000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.    RCKCS214.                                         00020005
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030005
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040005
000500 DATE-WRITTEN.  01/27/94.                                         00050005
000600 DATE-COMPILED.                                                   00060005
000700                                                                  00070005
000800*---------------------------------------------------------------* 00080005
000900*    TRANID      - E214                                         * 00090005
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100005
001100*    DESCRIPTION - ADD/COPY/CHANGE/DELETE PACK SLIP HEADER      * 00110005
001200*    MAPSET      - RCKM214                                      * 00120005
001300*                                                               * 00130005
001400*    THIS PROGRAM ALLOWS THE USER TO ADD, COPY, CHANGE OR       * 00140005
001500*    DELETE A PACK SLIP HEADER.                                 * 00150005
001600*                                                               * 00160005
001700*    AN 88 LEVEL SWITCH WAS CREATED TO DRIVE THE LOGIC WHICH    * 00170005
001800*    DICTATES WHAT "MODE" THE PROGRAM IS CURRENTLY IN.  THIS    * 00180005
001900*    PROGRAM CAN BE IN AN "ADD", "UPDATE", "DELETE" OR "COPY"   * 00190005
002000*    MODE AT ANY GIVEN TIME.                                    * 00200005
002100*                                                               * 00210005
002200*    ALL "ADD" LOGIC IS CONTAINED IN THE 5000- SERIES           * 00220005
002300*    PARAGRAPHS.                                                * 00230005
002400*                                                               * 00240005
002500*    ALL "UPDATE" LOGIC IS CONTAINED IN THE 6000- SERIES        * 00250005
002600*    PARAGRAPHS.                                                * 00260005
002700*                                                               * 00270005
002800*    ALL "DELETE" LOGIC IS CONTAINED IN THE 7000- SERIES        * 00280005
002900*    PARAGRAPHS.                                                * 00290005
003000*                                                               * 00300005
003100*    ALL "COPY" LOGIC IS CONTAINED IN THE 8000- SERIES          * 00310005
003200*    PARAGRAPHS.                                                * 00320005
003300*                                                               * 00330005
003400*    DC-154: MAKE THE SCREEN INQUIRY ONLY IF:                   * 00340005
003500*               THE RECEIVER HAS A STATUS OF 'CM' OR 'VE', OR   * 00350005
003600*               ANY OF THE RECEIPT LINES ARE VERIFIED ('VE').   * 00360005
003700*            BY M. FURLICK 6/24/94.                             * 00370005
003800*                                                               * 00380005
003900*    BY H. KIM  9/14/95.                                        * 00390005
004000*            IF SQL CODE = 904, 911, 913  PUT THE MESSAGE       * 00400005
004100*            INSTEAD OF ABENDING THE TRANSACTION.               * 00410005
004200*---------------------------------------------------------------* 00420005
004210* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00421097
004220* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00422098
004230* MAKING THE CALL DYNAMIC VS STATIC.                              00423098
004240*---------------------------------------------------------------* 00424098
004300                                                                  00430005
004400 ENVIRONMENT DIVISION.                                            00440005
004500 DATA DIVISION.                                                   00450005
004600                                                                  00460005
004700 WORKING-STORAGE SECTION.                                         00470005
004800                                                                  00480005
004900 01  DK-DB2-KEYS.                                                 00490005
005000     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00500005
005100     05  DK-SEQ-NBR                   PIC S9(4) COMP VALUE +0.    00510005
005200     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00520005
005300     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    00530005
005400     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00540005
005500     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    00550005
005600     05  DK-PRO-NBR                   PIC X(16) VALUE SPACES.     00560005
005700     05  DK-BOL-NBR                   PIC X(16) VALUE SPACES.     00570005
005800     05  DK-SCAC-ID                   PIC X(04) VALUE SPACES.     00580005
005900     05  DK-PKSL-NBR                  PIC X(10) VALUE SPACES.     00590005
006000     05  DK-OPER-UNT-ID-B             PIC S9(4) COMP VALUE +0.    00600005
006100     05  DK-OPER-UNT-ID-E             PIC S9(4) COMP VALUE +9999. 00610005
006200     05  DK-FCLTY-ID-B                PIC S9(4) COMP VALUE +0.    00620005
006300     05  DK-FCLTY-ID-E                PIC S9(4) COMP VALUE +9999. 00630005
006400     05  DK-PRO-NBR-B                 PIC X(16) VALUE SPACES.     00640005
006500     05  DK-PRO-NBR-E                 PIC X(16) VALUE             00650005
006600         '9999999999999999'.                                      00660005
006700     05  DK-BOL-NBR-B                 PIC X(16) VALUE SPACES.     00670005
006800     05  DK-BOL-NBR-E                 PIC X(16) VALUE             00680005
006900         '9999999999999999'.                                      00690005
007000     05  DK-SCAC-ID-B                 PIC X(04) VALUE SPACES.     00700005
007100     05  DK-SCAC-ID-E                 PIC X(04) VALUE '9999'.     00710005
007200     05  DK-PKSL-NBR-B                PIC X(10) VALUE SPACES.     00720005
007300     05  DK-PKSL-NBR-E                PIC X(10) VALUE             00730005
007400         '9999999999'.                                            00740005
007500     05  DK-REC-SEQ-NBR-B             PIC S9(9) COMP VALUE +0.    00750005
007600     05  DK-REC-SEQ-NBR-E             PIC S9(9) COMP VALUE +9999. 00760005
007700     05  DK-STR-DEST-NBR-B            PIC S9(4) COMP VALUE +0.    00770005
007800     05  DK-STR-DEST-NBR-E            PIC S9(4) COMP VALUE +9999. 00780005
007900     05  DK-SEQ-NBR-B                 PIC S9(4) COMP VALUE +0.    00790005
008000     05  DK-SEQ-NBR-E                 PIC S9(4) COMP VALUE +9999. 00800005
008100     05  DK-SHIPT-ID                  PIC S9(9) COMP VALUE +9999. 00810005
008200     05  DK-TRIP-ID                   PIC S9(9) COMP VALUE +9999. 00820005
008300     05  DK-CONTNR-ID                 PIC X(12) VALUE SPACES.     00830005
008400                                                                  00840005
008500 01  PC-PROGRAM-CONSTANTS.                                        00850005
008600     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E214'.    00860005
008700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS214'.00870005
008800     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC214A  '.00880005
008900     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM214 '.00890005
009000     05  PC-TROUBLE-RTN               PIC X(08)  VALUE 'TMKCS520'.00900005
009100     05  PC-TROUBLE-RTN-LENGTH        PIC S9(04) VALUE +600       00910005
009200                                                 COMP.            00920005
009300     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00930005
009400                                                 COMP.            00940005
009500     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00950005
009600                                                 COMP.            00960005
009700     05  PC-1                         PIC S9(09) VALUE +1         00970005
009800                                                 COMP.            00980005
009900     05  PC-9000                      PIC S9(9)  VALUE 9000       00990005
010000                                                 COMP.            01000005
010100     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       01010005
010200     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       01020005
010300     05  PC-AC                        PIC X(02)  VALUE 'AC'.      01030005
010400     05  PC-DE                        PIC X(02)  VALUE 'DE'.      01040005
010500     05  PC-CM                        PIC X(02)  VALUE 'CM'.      01050005
010600     05  PC-DS                        PIC X(02)  VALUE 'DS'.      01060005
010700     05  PC-DC                        PIC X(02)  VALUE 'DC'.      01070005
010800*** BEGIN - AHP 1/7/08                                            01080082
010900     05  PC-OP                        PIC X(02)  VALUE 'OP'.      01090073
011000*** END   - AHP 1/7/08                                            01100079
011100     05  PC-IN                        PIC X(02)  VALUE 'IN'.      01110005
011200     05  PC-IP                        PIC X(02)  VALUE 'IP'.      01120005
011300     05  PC-VE                        PIC X(02)  VALUE 'VE'.      01130005
011400     05  PC-03                        PIC X(02)  VALUE '03'.      01140005
011500     05  PC-3                         PIC X(01)  VALUE '3'.       01150005
011600     05  PC-IMPORT                    PIC X(02).                  01160005
011700         88  PC-IMPORT-EXT            VALUE 'IM' 'IE' 'IF'.       01170005
011800     05  PC-LONG-ZERO                 PIC S9(9)  VALUE ZERO       01180005
011900                                                 COMP.            01190005
012000     05  PC-A                         PIC X(01)  VALUE 'A'.       01200005
012100     05  PC-Y                         PIC X(01)  VALUE 'Y'.       01210005
012200     05  PC-AC-DESC                   PIC X(10)  VALUE            01220005
012300         'ACTIVE    '.                                            01230005
012400     05  PC-CM-DESC                   PIC X(10)  VALUE            01240005
012500         'COMPLETE  '.                                            01250005
012600     05  PC-IN-DESC                   PIC X(10)  VALUE            01260005
012700         'INACTIVE  '.                                            01270005
012800     05  PC-IP-DESC                   PIC X(10)  VALUE            01280005
012900         'IN PROCESS'.                                            01290005
013000     05  PC-VE-DESC                   PIC X(10)  VALUE            01300005
013100         'VERIFIED  '.                                            01310005
013200     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            01320005
013300                                                 '0001-01-01'.    01330005
013400     05  PC-DEFAULT-DATE2             PIC X(08)  VALUE            01340005
013500                                                 '01/01/01'.      01350005
013600     05  PC-DEFAULT-TIME              PIC X(08)  VALUE            01360005
013700                                                 '00.00.00'.      01370005
013800     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            01380005
013900         '9999-09-09-09.09.09.999999'.                            01390005
014000     05  PC-MULTIPLE-SHIPMTS          PIC X(22)  VALUE            01400005
014100         'MULTIPLE SHIPMENTS'.                                    01410005
014200     05  PC-DISPLAY-PO                  PIC  9(8)  VALUE ZEROS.   01420037
014300     05  PC-DISPLAY-RCVR                PIC  9(4)  VALUE ZEROS.   01430037
014400     05  PC-DISPLAY-LINE                PIC  9(4)  VALUE ZEROS.   01440037
014500     05  PC-DISPLAY-OPER                PIC  9(4)  VALUE ZEROS.   01450037
014600                                                                  01460037
014700     05  PC-INTER-APPL-CODES.                                     01470005
014800         10  PC-INTER-APPL-CRIT-ADD   PIC X(01)  VALUE '1'.       01480005
014900         10  PC-INTER-APPL-LIST-ADD   PIC X(01)  VALUE '2'.       01490005
015000         10  PC-INTER-APPL-CRIT-UPD   PIC X(01)  VALUE '3'.       01500005
015100         10  PC-INTER-APPL-CRIT-DEL   PIC X(01)  VALUE '4'.       01510005
015200         10  PC-INTER-APPL-LIST-UPD   PIC X(01)  VALUE '5'.       01520005
015300         10  PC-INTER-APPL-LIST-DEL   PIC X(01)  VALUE '6'.       01530005
015400         10  PC-INTER-APPL-CRIT-COPY  PIC X(01)  VALUE '7'.       01540005
015500         10  PC-INTER-APPL-LIST-COPY  PIC X(01)  VALUE '8'.       01550005
015600                                                                  01560005
015601******************************************************************01560192
015610* MSG-00004  PRESS F2 TO CONFIRM REQUEST                          01561092
015620* MSG-00005  INVALID VALUE                                        01562092
015630* MSG-00007  REQUIRED ENTRY                                       01563092
015640* MSG-00008  MUST BE NUMERIC                                      01564092
015650* MSG-00009  INVALID DATE                                         01565092
015660* MSG-00010  CANNOT BE ZERO                                       01566092
015670* MSG-00017  STORE NUMBER DOES NOT EXIST                          01567092
015680* MSG-00034  ADD SUCCESSFUL                                       01568092
015690* MSG-00045  INVALID FUNCTION KEY                                 01569092
015691* MSG-00046  DATA NOT CHANGED; NO UPDATE PERFORMED                01569192
015692* MSG-00047  ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION 01569292
015693* MSG-00057  A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01569392
015694* MSG-00059  UPDATE(S) SUCCESSFUL                                 01569492
015695* MSG-00069  TOP OF LIST                                          01569592
015696* MSG-00070  BOTTOM OF LIST                                       01569692
015697* MSG-00083  PURCHASE ORDER DOES NOT EXIST                        01569792
015698* MSG-00115  DELETE SUCCESSFUL                                    01569892
015699* MSG-00116  CANNOT DELETE - RECORD DOES NOT EXIST                01569992
015700* MSG-00148  DATA DOES NOT EXIST                                  01570092
015701* MSG-00254  ERRORS OCCURRED; NO UPDATE PERFORMED                 01570192
015702* MSG-00308  AT LEAST ONE ENTRY IS REQUIRED                       01570292
015703* MSG-00352  ADD PENDING                                          01570392
015704* MSG-00461  PURCHASE ORDER NUMBER REQUIRED                       01570492
015705* MSG-00464  RECEIVER MUST BE ADDED FIRST BEFORE ATTEMPTING UPDATE01570592
015706* MSG-00532  ONE OR MORE UPDATES UNSUCCESSFUL.  REFRESH TO SEE    01570692
015707* MSG-00551  WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 01570792
015708* MSG-00638  SHIPPING DESTINATION IS NOT CORRECT FOR DIRECT TO STR01570892
015709* MSG-00723  THIS FUNCTION MAY ONLY BE USED FOR STATUS OF INACTIVE01570992
015710* MSG-00724  UPDATE / DELETE IS ONLY VALID FOR ACTIVE AND INACTIVE01571092
015711* MSG-00729  MULTIPLE PACK SLIPS EXIST; USE THE LIST SCREEN       01571192
015712* MSG-00730  NO PACK SLIPS FOR THE SELECTION CRITERIA WERE FOUND  01571292
015713* MSG-00734  INVALID STATUS FOR THIS RECEIVER                     01571392
015714* MSG-00815  OPERATING UNIT AND FCLTY ID REQUIRED                 01571492
015715* MSG-00818  STR DEST CONFLICTS WITH RCVR PACKED BY STR IND       01571592
015716* MSG-00844  STORE CLOSED                                         01571692
015717* MSG-00861  INCONSISTANT PACK SLIP NUMBER FOR CONS/NON CONS      01571792
015718* MSG-00868  CANNOT ADD - PACKSLIP ALREADY EXISTS                 01571892
015719* MSG-01011  ADD COMPLETE - PO LEVEL TROUBLE EXISTS               01571992
015720* MSG-01741  INVALID OPERATING UNIT                               01572092
015721* MSG-01802  CNTNR MAY BE INVALID, CHANGE CNTNR OR PRESS F2       01572192
015722* MSG-02126  CNTNR DOES NOT BEGIN WITH 4 ALPHA CHAR - PRESS F2    01572292
015723* MSG-02133  IMPORT PO - ENTER CNTNR IF AVAILABLE - PRESS F2      01572392
015724* MSG-02135  CNTNR MAY BE INVALID OR DOESNT BEGIN WITH 4 ALPHA-F2 01572492
015725* MSG-03207  FNCTN MAY NOT BE USED TO DELETE SYS CRE F/A PKSLIP   01572592
015726* MSG-03411  UNABLE TO DELETE PACKSLIP-SML'S HAVE BEEN ACTIVATED  01572692
015727* MSG-03597  DIRECT STORE SHIP - OPER AND STORE MUST MATCH        01572792
015728******************************************************************01572892
015729                                                                  01572992
015730     05  PC-TSYMSG-NUMBERS.                                       01573005
015800         10  PC-TSYMSG-00004          PIC 9(05)  VALUE 00004.     01580005
016000         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01600005
016200         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01620005
016400         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01640005
016600         10  PC-TSYMSG-00009          PIC 9(05)  VALUE 00009.     01660005
016800         10  PC-TSYMSG-00010          PIC 9(05)  VALUE 00010.     01680005
017000         10  PC-TSYMSG-00017          PIC 9(05)  VALUE 00017.     01700005
017200         10  PC-TSYMSG-00034          PIC 9(05)  VALUE 00034.     01720005
017400         10  PC-TSYMSG-00045          PIC 9(05)  VALUE 00045.     01740005
017600         10  PC-TSYMSG-00046          PIC 9(05)  VALUE 00046.     01760005
017800         10  PC-TSYMSG-00047          PIC 9(05)  VALUE 00047.     01780005
018000         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01800005
018200         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01820005
018400         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01840005
018600         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01860005
018800         10  PC-TSYMSG-00083          PIC 9(05)  VALUE 00083.     01880005
019000         10  PC-TSYMSG-00115          PIC 9(05)  VALUE 00115.     01900005
019200         10  PC-TSYMSG-00116          PIC 9(05)  VALUE 00116.     01920005
019400         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01940005
019600         10  PC-TSYMSG-00254          PIC 9(05)  VALUE 00254.     01960005
019800         10  PC-TSYMSG-00308          PIC 9(05)  VALUE 00308.     01980005
020000         10  PC-TSYMSG-00352          PIC 9(05)  VALUE 00352.     02000005
020200         10  PC-TSYMSG-00461          PIC 9(05)  VALUE 00461.     02020005
020400         10  PC-TSYMSG-00464          PIC 9(05)  VALUE 00464.     02040005
020600         10  PC-TSYMSG-00532          PIC 9(05)  VALUE 00532.     02060005
020800         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     02080005
021100         10  PC-TSYMSG-00638          PIC 9(05)  VALUE 00638.     02110005
021300         10  PC-TSYMSG-00723          PIC 9(05)  VALUE 00723.     02130005
021500         10  PC-TSYMSG-00724          PIC 9(05)  VALUE 00724.     02150005
021700         10  PC-TSYMSG-00729          PIC 9(05)  VALUE 00729.     02170005
021900         10  PC-TSYMSG-00730          PIC 9(05)  VALUE 00730.     02190005
022100         10  PC-TSYMSG-00734          PIC 9(05)  VALUE 00734.     02210005
022300         10  PC-TSYMSG-00815          PIC 9(05)  VALUE 00815.     02230092
022500         10  PC-TSYMSG-00818          PIC 9(05)  VALUE 00818.     02250092
022700         10  PC-TSYMSG-00844          PIC 9(05)  VALUE 00844.     02270092
022900         10  PC-TSYMSG-00861          PIC 9(05)  VALUE 00861.     02290092
023100         10  PC-TSYMSG-00868          PIC 9(05)  VALUE 00868.     02310005
023300         10  PC-TSYMSG-01011          PIC 9(05)  VALUE 01011.     02330005
023500         10  PC-TSYMSG-01741          PIC 9(05)  VALUE 01741.     02350092
023600         10  PC-TSYMSG-01802          PIC 9(05)  VALUE 01802.     02360092
023800         10  PC-TSYMSG-02126          PIC 9(05)  VALUE 02126.     02380005
024100         10  PC-TSYMSG-02133          PIC 9(05)  VALUE 02133.     02410005
024400         10  PC-TSYMSG-02135          PIC 9(05)  VALUE 02135.     02440005
024700         10  PC-TSYMSG-03207          PIC 9(05)  VALUE 03207.     02470007
025000         10  PC-TSYMSG-03411          PIC 9(05)  VALUE 03411.     02500031
025300         10  PC-TSYMSG-03597          PIC 9(05)  VALUE 03597.     02530066
025500                                                                  02550005
025600 01  PS-PROGRAM-SWITCHES.                                         02560005
025700     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       02570005
025800         88  PS-ERROR                            VALUE 'Y'.       02580005
025900         88  PS-NO-ERROR                         VALUE 'N'.       02590005
026000     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X     VALUE 'N'.       02600013
026100         88  PS-ORIG-ASN-PKSLIP-YES              VALUE 'Y'.       02610013
026200         88  PS-ORIG-ASN-PKSLIP-NO               VALUE 'N'.       02620013
026300     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       02630005
026400         88  PS-COMMAREA-VALID                   VALUE 'Y'.       02640005
026500         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       02650005
026600     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       02660005
026700         88  PS-LIST-END                         VALUE 'Y'.       02670005
026800         88  PS-NO-LIST-END                      VALUE 'N'.       02680005
026900     05  PS-EOF-TPKITEM-CSR-SW        PIC X(01)  VALUE 'N'.       02690005
027000         88  PS-EOF-TPKITEM-CSR                  VALUE 'Y'.       02700005
027100     05  PS-EOF-TUNPKSL-CSR-SW        PIC X(01)  VALUE 'N'.       02710005
027200         88  PS-EOF-TUNPKSL-CSR                  VALUE 'Y'.       02720005
027300     05  PS-PO-EXISTS-SW              PIC X(01)  VALUE 'N'.       02730005
027400         88  PS-PO-EXISTS                        VALUE 'Y'.       02740005
027500         88  PS-PO-DOES-NOT-EXIST                VALUE 'N'.       02750005
027600     05  PS-PKSLIP-INSERT-SW          PIC X(01)  VALUE 'N'.       02760005
027700         88  PS-PKSLIP-NOT-INSERTED              VALUE 'N'.       02770005
027800         88  PS-PKSLIP-INSERTED                  VALUE 'Y'.       02780005
027900     05  PS-PKSLIP-EXISTS-SW          PIC X(01)  VALUE 'N'.       02790005
028000         88  PS-PKSLIP-FOUND                     VALUE 'Y'.       02800005
028100         88  PS-PKSLIP-NOT-FOUND                 VALUE 'N'.       02810005
028200         88  PS-MULTI-PKSLIP-FOUND               VALUE 'M'.       02820005
028300     05  PS-RECITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       02830005
028400         88  PS-RECITM-FOUND                     VALUE 'Y'.       02840005
028500         88  PS-RECITM-NOT-FOUND                 VALUE 'N'.       02850005
028600     05  PS-RECITM-VERIFIED-SW        PIC X(01)  VALUE 'N'.       02860005
028700         88  PS-RECITM-VERIFIED                  VALUE 'Y'.       02870005
028800         88  PS-RECITM-NOT-VERIFIED              VALUE 'N'.       02880005
028900     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       02890005
029000         88  PS-PURITM-FOUND                     VALUE 'Y'.       02900005
029100         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       02910005
029200     05  PS-PREV-UPDATE-SW            PIC X(01)  VALUE 'N'.       02920005
029300         88  PS-PREV-UPDATE                      VALUE 'Y'.       02930005
029400         88  PS-NO-PREV-UPDATE                   VALUE 'N'.       02940005
029500     05  PS-PACK-BY-STR-SW            PIC X(01)  VALUE 'N'.       02950005
029600         88  PS-DONT-BYPASS-PACK-BY-STR-CHK      VALUE 'Y'.       02960005
029700         88  PS-BYPASS-PACK-BY-STR-CHK           VALUE 'N'.       02970005
029800     05  PS-OTHER-SHIPT-EXIST-SW      PIC  X(01) VALUE 'N'.       02980005
029900         88  PS-OTHER-SHIPT-EXIST                VALUE 'Y'.       02990005
030000         88  PS-OTHER-SHIPT-DONT-EXIST           VALUE 'N'.       03000005
030100     05  PS-VHCL-ATTCHD-SW             PIC X(1)  VALUE 'Y'.       03010005
030200         88  PS-VHCL-ATTCHD                      VALUE 'Y'.       03020005
030300         88  PS-VHCL-NOT-ATTCHD                  VALUE 'N'.       03030005
030400                                                                  03040005
030500     05  PS-UPDATE-SW                  PIC X(1)  VALUE 'N'.       03050005
030600         88  PS-NO-UPDATES-DONE                  VALUE 'N'.       03060005
030700         88  PS-UPDATES-DONE                     VALUE 'Y'.       03070005
030800                                                                  03080005
030900     05  PS-NEXT-SCREEN-SW             PIC X(1)  VALUE 'N'.       03090005
031000         88  PS-NO-NEXT-SCREEN                   VALUE 'N'.       03100005
031100         88  PS-NEXT-SCREEN                      VALUE 'Y'.       03110005
031200     05  PS-MULT-SHIPMTS-SW            PIC X(1)  VALUE 'N'.       03120005
031300         88  PS-MULT-SHIPMTS                     VALUE 'Y'.       03130005
031400         88  PS-NO-MULT-SHIPMTS                  VALUE 'N'.       03140005
031500     05  PS-EOF-TINPKSU-SW             PIC X(1)  VALUE 'N'.       03150005
031600         88  PS-NOT-EOF-TINPKSU                  VALUE 'N'.       03160005
031700         88  PS-EOF-TINPKSU                      VALUE 'Y'.       03170005
031800     05  PS-PKSL-STAT-ERROR-SW         PIC X(1)  VALUE 'N'.       03180005
031900         88  PS-PKSL-STAT-ERROR                  VALUE 'Y'.       03190005
032000         88  PS-PKSL-NO-STAT-ERROR               VALUE 'N'.       03200005
032100     05  PS-CONTAINER-EXISTS-SW        PIC X(1)  VALUE 'N'.       03210005
032200         88  PS-CONTAINER-EXISTS                 VALUE 'Y'.       03220005
032300         88  PS-CONTAINER-EXISTS-NO              VALUE 'N'.       03230005
032400     05  PS-VALID-CONTNR-ID-SW         PIC X(1)  VALUE 'N'.       03240005
032500         88  PS-VALID-CONTNR-ID                  VALUE 'Y'.       03250005
032600         88  PS-VALID-CONTNR-ID-NO               VALUE 'N'.       03260005
032700     05  PS-PO-TYP-CDE-FOUND-SW        PIC X(1)  VALUE 'N'.       03270005
032800         88  PS-PO-TYP-CDE-FOUND                 VALUE 'Y'.       03280005
032900         88  PS-PO-TYP-CDE-FOUND-NO              VALUE 'N'.       03290005
033000     05  PS-OPER-UNT-STR-FND-SW        PIC X(1)  VALUE 'Y'.       03300029
033100         88  PS-OPER-UNT-STR-FND                 VALUE 'Y'.       03310019
033200         88  PS-OPER-UNT-STR-NOT-FND             VALUE 'N'.       03320019
033300     05  PS-CARTON-DATA-SW             PIC X(1)  VALUE 'Y'.       03330031
033400         88  PS-CARTON-DATA-YES                  VALUE 'Y'.       03340031
033500         88  PS-CARTON-DATA-NO                   VALUE 'N'.       03350031
033600     05  PS-CARTON-ACTIVITY-SW         PIC X(1)  VALUE 'Y'.       03360031
033700         88  PS-CARTON-ACTIVITY-YES              VALUE 'Y'.       03370031
033800         88  PS-CARTON-ACTIVITY-NO               VALUE 'N'.       03380031
033900     05  PS-PACKSLIP-SW                PIC X(1)  VALUE 'N'.       03390042
034000         88  PS-PACKSLIP-ONLY                    VALUE 'A'.       03400042
034100         88  PS-PACKSLIP-WITH-CRTN-DATA          VALUE 'B'.       03410042
034200* JAK 04/2007 ADD EBUS LOC SWITCH                                 03420065
034300     05  PS-EBUS-LOC-SW                PIC X(1)  VALUE 'N'.       03430060
034400         88  PS-EBUS-LOC-YES                     VALUE 'Y'.       03440060
034500         88  PS-EBUS-LOC-NO                      VALUE 'N'.       03450060
034600                                                                  03460031
034700 01  PV-PROGRAM-VARIABLES.                                        03470005
034800     05  PV-COMPARE-DATE.                                         03480005
034900         10  PV-COMP-MM               PIC  9(02)   VALUE ZEROES.  03490005
035000         10  PV-COMP-DD               PIC  9(02)   VALUE ZEROES.  03500005
035100         10  PV-COMP-YY               PIC  9(02)   VALUE ZEROES.  03510005
035200     05  PV-DISPLAY-DATE2.                                        03520005
035300         10  PV-DD-MONTH              PIC  9(02)   VALUE ZEROES.  03530005
035400         10  FILLER                   PIC  X(01)   VALUE '-'.     03540005
035500         10  PV-DD-DAY                PIC  9(02)   VALUE ZEROES.  03550005
035600         10  FILLER                   PIC  X(01)   VALUE '-'.     03560005
035700         10  PV-DD-YEAR               PIC  9(02)   VALUE ZEROES.  03570005
035800     05  PV-RECEIV-REC-DATE           PIC  X(10).                 03580005
035900     05  PV-VEND-SHIP-DTE             PIC  X(10).                 03590005
036000     05  PV-TEMP-SHIPT-ID             PIC S9(09) VALUE +0         03600005
036100                                                 COMP-3.          03610005
036200     05  PV-NI-TRIP-ID                PIC S9(04) VALUE +0         03620005
036300                                                 COMP SYNC.       03630005
036400     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         03640005
036500                                                 COMP SYNC.       03650005
036600     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         03660005
036700                                                 COMP SYNC.       03670005
036800     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         03680005
036900                                                 COMP-3.          03690005
037000     05  PV-PKSLIP-CTN-COUNT          PIC S9(09) VALUE +0         03700031
037100                                                 COMP-3.          03710031
037200     05  PV-ACTIVE-CTN-COUNT          PIC S9(09) VALUE +0         03720031
037300                                                 COMP-3.          03730031
037400     05  PV-INPKSU-CRTN-CNT           PIC S9(9) VALUE ZERO        03740047
037500                                                COMP.             03750047
037600     05  PV-NULL-IND                  PIC S9(04) VALUE +0         03760005
037700                                                 COMP SYNC.       03770005
037800     05  PV-COUNTER                   PIC S9(04) VALUE +0         03780016
037900                                                 COMP SYNC.       03790016
038000     05  PV-SEQ-NBR-IND               PIC S9(04) VALUE +0         03800005
038100                                                  COMP.           03810005
038200     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         03820005
038300                                                  COMP.           03830005
038400     05  PV-MAX-SEQ-NBR               PIC S9(04) VALUE +0         03840005
038500                                                 COMP.            03850005
038600     05  PV-NEXT-UNPKSL-LINE          PIC S9(04) VALUE +0         03860005
038700                                                 COMP.            03870005
038800     05  PV-NEXT-SEQ-NBR              PIC S9(04) VALUE +0         03880005
038900                                                 COMP.            03890005
039000     05  PV-MAX-SHIPT-NBR             PIC S9(04) VALUE +0         03900005
039100                                                 COMP.            03910005
039200     05  PV-NEXT-SHIPT-NBR            PIC S9(04) VALUE +0         03920005
039300                                                 COMP.            03930005
039400     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         03940005
039500                                                 COMP.            03950005
039600     05  PV-PKSL-ITM-QTY              PIC S9(09) VALUE +0         03960005
039700                                                 COMP.            03970005
039800     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE +0 COMP.    03980013
039900     05  PV-COUNT-IND                 PIC S9(4) VALUE ZERO        03990005
040000                                                COMP.             04000005
040100     05  PV-COUNT-NOT-INACTIVE-PKSLIP PIC S9(4) VALUE ZERO        04010005
040200                                                COMP.             04020005
040300     05  PV-PKSL-NBR-CNT              PIC S9(4) VALUE ZERO        04030005
040400                                                COMP.             04040005
040500     05  PV-STR-DEST-NBR-CNT          PIC S9(4) VALUE ZERO        04050005
040600                                                COMP.             04060005
040700     05  PV-DISPLAY-TASK              PIC 9(05).                  04070005
040800     05  PV-DISPLAY-SQLCODE           PIC ------9.                04080005
040900     05  PV-ABSTIME                   PIC S9(15) COMP.            04090005
041000     05  PV-CURRENT-TIME              PIC  9(06).                 04100005
041100     05  PV-CURRENT-DATE              PIC  9(06).                 04110005
041200     05  FILLER REDEFINES PV-CURRENT-DATE.                        04120005
041300         10  PV-CURRENT-DATE-YY       PIC  X(02).                 04130005
041400         10  PV-CURRENT-DATE-MM       PIC  X(02).                 04140005
041500         10  PV-CURRENT-DATE-DD       PIC  X(02).                 04150005
041600                                                                  04160005
041700     05  PV-COMPARE-DATE1             PIC  X(04).                 04170005
041800     05  FILLER REDEFINES PV-COMPARE-DATE1.                       04180005
041900         10  PV-CD-YY-N               PIC  9(02).                 04190005
042000         10  PV-CD-MM-N               PIC  9(02).                 04200005
042100     05  PV-COMPARE-DATE2             PIC  X(04).                 04210005
042200     05  PV-DB2-RETURN-AREAS.                                     04220005
042300         10  PV-DB2-MONTH             PIC S9(09)   VALUE +0       04230005
042400                                                   COMP.          04240005
042500         10  PV-DB2-DAY               PIC S9(09)   VALUE +0       04250005
042600                                                   COMP.          04260005
042700         10  PV-DB2-YEAR              PIC S9(09)   VALUE +0       04270005
042800                                                   COMP.          04280005
042900         10  PV-DB2-HOUR              PIC S9(09)   VALUE +0       04290005
043000                                                   COMP.          04300005
043100         10  PV-DB2-MINUTE            PIC S9(09)   VALUE +0       04310005
043200                                                   COMP.          04320005
043300     05  PV-DISPLAY-DATE.                                         04330005
043400         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  04340005
043500         10  FILLER                   PIC  X(01)   VALUE '-'.     04350005
043600         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  04360005
043700         10  FILLER                   PIC  X(01)   VALUE '-'.     04370005
043800         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  04380005
043900     05  PV-DISPLAY-TIME.                                         04390005
044000         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  04400005
044100         10  FILLER                   PIC  X(01)   VALUE ':'.     04410005
044200         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  04420005
044300     05  PV-DB2-DATE-HOST             PIC  X(10).                 04430005
044400     05  PV-DB2-DATE                  PIC  X(10).                 04440005
044500     05  FILLER  REDEFINES PV-DB2-DATE.                           04450005
044600         10  PV-DB2-DATE-CC           PIC  X(02).                 04460005
044700         10  PV-DB2-DATE-YY           PIC  X(02).                 04470005
044800         10  FILLER                   PIC  X(01).                 04480005
044900         10  PV-DB2-DATE-MM           PIC  X(02).                 04490005
045000         10  FILLER                   PIC  X(01).                 04500005
045100         10  PV-DB2-DATE-DD           PIC  X(02).                 04510005
045200     05  PV-INTEGER                   PIC  9(6).                  04520005
045300     05  PV-REMAINDER                 PIC  9(3).                  04530005
045400     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  04540005
045500         88  PV-PKSL-STAT-CDE-BEING-WORKED         VALUES         04550005
045600            'IP', 'CM'.                                           04560005
045700         88  PV-PKSL-STAT-CDE-ACTIVE               VALUE 'AC'.    04570005
045800         88  PV-PKSL-STAT-CDE-INACTIVE             VALUE 'IN'.    04580005
045900     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   04590005
046000     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   04600005
046100     05  PV-PRE-RCPT-INFO             PIC X(04)    VALUE SPACES.  04610005
046200         88  PV-VALID-PRE-RCPT-INFO                VALUES '    ', 04620005
046300                                                          'AVIS', 04630005
046400                                                          'FAX ', 04640005
046500                                                          'ASN ', 04650005
046600                                                          'FA  ', 04660010
046700                                                          'CONS'. 04670005
046800     05  PV-PKSL-NBR                  PIC X(10)    VALUE SPACES.  04680005
046900                                                                  04690005
047000     05  PV-CICS-MSG-AREA                PIC  X(75) VALUE SPACE.  04700005
047100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     04710005
047200                                                     COMP SYNC.   04720005
047300     05  PV-BOMB-MSG.                                             04730005
047400         10  PV-BOMB-TRAN                PIC X(4)   VALUE 'E214'. 04740005
047500         10  FILLER                      PIC X(01)  VALUE SPACES. 04750005
047600         10  PV-BOMB-PARA                PIC X(06)  VALUE SPACES. 04760005
047700         10  FILLER                      PIC X(01)  VALUE SPACES. 04770005
047800         10  PV-BOMB-TABLE               PIC X(08)  VALUE SPACES. 04780005
047900         10  FILLER                      PIC X(01)  VALUE SPACES. 04790005
048000         10  PV-BOMB-KEYS.                                        04800005
048100             15 FILLER                   PIC X(04)                04810005
048200                              VALUE 'PO= '.                       04820005
048300             15  PV-BOMB-PO              PIC 9(8)   VALUE ZERO.   04830005
048400             15 FILLER                   PIC X(01)  VALUE SPACE.  04840005
048500             15 FILLER                   PIC X(10)                04850005
048600                              VALUE 'PKSL SEQ= '.                 04860005
048700             15  PV-BOMB-PKSL-SEQ        PIC 9(4)   VALUE ZERO.   04870005
048800             15 FILLER                   PIC X(01)  VALUE SPACE.  04880005
048900             15 FILLER                   PIC X(07)                04890005
049000                              VALUE 'PKSL='.                      04900005
049100             15  PV-BOMB-PKSL            PIC X(10)  VALUE SPACE.  04910005
049200             15 FILLER                   PIC X(01)  VALUE SPACE.  04920005
049300             15 FILLER                   PIC X(05)                04930005
049400                              VALUE 'STR= '.                      04940005
049500             15  PV-BOMB-STORE           PIC 9(4)  VALUE ZERO.    04950018
049600                                                                  04960005
049700 01  PV-DB2-TMST                      PIC X(26).                  04970005
049800 01  FILLER  REDEFINES  PV-DB2-TMST.                              04980005
049900         10  PV-DB2-TMST-CCYY         PIC X(04).                  04990005
050000         10  FILLER                   PIC X(01).                  05000005
050100         10  PV-DB2-TMST-MO           PIC X(02).                  05010005
050200         10  FILLER                   PIC X(01).                  05020005
050300         10  PV-DB2-TMST-DA           PIC X(02).                  05030005
050400         10  FILLER                   PIC X(01).                  05040005
050500         10  PV-DB2-TMST-HH           PIC X(02).                  05050005
050600         10  FILLER                   PIC X(01).                  05060005
050700         10  PV-DB2-TMST-MM           PIC X(02).                  05070005
050800         10  FILLER                   PIC X(01).                  05080005
050900         10  PV-DB2-TMST-SS           PIC X(02).                  05090005
051000             88  PV-DB2-TMST-SS-01               VALUE '01'.      05100005
051100         10  FILLER                   PIC X(01).                  05110005
051200         10  PV-DB2-TMST-MS           PIC X(06).                  05120005
051300             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  05130005
051400                                                                  05140032
051500***************************************************************** 05150032
051600*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 05160032
051700*             FUNCTIONS                                         * 05170032
051800***************************************************************** 05180032
051900     COPY RCWS071.                                                05190032
052000                                                                  05200032
052100*----------------------------------------------------------------*05210005
052200*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *05220005
052300*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *05230005
052400*----------------------------------------------------------------*05240005
052500                                                                  05250005
052600     COPY RCWS013.                                                05260007
052700/                                                                 05270005
052800                                                                  05280005
052900*----------------------------------------------------------------*05290005
053000*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     05300005
053100*----------------------------------------------------------------*05310005
053200                                                                  05320005
053300     COPY TMWS500.                                                05330007
053400/                                                                 05340005
053500                                                                  05350005
053600*----------------------------------------------------------------*05360005
053700*    MAP LAYOUT                                                  *05370005
053800*----------------------------------------------------------------*05380005
053900                                                                  05390005
054000     COPY RCKM214.                                                05400005
054100                                                                  05410005
054200/                                                                 05420005
054300*----------------------------------------------------------------*05430005
054400*    ATTRIBUTE SETTINGS COPYBOOK.                                *05440005
054500*----------------------------------------------------------------*05450005
054600                                                                  05460005
054700     COPY DPWS015.                                                05470007
054800                                                                  05480005
054900/                                                                 05490005
055000*----------------------------------------------------------------*05500005
055100*    FUNCTION KEYS COPYBOOK                                      *05510005
055200*----------------------------------------------------------------*05520005
055300                                                                  05530005
055400     COPY DPWS016.                                                05540007
055500                                                                  05550005
055600/                                                                 05560005
055700*----------------------------------------------------------------*05570005
055800*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *05580005
055900*    SUB-ROUTINE (POKUT100).                                     *05590005
056000*----------------------------------------------------------------*05600005
056100     COPY DPWS010I.                                               05610007
056200                                                                  05620005
056300/                                                                 05630005
056400*----------------------------------------------------------------*05640005
056500*  WORK AREA PASSED IN CALL TO DPKUT500                          *05650005
056600*----------------------------------------------------------------*05660005
056700     COPY DPWS500.                                                05670007
056800                                                                  05680005
056900*----------------------------------------------------------------*05690018
057000*  WORK AREA PASSED IN CALL TO XLKUT071 (LOGISTICS LOCATION MOD.)*05700018
057100*----------------------------------------------------------------*05710018
057200     COPY XLWS071.                                                05720018
057300                                                                  05730018
057400/                                                                 05740005
057810******************************************************************05781098
057820** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **05782098
057830** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **05783098
057840******************************************************************05784098
057900     COPY DPWS030.                                                05790007
057910     COPY DPWS930.                                                05791098
058000                                                                  05800005
058100/                                                                 05810005
058200*----------------------------------------------------------------*05820005
058300*    STANDARD COMMAREA.                                          *05830005
058400*----------------------------------------------------------------*05840005
058500                                                                  05850005
058600     COPY DPWS020.                                                05860007
058700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05870005
058800                                                                  05880005
058900*----------------------------------------------------------------*05890005
059000*    INTER-APPLICATION COMMAREA.                                 *05900005
059100*----------------------------------------------------------------*05910005
059200                                                                  05920005
059300         10  INTER-APPL-COMM-AREA PIC X(200).                     05930005
059400     COPY RCWS012.                                                05940007
059500     COPY RCWS015.                                                05950007
059600*----------------------------------------------------------------*05960005
059700*    SPECIFIC COMMMAREA FOR RCKCS214.                            *05970005
059800*----------------------------------------------------------------*05980005
059900         10  ASC-SPECIFIC-COMMAREA.                               05990005
060000             15  ASC-USE-SELECTION-QUEUE-IND                      06000005
060100                                            PIC X(01).            06010005
060200                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        06020005
060300             15  ASC-SEL-QUEUE-NAME.                              06030005
060400                 20  ASC-SEL-TERM-ID        PIC X(04).            06040005
060500                 20  ASC-SEL-TASK           PIC S9(05) COMP-3.    06050005
060600                 20  ASC-SEL-SEQ            PIC 9(01).            06060005
060700             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    06070005
060800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     06080005
060900                                            PIC S9(09) COMP-3.    06090005
061000             15  ASC-SEL-SUB                PIC S9(04) COMP.      06100005
061100             15  ASC-SEL-ITEM               PIC S9(04) COMP.      06110005
061200             15  ASC-CURRENT-DATE           PIC X(10).            06120005
061300             15  ASC-ACTION-SW              PIC X(03).            06130005
061400                 88  ASC-ADD-PENDING        VALUE 'ADD'.          06140005
061500                 88  ASC-DELETE-PENDING     VALUE 'DEL'.          06150005
061600                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          06160005
061700                 88  ASC-COPY-PENDING       VALUE 'COP'.          06170005
061800             15  ASC-EDIT-CONTROL-SW        PIC X(01).            06180005
061900                 88  ASC-RECORD-NOT-ADDED   VALUE 'N'.            06190005
062000                 88  ASC-RECORD-ADDED       VALUE 'Y'.            06200005
062100             15  ASC-REC-EXISTS-B4-LOCAL-SW PIC X(01).            06210005
062200                 88  ASC-REC-EXISTS-B4-LOCAL VALUE 'Y'.           06220005
062300                 88  ASC-NO-REC-B4-LOCAL    VALUE 'N'.            06230005
062400             15  ASC-DELETE-SUCCESSFUL-SW   PIC X(01).            06240005
062500                 88  ASC-DELETE-SUCCESSFUL  VALUE 'Y'.            06250005
062600             15  ASC-COPY-SUCCESSFUL-SW     PIC X(01).            06260005
062700                 88  ASC-COPY-SUCCESSFUL    VALUE 'Y'.            06270005
062800             15  ASC-APPROVE-SUCCESSFUL-SW  PIC X(01).            06280005
062900                 88  ASC-APPROVE-SUCCESSFUL VALUE 'Y'.            06290005
063000             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            06300005
063100                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            06310005
063200                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            06320005
063300             15  ASC-READ-ONLY-SW           PIC X(01).            06330005
063400                 88  ASC-READ-ONLY          VALUE 'Y'.            06340005
063500                 88  ASC-NOT-READ-ONLY      VALUE 'N'.            06350005
063600             15  ASC-BAD-FCLTY-SW           PIC X(01).            06360005
063700                 88  ASC-BAD-FCLTY          VALUE 'Y'.            06370005
063800                 88  ASC-NOT-BAD-FCLTY      VALUE 'N'.            06380005
063900             15  ASC-LOCAL-01-SW                   PIC X(01).     06390005
064000                 88  ASC-LOCAL-01-NEED-CONFIRM     VALUE 'Y'.     06400005
064100                 88  ASC-LOCAL-01-NO-NEED-CONFIRM  VALUE 'N'.     06410005
064200             15  ASC-LOCAL-02-SW                   PIC X(01).     06420005
064300                 88  ASC-LOCAL-02-NEED-CONFIRM     VALUE 'Y'.     06430005
064400                 88  ASC-LOCAL-02-NO-NEED-CONFIRM  VALUE 'N'.     06440005
064500             15  ASC-KEY-FIELDS.                                  06450005
064600                 20  ASC-KEY-PO-NBR.                              06460005
064700** CHG0094517  EXANDED PO-NBR FROM 7 TO 8                         06470082
064800                     25  ASC-KEY-PO-NBR-N   PIC 9(08).            06480081
064900                 20  ASC-KEY-OPER-UNT-ID.                         06490005
065000                     25  ASC-KEY-OPER-UNT-ID-N                    06500005
065100                                            PIC 9(04).            06510005
065200                 20  ASC-KEY-FCLTY-ID.                            06520005
065300                     25  ASC-KEY-FCLTY-ID-N PIC 9(04).            06530005
065400                 20  ASC-KEY-FCLTY-NME      PIC X(30).            06540005
065500                 20  ASC-KEY-BOL-NBR        PIC X(16).            06550005
065600                 20  ASC-KEY-PRO-NBR        PIC X(16).            06560005
065700                 20  ASC-KEY-PKSL-STAT-CDES.                      06570005
065800                     25  ASC-KEY-AC-STAT    PIC X(02).            06580005
065900                     25  ASC-KEY-IN-STAT    PIC X(02).            06590005
066000                     25  ASC-KEY-IP-STAT    PIC X(02).            06600005
066100                     25  ASC-KEY-CM-STAT    PIC X(02).            06610005
066200                     25  ASC-KEY-VE-STAT    PIC X(02).            06620005
066300                 20  ASC-KEY-PKSL-NBR       PIC X(10).            06630005
066400                 20  ASC-KEY-REC-SEQ-NBR.                         06640005
066500                     25  ASC-KEY-REC-SEQ-NBR-N                    06650005
066600                                            PIC 9(04).            06660005
066700                 20  ASC-KEY-SEQ-NBR-N      PIC 9(04).            06670005
066800             15  ASC-SCREEN-FIELDS.                               06680005
066900                 20  ASC-OPER-UNT-ID.                             06690005
067000                     25  ASC-OPER-UNT-ID-N  PIC 9(04).            06700005
067100                 20  ASC-OPER-UNT-ID-DESC   PIC X(30).            06710005
067200                 20  ASC-FCLTY-ID.                                06720005
067300                     25  ASC-FCLTY-ID-N     PIC 9(04).            06730005
067400                 20  ASC-PO-NBR.                                  06740005
067500** CHG0094517  EXANDED PO-NBR FROM 7 TO 8                         06750082
067600                     25  ASC-PO-NBR-N       PIC 9(08).            06760081
067700                 20  ASC-PO-TRBL-DESC       PIC X(30).            06770005
067800                 20  ASC-STR-DEST-NBR.                            06780005
067900                     25  ASC-STR-DEST-NBR-N PIC 9(04).            06790005
068000                 20  ASC-STR-DEST-NME       PIC X(30).            06800005
068100                 20  ASC-PKSL-NBR           PIC X(10).            06810005
068200                 20  ASC-PAGE-CNT.                                06820005
068300                     25  ASC-PAGE-CNT-N     PIC 9(04).            06830005
068400                 20  ASC-BOL-NBR            PIC X(22).            06840005
068500                 20  ASC-SHIPMT-BOL-NBR     PIC X(22).            06850005
068600                 20  ASC-PRO-NBR            PIC X(30).            06860005
068700                 20  ASC-SHIPMT-PRO-NBR     PIC X(30).            06870005
068800                 20  ASC-SHIPMT-PKG-QTY.                          06880005
068900                     25  ASC-SHIPMT-PKG-QTY-N                     06890005
069000                                            PIC 9(06).            06900005
069100                 20  ASC-EXPTED-PKG-QTY.                          06910005
069200                     25  ASC-EXPTED-PKG-QTY-N                     06920005
069300                                            PIC 9(06).            06930005
069400                 20  ASC-INPKSU-COUNT       PIC 9(05).            06940048
069500                 20  ASC-CRE-SRC-CDE        PIC X(04).            06950005
069600                 20  ASC-REC-SEQ-NBR.                             06960005
069700                     25  ASC-REC-SEQ-NBR-N  PIC 9(04).            06970005
069800                 20  ASC-PKSL-STAT-CDE      PIC X(02).            06980005
069900                 20  ASC-PKSL-STAT-DESC     PIC X(10).            06990005
070000                 20  ASC-ORIGIN-SCAC-CDE    PIC X(04).            07000005
070100                 20  ASC-SCAC-CODE-DESC     PIC X(20).            07010005
070200                 20  ASC-VND-SHIP-DTE.                            07020005
070300                     25 ASC-VND-SHIP-MM     PIC X(02).            07030005
070400                     25 FILLER              PIC X(01).            07040005
070500                     25 ASC-VND-SHIP-DD     PIC X(02).            07050005
070600                     25 FILLER              PIC X(01).            07060005
070700                     25 ASC-VND-SHIP-YY     PIC X(02).            07070005
070800                 20  ASC-ASN-NBR            PIC X(30).            07080005
070900                 20  ASC-CONTNR-ID          PIC X(12).            07090005
071000                 20  ASC-CREATED-BY-UID     PIC X(08).            07100005
071100                 20  ASC-CREATED-BY-DTE     PIC X(10).            07110005
071200                 20  ASC-CREATED-BY-TME     PIC X(05).            07120005
071300                 20  ASC-LAST-UPD-BY-UID    PIC X(08).            07130005
071400                 20  ASC-LAST-UPD-BY-DTE    PIC X(10).            07140005
071500                 20  ASC-LAST-UPD-BY-TME    PIC X(05).            07150005
071600             15  ASC-SEQ-NBR                PIC S9(4)   COMP.     07160005
071700             15  ASC-SCREEN-FIELDS-OLD.                           07170005
071800                 20  ASC-STR-DEST-NBR-N-OLD PIC 9(04).            07180005
071900                 20  ASC-REC-SEQ-NBR-N-OLD  PIC 9(04).            07190005
072000                 20  ASC-PKSL-NBR-OLD       PIC X(10).            07200005
072100                 20  ASC-BOL-NBR-OLD        PIC X(16).            07210005
072200*** BEGIN - DMH 1/7/07                                            07220075
072300             15  ASC-KEY-OPER-TYPE          PIC X(02).            07230075
072400                 88  ASC-KEY-OPER-STORE         VALUE 'DS'.       07240075
072500                 88  ASC-KEY-OPER-DC            VALUE 'DC'.       07250075
072600             15  ASC-STR-OPER-TYPE          PIC X(02).            07260078
072700                 88  ASC-STR-OPER-STORE         VALUE 'DS'.       07270078
072800                 88  ASC-STR-OPER-DC            VALUE 'DC'.       07280078
072900*** END   - DMH 1/7/07                                            07290075
073000                                                                  07300005
073100/                                                                 07310005
073200*----------------------------------------------------------------*07320005
073300*    ABEND PROCESSING COPYBOOK.                                  *07330005
073400*----------------------------------------------------------------*07340005
073500                                                                  07350005
073600     COPY DPWS013.                                                07360007
073700/                                                                 07370005
073800                                                                  07380005
073900*----------------------------------------------------------------*07390005
074000*    SYSTEM MESSAGE COPYBOOK                                     *07400005
074100*----------------------------------------------------------------*07410005
074200                                                                  07420005
074300     COPY DPRD507I.                                               07430007
074400/                                                                 07440005
074500                                                                  07450005
074600*----------------------------------------------------------------*07460005
074700*    DB2 SQL COMMUNICATION AREA                                   07470005
074800*----------------------------------------------------------------*07480005
074900     EXEC SQL                                                     07490005
075000          INCLUDE SQLCA                                           07500005
075100     END-EXEC.                                                    07510005
075200                                                                  07520005
075300/                                                                 07530005
075400*----------------------------------------------------------------*07540005
075500*    DB2 DCLGEN FOR THE VEHICLE AUDIT TABLES                     *07550005
075600*----------------------------------------------------------------*07560005
075700     EXEC SQL                                                     07570005
075800          INCLUDE TAUVHCL                                         07580005
075900     END-EXEC.                                                    07590005
076000                                                                  07600005
076100/                                                                 07610005
076200*----------------------------------------------------------------*07620005
076300*    DB2 DCLGEN FOR THE VEHICLE/TRIP TABLS                       *07630005
076400*----------------------------------------------------------------*07640005
076500     EXEC SQL                                                     07650005
076600          INCLUDE TVHTRIP                                         07660005
076700     END-EXEC.                                                    07670005
076800                                                                  07680005
076900/                                                                 07690005
077000*----------------------------------------------------------------*07700005
077100*    DB2 DCLGEN FOR THE VEHICLE TABLE                            *07710005
077200*----------------------------------------------------------------*07720005
077300     EXEC SQL                                                     07730005
077400          INCLUDE TVEHICL                                         07740005
077500     END-EXEC.                                                    07750005
077600                                                                  07760005
077700/                                                                 07770005
077800*----------------------------------------------------------------*07780005
077900*    DB2 DCLGEN FOR THE EXTERNAL ENTERPRISE TABLE                 07790005
078000*----------------------------------------------------------------*07800005
078100     EXEC SQL                                                     07810005
078200          INCLUDE TEXTENT                                         07820005
078300     END-EXEC.                                                    07830005
078400                                                                  07840005
078500/                                                                 07850005
078600*----------------------------------------------------------------*07860005
078700*    DB2 DCLGEN FOR THE ENTERPRISE NAME TABLE                     07870005
078800*----------------------------------------------------------------*07880005
078900     EXEC SQL                                                     07890005
079000          INCLUDE TENTNME                                         07900005
079100     END-EXEC.                                                    07910005
079200                                                                  07920005
079300/                                                                 07930005
079400*----------------------------------------------------------------*07940005
079500*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        07950005
079600*----------------------------------------------------------------*07960005
079700     EXEC SQL                                                     07970005
079800          INCLUDE TPKSLIP                                         07980005
079900     END-EXEC.                                                    07990005
080000                                                                  08000005
080100/                                                                 08010005
080200*----------------------------------------------------------------*08020005
080300*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          08030005
080400*----------------------------------------------------------------*08040005
080500     EXEC SQL                                                     08050005
080600          INCLUDE TPKITEM                                         08060005
080700     END-EXEC.                                                    08070005
080800                                                                  08080005
080900/                                                                 08090005
081000*----------------------------------------------------------------*08100005
081100*    DB2 DCLGEN FOR UNMATCHED PACK SLIP ITEM TABLE                08110005
081200*----------------------------------------------------------------*08120005
081300     EXEC SQL                                                     08130005
081400          INCLUDE TUNPKSL                                         08140005
081500     END-EXEC.                                                    08150005
081600                                                                  08160005
081700/                                                                 08170005
081800*----------------------------------------------------------------*08180005
081900*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          08190005
082000*----------------------------------------------------------------*08200005
082100     EXEC SQL                                                     08210005
082200          INCLUDE TPURCHS                                         08220005
082300     END-EXEC.                                                    08230005
082400                                                                  08240005
082500/                                                                 08250005
082600*----------------------------------------------------------------*08260005
082700*    DB2 SHIPMENT TABLE                                           08270005
082800*----------------------------------------------------------------*08280005
082900     EXEC SQL                                                     08290005
083000          INCLUDE TSHIPMT                                         08300005
083100     END-EXEC.                                                    08310005
083200                                                                  08320005
083300/                                                                 08330005
083400*----------------------------------------------------------------*08340005
083500*    DB2 SHIPMENT TO PO TABLE                                     08350005
083600*----------------------------------------------------------------*08360005
083700     EXEC SQL                                                     08370005
083800          INCLUDE TSHPTPO                                         08380005
083900     END-EXEC.                                                    08390005
084000                                                                  08400005
084100/                                                                 08410005
084200*----------------------------------------------------------------*08420005
084300*    DB2 RECEIVER TABLE                                           08430005
084400*----------------------------------------------------------------*08440005
084500     EXEC SQL                                                     08450005
084600          INCLUDE TRECEIV                                         08460005
084700     END-EXEC.                                                    08470005
084800                                                                  08480005
084900/                                                                 08490005
085000*----------------------------------------------------------------*08500005
085100*    DB2 RECEIVER ITEM TABLE                                      08510005
085200*----------------------------------------------------------------*08520005
085300     EXEC SQL                                                     08530005
085400          INCLUDE TRECITM                                         08540005
085500     END-EXEC.                                                    08550005
085600                                                                  08560005
085700/                                                                 08570005
085800*----------------------------------------------------------------*08580005
085900*    DB2 TROUBLE NOTIFICATION TABLE                               08590005
086000*----------------------------------------------------------------*08600005
086100     EXEC SQL                                                     08610005
086200          INCLUDE TTRBNTF                                         08620005
086300     END-EXEC.                                                    08630005
086400/                                                                 08640005
086500*----------------------------------------------------------------*08650005
086600*    DB2 CARTON TABLES                                            08660005
086700*----------------------------------------------------------------*08670005
086800*SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT UNIT ASSOC TABLE         08680034
086900     EXEC SQL                                                     08690005
087000          INCLUDE TINPKSU                                         08700005
087100     END-EXEC.                                                    08710005
087200                                                                  08720005
087300*SU-SHIPMENT UNIT TABLE                                           08730034
087400     EXEC SQL                                                     08740005
087500          INCLUDE TSHPUNT                                         08750005
087600     END-EXEC.                                                    08760005
087700                                                                  08770034
087800*SU-LABEL CROSS REFERENCE TABLE                                   08780034
087900     EXEC SQL                                                     08790034
088000          INCLUDE TSULBXF                                         08800034
088100     END-EXEC.                                                    08810034
088200                                                                  08820060
088300*JAK 04/2007 - ADD TSHUNLO & XLT_LOC TABLES                       08830060
088400*SU-SHIPMENT UNIT LOCATION TABLE                                  08840060
088500     EXEC SQL                                                     08850060
088600          INCLUDE TSHUNLO                                         08860060
088700     END-EXEC.                                                    08870060
088800                                                                  08880060
088900*XLT_LOC - LOCATION DOMAIN TABLE                                  08890060
089000     EXEC SQL                                                     08900060
089100          INCLUDE XLT00010                                        08910060
089200     END-EXEC.                                                    08920060
089300/                                                                 08930005
089400*----------------------------------------------------------------*08940005
089500*    DB2 DCLGEN FOR IMPORTS CONTAINER TABLE                       08950005
089600*----------------------------------------------------------------*08960005
089700     EXEC SQL                                                     08970005
089800          INCLUDE TIMCNTK                                         08980005
089900     END-EXEC.                                                    08990005
090000                                                                  09000005
090100/                                                                 09010005
090200*---------------------------------------------------------------* 09020005
090300*  CURSOR TO SELECT ALL PACK SLIP LINE ITEMS                    * 09030005
090400*---------------------------------------------------------------* 09040005
090500                                                                  09050005
090600     EXEC SQL                                                     09060005
090700          DECLARE TPKITEM-CSR CURSOR FOR                          09070005
090800          SELECT A.PO_NBR,                                        09080005
090900                 A.SEQ_NBR,                                       09090005
091000                 A.PKSL_LNE_NBR,                                  09100005
091100                 A.PKSL_ITM_QTY,                                  09110005
091200                 A.PURITM_VER_NBR                                 09120005
091300          FROM   TPKITEM A                                        09130005
091400          WHERE  A.PO_NBR       = :DK-PO-NBR                      09140005
091500            AND  A.SEQ_NBR      = :DK-SEQ-NBR                     09150005
091600            AND  A.VER_STAT_CDE = :PC-ACTIVE                      09160005
091700          ORDER BY A.PKSL_LNE_NBR                                 09170005
091800     END-EXEC.                                                    09180005
091900                                                                  09190005
092000/                                                                 09200005
092100*---------------------------------------------------------------* 09210005
092200*  CURSOR TO SELECT ALL UNMATCHED PACK SLIP LINE ITEMS          * 09220005
092300*---------------------------------------------------------------* 09230005
092400                                                                  09240005
092500     EXEC SQL                                                     09250005
092600          DECLARE TUNPKSL-CSR CURSOR FOR                          09260005
092700          SELECT A.PO_NBR,                                        09270005
092800                 A.SEQ_NBR,                                       09280005
092900                 A.PKSL_LNE_NBR,                                  09290005
093000                 A.PKSL_ITM_QTY,                                  09300005
093100                 A.UNT_COST_AMT,                                  09310005
093200                 A.COLOR_DESC,                                    09320005
093300                 A.SIZE_DESC,                                     09330005
093400                 A.VEND_STYL_NAME,                                09340005
093500                 A.VEND_DESC                                      09350005
093600          FROM   TUNPKSL A                                        09360005
093700          WHERE  A.PO_NBR       = :DK-PO-NBR                      09370005
093800            AND  A.SEQ_NBR      = :DK-SEQ-NBR                     09380005
093900            AND  A.VER_STAT_CDE = :PC-ACTIVE                      09390005
094000          ORDER BY A.PKSL_LNE_NBR                                 09400005
094100     END-EXEC.                                                    09410005
094200                                                                  09420005
094300     EXEC SQL                                                     09430005
094400          DECLARE TINPKSU-CSR CURSOR FOR                          09440005
094500          SELECT SHIPT_UNT_ID                                     09450005
094600          FROM   TINPKSU                                          09460005
094700          WHERE  PO_NBR       = :PKSLIP-PO-NBR                    09470005
094800            AND  SEQ_NBR      = :PKSLIP-SEQ-NBR                   09480005
094900     END-EXEC.                                                    09490005
095000                                                                  09500005
095100/                                                                 09510005
095200 LINKAGE SECTION.                                                 09520005
095300                                                                  09530005
095400 01  DFHCOMMAREA.                                                 09540005
095500     05  FILLER                       OCCURS  1 TO 4072 TIMES     09550005
095600                                      DEPENDING ON EIBCALEN.      09560005
095700         10  FILLER                   PIC X.                      09570005
095800                                                                  09580005
095900/                                                                 09590005
096000 PROCEDURE DIVISION.                                              09600005
096100                                                                  09610005
096200*----------------------------------------------------------------*09620005
096300*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *09630005
096400*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *09640005
096500*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *09650005
096600*                                                                *09660005
096700*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *09670005
096800*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *09680005
096900*----------------------------------------------------------------*09690005
097000 0000-MAIN-MODULE.                                                09700005
097100                                                                  09710005
097200     INITIALIZE DP030-CICS-API-FIELDS.                            09720005
097300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09730005
097400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09740005
097500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09750005
097600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09760005
097700     MOVE LENGTH OF RC214AI        TO DP030-MAP-LENGTH (1).       09770005
097800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09780005
097900     PERFORM 0001-CALL-CICS-ARCH-API.                             09790005
098000                                                                  09800005
098100     PERFORM 1000-CONTROL-PROCESSING.                             09810005
098200                                                                  09820005
098300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09830005
098400     PERFORM 0001-CALL-CICS-ARCH-API.                             09840005
098500                                                                  09850005
098600/                                                                 09860005
098700 0001-CALL-CICS-ARCH-API.                                         09870005
098800                                                                  09880005
098810     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09881098
099000                                    DFHCOMMAREA                   09900098
099100                                    DP030-CICS-API-FIELDS         09910098
099200                                    DP020-STANDARD-COMMAREA       09920098
099300                                    RC214AI.                      09930098
099400                                                                  09940005
099500     IF  DP030-RC-CALL-SUCCESSFUL                                 09950005
099600         CONTINUE                                                 09960005
099700     ELSE                                                         09970005
099800         SET DP013-NO-ROLLBACK                                    09980005
099900             DP013-XCTL-DISPLAY-RESTART                           09990005
100000             DP013-CICS-ABEND      TO TRUE                        10000005
100100         MOVE 'BEFORE 0000-MAIN-MODULE'                           10010005
100200                                   TO DP013-PARAGRAPH             10020005
100210         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10021098
100220-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10022098
100500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10050005
100600         PERFORM DP013-0000-PROCESS-ABEND                         10060005
100700     END-IF.                                                      10070005
100800                                                                  10080005
100900/                                                                 10090005
101000*----------------------------------------------------------------*10100005
101100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *10110005
101200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *10120005
101300*----------------------------------------------------------------*10130005
101400                                                                  10140005
101500 1000-CONTROL-PROCESSING.                                         10150005
101600                                                                  10160005
101700     EVALUATE TRUE                                                10170005
101800         WHEN DP020-NEXT-ACT-INITIAL                              10180005
101900              PERFORM 1100-PROCESS-INTER-APPL-COMM                10190005
102000              IF  PS-COMMAREA-NOT-VALID                           10200005
102100                  CONTINUE                                        10210005
102200              ELSE                                                10220005
102300                  INITIALIZE XL071-COMMAREA-REC                   10230026
102400                  MOVE DK-OPER-UNT-ID TO XL071-LOCATION-NUMBER    10240026
102500*IR-128A: DON'T ALLOW MAINT IF THE RECEIVER IS STATUS 'VE'        10250005
102600*DC-154:  OR 'CM' OR RECITM = 'VE'.  DISPLAY SCREEN PROTECTED.    10260005
102700                 PERFORM 1200-GET-TRECEIV-STATUS                  10270005
102800                 PERFORM 3300-CHK-OPER-UNT-GET-NAME               10280019
102900                 MOVE XL071-LOC-NM  TO ASC-KEY-FCLTY-NME          10290023
103000                                                                  10300075
103100*** BEGIN - DMH 1/7/08                                            10310075
103200                 MOVE XL071-LOC-TYP-CDE TO ASC-KEY-OPER-TYPE      10320075
103300*** END   - DMH 1/7/08                                            10330075
103400                                                                  10340075
103500                 IF  ASC-ADD-PENDING                              10350005
103600                     IF  NOT ASC-READ-ONLY                        10360005
103700                         IF  DK-FCLTY-ID EQUAL ZERO               10370005
103800                             SET ASC-READ-ONLY                    10380005
103900                                 PS-ERROR                         10390005
104000                                 DP020-MSG-FATAL                  10400005
104100                                 DP030-SET-CURSOR-TRAILER         10410005
104200                                 ASC-BAD-FCLTY TO TRUE            10420005
104300                         END-IF                                   10430005
104400                     END-IF                                       10440005
104500                     PERFORM 4500-BUILD-INITIAL-ADD-PANEL         10450005
104600                 ELSE                                             10460005
104700                     PERFORM 4000-BUILD-INITIAL-PANEL             10470005
104800                 END-IF                                           10480005
104900                 IF  PS-NO-ERROR                                  10490005
105000                     PERFORM 3200-RESET-ATTRIBUTES                10500005
105100                     PERFORM 3500-SAVE-SCREEN-FIELDS              10510005
105200                 END-IF                                           10520005
105300              END-IF                                              10530005
105400                                                                  10540005
105500         WHEN DP020-NEXT-ACT-READ-MAP                             10550005
105600              SET PS-NEXT-SCREEN TO TRUE                          10560005
105700              PERFORM 2000-PROCESS-PANEL                          10570005
105800                                                                  10580005
105900         WHEN DP020-NEXT-ACT-RETURN                               10590005
106000              PERFORM 3200-RESET-ATTRIBUTES                       10600005
106100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10610005
106200              PERFORM 3500-SAVE-SCREEN-FIELDS                     10620005
106300              IF ASC-ADD-PENDING                                  10630005
106400                  MOVE SPACES      TO ASC-PKSL-NBR-OLD            10640005
106500                  MOVE ZEROS       TO ASC-REC-SEQ-NBR-N-OLD       10650005
106600              END-IF                                              10660005
106700                                                                  10670005
106800         WHEN OTHER                                               10680005
106900              SET DP013-LOGIC-ABEND                               10690005
107000                  DP013-NO-ROLLBACK                               10700005
107100                                   TO TRUE                        10710005
107200              MOVE '1000-CONTROL-PROCESSING'                      10720005
107300                                   TO DP013-PARAGRAPH             10730005
107400              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  10740005
107500                                   TO DP013-MESSAGE-TEXT(1)       10750005
107600              MOVE DP020-NEXT-APPL-ACTIVITY                       10760005
107700                                   TO DP013-MESSAGE-TEXT(2)       10770005
107800              PERFORM DP013-0000-PROCESS-ABEND                    10780005
107900     END-EVALUATE.                                                10790005
108000                                                                  10800005
108100/                                                                 10810005
108200*----------------------------------------------------------------*10820005
108300*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *10830005
108400*    INTER-APPLICATION FORMAT CODE.                              *10840005
108500*                                                                *10850005
108600*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *10860005
108700*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *10870005
108800*----------------------------------------------------------------*10880005
108900 1100-PROCESS-INTER-APPL-COMM.                                    10890005
109000                                                                  10900005
109100     SET PS-COMMAREA-VALID         TO TRUE.                       10910005
109200                                                                  10920005
109300     INITIALIZE ASC-SPECIFIC-COMMAREA.                            10930005
109400                                                                  10940005
109500     EVALUATE DP020-INT-APPL-FORMAT-IND                           10950005
109600                                                                  10960005
109700* PERFORM PRE-EDITS WHEN ADDING, COMING FROM THE CRIT SPEC        10970005
109800         WHEN PC-INTER-APPL-CRIT-ADD                              10980005
109900                                                                  10990005
110000             SET ASC-NO-REC-B4-LOCAL TO TRUE                      11000005
110100             IF  PS-NO-ERROR                                      11010005
110200                 MOVE RC012-OPER-UNT-ID                           11020005
110300                                   TO DK-OPER-UNT-ID              11030005
110400                                      ASC-KEY-OPER-UNT-ID-N       11040005
110500                                      ASC-OPER-UNT-ID-N           11050005
110600                 MOVE RC012-FCLTY-ID                              11060005
110700                                   TO DK-FCLTY-ID                 11070005
110800                                      ASC-KEY-FCLTY-ID-N          11080005
110900                                      ASC-FCLTY-ID-N              11090005
111000                 MOVE RC012-PO-NBR TO DK-PO-NBR                   11100005
111100                                      ASC-KEY-PO-NBR-N            11110005
111200                                      ASC-PO-NBR-N                11120005
111300                                      PKSLIP-PO-NBR               11130005
111400                 MOVE SPACES       TO ASC-STR-DEST-NBR            11140005
111500                 MOVE -1           TO ASTRL                       11150005
111600                 MOVE RC012-PKSL-STAT-CDES                        11160005
111700                                   TO ASC-KEY-PKSL-STAT-CDES      11170005
111800                 MOVE RC012-REC-SEQ-NBR                           11180005
111900                                   TO ASC-KEY-REC-SEQ-NBR-N       11190005
112000                                      ASC-REC-SEQ-NBR-N           11200005
112100                 MOVE RC012-PKSL-NBR                              11210005
112200                                   TO ASC-KEY-PKSL-NBR            11220005
112300                                      ASC-PKSL-NBR                11230005
112400                 MOVE RC012-BOL-NBR                               11240005
112500                                   TO ASC-KEY-BOL-NBR             11250005
112600                                      ASC-BOL-NBR                 11260005
112700                 MOVE RC012-PRO-NBR                               11270005
112800                                   TO ASC-KEY-PRO-NBR             11280005
112900                                      ASC-PRO-NBR                 11290005
113000                 MOVE PC-IN        TO ASC-PKSL-STAT-CDE           11300005
113100                 MOVE PC-IN-DESC   TO ASC-PKSL-STAT-DESC          11310005
113200                 SET ASC-ADD-PENDING                              11320005
113300                                   TO TRUE                        11330005
113400                 SET DP030-SET-CURSOR-APPL-1                      11340005
113500                                   TO TRUE                        11350005
113600             END-IF                                               11360005
113700                                                                  11370005
113800* PERFORM PRE-EDITS WHEN UPDATING, COMING FROM THE CRIT SPEC      11380005
113900* PERFORM PRE-EDITS WHEN DELETING, COMING FROM THE CRIT SPEC      11390005
114000         WHEN PC-INTER-APPL-CRIT-UPD                              11400005
114100         WHEN PC-INTER-APPL-CRIT-DEL                              11410005
114200              MOVE RC012-PO-NBR    TO DK-PO-NBR                   11420005
114300                                      ASC-KEY-PO-NBR-N            11430005
114400                                      ASC-PO-NBR-N                11440005
114500              MOVE RC012-OPER-UNT-ID                              11450005
114600                                   TO DK-OPER-UNT-ID              11460005
114700                                      ASC-OPER-UNT-ID-N           11470005
114800                                      ASC-KEY-OPER-UNT-ID-N       11480005
114900              MOVE RC012-FCLTY-ID  TO DK-FCLTY-ID                 11490005
115000                                      ASC-FCLTY-ID-N              11500005
115100                                      ASC-KEY-FCLTY-ID-N          11510005
115200              MOVE RC012-REC-SEQ-NBR                              11520005
115300                                   TO ASC-KEY-REC-SEQ-NBR-N       11530005
115400              PERFORM 1130-SETUP-PKSLIP-KEYS                      11540005
115500              IF PS-MULTI-PKSLIP-FOUND                            11550005
115600                  MOVE PC-TSYMSG-00729                            11560005
115700                                   TO DP020-MSG-NUMBER            11570005
115800                  SET PS-ERROR                                    11580005
115900                      PS-COMMAREA-NOT-VALID                       11590005
116000                      DP020-NEXT-ACT-APPL-ERROR                   11600005
116100                      DP020-MSG-FATAL                             11610005
116200                                   TO TRUE                        11620005
116300              END-IF                                              11630005
116400              IF PS-PKSLIP-NOT-FOUND                              11640005
116500                  MOVE PC-TSYMSG-00730                            11650005
116600                                   TO DP020-MSG-NUMBER            11660005
116700                  SET PS-ERROR                                    11670005
116800                      PS-COMMAREA-NOT-VALID                       11680005
116900                      DP020-NEXT-ACT-APPL-ERROR                   11690005
117000                      DP020-MSG-FATAL                             11700005
117100                                   TO TRUE                        11710005
117200              END-IF                                              11720005
117300             IF PS-PKSL-STAT-ERROR                                11730005
117400                  MOVE PC-TSYMSG-00723                            11740005
117500                                   TO DP020-MSG-NUMBER            11750005
117600                  SET PS-ERROR                                    11760005
117700                      PS-COMMAREA-NOT-VALID                       11770005
117800                      DP020-NEXT-ACT-APPL-ERROR                   11780005
117900                      DP020-MSG-FATAL                             11790005
118000                                   TO TRUE                        11800005
118100              END-IF                                              11810005
118200                                                                  11820005
118300             IF PS-NO-ERROR                                       11830005
118400                 IF  PKSLIP-PKSL-STAT-CDE > SPACES                11840005
118500                     MOVE PKSLIP-PKSL-STAT-CDE                    11850005
118600                                   TO PV-PKSL-STAT-CDE            11860005
118700                                      ASC-PKSL-STAT-CDE           11870005
118800                     IF PV-PKSL-STAT-CDE-BEING-WORKED             11880005
118900                         SET DP020-MSG-FATAL                      11890005
119000                             DP030-SET-CURSOR-TRAILER             11900005
119100                             PS-ERROR                             11910005
119200                                   TO TRUE                        11920005
119300                         MOVE PC-TSYMSG-00724                     11930005
119400                                   TO DP020-MSG-NUMBER            11940005
119500                     END-IF                                       11950005
119600                     IF NOT PV-PKSL-STAT-CDE-INACTIVE             11960005
119700                         MOVE DP016-PF3 TO DP020-SRC-AID          11970005
119800                         SET DP020-MSG-FATAL                      11980005
119900                             DP030-SET-CURSOR-TRAILER             11990005
120000                             PS-ERROR                             12000005
120100                                   TO TRUE                        12010005
120200                         MOVE PC-TSYMSG-00723                     12020005
120300                                   TO DP020-MSG-NUMBER            12030005
120400                     END-IF                                       12040005
120500                 END-IF                                           12050005
120600             END-IF                                               12060005
120700                                                                  12070005
120800             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CRIT-UPD12080005
120900                 IF  PS-NO-ERROR                                  12090005
121000                     SET ASC-UPDATE-PENDING                       12100005
121100                                   TO TRUE                        12110005
121200                     MOVE -1       TO ASTRL                       12120005
121300                 END-IF                                           12130005
121400             END-IF                                               12140005
121500                                                                  12150005
121600             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CRIT-DEL12160005
121700                 IF  PS-NO-ERROR                                  12170005
121800                     MOVE PC-TSYMSG-00004                         12180005
121900                                   TO DP020-MSG-NUMBER            12190005
122000                     SET ASC-DELETE-PENDING                       12200005
122100                         DP020-MSG-INFORMATIONAL                  12210005
122200                                   TO TRUE                        12220005
122300                 END-IF                                           12230005
122400             END-IF                                               12240005
122500                                                                  12250005
122600* ON AN ADD FROM THE LIST SCREEN, JUST DISPLAY AN EMPTY SCREEN    12260005
122700         WHEN PC-INTER-APPL-LIST-ADD                              12270005
122800             SET ASC-NO-REC-B4-LOCAL TO TRUE                      12280005
122900             SET DP030-SET-CURSOR-APPL-1                          12290005
123000                 ASC-USE-SELECTION-QUEUE                          12300005
123100                 ASC-ADD-PENDING   TO TRUE                        12310005
123200             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  12320005
123300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS12330005
123400             MOVE RC015-NUMBER-OF-TS-ITEMS                        12340005
123500                                   TO ASC-NUMBER-OF-TS-ITEMS      12350005
123600             MOVE RC015-SEL-QUEUE-NAME                            12360005
123700                                   TO ASC-SEL-QUEUE-NAME          12370005
123800             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             12380005
123900                 IF RC015-REC-SEQ-NBR > ZEROS                     12390005
124000                     MOVE RC015-REC-SEQ-NBR                       12400005
124100                                   TO ASC-REC-SEQ-NBR-N           12410005
124200                                      ASC-KEY-REC-SEQ-NBR-N       12420005
124300                                      DK-REC-SEQ-NBR              12430005
124400                 ELSE                                             12440005
124500                     MOVE SPACES   TO ASC-REC-SEQ-NBR             12450005
124600                                      ASC-KEY-REC-SEQ-NBR         12460005
124700                 END-IF                                           12470005
124800             ELSE                                                 12480005
124900                 PERFORM 1120-PREPARE-LIST-ENTRY                  12490005
125000             END-IF                                               12500005
125100             MOVE RC015-OPER-UNT-ID                               12510005
125200                                   TO ASC-KEY-OPER-UNT-ID-N       12520005
125300                                      ASC-OPER-UNT-ID-N           12530005
125400                                      DK-OPER-UNT-ID              12540005
125500             MOVE RC015-FCLTY-ID   TO ASC-KEY-FCLTY-ID-N          12550005
125600                                      ASC-FCLTY-ID-N              12560005
125700                                      DK-FCLTY-ID                 12570005
125800             MOVE -1               TO APOL                        12580005
125900             MOVE RC015-PO-NBR     TO ASC-KEY-PO-NBR-N            12590005
126000                                      ASC-PO-NBR-N                12600005
126100             MOVE SPACES           TO ASC-STR-DEST-NBR            12610005
126200             MOVE ASC-KEY-REC-SEQ-NBR                             12620005
126300                                   TO ASC-REC-SEQ-NBR             12630005
126400             MOVE ASC-KEY-BOL-NBR  TO ASC-BOL-NBR                 12640005
126500             MOVE ASC-KEY-PRO-NBR  TO ASC-PRO-NBR                 12650005
126600             MOVE PC-IN            TO ASC-PKSL-STAT-CDE           12660005
126700             MOVE PC-IN-DESC       TO ASC-PKSL-STAT-DESC          12670005
126800                                                                  12680005
126900* PERFORM PRE-EDITS WHEN UPDATING, COMING FROM A LIST SCREEN      12690005
127000* PERFORM PRE-EDITS WHEN DELETING, COMING FROM A LIST SCREEN      12700005
127100         WHEN PC-INTER-APPL-LIST-UPD                              12710005
127200         WHEN PC-INTER-APPL-LIST-DEL                              12720005
127300             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             12730005
127400                 SET DP020-NEXT-ACT-APPL-ERROR                    12740005
127500                     DP030-OVERRIDE-GO                            12750005
127600                     DP020-MSG-WARNING                            12760005
127700                     PS-ERROR                                     12770005
127800                     PS-COMMAREA-NOT-VALID                        12780005
127900                                   TO TRUE                        12790005
128000                 MOVE PC-TSYMSG-00057                             12800005
128100                                   TO DP020-MSG-NUMBER            12810005
128200             ELSE                                                 12820005
128300                 SET ASC-USE-SELECTION-QUEUE                      12830005
128400                     DP030-SET-CURSOR-APPL-1                      12840005
128500                                   TO TRUE                        12850005
128600                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              12860005
128700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS12870005
128800                 MOVE RC015-NUMBER-OF-TS-ITEMS                    12880005
128900                                   TO ASC-NUMBER-OF-TS-ITEMS      12890005
129000                 MOVE RC015-SEL-QUEUE-NAME                        12900005
129100                                   TO ASC-SEL-QUEUE-NAME          12910005
129200                 PERFORM 1120-PREPARE-LIST-ENTRY                  12920005
129300                 MOVE RC015-FCLTY-ID                              12930005
129400                                   TO ASC-KEY-FCLTY-ID-N          12940005
129500                                      ASC-FCLTY-ID-N              12950005
129600                                      DK-FCLTY-ID                 12960005
129700                                      DK-FCLTY-ID-B               12970005
129800                                      DK-FCLTY-ID-E               12980005
129900                 MOVE RC015-PO-NBR TO ASC-PO-NBR-N                12990005
130000                                      ASC-KEY-PO-NBR-N            13000005
130100                                      DK-PO-NBR                   13010005
130200                 PERFORM 1140-CHECK-DUPL-PKSLIP                   13020005
130300                 IF PS-PKSL-STAT-ERROR                            13030005
130400                     MOVE PC-TSYMSG-00723                         13040005
130500                                   TO DP020-MSG-NUMBER            13050005
130600                      SET PS-ERROR                                13060005
130700                          PS-COMMAREA-NOT-VALID                   13070005
130800                          DP020-NEXT-ACT-APPL-ERROR               13080005
130900                          DP020-MSG-FATAL                         13090005
131000                                   TO TRUE                        13100005
131100                 END-IF                                           13110005
131200                                                                  13120005
131300             END-IF                                               13130005
131400                                                                  13140005
131500             IF  PS-NO-ERROR                                      13150005
131600                 IF DP020-INT-APPL-FORMAT-IND =                   13160005
131700                    PC-INTER-APPL-LIST-UPD                        13170005
131800                     SET ASC-UPDATE-PENDING                       13180005
131900                                   TO TRUE                        13190005
132000                 ELSE                                             13200005
132100                     MOVE PC-TSYMSG-00004                         13210005
132200                                   TO DP020-MSG-NUMBER            13220005
132300                     SET ASC-DELETE-PENDING                       13230005
132400                     DP020-MSG-INFORMATIONAL                      13240005
132500                                   TO TRUE                        13250005
132600                 END-IF                                           13260005
132700             END-IF                                               13270005
132800                                                                  13280005
132900* PERFORM PRE-EDITS WHEN COPYING, COMING FROM A FLAT SCREEN       13290005
133000         WHEN PC-INTER-APPL-CRIT-COPY                             13300005
133100              MOVE RC012-PO-NBR    TO DK-PO-NBR                   13310005
133200                                      ASC-KEY-PO-NBR-N            13320005
133300                                      ASC-PO-NBR-N                13330005
133400              MOVE RC012-OPER-UNT-ID                              13340005
133500                                   TO DK-OPER-UNT-ID              13350005
133600                                      ASC-OPER-UNT-ID-N           13360005
133700                                      ASC-KEY-OPER-UNT-ID-N       13370005
133800              MOVE RC012-FCLTY-ID  TO DK-FCLTY-ID                 13380005
133900                                      ASC-FCLTY-ID-N              13390005
134000                                      ASC-KEY-FCLTY-ID-N          13400005
134100              MOVE RC012-REC-SEQ-NBR                              13410005
134200                                   TO ASC-KEY-REC-SEQ-NBR-N       13420005
134300                                      DK-REC-SEQ-NBR-B            13430005
134400                                      DK-REC-SEQ-NBR-E            13440005
134500                                      DK-REC-SEQ-NBR              13450005
134600              MOVE RC012-SEQ-NBR                                  13460005
134700                                   TO ASC-KEY-SEQ-NBR-N           13470005
134800                                      DK-SEQ-NBR-B                13480005
134900                                      DK-SEQ-NBR-E                13490005
135000                                      DK-SEQ-NBR                  13500005
135100             PERFORM 1140-CHECK-DUPL-PKSLIP                       13510005
135200             IF PS-PKSL-STAT-ERROR                                13520005
135300                 MOVE PC-TSYMSG-00723                             13530005
135400                                   TO DP020-MSG-NUMBER            13540005
135500                 SET PS-ERROR                                     13550005
135600                     PS-COMMAREA-NOT-VALID                        13560005
135700                     DP020-NEXT-ACT-APPL-ERROR                    13570005
135800                     DP020-MSG-FATAL                              13580005
135900                                   TO TRUE                        13590005
136000             ELSE                                                 13600005
136100                 IF PS-NO-ERROR                                   13610005
136200                     SET ASC-COPY-PENDING                         13620005
136300                                   TO TRUE                        13630005
136400                 END-IF                                           13640005
136500             END-IF                                               13650005
136600                                                                  13660005
136700* PERFORM PRE-EDITS WHEN COPYING, COMING FROM A LIST SCREEN       13670005
136800         WHEN PC-INTER-APPL-LIST-COPY                             13680005
136900             IF  RC015-NUMBER-OF-SELECTED-ITEMS NOT = 1           13690005
137000                 SET DP020-NEXT-ACT-APPL-ERROR                    13700005
137100                     DP030-OVERRIDE-GO                            13710005
137200                     DP020-MSG-WARNING                            13720005
137300                     PS-ERROR                                     13730005
137400                     PS-COMMAREA-NOT-VALID                        13740005
137500                                   TO TRUE                        13750005
137600                 IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO         13760005
137700                     MOVE PC-TSYMSG-00057                         13770005
137800                                   TO DP020-MSG-NUMBER            13780005
137900                 ELSE                                             13790005
138000                     MOVE PC-TSYMSG-00047                         13800005
138100                                   TO DP020-MSG-NUMBER            13810005
138200                 END-IF                                           13820005
138300             ELSE                                                 13830005
138400                 SET ASC-USE-SELECTION-QUEUE                      13840005
138500                                   TO TRUE                        13850005
138600                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              13860005
138700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13870005
138800                 MOVE RC015-NUMBER-OF-TS-ITEMS                    13880005
138900                                   TO ASC-NUMBER-OF-TS-ITEMS      13890005
139000                 MOVE RC015-SEL-QUEUE-NAME                        13900005
139100                                   TO ASC-SEL-QUEUE-NAME          13910005
139200                 PERFORM 1120-PREPARE-LIST-ENTRY                  13920005
139300                 MOVE RC015-FCLTY-ID                              13930005
139400                                   TO ASC-KEY-FCLTY-ID-N          13940005
139500                                      ASC-FCLTY-ID-N              13950005
139600                                      DK-FCLTY-ID                 13960005
139700                                      DK-FCLTY-ID-B               13970005
139800                                      DK-FCLTY-ID-E               13980005
139900                 MOVE RC015-PO-NBR TO ASC-PO-NBR-N                13990005
140000                                      ASC-KEY-PO-NBR-N            14000005
140100                                      DK-PO-NBR                   14010005
140200                 PERFORM 1140-CHECK-DUPL-PKSLIP                   14020005
140300                 IF  PS-NO-ERROR                                  14030005
140400                     SET ASC-COPY-PENDING                         14040005
140500                                   TO TRUE                        14050005
140600                 END-IF                                           14060005
140700             END-IF                                               14070005
140800                                                                  14080005
140900         WHEN OTHER                                               14090005
141000             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            14100005
141100             SET PS-ERROR                                         14110005
141200                 PS-COMMAREA-NOT-VALID                            14120005
141300                 DP020-MSG-FATAL                                  14130005
141400                 DP020-NEXT-ACT-APPL-ERROR                        14140005
141500                                   TO TRUE                        14150005
141600                                                                  14160005
141700     END-EVALUATE.                                                14170005
141800                                                                  14180005
141900/                                                                 14190005
142000*----------------------------------------------------------------*14200005
142100*    ENTRY IS FROM A LIST.  GET THE PO NUMBER FROM THE           *14210005
142200*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *14220005
142300*----------------------------------------------------------------*14230005
142400 1120-PREPARE-LIST-ENTRY.                                         14240005
142500                                                                  14250005
142600     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                14260005
142700     MOVE ZERO                     TO ASC-SEL-ITEM.               14270005
142800                                                                  14280005
142900     PERFORM 2110-GET-NEXT-PACK-SLIP.                             14290005
143000                                                                  14300005
143100 1130-SETUP-PKSLIP-KEYS.                                          14310005
143200                                                                  14320005
143300     IF RC012-OPER-UNT-ID > ZERO                                  14330005
143400         MOVE RC012-OPER-UNT-ID    TO DK-OPER-UNT-ID-B            14340005
143500                                      DK-OPER-UNT-ID-E            14350005
143600                                      ASC-OPER-UNT-ID-N           14360005
143700     END-IF.                                                      14370005
143800                                                                  14380005
143900     IF RC012-FCLTY-ID > ZERO                                     14390005
144000         MOVE RC012-FCLTY-ID       TO DK-FCLTY-ID-B               14400005
144100                                      DK-FCLTY-ID-E               14410005
144200                                      ASC-FCLTY-ID-N              14420005
144300     END-IF.                                                      14430005
144400                                                                  14440005
144500     IF RC012-REC-SEQ-NBR > ZEROES                                14450005
144600         MOVE RC012-REC-SEQ-NBR    TO DK-REC-SEQ-NBR-B            14460005
144700                                      DK-REC-SEQ-NBR-E            14470005
144800                                      DK-REC-SEQ-NBR              14480005
144900     END-IF.                                                      14490005
145000                                                                  14500005
145100     IF RC012-PKSL-NBR > SPACES                                   14510005
145200         MOVE RC012-PKSL-NBR       TO DK-PKSL-NBR-B               14520005
145300                                      DK-PKSL-NBR-E               14530005
145400     END-IF.                                                      14540005
145500                                                                  14550005
145600     IF RC012-BOL-NBR > SPACES                                    14560005
145700         MOVE RC012-BOL-NBR        TO DK-BOL-NBR-B                14570005
145800                                      DK-BOL-NBR-E                14580005
145900     END-IF.                                                      14590005
146000                                                                  14600005
146100     IF RC012-PRO-NBR > SPACES                                    14610005
146200         MOVE RC012-PRO-NBR        TO DK-PRO-NBR-B                14620005
146300                                      DK-PRO-NBR-E                14630005
146400     END-IF.                                                      14640005
146500                                                                  14650005
146600     PERFORM 1140-CHECK-DUPL-PKSLIP.                              14660005
146700                                                                  14670005
146800 1140-CHECK-DUPL-PKSLIP.                                          14680005
146900                                                                  14690005
147000                                                                  14700005
147100         EXEC SQL                                                 14710005
147200            SELECT  PO_NBR,                                       14720005
147300                    SEQ_NBR,                                      14730005
147400                    MONTH (CRE_TMST),                             14740005
147500                    DAY   (CRE_TMST),                             14750005
147600                    YEAR  (CRE_TMST),                             14760005
147700                    HOUR  (CRE_TMST),                             14770005
147800                    MINUTE(CRE_TMST),                             14780005
147900                    OPER_UNT_ID,                                  14790005
148000                    FCLTY_ID,                                     14800005
148100                    PKSL_NBR,                                     14810005
148200                    STR_DEST_NBR,                                 14820005
148300                    REC_SEQ_NBR,                                  14830005
148400                    BOL_NBR,                                      14840005
148500                    PRO_NBR,                                      14850005
148600                    PKSL_STAT_CDE,                                14860005
148700                    CRE_UID,                                      14870005
148800                    CRE_SRC_CDE,                                  14880005
148900                    EXPTED_PKG_QTY,                               14890005
149000                    OWNER_SCAC_ID,                                14900005
149100                    ASN_NBR,                                      14910005
149200                    VEND_SHIP_DTE,                                14920005
149300                    SHIPT_ID,                                     14930005
149400                    PKSL_PG_CNT,                                  14940005
149500                    CONTNR_ID                                     14950005
149600              INTO :PKSLIP-PO-NBR,                                14960005
149700                   :ASC-SEQ-NBR,                                  14970005
149800                   :PV-DB2-MONTH,                                 14980005
149900                   :PV-DB2-DAY,                                   14990005
150000                   :PV-DB2-YEAR,                                  15000005
150100                   :PV-DB2-HOUR,                                  15010005
150200                   :PV-DB2-MINUTE,                                15020005
150300                   :PKSLIP-OPER-UNT-ID,                           15030005
150400                   :PKSLIP-FCLTY-ID,                              15040005
150500                   :PKSLIP-PKSL-NBR,                              15050005
150600                   :PKSLIP-STR-DEST-NBR,                          15060005
150700                   :PKSLIP-REC-SEQ-NBR,                           15070005
150800                   :PKSLIP-BOL-NBR,                               15080005
150900                   :PKSLIP-PRO-NBR,                               15090005
151000                   :PKSLIP-PKSL-STAT-CDE,                         15100005
151100                   :PKSLIP-CRE-UID,                               15110005
151200                   :PKSLIP-CRE-SRC-CDE,                           15120005
151300                   :PKSLIP-EXPTED-PKG-QTY,                        15130005
151400                   :PKSLIP-OWNER-SCAC-ID,                         15140005
151500                   :PKSLIP-ASN-NBR,                               15150005
151600                   :PKSLIP-VEND-SHIP-DTE,                         15160005
151700                   :PKSLIP-SHIPT-ID,                              15170005
151800                   :PKSLIP-PKSL-PG-CNT,                           15180005
151900                   :PKSLIP-CONTNR-ID                              15190005
152000              FROM  TPKSLIP                                       15200005
152100             WHERE PO_NBR              = :DK-PO-NBR               15210005
152200               AND SEQ_NBR       BETWEEN :DK-SEQ-NBR-B            15220005
152300                                     AND :DK-SEQ-NBR-E            15230005
152400               AND VER_STAT_CDE        = 'A'                      15240005
152500                                                                  15250005
152600               AND OPER_UNT_ID   BETWEEN :DK-OPER-UNT-ID-B        15260005
152700                                     AND :DK-OPER-UNT-ID-E        15270005
152800               AND FCLTY_ID      BETWEEN :DK-FCLTY-ID-B           15280005
152900                                     AND :DK-FCLTY-ID-E           15290005
153000               AND REC_SEQ_NBR   BETWEEN :DK-REC-SEQ-NBR-B        15300005
153100                                     AND :DK-REC-SEQ-NBR-E        15310005
153200               AND PKSL_NBR      BETWEEN :DK-PKSL-NBR-B           15320005
153300                                     AND :DK-PKSL-NBR-E           15330005
153400               AND BOL_NBR       BETWEEN :DK-BOL-NBR-B            15340005
153500                                     AND :DK-BOL-NBR-E            15350005
153600               AND PRO_NBR       BETWEEN :DK-PRO-NBR-B            15360005
153700                                     AND :DK-PRO-NBR-E            15370005
153800               AND STR_DEST_NBR  BETWEEN :DK-STR-DEST-NBR-B       15380005
153900                                     AND :DK-STR-DEST-NBR-E       15390005
154000         END-EXEC                                                 15400005
154100                                                                  15410005
154200         EVALUATE TRUE                                            15420005
154300             WHEN SQLCODE = +0                                    15430005
154400                 SET PS-PKSLIP-FOUND                              15440005
154500                                   TO TRUE                        15450005
154600                 IF (DP020-INT-APPL-FORMAT-IND =                  15460005
154700                                  PC-INTER-APPL-LIST-DEL          15470005
154800                         OR DP020-INT-APPL-FORMAT-IND =           15480005
154900                                  PC-INTER-APPL-CRIT-DEL          15490005
155000                         OR DP020-INT-APPL-FORMAT-IND =           15500005
155100                                  PC-INTER-APPL-CRIT-COPY)        15510005
155200                         AND (PKSLIP-PKSL-STAT-CDE = 'AC')        15520005
155300                     SET PS-PKSL-STAT-ERROR TO TRUE               15530005
155400                     SET PS-ERROR           TO TRUE               15540005
155500                 END-IF                                           15550005
155600                                                                  15560005
155700             WHEN SQLCODE = +100                                  15570005
155800                 SET PS-PKSLIP-NOT-FOUND                          15580005
155900                                   TO TRUE                        15590005
156000             WHEN SQLCODE = -811                                  15600005
156100                 SET PS-MULTI-PKSLIP-FOUND                        15610005
156200                                   TO TRUE                        15620005
156300                                                                  15630005
156400             WHEN SQLCODE = -904                                  15640005
156500             WHEN SQLCODE = -911                                  15650005
156600             WHEN SQLCODE = -913                                  15660005
156700                 PERFORM 9900-SOFT-ABORT                          15670005
156800                                                                  15680005
156900             WHEN SQLWARN0 NOT = SPACES                           15690005
157000             WHEN SQLCODE < +0                                    15700005
157100             WHEN SQLCODE > +0                                    15710005
157200                 MOVE '1130-CHECK-DUPL-PKSLIP'                    15720005
157300                                   TO DP013-PARAGRAPH             15730005
157400                 MOVE 'CHECK IF SELECTION CRITERIA OK'            15740005
157500                                   TO DP013-MESSAGE-TEXT (1)      15750005
157600                 MOVE SQLCA        TO DP013-SQLCA                 15760005
157700                 MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)    15770005
157800                 SET DP013-DB2-ABEND                              15780005
157900                                   TO TRUE                        15790005
158000                 SET DP013-XCTL-DISPLAY-RESTART                   15800005
158100                                   TO TRUE                        15810005
158200                 PERFORM DP013-0000-PROCESS-ABEND                 15820005
158300         END-EVALUATE.                                            15830005
158400                                                                  15840005
158500/                                                                 15850005
158600*----------------------------------------------------------------*15860005
158700*    GET THE STATUS CODE OF THE RECEIVER WE ARE WORKING WITH     *15870005
158800*----------------------------------------------------------------*15880005
158900                                                                  15890005
159000 1200-GET-TRECEIV-STATUS.                                         15900005
159100                                                                  15910005
159200     EXEC SQL                                                     15920005
159300          SELECT                                                  15930005
159400                 STATUS_CDE                                       15940005
159500               , ML_POST_TMST                                     15950005
159600               , FS_POST_TMST                                     15960005
159700           INTO                                                   15970005
159800                :RECEIV-STATUS-CDE                                15980005
159900              , :RECEIV-ML-POST-TMST                              15990005
160000              , :RECEIV-FS-POST-TMST                              16000005
160100           FROM                                                   16010005
160200                 TRECEIV                                          16020005
160300          WHERE  ORD_NBR          =  :DK-PO-NBR                   16030005
160400            AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              16040005
160500            AND  VER_STATUS_CDE   =  :PC-ACTIVE                   16050005
160600            AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID              16060005
160700            AND  FCLTY_ID         =  :DK-FCLTY-ID                 16070005
160800     END-EXEC.                                                    16080005
160900                                                                  16090005
161000     EVALUATE TRUE                                                16100005
161100         WHEN SQLCODE = ZERO                                      16110005
161200              IF  RECEIV-STATUS-CDE = PC-VE                       16120005
161300                  CONTINUE                                        16130005
161400              ELSE                                                16140005
161500                  PERFORM 1300-SELECT-VERIFIED-RECITM             16150005
161600              END-IF                                              16160005
161700         WHEN SQLCODE = +100                                      16170005
161800              CONTINUE                                            16180005
161900         WHEN SQLCODE = -904                                      16190005
162000         WHEN SQLCODE = -911                                      16200005
162100         WHEN SQLCODE = -913                                      16210005
162200              PERFORM 9900-SOFT-ABORT                             16220005
162300                                                                  16230005
162400         WHEN SQLWARN0 NOT = SPACES                               16240005
162500         WHEN SQLCODE  NOT = ZERO                                 16250005
162600              MOVE '1200-GET-TRECEIV-STATUS'                      16260005
162700                                 TO DP013-PARAGRAPH               16270005
162800              MOVE 'UNSUCCESSFUL SELECT OF TRECIEV'               16280005
162900                                 TO DP013-MESSAGE-TEXT (1)        16290005
163000              MOVE SQLCA         TO DP013-SQLCA                   16300005
163100              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      16310005
163200              SET DP013-DB2-ABEND                                 16320005
163300                  DP013-XCTL-DISPLAY-RESTART                      16330005
163400                                 TO TRUE                          16340005
163500              PERFORM DP013-0000-PROCESS-ABEND                    16350005
163600     END-EVALUATE.                                                16360005
163700                                                                  16370005
163800 1300-SELECT-VERIFIED-RECITM.                                     16380005
163900                                                                  16390005
164000                                                                  16400005
164100         EXEC SQL                                                 16410005
164200             SELECT STATUS_CDE                                    16420005
164300               INTO :RECITM-STATUS-CDE                            16430005
164400               FROM TRECITM                                       16440005
164500              WHERE ORD_NBR         = :DK-PO-NBR                  16450005
164600                AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR             16460005
164700                AND VER_STATUS_CDE  = :PC-ACTIVE                  16470005
164800                AND OPER_UNT_ID     = :DK-OPER-UNT-ID             16480005
164900                AND FCLTY_ID        = :DK-FCLTY-ID                16490005
165000                AND STATUS_CDE      = :PC-VE                      16500005
165100         END-EXEC                                                 16510005
165200                                                                  16520005
165300         EVALUATE TRUE                                            16530005
165400             WHEN SQLCODE = ZERO                                  16540005
165500             WHEN SQLCODE = -811                                  16550005
165600                  SET PS-RECITM-VERIFIED                          16560005
165700                                 TO TRUE                          16570005
165800             WHEN SQLCODE = +100                                  16580005
165900                  SET PS-RECITM-NOT-VERIFIED                      16590005
166000                                 TO TRUE                          16600005
166100             WHEN SQLCODE = -904                                  16610005
166200             WHEN SQLCODE = -911                                  16620005
166300             WHEN SQLCODE = -913                                  16630005
166400                  PERFORM 9900-SOFT-ABORT                         16640005
166500                                                                  16650005
166600             WHEN SQLWARN0 NOT = SPACES                           16660005
166700             WHEN SQLCODE  NOT = ZERO                             16670005
166800                  MOVE '1300-SELECT-VERIFIED-RECITM'              16680005
166900                                 TO DP013-PARAGRAPH               16690005
167000                  MOVE 'UNSUCCESSFUL SELECT OF TRECITM'           16700005
167100                                 TO DP013-MESSAGE-TEXT (1)        16710005
167200                  MOVE SQLCA     TO DP013-SQLCA                   16720005
167300                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      16730005
167400                  SET DP013-DB2-ABEND                             16740005
167500                      DP013-XCTL-DISPLAY-RESTART                  16750005
167600                                 TO TRUE                          16760005
167700                  PERFORM DP013-0000-PROCESS-ABEND                16770005
167800         END-EVALUATE.                                            16780005
167900/                                                                 16790005
168000*----------------------------------------------------------------*16800005
168100*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*16810005
168200*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*16820005
168300*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *16830005
168400*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *16840005
168500*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *16850005
168600*----------------------------------------------------------------*16860005
168700                                                                  16870005
168800 2000-PROCESS-PANEL.                                              16880005
168900                                                                  16890005
169000     EVALUATE TRUE                                                16900005
169100                                                                  16910005
169200         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    16920005
169300             IF ASC-ADD-PENDING    OR                             16930005
169400                ASC-UPDATE-PENDING OR                             16940005
169500                ASC-COPY-PENDING                                  16950005
169600                 PERFORM 2100-CHECK-FUNCTION-KEY                  16960005
169700             ELSE                                                 16970005
169800                 IF  ASC-DELETE-SUCCESSFUL                        16980005
169900                     MOVE PC-TSYMSG-00116                         16990005
170000                                       TO DP020-MSG-NUMBER        17000005
170100                     SET DP020-MSG-FATAL                          17010005
170200                         PS-ERROR      TO TRUE                    17020005
170300                     PERFORM 3200-RESET-ATTRIBUTES                17030005
170400                 ELSE                                             17040005
170500                     SET DP030-CONTINUE-GO                        17050005
170600                                       TO TRUE                    17060005
170700                     PERFORM 7000-DELETE-PACK-SLIP                17070005
170800                 END-IF                                           17080005
170900            END-IF                                                17090005
171000                                                                  17100005
171100         WHEN DP020-SRC-AID = DP016-CLEAR                         17110005
171200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17120005
171300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17130005
171400*F5                                                               17140056
171500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     17150005
171600             IF  ASC-DELETE-SUCCESSFUL                            17160005
171700                 MOVE PC-TSYMSG-00116                             17170005
171800                                   TO DP020-MSG-NUMBER            17180005
171900                 SET DP030-DONT-ERASE                             17190005
172000                     DP030-SEND-DATAONLY (PC-APPL-MAP)            17200005
172100                     DP020-MSG-FATAL                              17210005
172200                                   TO TRUE                        17220005
172300             ELSE                                                 17230005
172400                 INITIALIZE ASC-SCREEN-FIELDS                     17240005
172500                 SET DP030-SET-CURSOR-APPL-1                      17250005
172600                                   TO TRUE                        17260005
172700                 MOVE -1           TO APOL                        17270005
172800                 MOVE ASC-KEY-PO-NBR-N                            17280005
172900                                   TO DK-PO-NBR                   17290005
173000                                      ASC-PO-NBR-N                17300005
173100                 MOVE ASC-KEY-OPER-UNT-ID-N                       17310005
173200                                   TO DK-OPER-UNT-ID              17320005
173300                                      DK-OPER-UNT-ID-B            17330005
173400                                      DK-OPER-UNT-ID-E            17340005
173500                                      ASC-OPER-UNT-ID-N           17350005
173600                 MOVE ASC-KEY-FCLTY-ID-N                          17360005
173700                                   TO DK-FCLTY-ID                 17370005
173800                                      DK-FCLTY-ID-B               17380005
173900                                      DK-FCLTY-ID-E               17390005
174000                                      ASC-FCLTY-ID-N              17400005
174100                 IF (ASC-ADD-PENDING                              17410005
174200                 AND ASC-ADD-NOT-SUCCESSFUL)                      17420005
174300                     MOVE ASC-KEY-REC-SEQ-NBR                     17430005
174400                                   TO ASC-REC-SEQ-NBR             17440005
174500                     MOVE ASC-KEY-BOL-NBR                         17450005
174600                                   TO ASC-BOL-NBR                 17460005
174700                     MOVE ASC-KEY-PRO-NBR                         17470005
174800                                   TO ASC-PRO-NBR                 17480005
174900                     MOVE ASC-KEY-PKSL-NBR                        17490005
175000                                   TO ASC-PKSL-NBR                17500005
175100                     MOVE PC-IN    TO ASC-PKSL-STAT-CDE           17510005
175200                     MOVE PC-IN-DESC                              17520005
175300                                   TO ASC-PKSL-STAT-DESC          17530005
175400                     PERFORM 4500-BUILD-INITIAL-ADD-PANEL         17540005
175500                 ELSE                                             17550005
175600                     MOVE ASC-SEQ-NBR                             17560005
175700                                   TO DK-SEQ-NBR-B                17570005
175800                                      DK-SEQ-NBR-E                17580005
175900                     PERFORM 1140-CHECK-DUPL-PKSLIP               17590005
176000                     PERFORM 4000-BUILD-INITIAL-PANEL             17600005
176100                 END-IF                                           17610005
176200                 PERFORM 3200-RESET-ATTRIBUTES                    17620005
176300                 PERFORM 3500-SAVE-SCREEN-FIELDS                  17630005
176400             END-IF                                               17640005
176500*F20                                                              17650056
176600         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             17660005
176700             IF  ASC-USE-SELECTION-QUEUE                          17670005
176800                 PERFORM 2110-GET-NEXT-PACK-SLIP                  17680005
176900                 IF PS-LIST-END                                   17690005
177000                    SET PS-NO-LIST-END                            17700005
177100                                   TO TRUE                        17710005
177200                 ELSE                                             17720005
177300                    MOVE ASC-KEY-PO-NBR-N                         17730005
177400                                   TO DK-PO-NBR                   17740005
177500                    MOVE ASC-KEY-OPER-UNT-ID-N                    17750005
177600                                   TO DK-OPER-UNT-ID              17760005
177700                    MOVE ASC-KEY-FCLTY-ID-N                       17770005
177800                                   TO DK-FCLTY-ID                 17780005
177900                    PERFORM 1140-CHECK-DUPL-PKSLIP                17790005
178000                    PERFORM 4000-BUILD-INITIAL-PANEL              17800005
178100                    PERFORM 3200-RESET-ATTRIBUTES                 17810005
178200                    MOVE SPACES    TO ASC-DELETE-SUCCESSFUL-SW    17820005
178300*LMM                                                              17830044
178400                    IF  PS-NO-ERROR                               17840044
178500                        IF ASC-DELETE-PENDING                     17850059
178600                           MOVE PC-TSYMSG-00004                   17860057
178700                                      TO DP020-MSG-NUMBER         17870044
178800                           SET ASC-DELETE-PENDING                 17880057
178900                               DP020-MSG-INFORMATIONAL            17890057
179000                                      TO TRUE                     17900044
179100                        ELSE                                      17910057
179200                           CONTINUE                               17920057
179300                        END-IF                                    17930057
179400                    END-IF                                        17940044
179500                 END-IF                                           17950005
179600             ELSE                                                 17960005
179700*                --- BOTTOM OF LIST ---                           17970005
179800                 MOVE PC-TSYMSG-00070                             17980005
179900                                   TO DP020-MSG-NUMBER            17990005
180000                 SET DP020-MSG-INFORMATIONAL                      18000005
180100                     PS-LIST-END   TO TRUE                        18010005
180200             END-IF                                               18020005
180300*F19                                                              18030056
180400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             18040005
180500             IF  ASC-USE-SELECTION-QUEUE                          18050005
180600                 PERFORM 2120-GET-PREV-PACK-SLIP                  18060005
180700                 IF PS-LIST-END                                   18070005
180800                    SET PS-NO-LIST-END                            18080005
180900                                   TO TRUE                        18090005
181000                 ELSE                                             18100005
181100                    MOVE ASC-KEY-PO-NBR-N                         18110005
181200                                   TO DK-PO-NBR                   18120005
181300                    MOVE ASC-KEY-OPER-UNT-ID-N                    18130005
181400                                   TO DK-OPER-UNT-ID              18140005
181500                    MOVE ASC-KEY-FCLTY-ID-N                       18150005
181600                                   TO DK-FCLTY-ID                 18160005
181700                    PERFORM 1140-CHECK-DUPL-PKSLIP                18170005
181800                    PERFORM 4000-BUILD-INITIAL-PANEL              18180005
181900                    PERFORM 3200-RESET-ATTRIBUTES                 18190005
182000                    MOVE SPACES    TO ASC-DELETE-SUCCESSFUL-SW    18200005
182100                 END-IF                                           18210005
182200             ELSE                                                 18220005
182300*                --- TOP OF LIST ---                              18230005
182400                 MOVE PC-TSYMSG-00069                             18240005
182500                                   TO DP020-MSG-NUMBER            18250005
182600                 SET DP020-MSG-INFORMATIONAL                      18260005
182700                     PS-LIST-END   TO TRUE                        18270005
182800             END-IF                                               18280005
182900                                                                  18290005
183000         WHEN ASC-READ-ONLY                                       18300005
183100              IF (DP020-SRC-AID EQUAL DP016-PF22                  18310005
183200              OR  DP020-SRC-AID EQUAL DP016-ENTER)                18320005
183300                  PERFORM 2101-SETUP-LOCAL-GOTO                   18330005
183400              ELSE                                                18340005
183500                  SET DP020-MSG-FATAL                             18350005
183600                      DP030-OVERRIDE-GO                           18360005
183700                      PS-ERROR    TO TRUE                         18370005
183800                  SET DP030-SET-CURSOR-TRAILER                    18380005
183900                                  TO TRUE                         18390005
184000                  MOVE PC-TSYMSG-00734                            18400005
184100                                  TO DP020-MSG-NUMBER             18410005
184200              END-IF                                              18420005
184300                                                                  18430005
184400                                                                  18440005
184500         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              18450005
184600             IF  ASC-COPY-PENDING                                 18460005
184700                 MOVE ASC-KEY-PO-NBR-N                            18470005
184800                                   TO RC012-PO-NBR                18480005
184900                 MOVE ASC-KEY-OPER-UNT-ID-N                       18490005
185000                                   TO RC012-OPER-UNT-ID           18500005
185100                 MOVE ASC-KEY-FCLTY-ID-N                          18510005
185200                                   TO RC012-FCLTY-ID              18520005
185300                 MOVE ASC-KEY-PKSL-STAT-CDES                      18530005
185400                                   TO RC012-PKSL-STAT-CDES        18540005
185500                 MOVE ASC-KEY-REC-SEQ-NBR-N                       18550005
185600                                   TO RC012-REC-SEQ-NBR           18560005
185700                 MOVE ASC-KEY-PKSL-NBR                            18570005
185800                                   TO RC012-PKSL-NBR              18580005
185900                 MOVE ASC-KEY-BOL-NBR                             18590005
186000                                   TO RC012-BOL-NBR               18600005
186100                 MOVE ASC-KEY-PRO-NBR                             18610005
186200                                   TO RC012-PRO-NBR               18620005
186300                                                                  18630005
186400                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             18640005
186500                 PERFORM 3200-RESET-ATTRIBUTES                    18650005
186600                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               18660005
186700                 IF  PS-NO-ERROR                                  18670005
186800                     SET DP030-CONTINUE-GO                        18680005
186900                                   TO TRUE                        18690005
187000                     PERFORM 8000-COPY-PACK-SLIP                  18700005
187100                 ELSE                                             18710005
187200                     SET DP030-OVERRIDE-GO                        18720005
187300                          TO TRUE                                 18730005
187400                 END-IF                                           18740005
187500             END-IF                                               18750005
187600                                                                  18760005
187700         WHEN OTHER                                               18770005
187800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18780005
187900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18790005
188000             IF  PS-NO-ERROR                                      18800005
188100                 SET DP030-CONTINUE-GO                            18810005
188200                                   TO TRUE                        18820005
188300                 PERFORM 2100-CHECK-FUNCTION-KEY                  18830005
188400             ELSE                                                 18840005
188500                 SET DP030-OVERRIDE-GO                            18850005
188600                                   TO TRUE                        18860005
188700             END-IF                                               18870005
188800     END-EVALUATE.                                                18880005
188900                                                                  18890005
189000/                                                                 18900005
189100*----------------------------------------------------------------*18910005
189200*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *18920005
189300*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*18930005
189400*    FROM THE CICS ARCHITECTURE API.                             *18940005
189500*----------------------------------------------------------------*18950005
189600                                                                  18960005
189700 2100-CHECK-FUNCTION-KEY.                                         18970005
189800                                                                  18980005
189900     EVALUATE TRUE                                                18990005
190000                                                                  19000005
190100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID) AND                19010005
190200              ASC-LOCAL-01-NEED-CONFIRM        AND                19020005
190300              ASC-ADD-PENDING                                     19030005
190400               SET DP030-CONTINUE-GO TO TRUE                      19040005
190500               SET ASC-RECORD-ADDED  TO TRUE                      19050005
190600               PERFORM 5000-ADD-PACK-SLIP-HEADER                  19060005
190700               SET ASC-LOCAL-01-NO-NEED-CONFIRM TO TRUE           19070005
190800                                                                  19080005
190900               MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                 19090005
191000               PERFORM 3012-SELECT-PO-TYP-CDE                     19100005
191100               IF PS-PO-TYP-CDE-FOUND AND                         19110005
191200                                       PC-IMPORT-EXT              19120005
191300                   MOVE DP015-UNP-ALP-NOR-OFF                     19130005
191400                                         TO ACONTNRA              19140005
191500                   MOVE DP015-GREEN      TO ACONTNRC              19150005
191600                   MOVE DP015-UNDERLINE  TO ACONTNRH              19160005
191700                   MOVE -1               TO ACONTNRL              19170005
191800               ELSE                                               19180005
191900                   MOVE DP015-PRO-NOR-OFF TO ACONTNRA             19190005
192000                   MOVE DP015-BLUE        TO ACONTNRC             19200005
192100                   MOVE DP015-HL-OFF      TO ACONTNRH             19210005
192200                   MOVE -1                TO ACONTNRL             19220005
192300                   MOVE SPACES            TO PKSLIP-CONTNR-ID     19230005
192400               END-IF                                             19240005
192500                                                                  19250005
192600         WHEN DP020-FK-CONFIRM (DP020-SRC-AID) AND                19260005
192700              ASC-LOCAL-02-NEED-CONFIRM        AND                19270005
192800              ASC-UPDATE-PENDING                                  19280005
192900               SET DP030-CONTINUE-GO TO TRUE                      19290005
193000               PERFORM 6000-UPDATE-PACK-SLIP                      19300005
193100               MOVE DP015-UNP-ALP-NOR-OFF                         19310005
193200                                     TO ACONTNRA                  19320005
193300               MOVE DP015-GREEN      TO ACONTNRC                  19330005
193400               MOVE DP015-UNDERLINE  TO ACONTNRH                  19340005
193500               MOVE -1               TO ACONTNRL                  19350005
193600               MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER          19360005
193700               SET DP020-MSG-INFORMATIONAL TO TRUE                19370005
193800               SET ASC-LOCAL-02-NO-NEED-CONFIRM TO TRUE           19380005
193900                                                                  19390005
194000         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    19400005
194100**IMPORTS ONLY - DOMESTIC DOESN'T HAVE A CONFIRM ON COPY          19410005
194200             IF  ASC-COPY-PENDING                                 19420005
194300                  PERFORM 2200-MOVE-SCREEN-TO-COMMAREA            19430005
194400                  PERFORM 3200-RESET-ATTRIBUTES                   19440005
194500                  SET DP030-CONTINUE-GO TO TRUE                   19450005
194600                  PERFORM 8000-COPY-PACK-SLIP                     19460005
194700             END-IF                                               19470005
194800                                                                  19480005
194900             IF ASC-ADD-PENDING                                   19490005
195000                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             19500005
195100                 MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR               19510005
195200                 PERFORM 3012-SELECT-PO-TYP-CDE                   19520005
195300*** BEGIN - DMH 1/7/08                                            19530078
195400                 IF  ASC-KEY-OPER-STORE         AND               19540078
195500                     ASC-STR-OPER-STORE         AND               19550078
195600                     PS-NO-ERROR                                  19560078
195700                     IF  ASC-STR-DEST-NBR  =  ASC-OPER-UNT-ID     19570078
195800                         CONTINUE                                 19580078
195900                     ELSE                                         19590078
196000                         SET DP020-MSG-FATAL                      19600078
196100                             PS-ERROR    TO TRUE                  19610078
196200                         MOVE PC-TSYMSG-03597 TO DP020-MSG-NUMBER 19620078
196300                         MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA     19630078
196400                         MOVE DP015-RED              TO ASTRC     19640078
196500                         MOVE DP015-REVERSE          TO ASTRH     19650078
196600                         MOVE -1                     TO ASTRL     19660078
196700                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      19670078
196800                     END-IF                                       19680078
196900                 END-IF                                           19690078
197000*** END   - DMH 1/7/08                                            19700078
197100                                                                  19710078
197200                 IF PS-NO-ERROR                                   19720078
197300                 IF PS-PO-TYP-CDE-FOUND AND                       19730078
197400                                        PC-IMPORT-EXT             19740005
197500                    PERFORM 3115-CHECK-CONTNR-ID                  19750005
197600                    IF PS-VALID-CONTNR-ID                         19760005
197700                        SET DP030-CONTINUE-GO TO TRUE             19770005
197800                        SET ASC-RECORD-ADDED  TO TRUE             19780005
197900                        PERFORM 5000-ADD-PACK-SLIP-HEADER         19790005
198000                        MOVE DP015-UNP-ALP-NOR-OFF                19800005
198100                                              TO ACONTNRA         19810005
198200                        MOVE DP015-GREEN      TO ACONTNRC         19820005
198300                        MOVE DP015-UNDERLINE  TO ACONTNRH         19830005
198400                        MOVE -1               TO ACONTNRL         19840005
198500                    ELSE                                          19850005
198600                        SET DP030-OVERRIDE-GO TO TRUE             19860005
198700                        SET ASC-LOCAL-01-NEED-CONFIRM             19870005
198800                                              TO TRUE             19880005
198900                        SET DP020-MSG-INFORMATIONAL               19890005
199000                            PS-ERROR          TO TRUE             19900005
199100                        MOVE PC-TSYMSG-02126  TO DP020-MSG-NUMBER 19910005
199200                        MOVE DP015-UNP-ALP-BRT-OFF                19920005
199300                                              TO ACONTNRA         19930005
199400                        MOVE DP015-RED        TO ACONTNRC         19940005
199500                        MOVE DP015-REVERSE    TO ACONTNRH         19950005
199600                        MOVE -1               TO ACONTNRL         19960005
199700                        SET DP030-SET-CURSOR-APPL-1 TO TRUE       19970005
199800                    END-IF                                        19980005
199900                 ELSE                                             19990005
200000                     PERFORM 5000-ADD-PACK-SLIP-HEADER            20000005
200100                     MOVE DP015-PRO-NOR-OFF TO ACONTNRA           20010005
200200                     MOVE DP015-BLUE        TO ACONTNRC           20020005
200300                     MOVE DP015-HL-OFF      TO ACONTNRH           20030005
200400                     MOVE -1                TO ACONTNRL           20040005
200500                     MOVE SPACES            TO PKSLIP-CONTNR-ID   20050005
200600                 END-IF                                           20060005
200700                 END-IF                                           20070078
200800             END-IF                                               20080005
200900                                                                  20090005
201000             IF ASC-UPDATE-PENDING                                20100099
201001                                                                  20100199
201010               IF ASC-LOCAL-02-NEED-CONFIRM                       20101099
201020                                                                  20102099
201100                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             20110005
201200                 MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR               20120005
201300                 PERFORM 3012-SELECT-PO-TYP-CDE                   20130005
201400                 IF PS-PO-TYP-CDE-FOUND AND                       20140005
201500                                         PC-IMPORT-EXT            20150005
201600                     IF ACONTNRL > ZERO                           20160005
201700                         PERFORM 3115-CHECK-CONTNR-ID             20170005
201800                     ELSE                                         20180005
201900                         SET PS-VALID-CONTNR-ID TO TRUE           20190005
202000                     END-IF                                       20200005
202100                 ELSE                                             20210005
202200                     SET PS-VALID-CONTNR-ID TO TRUE               20220005
202300                 END-IF                                           20230005
202400                                                                  20240005
202500                 IF PS-VALID-CONTNR-ID                            20250005
202600                     SET DP030-CONTINUE-GO TO TRUE                20260005
202700                     PERFORM 6000-UPDATE-PACK-SLIP                20270005
202800                     MOVE DP015-UNP-ALP-NOR-OFF                   20280005
202900                                           TO ACONTNRA            20290005
203000                     MOVE DP015-GREEN      TO ACONTNRC            20300005
203100                     MOVE DP015-UNDERLINE  TO ACONTNRH            20310005
203200                     MOVE -1               TO ACONTNRL            20320005
203300                     MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER    20330005
203400                     SET DP020-MSG-INFORMATIONAL TO TRUE          20340005
203500                 ELSE                                             20350005
203600                     SET DP030-OVERRIDE-GO TO TRUE                20360005
203700                     SET ASC-LOCAL-02-NEED-CONFIRM                20370005
203800                                           TO TRUE                20380005
203900                     SET DP020-MSG-INFORMATIONAL                  20390005
204000                         PS-ERROR          TO TRUE                20400005
204100                     MOVE PC-TSYMSG-02126  TO DP020-MSG-NUMBER    20410005
204200                     MOVE DP015-UNP-ALP-BRT-OFF                   20420005
204300                                           TO ACONTNRA            20430005
204400                     MOVE DP015-RED        TO ACONTNRC            20440005
204500                     MOVE DP015-REVERSE    TO ACONTNRH            20450005
204600                     MOVE -1               TO ACONTNRL            20460005
204700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          20470005
204800                 END-IF                                           20480005
204801* BEGIN - DMH 12/22/15                                            20480191
204810               ELSE                                               20481099
204820                 SET DP030-OVERRIDE-GO TO TRUE                    20482091
204850                 SET DP020-MSG-INFORMATIONAL                      20485091
204860                     PS-ERROR          TO TRUE                    20486091
204870                 MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER        20487091
204893                 MOVE -1               TO ACONTNRL                20489391
204894                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20489491
204895               END-IF                                             20489599
204896* END   - DMH 12/22/15                                            20489691
204900             END-IF                                               20490005
205000                                                                  20500005
205100         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  20510005
205200             IF ASC-OPER-UNT-ID-N  = ZERO AND                     20520005
205300                (DP020-SRC-AID EQUAL DP016-PF17 OR                20530005
205400                 DP020-SRC-AID EQUAL DP016-PF23 OR                20540005
205500                 DP020-SRC-AID EQUAL DP016-PF24)                  20550005
205600                 SET DP020-MSG-FATAL                              20560005
205700                     DP030-SET-CURSOR-TRAILER                     20570005
205800                     DP030-OVERRIDE-GO                            20580005
205900                     PS-ERROR      TO TRUE                        20590005
206000                 MOVE PC-TSYMSG-00815                             20600005
206100                                 TO DP020-MSG-NUMBER              20610005
206200             ELSE                                                 20620005
206300                 IF ASC-ADD-PENDING AND                           20630005
206400                    ASC-RECORD-NOT-ADDED AND                      20640005
206500                    ASC-NO-REC-B4-LOCAL                           20650005
206600                     SET DP020-MSG-FATAL                          20660005
206700                         DP030-SET-CURSOR-TRAILER                 20670005
206800                         DP030-OVERRIDE-GO                        20680005
206900                         PS-ERROR      TO TRUE                    20690005
207000                     MOVE PC-TSYMSG-00352                         20700005
207100                                       TO DP020-MSG-NUMBER        20710005
207200                 ELSE                                             20720005
207300                     IF ASC-UPDATE-PENDING                        20730005
207400                         PERFORM 1200-GET-TRECEIV-STATUS          20740005
207500                         IF (RECEIV-STATUS-CDE EQUAL              20750005
207600                                 PC-VE                            20760005
207700                             OR  PS-RECITM-VERIFIED)              20770005
207800                             SET DP020-MSG-FATAL                  20780005
207900                                 DP030-SET-CURSOR-TRAILER         20790005
208000                                 DP030-OVERRIDE-GO                20800005
208100                                 PS-ERROR      TO TRUE            20810005
208200                             MOVE PC-TSYMSG-00734                 20820005
208300                                       TO DP020-MSG-NUMBER        20830005
208400                         ELSE                                     20840005
208500                             PERFORM 2101-SETUP-LOCAL-GOTO        20850005
208600                         END-IF                                   20860005
208700                     ELSE                                         20870005
208800                         PERFORM 2101-SETUP-LOCAL-GOTO            20880005
208900                     END-IF                                       20890005
209000                 END-IF                                           20900005
209100             END-IF                                               20910005
209200                                                                  20920005
209300         WHEN DP020-SRC-AID = DP016-ENTER                         20930005
209400             CONTINUE                                             20940005
209500                                                                  20950005
209600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) AND          20960005
209700              DP020-SRC-AID = DP016-PF13                          20970005
209800             MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                   20980005
209900             PERFORM 3012-SELECT-PO-TYP-CDE                       20990005
210000             IF PS-PO-TYP-CDE-FOUND AND                           21000005
210100                                    PC-IMPORT-EXT                 21010005
210200                 IF ASC-CONTNR-ID > SPACES                        21020005
210300                     MOVE ASC-CONTNR-ID TO DK-CONTNR-ID           21030005
210400                     PERFORM 3110-VALIDATE-CONTAINER              21040005
210500                     IF PS-CONTAINER-EXISTS-NO                    21050005
210600                         SET DP030-OVERRIDE-GO TO TRUE            21060005
210700                         SET DP020-MSG-INFORMATIONAL              21070005
210800                             PS-ERROR         TO TRUE             21080005
210900                         MOVE PC-TSYMSG-01802 TO DP020-MSG-NUMBER 21090005
211000                         MOVE DP015-UNP-ALP-BRT-OFF               21100005
211100                                              TO ACONTNRA         21110005
211200                         MOVE DP015-RED       TO ACONTNRC         21120005
211300                         MOVE DP015-REVERSE   TO ACONTNRH         21130005
211400                         MOVE -1              TO ACONTNRL         21140005
211500                         SET DP030-SET-CURSOR-APPL-1              21150005
211600                                              TO TRUE             21160005
211700                     ELSE                                         21170005
211800                         SET DP030-CONTINUE-GO TO TRUE            21180005
211900                         SET ASC-RECORD-ADDED  TO TRUE            21190005
212000                         PERFORM 5000-ADD-PACK-SLIP-HEADER        21200005
212100                         MOVE DP015-UNP-ALP-NOR-OFF               21210005
212200                                               TO ACONTNRA        21220005
212300                         MOVE DP015-GREEN      TO ACONTNRC        21230005
212400                         MOVE DP015-UNDERLINE  TO ACONTNRH        21240005
212500                         MOVE -1               TO ACONTNRL        21250005
212600                     END-IF                                       21260005
212700                 END-IF                                           21270005
212800             ELSE                                                 21280005
212900                 SET DP030-CONTINUE-GO TO TRUE                    21290005
213000                 SET ASC-RECORD-ADDED  TO TRUE                    21300005
213100                 PERFORM 5000-ADD-PACK-SLIP-HEADER                21310005
213200                 MOVE DP015-PRO-NOR-OFF TO ACONTNRA               21320005
213300                 MOVE DP015-BLUE        TO ACONTNRC               21330005
213400                 MOVE DP015-HL-OFF      TO ACONTNRH               21340005
213500                 MOVE -1                TO ACONTNRL               21350005
213600             END-IF                                               21360005
213700                                                                  21370005
213800                                                                  21380005
213900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              21390005
214000             MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                   21400005
214100             PERFORM 3012-SELECT-PO-TYP-CDE                       21410005
214200             IF PS-PO-TYP-CDE-FOUND AND                           21420005
214300                                    PC-IMPORT-EXT                 21430005
214400                 IF ASC-CONTNR-ID > SPACES                        21440005
214500                     MOVE ASC-CONTNR-ID TO DK-CONTNR-ID           21450005
214600                                                                  21460005
214700                    IF ACONTNRL > ZERO                            21470005
214800                        PERFORM 3110-VALIDATE-CONTAINER           21480005
214900                        PERFORM 3115-CHECK-CONTNR-ID              21490005
215000                    ELSE                                          21500005
215100*FOR DOMESTIC PO'S                                                21510005
215200                        SET PS-CONTAINER-EXISTS TO TRUE           21520005
215300                        SET PS-VALID-CONTNR-ID  TO TRUE           21530005
215400                    END-IF                                        21540005
215500                                                                  21550005
215600                     IF PS-CONTAINER-EXISTS-NO                    21560005
215700                         IF PS-VALID-CONTNR-ID-NO                 21570005
215800                            SET DP030-OVERRIDE-GO TO TRUE         21580005
215900                            SET DP020-MSG-INFORMATIONAL           21590005
216000                                PS-ERROR          TO TRUE         21600005
216100                            MOVE PC-TSYMSG-02135  TO              21610005
216200                                               DP020-MSG-NUMBER   21620005
216300                            MOVE DP015-UNP-ALP-BRT-OFF            21630005
216400                                                  TO ACONTNRA     21640005
216500                            MOVE DP015-RED        TO ACONTNRC     21650005
216600                            MOVE DP015-REVERSE    TO ACONTNRH     21660005
216700                            MOVE -1               TO ACONTNRL     21670005
216800                            SET DP030-SET-CURSOR-APPL-1           21680005
216900                                                  TO TRUE         21690005
217000                         ELSE                                     21700005
217100                            SET DP030-OVERRIDE-GO TO TRUE         21710005
217200                            SET DP020-MSG-INFORMATIONAL           21720005
217300                                PS-ERROR          TO TRUE         21730005
217400                            MOVE PC-TSYMSG-01802  TO              21740005
217500                                               DP020-MSG-NUMBER   21750005
217600                            MOVE DP015-UNP-ALP-BRT-OFF            21760005
217700                                                  TO ACONTNRA     21770005
217800                            MOVE DP015-RED        TO ACONTNRC     21780005
217900                            MOVE DP015-REVERSE    TO ACONTNRH     21790005
218000                            MOVE -1               TO ACONTNRL     21800005
218100                            SET DP030-SET-CURSOR-APPL-1           21810005
218200                                                  TO TRUE         21820005
218300                         END-IF                                   21830005
218400                     ELSE                                         21840005
218500                         SET DP030-CONTINUE-GO TO TRUE            21850005
218600                         PERFORM 6000-UPDATE-PACK-SLIP            21860005
218700                         MOVE DP015-UNP-ALP-NOR-OFF               21870005
218800                                               TO ACONTNRA        21880005
218900                         MOVE DP015-GREEN      TO ACONTNRC        21890005
219000                         MOVE DP015-UNDERLINE  TO ACONTNRH        21900005
219100                         MOVE -1               TO ACONTNRL        21910005
219200                         MOVE PC-TSYMSG-00059  TO                 21920005
219300                                            DP020-MSG-NUMBER      21930005
219400                         SET DP020-MSG-INFORMATIONAL TO TRUE      21940005
219500                     END-IF                                       21950005
219600                 ELSE                                             21960005
219700                     SET DP030-CONTINUE-GO TO TRUE                21970005
219800                     PERFORM 6000-UPDATE-PACK-SLIP                21980005
219900                 END-IF                                           21990005
220000             ELSE                                                 22000088
220100                 SET DP030-CONTINUE-GO TO TRUE                    22010089
220200                 PERFORM 6000-UPDATE-PACK-SLIP                    22020089
220300                 MOVE DP015-PRO-NOR-OFF TO ACONTNRA               22030089
220400                 MOVE DP015-BLUE        TO ACONTNRC               22040089
220500                 MOVE DP015-HL-OFF      TO ACONTNRH               22050089
220600                 MOVE -1                TO ACONTNRL               22060089
220700                 MOVE SPACES            TO PKSLIP-CONTNR-ID       22070089
220800             END-IF                                               22080005
220900                                                                  22090005
221000         WHEN OTHER                                               22100005
221100             SET DP013-NO-ROLLBACK                                22110005
221200                 DP013-XCTL-DISPLAY-RESTART                       22120005
221300                 DP013-CICS-ABEND  TO TRUE                        22130005
221400             MOVE '2100-CHECK-FUNCTION-KEY'                       22140005
221500                                   TO DP013-PARAGRAPH             22150005
221600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      22160005
221700                                   TO DP013-MESSAGE-TEXT (1)      22170005
221800             PERFORM DP013-0000-PROCESS-ABEND                     22180005
221900     END-EVALUATE.                                                22190005
222000/                                                                 22200005
222100 2101-SETUP-LOCAL-GOTO.                                           22210005
222200                                                                  22220005
222300     IF DP020-FK-INT-APPL-FORMAT-IND(DP020-SRC-AID) = '3' OR '4'  22230005
222400         PERFORM 2101A-FORMAT-RC015                               22240005
222500     ELSE                                                         22250005
222600         PERFORM 2101B-FORMAT-RC012                               22260005
222700     END-IF.                                                      22270005
222800                                                                  22280005
222900     SET ASC-RECORD-NOT-ADDED                                     22290005
223000         ASC-REC-EXISTS-B4-LOCAL   TO TRUE.                       22300005
223100                                                                  22310005
223200 2101A-FORMAT-RC015.                                              22320005
223300     MOVE ASC-KEY-PO-NBR-N         TO RC015-PO-NBR.               22330005
223400     MOVE ASC-KEY-OPER-UNT-ID-N    TO RC015-OPER-UNT-ID.          22340005
223500     MOVE ASC-KEY-FCLTY-ID-N       TO RC015-FCLTY-ID.             22350005
223600     MOVE ASC-PKSL-NBR             TO RC015-PKSL-NBR.             22360005
223700     MOVE ASC-SEQ-NBR              TO RC015-SEQ-NBR.              22370005
223800                                                                  22380005
223900     IF ASC-REC-SEQ-NBR NUMERIC                                   22390005
224000         MOVE ASC-REC-SEQ-NBR-N    TO RC015-REC-SEQ-NBR           22400005
224100     ELSE                                                         22410005
224200         MOVE ZEROS                TO RC015-REC-SEQ-NBR           22420005
224300     END-IF.                                                      22430005
224400     IF ASC-STR-DEST-NBR NUMERIC                                  22440005
224500         MOVE ASC-STR-DEST-NBR-N   TO RC015-STR-NBR               22450005
224600     ELSE                                                         22460005
224700         MOVE ZEROS                TO RC015-STR-NBR               22470005
224800     END-IF.                                                      22480005
224900     IF DP020-FK-INT-APPL-FORMAT-IND(DP020-SRC-AID) = '3'         22490005
225000         MOVE 'Y'                  TO RC015-DISPLAY-Z-OTR         22500005
225100     ELSE                                                         22510005
225200         MOVE 'N'                  TO RC015-DISPLAY-Z-OTR         22520005
225300     END-IF.                                                      22530005
225400                                                                  22540005
225500 2101B-FORMAT-RC012.                                              22550005
225600     MOVE ASC-KEY-PO-NBR-N         TO RC012-PO-NBR.               22560005
225700     MOVE ASC-KEY-OPER-UNT-ID-N    TO RC012-OPER-UNT-ID.          22570005
225800     MOVE ASC-KEY-FCLTY-ID-N       TO RC012-FCLTY-ID.             22580005
225900     MOVE ASC-KEY-PKSL-STAT-CDES   TO RC012-PKSL-STAT-CDES.       22590005
226000                                                                  22600005
226100     IF ASC-REC-SEQ-NBR NUMERIC                                   22610005
226200         MOVE ASC-REC-SEQ-NBR-N    TO RC012-REC-SEQ-NBR           22620005
226300     ELSE                                                         22630005
226400         MOVE ZEROS                TO RC012-REC-SEQ-NBR           22640005
226500     END-IF.                                                      22650005
226600                                                                  22660005
226700     MOVE ASC-PKSL-NBR             TO RC012-PKSL-NBR.             22670005
226800     MOVE ASC-BOL-NBR              TO RC012-BOL-NBR.              22680005
226900     MOVE ASC-PRO-NBR              TO RC012-PRO-NBR.              22690005
227000     MOVE ASC-SEQ-NBR              TO RC012-SEQ-NBR.              22700005
227100                                                                  22710005
227200     IF ASC-STR-DEST-NBR NUMERIC                                  22720005
227300         MOVE ASC-STR-DEST-NBR-N   TO RC012-STR-NBR               22730005
227400     ELSE                                                         22740005
227500         MOVE ZEROS                TO RC012-STR-NBR               22750005
227600     END-IF.                                                      22760005
227700                                                                  22770005
227800/                                                                 22780005
227900*----------------------------------------------------------------*22790005
228000*    GET THE PACK SLIP NUMBER (KEY) OF THE NEXT SELECTED OBJECT  *22800005
228100*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *22810005
228200*----------------------------------------------------------------*22820005
228300 2110-GET-NEXT-PACK-SLIP.                                         22830005
228400                                                                  22840005
228500     ADD +1                        TO ASC-SEL-SUB.                22850005
228600     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            22860005
228700         ADD +1                    TO ASC-SEL-ITEM                22870005
228800         MOVE +1                   TO ASC-SEL-SUB                 22880005
228900     END-IF.                                                      22890005
229000                                                                  22900005
229100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                22910005
229200         PERFORM 9100-READ-SEL-QUEUE                              22920005
229300         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      22930005
229400             INITIALIZE ASC-SCREEN-FIELDS                         22940005
229500             MOVE ASC-KEY-PO-NBR-N TO ASC-PO-NBR-N                22950005
229600             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 22960005
229700                                    TO ASC-KEY-OPER-UNT-ID-N      22970005
229800                                       ASC-OPER-UNT-ID-N          22980005
229900                                       DK-OPER-UNT-ID             22990005
230000                                       DK-OPER-UNT-ID-B           23000005
230100                                       DK-OPER-UNT-ID-E           23010005
230200             MOVE ASC-KEY-FCLTY-ID-N                              23020005
230300                                   TO ASC-FCLTY-ID-N              23030005
230400             IF RC013-REC-SEQ-NBR (ASC-SEL-SUB) = ZEROES          23040005
230500                 MOVE SPACES       TO ASC-KEY-REC-SEQ-NBR         23050005
230600             ELSE                                                 23060005
230700                 MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)             23070005
230800                                   TO ASC-KEY-REC-SEQ-NBR-N       23080005
230900                                      DK-REC-SEQ-NBR-B            23090005
231000                                      DK-REC-SEQ-NBR-E            23100005
231100                                      DK-REC-SEQ-NBR              23110005
231200             END-IF                                               23120005
231300             MOVE RC013-PKSL-STAT-CDE (ASC-SEL-SUB)               23130005
231400                                   TO ASC-PKSL-STAT-CDE           23140005
231500                                      PV-PKSL-STAT-CDE            23150005
231600             IF RC013-STR-NBR (ASC-SEL-SUB) = ZEROES              23160005
231700                 MOVE SPACES       TO ASC-STR-DEST-NBR            23170005
231800             ELSE                                                 23180005
231900                 MOVE RC013-STR-NBR (ASC-SEL-SUB)                 23190005
232000                                   TO ASC-STR-DEST-NBR-N          23200005
232100                                      DK-STR-DEST-NBR-B           23210005
232200                                      DK-STR-DEST-NBR-E           23220005
232300             END-IF                                               23230005
232400             IF NOT PV-PKSL-STAT-CDE-INACTIVE                     23240005
232500                MOVE DP016-PF3 TO DP020-SRC-AID                   23250005
232600                SET DP020-MSG-FATAL                               23260005
232700                    DP030-SET-CURSOR-TRAILER                      23270005
232800                    PS-ERROR       TO TRUE                        23280005
232900                    MOVE PC-TSYMSG-00723                          23290005
233000                                   TO DP020-MSG-NUMBER            23300005
233100             ELSE                                                 23310005
233200                 MOVE RC013-PRO-NBR (ASC-SEL-SUB)                 23320005
233300                                   TO ASC-KEY-PRO-NBR             23330005
233400                                      DK-PRO-NBR-B                23340005
233500                                      DK-PRO-NBR-E                23350005
233600                 MOVE RC013-BOL-NBR (ASC-SEL-SUB)                 23360005
233700                                   TO ASC-KEY-BOL-NBR             23370005
233800                                      DK-BOL-NBR-B                23380005
233900                                      DK-BOL-NBR-E                23390005
234000                 MOVE RC013-PKSL-NBR (ASC-SEL-SUB)                23400005
234100                                   TO ASC-KEY-PKSL-NBR            23410005
234200                                      DK-PKSL-NBR-B               23420005
234300                                      DK-PKSL-NBR-E               23430005
234400                 MOVE RC013-SEQ-NBR  (ASC-SEL-SUB)                23440005
234500                                   TO DK-SEQ-NBR-B                23450005
234600                                      DK-SEQ-NBR-E                23460005
234700                                      ASC-SEQ-NBR                 23470005
234800                 SET RC013-INQ (ASC-SEL-SUB)                      23480005
234900                                   TO TRUE                        23490005
235000                 PERFORM 9200-REWRITE-SEL-QUEUE                   23500005
235100             END-IF                                               23510005
235200         ELSE                                                     23520005
235300             SUBTRACT +1 FROM ASC-SEL-SUB                         23530005
235400*            --- BOTTOM OF LIST ---                               23540005
235500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            23550005
235600             SET DP020-MSG-INFORMATIONAL                          23560005
235700                 PS-LIST-END                                      23570005
235800                                   TO TRUE                        23580005
235900         END-IF                                                   23590005
236000     ELSE                                                         23600005
236100         SUBTRACT +1 FROM ASC-SEL-ITEM                            23610005
236200         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 23620005
236300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            23630005
236400         SET DP020-MSG-INFORMATIONAL                              23640005
236500             PS-LIST-END                                          23650005
236600                                   TO TRUE                        23660005
236700     END-IF.                                                      23670005
236800                                                                  23680005
236900/                                                                 23690005
237000*----------------------------------------------------------------*23700005
237100*    GET THE PO NUMBER (KEY) OF THE PREVIOUS SELECTED            *23710005
237200*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *23720005
237300*----------------------------------------------------------------*23730005
237400 2120-GET-PREV-PACK-SLIP.                                         23740005
237500                                                                  23750005
237600     SUBTRACT +1 FROM ASC-SEL-SUB.                                23760005
237700     IF  ASC-SEL-SUB < +1                                         23770005
237800         SUBTRACT +1 FROM ASC-SEL-ITEM                            23780005
237900         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 23790005
238000     END-IF.                                                      23800005
238100                                                                  23810005
238200     IF  ASC-SEL-ITEM > ZERO                                      23820005
238300         PERFORM 9100-READ-SEL-QUEUE                              23830005
238400         INITIALIZE ASC-SCREEN-FIELDS                             23840005
238500         MOVE ASC-KEY-PO-NBR-N     TO ASC-PO-NBR-N                23850005
238600         MOVE ASC-KEY-OPER-UNT-ID-N                               23860005
238700                                   TO ASC-OPER-UNT-ID-N           23870005
238800         MOVE ASC-KEY-FCLTY-ID-N   TO ASC-FCLTY-ID-N              23880005
238900         IF RC013-REC-SEQ-NBR (ASC-SEL-SUB) = ZEROES              23890005
239000             MOVE SPACES           TO ASC-KEY-REC-SEQ-NBR         23900005
239100         ELSE                                                     23910005
239200             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 23920005
239300                                   TO ASC-KEY-REC-SEQ-NBR-N       23930005
239400                                      DK-REC-SEQ-NBR-B            23940005
239500                                      DK-REC-SEQ-NBR-E            23950005
239600                                      DK-REC-SEQ-NBR              23960005
239700         END-IF                                                   23970005
239800         MOVE RC013-PKSL-STAT-CDE (ASC-SEL-SUB)                   23980005
239900                                   TO ASC-PKSL-STAT-CDE           23990005
240000                                      PV-PKSL-STAT-CDE            24000005
240100         IF RC013-STR-NBR (ASC-SEL-SUB) = ZEROES                  24010005
240200             MOVE SPACES           TO ASC-STR-DEST-NBR            24020005
240300         ELSE                                                     24030005
240400             MOVE RC013-STR-NBR (ASC-SEL-SUB)                     24040005
240500                                   TO ASC-STR-DEST-NBR-N          24050005
240600                                      DK-STR-DEST-NBR-B           24060005
240700                                      DK-STR-DEST-NBR-E           24070005
240800         END-IF                                                   24080005
240900         MOVE RC013-PRO-NBR (ASC-SEL-SUB)                         24090005
241000                                   TO ASC-KEY-PRO-NBR             24100005
241100                                      DK-PRO-NBR-B                24110005
241200                                      DK-PRO-NBR-E                24120005
241300         MOVE RC013-BOL-NBR (ASC-SEL-SUB)                         24130005
241400                                   TO ASC-KEY-BOL-NBR             24140005
241500                                      DK-BOL-NBR-B                24150005
241600                                      DK-BOL-NBR-E                24160005
241700         MOVE RC013-PKSL-NBR (ASC-SEL-SUB)                        24170005
241800                                   TO ASC-KEY-PKSL-NBR            24180005
241900                                      DK-PKSL-NBR-B               24190005
242000                                      DK-PKSL-NBR-E               24200005
242100         MOVE RC013-SEQ-NBR  (ASC-SEL-SUB)                        24210005
242200                                   TO DK-SEQ-NBR-B                24220005
242300                                      DK-SEQ-NBR-E                24230005
242400     ELSE                                                         24240005
242500         MOVE +1                   TO ASC-SEL-ITEM                24250005
242600                                      ASC-SEL-SUB                 24260005
242700*        --- TOP OF LIST ---                                      24270005
242800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            24280005
242900         SET DP020-MSG-INFORMATIONAL                              24290005
243000             PS-LIST-END           TO TRUE                        24300005
243100     END-IF.                                                      24310005
243200/                                                                 24320005
243300 2195-CHECK-IF-IN-TROUBLE.                                        24330005
243400                                                                  24340005
243500     MOVE ZERO                    TO PV-DB2-COUNT                 24350005
243600                                                                  24360005
243700         EXEC SQL                                                 24370005
243800              SELECT COUNT(*)                                     24380005
243900                INTO :PV-DB2-COUNT :PV-NULL-IND                   24390005
244000                FROM TTRBNTF A                                    24400005
244100               WHERE A.PO_NBR        = :DK-PO-NBR                 24410005
244200                 AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            24420005
244300                 AND A.PO_LNE_NBR    = :PC-LONG-ZERO              24430005
244400                 AND A.RESOLVED_IND IN ('N','I')                  24440005
244500         END-EXEC                                                 24450005
244600                                                                  24460005
244700         EVALUATE TRUE                                            24470005
244800             WHEN SQLCODE = +0                                    24480005
244900             WHEN SQLCODE = +100                                  24490005
245000                  CONTINUE                                        24500005
245100             WHEN SQLCODE = -904                                  24510005
245200             WHEN SQLCODE = -911                                  24520005
245300             WHEN SQLCODE = -913                                  24530005
245400                  PERFORM 9900-SOFT-ABORT                         24540005
245500                                                                  24550005
245600             WHEN SQLWARN0 NOT = SPACES                           24560005
245700             WHEN SQLCODE < +0                                    24570005
245800             WHEN SQLCODE > +0                                    24580005
245900                  MOVE '2195-CHECK-IF-IN-TROUBLE'                 24590005
246000                                  TO DP013-PARAGRAPH              24600005
246100                  MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'        24610005
246200                                  TO DP013-MESSAGE-TEXT (1)       24620005
246300                  MOVE SQLCA      TO DP013-SQLCA                  24630005
246400                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     24640005
246500                  SET DP013-DB2-ABEND                             24650005
246600                      DP013-XCTL-DISPLAY-RESTART                  24660005
246700                                  TO TRUE                         24670005
246800                  PERFORM DP013-0000-PROCESS-ABEND                24680005
246900         END-EVALUATE.                                            24690005
247000                                                                  24700005
247100/                                                                 24710005
247200*----------------------------------------------------------------*24720005
247300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *24730005
247400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *24740005
247500*----------------------------------------------------------------*24750005
247600 2200-MOVE-SCREEN-TO-COMMAREA.                                    24760005
247700                                                                  24770005
247800     IF AOPERL > ZERO                                             24780005
247900         MOVE AOPERI               TO ASC-OPER-UNT-ID             24790005
248000     ELSE                                                         24800005
248100         IF AOPERF = DP015-ERASE-EOF                              24810005
248200             MOVE SPACES           TO ASC-OPER-UNT-ID             24820005
248300         END-IF                                                   24830005
248400     END-IF.                                                      24840005
248500                                                                  24850005
248600     IF APOL > ZERO                                               24860005
248700         MOVE APOI                 TO ASC-PO-NBR                  24870005
248800         SET ASC-RECORD-NOT-ADDED                                 24880005
248900             ASC-NO-REC-B4-LOCAL   TO TRUE                        24890005
249000     ELSE                                                         24900005
249100         IF APOF = DP015-ERASE-EOF                                24910005
249200             MOVE SPACES           TO ASC-PO-NBR                  24920005
249300         END-IF                                                   24930005
249400     END-IF.                                                      24940005
249500                                                                  24950005
249600     IF APKSLIPL > ZERO                                           24960005
249700         MOVE APKSLIPI             TO ASC-PKSL-NBR                24970005
249800     ELSE                                                         24980005
249900         IF APKSLIPF = DP015-ERASE-EOF                            24990005
250000             MOVE SPACES           TO ASC-PKSL-NBR                25000005
250100         END-IF                                                   25010005
250200     END-IF.                                                      25020005
250300                                                                  25030005
250400     IF APAGESL  > ZERO                                           25040005
250500         MOVE APAGESI              TO ASC-PAGE-CNT                25050005
250600     ELSE                                                         25060005
250700         IF APAGESF  = DP015-ERASE-EOF                            25070005
250800             MOVE ZEROES           TO ASC-PAGE-CNT                25080005
250900         END-IF                                                   25090005
251000     END-IF.                                                      25100005
251100                                                                  25110005
251200     IF ABOLL > ZERO                                              25120005
251300         MOVE ABOLI                TO ASC-BOL-NBR                 25130005
251400     ELSE                                                         25140005
251500         IF ABOLF = DP015-ERASE-EOF                               25150005
251600             MOVE SPACES           TO ASC-BOL-NBR                 25160005
251700         END-IF                                                   25170005
251800     END-IF.                                                      25180005
251900                                                                  25190005
252000     IF APROL > ZERO                                              25200005
252100         MOVE APROI                TO ASC-PRO-NBR                 25210005
252200     ELSE                                                         25220005
252300         IF APROF = DP015-ERASE-EOF                               25230005
252400             MOVE SPACES           TO ASC-PRO-NBR                 25240005
252500         END-IF                                                   25250005
252600     END-IF.                                                      25260005
252700                                                                  25270005
252800     IF ASTRL > ZERO                                              25280005
252900         MOVE ASTRI                TO ASC-STR-DEST-NBR            25290005
253000     ELSE                                                         25300005
253100         IF ASTRF = DP015-ERASE-EOF                               25310005
253200             MOVE SPACES           TO ASC-STR-DEST-NBR            25320005
253300         END-IF                                                   25330005
253400     END-IF.                                                      25340005
253500                                                                  25350005
253600     IF ACRTNL > ZERO                                             25360005
253700         MOVE ACRTNI               TO ASC-EXPTED-PKG-QTY          25370005
253800     ELSE                                                         25380005
253900         IF ACRTNF = DP015-ERASE-EOF                              25390005
254000             MOVE ZEROS            TO ASC-EXPTED-PKG-QTY          25400005
254100         END-IF                                                   25410005
254200     END-IF.                                                      25420005
254300                                                                  25430005
254400     IF ASRCL > ZERO                                              25440005
254500         MOVE ASRCI                TO ASC-CRE-SRC-CDE             25450005
254600     ELSE                                                         25460005
254700         IF ASRCF = DP015-ERASE-EOF                               25470005
254800             MOVE SPACES           TO ASC-CRE-SRC-CDE             25480005
254900         END-IF                                                   25490005
255000     END-IF.                                                      25500005
255100                                                                  25510005
255200     IF ARECSEQL > ZERO                                           25520005
255300         MOVE ARECSEQI             TO ASC-REC-SEQ-NBR             25530005
255400     ELSE                                                         25540005
255500         IF ARECSEQF = DP015-ERASE-EOF                            25550005
255600             MOVE ZEROS            TO ASC-REC-SEQ-NBR             25560005
255700         END-IF                                                   25570005
255800     END-IF.                                                      25580005
255900                                                                  25590005
256000     IF AOSCACL  > ZERO                                           25600005
256100         MOVE AOSCACI              TO ASC-ORIGIN-SCAC-CDE         25610005
256200     ELSE                                                         25620005
256300         IF AOSCACF  = DP015-ERASE-EOF                            25630005
256400             MOVE ZEROS            TO ASC-ORIGIN-SCAC-CDE         25640005
256500         END-IF                                                   25650005
256600     END-IF.                                                      25660005
256700                                                                  25670005
256800     IF AVSHPDTL > ZERO                                           25680005
256900         MOVE AVSHPDTI             TO ASC-VND-SHIP-DTE            25690005
257000     ELSE                                                         25700005
257100         IF AVSHPDTF = DP015-ERASE-EOF                            25710005
257200             MOVE SPACES           TO ASC-VND-SHIP-DTE            25720005
257300         END-IF                                                   25730005
257400     END-IF.                                                      25740005
257500                                                                  25750005
257600     IF ASC-COPY-PENDING                                          25760005
257700         MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                       25770005
257800         PERFORM 3012-SELECT-PO-TYP-CDE                           25780005
257900         IF PS-PO-TYP-CDE-FOUND-NO AND                            25790005
258000                              NOT PC-IMPORT-EXT                   25800005
258100             MOVE SPACES           TO ASC-CONTNR-ID               25810005
258200         ELSE                                                     25820005
258300             IF ACONTNRL > ZERO                                   25830005
258400                 MOVE ACONTNRI     TO ASC-CONTNR-ID               25840005
258500             ELSE                                                 25850005
258600                 IF ACONTNRF = DP015-ERASE-EOF                    25860005
258700                     MOVE SPACES   TO ASC-CONTNR-ID               25870005
258800                 END-IF                                           25880005
258900             END-IF                                               25890005
259000         END-IF                                                   25900005
259100     ELSE                                                         25910005
259200         IF ACONTNRL > ZERO                                       25920005
259300             MOVE ACONTNRI         TO ASC-CONTNR-ID               25930005
259400         ELSE                                                     25940005
259500             IF ACONTNRF = DP015-ERASE-EOF                        25950005
259600                 MOVE SPACES       TO ASC-CONTNR-ID               25960005
259700             END-IF                                               25970005
259800         END-IF                                                   25980005
259900     END-IF.                                                      25990005
260000                                                                  26000005
260100/                                                                 26010005
260200*----------------------------------------------------------------*26020005
260300*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *26030005
260400*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *26040005
260500*----------------------------------------------------------------*26050005
260600 3000-EDIT-DATA-IN-COMMAREA.                                      26060005
260700                                                                  26070005
260800     SET PS-NO-ERROR               TO TRUE.                       26080005
260900                                                                  26090005
261000     PERFORM 3200-RESET-ATTRIBUTES.                               26100005
261100     MOVE ASC-KEY-OPER-UNT-ID-N    TO DK-OPER-UNT-ID.             26110005
261200     MOVE ASC-KEY-FCLTY-ID-N       TO DK-FCLTY-ID.                26120005
261300                                                                  26130005
261400     IF DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                       26140005
261500              OR  DP020-SRC-AID EQUAL DP016-ENTER                 26150005
261600         CONTINUE                                                 26160005
261700     ELSE                                                         26170005
261800         IF ASC-COPY-PENDING                                      26180005
261900             MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                   26190005
262000             PERFORM 3012-SELECT-PO-TYP-CDE                       26200005
262100             IF PS-PO-TYP-CDE-FOUND AND                           26210005
262200                                    PC-IMPORT-EXT                 26220005
262300                 IF ASC-CONTNR-ID > SPACES                        26230005
262400                     MOVE ASC-CONTNR-ID TO DK-CONTNR-ID           26240005
262500                     PERFORM 3110-VALIDATE-CONTAINER              26250005
262600                     PERFORM 3115-CHECK-CONTNR-ID                 26260005
262700                     IF PS-CONTAINER-EXISTS-NO                    26270005
262800                         IF PS-VALID-CONTNR-ID-NO                 26280005
262900                             SET DP030-OVERRIDE-GO TO TRUE        26290005
263000                             SET DP020-MSG-INFORMATIONAL          26300005
263100                                 PS-ERROR          TO TRUE        26310005
263200                             MOVE PC-TSYMSG-02135  TO             26320005
263300                                                DP020-MSG-NUMBER  26330005
263400                             MOVE DP015-UNP-ALP-BRT-OFF           26340005
263500                                                   TO ACONTNRA    26350005
263600                             MOVE DP015-RED        TO ACONTNRC    26360005
263700                             MOVE DP015-REVERSE    TO ACONTNRH    26370005
263800                             MOVE -1               TO ACONTNRL    26380005
263900                             SET DP030-SET-CURSOR-APPL-1          26390005
264000                                                   TO TRUE        26400005
264100                         ELSE                                     26410005
264200                             SET DP030-OVERRIDE-GO TO TRUE        26420005
264300                             SET DP020-MSG-INFORMATIONAL          26430005
264400                                 PS-ERROR          TO TRUE        26440005
264500                             MOVE PC-TSYMSG-01802  TO             26450005
264600                                                DP020-MSG-NUMBER  26460005
264700                             MOVE DP015-UNP-ALP-BRT-OFF           26470005
264800                                                   TO ACONTNRA    26480005
264900                             MOVE DP015-RED        TO ACONTNRC    26490005
265000                             MOVE DP015-REVERSE    TO ACONTNRH    26500005
265100                             MOVE -1               TO ACONTNRL    26510005
265200                             SET DP030-SET-CURSOR-APPL-1          26520005
265300                                                   TO TRUE        26530005
265400                         END-IF                                   26540005
265500                     ELSE                                         26550005
265600                         MOVE DP015-UNP-ALP-NOR-OFF               26560005
265700                                               TO ACONTNRA        26570005
265800                         MOVE DP015-GREEN      TO ACONTNRC        26580005
265900                         MOVE DP015-UNDERLINE  TO ACONTNRH        26590005
266000                         MOVE -1               TO ACONTNRL        26600005
266100                         MOVE PC-TSYMSG-00059  TO                 26610005
266200                                            DP020-MSG-NUMBER      26620005
266300                         SET DP020-MSG-INFORMATIONAL TO TRUE      26630005
266400                     END-IF                                       26640005
266500                 END-IF                                           26650005
266600             ELSE                                                 26660005
266700                 MOVE DP015-PRO-NOR-OFF TO ACONTNRA               26670005
266800                 MOVE DP015-BLUE        TO ACONTNRC               26680005
266900                 MOVE DP015-HL-OFF      TO ACONTNRH               26690005
267000                 MOVE -1                TO ACONTNRL               26700005
267100                 MOVE SPACES            TO PKSLIP-CONTNR-ID       26710005
267200             END-IF                                               26720005
267300         ELSE                                                     26730005
267400             IF PC-IMPORT-EXT                                     26740005
267500              IF ASC-UPDATE-PENDING                               26750005
267600                  CONTINUE                                        26760005
267700              ELSE                                                26770005
267800                  IF ASC-CONTNR-ID > SPACES                       26780005
267900                      MOVE ASC-CONTNR-ID TO DK-CONTNR-ID          26790005
268000                      PERFORM 3110-VALIDATE-CONTAINER             26800005
268100                      IF PS-CONTAINER-EXISTS                      26810005
268200                          MOVE ASC-CONTNR-ID TO PKSLIP-CONTNR-ID  26820005
268300                      ELSE                                        26830005
268400                          SET PS-ERROR                            26840005
268500                              DP020-MSG-INFORMATIONAL TO TRUE     26850005
268600                          MOVE PC-TSYMSG-01802 TO                 26860005
268700                                               DP020-MSG-NUMBER   26870005
268800                          MOVE DP015-UNP-ALP-BRT-OFF              26880005
268900                                               TO ACONTNRA        26890005
269000                          MOVE DP015-RED       TO ACONTNRC        26900005
269100                          MOVE DP015-REVERSE   TO ACONTNRH        26910005
269200                          MOVE -1              TO ACONTNRL        26920005
269300                          SET DP030-SET-CURSOR-APPL-1             26930005
269400                                               TO TRUE            26940005
269500                      END-IF                                      26950005
269600                  ELSE                                            26960005
269700                      SET PS-ERROR                                26970005
269800                          DP020-MSG-INFORMATIONAL TO TRUE         26980005
269900                      MOVE PC-TSYMSG-02133 TO DP020-MSG-NUMBER    26990005
270000                      MOVE DP015-UNP-ALP-BRT-OFF                  27000005
270100                                           TO ACONTNRA            27010005
270200                      MOVE DP015-RED       TO ACONTNRC            27020005
270300                      MOVE DP015-REVERSE   TO ACONTNRH            27030005
270400                      MOVE -1              TO ACONTNRL            27040005
270500                      SET DP030-SET-CURSOR-APPL-1                 27050005
270600                                           TO TRUE                27060005
270700                  END-IF                                          27070005
270800              END-IF                                              27080005
270900             ELSE                                                 27090005
271000                 MOVE DP015-PRO-NOR-OFF TO ACONTNRA               27100005
271100                 MOVE DP015-BLUE        TO ACONTNRC               27110005
271200                 MOVE DP015-HL-OFF      TO ACONTNRH               27120005
271300                 MOVE SPACES            TO PKSLIP-CONTNR-ID       27130005
271400             END-IF                                               27140005
271500         END-IF                                                   27150005
271600     END-IF.                                                      27160005
271700                                                                  27170005
271800     PERFORM 3001-GET-CURRENT-DATE.                               27180005
271900                                                                  27190005
272000     IF  ASC-VND-SHIP-DTE  = SPACES                               27200005
272100         CONTINUE                                                 27210005
272200     ELSE                                                         27220005
272300         INITIALIZE  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56          27230005
272400         SET DPG51-ACTUAL-CALENDAR-ONLY                           27240005
272500             DPG51-DO-NOT-INCR-DECR-DATE                          27250005
272600             DPG52-LK-DTE-GREG         TO TRUE                    27260005
272700                                                                  27270005
272800         MOVE ASC-VND-SHIP-DD          TO PV-COMP-DD              27280005
272900         MOVE ASC-VND-SHIP-MM          TO PV-COMP-MM              27290005
273000         MOVE ASC-VND-SHIP-YY          TO PV-COMP-YY              27300005
273100         MOVE PV-COMPARE-DATE          TO DPG52-LK-DATE-INPUT     27310005
273200                                                                  27320005
273300         CALL DP500-KOHLS-CALENDAR-ROUTINE                        27330005
273400                          USING DPG51 DPG52 DPG53                 27340005
273500                                DPG54 DPG55 DPG56                 27350005
273600         IF DPG54-NO-ERROR                                        27360005
273700             MOVE DPG55-GREG-DATE-FMT  TO ASC-VND-SHIP-DTE        27370005
273800             MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-DATE           27380005
273900                                            PV-VEND-SHIP-DTE      27390005
274000         ELSE                                                     27400005
274100             SET PS-ERROR                                         27410005
274200                 DP020-MSG-FATAL   TO TRUE                        27420005
274300             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            27430005
274400             MOVE DP015-RED        TO AVSHPDTC                    27440005
274500             MOVE DP015-REVERSE    TO AVSHPDTH                    27450005
274600             MOVE -1               TO AVSHPDTL                    27460005
274700             SET DP030-SET-CURSOR-APPL-1                          27470005
274800                                   TO TRUE                        27480005
274900         END-IF                                                   27490005
275000     END-IF.                                                      27500005
275100                                                                  27510005
275200     IF  ASC-ORIGIN-SCAC-CDE > SPACES                             27520005
275300         MOVE ASC-ORIGIN-SCAC-CDE TO DK-SCAC-ID                   27530005
275400         PERFORM 3100-VALIDATE-SCAC-CDE                           27540005
275500         IF  SQLCODE = +100                                       27550005
275600             SET PS-ERROR                                         27560005
275700                 DP020-MSG-FATAL  TO TRUE                         27570005
275800             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             27580005
275900             MOVE DP015-UNP-ALP-BRT-OFF                           27590005
276000                                  TO AOSCACA                      27600005
276100             MOVE DP015-RED       TO AOSCACC                      27610005
276200             MOVE DP015-REVERSE   TO AOSCACH                      27620005
276300             MOVE -1              TO AOSCACL                      27630005
276400             SET DP030-SET-CURSOR-APPL-1                          27640005
276500                                  TO TRUE                         27650005
276600         END-IF                                                   27660005
276700     END-IF.                                                      27670005
276800                                                                  27680005
276900     IF  ASC-PKSL-STAT-CDE > SPACES                               27690005
277000         MOVE ASC-PKSL-STAT-CDE    TO PV-PKSL-STAT-CDE            27700005
277100         IF PV-PKSL-STAT-CDE-BEING-WORKED                         27710005
277200             SET DP020-MSG-FATAL                                  27720005
277300                 DP030-SET-CURSOR-TRAILER                         27730005
277400                 PS-ERROR          TO TRUE                        27740005
277500             MOVE PC-TSYMSG-00724  TO DP020-MSG-NUMBER            27750005
277600         END-IF                                                   27760005
277700     END-IF.                                                      27770005
277800                                                                  27780005
277900     IF  ASC-REC-SEQ-NBR > ZEROES                                 27790005
278000         MOVE ASC-REC-SEQ-NBR      TO DP010I-UNEDITED-FIELD       27800005
278100         MOVE LENGTH OF ASC-REC-SEQ-NBR                           27810005
278200                                   TO DP010I-MAXIMUM-DIGITS       27820005
278300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     27830005
278400         SET DP010I-NEGATIVE-NOT-ALLOWED                          27840005
278500                                   TO TRUE                        27850005
278600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         27860098
278620              USING DP010I-NUMERIC-EDIT-AREA                      27862097
278700                                                                  27870005
278800         IF  DP010I-ERROR-DETECTED                                27880005
278900             SET PS-ERROR                                         27890005
279000                 DP020-MSG-FATAL   TO TRUE                        27900005
279100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            27910005
279200             MOVE DP015-UNP-NUM-BRT-OFF                           27920005
279300                                   TO ARECSEQA                    27930005
279400             MOVE DP015-RED        TO ARECSEQC                    27940005
279500             MOVE DP015-REVERSE    TO ARECSEQH                    27950005
279600             MOVE -1               TO ARECSEQL                    27960005
279700             SET DP030-SET-CURSOR-APPL-1                          27970005
279800                                   TO TRUE                        27980005
279900         ELSE                                                     27990005
280000             MOVE DP010I-NUMERIC-FIELD                            28000005
280100                                   TO ASC-REC-SEQ-NBR-N           28010005
280200                                      DK-REC-SEQ-NBR              28020005
280300             MOVE ASC-PO-NBR-N     TO DK-PO-NBR                   28030005
280400             PERFORM 1200-GET-TRECEIV-STATUS                      28040005
280500             IF RECEIV-STATUS-CDE EQUAL PC-VE                     28050005
280600                 SET PS-ERROR                                     28060005
280700                     DP020-MSG-FATAL   TO TRUE                    28070005
280800                 MOVE PC-TSYMSG-00734                             28080005
280900                              TO DP020-MSG-NUMBER                 28090005
281000             ELSE                                                 28100005
281100                 MOVE ASC-REC-SEQ-NBR  TO ARECSEQO                28110005
281200                 PERFORM 3040-VALIDATE-REC-SEQ-NBR                28120005
281300             END-IF                                               28130005
281400         END-IF                                                   28140005
281500     ELSE                                                         28150005
281600         MOVE SPACES               TO ASC-REC-SEQ-NBR             28160005
281700     END-IF.                                                      28170005
281800                                                                  28180005
281900     IF PS-NO-ERROR AND ASC-REC-SEQ-NBR NOT = SPACES              28190005
282000         IF PV-VEND-SHIP-DTE > PV-RECEIV-REC-DATE                 28200005
282100             SET PS-ERROR                                         28210005
282200                 DP020-MSG-FATAL   TO TRUE                        28220005
282300             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            28230005
282400             MOVE DP015-RED        TO AVSHPDTC                    28240005
282500             MOVE DP015-REVERSE    TO AVSHPDTH                    28250005
282600             MOVE -1               TO AVSHPDTL                    28260005
282700             SET DP030-SET-CURSOR-APPL-1                          28270005
282800                                   TO TRUE                        28280005
282900         END-IF                                                   28290005
283000     END-IF.                                                      28300005
283100                                                                  28310005
283200     MOVE ASC-CRE-SRC-CDE          TO PV-PRE-RCPT-INFO.           28320005
283300                                                                  28330005
283400     IF PV-VALID-PRE-RCPT-INFO                                    28340005
283500         CONTINUE                                                 28350005
283600     ELSE                                                         28360005
283700         SET PS-ERROR                                             28370005
283800             DP020-MSG-FATAL       TO TRUE                        28380005
283900         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            28390005
284000         MOVE DP015-UNP-ALP-BRT-OFF                               28400005
284100                                   TO ASRCA                       28410005
284200         MOVE DP015-RED            TO ASRCC                       28420005
284300         MOVE DP015-REVERSE        TO ASRCH                       28430005
284400         MOVE -1                   TO ASRCL                       28440005
284500         SET DP030-SET-CURSOR-APPL-1                              28450005
284600                                   TO TRUE                        28460005
284700     END-IF.                                                      28470005
284800                                                                  28480005
284900     IF  ASC-EXPTED-PKG-QTY > SPACES                              28490005
285000         MOVE ASC-EXPTED-PKG-QTY   TO DP010I-UNEDITED-FIELD       28500005
285100         MOVE LENGTH OF ASC-EXPTED-PKG-QTY                        28510005
285200                                   TO DP010I-MAXIMUM-DIGITS       28520005
285300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     28530005
285400         SET DP010I-NEGATIVE-NOT-ALLOWED                          28540005
285500                                   TO TRUE                        28550005
285610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         28561097
285620              USING DP010I-NUMERIC-EDIT-AREA                      28562097
285700                                                                  28570005
285800         IF  DP010I-ERROR-DETECTED                                28580005
285900             SET PS-ERROR                                         28590005
286000                 DP020-MSG-FATAL   TO TRUE                        28600005
286100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            28610005
286200             MOVE DP015-UNP-NUM-BRT-OFF                           28620005
286300                                   TO ACRTNA                      28630005
286400             MOVE DP015-RED        TO ACRTNC                      28640005
286500             MOVE DP015-REVERSE    TO ACRTNH                      28650005
286600             MOVE -1               TO ACRTNL                      28660005
286700             SET DP030-SET-CURSOR-APPL-1                          28670005
286800                                   TO TRUE                        28680005
286900         ELSE                                                     28690005
287000             MOVE DP010I-NUMERIC-FIELD                            28700005
287100                                   TO ASC-EXPTED-PKG-QTY-N        28710005
287200                                      ACRTNO                      28720005
287300         END-IF                                                   28730005
287400     ELSE                                                         28740005
287500         MOVE ZEROS                TO ASC-EXPTED-PKG-QTY          28750005
287600     END-IF.                                                      28760005
287700                                                                  28770005
287800     IF  ASC-PKSL-NBR = SPACES OR ZEROS                           28780005
287900       IF PC-IMPORT-EXT                                           28790005
288000           MOVE DP015-UNP-ALP-NOR-OFF                             28800005
288100                                     TO ACONTNRA                  28810005
288200           MOVE DP015-GREEN          TO ACONTNRC                  28820005
288300           MOVE DP015-UNDERLINE      TO ACONTNRH                  28830005
288400           MOVE -1                   TO ACONTNRL                  28840005
288500           SET DP020-MSG-FATAL                                    28850005
288600               PS-ERROR              TO TRUE                      28860005
288700           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          28870005
288800           MOVE DP015-UNP-ALP-BRT-OFF                             28880005
288900                                     TO APKSLIPA                  28890005
289000           MOVE DP015-RED            TO APKSLIPC                  28900005
289100           MOVE DP015-REVERSE        TO APKSLIPH                  28910005
289200           MOVE -1                   TO APKSLIPL                  28920005
289300           SET DP030-SET-CURSOR-APPL-1                            28930005
289400                                     TO TRUE                      28940005
289500       ELSE                                                       28950005
289600           SET DP020-MSG-FATAL                                    28960005
289700               PS-ERROR              TO TRUE                      28970005
289800           MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER          28980005
289900           MOVE DP015-UNP-ALP-BRT-OFF                             28990005
290000                                     TO APKSLIPA                  29000005
290100           MOVE DP015-RED            TO APKSLIPC                  29010005
290200           MOVE DP015-REVERSE        TO APKSLIPH                  29020005
290300           MOVE -1                   TO APKSLIPL                  29030005
290400           SET DP030-SET-CURSOR-APPL-1                            29040005
290500                                     TO TRUE                      29050005
290600       END-IF                                                     29060005
290700     END-IF.                                                      29070005
290800                                                                  29080005
290900     IF  ASC-PAGE-CNT   > ZERO                                    29090005
291000         MOVE ASC-PAGE-CNT         TO DP010I-UNEDITED-FIELD       29100005
291100         MOVE 4                    TO DP010I-MAXIMUM-DIGITS       29110005
291200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     29120005
291300         SET DP010I-NEGATIVE-NOT-ALLOWED                          29130005
291400                                   TO TRUE                        29140005
291510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29151097
291520              USING DP010I-NUMERIC-EDIT-AREA                      29152097
291600                                                                  29160005
291700         IF  DP010I-ERROR-DETECTED                                29170005
291800             SET PS-ERROR                                         29180005
291900                 DP020-MSG-FATAL   TO TRUE                        29190005
292000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            29200005
292100             MOVE DP015-UNP-NUM-BRT-OFF                           29210005
292200                                   TO APAGESA                     29220005
292300             MOVE DP015-RED        TO APAGESC                     29230005
292400             MOVE DP015-REVERSE    TO APAGESH                     29240005
292500             MOVE -1               TO APAGESL                     29250005
292600             SET DP030-SET-CURSOR-APPL-1                          29260005
292700                                   TO TRUE                        29270005
292800         ELSE                                                     29280005
292900             MOVE DP010I-NUMERIC-FIELD                            29290005
293000                                   TO ASC-PAGE-CNT-N              29300005
293100         END-IF                                                   29310005
293200     END-IF.                                                      29320005
293300                                                                  29330005
293400                                                                  29340005
293500     IF  ASC-STR-DEST-NBR > SPACES                                29350005
293600         MOVE ASC-STR-DEST-NBR     TO DP010I-UNEDITED-FIELD       29360005
293700         MOVE LENGTH OF ASC-STR-DEST-NBR                          29370005
293800                                   TO DP010I-MAXIMUM-DIGITS       29380005
293900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     29390005
294000         SET DP010I-NEGATIVE-NOT-ALLOWED                          29400005
294100                                   TO TRUE                        29410005
294210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29421097
294220              USING DP010I-NUMERIC-EDIT-AREA                      29422097
294300                                                                  29430005
294400         IF  DP010I-ERROR-DETECTED                                29440005
294500             SET PS-ERROR                                         29450005
294600                 DP020-MSG-FATAL   TO TRUE                        29460005
294700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            29470005
294800             MOVE DP015-UNP-NUM-BRT-OFF                           29480005
294900                                   TO ASTRA                       29490005
295000             MOVE DP015-RED        TO ASTRC                       29500005
295100             MOVE DP015-REVERSE    TO ASTRH                       29510005
295200             MOVE -1               TO ASTRL                       29520005
295300             SET DP030-SET-CURSOR-APPL-1                          29530005
295400                                   TO TRUE                        29540005
295500         ELSE                                                     29550005
295600             MOVE DP010I-NUMERIC-FIELD                            29560005
295700                                   TO ASC-STR-DEST-NBR-N          29570005
295800                                      DK-STR-DEST-NBR             29580005
295801*** BEGIN - DMH 12/22/15                                          29580183
295810             IF  ASC-STR-DEST-NBR-N  > 0                          29581083
295820*** END   - DMH 12/22/15                                          29582083
295900                 MOVE ASC-STR-DEST-NBR TO ASTRO                   29590083
296000                 INITIALIZE XL071-COMMAREA-REC                    29600083
296100                 MOVE DK-STR-DEST-NBR  TO XL071-LOCATION-NUMBER   29610083
296200                 PERFORM 3300-CHK-OPER-UNT-GET-NAME               29620083
296300*** BEGIN - DMH 1/7/08                                            29630078
296400                 MOVE XL071-LOC-TYP-CDE TO ASC-STR-OPER-TYPE      29640083
296500*** END   - DMH 1/7/08                                            29650078
296600                 PERFORM 3050-CHECK-IF-DC                         29660083
296700                 IF PS-NO-ERROR                                   29670083
296800                     MOVE XL071-LOC-NM TO ASC-STR-DEST-NME        29680083
296900                     PERFORM 3055-CHECK-IF-STORE-CLOSED           29690083
297000                 END-IF                                           29700083
297010*** BEGIN - DMH 12/22/15                                          29701083
297100             END-IF                                               29710083
297101*** END   - DMH 12/22/15                                          29710183
297110         END-IF                                                   29711083
297200     ELSE                                                         29720005
297300         IF RECEIV-PACK-BY-ST-IND = PC-Y AND                      29730005
297400            PS-DONT-BYPASS-PACK-BY-STR-CHK                        29740005
297500             SET DP020-MSG-FATAL                                  29750005
297600                 PS-ERROR          TO TRUE                        29760005
297700             MOVE PC-TSYMSG-00818  TO DP020-MSG-NUMBER            29770005
297800             MOVE DP015-UNP-NUM-BRT-OFF                           29780005
297900                                   TO ASTRA                       29790005
298000             MOVE DP015-RED        TO ASTRC                       29800005
298100             MOVE DP015-REVERSE    TO ASTRH                       29810005
298200             MOVE -1               TO ASTRL                       29820005
298300             SET DP030-SET-CURSOR-APPL-1                          29830005
298400                                   TO TRUE                        29840005
298500         END-IF                                                   29850005
298600     END-IF.                                                      29860005
298700                                                                  29870005
298800     IF  ASC-PO-NBR > ZEROES                                      29880005
298900         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       29890005
299000         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       29900005
299100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     29910005
299200         SET DP010I-NEGATIVE-NOT-ALLOWED                          29920005
299300                                   TO TRUE                        29930005
299410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29941097
299420              USING DP010I-NUMERIC-EDIT-AREA                      29942097
299500                                                                  29950005
299600         IF  DP010I-ERROR-DETECTED                                29960005
299700             SET PS-ERROR                                         29970005
299800                 DP020-MSG-FATAL   TO TRUE                        29980005
299900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            29990005
300000             MOVE DP015-UNP-NUM-BRT-OFF                           30000005
300100                                   TO APOA                        30010005
300200             MOVE DP015-RED        TO APOC                        30020005
300300             MOVE DP015-REVERSE    TO APOH                        30030005
300400             MOVE -1               TO APOL                        30040005
300500             SET DP030-SET-CURSOR-APPL-1                          30050005
300600                                   TO TRUE                        30060005
300700         ELSE                                                     30070005
300800             MOVE DP010I-NUMERIC-FIELD                            30080005
300900                                   TO ASC-PO-NBR-N                30090005
301000                                      DK-PO-NBR                   30100005
301100             MOVE ASC-PO-NBR       TO APOO                        30110005
301200                                                                  30120005
301300             IF ASC-REC-SEQ-NBR NUMERIC                           30130005
301400                 PERFORM 3005-VALIDATE-RECEIVER                   30140005
301500             END-IF                                               30150005
301600         END-IF                                                   30160005
301700     ELSE                                                         30170005
301800         SET PS-ERROR                                             30180005
301900         DP020-MSG-FATAL           TO TRUE                        30190005
302000         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            30200005
302100         MOVE DP015-UNP-NUM-BRT-OFF                               30210005
302200                                   TO APOA                        30220005
302300         MOVE DP015-RED            TO APOC                        30230005
302400         MOVE DP015-REVERSE        TO APOH                        30240005
302500         MOVE -1                   TO APOL                        30250005
302600         SET DP030-SET-CURSOR-APPL-1                              30260005
302700                                   TO TRUE                        30270005
302800     END-IF.                                                      30280005
302900                                                                  30290005
303000*** BEGIN - AHP 1/7/08                                            30300079
303100     IF ASC-OPER-UNT-ID = ZEROES                                  30310096
303200        MOVE ASC-OPER-UNT-ID   TO AOPERO                          30320071
303300                                  DK-OPER-UNT-ID                  30330071
303400        INITIALIZE XL071-COMMAREA-REC                             30340068
303500        MOVE ASC-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER           30350068
303600        PERFORM 3300-CHK-OPER-UNT-GET-NAME                        30360068
303700     END-IF.                                                      30370068
303800*** END   - AHP 1/7/08                                            30380079
303910                                                                  30391095
303920*** BEGIN - DMH 8/28/20                                           30392095
303930     IF ASC-OPER-UNT-ID > ZEROES                                  30393096
303940        MOVE ASC-OPER-UNT-ID   TO AOPERO                          30394095
303950                                  DK-OPER-UNT-ID                  30395095
303960        INITIALIZE XL071-COMMAREA-REC                             30396095
303970        MOVE ASC-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER           30397095
303980        PERFORM 3300-CHK-OPER-UNT-GET-NAME                        30398095
303990*                                                                 30399095
303991        IF  XL071-LOC-TYP-CDE = 'DC' OR                           30399195
303992            XL071-LOC-TYP-CDE = 'DS' OR                           30399295
303993            XL071-LOC-TYP-CDE = 'CS' OR                           30399395
303994            XL071-LOC-TYP-CDE = 'RV' OR                           30399495
303995            XL071-LOC-TYP-CDE = 'HQ'                              30399595
303996            CONTINUE                                              30399695
303997        ELSE                                                      30399795
303998            SET PS-ERROR                                          30399895
303999                DP020-MSG-FATAL         TO TRUE                   30399995
304000            MOVE PC-TSYMSG-01741        TO DP020-MSG-NUMBER       30400095
304001            MOVE DP015-UNP-NUM-BRT-OFF  TO AOPERA                 30400195
304002            MOVE DP015-RED              TO AOPERC                 30400295
304003            MOVE DP015-REVERSE          TO AOPERH                 30400395
304004            MOVE -1                     TO AOPERL                 30400495
304005            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   30400595
304006        END-IF                                                    30400695
304007*                                                                 30400795
304008     END-IF.                                                      30400895
304009*** END   - DMH 8/28/20                                           30400995
304010                                                                  30401095
304020     IF  ASC-OPER-UNT-ID > ZEROES                                 30402005
304100         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       30410005
304200         MOVE LENGTH OF ASC-OPER-UNT-ID                           30420005
304300                                   TO DP010I-MAXIMUM-DIGITS       30430005
304400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     30440005
304500         SET DP010I-NEGATIVE-NOT-ALLOWED                          30450005
304600                                   TO TRUE                        30460005
304710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         30471097
304720              USING DP010I-NUMERIC-EDIT-AREA                      30472097
304800                                                                  30480005
304900         IF  DP010I-ERROR-DETECTED                                30490005
305000             SET PS-ERROR                                         30500005
305100                 DP020-MSG-FATAL   TO TRUE                        30510005
305200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            30520005
305300             MOVE DP015-UNP-NUM-BRT-OFF                           30530005
305400                                   TO AOPERA                      30540005
305500             MOVE DP015-RED        TO AOPERC                      30550005
305600             MOVE DP015-REVERSE    TO AOPERH                      30560005
305700             MOVE -1               TO AOPERL                      30570005
305800             SET DP030-SET-CURSOR-APPL-1                          30580005
305900                                   TO TRUE                        30590005
306000         ELSE                                                     30600005
306100             MOVE DP010I-NUMERIC-FIELD                            30610005
306200                                   TO ASC-OPER-UNT-ID-N           30620005
306300                                      DK-OPER-UNT-ID              30630005
306400             MOVE ASC-OPER-UNT-ID  TO AOPERO                      30640005
306500             INITIALIZE XL071-COMMAREA-REC                        30650026
306600             MOVE ASC-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER      30660026
306700             PERFORM 3300-CHK-OPER-UNT-GET-NAME                   30670019
306800         END-IF                                                   30680005
306900     ELSE                                                         30690005
307000         IF  ASC-OPER-UNT-ID NOT = ASC-KEY-OPER-UNT-ID            30700005
307100             SET PS-ERROR                                         30710005
307200                 DP020-MSG-FATAL       TO TRUE                    30720005
307300             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        30730005
307400             MOVE DP015-UNP-NUM-BRT-OFF                           30740005
307500                                       TO AOPERA                  30750005
307600             MOVE DP015-RED            TO AOPERC                  30760005
307700             MOVE DP015-REVERSE        TO AOPERH                  30770005
307800             MOVE -1                   TO AOPERL                  30780005
307900             SET DP030-SET-CURSOR-APPL-1                          30790005
308000                                       TO TRUE                    30800005
308100         END-IF                                                   30810005
308200     END-IF.                                                      30820005
308300                                                                  30830005
308400     IF PS-NO-ERROR                                               30840005
308500*IR-128A: DON'T ALLOW MAINT IF THE RECEIVER IS STATUS 'VE'        30850005
308600         PERFORM 1200-GET-TRECEIV-STATUS                          30860005
308700         IF RECEIV-STATUS-CDE EQUAL PC-VE OR                      30870005
308800            PS-RECITM-VERIFIED                                    30880005
308900             SET DP020-MSG-FATAL                                  30890005
309000                 PS-ERROR         TO TRUE                         30900005
309100             SET DP030-SET-CURSOR-TRAILER                         30910005
309200                                  TO TRUE                         30920005
309300             MOVE PC-TSYMSG-00734 TO DP020-MSG-NUMBER             30930005
309400     END-IF.                                                      30940005
309500*IR-128A                                                          30950005
309600                                                                  30960005
309700     IF PS-NO-ERROR                                               30970005
309800         IF DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                   30980005
309900             IF (ASC-ADD-PENDING AND                              30990005
310000                ASC-RECORD-ADDED) OR                              31000005
310100                ASC-REC-EXISTS-B4-LOCAL                           31010005
310200                 CONTINUE                                         31020005
310300             ELSE                                                 31030005
310400                 IF ASC-REC-SEQ-NBR > ZEROES                      31040005
310500                     IF ASC-PKSL-NBR      NOT = ASC-PKSL-NBR-OLD  31050005
310600                     OR ASC-REC-SEQ-NBR-N NOT =                   31060005
310700                                           ASC-REC-SEQ-NBR-N-OLD  31070005
310800                         PERFORM 3060-VALIDATE-PKSL-NBR           31080005
310900                     END-IF                                       31090005
311000                 END-IF                                           31100005
311100             END-IF                                               31110005
311200         ELSE                                                     31120005
311300             IF ASC-REC-SEQ-NBR > ZEROES                          31130005
311400                 IF ASC-PKSL-NBR      NOT = ASC-PKSL-NBR-OLD      31140005
311500                 OR ASC-REC-SEQ-NBR-N NOT = ASC-REC-SEQ-NBR-N-OLD 31150005
311600                     PERFORM 3060-VALIDATE-PKSL-NBR               31160005
311700                 END-IF                                           31170005
311800             END-IF                                               31180005
311900         END-IF                                                   31190005
312000     END-IF.                                                      31200005
312100                                                                  31210005
312200     IF  PS-NO-ERROR                                              31220005
312300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     31230005
312400         EVALUATE TRUE                                            31240005
312500             WHEN ASC-ADD-PENDING                                 31250005
312600                 MOVE -1           TO APOL                        31260005
312700                 SET DP030-SET-CURSOR-APPL-1                      31270005
312800                                   TO TRUE                        31280005
312900             WHEN ASC-UPDATE-PENDING                              31290005
313000                 MOVE -1           TO ASTRL                       31300005
313100                 SET DP030-SET-CURSOR-APPL-1                      31310005
313200                                   TO TRUE                        31320005
313300             WHEN ASC-COPY-PENDING                                31330005
313400                 MOVE -1           TO APOL                        31340005
313500                 SET DP030-SET-CURSOR-APPL-1                      31350005
313600                                   TO TRUE                        31360005
313700             WHEN ASC-DELETE-PENDING                              31370005
313800                 SET DP030-SET-CURSOR-TRAILER                     31380005
313900                                   TO TRUE                        31390005
314000         END-EVALUATE                                             31400005
314100     ELSE                                                         31410005
314200         IF ASC-ADD-PENDING                                       31420005
314300             SET ASC-ADD-NOT-SUCCESSFUL                           31430005
314400                 ASC-RECORD-NOT-ADDED                             31440005
314500                                   TO TRUE                        31450005
314600         END-IF                                                   31460005
314700     END-IF.                                                      31470005
314800                                                                  31480005
314900 3001-GET-CURRENT-DATE.                                           31490005
315000                                                                  31500005
315100     EXEC SQL                                                     31510005
315200          SET :PV-DB2-DATE-HOST    =  CURRENT DATE                31520005
315300     END-EXEC.                                                    31530005
315400                                                                  31540005
315500     MOVE PV-DB2-DATE-HOST    TO  PV-DB2-DATE.                    31550005
315600     MOVE PV-DB2-DATE-YY      TO  PV-CURRENT-DATE-YY.             31560005
315700     MOVE PV-DB2-DATE-MM      TO  PV-CURRENT-DATE-MM.             31570005
315800     MOVE PV-DB2-DATE-DD      TO  PV-CURRENT-DATE-DD.             31580005
315900                                                                  31590005
316000 3005-VALIDATE-RECEIVER.                                          31600005
316100     INITIALIZE DCLTRECEIV.                                       31610005
316200                                                                  31620005
316300                                                                  31630005
316400         EXEC SQL                                                 31640005
316500            SELECT  ORD_NBR                                       31650005
316600              INTO :RECEIV-ORD-NBR                                31660005
316700              FROM  TRECEIV                                       31670005
316800             WHERE  ORD_NBR        = :DK-PO-NBR                   31680005
316900               AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR              31690005
317000               AND  VER_STATUS_CDE = :PC-ACTIVE                   31700005
317100               AND  OPER_UNT_ID    = :DK-OPER-UNT-ID              31710005
317200               AND  FCLTY_ID       = :DK-FCLTY-ID                 31720005
317300         END-EXEC                                                 31730005
317400                                                                  31740005
317500         EVALUATE TRUE                                            31750005
317600             WHEN SQLCODE = +0                                    31760005
317700                  SET PS-NO-MULT-SHIPMTS TO TRUE                  31770005
317800                  PERFORM 3007-SELECT-TSHPTPO                     31780005
317900                  PERFORM 3010-CHECK-FOR-TROUBLE                  31790005
318000                                                                  31800005
318100             WHEN SQLCODE = +100                                  31810005
318200                  SET PS-ERROR                                    31820005
318300                      DP020-MSG-FATAL       TO TRUE               31830005
318400                  MOVE PC-TSYMSG-00464      TO DP020-MSG-NUMBER   31840005
318500                  MOVE DP015-UNP-NUM-BRT-OFF                      31850005
318600                                            TO ARECSEQA           31860005
318700                  MOVE DP015-RED            TO ARECSEQC           31870005
318800                  MOVE DP015-REVERSE        TO ARECSEQH           31880005
318900                  MOVE -1                   TO ARECSEQL           31890005
319000                  SET DP030-SET-CURSOR-APPL-1                     31900005
319100                                            TO TRUE               31910005
319200                                                                  31920005
319300             WHEN SQLCODE = -904                                  31930005
319400             WHEN SQLCODE = -911                                  31940005
319500             WHEN SQLCODE = -913                                  31950005
319600                 PERFORM 9900-SOFT-ABORT                          31960005
319700                                                                  31970005
319800             WHEN SQLWARN0 NOT = SPACES                           31980005
319900             WHEN SQLCODE < +0                                    31990005
320000             WHEN SQLCODE > +0                                    32000005
320100                 MOVE '3005-VALIDATE-RECEIVER'                    32010005
320200                                   TO DP013-PARAGRAPH             32020005
320300                 MOVE 'SELECT RECEIVER '                          32030005
320400                                   TO DP013-MESSAGE-TEXT (1)      32040005
320500                 MOVE SQLCA        TO DP013-SQLCA                 32050005
320600                 MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)    32060005
320700                 SET DP013-DB2-ABEND                              32070005
320800                                   TO TRUE                        32080005
320900                 SET DP013-XCTL-DISPLAY-RESTART                   32090005
321000                                   TO TRUE                        32100005
321100                 PERFORM DP013-0000-PROCESS-ABEND                 32110005
321200         END-EVALUATE.                                            32120005
321300                                                                  32130005
321400                                                                  32140005
321500 3007-SELECT-TSHPTPO.                                             32150005
321600     INITIALIZE DCLTSHPTPO.                                       32160005
321700                                                                  32170005
321800                                                                  32180005
321900         EXEC SQL                                                 32190005
322000            SELECT  SHIPT_ID                                      32200005
322100              INTO :SHPTPO-SHIPT-ID                               32210005
322200              FROM  TSHPTPO                                       32220005
322300             WHERE  PO_NBR           = :DK-PO-NBR                 32230005
322400               AND  REC_SEQ_NBR      = :DK-REC-SEQ-NBR            32240005
322500               AND  PRIM_SHIPT_IND   = :PC-Y                      32250005
322600         END-EXEC                                                 32260005
322700                                                                  32270005
322800         EVALUATE TRUE                                            32280005
322900             WHEN SQLCODE = +0                                    32290005
323000                  CONTINUE                                        32300005
323100             WHEN SQLCODE = -904                                  32310005
323200             WHEN SQLCODE = -911                                  32320005
323300             WHEN SQLCODE = -913                                  32330005
323400                  PERFORM 9900-SOFT-ABORT                         32340005
323500                                                                  32350005
323600             WHEN SQLCODE = +100                                  32360005
323700                  MOVE ZERO TO SHPTPO-SHIPT-ID                    32370005
323800                                                                  32380005
323900             WHEN SQLCODE = -811                                  32390005
324000                  MOVE ZERO TO SHPTPO-SHIPT-ID                    32400005
324100                  SET PS-MULT-SHIPMTS TO TRUE                     32410005
324200                                                                  32420005
324300             WHEN SQLWARN0 NOT = SPACES                           32430005
324400             WHEN SQLCODE < +0                                    32440005
324500             WHEN SQLCODE > +0                                    32450005
324600                 MOVE '3007-SELECT-TSHPTPO'                       32460005
324700                                   TO DP013-PARAGRAPH             32470005
324800                 MOVE 'SELECT SHPTPO   '                          32480005
324900                                   TO DP013-MESSAGE-TEXT (1)      32490005
325000                 MOVE SQLCA        TO DP013-SQLCA                 32500005
325100                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    32510005
325200                 SET DP013-DB2-ABEND                              32520005
325300                                   TO TRUE                        32530005
325400                 SET DP013-XCTL-DISPLAY-RESTART                   32540005
325500                                   TO TRUE                        32550005
325600                 PERFORM DP013-0000-PROCESS-ABEND                 32560005
325700         END-EVALUATE.                                            32570005
325800                                                                  32580005
325900 3010-CHECK-FOR-TROUBLE.                                          32590005
326000                                                                  32600005
326100     INITIALIZE TM500-FIELDS.                                     32610005
326200                                                                  32620005
326300     SET  TM500-CREATE-AUTO        TO TRUE.                       32630005
326400     SET  TM500-PO-LEVEL           TO TRUE.                       32640005
326500     SET  TM500-NO-DETAILS         TO TRUE.                       32650005
326600     MOVE ASC-PO-NBR-N             TO TM500-PO-NBR.               32660005
326700     MOVE ASC-KEY-OPER-UNT-ID-N    TO TM500-OPER-UNT-ID.          32670005
326800     MOVE ASC-KEY-FCLTY-ID-N       TO TM500-FCLTY-ID.             32680005
326900     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            32690005
327000                                                                  32700005
327100     IF SHPTPO-SHIPT-ID > 0                                       32710005
327200         PERFORM 9000-GET-SHIPMENT-DATA                           32720005
327300     ELSE                                                         32730005
327400         MOVE ZEROS                TO SHIPMT-SHIPT-ID             32740005
327500         MOVE SPACES               TO SHIPMT-VEND-SHIP-DTE        32750005
327600     END-IF.                                                      32760005
327700                                                                  32770005
327800     MOVE SHIPMT-VEND-SHIP-DTE     TO TM500-VEND-SHIP-DTE.        32780005
327900                                                                  32790005
328000     IF ASC-REC-SEQ-NBR NUMERIC                                   32800005
328100         MOVE ASC-REC-SEQ-NBR-N    TO TM500-REC-SEQ-NBR           32810005
328200     END-IF.                                                      32820005
328300                                                                  32830005
328400     EXEC CICS                                                    32840005
328500         LINK PROGRAM  (PC-TROUBLE-RTN)                           32850005
328600              COMMAREA (TM500-FIELDS)                             32860005
328700              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    32870005
328800     END-EXEC.                                                    32880005
328900                                                                  32890005
329000     IF TM500-CALL-SUCCESSFUL        OR                           32900005
329100        TM500-TPURCHS-SELECT-NOT-FND OR                           32910005
329200        TM500-DUPLICATE-TROUBLE      OR                           32920005
329300        TM500-TTRBNTF-UPDATE-NOT-FND                              32930005
329400         CONTINUE                                                 32940005
329500     ELSE                                                         32950005
329600         MOVE '3010-CHECK-FOR-TROUBLE    '                        32960005
329700                           TO DP013-PARAGRAPH                     32970005
329800         MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'                  32980005
329900                           TO DP013-MESSAGE-TEXT (1)              32990005
330000         MOVE TM500-RETURN-MSG                                    33000005
330100                           TO DP013-MESSAGE-TEXT (2)              33010005
330200         MOVE TM500-SQLCA  TO DP013-SQLCA                         33020005
330300         SET DP013-DB2-ABEND                                      33030005
330400                           TO TRUE                                33040005
330500         SET DP013-XCTL-DISPLAY-RESTART                           33050005
330600                           TO TRUE                                33060005
330700         PERFORM DP013-0000-PROCESS-ABEND                         33070005
330800     END-IF.                                                      33080005
330900                                                                  33090005
331000                                                                  33100005
331100 3012-SELECT-PO-TYP-CDE.                                          33110005
331200                                                                  33120005
331300         EXEC SQL                                                 33130005
331400            SELECT  PO_TYP_CDE                                    33140005
331500              INTO :PURCHS-PO-TYP-CDE                             33150005
331600              FROM  TPURCHS                                       33160005
331700             WHERE  PO_NBR           = :DK-PO-NBR                 33170005
331800               AND  VER_STATUS_CDE   = :PC-ACTIVE                 33180005
331900         END-EXEC                                                 33190005
332000                                                                  33200005
332100         MOVE SPACES TO PC-IMPORT                                 33210005
332200                                                                  33220005
332300         EVALUATE TRUE                                            33230005
332400             WHEN SQLCODE = +0                                    33240005
332500                  SET PS-PO-TYP-CDE-FOUND TO TRUE                 33250005
332600                  MOVE PURCHS-PO-TYP-CDE TO PC-IMPORT             33260005
332700                                                                  33270005
332800             WHEN SQLCODE = -904                                  33280005
332900             WHEN SQLCODE = -911                                  33290005
333000             WHEN SQLCODE = -913                                  33300005
333100                  PERFORM 9900-SOFT-ABORT                         33310005
333200                                                                  33320005
333300             WHEN SQLCODE = +100                                  33330005
333400                  SET PS-PO-TYP-CDE-FOUND-NO TO TRUE              33340005
333500                                                                  33350005
333600             WHEN SQLWARN0 NOT = SPACES                           33360005
333700             WHEN SQLCODE < +0                                    33370005
333800             WHEN SQLCODE > +0                                    33380005
333900                 MOVE '3012-SELECT-PO-TYP-CDE'                    33390005
334000                                   TO DP013-PARAGRAPH             33400005
334100                 MOVE 'SELECT TPURCHS  '                          33410005
334200                                   TO DP013-MESSAGE-TEXT (1)      33420005
334300                 MOVE SQLCA        TO DP013-SQLCA                 33430005
334400                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    33440005
334500                 SET DP013-DB2-ABEND                              33450005
334600                                   TO TRUE                        33460005
334700                 SET DP013-XCTL-DISPLAY-RESTART                   33470005
334800                                   TO TRUE                        33480005
334900                 PERFORM DP013-0000-PROCESS-ABEND                 33490005
335000         END-EVALUATE.                                            33500005
335100                                                                  33510005
335200 3040-VALIDATE-REC-SEQ-NBR.                                       33520019
335300                                                                  33530005
335400                                                                  33540005
335500         EXEC SQL                                                 33550005
335600            SELECT  ORD_NBR,                                      33560005
335700                    PACK_BY_ST_IND                                33570005
335800                  , CHAR (DATE(REC_TMST),ISO)                     33580005
335900              INTO :RECEIV-ORD-NBR,                               33590005
336000                   :RECEIV-PACK-BY-ST-IND                         33600005
336100                 , :PV-RECEIV-REC-DATE                            33610005
336200              FROM  TRECEIV                                       33620005
336300             WHERE  ORD_NBR        = :DK-PO-NBR                   33630005
336400               AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR              33640005
336500               AND  VER_STATUS_CDE = :PC-ACTIVE                   33650005
336600               AND  OPER_UNT_ID    = :DK-OPER-UNT-ID              33660005
336700               AND  FCLTY_ID       = :DK-FCLTY-ID                 33670005
336800         END-EXEC                                                 33680005
336900                                                                  33690005
337000         EVALUATE TRUE                                            33700005
337100             WHEN SQLCODE = +0                                    33710005
337200                  SET PS-DONT-BYPASS-PACK-BY-STR-CHK              33720005
337300                                   TO TRUE                        33730005
337400             WHEN SQLCODE = +100                                  33740005
337500                  SET PS-BYPASS-PACK-BY-STR-CHK                   33750005
337600                                   TO TRUE                        33760005
337700             WHEN SQLCODE = -904                                  33770005
337800             WHEN SQLCODE = -911                                  33780005
337900             WHEN SQLCODE = -913                                  33790005
338000                 PERFORM 9900-SOFT-ABORT                          33800005
338100                                                                  33810005
338200             WHEN SQLWARN0 NOT = SPACES                           33820005
338300             WHEN SQLCODE < +0                                    33830005
338400             WHEN SQLCODE > +0                                    33840005
338500                 MOVE '3040-VALIDATE-REC-SEQ-NBR'                 33850005
338600                                   TO DP013-PARAGRAPH             33860005
338700                 MOVE 'SELECT RECEIVER '                          33870005
338800                                   TO DP013-MESSAGE-TEXT (1)      33880005
338900                 MOVE SQLCA        TO DP013-SQLCA                 33890005
339000                 MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)    33900005
339100                 SET DP013-DB2-ABEND                              33910005
339200                                   TO TRUE                        33920005
339300                 SET DP013-XCTL-DISPLAY-RESTART                   33930005
339400                                   TO TRUE                        33940005
339500                 PERFORM DP013-0000-PROCESS-ABEND                 33950005
339600         END-EVALUATE.                                            33960005
339700                                                                  33970005
339800     IF SQLCODE = +100                                            33980005
339900         SET PS-ERROR                                             33990005
340000             DP020-MSG-FATAL       TO TRUE                        34000005
340100         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            34010005
340200         MOVE DP015-UNP-NUM-BRT-OFF                               34020005
340300                                   TO ARECSEQA                    34030005
340400         MOVE DP015-RED            TO ARECSEQC                    34040005
340500         MOVE DP015-REVERSE        TO ARECSEQH                    34050005
340600         MOVE -1                   TO ARECSEQL                    34060005
340700         SET DP030-SET-CURSOR-APPL-1                              34070005
340800                                   TO TRUE                        34080005
340900     END-IF.                                                      34090005
341000                                                                  34100005
341100******************************************************************34110019
341200*  IF THE OPER UNIT ID IS A DC, THEN NOT GOOD FOR DIRECT STORE    34120019
341300******************************************************************34130019
341400 3050-CHECK-IF-DC.                                                34140005
341500     IF PS-OPER-UNT-STR-FND                                       34150019
341600         IF XL071-LOC-TYP-CDE = PC-DS                             34160019
341700             IF RECEIV-PACK-BY-ST-IND = PC-Y OR                   34170019
341800                PS-BYPASS-PACK-BY-STR-CHK                         34180019
341900                  CONTINUE                                        34190019
342000             ELSE                                                 34200019
342100                  SET DP020-MSG-FATAL                             34210019
342200                      PS-ERROR                TO TRUE             34220019
342300                  MOVE PC-TSYMSG-00818        TO DP020-MSG-NUMBER 34230019
342400                  MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA            34240019
342500                  MOVE DP015-RED              TO ASTRC            34250019
342600                  MOVE DP015-REVERSE          TO ASTRH            34260019
342700                  MOVE -1                     TO ASTRL            34270019
342800                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             34280019
342900             END-IF                                               34290019
343000         ELSE                                                     34300019
343100             SET DP020-MSG-FATAL                                  34310019
343200                 PS-ERROR                TO TRUE                  34320019
343300             MOVE PC-TSYMSG-00638        TO DP020-MSG-NUMBER      34330019
343400             MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA                 34340019
343500             MOVE DP015-RED              TO ASTRC                 34350019
343600             MOVE DP015-REVERSE          TO ASTRH                 34360019
343700             MOVE -1                     TO ASTRL                 34370019
343800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  34380019
343900         END-IF                                                   34390019
344000     END-IF.                                                      34400019
344100                                                                  34410075
344200*** BEGIN - DMH 1/7/08                                            34420075
344300     IF  ASC-KEY-OPER-STORE         AND                           34430075
344400         ASC-STR-OPER-STORE         AND                           34440078
344500         PS-NO-ERROR                                              34450075
344600         IF  ASC-STR-DEST-NBR  =  ASC-OPER-UNT-ID                 34460075
344700             CONTINUE                                             34470075
344800         ELSE                                                     34480075
344900             SET DP020-MSG-FATAL                                  34490075
345000                 PS-ERROR                                         34500076
345100                 ASC-LOCAL-01-NO-NEED-CONFIRM  TO TRUE            34510076
345200             MOVE PC-TSYMSG-03597        TO DP020-MSG-NUMBER      34520077
345300             MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA                 34530077
345400             MOVE DP015-RED              TO ASTRC                 34540077
345500             MOVE DP015-REVERSE          TO ASTRH                 34550077
345600             MOVE -1                     TO ASTRL                 34560077
345700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  34570077
345800         END-IF                                                   34580077
345900     END-IF.                                                      34590077
346000*** END   - DMH 1/7/08                                            34600075
346100                                                                  34610005
346200******************************************************************34620019
346300*  IF THE STORE IS NOT OPEN THEN SEND ERROR MESSAGE               34630019
346400******************************************************************34640019
346500 3055-CHECK-IF-STORE-CLOSED.                                      34650005
346600     IF ((PV-DB2-DATE-HOST = XL071-ASGMT-EFF-BEG-DTE OR           34660027
346700          PV-DB2-DATE-HOST > XL071-ASGMT-EFF-BEG-DTE)             34670027
346800                         AND                                      34680019
346900        (PV-DB2-DATE-HOST = XL071-ASGMT-EFF-STP-DTE OR            34690027
347000         PV-DB2-DATE-HOST < XL071-ASGMT-EFF-STP-DTE))             34700027
347100         CONTINUE                                                 34710019
347200     ELSE                                                         34720019
347300         SET DP020-MSG-FATAL                                      34730019
347400             PS-ERROR               TO TRUE                       34740019
347500         MOVE PC-TSYMSG-00844       TO DP020-MSG-NUMBER           34750019
347600         MOVE DP015-UNP-ALP-BRT-OFF TO ASTRA                      34760019
347700         MOVE DP015-RED             TO ASTRC                      34770019
347800         MOVE DP015-REVERSE         TO ASTRH                      34780019
347900         MOVE -1                    TO ASTRL                      34790019
348000        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       34800019
348100     END-IF.                                                      34810020
348200/                                                                 34820005
348300*----------------------------------------------------------------*34830005
348400*  ALL PACK SLIP NUMBERS NEED TO BE THE SAME  (CONSOLIDATED) OR  *34840005
348500*  ALL PACK SLIP NUMBERS NEED TO BE DIFFERENT (NON-CONSOLIDATED) *34850005
348600*----------------------------------------------------------------*34860005
348700                                                                  34870005
348800 3060-VALIDATE-PKSL-NBR.                                          34880005
348900                                                                  34890005
349000     PERFORM 3070-COUNT-PKSL-NBR.                                 34900005
349100                                                                  34910005
349200     IF PV-PKSL-NBR-CNT > 1                                       34920005
349300         PERFORM 3090-SELECT-USING-PKSL-NBR                       34930005
349400         IF PS-PKSLIP-FOUND                                       34940005
349500             SET DP020-MSG-FATAL                                  34950005
349600                 PS-ERROR          TO TRUE                        34960005
349700             MOVE PC-TSYMSG-00861  TO DP020-MSG-NUMBER            34970005
349800             MOVE DP015-UNP-ALP-BRT-OFF                           34980005
349900                                   TO APKSLIPA                    34990005
350000             MOVE DP015-RED        TO APKSLIPC                    35000005
350100             MOVE DP015-REVERSE    TO APKSLIPH                    35010005
350200             MOVE -1               TO APKSLIPL                    35020005
350300             SET DP030-SET-CURSOR-APPL-1                          35030005
350400                                   TO TRUE                        35040005
350500         END-IF                                                   35050005
350600     ELSE                                                         35060005
350700         PERFORM 3080-COUNT-STR-DEST-NBR                          35070005
350800         IF PV-STR-DEST-NBR-CNT > 1                               35080005
350900             PERFORM 3090-SELECT-USING-PKSL-NBR                   35090005
351000             IF PS-PKSLIP-NOT-FOUND                               35100005
351100                 SET DP020-MSG-FATAL                              35110005
351200                     PS-ERROR      TO TRUE                        35120005
351300                 MOVE PC-TSYMSG-00861                             35130005
351400                                   TO DP020-MSG-NUMBER            35140005
351500                 MOVE DP015-UNP-ALP-BRT-OFF                       35150005
351600                                   TO APKSLIPA                    35160005
351700                 MOVE DP015-RED    TO APKSLIPC                    35170005
351800                 MOVE DP015-REVERSE                               35180005
351900                                   TO APKSLIPH                    35190005
352000                 MOVE -1           TO APKSLIPL                    35200005
352100                 SET DP030-SET-CURSOR-APPL-1                      35210005
352200                                   TO TRUE                        35220005
352300             END-IF                                               35230005
352400         END-IF                                                   35240005
352500     END-IF.                                                      35250005
352600                                                                  35260005
352700 3070-COUNT-PKSL-NBR.                                             35270005
352800                                                                  35280005
352900                                                                  35290005
353000     INITIALIZE PV-PKSL-NBR-CNT.                                  35300005
353100                                                                  35310005
353200                                                                  35320005
353300         EXEC SQL                                                 35330005
353400             SELECT COUNT(DISTINCT PKSL_NBR)                      35340005
353500              INTO  :PV-PKSL-NBR-CNT :PV-COUNT-IND                35350005
353600               FROM TPKSLIP                                       35360005
353700              WHERE PO_NBR          = :DK-PO-NBR                  35370005
353800                AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR             35380005
353900                AND VER_STAT_CDE    = :PC-ACTIVE                  35390005
354000         END-EXEC                                                 35400005
354100                                                                  35410005
354200         EVALUATE TRUE                                            35420005
354300             WHEN SQLCODE = ZERO                                  35430005
354400             WHEN SQLCODE = +100                                  35440005
354500                  CONTINUE                                        35450005
354600             WHEN SQLCODE = -904                                  35460005
354700             WHEN SQLCODE = -911                                  35470005
354800             WHEN SQLCODE = -913                                  35480005
354900             MOVE '3070-COUNT-PKSL-NBR' TO  PV-BOMB-PARA          35490005
355000             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         35500005
355100             MOVE DK-PO-NBR             TO  PV-BOMB-PO            35510005
355200             MOVE ZERO                  TO PV-BOMB-PKSL-SEQ       35520005
355300             MOVE SPACE                 TO PV-BOMB-PKSL           35530005
355400             MOVE ZERO                  TO PV-BOMB-STORE          35540005
355500                  PERFORM 9900-SOFT-ABORT                         35550005
355600                                                                  35560005
355700             WHEN SQLWARN0 NOT = SPACES                           35570005
355800             WHEN SQLCODE  NOT = ZERO                             35580005
355900                  MOVE '3070-COUNT-PKSL-NBR'                      35590005
356000                                 TO DP013-PARAGRAPH               35600005
356100                  MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP NBRS'       35610005
356200                                 TO DP013-MESSAGE-TEXT (1)        35620005
356300                  MOVE SQLCA     TO DP013-SQLCA                   35630005
356400                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      35640005
356500                  SET DP013-DB2-ABEND                             35650005
356600                      DP013-XCTL-DISPLAY-RESTART                  35660005
356700                                 TO TRUE                          35670005
356800                  PERFORM DP013-0000-PROCESS-ABEND                35680005
356900         END-EVALUATE.                                            35690005
357000                                                                  35700005
357100 3080-COUNT-STR-DEST-NBR.                                         35710005
357200                                                                  35720005
357300     INITIALIZE PV-STR-DEST-NBR-CNT.                              35730005
357400                                                                  35740005
357500                                                                  35750005
357600         EXEC SQL                                                 35760005
357700             SELECT COUNT(DISTINCT STR_DEST_NBR)                  35770005
357800              INTO  :PV-STR-DEST-NBR-CNT :PV-COUNT-IND            35780005
357900               FROM TPKSLIP                                       35790005
358000              WHERE PO_NBR          = :DK-PO-NBR                  35800005
358100                AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR             35810005
358200                AND VER_STAT_CDE    = :PC-ACTIVE                  35820005
358300         END-EXEC                                                 35830005
358400                                                                  35840005
358500         EVALUATE TRUE                                            35850005
358600             WHEN SQLCODE = ZERO                                  35860005
358700             WHEN SQLCODE = +100                                  35870005
358800                  CONTINUE                                        35880005
358900             WHEN SQLCODE = -904                                  35890005
359000             WHEN SQLCODE = -911                                  35900005
359100             WHEN SQLCODE = -913                                  35910005
359200             MOVE '3080-COUNT-STR-DEST-NBR' TO PV-BOMB-PARA       35920005
359300             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         35930005
359400             MOVE DK-PO-NBR             TO  PV-BOMB-PO            35940005
359500             MOVE ZERO                  TO PV-BOMB-PKSL-SEQ       35950005
359600             MOVE SPACE                 TO PV-BOMB-PKSL           35960005
359700             MOVE ZERO                  TO PV-BOMB-STORE          35970005
359800                  PERFORM 9900-SOFT-ABORT                         35980005
359900                                                                  35990005
360000             WHEN SQLWARN0 NOT = SPACES                           36000005
360100             WHEN SQLCODE  NOT = ZERO                             36010005
360200                  MOVE '3080-COUNT-STR-DEST-NBR'                  36020005
360300                                 TO DP013-PARAGRAPH               36030005
360400                  MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP STRS'       36040005
360500                                 TO DP013-MESSAGE-TEXT (1)        36050005
360600                  MOVE SQLCA     TO DP013-SQLCA                   36060005
360700                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      36070005
360800                  SET DP013-DB2-ABEND                             36080005
360900                      DP013-XCTL-DISPLAY-RESTART                  36090005
361000                                 TO TRUE                          36100005
361100                  PERFORM DP013-0000-PROCESS-ABEND                36110005
361200         END-EVALUATE.                                            36120005
361300                                                                  36130005
361400 3090-SELECT-USING-PKSL-NBR.                                      36140005
361500                                                                  36150005
361600                                                                  36160005
361700         EXEC SQL                                                 36170005
361800             SELECT PKSL_NBR                                      36180005
361900              INTO  :PV-PKSL-NBR                                  36190005
362000               FROM TPKSLIP                                       36200005
362100              WHERE PO_NBR          = :DK-PO-NBR                  36210005
362200                AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR             36220005
362300                AND PKSL_NBR        = :ASC-PKSL-NBR               36230005
362400                AND VER_STAT_CDE    = :PC-ACTIVE                  36240005
362500         END-EXEC                                                 36250005
362600                                                                  36260005
362700         EVALUATE TRUE                                            36270005
362800             WHEN SQLCODE = ZERO                                  36280005
362900             WHEN SQLCODE = -811                                  36290005
363000                  SET PS-PKSLIP-FOUND                             36300005
363100                                 TO TRUE                          36310005
363200             WHEN SQLCODE = +100                                  36320005
363300                  SET PS-PKSLIP-NOT-FOUND                         36330005
363400                                 TO TRUE                          36340005
363500             WHEN SQLCODE = -904                                  36350005
363600             WHEN SQLCODE = -911                                  36360005
363700             WHEN SQLCODE = -913                                  36370005
363800                  PERFORM 9900-SOFT-ABORT                         36380005
363900                                                                  36390005
364000             WHEN SQLWARN0 NOT = SPACES                           36400005
364100             WHEN SQLCODE  NOT = ZERO                             36410005
364200                  MOVE '3090-SELECT-USING-PKSL-NBR'               36420005
364300                                 TO DP013-PARAGRAPH               36430005
364400                  MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'           36440005
364500                                 TO DP013-MESSAGE-TEXT (1)        36450005
364600                  MOVE SQLCA     TO DP013-SQLCA                   36460005
364700                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      36470005
364800                  SET DP013-DB2-ABEND                             36480005
364900                      DP013-XCTL-DISPLAY-RESTART                  36490005
365000                                 TO TRUE                          36500005
365100                  PERFORM DP013-0000-PROCESS-ABEND                36510005
365200         END-EVALUATE.                                            36520005
365300                                                                  36530005
365400/                                                                 36540005
365500*----------------------------------------------------------------*36550005
365600*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *36560005
365700*  ENTERED IS VALID.                                             *36570005
365800*----------------------------------------------------------------*36580005
365900                                                                  36590005
366000 3100-VALIDATE-SCAC-CDE.                                          36600005
366100                                                                  36610005
366200         EXEC SQL                                                 36620005
366300              SELECT ENT_NAME_DESC                                36630005
366400                INTO :ENTNME-ENT-NAME-DESC                        36640005
366500                FROM TEXTENT A                                    36650005
366600                    ,TENTNME B                                    36660005
366700               WHERE A.SCAC_CDE    = :DK-SCAC-ID                  36670005
366800                 AND A.CARRIER_IND = 'Y'                          36680005
366900                 AND B.TYPE_CDE    = '01'                         36690005
367000                 AND A.ENT_ID = B.ENT_ID                          36700005
367100               WITH UR                                            36710080
367200         END-EXEC                                                 36720005
367300                                                                  36730005
367400         EVALUATE TRUE                                            36740005
367500             WHEN SQLCODE = +0                                    36750005
367600             WHEN SQLCODE = -811                                  36760005
367700                 MOVE ENTNME-ENT-NAME-DESC                        36770005
367800                                   TO ASC-SCAC-CODE-DESC          36780005
367900             WHEN SQLCODE = +100                                  36790005
368000                 MOVE ALL '?'      TO ASC-SCAC-CODE-DESC          36800005
368100                                      ASCACDSO                    36810005
368200             WHEN SQLCODE = -904                                  36820005
368300             WHEN SQLCODE = -911                                  36830005
368400             WHEN SQLCODE = -913                                  36840005
368500                 PERFORM 9900-SOFT-ABORT                          36850005
368600                                                                  36860005
368700             WHEN SQLWARN0 NOT = SPACES                           36870005
368800             WHEN SQLCODE < +0                                    36880005
368900             WHEN SQLCODE > +0                                    36890005
369000                 MOVE '3100-VALIDATE-SCAC-CDE'                    36900005
369100                                 TO DP013-PARAGRAPH               36910005
369200                 MOVE 'SELECT SCAC CODE'                          36920005
369300                                 TO DP013-MESSAGE-TEXT (1)        36930005
369400                 MOVE SQLCA      TO DP013-SQLCA                   36940005
369500                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      36950005
369600                 SET DP013-DB2-ABEND                              36960005
369700                                 TO TRUE                          36970005
369800                 SET DP013-XCTL-DISPLAY-RESTART                   36980005
369900                                 TO TRUE                          36990005
370000                 PERFORM DP013-0000-PROCESS-ABEND                 37000005
370100         END-EVALUATE.                                            37010005
370200                                                                  37020005
370300/                                                                 37030005
370400*----------------------------------------------------------------*37040005
370500* CHECK IF CONTAINER EXISTS ON TIMCNTK.                          *37050005
370600*----------------------------------------------------------------*37060005
370700 3110-VALIDATE-CONTAINER.                                         37070005
370800                                                                  37080005
370900     PERFORM                                                      37090005
371000         WITH TEST AFTER                                          37100005
371100         VARYING PV-RETRY-COUNTER                                 37110005
371200         FROM 1 BY 1                                              37120005
371300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37130005
371400             OR (SQLCODE = +0)                                    37140005
371500             OR (SQLCODE = -811)                                  37150005
371600             OR (SQLCODE = +100))                                 37160005
371700                                                                  37170005
371800         EXEC SQL                                                 37180005
371900             SELECT   A.CONTNR_ID                                 37190005
372000                    , A.MOM_TRIP_TYP_CDE                          37200005
372100                    , A.FDR_TRIP_TYP_CDE                          37210005
372200               INTO   :IMCNTK-CONTNR-ID                           37220005
372300                    , :IMCNTK-MOM-TRIP-TYP-CDE                    37230005
372400                    , :IMCNTK-FDR-TRIP-TYP-CDE                    37240005
372500               FROM   TIMCNTK A                                   37250005
372600              WHERE   A.CONTNR_ID = :DK-CONTNR-ID                 37260005
372700         END-EXEC                                                 37270005
372800                                                                  37280005
372900         EVALUATE TRUE                                            37290005
373000             WHEN SQLCODE = +0                                    37300005
373100             WHEN SQLCODE = -811                                  37310005
373200                 SET PS-CONTAINER-EXISTS    TO TRUE               37320005
373300                                                                  37330005
373400             WHEN SQLCODE = +100                                  37340005
373500                 SET PS-CONTAINER-EXISTS-NO TO TRUE               37350005
373600                                                                  37360005
373700             WHEN SQLCODE = -904                                  37370005
373800             WHEN SQLCODE = -911                                  37380005
373900             WHEN SQLCODE = -913                                  37390005
374000                 PERFORM 9900-SOFT-ABORT                          37400005
374100                                                                  37410005
374200             WHEN SQLWARN0 NOT = SPACES                           37420005
374300             WHEN SQLCODE < +0                                    37430005
374400             WHEN SQLCODE > +0                                    37440005
374500                 MOVE '3110-VALIDATE-CONTAINER '                  37450005
374600                                   TO DP013-PARAGRAPH             37460005
374700                 MOVE 'SELECT A TIMCNTK ROW   '                   37470005
374800                                   TO DP013-MESSAGE-TEXT(1)       37480005
374900                 MOVE SQLCA        TO DP013-SQLCA                 37490005
375000                 MOVE 'TIMCNTK'    TO DP013-DB2-TABLE-NAME (1)    37500005
375100                 SET DP013-DB2-ABEND                              37510005
375200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37520005
375300                 PERFORM DP013-0000-PROCESS-ABEND                 37530005
375400         END-EVALUATE                                             37540005
375500     END-PERFORM.                                                 37550005
375600                                                                  37560005
375700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37570005
375800         MOVE '3110-VALIDATE-CONTAINER '                          37580005
375900                                   TO DP013-PARAGRAPH             37590005
376000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37600005
376100                                   TO DP013-MESSAGE-TEXT (1)      37610005
376200         MOVE 'TO SELECT A TIMCNTK ROW'                           37620005
376300                                   TO DP013-MESSAGE-TEXT (2)      37630005
376400         MOVE SQLCA                TO DP013-SQLCA                 37640005
376500         MOVE 'TIMCNTK'            TO DP013-DB2-TABLE-NAME (1)    37650005
376600         SET DP013-DB2-ABEND                                      37660005
376700             DP013-XCTL-DISPLAY-RESTART                           37670005
376800                                   TO TRUE                        37680005
376900         PERFORM DP013-0000-PROCESS-ABEND                         37690005
377000     END-IF.                                                      37700005
377100                                                                  37710005
377200*----------------------------------------------------------------*37720005
377300* CHECK TO SEE IF FIRST 4 BYTES ON CONTAINER ID ARE CHARACTER.   *37730005
377400*----------------------------------------------------------------*37740005
377500 3115-CHECK-CONTNR-ID.                                            37750005
377600                                                                  37760005
377700     IF IMCNTK-MOM-TRIP-TYP-CDE = PC-A OR                         37770005
377800        IMCNTK-FDR-TRIP-TYP-CDE = PC-A                            37780005
377900         SET PS-VALID-CONTNR-ID       TO TRUE                     37790005
378000     ELSE                                                         37800005
378100        IF ASC-CONTNR-ID (1:1) NUMERIC OR                         37810005
378200           ASC-CONTNR-ID (2:1) NUMERIC OR                         37820005
378300           ASC-CONTNR-ID (3:1) NUMERIC OR                         37830005
378400           ASC-CONTNR-ID (4:1) NUMERIC                            37840005
378500            SET PS-VALID-CONTNR-ID-NO TO TRUE                     37850005
378600        ELSE                                                      37860005
378700            SET PS-VALID-CONTNR-ID    TO TRUE                     37870005
378800        END-IF                                                    37880005
378900     END-IF.                                                      37890005
379000                                                                  37900005
379100*----------------------------------------------------------------*37910005
379200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *37920005
379300*----------------------------------------------------------------*37930005
379400                                                                  37940005
379500 3200-RESET-ATTRIBUTES.                                           37950005
379600                                                                  37960005
379700                                                                  37970005
379800     EVALUATE TRUE                                                37980005
379900*DC-154 FROM HERE                                                 37990005
380000         WHEN ASC-READ-ONLY                                       38000005
380100              MOVE DP015-ASK-NOR-OFF                              38010005
380200                                   TO APKSLIPA                    38020005
380300                                      ABOLA                       38030005
380400                                      APROA                       38040005
380500                                      ASRCA                       38050005
380600                                      APOA                        38060005
380700                                      ARECSEQA                    38070005
380800                                      ASTRA                       38080005
380900                                      ACRTNA                      38090005
381000                                      AOSCACA                     38100005
381100                                      AVSHPDTA                    38110005
381200              MOVE DP015-BLUE      TO APOC                        38120005
381300                                      ARECSEQC                    38130005
381400                                      ASTRC                       38140005
381500                                      APKSLIPC                    38150005
381600                                      ABOLC                       38160005
381700                                      APROC                       38170005
381800                                      ACRTNC                      38180005
381900                                      ASRCC                       38190005
382000                                      AOSCACC                     38200005
382100                                      AVSHPDTC                    38210005
382200              MOVE DP015-HL-OFF    TO APOH                        38220005
382300                                      ARECSEQH                    38230005
382400                                      ASTRH                       38240005
382500                                      APKSLIPH                    38250005
382600                                      ABOLH                       38260005
382700                                      APROH                       38270005
382800                                      ACRTNH                      38280005
382900                                      ASRCH                       38290005
383000                                      AOSCACH                     38300005
383100                                      AVSHPDTH                    38310005
383200*DC-154 TO HERE                                                   38320005
383300         WHEN ASC-ADD-PENDING                                     38330005
383400              MOVE DP015-UNP-ALP-NOR-OFF                          38340005
383500                                   TO APKSLIPA                    38350005
383600                                      ABOLA                       38360005
383700                                      APROA                       38370005
383800                                      ASRCA                       38380005
383900                                      AOSCACA                     38390005
384000                                      AVSHPDTA                    38400005
384100              MOVE DP015-UNP-NUM-NOR-OFF                          38410005
384200                                   TO APOA                        38420005
384300                                      ARECSEQA                    38430005
384400                                      ASTRA                       38440005
384500                                      ACRTNA                      38450005
384600              MOVE DP015-GREEN     TO APOC                        38460005
384700                                      ARECSEQC                    38470005
384800                                      ASTRC                       38480005
384900                                      APKSLIPC                    38490005
385000                                      ABOLC                       38500005
385100                                      APROC                       38510005
385200                                      ACRTNC                      38520005
385300                                      ASRCC                       38530005
385400                                      AOSCACC                     38540005
385500                                      AVSHPDTC                    38550005
385600              MOVE DP015-UNDERLINE TO APOH                        38560005
385700                                      ARECSEQH                    38570005
385800                                      ASTRH                       38580005
385900                                      APKSLIPH                    38590005
386000                                      ABOLH                       38600005
386100                                      APROH                       38610005
386200                                      ACRTNH                      38620005
386300                                      ASRCH                       38630005
386400                                      AOSCACH                     38640005
386500                                      AVSHPDTH                    38650005
386600                                                                  38660005
386700              MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                  38670005
386800              PERFORM 3012-SELECT-PO-TYP-CDE                      38680005
386900              IF PS-PO-TYP-CDE-FOUND AND                          38690005
387000                                PC-IMPORT-EXT                     38700005
387100                  CONTINUE                                        38710005
387200              ELSE                                                38720005
387300                  MOVE DP015-PRO-NOR-OFF TO ACONTNRA              38730005
387400                  MOVE DP015-BLUE        TO ACONTNRC              38740005
387500                  MOVE DP015-HL-OFF      TO ACONTNRH              38750005
387600                  MOVE DP015-PRO-DRK-MDT TO ACONTNRA              38760005
387700              END-IF                                              38770005
387800                                                                  38780005
387900         WHEN ASC-UPDATE-PENDING                                  38790005
388000             MOVE DP015-PRO-NOR-OFF                               38800005
388100                                   TO APOA                        38810005
388200             MOVE DP015-BLUE       TO APOC                        38820005
388300             MOVE DP015-HL-OFF     TO APOH                        38830005
388400             MOVE DP015-UNP-ALP-NOR-OFF                           38840005
388500                                   TO APKSLIPA                    38850005
388600                                      ABOLA                       38860005
388700                                      APROA                       38870005
388800                                      ASRCA                       38880005
388900                                      AOSCACA                     38890005
389000                                      AVSHPDTA                    38900005
389100             MOVE DP015-UNP-NUM-NOR-OFF                           38910005
389200                                   TO ARECSEQA                    38920005
389300                                      ASTRA                       38930005
389400                                      ACRTNA                      38940005
389500                                      AOPERA                      38950005
389600             MOVE DP015-GREEN      TO ARECSEQC                    38960005
389700                                      ASTRC                       38970005
389800                                      APKSLIPC                    38980005
389900                                      ABOLC                       38990005
390000                                      APROC                       39000005
390100                                      ACRTNC                      39010005
390200                                      ASRCC                       39020005
390300                                      AOPERC                      39030005
390400                                      AOSCACC                     39040005
390500                                      AVSHPDTC                    39050005
390600             MOVE DP015-UNDERLINE  TO ARECSEQH                    39060005
390700                                      ASTRH                       39070005
390800                                      APKSLIPH                    39080005
390900                                      ABOLH                       39090005
391000                                      APROH                       39100005
391100                                      ACRTNH                      39110005
391200                                      ASRCH                       39120005
391300                                      AOPERH                      39130005
391400                                      AOSCACH                     39140005
391500                                      AVSHPDTH                    39150005
391600                                                                  39160005
391700             MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                   39170005
391800             PERFORM 3012-SELECT-PO-TYP-CDE                       39180005
391900             IF PS-PO-TYP-CDE-FOUND AND                           39190005
392000                                    PC-IMPORT-EXT                 39200005
392100                 CONTINUE                                         39210005
392200             ELSE                                                 39220005
392300                 MOVE DP015-PRO-NOR-OFF TO ACONTNRA               39230005
392400                 MOVE DP015-BLUE        TO ACONTNRC               39240005
392500                 MOVE DP015-HL-OFF      TO ACONTNRH               39250005
392600                 MOVE DP015-PRO-DRK-MDT TO ACONTNRA               39260005
392700             END-IF                                               39270005
392800                                                                  39280005
392900         WHEN ASC-COPY-PENDING                                    39290005
393000             MOVE DP015-PRO-NOR-OFF                               39300005
393100                                   TO APOA                        39310005
393200             MOVE DP015-BLUE       TO APOC                        39320005
393300             MOVE DP015-HL-OFF     TO APOH                        39330005
393400             MOVE DP015-UNP-ALP-NOR-OFF                           39340005
393500                                   TO APKSLIPA                    39350005
393600                                      ABOLA                       39360005
393700                                      APROA                       39370005
393800                                      ASRCA                       39380005
393900                                      AOSCACA                     39390005
394000                                      AVSHPDTA                    39400005
394100                                      ACONTNRA                    39410005
394200             MOVE DP015-UNP-NUM-NOR-OFF                           39420005
394300                                   TO ARECSEQA                    39430005
394400                                      ASTRA                       39440005
394500                                      ACRTNA                      39450005
394600                                      AOPERA                      39460005
394700             MOVE DP015-GREEN      TO ARECSEQC                    39470005
394800                                      ASTRC                       39480005
394900                                      APKSLIPC                    39490005
395000                                      ABOLC                       39500005
395100                                      APROC                       39510005
395200                                      ACRTNC                      39520005
395300                                      ASRCC                       39530005
395400                                      AOPERC                      39540005
395500                                      AOSCACC                     39550005
395600                                      AVSHPDTC                    39560005
395700                                      ACONTNRC                    39570005
395800             MOVE DP015-UNDERLINE  TO ARECSEQH                    39580005
395900                                      ASTRH                       39590005
396000                                      APKSLIPH                    39600005
396100                                      ABOLH                       39610005
396200                                      APROH                       39620005
396300                                      ACRTNH                      39630005
396400                                      ASRCH                       39640005
396500                                      AOPERH                      39650005
396600                                      AOSCACH                     39660005
396700                                      AVSHPDTH                    39670005
396800                                      ACONTNRH                    39680005
396900                                                                  39690005
397000              MOVE ASC-KEY-PO-NBR-N TO DK-PO-NBR                  39700005
397100              PERFORM 3012-SELECT-PO-TYP-CDE                      39710005
397200              IF PS-PO-TYP-CDE-FOUND AND                          39720005
397300                                     PC-IMPORT-EXT                39730005
397400                  CONTINUE                                        39740005
397500              ELSE                                                39750005
397600                  MOVE DP015-PRO-NOR-OFF TO ACONTNRA              39760005
397700                  MOVE DP015-BLUE        TO ACONTNRC              39770005
397800                  MOVE DP015-HL-OFF      TO ACONTNRH              39780005
397900                  MOVE DP015-PRO-DRK-MDT TO ACONTNRA              39790005
398000              END-IF                                              39800005
398100                                                                  39810005
398200                                                                  39820005
398300         WHEN ASC-DELETE-PENDING                                  39830005
398400             MOVE DP015-PRO-NOR-OFF                               39840005
398500                                   TO APOA                        39850005
398600                                      AOPERA                      39860005
398700                                      AFCLTYA                     39870005
398800                                      ASTRA                       39880005
398900                                      ARECSEQA                    39890005
399000                                      APKSLIPA                    39900005
399100                                      ABOLA                       39910005
399200                                      APROA                       39920005
399300                                      ACRTNA                      39930005
399400                                      ASRCA                       39940005
399500                                      AOSCACA                     39950005
399600                                      AVSHPDTA                    39960005
399700                                      ACONTNRA                    39970005
399800             MOVE DP015-BLUE       TO APOC                        39980005
399900                                      AOPERC                      39990005
400000                                      AFCLTYC                     40000005
400100                                      ASTRC                       40010005
400200                                      ARECSEQC                    40020005
400300                                      APKSLIPC                    40030005
400400                                      ABOLC                       40040005
400500                                      APROC                       40050005
400600                                      ACRTNC                      40060005
400700                                      ASRCC                       40070005
400800                                      AOSCACC                     40080005
400900                                      AVSHPDTC                    40090005
401000                                      ACONTNRC                    40100005
401100             MOVE DP015-HL-OFF     TO APOH                        40110005
401200                                      AOPERH                      40120005
401300                                      AFCLTYH                     40130005
401400                                      ASTRH                       40140005
401500                                      ARECSEQH                    40150005
401600                                      APKSLIPH                    40160005
401700                                      ABOLH                       40170005
401800                                      APROH                       40180005
401900                                      ACRTNH                      40190005
402000                                      ASRCH                       40200005
402100                                      AOSCACH                     40210005
402200                                      AVSHPDTH                    40220005
402300                                      ACONTNRH                    40230005
402400     END-EVALUATE.                                                40240005
402500                                                                  40250005
402600     IF  DP020-NEXT-ACT-INITIAL                                   40260005
402700         EVALUATE TRUE                                            40270005
402800            WHEN ASC-UPDATE-PENDING                               40280005
402900                MOVE -1            TO ASTRL                       40290005
403000                SET DP030-SET-CURSOR-APPL-1                       40300005
403100                                   TO TRUE                        40310005
403200            WHEN ASC-COPY-PENDING                                 40320005
403300                MOVE -1            TO APOL                        40330005
403400                SET DP030-SET-CURSOR-APPL-1                       40340005
403500                                   TO TRUE                        40350005
403600            WHEN ASC-DELETE-PENDING                               40360005
403700                SET DP030-SET-CURSOR-TRAILER                      40370005
403800                                   TO TRUE                        40380005
403900         END-EVALUATE                                             40390005
404000     END-IF.                                                      40400005
404100                                                                  40410005
404200*----------------------------------------------------------------*40420005
404300*  CHECK THAT THE OPER UNIT ENTERED ON THE MAP IS VALID AND       40430019
404400*    BRING BACK THE LOCATION NAME                                 40440019
404500*    XL071-COMMAREA-REC IS INITIALIZED AND XL071-LOCATION-NUMBER  40450027
404600*    IS FILLED IN PRIOR TO PERFORMING THIS PARAGRAPH              40460027
404700*    XL071-LOCATION-NM IS MOVED TO THE APPROPRIATE FIELD AFTER    40470027
404800*    GOING BACK TO WHERE IT CAME FROM                             40480027
404900*----------------------------------------------------------------*40490005
405000 3300-CHK-OPER-UNT-GET-NAME.                                      40500019
405100     INITIALIZE PS-OPER-UNT-STR-FND-SW.                           40510026
405200                                                                  40520019
405300     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    40530019
405400                                      XL071-COMMAREA              40540019
405500                                      XL071-COMMAREA-REC.         40550019
405600                                                                  40560019
405700     EVALUATE TRUE                                                40570019
405800         WHEN XL071-NO-ERRORS                                     40580019
405900             SET PS-OPER-UNT-STR-FND TO TRUE                      40590074
405950                                                                  40595093
406000         WHEN XL071-LOC-NOT-FOUND                                 40600026
406100             SET PS-OPER-UNT-STR-NOT-FND                          40610019
406200                 PS-ERROR                                         40620019
406300                 DP020-MSG-FATAL         TO TRUE                  40630019
406400             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      40640019
406500             MOVE DP015-UNP-NUM-BRT-OFF  TO AOPERA                40650019
406600             MOVE DP015-RED              TO AOPERC                40660019
406700             MOVE DP015-REVERSE          TO AOPERH                40670019
406800             MOVE -1                     TO AOPERL                40680019
406900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  40690019
407000*** BEGIN - AHP 1/7/08                                            40700079
407100         WHEN XL071-LOCATION-NUMBER = ZERO                        40710073
407200            AND XL071-LOC-TYP-CDE = PC-OP                         40720073
407300             SET PS-OPER-UNT-STR-NOT-FND                          40730073
407400                 PS-ERROR                                         40740073
407500                 DP020-MSG-FATAL         TO TRUE                  40750073
407600             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      40760073
407700             MOVE DP015-UNP-NUM-BRT-OFF  TO AOPERA                40770073
407800             MOVE DP015-RED              TO AOPERC                40780073
407900             MOVE DP015-REVERSE          TO AOPERH                40790073
408000             MOVE -1                     TO AOPERL                40800073
408100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  40810073
408200*** END   - AHP 1/7/08                                            40820079
408300         WHEN XL071-SQLCODE-N = -904                              40830029
408400         WHEN XL071-SQLCODE-N = -911                              40840029
408500         WHEN XL071-SQLCODE-N = -913                              40850029
408600             SET PS-OPER-UNT-STR-NOT-FND TO TRUE                  40860019
408700             PERFORM 9900-SOFT-ABORT                              40870019
408800         WHEN XL071-BAD-DB2-RETURN                                40880019
408900             SET PS-OPER-UNT-STR-NOT-FND TO TRUE                  40890019
409000             MOVE '3300-CHK-OPER-UNT-GET-NAME'                    40900019
409100                                   TO DP013-PARAGRAPH             40910005
409200             MOVE 'SELECT LOCATION FROM XLT_LOC'                  40920019
409300                                   TO DP013-MESSAGE-TEXT (1)      40930005
409400             MOVE XL071-SQLCA      TO DP013-SQLCA                 40940019
409500             MOVE XL071-SQLCODE-N    TO SQLCODE                   40950029
409600             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    40960019
409700             SET DP013-DB2-ABEND                                  40970019
409800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40980019
409900                 PERFORM DP013-0000-PROCESS-ABEND                 40990005
410000     END-EVALUATE.                                                41000019
410100                                                                  41010005
410200/                                                                 41020005
410300*----------------------------------------------------------------*41030005
410400*    SAVE SCREEN FIELDS FOR LATER COMPARISONS                    *41040005
410500*----------------------------------------------------------------*41050005
410600                                                                  41060005
410700 3500-SAVE-SCREEN-FIELDS.                                         41070005
410800                                                                  41080005
410900     MOVE ASC-REC-SEQ-NBR-N        TO ASC-REC-SEQ-NBR-N-OLD.      41090005
411000     MOVE ASC-STR-DEST-NBR-N       TO ASC-STR-DEST-NBR-N-OLD.     41100005
411100     MOVE ASC-PKSL-NBR             TO ASC-PKSL-NBR-OLD.           41110005
411200     MOVE ASC-BOL-NBR              TO ASC-BOL-NBR-OLD.            41120005
411300                                                                  41130005
411400/                                                                 41140005
411500*----------------------------------------------------------------*41150005
411600*  THIS PARAGRAPH BUILDS THE SCREEN FOR THE FOLLOWING MODES:     *41160005
411700*  "UPDATE", "DELETE" AND "COPY".                                *41170005
411800*----------------------------------------------------------------*41180005
411900                                                                  41190005
412000 4000-BUILD-INITIAL-PANEL.                                        41200005
412100                                                                  41210005
412200     MOVE PV-DB2-MONTH             TO PV-MONTH.                   41220005
412300     MOVE PV-DB2-DAY               TO PV-DAY.                     41230005
412400     MOVE PV-DB2-YEAR              TO PV-YEAR.                    41240005
412500     MOVE PV-DISPLAY-DATE          TO ASC-LAST-UPD-BY-DTE.        41250005
412600     MOVE PV-DB2-HOUR              TO PV-HOUR.                    41260005
412700     MOVE PV-DB2-MINUTE            TO PV-MINUTE.                  41270005
412800     MOVE PV-DISPLAY-TIME          TO ASC-LAST-UPD-BY-TME.        41280005
412900     MOVE PKSLIP-CRE-UID           TO ASC-LAST-UPD-BY-UID.        41290005
413000     MOVE PKSLIP-PKSL-NBR          TO ASC-PKSL-NBR.               41300005
413100     MOVE PKSLIP-PKSL-PG-CNT       TO ASC-PAGE-CNT-N.             41310005
413200                                                                  41320005
413300     IF PKSLIP-STR-DEST-NBR = ZEROS                               41330005
413400         MOVE SPACES               TO ASC-STR-DEST-NBR            41340005
413500     ELSE                                                         41350005
413600         MOVE PKSLIP-STR-DEST-NBR  TO ASC-STR-DEST-NBR-N          41360005
413700     END-IF                                                       41370005
413800                                                                  41380005
413900     MOVE PKSLIP-REC-SEQ-NBR       TO ASC-REC-SEQ-NBR-N.          41390005
414000     MOVE PKSLIP-BOL-NBR           TO ASC-BOL-NBR                 41400005
414100                                      ASC-KEY-BOL-NBR.            41410005
414200     MOVE PKSLIP-PRO-NBR           TO ASC-PRO-NBR                 41420005
414300                                      ASC-KEY-PRO-NBR.            41430005
414400     MOVE PKSLIP-PKSL-STAT-CDE     TO ASC-PKSL-STAT-CDE.          41440005
414500     MOVE PKSLIP-EXPTED-PKG-QTY    TO ASC-EXPTED-PKG-QTY-N.       41450005
414600                                                                  41460055
414700     PERFORM 8190-SUM-INPKSU-CARTONS.                             41470055
414800     MOVE PV-INPKSU-CRTN-CNT       TO ASC-INPKSU-COUNT.           41480048
414900                                                                  41490050
415000     MOVE PKSLIP-CRE-SRC-CDE       TO ASC-CRE-SRC-CDE.            41500005
415100     MOVE PKSLIP-OWNER-SCAC-ID     TO ASC-ORIGIN-SCAC-CDE.        41510005
415200                                                                  41520005
415300     MOVE PKSLIP-PO-NBR TO DK-PO-NBR.                             41530005
415400     PERFORM 3012-SELECT-PO-TYP-CDE.                              41540005
415500     IF PC-IMPORT-EXT                                             41550005
415600       IF PS-PO-TYP-CDE-FOUND                                     41560005
415700         IF PKSLIP-CONTNR-ID > SPACES                             41570005
415800             MOVE PKSLIP-CONTNR-ID TO ASC-CONTNR-ID               41580005
415900         ELSE                                                     41590005
416000             MOVE SPACES           TO ASC-CONTNR-ID               41600005
416100         END-IF                                                   41610005
416200        ELSE                                                      41620005
416300            MOVE DP015-PRO-NOR-OFF TO ACONTNRA                    41630005
416400            MOVE DP015-BLUE        TO ACONTNRC                    41640005
416500            MOVE DP015-HL-OFF      TO ACONTNRH                    41650005
416600            MOVE SPACES            TO ASC-CONTNR-ID               41660005
416700       END-IF                                                     41670005
416800     END-IF.                                                      41680005
416900                                                                  41690005
417000     IF ASC-ORIGIN-SCAC-CDE > SPACES                              41700005
417100         MOVE ASC-ORIGIN-SCAC-CDE  TO DK-SCAC-ID                  41710005
417200         PERFORM 3100-VALIDATE-SCAC-CDE                           41720005
417300     END-IF.                                                      41730005
417400                                                                  41740005
417500     MOVE PKSLIP-ASN-NBR           TO ASC-ASN-NBR.                41750005
417600                                                                  41760005
417700     IF PKSLIP-VEND-SHIP-DTE > PC-DEFAULT-DATE                    41770005
417800         MOVE PKSLIP-VEND-SHIP-DTE TO PV-DB2-DATE                 41780005
417900         MOVE PV-DB2-DATE-MM       TO PV-DD-MONTH                 41790005
418000         MOVE PV-DB2-DATE-DD       TO PV-DD-DAY                   41800005
418100         MOVE PV-DB2-DATE-YY       TO PV-DD-YEAR                  41810005
418200         MOVE PV-DISPLAY-DATE2     TO ASC-VND-SHIP-DTE            41820005
418300     ELSE                                                         41830005
418400         MOVE SPACES               TO ASC-VND-SHIP-DTE            41840005
418500     END-IF.                                                      41850005
418600                                                                  41860005
418700     EVALUATE ASC-PKSL-STAT-CDE                                   41870005
418800         WHEN PC-AC                                               41880005
418900             MOVE PC-AC-DESC       TO ASC-PKSL-STAT-DESC          41890005
419000         WHEN PC-CM                                               41900005
419100             MOVE PC-CM-DESC       TO ASC-PKSL-STAT-DESC          41910005
419200         WHEN PC-IN                                               41920005
419300             MOVE PC-IN-DESC       TO ASC-PKSL-STAT-DESC          41930005
419400         WHEN PC-IP                                               41940005
419500             MOVE PC-IP-DESC       TO ASC-PKSL-STAT-DESC          41950005
419600         WHEN PC-VE                                               41960005
419700             MOVE PC-VE-DESC       TO ASC-PKSL-STAT-DESC          41970005
419800     END-EVALUATE.                                                41980005
419900                                                                  41990005
420000     PERFORM 4010-SELECT-ORIG-PKSLIP.                             42000005
420100                                                                  42010005
420200     IF PS-PREV-UPDATE                                            42020005
420300         MOVE PV-DB2-MONTH         TO PV-MONTH                    42030005
420400         MOVE PV-DB2-DAY           TO PV-DAY                      42040005
420500         MOVE PV-DB2-YEAR          TO PV-YEAR                     42050005
420600         MOVE PV-DISPLAY-DATE      TO ASC-CREATED-BY-DTE          42060005
420700         MOVE PV-DB2-HOUR          TO PV-HOUR                     42070005
420800         MOVE PV-DB2-MINUTE        TO PV-MINUTE                   42080005
420900         MOVE PV-DISPLAY-TIME      TO ASC-CREATED-BY-TME          42090005
421000         MOVE PKSLIP-CRE-UID       TO ASC-CREATED-BY-UID          42100005
421100     ELSE                                                         42110005
421200         MOVE ASC-LAST-UPD-BY-UID  TO ASC-CREATED-BY-UID          42120005
421300         MOVE ASC-LAST-UPD-BY-DTE  TO ASC-CREATED-BY-DTE          42130005
421400         MOVE ASC-LAST-UPD-BY-TME  TO ASC-CREATED-BY-TME          42140005
421500     END-IF.                                                      42150005
421600                                                                  42160005
421700     INITIALIZE XL071-COMMAREA-REC.                               42170026
421800     MOVE ASC-STR-DEST-NBR-N TO XL071-LOCATION-NUMBER             42180026
421900     PERFORM 3300-CHK-OPER-UNT-GET-NAME.                          42190026
422000     IF XL071-NO-ERRORS                                           42200025
422100         IF XL071-LOC-TYP-CDE = PC-DC                             42210025
422200             MOVE XL071-LOC-NM  TO ASC-STR-DEST-NME               42220025
422300         END-IF                                                   42230025
422400     END-IF.                                                      42240025
422500                                                                  42250005
422600     IF DK-REC-SEQ-NBR > +0                                       42260005
422700         SET PS-NO-MULT-SHIPMTS TO TRUE                           42270005
422800         PERFORM 4200-GET-SHPTPO                                  42280005
422900         IF PS-NO-MULT-SHIPMTS                                    42290005
423000             PERFORM 4100-GET-SHIP-INFO                           42300005
423100         ELSE                                                     42310005
423200             MOVE PC-MULTIPLE-SHIPMTS                             42320005
423300                                 TO ASC-SHIPMT-BOL-NBR            42330005
423400                                    ASC-SHIPMT-PRO-NBR            42340005
423500             MOVE ZERO           TO ASC-SHIPMT-PKG-QTY-N          42350005
423600         END-IF                                                   42360005
423700     ELSE                                                         42370005
423800         MOVE SPACES               TO ASC-SHIPMT-BOL-NBR          42380005
423900                                      ASC-SHIPMT-PRO-NBR          42390005
424000                                      ASC-SHIPMT-PKG-QTY          42400005
424100     END-IF.                                                      42410005
424200                                                                  42420005
424300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        42430005
424400                                                                  42440005
424500/                                                                 42450005
424600*----------------------------------------------------------------*42460005
424700*    READ THE ORIGINAL PACK SLIP HEADER                          *42470005
424800*----------------------------------------------------------------*42480005
424900 4010-SELECT-ORIG-PKSLIP.                                         42490005
425000                                                                  42500005
425100                                                                  42510005
425200         EXEC SQL                                                 42520005
425300              SELECT  MONTH (A.CRE_TMST),                         42530005
425400                      DAY   (A.CRE_TMST),                         42540005
425500                      YEAR  (A.CRE_TMST),                         42550005
425600                      HOUR  (A.CRE_TMST),                         42560005
425700                      MINUTE(A.CRE_TMST),                         42570005
425800                     A.CRE_UID                                    42580005
425900                INTO :PV-DB2-MONTH,                               42590005
426000                     :PV-DB2-DAY,                                 42600005
426100                     :PV-DB2-YEAR,                                42610005
426200                     :PV-DB2-HOUR,                                42620005
426300                     :PV-DB2-MINUTE,                              42630005
426400                     :PKSLIP-CRE-UID                              42640005
426500                FROM TPKSLIP A                                    42650005
426600               WHERE A.PO_NBR       = :DK-PO-NBR                  42660005
426700                 AND A.SEQ_NBR      = :ASC-SEQ-NBR                42670005
426800                 AND A.VER_STAT_CDE = :PC-INACTIVE                42680005
426900                 AND A.CRE_TMST =                                 42690005
427000                     (SELECT MIN (B.CRE_TMST)                     42700005
427100                        FROM TPKSLIP B                            42710005
427200                       WHERE A.PO_NBR  = B.PO_NBR                 42720005
427300                         AND A.SEQ_NBR = B.SEQ_NBR)               42730005
427400         END-EXEC                                                 42740005
427500                                                                  42750005
427600         EVALUATE TRUE                                            42760005
427700             WHEN SQLCODE = +0                                    42770005
427800                  SET PS-PREV-UPDATE                              42780005
427900                                   TO TRUE                        42790005
428000                                                                  42800005
428100             WHEN SQLCODE = +100                                  42810005
428200                  SET PS-NO-PREV-UPDATE                           42820005
428300                                   TO TRUE                        42830005
428400                                                                  42840005
428500             WHEN SQLCODE = -904                                  42850005
428600             WHEN SQLCODE = -911                                  42860005
428700             WHEN SQLCODE = -913                                  42870005
428800                  PERFORM 9900-SOFT-ABORT                         42880005
428900                                                                  42890005
429000             WHEN SQLWARN0 NOT = SPACES                           42900005
429100             WHEN SQLCODE < +0                                    42910005
429200             WHEN SQLCODE > +0                                    42920005
429300                  MOVE '4010-SELECT-ORIG-PKSLIP'                  42930005
429400                                   TO DP013-PARAGRAPH             42940005
429500                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     42950005
429600                                   TO DP013-MESSAGE-TEXT (1)      42960005
429700                  MOVE SQLCA       TO DP013-SQLCA                 42970005
429800                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    42980005
429900                  SET DP013-DB2-ABEND                             42990005
430000                      DP013-XCTL-DISPLAY-RESTART                  43000005
430100                                   TO TRUE                        43010005
430200                  PERFORM DP013-0000-PROCESS-ABEND                43020005
430300         END-EVALUATE.                                            43030005
430400                                                                  43040005
430500/                                                                 43050005
430600*----------------------------------------------------------------*43060005
430700*    GET THE SHIPMENT INFORMATION FOR THE "SHIPMENT WINDOW"      *43070005
430800*----------------------------------------------------------------*43080005
430900 4100-GET-SHIP-INFO.                                              43090005
431000                                                                  43100005
431100                                                                  43110005
431200         EXEC SQL                                                 43120005
431300              SELECT A.PRO_NBR                                    43130005
431400                   , A.BOL_NBR                                    43140005
431500                   , A.EXPTED_PKG_QTY                             43150005
431600                INTO :SHIPMT-PRO-NBR                              43160005
431700                   , :SHIPMT-BOL-NBR                              43170005
431800                   , :SHIPMT-EXPTED-PKG-QTY                       43180005
431900                FROM TSHIPMT A                                    43190005
432000                   , TSHPTPO B                                    43200005
432100               WHERE A.SHIPT_ID    = B.SHIPT_ID                   43210005
432200                 AND B.PO_NBR      = :DK-PO-NBR                   43220005
432300                 AND B.REC_SEQ_NBR = :DK-REC-SEQ-NBR              43230005
432400         END-EXEC                                                 43240005
432500                                                                  43250005
432600         EVALUATE TRUE                                            43260005
432700             WHEN SQLCODE = +0                                    43270005
432800                 MOVE SHIPMT-BOL-NBR TO ASC-SHIPMT-BOL-NBR        43280005
432900                 MOVE SHIPMT-PRO-NBR TO ASC-SHIPMT-PRO-NBR        43290005
433000                 MOVE SHIPMT-EXPTED-PKG-QTY                       43300005
433100                                     TO ASC-SHIPMT-PKG-QTY-N      43310005
433200                                                                  43320005
433300             WHEN SQLCODE = +100                                  43330005
433400                 MOVE SPACES         TO ASC-SHIPMT-BOL-NBR        43340005
433500                                        ASC-SHIPMT-PRO-NBR        43350005
433600                 MOVE 0              TO ASC-SHIPMT-PKG-QTY-N      43360005
433700                                                                  43370005
433800             WHEN SQLCODE = -904                                  43380005
433900             WHEN SQLCODE = -911                                  43390005
434000             WHEN SQLCODE = -913                                  43400005
434100                  PERFORM 9900-SOFT-ABORT                         43410005
434200                                                                  43420005
434300             WHEN SQLWARN0 NOT = SPACES                           43430005
434400             WHEN SQLCODE < +0                                    43440005
434500             WHEN SQLCODE > +0                                    43450005
434600                  MOVE '4100-GET-SHIP-INFO'                       43460005
434700                                  TO DP013-PARAGRAPH              43470005
434800                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT TABLE'     43480005
434900                                  TO DP013-MESSAGE-TEXT (1)       43490005
435000                  MOVE DK-SHIPT-ID                                43500005
435100                                  TO DP013-MESSAGE-TEXT (2)       43510005
435200                  MOVE SQLCA      TO DP013-SQLCA                  43520005
435300                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     43530005
435400                  SET DP013-DB2-ABEND                             43540005
435500                      DP013-XCTL-DISPLAY-RESTART                  43550005
435600                                  TO TRUE                         43560005
435700                  PERFORM DP013-0000-PROCESS-ABEND                43570005
435800         END-EVALUATE.                                            43580005
435900                                                                  43590005
436000/                                                                 43600005
436100*----------------------------------------------------------------*43610005
436200*    CHECK FOR MULTIPLE SHIPMENTS PER RECEIVER                   *43620005
436300*----------------------------------------------------------------*43630005
436400 4200-GET-SHPTPO.                                                 43640005
436500                                                                  43650005
436600                                                                  43660005
436700         EXEC SQL                                                 43670005
436800            SELECT  SHIPT_ID                                      43680005
436900              INTO :SHPTPO-SHIPT-ID                               43690005
437000              FROM  TSHPTPO                                       43700005
437100             WHERE  PO_NBR           = :DK-PO-NBR                 43710005
437200               AND  REC_SEQ_NBR      = :DK-REC-SEQ-NBR            43720005
437300         END-EXEC                                                 43730005
437400                                                                  43740005
437500         EVALUATE TRUE                                            43750005
437600             WHEN SQLCODE = +0                                    43760005
437700                  CONTINUE                                        43770005
437800             WHEN SQLCODE = -904                                  43780005
437900             WHEN SQLCODE = -911                                  43790005
438000             WHEN SQLCODE = -913                                  43800005
438100                  PERFORM 9900-SOFT-ABORT                         43810005
438200                                                                  43820005
438300             WHEN SQLCODE = +100                                  43830005
438400                  MOVE ZERO TO SHPTPO-SHIPT-ID                    43840005
438500                                                                  43850005
438600             WHEN SQLCODE = -811                                  43860005
438700                  MOVE ZERO TO SHPTPO-SHIPT-ID                    43870005
438800                  SET PS-MULT-SHIPMTS TO TRUE                     43880005
438900                                                                  43890005
439000             WHEN SQLWARN0 NOT = SPACES                           43900005
439100             WHEN SQLCODE < +0                                    43910005
439200             WHEN SQLCODE > +0                                    43920005
439300                 MOVE '4200-GET-SHPTPO'                           43930005
439400                                   TO DP013-PARAGRAPH             43940005
439500                 MOVE 'SELECT SHPTPO   '                          43950005
439600                                   TO DP013-MESSAGE-TEXT (1)      43960005
439700                 MOVE SQLCA        TO DP013-SQLCA                 43970005
439800                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    43980005
439900                 SET DP013-DB2-ABEND                              43990005
440000                                   TO TRUE                        44000005
440100                 SET DP013-XCTL-DISPLAY-RESTART                   44010005
440200                                   TO TRUE                        44020005
440300                 PERFORM DP013-0000-PROCESS-ABEND                 44030005
440400         END-EVALUATE.                                            44040005
440500                                                                  44050047
440600*----------------------------------------------------------------*44060005
440700*  THIS PARAGRAPH BUILDS THE SCREEN FOR "ADD" MODE ONLY.         *44070005
440800*  MOST VALUES HAVE BEEN ALREADY RETRIEVED FROM THE EDIT SECTION.*44080005
440900*  THIS WAS NECESSARY SINCE WE ARE DEFAULTING NUMEROUS VALUES    *44090005
441000*  AND THE FACT THAT ERRORS WILL BE DISPLAYED IMMEDIATELY.       *44100005
441100*----------------------------------------------------------------*44110005
441200                                                                  44120005
441300 4500-BUILD-INITIAL-ADD-PANEL.                                    44130005
441400                                                                  44140005
441500     SET ASC-RECORD-NOT-ADDED      TO TRUE.                       44150005
441600     MOVE SPACES                   TO ASC-VND-SHIP-DTE.           44160005
441700                                                                  44170005
441800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        44180005
441900                                                                  44190005
442000/                                                                 44200005
442100*----------------------------------------------------------------*44210005
442200*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *44220005
442300*----------------------------------------------------------------*44230005
442400 4400-MOVE-COMMAREA-TO-SCREEN.                                    44240005
442500                                                                  44250005
442600     MOVE ASC-PO-NBR               TO APOO.                       44260005
442700     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     44270005
442800     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    44280005
442900     MOVE ASC-KEY-FCLTY-NME        TO AFDESCO.                    44290005
443000     MOVE ASC-PO-TRBL-DESC         TO ATRBLO.                     44300005
443100     MOVE ASC-STR-DEST-NBR         TO ASTRO.                      44310005
443200                                                                  44320005
443300     IF ASC-STR-DEST-NBR NUMERIC                                  44330005
443400         MOVE ASC-STR-DEST-NBR-N   TO DK-STR-DEST-NBR             44340005
443500         IF ASC-STR-DEST-NBR = ZEROS                              44350005
443600             MOVE SPACES           TO ASTRO                       44360005
443700         END-IF                                                   44370005
443800     END-IF.                                                      44380005
443900                                                                  44390005
444000     MOVE ASC-STR-DEST-NME         TO ASDESCO.                    44400005
444100     MOVE ASC-PKSL-NBR             TO APKSLIPO.                   44410005
444200     IF ASC-PAGE-CNT = ZEROES                                     44420005
444300        MOVE SPACES                TO APAGESO                     44430005
444400     ELSE                                                         44440005
444500        MOVE ASC-PAGE-CNT          TO APAGESO                     44450005
444600     END-IF.                                                      44460005
444700     MOVE ASC-BOL-NBR              TO ABOLO.                      44470005
444800     MOVE ASC-SHIPMT-BOL-NBR       TO ASHPBOLO.                   44480005
444900     MOVE ASC-PRO-NBR              TO APROO.                      44490005
445000     MOVE ASC-SHIPMT-PRO-NBR       TO ASHPPROO.                   44500005
445100     MOVE ASC-EXPTED-PKG-QTY-N     TO ACRTNO.                     44510005
445200     MOVE ASC-SHIPMT-PKG-QTY-N     TO ASHCRTNO.                   44520005
445300     MOVE ASC-CRE-SRC-CDE          TO ASRCO.                      44530005
445400                                                                  44540005
445500     IF ASC-REC-SEQ-NBR = ZEROS                                   44550005
445600         MOVE SPACES               TO ARECSEQO                    44560005
445700     ELSE                                                         44570005
445800         MOVE ASC-REC-SEQ-NBR      TO ARECSEQO                    44580005
445900     END-IF.                                                      44590005
446000                                                                  44600005
446100     MOVE ASC-PKSL-STAT-CDE        TO ASTATO.                     44610005
446200     MOVE ASC-PKSL-STAT-DESC       TO ASTDESCO.                   44620005
446300     MOVE ASC-CREATED-BY-UID       TO ACRTBYO.                    44630005
446400     MOVE ASC-CREATED-BY-DTE       TO ACRTDTEO.                   44640005
446500     MOVE ASC-CREATED-BY-TME       TO ACRTTMEO.                   44650005
446600*LMM                                                              44660048
446700     MOVE ASC-INPKSU-COUNT         TO ASSCCO.                     44670048
446800     MOVE ASC-LAST-UPD-BY-UID      TO ALSTBYO.                    44680005
446900     MOVE ASC-LAST-UPD-BY-DTE      TO ALSTDTEO.                   44690005
447000     MOVE ASC-LAST-UPD-BY-TME      TO ALSTTMEO.                   44700005
447100                                                                  44710005
447200     MOVE ASC-ORIGIN-SCAC-CDE      TO AOSCACO.                    44720005
447300     MOVE ASC-SCAC-CODE-DESC       TO ASCACDSO.                   44730005
447400     MOVE ASC-VND-SHIP-DTE         TO AVSHPDTO.                   44740005
447500     MOVE ASC-ASN-NBR              TO ASNBRO.                     44750005
447600     MOVE ASC-CONTNR-ID            TO ACONTNRO.                   44760005
447700                                                                  44770005
447800     IF (ASC-READ-ONLY                                            44780005
447900     OR  ASC-BAD-FCLTY)                                           44790005
448000         SET DP030-SET-CURSOR-TRAILER  TO TRUE                    44800005
448100     END-IF.                                                      44810005
448200                                                                  44820005
448300     IF  ASC-BAD-FCLTY                                            44830005
448400         MOVE PC-TSYMSG-00010      TO  DP020-MSG-NUMBER           44840005
448500         MOVE DP015-RED            TO  AFCLTYC                    44850005
448600         MOVE DP015-REVERSE        TO  AFCLTYH                    44860005
448700     END-IF.                                                      44870005
448800/                                                                 44880005
448900*----------------------------------------------------------------*44890005
449000*    PERFORM ADD NEW PACK SLIP HEADER PROCESSING                 *44900005
449100*----------------------------------------------------------------*44910005
449200                                                                  44920005
449300 5000-ADD-PACK-SLIP-HEADER.                                       44930005
449400                                                                  44940005
449500     INITIALIZE DCLTPKSLIP.                                       44950005
449600                                                                  44960005
449700     MOVE ASC-PO-NBR-N             TO PKSLIP-PO-NBR.              44970005
449800     MOVE ASC-KEY-OPER-UNT-ID-N    TO PKSLIP-OPER-UNT-ID.         44980005
449900     MOVE ASC-KEY-FCLTY-ID-N       TO PKSLIP-FCLTY-ID.            44990005
450000     MOVE ASC-PKSL-NBR             TO PKSLIP-PKSL-NBR.            45000005
450100     MOVE ASC-STR-DEST-NBR-N       TO PKSLIP-STR-DEST-NBR.        45010005
450200     MOVE ASC-PAGE-CNT-N           TO PKSLIP-PKSL-PG-CNT.         45020005
450300                                                                  45030005
450400     IF ASC-STR-DEST-NBR NUMERIC                                  45040005
450500         MOVE ASC-STR-DEST-NBR-N   TO PKSLIP-STR-DEST-NBR         45050005
450600     ELSE                                                         45060005
450700         MOVE ZEROS                TO PKSLIP-STR-DEST-NBR         45070005
450800     END-IF.                                                      45080005
450900                                                                  45090005
451000     MOVE ASC-EXPTED-PKG-QTY-N     TO PKSLIP-EXPTED-PKG-QTY.      45100005
451100                                                                  45110005
451200     MOVE ASC-ORIGIN-SCAC-CDE      TO PKSLIP-OWNER-SCAC-ID.       45120005
451300     MOVE ASC-ASN-NBR              TO PKSLIP-ASN-NBR.             45130005
451400                                                                  45140005
451500     IF ASC-VND-SHIP-DTE = SPACES                                 45150005
451600         MOVE PC-DEFAULT-DATE      TO PKSLIP-VEND-SHIP-DTE        45160005
451700     ELSE                                                         45170005
451800         INITIALIZE  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56          45180005
451900         SET DPG51-ACTUAL-CALENDAR-ONLY                           45190005
452000             DPG51-DO-NOT-INCR-DECR-DATE                          45200005
452100             DPG52-LK-DTE-GREG     TO TRUE                        45210005
452200                                                                  45220005
452300         MOVE ASC-VND-SHIP-DD          TO PV-COMP-DD              45230005
452400         MOVE ASC-VND-SHIP-MM          TO PV-COMP-MM              45240005
452500         MOVE ASC-VND-SHIP-YY          TO PV-COMP-YY              45250005
452600         MOVE PV-COMPARE-DATE          TO DPG52-LK-DATE-INPUT     45260005
452700                                                                  45270005
452800         CALL DP500-KOHLS-CALENDAR-ROUTINE                        45280005
452900                          USING DPG51 DPG52 DPG53                 45290005
453000                                DPG54 DPG55 DPG56                 45300005
453100         IF DPG54-NO-ERROR                                        45310005
453200             MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DB2-DATE           45320005
453300                                            PKSLIP-VEND-SHIP-DTE  45330005
453400         ELSE                                                     45340005
453500             SET PS-ERROR                                         45350005
453600                 DP020-MSG-FATAL   TO TRUE                        45360005
453700             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            45370005
453800             MOVE DP015-RED        TO AVSHPDTC                    45380005
453900             MOVE DP015-REVERSE    TO AVSHPDTH                    45390005
454000             MOVE -1               TO AVSHPDTL                    45400005
454100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  45410005
454200         END-IF                                                   45420005
454300     END-IF.                                                      45430005
454400                                                                  45440005
454500     MOVE ASC-CONTNR-ID   TO PKSLIP-CONTNR-ID.                    45450005
454600                                                                  45460005
454700     IF ASC-REC-SEQ-NBR > ZEROS                                   45470005
454800         MOVE ASC-REC-SEQ-NBR-N    TO PKSLIP-REC-SEQ-NBR          45480005
454900     ELSE                                                         45490005
455000         MOVE ZEROS                TO PKSLIP-REC-SEQ-NBR          45500005
455100     END-IF.                                                      45510005
455200                                                                  45520005
455300     IF SHPTPO-SHIPT-ID > 0                                       45530005
455400         PERFORM 9000-GET-SHIPMENT-DATA                           45540005
455500     ELSE                                                         45550005
455600         MOVE ZEROS                TO SHIPMT-SHIPT-ID             45560005
455700         MOVE SPACES               TO SHIPMT-VEND-SHIP-DTE        45570005
455800     END-IF.                                                      45580005
455900                                                                  45590005
456000     MOVE SHIPMT-SHIPT-ID          TO PKSLIP-SHIPT-ID.            45600005
456100     MOVE ASC-BOL-NBR              TO PKSLIP-BOL-NBR.             45610005
456200     MOVE ASC-PRO-NBR              TO PKSLIP-PRO-NBR.             45620005
456300     MOVE ASC-CRE-SRC-CDE          TO PKSLIP-CRE-SRC-CDE.         45630005
456400     MOVE PC-IN                    TO PKSLIP-PKSL-STAT-CDE.       45640005
456500                                                                  45650005
456600     PERFORM 9050-GET-PO-VER-NBR.                                 45660005
456700     MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR.          45670005
456800                                                                  45680005
456900     PERFORM 5030-GET-NEXT-SEQ-NBR.                               45690005
457000     MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR              45700005
457100                                      ASC-SEQ-NBR.                45710005
457200                                                                  45720005
457300     MOVE ASC-REC-SEQ-NBR-N        TO DK-REC-SEQ-NBR.             45730005
457400     PERFORM 5005-FIND-TPKSLIP.                                   45740005
457500     IF  SQLCODE NOT EQUAL +100                                   45750005
457600         SET DP020-MSG-FATAL       TO TRUE                        45760005
457700         MOVE PC-TSYMSG-00868      TO DP020-MSG-NUMBER            45770005
457800         MOVE DP015-UNP-ALP-NOR-OFF TO APKSLIPA                   45780005
457900         MOVE DP015-RED            TO APKSLIPC                    45790005
458000         MOVE DP015-REVERSE        TO APKSLIPH                    45800005
458100         MOVE -1                   TO APKSLIPL                    45810005
458200         SET DP030-SET-CURSOR-APPL-1                              45820005
458300             ASC-RECORD-NOT-ADDED  TO TRUE                        45830005
458400     ELSE                                                         45840005
458500         PERFORM 5001-CONTINUE-INSERT                             45850005
458600         PERFORM 2195-CHECK-IF-IN-TROUBLE                         45860005
458700         IF PV-DB2-COUNT > ZERO                                   45870005
458800             MOVE PC-TSYMSG-01011  TO DP020-MSG-NUMBER            45880005
458900         ELSE                                                     45890005
459000             MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            45900005
459100         END-IF                                                   45910005
459200         SET DP020-MSG-INFORMATIONAL                              45920005
459300             ASC-ADD-SUCCESSFUL    TO TRUE                        45930005
459400         PERFORM 3500-SAVE-SCREEN-FIELDS                          45940005
459500         MOVE SPACES               TO ASC-PKSL-NBR-OLD            45950005
459600         MOVE ZEROS                TO ASC-REC-SEQ-NBR-N-OLD       45960005
459700     END-IF.                                                      45970005
459800                                                                  45980005
459900 5001-CONTINUE-INSERT.                                            45990005
460000                                                                  46000005
460100     SET PS-PKSLIP-NOT-INSERTED    TO TRUE.                       46010005
460200     PERFORM 5003-GET-CURRENT-TMST.                               46020005
460300     IF  SQLCODE NOT EQUAL ZERO                                   46030005
460400         SET PS-ERROR              TO TRUE                        46040005
460500         SET DP020-MSG-FATAL       TO TRUE                        46050005
460600         MOVE SQLCODE              TO PV-DISPLAY-SQLCODE          46060005
460700         STRING 'NNNNN-E-DB2 ERROR OCCURED OBTAINING TIMESTAMP'   46070005
460800                '.  SQLCODE = '                                   46080005
460900                PV-DISPLAY-SQLCODE DELIMITED BY SIZE              46090005
461000                                 INTO DP020-MSG-MESSAGE           46100005
461100         MOVE DP015-PRO-NOR-OFF    TO APOA                        46110005
461200         MOVE DP015-RED            TO APOC                        46120005
461300         MOVE DP015-REVERSE        TO APOH                        46130005
461400         SET DP030-SET-CURSOR-TRAILER                             46140005
461500                                   TO TRUE                        46150005
461600     ELSE                                                         46160005
461700         SET PV-DB2-TMST-SS-01                                    46170005
461800             PV-DB2-TMST-MS-ZERO   TO  TRUE                       46180005
461900         PERFORM 5002-INSERT-LOOP                                 46190005
462000             UNTIL PS-PKSLIP-INSERTED                             46200005
462100     END-IF.                                                      46210005
462200                                                                  46220005
462300*----------------------------------------------------------------*46230005
462400*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *46240005
462500*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *46250005
462600*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *46260005
462700*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMSTAMP IS PART   *46270005
462800*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *46280005
462900*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *46290005
463000*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *46300005
463100*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *46310005
463200*----------------------------------------------------------------*46320005
463300                                                                  46330005
463400 5002-INSERT-LOOP.                                                46340005
463500                                                                  46350005
463600     PERFORM 5010-INSERT-TPKSLIP.                                 46360005
463700                                                                  46370005
463800     EVALUATE TRUE                                                46380005
463900         WHEN SQLCODE EQUAL ZERO                                  46390005
464000              SET PS-PKSLIP-INSERTED                              46400005
464100                                   TO TRUE                        46410005
464200                                                                  46420005
464300         WHEN SQLCODE EQUAL -803                                  46430005
464400              ADD 1                TO PKSLIP-SEQ-NBR              46440005
464500                                                                  46450005
464600         WHEN OTHER                                               46460005
464700              SET PS-ERROR         TO TRUE                        46470005
464800              SET DP020-MSG-FATAL  TO TRUE                        46480005
464900              MOVE PC-TSYMSG-00868 TO DP020-MSG-NUMBER            46490005
465000              MOVE DP015-PRO-NOR-OFF TO APOA                      46500005
465100              MOVE DP015-RED       TO APOC                        46510005
465200              MOVE DP015-REVERSE   TO APOH                        46520005
465300              SET DP030-SET-CURSOR-TRAILER                        46530005
465400                                   TO TRUE                        46540005
465500     END-EVALUATE.                                                46550005
465600                                                                  46560005
465700 5003-GET-CURRENT-TMST.                                           46570005
465800                                                                  46580005
465900     EXEC SQL                                                     46590005
466000          SET :PV-DB2-TMST         =  CURRENT TIMESTAMP           46600005
466100     END-EXEC.                                                    46610005
466200/                                                                 46620005
466300*----------------------------------------------------------------*46630005
466400*    SEE IF THE PACK SLIP TO BE ADDED ALREADY EXISTS!            *46640005
466500*----------------------------------------------------------------*46650005
466600                                                                  46660005
466700 5005-FIND-TPKSLIP.                                               46670005
466800                                                                  46680005
466900                                                                  46690005
467000         IF  DK-REC-SEQ-NBR = +0                                  46700005
467100             MOVE '5005-1'   TO  PV-BOMB-PARA                     46710005
467200             EXEC SQL                                             46720005
467300                  SELECT SEQ_NBR                                  46730005
467400                    INTO :PKSLIP-SEQ-NBR                          46740005
467500                    FROM TPKSLIP                                  46750005
467600                   WHERE PO_NBR        = :PKSLIP-PO-NBR           46760005
467700                     AND PKSL_NBR      = :PKSLIP-PKSL-NBR         46770005
467800                     AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR          46780005
467900                     AND STR_DEST_NBR  = :PKSLIP-STR-DEST-NBR     46790005
468000                     AND VER_STAT_CDE  = :PC-ACTIVE               46800005
468100                     AND BOL_NBR       = :PKSLIP-BOL-NBR          46810005
468200             END-EXEC                                             46820005
468300         ELSE                                                     46830005
468400             IF PKSLIP-STR-DEST-NBR = 0                           46840005
468500             MOVE '5005-2'   TO  PV-BOMB-PARA                     46850005
468600             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         46860005
468700                 EXEC SQL                                         46870005
468800                      SELECT SEQ_NBR                              46880005
468900                        INTO :PKSLIP-SEQ-NBR                      46890005
469000                        FROM TPKSLIP                              46900005
469100                       WHERE PO_NBR        = :PKSLIP-PO-NBR       46910005
469200                         AND PKSL_NBR      = :PKSLIP-PKSL-NBR     46920005
469300                         AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR      46930005
469400                         AND STR_DEST_NBR  = :PKSLIP-STR-DEST-NBR 46940005
469500                         AND VER_STAT_CDE  = :PC-ACTIVE           46950005
469600                 END-EXEC                                         46960005
469700             ELSE                                                 46970005
469800             MOVE '5005-3'   TO  PV-BOMB-PARA                     46980005
469900             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         46990005
470000                 EXEC SQL                                         47000005
470100                      SELECT SEQ_NBR                              47010005
470200                        INTO :PKSLIP-SEQ-NBR                      47020005
470300                        FROM TPKSLIP                              47030005
470400                       WHERE PO_NBR        = :PKSLIP-PO-NBR       47040005
470500                         AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR      47050005
470600                         AND STR_DEST_NBR  = :PKSLIP-STR-DEST-NBR 47060005
470700                         AND VER_STAT_CDE  = :PC-ACTIVE           47070005
470800                 END-EXEC                                         47080005
470900             END-IF                                               47090005
471000         END-IF                                                   47100005
471100                                                                  47110005
471200         EVALUATE TRUE                                            47120005
471300             WHEN SQLCODE = +0                                    47130005
471400             WHEN SQLCODE = +100                                  47140005
471500             WHEN SQLCODE = -811                                  47150005
471600                  CONTINUE                                        47160005
471700             WHEN SQLCODE = -904                                  47170005
471800             WHEN SQLCODE = -911                                  47180005
471900             WHEN SQLCODE = -913                                  47190005
472000             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         47200005
472100             MOVE PKSLIP-PO-NBR         TO  PV-BOMB-PO            47210005
472200             MOVE ZERO                  TO PV-BOMB-PKSL-SEQ       47220005
472300             MOVE SPACE                 TO PV-BOMB-PKSL           47230005
472400             MOVE PKSLIP-STR-DEST-NBR   TO PV-BOMB-STORE          47240005
472500                  PERFORM 9900-SOFT-ABORT                         47250005
472600                                                                  47260005
472700             WHEN SQLWARN0 NOT = SPACES                           47270005
472800             WHEN SQLCODE < +0                                    47280005
472900             WHEN SQLCODE > +0                                    47290005
473000                  MOVE '5005-FIND-TPKSLIP'                        47300005
473100                                   TO DP013-PARAGRAPH             47310005
473200                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     47320005
473300                                   TO DP013-MESSAGE-TEXT (1)      47330005
473400                  MOVE SQLCA       TO DP013-SQLCA                 47340005
473500                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    47350005
473600                  SET DP013-DB2-ABEND                             47360005
473700                      DP013-XCTL-DISPLAY-RESTART                  47370005
473800                                   TO TRUE                        47380005
473900                  PERFORM DP013-0000-PROCESS-ABEND                47390005
474000         END-EVALUATE.                                            47400005
474100/                                                                 47410005
474200*----------------------------------------------------------------*47420005
474300*    INSERT A PACK SLIP HEADER ROW                               *47430005
474400*----------------------------------------------------------------*47440005
474500                                                                  47450005
474600 5010-INSERT-TPKSLIP.                                             47460005
474700                                                                  47470005
474800                                                                  47480005
474900         EXEC SQL                                                 47490005
475000              INSERT INTO TPKSLIP                                 47500005
475100                     (PO_NBR,                                     47510005
475200                      SEQ_NBR,                                    47520005
475300                      CRE_TMST,                                   47530005
475400                      VER_STAT_CDE,                               47540005
475500                      OPER_UNT_ID,                                47550005
475600                      FCLTY_ID,                                   47560005
475700                      PKSL_NBR,                                   47570005
475800                      STR_DEST_NBR,                               47580005
475900                      REC_SEQ_NBR,                                47590005
476000                      SHIPT_ID,                                   47600005
476100                      BOL_NBR,                                    47610005
476200                      PRO_NBR,                                    47620005
476300                      PKSL_STAT_CDE,                              47630005
476400                      CRE_UID,                                    47640005
476500                      PO_VER_NBR,                                 47650005
476600                      CRE_SRC_CDE,                                47660005
476700                      EXPTED_PKG_QTY,                             47670005
476800                      OWNER_SCAC_ID,                              47680005
476900                      ASN_NBR,                                    47690005
477000                      VEND_SHIP_DTE,                              47700005
477100                      PKSL_PG_CNT,                                47710005
477200                      CONTNR_ID,                                  47720008
477300                      ORIG_PKSL_SEQ_NBR)                          47730008
477400              VALUES (:PKSLIP-PO-NBR,                             47740005
477500                      :PKSLIP-SEQ-NBR,                            47750005
477600                      :PV-DB2-TMST,                               47760005
477700                      :PC-ACTIVE,                                 47770005
477800                      :PKSLIP-OPER-UNT-ID,                        47780005
477900                      :PKSLIP-FCLTY-ID,                           47790005
478000                      :PKSLIP-PKSL-NBR,                           47800005
478100                      :PKSLIP-STR-DEST-NBR,                       47810005
478200                      :PKSLIP-REC-SEQ-NBR,                        47820005
478300                      :PKSLIP-SHIPT-ID,                           47830005
478400                      :PKSLIP-BOL-NBR,                            47840005
478500                      :PKSLIP-PRO-NBR,                            47850005
478600                      :PKSLIP-PKSL-STAT-CDE,                      47860005
478700                      :DP020-USERID,                              47870005
478800                      :PKSLIP-PO-VER-NBR,                         47880005
478900                      :PKSLIP-CRE-SRC-CDE,                        47890005
479000                      :PKSLIP-EXPTED-PKG-QTY,                     47900005
479100                      :PKSLIP-OWNER-SCAC-ID,                      47910005
479200                      :PKSLIP-ASN-NBR,                            47920005
479300                      :PKSLIP-VEND-SHIP-DTE,                      47930005
479400                      :PKSLIP-PKSL-PG-CNT,                        47940005
479500                      :PKSLIP-CONTNR-ID,                          47950008
479600                      :PKSLIP-ORIG-PKSL-SEQ-NBR)                  47960008
479700         END-EXEC                                                 47970005
479800                                                                  47980005
479900         EVALUATE TRUE                                            47990005
480000             WHEN SQLCODE = +0                                    48000005
480100             WHEN SQLCODE = -803                                  48010005
480200                  CONTINUE                                        48020005
480300             WHEN SQLCODE = -904                                  48030005
480400             WHEN SQLCODE = -911                                  48040005
480500             WHEN SQLCODE = -913                                  48050005
480600             MOVE '5010-INSERT-TPKSLIP' TO  PV-BOMB-PARA          48060005
480700             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         48070005
480800             MOVE PKSLIP-PO-NBR         TO  PV-BOMB-PO            48080005
480900             MOVE PKSLIP-SEQ-NBR        TO PV-BOMB-PKSL-SEQ       48090005
481000             MOVE PKSLIP-PKSL-NBR       TO PV-BOMB-PKSL           48100005
481100             MOVE PKSLIP-STR-DEST-NBR   TO PV-BOMB-STORE          48110005
481200                  SET PS-UPDATES-DONE TO TRUE                     48120005
481300                  PERFORM 9900-SOFT-ABORT                         48130005
481400                                                                  48140005
481500             WHEN SQLWARN0 NOT = SPACES                           48150005
481600             WHEN SQLCODE < +0                                    48160005
481700             WHEN SQLCODE > +0                                    48170005
481800                  MOVE '5010-INSERT-TPKSLIP'                      48180005
481900                                   TO DP013-PARAGRAPH             48190005
482000                  MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'          48200005
482100                                   TO DP013-MESSAGE-TEXT (1)      48210005
482200                  MOVE SQLCA       TO DP013-SQLCA                 48220005
482300                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    48230005
482400                  SET DP013-DB2-ABEND                             48240005
482500                      DP013-XCTL-DISPLAY-RESTART                  48250005
482600                                   TO TRUE                        48260005
482700                  PERFORM DP013-0000-PROCESS-ABEND                48270005
482800         END-EVALUATE.                                            48280005
482900                                                                  48290005
483000/                                                                 48300005
483100*----------------------------------------------------------------*48310005
483200*    FIND THE ROW WITH THE HIGHEST SEQUENCE NUMBER               *48320005
483300*----------------------------------------------------------------*48330005
483400                                                                  48340005
483500 5030-GET-NEXT-SEQ-NBR.                                           48350005
483600                                                                  48360005
483700     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             48370005
483800                                                                  48380005
483900                                                                  48390005
484000         EXEC SQL                                                 48400005
484100              SELECT MAX(SEQ_NBR)                                 48410005
484200                INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND              48420005
484300                FROM TPKSLIP                                      48430005
484400               WHERE PO_NBR = :PKSLIP-PO-NBR                      48440005
484500         END-EXEC                                                 48450005
484600                                                                  48460005
484700         EVALUATE TRUE                                            48470005
484800             WHEN SQLCODE = +0                                    48480005
484900                  COMPUTE PV-NEXT-SEQ-NBR =                       48490005
485000                          PV-MAX-SEQ-NBR + 1                      48500005
485100                                                                  48510005
485200             WHEN SQLCODE = +100                                  48520005
485300                  MOVE +1          TO PV-NEXT-SEQ-NBR             48530005
485400                                                                  48540005
485500             WHEN SQLCODE = -904                                  48550005
485600             WHEN SQLCODE = -911                                  48560005
485700             WHEN SQLCODE = -913                                  48570005
485800             MOVE '5030-GET-NEXT-SEQ-NBR' TO PV-BOMB-PARA         48580005
485900             MOVE 'TPKSLIP'             TO  PV-BOMB-TABLE         48590005
486000             MOVE PKSLIP-PO-NBR         TO  PV-BOMB-PO            48600005
486100             MOVE ZERO                  TO PV-BOMB-PKSL-SEQ       48610005
486200             MOVE SPACE                 TO PV-BOMB-PKSL           48620005
486300             MOVE ZERO                  TO PV-BOMB-STORE          48630005
486400                  PERFORM 9900-SOFT-ABORT                         48640005
486500                                                                  48650005
486600             WHEN SQLWARN0 NOT = SPACES                           48660005
486700             WHEN SQLCODE < +0                                    48670005
486800             WHEN SQLCODE > +0                                    48680005
486900                  MOVE '5030-GET-NEXT-SEQ-NBR'                    48690005
487000                                   TO DP013-PARAGRAPH             48700005
487100                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          48710005
487200                                   TO DP013-MESSAGE-TEXT (1)      48720005
487300                  MOVE SQLCA       TO DP013-SQLCA                 48730005
487400                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    48740005
487500                  SET DP013-DB2-ABEND                             48750005
487600                      DP013-XCTL-DISPLAY-RESTART                  48760005
487700                                   TO TRUE                        48770005
487800                  PERFORM DP013-0000-PROCESS-ABEND                48780005
487900         END-EVALUATE.                                            48790005
488000                                                                  48800005
488100/                                                                 48810005
488200*----------------------------------------------------------------*48820005
488300* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *48830005
488400* OBJECT WAS UDPATED.                                            *48840005
488500*----------------------------------------------------------------*48850005
488600                                                                  48860005
488700 5200-UPDATE-SELECTION-QUEUE.                                     48870005
488800                                                                  48880005
488900     PERFORM 9100-READ-SEL-QUEUE.                                 48890005
489000                                                                  48900005
489100     IF  ASC-DELETE-SUCCESSFUL                                    48910005
489200         SET RC013-DEL (ASC-SEL-SUB)                              48920005
489300                                   TO TRUE                        48930005
489400     ELSE                                                         48940005
489500         SET RC013-UPD (ASC-SEL-SUB)                              48950005
489600                                   TO TRUE                        48960005
489700     END-IF.                                                      48970005
489800                                                                  48980005
489900     PERFORM 9200-REWRITE-SEL-QUEUE.                              48990005
490000                                                                  49000005
490100/                                                                 49010005
490200*----------------------------------------------------------------*49020005
490300*    PERFORM UPDATE PACK SLIP PROCESSING                         *49030005
490400*----------------------------------------------------------------*49040005
490500 6000-UPDATE-PACK-SLIP.                                           49050005
490600                                                                  49060005
490700     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  49070005
490800                                                                  49080005
490900     PERFORM 8010-SELECT-TPKSLIP.                                 49090005
491000                                                                  49100005
491100     MOVE ASC-OPER-UNT-ID-N        TO PKSLIP-OPER-UNT-ID.         49110005
491200     MOVE ASC-FCLTY-ID-N           TO PKSLIP-FCLTY-ID.            49120005
491300     MOVE ASC-PKSL-NBR             TO PKSLIP-PKSL-NBR.            49130005
491400                                                                  49140005
491500     IF ASC-STR-DEST-NBR NUMERIC                                  49150005
491600         MOVE ASC-STR-DEST-NBR-N   TO PKSLIP-STR-DEST-NBR         49160005
491700     ELSE                                                         49170005
491800         MOVE ZEROS                TO PKSLIP-STR-DEST-NBR         49180005
491900     END-IF.                                                      49190005
492000                                                                  49200005
492100     MOVE ASC-REC-SEQ-NBR-N        TO PKSLIP-REC-SEQ-NBR.         49210005
492200     MOVE ASC-EXPTED-PKG-QTY-N     TO PKSLIP-EXPTED-PKG-QTY.      49220005
492300                                                                  49230005
492400     IF SHPTPO-SHIPT-ID > 0                                       49240005
492500         PERFORM 9000-GET-SHIPMENT-DATA                           49250005
492600         MOVE SHIPMT-SHIPT-ID      TO PKSLIP-SHIPT-ID             49260005
492700     ELSE                                                         49270005
492800         MOVE ZEROS                TO SHIPMT-SHIPT-ID             49280005
492900         MOVE SPACES               TO SHIPMT-VEND-SHIP-DTE        49290005
493000     END-IF.                                                      49300005
493100                                                                  49310005
493200     MOVE ASC-BOL-NBR              TO PKSLIP-BOL-NBR.             49320005
493300     MOVE ASC-PRO-NBR              TO PKSLIP-PRO-NBR.             49330005
493400     MOVE ASC-CRE-SRC-CDE          TO PKSLIP-CRE-SRC-CDE.         49340005
493500     MOVE ASC-PKSL-STAT-CDE        TO PKSLIP-PKSL-STAT-CDE.       49350005
493600     MOVE ASC-PAGE-CNT-N           TO PKSLIP-PKSL-PG-CNT.         49360005
493700     IF PV-VEND-SHIP-DTE > SPACES                                 49370005
493800         MOVE PV-VEND-SHIP-DTE     TO PKSLIP-VEND-SHIP-DTE        49380005
493900     END-IF                                                       49390005
494000                                                                  49400005
494100     MOVE ASC-ORIGIN-SCAC-CDE      TO PKSLIP-OWNER-SCAC-ID.       49410005
494200                                                                  49420005
494300     MOVE ASC-CONTNR-ID            TO PKSLIP-CONTNR-ID            49430005
494400                                                                  49440005
494500     PERFORM 6010-UPDATE-TPKSLIP                                  49450005
494600     PERFORM 5003-GET-CURRENT-TMST                                49460005
494700                                                                  49470005
494800*JAK - 04/2007 - START                                            49480060
494900*      IF THE STR_DEST_NBR IS CHANGED TO ZERO, AND THE            49490060
495000*      OPER_UNT_ID IS AN E-BUS LOCATION, THEN DELETE              49500060
495100*      ALL OF THE PBSERR ROWS FROM TSHUNLO                        49510060
495200                                                                  49520060
495300     IF PKSLIP-STR-DEST-NBR = 0                                   49530060
495400         PERFORM 6200-CHECK-LOC                                   49540062
495500         IF PS-EBUS-LOC-YES                                       49550062
495600             MOVE ASC-SEQ-NBR         TO DK-SEQ-NBR               49560065
495700             PERFORM 6210-DELETE-TSHUNLO                          49570062
495800         END-IF                                                   49580062
495900     END-IF.                                                      49590062
496000*JAK - 04/2007 - END                                              49600060
496100                                                                  49610060
496200* UPDATE THE OPER-UNT-ID ON ALL CARTONS ATTACHED TO THE PACKSLIP  49620005
496300     PERFORM 6100-OPEN-TINPKSU-CSR.                               49630005
496400     PERFORM 6110-FETCH-TINPKSU-CSR.                              49640005
496500     PERFORM UNTIL PS-EOF-TINPKSU                                 49650005
496600         PERFORM 6120-UPDATE-TSHPUNT                              49660005
496700         PERFORM 6110-FETCH-TINPKSU-CSR                           49670005
496800     END-PERFORM.                                                 49680005
496900                                                                  49690005
497000     PERFORM 6130-CLOSE-TINPKSU-CSR.                              49700005
497100                                                                  49710005
497200     PERFORM 5010-INSERT-TPKSLIP                                  49720005
497300     IF      SQLCODE = +0                                         49730005
497400         MOVE PC-TSYMSG-00059          TO DP020-MSG-NUMBER        49740005
497500         SET DP020-MSG-INFORMATIONAL                              49750005
497600                                   TO TRUE                        49760005
497700         IF      ASC-USE-SELECTION-QUEUE                          49770005
497800             PERFORM 5200-UPDATE-SELECTION-QUEUE                  49780005
497900         END-IF                                                   49790005
498000         PERFORM 3500-SAVE-SCREEN-FIELDS                          49800005
498100     END-IF.                                                      49810005
498200                                                                  49820005
498300                                                                  49830005
498400*----------------------------------------------------------------*49840005
498500*    SET THE CURRENT VERSION OF THE PACK SLIP HEADER TO INACTIVE *49850005
498600*    BEFORE THE INSERT OF THE NEW PACK SLIP HEADER ROW IS DONE.  *49860005
498700*----------------------------------------------------------------*49870005
498800                                                                  49880005
498900 6010-UPDATE-TPKSLIP.                                             49890005
499000                                                                  49900005
499100                                                                  49910005
499200         EXEC SQL                                                 49920005
499300              UPDATE TPKSLIP                                      49930005
499400                 SET VER_STAT_CDE   = :PC-INACTIVE                49940005
499500               WHERE PO_NBR         = :DK-PO-NBR                  49950005
499600                 AND SEQ_NBR        = :PKSLIP-SEQ-NBR             49960005
499700                 AND VER_STAT_CDE   = :PC-ACTIVE                  49970005
499800         END-EXEC                                                 49980005
499900                                                                  49990005
500000         EVALUATE TRUE                                            50000005
500100             WHEN SQLCODE = +0                                    50010005
500200                  CONTINUE                                        50020005
500300             WHEN SQLCODE = -904                                  50030005
500400             WHEN SQLCODE = -911                                  50040005
500500             WHEN SQLCODE = -913                                  50050005
500600                  SET PS-UPDATES-DONE TO TRUE                     50060005
500700                  PERFORM 9900-SOFT-ABORT                         50070005
500800                                                                  50080005
500900             WHEN SQLWARN0 NOT = SPACES                           50090005
501000             WHEN SQLCODE < +0                                    50100005
501100             WHEN SQLCODE > +0                                    50110005
501200                  MOVE '6010-UPDATE-TPKSLIP'                      50120005
501300                                   TO DP013-PARAGRAPH             50130005
501400                  MOVE 'UNSUCCESSFUL UPDATE FOR TPKSLIP'          50140005
501500                                   TO DP013-MESSAGE-TEXT (1)      50150005
501600                  MOVE SQLCA       TO DP013-SQLCA                 50160005
501700                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    50170005
501800                  SET DP013-DB2-ABEND                             50180005
501900                      DP013-XCTL-DISPLAY-RESTART                  50190005
502000                                   TO TRUE                        50200005
502100                  PERFORM DP013-0000-PROCESS-ABEND                50210005
502200         END-EVALUATE.                                            50220005
502300                                                                  50230005
502400/                                                                 50240005
502500 6100-OPEN-TINPKSU-CSR.                                           50250005
502600                                                                  50260005
502700     EXEC SQL                                                     50270005
502800         OPEN TINPKSU-CSR                                         50280005
502900     END-EXEC                                                     50290005
503000                                                                  50300005
503100     EVALUATE TRUE                                                50310005
503200         WHEN SQLCODE = ZERO                                      50320005
503300              CONTINUE                                            50330005
503400         WHEN SQLCODE = -904                                      50340005
503500         WHEN SQLCODE = -911                                      50350005
503600         WHEN SQLCODE = -913                                      50360005
503700              PERFORM 9900-SOFT-ABORT                             50370005
503800                                                                  50380005
503900         WHEN SQLWARN0 NOT = SPACE                                50390005
504000         WHEN SQLCODE  NOT = +0                                   50400005
504100             MOVE '6100-OPEN-TINPKSU-CSR'                         50410005
504200                                   TO DP013-PARAGRAPH             50420005
504300             MOVE 'OPEN TINPKSU-CSR CURSOR'                       50430005
504400                                   TO DP013-MESSAGE-TEXT (1)      50440005
504500             MOVE SQLCA            TO DP013-SQLCA                 50450005
504600             MOVE 'TINPKSU'        TO DP013-DB2-TABLE-NAME (1)    50460005
504700             SET DP013-DB2-ABEND                                  50470005
504800                                   TO TRUE                        50480005
504900             PERFORM DP013-0000-PROCESS-ABEND                     50490005
505000         END-EVALUATE.                                            50500005
505100                                                                  50510005
505200 6110-FETCH-TINPKSU-CSR.                                          50520005
505300                                                                  50530005
505400     EXEC SQL                                                     50540005
505500         FETCH TINPKSU-CSR                                        50550005
505600          INTO :INPKSU-SHIPT-UNT-ID                               50560005
505700     END-EXEC.                                                    50570005
505800                                                                  50580005
505900     EVALUATE TRUE                                                50590005
506000         WHEN SQLCODE = ZERO                                      50600005
506100              CONTINUE                                            50610005
506200                                                                  50620005
506300         WHEN SQLCODE = +100                                      50630005
506400              SET PS-EOF-TINPKSU                                  50640005
506500                                   TO TRUE                        50650005
506600         WHEN SQLCODE = -904                                      50660005
506700         WHEN SQLCODE = -911                                      50670005
506800         WHEN SQLCODE = -913                                      50680005
506900              PERFORM 9900-SOFT-ABORT                             50690005
507000                                                                  50700005
507100         WHEN SQLWARN0 NOT = SPACE                                50710005
507200         WHEN SQLCODE < +0                                        50720005
507300         WHEN SQLCODE > +0                                        50730005
507400              MOVE '6110-FETCH-TINPKSU-CSR'                       50740005
507500                                   TO DP013-PARAGRAPH             50750005
507600              MOVE 'FETCH TINPKSU CURSOR'                         50760005
507700                                   TO DP013-MESSAGE-TEXT (1)      50770005
507800              MOVE SQLCA           TO DP013-SQLCA                 50780005
507900              MOVE 'TINPKSU'       TO DP013-DB2-TABLE-NAME (1)    50790005
508000              SET DP013-DB2-ABEND  TO TRUE                        50800005
508100              PERFORM DP013-0000-PROCESS-ABEND                    50810005
508200     END-EVALUATE.                                                50820005
508300                                                                  50830005
508400 6120-UPDATE-TSHPUNT.                                             50840005
508500                                                                  50850005
508600     EXEC SQL                                                     50860005
508700         UPDATE TSHPUNT                                           50870005
508800             SET ORGN_OPER_UNT_ID = :PKSLIP-OPER-UNT-ID           50880005
508900                ,DEST_OPER_UNT_ID = :PKSLIP-STR-DEST-NBR          50890005
509000         WHERE SHIPT_UNT_ID       = :INPKSU-SHIPT-UNT-ID          50900005
509100     END-EXEC                                                     50910005
509200                                                                  50920005
509300     EVALUATE TRUE                                                50930005
509400         WHEN SQLCODE = ZERO                                      50940005
509500         WHEN SQLCODE = +100                                      50950005
509600             CONTINUE                                             50960005
509700         WHEN SQLCODE = -904                                      50970005
509800         WHEN SQLCODE = -911                                      50980005
509900         WHEN SQLCODE = -913                                      50990005
510000              PERFORM 9900-SOFT-ABORT                             51000005
510100                                                                  51010005
510200         WHEN SQLWARN0 NOT = SPACES                               51020005
510300         WHEN SQLCODE < ZERO                                      51030005
510400         WHEN SQLCODE > ZERO                                      51040005
510500             MOVE '6120-UPDATE-TSHPUNT'                           51050005
510600                                   TO DP013-PARAGRAPH             51060005
510700             MOVE 'UNSUCCESSFUL DELETE ON TPKSLIP'                51070005
510800                                   TO DP013-MESSAGE-TEXT (1)      51080005
510900             MOVE SQLCA            TO DP013-SQLCA                 51090005
511000             MOVE 'TPKSLIP '       TO DP013-DB2-TABLE-NAME (1)    51100005
511100             SET DP013-DB2-ABEND                                  51110005
511200                 DP013-XCTL-DISPLAY-RESTART                       51120005
511300                                   TO TRUE                        51130005
511400             PERFORM DP013-0000-PROCESS-ABEND                     51140005
511500     END-EVALUATE.                                                51150005
511600                                                                  51160005
511700 6130-CLOSE-TINPKSU-CSR.                                          51170005
511800                                                                  51180005
511900     EXEC SQL                                                     51190005
512000         CLOSE TINPKSU-CSR                                        51200005
512100     END-EXEC.                                                    51210005
512200                                                                  51220005
512300     EVALUATE TRUE                                                51230005
512400         WHEN SQLCODE = ZERO                                      51240005
512500              CONTINUE                                            51250005
512600         WHEN SQLCODE = -904                                      51260005
512700         WHEN SQLCODE = -911                                      51270005
512800         WHEN SQLCODE = -913                                      51280005
512900              PERFORM 9900-SOFT-ABORT                             51290005
513000                                                                  51300005
513100         WHEN SQLWARN0 NOT = SPACE                                51310005
513200         WHEN SQLCODE  NOT = ZERO                                 51320005
513300              MOVE '6130-CLOSE-TINPKSU-CSR'                       51330005
513400                                   TO DP013-PARAGRAPH             51340005
513500              MOVE 'CLOSE TINPKSU-CSR CURSOR'                     51350005
513600                                   TO DP013-MESSAGE-TEXT (1)      51360005
513700              MOVE SQLCA           TO DP013-SQLCA                 51370005
513800              MOVE 'TINPKSU'       TO DP013-DB2-TABLE-NAME (1)    51380005
513900              SET DP013-DB2-ABEND  TO TRUE                        51390005
514000              PERFORM DP013-0000-PROCESS-ABEND                    51400005
514100     END-EVALUATE.                                                51410005
514200/                                                                 51420005
514300* JAK  04/2007 - BEGIN                                            51430060
514400*----------------------------------------------------------------*51440060
514500*    CHECK TO SEE IF THE OPER-UNT-ID IS AN E-BUSINESS LOCATION    51450060
514600*----------------------------------------------------------------*51460060
514700                                                                  51470060
514800 6200-CHECK-LOC.                                                  51480060
514900                                                                  51490060
515000     EXEC SQL                                                     51500060
515100          SELECT E_BUS_IND                                        51510060
515200          INTO   :XLT00010-E-BUS-IND                              51520061
515300          FROM   XLT_LOC                                          51530061
515400          WHERE  LOC_NBR       = :DK-OPER-UNT-ID                  51540062
515500     END-EXEC.                                                    51550060
515600                                                                  51560060
515700     EVALUATE TRUE                                                51570060
515800         WHEN SQLCODE = +0                                        51580060
515900              IF XLT00010-E-BUS-IND = 'Y'                         51590063
516000                  SET PS-EBUS-LOC-YES   TO TRUE                   51600062
516100              ELSE                                                51610060
516200                  SET PS-EBUS-LOC-NO    TO TRUE                   51620062
516300              END-IF                                              51630060
516400         WHEN SQLCODE = -904                                      51640060
516500         WHEN SQLCODE = -911                                      51650060
516600         WHEN SQLCODE = -913                                      51660060
516700              SET PS-UPDATES-DONE TO TRUE                         51670060
516800              PERFORM 9900-SOFT-ABORT                             51680060
516900                                                                  51690060
517000         WHEN SQLWARN0 NOT = SPACES                               51700060
517100         WHEN SQLCODE < +0                                        51710060
517200         WHEN SQLCODE > +0                                        51720060
517210              MOVE ASC-PO-NBR-N      TO PC-DISPLAY-PO             51721084
517220              MOVE ASC-REC-SEQ-NBR-N TO PC-DISPLAY-RCVR           51722084
517240              MOVE ASC-OPER-UNT-ID-N TO PC-DISPLAY-OPER           51724084
517250                                                                  51725083
517300              MOVE '6200-CHECK-LOC'                               51730060
517400                                   TO DP013-PARAGRAPH             51740060
517500              MOVE 'UNSUCCESSFUL SELECT FROM XLT_LOC'             51750060
517600                                   TO DP013-MESSAGE-TEXT (1)      51760060
517610              STRING PC-DISPLAY-OPER '-'                          51761085
517620                     PC-DISPLAY-PO   '-'                          51762085
517630                     PC-DISPLAY-RCVR  DELIMITED BY SIZE           51763085
517640                                 INTO DP013-MESSAGE-TEXT (2)      51764083
517700              MOVE SQLCA       TO DP013-SQLCA                     51770060
517800              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        51780060
517900              SET DP013-DB2-ABEND                                 51790060
518000                  DP013-XCTL-DISPLAY-RESTART                      51800060
518100                                   TO TRUE                        51810060
518200              PERFORM DP013-0000-PROCESS-ABEND                    51820060
518300     END-EVALUATE.                                                51830060
518400                                                                  51840060
518500/                                                                 51850060
518600*----------------------------------------------------------------*51860060
518700*    DELETE ALL PBSERR ROWS FROM TSHUNLO FOR THE PO               51870060
518800*----------------------------------------------------------------*51880060
518900                                                                  51890060
519000 6210-DELETE-TSHUNLO.                                             51900060
519100                                                                  51910060
519200     EXEC SQL                                                     51920060
519300          DELETE FROM TSHUNLO                                     51930060
519400          WHERE SHIPT_UNT_ID IN                                   51940060
519500             (SELECT A.SHIPT_UNT_ID                               51950060
519600              FROM TSHUNLO A                                      51960060
519700                 , TINPKSU B                                      51970060
519800              WHERE B.PO_NBR       = :DK-PO-NBR                   51980060
519900              AND   B.SEQ_NBR      = :DK-SEQ-NBR                  51990060
520000              AND   A.SCN_LOC_ID   LIKE ('PBS%')                  52000060
520100              AND   A.SHIPT_UNT_ID = B.SHIPT_UNT_ID)              52010060
520200     END-EXEC.                                                    52020060
520300                                                                  52030060
520400     EVALUATE TRUE                                                52040060
520500         WHEN SQLCODE = +0                                        52050060
520600         WHEN SQLCODE = +100                                      52060064
520700              CONTINUE                                            52070064
520800         WHEN SQLCODE = -904                                      52080060
520900         WHEN SQLCODE = -911                                      52090060
521000         WHEN SQLCODE = -913                                      52100060
521100              SET PS-UPDATES-DONE TO TRUE                         52110060
521200              PERFORM 9900-SOFT-ABORT                             52120060
521300                                                                  52130060
521400         WHEN SQLWARN0 NOT = SPACES                               52140060
521500         WHEN SQLCODE < +0                                        52150060
521600         WHEN SQLCODE > +0                                        52160060
521700              MOVE '6210-DELETE-TSHUNLO'                          52170060
521800                                   TO DP013-PARAGRAPH             52180060
521900              MOVE 'UNSUCCESSFUL DELETE FROM TSHUNLO'             52190060
522000                                   TO DP013-MESSAGE-TEXT (1)      52200060
522100              MOVE SQLCA       TO DP013-SQLCA                     52210060
522200              MOVE 'TSHUNLO '  TO DP013-DB2-TABLE-NAME (1)        52220060
522300              SET DP013-DB2-ABEND                                 52230060
522400                  DP013-XCTL-DISPLAY-RESTART                      52240060
522500                                   TO TRUE                        52250060
522600              PERFORM DP013-0000-PROCESS-ABEND                    52260060
522700     END-EVALUATE.                                                52270060
522800/                                                                 52280060
522900* JAK  04/2007 - END                                              52290060
523000*----------------------------------------------------------------*52300005
523100*    PERFORM DELETE PACK SLIP HEADER PROCESSING                  *52310005
523200*----------------------------------------------------------------*52320005
523300 7000-DELETE-PACK-SLIP.                                           52330005
523400                                                                  52340005
523500     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  52350005
523600                                                                  52360005
523700     PERFORM 7005-SELECT-TPKSLIP.                                 52370005
523800     IF PKSLIP-PKSL-STAT-CDE          = 'AC'                      52380005
523900         MOVE PC-TSYMSG-00723      TO DP020-MSG-NUMBER            52390005
524000         SET PS-ERROR                                             52400005
524100             DP030-OVERRIDE-GO                                    52410005
524200*            PS-COMMAREA-NOT-VALID                                52420005
524300*            DP020-NEXT-ACT-APPL-ERROR                            52430005
524400             DP020-MSG-FATAL       TO TRUE                        52440005
524500     END-IF                                                       52450005
524600                                                                  52460007
524700     IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                              52470007
524800         MOVE PC-TSYMSG-03207      TO DP020-MSG-NUMBER            52480007
524900         SET PS-ERROR                                             52490007
525000             DP030-OVERRIDE-GO                                    52500007
525100             DP020-MSG-FATAL       TO TRUE                        52510007
525200     END-IF                                                       52520007
525300*LMM                                                              52530040
525400     IF PS-NO-ERROR                                               52540005
525500                                                                  52550040
525600         PERFORM 8200-VALIDATE-CTN-DATA                           52560040
525700                                                                  52570040
525800         IF PV-PKSLIP-CTN-COUNT > 0                               52580040
525900            SET PS-CARTON-DATA-YES TO TRUE                        52590040
526000         ELSE                                                     52600040
526100            SET PS-CARTON-DATA-NO  TO TRUE                        52610040
526200         END-IF                                                   52620040
526300                                                                  52630040
526400         IF PS-CARTON-DATA-YES                                    52640040
526500            SET PS-PACKSLIP-WITH-CRTN-DATA TO TRUE                52650041
526600                                                                  52660040
526700            PERFORM 8300-VALIDATE-CTN-ACTIVITY                    52670040
526800            IF PV-ACTIVE-CTN-COUNT > 0                            52680040
526900               SET PS-CARTON-ACTIVITY-YES TO TRUE                 52690040
527000               MOVE PC-TSYMSG-03411                               52700040
527100                                TO DP020-MSG-NUMBER               52710040
527200               SET PS-ERROR                                       52720040
527300                   PS-COMMAREA-NOT-VALID                          52730040
527400                   DP020-NEXT-ACT-APPL-ERROR                      52740040
527500                   DP020-MSG-FATAL                                52750040
527600                                TO TRUE                           52760040
527700            ELSE                                                  52770040
527800               SET PS-CARTON-ACTIVITY-NO  TO TRUE                 52780040
527900            END-IF                                                52790040
528000                                                                  52800040
528100            IF PS-CARTON-ACTIVITY-NO                              52810040
528200               PERFORM 7010-UPDATE-TPKSLIP-INACTIVE               52820040
528300                                                                  52830040
528400               PERFORM 7015-INSERT-TPKSLIP-DELETED                52840040
528500               PERFORM 7015B-CALL-PO-RCVR-TRKING-MOD              52850040
528600                                                                  52860040
528700***  PERFORM 7020-DELETE-TPKITEM                                  52870040
528800                                                                  52880040
528900***  PERFORM 7030-DELETE-TUNPKSL                                  52890040
529000                                                                  52900040
529100               MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER  52910040
529200               SET DP020-MSG-INFORMATIONAL                        52920040
529300               ASC-DELETE-SUCCESSFUL     TO TRUE                  52930040
529400            END-IF                                                52940040
529500         ELSE                                                     52950040
529600               SET PS-PACKSLIP-ONLY TO TRUE                       52960041
529700               PERFORM 7010-UPDATE-TPKSLIP-INACTIVE               52970040
529800                                                                  52980040
529900               PERFORM 7015-INSERT-TPKSLIP-DELETED                52990040
530000               PERFORM 7015B-CALL-PO-RCVR-TRKING-MOD              53000040
530100                                                                  53010040
530200***  PERFORM 7020-DELETE-TPKITEM                                  53020040
530300                                                                  53030040
530400***  PERFORM 7030-DELETE-TUNPKSL                                  53040040
530500                                                                  53050040
530600               MOVE PC-TSYMSG-00115          TO DP020-MSG-NUMBER  53060040
530700               SET DP020-MSG-INFORMATIONAL                        53070040
530800               ASC-DELETE-SUCCESSFUL     TO TRUE                  53080040
530900         END-IF                                                   53090040
531000                                                                  53100040
531100         IF  ASC-USE-SELECTION-QUEUE                              53110040
531200             PERFORM 5200-UPDATE-SELECTION-QUEUE                  53120040
531300         END-IF                                                   53130040
531400     END-IF.                                                      53140040
531500                                                                  53150040
531600/                                                                 53160040
531700*----------------------------------------------------------------*53170040
531800*    READ PACK SLIP HEADER TO BE COPIED                          *53180040
531900*----------------------------------------------------------------*53190040
532000 7005-SELECT-TPKSLIP.                                             53200040
532100                                                                  53210040
532200                                                                  53220040
532300         EXEC SQL                                                 53230040
532400              SELECT PO_NBR,                                      53240040
532500                     SEQ_NBR,                                     53250040
532600                     CRE_TMST,                                    53260040
532700                     VER_STAT_CDE,                                53270040
532800                     OPER_UNT_ID,                                 53280040
532900                     FCLTY_ID,                                    53290040
533000                     PKSL_NBR,                                    53300040
533100                     STR_DEST_NBR,                                53310040
533200                     REC_SEQ_NBR,                                 53320040
533300                     SHIPT_ID,                                    53330040
533400                     BOL_NBR,                                     53340040
533500                     PRO_NBR,                                     53350040
533600                     PKSL_STAT_CDE,                               53360040
533700                     CRE_UID,                                     53370040
533800                     PO_VER_NBR,                                  53380040
533900                     CRE_SRC_CDE,                                 53390040
534000                     EXPTED_PKG_QTY,                              53400040
534100                     OWNER_SCAC_ID,                               53410040
534200                     ASN_NBR,                                     53420040
534300                     VEND_SHIP_DTE,                               53430040
534400                     PKSL_PG_CNT,                                 53440040
534500                     CONTNR_ID,                                   53450040
534600                     ORIG_PKSL_SEQ_NBR                            53460040
534700                INTO :PKSLIP-PO-NBR,                              53470040
534800                     :PKSLIP-SEQ-NBR,                             53480040
534900                     :PKSLIP-CRE-TMST,                            53490040
535000                     :PKSLIP-VER-STAT-CDE,                        53500040
535100                     :PKSLIP-OPER-UNT-ID,                         53510040
535200                     :PKSLIP-FCLTY-ID,                            53520040
535300                     :PKSLIP-PKSL-NBR,                            53530040
535400                     :PKSLIP-STR-DEST-NBR,                        53540040
535500                     :PKSLIP-REC-SEQ-NBR,                         53550040
535600                     :PKSLIP-SHIPT-ID,                            53560040
535700                     :PKSLIP-BOL-NBR,                             53570040
535800                     :PKSLIP-PRO-NBR,                             53580040
535900                     :PKSLIP-PKSL-STAT-CDE,                       53590040
536000                     :PKSLIP-CRE-UID,                             53600040
536100                     :PKSLIP-PO-VER-NBR,                          53610040
536200                     :PKSLIP-CRE-SRC-CDE,                         53620040
536300                     :PKSLIP-EXPTED-PKG-QTY,                      53630040
536400                     :PKSLIP-OWNER-SCAC-ID,                       53640040
536500                     :PKSLIP-ASN-NBR,                             53650040
536600                     :PKSLIP-VEND-SHIP-DTE,                       53660040
536700                     :PKSLIP-PKSL-PG-CNT,                         53670040
536800                     :PKSLIP-CONTNR-ID,                           53680040
536900                     :PKSLIP-ORIG-PKSL-SEQ-NBR                    53690040
537000                FROM TPKSLIP                                      53700040
537100               WHERE PO_NBR       = :DK-PO-NBR                    53710040
537200                 AND SEQ_NBR      = :ASC-SEQ-NBR                  53720040
537300                 AND VER_STAT_CDE = :PC-ACTIVE                    53730040
537400         END-EXEC                                                 53740040
537500                                                                  53750040
537600         EVALUATE TRUE                                            53760040
537700             WHEN SQLCODE = +0                                    53770040
537800                  CONTINUE                                        53780040
537900*LMM                                                              53790046
538000             WHEN SQLCODE = +100                                  53800046
538100                  MOVE PC-TSYMSG-00730                            53810046
538200                                   TO DP020-MSG-NUMBER            53820046
538300                  SET PS-ERROR                                    53830046
538400                      PS-COMMAREA-NOT-VALID                       53840046
538500                      DP020-NEXT-ACT-APPL-ERROR                   53850046
538600                      DP020-MSG-FATAL                             53860046
538700                                   TO TRUE                        53870046
538800             WHEN SQLCODE = -904                                  53880040
538900             WHEN SQLCODE = -911                                  53890040
539000             WHEN SQLCODE = -913                                  53900040
539100                  PERFORM 9900-SOFT-ABORT                         53910040
539200                                                                  53920040
539300             WHEN SQLWARN0 NOT = SPACES                           53930040
539400             WHEN SQLCODE < +0                                    53940040
539500             WHEN SQLCODE > +0                                    53950040
539600                  MOVE '7005-SELECT-TPKSLIP'                      53960045
539700                                   TO DP013-PARAGRAPH             53970040
539800                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     53980040
539900                                   TO DP013-MESSAGE-TEXT (1)      53990040
540000                  MOVE SQLCA       TO DP013-SQLCA                 54000040
540100                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    54010040
540200                  SET DP013-DB2-ABEND                             54020040
540300                      DP013-XCTL-DISPLAY-RESTART                  54030040
540400                                   TO TRUE                        54040040
540500                  PERFORM DP013-0000-PROCESS-ABEND                54050040
540600         END-EVALUATE.                                            54060040
540700                                                                  54070040
540800/                                                                 54080040
540900*----------------------------------------------------------------*54090040
541000*    UPDATE PACK SLIP HEADER TO INACTIVE                         *54100040
541100*----------------------------------------------------------------*54110040
541200                                                                  54120040
541300 7010-UPDATE-TPKSLIP-INACTIVE.                                    54130040
541400                                                                  54140040
541500                                                                  54150040
541600         EXEC SQL                                                 54160040
541700              UPDATE TPKSLIP                                      54170040
541800                 SET VER_STAT_CDE   = :PC-INACTIVE                54180040
541900               WHERE PO_NBR         = :DK-PO-NBR                  54190040
542000                 AND SEQ_NBR        = :PKSLIP-SEQ-NBR             54200040
542100                 AND VER_STAT_CDE   = :PC-ACTIVE                  54210040
542200         END-EXEC                                                 54220040
542300                                                                  54230040
542400                                                                  54240040
542500***      EXEC SQL                                                 54250040
542600***           DELETE                                              54260040
542700***             FROM TPKSLIP                                      54270040
542800***            WHERE PO_NBR       = :DK-PO-NBR                    54280040
542900***              AND SEQ_NBR      = :ASC-SEQ-NBR                  54290040
543000***      END-EXEC                                                 54300040
543100                                                                  54310040
543200         EVALUATE TRUE                                            54320040
543300             WHEN SQLCODE = +0                                    54330040
543400                  CONTINUE                                        54340040
543500             WHEN SQLCODE = -904                                  54350040
543600             WHEN SQLCODE = -911                                  54360040
543700             WHEN SQLCODE = -913                                  54370040
543800                  SET PS-UPDATES-DONE TO TRUE                     54380040
543900                  PERFORM 9900-SOFT-ABORT                         54390040
544000                                                                  54400040
544100             WHEN SQLWARN0 NOT = SPACES                           54410040
544200             WHEN SQLCODE < +0                                    54420040
544300             WHEN SQLCODE > +0                                    54430040
544400                  MOVE '7010-DELETE-TPKSLIP'                      54440040
544500                                   TO DP013-PARAGRAPH             54450040
544600                  MOVE 'UNSUCCESSFUL DELETE ON TPKSLIP'           54460040
544700                                   TO DP013-MESSAGE-TEXT (1)      54470040
544800                  MOVE SQLCA       TO DP013-SQLCA                 54480040
544900                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    54490040
545000                  SET DP013-DB2-ABEND                             54500040
545100                      DP013-XCTL-DISPLAY-RESTART                  54510040
545200                                   TO TRUE                        54520040
545300                  PERFORM DP013-0000-PROCESS-ABEND                54530040
545400         END-EVALUATE.                                            54540040
545500                                                                  54550040
545600/                                                                 54560040
545700*----------------------------------------------------------------*54570040
545800*    INSERT A PACK SLIP HEADER ROW FOR DELETED PKSLIP.           *54580040
545900*----------------------------------------------------------------*54590040
546000                                                                  54600040
546100 7015-INSERT-TPKSLIP-DELETED.                                     54610040
546200                                                                  54620040
546300                                                                  54630040
546400         EXEC SQL                                                 54640040
546500              INSERT INTO TPKSLIP                                 54650040
546600                     (PO_NBR,                                     54660040
546700                      SEQ_NBR,                                    54670040
546800                      CRE_TMST,                                   54680040
546900                      VER_STAT_CDE,                               54690040
547000                      OPER_UNT_ID,                                54700040
547100                      FCLTY_ID,                                   54710040
547200                      PKSL_NBR,                                   54720040
547300                      STR_DEST_NBR,                               54730040
547400                      REC_SEQ_NBR,                                54740040
547500                      SHIPT_ID,                                   54750040
547600                      BOL_NBR,                                    54760040
547700                      PRO_NBR,                                    54770040
547800                      PKSL_STAT_CDE,                              54780040
547900                      CRE_UID,                                    54790040
548000                      PO_VER_NBR,                                 54800040
548100                      CRE_SRC_CDE,                                54810040
548200                      EXPTED_PKG_QTY,                             54820040
548300                      OWNER_SCAC_ID,                              54830040
548400                      ASN_NBR,                                    54840040
548500                      VEND_SHIP_DTE,                              54850040
548600                      PKSL_PG_CNT,                                54860040
548700                      CONTNR_ID,                                  54870040
548800                      ORIG_PKSL_SEQ_NBR)                          54880040
548900              VALUES (:PKSLIP-PO-NBR,                             54890040
549000                      :PKSLIP-SEQ-NBR,                            54900040
549100                       CURRENT TIMESTAMP,                         54910040
549200                      :PC-INACTIVE,                               54920040
549300                      :PKSLIP-OPER-UNT-ID,                        54930040
549400                      :PKSLIP-FCLTY-ID,                           54940040
549500                      :PKSLIP-PKSL-NBR,                           54950040
549600                      :PKSLIP-STR-DEST-NBR,                       54960040
549700                      :PKSLIP-REC-SEQ-NBR,                        54970040
549800                      :PKSLIP-SHIPT-ID,                           54980040
549900                      :PKSLIP-BOL-NBR,                            54990040
550000                      :PKSLIP-PRO-NBR,                            55000040
550100                      :PC-DE,                                     55010040
550200                      :DP020-USERID,                              55020040
550300                      :PKSLIP-PO-VER-NBR,                         55030040
550400                      :PKSLIP-CRE-SRC-CDE,                        55040040
550500                      :PKSLIP-EXPTED-PKG-QTY,                     55050040
550600                      :PKSLIP-OWNER-SCAC-ID,                      55060040
550700                      :PKSLIP-ASN-NBR,                            55070040
550800                      :PKSLIP-VEND-SHIP-DTE,                      55080040
550900                      :PKSLIP-PKSL-PG-CNT,                        55090040
551000                      :PKSLIP-CONTNR-ID,                          55100040
551100                      :PKSLIP-ORIG-PKSL-SEQ-NBR)                  55110040
551200         END-EXEC                                                 55120040
551300                                                                  55130040
551400         EVALUATE TRUE                                            55140040
551500             WHEN SQLCODE = +0                                    55150040
551600                  IF PS-CARTON-DATA-YES AND                       55160040
551700                     PS-CARTON-ACTIVITY-NO                        55170040
551800                     PERFORM 7015A-DELETE-CARTONS                 55180040
551900                  ELSE                                            55190040
552000                     CONTINUE                                     55200040
552100                  END-IF                                          55210040
552200             WHEN SQLCODE = -904                                  55220040
552300             WHEN SQLCODE = -911                                  55230040
552400             WHEN SQLCODE = -913                                  55240040
552500                  SET PS-UPDATES-DONE TO TRUE                     55250040
552600                  PERFORM 9900-SOFT-ABORT                         55260040
552700                                                                  55270040
552800             WHEN SQLWARN0 NOT = SPACES                           55280040
552900             WHEN SQLCODE < +0                                    55290040
553000             WHEN SQLCODE > +0                                    55300040
553100                  MOVE '8020-INSERT-TPKSLIP'                      55310040
553200                                   TO DP013-PARAGRAPH             55320040
553300                  MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'          55330040
553400                                   TO DP013-MESSAGE-TEXT (1)      55340040
553500                  MOVE SQLCA       TO DP013-SQLCA                 55350040
553600                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    55360040
553700                  SET DP013-DB2-ABEND                             55370040
553800                      DP013-XCTL-DISPLAY-RESTART                  55380040
553900                                   TO TRUE                        55390040
554000                  PERFORM DP013-0000-PROCESS-ABEND                55400040
554100         END-EVALUATE.                                            55410040
554200                                                                  55420040
554300/                                                                 55430040
554400*----------------------------------------------------------------*55440040
554500*    DELETE CARTONS ON PACKSLIP                                  *55450040
554600*----------------------------------------------------------------*55460040
554700                                                                  55470040
554800 7015A-DELETE-CARTONS.                                            55480040
554900                                                                  55490040
555000         EXEC SQL                                                 55500040
555100              DELETE                                              55510040
555200                FROM TSHPUNT A                                    55520040
555300               WHERE EXISTS                                       55530040
555400                   (SELECT *                                      55540040
555500                FROM TINPKSU B                                    55550040
555600               WHERE PO_NBR         = :PKSLIP-PO-NBR              55560040
555700                 AND SEQ_NBR        = :PKSLIP-SEQ-NBR             55570040
555800                 AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID)             55580040
555900         END-EXEC                                                 55590040
556000                                                                  55600040
556100         EVALUATE TRUE                                            55610040
556200             WHEN SQLCODE = +0                                    55620040
556300             WHEN SQLCODE = +100                                  55630040
556400                  CONTINUE                                        55640040
556500             WHEN SQLCODE = -904                                  55650040
556600             WHEN SQLCODE = -911                                  55660040
556700             WHEN SQLCODE = -913                                  55670040
556800                  SET PS-UPDATES-DONE TO TRUE                     55680040
556900                  PERFORM 9900-SOFT-ABORT                         55690040
557000             WHEN SQLWARN0 NOT = SPACES                           55700040
557100             WHEN SQLCODE < +0                                    55710040
557200             WHEN SQLCODE > +0                                    55720040
557300                  MOVE '7015A-DELETE-CARTONS'                     55730040
557400                                   TO DP013-PARAGRAPH             55740040
557500                  MOVE 'UNSUCCESSFUL DELETE ON TSHPUNT'           55750040
557600                                   TO DP013-MESSAGE-TEXT (1)      55760040
557700                  MOVE SQLCA       TO DP013-SQLCA                 55770040
557800                  MOVE 'TSHPUNT '  TO DP013-DB2-TABLE-NAME (1)    55780040
557900                  SET DP013-DB2-ABEND                             55790040
558000                      DP013-XCTL-DISPLAY-RESTART                  55800040
558100                                   TO TRUE                        55810040
558200                  PERFORM DP013-0000-PROCESS-ABEND                55820040
558300         END-EVALUATE.                                            55830040
558400                                                                  55840040
558500                                                                  55850040
558600 7015B-CALL-PO-RCVR-TRKING-MOD.                                   55860040
558700     INITIALIZE RC071-FIELDS.                                     55870040
558800     MOVE PKSLIP-PO-NBR             TO RC071-PO-NBR               55880040
558900*    MOVE PKSLIP-REC-SEQ-NBR        TO RC071-PO-RCVR              55890043
559000     MOVE 0                         TO RC071-PO-RCVR              55900043
559100     MOVE PKSLIP-OPER-UNT-ID        TO RC071-SIGNON-LOCATION      55910040
559200     MOVE ZERO                      TO RC071-PO-LINE              55920040
559300     MOVE ZERO                      TO RC071-PREPK-ID             55930040
559400     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      55940040
559500     MOVE DP020-USERID              TO RC071-USER-ID              55950040
559600     IF PS-PACKSLIP-ONLY                                          55960041
559700         MOVE '0C'                  TO RC071-DC-FUNCTION-CODE     55970040
559800     END-IF                                                       55980040
559900     IF PS-PACKSLIP-WITH-CRTN-DATA                                55990041
560000         MOVE '0D'                  TO RC071-DC-FUNCTION-CODE     56000040
560100     END-IF                                                       56010040
560200     MOVE PKSLIP-SEQ-NBR            TO RC071-PKSL-SEQ-NBR         56020040
560300     MOVE PKSLIP-STR-DEST-NBR       TO RC071-DEST-OPER-UNT-ID     56030040
560400                                                                  56040040
560500                                                                  56050040
560600     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        56060040
560700                                                                  56070040
560800     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  56080040
560900                                        RC071-COMMAREA            56090040
561000                                        RC071-FIELDS.             56100040
561100     IF RC071-SUCCESSFUL                                          56110040
561200         CONTINUE                                                 56120040
561300     ELSE                                                         56130040
561400         MOVE '7015B-CALL-PO-RCVR-TRKING-MOD'                     56140040
561500                                 TO DP013-PARAGRAPH               56150040
561600         MOVE PKSLIP-PO-NBR       TO PC-DISPLAY-PO                56160040
561700         MOVE PKSLIP-REC-SEQ-NBR  TO PC-DISPLAY-RCVR              56170040
561800         MOVE PKSLIP-OPER-UNT-ID  TO PC-DISPLAY-OPER              56180040
561900         MOVE RC071-PO-LINE       TO PC-DISPLAY-LINE              56190040
562000         STRING ' RCKCS214-RC137'   DELIMITED BY SIZE             56200040
562100                ' RCVR: '           DELIMITED BY SIZE             56210040
562200                PC-DISPLAY-PO       DELIMITED BY SIZE             56220040
562300                '-'                 DELIMITED BY SIZE             56230040
562400                PC-DISPLAY-RCVR                                   56240040
562500                                    DELIMITED BY SIZE             56250040
562600                '  LINE: '          DELIMITED BY SIZE             56260040
562700                PC-DISPLAY-LINE                                   56270040
562800                                    DELIMITED BY SIZE             56280040
562900                '  FCLTY: '         DELIMITED BY SIZE             56290040
563000                PC-DISPLAY-OPER                                   56300040
563100                                    DELIMITED BY SIZE             56310040
563200                                 INTO PV-CICS-MSG-AREA            56320040
563300         MOVE LENGTH OF PV-CICS-MSG-AREA                          56330040
563400                                   TO PV-COMMAREA-LENGTH          56340040
563500         MOVE 'UNSUCCESSFUL CALL TO TRACKING MOD'                 56350040
563600                                     TO DP013-MESSAGE-TEXT (1)    56360040
563700         MOVE RC071-CRA-RET-MSG      TO DP013-MESSAGE-TEXT (2)    56370040
563800         STRING ' OPER: '            DELIMITED BY SIZE            56380040
563900              PC-DISPLAY-OPER        DELIMITED BY SIZE            56390040
564000                ' RCVR: '            DELIMITED BY SIZE            56400040
564100              PC-DISPLAY-PO          DELIMITED BY SIZE            56410040
564200              '-'                    DELIMITED BY SIZE            56420040
564300              PC-DISPLAY-RCVR        DELIMITED BY SIZE            56430040
564400              ' IND: '               DELIMITED BY SIZE            56440040
564500              RC071-SUCCESS-IND      DELIMITED BY SIZE            56450040
564600                               INTO DP013-MESSAGE-TEXT (3)        56460040
564700         STRING ' LINE: '            DELIMITED BY SIZE            56470040
564800              PC-DISPLAY-LINE        DELIMITED BY SIZE            56480040
564900                               INTO DP013-MESSAGE-TEXT (4)        56490040
565000         MOVE '7015B-CALL-PO-RCVR-TRKING-MOD'                     56500040
565100                                   TO DP013-PARAGRAPH             56510040
565200         SET DP013-XCTL-DISPLAY-RESTART                           56520040
565300             DP013-DB2-ABEND     TO TRUE                          56530040
565400         SET PS-ERROR                    TO TRUE                  56540040
565500         PERFORM DP013-0000-PROCESS-ABEND                         56550040
565600      END-IF.                                                     56560040
565700                                                                  56570040
565800*----------------------------------------------------------------*56580040
565900*    DELETE PACK SLIP LINE ITEMS                                 *56590040
566000*----------------------------------------------------------------*56600040
566100                                                                  56610040
566200 7020-DELETE-TPKITEM.                                             56620040
566300                                                                  56630040
566400                                                                  56640040
566500         EXEC SQL                                                 56650040
566600              DELETE                                              56660040
566700                FROM TPKITEM                                      56670040
566800               WHERE PO_NBR       = :DK-PO-NBR                    56680040
566900                 AND SEQ_NBR      = :ASC-SEQ-NBR                  56690040
567000                 AND VER_STAT_CDE = :PC-ACTIVE                    56700040
567100         END-EXEC                                                 56710040
567200                                                                  56720040
567300         EVALUATE TRUE                                            56730040
567400             WHEN SQLCODE = +0                                    56740040
567500             WHEN SQLCODE = +100                                  56750040
567600                  CONTINUE                                        56760040
567700             WHEN SQLCODE = -904                                  56770040
567800             WHEN SQLCODE = -911                                  56780040
567900             WHEN SQLCODE = -913                                  56790040
568000                  SET PS-UPDATES-DONE TO TRUE                     56800040
568100                  PERFORM 9900-SOFT-ABORT                         56810040
568200                                                                  56820040
568300             WHEN SQLWARN0 NOT = SPACES                           56830040
568400             WHEN SQLCODE < +0                                    56840040
568500             WHEN SQLCODE > +0                                    56850040
568600                  MOVE '7020-DELETE-TPKITEM'                      56860040
568700                                   TO DP013-PARAGRAPH             56870040
568800                  MOVE 'UNSUCCESSFUL DELETE ON TPKITEM'           56880040
568900                                   TO DP013-MESSAGE-TEXT (1)      56890040
569000                  MOVE SQLCA       TO DP013-SQLCA                 56900040
569100                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    56910040
569200                  SET DP013-DB2-ABEND                             56920040
569300                      DP013-XCTL-DISPLAY-RESTART                  56930040
569400                                   TO TRUE                        56940040
569500                  PERFORM DP013-0000-PROCESS-ABEND                56950040
569600         END-EVALUATE.                                            56960040
569700                                                                  56970040
569800/                                                                 56980040
569900*----------------------------------------------------------------*56990040
570000*    DELETE PACK SLIP UNMATCHED ITEMS                            *57000040
570100*----------------------------------------------------------------*57010040
570200                                                                  57020040
570300 7030-DELETE-TUNPKSL.                                             57030040
570400                                                                  57040040
570500                                                                  57050040
570600         EXEC SQL                                                 57060040
570700              DELETE                                              57070040
570800                FROM TUNPKSL                                      57080040
570900               WHERE PO_NBR       = :DK-PO-NBR                    57090040
571000                 AND SEQ_NBR      = :ASC-SEQ-NBR                  57100040
571100                 AND VER_STAT_CDE = :PC-ACTIVE                    57110040
571200         END-EXEC                                                 57120040
571300                                                                  57130040
571400         EVALUATE TRUE                                            57140040
571500             WHEN SQLCODE = +0                                    57150040
571600             WHEN SQLCODE = +100                                  57160040
571700                  CONTINUE                                        57170040
571800             WHEN SQLCODE = -904                                  57180040
571900             WHEN SQLCODE = -911                                  57190040
572000             WHEN SQLCODE = -913                                  57200040
572100                  SET PS-UPDATES-DONE TO TRUE                     57210040
572200                  PERFORM 9900-SOFT-ABORT                         57220040
572300                                                                  57230040
572400             WHEN SQLWARN0 NOT = SPACES                           57240040
572500             WHEN SQLCODE < +0                                    57250040
572600             WHEN SQLCODE > +0                                    57260040
572700                  MOVE '7030-DELETE-TUNPKSL'                      57270040
572800                                   TO DP013-PARAGRAPH             57280040
572900                  MOVE 'UNSUCCESSFUL DELETE ON TUNPKSL'           57290040
573000                                   TO DP013-MESSAGE-TEXT (1)      57300040
573100                  MOVE SQLCA       TO DP013-SQLCA                 57310040
573200                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    57320040
573300                  SET DP013-DB2-ABEND                             57330040
573400                      DP013-XCTL-DISPLAY-RESTART                  57340040
573500                                   TO TRUE                        57350040
573600                  PERFORM DP013-0000-PROCESS-ABEND                57360040
573700         END-EVALUATE.                                            57370040
573800/                                                                 57380040
573900*----------------------------------------------------------------*57390040
574000*    PERFORM COPY PACK SLIP PROCESSING                           *57400040
574100*----------------------------------------------------------------*57410040
574200 8000-COPY-PACK-SLIP.                                             57420040
574300                                                                  57430040
574400     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  57440040
574500                                                                  57450040
574600     PERFORM 8010-SELECT-TPKSLIP.                                 57460040
574700                                                                  57470040
574800     MOVE SPACES                   TO PKSLIP-CONTNR-ID.           57480040
574900                                                                  57490040
575000     MOVE ASC-PO-NBR-N             TO PKSLIP-PO-NBR.              57500040
575100     MOVE ASC-PKSL-NBR             TO PKSLIP-PKSL-NBR.            57510040
575200                                                                  57520040
575300     IF ASC-STR-DEST-NBR NUMERIC                                  57530040
575400         MOVE ASC-STR-DEST-NBR-N   TO PKSLIP-STR-DEST-NBR         57540040
575500     ELSE                                                         57550040
575600         MOVE ZEROS                TO PKSLIP-STR-DEST-NBR         57560040
575700     END-IF.                                                      57570040
575800                                                                  57580040
575900     MOVE ASC-EXPTED-PKG-QTY-N     TO PKSLIP-EXPTED-PKG-QTY.      57590040
576000                                                                  57600040
576100     IF ASC-REC-SEQ-NBR > ZEROS                                   57610040
576200         MOVE ASC-REC-SEQ-NBR-N    TO PKSLIP-REC-SEQ-NBR          57620040
576300     ELSE                                                         57630040
576400         MOVE ZEROS                TO PKSLIP-REC-SEQ-NBR          57640040
576500     END-IF.                                                      57650040
576600                                                                  57660040
576700     IF SHPTPO-SHIPT-ID > 0                                       57670040
576800         PERFORM 9000-GET-SHIPMENT-DATA                           57680040
576900     ELSE                                                         57690040
577000         MOVE ZEROS                TO SHIPMT-SHIPT-ID             57700040
577100         MOVE SPACES               TO SHIPMT-VEND-SHIP-DTE        57710040
577200     END-IF.                                                      57720040
577300                                                                  57730040
577400     MOVE SHIPMT-SHIPT-ID          TO PKSLIP-SHIPT-ID.            57740040
577500     MOVE ASC-BOL-NBR              TO PKSLIP-BOL-NBR.             57750040
577600     MOVE ASC-PRO-NBR              TO PKSLIP-PRO-NBR.             57760040
577700     MOVE ASC-CRE-SRC-CDE          TO PKSLIP-CRE-SRC-CDE.         57770040
577800     MOVE PC-IN                    TO PKSLIP-PKSL-STAT-CDE.       57780040
577900     MOVE ASC-CONTNR-ID            TO PKSLIP-CONTNR-ID.           57790040
578000                                                                  57800040
578100     PERFORM 5030-GET-NEXT-SEQ-NBR.                               57810040
578200     MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR.             57820040
578300                                                                  57830040
578400     MOVE PKSLIP-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.             57840040
578500     PERFORM 5005-FIND-TPKSLIP.                                   57850040
578600     IF  SQLCODE NOT EQUAL +100                                   57860040
578700         SET DP020-MSG-FATAL       TO TRUE                        57870040
578800         MOVE PC-TSYMSG-00868      TO DP020-MSG-NUMBER            57880040
578900         MOVE DP015-UNP-ALP-NOR-OFF TO APKSLIPA                   57890040
579000         MOVE DP015-RED            TO APKSLIPC                    57900040
579100         MOVE DP015-REVERSE        TO APKSLIPH                    57910040
579200         MOVE -1                   TO APKSLIPL                    57920040
579300         SET DP030-SET-CURSOR-APPL-1                              57930040
579400                                   TO TRUE                        57940040
579500     ELSE                                                         57950040
579600         PERFORM 8001-CONTINUE-COPY                               57960040
579700     END-IF.                                                      57970040
579800                                                                  57980040
579900 8001-CONTINUE-COPY.                                              57990040
580000                                                                  58000040
580100     PERFORM 8020-INSERT-TPKSLIP.                                 58010040
580200                                                                  58020040
580300     MOVE 'N'                      TO PS-EOF-TPKITEM-CSR-SW.      58030040
580400     MOVE 'N'                      TO PS-EOF-TUNPKSL-CSR-SW.      58040040
580500     MOVE ASC-SEQ-NBR              TO DK-SEQ-NBR.                 58050040
580600                                                                  58060040
580700     PERFORM 8100-OPEN-TPKITEM-CSR.                               58070040
580800     PERFORM 8110-FETCH-TPKITEM-CSR.                              58080040
580900                                                                  58090040
581000     PERFORM UNTIL PS-EOF-TPKITEM-CSR                             58100040
581100         PERFORM 8120-INSERT-TPKITEM                              58110040
581200         PERFORM 8110-FETCH-TPKITEM-CSR                           58120040
581300     END-PERFORM.                                                 58130040
581400                                                                  58140040
581500     PERFORM 8130-CLOSE-TPKITEM-CSR.                              58150040
581600                                                                  58160040
581700     PERFORM 8140-OPEN-TUNPKSL-CSR.                               58170040
581800     PERFORM 8150-FETCH-TUNPKSL-CSR.                              58180040
581900     PERFORM 8180-GET-NEXT-LINE-NBR.                              58190040
582000                                                                  58200040
582100     PERFORM UNTIL PS-EOF-TUNPKSL-CSR                             58210040
582200         PERFORM 8160-INSERT-TUNPKSL                              58220040
582300         ADD 1                     TO PV-NEXT-UNPKSL-LINE         58230040
582400         PERFORM 8150-FETCH-TUNPKSL-CSR                           58240040
582500     END-PERFORM.                                                 58250040
582600                                                                  58260040
582700     PERFORM 8170-CLOSE-TUNPKSL-CSR.                              58270040
582800                                                                  58280040
582900     MOVE PC-TSYMSG-00059          TO DP020-MSG-NUMBER.           58290040
583000     SET DP020-MSG-INFORMATIONAL                                  58300040
583100         ASC-COPY-SUCCESSFUL       TO TRUE.                       58310040
583200                                                                  58320040
583300     IF  ASC-USE-SELECTION-QUEUE                                  58330040
583400         PERFORM 5200-UPDATE-SELECTION-QUEUE                      58340040
583500     END-IF.                                                      58350040
583600                                                                  58360040
583700     MOVE ASC-PO-NBR-N             TO RC012-PO-NBR.               58370040
583800                                                                  58380040
583900/                                                                 58390040
584000*----------------------------------------------------------------*58400040
584100*    READ PACK SLIP HEADER TO BE COPIED                          *58410040
584200*----------------------------------------------------------------*58420040
584300 8010-SELECT-TPKSLIP.                                             58430040
584400                                                                  58440040
584500                                                                  58450040
584600         EXEC SQL                                                 58460040
584700              SELECT PO_NBR,                                      58470040
584800                     SEQ_NBR,                                     58480040
584900                     CRE_TMST,                                    58490040
585000                     VER_STAT_CDE,                                58500040
585100                     OPER_UNT_ID,                                 58510040
585200                     FCLTY_ID,                                    58520040
585300                     PKSL_NBR,                                    58530040
585400                     STR_DEST_NBR,                                58540040
585500                     REC_SEQ_NBR,                                 58550040
585600                     SHIPT_ID,                                    58560040
585700                     BOL_NBR,                                     58570040
585800                     PRO_NBR,                                     58580040
585900                     PKSL_STAT_CDE,                               58590040
586000                     CRE_UID,                                     58600040
586100                     PO_VER_NBR,                                  58610040
586200                     CRE_SRC_CDE,                                 58620040
586300                     EXPTED_PKG_QTY,                              58630040
586400                     OWNER_SCAC_ID,                               58640040
586500                     ASN_NBR,                                     58650040
586600                     VEND_SHIP_DTE,                               58660040
586700                     PKSL_PG_CNT,                                 58670040
586800                     CONTNR_ID,                                   58680040
586900                     ORIG_PKSL_SEQ_NBR                            58690040
587000                INTO :PKSLIP-PO-NBR,                              58700040
587100                     :PKSLIP-SEQ-NBR,                             58710040
587200                     :PKSLIP-CRE-TMST,                            58720040
587300                     :PKSLIP-VER-STAT-CDE,                        58730040
587400                     :PKSLIP-OPER-UNT-ID,                         58740040
587500                     :PKSLIP-FCLTY-ID,                            58750040
587600                     :PKSLIP-PKSL-NBR,                            58760040
587700                     :PKSLIP-STR-DEST-NBR,                        58770040
587800                     :PKSLIP-REC-SEQ-NBR,                         58780040
587900                     :PKSLIP-SHIPT-ID,                            58790040
588000                     :PKSLIP-BOL-NBR,                             58800040
588100                     :PKSLIP-PRO-NBR,                             58810040
588200                     :PKSLIP-PKSL-STAT-CDE,                       58820040
588300                     :PKSLIP-CRE-UID,                             58830040
588400                     :PKSLIP-PO-VER-NBR,                          58840040
588500                     :PKSLIP-CRE-SRC-CDE,                         58850040
588600                     :PKSLIP-EXPTED-PKG-QTY,                      58860040
588700                     :PKSLIP-OWNER-SCAC-ID,                       58870040
588800                     :PKSLIP-ASN-NBR,                             58880040
588900                     :PKSLIP-VEND-SHIP-DTE,                       58890040
589000                     :PKSLIP-PKSL-PG-CNT,                         58900040
589100                     :PKSLIP-CONTNR-ID,                           58910040
589200                     :PKSLIP-ORIG-PKSL-SEQ-NBR                    58920040
589300                FROM TPKSLIP                                      58930040
589400               WHERE PO_NBR       = :DK-PO-NBR                    58940040
589500                 AND SEQ_NBR      = :ASC-SEQ-NBR                  58950040
589600                 AND VER_STAT_CDE = :PC-ACTIVE                    58960040
589700         END-EXEC                                                 58970040
589800                                                                  58980040
589900         EVALUATE TRUE                                            58990040
590000             WHEN SQLCODE = +0                                    59000040
590100                  CONTINUE                                        59010040
590200             WHEN SQLCODE = -904                                  59020040
590300             WHEN SQLCODE = -911                                  59030040
590400             WHEN SQLCODE = -913                                  59040040
590500                  PERFORM 9900-SOFT-ABORT                         59050040
590600                                                                  59060040
590700             WHEN SQLWARN0 NOT = SPACES                           59070040
590800             WHEN SQLCODE < +0                                    59080040
590900             WHEN SQLCODE > +0                                    59090040
591000                  MOVE '8010-SELECT-TPKSLIP'                      59100040
591100                                   TO DP013-PARAGRAPH             59110040
591200                  MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'     59120040
591300                                   TO DP013-MESSAGE-TEXT (1)      59130040
591400                  MOVE SQLCA       TO DP013-SQLCA                 59140040
591500                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    59150040
591600                  SET DP013-DB2-ABEND                             59160040
591700                      DP013-XCTL-DISPLAY-RESTART                  59170040
591800                                   TO TRUE                        59180040
591900                  PERFORM DP013-0000-PROCESS-ABEND                59190040
592000         END-EVALUATE.                                            59200040
592100                                                                  59210040
592200/                                                                 59220040
592300*----------------------------------------------------------------*59230040
592400*    INSERT A PACK SLIP HEADER ROW                               *59240040
592500*----------------------------------------------------------------*59250040
592600                                                                  59260040
592700 8020-INSERT-TPKSLIP.                                             59270040
592800                                                                  59280040
592900                                                                  59290040
593000         EXEC SQL                                                 59300040
593100              INSERT INTO TPKSLIP                                 59310040
593200                     (PO_NBR,                                     59320040
593300                      SEQ_NBR,                                    59330040
593400                      CRE_TMST,                                   59340040
593500                      VER_STAT_CDE,                               59350040
593600                      OPER_UNT_ID,                                59360040
593700                      FCLTY_ID,                                   59370040
593800                      PKSL_NBR,                                   59380040
593900                      STR_DEST_NBR,                               59390040
594000                      REC_SEQ_NBR,                                59400040
594100                      SHIPT_ID,                                   59410040
594200                      BOL_NBR,                                    59420040
594300                      PRO_NBR,                                    59430040
594400                      PKSL_STAT_CDE,                              59440040
594500                      CRE_UID,                                    59450040
594600                      PO_VER_NBR,                                 59460040
594700                      CRE_SRC_CDE,                                59470040
594800                      EXPTED_PKG_QTY,                             59480040
594900                      CONTNR_ID,                                  59490040
595000                      ORIG_PKSL_SEQ_NBR)                          59500040
595100              VALUES (:PKSLIP-PO-NBR,                             59510040
595200                      :PKSLIP-SEQ-NBR,                            59520040
595300                       CURRENT TIMESTAMP,                         59530040
595400                      :PC-ACTIVE,                                 59540040
595500                      :PKSLIP-OPER-UNT-ID,                        59550040
595600                      :PKSLIP-FCLTY-ID,                           59560040
595700                      :PKSLIP-PKSL-NBR,                           59570040
595800                      :PKSLIP-STR-DEST-NBR,                       59580040
595900                      :PKSLIP-REC-SEQ-NBR,                        59590040
596000                      :PKSLIP-SHIPT-ID,                           59600040
596100                      :PKSLIP-BOL-NBR,                            59610040
596200                      :PKSLIP-PRO-NBR,                            59620040
596300                      :PKSLIP-PKSL-STAT-CDE,                      59630040
596400                      :DP020-USERID,                              59640040
596500                      :PKSLIP-PO-VER-NBR,                         59650040
596600                      :PKSLIP-CRE-SRC-CDE,                        59660040
596700                      :PKSLIP-EXPTED-PKG-QTY,                     59670040
596800                      :PKSLIP-CONTNR-ID,                          59680040
596900                      :PKSLIP-ORIG-PKSL-SEQ-NBR)                  59690040
597000         END-EXEC                                                 59700040
597100                                                                  59710040
597200         EVALUATE TRUE                                            59720040
597300             WHEN SQLCODE = +0                                    59730040
597400                  CONTINUE                                        59740040
597500             WHEN SQLCODE = -904                                  59750040
597600             WHEN SQLCODE = -911                                  59760040
597700             WHEN SQLCODE = -913                                  59770040
597800                  SET PS-UPDATES-DONE TO TRUE                     59780040
597900                  PERFORM 9900-SOFT-ABORT                         59790040
598000                                                                  59800040
598100             WHEN SQLWARN0 NOT = SPACES                           59810040
598200             WHEN SQLCODE < +0                                    59820040
598300             WHEN SQLCODE > +0                                    59830040
598400                  MOVE '8020-INSERT-TPKSLIP'                      59840040
598500                                   TO DP013-PARAGRAPH             59850040
598600                  MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'          59860040
598700                                   TO DP013-MESSAGE-TEXT (1)      59870040
598800                  MOVE SQLCA       TO DP013-SQLCA                 59880040
598900                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    59890040
599000                  SET DP013-DB2-ABEND                             59900040
599100                      DP013-XCTL-DISPLAY-RESTART                  59910040
599200                                   TO TRUE                        59920040
599300                  PERFORM DP013-0000-PROCESS-ABEND                59930040
599400         END-EVALUATE.                                            59940040
599500                                                                  59950040
599600/                                                                 59960040
599700*----------------------------------------------------------------*59970040
599800* OPEN THE PACK SLIP LINE ITEM CURSOR                            *59980040
599900*----------------------------------------------------------------*59990040
600000                                                                  60000040
600100 8100-OPEN-TPKITEM-CSR.                                           60010040
600200                                                                  60020040
600300                                                                  60030040
600400         EXEC SQL                                                 60040040
600500             OPEN TPKITEM-CSR                                     60050040
600600         END-EXEC                                                 60060040
600700                                                                  60070040
600800         EVALUATE TRUE                                            60080040
600900             WHEN SQLCODE = +0                                    60090040
601000                  CONTINUE                                        60100040
601100             WHEN SQLCODE = -904                                  60110040
601200             WHEN SQLCODE = -911                                  60120040
601300             WHEN SQLCODE = -913                                  60130040
601400                  PERFORM 9900-SOFT-ABORT                         60140040
601500                                                                  60150040
601600             WHEN SQLWARN0 NOT = SPACE                            60160040
601700             WHEN SQLCODE  NOT = +0                               60170040
601800                  MOVE '8100-OPEN-TPKITEM-CSR'                    60180040
601900                                   TO DP013-PARAGRAPH             60190040
602000                  MOVE 'OPEN TPKITEM-CSR CURSOR'                  60200040
602100                                   TO DP013-MESSAGE-TEXT (1)      60210040
602200                  MOVE SQLCA       TO DP013-SQLCA                 60220040
602300                  MOVE 'TPKITEM'   TO DP013-DB2-TABLE-NAME (1)    60230040
602400                  SET DP013-DB2-ABEND                             60240040
602500                                   TO TRUE                        60250040
602600                  PERFORM DP013-0000-PROCESS-ABEND                60260040
602700         END-EVALUATE.                                            60270040
602800                                                                  60280040
602900/                                                                 60290040
603000*----------------------------------------------------------------*60300040
603100*    FETCH A PACK SLIP ITEM ROW                                  *60310040
603200*----------------------------------------------------------------*60320040
603300                                                                  60330040
603400 8110-FETCH-TPKITEM-CSR.                                          60340040
603500                                                                  60350040
603600     EXEC SQL                                                     60360040
603700         FETCH TPKITEM-CSR                                        60370040
603800          INTO :PKITEM-PO-NBR,                                    60380040
603900               :PKITEM-SEQ-NBR,                                   60390040
604000               :PKITEM-PKSL-LNE-NBR,                              60400040
604100               :PKITEM-PKSL-ITM-QTY,                              60410040
604200               :PKITEM-PURITM-VER-NBR                             60420040
604300     END-EXEC.                                                    60430040
604400                                                                  60440040
604500     EVALUATE TRUE                                                60450040
604600         WHEN SQLCODE = +0                                        60460040
604700              CONTINUE                                            60470040
604800                                                                  60480040
604900         WHEN SQLCODE = +100                                      60490040
605000              SET PS-EOF-TPKITEM-CSR                              60500040
605100                                   TO TRUE                        60510040
605200         WHEN SQLCODE = -904                                      60520040
605300         WHEN SQLCODE = -911                                      60530040
605400         WHEN SQLCODE = -913                                      60540040
605500              PERFORM 9900-SOFT-ABORT                             60550040
605600                                                                  60560040
605700         WHEN SQLWARN0 NOT = SPACE                                60570040
605800         WHEN SQLCODE < +0                                        60580040
605900         WHEN SQLCODE > +0                                        60590040
606000              MOVE '8110-FETCH-TPKITEM-CSR'                       60600040
606100                                   TO DP013-PARAGRAPH             60610040
606200              MOVE 'FETCH TPKITEM CURSOR'                         60620040
606300                                   TO DP013-MESSAGE-TEXT (1)      60630040
606400              MOVE SQLCA           TO DP013-SQLCA                 60640040
606500              MOVE 'TPKITEM'       TO DP013-DB2-TABLE-NAME (1)    60650040
606600              SET DP013-DB2-ABEND  TO TRUE                        60660040
606700              PERFORM DP013-0000-PROCESS-ABEND                    60670040
606800     END-EVALUATE.                                                60680040
606900                                                                  60690040
607000                                                                  60700040
607100*----------------------------------------------------------------*60710040
607200*    INSERT A PACK SLIP ITEM ROW                                 *60720040
607300*----------------------------------------------------------------*60730040
607400                                                                  60740040
607500 8120-INSERT-TPKITEM.                                             60750040
607600                                                                  60760040
607700                                                                  60770040
607800*TCR  AUTOVE                                                      60780040
607900     SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                         60790040
608000     PERFORM 8125-CHECK-ASN.                                      60800040
608100     MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                              60810040
608200     IF PS-ORIG-ASN-PKSLIP-YES                                    60820040
608300        MOVE PKITEM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY          60830040
608400     END-IF.                                                      60840040
608500*TCR  AUTOVE                                                      60850040
608600                                                                  60860040
608700                                                                  60870040
608800         EXEC SQL                                                 60880040
608900              INSERT INTO TPKITEM                                 60890040
609000                     (PO_NBR,                                     60900040
609100                      SEQ_NBR,                                    60910040
609200                      PKSL_LNE_NBR,                               60920040
609300                      CRE_TMST,                                   60930040
609400                      VER_STAT_CDE,                               60940040
609500                      PKSL_ITM_QTY,                               60950040
609600                      CRE_UID,                                    60960040
609700                      PURITM_VER_NBR,                             60970040
609800                      ORIG_PKSL_ITM_QTY)                          60980040
609900              VALUES (:PKSLIP-PO-NBR,                             60990040
610000                      :PKSLIP-SEQ-NBR,                            61000040
610100                      :PKITEM-PKSL-LNE-NBR,                       61010040
610200                       CURRENT TIMESTAMP,                         61020040
610300                      :PC-ACTIVE,                                 61030040
610400                      :PKITEM-PKSL-ITM-QTY,                       61040040
610500                      :DP020-USERID,                              61050040
610600                      :PKITEM-PURITM-VER-NBR,                     61060040
610700                      :PV-ORIG-PKSL-ITM-QTY)                      61070040
610800         END-EXEC                                                 61080040
610900                                                                  61090040
611000         EVALUATE TRUE                                            61100040
611100             WHEN SQLCODE = +0                                    61110040
611200                  CONTINUE                                        61120040
611300             WHEN SQLCODE = -904                                  61130040
611400             WHEN SQLCODE = -911                                  61140040
611500             WHEN SQLCODE = -913                                  61150040
611600                  SET PS-UPDATES-DONE TO TRUE                     61160040
611700                  PERFORM 9900-SOFT-ABORT                         61170040
611800                                                                  61180040
611900             WHEN SQLWARN0 NOT = SPACES                           61190040
612000             WHEN SQLCODE < +0                                    61200040
612100             WHEN SQLCODE > +0                                    61210040
612200                  MOVE '8120-INSERT-TPKITEM'                      61220040
612300                                   TO DP013-PARAGRAPH             61230040
612400                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          61240040
612500                                   TO DP013-MESSAGE-TEXT (1)      61250040
612600                  MOVE SQLCA       TO DP013-SQLCA                 61260040
612700                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    61270040
612800                  SET DP013-DB2-ABEND                             61280040
612900                      DP013-XCTL-DISPLAY-RESTART                  61290040
613000                                   TO TRUE                        61300040
613100                  PERFORM DP013-0000-PROCESS-ABEND                61310040
613200         END-EVALUATE.                                            61320040
613300                                                                  61330040
613400******************************************************************61340040
613500**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **61350040
613600******************************************************************61360040
613700 8125-CHECK-ASN.                                                  61370040
613800                                                                  61380040
613900         MOVE 0 TO PV-COUNTER                                     61390040
614000                   PV-NULL-IND.                                   61400040
614100                                                                  61410040
614200         EXEC SQL                                                 61420040
614300           SELECT COUNT(CRE_UID)                                  61430040
614400           INTO  :PV-COUNTER:PV-NULL-IND                          61440040
614500           FROM   TPKSLIP                                         61450040
614600           WHERE  PO_NBR       = :DK-PO-NBR                       61460040
614700             AND  SEQ_NBR      = :ASC-SEQ-NBR                     61470040
614800             AND  CRE_UID      = 'RCKUP006'                       61480040
614900         END-EXEC.                                                61490040
615000                                                                  61500040
615100         EVALUATE TRUE                                            61510040
615200             WHEN SQLCODE = ZERO                                  61520040
615300                  IF PV-COUNTER > 0                               61530040
615400                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          61540040
615500                  END-IF                                          61550040
615600             WHEN SQLCODE = +100                                  61560040
615700                  CONTINUE                                        61570040
615800             WHEN SQLCODE = -904                                  61580040
615900             WHEN SQLCODE = -911                                  61590040
616000             WHEN SQLCODE = -913                                  61600040
616100                  CONTINUE                                        61610040
616200                                                                  61620040
616300             WHEN SQLWARN0 NOT = SPACES                           61630040
616400             WHEN SQLCODE  NOT = ZERO                             61640040
616500                  MOVE '8125-CHECK-ASN'                           61650040
616600                                   TO DP013-PARAGRAPH             61660040
616700                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          61670040
616800                                   TO DP013-MESSAGE-TEXT (1)      61680040
616900                  MOVE SQLCA       TO DP013-SQLCA                 61690040
617000                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    61700040
617100                  SET DP013-DB2-ABEND                             61710040
617200                      DP013-XCTL-DISPLAY-RESTART                  61720040
617300                                   TO TRUE                        61730040
617400                  PERFORM DP013-0000-PROCESS-ABEND                61740040
617500         END-EVALUATE.                                            61750040
617600                                                                  61760040
617700/                                                                 61770040
617800*----------------------------------------------------------------*61780040
617900* CLOSE THE PACK SLIP ITEM CURSOR                                *61790040
618000*----------------------------------------------------------------*61800040
618100                                                                  61810040
618200 8130-CLOSE-TPKITEM-CSR.                                          61820040
618300                                                                  61830040
618400     EXEC SQL                                                     61840040
618500         CLOSE TPKITEM-CSR                                        61850040
618600     END-EXEC.                                                    61860040
618700                                                                  61870040
618800     EVALUATE TRUE                                                61880040
618900         WHEN SQLCODE = +0                                        61890040
619000              CONTINUE                                            61900040
619100         WHEN SQLCODE = -904                                      61910040
619200         WHEN SQLCODE = -911                                      61920040
619300         WHEN SQLCODE = -913                                      61930040
619400              PERFORM 9900-SOFT-ABORT                             61940040
619500                                                                  61950040
619600         WHEN SQLWARN0 NOT = SPACE                                61960040
619700         WHEN SQLCODE  NOT = +0                                   61970040
619800              MOVE '8130-CLOSE-TPKITEM-CSR'                       61980040
619900                                   TO DP013-PARAGRAPH             61990040
620000              MOVE 'CLOSE TPKITEM-CSR CURSOR'                     62000040
620100                                   TO DP013-MESSAGE-TEXT (1)      62010040
620200              MOVE SQLCA           TO DP013-SQLCA                 62020040
620300              MOVE 'TPKITEM'       TO DP013-DB2-TABLE-NAME (1)    62030040
620400              SET DP013-DB2-ABEND  TO TRUE                        62040040
620500              PERFORM DP013-0000-PROCESS-ABEND                    62050040
620600     END-EVALUATE.                                                62060040
620700                                                                  62070040
620800/                                                                 62080040
620900*----------------------------------------------------------------*62090040
621000* OPEN THE UNMATCED PACK SLIP LINE ITEM CURSOR                   *62100040
621100*----------------------------------------------------------------*62110040
621200                                                                  62120040
621300 8140-OPEN-TUNPKSL-CSR.                                           62130040
621400                                                                  62140040
621500                                                                  62150040
621600         EXEC SQL                                                 62160040
621700             OPEN TUNPKSL-CSR                                     62170040
621800         END-EXEC                                                 62180040
621900                                                                  62190040
622000         EVALUATE TRUE                                            62200040
622100             WHEN SQLCODE = +0                                    62210040
622200                  CONTINUE                                        62220040
622300             WHEN SQLCODE = -904                                  62230040
622400             WHEN SQLCODE = -911                                  62240040
622500             WHEN SQLCODE = -913                                  62250040
622600                  PERFORM 9900-SOFT-ABORT                         62260040
622700                                                                  62270040
622800             WHEN SQLWARN0 NOT = SPACE                            62280040
622900             WHEN SQLCODE  NOT = +0                               62290040
623000                  MOVE '8140-OPEN-TUNPKSL-CSR'                    62300040
623100                                   TO DP013-PARAGRAPH             62310040
623200                  MOVE 'OPEN TUNPKSL-CSR CURSOR'                  62320040
623300                                   TO DP013-MESSAGE-TEXT (1)      62330040
623400                  MOVE SQLCA       TO DP013-SQLCA                 62340040
623500                  MOVE 'TUNPKSL'   TO DP013-DB2-TABLE-NAME (1)    62350040
623600                  SET DP013-DB2-ABEND                             62360040
623700                                   TO TRUE                        62370040
623800                  PERFORM DP013-0000-PROCESS-ABEND                62380040
623900         END-EVALUATE.                                            62390040
624000                                                                  62400040
624100/                                                                 62410040
624200*----------------------------------------------------------------*62420040
624300*    FETCH AN UNMATCHED PACK SLIP ITEM ROW                       *62430040
624400*----------------------------------------------------------------*62440040
624500                                                                  62450040
624600 8150-FETCH-TUNPKSL-CSR.                                          62460040
624700                                                                  62470040
624800     EXEC SQL                                                     62480040
624900         FETCH TUNPKSL-CSR                                        62490040
625000          INTO :UNPKSL-PO-NBR,                                    62500040
625100               :UNPKSL-SEQ-NBR,                                   62510040
625200               :UNPKSL-PKSL-LNE-NBR,                              62520040
625300               :UNPKSL-PKSL-ITM-QTY,                              62530040
625400               :UNPKSL-UNT-COST-AMT,                              62540040
625500               :UNPKSL-COLOR-DESC,                                62550040
625600               :UNPKSL-SIZE-DESC,                                 62560040
625700               :UNPKSL-VEND-STYL-NAME,                            62570040
625800               :UNPKSL-VEND-DESC                                  62580040
625900     END-EXEC.                                                    62590040
626000                                                                  62600040
626100     EVALUATE TRUE                                                62610040
626200         WHEN SQLCODE = +0                                        62620040
626300              CONTINUE                                            62630040
626400                                                                  62640040
626500         WHEN SQLCODE = +100                                      62650040
626600              SET PS-EOF-TUNPKSL-CSR                              62660040
626700                                   TO TRUE                        62670040
626800                                                                  62680040
626900             WHEN SQLCODE = -904                                  62690040
627000             WHEN SQLCODE = -911                                  62700040
627100             WHEN SQLCODE = -913                                  62710040
627200                  PERFORM 9900-SOFT-ABORT                         62720040
627300         WHEN SQLWARN0 NOT = SPACE                                62730040
627400         WHEN SQLCODE < +0                                        62740040
627500         WHEN SQLCODE > +0                                        62750040
627600              MOVE '8150-FETCH-TUNPKSL-CSR'                       62760040
627700                                   TO DP013-PARAGRAPH             62770040
627800              MOVE 'FETCH TUNPKSL CURSOR'                         62780040
627900                                   TO DP013-MESSAGE-TEXT (1)      62790040
628000              MOVE SQLCA           TO DP013-SQLCA                 62800040
628100              MOVE 'TUNPKSL'       TO DP013-DB2-TABLE-NAME (1)    62810040
628200              SET DP013-DB2-ABEND  TO TRUE                        62820040
628300              PERFORM DP013-0000-PROCESS-ABEND                    62830040
628400     END-EVALUATE.                                                62840040
628500                                                                  62850040
628600                                                                  62860040
628700*----------------------------------------------------------------*62870040
628800*    INSERT AN UNMATCHED PACK SLIP ITEM ROW                      *62880040
628900*----------------------------------------------------------------*62890040
629000                                                                  62900040
629100 8160-INSERT-TUNPKSL.                                             62910040
629200                                                                  62920040
629300                                                                  62930040
629400         EXEC SQL                                                 62940040
629500              INSERT INTO TUNPKSL                                 62950040
629600                     (PO_NBR,                                     62960040
629700                      SEQ_NBR,                                    62970040
629800                      PKSL_LNE_NBR,                               62980040
629900                      CRE_TMST,                                   62990040
630000                      VER_STAT_CDE,                               63000040
630100                      PKSL_ITM_QTY,                               63010040
630200                      UNT_COST_AMT,                               63020040
630300                      COLOR_DESC,                                 63030040
630400                      SIZE_DESC,                                  63040040
630500                      VEND_STYL_NAME,                             63050040
630600                      VEND_DESC,                                  63060040
630700                      CRE_UID)                                    63070040
630800              VALUES (:UNPKSL-PO-NBR,                             63080040
630900                      :PKSLIP-SEQ-NBR,                            63090040
631000                      :PV-NEXT-UNPKSL-LINE,                       63100040
631100                       CURRENT TIMESTAMP,                         63110040
631200                      :PC-ACTIVE,                                 63120040
631300                      :UNPKSL-PKSL-ITM-QTY,                       63130040
631400                      :UNPKSL-UNT-COST-AMT,                       63140040
631500                      :UNPKSL-COLOR-DESC,                         63150040
631600                      :UNPKSL-SIZE-DESC,                          63160040
631700                      :UNPKSL-VEND-STYL-NAME,                     63170040
631800                      :UNPKSL-VEND-DESC,                          63180040
631900                      :DP020-USERID)                              63190040
632000         END-EXEC                                                 63200040
632100                                                                  63210040
632200         EVALUATE TRUE                                            63220040
632300             WHEN SQLCODE = +0                                    63230040
632400                  CONTINUE                                        63240040
632500             WHEN SQLCODE = -904                                  63250040
632600             WHEN SQLCODE = -911                                  63260040
632700             WHEN SQLCODE = -913                                  63270040
632800                  SET PS-UPDATES-DONE TO TRUE                     63280040
632900                  PERFORM 9900-SOFT-ABORT                         63290040
633000                                                                  63300040
633100             WHEN SQLWARN0 NOT = SPACES                           63310040
633200             WHEN SQLCODE < +0                                    63320040
633300             WHEN SQLCODE > +0                                    63330040
633400                  MOVE '8160-INSERT-TUNPKSL'                      63340040
633500                                   TO DP013-PARAGRAPH             63350040
633600                  MOVE 'UNSUCCESSFUL INSERT FOR TUNPKSL'          63360040
633700                                   TO DP013-MESSAGE-TEXT (1)      63370040
633800                  MOVE SQLCA       TO DP013-SQLCA                 63380040
633900                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    63390040
634000                  SET DP013-DB2-ABEND                             63400040
634100                      DP013-XCTL-DISPLAY-RESTART                  63410040
634200                                   TO TRUE                        63420040
634300                  PERFORM DP013-0000-PROCESS-ABEND                63430040
634400         END-EVALUATE.                                            63440040
634500                                                                  63450040
634600/                                                                 63460040
634700*----------------------------------------------------------------*63470040
634800* CLOSE THE UNMATCHED PACK SLIP ITEM CURSOR                      *63480040
634900*----------------------------------------------------------------*63490040
635000                                                                  63500040
635100 8170-CLOSE-TUNPKSL-CSR.                                          63510040
635200                                                                  63520040
635300     EXEC SQL                                                     63530040
635400         CLOSE TUNPKSL-CSR                                        63540040
635500     END-EXEC.                                                    63550040
635600                                                                  63560040
635700     EVALUATE TRUE                                                63570040
635800         WHEN SQLCODE = +0                                        63580040
635900              CONTINUE                                            63590040
636000                                                                  63600040
636100         WHEN SQLCODE = -904                                      63610040
636200         WHEN SQLCODE = -911                                      63620040
636300         WHEN SQLCODE = -913                                      63630040
636400              PERFORM 9900-SOFT-ABORT                             63640040
636500                                                                  63650040
636600         WHEN SQLWARN0 NOT = SPACE                                63660040
636700         WHEN SQLCODE  NOT = +0                                   63670040
636800              MOVE '8170-CLOSE-TUNPKSL-CSR'                       63680040
636900                                   TO DP013-PARAGRAPH             63690040
637000              MOVE 'CLOSE TUNPKSL-CSR CURSOR'                     63700040
637100                                   TO DP013-MESSAGE-TEXT (1)      63710040
637200              MOVE SQLCA           TO DP013-SQLCA                 63720040
637300              MOVE 'TUNPKSL'       TO DP013-DB2-TABLE-NAME (1)    63730040
637400              SET DP013-DB2-ABEND  TO TRUE                        63740040
637500              PERFORM DP013-0000-PROCESS-ABEND                    63750040
637600     END-EVALUATE.                                                63760040
637700                                                                  63770040
637800*----------------------------------------------------------------*63780040
637900*    FIND THE ROW WITH THE HIGHEST UNMATCHED PACK SLIP LINE NBR  *63790040
638000*----------------------------------------------------------------*63800040
638100                                                                  63810040
638200 8180-GET-NEXT-LINE-NBR.                                          63820040
638300                                                                  63830040
638400                                                                  63840040
638500         EXEC SQL                                                 63850040
638600              SELECT MAX (PKSL_LNE_NBR)                           63860040
638700                INTO :PV-NEXT-UNPKSL-LINE :PV-LINE-NBR-IND        63870040
638800                FROM TUNPKSL                                      63880040
638900               WHERE PO_NBR = :DK-PO-NBR                          63890040
639000         END-EXEC                                                 63900040
639100                                                                  63910040
639200         EVALUATE TRUE                                            63920040
639300             WHEN SQLCODE = +0                                    63930040
639400                  IF PV-LINE-NBR-IND = -1                         63940040
639500                      MOVE PC-9000 TO PV-NEXT-UNPKSL-LINE         63950040
639600                  ELSE                                            63960040
639700                      COMPUTE PV-NEXT-UNPKSL-LINE =               63970040
639800                              PV-NEXT-UNPKSL-LINE + 1             63980040
639900                  END-IF                                          63990040
640000                                                                  64000040
640100             WHEN SQLCODE = +100                                  64010040
640200                  MOVE PC-9000     TO PV-NEXT-UNPKSL-LINE         64020040
640300                                                                  64030040
640400             WHEN SQLCODE = -904                                  64040040
640500             WHEN SQLCODE = -911                                  64050040
640600             WHEN SQLCODE = -913                                  64060040
640700                  PERFORM 9900-SOFT-ABORT                         64070040
640800                                                                  64080040
640900             WHEN SQLWARN0 NOT = SPACES                           64090040
641000             WHEN SQLCODE < +0                                    64100040
641100             WHEN SQLCODE > +0                                    64110040
641200                  MOVE '8180-GET-NEXT-LINE-NBR'                   64120040
641300                                   TO DP013-PARAGRAPH             64130040
641400                  MOVE 'UNSUCCESSFUL SELECT MAX LINE NBR'         64140040
641500                                   TO DP013-MESSAGE-TEXT (1)      64150040
641600                  MOVE SQLCA       TO DP013-SQLCA                 64160040
641700                  MOVE 'TUNPKSL '  TO DP013-DB2-TABLE-NAME (1)    64170040
641800                  SET DP013-DB2-ABEND                             64180040
641900                      DP013-XCTL-DISPLAY-RESTART                  64190040
642000                                   TO TRUE                        64200040
642100                  PERFORM DP013-0000-PROCESS-ABEND                64210040
642200         END-EVALUATE.                                            64220040
642300                                                                  64230040
642400 8190-SUM-INPKSU-CARTONS.                                         64240055
642500         MOVE ZEROES                 TO PV-INPKSU-CRTN-CNT.       64250047
642600         MOVE RC013-SEQ-NBR (ASC-SEL-SUB)                         64260054
642700                                     TO DK-SEQ-NBR.               64270054
642800                                                                  64280054
642900         EXEC SQL                                                 64290047
643000             SELECT COUNT(*)                                      64300047
643100               INTO :PV-INPKSU-CRTN-CNT                           64310047
643200               FROM TINPKSU                                       64320047
643300              WHERE PO_NBR        = :DK-PO-NBR                    64330047
643400                AND SEQ_NBR       = :DK-SEQ-NBR                   64340052
643500         END-EXEC                                                 64350047
643600                                                                  64360047
643700         EVALUATE TRUE                                            64370047
643800             WHEN SQLCODE = ZERO                                  64380047
643900             WHEN SQLCODE = +100                                  64390047
644000                  CONTINUE                                        64400047
644100             WHEN SQLCODE = -904                                  64410047
644200             WHEN SQLCODE = -911                                  64420047
644300             WHEN SQLCODE = -913                                  64430047
644400                  PERFORM 9900-SOFT-ABORT                         64440047
644500                                                                  64450047
644600             WHEN SQLWARN0 NOT = SPACES                           64460047
644700             WHEN SQLCODE  NOT = ZERO                             64470047
644800                  MOVE '8190-SUM-INPKSU-CARTONS '                 64480055
644900                                 TO DP013-PARAGRAPH               64490047
645000                  MOVE 'UNSUCCESSFUL SELECT OF INPKSU CARTONS '   64500047
645100                                 TO DP013-MESSAGE-TEXT (1)        64510047
645200                  MOVE SQLCA     TO DP013-SQLCA                   64520047
645300                  MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (1)      64530047
645400                  SET DP013-DB2-ABEND                             64540047
645500                      DP013-XCTL-DISPLAY-RESTART                  64550047
645600                                 TO TRUE                          64560047
645700                                                                  64570047
645800                  PERFORM DP013-0000-PROCESS-ABEND                64580047
645900         END-EVALUATE.                                            64590047
646000                                                                  64600051
646100/                                                                 64610047
646200 8200-VALIDATE-CTN-DATA.                                          64620040
646300                                                                  64630040
646400         EXEC SQL                                                 64640040
646500              SELECT COUNT(*)                                     64650040
646600                INTO :PV-PKSLIP-CTN-COUNT                         64660040
646700                FROM TPKSLIP A                                    64670040
646800                   , TINPKSU B                                    64680040
646900               WHERE A.PO_NBR        = :PKSLIP-PO-NBR             64690040
647000                 AND A.SEQ_NBR       = :PKSLIP-SEQ-NBR            64700040
647100                 AND A.PO_NBR        = B.PO_NBR                   64710040
647200                 AND A.SEQ_NBR       = B.SEQ_NBR                  64720040
647300         END-EXEC                                                 64730040
647400                                                                  64740040
647500         EVALUATE TRUE                                            64750040
647600             WHEN SQLCODE = +0                                    64760040
647700             WHEN SQLCODE = +100                                  64770040
647800                  CONTINUE                                        64780040
647900             WHEN SQLCODE = -904                                  64790040
648000             WHEN SQLCODE = -911                                  64800040
648100             WHEN SQLCODE = -913                                  64810040
648200                  PERFORM 9900-SOFT-ABORT                         64820040
648300             WHEN SQLWARN0 NOT = SPACES                           64830040
648400             WHEN SQLCODE < +0                                    64840040
648500             WHEN SQLCODE > +0                                    64850040
648600                  MOVE '8200-VALIDATE-CTN-DATA'                   64860040
648700                                  TO DP013-PARAGRAPH              64870040
648800                  MOVE 'UNSUCCESSFUL SELECT PACKSLIP CARTON COUNT'64880040
648900                                  TO DP013-MESSAGE-TEXT (1)       64890040
649000                  MOVE SQLCA      TO DP013-SQLCA                  64900040
649100                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     64910040
649200                  MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (2)     64920040
649300                  SET DP013-DB2-ABEND                             64930040
649400                      DP013-XCTL-DISPLAY-RESTART                  64940040
649500                                  TO TRUE                         64950040
649600                  PERFORM DP013-0000-PROCESS-ABEND                64960040
649700         END-EVALUATE.                                            64970040
649800                                                                  64980040
649900/                                                                 64990040
650000 8300-VALIDATE-CTN-ACTIVITY.                                      65000040
650100                                                                  65010040
650200         EXEC SQL                                                 65020040
650300              SELECT COUNT(*)                                     65030040
650400                INTO :PV-ACTIVE-CTN-COUNT                         65040040
650500                FROM TINPKSU A                                    65050040
650600                   , TSULBXF B                                    65060040
650700               WHERE A.PO_NBR        = :PKSLIP-PO-NBR             65070040
650800                 AND A.SEQ_NBR       = :PKSLIP-SEQ-NBR            65080040
650900                 AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID             65090040
651000                 AND B.STAT_CDE      = 'A'                        65100040
651100         END-EXEC                                                 65110040
651200                                                                  65120040
651300         EVALUATE TRUE                                            65130040
651400             WHEN SQLCODE = +0                                    65140040
651500             WHEN SQLCODE = +100                                  65150040
651600                  CONTINUE                                        65160040
651700             WHEN SQLCODE = -904                                  65170040
651800             WHEN SQLCODE = -911                                  65180040
651900             WHEN SQLCODE = -913                                  65190040
652000                  PERFORM 9900-SOFT-ABORT                         65200040
652100             WHEN SQLWARN0 NOT = SPACES                           65210040
652200             WHEN SQLCODE < +0                                    65220040
652300             WHEN SQLCODE > +0                                    65230040
652400                  MOVE '8300-VALIDATE-CTN-ACTIVITY'               65240040
652500                                  TO DP013-PARAGRAPH              65250040
652600                  MOVE 'UNSUCCESSFUL SELECT ACTIVE CARTON COUNT'  65260040
652700                                  TO DP013-MESSAGE-TEXT (1)       65270040
652800                  MOVE SQLCA      TO DP013-SQLCA                  65280040
652900                  MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (1)     65290040
653000                  MOVE 'TSULBXF ' TO DP013-DB2-TABLE-NAME (2)     65300040
653100                  SET DP013-DB2-ABEND                             65310040
653200                      DP013-XCTL-DISPLAY-RESTART                  65320040
653300                                  TO TRUE                         65330040
653400                  PERFORM DP013-0000-PROCESS-ABEND                65340040
653500         END-EVALUATE.                                            65350040
653600                                                                  65360040
653700/                                                                 65370040
653800*----------------------------------------------------------------*65380040
653900*    READ THE SHIPMENT RECORD TO RETRIEVE THE SHIPT ID           *65390040
654000*----------------------------------------------------------------*65400040
654100 9000-GET-SHIPMENT-DATA.                                          65410040
654200                                                                  65420040
654300                                                                  65430040
654400         EXEC SQL                                                 65440040
654500              SELECT SHIPT_ID,                                    65450040
654600                     VEND_SHIP_DTE                                65460040
654700                INTO :SHIPMT-SHIPT-ID,                            65470040
654800                     :SHIPMT-VEND-SHIP-DTE                        65480040
654900                FROM TSHIPMT                                      65490040
655000               WHERE SHIPT_ID = :SHPTPO-SHIPT-ID                  65500040
655100         END-EXEC                                                 65510040
655200                                                                  65520040
655300         EVALUATE TRUE                                            65530040
655400             WHEN SQLCODE = +0                                    65540040
655500                  CONTINUE                                        65550040
655600             WHEN SQLCODE = -904                                  65560040
655700             WHEN SQLCODE = -911                                  65570040
655800             WHEN SQLCODE = -913                                  65580040
655900                  PERFORM 9900-SOFT-ABORT                         65590040
656000                                                                  65600040
656100             WHEN SQLCODE = +100                                  65610040
656200                  MOVE ZEROS       TO SHIPMT-SHIPT-ID             65620040
656300                  MOVE SPACES      TO SHIPMT-VEND-SHIP-DTE        65630040
656400                                                                  65640040
656500             WHEN SQLWARN0 NOT = SPACES                           65650040
656600             WHEN SQLCODE < +0                                    65660040
656700             WHEN SQLCODE > +0                                    65670040
656800                  MOVE '9000-GET-SHIPMENT-DATA'                   65680040
656900                                   TO DP013-PARAGRAPH             65690040
657000                  MOVE 'UNSUCCESSFUL SELECT OF SHIPMENT TABLE'    65700040
657100                                   TO DP013-MESSAGE-TEXT (1)      65710040
657200                  MOVE SQLCA       TO DP013-SQLCA                 65720040
657300                  MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (1)    65730040
657400                  SET DP013-DB2-ABEND                             65740040
657500                      DP013-XCTL-DISPLAY-RESTART                  65750040
657600                                   TO TRUE                        65760040
657700                  PERFORM DP013-0000-PROCESS-ABEND                65770040
657800         END-EVALUATE.                                            65780040
657900                                                                  65790040
658000/                                                                 65800040
658100*----------------------------------------------------------------*65810040
658200*    RETRIEVE THE VERSION NUMBER OF THE PURCHASE ORDER           *65820040
658300*----------------------------------------------------------------*65830040
658400 9050-GET-PO-VER-NBR.                                             65840040
658500                                                                  65850040
658600                                                                  65860040
658700         EXEC SQL                                                 65870040
658800              SELECT VER_NBR                                      65880040
658900                INTO :PURCHS-VER-NBR                              65890040
659000                FROM TPURCHS                                      65900040
659100               WHERE PO_NBR         = :DK-PO-NBR                  65910040
659200                 AND VER_STATUS_CDE = :PC-ACTIVE                  65920040
659300         END-EXEC                                                 65930040
659400                                                                  65940040
659500         EVALUATE TRUE                                            65950040
659600             WHEN SQLCODE = +0                                    65960040
659700                  CONTINUE                                        65970040
659800             WHEN SQLCODE = -904                                  65980040
659900             WHEN SQLCODE = -911                                  65990040
660000             WHEN SQLCODE = -913                                  66000040
660100                  PERFORM 9900-SOFT-ABORT                         66010040
660200                                                                  66020040
660300             WHEN SQLCODE = +100                                  66030040
660400                  MOVE ZEROS       TO PURCHS-VER-NBR              66040040
660500                                                                  66050040
660600             WHEN SQLWARN0 NOT = SPACES                           66060040
660700             WHEN SQLCODE < +0                                    66070040
660800             WHEN SQLCODE > +0                                    66080040
660900                  MOVE '9050-GET-PO-VER-NBR'                      66090040
661000                                   TO DP013-PARAGRAPH             66100040
661100                  MOVE 'UNSUCCESSFUL SELECT ON PO HEADER'         66110040
661200                                   TO DP013-MESSAGE-TEXT (1)      66120040
661300                  MOVE SQLCA       TO DP013-SQLCA                 66130040
661400                  MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)    66140040
661500                  SET DP013-DB2-ABEND                             66150040
661600                      DP013-XCTL-DISPLAY-RESTART                  66160040
661700                                   TO TRUE                        66170040
661800                  PERFORM DP013-0000-PROCESS-ABEND                66180040
661900         END-EVALUATE.                                            66190040
662000                                                                  66200040
662100/                                                                 66210040
662200*----------------------------------------------------------------*66220040
662300*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *66230040
662400*----------------------------------------------------------------*66240040
662500                                                                  66250040
662600 9100-READ-SEL-QUEUE.                                             66260040
662700                                                                  66270040
662800     EXEC CICS                                                    66280040
662900         READQ TS                                                 66290040
663000             QUEUE (ASC-SEL-QUEUE-NAME)                           66300040
663100             INTO  ( RC013-DC-SELECT-RECORD )                     66310040
663200             ITEM  (ASC-SEL-ITEM)                                 66320040
663300             RESP  (PV-CICS-RESPONSE)                             66330040
663400     END-EXEC.                                                    66340040
663500                                                                  66350040
663600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       66360040
663700         CONTINUE                                                 66370040
663800     ELSE                                                         66380040
663900         SET DP013-LOGIC-ABEND                                    66390040
664000             DP013-NO-ROLLBACK     TO TRUE                        66400040
664100         MOVE '9100-READ-SEL-QUEUE'                               66410040
664200                                   TO DP013-PARAGRAPH             66420040
664300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   66430040
664400                                   TO DP013-MESSAGE-TEXT (1)      66440040
664500         MOVE ASC-SEL-TASK         TO PV-DISPLAY-TASK             66450040
664600         STRING 'QUEUE ID: '                                      66460040
664700                ASC-SEL-TERM-ID                                   66470040
664800                ' '                                               66480040
664900                PV-DISPLAY-TASK                                   66490040
665000                ' '                                               66500040
665100                ASC-SEL-SEQ DELIMITED BY SIZE                     66510040
665200                               INTO DP013-MESSAGE-TEXT (2)        66520040
665300         PERFORM DP013-0000-PROCESS-ABEND                         66530040
665400     END-IF.                                                      66540040
665500                                                                  66550040
665600/                                                                 66560040
665700*----------------------------------------------------------------*66570040
665800*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *66580040
665900*----------------------------------------------------------------*66590040
666000 9200-REWRITE-SEL-QUEUE.                                          66600040
666100                                                                  66610040
666200     EXEC CICS                                                    66620040
666300          WRITEQ TS                                               66630040
666400              QUEUE  (ASC-SEL-QUEUE-NAME)                         66640040
666500              FROM   (RC013-DC-SELECT-RECORD)                     66650040
666600              ITEM   (ASC-SEL-ITEM)                               66660040
666700              RESP   (PV-CICS-RESPONSE)                           66670040
666800              REWRITE                                             66680040
666900     END-EXEC.                                                    66690040
667000                                                                  66700040
667100     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   66710040
667200         SET DP013-CICS-ABEND                                     66720040
667300             DP013-NO-ROLLBACK     TO TRUE                        66730040
667400         MOVE '9200-REWRITE-SEL-QUEUE'                            66740040
667500                                   TO DP013-PARAGRAPH             66750040
667600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   66760040
667700                                   TO DP013-MESSAGE-TEXT (1)      66770040
667800         PERFORM DP013-0000-PROCESS-ABEND                         66780040
667900     END-IF.                                                      66790040
668000                                                                  66800040
668100*----------------------------------------------------------------*66810040
668200*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *66820040
668300*    AND THE ERROR SWITCHES.                                     *66830040
668400*----------------------------------------------------------------*66840040
668500 9900-SOFT-ABORT.                                                 66850040
668600     SET PS-ERROR         TO TRUE.                                66860040
668700     SET DP020-MSG-FATAL  TO TRUE.                                66870040
668800     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    66880040
668900     IF PS-NO-NEXT-SCREEN                                         66890040
669000        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     66900040
669100     END-IF.                                                      66910040
669200     PERFORM 9901-BACKUP.                                         66920040
669300                                                                  66930040
669400     MOVE PV-BOMB-MSG TO PV-CICS-MSG-AREA                         66940040
669500     MOVE LENGTH OF PV-CICS-MSG-AREA                              66950040
669600            TO PV-COMMAREA-LENGTH                                 66960040
669700                                                                  66970040
669800        EXEC CICS                                                 66980040
669900            WRITEQ TD                                             66990040
670000                QUEUE   ('CSSL')                                  67000040
670100                FROM    (PV-CICS-MSG-AREA)                        67010040
670200                LENGTH  (PV-COMMAREA-LENGTH)                      67020040
670300                RESP    (PV-CICS-RESPONSE)                        67030040
670400        END-EXEC.                                                 67040040
670500                                                                  67050040
670600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          67060040
670700     PERFORM 0001-CALL-CICS-ARCH-API.                             67070040
670800                                                                  67080040
670900 9901-BACKUP.                                                     67090040
671000     EXEC CICS SYNCPOINT                                          67100040
671100          ROLLBACK                                                67110040
671200     END-EXEC.                                                    67120040
671300/                                                                 67130040
671400*----------------------------------------------------------------*67140040
671500*    ABEND PROCESSOR MODULE                                      *67150040
671600*----------------------------------------------------------------*67160040
671700                                                                  67170040
671800     COPY DPPD013.                                                67180040
