000100******************************************************************00010007
000200 IDENTIFICATION DIVISION.                                         00020007
000300******************************************************************00030007
000400                                                                  00040007
000500 PROGRAM-ID.    TRKUP008.                                         00050007
000600 AUTHOR.        MIKE FRIESS.                                      00060007
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070007
000800 DATE-WRITTEN   FEBRUARY, 2001.                                   00080007
000900 DATE-COMPILED.                                                   00090007
001000                                                                  00100007
001100******************************************************************00110007
001200*              DC CONTAINER SPLIT RETRANSMISSION                  00120007
001300******************************************************************00130007
001400*  THIS PROGRAM CREATES 'CMN' RETRANSMISSION FILE FROM CONTAINER  00140007
001500*  TABLES. IT EXTRACTS A FILE TO A WORK TABLE TO BE TRANSMITTED   00150007
001600*  AS IMPORT DC SPLIT INFORMATION TO THE DECONSOLIDATOR. TWO ERROR00160007
001700*  REPORTS AND A DETAIL REPORT ARE ALSO WRITTEN TO A WORK TABLE.  00170007
001800******************************************************************00180007
001900* MM/DD/YYYY WHO & WHAT                                           00190007
002000* ---------- -----------------------------------------------------00200007
002100* 03/10/2010 FRANK WALA                                           00210007
002200*    REPLACE HARD-CODED EFC NUMBER 870 WITH XLT_LOC TABLE TO CHECK00220007
002300*    THE E_BUS_IND IN PARA 2410.                                  00230007
002400*    PARA 2440 WAS FLAGGED AS DEAD CODE - COMMENTED IT OUT.       00240007
002500*                                                                 00250007
002600******************************************************************00260007
002700 ENVIRONMENT DIVISION.                                            00270007
002800******************************************************************00280007
002900                                                                  00290007
003000 CONFIGURATION SECTION.                                           00300007
003100                                                                  00310007
003200 SOURCE-COMPUTER.        IBM-3090.                                00320007
003300 OBJECT-COMPUTER.        IBM-3090.                                00330007
003400                                                                  00340007
003500 INPUT-OUTPUT SECTION.                                            00350007
003600                                                                  00360007
003700 FILE-CONTROL.                                                    00370007
003800                                                                  00380007
003900     SELECT INPUT-ENT-FILE                                        00390007
004000         ASSIGN                       TO INP01.                   00400007
004100                                                                  00410007
004200******************************************************************00420007
004300 DATA DIVISION.                                                   00430007
004400******************************************************************00440007
004500                                                                  00450007
004600 FILE SECTION.                                                    00460007
004700                                                                  00470007
004800 FD  INPUT-ENT-FILE                                               00480007
004900     RECORDING MODE IS F                                          00490007
005000     LABEL RECORDS ARE STANDARD                                   00500007
005100     RECORD CONTAINS 80 CHARACTERS                                00510007
005200     BLOCK CONTAINS 0 RECORDS.                                    00520007
005300 01  INPUT-RECORD1                    PIC  X(80).                 00530007
005400                                                                  00540007
005500******************************************************************00550007
005600 WORKING-STORAGE SECTION.                                         00560007
005700******************************************************************00570007
005800*                                                                 00580007
005900*                                                                 00590007
006000******************************************************************00600007
006100*  DB2 FORMATTED MESSAGE AREA                                     00610007
006200******************************************************************00620007
006300     COPY DPWS004.                                                00630007
006400*                                                                 00640007
006500******************************************************************00650007
006600*  COMMUNICATIONS AREA FOR DB2                                    00660007
006700******************************************************************00670007
006800     EXEC SQL                                                     00680007
006900          INCLUDE SQLCA                                           00690007
007000     END-EXEC.                                                    00700007
007100*                                                                 00710007
007200******************************************************************00720007
007300*  DB2 TABLE DECLARATION - IMPORTS CONTAINER UPC                  00730007
007400******************************************************************00740007
007500     EXEC SQL                                                     00750007
007600          INCLUDE TIMCNUP                                         00760007
007700     END-EXEC.                                                    00770007
007800*                                                                 00780007
007900******************************************************************00790007
008000*  DB2 TABLE DECLARATION - IMPORTS CONTAINER                      00800007
008100******************************************************************00810007
008200     EXEC SQL                                                     00820007
008300          INCLUDE TIMCNTK                                         00830007
008400     END-EXEC.                                                    00840007
008500*                                                                 00850007
008600******************************************************************00860007
008700*  DB2 TABLE DECLARATION - UPC SKU TABLE                          00870007
008800******************************************************************00880007
008900     EXEC SQL                                                     00890007
009000          INCLUDE TUPCSKU                                         00900007
009100     END-EXEC.                                                    00910007
009200*                                                                 00920007
009300******************************************************************00930007
009400*  DB2 TABLE DECLARATION - UPC TABLE                              00940007
009500******************************************************************00950007
009600     EXEC SQL                                                     00960007
009700          INCLUDE TUPC                                            00970007
009800     END-EXEC.                                                    00980007
009900*                                                                 00990007
010000******************************************************************01000007
010100*  DB2 TABLE DECLARATION - SHIPMENT STATUS TYPE TABLE LAYOUT      01010007
010200*                               (TSHSTYP)                         01020007
010300******************************************************************01030007
010400     EXEC SQL                                                     01040007
010500          INCLUDE TSHSTYP                                         01050007
010600     END-EXEC.                                                    01060007
010700*                                                                 01070007
010800******************************************************************01080007
010900*  DB2 TABLE DECLARATION - PURCHASE ORDER PLANNED SHIPMENT        01090007
011000*      TABLE  (TPLNSHP)                                           01100007
011100******************************************************************01110007
011200     EXEC SQL                                                     01120007
011300          INCLUDE TPLNSHP                                         01130007
011400     END-EXEC.                                                    01140007
011500*                                                                 01150007
011600******************************************************************01160007
011700*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)01170007
011800******************************************************************01180007
011900     EXEC SQL                                                     01190007
012000          INCLUDE TPURCHS                                         01200007
012100     END-EXEC.                                                    01210007
012200*                                                                 01220007
012300******************************************************************01230007
012400*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE ITEM TABLE     01240007
012500*      (TPURITM)                                                  01250007
012600******************************************************************01260007
012700     EXEC SQL                                                     01270007
012800          INCLUDE TPURITM                                         01280007
012900     END-EXEC.                                                    01290007
013000*                                                                 01300007
013100***************************************************************** 01310007
013200*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01320007
013300***************************************************************** 01330007
013400     EXEC SQL                                                     01340007
013500          INCLUDE XLT00003                                        01350007
013600     END-EXEC.                                                    01360007
013700*                                                                 01370007
013800***************************************************************** 01380007
013900*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01390007
014000***************************************************************** 01400007
014100     EXEC SQL                                                     01410007
014200          INCLUDE XLT00004                                        01420007
014300     END-EXEC.                                                    01430007
014400*                                                                 01440007
014500******************************************************************01450007
014600*  DB2 TABLE DECLARATION - IMPORT CONTAINER SPLITS RELEASE TABLE  01460007
014700*                          FOR CON SIDE.                          01470007
014800******************************************************************01480007
014900     EXEC SQL                                                     01490007
015000          INCLUDE TIMPORL                                         01500007
015100     END-EXEC.                                                    01510007
015200*                                                                 01520007
015300******************************************************************01530007
015400*  DB2 TABLE DECLARATION - IMPORT CONTAINER SPLITS RELEASE TABLE  01540007
015500*                          FOR CMN SIDE.                          01550007
015600******************************************************************01560007
015700     EXEC SQL                                                     01570007
015800          INCLUDE TIMCNRL                                         01580007
015900     END-EXEC.                                                    01590007
016000*                                                                 01600007
016100******************************************************************01610007
016200*  DB2 TABLE DECLARATION - IMPORT CONTAINER SPLITS RELEASE AUDIT  01620007
016300******************************************************************01630007
016400     EXEC SQL                                                     01640007
016500          INCLUDE TAUCNRL                                         01650007
016600     END-EXEC.                                                    01660007
016700*                                                                 01670007
016800******************************************************************01680007
016900*  DB2 TABLE DECLARATION - PURCHASE ORDER ALLOCATION PLAN TABLE   01690007
017000*      (TALLPLN)                                                  01700007
017100******************************************************************01710007
017200     EXEC SQL                                                     01720007
017300          INCLUDE TALLPLN                                         01730007
017400     END-EXEC.                                                    01740007
017500*                                                                 01750007
139868******************************************************************01760035
139868*  DB2 TABLE DECLARATION - PURCHASE ORDER STORE ALLOCATION TABLE  01770035
139868*      (TMESTDS)                                                  01780035
139868******************************************************************01790035
139868     EXEC SQL                                                     01800035
139868          INCLUDE TMESTDS                                         01810035
139868     END-EXEC.                                                    01820035
139868*                                                                 01830035
139868******************************************************************01840035
139868*  DB2 TABLE DECLARATION - PARM TABLE                             01850035
139868*      (TKRPRPM)                                                  01860035
139868******************************************************************01870035
139868     EXEC SQL                                                     01880035
139868          INCLUDE TKRPRPM                                         01890035
139868     END-EXEC.                                                    01900035
139868                                                                  01910035
017600******************************************************************01920007
017700*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME TABLE         01930007
017800*      (TENTNME)                                                  01940007
017900******************************************************************01950007
018000     EXEC SQL                                                     01960007
018100          INCLUDE TENTNME                                         01970007
018200     END-EXEC.                                                    01980007
018300*                                                                 01990007
018400******************************************************************02000007
018500*  DB2 TABLE DECLARATION - PURCHASE ORDER INSTRUCTION CODES TABLE 02010007
018600*      (TINSTCD)                                                  02020007
018700******************************************************************02030007
018800     EXEC SQL                                                     02040007
018900          INCLUDE TINSTCD                                         02050007
019000     END-EXEC.                                                    02060007
019100*                                                                 02070007
019200******************************************************************02080007
019300*  DB2 TABLE DECLARATION - PURCHASE INSTRUCTION TABLE (TPOINST)   02090007
019400******************************************************************02100007
019500     EXEC SQL                                                     02110007
019600          INCLUDE TPOINST                                         02120007
019700     END-EXEC.                                                    02130007
019800                                                                  02140007
019900******************************************************************02150007
020000*  DB2 TABLE DECLARATION - SKU TABLE (TSKXREF)                    02160007
020100******************************************************************02170007
020200     EXEC SQL                                                     02180007
020300          INCLUDE TSKXREF                                         02190007
020400     END-EXEC.                                                    02200007
020500******************************************************************02210007
020600*  DB2 TABLE DECLARATION - EXTERNAL ENTITY TABLE (TEXTENT)        02220007
020700******************************************************************02230007
020800     EXEC SQL                                                     02240007
020900          INCLUDE TEXTENT                                         02250007
021000     END-EXEC.                                                    02260007
021100******************************************************************02270007
021200*  DB2 TABLE DECLARATION - PO PREPACK TABLE       (TPOPRPK)       02280007
021300******************************************************************02290007
021400     EXEC SQL                                                     02300007
021500          INCLUDE TPOPRPK                                         02310007
021600     END-EXEC.                                                    02320007
021700******************************************************************02330007
021800*  DB2 TABLE DECLARATION - PO TABLE             (TOUTTR2)         02340007
021900******************************************************************02350007
022000     EXEC SQL                                                     02360007
022100          INCLUDE TOUTTR2                                         02370007
022200     END-EXEC.                                                    02380007
022300******************************************************************02390007
022400*  DB2 TABLE DECLARATION - ERROR RPT TABLE       (TOUTTR3)        02400007
022500******************************************************************02410007
022600     EXEC SQL                                                     02420007
022700          INCLUDE TOUTTR3                                         02430007
022800     END-EXEC.                                                    02440007
022900******************************************************************02450007
023000*  DB2 TABLE DECLARATION - DETAIL RPT TABLE      (TOUTTR4)        02460007
023100******************************************************************02470007
023200     EXEC SQL                                                     02480007
023300          INCLUDE TOUTTR4                                         02490007
023400     END-EXEC.                                                    02500007
023500******************************************************************02510007
023600*  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 02520007
023700*  THIS TABLE IS USED TO STORE WORKING STOREAGE INFORMATION FOR   02530007
023800*  CHECKPOINT RESTARTS.                                           02540007
023900******************************************************************02550007
024000     EXEC SQL                                                     02560007
024100         INCLUDE TCKRSTIN                                         02570007
024200     END-EXEC.                                                    02580007
024300*                                                                 02590007
024400******************************************************************02600007
024500*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02610007
024600*  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    02620007
024700******************************************************************02630007
024800     EXEC SQL                                                     02640007
024900         INCLUDE TCKRSTCN                                         02650007
025000     END-EXEC.                                                    02660007
025100*                                                                 02670007
025200******************************************************************02680007
025300*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02690007
025400*  PO TABLE.                                                      02700007
025500******************************************************************02710007
025600     EXEC SQL                                                     02720007
025700         INCLUDE TIMCNPO                                          02730007
025800     END-EXEC.                                                    02740007
025900*                                                                 02750007
026000******************************************************************02760007
026100*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02770007
026200*  PO AUDIT TABLE.                                                02780007
026300******************************************************************02790007
026400     EXEC SQL                                                     02800007
026500         INCLUDE TAUCNPO                                          02810007
026600     END-EXEC.                                                    02820007
026700*                                                                 02830007
026800******************************************************************02840007
026900*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - PORT OF   02850007
027000*  ENTRY CODE TABLE.                                              02860007
027100******************************************************************02870007
027200     EXEC SQL                                                     02880007
027300         INCLUDE TIMPOE                                           02890007
027400     END-EXEC.                                                    02900007
027500*                                                                 02910007
027600******************************************************************02920007
027700*  DB2 TABLE DECLARATION - IT-UPC PHYSICAL LOCATION STATUS        02930007
027800******************************************************************02940007
027900     EXEC SQL                                                     02950007
028000         INCLUDE TUPCPLS                                          02960007
028100     END-EXEC.                                                    02970007
028200*                                                                 02980007
028300******************************************************************02990007
028400*  DB2 TABLE DECLARATION - TR IMPORTS CONTAINER CARTON SEAL       03000007
028500******************************************************************03010007
028600     EXEC SQL                                                     03020007
028700         INCLUDE TRT00006                                         03030007
028800     END-EXEC.                                                    03040007
028900*                                                                 03050007
029000******************************************************************03060007
029100*  DB2 TABLE DECLARATION - TR IMPORTS CONTAINER CARTON LABEL      03070007
029200******************************************************************03080007
029300     EXEC SQL                                                     03090007
029400         INCLUDE TRT00008                                         03100007
029500     END-EXEC.                                                    03110007
029600*                                                                 03120007
029700******************************************************************03130007
029800*  DB2 TABLE DECLARATION - TR DECONSOL CONTROL RULE TABLE         03140007
029900******************************************************************03150007
030000     EXEC SQL                                                     03160007
030100         INCLUDE TRT00014                                         03170007
030200     END-EXEC.                                                    03180007
030300*                                                                 03190007
030400******************************************************************03200007
030500*  DB2 TABLE DECLARATION - TR DECONSOL CONTROL RULE CONSTRAINTS   03210007
030600******************************************************************03220007
030700     EXEC SQL                                                     03230007
030800         INCLUDE TRT00015                                         03240007
030900     END-EXEC.                                                    03250007
031000*                                                                 03260007
031100******************************************************************03270007
031200*  DB2 TABLE DECLARATION - WEB ITEM TABLE FOR E-COMMERCE          03280007
031300******************************************************************03290007
031400     EXEC SQL                                                     03300007
031500         INCLUDE TWEBITM                                          03310007
031600     END-EXEC.                                                    03320007
031610*FJW 03/10/10 BEGIN                                               03330007
031620******************************************************************03340007
031630*  DB2 TABLE DECLARATION - EFC2 LOC TABLE FOR E-COMMERCE          03350007
031640******************************************************************03360007
031650     EXEC SQL                                                     03370007
031660         INCLUDE XLT00010                                         03380007
031670     END-EXEC.                                                    03390007
031680*FJW 03/10/10 END                                                 03400007
031690*                                                                 03410007
155029******************************************************************03420073
155029* DB2 TABLE DECLARATION - WST_INTGRTN_TYP TABLE                   03430073
155029******************************************************************03440073
155029     EXEC SQL                                                     03450073
155029          INCLUDE WST00008                                        03460073
155029     END-EXEC.                                                    03470073
155029*                                                                 03480073
155029******************************************************************03490073
155029* DB2 TABLE DECLARATION - WST_ATTR_DEFN TABLE                     03500073
155029******************************************************************03510073
155029     EXEC SQL                                                     03520073
155029          INCLUDE WST00009                                        03530073
155029     END-EXEC.                                                    03540073
155029*                                                                 03550073
155029******************************************************************03560073
155029* DB2 TABLE DECLARATION - WST_ATTR_ELEM TABLE                     03570073
155029******************************************************************03580073
155029     EXEC SQL                                                     03590073
155029          INCLUDE WST00010                                        03600073
155029     END-EXEC.                                                    03610073
155029*                                                                 03620073
031700******************************************************************03630007
031800*    IMPORT TRIP RECORD LAYOUT                                    03640007
031900******************************************************************03650007
032000     COPY TRRD004.                                                03660007
032100 EJECT                                                            03670007
032200                                                                  03680007
032300******************************************************************03690007
032400*    ERROR REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION        03700007
032500*    TRANSMISSION AND RETRANSMISSION.                             03710007
032600******************************************************************03720007
032700     COPY TRRD006.                                                03730007
032800 EJECT                                                            03740007
032900                                                                  03750007
033000******************************************************************03760007
033100*    DETAIL REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION       03770007
033200*    TRANSMISSION AND RETRANSMISSION.                             03780007
033300******************************************************************03790007
033400     COPY TRRD020.                                                03800007
033500 EJECT                                                            03810007
033600                                                                  03820007
033700******************************************************************03830007
033800*    ENTITY ID'S TABLE COPYBOOK LAYOUT                            03840007
033900******************************************************************03850007
034000     COPY TRRD030.                                                03860007
034100                                                                  03870007
034200 EJECT                                                            03880007
034300                                                                  03890007
034400 01  ABEND-CODE                      PIC S9(04)    VALUE +0       03900007
034500                                                   COMP SYNC.     03910007
034600*                                                                 03920007
034700 01  PA-PROGRAM-ACCUMULATORS.                                     03930007
034800     05  PA-TOTALS.                                               03940007
034900         10 PA-TOTAL-CURR-SPLIT-QTY   PIC  S9(13)  VALUE +0       03950007
035000                                                     COMP-3.      03960007
035100         10 PA-TOTAL-OUTPUT-REC-COUNT PIC  S9(13)  VALUE +0       03970007
035200                                                     COMP-3.      03980007
035300         10 PA-TOTAL-OTPK-ORD-QTY     PIC  S9(13)  VALUE +0       03990007
035400                                                     COMP-3.      04000007
035500         10 PA-TOTAL-INPK-ORD-QTY     PIC  S9(13)  VALUE +0       04010007
035600                                                     COMP-3.      04020007
035700         10 PA-TTL-PCK-UNITS-SENT                                 04030007
035800                                      PIC  S9(13)  VALUE +0       04040007
035900                                                     COMP-3.      04050007
036000         10 PA-TTL-PCK-CARTS-SENT                                 04060007
036100                                      PIC  S9(13)  VALUE +0       04070007
036200                                                     COMP-3.      04080007
036300         10 PA-TTL-ORDERED-PACK-QTY     PIC  S9(13)  VALUE +0     04090007
036400                                                     COMP-3.      04100007
036500                                                                  04110007
036600         10 PA-TTL-ORDERED-PACK-QTY-DC    PIC  S9(9) COMP.        04120007
036700                                                                  04130007
036800         10 PA-TTL-PCK-SPLIT-QTY-DC-PCT   PIC  9V99999            04140007
036900                                             VALUE ZERO.          04150007
037000                                                                  04160007
037100         10 PA-TOTAL-PACK-SPLIT-QTY-PCT PIC S9(13) VALUE +0       04170007
037200                                                     COMP-3.      04180007
037300         10 PA-TOTAL-PACK-SPLIT-QTY-CARTON PIC S9(13) VALUE +0    04190007
037400                                                      COMP-3.     04200007
037500         10 PA-TOTAL-PACK-SPLIT-CARTON  PIC S9(13) VALUE +0       04210007
037600                                                     COMP-3.      04220007
037700     05  PA-ERROR-COUNT               PIC  S9(13)    VALUE +0     04230007
037800                                                     COMP-3.      04240007
037900                                                                  04250007
038000 01  PS-PROGRAM-SWITCHES.                                         04260007
038100     05  PS-EOC-DRIVER-CURSOR-SW       PIC  X(01)    VALUE 'N'.   04270007
038200         88  PS-EOC-DRIVER-CURSOR                    VALUE 'Y'.   04280007
038300         88  PS-NOT-EOC-DRIVER-CURSOR                VALUE 'N'.   04290007
038400     05  PS-PO-IS-CON-RETRAN-SW        PIC  X(01)    VALUE 'N'.   04300007
038500         88  PS-PO-IS-CON-RETRAN                     VALUE 'Y'.   04310007
038600         88  PS-PO-IS-CON-RETRAN-NO                  VALUE 'N'.   04320007
038700     05  PS-ALL-MULTI-PACKS-SW         PIC  X(01)    VALUE 'N'.   04330007
038800         88  PS-ALL-MULTI-PACKS                      VALUE 'Y'.   04340007
038900         88  PS-ALL-MULTI-PACKS-NO                   VALUE 'N'.   04350007
039000     05  PS-THIS-PO-HAD-MULTI-SW       PIC  X(01)    VALUE 'N'.   04360007
039100         88  PS-THIS-PO-HAD-MULTI                    VALUE 'Y'.   04370007
039200         88  PS-THIS-PO-HAD-MULTI-NO                 VALUE 'N'.   04380007
039300     05  PS-EOC-MULTI-PACK-CUR-SW      PIC  X(01)    VALUE 'N'.   04390007
039400         88  PS-EOC-MULTI-PACK-CUR                   VALUE 'Y'.   04400007
039500         88  PS-EOC-MULTI-PACK-CUR-NO                VALUE 'N'.   04410007
039600     05  PS-EOC-CONT-CURSOR-SW         PIC  X(01)    VALUE 'N'.   04420007
039700         88  PS-EOC-CONT-CURSOR                      VALUE 'Y'.   04430007
039800         88  PS-EOC-CONT-CURSOR-NO                   VALUE 'N'.   04440007
039900     05  PS-EOC-PO-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04450007
040000         88  PS-EOC-PO-CURSOR                        VALUE 'Y'.   04460007
040100         88  PS-EOC-PO-CURSOR-NO                     VALUE 'N'.   04470007
040200     05  PS-EOC-INSTR-CURSOR-SW        PIC  X(01)    VALUE 'N'.   04480007
040300         88  PS-EOC-INSTR-CURSOR                     VALUE 'Y'.   04490007
040400         88  PS-EOC-INSTR-CURSOR-NO                  VALUE 'N'.   04500007
040500     05  PS-EOC-BULK-UPC-CUR-SW        PIC  X(01)    VALUE 'N'.   04510007
040600         88  PS-EOC-BULK-UPC-CUR                     VALUE 'Y'.   04520007
040700         88  PS-EOC-BULK-UPC-CUR-NO                  VALUE 'N'.   04530007
040800     05  PS-EOC-PREPACK-DC-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04540007
040900         88  PS-EOC-PREPACK-DC-CURSOR                VALUE 'Y'.   04550007
041000         88  PS-EOC-PREPACK-DC-CURSOR-NO             VALUE 'N'.   04560007
041100     05  PS-EOC-PREPACK-CM-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04570007
041200         88  PS-EOC-PREPACK-CM-CURSOR                VALUE 'Y'.   04580007
041300         88  PS-EOC-PREPACK-CM-CURSOR-NO             VALUE 'N'.   04590007
041400     05  PS-EOC-DC-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04600007
041500         88  PS-EOC-DC-CURSOR                        VALUE 'Y'.   04610007
041600         88  PS-EOC-DC-CURSOR-NO                     VALUE 'N'.   04620007
041700     05  PS-EOC-LINE-CNTR-CURSOR-SW PIC     X(01)    VALUE 'N'.   04630007
041800         88  PS-EOC-LINE-CNTR-CURSOR                 VALUE 'Y'.   04640007
041900         88  PS-EOC-LINE-CNTR-CURSOR-NO              VALUE 'N'.   04650007
042000     05  PS-EOC-POE-CURSOR-SW          PIC  X(01)    VALUE 'N'.   04660007
042100         88  PS-EOC-POE-CURSOR                       VALUE 'Y'.   04670007
042200         88  PS-EOC-POE-CURSOR-NO                    VALUE 'N'.   04680007
042300     05  PS-POE-CITY-FOUND-SW          PIC  X(01)    VALUE 'N'.   04690007
042400         88 PS-POE-CITY-FOUND                        VALUE 'Y'.   04700007
042500         88 PS-POE-CITY-FOUND-NO                     VALUE 'N'.   04710007
042600     05  PS-POE-ON-TIMPOE-SW           PIC  X(01)    VALUE 'N'.   04720007
042700         88 PS-POE-ON-TIMPOE                         VALUE 'Y'.   04730007
042800         88 PS-POE-ON-TIMPOE-NO                      VALUE 'N'.   04740007
042900     05  PS-EOC-PACK-CURSOR-SW PIC X(01)             VALUE 'N'.   04750007
043000         88  PS-EOC-PACK-CURSOR                      VALUE 'Y'.   04760007
043100         88  PS-EOC-PACK-CURSOR-NO                   VALUE 'N'.   04770007
043200     05  PS-EOC-POPRPK-FOR-PO-CUR-SW PIC X(01)       VALUE 'N'.   04780007
043300         88  PS-EOC-POPRPK-FOR-PO-CUR                VALUE 'Y'.   04790007
043400         88  PS-EOC-POPRPK-FOR-PO-CUR-NO             VALUE 'N'.   04800007
043500     05  PS-EOC-PURITM-TUPC-CUR-SW      PIC X(01)    VALUE 'N'.   04810007
043600         88  PS-EOC-PURITM-TUPC-CUR                  VALUE 'Y'.   04820007
043700         88  PS-EOC-PURITM-TUPC-CUR-NO               VALUE 'N'.   04830007
043800     05  PS-EOC-PREPACK-CURSOR-SW       PIC X(01)    VALUE 'N'.   04840007
043900         88  PS-EOC-PREPACK-CURSOR                   VALUE 'Y'.   04850007
044000         88  PS-EOC-PREPACK-CURSOR-NO                VALUE 'N'.   04860007
044100     05  PS-EOC-PDC-UNITS-CURSOR-SW     PIC X(01)    VALUE 'N'.   04870007
044200         88  PS-EOC-PDC-UNITS-CURSOR                 VALUE 'Y'.   04880007
044300         88  PS-EOC-PDC-UNITS-CURSOR-NO              VALUE 'N'.   04890007
044400     05  PS-EOC-PREPACK-UPC-CURSOR-SW   PIC X(01)    VALUE 'N'.   04900007
044500         88  PS-EOC-PREPACK-UPC-CURSOR               VALUE 'Y'.   04910007
044600         88  PS-EOC-PREPACK-UPC-CURSOR-NO            VALUE 'N'.   04920007
044700     05  PS-EOC-CART-LABEL-CURSOR-SW    PIC X(01)    VALUE 'N'.   04930007
044800         88  PS-EOC-CART-LABEL-CURSOR                VALUE 'Y'.   04940007
044900         88  PS-EOC-CART-LABEL-CURSOR-NO             VALUE 'N'.   04950007
045000     05  PS-UPCS-ON-TIMCNUP-SW         PIC  X(01)    VALUE 'N'.   04960007
045100         88  PS-UPCS-ON-TIMCNUP                      VALUE 'Y'.   04970007
045200         88  PS-UPCS-ON-TIMCNUP-NO                   VALUE 'N'.   04980007
045300     05  PS-UPCS-ON-PREPACK-SW         PIC  X(01)    VALUE 'N'.   04990007
045400         88  PS-UPCS-ON-PREPACK                      VALUE 'Y'.   05000007
045500         88  PS-UPCS-ON-PREPACK-NO                   VALUE 'N'.   05010007
045600     05  PS-PREPACKS-FOR-PO-SW         PIC  X(01)    VALUE 'N'.   05020007
045700         88  PS-PREPACKS-FOR-PO                      VALUE 'Y'.   05030007
045800         88  PS-PREPACKS-FOR-PO-NO                   VALUE 'N'.   05040007
045900     05  PS-DC-SPLIT-INFO-PRESENT-SW   PIC  X(01)    VALUE 'N'.   05050007
046000         88  PS-DC-SPLIT-INFO-PRESENT                VALUE 'Y'.   05060007
046100         88  PS-DC-SPLIT-INFO-PRESENT-NO             VALUE 'N'.   05070007
046200     05  PS-CONT-INFO-PRESENT-SW       PIC  X(01)    VALUE 'N'.   05080007
046300         88  PS-CONT-INFO-PRESENT                    VALUE 'Y'.   05090007
046400         88  PS-CONT-INFO-PRESENT-NO                 VALUE 'N'.   05100007
046500     05  PS-PO-CUR-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05110007
046600         88  PS-PO-CUR-INFO-PRESENT                  VALUE 'Y'.   05120007
046700         88  PS-PO-CUR-INFO-PRESENT-NO               VALUE 'N'.   05130007
046800     05  PS-CURR-SPLIT-QTY-PRESENT-SW  PIC  X(01)    VALUE 'N'.   05140007
046900         88  PS-CURR-SPLIT-QTY-PRESENT               VALUE 'Y'.   05150007
047000         88  PS-CURR-SPLIT-QTY-PRESENT-NO            VALUE 'N'.   05160007
047100     05  PS-PO-SEL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05170007
047200         88  PS-PO-SEL-INFO-PRESENT                  VALUE 'Y'.   05180007
047300         88  PS-PO-SEL-INFO-PRESENT-NO               VALUE 'N'.   05190007
047400     05  PS-IMCNRL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05200007
047500         88  PS-IMCNRL-INFO-PRESENT                  VALUE 'Y'.   05210007
047600         88  PS-IMCNRL-INFO-PRESENT-NO               VALUE 'N'.   05220007
047700     05  PS-CMN-PASSES-XMIT-TEST-SW    PIC  X(01)    VALUE 'N'.   05230007
047800         88  PS-CMN-PASSES-XMIT-TEST                 VALUE 'Y'.   05240007
047900         88  PS-CMN-PASSES-XMIT-TEST-NO              VALUE 'N'.   05250007
048000     05  PS-PO-PASSES-XMIT-TEST-SW    PIC   X(01)    VALUE 'Y'.   05260007
048100         88  PS-PO-PASSES-XMIT-TEST                  VALUE 'Y'.   05270007
048200         88  PS-PO-PASSES-XMIT-TEST-NO               VALUE 'N'.   05280007
048300     05  PS-BLANK-SPLT-XMIT-FOUND-SW   PIC  X(01)    VALUE 'N'.   05290007
048400         88 PS-BLANK-SPLT-XMIT-FOUND                 VALUE 'Y'.   05300007
048500         88 PS-BLANK-SPLT-XMIT-FOUND-NO              VALUE 'N'.   05310007
048600     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   05320007
048700         88  PS-NORMAL-RUN                           VALUE '0'.   05330007
048800         88  PS-RESTART-RUN                          VALUE '9'.   05340007
048900     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   05350007
049000         88  PS-COMMITS-TAKEN                        VALUE 'Y'.   05360007
049100         88  PS-COMMITS-TAKEN-NO                     VALUE 'N'.   05370007
049200     05  PS-PROBLEM-DO-NOT-SEND-SW     PIC  X(01)    VALUE 'N'.   05380007
049300         88  PS-PROBLEM-DO-NOT-SEND                  VALUE 'Y'.   05390007
049400         88  PS-PROBLEM-DO-NOT-SEND-NO               VALUE 'N'.   05400007
049500     05  PS-ZERO-OUTR-PACK-QTY-SW      PIC  X(01)    VALUE 'N'.   05410007
049600         88  PS-ZERO-OUTR-PACK-QTY                   VALUE 'Y'.   05420007
049700         88  PS-ZERO-OUTR-PACK-QTY-NO                VALUE 'N'.   05430007
049800     05  PS-SELECT-PACK-SUM-OK-SW      PIC  X(01)    VALUE 'N'.   05440007
049900         88  PS-SELECT-PACK-SUM-OK                   VALUE 'Y'.   05450007
050000         88  PS-SELECT-PACK-SUM-OK-NO                VALUE 'N'.   05460007
050100***  05  PS-ORDERED-EQUALS-SHIPPED-SW  PIC  X(01)    VALUE 'N'.   05470007
050200***      88  PS-ORDERED-EQUALS-SHIPPED               VALUE 'Y'.   05480007
050300***      88  PS-ORDERED-EQUALS-SHIPPED-NO            VALUE 'N'.   05490007
050400     05  PS-FIRST-DC-SW                PIC  X(01)    VALUE 'N'.   05500007
050500         88  PS-FIRST-DC                             VALUE 'Y'.   05510007
050600         88  PS-FIRST-DC-NO                          VALUE 'N'.   05520007
050700     05  PS-COUNT-DCS-OK-SW            PIC  X(01)    VALUE 'N'.   05530007
050800         88  PS-COUNT-DCS-OK                         VALUE 'Y'.   05540007
050900         88  PS-COUNT-DCS-OK-NO                      VALUE 'N'.   05550007
051000     05  PS-UPC-PASSESED-EDITS-SW      PIC  X(01)    VALUE 'N'.   05560007
051100         88  PS-UPC-PASSESED-EDITS                   VALUE 'Y'.   05570007
051200         88  PS-UPC-PASSESED-EDITS-NO                VALUE 'N'.   05580007
051300     05  PS-THERE-ARE-E-COM-DCS-SW     PIC  X(01)    VALUE 'N'.   05590007
051400         88  PS-THERE-ARE-E-COM-DCS                  VALUE 'Y'.   05600007
051500         88  PS-THERE-ARE-E-COM-DCS-NO               VALUE 'N'.   05610007
051600     05  PS-THIS-IS-E-COM-UPC-SW       PIC  X(01)    VALUE 'N'.   05620007
051700         88  PS-THIS-IS-E-COM-UPC                    VALUE 'Y'.   05630007
051800         88  PS-THIS-IS-E-COM-UPC-NO                 VALUE 'N'.   05640007
051900     05  PS-EOC-E-COM-PACK-UPC-CUR-SW  PIC  X(01)    VALUE 'N'.   05650007
052000         88  PS-EOC-E-COM-PACK-UPC-CUR               VALUE 'Y'.   05660007
052100         88  PS-EOC-E-COM-PACK-UPC-CUR-NO            VALUE 'N'.   05670007
052200     05  PS-PASSED-E-COM-CHECK-SW      PIC  X(01)    VALUE 'N'.   05680007
052300         88  PS-PASSED-E-COM-CHECK                   VALUE 'Y'.   05690007
052400         88  PS-PASSED-E-COM-CHECK-NO                VALUE 'N'.   05700007
052500                                                                  05710007
052600     05  PS-POE-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05720007
052700         88  PS-POE-WRITTEN                          VALUE 'Y'.   05730007
052800         88  PS-POE-WRITTEN-NO                       VALUE 'N'.   05740007
052900     05  PS-VES-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05750007
053000         88  PS-VES-WRITTEN                          VALUE 'Y'.   05760007
053100         88  PS-VES-WRITTEN-NO                       VALUE 'N'.   05770007
053200     05  PS-ETA-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05780007
053300         88  PS-ETA-WRITTEN                          VALUE 'Y'.   05790007
053400         88  PS-ETA-WRITTEN-NO                       VALUE 'N'.   05800007
053500     05  PS-CMN-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05810007
053600         88  PS-CMN-WRITTEN                          VALUE 'Y'.   05820007
053700         88  PS-CMN-WRITTEN-NO                       VALUE 'N'.   05830007
053800                                                                  05840007
053900     05  PS-SPLITS-ENTERED-SW          PIC  X(01)    VALUE 'N'.   05850007
054000         88  PS-SPLITS-ENTERED                       VALUE 'Y'.   05860007
054100                                                                  05870007
054200     05  PS-EOT-EXTRACT-SW             PIC  X(01)    VALUE 'N'.   05880007
054300         88  PS-EOT-EXTRACT                          VALUE 'Y'.   05890007
054400         88  PS-EOT-EXTRACT-NO                       VALUE 'N'.   05900007
054500                                                                  05910007
054600     05  PS-EOC-SEAL-CURSOR-SW         PIC  X(01)    VALUE 'N'.   05920007
054700         88  PS-EOC-SEAL-CURSOR                      VALUE 'Y'.   05930007
054800         88  PS-EOC-SEAL-CURSOR-NO                   VALUE 'N'.   05940007
054900                                                                  05950007
055000     05 PS-NEED-SEALS-SW               PIC  X(01)    VALUE 'N'.   05960007
055100         88  PS-NEED-SEALS                           VALUE 'Y'.   05970007
055200         88  PS-NEED-SEALS-NO                        VALUE 'N'.   05980007
055300                                                                  05990007
055400     05  PS-END-OF-INPUT-ENT-FILE-SW      PIC X(01) VALUE 'N'.    06000007
055500         88  PS-END-OF-INPUT-ENT-FILE               VALUE 'Y'.    06010007
055600         88  PS-END-OF-INPUT-ENT-FILE-NO            VALUE 'N'.    06020007
055700                                                                  06030007
055800     05  PS-RETRAN-MATCH-TRAN-ENTID-SW    PIC X(01) VALUE 'N'.    06040007
055900         88  PS-RETRAN-MATCH-TRAN-ENTID             VALUE 'Y'.    06050007
056000         88  PS-RETRAN-MATCH-TRAN-ENTID-NO          VALUE 'N'.    06060007
056100                                                                  06070007
056200     05  PS-ENTID-FOUND-SW                PIC X(01) VALUE 'N'.    06080007
056300         88  PS-ENTID-FOUND                         VALUE 'Y'.    06090007
056400         88  PS-ENTID-FOUND-NO                      VALUE 'N'.    06100007
056500                                                                  06110007
056600     05  PS-END-OF-ENTID-TABLE-SW         PIC X(01) VALUE 'N'.    06120007
056700         88  PS-END-OF-ENTID-TABLE                  VALUE 'Y'.    06130007
056800         88  PS-END-OF-ENTID-TABLE-NO               VALUE 'N'.    06140007
139868     05  PS-FIRST-STORE-SW             PIC  X(01)    VALUE 'N'.   06150035
139868         88  PS-FIRST-STORE                          VALUE 'Y'.   06160035
139868         88  PS-FIRST-STORE-NO                       VALUE 'N'.   06170035
139868     05  PS-EOC-STORE-CURSOR-SW        PIC  X(01)    VALUE 'N'.   06180035
139868         88  PS-EOC-STORE-CURSOR                     VALUE 'Y'.   06190035
139868         88  PS-EOC-STORE-CURSOR-NO                  VALUE 'N'.   06200035
139868     05  PS-OUTLET-STORE-SW            PIC  X(01)    VALUE 'N'.   06210035
139868         88  PS-OUTLET-STORE                         VALUE 'Y'.   06220035
139868         88  PS-OUTLET-STORE-NO                      VALUE 'N'.   06230035
155029     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   06240073
155029         88  PS-NEW-UPC-YES                          VALUE 'Y'.   06250073
155029         88  PS-NEW-UPC-NO                           VALUE 'N'.   06260073
155029     05  PS-FIRST-UPC-SW               PIC  X(01)    VALUE 'N'.   06270073
155029         88  PS-FIRST-UPC-YES                        VALUE 'Y'.   06280073
155029         88  PS-FIRST-UPC-NO                         VALUE 'N'.   06290073
155029     05  PS-BYPASS-CRTN-WRITE-SW       PIC  X(01)    VALUE 'N'.   06300073
155029         88  PS-BYPASS-CRTN-WRITE                    VALUE 'Y'.   06310073
155029         88  PS-BYPASS-CRTN-WRITE-NO                 VALUE 'N'.   06320073
056900                                                                  06330007
057000 01  PC-PROGRAM-CONSTANTS.                                        06340007
057100     05  PC-SYSTEM-CD                PIC  X(02)    VALUE 'RV'.    06350007
057200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          06360007
057300         'TRKUP008'.                                              06370007
057400     05  PC-CURRENT-JOB-NAME         PIC  X(06)    VALUE 'TRK035'.06380007
057500     05  PC-EN                       PIC X(02)     VALUE 'EN'.    06390007
057600     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     06400007
057700     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     06410007
057800     05  PC-A                        PIC X(01)     VALUE 'A'.     06420007
057900     05  PC-B                        PIC X(01)     VALUE 'B'.     06430007
058000     05  PC-C                        PIC X(01)     VALUE 'C'.     06440007
058100     05  PC-D                        PIC X(01)     VALUE 'D'.     06450007
058200     05  PC-I                        PIC X(01)     VALUE 'I'.     06460007
058300     05  PC-M                        PIC X(01)     VALUE 'M'.     06470007
058400     05  PC-N                        PIC X(01)     VALUE 'N'.     06480007
058500     05  PC-O                        PIC X(01)     VALUE 'O'.     06490007
058600     05  PC-R                        PIC X(01)     VALUE 'R'.     06500007
058700     05  PC-S                        PIC X(01)     VALUE 'S'.     06510007
058800     05  PC-T                        PIC X(01)     VALUE 'T'.     06520007
058900     05  PC-U                        PIC X(01)     VALUE 'U'.     06530007
059000     05  PC-Y                        PIC X(01)     VALUE 'Y'.     06540007
059100     05  PC-MULTI                    PIC X(05)     VALUE 'MULTI'. 06550007
059200     05  PC-NO-SIZE                  PIC X(07)     VALUE          06560007
059300                                                   'NO SIZE'.     06570007
059400     05  PC-NULL-DTE                PIC X(10) VALUE '9999-09-09'. 06580007
059500     05  PC-LOW-VALUE               PIC X(01)     VALUE           06590007
059600                                                  LOW-VALUE.      06600007
059700     05  PC-EXTRACT-TBL-LIMIT       PIC S9(08)  VALUE +70000.     06610007
059800     05  PC-DECONSOL-TBL-LIMIT      PIC S9(08)  VALUE +00100.     06620007
059900     05  PC-DEFAULT-DTE-9               PIC X(10)     VALUE       06630007
060000                                                    '9999-09-09'. 06640007
060100     05  PC-DEFAULT-TME-9               PIC X(08)     VALUE       06650007
060200                                                      '09.09.09'. 06660007
060300                                                                  06670007
060400*                                                                 06680007
060500 01  PV-PROGRAM-VARIABLES.                                        06690007
060600     05  PV-HOLD-PORT-OF-ENTRY-CTY   PIC X(30)     VALUE SPACE.   06700007
JNSINC*    05  PV-PARA-NAME                PIC X(40)     VALUE SPACE.   06701085
060700     05  PV-HOLD-MOM-DEST-POE        PIC X(4)      VALUE 'XXXX'.  06710007
060800     05  PV-HOLD-MOM-POE-DELY-TMST   PIC X(10)     VALUE SPACE.   06720007
060900     05  PV-HOLD-MOM-IMPRT-VEH-NM    PIC X(25)     VALUE SPACE.   06730007
      *CHG0210079                                                       06731075
061000*    05  PV-QUOTIENT-ORDER-PERCENT   PIC S9V999    COMP-3         06740074
061000     05  PV-QUOTIENT-ORDER-PERCENT   PIC S9V99999  COMP-3         06741074
061100                                                   VALUE ZERO.    06750007
      *CHG0210079                                                       06751075
155029     05  PV-DEPT-NBR                 PIC S9(4)V    VALUE ZEROES   06760073
155029                                                   COMP-3.        06770073
155029     05  PV-FAST-E-BUS-IND           PIC X(01)     VALUE SPACES.  06780073
155029     05  PV-FAST-RDC-IND             PIC X(01)     VALUE SPACES.  06790073
155029     05  PV-FAST-EFC-IND             PIC X(01)     VALUE SPACES.  06800073
155029     05  PV-HOLD-OUT-RECORD.                                      06810073
155029         10  FILLER                  PIC X(03)     VALUE SPACES.  06820073
155029         10  PV-HOLD-DIST-CNTR       PIC X(04)     VALUE SPACES.  06830073
155029         10  FILLER                  PIC X(243)    VALUE SPACES.  06840073
061200     05  PV-DC-CART-CT               PIC 9(12)V9   VALUE ZERO.    06850007
061300     05  PV-MULTI-HOLD-PO-NBR        PIC S9(09)    COMP-3         06860007
061400                                                   VALUE ZERO.    06870007
061500     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP-3         06880007
061600                                                   VALUE ZERO.    06890007
061700     05  PV-HOLD-PLAN-NBR            PIC S9(04)    COMP-3         06900007
061800                                                   VALUE ZERO.    06910007
061900     05  PV-HOLD-PO-PREPK-ID         PIC  9(08)    VALUE ZEROES.  06920007
062000     05  PV-HOLD-PO-PREPK-PO         PIC  9(08)    VALUE ZERO.    06930007
062100     05  PV-DEST-NBR                 PIC  9(04)    VALUE ZEROES.  06940007
062200     05  PV-CURRENT-TIME             PIC  X(26)    VALUE SPACES.  06950007
062300     05  PV-REMAINDER                PIC S9(3)V99  VALUE +0       06960007
062400                                                     COMP SYNC.   06970007
062500     05  PV-REMAINDER-UNPACKED       PIC 9(3)V99   VALUE ZERO.    06980007
062600     05  PV-TMST                     PIC X(26)     VALUE SPACES.  06990007
062700     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  07000007
062800     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACE.   07010007
062900     05  PV-HOLD-TR020-PO-NBR        PIC 9(09)     VALUE ZERO.    07020007
063000     05  PV-HOLD-TR020-PROCESS-DATE  PIC X(08)     VALUE SPACE.   07030007
063100     05  PV-HOLD-CONTNR-ID           PIC X(12)     VALUE SPACE.   07040007
063200     05  PV-HOLD-CONTNR-MULTI        PIC X(12)     VALUE SPACE.   07050007
063300     05  PV-TR006-DEPT-NBR           PIC  9(04).                  07060007
063400     05  PV-TR006-DEPT-NBR-X REDEFINES                            07070007
063500         PV-TR006-DEPT-NBR.                                       07080007
063600         10  FILLER                  PIC  X(01).                  07090007
063700         10  PV-TR006-DEPT-NBR-3     PIC  X(03).                  07100007
063800                                                                  07110007
063900     05  PV-MULTI-UPC-ROWS           PIC S9(04)    VALUE +0       07120007
064000                                                     COMP SYNC.   07130007
064100     05  PV-DB2-COUNT                PIC S9(04)    VALUE +0       07140007
064200                                                     COMP SYNC.   07150007
064300     05  PV-EDIT-DEST                PIC ZZZ9.                    07160007
064400     05  PV-EDIT-PREPK-ID            PIC ZZZ9.                    07170007
139868     05  PV-HOLD-PCK-UNIT-QTY        PIC  9(12)    VALUE ZERO.    07180035
139868     05  PV-HOLD-PCK-CART-CT         PIC  9(12)    VALUE ZERO.    07190035
139868     05  PV-HOLD-PCK-UNIT-PER-CTN    PIC  9(12)    VALUE ZERO.    07200035
064500                                                                  07210007
064600     05  PV-E-COM-WORK-FIELDS.                                    07220007
064700         10  PV-NBR-OF-E-COM-ROWS      PIC S9(04)  VALUE +0       07230007
064800                                                     COMP SYNC.   07240007
064900         10  PV-NBR-OF-E-COM-DCS       PIC S9(04)  VALUE +0       07250007
065000                                                     COMP SYNC.   07260007
065100         10  PV-TTL-BAD-PACK-UPCS       PIC S9(04)  VALUE +0      07270007
065200                                                    COMP SYNC.    07280007
065300         10  PV-TTL-E-COM-PACK-UPCS     PIC S9(04)  VALUE +0      07290007
065400                                                    COMP SYNC.    07300007
065500         10  PV-TTL-PACK-UPCS           PIC S9(04)  VALUE +0      07310007
065600                                                    COMP SYNC.    07320007
065700                                                                  07330007
065800     05  PV-LABEL-WORK-FIELDS.                                    07340007
065900         10  PV-NBR-CART-LBLS-UPC      PIC S9(09)    COMP-3       07350007
066000                                                   VALUE ZERO.    07360007
066100         10  PV-TTL-CART-LBLS-ALL-DCS  PIC S9(09)    COMP-3       07370007
066200                                                   VALUE ZERO.    07380007
066300         10  PV-NBR-CART-LBLS-THIS-DC  PIC S9(09)    COMP-3       07390007
066400                                                   VALUE ZERO.    07400007
066500         10  PV-CARTON-ROWS-FETCHED    PIC S9(09)    COMP-3       07410007
066600                                                   VALUE ZERO.    07420007
066700                                                                  07430007
066800     05 PV-DCNSL-SCAC                PIC X(04)  VALUE SPACES.     07440007
066900     05 PV-ENT-ID                    PIC 9(09)  VALUE ZEROES.     07450007
067000     05 PV-SEARCH-ENT-ID             PIC 9(09)  VALUE ZEROES.     07460007
067100     05 PV-HOLD-ENT-NAME             PIC X(10)  VALUE SPACES.     07470007
067200                                                                  07480007
067300     05  PV-ADJUST-ROUNDED-DC-WRK-FLDS.                           07490007
067400         10  PV-TTL-ALL-DCS-PCT         PIC S9(03) VALUE +0.      07500007
067500         10  PV-TTL-ALL-DCS-UNITS       PIC S9(15) VALUE +0.      07510007
067600         10  PV-TTL-ALL-DCS-CARTS       PIC S9(15) VALUE +0.      07520007
067700         10  PV-TOTAL-NBR-OF-DCS        PIC S9(04) VALUE +0       07530007
067800                                                     COMP SYNC.   07540007
067900         10  PV-DCS-TO-SKIP             PIC S9(05) VALUE +0.      07550007
068000                                                                  07560007
068100     05  PV-CART-PER-PO-WORK-FIELDS.                              07570007
068200         10  PV-SUM-INCNUP-CART-CNT     PIC S9(13) VALUE +0       07580007
068300                                                     COMP-3.      07590007
068400         10  PV-CART-PER-PREPACK        PIC S9(13) VALUE +0       07600007
068500                                                     COMP-3.      07610007
068600         10  PV-CART-PER-ITEM           PIC S9(13) VALUE +0       07620007
068700                                                     COMP-3.      07630007
068800                                                                  07640007
068900 01  PV-CKPT-RESTART-INFO.                                        07650007
069000     05  PV-RESTART-TOT-OUT-REC-COUNT    PIC  S9(13)  VALUE +0    07660007
069100                                                     COMP-3.      07670007
069200     05  PV-RESTART-ERROR-COUNT          PIC S9(13)  VALUE +0     07680007
069300                                                     COMP SYNC.   07690007
069400 01  PV-EXTRACT-TABLE.                                            07700007
069500     05  PV-TBL-EXT-ROW                                           07710007
069600              OCCURS 70000 TIMES                                  07720007
069700                  INDEXED BY EXT-INDEX.                           07730007
069800         10  PV-TBL-EXT-TYPE       PIC X(03).                     07740007
069900         10  FILLER                PIC X(247).                    07750007
070000                                                                  07760007
070100 01 PV-DECONSOL-NO-TABLE.                                         07770007
070200    05 PV-DECONSOL-NO-TABLE-ENTRIES OCCURS 100 TIMES              07780007
070300                                 INDEXED BY DECNO-IND.            07790007
070400       10 PV-TBL-DECON-ENT-ID     PIC 9(09).                      07800007
070500       10 PV-TBL-DECON-ENT-NAME   PIC X(10).                      07810007
070600                                                                  07820007
070700*                                                                 07830007
070800*                                                                 07840007
070900*  CURSOR DECLARATION FOR CONTAINER MAIN CURSOR                   07850007
071000*                                                                 07860007
071100*                                                                 07870007
071200     EXEC SQL                                                     07880007
071300          DECLARE CMN_DRIVER_CUR CURSOR WITH HOLD FOR             07890007
071400             SELECT                                               07900007
071500                 TK.MOM_POE_DELY_TMST                             07910007
071600                ,TK.MOM_IMPRT_VEH_NM                              07920007
071700                ,TK.MOM_TRIP_TYP_CDE                              07930007
071800                ,TK.MOM_DEST_POE_CDE                              07940007
071900                ,TK.CONTNR_ID                                     07950007
072000                ,TK.CONTNR_SEQ_NBR                                07960007
072100                ,PO.PO_NBR                                        07970007
072200                ,PO.EXTL_REF_NBR                                  07980007
072300                ,PO.SPLT_XMIT_CDE                                 07990007
072400                ,PO.PO_UNT_QTY                                    08000007
072500                ,PO.PO_CBMT_QTY                                   08010007
072600                ,PO.PO_WT_KGRM_QTY                                08020007
072700                ,TK.MOM_IMPRT_TRIP_ID                             08030007
072800                ,TK.MOM_CARR_SCAC_ID                              08040007
072900                ,TK.SIZE_CDE                                      08050007
073000             FROM                                                 08060007
073100                  TIMCNRL   RL                                    08070007
073200                , TIMCNPO   PO                                    08080007
073300                , TIMCNTK   TK                                    08090007
073400             WHERE  PO.CONTNR_ID        = TK.CONTNR_ID            08100007
GMINCC               AND  PO.CONTNR_ID NOT IN('FSCU8358181')            08103087
GMINCC*** BUD        AND  PO.CONTNR_ID NOT IN('CAXU9970895')            08104094
GMINCC               AND  PO.CONTNR_ID NOT IN('OOLU7610091')            08105092
GMINCC               AND  PO.CONTNR_ID NOT IN('OOLU7856510')            08106093
GMINCC               AND  PO.CONTNR_ID NOT IN('TRKU4448061')            08107096
073500               AND  PO.CONTNR_SEQ_NBR   = TK.CONTNR_SEQ_NBR       08110007
073600               AND  PO.SPLT_XMIT_CDE    = 'S'                     08120007
073700               AND  PO.CONTNR_ID        = RL.CONTNR_ID            08130007
073800               AND  PO.CONTNR_SEQ_NBR   = RL.CONTNR_SEQ_NBR       08140007
073900               AND  PO.PO_NBR           = RL.PO_NBR               08150007
074000               AND ((RL.DCONSLR_RLSE_CDE IN('S','M')) OR          08160007
074100                    (RL.DCONSLR_RLSE_CDE = 'D' AND                08170007
074200                     RL.DCONSLR_ACTL_DTE  < '9999-09-09'))        08180007
074300               AND (TK.MOM_POE_DELY_TMST + 120 DAYS)              08190007
074400                               > CURRENT TIMESTAMP                08200007
074500             ORDER BY                                             08210007
074600                 TK.MOM_DEST_POE_CDE                              08220007
074700                ,TK.CONTNR_ID                                     08230007
074800                ,TK.CONTNR_SEQ_NBR                                08240007
074900     END-EXEC.                                                    08250007
075000*                                                                 08260007
075100*                                                                 08270007
075200*  CURSOR DECLARATION FOR POE CITY                                08280007
075300*                                                                 08290007
075400*                                                                 08300007
075500*  NOTE: 1. WE DON'T CHECK PO_ASGMT_ALWD_IND BECAUSE CONSOLIDATOR 08310007
075600*           HAS CONTROL OF POE SENT.                              08320007
075700*        2. WE ASSUME OCEAN TRIP TYPE.                            08330007
075800*                                                                 08340007
075900     EXEC SQL                                                     08350007
076000          DECLARE POE_CUR CURSOR FOR                              08360007
076100           SELECT DISTINCT                                        08370007
076200                  P.POE_STD_EDI_CDE                               08380007
076300                 ,P.POE_CTY_NM                                    08390007
076400             FROM                                                 08400007
076500                TIMPOE    P                                       08410007
076600             WHERE P.POE_CDE = :IMPOE-POE-CDE                     08420007
076700               AND P.STAT_CDE = 'A'                               08430007
076800        ORDER BY  P.POE_STD_EDI_CDE                               08440007
076900     END-EXEC.                                                    08450007
077000*                                                                 08460007
077100*                                                                 08470007
077200*  CURSOR DECLARATION TO OBTAIN SPECIAL INSTRUCTIONS FOR PURCHASE 08480007
077300* ORDERS                                                          08490007
077400*                                                                 08500007
077500*                                                                 08510007
077600     EXEC SQL                                                     08520007
077700          DECLARE INSTR_CUR CURSOR FOR                            08530007
077800           SELECT                                                 08540007
077900                  CD.INSTR_DESC                                   08550007
078000                , CD.INSTR_NBR                                    08560007
078100                , PI.RECIP_CDE                                    08570007
078200             FROM                                                 08580007
078300                  TPOINST   PI                                    08590007
078400                , TINSTCD   CD                                    08600007
078500             WHERE PI.PO_NBR   =  :IMCNPO-PO-NBR                  08610007
P40877*              AND (PI.RECIP_CDE = 'DC'                           08620008
P40877*               OR  PI.RECIP_CDE = 'DE')                          08630008
P40877               AND PI.RECIP_CDE = 'DE'                            08640008
078800               AND PI.INSTR_NBR  =  CD.INSTR_NBR                  08650007
078900         ORDER BY PI.RECIP_CDE DESC                               08660007
079000                , CD.INSTR_NBR                                    08670007
079100     END-EXEC.                                                    08680007
079200*                                                                 08690007
079300*                                                                 08700007
079400*  CURSOR DECLARATION TO OBTAIN BULK UPCS FOR PURCHASE ORDER.     08710007
079500*                                                                 08720007
079600*                                                                 08730007
079700     EXEC SQL                                                     08740007
079800          DECLARE BULK_UPC_CUR CURSOR FOR                         08750007
079900           SELECT DISTINCT                                        08760007
080000                  CNUP.UPC_NBR                                    08770007
080100                , CNUP.UPC_UNT_QTY                                08780007
080200                , CNUP.UPC_CART_CNT                               08790007
080300                , CNUP.SKU_NBR                                    08800007
080400                , CNUP.ASN_PKGNG_CDE                              08810007
080500                , CNUP.UPC_CBMT_QTY                               08820007
080600                , CNUP.UPC_WT_KGRM_QTY                            08830007
080700                , PUR.ITM_NBR                                     08840007
080800                , XS.NRF_CLOR_CDE                                 08850007
080900                , XS.CSTM_CLOR_DESC                               08860007
081000                , XS.SIZE_DESC                                    08870007
081100                , XS.SKU_DESC                                     08880007
081200                , XVS.VS_NBR                                      08890007
081300                , SKX.DEPT                                        08900007
081400                , SKX.CLASS                                       08910007
081500                , SKX.SUBCLASS                                    08920007
081600                , SKX.SKU                                         08930007
081610                , PUR.OUTR_PK_QTY                                 08940007
081700             FROM TIMCNUP      CNUP                               08950007
081800                 ,TPURCHS      PO                                 08960007
081900                 ,TPURITM      PUR                                08970007
082000                 ,TUPCSKU      SKU                                08980007
082100                 ,TSKXREF      SKX                                08990007
082200                 ,XLT_SKU      XS                                 09000007
082300                 ,XLT_VND_STYL XVS                                09010007
082400             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        09020007
082500               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   09030007
082600               AND CNUP.PO_NBR         = :IMCNPO-PO-NBR           09040007
082700               AND CNUP.UPC_NBR        =  SKU.UPC_NBR             09050007
082800               AND SKU.ITEM_NBR        =  PUR.ITM_NBR             09060007
082900               AND PUR.ITM_NBR         =  XS.ITM_NBR              09070007
083000               AND XS.STYL_ID          =  XVS.STYL_ID             09080007
083100               AND PUR.VER_STATUS_CDE  = 'A'                      09090007
083200               AND PUR.STATUS_CDE      IN ('AC', 'AP')            09100007
083300               AND PUR.PO_NBR          =  CNUP.PO_NBR             09110007
083400               AND PO.PO_NBR           =  PUR.PO_NBR              09120007
083500               AND PUR.ITM_NBR         =  SKX.ITM_NBR             09130007
083600             ORDER BY CNUP.UPC_NBR                                09140007
083700     END-EXEC.                                                    09150007
083800*                                                                 09160007
083900*                                                                 09170007
084000*  CURSOR DECLARATION TO OBTAIN ALL DISTRIBUTION CENTER SPLITS FOR09180007
084100*  BULK UPCS ON PURCHASE ORDER.                                   09190007
084200*                                                                 09200007
084300*                                                                 09210007
084400     EXEC SQL                                                     09220007
084500          DECLARE DC_CUR CURSOR FOR                               09230007
084600           SELECT                                                 09240007
084700                  AL.DEST_NBR                                     09250007
155029                , XL.E_BUS_IND                                    09260073
084800                , SUM (AL.CURR_SPLIT_QTY) AS SUMSPLIT             09270007
084900             FROM                                                 09280007
085000                  TIMCNUP   CNUP                                  09290007
085100                 ,TUPCSKU   SKU                                   09300007
085200                 ,TPURITM   PUR                                   09310007
085300                 ,TALLPLN   AL                                    09320007
155029                 ,XLT_LOC   XL                                    09330073
085400             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        09340007
GMINCC               AND CNUP.CONTNR_ID NOT IN('FSCU8358181')           09341090
085500               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   09350007
085600               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          09360007
085700               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            09370007
155029           AND CNUP.UPC_NBR = SKU.UPC_NBR                         09380073
085800               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           09390007
085900               AND PUR.VER_STATUS_CDE  = 'A'                      09400007
086000               AND PUR.STATUS_CDE     IN ('AC', 'AP')             09410007
086100               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          09420007
155029               AND AL.DEST_NBR         =  XL.LOC_NBR              09430073
086200               AND AL.PO_NBR           =  PUR.PO_NBR              09440007
086300               AND AL.CURR_SPLIT_QTY   >  0                       09450007
086400            GROUP BY AL.DEST_NBR                                  09460007
155029                    ,XL.E_BUS_IND                                 09470073
155029            ORDER BY XL.E_BUS_IND                                 09480073
086500                    ,SUMSPLIT                                     09490048
086600                    ,AL.DEST_NBR                                  09500048
086700     END-EXEC.                                                    09510007
086800*                                                                 09520007
086900*                                                                 09530007
087000*  CURSOR DECLARATION TO OBTAIN CONTAINER QUANTITIES AT THE PACK  09540007
087100*  LEVEL.                                                         09550007
087200*                                                                 09560007
087300*                                                                 09570007
087400     EXEC SQL                                                     09580007
087500          DECLARE PREPACK_CUR CURSOR FOR                          09590007
087600           SELECT DISTINCT                                        09600007
087700                  POP.PO_PREPK_ID                                 09610007
087800                 ,POP.PREPK_UPC_NBR                               09620007
087900                 ,POP.PK_SKU_NBR                                  09630007
088000                 ,POP.INPK_UNT_QTY                                09640007
088100                 ,POP.OTPK_UNT_QTY                                09650007
088100                 ,POP.PREPK_TYP_CDE                               09660009
088200                 ,CNUP.UPC_UNT_QTY                                09670007
088300                 ,CNUP.UPC_CART_CNT                               09680007
088400                 ,CNUP.SKU_NBR                                    09690007
088500                 ,CNUP.ASN_PKGNG_CDE                              09700007
088600                 ,CNUP.UPC_CBMT_QTY                               09710007
088700                 ,CNUP.UPC_WT_KGRM_QTY                            09720007
088800             FROM TIMCNUP   CNUP                                  09730007
088900                 ,TPOPRPK   POP                                   09740007
089000                 ,TPURITM   PUR                                   09750007
089100             WHERE POP.PO_NBR          = :IMCNPO-PO-NBR           09760007
089200               AND PUR.PO_NBR          =  POP.PO_NBR              09770007
089300               AND PUR.PO_PREPK_ID     =  POP.PO_PREPK_ID         09780007
089400               AND PUR.VER_STATUS_CDE  = 'A'                      09790007
089500               AND PUR.STATUS_CDE      IN ('AC', 'AP')            09800007
089600               AND CNUP.PO_NBR         =  POP.PO_NBR              09810007
089700               AND CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        09820007
089800               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   09830007
089900               AND CNUP.UPC_NBR        =  POP.PREPK_UPC_NBR       09840007
090000               AND EXISTS                                         09850007
090100                  (SELECT *                                       09860007
090200                     FROM TPURITM      A                          09870007
090300                         ,TUPCSKU      B                          09880007
090400                         ,TUPC         C                          09890007
090500                         ,TPOPRPK      D                          09900007
090600                         ,TSKXREF      E                          09910007
090700                         ,XLT_VND_STYL XVS                        09920007
090800                         ,XLT_SKU      XS                         09930007
090900                     WHERE A.PO_NBR       = :IMCNPO-PO-NBR        09940007
091000                       AND A.ITM_NBR      =  XS.ITM_NBR           09950007
091100                       AND XS.STYL_ID     =  XVS.STYL_ID          09960007
091200                       AND A.VER_STATUS_CDE = 'A'                 09970007
091300                       AND A.STATUS_CDE  IN ('AC', 'AP')          09980007
091400                       AND A.PO_PREPK_ID  = POP.PO_PREPK_ID       09990007
091500                       AND B.ITEM_NBR     = A.ITM_NBR             10000007
091600                       AND B.UPC_NBR      = C.UPC_NBR             10010007
091700                       AND C.UPC_TYP_CDE  = 'I'                   10020007
091800                       AND C.EFF_END_DTE IS NULL                  10030007
091900                       AND D.PO_PREPK_ID  = A.PO_PREPK_ID         10040007
092000                       AND D.PO_NBR       = A.PO_NBR              10050007
092100                       AND A.ITM_NBR      = E.ITM_NBR             10060007
092200                   )                                              10070007
092300             ORDER BY POP.PO_PREPK_ID                             10080007
092400     END-EXEC.                                                    10090007
092500*                                                                 10100007
092600*                                                                 10110007
092700*  CURSOR DECLARATION TO OBTAIN THE ORDERED QUANTITIES AT THE     10120007
092800*  PACK/DC LEVELS                                                 10130007
092900*                                                                 10140007
093000*                                                                 10150007
093100     EXEC SQL                                                     10160007
093200          DECLARE PREPACK_DC_CUR CURSOR FOR                       10170007
093300           SELECT                                                 10180007
093400                  TALL.DEST_NBR                                   10190007
155029                 ,XLT.E_BUS_IND                                   10200073
093500                 ,SUM (TALL.CURR_SPLIT_QTY) AS SUMSPLIT           10210007
093600             FROM                                                 10220007
093700                  TALLPLN   TALL                                  10230007
093800                 ,TPURITM   PUR                                   10240007
155029                 ,XLT_LOC   XLT                                   10250073
093900             WHERE PUR.PO_NBR          = :IMCNPO-PO-NBR           10260007
094000               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      10270007
155029               AND TALL.DEST_NBR       =  XLT.LOC_NBR             10280073
094100               AND PUR.VER_STATUS_CDE  = 'A'                      10290007
094200               AND PUR.STATUS_CDE      IN ('AC', 'AP')            10300007
094300               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          10310007
094400               AND TALL.PO_NBR         =  PUR.PO_NBR              10320007
094500               AND TALL.CURR_SPLIT_QTY >  0                       10330007
094600          GROUP BY TALL.DEST_NBR                                  10340007
155029                  ,XLT.E_BUS_IND                                  10350073
155029          ORDER BY XLT.E_BUS_IND                                  10360073
094700                  ,SUMSPLIT                                       10370045
094800                  ,TALL.DEST_NBR                                  10380007
094900     END-EXEC.                                                    10390007
095000*                                                                 10400007
095100*                                                                 10410007
095200*  CURSOR DECLRATION TO OBTAIN PREPACK UPC LEVEL DATA             10420007
095300*                                                                 10430007
095400*                                                                 10440007
095500     EXEC SQL                                                     10450007
095600          DECLARE PACK_UPC_CUR CURSOR FOR                         10460007
095700           SELECT                                                 10470007
095800                  B.UPC_NBR                                       10480007
095900                , XVS.VS_NBR                                      10490007
096000                , XS.NRF_CLOR_CDE                                 10500007
096100                , XS.CSTM_CLOR_DESC                               10510007
096200                , XS.SIZE_DESC                                    10520007
096300                , XS.SKU_DESC                                     10530007
096400                , A.UNT_QTY                                       10540007
096500                , A.PREPK_RATO_QTY                                10550007
096600                , D.OTPK_UNT_QTY                                  10560007
096700                , D.INPK_UNT_QTY                                  10570007
096700                , D.PREPK_TYP_CDE                                 10580009
096800                , E.DEPT                                          10590007
096900                , E.CLASS                                         10600007
097000                , E.SUBCLASS                                      10610007
097100                , E.SKU                                           10620007
097200             FROM                                                 10630007
097300                  TPURITM      A                                  10640007
097400                 ,TUPCSKU      B                                  10650007
097500                 ,TUPC         C                                  10660007
097600                 ,TPOPRPK      D                                  10670007
097700                 ,TSKXREF      E                                  10680007
097800                 ,XLT_VND_STYL XVS                                10690007
097900                 ,XLT_SKU      XS                                 10700007
098000             WHERE A.PO_NBR       = :IMCNPO-PO-NBR                10710007
098100               AND A.ITM_NBR      =  XS.ITM_NBR                   10720007
098200               AND XS.STYL_ID     =  XVS.STYL_ID                  10730007
098300               AND A.VER_STATUS_CDE = 'A'                         10740007
098400               AND A.STATUS_CDE  IN ('AC', 'AP')                  10750007
098500               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           10760007
098600               AND B.ITEM_NBR     = A.ITM_NBR                     10770007
098700               AND B.UPC_NBR      = C.UPC_NBR                     10780007
098800               AND C.UPC_TYP_CDE  = 'I'                           10790007
098900               AND C.EFF_END_DTE IS NULL                          10800007
099000               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 10810007
099100               AND D.PO_NBR       = A.PO_NBR                      10820007
099200               AND A.ITM_NBR      = E.ITM_NBR                     10830007
099300             ORDER BY B.UPC_NBR                                   10840007
099400     END-EXEC.                                                    10850007
099500*                                                                 10860007
099600*                                                                 10870007
099700*  CURSOR DECLRATION TO OBTAIN E-COMMERCE PREPACK UPC LEVEL DATA  10880007
099800*                                                                 10890007
099900*                                                                 10900007
100000     EXEC SQL                                                     10910007
100100          DECLARE E_COM_PACK_UPC_CUR CURSOR FOR                   10920007
100200           SELECT                                                 10930007
100300                  B.UPC_NBR                                       10940007
100400                 ,A.PO_LNE_NBR                                    10950007
100500             FROM                                                 10960007
100600                  TPURITM  A                                      10970007
100700                 ,TUPCSKU  B                                      10980007
100800                 ,TUPC     C                                      10990007
100900                 ,TPOPRPK  D                                      11000007
101000             WHERE A.PO_NBR       = :IMCNPO-PO-NBR                11010007
101100               AND A.VER_STATUS_CDE = 'A'                         11020007
101200               AND A.STATUS_CDE  IN ('AC', 'AP')                  11030007
101300               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           11040007
101400               AND B.ITEM_NBR     = A.ITM_NBR                     11050007
101500               AND B.UPC_NBR      = C.UPC_NBR                     11060007
101600               AND C.UPC_TYP_CDE  = 'I'                           11070007
101700               AND C.EFF_END_DTE IS NULL                          11080007
101800               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 11090007
101900               AND D.PO_NBR       = A.PO_NBR                      11100007
102000             ORDER BY B.UPC_NBR                                   11110007
102100     END-EXEC.                                                    11120007
102200*                                                                 11130007
102300*                                                                 11140007
102400* CARTON CURSOR                                                   11150007
102500*                                                                 11160007
102600*                                                                 11170007
102700     EXEC SQL                                                     11180007
102800          DECLARE CART_LABEL_CURSOR CURSOR FOR                    11190007
102900           SELECT SSCC_ID                                         11200007
103000                 ,UNT_QTY                                         11210007
103100             FROM TRT_IMPRT_CART                                  11220007
103200             WHERE CONTNR_ID      = :IMCNTK-CONTNR-ID             11230007
103300               AND CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR        11240007
103400               AND PO_NBR         = :IMCNPO-PO-NBR                11250007
103500               AND UPC_NBR        = :IMCNUP-UPC-NBR               11260007
103600          ORDER BY SSCC_ID                                        11270007
103700     END-EXEC.                                                    11280007
103800                                                                  11290007
103900*                                                                 11300007
104000*                                                                 11310007
104100* CONTAINER SEAL CURSOR                                           11320007
104200*                                                                 11330007
104300*                                                                 11340007
104400     EXEC SQL                                                     11350007
104500          DECLARE SEAL_CURSOR CURSOR FOR                          11360007
104600           SELECT SEAL_NBR                                        11370007
104700             FROM TRT_IMPRT_SEAL                                  11380007
104800             WHERE CONTNR_ID      = :TRT00006-CONTNR-ID           11390007
104900               AND CONTNR_SEQ_NBR = :TRT00006-CONTNR-SEQ-NBR      11400007
105000          ORDER BY SEAL_NBR                                       11410007
105100     END-EXEC.                                                    11420007
105200                                                                  11430007
139868*                                                                 11440035
139868*  CURSOR DECLARATION TO OBTAIN THE STORE DISTRIBUTION QUANTITIES 11450035
139868*  FOR BULK UPC'S ON THE PURCHASE ORDER FOR OUTLET STORES         11460035
139868*                                                                 11470035
139868     EXEC SQL                                                     11480035
139868          DECLARE DC_OUT_CUR CURSOR FOR                           11490035
139868           SELECT                                                 11500035
139868                  ES.STR_NBR                                      11510035
139868                , SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             11520035
139868             FROM                                                 11530035
139868                  TIMCNUP   CNUP                                  11540035
139868                 ,TUPCSKU   SKU                                   11550035
139868                 ,TPURITM   PUR                                   11560035
139868                 ,TMESTDS   ES                                    11570035
155029                 ,TALLPLN   PL                                    11580073
139868             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        11590035
139868               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   11600035
155029               AND ES.PLAN_NBR         = :ALLPLN-PLAN-NBR         11610073
155029               AND PL.PLAN_NBR         =  ES.PLAN_NBR             11620073
139868               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          11630035
139868               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            11640035
139868               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           11650035
139868               AND PUR.PO_NBR          =  CNUP.PO_NBR             11660035
155029               AND ES.PO_NBR           = PL.PO_NBR                11670073
139868               AND PUR.VER_STATUS_CDE  = 'A'                      11680035
139868               AND PUR.STATUS_CDE      IN ('AC', 'AP')            11690035
139868               AND ES.PO_LNE_NBR       =  PUR.PO_LNE_NBR          11700035
139868               AND ES.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         11710035
139868               AND ES.PO_NBR           =  PUR.PO_NBR              11720035
155029               AND ES.PO_LNE_NBR       =  PL.PO_LNE_NBR           11730073
139868               AND ES.STR_DISTRO_QTY   >  0                       11740035
139868            GROUP BY ES.STR_NBR                                   11750035
139868            ORDER BY SUMSPLIT                                     11760035
139868                    ,ES.STR_NBR                                   11770035
139868         WITH UR                                                  11780035
139868     END-EXEC.                                                    11790035
139868*                                                                 11800035
139868*  CURSOR DECLARATION TO OBTAIN THE STORE DISTRIBUTION QUANTITIES 11810035
139868*  AT THE STORE LEVEL FOR OUTLET STORES                           11820035
139868*                                                                 11830035
139868     EXEC SQL                                                     11840035
139868          DECLARE PRPACK_DC_OUT_CUR CURSOR FOR                    11850035
139868           SELECT DISTINCT                                        11860035
139868                  ES.STR_NBR                                      11870035
139868                 ,SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             11880035
139868             FROM                                                 11890035
139868                  TMESTDS   ES                                    11900035
139868                 ,TPURITM   PUR                                   11910035
139868             WHERE PUR.PO_NBR          = :IMCNPO-PO-NBR           11920035
139868               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      11930035
155029               AND ES.PLAN_NBR         = :ALLPLN-PLAN-NBR         11940073
139868               AND PUR.VER_STATUS_CDE  = 'A'                      11950035
139868               AND PUR.STATUS_CDE      IN ('AC', 'AP')            11960035
139868               AND ES.PO_LNE_NBR       =  PUR.PO_LNE_NBR          11970035
139868               AND ES.PO_NBR           =  PUR.PO_NBR              11980035
139868               AND ES.STR_DISTRO_QTY   >  0                       11990035
139868          GROUP BY ES.STR_NBR                                     12000035
139868          ORDER BY SUMSPLIT                                       12010035
139868                  ,ES.STR_NBR                                     12020035
139868         WITH UR                                                  12030035
139868     END-EXEC.                                                    12040035
139868                                                                  12050035
105300******************************************************************12060007
105400 LINKAGE SECTION.                                                 12070007
105500******************************************************************12080007
105600                                                                  12090007
105700******************************************************************12100007
105800 PROCEDURE DIVISION.                                              12110007
105900******************************************************************12120007
106000                                                                  12130007
106100******************************************************************12140007
106200 0000-PROGRAM-MAINLINE.                                           12150007
106300                                                                  12160007
106400     DISPLAY 'EFC2 TRKUP008 STARTED'.                             12170007
106500                                                                  12180007
106600     PERFORM 1000-INITIALIZE.                                     12190007
106700                                                                  12200007
106800     PERFORM 2000-CREATE-EXTRACT-FILES                            12210007
106900         UNTIL PS-EOC-DRIVER-CURSOR                               12220007
107000                                                                  12230007
107100     PERFORM 9000-EOJ-ROUTINE.                                    12240007
107200     STOP RUN.                                                    12250007
107300                                                                  12260007
107400******************************************************************12270007
107500*  FIRST OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO  12280007
107600*  REPORT FILES.                                                  12290007
107700******************************************************************12300007
107800 1000-INITIALIZE.                                                 12310007
107900                                                                  12320007
108000     INITIALIZE PV-DECONSOL-NO-TABLE.                             12330007
108100     OPEN  INPUT INPUT-ENT-FILE.                                  12340007
108200     PERFORM 1020-READ-INPUT-ENT-FILE.                            12350007
108300     SET DECNO-IND TO 1.                                          12360007
108400     PERFORM 1010-BUILD-ENT-TABLE                                 12370007
108500       UNTIL PS-END-OF-INPUT-ENT-FILE                             12380007
108600          OR DECNO-IND > PC-DECONSOL-TBL-LIMIT                    12390007
108700     IF DECNO-IND > PC-DECONSOL-TBL-LIMIT                         12400007
108800       DISPLAY  '***********************************************' 12410007
108900       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 12420007
109000       DISPLAY  '** PROGRAM = TRKUP008                        **' 12430007
109100       DISPLAY  '** PARAGRAPGH  - 1000-INITIALIZE             **' 12440007
109200       DISPLAY  '**                                           **' 12450007
109300       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 12460007
109400       DISPLAY  '**                                           **' 12470007
109500       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 12480007
109600       DISPLAY  '**                                           **' 12490007
109700       DISPLAY  '**             PV-DECONSOL-NO-TABLE          **' 12500007
109800       DISPLAY  '**                                           **' 12510007
109900       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 12520007
110000       DISPLAY  '**                                           **' 12530007
110100       DISPLAY  '**             PC-DECONSOL-TBL-LIMIT         **' 12540007
110200       DISPLAY  '**                                           **' 12550007
110300       DISPLAY  '***********************************************' 12560007
110400     END-IF.                                                      12570007
110500                                                                  12580007
110600     PERFORM 1100-RETREVE-CURRENT-TIMESTAMP.                      12590007
110700                                                                  12600007
110800     INITIALIZE PA-TOTAL-OUTPUT-REC-COUNT.                        12610007
110900     INITIALIZE PV-HOLD-TR020-PO-NBR                              12620007
111000                PV-HOLD-CONTNR-ID                                 12630007
111100                PV-HOLD-TR020-PROCESS-DATE.                       12640007
111200     INITIALIZE TR006-RECORD.                                     12650007
111300                                                                  12660007
111400     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    12670007
111500                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   12680007
111600                                                                  12690007
111700     PERFORM 6500-GET-CHECKPOINT-CNTL.                            12700007
111800     MOVE PV-CKPT-STAT-CODE       TO                              12710007
111900         PS-RUN-TYPE-SW.                                          12720007
112000                                                                  12730007
112100     IF PS-RESTART-RUN                                            12740007
112200         PERFORM 6550-CHECKPOINT-RESTART                          12750007
112300     END-IF.                                                      12760007
112400                                                                  12770007
112500     MOVE SPACES   TO PV-EXTRACT-TABLE.                           12780007
112600     SET EXT-INDEX TO +1.                                         12790007
112700                                                                  12800007
112800     INITIALIZE TR004-REC-TYPE-POE                                12810007
112900                TR004-REC-TYPE-ETA                                12820007
113000                TR004-REC-TYPE-VES                                12830007
113100                TR004-REC-TYPE-CONTAINER                          12840007
113200                TR004-REC-TYPE-PO                                 12850007
113300                TR004-REC-TYPE-INS                                12860007
113400                TR004-REC-TYPE-UPC                                12870007
113500                TR004-REC-TYPE-DC                                 12880007
113600                TR004-REC-TYPE-DC-CARTON                          12890007
113700                TR004-REC-TYPE-PCK                                12900007
113800                TR004-REC-TYPE-PDC                                12910007
113900                TR004-REC-TYPE-PACK-CARTON                        12920007
114000                TR004-REC-TYPE-CONTAINER-SEAL                     12930007
114100                TR020-REC-TYPE-PO                                 12940007
114200                TR020-REC-TYPE-CONTNR                             12950007
114300                TR020-REC-TYPE-INS                                12960007
114400                TR020-REC-TYPE-UPC                                12970007
114500                TR020-REC-TYPE-DC                                 12980007
114600                TR020-REC-TYPE-DC-CARTON                          12990007
114700                TR020-REC-TYPE-PCK                                13000007
114800                TR020-REC-TYPE-PDC                                13010007
114900                TR020-REC-TYPE-PACK-CART                          13020007
115000                TR020-REC-TYPE-CONTAINER-SEAL.                    13030007
115100                                                                  13040007
115200     MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM.            13050007
115300     MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD.            13060007
115400     MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY.          13070007
115500     MOVE TR006-PROCESS-DATE      TO PV-HOLD-TR020-PROCESS-DATE.  13080007
115600                                                                  13090007
115700     PERFORM 7000-OPEN-DRIVER-CURSOR.                             13100007
115800                                                                  13110007
115900     PERFORM 7020-FETCH-VALIDATE-DRIVER-CUR                       13120007
116000          UNTIL PS-CMN-PASSES-XMIT-TEST                           13130007
116100             OR PS-EOC-DRIVER-CURSOR.                             13140007
116200                                                                  13150007
116300     IF PS-EOC-DRIVER-CURSOR                                      13160007
116400         CONTINUE                                                 13170007
116500     ELSE                                                         13180007
116600         PERFORM 4600-SET-CHECKPOINT-TIME                         13190007
116700     END-IF.                                                      13200007
116800                                                                  13210007
116900****************************************************************  13220007
117000* 1010-BUILD-ENT-TABLE - BUILD ENTITY TABLE FROM INPUT-ENT-FILE*  13230007
117100****************************************************************  13240007
117200 1010-BUILD-ENT-TABLE.                                            13250007
117300                                                                  13260007
117400     IF TR030-ENT-ID NUMERIC                                      13270007
117500         MOVE TR030-ENT-ID                                        13280007
117600         TO   PV-TBL-DECON-ENT-ID (DECNO-IND)                     13290007
117700     ELSE                                                         13300007
117800         DISPLAY '** INVALID ENTITY ID '                          13310007
117900         TR030-DCONSLR-ENT-TBL-REC                                13320007
118000     END-IF.                                                      13330007
118100                                                                  13340007
118200     MOVE TR030-ENT-DCONSLR-NAME                                  13350007
118300                       TO PV-TBL-DECON-ENT-NAME(DECNO-IND).       13360007
118400                                                                  13370007
118500     PERFORM 1020-READ-INPUT-ENT-FILE                             13380007
118600     SET DECNO-IND UP BY 1.                                       13390007
118700                                                                  13400007
118800                                                                  13410007
118900****************************************************************  13420007
119000* READ IN CONTROL FILE                                         *  13430007
119100****************************************************************  13440007
119200                                                                  13450007
119300 1020-READ-INPUT-ENT-FILE.                                        13460007
119400     READ INPUT-ENT-FILE INTO TR030-DCONSLR-ENT-TBL-REC           13470007
119500       AT END                                                     13480007
119600        SET PS-END-OF-INPUT-ENT-FILE TO TRUE.                     13490007
119700                                                                  13500007
139868******************************************************************13510035
139868** SELECT PARM - CHECK IF THIS IS AN OUTLET STORE               **13520035
139868******************************************************************13530035
139868 1050-SELECT-OUTLET-PARM.                                         13540035
139868                                                                  13550035
139868     MOVE 'TRCNSP'             TO KRPRPM-SYS-PRC-FUNC-CDE.        13560035
139868     MOVE 'KHL'                TO KRPRPM-INTFC-SYS-CDE.           13570035
139868     MOVE 'AC'                 TO KRPRPM-FUNC-PRC-STAT-CDE.       13580035
139868     MOVE 'Y'                  TO KRPRPM-FUNC-TXT.                13590035
139868                                                                  13600035
139868        EXEC SQL                                                  13610035
139868            SELECT LOC_ID                                         13620035
139868              INTO :KRPRPM-LOC-ID                                 13630035
139868              FROM  TKRPRPM                                       13640035
139868             WHERE  LOC_ID            = :KRPRPM-LOC-ID            13650035
139868               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  13660035
139868               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     13670035
139868               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 13680035
139868               AND  FUNC_TXT          = :KRPRPM-FUNC-TXT          13690035
139868             WITH UR                                              13700035
139868        END-EXEC.                                                 13710035
139868                                                                  13720035
139868        EVALUATE TRUE                                             13730035
139868            WHEN SQLCODE = +0                                     13740035
139868                SET PS-OUTLET-STORE     TO TRUE                   13750035
139868                                                                  13760035
139868            WHEN SQLCODE = +100                                   13770035
139868                SET PS-OUTLET-STORE-NO  TO TRUE                   13780035
139868                                                                  13790035
139868            WHEN SQLWARN0 NOT = SPACES                            13800035
139868            WHEN SQLCODE < +0                                     13810035
139868            WHEN SQLCODE > +0                                     13820035
139868             DISPLAY '** ABEND **'                                13830035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   13840035
139868             DISPLAY '** PARAGRAPH = 1050-SELECT-OUTLET-PARM **'  13850035
139868             DISPLAY '** KRPRPM-LOC-ID            = '             13860035
139868                                          KRPRPM-LOC-ID           13870035
139868             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE  = '             13880035
139868                                          KRPRPM-SYS-PRC-FUNC-CDE 13890035
139868             DISPLAY '** KRPRPM-INTFC-SYS-CDE     = '             13900035
139868                                          KRPRPM-INTFC-SYS-CDE    13910035
139868             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             13920035
139868                                          KRPRPM-FUNC-PRC-STAT-CDE13930035
139868             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           13940035
139868             PERFORM 9100-SQL-ABEND                               13950035
139868        END-EVALUATE.                                             13960035
139868                                                                  13970035
119800******************************************************************13980007
119900 1100-RETREVE-CURRENT-TIMESTAMP.                                  13990007
120000                                                                  14000007
120100     EXEC SQL                                                     14010007
120200         SET  :PV-CURRENT-TIME =                                  14020007
120300                 CURRENT TIMESTAMP                                14030007
120400     END-EXEC.                                                    14040007
120500                                                                  14050007
120600     EVALUATE TRUE                                                14060007
120700         WHEN SQLWARN0 NOT EQUAL SPACE                            14070007
120800         WHEN SQLCODE NOT EQUAL ZERO                              14080007
120900             DISPLAY '** ABEND **'                                14090007
121000             DISPLAY '** PROGRAM = TRKUP008 **'                   14100007
121100             DISPLAY '** PARAGRAPH = 1100-RETREVE-CURRENT-TIME**' 14110007
121200             DISPLAY '** UNSUCCESSFUL SELECT OF TIME**'           14120007
121300             PERFORM 9100-SQL-ABEND                               14130007
121400     END-EVALUATE.                                                14140007
121500                                                                  14150007
121600 EJECT                                                            14160007
121700******************************************************************14170007
121800* PROCESS:  THIS PARAGRAPH WILL SET UP AND WRITE EXTRACT RECORDS  14180007
121900******************************************************************14190007
122000 2000-CREATE-EXTRACT-FILES.                                       14200007
122100                                                                  14210007
122200     IF IMCNTK-CONTNR-ID = PV-HOLD-CONTNR-ID                      14220007
122300       CONTINUE                                                   14230007
122400     ELSE                                                         14240007
122500        IF PS-NEED-SEALS                                          14250007
122600           PERFORM 8752-OPEN-SEAL-CURSOR                          14260007
122700           SET PS-EOC-SEAL-CURSOR-NO TO TRUE                      14270007
122800           PERFORM 2900-SEAL-CURSOR-FOR-XMIT                      14280007
122900             UNTIL PS-EOC-SEAL-CURSOR                             14290007
123000           PERFORM 8754-CLOSE-SEAL-CURSOR                         14300007
123100           SET PS-NEED-SEALS-NO TO TRUE                           14310007
123200        END-IF                                                    14320007
123300     END-IF.                                                      14330007
123400                                                                  14340007
123500                                                                  14350007
123600     IF  IMCNTK-MOM-DEST-POE-CDE = PV-HOLD-MOM-DEST-POE           14360007
123700        CONTINUE                                                  14370007
123800     ELSE                                                         14380007
123900        MOVE IMCNTK-MOM-DEST-POE-CDE                              14390007
124000                              TO PV-HOLD-MOM-DEST-POE             14400007
124100        PERFORM 7100-GET-POE-CITY                                 14410007
124200        IF PS-POE-CITY-FOUND                                      14420007
124300          MOVE IMPOE-POE-CTY-NM TO TR004-PORT-OF-ENTRY-CTY        14430007
124400        ELSE                                                      14440007
124500          MOVE 'POE CITY NOT FOUND'                               14450007
124600                                TO TR004-PORT-OF-ENTRY-CTY        14460007
124700        END-IF                                                    14470007
124800*       ********************************************************  14480007
124900*       * EVEN THOUGH THE MOM-DEST-POE-CODES ARE DIFFERENT THE *  14490007
125000*       * PROCESS CAN TURN UP THE SAME POE CITY NAME.          *  14500007
125100*       ********************************************************  14510007
125200        IF TR004-PORT-OF-ENTRY-CTY = PV-HOLD-PORT-OF-ENTRY-CTY    14520007
125300          CONTINUE                                                14530007
125400        ELSE                                                      14540007
125500          SET TR004-PROCESS-POE-RETRANS-CMN TO TRUE               14550007
125600          SET PS-POE-WRITTEN-NO TO TRUE                           14560007
125700          SET PS-ETA-WRITTEN-NO TO TRUE                           14570007
125800          SET PS-VES-WRITTEN-NO TO TRUE                           14580007
125900          SET PS-CMN-WRITTEN-NO TO TRUE                           14590007
126000          MOVE TR004-PORT-OF-ENTRY-CTY                            14600007
126100                                  TO PV-HOLD-PORT-OF-ENTRY-CTY    14610007
126200        END-IF                                                    14620007
126300     END-IF.                                                      14630007
126400                                                                  14640007
126500     IF IMCNTK-MOM-POE-DELY-TMST (1:10)                           14650007
126600                              = PV-HOLD-MOM-POE-DELY-TMST         14660007
126700         CONTINUE                                                 14670007
126800     ELSE                                                         14680007
126900         INITIALIZE TR004-REC-TYPE-ETA                            14690007
127000         SET TR004-PROCESS-ETA-RETRANS-CMN TO TRUE                14700007
127100                                                                  14710007
127200         MOVE IMCNTK-MOM-POE-DELY-TMST (1:4) TO                   14720007
127300             TR004-VESSEL-ETA-DATE (1:4)                          14730007
127400         MOVE IMCNTK-MOM-POE-DELY-TMST (6:2) TO                   14740007
127500             TR004-VESSEL-ETA-DATE (5:2)                          14750007
127600         MOVE IMCNTK-MOM-POE-DELY-TMST (9:2) TO                   14760007
127700             TR004-VESSEL-ETA-DATE (7:2)                          14770007
127800         MOVE TR004-VESSEL-ETA-DATE     TO                        14780007
127900             TR020-VESSEL-ETA-DATE-CONTNR                         14790007
128000         SET PS-ETA-WRITTEN-NO TO TRUE                            14800007
128100         SET PS-VES-WRITTEN-NO TO TRUE                            14810007
128200         SET PS-CMN-WRITTEN-NO TO TRUE                            14820007
128300         MOVE IMCNTK-MOM-POE-DELY-TMST (1:10) TO                  14830007
128400             PV-HOLD-MOM-POE-DELY-TMST                            14840007
128500     END-IF.                                                      14850007
128600                                                                  14860007
128700     IF IMCNTK-MOM-IMPRT-VEH-NM  =  PV-HOLD-MOM-IMPRT-VEH-NM      14870007
128800         CONTINUE                                                 14880007
128900     ELSE                                                         14890007
129000         INITIALIZE TR004-REC-TYPE-VES                            14900007
129100         SET TR004-PROCESS-VES-RETRANS-CMN TO TRUE                14910007
129200         MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR004-VESSEL-NAME        14920007
129300                                  TR020-VESSEL-NAME-CONTNR        14930007
129400         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO TR004-TRIP-TYP-CDE       14940007
129500                                  TR020-TRIP-TYP-CDE-CONTNR       14950007
129600         MOVE IMCNTK-MOM-IMPRT-VEH-NM TO PV-HOLD-MOM-IMPRT-VEH-NM 14960007
129700         MOVE IMCNTK-MOM-IMPRT-TRIP-ID                            14970007
129800                                 TO TR004-VOYAGE-ID-NBR           14980007
129900                                    TR020-VOYAGE-ID-NBR-CONTNR    14990007
130000         MOVE IMCNTK-MOM-CARR-SCAC-ID                             15000007
130100                                 TO TR004-CARR-SCAC-ID            15010007
130200                                    TR020-CARR-SCAC-ID-CONTNR     15020007
130300         SET PS-VES-WRITTEN-NO TO TRUE                            15030007
130400         SET PS-CMN-WRITTEN-NO TO TRUE                            15040007
130500     END-IF.                                                      15050007
130600                                                                  15060007
130700     IF IMCNTK-CONTNR-ID = PV-HOLD-CONTNR-ID                      15070007
130800       CONTINUE                                                   15080007
130900     ELSE                                                         15090007
131000       INITIALIZE TR004-REC-TYPE-CONTAINER                        15100007
131100       MOVE IMCNTK-CONTNR-ID    TO TR004-CONTNR-ID                15110007
131200                                   PV-HOLD-CONTNR-ID              15120007
131300       MOVE IMCNTK-SIZE-CDE      TO TR004-CONTNR-SIZE-CDE         15130007
131400                               TR020-CONTNR-SIZE-CDE-CONTNR       15140007
131500       SET PS-CMN-WRITTEN-NO TO TRUE                              15150007
131600       MOVE PV-HOLD-MOM-DEST-POE                                  15160007
131700                                TO TR020-POE-CDE-CONTNR           15170007
131800                                   TR004-POE-CDE                  15180007
131900     END-IF.                                                      15190007
132000                                                                  15200007
132100     PERFORM 2200-PROCESS-PO.                                     15210007
132200                                                                  15220007
132300     IF PS-CMN-WRITTEN                                            15230007
132400        PERFORM 8752-OPEN-SEAL-CURSOR                             15240007
132500        SET PS-EOC-SEAL-CURSOR-NO TO TRUE                         15250007
132600        PERFORM 2910-SEAL-CURSOR-FOR-REPORT                       15260007
132700          UNTIL PS-EOC-SEAL-CURSOR                                15270007
132800        PERFORM 8754-CLOSE-SEAL-CURSOR                            15280007
132900     END-IF.                                                      15290007
133000                                                                  15300007
133100     PERFORM 4400-CHECKPOINT-CHECK.                               15310007
133200                                                                  15320007
133300     INITIALIZE TR006-RECORD.                                     15330007
133400     SET PS-CMN-PASSES-XMIT-TEST-NO TO TRUE.                      15340007
133500     PERFORM 7020-FETCH-VALIDATE-DRIVER-CUR                       15350007
133600          UNTIL PS-CMN-PASSES-XMIT-TEST                           15360007
133700             OR PS-EOC-DRIVER-CURSOR.                             15370007
133800                                                                  15380007
133900******************************************************************15390007
134000* PROCESS ALL PURCHASE ORDERS FOR THIS CONTAINER.                *15400007
134100******************************************************************15410007
134200 2200-PROCESS-PO.                                                 15420007
134300                                                                  15430007
134400     SET PS-PO-PASSES-XMIT-TEST   TO TRUE.                        15440007
134500     PERFORM 7800-VALIDATE-PO.                                    15450007
134600                                                                  15460007
134700     IF PS-PO-PASSES-XMIT-TEST                                    15470007
134800         INITIALIZE TR004-REC-TYPE-PO                             15480007
134900                    PV-HOLD-PO-NBR                                15490007
135000         MOVE IMCNTK-CONTNR-ID  TO TR004-CONTNR-ID                15500007
135100         MOVE IMCNPO-PO-NBR     TO TR020-PO-NBR-CONTNR            15510007
135200                                   TR004-PO-NBR                   15520007
135300                                   PV-HOLD-TR020-PO-NBR           15530007
135400         PERFORM 2260-SELECT-PLNSHP-DATES                         15540007
135500         SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE                  15550007
135600         PERFORM 2250-SELECT-TPURCHS-INFO                         15560007
155029         PERFORM 6600-FAST-PARM-CHECK                             15570073
135700                                                                  15580007
135800         IF PS-PO-SEL-INFO-PRESENT                                15590007
135900           IF PURCHS-STATUS-CDE = 'AC' OR 'AP' OR 'CA' OR 'CM'    15600007
136000             CONTINUE                                             15610007
136100           ELSE                                                   15620007
136200             SET PS-PO-SEL-INFO-PRESENT-NO    TO TRUE             15630007
136300             SET TR006-ERROR-TYPE-ERROR       TO TRUE             15640007
136400             INITIALIZE TR006-ERROR-MSG                           15650007
136500             STRING 'CMN-PO INVALID STATUS-NOT SNT-',             15660007
136600                 PURCHS-STATUS-CDE                                15670007
136700                 DELIMITED BY SIZE                                15680007
136800                 INTO TR006-ERROR-MSG                             15690007
136900             PERFORM 8830-WRITE-ERROR-LINE                        15700007
137000           END-IF                                                 15710007
137100         END-IF                                                   15720007
137200                                                                  15730007
137300         IF PS-PO-SEL-INFO-PRESENT                                15740007
137400           IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-B             15750007
137500                              OR PC-C OR PC-S OR SPACES           15760007
137600             CONTINUE                                             15770007
137700           ELSE                                                   15780007
137800               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            15790007
137900               SET TR006-ERROR-TYPE-ERROR      TO TRUE            15800007
138000               INITIALIZE TR006-UPC-NBR                           15810007
138100                          TR006-ERROR-MSG                         15820007
138200               STRING  'CMN-PO-INVALID PKG CD-NOT SENT-',         15830007
138300                       PURCHS-PKGNG-CDE                           15840007
138400                   DELIMITED BY SIZE                              15850007
138500                   INTO TR006-ERROR-MSG                           15860007
138600               PERFORM 8830-WRITE-ERROR-LINE                      15870007
138700         END-IF                                                   15880007
138800                                                                  15890007
138900         IF PS-PO-SEL-INFO-PRESENT                                15900007
139000           SET PS-IMCNRL-INFO-PRESENT-NO  TO TRUE                 15910007
139100           PERFORM 4020-SELECT-IMCNRL-FOR-AUDIT                   15920007
139200           IF PS-IMCNRL-INFO-PRESENT                              15930007
139300                                                                  15940007
139400             SET PS-RETRAN-MATCH-TRAN-ENTID-NO  TO TRUE           15950007
139500             PERFORM 8900-CHK-TRAN-SAME-AS-RETAN                  15960007
139600             IF PS-RETRAN-MATCH-TRAN-ENTID                        15970007
139700               CONTINUE                                           15980007
139800             ELSE                                                 15990007
139900                                                                  16000007
140000               SET TR006-ERROR-TYPE-ERROR       TO TRUE           16010007
140100               INITIALIZE TR006-ERROR-MSG                         16020007
140200               STRING 'CMN-RETRAN DCNSL NOT= TRAN DCNSL'          16030007
140300                 DELIMITED BY SIZE                                16040007
140400                 INTO TR006-ERROR-MSG                             16050007
140500               PERFORM 8830-WRITE-ERROR-LINE                      16060007
140600               SET TR006-ERROR-TYPE-ERROR       TO TRUE           16070007
140700               INITIALIZE TR006-ERROR-MSG                         16080007
140800               STRING 'CMN-NOT SENT BUT SET TO TRANSMIT'          16090007
140900                 DELIMITED BY SIZE                                16100007
141000                 INTO TR006-ERROR-MSG                             16110007
141100               PERFORM 8830-WRITE-ERROR-LINE                      16120007
141200                                                                  16130007
141300               PERFORM 4000-SELECT-IMCNPO-FOR-AUDIT               16140007
141400               MOVE SPACE TO IMCNPO-SPLT-XMIT-CDE                 16150007
141500               PERFORM 2270-UPDATE-TIMCNPO                        16160071
141600               MOVE PC-D TO IMCNRL-DCONSLR-RLSE-CDE               16170007
141700               MOVE PC-DEFAULT-DTE-9  TO IMCNRL-DCONSLR-ACTL-DTE  16180007
141800               MOVE PC-DEFAULT-TME-9  TO IMCNRL-DCONSLR-ACTL-TM   16190007
141900               PERFORM 2280-UPDATE-TIMCNRL                        16200071
142000                                                                  16210007
142100             END-IF                                               16220007
142200                                                                  16230007
142300                                                                  16240007
142400             IF PS-RETRAN-MATCH-TRAN-ENTID                        16250007
142500               SET PS-PROBLEM-DO-NOT-SEND-NO TO TRUE              16260007
142600*              **********************************                 16270007
142700               PERFORM 2210-CREATE-PO                             16280007
142800*              **********************************                 16290007
142900               IF PS-PROBLEM-DO-NOT-SEND                          16300007
143000                   CONTINUE                                       16310007
143100               ELSE                                               16320007
143200                   PERFORM 4000-SELECT-IMCNPO-FOR-AUDIT           16330007
143300                   MOVE PC-Y TO IMCNPO-SPLT-XMIT-CDE              16340007
143400                   PERFORM 2270-UPDATE-TIMCNPO                    16350071
143500                   MOVE PC-R TO IMCNRL-DCONSLR-RLSE-CDE           16360007
143600                   PERFORM 4800-SET-CURRENT-DATE-TIME             16370007
143700                   PERFORM 2280-UPDATE-TIMCNRL                    16380071
143800                   PERFORM 3000-WRITE-OUT-GOOD-PO-RECS            16390007
143900               END-IF                                             16400007
144000               MOVE SPACES   TO PV-EXTRACT-TABLE                  16410007
144100               SET EXT-INDEX TO +1                                16420007
144200             END-IF                                               16430007
144300                                                                  16440007
144400           END-IF                                                 16450007
144500                                                                  16460007
144600         END-IF                                                   16470007
144700                                                                  16480007
144800     END-IF.                                                      16490007
144900*                                                                 16500007
145000*                                                                 16510007
145100******************************************************************16520007
145200* CREATE PURCHASE ORDER RECORDS FOR EXTRACT (TOUTTR2).           *16530007
145300******************************************************************16540007
145400 2210-CREATE-PO.                                                  16550007
145500                                                                  16560007
145600     MOVE IMCNPO-PO-UNT-QTY       TO TR004-PO-UNIT-QTY            16570007
145700                                     TR020-UNIT-QTY-CONTNR.       16580007
145800     MOVE PURCHS-PO-TYP-CDE       TO TR004-PO-TYP-CDE             16590007
145900                                     TR020-PO-TYP-CDE-PO.         16600007
146000     MOVE IMCNPO-EXTL-REF-NBR     TO TR004-EXTL-REF-NBR           16610007
146100                                     TR020-EXTL-REF-CONTNR.       16620007
146200     PERFORM 2220-SELECT-SUM-UPC-CART.                            16630007
146300     MOVE PV-SUM-INCNUP-CART-CNT   TO TR004-CART-PER-PO           16640007
146400                                      TR020-EXP-CART-CT-CONTNR.   16650007
146500     PERFORM 2215-SELECT-ENTITY-NAME-DESCR.                       16660007
146600                                                                  16670007
146700     PERFORM 2217-SELECT-AD-DATE.                                 16680007
146800                                                                  16690007
146900     MOVE PURCHS-OTB-PER-NBR      TO TR004-OPEN-TO-BUY-PERIOD.    16700007
147000                                                                  16710007
147100     MOVE PURCHS-PKGNG-CDE        TO TR004-PKGNG-CDE              16720007
147200                                     TR006-PKGNG-CDE.             16730007
147300                                                                  16740007
147400                                                                  16750007
147500     PERFORM 5400-WRITE-PUR-ORDER-PO-RECORD.                      16760007
147600                                                                  16770007
147700     PERFORM 2300-PROCESS-INSTRUCTION-LINES.                      16780007
147800                                                                  16790007
147900     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           16800007
148000         PERFORM 8735-OPEN-PACK-CURSOR                            16810007
148100         SET  PS-PREPACKS-FOR-PO-NO       TO TRUE                 16820007
148200         PERFORM 2350-PROCESS-PACKS-IDS                           16830007
148300                UNTIL PS-EOC-PACK-CURSOR                          16840007
148400         SET PS-EOC-PACK-CURSOR-NO TO TRUE                        16850007
148500     ELSE                                                         16860007
148600         PERFORM 8200-OPEN-BULK-UPC-CUR                           16870007
148700         SET PS-UPCS-ON-TIMCNUP-NO        TO TRUE                 16880007
148800         PERFORM 2400-PROCESS-UPC-FOR-BULK UNTIL                  16890007
148900                 PS-EOC-BULK-UPC-CUR                              16900007
149000         SET PS-EOC-BULK-UPC-CUR-NO       TO TRUE                 16910007
149100     END-IF.                                                      16920007
149200                                                                  16930007
149300******************************************************************16940007
149400 2215-SELECT-ENTITY-NAME-DESCR.                                   16950007
149500*                                                                 16960007
149600     EXEC SQL                                                     16970007
149700           SELECT DISTINCT                                        16980007
149800                  EN.ENT_NAME_DESC                                16990007
149900             INTO                                                 17000007
150000                  :ENTNME-ENT-NAME-DESC                           17010007
150100             FROM                                                 17020007
150200                  TPURCHS   PO                                    17030007
150300                , TENTNME   EN                                    17040007
150400             WHERE PO.PO_NBR     =  :IMCNPO-PO-NBR                17050007
150500               AND PO.ENT_ID     =  EN.ENT_ID                     17060007
150600               AND PO.VER_STATUS_CDE = 'A'                        17070007
150700               AND EN.TYPE_CDE = '01'                             17080007
150800     END-EXEC                                                     17090007
150900                                                                  17100007
151000     EVALUATE TRUE                                                17110007
151100         WHEN SQLCODE = ZERO                                      17120007
151200             MOVE ENTNME-ENT-NAME-DESC  TO                        17130007
151300                 TR004-VENDOR-NAME                                17140007
151400                                                                  17150007
151500         WHEN SQLCODE = +100                                      17160007
151600             CONTINUE                                             17170007
151700         WHEN SQLWARN0 NOT EQUAL SPACE                            17180007
151800         WHEN SQLCODE NOT EQUAL ZERO                              17190007
151900             DISPLAY '** ABEND **'                                17200007
152000             DISPLAY '** PROGRAM = TRKUP008 **'                   17210007
152100             DISPLAY '** PARAGRAPH = 2215-PROCESS-PO**'           17220007
152200             PERFORM 9100-SQL-ABEND                               17230007
152300     END-EVALUATE.                                                17240007
152400******************************************************************17250007
152500*  GET THE EARLIEST ADVERTISING DATE                              17260007
152600******************************************************************17270007
152700 2217-SELECT-AD-DATE.                                             17280007
152800*                                                                 17290007
152900     EXEC SQL                                                     17300007
153000         SELECT  MIN(AD_EVNT_DTE)                                 17310007
153100           INTO  :PURITM-AD-EVNT-DTE                              17320007
153200           FROM  TPURITM                                          17330007
153300          WHERE  PO_NBR         = :IMCNPO-PO-NBR                  17340007
153400            AND  AD_EVNT_DTE   <> '0001-01-01'                    17350007
153500            AND  VER_STATUS_CDE = 'A'                             17360007
153600            AND  STATUS_CDE    IN ('AC', 'AP')                    17370007
153700     END-EXEC                                                     17380007
153800                                                                  17390007
153900     EVALUATE TRUE                                                17400007
154000         WHEN SQLCODE = +0                                        17410007
154100              MOVE PURITM-AD-EVNT-DTE (1:4)                       17420007
154200                                   TO TR004-AD-DATE (1:4)         17430007
154300              MOVE PURITM-AD-EVNT-DTE (6:2)                       17440007
154400                                   TO TR004-AD-DATE (5:2)         17450007
154500              MOVE PURITM-AD-EVNT-DTE (9:2)                       17460007
154600                                   TO TR004-AD-DATE (7:2)         17470007
154700                                                                  17480007
154800         WHEN SQLCODE =  100                                      17490007
154900         WHEN SQLCODE = -305                                      17500007
155000              MOVE SPACES     TO TR004-AD-DATE                    17510007
155100                                                                  17520007
155200         WHEN SQLWARN0 NOT = SPACE                                17530007
155300         WHEN SQLCODE  NOT = +0                                   17540007
155400             DISPLAY '** ABEND **'                                17550007
155500             DISPLAY '** PROGRAM = TRKUP008 **'                   17560007
155600             DISPLAY '** PARAGRAPH = 2217-SELECT-AD-DATE'         17570007
155700             PERFORM 9100-SQL-ABEND                               17580007
155800     END-EVALUATE.                                                17590007
155900                                                                  17600007
156000******************************************************************17610007
156100* THIS USED ONLY TO GET TR004-CART-PER-PO                        *17620007
156200******************************************************************17630007
156300 2220-SELECT-SUM-UPC-CART.                                        17640007
156400                                                                  17650007
156500     MOVE ZERO            TO PV-SUM-INCNUP-CART-CNT.              17660007
156600     EXEC SQL                                                     17670007
156700           SELECT                                                 17680007
156800                 SUM (A.UPC_CART_CNT)                             17690007
156900             INTO                                                 17700007
157000                :PV-SUM-INCNUP-CART-CNT                           17710007
157100             FROM                                                 17720007
157200                  TIMCNUP  A                                      17730007
157300             WHERE A.PO_NBR         = :IMCNPO-PO-NBR              17740007
157400               AND A.CONTNR_ID      = :IMCNTK-CONTNR-ID           17750007
157500               AND A.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR      17760007
157600     END-EXEC.                                                    17770007
157700                                                                  17780007
157800     EVALUATE TRUE                                                17790007
157900         WHEN SQLCODE = ZERO                                      17800007
158000             CONTINUE                                             17810007
158100         WHEN SQLCODE = +100                                      17820007
158200         WHEN SQLCODE = -305                                      17830007
158300             MOVE ZEROES     TO PV-SUM-INCNUP-CART-CNT            17840007
158400                                                                  17850007
158500         WHEN SQLWARN0 NOT EQUAL SPACE                            17860007
158600         WHEN SQLCODE NOT EQUAL ZERO                              17870007
158700             DISPLAY '** ABEND **'                                17880007
158800             DISPLAY '** PROGRAM = TRKUP008 **'                   17890007
158900             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          17900007
159000             DISPLAY '** PARA = 2220-SELECT-SUM-UPC-CART **'      17910007
159100             PERFORM 9100-SQL-ABEND                               17920007
159200     END-EVALUATE.                                                17930007
159300                                                                  17940007
159400 EJECT                                                            17950007
159500******************************************************************17960007
159600 2250-SELECT-TPURCHS-INFO.                                        17970007
159700*                                                                 17980007
159800     EXEC SQL                                                     17990007
159900           SELECT DISTINCT                                        18000007
160000                  PO.STATUS_CDE                                   18010007
160100                , PO.PO_NBR                                       18020007
160200                , PO.OTB_PER_NBR                                  18030007
160300                , PO.NEW_STR_PO_IND                               18040007
160400                , PO.PKGNG_CDE                                    18050007
160500                , PO.DEPT_NBR                                     18060007
160600                , PO_TYP_CDE                                      18070007
160700             INTO                                                 18080007
160800                  :PURCHS-STATUS-CDE                              18090007
160900                , :PURCHS-PO-NBR                                  18100007
161000                , :PURCHS-OTB-PER-NBR                             18110007
161100                , :PURCHS-NEW-STR-PO-IND                          18120007
161200                , :PURCHS-PKGNG-CDE                               18130007
161300                , :PURCHS-DEPT-NBR                                18140007
161400                , :PURCHS-PO-TYP-CDE                              18150007
161500             FROM                                                 18160007
161600                  TPURCHS   PO                                    18170007
161700             WHERE PO.PO_NBR     =  :IMCNPO-PO-NBR                18180007
161800               AND PO.VER_STATUS_CDE = 'A'                        18190007
161900     END-EXEC                                                     18200007
162000                                                                  18210007
162100     EVALUATE TRUE                                                18220007
162200         WHEN SQLCODE = ZERO                                      18230007
162300             INITIALIZE TR006-DEPT-NBR                            18240007
162400                        PV-TR006-DEPT-NBR                         18250007
162500             MOVE PURCHS-DEPT-NBR   TO PV-TR006-DEPT-NBR-3        18260007
162600             MOVE PV-TR006-DEPT-NBR TO TR006-DEPT-NBR             18270007
162700             SET PS-PO-SEL-INFO-PRESENT TO TRUE                   18280007
162800                                                                  18290007
162900         WHEN SQLCODE = +100                                      18300007
163000             INITIALIZE TR006-DEPT-NBR                            18310007
163100                        TR006-ERROR-MSG                           18320007
163200             SET TR006-ERROR-TYPE-ERROR       TO TRUE             18330007
163300             STRING 'CMN-PO MISSING-NOT SENT'                     18340007
163400                 DELIMITED BY SIZE                                18350007
163500                 INTO TR006-ERROR-MSG                             18360007
163600             PERFORM 8830-WRITE-ERROR-LINE                        18370007
163700                                                                  18380007
163800         WHEN SQLWARN0 NOT EQUAL SPACE                            18390007
163900         WHEN SQLCODE NOT EQUAL ZERO                              18400007
164000             DISPLAY '** ABEND **'                                18410007
164100             DISPLAY '** PROGRAM = TRKUP008 **'                   18420007
164200             DISPLAY '** PARAGRAPH = 2250-SELECT-TPURCHS-INFO***' 18430007
164300             DISPLAY 'IMCNPO-PO-NBR = ' IMCNPO-PO-NBR             18440007
164400             PERFORM 9100-SQL-ABEND                               18450007
164500     END-EVALUATE.                                                18460007
164600                                                                  18470007
164700******************************************************************18480007
164800 2260-SELECT-PLNSHP-DATES.                                        18490007
164900*                                                                 18500007
165000     EXEC SQL                                                     18510007
165100           SELECT DISTINCT                                        18520007
165200                  PL.DONT_SHIP_BEF_DTE                            18530007
165300                , PL.CAN_IFNOT_SHIP_DTE                           18540007
165400                , PL.EXT_CAN_DTE                                  18550007
165500             INTO                                                 18560007
165600                  :PLNSHP-DONT-SHIP-BEF-DTE                       18570007
165700                , :PLNSHP-CAN-IFNOT-SHIP-DTE                      18580007
165800                , :PLNSHP-EXT-CAN-DTE                             18590007
165900             FROM                                                 18600007
166000                  TPLNSHP   PL                                    18610007
166100             WHERE PL.PO_NBR     =  :IMCNPO-PO-NBR                18620007
166200               AND PL.VER_STATUS_CDE = 'A'                        18630007
166300     END-EXEC                                                     18640007
166400                                                                  18650007
166500     EVALUATE TRUE                                                18660007
166600         WHEN SQLCODE = ZERO                                      18670007
166700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO               18680007
166800                 TR004-DO-NOT-SHIP-BEF-DTE (1:4)                  18690007
166900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               18700007
167000                 TR004-DO-NOT-SHIP-BEF-DTE (5:2)                  18710007
167100             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               18720007
167200                 TR004-DO-NOT-SHIP-BEF-DTE (7:2)                  18730007
167300                                                                  18740007
167400             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               18750007
167500             MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2) TO               18760007
167600                 TR006-DONT-SHIP-BEFORE-DATE (5:2)                18770007
167700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               18780007
167800                 TR006-DONT-SHIP-BEFORE-DATE (1:2)                18790007
167900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               18800007
168000                 TR006-DONT-SHIP-BEFORE-DATE (3:2)                18810007
168100                                                                  18820007
168200             IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                 18830007
168300                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(1:4) TO           18840007
168400                     TR004-CANCEL-DATE (1:4)                      18850007
168500                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(6:2) TO           18860007
168600                     TR004-CANCEL-DATE (5:2)                      18870007
168700                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(9:2) TO           18880007
168800                     TR004-CANCEL-DATE (7:2)                      18890007
168900              ELSE                                                18900007
169000                 MOVE PLNSHP-EXT-CAN-DTE(1:4) TO                  18910007
169100                     TR004-CANCEL-DATE (1:4)                      18920007
169200                 MOVE PLNSHP-EXT-CAN-DTE(6:2) TO                  18930007
169300                     TR004-CANCEL-DATE (5:2)                      18940007
169400                 MOVE PLNSHP-EXT-CAN-DTE(9:2) TO                  18950007
169500                     TR004-CANCEL-DATE (7:2)                      18960007
169600              END-IF                                              18970007
169700                                                                  18980007
169800         WHEN SQLCODE = +100                                      18990007
169900             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               19000007
170000                        TR004-CANCEL-DATE                         19010007
170100                        TR004-DO-NOT-SHIP-BEF-DTE                 19020007
170200                                                                  19030007
170300                                                                  19040007
170400         WHEN SQLWARN0 NOT EQUAL SPACE                            19050007
170500         WHEN SQLCODE NOT EQUAL ZERO                              19060007
170600             DISPLAY '** ABEND **'                                19070007
170700             DISPLAY '** PROGRAM = TRKUP008 **'                   19080007
170800             DISPLAY '** PARAGRAPH = 2260-SELECT-PLNSHP-DATES**'  19090007
170900             PERFORM 9100-SQL-ABEND                               19100007
171000     END-EVALUATE.                                                19110007
171100                                                                  19120007
171200******************************************************************19130007
171300 2270-UPDATE-TIMCNPO.                                             19140007
171400                                                                  19150007
171500         EXEC SQL                                                 19160007
171600             UPDATE TIMCNPO                                       19170007
171700                SET SPLT_XMIT_CDE    = :IMCNPO-SPLT-XMIT-CDE      19180007
171800                 ,  LAST_UPD_TMST    = (CURRENT TIMESTAMP)        19190007
171900                 ,  LAST_UPD_BY_USR_ID                            19200007
172000                                     = :PC-CURRENT-PROGRAM-NAME   19210007
172100              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          19220007
172200                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     19230007
172300                AND PO_NBR           = :IMCNPO-PO-NBR             19240007
172400         END-EXEC                                                 19250007
172500                                                                  19260007
172600     EVALUATE TRUE                                                19270007
172700         WHEN SQLCODE = ZERO                                      19280007
172800             PERFORM 4010-CREATE-IMCNPO-AUDIT-TRAIL               19290007
172900                                                                  19300007
173000         WHEN SQLCODE = +100                                      19310007
173100             CONTINUE                                             19320007
173200                                                                  19330007
173300         WHEN SQLWARN0 NOT EQUAL SPACE                            19340007
173400         WHEN SQLCODE NOT EQUAL ZERO                              19350007
173500             DISPLAY '** ABEND **'                                19360007
173600             DISPLAY '** PROGRAM = TRKUP008 **'                   19370007
173700             DISPLAY '** PARAGRAPH = 2270-UPDATE-TIMCNPO**'       19380007
173800             PERFORM 9100-SQL-ABEND                               19390007
173900     END-EVALUATE.                                                19400007
174000                                                                  19410007
174100******************************************************************19420007
174200 2280-UPDATE-TIMCNRL.                                             19430007
174300                                                                  19440007
174400         EXEC SQL                                                 19450007
174500             UPDATE TIMCNRL                                       19460007
174600                SET                                               19470007
174700                   DCONSLR_RLSE_CDE = :IMCNRL-DCONSLR-RLSE-CDE    19480007
174800                 , DCONSLR_ACTL_DTE = :IMCNRL-DCONSLR-ACTL-DTE    19490007
174900                 , DCONSLR_ACTL_TM  = :IMCNRL-DCONSLR-ACTL-TM     19500007
175000                 , LAST_UPD_TMST    = (CURRENT TIMESTAMP)         19510007
175100                 , LAST_UPD_BY_UID  = :PC-CURRENT-PROGRAM-NAME    19520007
175200              WHERE CONTNR_ID       = :IMCNTK-CONTNR-ID           19530007
175300                AND CONTNR_SEQ_NBR  = :IMCNTK-CONTNR-SEQ-NBR      19540007
175400                AND PO_NBR          = :IMCNPO-PO-NBR              19550007
175500         END-EXEC                                                 19560007
175600                                                                  19570007
175700     EVALUATE TRUE                                                19580007
175800         WHEN SQLCODE = ZERO                                      19590007
175900             PERFORM 4030-CREATE-IMCNRL-AUDIT-TRAIL               19600007
176000                                                                  19610007
176100                                                                  19620007
176200         WHEN SQLWARN0 NOT EQUAL SPACE                            19630007
176300         WHEN SQLCODE NOT EQUAL ZERO                              19640007
176400          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 19650007
176500          INITIALIZE TR006-ERROR-MSG                              19660007
176600          STRING 'CMN-CNRL TBL ERR-CALL IS-FIX'                   19670007
176700              DELIMITED BY SIZE                                   19680007
176800              INTO TR006-ERROR-MSG                                19690007
176900          PERFORM 8830-WRITE-ERROR-LINE                           19700007
177000          SET PS-PROBLEM-DO-NOT-SEND      TO TRUE                 19710007
177100          DISPLAY '** PROGRAM = TRKUP008 **'                      19720007
177200          DISPLAY '** PARAGRAPH = 2280-UPDATE-TIMCNRL**'          19730007
177300          DISPLAY '** IMCNTK-CONTNR-ID      ' IMCNTK-CONTNR-ID    19740007
177400          DISPLAY '** IMCNTK-CONTNR-SEQ-NBR '                     19750007
177500                                         IMCNTK-CONTNR-SEQ-NBR    19760007
177600          DISPLAY '** IMCNPO-PO-NBR         ' IMCNPO-PO-NBR       19770007
177700     END-EVALUATE.                                                19780007
177800                                                                  19790007
177900******************************************************************19800007
178000 2300-PROCESS-INSTRUCTION-LINES.                                  19810007
178100                                                                  19820007
178200     PERFORM 7900-OPEN-INSTR-CURSOR.                              19830007
178300                                                                  19840007
178400     PERFORM 8100-FETCH-INSTR-CURSOR.                             19850007
178500                                                                  19860007
178600     IF PS-EOC-INSTR-CURSOR                                       19870007
178700         PERFORM 8000-CLOSE-INSTR-CURSOR                          19880007
178800     ELSE                                                         19890007
178900         PERFORM 2310-FINISH-INSTRUCTION-LINES                    19900007
179000         PERFORM 8000-CLOSE-INSTR-CURSOR                          19910007
179100     END-IF.                                                      19920007
179200                                                                  19930007
179300     SET PS-EOC-INSTR-CURSOR-NO TO TRUE.                          19940007
179400                                                                  19950007
179500******************************************************************19960007
179600 2310-FINISH-INSTRUCTION-LINES.                                   19970007
179700                                                                  19980007
179800     INITIALIZE TR004-REC-TYPE-INS.                               19990007
179900     MOVE INSTCD-INSTR-DESC TO TR004-SPEC-INSTR.                  20000007
180000     PERFORM 5500-WRITE-PUR-ORDER-INS-REC.                        20010007
180100                                                                  20020007
180200******************************************************************20030007
180300 2350-PROCESS-PACKS-IDS.                                          20040007
180400                                                                  20050007
180500     PERFORM 8745-FETCH-PACK-CURSOR.                              20060007
180600                                                                  20070007
180700     IF PS-EOC-PACK-CURSOR                                        20080007
180800       PERFORM 8740-CLOSE-PACK-CURSOR                             20090007
180900       INITIALIZE TR006-PACK-ID                                   20100007
181000       MOVE ZERO TO PV-HOLD-PO-PREPK-ID                           20110007
181100     ELSE                                                         20120007
181200       MOVE POPRPK-PO-PREPK-ID  TO TR006-PACK-ID                  20130007
181300                                                                  20140007
181400       PERFORM 8470-OPEN-E-COM-PACK-UPC-CUR                       20150007
181500       SET PS-EOC-E-COM-PACK-UPC-CUR-NO TO TRUE                   20160007
181600       SET PS-PASSED-E-COM-CHECK-NO     TO TRUE                   20170007
181700       PERFORM 2352-CHECK-PACK-FOR-E-COM                          20180007
181800            UNTIL PS-EOC-E-COM-PACK-UPC-CUR                       20190007
181900       PERFORM 8474-CLOSE-E-COM-PACK-UPC-CUR                      20200007
182000                                                                  20210007
182100       IF PS-PASSED-E-COM-CHECK                                   20220007
182200                                                                  20230007
182300         MOVE POPRPK-PO-PREPK-ID     TO TR004-PACK-ID             20240007
182400         MOVE IMCNUP-UPC-UNT-QTY     TO TR004-PACK-UNIT-QTY       20250007
139868                                        PV-HOLD-PCK-UNIT-QTY      20260035
182500         MOVE IMCNUP-UPC-CART-CNT    TO TR004-PACK-CART-CT        20270007
139868                                        PV-HOLD-PCK-CART-CT       20280035
182600         MOVE IMCNUP-UPC-CBMT-QTY    TO TR004-PACK-CBMT-QTY       20290007
182700         MOVE IMCNUP-UPC-WT-KGRM-QTY TO TR004-PACK-WT-KGRM-QTY    20300007
182800                                                                  20310007
182900         IF IMCNUP-ASN-PKGNG-CDE   NOT =    'AS'                  20320007
183000             INITIALIZE TR006-ERROR-MSG                           20330007
183100             SET TR006-ERROR-TYPE-ERROR       TO TRUE             20340007
183200             STRING 'CMN-PCK HAS BULK ASN PKG CDE-FIX'            20350007
183300                 DELIMITED BY SIZE                                20360007
183400                 INTO TR006-ERROR-MSG                             20370007
183500             MOVE IMCNUP-SKU-NBR   TO TR006-SKU                   20380007
183600             MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR               20390007
183700             PERFORM 8830-WRITE-ERROR-LINE                        20400007
183800             SET PS-PROBLEM-DO-NOT-SEND TO TRUE                   20410007
183900         END-IF                                                   20420007
184000                                                                  20430007
184100** BUD **IF PURCHS-PKGNG-CDE = PC-M                               20440009
184100         IF POPRPK-PREPK-TYP-CDE = PC-M                           20450009
184200           MOVE POPRPK-INPK-UNT-QTY  TO TR004-PACK-UNITS-PER-CTN  20460007
139868                                        PV-HOLD-PCK-UNIT-PER-CTN  20470035
184300         ELSE                                                     20480007
184400           MOVE POPRPK-OTPK-UNT-QTY  TO TR004-PACK-UNITS-PER-CTN  20490007
139868                                        PV-HOLD-PCK-UNIT-PER-CTN  20500035
184500         END-IF                                                   20510007
184600                                                                  20520007
184700** BUD **IF PURCHS-PKGNG-CDE = PC-M                               20530009
184100         IF POPRPK-PREPK-TYP-CDE = PC-M                           20540009
184800            MOVE 1    TO TR004-PACKS-PER-CART                     20550007
184900         ELSE                                                     20560007
185000            IF POPRPK-INPK-UNT-QTY = ZERO                         20570007
185100              MOVE ZERO TO TR004-PACKS-PER-CART                   20580007
185200              PERFORM 2354-INPK-ZERO-ERROR-PACK                   20590007
185300            ELSE                                                  20600007
185400              COMPUTE TR004-PACKS-PER-CART =                      20610007
185500                   (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY)    20620007
185600            END-IF                                                20630007
185700         END-IF                                                   20640007
185800                                                                  20650007
185900*        **********************************************           20660007
186000*        *             SEPARATE SELECTS               *           20670007
186100*        **********************************************           20680007
186200*        * THE NEXT 4 PERFORMS ARE SELECT DISTINCTS   *           20690007
186300*        * ON THE SAME TABLE WITH SAME WHERE CLAUSES. *           20700007
186400*        * THEY MUST BE KEPT SEPARATE SO THAT WE KNOW *           20710007
186500*        * WHETHER WE HAVE MULTI ROWS (-811) DUE TO   *           20720007
186600*        * STYLE, COLOR OR SIZE.  UNITS MUST BE DONE  *           20730007
186700*        * SEPARATELY BECAUSE -811 ISN'T CHECKED.     *           20740007
186800*        **********************************************           20750007
186900         PERFORM 2360-SELECT-VENDOR-STYLE-PCK                     20760007
187000         PERFORM 2361-SELECT-COLOR-PCK                            20770007
187100         PERFORM 2362-SELECT-SIZE-PCK                             20780007
187200         PERFORM 2363-SELECT-DESC-PCK                             20790007
187300*        *********** END SEPARATE SELECTS *************           20800007
187400         MOVE POPRPK-PREPK-UPC-NBR                                20810007
187500                                  TO TR004-PACK-UPC-NBR           20820007
187600                                                                  20830007
187700         MOVE POPRPK-PK-SKU-NBR  TO TR004-PACK-SKU                20840007
187800                                                                  20850007
187900         IF POPRPK-PK-SKU-NBR = IMCNUP-SKU-NBR                    20860007
188000          AND POPRPK-PK-SKU-NBR   NOT =   ZERO                    20870007
188100           CONTINUE                                               20880007
188200         ELSE                                                     20890007
188300           INITIALIZE TR006-ERROR-MSG                             20900007
188400           IF POPRPK-PK-SKU-NBR = ZERO                            20910007
188500             STRING 'CMN-NO PCK SKU FOR PACK PO-FIX'              20920007
188600                 DELIMITED BY SIZE                                20930007
188700                 INTO TR006-ERROR-MSG                             20940007
188800** BG      ELSE                                                   20950007
188900** BG        STRING 'CMN-PACK SKU NOT = CONT SKU-FIX'             20960007
189000** BG            DELIMITED BY SIZE                                20970007
189100** BG            INTO TR006-ERROR-MSG                             20980007
189200** BG      END-IF                                                 20990007
189300           SET TR006-ERROR-TYPE-ERROR       TO TRUE               21000007
189400           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     21010007
189500           MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR                 21020007
189600           PERFORM 8830-WRITE-ERROR-LINE                          21030007
189700           SET PS-PROBLEM-DO-NOT-SEND       TO TRUE               21040007
189800           END-IF                                                 21050007
189900         END-IF                                                   21060007
190000                                                                  21070007
190100         MOVE POPRPK-PREPK-UPC-NBR TO IMCNUP-UPC-NBR              21080007
190200                                                                  21090007
190300         PERFORM 2430-GET-CARTON-LABEL-DATA                       21100007
190400         IF IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC            21110007
190500           MOVE ZERO TO TR004-PCK-NO-LBL-CART-CT                  21120007
190600         ELSE                                                     21130007
190700           COMPUTE TR004-PCK-NO-LBL-CART-CT =                     21140007
190800             (IMCNUP-UPC-CART-CNT - PV-NBR-CART-LBLS-UPC)         21150007
190900         END-IF                                                   21160007
191000                                                                  21170007
191100         PERFORM 5755-WRITE-PUR-ORDER-PCK-REC                     21180007
191200                                                                  21190007
191300***      SET PS-ORDERED-EQUALS-SHIPPED-NO TO TRUE                 21200007
191400         SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE                 21210007
191500         PERFORM 2370-SELECT-PACK-SUM                             21220007
191600                                                                  21230007
191700         IF PS-SELECT-PACK-SUM-OK                                 21240007
191800           SET PS-COUNT-DCS-OK-NO         TO TRUE                 21250007
191900           PERFORM 2384-COUNT-DCS-FOR-PACK                        21260007
192000           IF PS-COUNT-DCS-OK                                     21270018
192100             IF PV-NBR-CART-LBLS-UPC > ZERO                       21280007
192200               PERFORM 8758-OPEN-CART-LABEL-CURSOR                21290007
192300               SET PS-EOC-CART-LABEL-CURSOR-NO TO TRUE            21300007
192400             END-IF                                               21310007
192500             SET PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             21320007
192600             SET PS-FIRST-DC                  TO TRUE             21330007
139868             SET PS-OUTLET-STORE-NO           TO TRUE             21340035
192700             PERFORM 8420-OPEN-PACK-DC-CURSOR                     21350007
192800             PERFORM 2372-PROCESS-PREPACK-DC UNTIL                21360007
192900                     PS-EOC-PREPACK-DC-CURSOR                     21370007
193000             SET PS-EOC-PREPACK-DC-CURSOR-NO  TO TRUE             21380007
193100             IF PV-NBR-CART-LBLS-UPC > ZERO                       21390007
193200               PERFORM 8760-CLOSE-CART-LABEL-CURSOR               21400007
193300             END-IF                                               21410007
193400           END-IF                                                 21420007
193500         END-IF                                                   21430007
193600                                                                  21440007
193700         PERFORM 8450-OPEN-PACK-UPC-CURSOR                        21450007
193800         SET PS-UPCS-ON-PREPACK-NO        TO TRUE                 21460007
193900         PERFORM 2480-PROCESS-PREPACK-UPC UNTIL                   21470007
194000                  PS-EOC-PREPACK-UPC-CURSOR                       21480007
194100         SET PS-EOC-PREPACK-UPC-CURSOR-NO TO TRUE                 21490007
194200                                                                  21500007
194300       END-IF                                                     21510007
194400                                                                  21520007
194500     END-IF.                                                      21530007
194600                                                                  21540007
194700******************************************************************21550007
194800* GO THRU ALL UPCS ON PACK - IF THERE ARE ANY SPLITS FOR E-COM-  *21560007
194900* MERCE FULFILLMENT CENTER, ALL OF THE UPCS ON THE PACK MUST BE  *21570007
195000* E-COM TYPE OR THE SPLITS WILL NOT BE SENT.                     *21580007
195100******************************************************************21590007
195200 2352-CHECK-PACK-FOR-E-COM.                                       21600007
195300                                                                  21610007
195400     PERFORM 8472-FETCH-E-COM-PACK-UPC-CUR.                       21620007
195500                                                                  21630007
195600     IF PS-EOC-E-COM-PACK-UPC-CUR                                 21640007
195700                                                                  21650007
195800        EVALUATE TRUE                                             21660007
195900                                                                  21670007
196000           WHEN PV-TTL-E-COM-PACK-UPCS = ZERO                     21680007
196100             AND PV-TTL-BAD-PACK-UPCS = ZERO                      21690007
196200           WHEN PV-TTL-E-COM-PACK-UPCS  = PV-TTL-PACK-UPCS        21700007
196300                                                                  21710007
196400             SET PS-PASSED-E-COM-CHECK TO TRUE                    21720007
196500                                                                  21730007
196600           WHEN OTHER                                             21740007
196700                                                                  21750007
196800             INITIALIZE TR006-ERROR-MSG                           21760007
196900             SET TR006-ERROR-TYPE-ERROR       TO TRUE             21770007
197000             STRING 'CMN-PCK HAS ECOM DC-NOT ECOM SKU'            21780007
197100                 DELIMITED BY SIZE                                21790007
197200                 INTO TR006-ERROR-MSG                             21800007
197300             MOVE IMCNUP-SKU-NBR   TO TR006-SKU                   21810007
197400             PERFORM 8830-WRITE-ERROR-LINE                        21820007
197500             SET PS-PROBLEM-DO-NOT-SEND TO TRUE                   21830007
197600                                                                  21840007
197700        END-EVALUATE                                              21850007
197800                                                                  21860007
197900        INITIALIZE  PV-TTL-E-COM-PACK-UPCS                        21870007
198000        INITIALIZE  PV-TTL-PACK-UPCS                              21880007
198100        INITIALIZE  PV-TTL-BAD-PACK-UPCS                          21890007
198200                                                                  21900007
198300     ELSE                                                         21910007
198400                                                                  21920007
198500       ADD +1   TO PV-TTL-PACK-UPCS                               21930007
198600       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     21940007
198700       PERFORM 2410-SELECT-E-COM-DCS                              21950007
198800                                                                  21960007
198900       IF PS-THERE-ARE-E-COM-DCS                                  21970007
199000          SET PS-THIS-IS-E-COM-UPC-NO  TO TRUE                    21980007
199100          PERFORM 2415-SELECT-UPC-FROM-TWEBITM                    21990007
199200             IF PS-THIS-IS-E-COM-UPC                              22000007
199300               ADD +1   TO PV-TTL-E-COM-PACK-UPCS                 22010007
199400             ELSE                                                 22020007
199500               ADD +1   TO PV-TTL-BAD-PACK-UPCS                   22030007
199600             END-IF                                               22040007
199700       END-IF                                                     22050007
199800                                                                  22060007
199900     END-IF.                                                      22070007
200000                                                                  22080007
200100******************************************************************22090007
200200*  ONLY PRINT THE MESSAGE ONCE PER PO/PACK ID COMBO.              22100007
200300******************************************************************22110007
200400 2354-INPK-ZERO-ERROR-PACK.                                       22120007
200500                                                                  22130007
200600     IF PV-HOLD-PO-PREPK-PO = TR006-PO-NBR                        22140007
200700       AND PV-HOLD-PO-PREPK-ID = TR006-PACK-ID                    22150007
200800         CONTINUE                                                 22160007
200900     ELSE                                                         22170007
201000         SET TR006-ERROR-TYPE-ERROR   TO TRUE                     22180007
201100         INITIALIZE TR006-ERROR-MSG                               22190007
201200         STRING 'CMN-POPRPK-INPK-UNT-QTY FLD IS 0'                22200007
201300             DELIMITED BY SIZE                                    22210007
201400             INTO TR006-ERROR-MSG                                 22220007
201500         MOVE IMCNUP-SKU-NBR   TO TR006-SKU                       22230007
201600         PERFORM 8830-WRITE-ERROR-LINE                            22240007
201700         MOVE TR006-PO-NBR     TO  PV-HOLD-PO-PREPK-PO            22250007
201800         MOVE TR006-PACK-ID    TO  PV-HOLD-PO-PREPK-ID            22260007
201900     END-IF.                                                      22270007
202000                                                                  22280007
202100******************************************************************22290007
202200* SELECT THE VENDOR STYLE NAME FROM TPURITM.                     *22300007
202300******************************************************************22310007
202400 2360-SELECT-VENDOR-STYLE-PCK.                                    22320007
202500                                                                  22330007
202600     EXEC SQL                                                     22340007
202700         SELECT DISTINCT                                          22350007
202800                XVS.VS_NBR                                        22360007
202900           INTO :XLT00004-VS-NBR                                  22370007
203000           FROM TPURITM      A                                    22380007
203100               ,XLT_VND_STYL XVS                                  22390007
203200               ,XLT_SKU      XS                                   22400007
203300          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 22410007
203400            AND A.ITM_NBR        =  XS.ITM_NBR                    22420007
203500            AND XS.STYL_ID       =  XVS.STYL_ID                   22430007
203600            AND A.VER_STATUS_CDE = :PC-A                          22440007
203700            AND A.STATUS_CDE    IN ('AC', 'AP')                   22450007
203800            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            22460007
203900     END-EXEC                                                     22470007
204000                                                                  22480007
204100     EVALUATE TRUE                                                22490007
204200         WHEN SQLCODE = ZERO                                      22500007
204300             MOVE XLT00004-VS-NBR       TO                        22510007
204400                   TR004-PACK-VEND-STYL-NAME                      22520007
204500                                                                  22530007
204600         WHEN SQLCODE = +100                                      22540007
204700             MOVE SPACES TO TR004-PACK-VEND-STYL-NAME             22550007
204800                                                                  22560007
204900         WHEN SQLCODE = -811                                      22570007
205000             MOVE PC-MULTI TO TR004-PACK-VEND-STYL-NAME           22580007
205100                                                                  22590007
205200         WHEN SQLWARN0 NOT EQUAL SPACE                            22600007
205300         WHEN SQLCODE NOT EQUAL ZERO                              22610007
205400             DISPLAY '**************************************'     22620007
205500             DISPLAY '** ABEND                            **'     22630007
205600             DISPLAY '** PROGRAM = TRKUP008               **'     22640007
205700             DISPLAY '** PARAGRAPH = 2360-SELECT-VENDOR-  **'     22650007
205800             DISPLAY '**                  STYLE-PCK       **'     22660007
205900             DISPLAY '** SELECT TPURITM                   **'     22670007
206000             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              22680007
206100             DISPLAY '**************************************'     22690007
206200             PERFORM 9100-SQL-ABEND                               22700007
206300     END-EVALUATE.                                                22710007
206400                                                                  22720007
206500******************************************************************22730007
206600* SELECT THE COLOR CODE AND DESCRIPTION FROM TPURITM.            *22740007
206700******************************************************************22750007
206800 2361-SELECT-COLOR-PCK.                                           22760007
206900                                                                  22770007
207000     EXEC SQL                                                     22780007
207100         SELECT DISTINCT                                          22790007
207200                XS.NRF_CLOR_CDE                                   22800007
207300              , XS.CSTM_CLOR_DESC                                 22810007
207400           INTO :XLT00003-NRF-CLOR-CDE                            22820007
207500              , :XLT00003-CSTM-CLOR-DESC                          22830007
207600           FROM TPURITM  A                                        22840007
207700               ,XLT_SKU  XS                                       22850007
207800          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                22860007
207900            AND A.ITM_NBR        =  XS.ITM_NBR                    22870007
208000            AND A.VER_STATUS_CDE = :PC-A                          22880007
208100            AND A.STATUS_CDE    IN ('AC', 'AP')                   22890007
208200            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            22900007
208300     END-EXEC                                                     22910007
208400                                                                  22920007
208500     EVALUATE TRUE                                                22930007
208600         WHEN SQLCODE = ZERO                                      22940007
208700             MOVE XLT00003-NRF-CLOR-CDE   TO TR004-PACK-COLOR-CDE 22950007
208800             MOVE XLT00003-CSTM-CLOR-DESC TO TR004-PACK-COLOR-DESC22960007
208900                                                                  22970007
209000         WHEN SQLCODE = +100                                      22980007
209100             MOVE SPACES TO TR004-PACK-COLOR-CDE                  22990007
209200                            TR004-PACK-COLOR-DESC                 23000007
209300                                                                  23010007
209400         WHEN SQLCODE = -811                                      23020007
209500             MOVE PC-MULTI TO TR004-PACK-COLOR-CDE                23030007
209600                              TR004-PACK-COLOR-DESC               23040007
209700                                                                  23050007
209800         WHEN SQLWARN0 NOT EQUAL SPACE                            23060007
209900         WHEN SQLCODE NOT EQUAL ZERO                              23070007
210000             DISPLAY '**************************************'     23080007
210100             DISPLAY '** ABEND                            **'     23090007
210200             DISPLAY '** PROGRAM = TRKUP008               **'     23100007
210300             DISPLAY '** PARAGRAPH = 2361-SELECT-COLOR-PCK**'     23110007
210400             DISPLAY '** SELECT TPURITM                   **'     23120007
210500             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              23130007
210600             DISPLAY '**************************************'     23140007
210700             PERFORM 9100-SQL-ABEND                               23150007
210800     END-EVALUATE.                                                23160007
210900                                                                  23170007
211000******************************************************************23180007
211100* SELECT THE SIZE DESCRIPTION FROM TPURITM.                      *23190007
211200******************************************************************23200007
211300 2362-SELECT-SIZE-PCK.                                            23210007
211400                                                                  23220007
211500     EXEC SQL                                                     23230007
211600         SELECT DISTINCT                                          23240007
211700                XS.SIZE_DESC                                      23250007
211800           INTO :XLT00003-SIZE-DESC                               23260007
211900           FROM TPURITM  A                                        23270007
212000               ,XLT_SKU  XS                                       23280007
212100          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                23290007
212200            AND A.ITM_NBR        =  XS.ITM_NBR                    23300007
212300            AND A.VER_STATUS_CDE = :PC-A                          23310007
212400            AND A.STATUS_CDE    IN ('AC', 'AP')                   23320007
212500            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            23330007
212600     END-EXEC                                                     23340007
212700                                                                  23350007
212800     EVALUATE TRUE                                                23360007
212900         WHEN SQLCODE = ZERO                                      23370007
213000             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         23380007
213100                 MOVE PC-NO-SIZE         TO TR004-PACK-SIZE-DESC  23390007
213200             ELSE                                                 23400007
213300                 MOVE XLT00003-SIZE-DESC TO TR004-PACK-SIZE-DESC  23410007
213400             END-IF                                               23420007
213500                                                                  23430007
213600         WHEN SQLCODE = +100                                      23440007
213700             MOVE SPACES  TO TR004-PACK-SIZE-DESC                 23450007
213800                                                                  23460007
213900         WHEN SQLCODE = -811                                      23470007
214000             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         23480007
214100                 MOVE PC-NO-SIZE TO TR004-PACK-SIZE-DESC          23490007
214200             ELSE                                                 23500007
214300                 MOVE PC-MULTI TO TR004-PACK-SIZE-DESC            23510007
214400             END-IF                                               23520007
214500                                                                  23530007
214600         WHEN SQLWARN0 NOT EQUAL SPACE                            23540007
214700         WHEN SQLCODE NOT EQUAL ZERO                              23550007
214800             DISPLAY '**************************************'     23560007
214900             DISPLAY '** ABEND                            **'     23570007
215000             DISPLAY '** PROGRAM = TRKUP008               **'     23580007
215100             DISPLAY '** PARAGRAPH = 2362-SELECT-SIZE-PCK **'     23590007
215200             DISPLAY '** SELECT TPURITM                   **'     23600007
215300             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              23610007
215400             DISPLAY '**************************************'     23620007
215500             PERFORM 9100-SQL-ABEND                               23630007
215600     END-EVALUATE.                                                23640007
215700                                                                  23650007
215800******************************************************************23660007
215900* SELECT THE PREPACK DESCRIPTION FROM TPOPRPK.                   *23670007
216000******************************************************************23680007
216100 2363-SELECT-DESC-PCK.                                            23690007
216200                                                                  23700007
216300     EXEC SQL                                                     23710007
216400         SELECT A.PREPK_DESC                                      23720007
216500           INTO :POPRPK-PREPK-DESC                                23730007
216600           FROM TPOPRPK  A                                        23740007
216700          WHERE A.PO_NBR    =  :IMCNPO-PO-NBR                     23750007
216800            AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID              23760007
216900     END-EXEC                                                     23770007
217000                                                                  23780007
217100     EVALUATE TRUE                                                23790007
217200         WHEN SQLCODE = ZERO                                      23800007
217300             MOVE POPRPK-PREPK-DESC TO TR004-PACK-DESC            23810007
217400                                                                  23820007
217500         WHEN SQLCODE = +100                                      23830007
217600             MOVE SPACES TO TR004-PACK-DESC                       23840007
217700                                                                  23850007
217800         WHEN SQLWARN0 NOT EQUAL SPACE                            23860007
217900         WHEN SQLCODE NOT EQUAL ZERO                              23870007
218000             DISPLAY '**************************************'     23880007
218100             DISPLAY '** ABEND                            **'     23890007
218200             DISPLAY '** PROGRAM = TRKUP008               **'     23900007
218300             DISPLAY '** PARAGRAPH = 2363-SELECT-UNIT-    **'     23910007
218400             DISPLAY '**                  QTY-PCK         **'     23920007
218500             DISPLAY '** SELECT TPOPRPK                   **'     23930007
218600             DISPLAY '** PO NUMBER  = ' PURCHS-PO-NBR             23940007
218700             DISPLAY '** PREPACK ID = ' POPRPK-PO-PREPK-ID        23950007
218800             DISPLAY '**************************************'     23960007
218900             PERFORM 9100-SQL-ABEND                               23970007
219000     END-EVALUATE.                                                23980007
219100                                                                  23990007
219200 EJECT                                                            24000007
219300******************************************************************24010007
219400* GET THE TOTAL ORDERED QTY FOR THIS PACK.                       *24020007
219500******************************************************************24030007
219600 2370-SELECT-PACK-SUM.                                            24040007
219700                                                                  24050007
219800     EXEC SQL                                                     24060007
219900           SELECT                                                 24070007
220000             SUM  (TALL.CURR_SPLIT_QTY)                           24080007
220100            INTO  :PA-TTL-ORDERED-PACK-QTY                        24090007
220200            FROM                                                  24100007
220300                  TALLPLN   TALL                                  24110007
220400                 ,TPURITM   PUR                                   24120007
220500            WHERE  PUR.PO_NBR          = :IMCNPO-PO-NBR           24130007
220600               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      24140007
220700               AND PUR.VER_STATUS_CDE  = 'A'                      24150007
220800               AND PUR.STATUS_CDE     IN ('AC', 'AP')             24160007
220900               AND TALL.PO_NBR         =  PUR.PO_NBR              24170007
221000               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          24180007
221100               AND TALL.CURR_SPLIT_QTY >  0                       24190007
221200     END-EXEC.                                                    24200007
221300                                                                  24210007
221400     EVALUATE TRUE                                                24220007
221500         WHEN SQLCODE = ZERO AND PA-TTL-ORDERED-PACK-QTY     > 0  24230007
221600           SET PS-SELECT-PACK-SUM-OK     TO TRUE                  24240007
221700***        ***************************************************    24250007
221800***        * WE DECIDED TO JUST GO WITH SHIPPED CARTONS AND       24260007
221900***        * BASE UNITS ON MULTIPLES OF CARTONS. BUT IN CASE      24270007
222000***        * WE CHANGE OUR MINDS .......                          24280007
222100***        ***************************************************    24290007
222200***        IF PA-TTL-PCK-UNITS-SENT = PA-TTL-ORDERED-PACK-QTY     24300007
222300***          SET PS-ORDERED-EQUALS-SHIPPED   TO TRUE              24310007
222400***        END-IF                                                 24320007
222500                                                                  24330007
222600         WHEN SQLCODE = ZERO AND PA-TTL-ORDERED-PACK-QTY     = 0  24340007
222700         WHEN SQLCODE = +100                                      24350007
222800         WHEN SQLCODE = -305                                      24360007
222900           SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE               24370007
223000           SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE               24380007
223100           INITIALIZE TR006-ERROR-MSG                             24390007
223200                      TR006-UPC-NBR                               24400007
223300           STRING 'CMN-PACK MISSING SPLT-FIX'                     24410007
223400               DELIMITED BY SIZE                                  24420007
223500               INTO TR006-ERROR-MSG                               24430007
223600           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     24440007
223700           PERFORM 8830-WRITE-ERROR-LINE                          24450007
223800           SET PS-PROBLEM-DO-NOT-SEND TO TRUE                     24460007
223900                                                                  24470007
224000         WHEN SQLWARN0 NOT EQUAL SPACE                            24480007
224100         WHEN SQLCODE NOT EQUAL ZERO                              24490007
224200             DISPLAY '** ABEND **'                                24500007
224300             DISPLAY '** PROGRAM = TRKUP008 **'                   24510007
224400             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          24520007
224500             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      24530007
224600             DISPLAY '** PREPACK ID    = ' POPRPK-PO-PREPK-ID     24540007
224700             DISPLAY '** PARA = 2370-SELECT-PACK-SUM **'          24550007
224800             PERFORM 9100-SQL-ABEND                               24560007
224900     END-EVALUATE.                                                24570007
225000                                                                  24580007
225100******************************************************************24590007
225200* PROCESS PREPACK DC INFORMATION.                                *24600007
225300******************************************************************24610007
225400 2372-PROCESS-PREPACK-DC.                                         24620007
225500                                                                  24630007
225600     PERFORM 8430-FETCH-PACK-DC-CURSOR.                           24640007
225700     IF PS-EOC-PREPACK-DC-CURSOR                                  24650007
139868        PERFORM 2373-PROCESS-PREPACK-CONT                         24660035
139868     ELSE                                                         24670035
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     24680035
139868        PERFORM 1050-SELECT-OUTLET-PARM                           24690035
139868        IF PS-OUTLET-STORE                                        24700035
139868           SET PS-FIRST-STORE  TO TRUE                            24710035
139868           PERFORM 8960-OUTLET-STORE-PREPACK                      24720035
139868        ELSE                                                      24730035
155029           EVALUATE TRUE                                          24740073
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       24750073
155029               AND  PV-FAST-E-BUS-IND = 'N')                      24760073
155029                 IF PS-FIRST-UPC-YES                              24770073
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 24780073
155029                    SET PS-FIRST-STORE    TO TRUE                 24790073
155029                 END-IF                                           24800073
155029                 SET PS-OUTLET-STORE   TO TRUE                    24810073
155029                 PERFORM 8960-OUTLET-STORE-PREPACK                24820073
155029                                                                  24830073
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       24840073
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      24850073
155029                 IF PS-FIRST-UPC-YES                              24860073
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 24870073
155029                    SET PS-FIRST-STORE    TO TRUE                 24880073
155029                 END-IF                                           24890073
155029                 SET PS-OUTLET-STORE   TO TRUE                    24900073
155029                 PERFORM 8960-OUTLET-STORE-PREPACK                24910073
155029                                                                  24920073
155029              WHEN OTHER                                          24930073
JNSINC*             DISPLAY 'WHEN OTHER IN 2372-'                       24931085
JNSINC*             DISPLAY PV-FAST-RDC-IND                             24932085
JNSINC*             DISPLAY PV-FAST-EFC-IND                             24932185
JNSINC*             DISPLAY PV-FAST-E-BUS-IND                           24933085
139868                 PERFORM 2373-PROCESS-PREPACK-CONT                24940052
155029           END-EVALUATE                                           24950073
139868        END-IF                                                    24960062
139868     END-IF.                                                      24970062
139868                                                                  24980035
139868******************************************************************24990035
139868 2373-PROCESS-PREPACK-CONT.                                       25000035
139868                                                                  25010035
225700     IF PS-EOC-PREPACK-DC-CURSOR                                  25020018
JNSINC*        MOVE '2373-PROCESS-PREPACK-CONT' TO PV-PARA-NAME         25030085
JNSINC*        DISPLAY PV-PARA-NAME                                     25030185
225800         PERFORM 8425-CLOSE-PACK-DC-CURSOR                        25031076
225900         IF PS-DC-SPLIT-INFO-PRESENT                              25040007
139868           IF PS-OUTLET-STORE                                     25050035
139868              CONTINUE                                            25060035
139868           ELSE                                                   25070035
226000              PERFORM 2380-ADJUST-ROUNDED-PDC-DIST                25080022
226100              PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                25090022
226200              IF PV-NBR-CART-LBLS-UPC > 0                         25100022
226300                PERFORM 2394-CREATE-PCT-CARTON-LABELS             25110022
226400              END-IF                                              25120022
139868           END-IF                                                 25130035
226500         END-IF                                                   25140007
226600     ELSE                                                         25150007
226700         IF PS-FIRST-DC                                           25160007
226800           SET PS-FIRST-DC-NO     TO TRUE                         25170007
226900*          ***************************************************    25180007
227000*          * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO       25190007
227100*          * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.        25200007
227200*          ***************************************************    25210007
227300           COMPUTE PV-DCS-TO-SKIP =                               25220007
227400             (IMCNUP-UPC-CART-CNT - PV-TOTAL-NBR-OF-DCS)          25230007
227500              * (-1)                                              25240007
227600                                                                  25250007
227700             INITIALIZE PV-TTL-ALL-DCS-PCT                        25260007
227800                      PV-TTL-ALL-DCS-UNITS                        25270007
227900                      PV-TTL-ALL-DCS-CARTS                        25280007
228000         ELSE                                                     25290007
228100*            *******************************************          25300007
228200*            * IF NOT EOC OR FIRST DC, WRITE THE DTL   *          25310007
228300*            * EXTRACT & REPORT RECS FROM THE PRIOR DC *          25320007
228400*            *******************************************          25330007
228500             PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                 25340007
228600             IF PV-NBR-CART-LBLS-UPC > 0                          25350007
228700               PERFORM 2394-CREATE-PCT-CARTON-LABELS              25360007
228800             END-IF                                               25370007
228900             IF PV-DCS-TO-SKIP  > ZERO                            25380007
229000               SUBTRACT 1 FROM PV-DCS-TO-SKIP                     25390007
229100             END-IF                                               25400007
229200         END-IF                                                   25410007
229300         INITIALIZE TR004-REC-TYPE-PDC                            25420007
229400         MOVE ALLPLN-DEST-NBR TO TR004-PDC-DIST-CNTR              25430007
229500         PERFORM 2374-ORDER-PERCENT-PDC                           25440007
229600         PERFORM 2376-CART-AND-UNIT-CNT-PDC                       25450007
229700     END-IF.                                                      25460007
229800                                                                  25470007
229900******************************************************************25480007
230000* CALCULATE ORDER PERCENT FOR THIS DC.                           *25490007
230100******************************************************************25500007
230200 2374-ORDER-PERCENT-PDC.                                          25510007
230300                                                                  25520007
230400     IF PS-SELECT-PACK-SUM-OK                                     25530007
230500       AND PA-TTL-ORDERED-PACK-QTY     NOT =  ZERO                25540007
230600         DIVIDE PA-TTL-ORDERED-PACK-QTY                           25550007
230700           INTO PA-TTL-ORDERED-PACK-QTY-DC                        25560007
230800              GIVING PA-TTL-PCK-SPLIT-QTY-DC-PCT ROUNDED          25570007
230900         MULTIPLY PA-TTL-PCK-SPLIT-QTY-DC-PCT                     25580007
231000               BY  100 GIVING TR004-PDC-PERCNT ROUNDED            25590007
231100     ELSE                                                         25600007
231200       MOVE ZERO    TO TR004-PDC-PERCNT                           25610007
231300               PA-TTL-PCK-SPLIT-QTY-DC-PCT                        25620007
231400     END-IF.                                                      25630007
231500                                                                  25640007
231600     IF TR004-PDC-PERCNT = ZERO                                   25650007
231700        MOVE +1 TO TR004-PDC-PERCNT                               25660007
231800     END-IF.                                                      25670007
231900                                                                  25680007
232000     ADD  TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT.          25690007
232100                                                                  25700007
232200******************************************************************25710007
232300* CALCULATE THE PDC CARTON COUNT AND UNITS FOR THIS DC           *25720007
232400******************************************************************25730007
232500 2376-CART-AND-UNIT-CNT-PDC.                                      25740007
232600                                                                  25750007
232700     COMPUTE TR004-PDC-CART-CT ROUNDED =                          25760007
232800        (IMCNUP-UPC-CART-CNT  *                                   25770007
232900                              PA-TTL-PCK-SPLIT-QTY-DC-PCT).       25780007
233000                                                                  25790007
233100     IF PV-DCS-TO-SKIP  > ZERO                                    25800007
233200       MOVE ZERO    TO TR004-PDC-CART-CT                          25810007
233300     ELSE                                                         25820007
233400       COMPUTE PV-DC-CART-CT ROUNDED =                            25830007
233500         (IMCNUP-UPC-CART-CNT * PA-TTL-PCK-SPLIT-QTY-DC-PCT)      25840007
233600       ADD .5 TO PV-DC-CART-CT                                    25850007
233700       IF PV-DC-CART-CT < 1                                       25860007
233800          MOVE 1                   TO TR004-PDC-CART-CT           25870007
233900       ELSE                                                       25880007
234000          MOVE PV-DC-CART-CT       TO TR004-PDC-CART-CT           25890007
234100       END-IF                                                     25900007
234200     END-IF.                                                      25910007
234300                                                                  25920007
234400     ADD  TR004-PDC-CART-CT       TO PV-TTL-ALL-DCS-CARTS.        25930007
234500                                                                  25940007
234600     IF TR004-PDC-CART-CT = ZERO                                  25950007
234700        IF PURCHS-NEW-STR-PO-IND = PC-Y                           25960007
234800          PERFORM 2600-ZERO-CARTONS-ERROR                         25970007
234900        END-IF                                                    25980007
235000     END-IF.                                                      25990007
235100                                                                  26000007
235200***  ***************************************************          26010007
235300***  * WE DECIDED TO JUST GO WITH SHIPPED CARTONS AND             26020007
235400***  * BASE UNITS ON MULTIPLES OF CARTONS. BUT IN CASE            26030007
235500***  * WE CHANGE OUR MINDS .......                                26040007
235600***  ***************************************************          26050007
235700***  IF PS-ORDERED-EQUALS-SHIPPED                                 26060007
235800***    MOVE PA-TTL-ORDERED-PACK-QTY-DC TO TR004-PDC-UNIT-QTY      26070007
235900***  ELSE                                                         26080007
236000     COMPUTE TR004-PDC-UNIT-QTY ROUNDED =                         26090007
236100          (IMCNUP-UPC-UNT-QTY * PA-TTL-PCK-SPLIT-QTY-DC-PCT).     26100007
236200     ADD  TR004-PDC-UNIT-QTY      TO PV-TTL-ALL-DCS-UNITS.        26110007
236300                                                                  26120007
236400     PERFORM 2390-COMPUTE-HOW-MANY-LBLS-PDC.                      26130007
236500     PERFORM 2392-COMPUTE-PDC-NO-LABELS.                          26140007
236600                                                                  26150007
236700******************************************************************26160007
236800 2380-ADJUST-ROUNDED-PDC-DIST.                                    26170007
236900                                                                  26180007
237000     IF PV-TTL-ALL-DCS-PCT = 100                                  26190007
237100       CONTINUE                                                   26200007
237200     ELSE                                                         26210007
237300       COMPUTE TR004-PDC-PERCNT =                                 26220007
237400            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         26230007
237500     END-IF.                                                      26240007
237600                                                                  26250007
237700*    ********************************************************     26260007
237800*    *  ADJUST CARTONS BASED ON ACTUAL                      *     26270007
237900*    *  SHIPPED QUANTITIES.                                 *     26280007
238000*    ********************************************************     26290007
238100     IF PV-TTL-ALL-DCS-CARTS = IMCNUP-UPC-CART-CNT                26300007
238200       CONTINUE                                                   26310007
238300     ELSE                                                         26320007
238400       COMPUTE TR004-PDC-CART-CT =                                26330007
238500          TR004-PDC-CART-CT +                                     26340007
238600             (IMCNUP-UPC-CART-CNT - PV-TTL-ALL-DCS-CARTS)         26350007
238700*      ******************************************************     26360007
238800*      * IF CARTONS WERE ADJUSTED, ADJUST HOW MANY LABELS   *     26370007
238900*      * AND UNLBELED CARTS FOR THIS DC.                    *     26380007
239000*      ******************************************************     26390007
239100       SUBTRACT PV-NBR-CART-LBLS-THIS-DC                          26400007
239200                     FROM PV-TTL-CART-LBLS-ALL-DCS                26410007
239300       PERFORM 2390-COMPUTE-HOW-MANY-LBLS-PDC                     26420007
239400       PERFORM 2392-COMPUTE-PDC-NO-LABELS                         26430007
239500     END-IF.                                                      26440007
239600                                                                  26450007
239700*    ********************************************************     26460007
239800*    *  ADJUST UNITS BASED ON ACTUAL                        *     26470007
239900*    *  SHIPPED QUANTITIES.                                 *     26480007
240000*    ********************************************************     26490007
240100     IF PV-TTL-ALL-DCS-UNITS = IMCNUP-UPC-UNT-QTY                 26500007
240200       CONTINUE                                                   26510007
240300     ELSE                                                         26520007
240400       COMPUTE TR004-PDC-UNIT-QTY =                               26530007
240500          TR004-PDC-UNIT-QTY +                                    26540007
240600             (IMCNUP-UPC-UNT-QTY - PV-TTL-ALL-DCS-UNITS)          26550007
240700     END-IF.                                                      26560007
240800                                                                  26570007
240900*    ********************************************************     26580007
241000*    *  ADJUST LABELS FOR THIS PACK DC                      *     26590007
241100*    ********************************************************     26600007
241200     IF PV-NBR-CART-LBLS-UPC = PV-TTL-CART-LBLS-ALL-DCS           26610007
241300       CONTINUE                                                   26620007
241400     ELSE                                                         26630007
241500        IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC             26640007
241600          CONTINUE                                                26650007
241700        ELSE                                                      26660007
241800          COMPUTE PV-NBR-CART-LBLS-THIS-DC =                      26670007
241900            PV-NBR-CART-LBLS-THIS-DC +                            26680007
242000             (PV-NBR-CART-LBLS-UPC - PV-TTL-CART-LBLS-ALL-DCS)    26690007
242100        END-IF                                                    26700007
242200        PERFORM 2392-COMPUTE-PDC-NO-LABELS                        26710007
242300     END-IF.                                                      26720007
242400                                                                  26730007
139868******************************************************************26740035
139868 2382-ADJUST-ROUNDED-OUT-DIST.                                    26750035
139868                                                                  26760035
139868     IF PV-TTL-ALL-DCS-PCT = 100                                  26770035
139868       CONTINUE                                                   26780035
139868     ELSE                                                         26790035
139868       COMPUTE TR004-PDC-PERCNT =                                 26800035
139868            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         26810035
139868     END-IF.                                                      26820035
139868                                                                  26830035
242500******************************************************************26840007
242600* COUNT THE DCS FOR THIS PACK.                                   *26850007
242700******************************************************************26860007
242800 2384-COUNT-DCS-FOR-PACK.                                         26870007
242900                                                                  26880007
243000     EXEC SQL                                                     26890007
243100           SELECT                                                 26900007
243200                  COUNT(DISTINCT TALL.DEST_NBR)                   26910007
243300             INTO                                                 26920007
243400                  :PV-TOTAL-NBR-OF-DCS                            26930007
243500             FROM                                                 26940007
243600                  TALLPLN   TALL                                  26950007
243700                 ,TPURITM   PUR                                   26960007
243800            WHERE  PUR.PO_NBR          = :IMCNPO-PO-NBR           26970007
243900               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      26980007
244000               AND PUR.VER_STATUS_CDE  = 'A'                      26990007
244100               AND PUR.STATUS_CDE     IN ('AC', 'AP')             27000007
244200               AND TALL.PO_NBR         =  PUR.PO_NBR              27010007
244300               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          27020007
244400               AND TALL.CURR_SPLIT_QTY >  0                       27030007
244500     END-EXEC.                                                    27040007
244600                                                                  27050007
244700     EVALUATE TRUE                                                27060007
244800         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS  > 0         27070007
244900           SET PS-COUNT-DCS-OK           TO TRUE                  27080007
245000                                                                  27090007
245100         WHEN SQLCODE = ZERO                                      27100007
245200         WHEN SQLCODE = +100                                      27110007
245300         WHEN SQLCODE = -305                                      27120007
245400           SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE               27130007
245500           SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE               27140007
245600           INITIALIZE TR006-ERROR-MSG                             27150007
245700                      TR006-UPC-NBR                               27160007
245800           STRING 'CMN-PACK MISSING SPLT-FIX'                     27170007
245900               DELIMITED BY SIZE                                  27180007
246000               INTO TR006-ERROR-MSG                               27190007
246100           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     27200007
246200           PERFORM 8830-WRITE-ERROR-LINE                          27210007
246300           SET PS-PROBLEM-DO-NOT-SEND TO TRUE                     27220007
246400                                                                  27230007
246500         WHEN OTHER                                               27240007
246600             DISPLAY '** ABEND **'                                27250007
246700             DISPLAY '** PROGRAM = TRKUP008 **'                   27260007
246800             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          27270007
246900             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      27280007
247000             DISPLAY '** PREPACK ID    = ' POPRPK-PO-PREPK-ID     27290007
247100             DISPLAY '** PARA = 2384-COUNT-DCS-FOR-PACK'          27300007
247200             PERFORM 9100-SQL-ABEND                               27310007
247300     END-EVALUATE.                                                27320007
247400                                                                  27330007
247500******************************************************************27340007
247600                                                                  27350007
247700 2390-COMPUTE-HOW-MANY-LBLS-PDC.                                  27360007
247800                                                                  27370007
247900      IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC               27380007
248000        MOVE TR004-PDC-CART-CT TO PV-NBR-CART-LBLS-THIS-DC        27390007
248100      ELSE                                                        27400007
248200         COMPUTE PV-NBR-CART-LBLS-THIS-DC ROUNDED =               27410007
248300          (PV-NBR-CART-LBLS-UPC * PA-TTL-PCK-SPLIT-QTY-DC-PCT)    27420007
248400      END-IF.                                                     27430007
248500                                                                  27440007
248600      ADD PV-NBR-CART-LBLS-THIS-DC                                27450007
248700                               TO PV-TTL-CART-LBLS-ALL-DCS.       27460007
248800                                                                  27470007
248900******************************************************************27480007
249000                                                                  27490007
249100 2392-COMPUTE-PDC-NO-LABELS.                                      27500007
249200                                                                  27510007
249300      IF PV-NBR-CART-LBLS-THIS-DC > TR004-PDC-CART-CT             27520007
249400        MOVE ZERO TO TR004-PDC-NO-LBL-CART-CT                     27530007
249500      ELSE                                                        27540007
249600        COMPUTE TR004-PDC-NO-LBL-CART-CT =                        27550007
249700          (TR004-PDC-CART-CT - PV-NBR-CART-LBLS-THIS-DC)          27560007
249800      END-IF.                                                     27570007
249900                                                                  27580007
250000******************************************************************27590007
250100                                                                  27600007
250200 2394-CREATE-PCT-CARTON-LABELS.                                   27610007
250300                                                                  27620007
250400      MOVE ZERO TO PV-CARTON-ROWS-FETCHED.                        27630007
250500                                                                  27640007
250600      PERFORM UNTIL PV-CARTON-ROWS-FETCHED =                      27650007
250700                              PV-NBR-CART-LBLS-THIS-DC            27660007
250800                 OR PS-EOC-CART-LABEL-CURSOR                      27670007
250900         PERFORM 8756-FETCH-CART-LABEL-CURSOR                     27680007
251000         EVALUATE TRUE                                            27690007
251100           WHEN PS-EOC-CART-LABEL-CURSOR                          27700007
251200**              SOME KIND OF ERROR ?                              27710007
251300              CONTINUE                                            27720007
251400           WHEN OTHER                                             27730007
251500               ADD +1 TO PV-CARTON-ROWS-FETCHED                   27740007
251600               INITIALIZE TR004-REC-TYPE-PACK-CARTON              27750007
251700               MOVE TRT00008-SSCC-ID (1:20)                       27760007
251800                               TO TR004-PCT-SSCC-ID (1:20)        27770007
251900               MOVE TRT00008-UNT-QTY                              27780007
252000                               TO TR004-PCT-CARTON-UNIT-QTY       27790007
252100               PERFORM 5720-WRITE-PCT-RECORD                      27800007
252200           END-EVALUATE                                           27810007
252300      END-PERFORM.                                                27820007
252400                                                                  27830007
252500 EJECT                                                            27840007
252600******************************************************************27850007
252700 2400-PROCESS-UPC-FOR-BULK.                                       27860007
252800                                                                  27870007
252900     PERFORM 8400-FETCH-BULK-UPC-CUR.                             27880007
253000                                                                  27890007
253100     IF PS-EOC-BULK-UPC-CUR                                       27900007
253200         PERFORM 8300-CLOSE-BULK-UPC-CUR                          27910007
253300     ELSE                                                         27920007
253400       SET PS-ZERO-OUTR-PACK-QTY-NO   TO TRUE                     27930007
253500**GB 3/25/12  PERFORM 2420-SELECT-VEND-OUTR-PACK-QTY              27940007
253600                                                                  27950007
253700       SET PS-UPC-PASSESED-EDITS      TO TRUE                     27960007
253800       PERFORM 2405-BULK-UPC-EDITS                                27970007
253900                                                                  27980007
254000       IF PS-UPC-PASSESED-EDITS                                   27990007
254100                                                                  28000007
254200           INITIALIZE TR004-REC-TYPE-UPC                          28010007
254300           MOVE IMCNUP-UPC-UNT-QTY      TO TR004-UPC-UNIT-QTY     28020007
139868                                           PV-HOLD-PCK-UNIT-QTY   28030035
254400           MOVE IMCNUP-UPC-CBMT-QTY     TO TR004-UPC-CBMT-QTY     28040007
254500           MOVE IMCNUP-UPC-WT-KGRM-QTY  TO TR004-UPC-WT-KGRM-QTY  28050007
254600           MOVE IMCNUP-UPC-NBR          TO TR004-UPC-NBR          28060007
254700           MOVE XLT00004-VS-NBR         TO TR004-VEND-STYL-NAME   28070007
254800           MOVE XLT00003-NRF-CLOR-CDE   TO TR004-UPC-COLOR-CDE    28080007
254900           MOVE XLT00003-CSTM-CLOR-DESC TO TR004-UPC-COLOR-DESC   28090007
255000           MOVE XLT00003-SIZE-DESC      TO TR004-UPC-SIZE-DESC    28100007
255100           MOVE XLT00003-SKU-DESC       TO TR004-SKU-DESC         28110007
255200           MOVE SKXREF-DEPT             TO TR004-DEPT-NBR         28120007
255300           MOVE SKXREF-CLASS            TO TR004-CLASS            28130007
255400           MOVE SKXREF-SUBCLASS         TO TR004-SUB-CLASS        28140007
255500           MOVE SKXREF-SKU              TO TR004-SKU-SEQ-NBR      28150007
255600***        ****************************************               28160007
255700***        * REMOVE THIS MESSAGE 9/9/03 UNTIL ALL *               28170007
255800***        * CONSOL START SENDING SKUS.           *               28180007
255900***        ****************************************               28190007
256000***        IF SKXREF-SKU = IMCNUP-SKU-NBR                         28200007
256100***          CONTINUE                                             28210007
256200***        ELSE                                                   28220007
256300***            SET TR006-ERROR-TYPE-ERROR       TO TRUE           28230007
256400***            INITIALIZE TR006-ERROR-MSG                         28240007
256500***            STRING 'CMN-BULK SKU NOT FOUND'                    28250007
256600***                DELIMITED BY SIZE                              28260007
256700***                INTO TR006-ERROR-MSG                           28270007
256800***            MOVE IMCNUP-SKU-NBR   TO TR006-SKU                 28280007
256900***            PERFORM 8830-WRITE-ERROR-LINE                      28290007
257000***        END-IF                                                 28300007
257100                                                                  28310007
257200           IF  IMCNUP-UPC-UNT-QTY   = ZERO                        28320007
257300            OR IMCNUP-UPC-CART-CNT = ZERO                         28330007
257400              MOVE PURITM-OUTR-PK-QTY  TO TR004-OUTR-PK-QTY       28340007
139868                                          PV-HOLD-PCK-CART-CT     28350035
257500           ELSE                                                   28360007
257600              DIVIDE IMCNUP-UPC-CART-CNT                          28370007
257700                  INTO IMCNUP-UPC-UNT-QTY                         28380007
257800                   GIVING TR004-OUTR-PK-QTY ROUNDED               28390007
139868              MOVE TR004-OUTR-PK-QTY   TO PV-HOLD-PCK-CART-CT     28400035
257900           END-IF                                                 28410007
258000                                                                  28420007
258100           MOVE ZERO                   TO TR004-PACK-RATIO-QTY    28430007
258200                                                                  28440007
258300           PERFORM 2430-GET-CARTON-LABEL-DATA                     28450007
258400           IF IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC          28460007
258500             MOVE ZERO TO TR004-UPC-NO-LBL-CART-CT                28470007
258600           ELSE                                                   28480007
258700             COMPUTE TR004-UPC-NO-LBL-CART-CT =                   28490007
258800               (IMCNUP-UPC-CART-CNT - PV-NBR-CART-LBLS-UPC)       28500007
258900           END-IF                                                 28510007
259000                                                                  28520007
259100           PERFORM 5600-WRITE-PUR-ORDER-UPC-REC                   28530007
259200                                                                  28540007
259300           SET PS-CURR-SPLIT-QTY-PRESENT-NO   TO TRUE             28550007
259400***        SET PS-ORDERED-EQUALS-SHIPPED-NO   TO TRUE             28560007
259500           PERFORM 2520-SUM-DC-SPLIT-QTY                          28570007
259600           IF PS-CURR-SPLIT-QTY-PRESENT                           28580007
259700             SET PS-COUNT-DCS-OK-NO           TO TRUE             28590007
259800             PERFORM 2525-COUNT-DCS-FOR-THIS-UPC                  28600018
259900           END-IF                                                 28610007
260000                                                                  28620007
260100           IF PS-CURR-SPLIT-QTY-PRESENT                           28630007
260200            AND PS-COUNT-DCS-OK                                   28640007
260300              SET PS-FIRST-DC                 TO TRUE             28650007
139868              SET PS-OUTLET-STORE-NO          TO TRUE             28660035
260400              SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE             28670007
260500              IF PV-NBR-CART-LBLS-UPC > ZERO                      28680007
260600                PERFORM 8758-OPEN-CART-LABEL-CURSOR               28690007
260700                SET PS-EOC-CART-LABEL-CURSOR-NO TO TRUE           28700007
260800              END-IF                                              28710007
260900              PERFORM 8500-OPEN-DC-CURSOR                         28720007
261000              PERFORM 2500-PROCESS-DC-CURSOR                      28730007
261100                UNTIL PS-EOC-DC-CURSOR                            28740007
261200              SET PS-EOC-DC-CURSOR-NO TO TRUE                     28750007
261300              IF PV-NBR-CART-LBLS-UPC > ZERO                      28760007
261400                PERFORM 8760-CLOSE-CART-LABEL-CURSOR              28770007
261500              END-IF                                              28780007
261600           END-IF                                                 28790007
261700                                                                  28800007
261800       END-IF                                                     28810007
261900                                                                  28820007
262000     END-IF.                                                      28830007
262100                                                                  28840007
262200******************************************************************28850007
262300 2405-BULK-UPC-EDITS.                                             28860007
262400                                                                  28870007
262500       SET PS-ZERO-OUTR-PACK-QTY-NO   TO TRUE.                    28880007
262600**GB 3/26/12 PERFORM 2420-SELECT-VEND-OUTR-PACK-QTY.              28890007
262610       PERFORM 2420-EDIT-VEND-OUTR-PACK-QTY.                      28900007
262700                                                                  28910007
262800       EVALUATE TRUE                                              28920007
262900                                                                  28930007
263000         WHEN PS-ZERO-OUTR-PACK-QTY                               28940007
263100             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                28950007
263200                                                                  28960007
263300         WHEN IMCNUP-ASN-PKGNG-CDE   NOT =    'EA'                28970007
263400               INITIALIZE TR006-ERROR-MSG                         28980007
263500               SET TR006-ERROR-TYPE-ERROR       TO TRUE           28990007
263600               MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR             29000007
263700               MOVE IMCNUP-SKU-NBR   TO TR006-SKU                 29010007
263800               STRING 'CMN-BULK HAS PCK ASN PKG CDE-FIX'          29020007
263900                   DELIMITED BY SIZE                              29030007
264000                   INTO TR006-ERROR-MSG                           29040007
264100               PERFORM 8830-WRITE-ERROR-LINE                      29050007
264200               SET PS-PROBLEM-DO-NOT-SEND TO TRUE                 29060007
264300               SET PS-UPC-PASSESED-EDITS-NO  TO TRUE              29070007
264400                                                                  29080007
264500         WHEN IMCNUP-UPC-CART-CNT = ZERO                          29090007
264600            AND IMCNUP-UPC-UNT-QTY < PURITM-OUTR-PK-QTY           29100007
264700             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                29110007
264800             MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                29120007
264900             MOVE IMCNUP-SKU-NBR  TO TR006-SKU                    29130007
265000             SET TR006-ERROR-TYPE-ERROR       TO TRUE             29140007
265100             INITIALIZE TR006-ERROR-MSG                           29150007
265200             STRING 'CMN-BULK UNITS<OUTR PACK QTY-FIX'            29160007
265300                 DELIMITED BY SIZE                                29170007
265400                 INTO TR006-ERROR-MSG                             29180007
265500             PERFORM 8830-WRITE-ERROR-LINE                        29190007
265600             SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            29200007
265700                                                                  29210007
265800                                                                  29220007
265900         WHEN IMCNUP-UPC-UNT-QTY > ZERO                           29230007
266000          AND IMCNUP-UPC-UNT-QTY < IMCNUP-UPC-CART-CNT            29240007
266100             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                29250007
266200             MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                29260007
266300             MOVE IMCNUP-SKU-NBR  TO TR006-SKU                    29270007
266400             SET TR006-ERROR-TYPE-ERROR       TO TRUE             29280007
266500             INITIALIZE TR006-ERROR-MSG                           29290007
266600             STRING 'CMN-BLK UNTS LESS THAN CRTNS-FIX'            29300007
266700                 DELIMITED BY SIZE                                29310007
266800                 INTO TR006-ERROR-MSG                             29320007
266900             PERFORM 8830-WRITE-ERROR-LINE                        29330007
267000             SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            29340007
267100                                                                  29350007
267200         WHEN OTHER                                               29360007
267300           SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                 29370007
267400           PERFORM 2410-SELECT-E-COM-DCS                          29380007
267500                                                                  29390007
267600           IF PS-THERE-ARE-E-COM-DCS                              29400007
267700             SET PS-THIS-IS-E-COM-UPC-NO   TO TRUE                29410007
267800             PERFORM 2415-SELECT-UPC-FROM-TWEBITM                 29420007
267900                                                                  29430007
268000             IF PS-THIS-IS-E-COM-UPC                              29440007
268100               CONTINUE                                           29450007
268200             ELSE                                                 29460007
268300                 INITIALIZE TR006-ERROR-MSG                       29470007
268400                 MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR            29480007
268500                 SET TR006-ERROR-TYPE-ERROR       TO TRUE         29490007
268600                 STRING 'CMN-HAS E-COM DC-NOT E-COM SKU'          29500007
268700                     DELIMITED BY SIZE                            29510007
268800                     INTO TR006-ERROR-MSG                         29520007
268900                 PERFORM 8830-WRITE-ERROR-LINE                    29530007
269000                 SET PS-PROBLEM-DO-NOT-SEND TO TRUE               29540007
269100                 SET PS-UPC-PASSESED-EDITS-NO  TO TRUE            29550007
269200             END-IF                                               29560007
269300           END-IF                                                 29570007
269400                                                                  29580007
269500       END-EVALUATE.                                              29590007
269600                                                                  29600007
269700******************************************************************29610007
269800 2410-SELECT-E-COM-DCS.                                           29620007
269900*                                                                 29630007
270000     INITIALIZE PV-NBR-OF-E-COM-DCS.                              29640007
270100*                                                                 29650007
270200     EXEC SQL                                                     29660007
270300           SELECT                                                 29670007
270400                   COUNT(*)                                       29680007
270500             INTO                                                 29690007
270600                  :PV-NBR-OF-E-COM-DCS                            29700007
270700             FROM                                                 29710007
270800                  TUPCSKU   SKU                                   29720007
270900                 ,TPURITM   PUR                                   29730007
271000                 ,TALLPLN   AL                                    29740007
271100*FJW 03/10/10 BEGIN                                               29750007
271110                 ,XLT_LOC   LOC                                   29760007
271120*FJW 03/10/10 END                                                 29770007
271130             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           29780007
271140               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             29790007
271150               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            29800007
271160               AND PUR.PO_LNE_NBR     = :PURITM-PO-LNE-NBR        29810007
271170               AND PUR.VER_STATUS_CDE = 'A'                       29820007
271180               AND PUR.STATUS_CDE    IN ('AC', 'AP')              29830007
271190               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           29840007
271200               AND AL.PO_NBR          =  PUR.PO_NBR               29850007
271300               AND AL.CURR_SPLIT_QTY  >  0                        29860007
271400*FJW 03/10/10 BEGIN                                               29870007
271500*              AND AL.DEST_NBR        =  870                      29880007
271600               AND AL.DEST_NBR        =  LOC.LOC_NBR              29890007
271700               AND LOC.LOC_TYP_CDE    = 'DC'                      29900007
271800               AND LOC.E_BUS_IND      = 'Y'                       29910007
271900*FJW 03/10/10 END                                                 29920007
272000     END-EXEC                                                     29930007
272100                                                                  29940007
272200     EVALUATE TRUE                                                29950007
272300         WHEN SQLCODE = ZERO                                      29960007
272400         WHEN SQLCODE = -811                                      29970007
272500            IF PV-NBR-OF-E-COM-DCS > 0                            29980007
272600              SET PS-THERE-ARE-E-COM-DCS  TO TRUE                 29990007
272700            END-IF                                                30000007
272800                                                                  30010007
272900         WHEN SQLCODE = +100                                      30020007
273000              CONTINUE                                            30030007
273100                                                                  30040007
273200         WHEN SQLWARN0 NOT EQUAL SPACE                            30050007
273300         WHEN SQLCODE NOT EQUAL ZERO                              30060007
273400             DISPLAY '** ABEND **'                                30070007
273500             DISPLAY '** PROGRAM = TRKUP008 **'                   30080007
273600             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          30090007
273700             DISPLAY '** IMCNUP-UPC-NBR = '                       30100007
273800                 IMCNUP-UPC-NBR                                   30110007
273900             DISPLAY '** PARAGRAPH = 2410-SELECT-E-COM-DCS'       30120007
274000             PERFORM 9100-SQL-ABEND                               30130007
274100     END-EVALUATE.                                                30140007
274200                                                                  30150007
274300******************************************************************30160007
274400 2415-SELECT-UPC-FROM-TWEBITM.                                    30170007
274500*                                                                 30180007
274600     INITIALIZE PV-NBR-OF-E-COM-ROWS.                             30190007
274700*                                                                 30200007
274800     EXEC SQL                                                     30210007
274900           SELECT COUNT (*)                                       30220007
275000           INTO   :PV-NBR-OF-E-COM-ROWS                           30230007
275100           FROM TUPCPLS A                                         30240007
275200              , TWEBITM B                                         30250007
275300              , TUPCSKU   SKU                                     30260007
275400              , TPURITM   PUR                                     30270007
275500             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           30280007
275600               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             30290007
275700               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            30300007
275800               AND PUR.VER_STATUS_CDE = 'A'                       30310007
275900               AND PUR.STATUS_CDE    IN ('AC', 'AP')              30320007
276000               AND A.ITM_NBR          =  PUR.ITM_NBR              30330007
276100               AND A.OPERCO_NBR    = '03'                         30340007
276200               AND A.STR_NBR       = 0                            30350007
276300               AND ((A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      30360007
276400                       A.EFF_END_TMST IS NULL) OR                 30370007
276500                      (A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND    30380007
276600                       A.EFF_END_TMST  > CURRENT TIMESTAMP))      30390007
276700               AND A.UPC_ID        = B.INTR_UPC_ID                30400007
276800               AND (B.EFF_BEG_TMST <= CURRENT TIMESTAMP AND       30410007
276900                         B.EFF_END_TMST IS NULL)                  30420007
277000     END-EXEC                                                     30430007
277100                                                                  30440007
277200     EVALUATE TRUE                                                30450007
277300         WHEN SQLCODE = ZERO                                      30460007
277400         WHEN SQLCODE = -811                                      30470007
277500            IF PV-NBR-OF-E-COM-ROWS > 0                           30480007
277600              SET PS-THIS-IS-E-COM-UPC    TO TRUE                 30490007
277700            END-IF                                                30500007
277800                                                                  30510007
277900         WHEN SQLCODE = +100                                      30520007
278000              CONTINUE                                            30530007
278100                                                                  30540007
278200         WHEN SQLWARN0 NOT EQUAL SPACE                            30550007
278300         WHEN SQLCODE NOT EQUAL ZERO                              30560007
278400             DISPLAY '** ABEND **'                                30570007
278500             DISPLAY '** PROGRAM = TRKUP008 **'                   30580007
278600             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          30590007
278700             DISPLAY '** IMCNUP-UPC-NBR = '                       30600007
278800                 IMCNUP-UPC-NBR                                   30610007
278900             DISPLAY '** PARAGRAPH = 2415-SELECT-UPC-FROM-TWEBITM'30620007
279000             PERFORM 9100-SQL-ABEND                               30630007
279100     END-EVALUATE.                                                30640007
279200                                                                  30650007
279300******************************************************************30660007
279400*2420-SELECT-VEND-OUTR-PACK-QTY.                                  30670007
279500*                                                                 30680007
279600*    EXEC SQL                                                     30690007
279700*          SELECT                                                 30700007
279800*                 UPC.OUTR_PK_QTY                                 30710007
279900*            INTO                                                 30720007
280000*                 :UPC-OUTR-PK-QTY                                30730007
280100*            FROM                                                 30740007
280200*                 TSKXREF  SKX                                    30750007
280300*                ,TUPC     UPC                                    30760007
280400*          WHERE  SKX.ITM_NBR      =  :PURITM-ITM-NBR             30770007
280500*            AND  SKX.INTR_UPC_ID  =  UPC.INTR_UPC_ID             30780007
280600*            AND  UPC.UPC_TYP_CDE  = 'I'                          30790007
280700*    END-EXEC                                                     30800007
280800*                                                                 30810007
280900*    EVALUATE TRUE                                                30820007
281000*        WHEN SQLCODE = ZERO                                      30830007
281100*            IF UPC-OUTR-PK-QTY = ZERO                            30840007
281200*                INITIALIZE TR006-ERROR-MSG                       30850007
281300*                MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR            30860007
281400*                SET TR006-ERROR-TYPE-ERROR       TO TRUE         30870007
281500*                STRING 'CMN-ZERO OTR PK QTY-FIX'                 30880007
281600*                    DELIMITED BY SIZE                            30890007
281700*                    INTO TR006-ERROR-MSG                         30900007
281800*                PERFORM 8830-WRITE-ERROR-LINE                    30910007
281900*                SET PS-PROBLEM-DO-NOT-SEND TO TRUE               30920007
282000*                SET PS-ZERO-OUTR-PACK-QTY     TO TRUE            30930007
282100*            END-IF                                               30940007
282200*                                                                 30950007
282300*        WHEN SQLCODE = +100                                      30960007
282400*            MOVE 0 TO UPC-OUTR-PK-QTY                            30970007
282500*            MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                30980007
282600*            SET TR006-ERROR-TYPE-ERROR       TO TRUE             30990007
282700*            INITIALIZE TR006-ERROR-MSG                           31000007
282800*            STRING 'CMN-SKU OUTR PK QTY NT FOUND-FIX'            31010007
282900*                DELIMITED BY SIZE                                31020007
283000*                INTO TR006-ERROR-MSG                             31030007
283100*            PERFORM 8830-WRITE-ERROR-LINE                        31040007
283200*            SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            31050007
283300*            SET PS-ZERO-OUTR-PACK-QTY         TO TRUE            31060007
283400*                                                                 31070007
283500*        WHEN SQLWARN0 NOT EQUAL SPACE                            31080007
283600*        WHEN SQLCODE NOT EQUAL ZERO                              31090007
283700*            DISPLAY '** ABEND **'                                31100007
283800*            DISPLAY '** PROGRAM = TRKUP008 **'                   31110007
283900*            DISPLAY '** PARAGRAPH = 2420-SEL-VEND-OUTR-PACK-QTY*'31120007
284000*            DISPLAY '** PURITM-ITM-NBR = ' PURITM-ITM-NBR        31130007
284100*            DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          31140007
284200*            DISPLAY '** PURITM-PO-LNE-NBR = '                    31150007
284300*                 PURITM-PO-LNE-NBR                               31160007
284400*            PERFORM 9100-SQL-ABEND                               31170007
284500*    END-EVALUATE.                                                31180007
284600*                                                                 31190007
284610 2420-EDIT-VEND-OUTR-PACK-QTY.                                    31200007
284620                                                                  31210007
284630      IF PURITM-OUTR-PK-QTY = ZERO                                31220007
284640          INITIALIZE TR006-ERROR-MSG                              31230007
284650          MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                      31240007
284660          MOVE SKXREF-SKU   TO TR006-SKU                          31250007
284670          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 31260007
284680          STRING 'BULK-ZERO OUTR PCK QTY-FIX'                     31270007
284690              DELIMITED BY SIZE                                   31280007
284691              INTO TR006-ERROR-MSG                                31290007
284692          PERFORM 8830-WRITE-ERROR-LINE                           31300007
284693          SET PS-PROBLEM-DO-NOT-SEND    TO TRUE                   31310007
284694          SET PS-ZERO-OUTR-PACK-QTY     TO TRUE                   31320007
284695      END-IF.                                                     31330007
284702                                                                  31340007
284710******************************************************************31350007
284800* CARTON LABEL MAIN PROCESS                                      *31360007
284900******************************************************************31370007
285000                                                                  31380007
285100 2430-GET-CARTON-LABEL-DATA.                                      31390007
285200                                                                  31400007
285300     INITIALIZE PV-LABEL-WORK-FIELDS.                             31410007
285400     PERFORM 2445-SELECT-CART-LBL-CNT.                            31420007
285500                                                                  31430007
285600     EVALUATE TRUE                                                31440007
285700                                                                  31450007
285800       WHEN PV-NBR-CART-LBLS-UPC = ZERO                           31460007
285900           CONTINUE                                               31470007
286000       WHEN IMCNUP-UPC-CART-CNT   NOT =   PV-NBR-CART-LBLS-UPC    31480007
286100           PERFORM 2435-CARTON-LABEL-EDITS                        31490007
286200                                                                  31500007
286300     END-EVALUATE.                                                31510007
286400                                                                  31520007
286500******************************************************************31530007
286600* CARTON LABEL EDITS FOR BULK OR PACKS                           *31540007
286700******************************************************************31550007
286800                                                                  31560007
286900 2435-CARTON-LABEL-EDITS.                                         31570007
287000                                                                  31580007
287100     MOVE IMCNPO-PO-NBR          TO TR006-PO-NBR.                 31590007
287200     MOVE IMCNUP-UPC-NBR         TO TR006-UPC-NBR.                31600007
287300     MOVE IMCNUP-SKU-NBR         TO TR006-SKU.                    31610007
287400     SET TR006-ERROR-TYPE-ERROR  TO TRUE.                         31620007
287500     INITIALIZE TR006-ERROR-MSG.                                  31630007
287600                                                                  31640007
287700     EVALUATE TRUE                                                31650007
287800                                                                  31660007
287900*     *** PACKS ***                                               31670007
288000      WHEN PURCHS-PKGNG-CDE = PC-M OR PC-I                        31680007
288100       MOVE POPRPK-PO-PREPK-ID     TO TR006-PACK-ID               31690007
288200       EVALUATE TRUE                                              31700007
288300          WHEN IMCNUP-UPC-CART-CNT > PV-NBR-CART-LBLS-UPC         31710007
288400              STRING 'CMN-PCK UPC CTN CT>TOTL SSCC IDS'           31720007
288500                    DELIMITED BY SIZE                             31730007
288600              INTO TR006-ERROR-MSG                                31740007
288700          WHEN IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC         31750007
288800              STRING 'CMN-PCK UPC CTN CT<TOTL SSCC IDS'           31760007
288900                    DELIMITED BY SIZE                             31770007
289000              INTO TR006-ERROR-MSG                                31780007
289100       END-EVALUATE                                               31790007
289200                                                                  31800007
289300*     *** BULK ***                                                31810007
289400      WHEN OTHER                                                  31820007
289500       EVALUATE TRUE                                              31830007
289600        WHEN IMCNUP-UPC-CART-CNT > PV-NBR-CART-LBLS-UPC           31840007
289700            STRING 'CMN-BLK UPC CTN CT>TOTL SSCC IDS'             31850007
289800                  DELIMITED BY SIZE                               31860007
289900            INTO TR006-ERROR-MSG                                  31870007
290000        WHEN IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC           31880007
290100            STRING 'CMN-BLK UPC CTN CT<TOTL SSCC IDS'             31890007
290200                  DELIMITED BY SIZE                               31900007
290300            INTO TR006-ERROR-MSG                                  31910007
290400       END-EVALUATE                                               31920007
290500                                                                  31930007
290600     END-EVALUATE.                                                31940007
290700                                                                  31950007
290800     PERFORM 8830-WRITE-ERROR-LINE.                               31960007
290900                                                                  31970007
291000******************************************************************31980007
291100*FJW 03/10/10 BEGIN                                               31990007
291200*2440-NO-CART-LABELS-MSG.                                         32000007
291300*                                                                 32010007
291400*    MOVE IMCNPO-PO-NBR          TO TR006-PO-NBR.                 32020007
291500*    MOVE IMCNUP-UPC-NBR         TO TR006-UPC-NBR.                32030007
291600*    MOVE IMCNUP-SKU-NBR         TO TR006-SKU.                    32040007
291700*    SET TR006-ERROR-TYPE-ERROR  TO TRUE.                         32050007
291800*    INITIALIZE TR006-ERROR-MSG.                                  32060007
291900*    IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           32070007
292000*      MOVE POPRPK-PO-PREPK-ID     TO TR006-PACK-ID               32080007
292100*      STRING 'CMN-FCTRY LBLS BUT NO CRTNS SNT'                   32090007
292200*         DELIMITED BY SIZE                                       32100007
292300*          INTO TR006-ERROR-MSG                                   32110007
292400*    ELSE                                                         32120007
292500*      STRING 'CMN-FCTRY LBLS BUT NO CRTNS SNT'                   32130007
292600*         DELIMITED BY SIZE                                       32140007
292700*          INTO TR006-ERROR-MSG                                   32150007
292800*    END-IF.                                                      32160007
292900*                                                                 32170007
293000*    PERFORM 8830-WRITE-ERROR-LINE.                               32180007
293100*FJW 03/10/10 END                                                 32190007
293200******************************************************************32200007
293300                                                                  32210007
293400 2445-SELECT-CART-LBL-CNT.                                        32220007
293500                                                                  32230007
293600     EXEC SQL                                                     32240007
293700           SELECT COUNT (*)                                       32250007
293800             INTO :PV-NBR-CART-LBLS-UPC                           32260007
293900             FROM TRT_IMPRT_CART                                  32270007
294000            WHERE CONTNR_ID      = :IMCNTK-CONTNR-ID              32280007
294100              AND CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR         32290007
294200              AND PO_NBR         = :IMCNPO-PO-NBR                 32300007
294300              AND UPC_NBR        = :IMCNUP-UPC-NBR                32310007
294400     END-EXEC                                                     32320007
294500                                                                  32330007
294600     EVALUATE TRUE                                                32340007
294700         WHEN SQLCODE = ZERO                                      32350007
294800             CONTINUE                                             32360007
294900                                                                  32370007
295000         WHEN SQLCODE = +100                                      32380007
295100             MOVE 0 TO PV-NBR-CART-LBLS-UPC                       32390007
295200                                                                  32400007
295300         WHEN SQLWARN0 NOT EQUAL SPACE                            32410007
295400         WHEN SQLCODE NOT EQUAL ZERO                              32420007
295500             DISPLAY '** ABEND **'                                32430007
295600             DISPLAY '** PROGRAM = TRKUP008 **'                   32440013
295700             DISPLAY '** PARAGRAPH = 2445-SELECT-CART-LBL-CNT'    32450007
295800             DISPLAY '** IMCNTK-CONTNR-ID      ' IMCNTK-CONTNR-ID 32460007
295900             DISPLAY '** IMCNPO-PO-NBR         '    IMCNPO-PO-NBR 32470007
296000             DISPLAY '** IMCNUP-UPC-NBR        '   IMCNUP-UPC-NBR 32480007
296100             PERFORM 9100-SQL-ABEND                               32490007
296200     END-EVALUATE.                                                32500007
296300                                                                  32510007
296400******************************************************************32520007
296500 2480-PROCESS-PREPACK-UPC.                                        32530007
296600                                                                  32540007
296700     PERFORM 8460-FETCH-PACK-UPC-CURSOR.                          32550007
296800                                                                  32560007
296900     IF PS-EOC-PREPACK-UPC-CURSOR                                 32570007
297000       PERFORM 8455-CLOSE-PACK-UPC-CURSOR                         32580007
297100     ELSE                                                         32590007
297200       INITIALIZE TR004-REC-TYPE-UPC                              32600007
297300       MOVE TUPCSKU-UPC-NBR         TO TR004-UPC-NBR              32610007
297400       MOVE XLT00004-VS-NBR         TO TR004-VEND-STYL-NAME       32620007
297500       MOVE XLT00003-NRF-CLOR-CDE   TO TR004-UPC-COLOR-CDE        32630007
297600       MOVE XLT00003-CSTM-CLOR-DESC TO TR004-UPC-COLOR-DESC       32640007
297700       MOVE XLT00003-SIZE-DESC      TO TR004-UPC-SIZE-DESC        32650007
297800       MOVE XLT00003-SKU-DESC       TO TR004-SKU-DESC             32660007
297900       MOVE SKXREF-DEPT             TO TR004-DEPT-NBR             32670007
298000       MOVE SKXREF-CLASS            TO TR004-CLASS                32680007
298100       MOVE SKXREF-SUBCLASS         TO TR004-SUB-CLASS            32690007
298200       MOVE SKXREF-SKU              TO TR004-SKU-SEQ-NBR          32700007
298300       MOVE 1                       TO TR004-OUTR-PK-QTY          32710007
298400                                                                  32720007
298500*      ***************************************************        32730007
298600*      * PURITM UNIT QUANTITY IS FOR THE PO/LINE WHICH   *        32740007
298700*      * WE ARE UNABLE TO BREAK DOWN BY CONTAINER. UPC   *        32750007
298800*      * UNITS WILL THEREFORE APPEAR TO BE HIGH IF THE   *        32760007
298900*      * PO IS ON MULTIPLE CONTAINERS.                   *        32770007
299000*      *                                                 *        32780007
299100*      * TO AVOID CONFUSION WE DON'T THE CALC PACK'S     *        32790007
299200*      * COMPONANT QTYS BECAUSE:                         *        32800007
299300*      * 1. ROUNDING IS IMPOSSIBLE TO RECONCILE FOR UPCS *        32810007
299400*      *    THAT ARE SUPPOSE TO BE IN A RATIO WITHIN A   *        32820007
299500*      *    PACK.                                        *        32830007
299600*      * 2. IF SENT AS A BULK THE COMPONENT UPC QTYS     *        32840007
299700*      *    COULD BE DIFFERENT THEN THE ORDERED QTYS.    *        32850007
299800*      ***************************************************        32860007
299900       MOVE PURITM-UNT-QTY          TO TR004-UPC-UNIT-QTY         32870007
300000*      ***************************************************        32880007
300100                                                                  32890007
300200** BUD*IF PURCHS-PKGNG-CDE = PC-M                                 32900009
300200       IF POPRPK-PREPK-TYP-CDE = PC-M                             32910009
300300          MOVE PURITM-PREPK-RATO-QTY  TO TR004-PACK-RATIO-QTY     32920007
300400       ELSE                                                       32930007
300500          IF POPRPK-INPK-UNT-QTY = ZERO                           32940007
300600            MOVE ZERO TO TR004-PACK-RATIO-QTY                     32950007
300700            PERFORM 2482-INPK-ZERO-ERROR                          32960007
300800          ELSE                                                    32970007
300900            COMPUTE  TR004-PACK-RATIO-QTY =                       32980007
301000                 (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY) *    32990007
301100                    PURITM-PREPK-RATO-QTY                         33000007
301200          END-IF                                                  33010007
301300       END-IF                                                     33020007
301400                                                                  33030007
301500       PERFORM 5600-WRITE-PUR-ORDER-UPC-REC                       33040007
301600                                                                  33050007
301700     END-IF.                                                      33060007
301800                                                                  33070007
301900******************************************************************33080007
302000*  ONLY PRINT THE MESSAGE ONCE PER PO/PACK ID COMBO.              33090007
302100******************************************************************33100007
302200 2482-INPK-ZERO-ERROR.                                            33110007
302300                                                                  33120007
302400     IF PV-HOLD-PO-PREPK-PO = TR006-PO-NBR                        33130007
302500       AND PV-HOLD-PO-PREPK-ID = TR006-PACK-ID                    33140007
302600         CONTINUE                                                 33150007
302700     ELSE                                                         33160007
302800         SET TR006-ERROR-TYPE-ERROR   TO TRUE                     33170007
302900         INITIALIZE TR006-ERROR-MSG                               33180007
303000         STRING 'CMN-POPRPK-INPK-UNT-QY FLD 0-DTL'                33190007
303100             DELIMITED BY SIZE                                    33200007
303200             INTO TR006-ERROR-MSG                                 33210007
303300         MOVE IMCNUP-SKU-NBR   TO TR006-SKU                       33220007
303400         PERFORM 8830-WRITE-ERROR-LINE                            33230007
303500         MOVE TR006-PO-NBR     TO  PV-HOLD-PO-PREPK-PO            33240007
303600         MOVE TR006-PACK-ID    TO  PV-HOLD-PO-PREPK-ID            33250007
303700     END-IF.                                                      33260007
303800                                                                  33270007
303900******************************************************************33280007
304000 2500-PROCESS-DC-CURSOR.                                          33290007
304100                                                                  33300007
304200     PERFORM 8700-FETCH-DC-CURSOR.                                33310007
304300                                                                  33320007
139868     IF PS-EOC-DC-CURSOR                                          33330035
139868        PERFORM 2510-PROCESS-DC-CONTINUE                          33340035
139868     ELSE                                                         33350035
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     33360035
139868        PERFORM 1050-SELECT-OUTLET-PARM                           33370035
139868        IF PS-OUTLET-STORE                                        33380035
139868           SET PS-FIRST-STORE    TO TRUE                          33390035
155029           PERFORM 2522-SUM-STORE-SPLIT-QTY                       33400073
139868           PERFORM 8970-OUTLET-STORE-DC                           33410035
139868        ELSE                                                      33420035
155029           EVALUATE TRUE                                          33430073
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       33440073
155029               AND  PV-FAST-E-BUS-IND = 'N')                      33450073
155029                 IF PS-FIRST-UPC-YES                              33460073
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 33470073
155029                    SET PS-FIRST-STORE    TO TRUE                 33480073
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              33490073
155029                 END-IF                                           33500073
155029                 SET PS-OUTLET-STORE   TO TRUE                    33510073
155029                 PERFORM 8970-OUTLET-STORE-DC                     33520073
155029                                                                  33530073
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       33540073
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      33550073
155029                 IF PS-FIRST-UPC-YES                              33560073
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 33570073
155029                    SET PS-FIRST-STORE    TO TRUE                 33580073
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              33590073
155029                 END-IF                                           33600073
155029                 SET PS-OUTLET-STORE   TO TRUE                    33610073
155029                 PERFORM 8970-OUTLET-STORE-DC                     33620073
155029                                                                  33630073
155029              WHEN OTHER                                          33640073
139868                 PERFORM 2510-PROCESS-DC-CONTINUE                 33650045
155029           END-EVALUATE                                           33660073
139868        END-IF                                                    33670035
139868     END-IF.                                                      33680035
139868                                                                  33690035
139868******************************************************************33700035
139868 2510-PROCESS-DC-CONTINUE.                                        33710035
139868                                                                  33720035
304400     IF PS-EOC-DC-CURSOR                                          33730007
304500        PERFORM 8600-CLOSE-DC-CURSOR                              33740007
304600        IF PS-DC-SPLIT-INFO-PRESENT                               33750007
139868           IF PS-OUTLET-STORE                                     33760035
139868              CONTINUE                                            33770035
139868           ELSE                                                   33780035
304700              PERFORM 2540-ADJUST-ROUNDED-DC-DIST                 33790012
304800              PERFORM 5700-WRITE-DC-RECORD                        33800012
304900              IF PV-NBR-CART-LBLS-UPC > 0                         33810012
305000                PERFORM 2720-CREATE-DC-CARTON-LABELS              33820012
305100              END-IF                                              33830012
139868           END-IF                                                 33840035
305200        END-IF                                                    33850007
305300     ELSE                                                         33860007
305400        IF PS-FIRST-DC                                            33870007
305500          SET PS-FIRST-DC-NO     TO TRUE                          33880007
305600*         ***************************************************     33890007
305700*         * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO        33900007
305800*         * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.         33910007
305900*         ***************************************************     33920007
306000          COMPUTE PV-DCS-TO-SKIP =                                33930007
306100           (IMCNUP-UPC-CART-CNT - PV-TOTAL-NBR-OF-DCS) * (-1)     33940007
306200                                                                  33950007
306300          INITIALIZE PV-TTL-ALL-DCS-PCT                           33960007
306400                     PV-TTL-ALL-DCS-UNITS                         33970007
306500                     PV-TTL-ALL-DCS-CARTS                         33980007
306600        ELSE                                                      33990007
306700*           *******************************************           34000007
306800*           * IF NOT EOC OR FIRST DC, WRITE THE DTL   *           34010007
306900*           * EXTRACT & REPORT RECS FROM THE PRIOR DC *           34020007
307000*           *******************************************           34030007
307100            PERFORM 5700-WRITE-DC-RECORD                          34040007
307200            IF PV-NBR-CART-LBLS-UPC > 0                           34050007
155029            AND PS-BYPASS-CRTN-WRITE-NO                           34060073
307300              PERFORM 2720-CREATE-DC-CARTON-LABELS                34070007
307400            END-IF                                                34080007
307500        END-IF                                                    34090007
155029        IF PV-FAST-E-BUS-IND = 'Y'                                34100073
155029           PERFORM 2520-SUM-DC-SPLIT-QTY                          34110073
155029        END-IF                                                    34120073
307600        INITIALIZE TR004-REC-TYPE-DC                              34130007
307700        MOVE ALLPLN-DEST-NBR     TO TR004-DIST-CNTR               34140007
307800        PERFORM 2530-DC-COMPUTATIONS                              34150007
307900        IF PV-DCS-TO-SKIP  > ZERO                                 34160007
308000          SUBTRACT 1 FROM PV-DCS-TO-SKIP                          34170007
308100        END-IF                                                    34180007
308200     END-IF.                                                      34190007
308300                                                                  34200007
308400******************************************************************34210007
308500 2520-SUM-DC-SPLIT-QTY.                                           34220007
308600*                                                                 34230007
308700     EXEC SQL                                                     34240007
308800           SELECT                                                 34250007
308900                  SUM (AL.CURR_SPLIT_QTY)                         34260007
309000             INTO                                                 34270007
309100                  :PA-TOTAL-CURR-SPLIT-QTY                        34280007
309200             FROM                                                 34290007
309300                  TIMCNUP   CNUP                                  34300007
309400                 ,TUPCSKU   SKU                                   34310007
309500                 ,TPURITM   PUR                                   34320007
309600                 ,TALLPLN   AL                                    34330007
309700             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        34340007
309800               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   34350007
309900               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          34360007
155029               AND CNUP.UPC_NBR        =  SKU.UPC_NBR             34370073
310000               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            34380007
310100               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           34390007
310200               AND PUR.VER_STATUS_CDE  = 'A'                      34400007
310300               AND PUR.STATUS_CDE     IN ('AC', 'AP')             34410007
310400               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          34420007
310500               AND AL.PO_NBR           =  PUR.PO_NBR              34430007
310600               AND AL.CURR_SPLIT_QTY   >  0                       34440007
310700     END-EXEC                                                     34450007
310800                                                                  34460007
310900     EVALUATE TRUE                                                34470007
311000         WHEN SQLCODE = ZERO                                      34480007
311100         WHEN SQLCODE = -305                                      34490007
311200                                                                  34500007
311300             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    34510007
311400              OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC              34520007
311500                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        34530007
311600                 PERFORM 8710-MISSING-SPLIT-ERROR                 34540007
311700             ELSE                                                 34550007
311800                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            34560007
311900             END-IF                                               34570007
312000                                                                  34580007
312100         WHEN SQLCODE = +100                                      34590007
312200             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            34600007
312300             PERFORM 8710-MISSING-SPLIT-ERROR                     34610007
312400                                                                  34620007
312500         WHEN SQLWARN0 NOT EQUAL SPACE                            34630007
312600         WHEN SQLCODE NOT EQUAL ZERO                              34640007
312700             DISPLAY '** ABEND **'                                34650007
312800             DISPLAY '** PROGRAM = TRKUP008 **'                   34660007
312900             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          34670007
313000             DISPLAY '** IMCNUP-UPC-NBR = '                       34680007
313100                 IMCNUP-UPC-NBR                                   34690007
313200             DISPLAY '** PARAGRAPH = 2520-SUM-DC-SPLIT-QTY**'     34700007
313300             PERFORM 9100-SQL-ABEND                               34710007
313400     END-EVALUATE.                                                34720007
313500                                                                  34730007
139868******************************************************************34740035
139868*  RETRIEVE THE TOTAL QUANTITY FOR THE OUTLET STORE               34750035
139868******************************************************************34760035
139868 2522-SUM-STORE-SPLIT-QTY.                                        34770035
139868                                                                  34780035
139868     EXEC SQL                                                     34790035
139868           SELECT SUM (ES.STR_DISTRO_QTY)                         34800035
139868             INTO :PA-TOTAL-CURR-SPLIT-QTY                        34810035
139868             FROM TIMCNUP   CNUP                                  34820035
139868                 ,TUPCSKU   SKU                                   34830035
139868                 ,TPURITM   PUR                                   34840035
139868                 ,TALLPLN   AL                                    34850035
139868                 ,TMESTDS   ES                                    34860035
139868             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        34870035
139868               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   34880035
139868               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          34890035
139868               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            34900035
139868               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           34910035
139868               AND PUR.VER_STATUS_CDE  = 'A'                      34920035
139868               AND PUR.STATUS_CDE     IN ('AC', 'AP')             34930035
139868               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          34940035
139868               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           34950035
139868               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         34960035
139868               AND AL.PO_NBR           =  PUR.PO_NBR              34970035
139868               AND AL.PO_NBR           =  CNUP.PO_NBR             34980035
139868               AND AL.PLAN_NBR         =  ES.PLAN_NBR             34990035
139868               AND PUR.PO_NBR          =  ES.PO_NBR               35000035
139868               AND ES.STR_DISTRO_QTY  >  0                        35010035
139868     END-EXEC                                                     35020035
139868                                                                  35030035
139868     EVALUATE TRUE                                                35040035
139868         WHEN SQLCODE = ZERO                                      35050035
139868         WHEN SQLCODE = -305                                      35060035
139868                                                                  35070035
139868             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    35080035
139868             OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC               35090035
139868                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        35100035
139868                 PERFORM 8710-MISSING-SPLIT-ERROR                 35110035
139868             ELSE                                                 35120035
139868                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            35130035
139868             END-IF                                               35140035
139868                                                                  35150035
139868         WHEN SQLCODE = +100                                      35160035
139868             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            35170035
139868             PERFORM 8710-MISSING-SPLIT-ERROR                     35180035
139868                                                                  35190035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            35200035
139868         WHEN SQLCODE NOT EQUAL ZERO                              35210035
139868             DISPLAY '** ABEND **'                                35220035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   35230035
139868             DISPLAY '** IMCNTK-CONTNR-ID = ' IMCNTK-CONTNR-ID    35240035
139868             DISPLAY '** IMCNTK-CONTNR-SEQ-NBR = '                35250035
139868                                            IMCNTK-CONTNR-SEQ-NBR 35260035
139868             DISPLAY '** IMCNPO-PO-NBR    = ' IMCNPO-PO-NBR       35270035
139868             DISPLAY '** IMCNUP-UPC-NBR   = ' IMCNUP-UPC-NBR      35280035
139868             DISPLAY '** PARAGRAPH = 2522-SUM-STORE-SPLIT-QTY**'  35290035
139868             PERFORM 9100-SQL-ABEND                               35300035
139868     END-EVALUATE.                                                35310035
139868                                                                  35320035
313600******************************************************************35330007
313700 2525-COUNT-DCS-FOR-THIS-UPC.                                     35340007
313800*                                                                 35350007
313900     EXEC SQL                                                     35360007
314000           SELECT                                                 35370007
314100                   COUNT(DISTINCT AL.DEST_NBR)                    35380007
314200             INTO                                                 35390007
314300                  :PV-TOTAL-NBR-OF-DCS                            35400007
314400             FROM                                                 35410007
314500                  TUPCSKU   SKU                                   35420007
314600                 ,TPURITM   PUR                                   35430007
314700                 ,TALLPLN   AL                                    35440007
314800             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           35450007
314900               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             35460007
315000               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            35470007
315100               AND PUR.VER_STATUS_CDE = 'A'                       35480007
315200               AND PUR.STATUS_CDE     IN ('AC', 'AP')             35490007
315300               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           35500007
315400               AND AL.PO_NBR          =  PUR.PO_NBR               35510007
315500               AND AL.CURR_SPLIT_QTY  >  0                        35520007
315600     END-EXEC                                                     35530007
315700                                                                  35540007
315800     EVALUATE TRUE                                                35550007
315900         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS = ZERO       35560007
316000         WHEN SQLCODE = +100                                      35570007
316100             PERFORM 8710-MISSING-SPLIT-ERROR                     35580007
316200                                                                  35590007
316300         WHEN SQLCODE = ZERO                                      35600007
316400             SET PS-COUNT-DCS-OK         TO TRUE                  35610007
316500                                                                  35620007
316600         WHEN SQLWARN0 NOT EQUAL SPACE                            35630007
316700         WHEN SQLCODE NOT EQUAL ZERO                              35640007
316800             DISPLAY '** ABEND **'                                35650007
316900             DISPLAY '** PROGRAM = TRKUP008 **'                   35660007
317000             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          35670007
317100             DISPLAY '** IMCNUP-UPC-NBR = '                       35680007
317200                 IMCNUP-UPC-NBR                                   35690007
317300             DISPLAY '** PARAGRAPH = 2525-COUNT-DCS-FOR-THIS-UPC' 35700007
317400             PERFORM 9100-SQL-ABEND                               35710007
317500     END-EVALUATE.                                                35720007
317600                                                                  35730007
317700******************************************************************35740020
317800 2530-DC-COMPUTATIONS.                                            35750007
317900                                                                  35760007
318000     IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                            35770007
318100       CONTINUE                                                   35780007
318200     ELSE                                                         35790007
318300       DIVIDE PA-TOTAL-CURR-SPLIT-QTY    INTO                     35800007
318400         ALLPLN-CURR-SPLIT-QTY         GIVING                     35810007
318500         PV-QUOTIENT-ORDER-PERCENT                                35820007
318600     END-IF.                                                      35830007
318700                                                                  35840007
318800     MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                        35850007
318900          100 GIVING TR004-DC-PERCNT ROUNDED.                     35860007
319000                                                                  35870007
319100     IF TR004-DC-PERCNT = ZERO                                    35880007
319200        MOVE +1 TO TR004-DC-PERCNT                                35890007
319300     END-IF.                                                      35900007
319400                                                                  35910007
319500     PERFORM 2532-CALC-CART-COUNT.                                35920007
319600     MOVE PV-DC-CART-CT TO TR004-DC-CART-CT.                      35930007
319700                                                                  35940007
319800***  IF PS-ORDERED-EQUALS-SHIPPED                                 35950007
319900***    MOVE ALLPLN-CURR-SPLIT-QTY  TO TR004-DC-UNIT-QTY           35960007
320000***  ELSE                                                         35970007
320100     COMPUTE TR004-DC-UNIT-QTY  =                                 35980007
320200            (TR004-DC-CART-CT * TR004-OUTR-PK-QTY).               35990007
320300                                                                  36000007
320400     PERFORM 2700-COMPUTE-HOW-MANY-LBLS-DC.                       36010007
320500     PERFORM 2710-COMPUTE-DC-NO-LABELS.                           36020007
320600                                                                  36030007
320700     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             36040007
320800     ADD  TR004-DC-UNIT-QTY    TO PV-TTL-ALL-DCS-UNITS.           36050007
320900     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           36060007
321000                                                                  36070007
321100******************************************************************36080007
321200 2532-CALC-CART-COUNT.                                            36090007
321300                                                                  36100007
321400     EVALUATE TRUE                                                36110007
321500                                                                  36120007
321600        WHEN PV-DCS-TO-SKIP  > ZERO                               36130007
321700          MOVE ZERO    TO PV-DC-CART-CT                           36140007
321800                                                                  36150007
321900        WHEN IMCNUP-UPC-CART-CNT > 0                              36160007
322000          COMPUTE PV-DC-CART-CT ROUNDED =                         36170007
322100            (IMCNUP-UPC-CART-CNT * PV-QUOTIENT-ORDER-PERCENT)     36180007
322200          ADD .5 TO PV-DC-CART-CT                                 36190007
322300                                                                  36200007
322400        WHEN TR004-OUTR-PK-QTY = 0                                36210007
322500          SET TR006-ERROR-TYPE-ERROR   TO TRUE                    36220007
322600          INITIALIZE TR006-ERROR-MSG                              36230007
322700          STRING 'CMN-ZRO OTR PK QTY-CAL IS-NT SNT'               36240007
322800              DELIMITED BY SIZE                                   36250007
322900              INTO TR006-ERROR-MSG                                36260007
323000          PERFORM 8830-WRITE-ERROR-LINE                           36270007
323100          MOVE ZERO TO PV-DC-CART-CT                              36280007
323200          SET PS-PROBLEM-DO-NOT-SEND TO TRUE                      36290007
323300                                                                  36300007
323400        WHEN OTHER                                                36310007
323500          COMPUTE PV-DC-CART-CT ROUNDED =                         36320007
323600          (IMCNUP-UPC-UNT-QTY / TR004-OUTR-PK-QTY)                36330007
323700                     * PV-QUOTIENT-ORDER-PERCENT                  36340007
323800          ADD .5 TO PV-DC-CART-CT                                 36350007
323900                                                                  36360007
324000     END-EVALUATE.                                                36370007
324100                                                                  36380007
324200     IF PV-DC-CART-CT = ZERO                                      36390007
324300        IF PURCHS-NEW-STR-PO-IND = PC-Y                           36400007
324400          PERFORM 2610-ZERO-CARTS-ERROR-BULK                      36410007
324500        END-IF                                                    36420007
324600     ELSE                                                         36430007
324700*       **** NOT ZERO BUT LESS THAN 1  (FOR EXAMPLE .2)           36440007
324800        IF PV-DC-CART-CT < 1                                      36450007
324900          MOVE 1     TO PV-DC-CART-CT                             36460007
325000        END-IF                                                    36470007
325100     END-IF.                                                      36480007
325200                                                                  36490007
325300******************************************************************36500007
325400 2540-ADJUST-ROUNDED-DC-DIST.                                     36510007
325500                                                                  36520007
325600     IF PV-TTL-ALL-DCS-PCT = 100                                  36530007
325700       CONTINUE                                                   36540007
325800     ELSE                                                         36550007
325900       COMPUTE TR004-DC-PERCNT =                                  36560007
326000            TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)          36570007
326100     END-IF.                                                      36580007
326200                                                                  36590007
326300     IF PV-TTL-ALL-DCS-CARTS = IMCNUP-UPC-CART-CNT                36600007
326400       CONTINUE                                                   36610007
326500     ELSE                                                         36620007
326600       COMPUTE TR004-DC-CART-CT =                                 36630007
326700          TR004-DC-CART-CT +                                      36640007
326800             (IMCNUP-UPC-CART-CNT - PV-TTL-ALL-DCS-CARTS)         36650007
326900*      ********************************************************   36660007
327000*      * A1 - IF YOU ADJUST CARTONS, BETTER ADJUST THE NUMBER *   36670007
327100*      *      OF UNLBELED AS WELL.                            *   36680007
327200*      ********************************************************   36690007
327300       SUBTRACT PV-NBR-CART-LBLS-THIS-DC                          36700007
327400                     FROM PV-TTL-CART-LBLS-ALL-DCS                36710007
327500       PERFORM 2700-COMPUTE-HOW-MANY-LBLS-DC                      36720007
327600       PERFORM 2710-COMPUTE-DC-NO-LABELS                          36730007
327700*      ********************************************************   36740007
327800*      * A2 - IF YOU ADJUST CARTONS, ADJUST UNITS WHICH WERE  *   36750007
327900*      *      BASED ON CARTONS.                               *   36760007
328000*      ********************************************************   36770007
328100       SUBTRACT TR004-DC-UNIT-QTY  FROM PV-TTL-ALL-DCS-UNITS      36780007
328200       COMPUTE TR004-DC-UNIT-QTY  =                               36790007
328300              (TR004-DC-CART-CT * TR004-OUTR-PK-QTY)              36800007
328400       ADD  TR004-DC-UNIT-QTY    TO PV-TTL-ALL-DCS-UNITS          36810007
328500     END-IF.                                                      36820007
328600                                                                  36830007
328700*    ********************************************************     36840007
328800*    *  B - IN A1 ABOVE, UNITS MAY HAVE BEEN ADJUSTED BASED *     36850007
328900*    *      ON CARTONS.  NOW ADJUST UNITS BASED ON ACTUAL   *     36860007
329000*    *      SHIPPED QUANTITIES.                             *     36870007
329100*    ********************************************************     36880007
329200     IF PV-TTL-ALL-DCS-UNITS = IMCNUP-UPC-UNT-QTY                 36890007
329300       CONTINUE                                                   36900007
329400     ELSE                                                         36910007
329500       COMPUTE TR004-DC-UNIT-QTY =                                36920007
329600          TR004-DC-UNIT-QTY +                                     36930007
329700             (IMCNUP-UPC-UNT-QTY - PV-TTL-ALL-DCS-UNITS)          36940007
329800     END-IF.                                                      36950007
329900                                                                  36960007
330000*    ********************************************************     36970007
330100*    *  ADJUST LABELS FOR THIS DC                                 36980007
330200*    *  (YOU DON'T NEED TO ADJUST IF NUMBER OF LABELS = CARTS     36990007
330300*    *   BECAUSE THE SPLITS FOR EACH WILL BE IDENTICAL AND        37000007
330400*    *   LABELS WERE ADJUSTED WHEN CARTONS WERE.)                 37010007
330500*    ********************************************************     37020007
330600     IF PV-NBR-CART-LBLS-UPC = PV-TTL-CART-LBLS-ALL-DCS           37030007
330700       CONTINUE                                                   37040007
330800     ELSE                                                         37050007
330900       IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC              37060007
331000          CONTINUE                                                37070007
331100       ELSE                                                       37080007
331200         COMPUTE PV-NBR-CART-LBLS-THIS-DC =                       37090007
331300            PV-NBR-CART-LBLS-THIS-DC +                            37100007
331400             (PV-NBR-CART-LBLS-UPC - PV-TTL-CART-LBLS-ALL-DCS)    37110007
331500         PERFORM 2710-COMPUTE-DC-NO-LABELS                        37120007
331600       END-IF                                                     37130007
331700     END-IF.                                                      37140007
331800                                                                  37150007
139868******************************************************************37160035
139868 2550-ADJUST-ROUNDED-OUT-DIST.                                    37170035
139868                                                                  37180035
155029     IF  PS-EOC-STORE-CURSOR                                      37190073
155029     AND PS-OUTLET-STORE-NO                                       37200073
155029        DIVIDE PA-TOTAL-CURR-SPLIT-QTY                            37210073
155029          INTO MESTDS-STR-DISTRO-QTY                              37220073
155029            GIVING PV-QUOTIENT-ORDER-PERCENT                      37230073
155029        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     37240073
155029            100 GIVING TR004-DC-PERCNT ROUNDED                    37250073
155029                                                                  37260073
155029        IF TR004-DC-PERCNT = ZERO                                 37270073
155029           MOVE +1 TO TR004-DC-PERCNT                             37280073
155029        END-IF                                                    37290073
155029                                                                  37300073
155029     ELSE                                                         37310073
139868        IF PV-TTL-ALL-DCS-PCT = 100                               37320045
139868           CONTINUE                                               37330045
139868        ELSE                                                      37340045
139868           COMPUTE TR004-DC-PERCNT =                              37350045
139868               TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)       37360045
139868        END-IF                                                    37370045
155029     END-IF.                                                      37380073
139868                                                                  37390035
331900******************************************************************37400007
332000 2600-ZERO-CARTONS-ERROR.                                         37410007
332100                                                                  37420007
332200     SET TR006-ERROR-TYPE-ERROR       TO TRUE.                    37430007
332300     INITIALIZE TR006-ERROR-MSG.                                  37440007
332400     MOVE ALLPLN-DEST-NBR             TO PV-EDIT-DEST.            37450024
332500     STRING 'CMN-PCK-DC-',                                        37460007
332600            PV-EDIT-DEST                                          37470007
332700            '-0 CRTS-NW STR PO'                                   37480007
332800         DELIMITED BY SIZE                                        37490007
332900         INTO TR006-ERROR-MSG.                                    37500007
333000     MOVE IMCNUP-SKU-NBR   TO TR006-SKU                           37510007
333100     PERFORM 8830-WRITE-ERROR-LINE.                               37520007
333200                                                                  37530007
333300******************************************************************37540007
333400 2610-ZERO-CARTS-ERROR-BULK.                                      37550007
333500                                                                  37560007
333600     SET TR006-ERROR-TYPE-ERROR       TO TRUE.                    37570007
333700     INITIALIZE TR006-ERROR-MSG.                                  37580007
333800     MOVE ALLPLN-DEST-NBR             TO PV-EDIT-DEST.            37590024
333900     STRING 'CMN-BLK-DC-',                                        37600007
334000            PV-EDIT-DEST                                          37610007
334100            '-0 CRTS-NW STR PO'                                   37620007
334200         DELIMITED BY SIZE                                        37630007
334300         INTO TR006-ERROR-MSG.                                    37640007
334400     PERFORM 8830-WRITE-ERROR-LINE.                               37650007
334500                                                                  37660007
334600*************************************************************     37670007
334700 2700-COMPUTE-HOW-MANY-LBLS-DC.                                   37680007
334800                                                                  37690007
334900       IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC              37700007
335000         MOVE TR004-DC-CART-CT TO PV-NBR-CART-LBLS-THIS-DC        37710007
335100       ELSE                                                       37720007
335200         COMPUTE PV-NBR-CART-LBLS-THIS-DC ROUNDED =               37730007
335300          (PV-NBR-CART-LBLS-UPC * PV-QUOTIENT-ORDER-PERCENT)      37740007
335400       END-IF.                                                    37750007
335500                                                                  37760007
335600       ADD  PV-NBR-CART-LBLS-THIS-DC                              37770007
335700                               TO PV-TTL-CART-LBLS-ALL-DCS.       37780007
335800                                                                  37790007
335900*************************************************************     37800007
336000 2710-COMPUTE-DC-NO-LABELS.                                       37810007
336100                                                                  37820007
336200       IF PV-NBR-CART-LBLS-THIS-DC > TR004-DC-CART-CT             37830007
336300          MOVE ZERO TO TR004-DC-NO-LBL-CART-CT                    37840007
336400       ELSE                                                       37850007
336500          COMPUTE TR004-DC-NO-LBL-CART-CT =                       37860007
336600            (TR004-DC-CART-CT - PV-NBR-CART-LBLS-THIS-DC)         37870007
336700       END-IF.                                                    37880007
336800                                                                  37890007
336900*************************************************************     37900007
337000 2720-CREATE-DC-CARTON-LABELS.                                    37910007
337100                                                                  37920007
337200       MOVE ZERO TO PV-CARTON-ROWS-FETCHED.                       37930007
337300                                                                  37940007
337400       PERFORM UNTIL PV-CARTON-ROWS-FETCHED =                     37950007
337500                               PV-NBR-CART-LBLS-THIS-DC           37960007
337600               OR PS-EOC-CART-LABEL-CURSOR                        37970007
337700          PERFORM 8756-FETCH-CART-LABEL-CURSOR                    37980007
337800          EVALUATE TRUE                                           37990007
337900            WHEN PS-EOC-CART-LABEL-CURSOR                         38000007
338000***              SOME KIND OF ERROR ?                             38010007
338100               CONTINUE                                           38020007
338200            WHEN OTHER                                            38030007
338300                ADD +1 TO PV-CARTON-ROWS-FETCHED                  38040007
338400                INITIALIZE TR004-REC-TYPE-DC-CARTON               38050007
338500                MOVE TRT00008-SSCC-ID (1:20)                      38060007
338600                                TO TR004-DCT-SSCC-ID (1:20)       38070007
338700                MOVE TRT00008-UNT-QTY                             38080007
338800                                TO TR004-DCT-CARTON-UNIT-QTY      38090007
338900                PERFORM 5710-WRITE-DCT-RECORD                     38100007
339000            END-EVALUATE                                          38110007
339100       END-PERFORM.                                               38120007
339200                                                                  38130007
339300******************************************************************38140007
339400 2900-SEAL-CURSOR-FOR-XMIT.                                       38150007
339500                                                                  38160007
339600      PERFORM 8750-FETCH-SEAL-CURSOR.                             38170007
339700                                                                  38180007
339800      IF PS-EOC-SEAL-CURSOR                                       38190007
339900        CONTINUE                                                  38200007
340000      ELSE                                                        38210007
340100        PERFORM 5770-WRITE-CONTAINER-SEAL-REC                     38220007
340200      END-IF.                                                     38230007
340300                                                                  38240007
340400******************************************************************38250007
340500 2910-SEAL-CURSOR-FOR-REPORT.                                     38260007
340600                                                                  38270007
340700      PERFORM 8750-FETCH-SEAL-CURSOR.                             38280007
340800                                                                  38290007
340900      IF PS-EOC-SEAL-CURSOR                                       38300007
341000        CONTINUE                                                  38310007
341100      ELSE                                                        38320007
341200        PERFORM 8872-WRITE-DTL-RPT-SEAL-RECORD                    38330007
341300      END-IF.                                                     38340007
341400                                                                  38350007
341500      EJECT                                                       38360007
341600******************************************************************38370007
341700* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  38380007
341800* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL38390007
341900* PROGRAM TABLE.                                                  38400007
342000******************************************************************38410007
342100                                                                  38420007
342200 3000-WRITE-OUT-GOOD-PO-RECS.                                     38430007
342300                                                                  38440007
342400     IF PS-POE-WRITTEN-NO                                         38450007
342500       PERFORM 5100-WRITE-POE-RECORD                              38460007
342600       SET PS-POE-WRITTEN TO TRUE                                 38470007
342700     END-IF.                                                      38480007
342800                                                                  38490007
342900     IF PS-ETA-WRITTEN-NO                                         38500007
343000       PERFORM 5000-WRITE-ETA-RECORD                              38510007
343100       SET PS-ETA-WRITTEN TO TRUE                                 38520007
343200     END-IF.                                                      38530007
343300                                                                  38540007
343400     IF PS-VES-WRITTEN-NO                                         38550007
343500       PERFORM 5200-WRITE-VES-RECORD                              38560007
343600       SET PS-VES-WRITTEN TO TRUE                                 38570007
343700     END-IF.                                                      38580007
343800                                                                  38590007
343900     IF PS-CMN-WRITTEN-NO                                         38600007
344000       PERFORM 5300-WRITE-CMN-RECORD                              38610007
344100       SET PS-CMN-WRITTEN TO TRUE                                 38620007
344200       SET PS-NEED-SEALS  TO TRUE                                 38630007
344300       MOVE IMCNTK-CONTNR-ID      TO TRT00006-CONTNR-ID           38640007
344400       MOVE IMCNTK-CONTNR-SEQ-NBR TO TRT00006-CONTNR-SEQ-NBR      38650007
344500     END-IF.                                                      38660007
344600                                                                  38670007
344700     SET EXT-INDEX TO +1.                                         38680007
344800     SET PS-EOT-EXTRACT-NO  TO TRUE.                              38690007
344900     PERFORM 3100-UNLOAD-EXT-TABLE                                38700007
345000         UNTIL  PS-EOT-EXTRACT                                    38710007
345100             OR EXT-INDEX > PC-EXTRACT-TBL-LIMIT.                 38720007
345200                                                                  38730007
345300******************************************************************38740007
345400* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  38750007
345500* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL38760007
345600* PROGRAM TABLE.                                                  38770007
345700******************************************************************38780007
345800                                                                  38790007
345900 3100-UNLOAD-EXT-TABLE.                                           38800007
346000                                                                  38810007
346100     EVALUATE TRUE                                                38820007
346200                                                                  38830007
346300         WHEN PV-TBL-EXT-ROW (EXT-INDEX) = SPACES                 38840007
346400                                                                  38850007
346500            SET PS-EOT-EXTRACT TO TRUE                            38860007
346600                                                                  38870007
346700         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PO '                 38880007
346800                                                                  38890007
346900            PERFORM 3110-PO-EXTRACT-AND-DETAIL                    38900007
347000            SET EXT-INDEX UP BY +1                                38910007
347100                                                                  38920007
347200         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'INS'                 38930007
347300                                                                  38940007
347400            PERFORM 3120-INS-EXTRACT-AND-DETAIL                   38950007
347500            SET EXT-INDEX UP BY +1                                38960007
347600                                                                  38970007
347700         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCK'                 38980007
347800                                                                  38990007
347900            PERFORM 3130-PCK-EXTRACT-AND-DETAIL                   39000007
348000            SET EXT-INDEX UP BY +1                                39010007
348100                                                                  39020007
348200         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'UPC'                 39030007
348300                                                                  39040007
348400            PERFORM 3140-UPC-EXTRACT-AND-DETAIL                   39050007
348500            SET EXT-INDEX UP BY +1                                39060007
348600                                                                  39070007
348700         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PDC'                 39080007
348800                                                                  39090007
348900            PERFORM 3150-PDC-EXTRACT-AND-DETAIL                   39100007
349000            SET EXT-INDEX UP BY +1                                39110007
349100                                                                  39120007
349200         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DC '                 39130007
349300                                                                  39140007
349400            PERFORM 3160-DC-EXTRACT-AND-DETAIL                    39150007
349500            SET EXT-INDEX UP BY +1                                39160007
349600                                                                  39170007
349700         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCT'                 39180007
349800                                                                  39190007
349900            PERFORM 3170-PCT-EXTRACT-AND-DETAIL                   39200007
350000            SET EXT-INDEX UP BY +1                                39210007
350100                                                                  39220007
350200         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DCT'                 39230007
350300                                                                  39240007
350400            PERFORM 3180-DCT-EXTRACT-AND-DETAIL                   39250007
350500            SET EXT-INDEX UP BY +1                                39260007
350600                                                                  39270007
350700         WHEN OTHER                                               39280007
350800                                                                  39290007
350900            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    39300007
351000            DISPLAY  '&& TABLE ERROR                       &&'    39310007
351100            DISPLAY  '&& FOUND REC TYPE  - '                      39320007
351200                               PV-TBL-EXT-TYPE (EXT-INDEX)        39330007
351300            DISPLAY                          '             &&'    39340007
351400            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    39350007
351500                                                                  39360007
351600            SET EXT-INDEX UP BY +1                                39370007
351700                                                                  39380007
351800     END-EVALUATE.                                                39390007
351900                                                                  39400007
352000******************************************************************39410007
352100* PO  DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *39420007
352200******************************************************************39430007
352300                                                                  39440007
352400 3110-PO-EXTRACT-AND-DETAIL.                                      39450007
352500                                                                  39460007
352600     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PO         39470007
352700                                        OUTTR2-TRGL-EDI-PO-ODR.   39480007
352800     PERFORM 6000-INSERT-EXTRACT-REC.                             39490007
352900*    *************************************************            39500007
353000*    * A CMN RECORD IS WRITTEN TO THE REPORT DETAIL  *            39510007
353100*    * FILE FOR EACH PO BECAUSE REPORTING IS BY PO,  *            39520007
353200*    * NOT CONTAINER.                                *            39530007
353300*    *************************************************            39540007
353400     PERFORM 8856-WRITE-DTL-RPT-CMN-RECORD.                       39550007
353500     PERFORM 8850-WRITE-DTL-RPT-PO-RECORD.                        39560007
353600                                                                  39570007
353700******************************************************************39580007
353800* INS DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *39590007
353900******************************************************************39600007
354000                                                                  39610007
354100 3120-INS-EXTRACT-AND-DETAIL.                                     39620007
354200                                                                  39630007
354300     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-INS        39640007
354400                                        OUTTR2-TRGL-EDI-PO-ODR.   39650007
354500     PERFORM 6000-INSERT-EXTRACT-REC.                             39660007
354600     PERFORM 8852-WRITE-DTL-RPT-INS-RECORD.                       39670007
354700                                                                  39680007
354800******************************************************************39690007
354900* PCK DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *39700007
355000******************************************************************39710007
355100                                                                  39720007
355200 3130-PCK-EXTRACT-AND-DETAIL.                                     39730007
355300                                                                  39740007
355400     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PCK        39750007
355500                                        OUTTR2-TRGL-EDI-PO-ODR.   39760007
355600     PERFORM 6000-INSERT-EXTRACT-REC.                             39770007
355700     PERFORM 8847-WRITE-DTL-RPT-PCK-RECORD.                       39780007
355800                                                                  39790007
355900******************************************************************39800007
356000* UPC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *39810007
356100******************************************************************39820007
356200                                                                  39830007
356300 3140-UPC-EXTRACT-AND-DETAIL.                                     39840007
356400                                                                  39850007
356500     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-UPC        39860007
356600                                        OUTTR2-TRGL-EDI-PO-ODR.   39870007
356700     PERFORM 6000-INSERT-EXTRACT-REC.                             39880007
356800     PERFORM 8854-WRITE-DTL-RPT-UPC-RECORD.                       39890007
356900                                                                  39900007
357000******************************************************************39910007
357100* PDC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *39920007
357200******************************************************************39930007
357300                                                                  39940007
357400 3150-PDC-EXTRACT-AND-DETAIL.                                     39950007
357500                                                                  39960007
357600     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PDC        39970007
357700                                        OUTTR2-TRGL-EDI-PO-ODR.   39980007
357800     PERFORM 6000-INSERT-EXTRACT-REC.                             39990007
357900     PERFORM 8848-WRITE-DTL-RPT-PDC-RECORD.                       40000007
358000                                                                  40010007
358100******************************************************************40020007
358200* DC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT   *40030007
358300******************************************************************40040007
358400                                                                  40050007
358500 3160-DC-EXTRACT-AND-DETAIL.                                      40060007
358600                                                                  40070007
358700     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC         40080007
358800                                        OUTTR2-TRGL-EDI-PO-ODR.   40090007
358900     PERFORM 6000-INSERT-EXTRACT-REC.                             40100007
359000     PERFORM 8870-WRITE-DTL-RPT-DC-RECORD.                        40110007
359100                                                                  40120007
359200******************************************************************40130007
359300* PACK CARTON DATA FROM TABLE - WRITE TO EXTRACT * DETAIL REPT   *40140007
359400******************************************************************40150007
359500                                                                  40160007
359600 3170-PCT-EXTRACT-AND-DETAIL.                                     40170007
359700                                                                  40180007
359800     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PACK-CARTON40190007
359900                                        OUTTR2-TRGL-EDI-PO-ODR.   40200007
360000     PERFORM 6000-INSERT-EXTRACT-REC.                             40210007
360100     PERFORM 8874-WRITE-DTL-RPT-PCT-REC.                          40220007
360200                                                                  40230007
360300******************************************************************40240007
360400* PACK CARTON DATA FROM TABLE - WRITE TO EXTRACT * DETAIL REPT   *40250007
360500******************************************************************40260007
360600                                                                  40270007
360700 3180-DCT-EXTRACT-AND-DETAIL.                                     40280007
360800                                                                  40290007
360900     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC-CARTON  40300007
361000                                        OUTTR2-TRGL-EDI-PO-ODR.   40310007
361100     PERFORM 6000-INSERT-EXTRACT-REC.                             40320007
361200     PERFORM 8876-WRITE-DTL-RPT-DCT-REC.                          40330007
361300                                                                  40340007
361400******************************************************************40350007
361500* SELECT IMCNPO ROW INTO AUDIT HOST VARIABLES.                   *40360007
361600******************************************************************40370007
361700 4000-SELECT-IMCNPO-FOR-AUDIT.                                    40380007
361800                                                                  40390007
361900         EXEC SQL                                                 40400007
362000             SELECT CONTNR_ID                                     40410007
362100                   ,CONTNR_SEQ_NBR                                40420007
362200                   ,PO_NBR                                        40430007
362300                   ,CSTM_ENTR_ID                                  40440007
362400                   ,MSTR_BOL_NBR                                  40450007
362500                   ,HSE_BOL_NBR                                   40460007
362600                   ,LTR_OF_CR_NBR                                 40470007
362700                   ,PO_RCVD_DELY_TMST                             40480007
362800                   ,PO_C_O_PROD_CDE                               40490007
362900                   ,PO_CART_CNT                                   40500007
363000                   ,PO_CBMT_QTY                                   40510007
363100                   ,PO_WT_KGRM_QTY                                40520007
363200                   ,PO_UNT_QTY                                    40530007
363300                   ,LAST_UPD_BY_USR_ID                            40540007
363400                   ,LAST_UPD_TMST                                 40550007
363500                   ,EXTL_REF_NBR                                  40560007
363600                   ,BKR_FRGT_RLSE_CDE                             40570007
363700                   ,DO_RCVD_CDE                                   40580007
363800                   ,CONTNR_PU_CDE                                 40590007
363900                   ,ACTL_POE_DELY_CDE                             40600007
364000                   ,DVN_CDE                                       40610007
364100                   ,DCONSLR_RET_CDE                               40620007
364200                   ,SPLT_XMIT_CDE                                 40630007
364300                   ,DOC_RCVD_ORGN_TMST                            40640007
364400               INTO :AUCNPO-CONTNR-ID                             40650007
364500                   ,:AUCNPO-CONTNR-SEQ-NBR                        40660007
364600                   ,:AUCNPO-PO-NBR                                40670007
364700                   ,:AUCNPO-CSTM-ENTR-ID                          40680007
364800                   ,:AUCNPO-MSTR-BOL-NBR                          40690007
364900                   ,:AUCNPO-HSE-BOL-NBR                           40700007
365000                   ,:AUCNPO-LTR-OF-CR-NBR                         40710007
365100                   ,:AUCNPO-PO-RCVD-DELY-TMST                     40720007
365200                   ,:AUCNPO-PO-C-O-PROD-CDE                       40730007
365300                   ,:AUCNPO-PO-CART-CNT                           40740007
365400                   ,:AUCNPO-PO-CBMT-QTY                           40750007
365500                   ,:AUCNPO-PO-WT-KGRM-QTY                        40760007
365600                   ,:AUCNPO-PO-UNT-QTY                            40770007
365700                   ,:AUCNPO-LAST-UPD-BY-USR-ID                    40780007
365800                   ,:AUCNPO-LAST-UPD-TMST                         40790007
365900                   ,:AUCNPO-EXTL-REF-NBR                          40800007
366000                   ,:AUCNPO-BKR-FRGT-RLSE-CDE                     40810007
366100                   ,:AUCNPO-DO-RCVD-CDE                           40820007
366200                   ,:AUCNPO-CONTNR-PU-CDE                         40830007
366300                   ,:AUCNPO-ACTL-POE-DELY-CDE                     40840007
366400                   ,:AUCNPO-DVN-CDE                               40850007
366500                   ,:AUCNPO-DCONSLR-RET-CDE                       40860007
366600                   ,:AUCNPO-SPLT-XMIT-CDE                         40870007
366700                   ,:AUCNPO-DOC-RCVD-ORGN-TMST                    40880007
366800               FROM TIMCNPO                                       40890007
366900              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          40900007
367000                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     40910007
367100                AND PO_NBR           = :IMCNPO-PO-NBR             40920007
367200         END-EXEC                                                 40930007
367300                                                                  40940007
367400         EVALUATE TRUE                                            40950007
367500         WHEN SQLCODE = ZERO                                      40960007
367600              CONTINUE                                            40970007
367700                                                                  40980007
367800         WHEN SQLCODE = +100                                      40990007
367900         WHEN SQLWARN0 NOT EQUAL SPACE                            41000007
368000         WHEN SQLCODE NOT EQUAL ZERO                              41010007
368100             DISPLAY '** ABEND **'                                41020007
368200             DISPLAY '** PROGRAM = TRKUP008 **'                   41030007
368300             DISPLAY                                              41040007
368400                '** PARAGRAPH = 4000-SELECT-IMCNPO-FOR-AUDIT **'  41050007
368500             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           41060007
368600             DISPLAY 'CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR      41070007
368700             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              41080007
368800             PERFORM 9100-SQL-ABEND                               41090007
368900         END-EVALUATE.                                            41100007
369000                                                                  41110007
369100******************************************************************41120007
369200* INSERT A COPY OF THE IMCNPO ROW TO THE AUDIT TRAIL TABLE       *41130007
369300* AFTER UPDATING THE TIMCNPO TABLE.                              *41140007
369400******************************************************************41150007
369500 4010-CREATE-IMCNPO-AUDIT-TRAIL.                                  41160007
369600                                                                  41170007
369700         EXEC SQL                                                 41180007
369800             INSERT INTO TAUCNPO                                  41190007
369900                   (CONTNR_ID                                     41200007
370000                   ,CONTNR_SEQ_NBR                                41210007
370100                   ,PO_NBR                                        41220007
370200                   ,CSTM_ENTR_ID                                  41230007
370300                   ,MSTR_BOL_NBR                                  41240007
370400                   ,HSE_BOL_NBR                                   41250007
370500                   ,LTR_OF_CR_NBR                                 41260007
370600                   ,PO_RCVD_DELY_TMST                             41270007
370700                   ,PO_C_O_PROD_CDE                               41280007
370800                   ,PO_CART_CNT                                   41290007
370900                   ,PO_CBMT_QTY                                   41300007
371000                   ,PO_WT_KGRM_QTY                                41310007
371100                   ,PO_UNT_QTY                                    41320007
371200                   ,LAST_UPD_BY_USR_ID                            41330007
371300                   ,LAST_UPD_TMST                                 41340007
371400                   ,EXTL_REF_NBR                                  41350007
371500                   ,BKR_FRGT_RLSE_CDE                             41360007
371600                   ,DO_RCVD_CDE                                   41370007
371700                   ,CONTNR_PU_CDE                                 41380007
371800                   ,ACTL_POE_DELY_CDE                             41390007
371900                   ,DVN_CDE                                       41400007
372000                   ,DCONSLR_RET_CDE                               41410007
372100                   ,SPLT_XMIT_CDE                                 41420007
372200                   ,DOC_RCVD_ORGN_TMST                            41430007
372300                   ,AUD_FUNC_CDE                                  41440007
372400                   ,AUD_TMST)                                     41450007
372500            VALUES (:AUCNPO-CONTNR-ID                             41460007
372600                   ,:AUCNPO-CONTNR-SEQ-NBR                        41470007
372700                   ,:AUCNPO-PO-NBR                                41480007
372800                   ,:AUCNPO-CSTM-ENTR-ID                          41490007
372900                   ,:AUCNPO-MSTR-BOL-NBR                          41500007
373000                   ,:AUCNPO-HSE-BOL-NBR                           41510007
373100                   ,:AUCNPO-LTR-OF-CR-NBR                         41520007
373200                   ,:AUCNPO-PO-RCVD-DELY-TMST                     41530007
373300                   ,:AUCNPO-PO-C-O-PROD-CDE                       41540007
373400                   ,:AUCNPO-PO-CART-CNT                           41550007
373500                   ,:AUCNPO-PO-CBMT-QTY                           41560007
373600                   ,:AUCNPO-PO-WT-KGRM-QTY                        41570007
373700                   ,:AUCNPO-PO-UNT-QTY                            41580007
373800                   ,:AUCNPO-LAST-UPD-BY-USR-ID                    41590007
373900                   ,:AUCNPO-LAST-UPD-TMST                         41600007
374000                   ,:AUCNPO-EXTL-REF-NBR                          41610007
374100                   ,:AUCNPO-BKR-FRGT-RLSE-CDE                     41620007
374200                   ,:AUCNPO-DO-RCVD-CDE                           41630007
374300                   ,:AUCNPO-CONTNR-PU-CDE                         41640007
374400                   ,:AUCNPO-ACTL-POE-DELY-CDE                     41650007
374500                   ,:AUCNPO-DVN-CDE                               41660007
374600                   ,:AUCNPO-DCONSLR-RET-CDE                       41670007
374700                   ,:AUCNPO-SPLT-XMIT-CDE                         41680007
374800                   ,:AUCNPO-DOC-RCVD-ORGN-TMST                    41690007
374900                   ,:PC-U                                         41700007
375000                   ,:PV-CURRENT-TIME)                             41710007
375100         END-EXEC                                                 41720007
375200                                                                  41730007
375300         EVALUATE TRUE                                            41740007
375400                                                                  41750007
375500         WHEN SQLCODE = ZERO                                      41760007
375600              CONTINUE                                            41770007
375700                                                                  41780007
375800         WHEN SQLWARN0 NOT EQUAL SPACE                            41790007
375900         WHEN SQLCODE NOT EQUAL ZERO                              41800007
376000             DISPLAY '** ABEND **'                                41810007
376100             DISPLAY '** PROGRAM = TRKUP008 **'                   41820007
376200             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           41830007
376300             DISPLAY 'CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR      41840007
376400             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              41850007
376500                  '** PARAGRAPH = 4010-CREATE-IMCNPO-AUDIT-TRAIL' 41860007
376600             PERFORM 9100-SQL-ABEND                               41870007
376700         END-EVALUATE.                                            41880007
376800******************************************************************41890007
376900* SELECT IMCNRL ROW INTO AUDIT HOST VARIABLES.                   *41900007
377000******************************************************************41910007
377100 4020-SELECT-IMCNRL-FOR-AUDIT.                                    41920007
377200                                                                  41930007
377300         EXEC SQL                                                 41940007
377400             SELECT  CONTNR_ID                                    41950007
377500                    ,CONTNR_SEQ_NBR                               41960007
377600                    ,PO_NBR                                       41970007
377700                    ,DCONSLR_RLSE_CDE                             41980007
377800                    ,DCONSLR_REQR_DTE                             41990007
377900                    ,DCONSLR_ACTL_DTE                             42000007
378000                    ,DCONSLR_ACTL_TM                              42010007
378100                    ,CRE_TMST                                     42020007
378200                    ,CRE_BY_UID                                   42030007
378300                    ,LAST_UPD_TMST                                42040007
378400                    ,LAST_UPD_BY_UID                              42050007
378500                    ,DCONSLR_ENT_ID                               42060007
378600               INTO :AUCNRL-CONTNR-ID                             42070007
378700                   ,:AUCNRL-CONTNR-SEQ-NBR                        42080007
378800                   ,:AUCNRL-PO-NBR                                42090007
378900                   ,:AUCNRL-DCONSLR-RLSE-CDE                      42100007
379000                   ,:AUCNRL-DCONSLR-REQR-DTE                      42110007
379100                   ,:AUCNRL-DCONSLR-ACTL-DTE                      42120007
379200                   ,:AUCNRL-DCONSLR-ACTL-TM                       42130007
379300                   ,:AUCNRL-CRE-TMST                              42140007
379400                   ,:AUCNRL-CRE-BY-UID                            42150007
379500                   ,:AUCNRL-LAST-UPD-TMST                         42160007
379600                   ,:AUCNRL-LAST-UPD-BY-UID                       42170007
379700                   ,:AUCNRL-DCONSLR-ENT-ID                        42180007
379800               FROM TIMCNRL                                       42190007
379900              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          42200007
380000                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     42210007
380100                AND PO_NBR           = :IMCNPO-PO-NBR             42220007
380200         END-EXEC                                                 42230007
380300                                                                  42240007
380400         EVALUATE TRUE                                            42250007
380500         WHEN SQLCODE = ZERO                                      42260007
380600             SET PS-IMCNRL-INFO-PRESENT      TO TRUE              42270007
380700                                                                  42280007
380800         WHEN SQLCODE = +100                                      42290007
380900             INITIALIZE TR006-DEPT-NBR                            42300007
381000                        TR006-ERROR-MSG                           42310007
381100             SET TR006-ERROR-TYPE-ERROR       TO TRUE             42320007
381200             STRING 'CMN-DCNSLR/PO INFO MISNG-NOT SNT'            42330007
381300                 DELIMITED BY SIZE                                42340007
381400                 INTO TR006-ERROR-MSG                             42350007
381500             PERFORM 8830-WRITE-ERROR-LINE                        42360007
381600                                                                  42370007
381700         WHEN SQLWARN0 NOT EQUAL SPACE                            42380007
381800         WHEN SQLCODE NOT EQUAL ZERO                              42390007
381900             DISPLAY '** ABEND **'                                42400007
382000             DISPLAY '** PROGRAM = TRKUP008 **'                   42410007
382100             DISPLAY                                              42420007
382200                '** PARAGRAPH = 4020-SELECT-IMCNRL-FOR-AUDIT **'  42430007
382300             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           42440007
382400             DISPLAY 'CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR      42450007
382500             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              42460007
382600             PERFORM 9100-SQL-ABEND                               42470007
382700         END-EVALUATE.                                            42480007
382800                                                                  42490007
382900******************************************************************42500007
383000* INSERT A COPY OF THE IMCNRL ROW TO THE AUDIT TRAIL TABLE       *42510007
383100* AFTER UPDATING THE TIMCNRL TABLE.                              *42520007
383200******************************************************************42530007
383300 4030-CREATE-IMCNRL-AUDIT-TRAIL.                                  42540007
383400                                                                  42550007
383500         EXEC SQL                                                 42560007
383600             INSERT INTO TAUCNRL                                  42570007
383700                   (CONTNR_ID                                     42580007
383800                   ,CONTNR_SEQ_NBR                                42590007
383900                   ,PO_NBR                                        42600007
384000                   ,DCONSLR_RLSE_CDE                              42610007
384100                   ,DCONSLR_REQR_DTE                              42620007
384200                   ,DCONSLR_ACTL_DTE                              42630007
384300                   ,DCONSLR_ACTL_TM                               42640007
384400                   ,CRE_TMST                                      42650007
384500                   ,CRE_BY_UID                                    42660007
384600                   ,LAST_UPD_TMST                                 42670007
384700                   ,LAST_UPD_BY_UID                               42680007
384800                   ,AUD_FUNC_CDE                                  42690007
384900                   ,AUD_TMST                                      42700007
385000                   ,DCONSLR_ENT_ID)                               42710007
385100            VALUES (:AUCNRL-CONTNR-ID                             42720007
385200                   ,:AUCNRL-CONTNR-SEQ-NBR                        42730007
385300                   ,:AUCNRL-PO-NBR                                42740007
385400                   ,:AUCNRL-DCONSLR-RLSE-CDE                      42750007
385500                   ,:AUCNRL-DCONSLR-REQR-DTE                      42760007
385600                   ,:AUCNRL-DCONSLR-ACTL-DTE                      42770007
385700                   ,:AUCNRL-DCONSLR-ACTL-TM                       42780007
385800                   ,:AUCNRL-CRE-TMST                              42790007
385900                   ,:AUCNRL-CRE-BY-UID                            42800007
386000                   ,:AUCNRL-LAST-UPD-TMST                         42810007
386100                   ,:AUCNRL-LAST-UPD-BY-UID                       42820007
386200                   ,:PC-U                                         42830007
386300                   ,:PV-CURRENT-TIME                              42840007
386400                   ,:AUCNRL-DCONSLR-ENT-ID)                       42850007
386500         END-EXEC                                                 42860007
386600                                                                  42870007
386700         EVALUATE TRUE                                            42880007
386800                                                                  42890007
386900         WHEN SQLCODE = ZERO                                      42900007
387000              CONTINUE                                            42910007
387100                                                                  42920007
387200         WHEN SQLWARN0 NOT EQUAL SPACE                            42930007
387300         WHEN SQLCODE NOT EQUAL ZERO                              42940007
387400             DISPLAY '** ABEND **'                                42950007
387500             DISPLAY '** PROGRAM = TRKUP008 **'                   42960007
387600             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           42970007
387700             DISPLAY 'CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR      42980007
387800             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              42990007
387900                  '** PARAGRAPH = 4030-CREATE-IMCNRL-AUDIT-TRAIL' 43000007
388000             PERFORM 9100-SQL-ABEND                               43010007
388100         END-EVALUATE.                                            43020007
388200*----------------------------------------------------------------*43030007
388300*    CHECK TO SEE IF A CHECKPOINT SHOULD BE TAKEN.               *43040007
388400*----------------------------------------------------------------*43050007
388500 4400-CHECKPOINT-CHECK.                                           43060007
388600                                                                  43070007
388700     EXEC SQL                                                     43080007
388800       SET :PV-TMST = CURRENT TIMESTAMP                           43090007
388900     END-EXEC.                                                    43100007
389000                                                                  43110007
389100     EVALUATE TRUE                                                43120007
389200         WHEN SQLWARN0 NOT EQUAL SPACE                            43130007
389300         WHEN SQLCODE NOT EQUAL ZERO                              43140007
389400             DISPLAY '** ABEND **'                                43150007
389500             DISPLAY '** PROGRAM = TRKUP008 **'                   43160007
389600             DISPLAY '** PARAGRAPH = 4400-CHEKPOINT-CHECK**'      43170007
389700             DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'          43180007
389800             PERFORM 9100-SQL-ABEND                               43190007
389900     END-EVALUATE.                                                43200007
390000                                                                  43210007
390100     IF PV-TMST > PV-HOLD-TMST                                    43220007
390200        IF PS-COMMITS-TAKEN                                       43230007
390300            CONTINUE                                              43240007
390400        ELSE                                                      43250007
390500            MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE          43260007
390600            PERFORM 6570-UPDATE-TCKRSTCNTL                        43270007
390700            SET PS-COMMITS-TAKEN   TO TRUE                        43280007
390800        END-IF                                                    43290007
390900        PERFORM 6580-UPDATE-TCKRSTINF                             43300007
391000        PERFORM 4500-COMMIT                                       43310007
391100        DISPLAY 'COMMIT TAKEN AT '                                43320007
391200        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)43330007
391300         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)43340007
391400        PERFORM 4600-SET-CHECKPOINT-TIME                          43350007
391500     END-IF.                                                      43360007
391600                                                                  43370007
391700 EJECT                                                            43380007
391800******************************************************************43390007
391900* EXECUTES AN SQL COMMIT AFTER ALL TABLES FOR TRIP ARE UPDATED.   43400007
392000******************************************************************43410007
392100 4500-COMMIT.                                                     43420007
392200                                                                  43430007
392300     EXEC SQL                                                     43440007
392400         COMMIT                                                   43450007
392500     END-EXEC.                                                    43460007
392600                                                                  43470007
392700     EVALUATE TRUE                                                43480007
392800         WHEN SQLWARN0 NOT EQUAL SPACE                            43490007
392900         WHEN SQLCODE NOT EQUAL ZERO                              43500007
393000       DISPLAY '***********CHECKPOINT*************'               43510007
393100          DISPLAY 'IMCNPO-PO-NBR = ' IMCNPO-PO-NBR                43520007
393200          DISPLAY 'CONTAINER ID  = ' IMCNTK-CONTNR-ID             43530007
393300          DISPLAY 'CNTR SEQ NBR  = ' IMCNTK-CONTNR-SEQ-NBR        43540007
393400          DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                  43550007
393500              PA-TOTAL-OUTPUT-REC-COUNT                           43560007
393600          DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT              43570007
393700          DISPLAY '**********************************'            43580007
393800                                                                  43590007
393900             DISPLAY '** ABEND **'                                43600007
394000             DISPLAY '** PROGRAM = TRKUP008 **'                   43610007
394100             DISPLAY '** PARAGRAPH = 4500-COMMIT**'               43620007
394200             DISPLAY '**UNSUCCESSFUL COMMIT**'                    43630007
394300             PERFORM 9100-SQL-ABEND                               43640007
394400     END-EVALUATE.                                                43650007
394500 EJECT                                                            43660007
394600******************************************************************43670007
394700* SET THE TIME FOR THE NEXT CHECKPOINT.                           43680007
394800******************************************************************43690007
394900 4600-SET-CHECKPOINT-TIME.                                        43700007
395000                                                                  43710007
395100      EXEC SQL                                                    43720007
395200          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    43730007
395300          INTO :PV-HOLD-TMST                                      43740007
395400          FROM TCKRSTCNTL                                         43750007
395500          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              43760007
395600      END-EXEC.                                                   43770007
395700                                                                  43780007
395800     EVALUATE TRUE                                                43790007
395900         WHEN SQLWARN0 NOT EQUAL SPACE                            43800007
396000         WHEN SQLCODE NOT EQUAL ZERO                              43810007
396100             DISPLAY '** ABEND **'                                43820007
396200             DISPLAY '** PROGRAM = TRKUP008 **'                   43830007
396300             DISPLAY '** PARAGRAPH = 4600-SET-CHECKPOINT-TIME**'  43840007
396400             DISPLAY '**UNSUCESSFUL SET OF CHECKPOINT INTERVAL**' 43850007
396500             PERFORM 9100-SQL-ABEND                               43860007
396600     END-EVALUATE.                                                43870007
396700 EJECT                                                            43880007
396800******************************************************************43890007
396900 4800-SET-CURRENT-DATE-TIME.                                      43900007
397000                                                                  43910007
397100     EXEC SQL                                                     43920007
397200       SET :IMCNRL-DCONSLR-ACTL-DTE = CURRENT DATE                43930007
397300          ,:IMCNRL-DCONSLR-ACTL-TM  = CURRENT TIME                43940007
397400     END-EXEC.                                                    43950007
397500                                                                  43960007
397600     EVALUATE TRUE                                                43970007
397700         WHEN SQLWARN0 NOT EQUAL SPACE                            43980007
397800         WHEN SQLCODE NOT EQUAL ZERO                              43990007
397900             DISPLAY '** ABEND **'                                44000007
398000             DISPLAY '** PROGRAM = TRKUP008 **'                   44010007
398100             DISPLAY '** PARAGRAPH = 4800-SET-CURRENT-DATE-TIME'  44020007
398200             DISPLAY '**UNSUCCESSFUL SET DATE/TIME**'             44030007
398300             PERFORM 9100-SQL-ABEND                               44040007
398400     END-EVALUATE.                                                44050007
398500                                                                  44060007
398600 EJECT                                                            44070007
398700******************************************************************44080007
398800* WRITE ESTIMATE TIME OF ARRIVAL RECORD TYPE FOR VESSEL EXTRACT  *44090007
398900* FILE                                                           *44100007
399000******************************************************************44110007
399100 5000-WRITE-ETA-RECORD.                                           44120007
399200                                                                  44130007
399300     MOVE 'ETA' TO TR004-REC-TYPE-CDE-ETA.                        44140007
399400     MOVE TR004-REC-TYPE-ETA      TO                              44150007
399500         OUTTR2-TRGL-EDI-PO-ODR.                                  44160007
399600                                                                  44170007
399700     PERFORM 6000-INSERT-EXTRACT-REC.                             44180007
399800                                                                  44190007
399900******************************************************************44200007
400000* WRITE PORT OF ENTRY RECORD TYPE FOR EXTRACT FILE.              *44210007
400100******************************************************************44220007
400200 5100-WRITE-POE-RECORD.                                           44230007
400300                                                                  44240007
400400     MOVE 'POE'   TO TR004-REC-TYPE-CDE-POE.                      44250007
400500     MOVE TR004-REC-TYPE-POE      TO                              44260007
400600         OUTTR2-TRGL-EDI-PO-ODR.                                  44270007
400700                                                                  44280007
400800     PERFORM 6000-INSERT-EXTRACT-REC.                             44290007
400900                                                                  44300007
401000******************************************************************44310007
401100* WRITE VESSEL RECORD TYPE FOR EXTRACT FILE.                     *44320007
401200******************************************************************44330007
401300 5200-WRITE-VES-RECORD.                                           44340007
401400                                                                  44350007
401500     MOVE 'VES'     TO TR004-REC-TYPE-CDE-VES.                    44360007
401600     MOVE TR004-REC-TYPE-VES      TO                              44370007
401700         OUTTR2-TRGL-EDI-PO-ODR.                                  44380007
401800                                                                  44390007
401900     PERFORM 6000-INSERT-EXTRACT-REC.                             44400007
402000                                                                  44410007
402100******************************************************************44420007
402200* WRITE CONTAINER RECORD TYPE FOR EXTRACT FILE.                  *44430007
402300******************************************************************44440007
402400 5300-WRITE-CMN-RECORD.                                           44450007
402500                                                                  44460007
402600     SET TR004-REC-TYPE-CDE-CMN        TO TRUE.                   44470007
402700     MOVE TR004-REC-TYPE-CONTAINER  TO                            44480007
402800                                       OUTTR2-TRGL-EDI-PO-ODR.    44490007
402900                                                                  44500007
403000     PERFORM 6000-INSERT-EXTRACT-REC.                             44510007
403100                                                                  44520007
403200******************************************************************44530007
403300* WRITE PO RECORD TYPE FOR EXTRACT FILE.                         *44540007
403400******************************************************************44550007
403500                                                                  44560007
403600 5400-WRITE-PUR-ORDER-PO-RECORD.                                  44570007
403700                                                                  44580007
403800     MOVE 'PO '                 TO TR004-REC-TYPE-CDE-PO.         44590007
403900     MOVE TR004-REC-TYPE-PO     TO PV-TBL-EXT-ROW (EXT-INDEX).    44600007
404000     PERFORM 5900-CHECK-OVERFLOW.                                 44610007
404100                                                                  44620007
404200******************************************************************44630007
404300* WRITE INSTRUCTION RECORD TYPE FOR EXTRACT FILE.                *44640007
404400******************************************************************44650007
404500                                                                  44660007
404600 5500-WRITE-PUR-ORDER-INS-REC.                                    44670007
404700                                                                  44680007
404800     MOVE 'INS'     TO TR004-REC-TYPE-CDE-INS.                    44690007
404900     MOVE TR004-REC-TYPE-INS    TO PV-TBL-EXT-ROW (EXT-INDEX).    44700007
405000     PERFORM 5900-CHECK-OVERFLOW.                                 44710007
405100                                                                  44720007
405200******************************************************************44730007
405300* WRITE PURCHASE ORDER UPC RECORD TYPE FOR EXTRACT FILE.         *44740007
405400******************************************************************44750007
405500                                                                  44760007
405600 5600-WRITE-PUR-ORDER-UPC-REC.                                    44770007
405700                                                                  44780007
405800     MOVE 'UPC'    TO TR004-REC-TYPE-CDE-UPC.                     44790007
405900     MOVE TR004-REC-TYPE-UPC    TO PV-TBL-EXT-ROW (EXT-INDEX).    44800007
406000     PERFORM 5900-CHECK-OVERFLOW.                                 44810007
406100                                                                  44820007
406200******************************************************************44830007
406300* WRITE DISTRIBUTION CENTER RECORD TYPE FOR EXTRACT FILE.        *44840007
406400******************************************************************44850007
406500                                                                  44860007
406600 5700-WRITE-DC-RECORD.                                            44870007
406700                                                                  44880007
155029     SET PS-BYPASS-CRTN-WRITE-NO   TO TRUE.                       44890073
155029                                                                  44900073
155029     IF TR004-DIST-CNTR = PV-HOLD-DIST-CNTR                       44910073
155029        SET PS-BYPASS-CRTN-WRITE   TO TRUE                        44920073
155029     ELSE                                                         44930073
406800        MOVE 'DC '    TO TR004-REC-TYPE-CDE-DC                    44940045
155029        MOVE TR004-REC-TYPE-DC     TO PV-HOLD-OUT-RECORD          44950073
406900        MOVE TR004-REC-TYPE-DC     TO PV-TBL-EXT-ROW (EXT-INDEX)  44960045
407000        PERFORM 5900-CHECK-OVERFLOW                               44970045
155029     END-IF.                                                      44980073
407100                                                                  44990007
407200******************************************************************45000007
407300* WRITE BULK DC LABEL TYPE TO EXTRACT FILE.                      *45010007
407400******************************************************************45020007
407500                                                                  45030007
407600 5710-WRITE-DCT-RECORD.                                           45040007
407700                                                                  45050007
407800     MOVE 'DCT'    TO TR004-REC-TYPE-CDE-DC-CARTON.               45060007
407900     MOVE TR004-REC-TYPE-DC-CARTON TO PV-TBL-EXT-ROW (EXT-INDEX). 45070007
408000     PERFORM 5900-CHECK-OVERFLOW.                                 45080007
408100                                                                  45090007
408200******************************************************************45100007
408300* WRITE PACK DC LABEL TYPE TO EXTRACT FILE.                      *45110007
408400******************************************************************45120007
408500                                                                  45130007
408600 5720-WRITE-PCT-RECORD.                                           45140007
408700                                                                  45150007
408800     MOVE 'PCT'    TO TR004-REC-TYPE-CDE-PCT                      45160007
408900     MOVE TR004-REC-TYPE-PACK-CARTON                              45170007
409000                               TO PV-TBL-EXT-ROW (EXT-INDEX).     45180007
409100     PERFORM 5900-CHECK-OVERFLOW.                                 45190007
409200                                                                  45200007
409300******************************************************************45210007
409400* WRITE PACK RECORD TYPE (PCK) FOR EXTRACT FILE.                 *45220007
409500******************************************************************45230007
409600                                                                  45240007
409700 5755-WRITE-PUR-ORDER-PCK-REC.                                    45250007
409800                                                                  45260007
409900     MOVE 'PCK'    TO TR004-REC-TYPE-CDE-PCK.                     45270007
410000     MOVE TR004-REC-TYPE-PCK    TO PV-TBL-EXT-ROW (EXT-INDEX).    45280007
410100     PERFORM 5900-CHECK-OVERFLOW.                                 45290007
410200                                                                  45300007
410300******************************************************************45310007
410400* WRITE PACK DC (PDC) RECORD TYPE FOR EXTRACT FILE.              *45320007
410500******************************************************************45330007
410600                                                                  45340007
410700 5760-WRITE-PUR-ORDER-PDC-REC.                                    45350007
410800                                                                  45360007
155029     IF TR004-PDC-DIST-CNTR = PV-HOLD-DIST-CNTR                   45370073
155029        CONTINUE                                                  45380073
155029     ELSE                                                         45390073
410900        MOVE 'PDC'    TO TR004-REC-TYPE-CDE-PDC                   45400057
155029        MOVE TR004-REC-TYPE-PDC    TO PV-HOLD-OUT-RECORD          45410073
411000        MOVE TR004-REC-TYPE-PDC    TO PV-TBL-EXT-ROW (EXT-INDEX)  45420057
411100        PERFORM 5900-CHECK-OVERFLOW                               45430057
155029     END-IF.                                                      45440073
411200                                                                  45450007
411300******************************************************************45460007
411400* WRITE CONTAINER SEAL TO EXTRACT FILE.                           45470007
411500******************************************************************45480007
411600                                                                  45490007
411700 5770-WRITE-CONTAINER-SEAL-REC.                                   45500007
411800                                                                  45510007
411900     INITIALIZE TR004-REC-TYPE-CONTAINER-SEAL                     45520007
412000     MOVE TRT00006-SEAL-NBR     TO TR004-SEA-CONTNR-SEAL-NBR.     45530007
412100     MOVE 'SEA'                 TO TR004-REC-TYPE-CDE-CONTNR-SEAL 45540007
412200     MOVE TR004-REC-TYPE-CONTAINER-SEAL                           45550007
412300                                TO OUTTR2-TRGL-EDI-PO-ODR.        45560007
412400                                                                  45570007
412500     PERFORM 6000-INSERT-EXTRACT-REC.                             45580007
412600                                                                  45590007
412700******************************************************************45600007
412800* WRITE TRAILER RECORD FOR EXTRACT FILE.                         *45610007
412900******************************************************************45620007
413000                                                                  45630007
413100 5800-WRITE-PUR-ORDER-CTT-REC.                                    45640007
413200                                                                  45650007
413300     MOVE 'CTT'    TO TR004-REC-TYPE-CDE-CTT.                     45660007
413400     MOVE TR004-REC-TYPE-CTT      TO                              45670007
413500         OUTTR2-TRGL-EDI-PO-ODR.                                  45680007
413600                                                                  45690007
413700     PERFORM 6000-INSERT-EXTRACT-REC.                             45700007
413800                                                                  45710007
413900******************************************************************45720007
414000* CHECK IF INTERNAL TABLE FILLED UP.                             *45730007
414100******************************************************************45740007
414200                                                                  45750007
414300 5900-CHECK-OVERFLOW.                                             45760007
414400                                                                  45770007
414500     SET EXT-INDEX UP BY +1.                                      45780007
414600                                                                  45790007
414700     IF EXT-INDEX > PC-EXTRACT-TBL-LIMIT                          45800007
414800       DISPLAY  '***********************************************' 45810007
414900       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 45820007
415000       DISPLAY  '** PROGRAM = TRKUP008                        **' 45830007
415100       DISPLAY  '** PARAGRAPGH  - 5900-CHECK-OVERFLOW         **' 45840007
415200       DISPLAY  '**                                           **' 45850007
415300       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 45860007
415400       DISPLAY  '**                                           **' 45870007
415500       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 45880007
415600       DISPLAY  '**                                           **' 45890007
415700       DISPLAY  '**              PV-EXTRACT-TABLE             **' 45900007
415800       DISPLAY  '**                                           **' 45910007
415900       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 45920007
416000       DISPLAY  '**                                           **' 45930007
416100       DISPLAY  '**              PC-EXTRACT-TBL-LIMIT         **' 45940007
416200       DISPLAY  '**                                           **' 45950007
416300       DISPLAY  '** CONTAINER ID = ' IMCNTK-CONTNR-ID             45960007
416400       DISPLAY  '** CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR        45970007
416500       DISPLAY  '** PO NUMBER    = ' IMCNPO-PO-NBR                45980007
416600       DISPLAY  '**                                           **' 45990007
416700       DISPLAY  '***********************************************' 46000007
416800       PERFORM 9100-SQL-ABEND                                     46010007
416900     END-IF.                                                      46020007
417000                                                                  46030007
417100******************************************************************46040007
417200* 6000-INSERT-EXTRACT-REC.                                      * 46050007
417300******************************************************************46060007
417400 6000-INSERT-EXTRACT-REC.                                         46070007
417500                                                                  46080007
417600     EXEC SQL                                                     46090007
417700         INSERT INTO TOUTTR2                                      46100007
417800             (TRGL_EDI_PO_ODR)                                    46110007
417900            VALUES  (:OUTTR2-TRGL-EDI-PO-ODR)                     46120007
418000     END-EXEC                                                     46130007
418100                                                                  46140007
418200     EVALUATE TRUE                                                46150007
418300         WHEN SQLWARN0 NOT EQUAL SPACE                            46160007
418400         WHEN SQLCODE NOT EQUAL ZERO                              46170007
418500             DISPLAY '** ABEND **'                                46180007
418600             DISPLAY '** PROGRAM = TRKUP008 **'                   46190007
418700             DISPLAY '** PARAGRAPH = 6000-INSERT-EXTRACT-REC**'   46200007
418800             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR2**'         46210007
418900             PERFORM 9100-SQL-ABEND                               46220007
419000     END-EVALUATE.                                                46230007
419100                                                                  46240007
419200     ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT.                         46250007
419300                                                                  46260007
419400 EJECT                                                            46270007
419500******************************************************************46280007
419600*    SELECT CHECKPOINT RESTART CONTROL INFO.                     *46290007
419700******************************************************************46300007
419800 6500-GET-CHECKPOINT-CNTL.                                        46310007
419900                                                                  46320007
420000     EXEC SQL                                                     46330007
420100      SELECT CKPT_STAT_CODE                                       46340007
420200       INTO :PV-CKPT-STAT-CODE                                    46350007
420300       FROM TCKRSTCNTL                                            46360007
420400       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 46370007
420500     END-EXEC.                                                    46380007
420600                                                                  46390007
420700                                                                  46400007
420800     EVALUATE TRUE                                                46410007
420900         WHEN SQLWARN0 NOT EQUAL SPACE                            46420007
421000         WHEN SQLCODE NOT EQUAL ZERO                              46430007
421100             DISPLAY '** ABEND **'                                46440007
421200             DISPLAY '** PROGRAM = TRKUP008 **'                   46450007
421300             DISPLAY '** PARAGRAPH = 6500-GET-CHECKPOINT-CNTL**'  46460007
421400             DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART*'   46470007
421500             PERFORM 9100-SQL-ABEND                               46480007
421600     END-EVALUATE.                                                46490007
421700                                                                  46500007
421800 EJECT                                                            46510007
421900******************************************************************46520007
422000 6550-CHECKPOINT-RESTART.                                         46530007
422100                                                                  46540007
422200     PERFORM 6560-GET-CHECKPOINT-INFO.                            46550007
422300     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO PV-CKPT-RESTART-INFO.  46560007
422400                                                                  46570007
422500     DISPLAY '** TRKUP008 CHECKPOINT RESTART **'.                 46580007
422600     DISPLAY '** TOTAL OUTPUT RECORD COUNT AT RESTART = '         46590007
422700              PV-RESTART-TOT-OUT-REC-COUNT.                       46600007
422800     DISPLAY '***********************************************'    46610007
422900                                                                  46620007
423000     MOVE PV-RESTART-TOT-OUT-REC-COUNT    TO                      46630007
423100         PA-TOTAL-OUTPUT-REC-COUNT.                               46640007
423200                                                                  46650007
423300     MOVE PV-RESTART-ERROR-COUNT          TO                      46660007
423400         PA-ERROR-COUNT.                                          46670007
423500                                                                  46680007
423600                                                                  46690007
423700******************************************************************46700007
423800*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.      *46710007
423900******************************************************************46720007
424000 6560-GET-CHECKPOINT-INFO.                                        46730007
424100                                                                  46740007
424200     EXEC SQL                                                     46750007
424300      SELECT WORK_STRG_DESC                                       46760007
424400       INTO :TCKRSTINF-WORK-STRG-DESC                             46770007
424500       FROM TCKRSTINF                                             46780007
424600      WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                  46790007
424700     END-EXEC.                                                    46800007
424800                                                                  46810007
424900     EVALUATE TRUE                                                46820007
425000         WHEN SQLWARN0 NOT EQUAL SPACE                            46830007
425100         WHEN SQLCODE NOT EQUAL ZERO                              46840007
425200             DISPLAY '** ABEND **'                                46850007
425300             DISPLAY '** PROGRAM = TRKUP008 **'                   46860007
425400             DISPLAY '** PARAGRAPH = 6560-GET-CHECKPOINT-INFO**'  46870007
425500             DISPLAY '** GETTING RESTART WORKING STORAGE INFO**'  46880007
425600             PERFORM 9100-SQL-ABEND                               46890007
425700     END-EVALUATE.                                                46900007
425800                                                                  46910007
425900 EJECT                                                            46920007
426000******************************************************************46930007
426100*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *46940007
426200*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *46950007
426300******************************************************************46960007
426400 6570-UPDATE-TCKRSTCNTL.                                          46970007
426500                                                                  46980007
426600     EXEC SQL                                                     46990007
426700       UPDATE TCKRSTCNTL                                          47000007
426800       SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                  47010007
426900       WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME            47020007
427000     END-EXEC.                                                    47030007
427100                                                                  47040007
427200     EVALUATE TRUE                                                47050007
427300         WHEN SQLWARN0 NOT EQUAL SPACE                            47060007
427400         WHEN SQLCODE NOT EQUAL ZERO                              47070007
427500             DISPLAY '** ABEND **'                                47080007
427600             DISPLAY '** PROGRAM = TRKUP008 **'                   47090007
427700             DISPLAY '** PARAGRAPH = 6570-UPDATE-TCKRSTCNTL**'    47100007
427800             DISPLAY '** GETTING RESTART INFORMATION AFTER ABEND*'47110007
427900             PERFORM 9100-SQL-ABEND                               47120007
428000     END-EVALUATE.                                                47130007
428100                                                                  47140007
428200 EJECT                                                            47150007
428300******************************************************************47160007
428400*    UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS     *47170007
428500*    INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND*47180007
428600******************************************************************47190007
428700 6580-UPDATE-TCKRSTINF.                                           47200007
428800                                                                  47210007
428900     MOVE PA-TOTAL-OUTPUT-REC-COUNT       TO                      47220007
429000         PV-RESTART-TOT-OUT-REC-COUNT.                            47230007
429100     MOVE PA-ERROR-COUNT                  TO                      47240007
429200         PV-RESTART-ERROR-COUNT.                                  47250007
429300     MOVE PV-CKPT-RESTART-INFO            TO                      47260007
429400         TCKRSTINF-WORK-STRG-DESC-TEXT.                           47270007
429500     MOVE 4022                            TO                      47280007
429600         TCKRSTINF-WORK-STRG-DESC-LEN.                            47290007
429700                                                                  47300007
429800     EXEC SQL                                                     47310007
429900        UPDATE TCKRSTINF                                          47320007
430000         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         47330007
430100         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          47340007
430200     END-EXEC.                                                    47350007
430300                                                                  47360007
430400     EVALUATE TRUE                                                47370007
430500         WHEN SQLWARN0 NOT EQUAL SPACE                            47380007
430600         WHEN SQLCODE NOT EQUAL ZERO                              47390007
430700             DISPLAY '** ABEND **'                                47400007
430800             DISPLAY '** PROGRAM = TRKUP008 **'                   47410007
430900             DISPLAY '** PARAGRAPH = 6580-UPDATE-TCKRSTINF**'     47420007
431000             DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF**'         47430007
431100             PERFORM 9100-SQL-ABEND                               47440007
431200     END-EVALUATE.                                                47450007
431300                                                                  47460007
431400 EJECT                                                            47470007
155029******************************************************************47480073
155029*  FOR FAST FASHION CHECK TO SEE IF THIS DEPARTMENT NUMBER IS    *47490073
155029*  ONE OF THE FAST FASHION DEPARTMENT NUMBERS                    *47500073
155029******************************************************************47510073
155029 6600-FAST-PARM-CHECK.                                            47520073
155029                                                                  47530073
155029     MOVE PURCHS-DEPT-NBR  TO PV-DEPT-NBR.                        47540073
155029     MOVE SPACES           TO PV-FAST-RDC-IND                     47550073
155029                              PV-FAST-EFC-IND.                    47560073
155029                                                                  47570073
155029     EXEC SQL                                                     47580073
155029         SELECT  D.ATTR_ELEM_TXT AS RDC_IND                       47590073
155029                ,E.ATTR_ELEM_TXT AS EFC_IND                       47600073
155029           INTO :PV-FAST-RDC-IND                                  47610073
155029               ,:PV-FAST-EFC-IND                                  47620073
155029           FROM WST_INTGRTN_TYP A                                 47630073
155029               ,WST_ATTR_DEFN   B                                 47640073
155029               ,WST_ATTR_ELEM   C                                 47650073
155029               ,WST_ATTR_ELEM   D                                 47660073
155029               ,WST_ATTR_ELEM   E                                 47670073
155029               ,WST_ATTR_ELEM   F                                 47680073
155029               ,WST_ATTR_ELEM   G                                 47690073
155029          WHERE A.INTGRTN_TYP_CDE   = 'FASTFSHDPT'                47700073
155029            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           47710073
155029            AND B.ATTR_DEFN_SEQ_NBR = 1                           47720073
155029            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           47730073
155029            AND C.ATTR_DEFN_SEQ_NBR = 1                           47740073
155029            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           47750073
155029            AND D.ATTR_DEFN_SEQ_NBR = 2                           47760073
155029            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           47770073
155029            AND E.ATTR_DEFN_SEQ_NBR = 3                           47780073
155029            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           47790073
155029            AND F.ATTR_DEFN_SEQ_NBR = 4                           47800073
155029            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           47810073
155029            AND G.ATTR_DEFN_SEQ_NBR = 5                           47820073
155029            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         47830073
155029            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         47840073
155029            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         47850073
155029            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         47860073
155029            AND C.ATTR_ELEM_NBR     = :PV-DEPT-NBR                47870073
155029            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           47880073
155029            AND G.ATTR_ELEM_TMST = '9999-12-31-23.59.59.999999'   47890073
155029          WITH UR                                                 47900073
155029     END-EXEC.                                                    47910073
155029                                                                  47920073
155029     EVALUATE TRUE                                                47930073
155029          WHEN SQLCODE = +0                                       47940073
155029               CONTINUE                                           47950073
155029                                                                  47960073
155029          WHEN SQLCODE = +100                                     47970073
155029               MOVE 'N'          TO PV-FAST-RDC-IND               47980073
155029                                    PV-FAST-EFC-IND               47990073
155029                                                                  48000073
155029          WHEN OTHER                                              48010073
155029            DISPLAY '** ABEND **'                                 48020073
155029            DISPLAY '** PROGRAM = TRKUP008 **'                    48030073
155029            DISPLAY '** PARAGRAPH = 6600-FAST-PARM-CHECK **'      48040073
155029            DISPLAY '** IMCNPO-PO-NBR   = ' IMCNPO-PO-NBR         48050073
155029            DISPLAY '** PURCHS-DEPT-NBR = ' PURCHS-DEPT-NBR       48060073
155029            DISPLAY '** UNSUCCESSFUL SELECT OF FAST PARM**'       48070073
155029            PERFORM 9100-SQL-ABEND                                48080073
155029     END-EVALUATE.                                                48090073
155029                                                                  48100073
155029 EJECT                                                            48110073
431500******************************************************************48120007
431600* OPEN DRIVER (TRIP) CURSOR FOR CON TRANSMISSIONS.                48130007
431700******************************************************************48140007
431800 7000-OPEN-DRIVER-CURSOR.                                         48150007
431900                                                                  48160007
432000     EXEC SQL                                                     48170007
432100          OPEN CMN_DRIVER_CUR                                     48180007
432200     END-EXEC.                                                    48190007
432300                                                                  48200007
432400     EVALUATE TRUE                                                48210007
432500         WHEN SQLWARN0 NOT EQUAL SPACE                            48220007
432600         WHEN SQLCODE NOT EQUAL ZERO                              48230007
432700             DISPLAY '** ABEND **'                                48240007
432800             DISPLAY '** PROGRAM = TRKUP008 **'                   48250007
432900             DISPLAY                                              48260007
433000                '** PARAGRAPH = 7000-OPEN-DRIVER-CURSOR **'       48270007
433100             PERFORM 9100-SQL-ABEND                               48280007
433200     END-EVALUATE.                                                48290007
433300                                                                  48300007
433400*                                                                 48310007
433500******************************************************************48320007
433600* CLOSE CURSOR FOR COM TRANSMISSIONS.                            *48330007
433700******************************************************************48340007
433800 7010-CLOSE-DRIVER-CURSOR.                                        48350007
433900                                                                  48360007
434000                                                                  48370007
434100     EXEC SQL                                                     48380007
434200         CLOSE CMN_DRIVER_CUR                                     48390007
434300     END-EXEC.                                                    48400007
434400                                                                  48410007
434500     EVALUATE TRUE                                                48420007
434600         WHEN SQLWARN0 NOT EQUAL SPACE                            48430007
434700         WHEN SQLCODE NOT EQUAL ZERO                              48440007
434800             DISPLAY '** ABEND **'                                48450007
434900             DISPLAY '** PROGRAM = TRKUP008 **'                   48460007
435000             DISPLAY                                              48470007
435100               '** PARAGRAPH = 7010-CLOSE-DRIVER-CURSOR**'        48480007
435200             PERFORM 9100-SQL-ABEND                               48490007
435300     END-EVALUATE.                                                48500007
435400                                                                  48510007
435500******************************************************************48520007
435600* FETCH AND VALIDATE CURSOR FOR CMN TRANSMISSIONS                *48530007
435700*   - CHECK TIMPORL TO MAKE SURE PO IS NOT SET FOR CON RETRANS.  *48540007
435800*   - IF IT PASSES ABOVE TEST, CHECK THAT NO UPC IS ON MULTIPLE  *48550007
435900*     PACKS FOR A EACH PO.  IF ALL THE PO'S ARE MULTIS, DON'T    *48560007
436000*     PROCESS THE CONTAINER.                                     *48570007
436100******************************************************************48580007
436200 7020-FETCH-VALIDATE-DRIVER-CUR.                                  48590007
436300                                                                  48600007
436400     PERFORM 7022-FETCH-DRIVER-CURSOR.                            48610007
436500                                                                  48620007
436600     IF PS-EOC-DRIVER-CURSOR                                      48630007
436700       CONTINUE                                                   48640007
436800     ELSE                                                         48650007
436900       MOVE IMCNPO-PO-NBR                    TO TR006-PO-NBR      48660007
437000       SET PS-CMN-PASSES-XMIT-TEST           TO TRUE              48670007
437100*      ***********************************************************48680007
437200*      * CHECK IMPORL FOR CON RETRANS.                           *48690007
437300*      ***********************************************************48700007
437400       SET PS-PO-IS-CON-RETRAN-NO            TO TRUE              48710007
437500       PERFORM 7025-SELECT-TIMPORL                                48720007
437600       IF PS-PO-IS-CON-RETRAN                                     48730007
437700          SET PS-CMN-PASSES-XMIT-TEST-NO     TO TRUE              48740007
437800       END-IF                                                     48750007
437900     END-IF.                                                      48760007
438000                                                                  48770007
438100******************************************************************48780007
438200* FETCH CURSOR FOR CMN TRANSMISSIONS                             *48790007
438300******************************************************************48800007
438400 7022-FETCH-DRIVER-CURSOR.                                        48810007
438500                                                                  48820007
438600     EXEC SQL                                                     48830007
438700          FETCH CMN_DRIVER_CUR                                    48840007
438800          INTO                                                    48850007
438900                 :IMCNTK-MOM-POE-DELY-TMST                        48860007
439000               , :IMCNTK-MOM-IMPRT-VEH-NM                         48870007
439100               , :IMCNTK-MOM-TRIP-TYP-CDE                         48880007
439200               , :IMCNTK-MOM-DEST-POE-CDE                         48890007
439300               , :IMCNTK-CONTNR-ID                                48900007
439400               , :IMCNTK-CONTNR-SEQ-NBR                           48910007
439500               , :IMCNPO-PO-NBR                                   48920007
439600               , :IMCNPO-EXTL-REF-NBR                             48930007
439700               , :IMCNPO-SPLT-XMIT-CDE                            48940007
439800               , :IMCNPO-PO-UNT-QTY                               48950007
439900               , :IMCNPO-PO-CBMT-QTY                              48960007
440000               , :IMCNPO-PO-WT-KGRM-QTY                           48970007
440100               , :IMCNTK-MOM-IMPRT-TRIP-ID                        48980007
440200               , :IMCNTK-MOM-CARR-SCAC-ID                         48990007
440300               , :IMCNTK-SIZE-CDE                                 49000007
440400     END-EXEC.                                                    49010007
440500                                                                  49020007
440600     EVALUATE TRUE                                                49030007
440700         WHEN SQLCODE = ZERO                                      49040007
440800            CONTINUE                                              49050007
440900                                                                  49060007
441000         WHEN SQLCODE = +100                                      49070007
441100              SET PS-EOC-DRIVER-CURSOR                            49080007
441200                               TO  TRUE                           49090007
441300                                                                  49100007
441400         WHEN SQLWARN0 NOT EQUAL SPACE                            49110007
441500         WHEN SQLCODE NOT EQUAL ZERO                              49120007
441600             DISPLAY '** ABEND **'                                49130007
441700             DISPLAY '** PROGRAM = TRKUP008 **'                   49140007
441800             DISPLAY                                              49150007
441900                 '** PARAGRAPH = 7022-FETCH-DRIVER-CURSOR**'      49160007
442000             PERFORM 9100-SQL-ABEND                               49170007
442100     END-EVALUATE.                                                49180007
442200                                                                  49190007
442300******************************************************************49200007
442400* CHECK IF ANY PO FOR THIS CONTAINER FOUND ON TIMPORL            *49210007
442500******************************************************************49220007
442600 7025-SELECT-TIMPORL.                                             49230007
442700                                                                  49240007
442800     EXEC SQL                                                     49250007
442900          SELECT                                                  49260007
443000                PORL.DCONSLR_RLSE_CDE                             49270007
443100          INTO :IMPORL-DCONSLR-RLSE-CDE                           49280007
443200          FROM TIMPORL  PORL                                      49290007
443300          WHERE   PORL.PO_NBR  =  :IMCNPO-PO-NBR                  49300007
443400            AND PORL.VER_STATUS_CDE  = 'A'                        49310007
443500            AND (   (PORL.DCONSLR_RLSE_CDE  IN ('Y','R','S') )    49320007
443600                 OR (PORL.DCONSLR_RLSE_CDE  = 'D'  AND            49330007
443700                  PORL.DCONSLR_ACTL_DTE  < '9999-09-09')  )       49340007
443800     END-EXEC.                                                    49350007
443900                                                                  49360007
444000     EVALUATE TRUE                                                49370007
444100                                                                  49380007
444200         WHEN SQLCODE = ZERO                                      49390007
444300         WHEN SQLCODE = -811                                      49400007
444400            SET PS-PO-IS-CON-RETRAN  TO TRUE                      49410007
444500                                                                  49420007
444600         WHEN SQLCODE = +100                                      49430007
444700            CONTINUE                                              49440007
444800                                                                  49450007
444900         WHEN SQLWARN0 NOT EQUAL SPACE                            49460007
445000         WHEN SQLCODE NOT EQUAL ZERO                              49470007
445100             DISPLAY '** ABEND **'                                49480007
445200             DISPLAY '** PROGRAM = TRKUP008 **'                   49490007
445300             DISPLAY                                              49500007
445400                 '** PARAGRAPH = 7025-SELECT-ANY-SPLT-XMIT **'    49510007
445500             PERFORM 9100-SQL-ABEND                               49520007
445600     END-EVALUATE.                                                49530007
445700                                                                  49540007
445800******************************************************************49550007
445900* TAKE MOM_DEST_POE CONVERT TO TIMPOE FOR CURSOR TO POE CITY.    *49560007
446000******************************************************************49570007
446100 7100-GET-POE-CITY.                                               49580007
446200                                                                  49590007
446300     SET PS-POE-CITY-FOUND-NO   TO TRUE.                          49600007
446400     SET PS-POE-ON-TIMPOE-NO    TO TRUE.                          49610007
446500     PERFORM 7105-SELECT-POE-CD                                   49620007
446600       IF PS-POE-ON-TIMPOE                                        49630007
446700         SET PS-EOC-POE-CURSOR-NO  TO TRUE                        49640007
446800         PERFORM 7110-OPEN-POE-CURSOR                             49650007
446900         PERFORM 7120-FETCH-POE-CURSOR                            49660007
447000         IF PS-EOC-POE-CURSOR                                     49670007
447100            CONTINUE                                              49680007
447200         ELSE                                                     49690007
447300            SET PS-POE-CITY-FOUND   TO TRUE                       49700007
447400         END-IF                                                   49710007
447500         PERFORM 7115-CLOSE-POE-CURSOR                            49720007
447600       END-IF.                                                    49730007
447700                                                                  49740007
447800******************************************************************49750007
447900* SELECT POE ROW USING TIMCNTK.MOM_DEST_POE_CDE                  *49760007
448000******************************************************************49770007
448100 7105-SELECT-POE-CD.                                              49780007
448200                                                                  49790007
448300     EXEC SQL                                                     49800007
448400           SELECT DISTINCT                                        49810007
448500               P.POE_CDE                                          49820007
448600             INTO                                                 49830007
448700              :IMPOE-POE-CDE                                      49840007
448800             FROM                                                 49850007
448900               TIMPOE  P                                          49860007
449000             WHERE P.POE_STD_EDI_CDE = :IMCNTK-MOM-DEST-POE-CDE   49870007
449100               AND P.STAT_CDE = 'A'                               49880007
449200     END-EXEC.                                                    49890007
449300                                                                  49900007
449400                                                                  49910007
449500     EVALUATE TRUE                                                49920007
449600                                                                  49930007
449700         WHEN SQLCODE = ZERO                                      49940007
449800         WHEN SQLCODE = -811                                      49950007
449900            SET PS-POE-ON-TIMPOE   TO TRUE                        49960007
450000                                                                  49970007
450100         WHEN SQLCODE = +100                                      49980007
450200            CONTINUE                                              49990007
450300                                                                  50000007
450400         WHEN SQLWARN0 NOT EQUAL SPACE                            50010007
450500         WHEN SQLCODE NOT EQUAL ZERO                              50020007
450600             DISPLAY '** ABEND **'                                50030007
450700             DISPLAY '** PROGRAM = TRKUP008 **'                   50040007
450800             DISPLAY                                              50050007
450900                 '** PARAGRAPH = 7105-SELECT-POE-CD **'           50060007
451000             PERFORM 9100-SQL-ABEND                               50070007
451100     END-EVALUATE.                                                50080007
451200******************************************************************50090007
451300* OPEN CURSOR TO OBTAIN POE CITY FROM TIMPOE.                    *50100007
451400******************************************************************50110007
451500 7110-OPEN-POE-CURSOR.                                            50120007
451600                                                                  50130007
451700     EXEC SQL                                                     50140007
451800          OPEN POE_CUR                                            50150007
451900     END-EXEC.                                                    50160007
452000                                                                  50170007
452100     EVALUATE TRUE                                                50180007
452200         WHEN SQLWARN0 NOT EQUAL SPACE                            50190007
452300         WHEN SQLCODE NOT EQUAL ZERO                              50200007
452400             DISPLAY '** ABEND **'                                50210007
452500             DISPLAY '** PROGRAM = TRKUP008 **'                   50220007
452600             DISPLAY                                              50230007
452700                '** PARAGRAPH = 7110-OPEN-POE-CURSOR **'          50240007
452800             PERFORM 9100-SQL-ABEND                               50250007
452900     END-EVALUATE.                                                50260007
453000*                                                                 50270007
453100 EJECT                                                            50280007
453200******************************************************************50290007
453300* CLOSE CURSOR FOR TIMPOE.                                       *50300007
453400******************************************************************50310007
453500 7115-CLOSE-POE-CURSOR.                                           50320007
453600                                                                  50330007
453700                                                                  50340007
453800     EXEC SQL                                                     50350007
453900         CLOSE POE_CUR                                            50360007
454000     END-EXEC.                                                    50370007
454100                                                                  50380007
454200     EVALUATE TRUE                                                50390007
454300         WHEN SQLWARN0 NOT EQUAL SPACE                            50400007
454400         WHEN SQLCODE NOT EQUAL ZERO                              50410007
454500             DISPLAY '** ABEND **'                                50420007
454600             DISPLAY '** PROGRAM = TRKUP008 **'                   50430007
454700             DISPLAY                                              50440007
454800               '** PARAGRAPH = 7115-CLOSE-POE-CURSOR**'           50450007
454900             PERFORM 9100-SQL-ABEND                               50460007
455000     END-EVALUATE.                                                50470007
455100                                                                  50480007
455200*                                                                 50490007
455300******************************************************************50500007
455400* FETCH CURSOR FOR POE CITY FROM TIMPOE.                         *50510007
455500******************************************************************50520007
455600 7120-FETCH-POE-CURSOR.                                           50530007
455700                                                                  50540007
455800     EXEC SQL                                                     50550007
455900          FETCH POE_CUR                                           50560007
456000          INTO                                                    50570007
456100                 :IMPOE-POE-STD-EDI-CDE                           50580007
456200                ,:IMPOE-POE-CTY-NM                                50590007
456300     END-EXEC.                                                    50600007
456400                                                                  50610007
456500     EVALUATE TRUE                                                50620007
456600         WHEN SQLCODE = ZERO                                      50630007
456700                 CONTINUE                                         50640007
456800                                                                  50650007
456900         WHEN SQLCODE = +100                                      50660007
457000              SET PS-EOC-POE-CURSOR                               50670007
457100                               TO  TRUE                           50680007
457200                                                                  50690007
457300         WHEN SQLWARN0 NOT EQUAL SPACE                            50700007
457400         WHEN SQLCODE NOT EQUAL ZERO                              50710007
457500             DISPLAY '** ABEND **'                                50720007
457600             DISPLAY '** PROGRAM = TRKUP008 **'                   50730007
457700             DISPLAY                                              50740007
457800                 '** PARAGRAPH = 7120-FETCH-POE-CURSOR**'         50750007
457900             PERFORM 9100-SQL-ABEND                               50760007
458000     END-EVALUATE.                                                50770007
458100                                                                  50780007
458200******************************************************************50790007
458300 7800-VALIDATE-PO.                                                50800007
458400                                                                  50810007
458500      PERFORM 7822-CHECK-UNCONFIRMED-PACKS.                       50820007
458600      IF PS-PO-PASSES-XMIT-TEST                                   50830007
458700        PERFORM 7825-SELECT-UNTIED-LINES                          50840007
458800      END-IF.                                                     50850007
458900                                                                  50860007
459000******************************************************************50870007
459100 7822-CHECK-UNCONFIRMED-PACKS.                                    50880007
459200                                                                  50890007
459300     INITIALIZE  PV-DB2-COUNT.                                    50900007
459400                                                                  50910007
459500     EXEC SQL                                                     50920007
459600         SELECT COUNT (*)                                         50930007
459700           INTO :PV-DB2-COUNT                                     50940007
459800           FROM TPURITM  A                                        50950007
459900               ,TPURCHS  B                                        50960007
460000          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 50970007
460100            AND A.VER_STATUS_CDE = :PC-A                          50980007
460200            AND A.STATUS_CDE     = 'RV'                           50990007
460300            AND B.PO_NBR         =  A.PO_NBR                      51000007
460400            AND B.VER_STATUS_CDE = :PC-A                          51010007
460500            AND B.PKGNG_CDE      IN ('M','I')                     51020007
460600     END-EXEC                                                     51030007
460700                                                                  51040007
460800     EVALUATE TRUE                                                51050007
460900         WHEN SQLCODE = ZERO                                      51060007
461000         WHEN SQLCODE = -811                                      51070007
461100           IF PV-DB2-COUNT = ZERO                                 51080007
461200             CONTINUE                                             51090007
461300           ELSE                                                   51100007
461400             SET PS-PO-PASSES-XMIT-TEST-NO  TO TRUE               51110007
461500             SET TR006-ERROR-TYPE-ERROR     TO TRUE               51120007
461600             IF SKXREF-DEPT NUMERIC                               51130007
461700              IF SKXREF-DEPT > ZEROES                             51140007
461800                 MOVE SKXREF-DEPT       TO TR006-DEPT-NBR         51150007
461900              END-IF                                              51160007
462000             END-IF                                               51170007
462100             MOVE PURCHS-PKGNG-CDE      TO TR006-PKGNG-CDE        51180007
462200             INITIALIZE TR006-UPC-NBR                             51190007
462300                        TR006-ERROR-MSG                           51200007
462400             STRING 'CMN-UNCONFIRMED PACKS'                       51210007
462500                 DELIMITED BY SIZE                                51220007
462600                 INTO TR006-ERROR-MSG                             51230007
462700             PERFORM 8830-WRITE-ERROR-LINE                        51240007
462800           END-IF                                                 51250007
462900                                                                  51260007
463000         WHEN SQLCODE = +100                                      51270007
463100             CONTINUE                                             51280007
463200                                                                  51290007
463300         WHEN SQLWARN0 NOT EQUAL SPACE                            51300007
463400         WHEN SQLCODE NOT EQUAL ZERO                              51310007
463500             DISPLAY '**************************************'     51320007
463600             DISPLAY '** ABEND                            **'     51330007
463700             DISPLAY '** PROGRAM = TRKUP008               **'     51340007
463800             DISPLAY '** PARAGRAPH = 7822-CHECK-UNCONFIRMED-PACKS'51350007
463900             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              51360007
464000             DISPLAY '**************************************'     51370007
464100             PERFORM 9100-SQL-ABEND                               51380007
464200     END-EVALUATE.                                                51390007
464300                                                                  51400007
464400******************************************************************51410007
464500 7825-SELECT-UNTIED-LINES.                                        51420007
464600                                                                  51430007
464700     EXEC SQL                                                     51440007
464800         SELECT A.PO_NBR                                          51450007
464900               ,B.PKGNG_CDE                                       51460007
465000           INTO :PURITM-PO-NBR                                    51470007
465100               ,:PURCHS-PKGNG-CDE                                 51480007
465200           FROM TPURITM  A                                        51490007
465300               ,TPURCHS  B                                        51500007
465400          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 51510007
465500            AND A.VER_STATUS_CDE = :PC-A                          51520007
465600            AND A.STATUS_CDE     IN ('AC', 'AP')                  51530007
465700            AND A.PO_PREPK_ID    =  0                             51540007
465800            AND B.PO_NBR         =  A.PO_NBR                      51550007
465900            AND B.VER_STATUS_CDE = :PC-A                          51560007
466000            AND B.PKGNG_CDE      IN ('M','I')                     51570007
466100     END-EXEC                                                     51580007
466200                                                                  51590007
466300     EVALUATE TRUE                                                51600007
466400         WHEN SQLCODE = ZERO                                      51610007
466500         WHEN SQLCODE = -811                                      51620007
466600             SET TR006-ERROR-TYPE-ERROR TO TRUE                   51630007
466700             IF SKXREF-DEPT NUMERIC                               51640007
466800              IF SKXREF-DEPT > ZEROES                             51650007
466900                 MOVE SKXREF-DEPT       TO TR006-DEPT-NBR         51660007
467000              END-IF                                              51670007
467100             END-IF                                               51680007
467200             MOVE PURCHS-PKGNG-CDE      TO TR006-PKGNG-CDE        51690007
467300             INITIALIZE TR006-UPC-NBR                             51700007
467400                        TR006-ERROR-MSG                           51710007
467500             STRING 'CMN-PK DTL UPC NT TIED TO PCK-FX'            51720007
467600                 DELIMITED BY SIZE                                51730007
467700                 INTO TR006-ERROR-MSG                             51740007
467800             PERFORM 8830-WRITE-ERROR-LINE                        51750007
467900                                                                  51760007
468000         WHEN SQLCODE = +100                                      51770007
468100             CONTINUE                                             51780007
468200                                                                  51790007
468300         WHEN SQLWARN0 NOT EQUAL SPACE                            51800007
468400         WHEN SQLCODE NOT EQUAL ZERO                              51810007
468500             DISPLAY '**************************************'     51820007
468600             DISPLAY '** ABEND                            **'     51830007
468700             DISPLAY '** PROGRAM = TRKUP008               **'     51840007
468800             DISPLAY '** PARAGRAPH = 7825-SELECT-UNTIED-LINES'    51850007
468900             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              51860007
469000             DISPLAY '**************************************'     51870007
469100             PERFORM 9100-SQL-ABEND                               51880007
469200     END-EVALUATE.                                                51890007
469300                                                                  51900007
469400 EJECT                                                            51910007
155029******************************************************************51920073
155029 7830-RETRIEVE-PLAN-NBR.                                          51930073
155029                                                                  51940073
155029     EXEC SQL                                                     51950073
155029           SELECT DISTINCT AL.PLAN_NBR                            51960073
155029             INTO :ALLPLN-PLAN-NBR                                51970073
155029             FROM TIMCNUP   CNUP                                  51980073
155029                 ,TUPCSKU   SKU                                   51990073
155029                 ,TPURITM   PUR                                   52000073
155029                 ,TALLPLN   AL                                    52010073
155029                 ,TMESTDS   ES                                    52020073
155029             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        52030073
155029               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   52040073
155029               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          52050073
155029               AND AL.DEST_NBR         = :ALLPLN-DEST-NBR         52060073
155029               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            52070073
155029               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           52080073
155029               AND PUR.VER_STATUS_CDE  = 'A'                      52090073
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             52100073
155029               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          52110073
155029               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           52120073
155029               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         52130073
155029               AND AL.PO_NBR           =  PUR.PO_NBR              52140073
155029               AND AL.PO_NBR           =  CNUP.PO_NBR             52150073
155029               AND AL.PLAN_NBR         =  ES.PLAN_NBR             52160073
155029               AND PUR.PO_NBR          =  ES.PO_NBR               52170073
155029               AND ES.STR_DISTRO_QTY  >  0                        52180073
155029     END-EXEC.                                                    52190073
155029                                                                  52200073
155029     EVALUATE TRUE                                                52210073
155029         WHEN SQLCODE = ZERO                                      52220073
155029             CONTINUE                                             52230073
155029                                                                  52240073
155029         WHEN SQLCODE = +100                                      52250073
155029             SET PS-EOC-STORE-CURSOR                              52260073
155029                 PS-EOC-PREPACK-DC-CURSOR                         52270073
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             52280073
JNSINC*        MOVE '7830-RETRIEVE-PLAN-NBR' TO PV-PARA-NAME            52281085
JNSINC*        DISPLAY PV-PARA-NAME                                     52282085
JNSINC         DISPLAY IMCNTK-CONTNR-ID                                 52283085
JNSINC         DISPLAY IMCNTK-CONTNR-SEQ-NBR                            52284085
JNSINC         DISPLAY IMCNUP-UPC-NBR                                   52285085
JNSINC         DISPLAY ALLPLN-DEST-NBR                                  52286085
JNSINC         DISPLAY IMCNPO-PO-NBR                                    52287085
155029             PERFORM 8425-CLOSE-PACK-DC-CURSOR                    52290073
155029             INITIALIZE TR006-UPC-NBR                             52300073
155029                        TR006-ERROR-MSG                           52310073
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             52320073
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              52330073
155029                     DELIMITED BY SIZE                            52340073
155029                     INTO TR006-ERROR-MSG                         52350073
155029             MOVE IMCNUP-SKU-NBR   TO  TR006-SKU                  52360073
155029             PERFORM 8830-WRITE-ERROR-LINE                        52370073
155029                                                                  52380073
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            52390073
155029         WHEN SQLCODE NOT EQUAL ZERO                              52400073
155029             DISPLAY '**************************************'     52410073
155029             DISPLAY '** ABEND                            **'     52420073
155029             DISPLAY '** PROGRAM = TRKUP008               **'     52430073
155029             DISPLAY '** PARAGRAPH = 7830-RETRIEVE-PLAN-NBR'      52440073
155029             DISPLAY '** CONTAINER = ' IMCNTK-CONTNR-ID           52450073
155029             DISPLAY '** CONT SEQ# = ' IMCNTK-CONTNR-SEQ-NBR      52460073
155029             DISPLAY '** UPC NBR   = ' IMCNUP-UPC-NBR             52470073
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            52480073
155029             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              52490073
155029             DISPLAY '**************************************'     52500073
155029             PERFORM 9100-SQL-ABEND                               52510073
155029     END-EVALUATE.                                                52520073
155029                                                                  52530073
155029 EJECT                                                            52540073
155029******************************************************************52550073
155029 7835-RETRIEVE-PLAN-NBR.                                          52560073
155029                                                                  52570073
155029     EXEC SQL                                                     52580073
155029         SELECT DISTINCT(PLAN_NBR)                                52590073
155029           INTO :ALLPLN-PLAN-NBR                                  52600073
155029           FROM TALLPLN                                           52610073
155029          WHERE PO_NBR         = :IMCNPO-PO-NBR                   52620073
155029            AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR               52630073
155029            AND DEST_NBR       = :ALLPLN-DEST-NBR                 52640073
155029            AND CURR_SPLIT_QTY >  0                               52650073
155029     END-EXEC.                                                    52660073
155029                                                                  52670073
155029     EVALUATE TRUE                                                52680073
155029         WHEN SQLCODE = ZERO                                      52690073
155029             CONTINUE                                             52700073
155029                                                                  52710073
155029         WHEN SQLCODE = +100                                      52720073
155029             SET PS-EOC-STORE-CURSOR                              52730073
155029                 PS-EOC-PREPACK-DC-CURSOR                         52740073
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             52750073
JNSINC*        MOVE '7835-RETRIEVE-PLAN-NBR' TO PV-PARA-NAME            52751085
JNSINC*        DISPLAY PV-PARA-NAME                                     52752085
155029             PERFORM 8425-CLOSE-PACK-DC-CURSOR                    52760073
155029             INITIALIZE TR006-UPC-NBR                             52770073
155029                        TR006-ERROR-MSG                           52780073
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             52790073
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              52800073
155029                     DELIMITED BY SIZE                            52810073
155029                     INTO TR006-ERROR-MSG                         52820073
155029             MOVE IMCNUP-SKU-NBR   TO  TR006-SKU                  52830073
155029             PERFORM 8830-WRITE-ERROR-LINE                        52840073
155029                                                                  52850073
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            52860073
155029         WHEN SQLCODE NOT EQUAL ZERO                              52870073
155029             DISPLAY '**************************************'     52880073
155029             DISPLAY '** ABEND                            **'     52890073
155029             DISPLAY '** PROGRAM = TRKUP008               **'     52900073
155029             DISPLAY '** PARAGRAPH = 7835-RETRIEVE-PLAN-NBR'      52910073
155029             DISPLAY '** UPC NBR   = ' IMCNUP-UPC-NBR             52920073
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            52930073
155029             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              52940073
155029             DISPLAY '** PO LNE NBR= ' PURITM-PO-LNE-NBR          52950073
155029             DISPLAY '**************************************'     52960073
155029             PERFORM 9100-SQL-ABEND                               52970073
155029     END-EVALUATE.                                                52980073
155029                                                                  52990073
155029 EJECT                                                            53000073
469500******************************************************************53010007
469600 7900-OPEN-INSTR-CURSOR.                                          53020007
469700                                                                  53030007
469800     EXEC SQL                                                     53040007
469900          OPEN INSTR_CUR                                          53050007
470000     END-EXEC.                                                    53060007
470100                                                                  53070007
470200     EVALUATE TRUE                                                53080007
470300         WHEN SQLWARN0 NOT EQUAL SPACE                            53090007
470400         WHEN SQLCODE NOT EQUAL ZERO                              53100007
470500             DISPLAY '** ABEND **'                                53110007
470600             DISPLAY '** PROGRAM = TRKUP008 **'                   53120007
470700             DISPLAY '** PARAGRAPH = 7900-OPEN-INSTR-CURSOR **'   53130007
470800             PERFORM 9100-SQL-ABEND                               53140007
470900     END-EVALUATE.                                                53150007
471000                                                                  53160007
471100*                                                                 53170007
471200******************************************************************53180007
471300 8000-CLOSE-INSTR-CURSOR.                                         53190007
471400                                                                  53200007
471500                                                                  53210007
471600     EXEC SQL                                                     53220007
471700         CLOSE INSTR_CUR                                          53230007
471800     END-EXEC.                                                    53240007
471900                                                                  53250007
472000     EVALUATE TRUE                                                53260007
472100         WHEN SQLWARN0 NOT EQUAL SPACE                            53270007
472200         WHEN SQLCODE NOT EQUAL ZERO                              53280007
472300             DISPLAY '** ABEND **'                                53290007
472400             DISPLAY '** PROGRAM = TRKUP008 **'                   53300007
472500             DISPLAY '** PARAGRAPH = 8000-CLOSE-INSTR-CURSOR**'   53310007
472600             PERFORM 9100-SQL-ABEND                               53320007
472700     END-EVALUATE.                                                53330007
472800                                                                  53340007
472900*                                                                 53350007
473000******************************************************************53360007
473100 8100-FETCH-INSTR-CURSOR.                                         53370007
473200                                                                  53380007
473300     EXEC SQL                                                     53390007
473400          FETCH INSTR_CUR                                         53400007
473500          INTO                                                    53410007
473600                  :INSTCD-INSTR-DESC                              53420007
473700                , :INSTCD-INSTR-NBR                               53430007
473800                , :POINST-RECIP-CDE                               53440007
473900     END-EXEC.                                                    53450007
474000                                                                  53460007
474100     EVALUATE TRUE                                                53470007
474200         WHEN SQLCODE = ZERO                                      53480007
474300             CONTINUE                                             53490007
474400                                                                  53500007
474500         WHEN SQLCODE = +100                                      53510007
474600              SET PS-EOC-INSTR-CURSOR                             53520007
474700                                   TO  TRUE                       53530007
474800                                                                  53540007
474900         WHEN SQLWARN0 NOT EQUAL SPACE                            53550007
475000         WHEN SQLCODE NOT EQUAL ZERO                              53560007
475100             DISPLAY '** ABEND **'                                53570007
475200             DISPLAY '** PROGRAM = TRKUP008 **'                   53580007
475300             DISPLAY '** PARAGRAPH = 8100-FETCH-INSTR-CURSOR**'   53590007
475400             PERFORM 9100-SQL-ABEND                               53600007
475500     END-EVALUATE.                                                53610007
475600                                                                  53620007
475700 EJECT                                                            53630007
475800******************************************************************53640007
475900 8200-OPEN-BULK-UPC-CUR.                                          53650007
476000                                                                  53660007
476100     EXEC SQL                                                     53670007
476200          OPEN BULK_UPC_CUR                                       53680007
476300     END-EXEC.                                                    53690007
476400                                                                  53700007
476500     EVALUATE TRUE                                                53710007
476600         WHEN SQLWARN0 NOT EQUAL SPACE                            53720007
476700         WHEN SQLCODE NOT EQUAL ZERO                              53730007
476800             DISPLAY '** ABEND **'                                53740007
476900             DISPLAY '** PROGRAM = TRKUP008 **'                   53750007
477000             DISPLAY '** PARAGRAPH = 8200-OPEN-BULK-UPC-CUR **'   53760007
477100             PERFORM 9100-SQL-ABEND                               53770007
477200     END-EVALUATE.                                                53780007
477300                                                                  53790007
477400*                                                                 53800007
477500******************************************************************53810007
477600 8300-CLOSE-BULK-UPC-CUR.                                         53820007
477700                                                                  53830007
477800                                                                  53840007
477900     EXEC SQL                                                     53850007
478000         CLOSE BULK_UPC_CUR                                       53860007
478100     END-EXEC.                                                    53870007
478200                                                                  53880007
478300     EVALUATE TRUE                                                53890007
478400         WHEN SQLWARN0 NOT EQUAL SPACE                            53900007
478500         WHEN SQLCODE NOT EQUAL ZERO                              53910007
478600             DISPLAY '** ABEND **'                                53920007
478700             DISPLAY '** PROGRAM = TRKUP008 **'                   53930007
478800             DISPLAY '** PARAGRAPH = 8300-CLOSE-BULK-UPC-CUR**'   53940007
478900             PERFORM 9100-SQL-ABEND                               53950007
479000     END-EVALUATE.                                                53960007
479100                                                                  53970007
479200*                                                                 53980007
479300******************************************************************53990007
479400 8400-FETCH-BULK-UPC-CUR.                                         54000007
479500                                                                  54010007
479600     EXEC SQL                                                     54020007
479700          FETCH BULK_UPC_CUR                                      54030007
479800          INTO    :IMCNUP-UPC-NBR                                 54040007
479900                , :IMCNUP-UPC-UNT-QTY                             54050007
480000                , :IMCNUP-UPC-CART-CNT                            54060007
480100                , :IMCNUP-SKU-NBR                                 54070007
480200                , :IMCNUP-ASN-PKGNG-CDE                           54080007
480300                , :IMCNUP-UPC-CBMT-QTY                            54090007
480400                , :IMCNUP-UPC-WT-KGRM-QTY                         54100007
480500                , :PURITM-ITM-NBR                                 54110007
480600                , :XLT00003-NRF-CLOR-CDE                          54120007
480700                , :XLT00003-CSTM-CLOR-DESC                        54130007
480800                , :XLT00003-SIZE-DESC                             54140007
480900                , :XLT00003-SKU-DESC                              54150007
481000                , :XLT00004-VS-NBR                                54160007
481100                , :SKXREF-DEPT                                    54170007
481200                , :SKXREF-CLASS                                   54180007
481300                , :SKXREF-SUBCLASS                                54190007
481400                , :SKXREF-SKU                                     54200007
481410                , :PURITM-OUTR-PK-QTY                             54210007
481500     END-EXEC.                                                    54220007
481600                                                                  54230007
481700     EVALUATE TRUE                                                54240007
481800         WHEN SQLCODE = ZERO                                      54250007
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        54260073
155029             SET PS-NEW-UPC-YES      TO TRUE                      54270073
481900             SET PS-UPCS-ON-TIMCNUP TO TRUE                       54280007
482000             IF SKXREF-DEPT NUMERIC                               54290007
482100              IF SKXREF-DEPT > ZEROES                             54300007
482200                 MOVE SKXREF-DEPT TO TR006-DEPT-NBR               54310007
482300              END-IF                                              54320007
482400             END-IF                                               54330007
482500                                                                  54340007
482600         WHEN SQLCODE = +100                                      54350007
482700              IF PS-UPCS-ON-TIMCNUP                               54360007
482800                  CONTINUE                                        54370007
482900              ELSE                                                54380007
483000                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         54390007
483100                  INITIALIZE TR006-UPC-NBR                        54400007
483200                             TR006-ERROR-MSG                      54410007
483300                  STRING 'CMN-NO UPCS FOR BULK PO-FIX'            54420007
483400                      DELIMITED BY SIZE                           54430007
483500                      INTO TR006-ERROR-MSG                        54440007
483600                  PERFORM 8830-WRITE-ERROR-LINE                   54450007
483700                  SET PS-PROBLEM-DO-NOT-SEND TO TRUE              54460007
483800              END-IF                                              54470007
483900                                                                  54480007
484000              SET PS-EOC-BULK-UPC-CUR TO TRUE                     54490007
484100                                                                  54500007
484200         WHEN SQLWARN0 NOT EQUAL SPACE                            54510007
484300         WHEN SQLCODE NOT EQUAL ZERO                              54520007
484400             DISPLAY '** ABEND **'                                54530007
484500             DISPLAY '** PROGRAM = TRKUP008 **'                   54540007
484600             DISPLAY '** PARAGRAPH = 8400-FETCH-BULK-UPC-CUR**'   54550007
484700             PERFORM 9100-SQL-ABEND                               54560007
484800     END-EVALUATE.                                                54570007
484900                                                                  54580007
485000 EJECT                                                            54590007
485100******************************************************************54600007
485200 8420-OPEN-PACK-DC-CURSOR.                                        54610007
485300                                                                  54620007
485400     EXEC SQL                                                     54630007
485500          OPEN PREPACK_DC_CUR                                     54640007
485600     END-EXEC.                                                    54650007
485700                                                                  54660007
485800     EVALUATE TRUE                                                54670007
485900         WHEN SQLWARN0 NOT EQUAL SPACE                            54680007
486000         WHEN SQLCODE NOT EQUAL ZERO                              54690007
486100             DISPLAY '** ABEND **'                                54700007
486200             DISPLAY '** PROGRAM = TRKUP008 **'                   54710007
486300             DISPLAY '** PARAGRAPH = 8420-OPEN-PACK-DC-CURSOR***' 54720007
486400             PERFORM 9100-SQL-ABEND                               54730007
486500     END-EVALUATE.                                                54740007
486600                                                                  54750007
486700******************************************************************54760007
486800 8425-CLOSE-PACK-DC-CURSOR.                                       54770007
486900                                                                  54780007
487000     EXEC SQL                                                     54790007
487100         CLOSE PREPACK_DC_CUR                                     54800007
487200     END-EXEC.                                                    54810007
487300                                                                  54820007
487400     EVALUATE TRUE                                                54830007
JNSINC*        WHEN SQLCODE = 0                                         54840085
JNSINC*        WHEN SQLCODE = -501                                      54840185
JNSINC*            CONTINUE                                             54840285
JNSINC*                                                                 54840385
487500         WHEN SQLWARN0 NOT EQUAL SPACE                            54841081
487600         WHEN SQLCODE NOT EQUAL ZERO                              54850007
487700             DISPLAY '** ABEND **'                                54860007
487800             DISPLAY '** PROGRAM = TRKUP008 **'                   54870007
487900             DISPLAY '** PARAGRAPH = 8425-CLOSE-PACK-DC-CURSOR***'54880007
488000             PERFORM 9100-SQL-ABEND                               54890007
488100     END-EVALUATE.                                                54900007
488200                                                                  54910007
488300******************************************************************54920007
488400 8430-FETCH-PACK-DC-CURSOR.                                       54930007
488500                                                                  54940007
488600     EXEC SQL                                                     54950007
488700          FETCH PREPACK_DC_CUR                                    54960007
488800          INTO                                                    54970007
488900               :ALLPLN-DEST-NBR                                   54980007
155029             , :PV-FAST-E-BUS-IND                                 54990073
489000             , :PA-TTL-ORDERED-PACK-QTY-DC                        55000007
489100     END-EXEC.                                                    55010007
489200                                                                  55020007
489300     EVALUATE TRUE                                                55030007
489400         WHEN SQLCODE = ZERO                                      55040007
489500             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 55050007
155029             IF PS-NEW-UPC-YES                                    55060073
155029                SET PS-NEW-UPC-NO      TO TRUE                    55070073
155029                SET PS-FIRST-UPC-YES   TO TRUE                    55080073
155029             END-IF                                               55090073
489600                                                                  55100007
489700         WHEN SQLCODE = +100                                      55110007
489800              SET PS-EOC-PREPACK-DC-CURSOR TO TRUE                55120007
489900              IF PS-DC-SPLIT-INFO-PRESENT                         55130007
490000                 CONTINUE                                         55140007
490100              ELSE                                                55150007
490200                 INITIALIZE TR006-UPC-NBR                         55160007
490300                            TR006-ERROR-MSG                       55170007
490400                 SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE         55180007
490500                 STRING 'CMN-PACK MISSING SPLT-FIX'               55190007
490600                     DELIMITED BY SIZE                            55200007
490700                     INTO TR006-ERROR-MSG                         55210007
490800                 MOVE IMCNUP-SKU-NBR   TO  TR006-SKU              55220007
490900                 PERFORM 8830-WRITE-ERROR-LINE                    55230007
491000                 SET PS-PROBLEM-DO-NOT-SEND TO TRUE               55240007
491100              END-IF                                              55250007
491200                                                                  55260007
491300         WHEN SQLWARN0 NOT EQUAL SPACE                            55270007
491400         WHEN SQLCODE NOT EQUAL ZERO                              55280007
491500             DISPLAY '** ABEND **'                                55290007
491600             DISPLAY '** PROGRAM = TRKUP008 **'                   55300007
491700             DISPLAY '** PARAGRAPH = 8430-FETCH-PACK-DC-CURSOR**' 55310007
093900             DISPLAY 'PO_NBR =      ' IMCNPO-PO-NBR               55320039
094000             DISPLAY 'PO_PREPK_ID = ' POPRPK-PO-PREPK-ID          55330039
491800             PERFORM 9100-SQL-ABEND                               55340007
491900     END-EVALUATE.                                                55350007
492000                                                                  55360007
492100 EJECT                                                            55370007
492200******************************************************************55380007
492300 8450-OPEN-PACK-UPC-CURSOR.                                       55390007
492400                                                                  55400007
492500     EXEC SQL                                                     55410007
492600          OPEN PACK_UPC_CUR                                       55420007
492700     END-EXEC.                                                    55430007
492800                                                                  55440007
492900     EVALUATE TRUE                                                55450007
493000         WHEN SQLWARN0 NOT EQUAL SPACE                            55460007
493100         WHEN SQLCODE NOT EQUAL ZERO                              55470007
493200             DISPLAY '** ABEND **'                                55480007
493300             DISPLAY '** PROGRAM = TRKUP008 **'                   55490007
493400             DISPLAY '** PARAGRAPH = 8450-OPEN-PACK-UPC-CURSOR*'  55500007
493500             PERFORM 9100-SQL-ABEND                               55510007
493600     END-EVALUATE.                                                55520007
493700                                                                  55530007
493800******************************************************************55540007
493900 8455-CLOSE-PACK-UPC-CURSOR.                                      55550007
494000                                                                  55560007
494100     EXEC SQL                                                     55570007
494200         CLOSE PACK_UPC_CUR                                       55580007
494300     END-EXEC.                                                    55590007
494400                                                                  55600007
494500     EVALUATE TRUE                                                55610007
494600         WHEN SQLWARN0 NOT EQUAL SPACE                            55620007
494700         WHEN SQLCODE NOT EQUAL ZERO                              55630007
494800             DISPLAY '** ABEND **'                                55640007
494900             DISPLAY '** PROGRAM = TRKUP008 **'                   55650007
495000             DISPLAY '** PARAGRAPH = 8455-CLOSE-PACK-UPC-CURSOR*' 55660007
495100             PERFORM 9100-SQL-ABEND                               55670007
495200     END-EVALUATE.                                                55680007
495300                                                                  55690007
495400******************************************************************55700007
495500 8460-FETCH-PACK-UPC-CURSOR.                                      55710007
495600                                                                  55720007
495700     EXEC SQL                                                     55730007
495800          FETCH PACK_UPC_CUR                                      55740007
495900          INTO                                                    55750007
496000               :TUPCSKU-UPC-NBR                                   55760007
496100             , :XLT00004-VS-NBR                                   55770007
496200             , :XLT00003-NRF-CLOR-CDE                             55780007
496300             , :XLT00003-CSTM-CLOR-DESC                           55790007
496400             , :XLT00003-SIZE-DESC                                55800007
496500             , :XLT00003-SKU-DESC                                 55810007
496600             , :PURITM-UNT-QTY                                    55820007
496700             , :PURITM-PREPK-RATO-QTY                             55830007
496800             , :POPRPK-OTPK-UNT-QTY                               55840007
496900             , :POPRPK-INPK-UNT-QTY                               55850007
496900             , :POPRPK-PREPK-TYP-CDE                              55860009
497000             , :SKXREF-DEPT                                       55870007
497100             , :SKXREF-CLASS                                      55880007
497200             , :SKXREF-SUBCLASS                                   55890007
497300             , :SKXREF-SKU                                        55900007
497400     END-EXEC.                                                    55910007
497500                                                                  55920007
497600     EVALUATE TRUE                                                55930007
497700         WHEN SQLCODE = ZERO                                      55940007
497800             SET PS-UPCS-ON-PREPACK TO TRUE                       55950007
497900             IF SKXREF-DEPT NUMERIC                               55960007
498000              IF SKXREF-DEPT > ZEROES                             55970007
498100                 MOVE SKXREF-DEPT TO TR006-DEPT-NBR               55980007
498200              END-IF                                              55990007
498300             END-IF                                               56000007
498400                                                                  56010007
498500         WHEN SQLCODE = +100                                      56020007
498600              IF PS-UPCS-ON-PREPACK                               56030007
498700                  CONTINUE                                        56040007
498800              ELSE                                                56050007
498900                  INITIALIZE TR006-UPC-NBR                        56060007
499000                             TR006-ERROR-MSG                      56070007
499100                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         56080007
499200                  STRING 'CMN-NO DTL SKUS FOR PACK PO-FIX'        56090007
499300                      DELIMITED BY SIZE                           56100007
499400                      INTO TR006-ERROR-MSG                        56110007
499500                  MOVE IMCNUP-SKU-NBR   TO TR006-SKU              56120007
499600                  MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR          56130007
499700                  PERFORM 8830-WRITE-ERROR-LINE                   56140007
499800                  SET PS-PROBLEM-DO-NOT-SEND      TO TRUE         56150007
499900              END-IF                                              56160007
500000                                                                  56170007
500100              SET PS-EOC-PREPACK-UPC-CURSOR TO TRUE               56180007
500200                                                                  56190007
500300         WHEN SQLWARN0 NOT EQUAL SPACE                            56200007
500400         WHEN SQLCODE NOT EQUAL ZERO                              56210007
500500             DISPLAY '** ABEND **'                                56220007
500600             DISPLAY '** PROGRAM = TRKUP008 **'                   56230007
500700             DISPLAY '** PARAGRAPH = 8460-FETCH-PACK-UPC-CURSOR'  56240007
500800             PERFORM 9100-SQL-ABEND                               56250007
500900     END-EVALUATE.                                                56260007
501000                                                                  56270007
501100 EJECT                                                            56280007
501200******************************************************************56290007
501300 8470-OPEN-E-COM-PACK-UPC-CUR.                                    56300007
501400                                                                  56310007
501500     EXEC SQL                                                     56320007
501600         OPEN E_COM_PACK_UPC_CUR                                  56330007
501700     END-EXEC.                                                    56340007
501800                                                                  56350007
501900     EVALUATE TRUE                                                56360007
502000         WHEN SQLWARN0 NOT EQUAL SPACE                            56370007
502100         WHEN SQLCODE NOT EQUAL ZERO                              56380007
502200            DISPLAY '** ABEND **'                                 56390007
502300            DISPLAY '** PROGRAM = TRKUP008 **'                    56400007
502400            DISPLAY '** PARAGRAPH = 8470-OPEN-E-COM-PACK-UPC-CUR' 56410007
502500            PERFORM 9100-SQL-ABEND                                56420007
502600     END-EVALUATE.                                                56430007
502700                                                                  56440007
502800******************************************************************56450007
502900 8472-FETCH-E-COM-PACK-UPC-CUR.                                   56460007
503000                                                                  56470007
503100     EXEC SQL                                                     56480007
503200          FETCH E_COM_PACK_UPC_CUR                                56490007
503300          INTO                                                    56500007
503400               :IMCNUP-UPC-NBR                                    56510007
503500              ,:PURITM-PO-LNE-NBR                                 56520007
503600     END-EXEC.                                                    56530007
503700                                                                  56540007
503800     EVALUATE TRUE                                                56550007
503900         WHEN SQLCODE = ZERO                                      56560007
504000             CONTINUE                                             56570007
504100                                                                  56580007
504200         WHEN SQLCODE = +100                                      56590007
504300              SET PS-EOC-E-COM-PACK-UPC-CUR  TO TRUE              56600007
504400                                                                  56610007
504500         WHEN SQLWARN0 NOT EQUAL SPACE                            56620007
504600         WHEN SQLCODE NOT EQUAL ZERO                              56630007
504700            DISPLAY '** ABEND **'                                 56640007
504800            DISPLAY '** PROGRAM = TRKUP008 **'                    56650007
504900            DISPLAY '** PARAGRAPH = 8472-FETCH-E-COM-PACK-UPC-CUR'56660007
505000            PERFORM 9100-SQL-ABEND                                56670007
505100     END-EVALUATE.                                                56680007
505200                                                                  56690007
505300******************************************************************56700007
505400 8474-CLOSE-E-COM-PACK-UPC-CUR.                                   56710007
505500                                                                  56720007
505600     EXEC SQL                                                     56730007
505700         CLOSE E_COM_PACK_UPC_CUR                                 56740007
505800     END-EXEC.                                                    56750007
505900                                                                  56760007
506000     EVALUATE TRUE                                                56770007
506100         WHEN SQLWARN0 NOT EQUAL SPACE                            56780007
506200         WHEN SQLCODE NOT EQUAL ZERO                              56790007
506300          DISPLAY '** ABEND **'                                   56800007
506400          DISPLAY '** PROGRAM = TRKUP008 **'                      56810007
506500          DISPLAY '** PARAGRAPH = 8470-CLOSE-E-COM-PACK-UPC-CUR'  56820007
506600            PERFORM 9100-SQL-ABEND                                56830007
506700     END-EVALUATE.                                                56840007
506800                                                                  56850007
506900 EJECT                                                            56860007
507000******************************************************************56870007
507100 8500-OPEN-DC-CURSOR.                                             56880007
507200                                                                  56890007
507300     EXEC SQL                                                     56900007
507400          OPEN DC_CUR                                             56910007
507500     END-EXEC.                                                    56920007
507600                                                                  56930007
507700     EVALUATE TRUE                                                56940007
507800         WHEN SQLWARN0 NOT EQUAL SPACE                            56950007
507900         WHEN SQLCODE NOT EQUAL ZERO                              56960007
508000             DISPLAY '** ABEND **'                                56970007
508100             DISPLAY '** PROGRAM = TRKUP008 **'                   56980007
508200             DISPLAY '** PARAGRAPH = 8500-OPEN-DC-CURSOR **'      56990007
508300             PERFORM 9100-SQL-ABEND                               57000007
508400     END-EVALUATE.                                                57010007
508500                                                                  57020007
508600******************************************************************57030007
508700 8600-CLOSE-DC-CURSOR.                                            57040007
508800                                                                  57050007
508900                                                                  57060007
509000     EXEC SQL                                                     57070007
509100         CLOSE DC_CUR                                             57080007
509200     END-EXEC.                                                    57090007
509300                                                                  57100007
509400     EVALUATE TRUE                                                57110007
509500         WHEN SQLWARN0 NOT EQUAL SPACE                            57120007
509600         WHEN SQLCODE NOT EQUAL ZERO                              57130007
509700             DISPLAY '** ABEND **'                                57140007
509800             DISPLAY '** PROGRAM = TRKUP008 **'                   57150007
509900             DISPLAY '** PARAGRAPH = 8600-CLOSE-DC-CURSOR**'      57160007
510000             PERFORM 9100-SQL-ABEND                               57170007
510100     END-EVALUATE.                                                57180007
510200                                                                  57190007
510300******************************************************************57200007
510400 8700-FETCH-DC-CURSOR.                                            57210007
510500                                                                  57220007
510600     EXEC SQL                                                     57230007
510700          FETCH DC_CUR                                            57240007
510800          INTO                                                    57250007
510900                  :ALLPLN-DEST-NBR                                57260007
155029                , :PV-FAST-E-BUS-IND                              57270073
511000                , :ALLPLN-CURR-SPLIT-QTY                          57280007
511100     END-EXEC.                                                    57290007
511200                                                                  57300007
511300     EVALUATE TRUE                                                57310007
511400         WHEN SQLCODE = ZERO                                      57320007
511500             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 57330007
155029             IF PS-NEW-UPC-YES                                    57340073
155029                SET PS-NEW-UPC-NO      TO TRUE                    57350073
155029                SET PS-FIRST-UPC-YES   TO TRUE                    57360073
155029             END-IF                                               57370073
511600                                                                  57380007
511700         WHEN SQLCODE = +100                                      57390007
511800              IF PS-DC-SPLIT-INFO-PRESENT                         57400007
511900                  CONTINUE                                        57410007
512000              ELSE                                                57420007
512100                   PERFORM  8710-MISSING-SPLIT-ERROR              57430007
512200              END-IF                                              57440007
512300                                                                  57450007
512400              SET PS-EOC-DC-CURSOR TO TRUE                        57460007
512500                                                                  57470007
512600         WHEN SQLWARN0 NOT EQUAL SPACE                            57480007
512700         WHEN SQLCODE NOT EQUAL ZERO                              57490007
512800             DISPLAY '** ABEND **'                                57500007
512900             DISPLAY '** PROGRAM = TRKUP008 **'                   57510007
513000             DISPLAY '** PARAGRAPH = 8700-FETCH-DC-CURSOR**'      57520007
513100             PERFORM 9100-SQL-ABEND                               57530007
513200     END-EVALUATE.                                                57540007
513300                                                                  57550007
513400******************************************************************57560007
513500 8710-MISSING-SPLIT-ERROR.                                        57570007
513600                                                                  57580007
513700     SET PS-PROBLEM-DO-NOT-SEND TO TRUE.                          57590007
513800     IF IMCNPO-PO-NBR = PV-HOLD-PO-NBR                            57600007
513900         CONTINUE                                                 57610007
514000     ELSE                                                         57620007
514100         MOVE IMCNPO-PO-NBR TO PV-HOLD-PO-NBR                     57630007
514200         SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE                 57640007
514300         INITIALIZE TR006-ERROR-MSG                               57650007
514400                    TR006-UPC-NBR                                 57660007
514500         STRING 'CMN-PO MISSING SPLIT-FIX'                        57670007
514600             DELIMITED BY SIZE                                    57680007
514700             INTO TR006-ERROR-MSG                                 57690007
514800         PERFORM 8830-WRITE-ERROR-LINE                            57700007
514900     END-IF.                                                      57710007
515000                                                                  57720007
515100 EJECT                                                            57730007
515200******************************************************************57740007
515300 8735-OPEN-PACK-CURSOR.                                           57750007
515400                                                                  57760007
515500     EXEC SQL                                                     57770007
515600          OPEN PREPACK_CUR                                        57780007
515700     END-EXEC.                                                    57790007
515800                                                                  57800007
515900     EVALUATE TRUE                                                57810007
516000         WHEN SQLWARN0 NOT EQUAL SPACE                            57820007
516100         WHEN SQLCODE NOT EQUAL ZERO                              57830007
516200            DISPLAY '** ABEND **'                                 57840007
516300            DISPLAY '** PROGRAM = TRKUP008 **'                    57850007
516400            DISPLAY '** PARAGRAPH = 8735-OPEN-PACK-CURSOR'        57860007
516500            PERFORM 9100-SQL-ABEND                                57870007
516600     END-EVALUATE.                                                57880007
516700                                                                  57890007
516800******************************************************************57900007
516900 8740-CLOSE-PACK-CURSOR.                                          57910007
517000                                                                  57920007
517100     EXEC SQL                                                     57930007
517200         CLOSE PREPACK_CUR                                        57940007
517300     END-EXEC.                                                    57950007
517400                                                                  57960007
517500     EVALUATE TRUE                                                57970007
517600         WHEN SQLWARN0 NOT EQUAL SPACE                            57980007
517700         WHEN SQLCODE NOT EQUAL ZERO                              57990007
517800           DISPLAY '** ABEND **'                                  58000007
517900           DISPLAY '** PROGRAM = TRKUP008 **'                     58010007
518000           DISPLAY '** PARAGRAPH =8740-CLOSE-PACK-CURSOR'         58020007
518100           PERFORM 9100-SQL-ABEND                                 58030007
518200     END-EVALUATE.                                                58040007
518300                                                                  58050007
518400******************************************************************58060007
518500 8745-FETCH-PACK-CURSOR.                                          58070007
518600                                                                  58080007
518700     EXEC SQL                                                     58090007
518800          FETCH PREPACK_CUR                                       58100007
518900          INTO                                                    58110007
519000               :POPRPK-PO-PREPK-ID                                58120007
519100             , :POPRPK-PREPK-UPC-NBR                              58130007
519200             , :POPRPK-PK-SKU-NBR                                 58140007
519300             , :POPRPK-INPK-UNT-QTY                               58150007
519400             , :POPRPK-OTPK-UNT-QTY                               58160007
519400             , :POPRPK-PREPK-TYP-CDE                              58170009
519500             , :IMCNUP-UPC-UNT-QTY                                58180007
519600             , :IMCNUP-UPC-CART-CNT                               58190007
519700             , :IMCNUP-SKU-NBR                                    58200007
519800             , :IMCNUP-ASN-PKGNG-CDE                              58210007
519900             , :IMCNUP-UPC-CBMT-QTY                               58220007
520000             , :IMCNUP-UPC-WT-KGRM-QTY                            58230007
520100     END-EXEC.                                                    58240007
520200                                                                  58250007
520300     EVALUATE TRUE                                                58260007
520400         WHEN SQLCODE = ZERO                                      58270007
155029             SET PS-NEW-UPC-YES      TO TRUE                      58280073
520500             SET PS-PREPACKS-FOR-PO  TO TRUE                      58290070
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        58300073
520600                                                                  58310007
520700         WHEN SQLCODE = +100                                      58320007
520800             SET PS-EOC-PACK-CURSOR TO TRUE                       58330007
520900             IF  PS-PREPACKS-FOR-PO                               58340007
521000                CONTINUE                                          58350007
521100             ELSE                                                 58360007
521200                  INITIALIZE TR006-UPC-NBR                        58370007
521300                             TR006-ERROR-MSG                      58380007
521400                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         58390007
521500                  STRING  'CMN-NO PACK UPCS FOR PACK PO-FIX'      58400007
521600                      DELIMITED BY SIZE                           58410007
521700                      INTO TR006-ERROR-MSG                        58420007
521800                  PERFORM 8830-WRITE-ERROR-LINE                   58430007
521900                  SET PS-PROBLEM-DO-NOT-SEND TO TRUE              58440007
522000             END-IF                                               58450007
522100                                                                  58460007
522200         WHEN SQLWARN0 NOT EQUAL SPACE                            58470007
522300         WHEN SQLCODE NOT EQUAL ZERO                              58480007
522400          DISPLAY '** ABEND **'                                   58490007
522500          DISPLAY '** PROGRAM = TRKUP008 **'                      58500007
522600          DISPLAY '** PARAGRAPH = 8745-FETCH-PACK-CURSOR'         58510007
522700          PERFORM 9100-SQL-ABEND                                  58520007
522800     END-EVALUATE.                                                58530007
522900                                                                  58540007
523000******************************************************************58550007
523100 8750-FETCH-SEAL-CURSOR.                                          58560007
523200                                                                  58570007
523300     EXEC SQL                                                     58580007
523400          FETCH SEAL_CURSOR                                       58590007
523500          INTO :TRT00006-SEAL-NBR                                 58600007
523600     END-EXEC.                                                    58610007
523700                                                                  58620007
523800     EVALUATE TRUE                                                58630007
523900         WHEN SQLCODE = ZERO                                      58640007
524000             CONTINUE                                             58650007
524100                                                                  58660007
524200         WHEN SQLCODE = +100                                      58670007
524300             SET PS-EOC-SEAL-CURSOR TO TRUE                       58680007
524400                                                                  58690007
524500         WHEN SQLWARN0 NOT EQUAL SPACE                            58700007
524600         WHEN SQLCODE NOT EQUAL ZERO                              58710007
524700          DISPLAY '** ABEND **'                                   58720007
524800          DISPLAY '** PROGRAM = TRKUP008 **'                      58730013
524900          DISPLAY '** PARAGRAPH = 8750-FETCH-SEAL-CURSOR'         58740007
525000          PERFORM 9100-SQL-ABEND                                  58750007
525100     END-EVALUATE.                                                58760007
525200                                                                  58770007
525300******************************************************************58780007
525400 8752-OPEN-SEAL-CURSOR.                                           58790007
525500                                                                  58800007
525600     EXEC SQL                                                     58810007
525700          OPEN SEAL_CURSOR                                        58820007
525800     END-EXEC.                                                    58830007
525900                                                                  58840007
526000     EVALUATE TRUE                                                58850007
526100         WHEN SQLWARN0 NOT EQUAL SPACE                            58860007
526200         WHEN SQLCODE NOT EQUAL ZERO                              58870007
526300            DISPLAY '** ABEND **'                                 58880007
526400            DISPLAY '** PROGRAM = TRKUP008 **'                    58890013
526500            DISPLAY '** PARAGRAPH = 8752-OPEN-SEAL-CURSOR'        58900007
526600            PERFORM 9100-SQL-ABEND                                58910007
526700     END-EVALUATE.                                                58920007
526800                                                                  58930007
526900******************************************************************58940007
527000 8754-CLOSE-SEAL-CURSOR.                                          58950007
527100                                                                  58960007
527200     EXEC SQL                                                     58970007
527300         CLOSE SEAL_CURSOR                                        58980007
527400     END-EXEC.                                                    58990007
527500                                                                  59000007
527600     EVALUATE TRUE                                                59010007
527700         WHEN SQLWARN0 NOT EQUAL SPACE                            59020007
527800         WHEN SQLCODE NOT EQUAL ZERO                              59030007
527900           DISPLAY '** ABEND **'                                  59040007
528000           DISPLAY '** PROGRAM = TRKUP008 **'                     59050013
528100           DISPLAY '** PARAGRAPH =8754-CLOSE-SEAL-CURSOR'         59060007
528200           PERFORM 9100-SQL-ABEND                                 59070007
528300     END-EVALUATE.                                                59080007
528400                                                                  59090007
528500******************************************************************59100007
528600 8756-FETCH-CART-LABEL-CURSOR.                                    59110007
528700                                                                  59120007
528800     EXEC SQL                                                     59130007
528900          FETCH CART_LABEL_CURSOR                                 59140007
529000          INTO :TRT00008-SSCC-ID                                  59150007
529100              ,:TRT00008-UNT-QTY                                  59160007
529200     END-EXEC.                                                    59170007
529300                                                                  59180007
529400     EVALUATE TRUE                                                59190007
529500         WHEN SQLCODE = ZERO                                      59200007
529600             CONTINUE                                             59210007
529700                                                                  59220007
529800         WHEN SQLCODE = +100                                      59230007
529900             SET PS-EOC-CART-LABEL-CURSOR  TO TRUE                59240007
530000                                                                  59250007
530100         WHEN SQLWARN0 NOT EQUAL SPACE                            59260007
530200         WHEN SQLCODE NOT EQUAL ZERO                              59270007
530300          DISPLAY '** ABEND **'                                   59280007
530400          DISPLAY '** PROGRAM = TRKUP008 **'                      59290013
530500          DISPLAY '** PARAGRAPH = 8756-FETCH-CART-LABEL-CURSOR'   59300007
530600          PERFORM 9100-SQL-ABEND                                  59310007
530700     END-EVALUATE.                                                59320007
530800                                                                  59330007
530900******************************************************************59340007
531000 8758-OPEN-CART-LABEL-CURSOR.                                     59350007
531100                                                                  59360007
531200     EXEC SQL                                                     59370007
531300          OPEN CART_LABEL_CURSOR                                  59380007
531400     END-EXEC.                                                    59390007
531500                                                                  59400007
531600     EVALUATE TRUE                                                59410007
531700         WHEN SQLWARN0 NOT EQUAL SPACE                            59420007
531800         WHEN SQLCODE NOT EQUAL ZERO                              59430007
531900            DISPLAY '** ABEND **'                                 59440007
532000            DISPLAY '** PROGRAM = TRKUP008 **'                    59450013
532100            DISPLAY '** PARAGRAPH = 8758-OPEN-CART-LABEL-CURSOR'  59460007
532200            PERFORM 9100-SQL-ABEND                                59470007
532300     END-EVALUATE.                                                59480007
532400                                                                  59490007
532500******************************************************************59500007
532600 8760-CLOSE-CART-LABEL-CURSOR.                                    59510007
532700                                                                  59520007
532800     EXEC SQL                                                     59530007
532900         CLOSE CART_LABEL_CURSOR                                  59540007
533000     END-EXEC.                                                    59550007
533100                                                                  59560007
533200     EVALUATE TRUE                                                59570007
533300         WHEN SQLWARN0 NOT EQUAL SPACE                            59580007
533400         WHEN SQLCODE NOT EQUAL ZERO                              59590007
533500           DISPLAY '** ABEND **'                                  59600007
533600           DISPLAY '** PROGRAM = TRKUP008 **'                     59610013
533700           DISPLAY '** PARAGRAPH = 8760-CLOSE-CART-LABEL-CURSOR'  59620007
533800           PERFORM 9100-SQL-ABEND                                 59630007
533900     END-EVALUATE.                                                59640007
534000                                                                  59650007
534100******************************************************************59660007
534200 8830-WRITE-ERROR-LINE.                                           59670007
534300                                                                  59680007
534400     SET  TR006-REXMIT-RPT            TO TRUE.                    59690007
534500     MOVE IMCNTK-MOM-IMPRT-VEH-NM     TO TR006-VESSEL-NAME.       59700007
534600     MOVE IMCNTK-CONTNR-ID            TO TR006-CONTAINER-NUMBER.  59710007
534700     MOVE PV-CURRENT-TIME (6:2)       TO TR006-PROCESS-MM.        59720007
534800     MOVE PV-CURRENT-TIME (9:2)       TO TR006-PROCESS-DD.        59730007
534900     MOVE PV-CURRENT-TIME (1:4)       TO TR006-PROCESS-YYYY.      59740007
535000     MOVE PC-CURRENT-PROGRAM-NAME     TO TR006-PGM-NAME.          59750007
535100     MOVE IMCNTK-MOM-POE-DELY-TMST (1:4)                          59760007
535200                                TO TR006-ETA-DATE (1:4)           59770007
535300     MOVE IMCNTK-MOM-POE-DELY-TMST (6:2)                          59780007
535400                                TO TR006-ETA-DATE (5:2)           59790007
535500     MOVE IMCNTK-MOM-POE-DELY-TMST (9:2)                          59800007
535600                                TO TR006-ETA-DATE (7:2)           59810007
535700                                                                  59820007
535800     MOVE TR006-RECORD          TO OUTTR3-TRGL-ERR-RPT-ODR.       59830007
535900     ADD +1                     TO PA-ERROR-COUNT.                59840007
536000                                                                  59850007
536100     PERFORM 8840-INSERT-ERROR.                                   59860007
536200                                                                  59870007
536300                                                                  59880007
536400******************************************************************59890007
536500 8840-INSERT-ERROR.                                               59900007
536600                                                                  59910007
536700     EXEC SQL                                                     59920007
536800         INSERT INTO TOUTTR3                                      59930007
536900             (TRGL_ERR_RPT_ODR)                                   59940007
537000            VALUES  (:OUTTR3-TRGL-ERR-RPT-ODR)                    59950007
537100     END-EXEC                                                     59960007
537200                                                                  59970007
537300     EVALUATE TRUE                                                59980007
537400         WHEN SQLWARN0 NOT EQUAL SPACE                            59990007
537500         WHEN SQLCODE NOT EQUAL ZERO                              60000007
537600             DISPLAY '** ABEND **'                                60010007
537700             DISPLAY '** PROGRAM = TRKUP008 **'                   60020007
537800             DISPLAY '** PARAGRAPH = 8840-INSERT-ERROR**'         60030007
537900             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR3**'         60040007
538000             PERFORM 9100-SQL-ABEND                               60050007
538100     END-EVALUATE.                                                60060007
538200                                                                  60070007
538300 EJECT                                                            60080007
538400******************************************************************60090007
538500* WRITE PACK (PCK) RECORD TYPE FOR DETAIL REPORT RECORD.         *60100007
538600******************************************************************60110007
538700 8847-WRITE-DTL-RPT-PCK-RECORD.                                   60120007
538800                                                                  60130007
538900     MOVE '40PCK'                     TO TR020-REC-TYPE-CDE-PCK.  60140007
539000     SET  TR020-REXMIT-RPT-PCK        TO TRUE.                    60150007
539100     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCK.        60160007
539200     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCK.  60170007
539300     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-PCK.     60180007
539400     MOVE TR004-PACK-ID               TO TR020-PACK-ID-PCK.       60190007
539500     MOVE TR004-PACK-UNITS-PER-CTN    TO TR020-UNITS-PER-CTN-PCK. 60200007
539600     MOVE TR004-PACK-CART-CT          TO TR020-CART-CT-PCK.       60210007
539700     MOVE TR004-PACK-CBMT-QTY         TO TR020-CBMT-QTY-PCK.      60220007
539800     MOVE TR004-PACK-WT-KGRM-QTY      TO TR020-WT-KGRM-QTY-PCK.   60230007
539900     MOVE TR004-PACK-UNIT-QTY         TO TR020-UNIT-QTY-PCK.      60240007
540000     MOVE TR004-PACK-DESC             TO TR020-DESC-PCK.          60250007
540100     MOVE TR004-PACKS-PER-CART       TO TR020-PACKS-PER-CART-PCK. 60260007
540200     MOVE TR004-PACK-UPC-NBR          TO TR020-UPC-NBR-PCK        60270007
540300     MOVE IMCNUP-ASN-PKGNG-CDE        TO TR020-ASN-PKGNG-CDE-PCK. 60280007
540400     MOVE TR004-PACK-SKU              TO TR020-SKU-PCK.           60290007
540500     MOVE TR004-PCK-NO-LBL-CART-CT    TO TR020-NO-LBL-CART-CT-PCK.60300007
540600                                                                  60310007
540700     MOVE TR020-REC-TYPE-PCK      TO DCLTOUTTR4.                  60320007
540800                                                                  60330007
540900     PERFORM 8880-INSERT-DETAIL.                                  60340007
541000                                                                  60350007
541100******************************************************************60360007
541200* WRITE PACK DC (PDC) RECORD TYPE FOR DETAIL REPORT RECORD.      *60370007
541300******************************************************************60380007
541400 8848-WRITE-DTL-RPT-PDC-RECORD.                                   60390007
541500                                                                  60400007
541600     SET TR020-REXMIT-RPT-PDC         TO TRUE.                    60410007
541700     MOVE '50PDC'                     TO TR020-REC-TYPE-CDE-PDC.  60420007
541800     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PDC.        60430007
541900     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PDC.  60440007
542000     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-PDC.     60450007
542100     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-PDC.       60460007
542200     MOVE TR004-PDC-DIST-CNTR         TO TR020-DIST-CNTR-PDC.     60470007
542300     MOVE TR004-PDC-UNIT-QTY          TO TR020-UNIT-QTY-PDC.      60480007
542400     MOVE TR004-PDC-PERCNT            TO TR020-PERCNT-PDC.        60490007
542500     MOVE TR004-PDC-CART-CT           TO TR020-CART-CT-PDC.       60500007
542600     MOVE TR004-PDC-NO-LBL-CART-CT                                60510007
542700                               TO TR020-NO-LBL-CART-CT-PDC.       60520007
542800                                                                  60530007
542900     MOVE TR020-REC-TYPE-PDC       TO DCLTOUTTR4.                 60540007
543000                                                                  60550007
543100     PERFORM 8880-INSERT-DETAIL.                                  60560007
543200                                                                  60570007
543300******************************************************************60580007
543400* WRITE PURCHASE ORDER RECORD TYPE FOR DETAIL REPORT RECORD.     *60590007
543500******************************************************************60600007
543600 8850-WRITE-DTL-RPT-PO-RECORD.                                    60610007
543700                                                                  60620007
543800     MOVE '10PO '                     TO TR020-REC-TYPE-CDE-PO.   60630007
543900     SET  TR020-REXMIT-RPT-PO         TO TRUE.                    60640007
544000     MOVE TR004-PO-NBR                TO TR020-PO-NBR-PO.         60650007
544100     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PO.   60660007
544200     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-PO.      60670007
544300     MOVE TR004-VENDOR-NAME           TO TR020-VENDOR-NAME-PO.    60680007
544400     MOVE TR006-DONT-SHIP-BEFORE-DATE                             60690007
544500                               TO TR020-DO-NOT-SHIP-BEF-DTE-PO.   60700007
544600     MOVE TR004-CANCEL-DATE           TO TR020-CANCEL-DATE-PO.    60710007
544700     MOVE TR004-OPEN-TO-BUY-PERIOD                                60720007
544800                               TO TR020-OPEN-TO-BUY-PERIOD-PO.    60730007
544900     MOVE TR004-PKGNG-CDE             TO TR020-PKGNG-CDE-PO.      60740007
545000     MOVE TR004-AD-DATE               TO TR020-AD-DATE-PO.        60750007
545100     MOVE PC-CURRENT-PROGRAM-NAME     TO TR020-PGM-NAME.          60760007
545200                                                                  60770007
545300     MOVE TR020-REC-TYPE-PO        TO DCLTOUTTR4.                 60780007
545400     PERFORM 8880-INSERT-DETAIL.                                  60790007
545500                                                                  60800007
545600******************************************************************60810007
545700* WRITE INSTURCTIONS RECORD TYPE FOR DETAIL REPORT RECORD.       *60820007
545800******************************************************************60830007
545900 8852-WRITE-DTL-RPT-INS-RECORD.                                   60840007
546000                                                                  60850007
546100     MOVE '20INS'                     TO TR020-REC-TYPE-CDE-INS.  60860007
546200     SET TR020-REXMIT-RPT-INS         TO TRUE.                    60870007
546300     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-INS.        60880007
546400     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-INS.  60890007
546500     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-INS.     60900007
546600     MOVE TR004-SPEC-INSTR            TO TR020-SPEC-INSTR-INS.    60910007
546700                                                                  60920007
546800     MOVE TR020-REC-TYPE-INS-1     TO OUTTR4-TRGL-DTL-RPT-1-ODR.  60930007
546900     MOVE TR020-REC-TYPE-INS-2     TO OUTTR4-TRGL-DTL-RPT-2-ODR.  60940007
547000                                                                  60950007
547100     PERFORM 8880-INSERT-DETAIL.                                  60960007
547200                                                                  60970007
547300******************************************************************60980007
547400* WRITE PURCHASE ORDER LINE RECORD TYPE FOR DETAIL REPORT RECORD.*60990007
547500******************************************************************61000007
547600 8854-WRITE-DTL-RPT-UPC-RECORD.                                   61010007
547700                                                                  61020007
547800     MOVE '60UPC'                     TO TR020-REC-TYPE-CDE-UPC.  61030007
547900     SET TR020-REXMIT-RPT-UPC         TO TRUE.                    61040007
548000     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-UPC.        61050007
548100     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-UPC.  61060007
548200     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-UPC.     61070007
548300     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-UPC.       61080007
548400     MOVE TR004-VEND-STYL-NAME       TO TR020-VEND-STYL-NAME-UPC. 61090007
548500     MOVE TR004-UPC-COLOR-CDE         TO TR020-COLOR-CDE-UPC.     61100007
548600     MOVE TR004-UPC-SIZE-DESC         TO TR020-SIZE-DESC-UPC.     61110007
548700     MOVE TR004-UPC-NBR               TO TR020-UPC-NBR-UPC.       61120007
548800     MOVE TR004-UPC-COLOR-DESC        TO TR020-COLOR-DESC-UPC.    61130007
548900     MOVE TR004-SKU-DESC              TO TR020-SKU-DESC-UPC.      61140007
549000     MOVE TR004-DEPT-NBR              TO TR020-DEPT-NBR-UPC.      61150007
549100     MOVE TR004-CLASS                 TO TR020-CLASS-UPC.         61160007
549200     MOVE TR004-SUB-CLASS             TO TR020-SUB-CLASS-UPC.     61170007
549300     MOVE TR004-SKU-SEQ-NBR           TO TR020-SKU-UPC.           61180007
549400     MOVE TR004-OUTR-PK-QTY           TO TR020-OUTR-PK-QTY-UPC.   61190007
549500     MOVE TR004-PACK-RATIO-QTY        TO TR020-PACK-RATIO-QTY-UPC.61200007
549600     MOVE TR004-UPC-UNIT-QTY          TO TR020-UNIT-QTY-UPC.      61210007
549700     MOVE TR004-UPC-CBMT-QTY          TO TR020-CBMT-QTY-UPC.      61220007
549800     MOVE TR004-UPC-WT-KGRM-QTY       TO TR020-WT-KGRM-QTY-UPC.   61230007
549900     MOVE IMCNUP-ASN-PKGNG-CDE        TO TR020-ASN-PKGNG-CDE-UPC. 61240007
550000     MOVE TR004-UPC-NO-LBL-CART-CT    TO TR020-NO-LBL-CART-CT-UPC.61250007
550100                                                                  61260007
550200     MOVE TR020-REC-TYPE-UPC       TO DCLTOUTTR4.                 61270007
550300                                                                  61280007
550400     PERFORM 8880-INSERT-DETAIL.                                  61290007
550500                                                                  61300007
550600******************************************************************61310007
550700* WRITE CONTAINER/VESSEL RECORD TYPE FOR DETAIL REPORT RECORD.   *61320007
550800******************************************************************61330007
550900 8856-WRITE-DTL-RPT-CMN-RECORD.                                   61340007
551000                                                                  61350007
551100     SET TR020-REC-TYPE-CDE-CMN-CONTNR    TO TRUE.                61360007
551200     SET TR020-REXMIT-RPT-CONTNR          TO TRUE.                61370007
551300     MOVE PV-HOLD-TR020-PROCESS-DATE                              61380007
551400                                  TO TR020-PROCESS-DATE-CONTNR.   61390007
551500     MOVE PV-HOLD-CONTNR-ID       TO TR020-CONTNR-ID-CONTNR.      61400007
551600                                                                  61410007
551700     MOVE TR020-REC-TYPE-CONTNR   TO DCLTOUTTR4.                  61420007
551800                                                                  61430007
551900     PERFORM 8880-INSERT-DETAIL.                                  61440007
552000                                                                  61450007
552100                                                                  61460007
552200******************************************************************61470007
552300 8870-WRITE-DTL-RPT-DC-RECORD.                                    61480007
552400                                                                  61490007
552500     MOVE '70DC '                  TO TR020-REC-TYPE-CDE-DC.      61500007
552600     SET  TR020-REXMIT-RPT-DC      TO TRUE.                       61510007
552700     MOVE PV-HOLD-TR020-PROCESS-DATE                              61520007
552800                                   TO TR020-PROCESS-DATE-DC.      61530007
552900     MOVE TR020-PO-NBR-UPC         TO TR020-PO-NBR-DC.            61540007
553000     MOVE TR020-CONTNR-ID-UPC      TO TR020-CONTNR-ID-DC.         61550007
553100     MOVE TR020-PACK-ID-UPC        TO TR020-PACK-ID-DC.           61560007
553200     MOVE TR020-VEND-STYL-NAME-UPC TO TR020-VEND-STYL-NAME-DC.    61570007
553300     MOVE TR020-COLOR-CDE-UPC      TO TR020-COLOR-CDE-DC.         61580007
553400     MOVE TR020-SIZE-DESC-UPC      TO TR020-SIZE-DESC-DC.         61590007
553500     MOVE TR004-DIST-CNTR          TO TR020-DIST-CNTR-DC.         61600007
553600**** MOVE TR020-UPC-NBR-UPC        TO TR020-UPC-NBR-DC.           61610007
553700     MOVE TR004-DC-UNIT-QTY        TO TR020-UNIT-QTY-DC.          61620007
553800     MOVE TR004-DC-PERCNT          TO TR020-PERCNT-DC.            61630007
553900     MOVE TR004-DC-CART-CT         TO TR020-CART-CT-DC.           61640007
554000     MOVE TR004-DC-NO-LBL-CART-CT                                 61650007
554100                               TO TR020-NO-LBL-CART-CT-DC.        61660007
554200                                                                  61670007
554300     MOVE TR020-REC-TYPE-DC        TO DCLTOUTTR4.                 61680007
554400                                                                  61690007
554500     PERFORM 8880-INSERT-DETAIL.                                  61700007
554600                                                                  61710007
554700******************************************************************61720007
554800 8872-WRITE-DTL-RPT-SEAL-RECORD.                                  61730007
554900                                                                  61740007
555000     MOVE '80SEA'          TO TR020-REC-TYPE-CDE-CONTNR-SEAL.     61750007
555100     SET  TR020-REXMIT-RPT-SEAL    TO TRUE.                       61760007
555200     MOVE TRT00006-SEAL-NBR                                       61770007
555300                           TO TR020-CONTNR-SEAL.                  61780007
555400     MOVE PV-HOLD-TR020-PROCESS-DATE                              61790007
555500                                 TO TR020-PROCESS-DATE-SEAL.      61800007
555600     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-SEAL.    61810007
555700     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-SEAL.       61820007
555800     MOVE 99999999               TO TR020-PACK-ID-SEAL.           61830007
555900     MOVE HIGH-VALUES            TO TR020-VEND-STYL-NAME-SEAL     61840007
556000                                    TR020-COLOR-CDE-SEAL          61850007
556100                                    TR020-SIZE-DESC-SEAL.         61860007
556200     MOVE TR020-REC-TYPE-CONTAINER-SEAL                           61870007
556300                           TO DCLTOUTTR4.                         61880007
556400     PERFORM 8880-INSERT-DETAIL.                                  61890007
556500                                                                  61900007
556600******************************************************************61910007
556700 8874-WRITE-DTL-RPT-PCT-REC.                                      61920007
556800                                                                  61930007
556900     MOVE '50PDC'             TO TR020-REC-TYPE-CDE-PCT.          61940007
557000     MOVE 1                   TO TR020-SEC-REC-TYP-PCT.           61950007
557100     SET  TR020-REXMIT-RPT-PCT TO TRUE.                           61960007
557200     MOVE TR004-PCT-SSCC-ID         TO TR020-SSCC-ID-PCT.         61970007
557300     MOVE TR004-PCT-CARTON-UNIT-QTY TO TR020-UNT-QTY-PCT.         61980007
557400     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCT.        61990007
557500     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCT.  62000007
557600     MOVE PV-HOLD-CONTNR-ID           TO TR020-CONTNR-ID-PCT.     62010007
557700     MOVE TR020-PACK-ID-PDC           TO TR020-PACK-ID-PCT.       62020007
557800     MOVE TR020-DIST-CNTR-PDC         TO TR020-DIST-CNTR-PCT.     62030007
557900     MOVE TR020-REC-TYPE-PACK-CART                                62040007
558000                           TO DCLTOUTTR4.                         62050007
558100     PERFORM 8880-INSERT-DETAIL.                                  62060007
558200                                                                  62070007
558300******************************************************************62080007
558400 8876-WRITE-DTL-RPT-DCT-REC.                                      62090007
558500                                                                  62100007
558600     MOVE '70DC '             TO TR020-REC-TYPE-CDE-DCT.          62110007
558700     MOVE 1                   TO TR020-SEC-REC-TYP-DCT.           62120007
558800     SET  TR020-REXMIT-RPT-DCT TO TRUE.                           62130007
558900     MOVE TR020-PROCESS-DATE-DC     TO TR020-PROCESS-DATE-DCT.    62140007
559000     MOVE TR020-PO-NBR-DC           TO TR020-PO-NBR-DCT.          62150007
559100     MOVE TR020-CONTNR-ID-DC        TO TR020-CONTNR-ID-DCT.       62160007
559200     MOVE TR020-PACK-ID-DC          TO TR020-PACK-ID-DCT.         62170007
559300     MOVE TR020-VEND-STYL-NAME-DC   TO TR020-VEND-STYL-NAME-DCT.  62180007
559400     MOVE TR020-COLOR-CDE-DC        TO TR020-COLOR-CDE-DCT.       62190007
559500     MOVE TR020-SIZE-DESC-DC        TO TR020-SIZE-DESC-DCT.       62200007
559600     MOVE TR020-DIST-CNTR-DC        TO TR020-DIST-CNTR-DCT.       62210007
559700     MOVE TR004-DCT-SSCC-ID         TO TR020-SSCC-ID-DCT.         62220007
559800     MOVE TR004-DCT-CARTON-UNIT-QTY TO TR020-UNT-QTY-DCT.         62230007
559900     MOVE TR020-REC-TYPE-DC-CARTON                                62240007
560000                           TO DCLTOUTTR4.                         62250007
560100     PERFORM 8880-INSERT-DETAIL.                                  62260007
560200                                                                  62270007
560300******************************************************************62280007
560400 8880-INSERT-DETAIL.                                              62290007
560500                                                                  62300007
560600     EXEC SQL                                                     62310007
560700         INSERT INTO TOUTTR4                                      62320007
560800             (TRGL_DTL_RPT_1_ODR                                  62330007
560900             ,TRGL_DTL_RPT_2_ODR)                                 62340007
561000            VALUES  (:OUTTR4-TRGL-DTL-RPT-1-ODR                   62350007
561100                    ,:OUTTR4-TRGL-DTL-RPT-2-ODR)                  62360007
561200     END-EXEC                                                     62370007
561300                                                                  62380007
561400     EVALUATE TRUE                                                62390007
561500         WHEN SQLWARN0 NOT EQUAL SPACE                            62400007
561600         WHEN SQLCODE NOT EQUAL ZERO                              62410007
561700             DISPLAY '** ABEND **'                                62420007
561800             DISPLAY '** PROGRAM = TRKUP008 **'                   62430007
561900             DISPLAY '** PARAGRAPH = 8880-INSERT-ERROR**'         62440007
562000             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR4**'         62450007
562100             PERFORM 9100-SQL-ABEND                               62460007
562200     END-EVALUATE.                                                62470007
562300                                                                  62480007
562400     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    62490007
562500                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   62500007
562600                                                                  62510007
562700 EJECT                                                            62520007
562800******************************************************************62530007
562900 8900-CHK-TRAN-SAME-AS-RETAN.                                     62540007
563000                                                                  62550007
563100*    *** 1ST LOOK FOR A CONTAINER ADJUSTMENT ***                  62560007
563200     MOVE 'ADJ'    TO TRT00014-RUL-TYP-CDE.                       62570007
563300     PERFORM 8910-SELECT-DCP-RULE-CONT.                           62580007
563400                                                                  62590007
563500*    *** IF NO CONTAINER - LOOK FOR A VESSEL ADJUSTMENT ***       62600007
563600     IF PV-DCNSL-SCAC = SPACES                                    62610007
563700        PERFORM 8920-SELECT-DCP-RULE-VSL                          62620007
563800     END-IF.                                                      62630007
563900                                                                  62640007
564000*    *** IF NEITHER - GET THE CONTAINER DEFAULT ***               62650007
564100     IF PV-DCNSL-SCAC = SPACES                                    62660007
564200        MOVE 'DEF'    TO TRT00014-RUL-TYP-CDE                     62670007
564300        PERFORM 8910-SELECT-DCP-RULE-CONT                         62680007
564400     END-IF.                                                      62690007
564500                                                                  62700007
564600     IF PV-DCNSL-SCAC = SPACES                                    62710007
564700        DISPLAY '#### NO RULE FOUND FOR THIS CONTAINER'           62720007
564800        DISPLAY '#### CONT ID  = ' IMCNTK-CONTNR-ID               62730007
564900*       *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN        62740007
565000        SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                    62750007
565100     ELSE                                                         62760007
565200        PERFORM 8930-ENTID-COMPARE-PROCESS                        62770007
565300     END-IF.                                                      62780007
565400                                                                  62790007
565500******************************************************************62800007
565600 8910-SELECT-DCP-RULE-CONT.                                       62810007
565700                                                                  62820007
565800     MOVE SPACES TO       PV-DCNSL-SCAC                           62830007
565900                          TRT00015-RUL-CNSTR-VAL-TXT.             62840007
566000                                                                  62850007
566100     EXEC SQL                                                     62860007
566200         SELECT DISTINCT                                          62870007
566300                A.RUL_CNSTR_VAL_TXT                               62880007
566400         INTO   :TRT00015-RUL-CNSTR-VAL-TXT                       62890007
566500         FROM   TRT_RUL_CNSTR A                                   62900007
566600               ,TRT_RUL_CNSTR B                                   62910007
566700               ,TRT_RUL_CNSTR C                                   62920007
566800               ,TRT_RUL       D                                   62930007
566900         WHERE  A.RUL_ID            = B.RUL_ID                    62940007
567000           AND  A.RUL_ID            = C.RUL_ID                    62950007
567100           AND  A.RUL_ID            = D.RUL_ID                    62960007
567200           AND  A.RUL_CNSTR_TYP_CDE = 'DECN'                      62970007
567300           AND  B.RUL_CNSTR_TYP_CDE = 'CONT'                      62980007
567400           AND  B.RUL_CNSTR_VAL_TXT = :IMCNTK-CONTNR-ID           62990007
567500           AND  C.RUL_CNSTR_TYP_CDE = 'SEQ'                       63000007
567600           AND  INTEGER(SUBSTR(C.RUL_CNSTR_VAL_TXT,1,6))          63010007
567700                                    = :IMCNTK-CONTNR-SEQ-NBR      63020007
567800           AND  D.RUL_TYP_CDE       = :TRT00014-RUL-TYP-CDE       63030007
567900           AND  D.RUL_CDE           = 'CONT'                      63040007
568000     END-EXEC                                                     63050007
568100                                                                  63060007
568200     EVALUATE TRUE                                                63070007
568300                                                                  63080007
568400         WHEN SQLCODE = ZERO                                      63090007
568500             MOVE TRT00015-RUL-CNSTR-VAL-TXT  TO PV-DCNSL-SCAC    63100007
568600                                                                  63110007
568700         WHEN SQLCODE = +100                                      63120007
568800         WHEN SQLCODE = -811                                      63130007
568900             CONTINUE                                             63140007
569000                                                                  63150007
569100         WHEN SQLWARN0 NOT = SPACES                               63160007
569200         WHEN SQLCODE < ZERO                                      63170007
569300         WHEN SQLCODE > ZERO                                      63180007
569400             DISPLAY '** ABEND **'                                63190007
569500             DISPLAY '** SQLCODE = ' SQLCODE                      63200007
569600             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      63210007
569700             DISPLAY '** PARAGRAPH = 8910-SELECT-DCP-RULE-CONT'   63220007
569800             DISPLAY '** CONT ID  = ' IMCNTK-CONTNR-ID            63230007
569900             PERFORM 9100-SQL-ABEND                               63240007
570000     END-EVALUATE.                                                63250007
570100*                                                                 63260007
570200******************************************************************63270007
570300 8920-SELECT-DCP-RULE-VSL.                                        63280007
570400                                                                  63290007
570500     MOVE SPACES TO       PV-DCNSL-SCAC                           63300007
570600                          TRT00015-RUL-CNSTR-VAL-TXT.             63310007
570700                                                                  63320007
570800     EXEC SQL                                                     63330007
570900         SELECT DISTINCT                                          63340007
571000                VSLA.RUL_CNSTR_VAL_TXT                            63350007
571100         INTO   :TRT00015-RUL-CNSTR-VAL-TXT                       63360007
571200         FROM   TRT_RUL_CNSTR VSLA                                63370007
571300               ,TRT_RUL_CNSTR VSLB                                63380007
571400               ,TRT_RUL_CNSTR VSLC                                63390007
571500               ,TRT_RUL       VSLD                                63400007
571600         WHERE  VSLA.RUL_ID            = VSLB.RUL_ID              63410007
571700           AND  VSLA.RUL_ID            = VSLC.RUL_ID              63420007
571800           AND  VSLA.RUL_ID            = VSLD.RUL_ID              63430007
571900           AND  VSLA.RUL_CNSTR_TYP_CDE = 'DECN'                   63440007
572000           AND  VSLB.RUL_CNSTR_TYP_CDE = 'VSL'                    63450007
572100           AND  VSLD.RUL_TYP_CDE       = 'ADJ'                    63460007
572200           AND  VSLD.RUL_CDE           = 'VSL'                    63470007
572300**BUDBRAD  AND  VSLB.RUL_CNSTR_VAL_TXT =                          63480095
572300           AND  VSLB.RUL_CNSTR_VAL_TXT IN                         63481095
572400               (SELECT   A.RUL_CNSTR_VAL_TXT                      63490007
572500                  FROM   TRT_RUL_CNSTR A                          63500007
572600                        ,TRT_RUL_CNSTR B                          63510007
572700                        ,TRT_RUL_CNSTR C                          63520007
572800                        ,TRT_RUL       D                          63530007
572900                  WHERE  A.RUL_ID            = B.RUL_ID           63540007
573000                    AND  A.RUL_ID            = C.RUL_ID           63550007
573100                    AND  A.RUL_ID            = D.RUL_ID           63560007
573200                    AND  A.RUL_CNSTR_TYP_CDE = 'VSL'              63570007
573300                    AND  A.RUL_CNSTR_VAL_TXT =                    63580007
573400                                           VSLB.RUL_CNSTR_VAL_TXT 63590007
573500                    AND  B.RUL_CNSTR_TYP_CDE = 'CONT'             63600007
573600                    AND  B.RUL_CNSTR_VAL_TXT = :IMCNTK-CONTNR-ID  63610007
573700                    AND  C.RUL_CNSTR_TYP_CDE = 'SEQ'              63620007
573800                    AND  INTEGER(SUBSTR(C.RUL_CNSTR_VAL_TXT,1,6)) 63630007
573900                                         = :IMCNTK-CONTNR-SEQ-NBR 63640007
574000                    AND  D.RUL_TYP_CDE       = 'DEF'              63650007
574100                    AND  D.RUL_CDE           = 'CONT'             63660007
574200                    AND  D.RUL_BEG_DTE  = VSLD.RUL_BEG_DTE        63670007
574300                    AND  D.RUL_END_DTE  = VSLD.RUL_END_DTE        63680007
574400                )                                                 63690007
574500     END-EXEC                                                     63700007
574600                                                                  63710007
574700     EVALUATE TRUE                                                63720007
574800                                                                  63730007
574900         WHEN SQLCODE = ZERO                                      63740007
575000             MOVE TRT00015-RUL-CNSTR-VAL-TXT  TO PV-DCNSL-SCAC    63750007
575100                                                                  63760007
575200         WHEN SQLCODE = +100                                      63770007
575300         WHEN SQLCODE = -811                                      63780007
575400             CONTINUE                                             63790007
575500                                                                  63800007
575600         WHEN SQLWARN0 NOT = SPACES                               63810007
575700         WHEN SQLCODE < ZERO                                      63820007
575800         WHEN SQLCODE > ZERO                                      63830007
575900             DISPLAY '** ABEND **'                                63840007
576000             DISPLAY '** SQLCODE = ' SQLCODE                      63850007
576100             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      63860007
576200             DISPLAY '** PARAGRAPH = 8920-SELECT-DCP-RULE-VSL'    63870007
576300             DISPLAY '** CONT ID  = ' IMCNTK-CONTNR-ID            63880007
576400             PERFORM 9100-SQL-ABEND                               63890007
576500     END-EVALUATE.                                                63900007
576600*                                                                 63910007
576700                                                                  63920007
576800******************************************************************63930007
576900 8930-ENTID-COMPARE-PROCESS.                                      63940007
577000                                                                  63950007
577100     PERFORM 8940-SELECT-ENTITY-ID.                               63960007
577200     IF PV-ENT-ID = ZERO                                          63970007
577300       DISPLAY '#### RULE SCAC NOT ON TEXTENT TABLE'              63980007
577400       DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC                   63990007
577500       DISPLAY '#### CONT ID  = ' IMCNTK-CONTNR-ID                64000007
577600*      *** NO ENTID TO MATCH UP TO SO LET IT GO AS RETRAN         64010007
577700       SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                     64020007
577800     ELSE                                                         64030007
577900       IF AUCNRL-DCONSLR-ENT-ID = PV-ENT-ID                       64040007
578000         SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                   64050007
578100       END-IF                                                     64060007
578200     END-IF.                                                      64070007
578300                                                                  64080007
578400*    **************************************************           64090007
578500*    * THE ENTIDS MAY NOT MATCH BUT IT MAY STILL BE   *           64100007
578600*    * THE SAME DECONSOLIDATOR I.E. GALE TRIANGLE AND *           64110007
578700*    * EAST HAVE DIF ENTIDS.  LOOK ON A TABLE TO SEE  *           64120007
578800*    * IF THIS IS THE CASE.                           *           64130007
578900*    **************************************************           64140007
579000     IF PS-RETRAN-MATCH-TRAN-ENTID                                64150007
579100       CONTINUE                                                   64160007
579200     ELSE                                                         64170007
579300*        *****************************                            64180007
579400*        * LOOK UP RE-TRANSMIT ENTID *                            64190007
579500*        *****************************                            64200007
579600         SET PS-ENTID-FOUND-NO         TO TRUE                    64210007
579700         SET PS-END-OF-ENTID-TABLE-NO  TO TRUE                    64220007
579800         MOVE PV-ENT-ID   TO PV-SEARCH-ENT-ID                     64230007
579900         SET DECNO-IND                 TO 1                       64240007
580000         PERFORM 8950-SEARCH-ENTITY-TABLE                         64250007
580100           UNTIL PS-END-OF-ENTID-TABLE                            64260007
580200            OR  PS-ENTID-FOUND                                    64270007
580300         IF PS-ENTID-FOUND                                        64280007
580400           MOVE PV-TBL-DECON-ENT-NAME (DECNO-IND)                 64290007
580500                                    TO PV-HOLD-ENT-NAME           64300007
580600         ELSE                                                     64310007
580700           DISPLAY '#### RULE ENTID NOT ON DCONSLR.CONTROL'       64320007
580800           DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC               64330007
580900           DISPLAY '#### CONT ID  = ' IMCNTK-CONTNR-ID            64340007
581000*          *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN     64350007
581100           SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                 64360007
581200         END-IF                                                   64370007
581300     END-IF.                                                      64380007
581400                                                                  64390007
581500*    ***********************************                          64400007
581600*    * LOOK UP ORIGINAL TRANSMIT ENTID *                          64410007
581700*    ***********************************                          64420007
581800     IF PS-RETRAN-MATCH-TRAN-ENTID                                64430007
581900       CONTINUE                                                   64440007
582000     ELSE                                                         64450007
582100       SET PS-ENTID-FOUND-NO         TO TRUE                      64460007
582200       SET PS-END-OF-ENTID-TABLE-NO  TO TRUE                      64470007
582300       SET DECNO-IND                 TO 1                         64480007
582400       MOVE AUCNRL-DCONSLR-ENT-ID  TO PV-SEARCH-ENT-ID            64490007
582500       PERFORM 8950-SEARCH-ENTITY-TABLE                           64500007
582600         UNTIL PS-END-OF-ENTID-TABLE                              64510007
582700          OR  PS-ENTID-FOUND                                      64520007
582800       IF PS-ENTID-FOUND                                          64530007
582900         CONTINUE                                                 64540007
583000       ELSE                                                       64550007
583100           DISPLAY '#### TIMCNRL ENTID NOT ON DCONSLR.CONTROL'    64560007
583200           DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC               64570007
583300           DISPLAY '#### CONT ID  = ' IMCNTK-CONTNR-ID            64580007
583400*          *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN     64590007
583500           SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                 64600007
583600       END-IF                                                     64610007
583700     END-IF.                                                      64620007
583800                                                                  64630007
583900     IF PS-RETRAN-MATCH-TRAN-ENTID                                64640007
584000       CONTINUE                                                   64650007
584100     ELSE                                                         64660007
584200       IF PV-TBL-DECON-ENT-NAME (DECNO-IND) = PV-HOLD-ENT-NAME    64670007
584300         SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                   64680007
584400       END-IF                                                     64690007
584500     END-IF.                                                      64700007
584600                                                                  64710007
584700******************************************************************64720007
584800* SELECT DECON ENTID FOR THE CONTAINER OR VESSEL DECON SCAC      *64730007
584900******************************************************************64740007
585000 8940-SELECT-ENTITY-ID.                                           64750007
585100                                                                  64760007
585200     EXEC SQL                                                     64770007
585300        SELECT ENT_ID                                             64780007
585400        INTO  :EXTENT-ENT-ID                                      64790007
585500        FROM   TEXTENT                                            64800007
585600        WHERE  SCAC_CDE = :PV-DCNSL-SCAC                          64810007
585700     END-EXEC                                                     64820007
585800                                                                  64830007
585900     EVALUATE TRUE                                                64840007
586000         WHEN SQLCODE = ZERO                                      64850007
586100             MOVE EXTENT-ENT-ID TO PV-ENT-ID                      64860007
586200         WHEN SQLCODE = +100                                      64870007
586300         WHEN SQLCODE = -811                                      64880007
586400             MOVE ZEROES        TO PV-ENT-ID                      64890007
586500         WHEN SQLWARN0 NOT EQUAL SPACE                            64900007
586600         WHEN SQLCODE NOT EQUAL ZERO                              64910007
586700             DISPLAY '** ABEND **'                                64920007
586800             DISPLAY '** SQLCODE = ' SQLCODE                      64930007
586900             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      64940007
587000             DISPLAY '** PARAGRAPH = 8940-SELECT-ENTITY-ID'       64950007
587100             DISPLAY '** CONT ID  = ' IMCNTK-CONTNR-ID            64960007
587200             DISPLAY '** DCNSL SCAC ' PV-DCNSL-SCAC               64970007
587300             PERFORM 9100-SQL-ABEND                               64980007
587400     END-EVALUATE.                                                64990007
587500                                                                  65000007
587600******************************************************************65010007
587700* LOOK UP A DESCRIPTION USING THE DECON ENTID.                    65020007
587800******************************************************************65030007
587900 8950-SEARCH-ENTITY-TABLE.                                        65040007
588000                                                                  65050007
588100     SEARCH PV-DECONSOL-NO-TABLE-ENTRIES                          65060007
588200                                                                  65070007
588300         WHEN PV-TBL-DECON-ENT-ID(DECNO-IND) = PV-SEARCH-ENT-ID   65080007
588400            SET PS-ENTID-FOUND TO TRUE                            65090007
588500                                                                  65100007
588600         WHEN PV-TBL-DECON-ENT-ID(DECNO-IND)                      65110007
588700                                   = ZEROS OR LOW-VALUES          65120007
588800            SET PS-END-OF-ENTID-TABLE TO TRUE                     65130007
588900                                                                  65140007
589000         WHEN DECNO-IND = PC-DECONSOL-TBL-LIMIT                   65150007
589100            SET PS-END-OF-ENTID-TABLE TO TRUE                     65160007
589200                                                                  65170007
589300     END-SEARCH.                                                  65180007
589400                                                                  65190007
139868******************************************************************65200035
139868 8960-OUTLET-STORE-PREPACK.                                       65210035
139868                                                                  65220035
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     65230035
155029     PERFORM 7835-RETRIEVE-PLAN-NBR.                              65240073
155029                                                                  65250073
139868     PERFORM 8972-OPEN-PRPACK-DC-STR-CSR.                         65260035
139868                                                                  65270035
139868     PERFORM 8980-PROCESS-STORE-PRPK-CSR                          65280035
139868       UNTIL PS-EOC-STORE-CURSOR.                                 65290035
139868                                                                  65300035
139868     PERFORM 8974-CLOSE-PRPACK-DC-STR-CSR.                        65310035
139868                                                                  65320035
139868******************************************************************65330035
139868 8970-OUTLET-STORE-DC.                                            65340035
139868                                                                  65350035
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     65360035
155029     PERFORM 7830-RETRIEVE-PLAN-NBR.                              65370073
155029                                                                  65380073
139868     PERFORM 8971-OPEN-DC-STORE-CSR.                              65390035
139868                                                                  65400035
139868     PERFORM 8990-PROCESS-STORE-DC-CURSOR                         65410035
139868       UNTIL PS-EOC-STORE-CURSOR.                                 65420035
139868                                                                  65430035
139868     PERFORM 8973-CLOSE-DC-STORE-CSR.                             65440035
139868                                                                  65450035
139868******************************************************************65460035
139868 8971-OPEN-DC-STORE-CSR.                                          65470035
139868                                                                  65480035
139868     EXEC SQL                                                     65490035
139868          OPEN DC_OUT_CUR                                         65500035
139868     END-EXEC.                                                    65510035
139868                                                                  65520035
139868     EVALUATE TRUE                                                65530035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65540035
139868         WHEN SQLCODE NOT EQUAL ZERO                              65550035
139868             DISPLAY '** ABEND **'                                65560035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   65570035
139868             DISPLAY '** PARAGRAPH = 8971-OPEN-DC-STORE-CSR **'   65580035
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         65590035
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    65600035
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           65610035
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            65620035
155029             DISPLAY 'PLAN-NBR       = ' ALLPLN-PLAN-NBR          65630073
139868             PERFORM 9100-SQL-ABEND                               65640035
139868     END-EVALUATE.                                                65650035
139868                                                                  65660035
139868******************************************************************65670035
139868 8972-OPEN-PRPACK-DC-STR-CSR.                                     65680035
139868                                                                  65690035
139868     EXEC SQL                                                     65700035
139868          OPEN PRPACK_DC_OUT_CUR                                  65710035
139868     END-EXEC.                                                    65720035
139868                                                                  65730035
139868     EVALUATE TRUE                                                65740035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65750035
139868         WHEN SQLCODE NOT EQUAL ZERO                              65760035
139868             DISPLAY '** ABEND **'                                65770035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   65780035
139868             DISPLAY '** PARAGRAPH = '                            65790035
139868                     '8972-OPEN-PRPACK-DC-STR-CSR **'             65800035
139868             DISPLAY '** PO-NBR      = ' IMCNPO-PO-NBR            65810035
139868             DISPLAY '** PO-PREPK-ID = ' POPRPK-PO-PREPK-ID       65820035
139868             PERFORM 9100-SQL-ABEND                               65830035
139868     END-EVALUATE.                                                65840035
139868                                                                  65850035
139868******************************************************************65860035
139868 8973-CLOSE-DC-STORE-CSR.                                         65870035
139868                                                                  65880035
139868     EXEC SQL                                                     65890035
139868         CLOSE DC_OUT_CUR                                         65900035
139868     END-EXEC.                                                    65910035
139868                                                                  65920035
139868     EVALUATE TRUE                                                65930035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65940035
139868         WHEN SQLCODE NOT EQUAL ZERO                              65950035
139868             DISPLAY '** ABEND **'                                65960035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   65970035
139868             DISPLAY '** PARAGRAPH = 8973-CLOSE-DC-STORE-CSR**'   65980035
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         65990035
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    66000035
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           66010035
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            66020035
155029             DISPLAY 'PLAN-NBR       = ' ALLPLN-PLAN-NBR          66030073
139868             PERFORM 9100-SQL-ABEND                               66040035
139868     END-EVALUATE.                                                66050035
139868                                                                  66060035
139868******************************************************************66070035
139868 8974-CLOSE-PRPACK-DC-STR-CSR.                                    66080035
139868                                                                  66090035
139868     EXEC SQL                                                     66100035
139868         CLOSE PRPACK_DC_OUT_CUR                                  66110035
139868     END-EXEC.                                                    66120035
139868                                                                  66130035
139868     EVALUATE TRUE                                                66140035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            66150035
139868         WHEN SQLCODE NOT EQUAL ZERO                              66160035
139868             DISPLAY '** ABEND **'                                66170035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   66180035
139868             DISPLAY '** PARAGRAPH = 8974-CLOSE-PRPACK-DC-STR-CSR'66190035
139868             PERFORM 9100-SQL-ABEND                               66200035
139868     END-EVALUATE.                                                66210035
139868                                                                  66220035
139868******************************************************************66230035
139868 8975-FETCH-DC-STORE-CSR.                                         66240035
139868                                                                  66250035
139868     EXEC SQL                                                     66260035
139868          FETCH DC_OUT_CUR                                        66270035
139868           INTO :MESTDS-STR-NBR                                   66280035
139868               ,:MESTDS-STR-DISTRO-QTY                            66290035
139868     END-EXEC.                                                    66300035
139868                                                                  66310035
139868     EVALUATE TRUE                                                66320035
139868         WHEN SQLCODE = ZERO                                      66330035
139868             CONTINUE                                             66340035
139868                                                                  66350040
139868         WHEN SQLCODE = +100                                      66360035
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    66370035
139868             IF PS-FIRST-STORE                                    66380035
139868                SET PS-EOC-DC-CURSOR                              66390035
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          66400035
139868                PERFORM 8600-CLOSE-DC-CURSOR                      66410035
139868                INITIALIZE TR006-UPC-NBR                          66420035
139868                           TR006-ERROR-MSG                        66430035
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          66440035
139868                STRING 'CMN BULK MISSING SPLT-FIX/OUTLET'         66450043
139868                    DELIMITED BY SIZE                             66460035
139868                     INTO TR006-ERROR-MSG                         66470035
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               66480035
139868                PERFORM 8830-WRITE-ERROR-LINE                     66490035
139868                SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE           66500035
139868             END-IF                                               66510035
139868                                                                  66520035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            66530035
139868         WHEN SQLCODE NOT EQUAL ZERO                              66540035
139868             DISPLAY '** ABEND **'                                66550035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   66560035
139868             DISPLAY '** PARAGRAPH = 8975-FETCH-DC-STORE-CSR**'   66570035
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         66580035
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    66590035
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           66600035
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            66610035
139868             PERFORM 9100-SQL-ABEND                               66620035
139868     END-EVALUATE.                                                66630035
139868                                                                  66640035
139868******************************************************************66650035
139868 8976-FETCH-PRPACK-DC-STR-CSR.                                    66660035
139868                                                                  66670035
139868     EXEC SQL                                                     66680035
139868          FETCH PRPACK_DC_OUT_CUR                                 66690035
139868           INTO :MESTDS-STR-NBR                                   66700035
139868               ,:MESTDS-STR-DISTRO-QTY                            66710035
139868     END-EXEC.                                                    66720035
139868                                                                  66730035
139868     EVALUATE TRUE                                                66740035
139868         WHEN SQLCODE = ZERO                                      66750035
139868             CONTINUE                                             66760050
139868                                                                  66770035
139868         WHEN SQLCODE = +100                                      66780039
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    66790035
139868             IF PS-FIRST-STORE                                    66800035
139868**              SET PS-EOC-DC-CURSOR                              66810040
192900                SET PS-EOC-PREPACK-DC-CURSOR                      66820040
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          66830035
JNSINC*        MOVE '8976-FETCH-PRPACK-DC-STR-CSR' TO PV-PARA-NAME      66831085
JNSINC*        DISPLAY PV-PARA-NAME                                     66832085
139868                PERFORM 8425-CLOSE-PACK-DC-CURSOR                 66840035
139868                INITIALIZE TR006-UPC-NBR                          66850035
139868                           TR006-ERROR-MSG                        66860035
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          66870035
139868                STRING 'CMN PACK MISSING SPLT-FIX/OUTLET'         66880044
139868                    DELIMITED BY SIZE                             66890035
139868                     INTO TR006-ERROR-MSG                         66900035
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               66910035
139868                PERFORM 8830-WRITE-ERROR-LINE                     66920035
139868                SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE           66930035
139868             END-IF                                               66940035
139868                                                                  66950035
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            66960035
139868         WHEN SQLCODE NOT EQUAL ZERO                              66970035
139868             DISPLAY '** ABEND **'                                66980035
139868             DISPLAY '** PROGRAM = TRKUP008 **'                   66990035
139868             DISPLAY '** PARAGRAPH = 8976-FETCH-PRPACK-DC-STR-CSR'67000035
139868             DISPLAY '** PO-NBR      = ' IMCNPO-PO-NBR            67010035
155029             DISPLAY '** PLAN-NBR    = ' ALLPLN-PLAN-NBR          67020073
139868             DISPLAY '** PO-PREPK-ID = ' POPRPK-PO-PREPK-ID       67030035
139868             PERFORM 9100-SQL-ABEND                               67040035
139868     END-EVALUATE.                                                67050035
139868                                                                  67060035
139868******************************************************************67070035
139868 8980-PROCESS-STORE-PRPK-CSR.                                     67080035
139868                                                                  67090035
139868     PERFORM 8976-FETCH-PRPACK-DC-STR-CSR.                        67100035
139868                                                                  67110035
139868     IF PS-EOC-STORE-CURSOR                                       67120035
139868        IF PS-DC-SPLIT-INFO-PRESENT                               67130035
155029           SET PS-OUTLET-STORE-NO TO TRUE                         67140073
139868           PERFORM 2382-ADJUST-ROUNDED-OUT-DIST                   67150035
139868           PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                   67160035
139868           IF PV-NBR-CART-LBLS-UPC > 0                            67170035
139868**          PRINT THE REMAINDER OF THE CARTON LABELS              67180035
155029**GB          MOVE 10               TO PV-NBR-CART-LBLS-THIS-DC   67190073
139868              PERFORM 2394-CREATE-PCT-CARTON-LABELS               67200035
139868           END-IF                                                 67210035
139868        END-IF                                                    67220035
139868     ELSE                                                         67230035
139868        IF PS-FIRST-STORE                                         67240035
139868           SET PS-FIRST-STORE-NO      TO TRUE                     67250035
155029           SET PS-FIRST-DC-NO         TO TRUE                     67260073
139868                                                                  67270035
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          67280035
139868                      PV-TTL-ALL-DCS-UNITS                        67290035
139868                      PV-TTL-ALL-DCS-CARTS                        67300035
139868                                                                  67310035
139868        ELSE                                                      67320035
139868*         **********************************************          67330035
139868*         * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *          67340035
139868*         * EXTRACT FROM THE PRIOR STORE               *          67350035
139868*         **********************************************          67360035
139868           PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                   67370035
139868           IF PV-NBR-CART-LBLS-UPC > 0                            67380035
139868              PERFORM 2394-CREATE-PCT-CARTON-LABELS               67390035
139868           END-IF                                                 67400035
139868        END-IF                                                    67410035
139868        INITIALIZE TR004-REC-TYPE-PDC                             67420035
139868        MOVE MESTDS-STR-NBR         TO TR004-PDC-DIST-CNTR        67430035
139868        MOVE MESTDS-STR-DISTRO-QTY  TO TR004-PDC-UNIT-QTY         67440035
139868                                                                  67450037
155029        IF PV-FAST-E-BUS-IND = 'Y'                                67460073
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         67470073
155029             INTO MESTDS-STR-DISTRO-QTY                           67480073
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   67490073
155029        ELSE                                                      67500073
140332           DIVIDE PV-HOLD-PCK-UNIT-QTY                            67510056
140332             INTO MESTDS-STR-DISTRO-QTY                           67520056
140332               GIVING PV-QUOTIENT-ORDER-PERCENT                   67530056
155029        END-IF                                                    67540073
140332        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     67550038
140332            100 GIVING TR004-PDC-PERCNT ROUNDED                   67560038
139868                                                                  67570035
139868        IF TR004-PDC-PERCNT = ZERO                                67580035
139868           MOVE +1 TO TR004-PDC-PERCNT                            67590035
139868        END-IF                                                    67600035
139868                                                                  67610035
139868        ADD TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT         67620035
139868                                                                  67630035
139868        DIVIDE PV-HOLD-PCK-UNIT-PER-CTN                           67640035
139868          INTO MESTDS-STR-DISTRO-QTY                              67650035
139868             GIVING TR004-PDC-CART-CT ROUNDED                     67660035
139868                                                                  67670035
155029        ADD  TR004-PDC-UNIT-QTY     TO PV-TTL-ALL-DCS-UNITS       67680073
155029        ADD  TR004-PDC-CART-CT      TO PV-TTL-ALL-DCS-CARTS       67690073
139868        MOVE TR004-PDC-CART-CT      TO PV-NBR-CART-LBLS-THIS-DC   67700035
139868                                                                  67710035
139868     END-IF.                                                      67720035
139868                                                                  67730035
139868******************************************************************67740035
139868 8990-PROCESS-STORE-DC-CURSOR.                                    67750035
139868                                                                  67760035
139868     PERFORM 8975-FETCH-DC-STORE-CSR.                             67770035
139868                                                                  67780035
139868     IF PS-EOC-STORE-CURSOR                                       67790035
139868        IF PS-DC-SPLIT-INFO-PRESENT                               67800035
155029           SET PS-OUTLET-STORE-NO TO TRUE                         67810073
139868           PERFORM 2550-ADJUST-ROUNDED-OUT-DIST                   67820035
139868           PERFORM 5700-WRITE-DC-RECORD                           67830035
139868           IF PV-NBR-CART-LBLS-UPC > 0                            67840035
139868**          PRINT THE REMAINDER OF THE CARTON LABELS              67850035
155029**GB         MOVE 10                  TO PV-NBR-CART-LBLS-THIS-DC 67860073
139868             PERFORM 2720-CREATE-DC-CARTON-LABELS                 67870035
139868           END-IF                                                 67880035
139868        END-IF                                                    67890035
139868     ELSE                                                         67900035
139868        IF PS-FIRST-STORE                                         67910035
139868           SET PS-FIRST-STORE-NO      TO TRUE                     67920035
155029           SET PS-FIRST-DC-NO         TO TRUE                     67930073
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          67940035
139868                      PV-TTL-ALL-DCS-UNITS                        67950035
139868                      PV-TTL-ALL-DCS-CARTS                        67960035
139868                                                                  67970035
139868        ELSE                                                      67980035
139868*         **********************************************          67990035
139868*         * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *          68000035
139868*         * EXTRACT FROM THE PRIOR STORE               *          68010035
139868*         **********************************************          68020035
139868           PERFORM 5700-WRITE-DC-RECORD                           68030035
139868           IF PV-NBR-CART-LBLS-UPC > 0                            68040035
155029           AND PS-BYPASS-CRTN-WRITE-NO                            68050073
139868              PERFORM 2720-CREATE-DC-CARTON-LABELS                68060035
139868           END-IF                                                 68070035
139868        END-IF                                                    68080035
139868        INITIALIZE TR004-REC-TYPE-DC                              68090035
139868        MOVE MESTDS-STR-NBR         TO TR004-DIST-CNTR            68100035
139868        MOVE MESTDS-STR-DISTRO-QTY  TO TR004-DC-UNIT-QTY          68110035
139868                                                                  68120035
155029        IF PV-FAST-E-BUS-IND = 'Y'                                68130073
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         68140073
155029             INTO MESTDS-STR-DISTRO-QTY                           68150073
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   68160073
155029        ELSE                                                      68170073
139868           DIVIDE PV-HOLD-PCK-UNIT-QTY                            68180045
139868             INTO MESTDS-STR-DISTRO-QTY                           68190045
139868               GIVING PV-QUOTIENT-ORDER-PERCENT                   68200045
139868           MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                  68210045
139868               100 GIVING TR004-DC-PERCNT ROUNDED                 68220045
155029        END-IF                                                    68230073
139868                                                                  68240035
139868        IF TR004-DC-PERCNT = ZERO                                 68250035
139868           MOVE +1 TO TR004-DC-PERCNT                             68260035
139868        END-IF                                                    68270035
139868                                                                  68280035
139868        ADD TR004-DC-PERCNT   TO PV-TTL-ALL-DCS-PCT               68290035
139868                                                                  68300035
139868        DIVIDE PV-HOLD-PCK-CART-CT                                68310035
139868          INTO MESTDS-STR-DISTRO-QTY                              68320035
139868             GIVING TR004-DC-CART-CT ROUNDED                      68330035
139868                                                                  68340035
139868        MOVE TR004-DC-CART-CT  TO PV-NBR-CART-LBLS-THIS-DC        68350070
155029        ADD  TR004-DC-UNIT-QTY TO PV-TTL-ALL-DCS-UNITS            68360073
155029        ADD  TR004-DC-CART-CT  TO PV-TTL-ALL-DCS-CARTS            68370073
139868                                                                  68380035
139868     END-IF.                                                      68390035
139868                                                                  68400035
589500******************************************************************68410007
589600* END OF JOB ROUTINE.                                             68420007
589700******************************************************************68430007
589800 9000-EOJ-ROUTINE.                                                68440007
589900                                                                  68450007
590000     IF PS-NEED-SEALS                                             68460007
590100        PERFORM 8752-OPEN-SEAL-CURSOR                             68470007
590200        SET PS-EOC-SEAL-CURSOR-NO TO TRUE                         68480007
590300        PERFORM 2900-SEAL-CURSOR-FOR-XMIT                         68490007
590400          UNTIL PS-EOC-SEAL-CURSOR                                68500007
590500        PERFORM 8754-CLOSE-SEAL-CURSOR                            68510007
590600     END-IF.                                                      68520007
590700                                                                  68530007
590800     IF PA-TOTAL-OUTPUT-REC-COUNT = ZERO                          68540007
590900         CONTINUE                                                 68550007
591000     ELSE                                                         68560007
591100         INITIALIZE TR004-REC-TYPE-CTT                            68570007
591200         MOVE PA-TOTAL-OUTPUT-REC-COUNT TO                        68580007
591300             TR004-HASH-TOTALS                                    68590007
591400         PERFORM 5800-WRITE-PUR-ORDER-CTT-REC                     68600007
591500     END-IF.                                                      68610007
591600                                                                  68620007
591700     DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                       68630007
591800         PA-TOTAL-OUTPUT-REC-COUNT.                               68640007
591900     DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT.                  68650007
592000                                                                  68660007
592100     PERFORM 7010-CLOSE-DRIVER-CURSOR.                            68670007
592200                                                                  68680007
592300     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              68690007
592400     PERFORM 6570-UPDATE-TCKRSTCNTL.                              68700007
592500                                                                  68710007
592600 EJECT                                                            68720007
592700******************************************************************68730007
592800* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      68740007
592900* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 68750007
593000******************************************************************68760007
593100 9100-SQL-ABEND.                                                  68770007
593200******************************************************************68780007
593300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    68790007
593400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         68800007
593500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     68810007
593600* FORMAT.                                                         68820007
593700******************************************************************68830007
593800     COPY DPPD004.                                                68840007
593900                                                                  68850007
594000     MOVE +4013 TO ABEND-CODE.                                    68860007
594100     CALL 'ILBOABN0' USING ABEND-CODE.                            68870007
