      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    TFKCS441.                                         00040000
       AUTHOR.        JACK KRAMER.                                      00050000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
       DATE-WRITTEN.  OCTOBER 1996.                                     00070000
       DATE-COMPILED.                                                   00080000
                                                                        00090000
      *---------------------------------------------------------------* 00100000
      *    P441 - CREATE/MAINTAIN TRANSFER WORKSHEET.                 * 00110000
      *                                                               * 00120000
      *    THIS PROGRAM ALLOWS THE CREATION AND MAINTENANCE OF A   .  * 00130000
      *    TRANSFER WORKSHEET. INITIAL ENTRY TO THIS PROGRAM FROM THE * 00140000
      *    TRANSFER WORKSHEET SETUP WILL GENERATE THE RANDOM DATA KEY * 00150000
      *    AND INSERT A ROW IN THE TRANSFER MASTER TABLE WITH THE     * 00160000
      *    DKEY, XFER TYPE, CONTAINER TYPE, BEGIN TIMESTAMP, AND FROM * 00170000
      *    STORE NUMBER.                                              * 00180000
      *    A WORKSHEET MAY BE CREATED OR SUSPENDED FOR LATER ACCESS   * 00190000
      *    THROUGH THE WORKSHEET CRITERIA SPEC SCREEN. THE TRANSFER   * 00200000
      *    MAY ALSO BE COMPLETED, WHICH GENERATES THE TRANSFER        * 00210000
      *    SEQUENCE NUMBER AND UPDATES ALL APPROPRIATE TABLES, AND    * 00220000
      *    INSERTS A STATUS TABLE OF 'CM' FOR COMPLETED.              * 00230000
      *    THE PROGRAM USES MULTIPLE MAPS, THE SPECIFIC MAPS USED ARE * 00240000
      *    DETERMINED BY THE TRANSFER AND CONTAINER TYPES ENTERED ON  * 00250000
      *    THE PREVIOUS SCREEN (CREATE TRANSFER WORKSHEET SETUP).     * 00260000
      *    THE PROGRAM HANDLES BOTH RETAIL AND NON-RETAIL DETAIL      * 00270000
      *    TRANSFER LINES. THERE IS A LIMIT OF 2 SCREENS OF DETAIL    * 00280000
      *    INFORMATION (20 LINES PER SCREEN FOR RETAIL TRANSFERS AND  * 00290000
      *    10 LINES PER SCREEN FOR NON-RETAIL TRANSFERS). THE DETAIL  * 00300000
      *    INFORMATION IS HELD IN AN ARRAY OF 2 BLOCKS IN THE         * 00310000
      *    COMMAREA. THE PROGRAM TOGGLES BETWEEN THE 2 BLOCKS BY USE  * 00320000
      *    OF F7 PREVPAGE AND F8 NEXTPAGE.                            * 00330000
      *---------------------------------------------------------------* 00340000
      * 08/13/1998 - JACK KRAMER                                      * 00350000
      *    CHANGED THE LOGIC TO ALLOW TRANSFERS TO A STORE THAT IS    * 00360000
      *    CLOSING UP TO 1 WEEK PRIOR TO THE CLOSE DATE - USED TO BE  * 00370000
      *    3 WEEKS.                                                   * 00380000
      *---------------------------------------------------------------* 00390000
      *  1/20/2003 - RAY GRAF                                           00400000
      *   PROCESS NONINTELLIGENT SKU.                                   00410000
111703******************************************************************00420000
111703* 11/17/2003 - RAY GRAF                                           00430000
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00440000
111703*     REJECT SORT1 ITEMS FOR DEF/DAM SORT 2 TRANSFER TYPE         00450000
111703*     REJECT SORT2 ITEMS FOR DEF/DAM SORT 1 TRANSFER TYPE         00460000
111703*     REJECT DUMMY SKU'S AND DUMMY UPC'S FOR SORT1 TRANSFER TYPE  00470000
111703*     REJECT DEPT 127 AND 427 FOR EITHER DEF/DAM TRANSFER TYPE    00480000
111703*         WHEN THE 'TO' STORE IS 811 (FINDLAY)                    00490000
122403******************************************************************00500000
122403* 12/24/03 - RAY GRAF                                             00510000
122403*   DO NOT ALLOW DEF/DAM TRANSFER OR CALLBACK TO ANY              00520000
122403*   LOCATION OTHER THAN FINDLAY.                                  00530000
122403******************************************************************00540000
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00550000
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00560000
      ***************************************************************** 00570000
080504*DATE:08/05/04 CHANGED BY:JULIE TEWES CORRECTION TO DUMMY UPC     00580000
080504*              AND DEPT LOGIC ERROR                               00590000
080504******************************************************************00600000
092904*  9/29/2004 - RAY GRAF                                           00610000
092904*   REMOVE ALL REFERENCES TO TABLE TPPCPRC IN ORDER FOR           00620000
092904*   DBA TO REDEFINE AN INDEX FOR THIS TABLE.  TPPCPRC IS NOT      00630000
092904*   BEING ACCESSED IN THIS PROGRAM.                               00640000
      ******************************************************************00650000
100404* 10/04/2004 - RAY GRAF                                           00660000
100404*   EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                   00670000
      ******************************************************************00680000
051705*  DATE 05/17/05 RAY GRAF                                         00690000
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00700000
051705******************************************************************00710000
060110*  DATE 06/01/10 JACKIE HELING                                    00720000
060110*  BLOCK CERTAIN LOCATIONS FROM SENDING/RECEIVING TRANSFERS.      00730000
060110******************************************************************00740000
033111* WR39649 -  DAVID WELLER - 03/31/2011                            00750000
033111*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809     00760000
033111***************************************************************** 00770000
070111*  DATE 07/01/11 CHERI PARMLEY              WR#40189              00780000
070111*  ADD NEW LOOKUP RTV CENTER TABLE                                00790000
070111*  USE XST_DEPT TABLE FOR JEWELRY DEPTS                           00800000
070111******************************************************************00810000
SR3403*  DATE 03/02/12 JALAJ KUMAR                WR#SR3403             00820000
SR3403*  PRICE FIELD EXPANSIONS FOR LARGE RETAIL PROJECT                00830000
SR3403******************************************************************00840000
C83065******************************************************************00850000
C83065*   DATE 05/30/2014                                               00860000
C83065*   ADDED WHERE LOC_NBR = C.LOC_NBR IN THE RTV LOCATION QUERY.    00870000
C83065*   THIS IS ADDED TO FETCH THE CORRECT EFF_BEG_DTE FOR A SPECIFIC 00880000
C83065*   DC LOCATION.                                                  00890000
C83065*   FIND FOR THE TAG C83065 TO KNOW THE CHANGES.                  00900000
C83065*   MADE BY: SARVESWARAN N.S.K      WR/IR #: CHG0083065           00910000
C83065******************************************************************00920000
C83797*  DATE 06/06/2014 COGNIZANT                CHG# CHG0083797       00930000
C83797*  ADDED CONDITION TO PREVENT USER FROM ENTERING ZERO DOLLAR FOR  00940000
C83797*  PRICE FIELD                                                    00950000
C83797******************************************************************00960000
105225******************************************************************00970000
105225*  DATE 02/19/2015 COGNIZANT                CHG# CHG0105225       00980000
105225*  INCREASED SPACE FOR PV-READ-COUNT TO HOLD MAXIMUM COUNT OF     00990000
105225*  RECORDS RETRIEVED FROM TSKXREF TABLE.                          01000000
105225******************************************************************01010000
P11870*  DATE 07/27/2017 BARB SCHULTZ              CHG0170592           01020000
P11870*  BLOCK PREMIUM SUNGLASSES - DEPT 431 AND APPLE WATCHES - DEPT   01020100
P11870*  30, MAJOR CLASS = 10 AND (SUBCLASS = 11 OR 12).                01020200
P11870*  ALSO ADDED A NEW MESSAGE 3795 TO REPLACE 3194 - WORDING WAS    01020300
P11870*  CHANGED.                                                       01020400
P11870******************************************************************01020500
      * DATE:        09/24/2021                                         01020601
      * WR/IR#:      CHG0261678                                         01020704
      * PROGRAMMER:  GERMAN BANDA                                       01020801
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         01020901
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                   01021001
      *              MAKING THE CALL DYNAMIC VS STATIC                  01021101
      *----------------------------------------------------------------*01021201
CICS  * CHANGED 11/16/2022    BY JIM HUNTER      WR: CHG0278345         01021305
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        01021405
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       01021505
CICS  *-----------------------------------------------------------------01021605
      * CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369         01021706
      *    CHANGE CALL OF UPC CHECK DIGIT ROUTINE TO BE DYNAMIC         01021807
      *-----------------------------------------------------------------01022006
                                                                        01022100
                                                                        01022200
       EJECT                                                            01022300
       ENVIRONMENT DIVISION.                                            01022400
                                                                        01022500
       DATA DIVISION.                                                   01022600
                                                                        01022700
       WORKING-STORAGE SECTION.                                         01022800
                                                                        01022900
       01  DK-DB2-KEYS.                                                 01023000
           05  DK-XFER-TYPE                   PIC  X(02)  VALUE SPACE.  01023100
           05  DK-CONTNR-TYPE                 PIC  X(02)  VALUE SPACE.  01023200
           05  DK-XFER-DKEY-ID                PIC  S9(9)  VALUE ZERO    01023300
                                                          COMP.         01023400
           05  DK-STORE-NBR                   PIC  S9(4)  VALUE ZERO    01023500
                                                          COMP.         01023600
051705*    05  DK-STORE-NBR-9                 PIC S9(04)  VALUE ZERO    01024000
051705*                                                   COMP.         01025000
           05  DK-UPC-NBR                     PIC S9(15)  VALUE ZERO    01026000
                                                          COMP-3.       01027000
           05  DK-ITEM-NBR                    PIC S9(15)  VALUE ZEROS   01028000
                                                           COMP-3.      01029000
           05  DK-DEPT-NBR                    PIC S9(04)  VALUE ZEROS   01030000
                                                           COMP-3.      01040000
           05  DK-CLASS-NBR                   PIC S9(04)  VALUE ZEROS   01050000
                                                           COMP-3.      01060000
           05  DK-SUBCLASS-NBR                PIC S9(04)  VALUE ZEROS   01070000
                                                           COMP-3.      01080000
111703     05  DK-TO-STR-NBR                  PIC S9(04)  VALUE ZEROS   01090000
111703                                                     COMP.        01100000
                                                                        01110000
       01  PC-PROGRAM-CONSTANTS.                                        01120000
100404     05  PC-RTV-811                     PIC  9(04)  VALUE 811.    01130000
100404     05  PC-RV-FINDLAY-NAME             PIC  X(10)                01140000
100404                                        VALUE 'RV-FINDLAY'.       01150000
           05  PC-FROM-CRIT-SPEC              PIC  X(01)  VALUE '2'.    01160000
           05  PC-FROM-WORKSHEET-SETUP        PIC  X(01)  VALUE '1'.    01170000
           05  PC-COMPLETE-STATUS             PIC  X(02)  VALUE 'CM'.   01180000
           05  PC-ZERO                         PIC S9(04)  VALUE ZERO   01190000
                                                           COMP SYNC.   01200000
           05  PC-SCL                         PIC  X(03)  VALUE 'SCL'.  01210000
           05  PC-KOHLS-OPERATING-COMPANY     PIC  X(02)  VALUE '03'.   01220000
           05  PC-FIVE-DAYS                   PIC 9(01) VALUE 5.        01230000
           05  PC-CLEARANCE                   PIC  9(02)  VALUE 30.     01240000
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01250000
                                                          'TF441A  '.   01260000
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01270000
                                                          'TFKM441 '.   01280000
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01290000
                                                          'TFKCS441'.   01300000
           05  PC-COMMON-HEADER-MAP-NAME      PIC  X(08)  VALUE         01310000
                                                          'TF441A  '.   01320000
           05  PC-COMPLETED-BY-MAP-NAME       PIC  X(08)  VALUE         01330000
                                                          'TF441B  '.   01340000
           05  PC-CALLBACK-MAP-NAME           PIC  X(08)  VALUE         01350000
                                                          'TF441C  '.   01360000
           05  PC-APPROVAL-MAP-NAME           PIC  X(08)  VALUE         01370000
                                                          'TF441D  '.   01380000
           05  PC-CUSTOMER-MAP-NAME           PIC  X(08)  VALUE         01390000
                                                          'TF441E  '.   01400000
           05  PC-NON-RETAIL-MAP-NAME         PIC  X(08)  VALUE         01410000
                                                          'TF441F  '.   01420000
           05  PC-TOTE-MAP-NAME               PIC  X(08)  VALUE         01430000
                                                          'TF441G  '.   01440000
           05  PC-TRAILER-MAP-NAME            PIC  X(08)  VALUE         01450000
                                                          'TF441H  '.   01460000
           05  PC-RTL-DETAIL-MAP-NAME         PIC  X(08)  VALUE         01470000
                                                          'TF441I  '.   01480000
           05  PC-NRTL-DETAIL-MAP-NAME        PIC  X(08)  VALUE         01490000
                                                          'TF441J  '.   01500000
           05  PC-DC2                         PIC  X(03)  VALUE 'DC2'.  01510000
           05  PC-DC4                         PIC  X(03)  VALUE 'DC4'.  01520000
           05  PC-YES                         PIC  X(01)  VALUE 'Y'.    01530000
           05  PC-DS                          PIC  X(02)  VALUE 'DS'.   01540000
           05  PC-ENTRY-METHOD                PIC  X(02)  VALUE '02'.   01550000
111703     05  PC-DEFECTIVE-DAMAGE-SORT1      PIC  X(02)  VALUE '00'.   01560000
111703     05  PC-DEFECTIVE-DAMAGE-SORT2      PIC  X(02)  VALUE '01'.   01570000
           05  PC-CALLBACK                    PIC  X(02)  VALUE '02'.   01580000
           05  PC-STOCK-BALANCE-MSG           PIC  X(13)  VALUE         01590000
                                              'STOCK BALANCE'.          01600000
           05  PC-CUST-NON-HANDCARRY-MSG      PIC  X(22)  VALUE         01610000
                                              'CUSTOMER NON-HANDCARRY'. 01620000
           05  PC-STOCK-BAL-CORP              PIC  X(02)  VALUE '03'.   01630000
           05  PC-STOCK-BAL-STORE             PIC  X(02)  VALUE '04'.   01640000
           05  PC-CUSTOMER                    PIC  X(02)  VALUE '05'.   01650000
           05  PC-NON-RETAIL                  PIC  X(02)  VALUE '06'.   01660000
           05  PC-OFFSITE-STORAGE             PIC  X(02)  VALUE '07'.   01670000
           05  PC-SECURE-TOTE                 PIC  X(02)  VALUE '02'.   01680000
           05  PC-TRAILER                     PIC  X(02)  VALUE '04'.   01690000
           05  PC-HAND-CARRY                  PIC  X(02)  VALUE '05'.   01700000
           05  PC-OP-CO-NMBR                  PIC  X(02)  VALUE '03'.   01710000
           05  PC-DC                          PIC  X(02)  VALUE 'DC'.   01720000
           05  PC-RTV                         PIC  X(02)  VALUE 'RV'.   01730000
           05  PC-DEPT-STR                    PIC  X(02)  VALUE 'DS'.   01740000
           05  PC-SETUP-FORMAT                PIC  X(01)  VALUE '1'.    01750000
           05  PC-FR-STR-FORMAT               PIC  X(01)  VALUE '5'.    01760000
           05  PC-MAX-TIMESTAMP               PIC  X(26)  VALUE         01770000
                            '9999-12-31-24.00.00.000000'.               01780000
           05 PC-INIT                   PIC  X(04)  VALUE 'INIT'.       01790000
           05 PC-PUT                    PIC  X(04)  VALUE 'PUT'.        01800000
           05 PC-TERM                   PIC  X(04)  VALUE 'TERM'.       01810000
           05 PC-TOP-OF-PAGE            PIC  X(01)  VALUE '1'.          01820000
           05 PC-SINGLE-SPACE           PIC  X(01)  VALUE ' '.          01830000
           05 PC-DOUBLE-SPACE           PIC  X(01)  VALUE '0'.          01840000
           05  PC-DAYS-IN-ONE-WEEK             PIC  9(02)  VALUE  7.    01850000
           05  PC-DEFAULT-CLOSED-DATE          PIC  X(10)  VALUE        01860000
               '9999-09-09'.                                            01870000
           05  PC-LINE-MAX                    PIC S9(02)  VALUE +60     01880000
                                                          COMP-3.       01890000
           05  PC-MAX-QTY                     PIC S9(03)  VALUE +999    01900000
                                                          COMP-3.       01910000
           05  PC-ITEMS-PER-RTL-PANEL         PIC S9(04)  VALUE +20     01920000
                                                          COMP SYNC.    01930000
           05  PC-ITEMS-PER-NRTL-PANEL        PIC S9(04)  VALUE +10     01940000
                                                          COMP SYNC.    01950000
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01960000
                                                          COMP SYNC.    01970000
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01980000
                                                          COMP-3.       01990000
           05  PC-RED-TICKET                   PIC  X(10)  VALUE        02000000
               '  RED TKT'.                                             02010000
           05  PC-YELLOW-TICKET                PIC  X(10)  VALUE        02020000
               'YELLO TKT'.                                             02030000
           05  PC-WHITE-TICKET                 PIC  X(10)  VALUE        02040000
               'WHITE TKT'.                                             02050000
111703     05  PC-VND-DC-RET-CDE               PIC  X(02)  VALUE SPACE. 02060000
111703         88  PC-MOS-RET-CDE                          VALUE 'MO'.  02070000
111703         88  PC-NON-RTV-RET-CDE                      VALUE 'MO'.  02080000
                                                                        02090000
           05  PC-DUMMY-SKU-CONVERSION-MSG     PIC  X(31)  VALUE        02100000
               'SKU 000 NOT FORMATTED CORRECTLY'.                       02110000
      *                                                                 02120000
           05  PC-TSYMSG-NUMBERS.                                       02130000
               10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  02140000
               10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  02150000
               10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  02160000
               10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  02170000
               10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  02180000
               10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02190000
               10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02200000
               10  PC-TSYMSG-00073            PIC  9(05)  VALUE 00073.  02210000
               10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  02220000
               10  PC-TSYMSG-00100            PIC  9(05)  VALUE 00100.  02230000
               10  PC-TSYMSG-00110            PIC  9(05)  VALUE 00110.  02240000
               10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02250000
               10  PC-TSYMSG-00342            PIC  9(05)  VALUE 00342.  02260000
               10  PC-TSYMSG-00413            PIC  9(05)  VALUE 00413.  02270000
               10  PC-TSYMSG-00827            PIC  9(05)  VALUE 00827.  02280000
               10  PC-TSYMSG-00844            PIC  9(05)  VALUE 00844.  02290000
               10  PC-TSYMSG-01403            PIC  9(05)  VALUE 01403.  02300000
               10  PC-TSYMSG-01449            PIC  9(05)  VALUE 01449.  02310000
               10  PC-TSYMSG-01460            PIC  9(05)  VALUE 01460.  02320000
               10  PC-TSYMSG-01461            PIC  9(05)  VALUE 01461.  02330000
               10  PC-TSYMSG-01479            PIC  9(05)  VALUE 01479.  02340000
               10  PC-TSYMSG-01482            PIC  9(05)  VALUE 01482.  02350000
               10  PC-TSYMSG-01483            PIC  9(05)  VALUE 01483.  02360000
               10  PC-TSYMSG-01484            PIC  9(05)  VALUE 01484.  02370000
               10  PC-TSYMSG-01485            PIC  9(05)  VALUE 01485.  02380000
               10  PC-TSYMSG-01486            PIC  9(05)  VALUE 01486.  02390000
               10  PC-TSYMSG-01487            PIC  9(05)  VALUE 01487.  02400000
               10  PC-TSYMSG-01489            PIC  9(05)  VALUE 01489.  02410000
               10  PC-TSYMSG-01495            PIC  9(05)  VALUE 01495.  02420000
               10  PC-TSYMSG-01521            PIC  9(05)  VALUE 01521.  02430000
               10  PC-TSYMSG-01539            PIC  9(05)  VALUE 01539.  02440000
               10  PC-TSYMSG-01542            PIC  9(05)  VALUE 01542.  02450000
               10  PC-TSYMSG-01543            PIC  9(05)  VALUE 01543.  02460000
               10  PC-TSYMSG-01544            PIC  9(05)  VALUE 01544.  02470000
      * STORE NOT OPEN TO RECEIVE                                       02480000
               10  PC-TSYMSG-01552            PIC  9(05)  VALUE 01552.  02490000
               10  PC-TSYMSG-01616            PIC  9(05)  VALUE 01616.  02500000
               10  PC-TSYMSG-01680            PIC  9(05)  VALUE 01680.  02510000
               10  PC-TSYMSG-02002            PIC  9(05)  VALUE 02002.  02520000
               10  PC-TSYMSG-02124            PIC  9(05)  VALUE 02124.  02530000
070111*************INVALID TRANSFER ITEM TYPE. MUST BE A (SORT2-RTV)    02540000
111703         10  PC-TSYMSG-03192            PIC  9(05)  VALUE 03192.  02550000
070111*************INVALID TRANSFER ITEM TYPE. THIS IS A (SORT1-DC) ITEM02560000
111703         10  PC-TSYMSG-03193            PIC  9(05)  VALUE 03193.  02570000
111703*************THIS DEPARTMENT REQUIRES A CALLBACK TRANSFER         02580000
P11870*        10  PC-TSYMSG-03194            PIC  9(05)  VALUE 03194.  02590000
P11870         10  PC-TSYMSG-03795            PIC  9(05)  VALUE 03795.  02600000
111703*************SKU 000 MUST BE SENT AS A (SORT2-RTV) ITEM           02610000
111703         10  PC-TSYMSG-03200            PIC  9(05)  VALUE 03200.  02620000
122403*************LOCATION CANNOT BE CHANGED FOR DEF/DAM TRANSFER      02630000
122403         10  PC-TSYMSG-03208            PIC  9(05)  VALUE 03208.  02640000
               10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02650000
                                                                        02660000
           05  PC-TKT-MSG.                                              02670000
               10  FILLER                     PIC  X(46)  VALUE         02680000
                   'TICKET PRICE MUST MATCH CURRENT FILE PRICE OF '.    02690000
SR3403         10  PC-TKT-PRICE               PIC ZZZZ9.99.             02700000
           05  PC-RED-TKT-MSG.                                          02710000
               10  FILLER                     PIC  X(48)  VALUE         02720000
                   'RED TICKET PRICE MUST NOT BE LOWER THAN CURRENT '.  02730000
               10  FILLER                     PIC  X(14)  VALUE         02740000
                   'FILE PRICE OF '.                                    02750000
SR3403         10  PC-RED-TKT-PRICE           PIC ZZZZ9.99.             02760000
           05  PC-RCP-MSG.                                              02770000
               10  FILLER                     PIC  X(19)  VALUE         02780000
                   'RCP - RETICKET TO $'.                               02790000
SR3403         10  PC-RCP-PRICE               PIC ZZZZ9.99.             02800000
               10  FILLER                     PIC  X(37)  VALUE         02810000
                   ' AND COMPLETE AN INSTORE PRICE CHANGE'.             02820000
           05  PC-CALLBACK-LITERAL            PIC  X(16)  VALUE         02830000
                   'CALLBACK NO...:'.                                   02840000
           05  PC-APPROVAL-LITERAL            PIC  X(16)  VALUE         02850000
                   'APPROVAL NO...:'.                                   02860000
           05  PC-REQUESTOR-LITERAL           PIC  X(16)  VALUE         02870000
                   'REQUESTED BY..:'.                                   02880000
           05  PC-ATTENTION-LITERAL           PIC  X(15)  VALUE         02890000
                   'ATTENTION TO.:'.                                    02900000
           05  PC-LG-TOTE-LITERAL             PIC  X(15)  VALUE         02910000
                   'LG TOTE SEAL.:'.                                    02920000
           05  PC-SM-TOTE-LITERAL             PIC  X(16)  VALUE         02930000
                   'SM TOTE SEAL..:'.                                   02940000
           05  PC-TRLR-SEAL-LITERAL           PIC  X(15)  VALUE         02950000
                   'TRAILER SEAL.:'.                                    02960000
           05  PC-TRLR-NBR-LITERAL            PIC  X(16)  VALUE         02970000
                   'TRAILER NUMBER:'.                                   02980000
           05  PC-WORKSHEET-LITERAL           PIC  X(14)  VALUE         02990000
                   'WORKSHEET NO.:'.                                    03000000
           05  PC-TRANSFER-LITERAL            PIC  X(14)  VALUE         03010000
                   'TRANSFER NO..:'.                                    03020000
      *                                                                 03030000
       01  PS-PROGRAM-SWITCHES.                                         03040000
           05  PS-STORE-FOUND-SW              PIC  X(01)  VALUE 'Y'.    03050000
               88  PS-STORE-FOUND                         VALUE 'Y'.    03060000
               88  PS-STORE-NOT-FOUND                     VALUE 'N'.    03070000
           05  PS-DC-FOUND-SW                 PIC  X(01)  VALUE 'Y'.    03080000
               88  PS-DC-FOUND                            VALUE 'Y'.    03090000
               88  PS-DC-NOT-FOUND                        VALUE 'N'.    03100000
           05  PS-CONTROL-FOUND-SW            PIC  X(01)  VALUE 'Y'.    03110000
               88  PS-CONTROL-FOUND                       VALUE 'Y'.    03120000
               88  PS-CONTROL-NOT-FOUND                   VALUE 'N'.    03130000
           05  PS-VALID-CALLBACK-SW           PIC  X(01)  VALUE 'N'.    03140000
               88  PS-VALID-CALLBACK                      VALUE 'Y'.    03150000
               88  PS-INVALID-CALLBACK                    VALUE 'N'.    03160000
           05  PS-VALID-DEPT-CL-SW            PIC  X(01)  VALUE 'N'.    03170000
               88  PS-VALID-DEPT-CL                       VALUE 'Y'.    03180000
               88  PS-INVALID-DEPT-CL                     VALUE 'N'.    03190000
           05  PS-FOUND-DUMMY-UPC             PIC  X(01)  VALUE 'N'.    03200000
               88  PS-FOUND-DUMMY-UPC-Y                   VALUE 'Y'.    03210000
               88  PS-FOUND-DUMMY-UPC-N                   VALUE 'N'.    03220000
           05  PS-VALID-UPC-SW                PIC  X(01)  VALUE 'N'.    03230000
               88  PS-VALID-UPC                           VALUE 'Y'.    03240000
               88  PS-INVALID-UPC                         VALUE 'N'.    03250000
           05  PS-VALID-CHECK-DIGIT-SW        PIC  X(01)  VALUE 'N'.    03260000
               88  PS-VALID-CHECK-DIGIT                   VALUE 'Y'.    03270000
               88  PS-INVALID-CHECK-DIGIT                 VALUE 'N'.    03280000
           05  PS-ITEM-FOUND-SW               PIC  X(01)  VALUE 'N'.    03290000
               88  PS-ITEM-FOUND                          VALUE 'Y'.    03300000
               88  PS-NO-ITEM-FOUND                       VALUE 'N'.    03310000
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    03320000
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    03330000
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    03340000
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    03350000
               88  PS-ERROR                               VALUE 'Y'.    03360000
               88  PS-NO-ERROR                            VALUE 'N'.    03370000
           05  PS-QTY-ERROR-FOUND-SW          PIC  X(01)  VALUE 'N'.    03380000
               88  PS-QTY-ERROR-FOUND                     VALUE 'Y'.    03390000
               88  PS-QTY-ERROR-NOT-FOUND                 VALUE 'N'.    03400000
           05  PS-SECURE-HAND-CARRY-SW        PIC  X(01)  VALUE 'N'.    03410000
               88  PS-SECURE-HAND-CARRY-OK                VALUE 'Y'.    03420000
               88  PS-SECURE-HAND-CARRY-NOT-OK            VALUE 'N'.    03430000
           05  PS-REGN-CLR-FOUND-SW           PIC  X(01)  VALUE 'N'.    03440000
               88  PS-REGN-CLR-FOUND                      VALUE 'Y'.    03450000
               88  PS-REGN-CLR-NOT-FOUND                  VALUE 'N'.    03460000
           05  PS-CLR-ITM-IND                 PIC  X(01)  VALUE SPACE.  03470000
               88  PS-NOT-CLR-ITM                         VALUE 'N'.    03480000
               88  PS-CLR-ITM                             VALUE 'Y'.    03490000
           05  PS-CLR-ITM-1ST-MKDN-IND        PIC  X(01)  VALUE SPACE.  03500000
               88  PS-NOT-1ST-MKDN                        VALUE 'N'.    03510000
               88  PS-1ST-MKDN                            VALUE 'Y'.    03520000
           05  PS-REGN-PRC-ITM-IND            PIC  X(01)  VALUE SPACE.  03530000
               88  PS-NOT-REGN-PRC-ITM                    VALUE 'N'.    03540000
               88  PS-REGN-PRC-ITM                        VALUE 'Y'.    03550000
111703     05  PS-VALID-XFER-IND              PIC  X(01)  VALUE 'Y'.    03560000
111703         88  PS-INVALID-XFER                        VALUE 'N'.    03570000
111703         88  PS-VALID-XFER                          VALUE 'Y'.    03580000
070111     05  PS-IS-DEPT-FOUND               PIC  X(01)  VALUE 'Y'.    03590000
070111         88  PS-DEPT-NOT-FOUND                      VALUE 'N'.    03600000
070111         88  PS-DEPT-FOUND                          VALUE 'Y'.    03610000
070111     05  PS-IS-RTV-FOUND                PIC  X(01)  VALUE 'Y'.    03620000
070111         88  PS-RTV-NOT-FOUND                       VALUE 'N'.    03630000
070111         88  PS-RTV-FOUND                           VALUE 'Y'.    03640000
P11870     05  PS-BLOCK-SUNGLASS-WATCHES-SW   PIC  X(01)  VALUE 'N'.    03650000
P11870         88  PS-BLOCK-SUNGLASS-WATCHES              VALUE 'Y'.    03660000
P11870         88  PS-SUNGLASS-WATCH-NOT-BLOCKED          VALUE 'N'.    03670000
      *                                                                 03680000
       01  PV-PROGRAM-VARIABLES.                                        03690000
100404*****HOLD FOR REGIONAL AND NONREGIONAL FIELDS                     03700000
100404     05  PV-NREGN-UNT-RTL-AMT          PIC S9(7)V9(2) VALUE ZERO. 03710000
100404     05  PV-NREGN-UPC-STAT-CHG-DTE     PIC  X(10)     VALUE SPACE.03720000
100404     05  PV-NREGN-UNT-RTL-CHG-DTE      PIC  X(10)     VALUE SPACE.03730000
100404     05  PV-NREGN-LOC-SKU-STAT-CDE     PIC  X(02)     VALUE SPACE.03740000
100404     05  PV-REGN-UNT-RTL-AMT           PIC S9(7)V9(2) VALUE ZERO. 03750000
100404     05  PV-REGN-UPC-STAT-CHG-DTE      PIC  X(10)     VALUE SPACE.03760000
100404     05  PV-REGN-UNT-RTL-CHG-DTE       PIC  X(10)     VALUE SPACE.03770000
100404     05  PV-REGN-LOC-SKU-STAT-CDE      PIC  X(02)     VALUE SPACE.03780000
                                                                        03790000
100404     05  PV-GP-RTL-QTY-NULL-IND         PIC S9(04)  VALUE +0      03800000
100404                                                    COMP SYNC.    03810000
100404     05  PV-GP-RTL-AMT-NULL-IND         PIC S9(04)  VALUE +0      03820000
100404                                                    COMP SYNC.    03830000
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03840000
                                                          COMP SYNC.    03850000
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      03860000
                                                    COMP SYNC.          03870000
           05  PV-SUB                         PIC S9(04)  VALUE +0      03880000
                                                          COMP SYNC.    03890000
           05  PV-BLOCK                       PIC S9(04)  VALUE +0      03900000
                                                          COMP SYNC.    03910000
           05  PV-HOLD-ITEM                   PIC S9(04)  VALUE +0      03920000
                                                          COMP SYNC.    03930000
           05  PV-ITEM                        PIC S9(04)  VALUE +0      03940000
                                                          COMP SYNC.    03950000
           05  PV-BLOCK2                      PIC S9(04)  VALUE +0      03960000
                                                          COMP SYNC.    03970000
           05  PV-ITEM2                       PIC S9(04)  VALUE +0      03980000
                                                          COMP SYNC.    03990000
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      04000000
                                                          COMP SYNC.    04010000
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      04020000
                                                          COMP SYNC.    04030000
100404*    05  PV-XFER-NBR                    PIC 9(09).                04040000
100404     05  PV-XFER-NBR                    PIC 9(10).                04050000
           05  FILLER REDEFINES PV-XFER-NBR.                            04060000
100404*        10  PV-FROM-STORE-NBR          PIC 9(03).                04070000
100404         10  PV-FROM-STORE-NBR          PIC 9(04).                04080000
               10  PV-SEQ-NBR                 PIC 9(06).                04090000
           05  PV-DISP-XFER-NBR.                                        04100000
100404*        10  PV-DISP-FROM-STORE-NBR     PIC X(03).                04110000
100404         10  PV-DISP-FROM-STORE-NBR     PIC X(04).                04120000
               10                             PIC X(01)  VALUE '-'.     04130000
               10  PV-DISP-SEQ-NBR            PIC 9(06).                04140000
           05  PV-DISPLAY-ITM-NBR              PIC  9(15)  VALUE ZEROS. 04150000
           05  PV-XFER-SEQ-NBR                 PIC S9(09)  VALUE ZERO   04160000
                                                          COMP SYNC.    04170000
           05  PV-UPC-CODE                     PIC S9(15)  VALUE ZERO   04180000
                                                           COMP-3.      04190000
           05  PV-UPC-CODE-DISPLAY             PIC 9(15)  VALUE ZERO.   04200000
           05  PV-MAP-START-BYTE              PIC S9(04)  VALUE ZERO    04210000
                                                          COMP SYNC.    04220000
           05  PV-DISPLAY-XFER-DKEY-ID         PIC  9(09)  VALUE ZEROS. 04230000
           05  PV-LINE-COUNT                  PIC  S9(03)  VALUE +0.    04240000
           05  PV-PAGE-COUNT                  PIC  S9(03)  VALUE +0.    04250000
           05  PV-HOLD-QTY                    PIC S9(04)  COMP.         04260000
           05  PV-LINE-NBR                    PIC S9(04)  COMP.         04270000
SR3403     05  PV-PRICE                       PIC ZZZZ9.99.             04280000
           05  PV-QUANTITY                    PIC ZZZ.                  04290000
SR3403     05  PV-EDIT-PRICE                  PIC S9(07)V9(2)           04300000
                                                    VALUE ZEROS         04310000
                                                    COMP-3.             04320000
           05  PV-EDIT-PRICE-4-DEC REDEFINES PV-EDIT-PRICE              04330000
SR3403                                        PIC S9(05)V9(4)           04340000
                                                    COMP-3.             04350000
           05  PV-LG-TOTE-FIELD.                                        04360000
               10  PV-LG-TOTE-SEAL1            PIC X(08).               04370000
               10                              PIC X(01)  VALUE SPACE.  04380000
               10  PV-LG-TOTE-SEAL2            PIC X(08).               04390000
           05  PV-NAME.                                                 04400000
               10  PV-INT                      PIC X(01).               04410000
               10                              PIC X(01)  VALUE SPACE.  04420000
               10  PV-LAST-NAME                PIC X(20).               04430000
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0     04440000
                                                           COMP SYNC.   04450000
           05  PV-DB2-TIMESTAMP               PIC X(26).                04460000
           05  PV-TIMESTAMP                   PIC X(26).                04470000
           05  PV-TIMESTAMP-FIELDS REDEFINES PV-TIMESTAMP.              04480000
               10  FILLER                     PIC X(14).                04490000
               10  PV-MINUTE                  PIC X(02).                04500000
               10  FILLER                     PIC X(02).                04510000
               10  PV-SECOND                  PIC X(01).                04520000
               10  FILLER                     PIC X(01).                04530000
               10  PV-NANOSEC-1-3             PIC X(03).                04540000
               10  PV-NANOSEC-4-6             PIC X(03).                04550000
           05  PV-RANDOM-KEY                  PIC 9(09).                04560000
           05  PV-RANDOM-KEY-FIELDS REDEFINES PV-RANDOM-KEY.            04570000
               10  PV-NANOSEC-4-6             PIC X(03).                04580000
               10  PV-NANOSEC-1-3             PIC X(03).                04590000
               10  PV-MINUTE                  PIC X(02).                04600000
               10  PV-SECOND                  PIC X(01).                04610000
                                                                        04620000
           05  PV-RANDOM-KEY-COMP-3           PIC S9(09) COMP-3.        04630000
           05  PV-DISPLAY-UPC-NBR              PIC  9(13)  VALUE ZEROS. 04640000
           05  PV-DISPLAY-INTR-UPC-ID          PIC  9(09)  VALUE ZEROS. 04650000
           05  PV-CURRENT-DATE.                                         04660000
               10  PV-CURRENT-YEAR             PIC  9(02)  VALUE ZEROS. 04670000
               10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 04680000
               10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 04690000
           05  PV-CLOSED-DATE.                                          04700000
               10  PV-CLOSED-CENTURY           PIC  9(02)  VALUE ZEROS. 04710000
               10  PV-CLOSED-YEAR              PIC  9(02)  VALUE ZEROS. 04720000
               10  FILLER                      PIC  X(01)  VALUE SPACE. 04730000
               10  PV-CLOSED-MONTH             PIC  9(02)  VALUE ZEROS. 04740000
               10  FILLER                      PIC  X(01)  VALUE SPACE. 04750000
               10  PV-CLOSED-DAY               PIC  9(02)  VALUE ZEROS. 04760000
           05  PV-GREGORIAN-DATE.                                       04770000
               10  PV-GD-MONTH                 PIC  9(02)  VALUE ZEROS. 04780000
               10  PV-GD-DAY                   PIC  9(02)  VALUE ZEROS. 04790000
               10  PV-GD-YEAR                  PIC  9(02)  VALUE ZEROS. 04800000
           05  PV-DAYS-DIFFERENCE              PIC  9(03)  VALUE ZEROS. 04810000
           05  PV-CURRENT-ISO-DATE             PIC X(10)   VALUE SPACE. 04820000
           05  PV-CUR-RTL-AMT                  PIC S9(7)V9(2) COMP-3.   04830000
           05  PV-GP-QTY                       PIC S9(3)V COMP-3.       04840000
           05  PV-GP-RTL-AMT                   PIC S9(5)V9(2) COMP-3.   04850000
           05  PV-MESSAGE.                                              04860000
               10  PV-MSG-COLOR                PIC X(10)   VALUE SPACES.04870000
               10  FILLER                      PIC X(14)   VALUE        04880000
                   'PRICE MUST BE'.                                     04890000
SR3403         10  PV-MSG-PRICE                PIC ZZZZZ.99 VALUE ZEROS.04900000
           05  PV-FROM-PRICE                   PIC S9(7)V9(2) COMP-3.   04910000
           05  PV-TO-PRICE                     PIC S9(7)V9(2) COMP-3.   04920000
           05  PV-CHECK-DUMMY-SKU-DEPT-CL.                              04930000
               10  PV-DUMMY-SKU-DEPT           PIC 9(03).               04940000
               10  PV-DUMMY-SKU-CL.                                     04950000
                   15  PV-DUMMY-SKU-CL-1       PIC 9(01) VALUE ZEROS.   04960000
                   15  PV-DUMMY-SKU-CL-2       PIC 9(01) VALUE ZEROS.   04970000
               10  PV-DUMMY-SKU-CL-9 REDEFINES PV-DUMMY-SKU-CL          04980000
                                               PIC 9(02).               04990000
               10  PV-DUMMY-SKU-000            PIC 9(03) VALUE ZEROS.   05000000
           05  PV-HOLD-UPC-NBR.                                         05010000
               10  PV-KOHLS-UPC-DIGITS         PIC X(04).               05020000
               10  PV-KOHLS-DEPT               PIC X(03).               05030000
               10  PV-KOHLS-CL.                                         05040000
                   15  PV-KOHLS-CL-1           PIC X(01).               05050000
                   15  PV-KOHLS-CL-2           PIC X(01).               05060000
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                  05070000
                                               PIC 9(02).               05080000
               10  PV-KOHLS-DUMMY-SKU-000      PIC X(03).               05090000
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).               05100000
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR              05110000
                                               PIC 9(13).               05120000
           05  PV-HOLD-DUMMY-SKU.                                       05130000
               10  PV-HOLD-DEPT                PIC X(03).               05140000
               10  PV-HOLD-DEPT-N REDEFINES PV-HOLD-DEPT                05150000
                                               PIC 9(03).               05160000
               10  PV-HOLD-CL                  PIC X(02).               05170000
               10  PV-HOLD-DUMMY-SKU-000       PIC X(03).               05180000
           05  PV-HOLD-DUMMY-SKU-N REDEFINES PV-HOLD-DUMMY-SKU          05190000
                                               PIC 9(08).               05200000
105225     05  PV-READ-COUNT                   PIC S9(06) VALUE +0      05210000
                                                          COMP SYNC.    05220000
           05  PV-NUM-ROWS                    PIC S9(9)    VALUE ZEROS  05230000
                                                           COMP SYNC.   05240000
070111     05  PV-DC                          PIC  9(04)  VALUE 0.      05250000
P11870     05  PV-DEPT-NBR                    PIC  9(4)   VALUE ZEROES. 05260000
P11870     05  PV-MAJ-CL-NBR                  PIC  9(4)   VALUE ZEROES. 05270000
P11870     05  PV-SUB-CL-NBR                  PIC  9(4)   VALUE ZEROES. 05280000
                                                                        05290000
       01  PWT-PROGRAM-WORK-TABLE.                                      05300000
           05  PWT-TABLE.                                               05310000
               10  PWT-BLOCK-ENTRIES  OCCURS 2 TIMES.                   05320000
                   15  PWT-ITEM-ENTRIES  OCCURS 20 TIMES.               05330000
                       20  PWT-QTY-CHECKED-SW     PIC X  VALUE ' '.     05340000
                           88  PWT-QTY-NOT-CHECKED     VALUE ' '.       05350000
                           88  PWT-QTY-CHECKED         VALUE 'Y'.       05360000
                       20  PWT-QTY-ERROR-SW       PIC X  VALUE ' '.     05370000
                           88  PWT-NO-QTY-ERROR        VALUE ' '.       05380000
                           88  PWT-QTY-ERROR           VALUE 'Y'.       05390000
       01  SD-SYSTEM-DATE.                                              05400000
           05  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE.     05410000
           05  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                     05420000
               10  SD-SYSTEM-MONTH         PIC  X(02).                  05430000
               10  FILLER                  PIC  X(01).                  05440000
               10  SD-SYSTEM-DAY           PIC  X(02).                  05450000
               10  FILLER                  PIC  X(01).                  05460000
               10  SD-SYSTEM-YEAR          PIC  X(02).                  05470000
           EJECT                                                        05480000
      *--- REPORT LINE DEFINITIONS FOR THE DRS REPORT                   05490000
      *                                                                 05500000
           COPY DPWS132O.                                               05510000
       01  HL2-HEADING-LINE-2.                                          05520000
           05  FILLER                          PIC  X(57)  VALUE SPACE. 05530000
           05  FILLER                          PIC  X(30)  VALUE        05540000
               'TRANSFER WORKSHEET'.                                    05550000
      *                                                                 05560000
       01  HL3-HEADING-LINE-3.                                          05570000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 05580000
           05  FILLER                          PIC  X(15)  VALUE        05590000
                'WORKSHEET NO.:'.                                       05600000
           05  HL3-CONTROL-NBR                 PIC  9(09).              05610000
100404     05  FILLER                          PIC  X(24)  VALUE SPACE. 05620000
           05  FILLER                          PIC  X(16)  VALUE        05630000
                'TO STORE......:'.                                      05640000
100404*    05  HL3-TO-STORE-NBR                PIC  9(03).              05650000
100404     05  HL3-TO-STORE-NBR                PIC  9(04).              05660000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 05670000
           05  HL3-TO-STORE-NAM                PIC  X(10).              05680000
       01  HL4-HEADING-LINE-4.                                          05690000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 05700000
           05  FILLER                          PIC  X(15)  VALUE        05710000
                'TRANSFER TYPE:'.                                       05720000
           05  HL4-XFER-TYPE                   PIC  X(02).              05730000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 05740000
           05  HL4-XFER-DESC                   PIC  X(20).              05750000
           05  FILLER                          PIC  X(10)  VALUE SPACE. 05760000
100404*    05  FILLER                          PIC  X(16)  VALUE        05770000
100404     05  FILLER                          PIC  X(18)  VALUE        05780000
                'CONTAINER TYPE:'.                                      05790000
           05  HL4-CONTNR-TYPE                 PIC  X(02).              05800000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 05810000
           05  HL4-CONTNR-DESC                 PIC  X(20).              05820000
       01  HL5-HEADING-LINE-5.                                          05830000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 05840000
           05  FILLER                          PIC  X(15)  VALUE        05850000
                'COMPLETED BY.:'.                                       05860000
           05  HL5-COMP-BY-INT                 PIC  X(01).              05870000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 05880000
           05  HL5-COMP-BY-NAM                 PIC  X(20).              05890000
           05  FILLER                          PIC  X(11)  VALUE SPACE. 05900000
           05  HL5-LITERAL                     PIC  X(16)  VALUE SPACE. 05910000
           05  HL5-FIELD                       PIC  X(22).              05920000
       01  HL6A-HEADING-LINE-6A.                                        05930000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 05940000
           05  FILLER                          PIC  X(15)  VALUE        05950000
                'ATTENTION TO.:'.                                       05960000
           05  HL6A-ATTN-TO-INT                PIC  X(01).              05970000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 05980000
           05  HL6A-ATTN-TO-NAM                PIC  X(20).              05990000
       01  HL6B-HEADING-LINE-6B.                                        06000000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 06010000
           05  FILLER                          PIC  X(15)  VALUE        06020000
                'CUSTOMER NAME:'.                                       06030000
           05  HL6B-CUST-NAME                  PIC  X(20).              06040000
           05  FILLER                          PIC  X(13)  VALUE SPACE. 06050000
           05  FILLER                          PIC  X(16)  VALUE        06060000
                'CUSTOMER PHONE:'.                                      06070000
           05  FILLER                          PIC  X(01)  VALUE '('.   06080000
           05  HL6B-PHONE-AREA                 PIC  X(03).              06090000
           05  FILLER                          PIC  X(02)  VALUE ')-'.  06100000
           05  HL6B-PHONE-EXCH                 PIC  X(03).              06110000
           05  FILLER                          PIC  X(01)  VALUE '-'.   06120000
           05  HL6B-PHONE-NBR                  PIC  X(04).              06130000
       01  HL7-HEADING-LINE-7.                                          06140000
           05  FILLER                          PIC  X(05)  VALUE SPACE. 06150000
           05  FILLER                          PIC  X(12)  VALUE        06160000
                'ADDRESS...:'.                                          06170000
           05  HL7-ADDRESS                     PIC  X(20).              06180000
           05  FILLER                          PIC  X(16)  VALUE SPACE. 06190000
           05  FILLER                          PIC  X(13)  VALUE        06200000
                'CITY.......:'.                                         06210000
           05  HL7-CITY                        PIC  X(20).              06220000
       01  HL8-HEADING-LINE-8.                                          06230000
           05  FILLER                          PIC  X(05)  VALUE SPACE. 06240000
           05  FILLER                          PIC  X(12)  VALUE        06250000
                '          :'.                                          06260000
           05  HL8-ADDRESS                     PIC  X(20).              06270000
           05  FILLER                          PIC  X(16)  VALUE SPACE. 06280000
           05  FILLER                          PIC  X(13)  VALUE        06290000
                'STATE/ZIP..:'.                                         06300000
           05  HL8-STATE                       PIC  X(02).              06310000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06320000
           05  HL8-ZIP                         PIC  X(05).              06330000
           05  HL8-DASH                        PIC  X(01)  VALUE SPACE. 06340000
           05  HL8-ZIP-EXT                     PIC  X(04).              06350000
       01  HL9-HEADING-LINE-9.                                          06360000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 06370000
           05  HL9-LITERAL-1                   PIC  X(15)  VALUE SPACE. 06380000
           05  HL9-FIELD-1                     PIC  X(20).              06390000
           05  FILLER                          PIC  X(13)  VALUE SPACE. 06400000
           05  HL9-LITERAL-2                   PIC  X(16)  VALUE SPACE. 06410000
           05  HL9-FIELD-2                     PIC  X(08).              06420000
       01  HL10A-HEADING-LINE-10A.                                      06430000
           05  FILLER                          PIC  X(20)  VALUE        06440000
             '  LN UPC            '.                                    06450000
           05  FILLER                          PIC  X(20)  VALUE        06460000
SR3403       ' TICKET QTY         '.                                    06470000
           05  FILLER                          PIC  X(20)  VALUE        06480000
             '  LN UPC            '.                                    06490000
           05  FILLER                          PIC  X(20)  VALUE        06500000
SR3403       '  TICKET QTY        '.                                    06510000
       01  HL10B-HEADING-LINE-10B.                                      06520000
           05  FILLER                          PIC  X(49)  VALUE        06530000
             '  LN   ITEM DESCRIPTION'.                                 06540000
           05  FILLER                          PIC  X(22)  VALUE        06550000
             'FIXTURE'.                                                 06560000
           05  FILLER                          PIC  X(10)  VALUE        06570000
             'DPT   QTY'.                                               06580000
       01  DL1A-DETAIL-LINE-1A.                                         06590000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06600000
           05  DL1A-LIN1                       PIC  ZZ9.                06610000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06620000
           05  DL1A-UPC1                       PIC  X(13).              06630000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06640000
SR3403     05  DL1A-PRC1                       PIC  ZZZZZ.ZZ.           06650000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06660000
           05  DL1A-QTY1                       PIC  X(03).              06670000
           05  FILLER                          PIC  X(11)  VALUE SPACE. 06680000
           05  DL1A-LIN2                       PIC  ZZ9.                06690000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06700000
           05  DL1A-UPC2                       PIC  X(13).              06710000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06720000
SR3403     05  DL1A-PRC2                       PIC  ZZZZZ.ZZ.           06730000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06740000
           05  DL1A-QTY2                       PIC  X(03).              06750000
           05  FILLER                          PIC  X(03)  VALUE SPACE. 06760000
       01  DL1B-DETAIL-LINE-1B.                                         06770000
           05  FILLER                          PIC  X(01)  VALUE SPACE. 06780000
           05  DL1B-LINE                       PIC  ZZ9.                06790000
           05  FILLER                          PIC  X(03)  VALUE SPACE. 06800000
           05  DL1B-DESCRIPTION                PIC  X(40)  VALUE SPACE. 06810000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 06820000
           05  DL1B-FIXTURE                    PIC  X(20)  VALUE SPACE. 06830000
           05  FILLER                          PIC  X(02)  VALUE SPACE. 06840000
           05  DL1B-DEPT                       PIC  X(03)  VALUE SPACE. 06850000
           05  FILLER                          PIC  X(03)  VALUE SPACE. 06860000
           05  DL1B-QTY                        PIC  X(03).              06870000
       01  BL-BLANK-LINE.                                               06880000
           05  FILLER                          PIC  X(80)  VALUE SPACE. 06890000
      ***************************************************************** 06900000
      **                  SYMBOLIC MAP DESCRIPTION                   ** 06910000
      **                                                             ** 06920000
      **  THE MAPSET FOR THIS PROGRAM CONSISTS OF 10 SEPERATE MAPS.  ** 06930000
      **  4 MAPS WILL BE DISPLAYED AT ONE TIME; THE SPECIFIC MAPS    ** 06940000
      **  DISPLAYED WILL DEPEND ON THE TRANSFER AND CONTAINER TYPES  ** 06950000
      **  BEING PROCESSED.                                           ** 06960000
      **  THE MAPS CONTAIN DATA AS FOLLOWS:                          ** 06970000
      **                                                             ** 06980000
      **  A)  COMMON HEADER INFO FOR ALL TRANSFER TYPES.             ** 06990000
      **  B)  COMPLETED BY INFO FOR DEF/DAMAGE & STOCK BALANCE-STORE.** 07000000
      **  C)  CALLBACK NUMBER FOR CALLBACK TRANSFERS.                ** 07010000
      **  D)  APPROVAL NUMBER FOR CORPORATE STOCK BALANCE TRANSFERS. ** 07020000
      **  E)  CUSTOMER INFO FOR CUSTOMER TRANSFERS.                  ** 07030000
      **  F)  NON-RETAIL SPECIFIC HEADER INFO.                       ** 07040000
      **  G)  TOTE SEAL INFO FOR ALL CONTAINERS EXCEPT TRAILER.      ** 07050000
      **  H)  TRAILER NUMBER & SEAL INFO FOR TRAILER CONTAINERS.     ** 07060000
      **  I)  DETAIL INFORMATION FOR RETAIL TRANSFERS.               ** 07070000
      **  J)  DETAIL INFORMATION FOR NON-RETAIL TRANSFERS.           ** 07080000
      ***************************************************************** 07090000
       01  MR-MAPSET-REDEFINITION.                                      07100000
           05  MR-A-HEADER.                                             07110000
               10  FILLER                        PIC  X(12).            07120000
               10  MR-A-LITERAL-L               PIC S9(04)  COMP.       07130000
               10  MR-A-LITERAL-A                PIC  X(01).            07140000
               10  MR-A-LITERAL-C                PIC  X(01).            07150000
               10  MR-A-LITERAL-H                PIC  X(01).            07160000
               10  MR-A-LITERAL                  PIC  X(14).            07170000
      *                                                                 07180000
               10  MR-A-CTL-NBR-L                PIC S9(04)  COMP.      07190000
               10  MR-A-CTL-NBR-A                PIC  X(01).            07200000
               10  MR-A-CTL-NBR-C                PIC  X(01).            07210000
               10  MR-A-CTL-NBR-H                PIC  X(01).            07220000
100404*        10  MR-A-CTL-NBR                  PIC  X(10).            07230000
100404         10  MR-A-CTL-NBR                  PIC  X(11).            07240000
      *                                                                 07250000
               10  MR-A-TO-STORE-NBR-L           PIC S9(04)  COMP.      07260000
               10  MR-A-TO-STORE-NBR-A           PIC  X(01).            07270000
               10  MR-A-TO-STORE-NBR-C           PIC  X(01).            07280000
               10  MR-A-TO-STORE-NBR-H           PIC  X(01).            07290000
               10  MR-A-TO-STORE-NBR.                                   07300000
100404*            15  MR-A-TO-STORE-NBR-N       PIC  9(03).            07310000
100404             15  MR-A-TO-STORE-NBR-N       PIC  9(04).            07320000
      *                                                                 07330000
               10  MR-A-TO-STORE-NAM-L           PIC S9(04)  COMP.      07340000
               10  MR-A-TO-STORE-NAM-A           PIC  X(01).            07350000
               10  MR-A-TO-STORE-NAM-C           PIC  X(01).            07360000
               10  MR-A-TO-STORE-NAM-H           PIC  X(01).            07370000
               10  MR-A-TO-STORE-NAM             PIC  X(10).            07380000
      *                                                                 07390000
               10  MR-A-XFER-TYPE-L              PIC S9(04)  COMP.      07400000
               10  MR-A-XFER-TYPE-A              PIC  X(01).            07410000
               10  MR-A-XFER-TYPE-C              PIC  X(01).            07420000
               10  MR-A-XFER-TYPE-H              PIC  X(01).            07430000
               10  MR-A-XFER-TYPE                PIC  X(01).            07440000
      *                                                                 07450000
               10  MR-A-XFER-DESC-L              PIC S9(04)  COMP.      07460000
               10  MR-A-XFER-DESC-A              PIC  X(01).            07470000
               10  MR-A-XFER-DESC-C              PIC  X(01).            07480000
               10  MR-A-XFER-DESC-H              PIC  X(01).            07490000
               10  MR-A-XFER-DESC                PIC  X(21).            07500000
      *                                                                 07510000
               10  MR-A-CONT-TYPE-L              PIC S9(04)  COMP.      07520000
               10  MR-A-CONT-TYPE-A              PIC  X(01).            07530000
               10  MR-A-CONT-TYPE-C              PIC  X(01).            07540000
               10  MR-A-CONT-TYPE-H              PIC  X(01).            07550000
               10  MR-A-CONT-TYPE                PIC  X(01).            07560000
      *                                                                 07570000
               10  MR-A-CONT-DESC-L              PIC S9(04)  COMP.      07580000
               10  MR-A-CONT-DESC-A              PIC  X(01).            07590000
               10  MR-A-CONT-DESC-C              PIC  X(01).            07600000
               10  MR-A-CONT-DESC-H              PIC  X(01).            07610000
               10  MR-A-CONT-DESC                PIC  X(18).            07620000
           05  MR-B-COMPLETED-BY.                                       07630000
      *                                                                 07640000
               10  FILLER                        PIC  X(12).            07650000
               10  MR-B-COMP-BY-INT-L            PIC S9(04)  COMP.      07660000
               10  MR-B-COMP-BY-INT-A            PIC  X(01).            07670000
               10  MR-B-COMP-BY-INT-C            PIC  X(01).            07680000
               10  MR-B-COMP-BY-INT-H            PIC  X(01).            07690000
               10  MR-B-COMP-BY-INT              PIC  X(01).            07700000
      *                                                                 07710000
               10  MR-B-COMP-BY-NAM-L            PIC S9(04)  COMP.      07720000
               10  MR-B-COMP-BY-NAM-A            PIC  X(01).            07730000
               10  MR-B-COMP-BY-NAM-C            PIC  X(01).            07740000
               10  MR-B-COMP-BY-NAM-H            PIC  X(01).            07750000
               10  MR-B-COMP-BY-NAM              PIC  X(20).            07760000
      *                                                                 07770000
           05  MR-C-CALLBACK.                                           07780000
               10  FILLER                        PIC  X(12).            07790000
               10  MR-C-COMP-BY-INT-L            PIC S9(04)  COMP.      07800000
               10  MR-C-COMP-BY-INT-A            PIC  X(01).            07810000
               10  MR-C-COMP-BY-INT-C            PIC  X(01).            07820000
               10  MR-C-COMP-BY-INT-H            PIC  X(01).            07830000
               10  MR-C-COMP-BY-INT              PIC  X(01).            07840000
      *                                                                 07850000
               10  MR-C-COMP-BY-NAM-L            PIC S9(04)  COMP.      07860000
               10  MR-C-COMP-BY-NAM-A            PIC  X(01).            07870000
               10  MR-C-COMP-BY-NAM-C            PIC  X(01).            07880000
               10  MR-C-COMP-BY-NAM-H            PIC  X(01).            07890000
               10  MR-C-COMP-BY-NAM              PIC  X(20).            07900000
      *                                                                 07910000
               10  MR-C-CALLBACK-NBR-L           PIC S9(04)  COMP.      07920000
               10  MR-C-CALLBACK-NBR-A           PIC  X(01).            07930000
               10  MR-C-CALLBACK-NBR-C           PIC  X(01).            07940000
               10  MR-C-CALLBACK-NBR-H           PIC  X(01).            07950000
               10  MR-C-CALLBACK-NBR.                                   07960000
                   15  MR-C-CALLBACK-NBR-N       PIC  9(04).            07970000
      *                                                                 07980000
           05  MR-D-APPROVAL.                                           07990000
               10  FILLER                        PIC  X(12).            08000000
               10  MR-D-COMP-BY-INT-L            PIC S9(04)  COMP.      08010000
               10  MR-D-COMP-BY-INT-A            PIC  X(01).            08020000
               10  MR-D-COMP-BY-INT-C            PIC  X(01).            08030000
               10  MR-D-COMP-BY-INT-H            PIC  X(01).            08040000
               10  MR-D-COMP-BY-INT              PIC  X(01).            08050000
      *                                                                 08060000
               10  MR-D-COMP-BY-NAM-L            PIC S9(04)  COMP.      08070000
               10  MR-D-COMP-BY-NAM-A            PIC  X(01).            08080000
               10  MR-D-COMP-BY-NAM-C            PIC  X(01).            08090000
               10  MR-D-COMP-BY-NAM-H            PIC  X(01).            08100000
               10  MR-D-COMP-BY-NAM              PIC  X(20).            08110000
      *                                                                 08120000
               10  MR-D-APPROVAL-NBR-L           PIC S9(04)  COMP.      08130000
               10  MR-D-APPROVAL-NBR-A           PIC  X(01).            08140000
               10  MR-D-APPROVAL-NBR-C           PIC  X(01).            08150000
               10  MR-D-APPROVAL-NBR-H           PIC  X(01).            08160000
               10  MR-D-APPROVAL-NBR.                                   08170000
                   15  MR-D-APPROVAL-NBR-N       PIC  9(09).            08180000
      *                                                                 08190000
           05  MR-E-CUSTOMER.                                           08200000
               10  FILLER                        PIC  X(12).            08210000
               10  MR-E-COMP-BY-INT-L            PIC S9(04)  COMP.      08220000
               10  MR-E-COMP-BY-INT-A            PIC  X(01).            08230000
               10  MR-E-COMP-BY-INT-C            PIC  X(01).            08240000
               10  MR-E-COMP-BY-INT-H            PIC  X(01).            08250000
               10  MR-E-COMP-BY-INT              PIC  X(01).            08260000
      *                                                                 08270000
               10  MR-E-COMP-BY-NAM-L            PIC S9(04)  COMP.      08280000
               10  MR-E-COMP-BY-NAM-A            PIC  X(01).            08290000
               10  MR-E-COMP-BY-NAM-C            PIC  X(01).            08300000
               10  MR-E-COMP-BY-NAM-H            PIC  X(01).            08310000
               10  MR-E-COMP-BY-NAM              PIC  X(20).            08320000
      *                                                                 08330000
               10  MR-E-REQ-BY-INT-L             PIC S9(04)  COMP.      08340000
               10  MR-E-REQ-BY-INT-A             PIC  X(01).            08350000
               10  MR-E-REQ-BY-INT-C             PIC  X(01).            08360000
               10  MR-E-REQ-BY-INT-H             PIC  X(01).            08370000
               10  MR-E-REQ-BY-INT               PIC  X(01).            08380000
      *                                                                 08390000
               10  MR-E-REQ-BY-NAM-L             PIC S9(04)  COMP.      08400000
               10  MR-E-REQ-BY-NAM-A             PIC  X(01).            08410000
               10  MR-E-REQ-BY-NAM-C             PIC  X(01).            08420000
               10  MR-E-REQ-BY-NAM-H             PIC  X(01).            08430000
               10  MR-E-REQ-BY-NAM               PIC  X(20).            08440000
      *                                                                 08450000
               10  MR-E-CUST-NAME-L              PIC S9(04)  COMP.      08460000
               10  MR-E-CUST-NAME-A              PIC  X(01).            08470000
               10  MR-E-CUST-NAME-C              PIC  X(01).            08480000
               10  MR-E-CUST-NAME-H              PIC  X(01).            08490000
               10  MR-E-CUST-NAME                PIC  X(20).            08500000
      *                                                                 08510000
               10  MR-E-PHONE-AREA-L             PIC S9(04)  COMP.      08520000
               10  MR-E-PHONE-AREA-A             PIC  X(01).            08530000
               10  MR-E-PHONE-AREA-C             PIC  X(01).            08540000
               10  MR-E-PHONE-AREA-H             PIC  X(01).            08550000
               10  MR-E-PHONE-AREA.                                     08560000
                   15  MR-E-PHONE-AREA-N         PIC  9(03).            08570000
      *                                                                 08580000
               10  MR-E-PHONE-EXCH-L             PIC S9(04)  COMP.      08590000
               10  MR-E-PHONE-EXCH-A             PIC  X(01).            08600000
               10  MR-E-PHONE-EXCH-C             PIC  X(01).            08610000
               10  MR-E-PHONE-EXCH-H             PIC  X(01).            08620000
               10  MR-E-PHONE-EXCH.                                     08630000
                   15  MR-E-PHONE-EXCH-N         PIC  9(03).            08640000
      *                                                                 08650000
               10  MR-E-PHONE-NBR-L              PIC S9(04)  COMP.      08660000
               10  MR-E-PHONE-NBR-A              PIC  X(01).            08670000
               10  MR-E-PHONE-NBR-C              PIC  X(01).            08680000
               10  MR-E-PHONE-NBR-H              PIC  X(01).            08690000
               10  MR-E-PHONE-NBR.                                      08700000
                   15  MR-E-PHONE-NBR-N          PIC  9(04).            08710000
      *                                                                 08720000
               10  MR-E-ADDR1-L                  PIC S9(04)  COMP.      08730000
               10  MR-E-ADDR1-A                  PIC  X(01).            08740000
               10  MR-E-ADDR1-C                  PIC  X(01).            08750000
               10  MR-E-ADDR1-H                  PIC  X(01).            08760000
               10  MR-E-ADDR1                    PIC  X(20).            08770000
      *                                                                 08780000
               10  MR-E-CITY-L                   PIC S9(04)  COMP.      08790000
               10  MR-E-CITY-A                   PIC  X(01).            08800000
               10  MR-E-CITY-C                   PIC  X(01).            08810000
               10  MR-E-CITY-H                   PIC  X(01).            08820000
               10  MR-E-CITY                     PIC  X(20).            08830000
      *                                                                 08840000
               10  MR-E-ADDR2-L                  PIC S9(04)  COMP.      08850000
               10  MR-E-ADDR2-A                  PIC  X(01).            08860000
               10  MR-E-ADDR2-C                  PIC  X(01).            08870000
               10  MR-E-ADDR2-H                  PIC  X(01).            08880000
               10  MR-E-ADDR2                    PIC  X(20).            08890000
      *                                                                 08900000
               10  MR-E-STATE-L                  PIC S9(04)  COMP.      08910000
               10  MR-E-STATE-A                  PIC  X(01).            08920000
               10  MR-E-STATE-C                  PIC  X(01).            08930000
               10  MR-E-STATE-H                  PIC  X(01).            08940000
               10  MR-E-STATE                    PIC  X(02).            08950000
      *                                                                 08960000
               10  MR-E-ZIP-L                    PIC S9(04)  COMP.      08970000
               10  MR-E-ZIP-A                    PIC  X(01).            08980000
               10  MR-E-ZIP-C                    PIC  X(01).            08990000
               10  MR-E-ZIP-H                    PIC  X(01).            09000000
               10  MR-E-ZIP.                                            09010000
                   15  MR-E-ZIP-N                PIC  9(05).            09020000
      *                                                                 09030000
               10  MR-E-ZIP-EXT-L                PIC S9(04)  COMP.      09040000
               10  MR-E-ZIP-EXT-A                PIC  X(01).            09050000
               10  MR-E-ZIP-EXT-C                PIC  X(01).            09060000
               10  MR-E-ZIP-EXT-H                PIC  X(01).            09070000
               10  MR-E-ZIP-EXT.                                        09080000
                   15  MR-E-ZIP-EXT-N            PIC  9(04).            09090000
      *                                                                 09100000
           05  MR-F-NON-RETAIL.                                         09110000
               10  FILLER                        PIC  X(12).            09120000
               10  MR-F-COMP-BY-INT-L            PIC S9(04)  COMP.      09130000
               10  MR-F-COMP-BY-INT-A            PIC  X(01).            09140000
               10  MR-F-COMP-BY-INT-C            PIC  X(01).            09150000
               10  MR-F-COMP-BY-INT-H            PIC  X(01).            09160000
               10  MR-F-COMP-BY-INT              PIC  X(01).            09170000
      *                                                                 09180000
               10  MR-F-COMP-BY-NAM-L            PIC S9(04)  COMP.      09190000
               10  MR-F-COMP-BY-NAM-A            PIC  X(01).            09200000
               10  MR-F-COMP-BY-NAM-C            PIC  X(01).            09210000
               10  MR-F-COMP-BY-NAM-H            PIC  X(01).            09220000
               10  MR-F-COMP-BY-NAM              PIC  X(20).            09230000
      *                                                                 09240000
               10  MR-F-REQ-BY-INT-L             PIC S9(04)  COMP.      09250000
               10  MR-F-REQ-BY-INT-A             PIC  X(01).            09260000
               10  MR-F-REQ-BY-INT-C             PIC  X(01).            09270000
               10  MR-F-REQ-BY-INT-H             PIC  X(01).            09280000
               10  MR-F-REQ-BY-INT               PIC  X(01).            09290000
      *                                                                 09300000
               10  MR-F-REQ-BY-NAM-L             PIC S9(04)  COMP.      09310000
               10  MR-F-REQ-BY-NAM-A             PIC  X(01).            09320000
               10  MR-F-REQ-BY-NAM-C             PIC  X(01).            09330000
               10  MR-F-REQ-BY-NAM-H             PIC  X(01).            09340000
               10  MR-F-REQ-BY-NAM               PIC  X(20).            09350000
      *                                                                 09360000
               10  MR-F-ATTN-TO-INT-L            PIC S9(04)  COMP.      09370000
               10  MR-F-ATTN-TO-INT-A            PIC  X(01).            09380000
               10  MR-F-ATTN-TO-INT-C            PIC  X(01).            09390000
               10  MR-F-ATTN-TO-INT-H            PIC  X(01).            09400000
               10  MR-F-ATTN-TO-INT              PIC  X(01).            09410000
      *                                                                 09420000
               10  MR-F-ATTN-TO-NAM-L            PIC S9(04)  COMP.      09430000
               10  MR-F-ATTN-TO-NAM-A            PIC  X(01).            09440000
               10  MR-F-ATTN-TO-NAM-C            PIC  X(01).            09450000
               10  MR-F-ATTN-TO-NAM-H            PIC  X(01).            09460000
               10  MR-F-ATTN-TO-NAM              PIC  X(20).            09470000
      *                                                                 09480000
           05  MR-G-TOTES.                                              09490000
               10  FILLER                        PIC  X(12).            09500000
               10  MR-G-LG-TOTE-SEAL1-L          PIC S9(04)  COMP.      09510000
               10  MR-G-LG-TOTE-SEAL1-A          PIC  X(01).            09520000
               10  MR-G-LG-TOTE-SEAL1-C          PIC  X(01).            09530000
               10  MR-G-LG-TOTE-SEAL1-H          PIC  X(01).            09540000
               10  MR-G-LG-TOTE-SEAL1            PIC  X(07).            09550000
      *                                                                 09560000
               10  MR-G-LG-TOTE-SEAL2-L          PIC S9(04)  COMP.      09570000
               10  MR-G-LG-TOTE-SEAL2-A          PIC  X(01).            09580000
               10  MR-G-LG-TOTE-SEAL2-C          PIC  X(01).            09590000
               10  MR-G-LG-TOTE-SEAL2-H          PIC  X(01).            09600000
               10  MR-G-LG-TOTE-SEAL2            PIC  X(07).            09610000
      *                                                                 09620000
               10  MR-G-SM-TOTE-SEAL-L           PIC S9(04)  COMP.      09630000
               10  MR-G-SM-TOTE-SEAL-A           PIC  X(01).            09640000
               10  MR-G-SM-TOTE-SEAL-C           PIC  X(01).            09650000
               10  MR-G-SM-TOTE-SEAL-H           PIC  X(01).            09660000
               10  MR-G-SM-TOTE-SEAL             PIC  X(07).            09670000
      *                                                                 09680000
           05  MR-H-TRAILER.                                            09690000
               10  FILLER                        PIC  X(12).            09700000
               10  MR-H-TRLR-SEAL-L              PIC S9(04)  COMP.      09710000
               10  MR-H-TRLR-SEAL-A              PIC  X(01).            09720000
               10  MR-H-TRLR-SEAL-C              PIC  X(01).            09730000
               10  MR-H-TRLR-SEAL-H              PIC  X(01).            09740000
               10  MR-H-TRLR-SEAL                PIC  X(07).            09750000
      *                                                                 09760000
               10  MR-H-TRLR-NBR-L               PIC S9(04)  COMP.      09770000
               10  MR-H-TRLR-NBR-A               PIC  X(01).            09780000
               10  MR-H-TRLR-NBR-C               PIC  X(01).            09790000
               10  MR-H-TRLR-NBR-H               PIC  X(01).            09800000
               10  MR-H-TRLR-NBR                 PIC  X(08).            09810000
      *                                                                 09820000
           05  MR-I-RTL-DETAIL.                                         09830000
               10  FILLER                        PIC  X(12).            09840000
               10  MR-I-SCROLL-AREA              OCCURS 20 TIMES.       09850000
                   15  MR-I-LINE-NBR-L           PIC S9(04) COMP.       09860000
                   15  MR-I-LINE-NBR-A           PIC  X(01).            09870000
                   15  MR-I-LINE-NBR-C           PIC  X(01).            09880000
                   15  MR-I-LINE-NBR-H           PIC  X(01).            09890000
                   15  MR-I-LINE-NBR.                                   09900000
                       20  MR-I-LINE-NBR-N       PIC  Z9.               09910000
      *                                                                 09920000
                   15  MR-I-UPC-L                PIC S9(04) COMP.       09930000
                   15  MR-I-UPC-A                PIC  X(01).            09940000
                   15  MR-I-UPC-C                PIC  X(01).            09950000
                   15  MR-I-UPC-H                PIC  X(01).            09960000
                   15  MR-I-UPC.                                        09970000
                       20  MR-I-UPC-N            PIC  Z(13).            09980000
      *                                                                 09990000
                   15  MR-I-PRICE-L              PIC S9(04) COMP.       10000000
                   15  MR-I-PRICE-A              PIC  X(01).            10010000
                   15  MR-I-PRICE-C              PIC  X(01).            10020000
                   15  MR-I-PRICE-H              PIC  X(01).            10030000
                   15  MR-I-PRICE.                                      10040000
SR3403                 20  MR-I-PRICE-N          PIC ZZZZZ.99.          10050000
      *                                                                 10060000
                   15  MR-I-QTY-L                PIC S9(04) COMP.       10070000
                   15  MR-I-QTY-A                PIC  X(01).            10080000
                   15  MR-I-QTY-C                PIC  X(01).            10090000
                   15  MR-I-QTY-H                PIC  X(01).            10100000
                   15  MR-I-QTY.                                        10110000
                       20  MR-I-QTY-N            PIC  Z(03).            10120000
      *                                                                 10130000
           05  MR-J-NRTL-DETAIL.                                        10140000
               10  FILLER                        PIC  X(12).            10150000
               10  MR-J-SCROLL-AREA              OCCURS 10 TIMES.       10160000
                   15  MR-J-LINE-NBR-L           PIC S9(04) COMP.       10170000
                   15  MR-J-LINE-NBR-A           PIC  X(01).            10180000
                   15  MR-J-LINE-NBR-C           PIC  X(01).            10190000
                   15  MR-J-LINE-NBR-H           PIC  X(01).            10200000
                   15  MR-J-LINE-NBR.                                   10210000
                       20  MR-J-LINE-NBR-N       PIC  Z9.               10220000
      *                                                                 10230000
                   15  MR-J-DESC-L               PIC S9(04) COMP.       10240000
                   15  MR-J-DESC-A               PIC  X(01).            10250000
                   15  MR-J-DESC-C               PIC  X(01).            10260000
                   15  MR-J-DESC-H               PIC  X(01).            10270000
                   15  MR-J-DESC                 PIC X(40).             10280000
      *                                                                 10290000
                   15  MR-J-FIXTURE-L            PIC S9(04) COMP.       10300000
                   15  MR-J-FIXTURE-A            PIC  X(01).            10310000
                   15  MR-J-FIXTURE-C            PIC  X(01).            10320000
                   15  MR-J-FIXTURE-H            PIC  X(01).            10330000
                   15  MR-J-FIXTURE              PIC X(20).             10340000
      *                                                                 10350000
                   15  MR-J-DEPT-L               PIC S9(04) COMP.       10360000
                   15  MR-J-DEPT-A               PIC  X(01).            10370000
                   15  MR-J-DEPT-C               PIC  X(01).            10380000
                   15  MR-J-DEPT-H               PIC  X(01).            10390000
                   15  MR-J-DEPT                 PIC X(03).             10400000
      *                                                                 10410000
                   15  MR-J-QTY-L                PIC S9(04) COMP.       10420000
                   15  MR-J-QTY-A                PIC  X(01).            10430000
                   15  MR-J-QTY-C                PIC  X(01).            10440000
                   15  MR-J-QTY-H                PIC  X(01).            10450000
                   15  MR-J-QTY.                                        10460000
                       20  MR-J-QTY-N            PIC  9(03).            10470000
      *                                                                 10480000
       01  MD-MAP-DATA-AREA                      PIC X(3000).           10490000
      *                                                                 10500000
           EJECT                                                        10510000
      *---------------------------------------------------------------* 10520000
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 10530000
      *---------------------------------------------------------------* 10540000
                                                                        10550000
           COPY DPWS015.                                                10560000
                                                                        10570000
060110*---------------------------------------------------------------* 10580000
060110*  LIST OF LOCATION EXCLUSIONS                                    10590000
060110*---------------------------------------------------------------* 10600000
060110     COPY TFWS010.                                                10610000
                                                                        10620000
      *---------------------------------------------------------------* 10630000
      *    FUNCTION KEYS COPYBOOK.                                    * 10640000
      *---------------------------------------------------------------* 10650000
                                                                        10660000
           COPY DPWS016.                                                10670000
                                                                        10680000
      *---------------------------------------------------------------* 10690000
      *    NUMERIC EDIT LAYOUT.                                       * 10700000
      *---------------------------------------------------------------* 10710000
                                                                        10720000
           COPY DPWS010I.                                               10730000
      *                                                                 10740000
      *  COPY BOOK FOR THE CALENDAR ROUTINE                             10750000
      *                                                                 10760000
           COPY DPWS500.                                                10770000
                                                                        10780000
       EJECT                                                            10790000
      *---------------------------------------------------------------* 10800000
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 10810005
      *---------------------------------------------------------------* 10820000
                                                                        10830000
           COPY DPWS030.                                                10840000
CICS       COPY DPWS930.                                                10841005
       EJECT                                                            10850000
      *---------------------------------------------------------------* 10860000
      *    STANDARD COMMAREA.                                         * 10870000
      *---------------------------------------------------------------* 10880000
                                                                        10890000
           COPY DPWS020.                                                10900000
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                10910000
                                                                        10920000
      *---------------------------------------------------------------* 10930000
      * INTER-APPLICATION COMMAREA.                                   * 10940000
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE          * 10950000
      *             TRANSFER WORKSHEET SETUP SCREEN.                  * 10960000
      *   TFWS001 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED TO THE   * 10970000
      *             TRANSFER WORKSHEET INQUIRY SCREEN.                * 10980000
      *---------------------------------------------------------------* 10990000
                                                                        11000000
               10  INTER-APPL-COMM-AREA       PIC X(200).               11010000
           COPY TFWS001.                                                11020000
      *---------------------------------------------------------------* 11030000
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 11040000
      *---------------------------------------------------------------* 11050000
               10  ASC-SPECIFIC-COMMAREA.                               11060000
                   15  ASC-CONTROL-NBR                     PIC  9(09).  11070000
                   15  ASC-XFER-SEQ-NBR                    PIC  S9(09)  11080000
                                                                COMP.   11090000
                   15  ASC-XFER-DKEY-ID                    PIC  S9(09)  11100000
                                                                COMP.   11110000
                   15  ASC-XFER-TYPE                       PIC  X(02).  11120000
                       88  ASC-NON-RETAIL-XFER             VALUE '06'.  11130000
                       88  ASC-RETAIL-XFER                 VALUE        11140000
111703                                           '00' THRU '05', '07'.  11150000
                       88  ASC-ZERO-SKU-ALLOWED            VALUE        11160000
                                                 '00', '01', '02'.      11170000
                   15  ASC-XFER-DESC                       PIC  X(21).  11180000
                   15  ASC-CONTNR-TYPE                     PIC  X(02).  11190000
                       88  ASC-SECURE-TOTE                 VALUE '02'.  11200000
                   15  ASC-CONTNR-DESC                     PIC  X(18).  11210000
100404             15  ASC-FR-STORE-NBR                    PIC  9(04).  11220000
                       88  ASC-OVERRIDE-TO-FINDLAY-RTV  VALUES          11230000
                         220, 230 THRU 234, 246 THRU 248, 258, 297,     11240000
      * ------  DISTRICT 14 NEW STORE - 01/19/98 -----------------      11250000
                      301,                                              11260000
      * ------  DISTRICT 11 STORES - 08/31/97 --------------------      11270000
                      072, 102, 126, 127, 129, 201, 217, 256, 281,      11280000
      * ------  DISTRICT 08 & 17 STORES - 10/05/97 ---------------      11290000
                      048, 049, 051 THRU 055, 079, 086, 103 THRU 105,   11300000
                      202, 215, 219, 228, 241, 245, 257,                11310000
      * ------  DISTRICT 05, 06 & 12 STORES - 01/19/98 -----------      11320000
                      019, 057 THRU 070, 073, 075, 077, 078, 083,       11330000
                      088, 203, 224, 229, 259, 260.                     11340000
      * ----------------------------------------------------------      11350000
100404*            15  ASC-TO-STORE-NBR                    PIC  X(03).  11360000
100404             15  ASC-TO-STORE-NBR                    PIC  X(04).  11370000
                   15  ASC-TO-STORE-NBR-N REDEFINES ASC-TO-STORE-NBR    11380000
100404*                                                    PIC  9(03).  11390000
100404                                                     PIC  9(04).  11400000
                   15  ASC-TO-STORE-NAM                    PIC  X(10).  11410000
                   15  ASC-TO-STORE-TYPE                   PIC  X(02).  11420000
                   15  ASC-COMP-BY-INT                     PIC  X(01).  11430000
                   15  ASC-COMP-BY-NAM                     PIC  X(20).  11440000
                   15  ASC-REQ-BY-INT                      PIC  X(01).  11450000
                   15  ASC-REQ-BY-NAM                      PIC  X(20).  11460000
                   15  ASC-ATTN-TO-INT                     PIC  X(01).  11470000
                   15  ASC-ATTN-TO-NAM                     PIC  X(20).  11480000
                   15  ASC-CALLBACK-NBR                    PIC  X(04).  11490000
                   15  ASC-CALLBACK-NBR-N REDEFINES ASC-CALLBACK-NBR    11500000
                                                           PIC  9(04).  11510000
                   15  ASC-APPROVAL-NBR                    PIC  X(09).  11520000
                   15  ASC-APPROVAL-NBR-N REDEFINES ASC-APPROVAL-NBR    11530000
                                                           PIC  9(09).  11540000
                   15  ASC-CUST-NAME                       PIC  X(20).  11550000
                   15  ASC-PHONE                           PIC  X(10).  11560000
                   15  FILLER REDEFINES ASC-PHONE.                      11570000
                       20  ASC-PHONE-AREA.                              11580000
                           25  ASC-PHONE-AREA-N            PIC  9(03).  11590000
                       20  ASC-PHONE-EXCH.                              11600000
                           25  ASC-PHONE-EXCH-N            PIC  9(03).  11610000
                       20  ASC-PHONE-NBR.                               11620000
                           25  ASC-PHONE-NBR-N             PIC  9(04).  11630000
                   15  ASC-ADDR1                           PIC  X(20).  11640000
                   15  ASC-ADDR2                           PIC  X(20).  11650000
                   15  ASC-CITY                            PIC  X(20).  11660000
                   15  ASC-STATE                           PIC  X(02).  11670000
                   15  ASC-ZIP                             PIC X(05).   11680000
                   15  ASC-ZIP-N REDEFINES ASC-ZIP         PIC  9(05).  11690000
                   15  ASC-ZIP-EXT                         PIC  X(04).  11700000
                   15  ASC-ZIP-EXT-N REDEFINES ASC-ZIP-EXT PIC  9(04).  11710000
                   15  ASC-LG-TOTE-SEAL1                   PIC  X(07).  11720000
                   15  ASC-LG-TOTE-SEAL2                   PIC  X(07).  11730000
                   15  ASC-SM-TOTE-SEAL                    PIC  X(07).  11740000
                   15  ASC-TRAILER-SEAL                    PIC  X(07).  11750000
                   15  ASC-TRAILER-NBR                     PIC  X(08).  11760000
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                11770000
                       20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  11780000
                           88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   11790000
                           88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   11800000
                       20  ASC-RETAIL-ITEM-ARRAY.                       11810000
                           25  ASC-RETAIL-ENTRIES OCCURS 20 TIMES.      11820000
                               30  FILLER                PIC  X(16).    11830000
                               30  ASC-UPC               PIC  X(13).    11840000
                               30  ASC-UPC-X REDEFINES ASC-UPC.         11850000
                                   45  ASC-UPC-DIGITS-1-8  PIC X(08).   11860000
                                   45  ASC-UPC-DIGITS-9-13 PIC X(05).   11870000
                               30  ASC-UPC-XX REDEFINES ASC-UPC.        11880000
                                   45  ASC-UPC-DIGITS-1-5  PIC X(05).   11890000
                                   45  ASC-UPC-DIGITS-6-13 PIC X(08).   11900000
                               30  ASC-UPC-XXX REDEFINES ASC-UPC.       11910000
                                   45  ASC-KOHLS-UPC-DIGITS PIC X(04).  11920000
                                   45  ASC-KOHLS-DEPT       PIC X(03).  11930000
                                   45  FILLER               PIC X(02).  11940000
                                   45  ASC-KOHLS-DUMMY-SKU  PIC X(03).  11950000
                                   45  FILLER               PIC X(01).  11960000
                               30  ASC-UPC-N REDEFINES ASC-UPC          11970000
                                                         PIC  9(13).    11980000
                               30  ASC-KOHLS-UPC         PIC S9(15)     11990000
                                                         COMP-3.        12000000
                               30  ASC-ITEM-NBR          PIC S9(15)     12010000
                                                         COMP-3.        12020000
SR3403                         30  ASC-PRICE             PIC X(08).     12030000
                               30  ASC-PRICE-N REDEFINES ASC-PRICE      12040000
                                                         PIC  9(06)V99. 12050000
                               30  ASC-FILE-PRICE        PIC S9(05)V99  12060000
                                                         COMP-3.        12070000
                               30  ASC-RTL-QTY           PIC X(03).     12080000
                               30  ASC-RTL-QTY-N REDEFINES ASC-RTL-QTY  12090000
                                                         PIC  9(03).    12100000
                               30  ASC-CALLBACK-PRICE-SW PIC X(01).     12110000
                                   88  ASC-VALID-CALLBACK-PRICE         12120000
                                                            VALUE 'Y'.  12130000
                                   88  ASC-INVALID-CALLBACK-PRICE       12140000
                                                            VALUE 'N'.  12150000
                               30  ASC-RTL-ITEM-UPDATED-SW PIC X(01).   12160000
                                   88  ASC-RTL-ITEM-UPDATED             12170000
                                                            VALUE 'Y'.  12180000
                                   88  ASC-RTL-ITEM-NOT-UPDATED         12190000
                                                            VALUE ' '.  12200000
                               30  ASC-GROUP-PRICED-SW     PIC X(01).   12210000
                                   88  ASC-GROUP-PRICED-ITEM            12220000
                                                            VALUE 'Y'.  12230000
                                   88  ASC-NOT-GROUP-PRICED-ITEM        12240000
                                                            VALUE 'N'.  12250000
                       20  ASC-NON-RETAIL-ITEM-ARRAY                    12260000
                           REDEFINES ASC-RETAIL-ITEM-ARRAY.             12270000
                           25  ASC-NON-RETAIL-ENTRIES OCCURS 10 TIMES.  12280000
                               30  ASC-ITEM-DESC.                       12290000
                                   35  ASC-ITEM-DESC1    PIC X(20).     12300000
                                   35  ASC-ITEM-DESC2    PIC X(20).     12310000
                               30  ASC-NRTL-DEPT         PIC  X(03).    12320000
                               30  ASC-FIXTURE           PIC  X(20).    12330000
                               30  ASC-NRTL-QTY          PIC X(03).     12340000
                               30  ASC-NRTL-QTY-N REDEFINES ASC-NRTL-QTY12350000
                                                         PIC 9(03).     12360000
                               30  ASC-NRTL-ITEM-UPDATED-SW PIC X(01).  12370000
                                   88  ASC-NRTL-ITEM-UPDATED            12380000
                                                            VALUE 'Y'.  12390000
                                   88  ASC-NRTL-ITEM-NOT-UPDATED        12400000
                                                            VALUE ' '.  12410000
                                                                        12420000
                   15  ASC-ERROR-SW                      PIC  X(01).    12430000
                       88  ASC-NO-ERROR                   VALUE 'N'.    12440000
                       88  ASC-ERROR                      VALUE 'Y'.    12450000
                   15  ASC-XFER-COMPLETE-SW                PIC  X(01).  12460000
                       88  ASC-XFER-IS-COMPLETE            VALUE 'Y'.   12470000
                       88  ASC-XFER-IS-NOT-COMPLETE        VALUE ' '.   12480000
                   15  ASC-COMPLETE-REQUEST-SW             PIC  X(01).  12490000
                       88  ASC-COMPLETE-REQUEST            VALUE 'Y'.   12500000
                       88  ASC-NO-COMPLETE-REQUEST         VALUE 'N'.   12510000
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  12520000
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   12530000
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   12540000
                   15  ASC-CUSTOMER-EXISTS-SW              PIC  X(01).  12550000
                       88  ASC-CUSTOMER-EXISTS             VALUE 'Y'.   12560000
                       88  ASC-CUSTOMER-DOES-NOT-EXIST     VALUE 'N'.   12570000
                   15  ASC-FR-STR-OVRRID-IND               PIC  X(01).  12580000
                       88  ASC-FR-STR-OVERRIDE             VALUE 'Y'.   12590000
                       88  ASC-NO-FR-STR-OVERRIDE          VALUE 'N'.   12600000
                   15  ASC-PRINT-REQUEST-SW      PIC X(01).             12610000
                       88  ASC-PRINT-LIST-REQUEST       VALUE 'L'.      12620000
                       88  ASC-NO-PRINT-REQUEST         VALUE 'N'.      12630000
                       88  ASC-PRINT-DOC-REQUEST        VALUE 'D'.      12640000
                   15  ASC-DO-NOT-SHIP-SW                  PIC  X(01).  12650000
                       88  ASC-DO-NOT-SHIP                 VALUE 'N'.   12660000
                       88  ASC-OK-TO-SHIP                  VALUE 'Y'.   12670000
                   15  ASC-NBR-OF-LINES-ENTERED          PIC S9(03)     12680000
                                                              COMP-3.   12690000
                   15  ASC-BLK-SUB                       PIC S9(04)     12700000
                                                              COMP      12710000
                                                              SYNC.     12720000
                   15  ASC-ITEM-SUB                      PIC S9(04)     12730000
                                                              COMP      12740000
                                                              SYNC.     12750000
                   15  ASC-HIGHEST-BLOCK-WRITTEN         PIC S9(04)     12760000
                                                              COMP      12770000
                                                              SYNC.     12780000
070111             15  ASC-RTV-NBR                         PIC  9(04).  12790000
           EJECT                                                        12800000
      *                                                                 12810000
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            12820000
      *                                                                 12830000
           COPY DRRD001O.                                               12840000
                                                                        12850000
      *                                                                 12860000
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        12870000
      *                                                                 12880000
           COPY DRRD002O.                                               12890000
                                                                        12900000
      *                                                                 12910000
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) OUTPUT BLOCK        12920000
      *                                                                 12930000
           COPY DRSDROBC.                                               12940000
                                                                        12950000
           EJECT                                                        12960000
                                                                        12970000
      *----------------------------------------------------------------*12980000
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      12990000
      *----------------------------------------------------------------*13000000
080204     COPY RFWS009.                                                13010000
                                                                        13020000
      *---------------------------------------------------------------* 13030000
      *    ABEND PROCESSING COPYBOOK.                                 * 13040000
      *---------------------------------------------------------------* 13050000
                                                                        13060000
           COPY DPWS013.                                                13070000
                                                                        13080000
       EJECT                                                            13090000
      *                                                                 13100000
      ******************************************************************13110000
      *  UPC PARAMETER LIST FOR CALLING THE UPC CHECK DIGIT ROUTINE.    13120000
      ******************************************************************13130000
           COPY DPWS040I.                                               13140000
                                                                        13150000
      *                                                                 13160000
      ******************************************************************13170000
      *  NIS REFORMATTING WORK FIELDS.                                  13180000
      ******************************************************************13190000
           COPY ISWS006.                                                13200000
                                                                        13210000
                                                                        13220000
      *---------------------------------------------------------------* 13230000
      *    DB2 AREA FOR TRANSFER TABLE                                * 13240000
      *---------------------------------------------------------------* 13250000
           EXEC SQL                                                     13260000
                INCLUDE TTFMSTR                                         13270000
           END-EXEC.                                                    13280000
      *---------------------------------------------------------------* 13290000
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 13300000
      *---------------------------------------------------------------* 13310000
           EXEC SQL                                                     13320000
                INCLUDE TTFITEM                                         13330000
           END-EXEC.                                                    13340000
      *---------------------------------------------------------------* 13350000
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 13360000
      *---------------------------------------------------------------* 13370000
           EXEC SQL                                                     13380000
                INCLUDE TTFCUST                                         13390000
           END-EXEC.                                                    13400000
      *---------------------------------------------------------------* 13410000
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 13420000
      *---------------------------------------------------------------* 13430000
           EXEC SQL                                                     13440000
                INCLUDE TTFSTAT                                         13450000
           END-EXEC.                                                    13460000
      *---------------------------------------------------------------* 13470000
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 13480000
      *---------------------------------------------------------------* 13490000
           EXEC SQL                                                     13500000
                INCLUDE TTFTYCD                                         13510000
           END-EXEC.                                                    13520000
      *---------------------------------------------------------------* 13530000
      *    DB2 AREA FOR TRANSFER CONTAINER TYPE TABLE                 * 13540000
      *---------------------------------------------------------------* 13550000
           EXEC SQL                                                     13560000
                INCLUDE TTFSHCT                                         13570000
           END-EXEC.                                                    13580000
      *---------------------------------------------------------------* 13590000
      *    DB2 AREA FOR SKU CROSS REFERENCE TABLE                     * 13600000
      *---------------------------------------------------------------* 13610000
           EXEC SQL                                                     13620000
                INCLUDE TSKXREF                                         13630000
           END-EXEC.                                                    13640000
051705*---------------------------------------------------------------* 13650000
051705*    DB2 AREA FOR INVENTORY PARAMETERS TABLE                    * 13660000
051705*---------------------------------------------------------------* 13670000
051705*    EXEC SQL                                                     13680000
051705*         INCLUDE TINVPAR                                         13690000
051705*    END-EXEC.                                                    13700000
051705*---------------------------------------------------------------* 13710000
051705*    DB2 AREA FOR TRANSFER CONTROL TABLE                        * 13720000
051705*---------------------------------------------------------------* 13730000
051705*    EXEC SQL                                                     13740000
051705*         INCLUDE TTFCNTL                                         13750000
051705*    END-EXEC.                                                    13760000
      *---------------------------------------------------------------* 13770000
      *    DB2 AREA FOR XST_LOC TABLE                                 * 13780000
      *---------------------------------------------------------------* 13790000
           EXEC SQL                                                     13800000
                INCLUDE XST00001                                        13810000
           END-EXEC.                                                    13820000
      *---------------------------------------------------------------* 13830000
      *    DB2 AREA FOR XST_SKU_LOC TABLE                             * 13840000
      *---------------------------------------------------------------* 13850000
           EXEC SQL                                                     13860000
                INCLUDE XST00008                                        13870000
           END-EXEC.                                                    13880000
      *---------------------------------------------------------------* 13890000
      *  XST_SKU TABLE                                                  13900000
      *---------------------------------------------------------------* 13910000
           EXEC SQL                                                     13920000
               INCLUDE XST00010                                         13930000
           END-EXEC.                                                    13940000
100404*---------------------------------------------------------------* 13950000
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 13960000
100404*---------------------------------------------------------------* 13970000
100404     EXEC SQL                                                     13980000
100404          INCLUDE XST00012                                        13990000
100404     END-EXEC.                                                    14000000
      *---------------------------------------------------------------* 14010000
      *  XST_VND_STYL TABLE                                             14020000
      *---------------------------------------------------------------* 14030000
           EXEC SQL                                                     14040000
               INCLUDE XST00013                                         14050000
           END-EXEC.                                                    14060000
070111*---------------------------------------------------------------* 14070000
070111*    DB2 AREA FOR XST_DEPT TABLE                                * 14080000
070111*---------------------------------------------------------------* 14090000
070111     EXEC SQL                                                     14100000
070111          INCLUDE XST00015                                        14110000
070111     END-EXEC.                                                    14120000
      *---------------------------------------------------------------* 14130000
      *  XST_VND_DEPT TABLE                                           * 14140000
      *---------------------------------------------------------------* 14150000
           EXEC SQL                                                     14160000
                INCLUDE XST00017                                        14170000
           END-EXEC.                                                    14180000
      *---------------------------------------------------------------* 14190000
      *  XST_DC_LOC_ASGMT TABLE                                       * 14200000
      *---------------------------------------------------------------* 14210000
           EXEC SQL                                                     14220000
                INCLUDE XST00020                                        14230000
           END-EXEC.                                                    14240000
      *---------------------------------------------------------------* 14250000
      *  XST_RTV_LOC_RLTNSHP TABLE                                    * 14260000
      *---------------------------------------------------------------* 14270000
           EXEC SQL                                                     14280000
                INCLUDE XST00135                                        14290000
           END-EXEC.                                                    14300000
      *---------------------------------------------------------------* 14310000
      *    DB2 AREA FOR COMMUNICATIONS                                * 14320000
      *---------------------------------------------------------------* 14330000
           EXEC SQL                                                     14340000
                INCLUDE SQLCA                                           14350000
           END-EXEC.                                                    14360000
                                                                        14370000
      *---------------------------------------------------------------* 14380000
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 14390000
      *---------------------------------------------------------------* 14400000
                                                                        14410000
           EXEC SQL                                                     14420000
                DECLARE RTL-ITEM-CSR CURSOR                             14430000
                FOR SELECT                                              14440000
                      XFER_LNE_NBR                                      14450000
                     ,CPLD_RTL_PRIC_AMT                                 14460000
                     ,SCN_UPC_NBR                                       14470000
                     ,KOHLS_UPC_NBR                                     14480000
                     ,ITM_NBR                                           14490000
                     ,XFER_PRIC_AMT                                     14500000
                     ,XFER_QTY                                          14510000
                FROM  TTFITEM                                           14520000
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 14530000
               ORDER BY  XFER_LNE_NBR                                   14540000
100404         WITH UR                                                  14550000
           END-EXEC.                                                    14560000
                                                                        14570000
      *---------------------------------------------------------------* 14580000
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 14590000
      *---------------------------------------------------------------* 14600000
                                                                        14610000
           EXEC SQL                                                     14620000
                DECLARE NRTL-ITEM-CSR CURSOR                            14630000
                FOR SELECT                                              14640000
                      XFER_LNE_NBR                                      14650000
                     ,NRTL_1ST_LNE_DESC                                 14660000
                     ,NRTL_2ND_LNE_DESC                                 14670000
                     ,NRTL_FIXT_ID                                      14680000
                     ,NRTL_DEPT_NBR                                     14690000
                     ,XFER_QTY                                          14700000
                FROM  TTFITEM                                           14710000
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 14720000
               ORDER BY  XFER_LNE_NBR                                   14730000
100404         WITH UR                                                  14740000
                                                                        14750000
           END-EXEC.                                                    14760000
                                                                        14770000
      *---------------------------------------------------------------* 14780000
      * CURSOR TO RETRIEVE THE DEFAULT RETURN TO VENDOR NUMBER AND NAME 14790000
      * FOR THE STORE CREATING THE TRANSFER                             14800000
100404* NOTE: REMOVE THIS CURSOR. ALL DEFECTIVE DAMAGED AND CALLBACKS   14810000
100404*       MUST BE TO FINDLAY.                                       14820000
      *---------------------------------------------------------------* 14830000
100404*    EXEC SQL                                                     14840000
100404*       DECLARE  STR_DC_CSR CURSOR FOR                            14850000
100404*        SELECT  DC1_NMBR                                         14860000
100404*          FROM  TSTR000                                          14870000
100404*         WHERE  ((OP_CO_NMBR                = :PC-OP-CO-NMBR)    14880000
100404*           AND   (STR_NBR                   = :DK-STORE-NBR)     14890000
100404*           AND   (CHAR(DC1_RCT_START_DATE) <= CURRENT DATE       14900000
100404*                           AND                                   14910000
100404*                  CHAR(DC1_RCT_STOP_DATE)  >= CURRENT DATE))     14920000
100404*     UNION ALL                                                   14930000
100404*        SELECT  DC2_NMBR                                         14940000
100404*          FROM  TSTR000                                          14950000
100404*         WHERE  ((OP_CO_NMBR                = :PC-OP-CO-NMBR)    14960000
100404*           AND   (STR_NBR                   = :DK-STORE-NBR)     14970000
100404*           AND   (CHAR(DC2_RCT_START_DATE) <= CURRENT DATE       14980000
100404*                           AND                                   14990000
100404*                  CHAR(DC2_RCT_STOP_DATE)  >= CURRENT DATE))     15000000
100404*    END-EXEC.                                                    15010000
                                                                        15020000
      *                                                                 15030000
      * CURSOR TO RETRIEVE ALL TRANSFER TYPE CODES IN TYPE CODE SEQUENCE15040000
      *                                                                 15050000
           EXEC SQL                                                     15060000
              DECLARE  TYP_CDE_CSR CURSOR FOR                           15070000
               SELECT  XFER_TYP_CDE,                                    15080000
                       TYP_1ST_LNE_DESC,                                15090000
                       TYP_2ND_LNE_DESC,                                15100000
                       PTC_PTH_CDE                                      15110000
                 FROM  TTFTYCD                                          15120000
             ORDER BY  XFER_TYP_CDE                                     15130000
100404       WITH UR                                                    15140000
           END-EXEC.                                                    15150000
       EJECT                                                            15160000
       LINKAGE SECTION.                                                 15170000
                                                                        15180000
       01  DFHCOMMAREA.                                                 15190000
           05  FILLER                         OCCURS  1 TO 4072 TIMES   15200000
                                              DEPENDING ON EIBCALEN.    15210000
               10  FILLER                     PIC X.                    15220000
                                                                        15230000
       EJECT                                                            15240000
       PROCEDURE DIVISION.                                              15250000
      ******************************************************************15260000
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **15270000
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **15280000
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **15290000
      ******************************************************************15300000
       0000-MAIN-MODULE.                                                15310000
           INITIALIZE DP030-CICS-API-FIELDS.                            15320000
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          15330000
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       15340000
           MOVE +4                       TO DP030-NUMBER-OF-MAPS.       15350000
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     15360000
           PERFORM 0001-CALL-CICS-ARCH-API.                             15370000
      *                                                                 15380000
           MOVE 1                      TO PV-MAP-START-BYTE.            15390000
           MOVE LENGTH OF MR-A-HEADER  TO DP030-MAP-LENGTH (1).         15400000
           MOVE MD-MAP-DATA-AREA                                        15410000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (1))          15420000
                                       TO MR-A-HEADER.                  15430000
           ADD DP030-MAP-LENGTH (1)                                     15440000
                                       TO PV-MAP-START-BYTE.            15450000
           EVALUATE ASC-XFER-TYPE                                       15460000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           15470000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           15480000
               WHEN PC-STOCK-BAL-STORE                                  15490000
                   MOVE LENGTH OF MR-B-COMPLETED-BY                     15500000
                                       TO DP030-MAP-LENGTH (2)          15510000
                   MOVE MD-MAP-DATA-AREA                                15520000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          15530000
                                       TO MR-B-COMPLETED-BY             15540000
                   ADD DP030-MAP-LENGTH (2)                             15550000
                                       TO PV-MAP-START-BYTE             15560000
               WHEN PC-CALLBACK                                         15570000
                   MOVE LENGTH OF MR-C-CALLBACK                         15580000
                                       TO DP030-MAP-LENGTH (2)          15590000
                   MOVE MD-MAP-DATA-AREA                                15600000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          15610000
                                       TO MR-C-CALLBACK                 15620000
                   ADD DP030-MAP-LENGTH (2)                             15630000
                                       TO PV-MAP-START-BYTE             15640000
               WHEN PC-STOCK-BAL-CORP                                   15650000
                   MOVE LENGTH OF MR-D-APPROVAL                         15660000
                                       TO DP030-MAP-LENGTH (2)          15670000
                   MOVE MD-MAP-DATA-AREA                                15680000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          15690000
                                       TO MR-D-APPROVAL                 15700000
                   ADD DP030-MAP-LENGTH (2)                             15710000
                                       TO PV-MAP-START-BYTE             15720000
               WHEN PC-CUSTOMER                                         15730000
                   MOVE LENGTH OF MR-E-CUSTOMER                         15740000
                                       TO DP030-MAP-LENGTH (2)          15750000
                   MOVE MD-MAP-DATA-AREA                                15760000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          15770000
                                       TO MR-E-CUSTOMER                 15780000
                   ADD DP030-MAP-LENGTH (2)                             15790000
                                       TO PV-MAP-START-BYTE             15800000
               WHEN PC-NON-RETAIL                                       15810000
                   MOVE LENGTH OF MR-F-NON-RETAIL                       15820000
                                       TO DP030-MAP-LENGTH (2)          15830000
                   MOVE MD-MAP-DATA-AREA                                15840000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          15850000
                                       TO MR-F-NON-RETAIL               15860000
                   ADD DP030-MAP-LENGTH (2)                             15870000
                                       TO PV-MAP-START-BYTE             15880000
           END-EVALUATE.                                                15890000
           EVALUATE ASC-CONTNR-TYPE                                     15900000
               WHEN PC-TRAILER                                          15910000
                   MOVE LENGTH OF MR-H-TRAILER                          15920000
                                       TO DP030-MAP-LENGTH (3)          15930000
                   MOVE MD-MAP-DATA-AREA                                15940000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))          15950000
                                       TO MR-H-TRAILER                  15960000
                   ADD DP030-MAP-LENGTH (3)                             15970000
                                       TO PV-MAP-START-BYTE             15980000
               WHEN OTHER                                               15990000
                   MOVE LENGTH OF MR-G-TOTES                            16000000
                                       TO DP030-MAP-LENGTH (3)          16010000
                   MOVE MD-MAP-DATA-AREA                                16020000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))          16030000
                                       TO MR-G-TOTES                    16040000
                   ADD DP030-MAP-LENGTH (3)                             16050000
                                       TO PV-MAP-START-BYTE             16060000
           END-EVALUATE.                                                16070000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         16080000
                   MOVE LENGTH OF MR-I-RTL-DETAIL                       16090000
                                       TO DP030-MAP-LENGTH (4)          16100000
                   MOVE MD-MAP-DATA-AREA                                16110000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))          16120000
                                       TO MR-I-RTL-DETAIL               16130000
                   ADD DP030-MAP-LENGTH (4)    TO PV-MAP-START-BYTE     16140000
           ELSE                                                         16150000
                   MOVE LENGTH OF MR-J-NRTL-DETAIL                      16160000
                                       TO DP030-MAP-LENGTH (4)          16170000
                   MOVE MD-MAP-DATA-AREA                                16180000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))          16190000
                                       TO MR-J-NRTL-DETAIL              16200000
                   ADD DP030-MAP-LENGTH (4)    TO PV-MAP-START-BYTE     16210000
           END-IF.                                                      16220000
      *                                                                 16230000
           PERFORM 1000-CONTROL-PROCESSING                              16240000
      *                                                                 16250000
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     16260000
           PERFORM 0001-CALL-CICS-ARCH-API.                             16270000
                                                                        16280000
      ******************************************************************16290000
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **16300000
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **16310000
      ******************************************************************16320000
       0001-CALL-CICS-ARCH-API.                                         16330000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      16340005
                                          DFHCOMMAREA                   16350005
                                          DP030-CICS-API-FIELDS         16360005
                                          DP020-STANDARD-COMMAREA       16370005
                                          MD-MAP-DATA-AREA.             16380005
      *                                                                 16390000
           IF  DP030-RC-CALL-SUCCESSFUL                                 16400000
               CONTINUE                                                 16410000
           ELSE                                                         16420000
               SET DP013-NO-ROLLBACK                                    16430000
                   DP013-XCTL-DISPLAY-RESTART                           16440000
                   DP013-CICS-ABEND      TO TRUE                        16450000
               MOVE '0001-CALL-CICS-ARCH-API'                           16460000
                                         TO DP013-PARAGRAPH             16470000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O16471005
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      16472005
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      16500000
               PERFORM DP013-0000-PROCESS-ABEND                         16510000
           END-IF.                                                      16520000
      *----------------------------------------------------------------*16530000
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *16540000
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *16550000
      *----------------------------------------------------------------*16560000
                                                                        16570000
       1000-CONTROL-PROCESSING.                                         16580000
                                                                        16590000
           EVALUATE TRUE                                                16600000
               WHEN DP020-NEXT-ACT-INITIAL                              16610000
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     16620000
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 16630000
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 16640000
      ***-----$TEMPLATE NOTE$-------------------------------------------16650000
      *** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,16660000
      *** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  16670000
      *** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.16680000
      ***---------------------------------------------------------------16690000
                   IF  PS-COMMAREA-NOT-VALID                            16700000
                       SET DP020-NEXT-ACT-APPL-ERROR                    16710000
                                         TO TRUE                        16720000
                   ELSE                                                 16730000
                       PERFORM 4000-BUILD-INITIAL-PANEL                 16740000
                   END-IF                                               16750000
                                                                        16760000
               WHEN DP020-NEXT-ACT-READ-MAP                             16770000
                   PERFORM 2000-PROCESS-PANEL                           16780000
                                                                        16790000
               WHEN DP020-NEXT-ACT-RETURN                               16800000
                   IF ASC-PRINT-LIST-REQUEST        AND                 16810000
                         TF001-PRINT-YES            AND                 16820000
                         TF001-PRINTER-DEST NOT = SPACES                16830000
                       PERFORM 6500-PRINT-LIST                          16840000
                       MOVE PC-TSYMSG-00098                             16850000
                                         TO DP020-MSG-NUMBER            16860000
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             16870000
                   ELSE                                                 16880000
                       IF ASC-PRINT-DOC-REQUEST     AND                 16890000
                             TF001-PRINT-DOC                            16900000
                           PERFORM 3250-RESET-ATTRIBUTES                16910000
                           IF ASC-DO-NOT-SHIP                           16920000
                               MOVE PC-TSYMSG-01680 TO DP020-MSG-NUMBER 16930000
                           ELSE                                         16940000
                               MOVE PC-TSYMSG-01495 TO DP020-MSG-NUMBER 16950000
                           END-IF                                       16960000
                           MOVE ASC-FR-STORE-NBR TO                     16970000
                                                 PV-DISP-FROM-STORE-NBR 16980000
                           MOVE ASC-XFER-SEQ-NBR TO PV-DISP-SEQ-NBR     16990000
                           MOVE PV-DISP-XFER-NBR TO DP020-MSG-TEXT      17000000
                           SET DP030-SET-CURSOR-TRAILER  TO TRUE        17010000
                           SET DP020-MSG-INFORMATIONAL TO TRUE          17020000
                           MOVE +1                  TO ASC-BLK-SUB      17030000
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         17040000
                       END-IF                                           17050000
                   END-IF                                               17060000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  17070000
                   MOVE +1                  TO ASC-BLK-SUB              17080000
                   IF ASC-XFER-IS-NOT-COMPLETE                          17090000
                       PERFORM 3000-EDIT-DATA-IN-COMMAREA               17100000
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17110000
                   ELSE                                                 17120000
                       PERFORM 3250-RESET-ATTRIBUTES                    17130000
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17140000
                   END-IF                                               17150000
                                                                        17160000
               WHEN OTHER                                               17170000
                   SET DP013-LOGIC-ABEND TO TRUE                        17180000
                   SET DP013-NO-ROLLBACK TO TRUE                        17190000
                   MOVE '1000-CONTROL-PROCESSING'                       17200000
                                         TO DP013-PARAGRAPH             17210000
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    17220000
                                         TO DP013-MESSAGE-TEXT(1)       17230000
                   PERFORM DP013-0000-PROCESS-ABEND                     17240000
           END-EVALUATE.                                                17250000
                                                                        17260000
       EJECT                                                            17270000
      *----------------------------------------------------------------*17280000
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA FROM  *17290000
      * THE WORKSHEET SETUP PROGRAM OR FROM THE CRITERIA SPEC.         *17300000
      *----------------------------------------------------------------*17310000
       1100-PROCESS-INTER-APPL-COMM.                                    17320000
           SET PS-COMMAREA-VALID         TO TRUE.                       17330000
           MOVE TF001-XFER-FROM-STR      TO ASC-FR-STORE-NBR.           17340000
           IF DP020-INT-APPL-FORMAT-IND = PC-SETUP-FORMAT OR            17350000
                                          PC-FR-STR-FORMAT              17360000
               MOVE TF001-XFER-TYPE      TO ASC-XFER-TYPE               17370000
               MOVE TF001-CONTNR-TYPE    TO ASC-CONTNR-TYPE             17380000
               IF TF001-FR-STR-OVERRIDE                                 17390000
                   SET ASC-FR-STR-OVERRIDE       TO TRUE                17400000
               ELSE                                                     17410000
                   SET ASC-NO-FR-STR-OVERRIDE    TO TRUE                17420000
               END-IF                                                   17430000
               IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                     17440000
                   INITIALIZE ASC-RETAIL-ITEM-ARRAY (1)                 17450000
                              ASC-RETAIL-ITEM-ARRAY (2)                 17460000
               ELSE                                                     17470000
                   INITIALIZE ASC-NON-RETAIL-ITEM-ARRAY (1)             17480000
                              ASC-NON-RETAIL-ITEM-ARRAY (2)             17490000
               END-IF                                                   17500000
               PERFORM 4100-GET-CONTROL-NUMBER                          17510000
                                                                        17520000
               PERFORM 4130-INSERT-ROW                                  17530000
               EVALUATE ASC-XFER-TYPE                                   17540000
                   WHEN PC-CALLBACK                                     17550000
111703             WHEN PC-DEFECTIVE-DAMAGE-SORT1                       17560000
111703             WHEN PC-DEFECTIVE-DAMAGE-SORT2                       17570000
                       PERFORM 2300-FIND-STR-RTV-SITE                   17580000
               END-EVALUATE                                             17590000
           ELSE                                                         17600000
               MOVE TF001-DKEY-ID        TO DK-XFER-DKEY-ID             17610000
                                            ASC-XFER-DKEY-ID            17620000
                                            ASC-CONTROL-NBR             17630000
               PERFORM 6000-GET-CONTROL-INFO                            17640000
           END-IF.                                                      17650000
                                                                        17660000
       EJECT                                                            17670000
      *----------------------------------------------------------------*17680000
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *17690000
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *17700000
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *17710000
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *17720000
      * FUNCTION KEYS CAN GET THIS FAR.                                *17730000
      *----------------------------------------------------------------*17740000
                                                                        17750000
       2000-PROCESS-PANEL.                                              17760000
           IF ASC-XFER-IS-NOT-COMPLETE                                  17770000
             EVALUATE TRUE                                              17780000
               WHEN DP020-SRC-AID = DP016-ENTER                         17790000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  17800000
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 17810000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17820000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17830000
                                                                        17840000
               WHEN DP020-SRC-AID = DP016-CLEAR                         17850000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  17860000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17870000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17880000
                                                                        17890000
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    17900000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  17910000
                   MOVE ASC-XFER-TYPE                                   17920000
                                         TO DK-XFER-TYPE                17930000
                   MOVE ASC-CONTNR-TYPE                                 17940000
                                         TO DK-CONTNR-TYPE              17950000
                   PERFORM 4000-BUILD-INITIAL-PANEL                     17960000
                                                                        17970000
      *---  CREATE  ------------------------------------------------*   17980000
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              17990000
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18000000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18010000
                   PERFORM 5000-CREATE-WORKSHEET                        18020000
P11870             IF PS-BLOCK-SUNGLASS-WATCHES                         18030000
P11870                SET ASC-NO-COMPLETE-REQUEST TO TRUE               18040000
P11870                MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER          18050000
P11870                SET DP020-MSG-INFORMATIONAL TO TRUE               18060000
P11870                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              18070000
P11870             END-IF                                               18080000
P11870             MOVE ZEROS            TO DP020-MSG-NUMBER            18090000
                                                                        18100000
      *---  SUSPEND  -----------------------------------------------*   18110000
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              18120000
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18130000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18140000
                   PERFORM 5000-CREATE-WORKSHEET                        18141000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  18142000
                   MOVE PC-TSYMSG-01484       TO DP020-MSG-NUMBER       18143000
                   SET DP020-MSG-INFORMATIONAL                          18144000
                                              TO TRUE                   18145000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18146000
                                                                        18147000
      *---  PRINT WKST  --------------------------------------------*   18148000
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              18149000
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18150000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18160000
                   PERFORM 5000-CREATE-WORKSHEET                        18170000
                   SET ASC-PRINT-LIST-REQUEST TO TRUE                   18180000
                   INITIALIZE TF001-DRS-DATA                            18190000
080204             MOVE ASC-FR-STORE-NBR      TO RFWS009-STORE-NBR      18200000
080204             MOVE RFWS009-STORE-PRINTER-DEST                      18210000
080204                                        TO TF001-PRINTER-DEST     18220000
                   MOVE SPACES                TO DP020-MSG-NUMBER-X     18230000
                                                 DP020-MSG-TEXT         18240000
                                                                        18250000
               WHEN OTHER                                               18260000
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18270000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18280000
                   IF  ASC-NO-ERROR                                     18290000
                       SET DP030-CONTINUE-GO                            18300000
                                       TO TRUE                          18310000
                       PERFORM 2100-CHECK-FUNCTION-KEY                  18320000
                   ELSE                                                 18330000
                       SET DP030-OVERRIDE-GO                            18340000
                                       TO TRUE                          18350000
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18360000
                   END-IF                                               18370000
             END-EVALUATE                                               18380000
           ELSE                                                         18390000
             EVALUATE TRUE                                              18400000
               WHEN DP020-SRC-AID = DP016-ENTER                         18410000
               WHEN DP020-SRC-AID = DP016-CLEAR                         18420000
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    18430000
                   PERFORM 3250-RESET-ATTRIBUTES                        18440000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18450000
                                                                        18460000
      *---  CREATE  ------------------------------------------------*   18470000
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              18480000
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 18490000
                   MOVE ZEROS            TO DP020-MSG-NUMBER            18500000
                                                                        18510000
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  18520000
                   MOVE +1           TO ASC-BLK-SUB                     18530000
                   SET DP030-SET-CURSOR-TRAILER  TO TRUE                18540000
                   PERFORM 3250-RESET-ATTRIBUTES                        18550000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18560000
                                                                        18570000
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   18580000
                   IF ASC-BLK-SUB = +1                                  18590000
                       MOVE PC-TSYMSG-00069                             18600000
                                         TO DP020-MSG-NUMBER            18610000
                       SET DP020-MSG-INFORMATIONAL                      18620000
                                         TO TRUE                        18630000
                   ELSE                                                 18640000
                       MOVE +1           TO ASC-BLK-SUB                 18650000
                   END-IF                                               18660000
                   SET DP030-SET-CURSOR-TRAILER  TO TRUE                18670000
                   PERFORM 3250-RESET-ATTRIBUTES                        18680000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18690000
                                                                        18700000
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   18710000
                   IF ASC-BLK-SUB = +2                                  18720000
                       MOVE PC-TSYMSG-00070                             18730000
                                         TO DP020-MSG-NUMBER            18740000
                       SET DP020-MSG-INFORMATIONAL                      18750000
                                         TO TRUE                        18760000
                   ELSE                                                 18770000
                       MOVE +2           TO ASC-BLK-SUB                 18780000
                   END-IF                                               18790000
                   SET DP030-SET-CURSOR-TRAILER  TO TRUE                18800000
                   PERFORM 3250-RESET-ATTRIBUTES                        18810000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18820000
                                                                        18830000
               WHEN OTHER                                               18840000
                   MOVE PC-TSYMSG-01487       TO DP020-MSG-NUMBER       18850000
                   MOVE ASC-FR-STORE-NBR      TO PV-DISP-FROM-STORE-NBR 18860000
                   MOVE ASC-XFER-SEQ-NBR      TO PV-DISP-SEQ-NBR        18870000
                   MOVE PV-DISP-XFER-NBR      TO DP020-MSG-TEXT         18880000
                   SET DP020-MSG-FATAL        TO TRUE                   18890000
                   SET DP030-SET-CURSOR-TRAILER  TO TRUE                18900000
                   SET DP030-OVERRIDE-GO      TO TRUE                   18910000
                   PERFORM 3250-RESET-ATTRIBUTES                        18920000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18930000
                                                                        18940000
             END-EVALUATE                                               18950000
           END-IF.                                                      18960000
       EJECT                                                            18970000
      *----------------------------------------------------------------*18980000
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*18990000
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *19000000
      * CICS ARCHITECTURE API.                                         *19010000
      *----------------------------------------------------------------*19020000
       2100-CHECK-FUNCTION-KEY.                                         19030000
           EVALUATE TRUE                                                19040000
                                                                        19050000
      *---  COMPLETE  ----------------------------------------------*   19060000
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              19070000
                   IF ASC-NBR-OF-LINES-ENTERED = 0                      19080000
                       SET ASC-NO-COMPLETE-REQUEST TO TRUE              19090000
                       MOVE PC-TSYMSG-01483       TO DP020-MSG-NUMBER   19100000
                       SET DP020-MSG-FATAL        TO TRUE               19110000
                       SET DP030-SET-CURSOR-APPL-4   TO TRUE            19120000
                       SET DP030-OVERRIDE-GO      TO TRUE               19130000
                       IF ASC-XFER-TYPE NOT = PC-NON-RETAIL             19140000
                           MOVE -1                TO MR-I-UPC-L (1)     19150000
                       ELSE                                             19160000
                           MOVE -1                TO MR-J-DESC-L (1)    19170000
                       END-IF                                           19180000
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19190000
                   ELSE                                                 19200000
                       IF ASC-COMPLETE-REQUEST                          19210000
                           PERFORM 7000-COMPLETE-TRANSFER               19220000
                           SET ASC-PRINT-DOC-REQUEST TO TRUE            19230000
                           INITIALIZE TF001-INTER-APPL-COMMAREA         19240000
080204                     MOVE ASC-FR-STORE-NBR TO RFWS009-STORE-NBR   19250000
                                                    PV-FROM-STORE-NBR   19260000
                           MOVE ASC-XFER-SEQ-NBR TO PV-SEQ-NBR          19270000
                           MOVE PV-XFER-NBR      TO TF001-XFER-NBR      19280000
080204                     MOVE RFWS009-STORE-PRINTER-DEST              19290000
080204                                           TO TF001-PRINTER-DEST  19300000
                           SET ASC-XFER-IS-COMPLETE    TO TRUE          19310000
                       ELSE                                             19320000
                           SET ASC-COMPLETE-REQUEST TO TRUE             19330000
                           MOVE PC-TSYMSG-01403  TO DP020-MSG-NUMBER    19340000
                           MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT      19350000
                           SET DP020-MSG-INFORMATIONAL TO TRUE          19360000
                           SET DP030-SET-CURSOR-APPL-4   TO TRUE        19370000
                           SET DP030-OVERRIDE-GO      TO TRUE           19380000
                           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL         19390000
                               MOVE -1           TO MR-I-UPC-L (1)      19400000
                           ELSE                                         19410000
                               MOVE -1           TO MR-J-DESC-L (1)     19420000
                           END-IF                                       19430000
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         19440000
                       END-IF                                           19450000
                   END-IF                                               19460000
                                                                        19470000
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  19480000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  19490000
                   MOVE +1           TO ASC-BLK-SUB                     19500000
                   SET DP030-SET-CURSOR-APPL-4   TO TRUE                19510000
                   IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                 19520000
                       MOVE -1                TO MR-I-UPC-L (1)         19530000
                   ELSE                                                 19540000
                       MOVE -1                TO MR-J-DESC-L (1)        19550000
                   END-IF                                               19560000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19570000
                                                                        19580000
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   19590000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  19600000
                   IF ASC-BLK-SUB = +1                                  19610000
                       MOVE PC-TSYMSG-00069                             19620000
                                         TO DP020-MSG-NUMBER            19630000
                       SET DP020-MSG-INFORMATIONAL                      19640000
                                         TO TRUE                        19650000
                   ELSE                                                 19660000
                       MOVE +1           TO ASC-BLK-SUB                 19670000
                   END-IF                                               19680000
                   SET DP030-SET-CURSOR-APPL-4   TO TRUE                19690000
                   IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                 19700000
                       MOVE -1                TO MR-I-UPC-L (1)         19710000
                   ELSE                                                 19720000
                       MOVE -1                TO MR-J-DESC-L (1)        19730000
                   END-IF                                               19740000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19750000
                                                                        19760000
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   19770000
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  19780000
                   IF ASC-BLK-SUB = +2                                  19790000
                       MOVE PC-TSYMSG-00070                             19800000
                                         TO DP020-MSG-NUMBER            19810000
                       SET DP020-MSG-INFORMATIONAL                      19820000
                                         TO TRUE                        19830000
                   ELSE                                                 19840000
                       MOVE +2           TO ASC-BLK-SUB                 19850000
                   END-IF                                               19860000
                   SET DP030-SET-CURSOR-APPL-4   TO TRUE                19870000
                   IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                 19880000
                       MOVE -1                TO MR-I-UPC-L (1)         19890000
                   ELSE                                                 19900000
                       MOVE -1                TO MR-J-DESC-L (1)        19910000
                   END-IF                                               19920000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 19930000
                                                                        19940000
               WHEN OTHER                                               19950000
                   SET DP013-NO-ROLLBACK                                19960000
                       DP013-XCTL-DISPLAY-RESTART                       19970000
                       DP013-CICS-ABEND  TO TRUE                        19980000
                   MOVE '2100-CHECK-FUNCTION-KEY'                       19990000
                                         TO DP013-PARAGRAPH             20000000
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      20010000
                                         TO DP013-MESSAGE-TEXT (1)      20020000
                   PERFORM DP013-0000-PROCESS-ABEND                     20030000
           END-EVALUATE.                                                20040000
      *                                                                 20050000
       EJECT                                                            20060000
      ******************************************************************20070000
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **20080000
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **20090000
      ******************************************************************20100000
       2200-MOVE-SCREEN-TO-COMMAREA.                                    20110000
      *                                                                 20120000
           IF  MR-A-TO-STORE-NBR-L > 0                                  20130000
               MOVE MR-A-TO-STORE-NBR    TO ASC-TO-STORE-NBR            20140000
           ELSE                                                         20150000
               IF  MR-A-TO-STORE-NBR-A = DP015-ERASE-EOF                20160000
                   MOVE LOW-VALUES       TO ASC-TO-STORE-NBR            20170000
               END-IF                                                   20180000
           END-IF.                                                      20190000
           EVALUATE ASC-XFER-TYPE                                       20200000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           20210000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           20220000
               WHEN PC-STOCK-BAL-STORE                                  20230000
                   IF MR-B-COMP-BY-INT-L > 0                            20240000
                       MOVE MR-B-COMP-BY-INT   TO ASC-COMP-BY-INT       20250000
                   ELSE                                                 20260000
                       IF  MR-B-COMP-BY-INT-A = DP015-ERASE-EOF         20270000
                           MOVE SPACE          TO ASC-COMP-BY-INT       20280000
                       END-IF                                           20290000
                   END-IF                                               20300000
                   IF MR-B-COMP-BY-NAM-L > 0                            20310000
                       MOVE MR-B-COMP-BY-NAM   TO ASC-COMP-BY-NAM       20320000
                   ELSE                                                 20330000
                       IF  MR-B-COMP-BY-NAM-A = DP015-ERASE-EOF         20340000
                           MOVE SPACE          TO ASC-COMP-BY-NAM       20350000
                       END-IF                                           20360000
                   END-IF                                               20370000
               WHEN PC-CALLBACK                                         20380000
                   IF MR-C-COMP-BY-INT-L > 0                            20390000
                       MOVE MR-C-COMP-BY-INT   TO ASC-COMP-BY-INT       20400000
                   ELSE                                                 20410000
                       IF  MR-C-COMP-BY-INT-A = DP015-ERASE-EOF         20420000
                           MOVE SPACE          TO ASC-COMP-BY-INT       20430000
                       END-IF                                           20440000
                   END-IF                                               20450000
                   IF MR-C-COMP-BY-NAM-L > 0                            20460000
                       MOVE MR-C-COMP-BY-NAM   TO ASC-COMP-BY-NAM       20470000
                   ELSE                                                 20480000
                       IF  MR-C-COMP-BY-NAM-A = DP015-ERASE-EOF         20490000
                           MOVE SPACE          TO ASC-COMP-BY-NAM       20500000
                       END-IF                                           20510000
                   END-IF                                               20520000
                   IF MR-C-CALLBACK-NBR-L > 0                           20530000
                       MOVE MR-C-CALLBACK-NBR-N                         20540000
                                               TO ASC-CALLBACK-NBR      20550000
                   ELSE                                                 20560000
                       IF  MR-C-CALLBACK-NBR-A = DP015-ERASE-EOF        20570000
                           MOVE SPACE          TO ASC-CALLBACK-NBR      20580000
                       END-IF                                           20590000
                   END-IF                                               20600000
               WHEN PC-STOCK-BAL-CORP                                   20610000
                   IF MR-D-COMP-BY-INT-L > 0                            20620000
                       MOVE MR-D-COMP-BY-INT   TO ASC-COMP-BY-INT       20630000
                   ELSE                                                 20640000
                       IF  MR-D-COMP-BY-INT-A = DP015-ERASE-EOF         20650000
                           MOVE SPACE          TO ASC-COMP-BY-INT       20660000
                       END-IF                                           20670000
                   END-IF                                               20680000
                   IF MR-D-COMP-BY-NAM-L > 0                            20690000
                       MOVE MR-D-COMP-BY-NAM   TO ASC-COMP-BY-NAM       20700000
                   ELSE                                                 20710000
                       IF  MR-D-COMP-BY-NAM-A = DP015-ERASE-EOF         20720000
                           MOVE SPACE          TO ASC-COMP-BY-NAM       20730000
                       END-IF                                           20740000
                   END-IF                                               20750000
                   IF MR-D-APPROVAL-NBR-L > 0                           20760000
                       MOVE MR-D-APPROVAL-NBR-N                         20770000
                                               TO ASC-APPROVAL-NBR      20780000
                   ELSE                                                 20790000
                       IF  MR-D-APPROVAL-NBR-A = DP015-ERASE-EOF        20800000
                           MOVE SPACE          TO ASC-APPROVAL-NBR      20810000
                       END-IF                                           20820000
                   END-IF                                               20830000
               WHEN PC-CUSTOMER                                         20840000
                   IF MR-E-COMP-BY-INT-L > 0                            20850000
                       MOVE MR-E-COMP-BY-INT   TO ASC-COMP-BY-INT       20860000
                   ELSE                                                 20870000
                       IF  MR-E-COMP-BY-INT-A = DP015-ERASE-EOF         20880000
                           MOVE SPACE          TO ASC-COMP-BY-INT       20890000
                       END-IF                                           20900000
                   END-IF                                               20910000
                   IF MR-E-COMP-BY-NAM-L > 0                            20920000
                       MOVE MR-E-COMP-BY-NAM   TO ASC-COMP-BY-NAM       20930000
                   ELSE                                                 20940000
                       IF  MR-E-COMP-BY-NAM-A = DP015-ERASE-EOF         20950000
                           MOVE SPACE          TO ASC-COMP-BY-NAM       20960000
                       END-IF                                           20970000
                   END-IF                                               20980000
                   IF MR-E-REQ-BY-INT-L > 0                             20990000
                       MOVE MR-E-REQ-BY-INT    TO ASC-REQ-BY-INT        21000000
                   ELSE                                                 21010000
                       IF  MR-E-REQ-BY-INT-A = DP015-ERASE-EOF          21020000
                           MOVE SPACE          TO ASC-REQ-BY-INT        21030000
                       END-IF                                           21040000
                   END-IF                                               21050000
                   IF MR-E-REQ-BY-NAM-L > 0                             21060000
                       MOVE MR-E-REQ-BY-NAM    TO ASC-REQ-BY-NAM        21070000
                   ELSE                                                 21080000
                       IF  MR-E-REQ-BY-NAM-A = DP015-ERASE-EOF          21090000
                           MOVE SPACE          TO ASC-REQ-BY-NAM        21100000
                       END-IF                                           21110000
                   END-IF                                               21120000
                   IF MR-E-CUST-NAME-L > 0                              21130000
                       MOVE MR-E-CUST-NAME                              21140000
                                               TO ASC-CUST-NAME         21150000
                   ELSE                                                 21160000
                       IF  MR-E-CUST-NAME-A = DP015-ERASE-EOF           21170000
                           MOVE SPACE          TO ASC-CUST-NAME         21180000
                       END-IF                                           21190000
                   END-IF                                               21200000
                   IF MR-E-PHONE-AREA-L > 0                             21210000
                       MOVE MR-E-PHONE-AREA                             21220000
                                               TO ASC-PHONE-AREA        21230000
                   ELSE                                                 21240000
                       IF  MR-E-PHONE-AREA-A = DP015-ERASE-EOF          21250000
                           MOVE SPACE          TO ASC-PHONE-AREA        21260000
                       END-IF                                           21270000
                   END-IF                                               21280000
                   IF MR-E-PHONE-EXCH-L > 0                             21290000
                       MOVE MR-E-PHONE-EXCH                             21300000
                                               TO ASC-PHONE-EXCH        21310000
                   ELSE                                                 21320000
                       IF  MR-E-PHONE-EXCH-A = DP015-ERASE-EOF          21330000
                           MOVE SPACE          TO ASC-PHONE-EXCH        21340000
                       END-IF                                           21350000
                   END-IF                                               21360000
                   IF MR-E-PHONE-NBR-L > 0                              21370000
                       MOVE MR-E-PHONE-NBR                              21380000
                                               TO ASC-PHONE-NBR         21390000
                   ELSE                                                 21400000
                       IF  MR-E-PHONE-NBR-A = DP015-ERASE-EOF           21410000
                           MOVE SPACE          TO ASC-PHONE-NBR         21420000
                       END-IF                                           21430000
                   END-IF                                               21440000
                   IF MR-E-ADDR1-L > 0                                  21450000
                       MOVE MR-E-ADDR1                                  21460000
                                               TO ASC-ADDR1             21470000
                   ELSE                                                 21480000
                       IF  MR-E-ADDR1-A = DP015-ERASE-EOF               21490000
                           MOVE SPACE          TO ASC-ADDR1             21500000
                       END-IF                                           21510000
                   END-IF                                               21520000
                   IF MR-E-ADDR2-L > 0                                  21530000
                       MOVE MR-E-ADDR2                                  21540000
                                               TO ASC-ADDR2             21550000
                   ELSE                                                 21560000
                       IF  MR-E-ADDR2-A = DP015-ERASE-EOF               21570000
                           MOVE SPACE          TO ASC-ADDR2             21580000
                       END-IF                                           21590000
                   END-IF                                               21600000
                   IF MR-E-CITY-L > 0                                   21610000
                       MOVE MR-E-CITY                                   21620000
                                               TO ASC-CITY              21630000
                   ELSE                                                 21640000
                       IF  MR-E-CITY-A = DP015-ERASE-EOF                21650000
                           MOVE SPACE          TO ASC-CITY              21660000
                       END-IF                                           21670000
                   END-IF                                               21680000
                   IF MR-E-STATE-L > 0                                  21690000
                       MOVE MR-E-STATE                                  21700000
                                               TO ASC-STATE             21710000
                   ELSE                                                 21720000
                       IF  MR-E-STATE-A = DP015-ERASE-EOF               21730000
                           MOVE SPACE          TO ASC-STATE             21740000
                       END-IF                                           21750000
                   END-IF                                               21760000
                   IF MR-E-ZIP-L > 0                                    21770000
                       MOVE MR-E-ZIP                                    21780000
                                               TO ASC-ZIP               21790000
                   ELSE                                                 21800000
                       IF  MR-E-ZIP-A = DP015-ERASE-EOF                 21810000
                           MOVE SPACE          TO ASC-ZIP               21820000
                       END-IF                                           21830000
                   END-IF                                               21840000
                   IF MR-E-ZIP-EXT-L > 0                                21850000
                       MOVE MR-E-ZIP-EXT                                21860000
                                               TO ASC-ZIP-EXT           21870000
                   ELSE                                                 21880000
                       IF  MR-E-ZIP-EXT-A = DP015-ERASE-EOF             21890000
                           MOVE SPACE          TO ASC-ZIP-EXT           21900000
                       END-IF                                           21910000
                   END-IF                                               21920000
               WHEN PC-NON-RETAIL                                       21930000
                   IF MR-F-COMP-BY-INT-L > 0                            21940000
                       MOVE MR-F-COMP-BY-INT   TO ASC-COMP-BY-INT       21950000
                   ELSE                                                 21960000
                       IF  MR-F-COMP-BY-INT-A = DP015-ERASE-EOF         21970000
                           MOVE SPACE          TO ASC-COMP-BY-INT       21980000
                       END-IF                                           21990000
                   END-IF                                               22000000
                   IF MR-F-COMP-BY-NAM-L > 0                            22010000
                       MOVE MR-F-COMP-BY-NAM   TO ASC-COMP-BY-NAM       22020000
                   ELSE                                                 22030000
                       IF  MR-F-COMP-BY-NAM-A = DP015-ERASE-EOF         22040000
                           MOVE SPACE          TO ASC-COMP-BY-NAM       22050000
                       END-IF                                           22060000
                   END-IF                                               22070000
                   IF MR-F-REQ-BY-INT-L > 0                             22080000
                       MOVE MR-F-REQ-BY-INT    TO ASC-REQ-BY-INT        22090000
                   ELSE                                                 22100000
                       IF  MR-F-REQ-BY-INT-A = DP015-ERASE-EOF          22110000
                           MOVE SPACE          TO ASC-REQ-BY-INT        22120000
                       END-IF                                           22130000
                   END-IF                                               22140000
                   IF MR-F-REQ-BY-NAM-L > 0                             22150000
                       MOVE MR-F-REQ-BY-NAM    TO ASC-REQ-BY-NAM        22160000
                   ELSE                                                 22170000
                       IF  MR-F-REQ-BY-NAM-A = DP015-ERASE-EOF          22180000
                           MOVE SPACE          TO ASC-REQ-BY-NAM        22190000
                       END-IF                                           22200000
                   END-IF                                               22210000
                   IF MR-F-ATTN-TO-INT-L > 0                            22220000
                       MOVE MR-F-ATTN-TO-INT   TO ASC-ATTN-TO-INT       22230000
                   ELSE                                                 22240000
                       IF  MR-F-ATTN-TO-INT-A = DP015-ERASE-EOF         22250000
                           MOVE SPACE          TO ASC-ATTN-TO-INT       22260000
                       END-IF                                           22270000
                   END-IF                                               22280000
                   IF MR-F-ATTN-TO-NAM-L > 0                            22290000
                       MOVE MR-F-ATTN-TO-NAM   TO ASC-ATTN-TO-NAM       22300000
                   ELSE                                                 22310000
                       IF  MR-F-ATTN-TO-NAM-A = DP015-ERASE-EOF         22320000
                           MOVE SPACE          TO ASC-ATTN-TO-NAM       22330000
                       END-IF                                           22340000
                   END-IF                                               22350000
           END-EVALUATE.                                                22360000
           EVALUATE ASC-CONTNR-TYPE                                     22370000
               WHEN PC-TRAILER                                          22380000
                   IF MR-H-TRLR-SEAL-L > 0                              22390000
                       MOVE MR-H-TRLR-SEAL                              22400000
                                               TO ASC-TRAILER-SEAL      22410000
                   ELSE                                                 22420000
                       IF  MR-H-TRLR-SEAL-A = DP015-ERASE-EOF           22430000
                           MOVE SPACE          TO ASC-TRAILER-SEAL      22440000
                       END-IF                                           22450000
                   END-IF                                               22460000
                   IF MR-H-TRLR-NBR-L > 0                               22470000
                       MOVE MR-H-TRLR-NBR                               22480000
                                               TO ASC-TRAILER-NBR       22490000
                   ELSE                                                 22500000
                       IF  MR-H-TRLR-NBR-A = DP015-ERASE-EOF            22510000
                           MOVE SPACE          TO ASC-TRAILER-NBR       22520000
                       END-IF                                           22530000
                   END-IF                                               22540000
               WHEN OTHER                                               22550000
                   IF MR-G-LG-TOTE-SEAL1-L > 0                          22560000
                       MOVE MR-G-LG-TOTE-SEAL1                          22570000
                                               TO ASC-LG-TOTE-SEAL1     22580000
                   ELSE                                                 22590000
                       IF  MR-G-LG-TOTE-SEAL1-A = DP015-ERASE-EOF       22600000
                           MOVE SPACE          TO ASC-LG-TOTE-SEAL1     22610000
                       END-IF                                           22620000
                   END-IF                                               22630000
                   IF MR-G-LG-TOTE-SEAL2-L > 0                          22640000
                       MOVE MR-G-LG-TOTE-SEAL2                          22650000
                                               TO ASC-LG-TOTE-SEAL2     22660000
                   ELSE                                                 22670000
                       IF  MR-G-LG-TOTE-SEAL2-A = DP015-ERASE-EOF       22680000
                           MOVE SPACE          TO ASC-LG-TOTE-SEAL2     22690000
                       END-IF                                           22700000
                   END-IF                                               22710000
                   IF MR-G-SM-TOTE-SEAL-L > 0                           22720000
                       MOVE MR-G-SM-TOTE-SEAL                           22730000
                                               TO ASC-SM-TOTE-SEAL      22740000
                   ELSE                                                 22750000
                       IF  MR-G-SM-TOTE-SEAL-A = DP015-ERASE-EOF        22760000
                           MOVE SPACE          TO ASC-SM-TOTE-SEAL      22770000
                       END-IF                                           22780000
                   END-IF                                               22790000
           END-EVALUATE.                                                22800000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         22810000
                  PERFORM 2210-MOVE-RTL-TO-COMMAREA                     22820000
                    VARYING ASC-ITEM-SUB                                22830000
                      FROM 1 BY 1                                       22840000
                      UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL       22850000
           ELSE                                                         22860000
                  PERFORM 2220-MOVE-NRTL-TO-COMMAREA                    22870000
                    VARYING ASC-ITEM-SUB                                22880000
                      FROM 1 BY 1                                       22890000
                      UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL      22900000
           END-IF.                                                      22910000
      ******************************************************************22920000
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**22930000
      ** FOR RETAIL TRANSFER TYPES.                                   **22940000
      ******************************************************************22950000
       2210-MOVE-RTL-TO-COMMAREA.                                       22960000
           IF  MR-I-UPC-L (ASC-ITEM-SUB) > ZERO                         22970000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             22980000
               MOVE MR-I-UPC-N (ASC-ITEM-SUB)                           22990000
                                         TO ASC-UPC                     23000000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23010000
           ELSE                                                         23020000
               IF  MR-I-UPC-A (ASC-ITEM-SUB) = DP015-ERASE-EOF          23030000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23040000
                       MOVE SPACE        TO ASC-UPC                     23050000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23060000
               END-IF                                                   23070000
           END-IF.                                                      23080000
           IF  MR-I-PRICE-L (ASC-ITEM-SUB) > ZERO                       23090000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23100000
               MOVE MR-I-PRICE (ASC-ITEM-SUB)                           23110000
                                         TO ASC-PRICE                   23120000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23130000
           ELSE                                                         23140000
               IF  MR-I-PRICE-A (ASC-ITEM-SUB) = DP015-ERASE-EOF        23150000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23160000
                       MOVE LOW-VALUES   TO ASC-PRICE                   23170000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23180000
               END-IF                                                   23190000
           END-IF.                                                      23200000
           IF  MR-I-QTY-L (ASC-ITEM-SUB) > ZERO                         23210000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23220000
               MOVE MR-I-QTY (ASC-ITEM-SUB)                             23230000
                                         TO ASC-RTL-QTY                 23240000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23250000
           ELSE                                                         23260000
               IF  MR-I-QTY-A (ASC-ITEM-SUB) = DP015-ERASE-EOF          23270000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23280000
                       MOVE LOW-VALUES   TO ASC-RTL-QTY                 23290000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23300000
               END-IF                                                   23310000
           END-IF.                                                      23320000
      ******************************************************************23330000
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**23340000
      ** FOR NON-RETAIL TRANSFER TYPES.                               **23350000
      ******************************************************************23360000
       2220-MOVE-NRTL-TO-COMMAREA.                                      23370000
           IF  MR-J-DESC-L (ASC-ITEM-SUB) > ZERO                        23380000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23390000
               MOVE MR-J-DESC (ASC-ITEM-SUB)                            23400000
                                         TO ASC-ITEM-DESC               23410000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23420000
           ELSE                                                         23430000
               IF  MR-J-DESC-A (ASC-ITEM-SUB) = DP015-ERASE-EOF         23440000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23450000
                       MOVE SPACE        TO ASC-ITEM-DESC               23460000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23470000
               END-IF                                                   23480000
           END-IF.                                                      23490000
           IF  MR-J-FIXTURE-L (ASC-ITEM-SUB) > ZERO                     23500000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23510000
               MOVE MR-J-FIXTURE (ASC-ITEM-SUB)                         23520000
                                         TO ASC-FIXTURE                 23530000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23540000
           ELSE                                                         23550000
               IF  MR-J-FIXTURE-A (ASC-ITEM-SUB) = DP015-ERASE-EOF      23560000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23570000
                       MOVE SPACE        TO ASC-FIXTURE                 23580000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23590000
               END-IF                                                   23600000
           END-IF.                                                      23610000
           IF  MR-J-DEPT-L (ASC-ITEM-SUB) > ZERO                        23620000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23630000
               MOVE MR-J-DEPT (ASC-ITEM-SUB)                            23640000
                                         TO ASC-NRTL-DEPT               23650000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23660000
           ELSE                                                         23670000
               IF  MR-J-DEPT-A (ASC-ITEM-SUB) = DP015-ERASE-EOF         23680000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23690000
                       MOVE SPACE        TO ASC-NRTL-DEPT               23700000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23710000
               END-IF                                                   23720000
           END-IF.                                                      23730000
           IF  MR-J-QTY-L (ASC-ITEM-SUB) > ZERO                         23740000
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             23750000
               MOVE MR-J-QTY (ASC-ITEM-SUB)                             23760000
                                         TO ASC-NRTL-QTY                23770000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23780000
           ELSE                                                         23790000
               IF  MR-J-QTY-A (ASC-ITEM-SUB) = DP015-ERASE-EOF          23800000
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     23810000
                       MOVE SPACE        TO ASC-NRTL-QTY                23820000
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      23830000
               END-IF                                                   23840000
           END-IF.                                                      23850000
      *                                                                 23860000
       2300-FIND-STR-RTV-SITE.                                          23870000
           MOVE ASC-FR-STORE-NBR          TO DK-STORE-NBR.              23880000
                                                                        23890000
070111     PERFORM 7520-SELECT-RTV-SITE                                 23900000
070111     MOVE PV-DC                     TO ASC-TO-STORE-NBR-N.        23910000
070111     MOVE XST00001-LOC-10-ABBR-NM   TO ASC-TO-STORE-NAM.          23920000
      ******************************************************************23930000
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **23940000
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **23950000
      ******************************************************************23960000
       3000-EDIT-DATA-IN-COMMAREA.                                      23970000
051705     SET ASC-OK-TO-SHIP            TO TRUE.                       23980000
           SET ASC-NO-ERROR              TO TRUE.                       23990000
           MOVE +0                       TO ASC-NBR-OF-LINES-ENTERED.   24000000
           PERFORM 3200-RESET-ATTRIBUTES.                               24010000
           PERFORM 3300-EDIT-HEADER-INFO.                               24020000
           SET PS-SECURE-HAND-CARRY-NOT-OK       TO TRUE.               24030000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         24040000
               PERFORM 3400-EDIT-RTL-DETAIL-INFO                        24050000
                   VARYING ASC-ITEM-SUB                                 24060000
                   FROM 1 BY 1                                          24070000
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL          24080000
           ELSE                                                         24090000
               PERFORM 3450-EDIT-NRTL-DETAIL-INFO                       24100000
                   VARYING ASC-ITEM-SUB                                 24110000
                   FROM 1 BY 1                                          24120000
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL         24130000
           END-IF.                                                      24140000
      ******************************************************************24150000
      ** IF NO OTHER EDIT ERRORS, CHECK FOR MAXIMUM QTY EXCEEDED.     **24160000
      ******************************************************************24170000
           IF ASC-NO-ERROR      AND                                     24180000
               ASC-XFER-TYPE NOT = PC-NON-RETAIL                        24190000
               INITIALIZE PWT-PROGRAM-WORK-TABLE                        24200000
               PERFORM 3460-EDIT-RTL-QTY                                24210000
                 VARYING PV-BLOCK                                       24220000
                   FROM 1 BY 1 UNTIL                                    24230000
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              24240000
                 AFTER PV-ITEM                                          24250000
                   FROM 1 BY 1 UNTIL                                    24260000
                         PV-ITEM > PC-ITEMS-PER-RTL-PANEL               24270000
      ******************************************************************24280000
      ** IF THERE ARE MAXIMUM QTY ERRORS, FIND THE FIRST OCCURANCE    **24290000
      ** SO THE PROPER SCREEN CAN BE DISPLAYED WITH ERRORS.           **24300000
      ******************************************************************24310000
               IF ASC-ERROR                                             24320000
                   SET PS-QTY-ERROR-NOT-FOUND     TO TRUE               24330000
                   PERFORM 3480-CHECK-FOR-QTY-ERROR                     24340000
                     VARYING PV-BLOCK                                   24350000
                       FROM 1 BY 1 UNTIL                                24360000
                            (PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY OR       24370000
                             PS-QTY-ERROR-FOUND)                        24380000
                     AFTER PV-ITEM                                      24390000
                       FROM 1 BY 1 UNTIL                                24400000
                            (PV-ITEM > PC-ITEMS-PER-RTL-PANEL OR        24410000
                             PS-QTY-ERROR-FOUND)                        24420000
                   IF PS-QTY-ERROR-FOUND                                24430000
                       MOVE DP015-RED             TO MR-I-QTY-C         24440000
                                        (PV-HOLD-ITEM)                  24450000
                       MOVE DP015-REVERSE         TO MR-I-QTY-H         24460000
                                        (PV-HOLD-ITEM)                  24470000
                       MOVE PC-TSYMSG-01543   TO DP020-MSG-NUMBER       24480000
                       SET DP020-MSG-FATAL    TO TRUE                   24490000
                       MOVE -1                TO MR-I-QTY-L             24500000
                                        (PV-HOLD-ITEM)                  24510000
                       SET DP030-SET-CURSOR-APPL-4   TO TRUE            24520000
      ******************************************************************24530000
      ** TEST THE REST OF THE ITEMS ON THE SAME SCREEN TO HIGHLIGHT   **24540000
      ** ANY ADDITIONAL QTY ERROR FIELDS.                             **24550000
      ******************************************************************24560000
                       PERFORM                                          24570000
                         VARYING PV-ITEM2                               24580000
                           FROM PV-HOLD-ITEM BY 1 UNTIL                 24590000
                                PV-ITEM2 > PC-ITEMS-PER-RTL-PANEL       24600000
                           IF PWT-QTY-ERROR (ASC-BLK-SUB PV-ITEM2)      24610000
                               MOVE DP015-RED         TO MR-I-QTY-C     24620000
                                        (PV-ITEM2)                      24630000
                               MOVE DP015-REVERSE   TO MR-I-QTY-H       24640000
                                        (PV-ITEM2)                      24650000
                           END-IF                                       24660000
                       END-PERFORM                                      24670000
                   END-IF                                               24680000
               END-IF                                                   24690000
           END-IF.                                                      24700000
           IF ASC-NO-ERROR                                              24710000
               SET DP030-SET-CURSOR-APPL-4   TO TRUE                    24720000
               IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                     24730000
                   MOVE -1                TO MR-I-UPC-L (1)             24740000
               ELSE                                                     24750000
                   MOVE -1                TO MR-J-DESC-L (1)            24760000
               END-IF                                                   24770000
           END-IF.                                                      24780000
           IF ASC-NO-ERROR AND ASC-XFER-TYPE = PC-CALLBACK              24790000
               SET PS-VALID-CALLBACK            TO TRUE                 24800000
               PERFORM                                                  24810000
                 VARYING ASC-ITEM-SUB                                   24820000
                   FROM 1 BY 1 UNTIL                                    24830000
                     ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL              24840000
                   IF ASC-INVALID-CALLBACK-PRICE                        24850000
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   24860000
                       SET PS-INVALID-CALLBACK  TO TRUE                 24870000
                       MOVE DP015-YELLOW  TO MR-I-UPC-C (ASC-ITEM-SUB)  24880000
                                             MR-I-PRICE-C (ASC-ITEM-SUB)24890000
                       MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)  24900000
                                             MR-I-PRICE-H (ASC-ITEM-SUB)24910000
                   END-IF                                               24920000
               END-PERFORM                                              24930000
               IF PS-INVALID-CALLBACK                                   24940000
                   MOVE PC-TSYMSG-01486         TO DP020-MSG-NUMBER     24950000
                   SET DP020-MSG-INFORMATIONAL  TO TRUE                 24960000
               END-IF                                                   24970000
           END-IF.                                                      24980000
                                                                        24990000
      *                                                                 25000000
       EJECT                                                            25010000
      ******************************************************************25020000
      ** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **25030000
      ******************************************************************25040000
                                                                        25050000
       3200-RESET-ATTRIBUTES.                                           25060000
           MOVE DP015-UNP-NUM-NOR-OFF    TO MR-A-TO-STORE-NBR-A.        25070000
           MOVE DP015-GREEN              TO MR-A-TO-STORE-NBR-C.        25080000
           MOVE DP015-UNDERLINE          TO MR-A-TO-STORE-NBR-H.        25090000
           EVALUATE ASC-XFER-TYPE                                       25100000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           25110000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           25120000
               WHEN PC-STOCK-BAL-STORE                                  25130000
                   MOVE DP015-UNP-ALP-NOR-OFF                           25140000
                                         TO MR-B-COMP-BY-INT-A          25150000
                                            MR-B-COMP-BY-NAM-A          25160000
                   MOVE DP015-GREEN      TO MR-B-COMP-BY-INT-C          25170000
                                            MR-B-COMP-BY-NAM-C          25180000
                   MOVE DP015-UNDERLINE  TO MR-B-COMP-BY-INT-H          25190000
                                            MR-B-COMP-BY-NAM-H          25200000
               WHEN PC-CALLBACK                                         25210000
                   MOVE DP015-UNP-ALP-NOR-OFF                           25220000
                                         TO MR-C-COMP-BY-INT-A          25230000
                                            MR-C-COMP-BY-NAM-A          25240000
                   MOVE DP015-UNP-NUM-NOR-OFF                           25250000
                                         TO MR-C-CALLBACK-NBR-A         25260000
                   MOVE DP015-GREEN      TO MR-C-COMP-BY-INT-C          25270000
                                            MR-C-COMP-BY-NAM-C          25280000
                                            MR-C-CALLBACK-NBR-C         25290000
                   MOVE DP015-UNDERLINE  TO MR-C-COMP-BY-INT-H          25300000
                                            MR-C-COMP-BY-NAM-H          25310000
                                            MR-C-CALLBACK-NBR-H         25320000
               WHEN PC-STOCK-BAL-CORP                                   25330000
                   MOVE DP015-UNP-ALP-NOR-OFF                           25340000
                                         TO MR-D-COMP-BY-INT-A          25350000
                                            MR-D-COMP-BY-NAM-A          25360000
                   MOVE DP015-UNP-NUM-NOR-OFF                           25370000
                                         TO MR-D-APPROVAL-NBR-A         25380000
                   MOVE DP015-GREEN      TO MR-D-COMP-BY-INT-C          25390000
                                            MR-D-COMP-BY-NAM-C          25400000
                                            MR-D-APPROVAL-NBR-C         25410000
                   MOVE DP015-UNDERLINE  TO MR-D-COMP-BY-INT-H          25420000
                                            MR-D-COMP-BY-NAM-H          25430000
                                            MR-D-APPROVAL-NBR-H         25440000
               WHEN PC-CUSTOMER                                         25450000
                   MOVE DP015-UNP-ALP-NOR-OFF                           25460000
                                         TO MR-E-COMP-BY-INT-A          25470000
                                            MR-E-COMP-BY-NAM-A          25480000
                                            MR-E-REQ-BY-INT-A           25490000
                                            MR-E-REQ-BY-NAM-A           25500000
                                            MR-E-CUST-NAME-A            25510000
                                            MR-E-ADDR1-A                25520000
                                            MR-E-ADDR2-A                25530000
                                            MR-E-CITY-A                 25540000
                                            MR-E-STATE-A                25550000
                   MOVE DP015-UNP-NUM-NOR-OFF                           25560000
                                         TO MR-E-PHONE-AREA-A           25570000
                                            MR-E-PHONE-EXCH-A           25580000
                                            MR-E-PHONE-NBR-A            25590000
                                            MR-E-ZIP-A                  25600000
                                            MR-E-ZIP-EXT-A              25610000
                   MOVE DP015-GREEN      TO MR-E-COMP-BY-INT-C          25620000
                                            MR-E-COMP-BY-NAM-C          25630000
                                            MR-E-REQ-BY-INT-C           25640000
                                            MR-E-REQ-BY-NAM-C           25650000
                                            MR-E-CUST-NAME-C            25660000
                                            MR-E-ADDR1-C                25670000
                                            MR-E-ADDR2-C                25680000
                                            MR-E-CITY-C                 25690000
                                            MR-E-STATE-C                25700000
                                            MR-E-PHONE-AREA-C           25710000
                                            MR-E-PHONE-EXCH-C           25720000
                                            MR-E-PHONE-NBR-C            25730000
                                            MR-E-ZIP-C                  25740000
                                            MR-E-ZIP-EXT-C              25750000
                   MOVE DP015-UNDERLINE  TO MR-E-COMP-BY-INT-H          25760000
                                            MR-E-COMP-BY-NAM-H          25770000
                                            MR-E-REQ-BY-INT-H           25780000
                                            MR-E-REQ-BY-NAM-H           25790000
                                            MR-E-CUST-NAME-H            25800000
                                            MR-E-ADDR1-H                25810000
                                            MR-E-ADDR2-H                25820000
                                            MR-E-CITY-H                 25830000
                                            MR-E-STATE-H                25840000
                                            MR-E-PHONE-AREA-H           25850000
                                            MR-E-PHONE-EXCH-H           25860000
                                            MR-E-PHONE-NBR-H            25870000
                                            MR-E-ZIP-H                  25880000
                                            MR-E-ZIP-EXT-H              25890000
           END-EVALUATE.                                                25900000
           EVALUATE ASC-CONTNR-TYPE                                     25910000
               WHEN PC-TRAILER                                          25920000
                   MOVE DP015-UNP-ALP-NOR-OFF                           25930000
                                         TO MR-H-TRLR-NBR-A             25940000
                                            MR-H-TRLR-SEAL-A            25950000
                   MOVE DP015-GREEN      TO MR-H-TRLR-NBR-C             25960000
                                            MR-H-TRLR-SEAL-C            25970000
                   MOVE DP015-UNDERLINE  TO MR-H-TRLR-NBR-H             25980000
                                            MR-H-TRLR-SEAL-H            25990000
               WHEN OTHER                                               26000000
                   MOVE DP015-UNP-ALP-NOR-OFF                           26010000
                                         TO MR-G-LG-TOTE-SEAL1-A        26020000
                                            MR-G-LG-TOTE-SEAL2-A        26030000
                                            MR-G-SM-TOTE-SEAL-A         26040000
                   MOVE DP015-GREEN      TO MR-G-LG-TOTE-SEAL1-C        26050000
                                            MR-G-LG-TOTE-SEAL2-C        26060000
                                            MR-G-SM-TOTE-SEAL-C         26070000
                   MOVE DP015-UNDERLINE  TO MR-G-LG-TOTE-SEAL1-H        26080000
                                            MR-G-LG-TOTE-SEAL2-H        26090000
                                            MR-G-SM-TOTE-SEAL-H         26100000
           END-EVALUATE.                                                26110000
      *                                                                 26120000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         26130000
             PERFORM                                                    26140000
               VARYING PV-SUB                                           26150000
               FROM 1 BY 1                                              26160000
               UNTIL PV-SUB > PC-ITEMS-PER-RTL-PANEL                    26170000
               MOVE DP015-UNP-NUM-NOR-OFF                               26180000
                                         TO MR-I-UPC-A    (PV-SUB)      26190000
                                            MR-I-PRICE-A  (PV-SUB)      26200000
                                            MR-I-QTY-A    (PV-SUB)      26210000
               MOVE DP015-GREEN          TO MR-I-UPC-C    (PV-SUB)      26220000
                                            MR-I-PRICE-C  (PV-SUB)      26230000
                                            MR-I-QTY-C    (PV-SUB)      26240000
               MOVE DP015-UNDERLINE      TO MR-I-UPC-H    (PV-SUB)      26250000
                                            MR-I-PRICE-H  (PV-SUB)      26260000
                                            MR-I-QTY-H    (PV-SUB)      26270000
             END-PERFORM                                                26280000
           ELSE                                                         26290000
             PERFORM                                                    26300000
               VARYING PV-SUB                                           26310000
               FROM 1 BY 1                                              26320000
               UNTIL PV-SUB > PC-ITEMS-PER-NRTL-PANEL                   26330000
               MOVE DP015-UNP-NUM-NOR-OFF                               26340000
                                         TO MR-J-QTY-A    (PV-SUB)      26350000
               MOVE DP015-UNP-ALP-NOR-OFF                               26360000
                                         TO MR-J-DESC-A   (PV-SUB)      26370000
                                            MR-J-FIXTURE-A (PV-SUB)     26380000
                                            MR-J-DEPT-A   (PV-SUB)      26390000
               MOVE DP015-GREEN          TO MR-J-DESC-C   (PV-SUB)      26400000
                                            MR-J-FIXTURE-C (PV-SUB)     26410000
                                            MR-J-DEPT-C   (PV-SUB)      26420000
                                            MR-J-QTY-C    (PV-SUB)      26430000
               MOVE DP015-UNDERLINE      TO MR-J-DESC-H   (PV-SUB)      26440000
                                            MR-J-FIXTURE-H (PV-SUB)     26450000
                                            MR-J-DEPT-H   (PV-SUB)      26460000
                                            MR-J-QTY-H    (PV-SUB)      26470000
             END-PERFORM                                                26480000
           END-IF.                                                      26490000
      ******************************************************************26500000
      ** RESET THE ATTRIBUTES TO NON-ENTERABLE WHEN XFER IS COMPLETE. **26510000
      ******************************************************************26520000
                                                                        26530000
       3250-RESET-ATTRIBUTES.                                           26540000
           MOVE DP015-PRO-NOR-OFF        TO MR-A-TO-STORE-NBR-A.        26550000
           MOVE DP015-BLUE               TO MR-A-TO-STORE-NBR-C.        26560000
           MOVE DP015-HL-OFF             TO MR-A-TO-STORE-NBR-H.        26570000
           EVALUATE ASC-XFER-TYPE                                       26580000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           26590000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           26600000
               WHEN PC-STOCK-BAL-STORE                                  26610000
                   MOVE DP015-PRO-NOR-OFF                               26620000
                                         TO MR-B-COMP-BY-INT-A          26630000
                                            MR-B-COMP-BY-NAM-A          26640000
                   MOVE DP015-BLUE       TO MR-B-COMP-BY-INT-C          26650000
                                            MR-B-COMP-BY-NAM-C          26660000
                   MOVE DP015-HL-OFF     TO MR-B-COMP-BY-INT-H          26670000
                                            MR-B-COMP-BY-NAM-H          26680000
               WHEN PC-CALLBACK                                         26690000
                   MOVE DP015-PRO-NOR-OFF                               26700000
                                         TO MR-C-COMP-BY-INT-A          26710000
                                            MR-C-COMP-BY-NAM-A          26720000
                                            MR-C-CALLBACK-NBR-A         26730000
                   MOVE DP015-BLUE       TO MR-C-COMP-BY-INT-C          26740000
                                            MR-C-COMP-BY-NAM-C          26750000
                                            MR-C-CALLBACK-NBR-C         26760000
                   MOVE DP015-HL-OFF     TO MR-C-COMP-BY-INT-H          26770000
                                            MR-C-COMP-BY-NAM-H          26780000
                                            MR-C-CALLBACK-NBR-H         26790000
               WHEN PC-STOCK-BAL-CORP                                   26800000
                   MOVE DP015-PRO-NOR-OFF                               26810000
                                         TO MR-D-COMP-BY-INT-A          26820000
                                            MR-D-COMP-BY-NAM-A          26830000
                                            MR-D-APPROVAL-NBR-A         26840000
                   MOVE DP015-BLUE       TO MR-D-COMP-BY-INT-C          26850000
                                            MR-D-COMP-BY-NAM-C          26860000
                                            MR-D-APPROVAL-NBR-C         26870000
                   MOVE DP015-HL-OFF     TO MR-D-COMP-BY-INT-H          26880000
                                            MR-D-COMP-BY-NAM-H          26890000
                                            MR-D-APPROVAL-NBR-H         26900000
               WHEN PC-CUSTOMER                                         26910000
                   MOVE DP015-PRO-NOR-OFF                               26920000
                                         TO MR-E-COMP-BY-INT-A          26930000
                                            MR-E-COMP-BY-NAM-A          26940000
                                            MR-E-REQ-BY-INT-A           26950000
                                            MR-E-REQ-BY-NAM-A           26960000
                                            MR-E-CUST-NAME-A            26970000
                                            MR-E-ADDR1-A                26980000
                                            MR-E-ADDR2-A                26990000
                                            MR-E-CITY-A                 27000000
                                            MR-E-STATE-A                27010000
                                            MR-E-PHONE-AREA-A           27020000
                                            MR-E-PHONE-EXCH-A           27030000
                                            MR-E-PHONE-NBR-A            27040000
                                            MR-E-ZIP-A                  27050000
                                            MR-E-ZIP-EXT-A              27060000
                   MOVE DP015-BLUE       TO MR-E-COMP-BY-INT-C          27070000
                                            MR-E-COMP-BY-NAM-C          27080000
                                            MR-E-REQ-BY-INT-C           27090000
                                            MR-E-REQ-BY-NAM-C           27100000
                                            MR-E-CUST-NAME-C            27110000
                                            MR-E-ADDR1-C                27120000
                                            MR-E-ADDR2-C                27130000
                                            MR-E-CITY-C                 27140000
                                            MR-E-STATE-C                27150000
                                            MR-E-PHONE-AREA-C           27160000
                                            MR-E-PHONE-EXCH-C           27170000
                                            MR-E-PHONE-NBR-C            27180000
                                            MR-E-ZIP-C                  27190000
                                            MR-E-ZIP-EXT-C              27200000
                   MOVE DP015-HL-OFF     TO MR-E-COMP-BY-INT-H          27210000
                                            MR-E-COMP-BY-NAM-H          27220000
                                            MR-E-REQ-BY-INT-H           27230000
                                            MR-E-REQ-BY-NAM-H           27240000
                                            MR-E-CUST-NAME-H            27250000
                                            MR-E-ADDR1-H                27260000
                                            MR-E-ADDR2-H                27270000
                                            MR-E-CITY-H                 27280000
                                            MR-E-STATE-H                27290000
                                            MR-E-PHONE-AREA-H           27300000
                                            MR-E-PHONE-EXCH-H           27310000
                                            MR-E-PHONE-NBR-H            27320000
                                            MR-E-ZIP-H                  27330000
                                            MR-E-ZIP-EXT-H              27340000
               WHEN PC-NON-RETAIL                                       27350000
                   MOVE DP015-PRO-NOR-OFF                               27360000
                                         TO MR-F-COMP-BY-INT-A          27370000
                                            MR-F-COMP-BY-NAM-A          27380000
                                            MR-F-REQ-BY-INT-A           27390000
                                            MR-F-REQ-BY-NAM-A           27400000
                                            MR-F-ATTN-TO-INT-A          27410000
                                            MR-F-ATTN-TO-NAM-A          27420000
                   MOVE DP015-BLUE       TO MR-F-COMP-BY-INT-C          27430000
                                            MR-F-COMP-BY-NAM-C          27440000
                                            MR-F-REQ-BY-INT-C           27450000
                                            MR-F-REQ-BY-NAM-C           27460000
                                            MR-F-ATTN-TO-INT-C          27470000
                                            MR-F-ATTN-TO-NAM-C          27480000
                   MOVE DP015-HL-OFF     TO MR-F-COMP-BY-INT-H          27490000
                                            MR-F-COMP-BY-NAM-H          27500000
                                            MR-F-REQ-BY-INT-H           27510000
                                            MR-F-REQ-BY-NAM-H           27520000
                                            MR-F-ATTN-TO-INT-H          27530000
                                            MR-F-ATTN-TO-NAM-H          27540000
           END-EVALUATE.                                                27550000
           EVALUATE ASC-CONTNR-TYPE                                     27560000
               WHEN PC-TRAILER                                          27570000
                   MOVE DP015-PRO-NOR-OFF                               27580000
                                         TO MR-H-TRLR-NBR-A             27590000
                                            MR-H-TRLR-SEAL-A            27600000
                   MOVE DP015-BLUE       TO MR-H-TRLR-NBR-C             27610000
                                            MR-H-TRLR-SEAL-C            27620000
                   MOVE DP015-HL-OFF     TO MR-H-TRLR-NBR-H             27630000
                                            MR-H-TRLR-SEAL-H            27640000
               WHEN OTHER                                               27650000
                   MOVE DP015-PRO-NOR-OFF                               27660000
                                         TO MR-G-LG-TOTE-SEAL1-A        27670000
                                            MR-G-LG-TOTE-SEAL2-A        27680000
                                            MR-G-SM-TOTE-SEAL-A         27690000
                   MOVE DP015-BLUE       TO MR-G-LG-TOTE-SEAL1-C        27700000
                                            MR-G-LG-TOTE-SEAL2-C        27710000
                                            MR-G-SM-TOTE-SEAL-C         27720000
                   MOVE DP015-HL-OFF     TO MR-G-LG-TOTE-SEAL1-H        27730000
                                            MR-G-LG-TOTE-SEAL2-H        27740000
                                            MR-G-SM-TOTE-SEAL-H         27750000
           END-EVALUATE.                                                27760000
      *                                                                 27770000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         27780000
             PERFORM                                                    27790000
               VARYING PV-SUB                                           27800000
               FROM 1 BY 1                                              27810000
               UNTIL PV-SUB > PC-ITEMS-PER-RTL-PANEL                    27820000
                                                                        27830000
               MOVE DP015-PRO-NOR-OFF TO    MR-I-UPC-A    (PV-SUB)      27840000
                                            MR-I-PRICE-A  (PV-SUB)      27850000
                                            MR-I-QTY-A    (PV-SUB)      27860000
               MOVE DP015-BLUE        TO    MR-I-UPC-C    (PV-SUB)      27870000
                                            MR-I-PRICE-C  (PV-SUB)      27880000
                                            MR-I-QTY-C    (PV-SUB)      27890000
               MOVE DP015-HL-OFF      TO    MR-I-UPC-H    (PV-SUB)      27900000
                                            MR-I-PRICE-H  (PV-SUB)      27910000
                                            MR-I-QTY-H    (PV-SUB)      27920000
             END-PERFORM                                                27930000
           ELSE                                                         27940000
             PERFORM                                                    27950000
               VARYING PV-SUB                                           27960000
               FROM 1 BY 1                                              27970000
               UNTIL PV-SUB > PC-ITEMS-PER-NRTL-PANEL                   27980000
               MOVE DP015-PRO-NOR-OFF                                   27990000
                                         TO MR-J-QTY-A    (PV-SUB)      28000000
                                            MR-J-DESC-A   (PV-SUB)      28010000
                                            MR-J-FIXTURE-A (PV-SUB)     28020000
                                            MR-J-DEPT-A   (PV-SUB)      28030000
               MOVE DP015-BLUE           TO MR-J-DESC-C   (PV-SUB)      28040000
                                            MR-J-FIXTURE-C (PV-SUB)     28050000
                                            MR-J-DEPT-C   (PV-SUB)      28060000
                                            MR-J-QTY-C    (PV-SUB)      28070000
               MOVE DP015-HL-OFF         TO MR-J-DESC-H   (PV-SUB)      28080000
                                            MR-J-FIXTURE-H (PV-SUB)     28090000
                                            MR-J-DEPT-H   (PV-SUB)      28100000
                                            MR-J-QTY-H    (PV-SUB)      28110000
             END-PERFORM                                                28120000
           END-IF.                                                      28130000
      ******************************************************************28140000
      ** EDIT THE HEADING INFORMATION.                                **28150000
      ******************************************************************28160000
       3300-EDIT-HEADER-INFO.                                           28170000
           PERFORM 3380-GET-CUR-DATE.                                   28180000
           IF ASC-TO-STORE-NBR NOT > SPACES                             28190000
               MOVE DP015-RED             TO MR-A-TO-STORE-NBR-C        28200000
               MOVE DP015-REVERSE         TO MR-A-TO-STORE-NBR-H        28210000
               IF ASC-NO-ERROR                                          28220000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           28230000
                   SET DP020-MSG-FATAL    TO TRUE                       28240000
                   MOVE -1                TO MR-A-TO-STORE-NBR-L        28250000
                   SET DP030-SET-CURSOR-APPL-1                          28260000
                       ASC-ERROR          TO TRUE                       28270000
               END-IF                                                   28280000
           ELSE                                                         28290000
               IF ASC-TO-STORE-NBR-N = ASC-FR-STORE-NBR                 28300000
                   MOVE DP015-RED             TO MR-A-TO-STORE-NBR-C    28310000
                   MOVE DP015-REVERSE         TO MR-A-TO-STORE-NBR-H    28320000
                   IF ASC-NO-ERROR                                      28330000
                       MOVE PC-TSYMSG-00827   TO DP020-MSG-NUMBER       28340000
                       SET DP020-MSG-FATAL    TO TRUE                   28350000
                       MOVE -1                TO MR-A-TO-STORE-NBR-L    28360000
                       SET DP030-SET-CURSOR-APPL-1                      28370000
                           ASC-ERROR          TO TRUE                   28380000
                   END-IF                                               28390000
               ELSE                                                     28400000
                   MOVE ASC-TO-STORE-NBR      TO DP010I-UNEDITED-FIELD  28410000
100404*            MOVE +3                    TO DP010I-MAXIMUM-DIGITS  28420000
100404             MOVE LENGTH OF ASC-TO-STORE-NBR                      28430000
100404                                        TO DP010I-MAXIMUM-DIGITS  28440000
                   MOVE +0                   TO DP010I-MAXIMUM-DECIMALS 28450000
                   SET  DP010I-NEGATIVE-NOT-ALLOWED                     28460000
                                              TO TRUE                   28470000
                   CALL DP010I-NUMERIC-EDIT-ROUTINE                     28481002
                         USING DP010I-NUMERIC-EDIT-AREA                 28482002
                   MOVE DP010I-NUMERIC-FIELD  TO ASC-TO-STORE-NBR-N     28490000
                                                 DK-STORE-NBR           28500000
                   SET PS-STORE-NOT-FOUND     TO TRUE                   28510000
                   PERFORM 4500-READ-STORE                              28520000
                   IF PS-STORE-NOT-FOUND                                28530000
                       MOVE DP015-RED         TO MR-A-TO-STORE-NBR-C    28540000
                       MOVE DP015-REVERSE     TO MR-A-TO-STORE-NBR-H    28550000
                       IF ASC-NO-ERROR                                  28560000
                          MOVE PC-TSYMSG-00017   TO DP020-MSG-NUMBER    28570000
                           SET DP020-MSG-FATAL    TO TRUE               28580000
                           MOVE -1            TO MR-A-TO-STORE-NBR-L    28590000
                           SET DP030-SET-CURSOR-APPL-1                  28600000
                           ASC-ERROR          TO TRUE                   28610000
                       END-IF                                           28620000
                   ELSE                                                 28630000
                       PERFORM 4510-VALIDATE-STORE                      28640000
                   END-IF                                               28650000
               END-IF                                                   28660000
           END-IF.                                                      28670000
           EVALUATE ASC-XFER-TYPE                                       28680000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           28690000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           28700000
               WHEN PC-STOCK-BAL-STORE                                  28710000
                   PERFORM 3310-EDIT-DEF-DAMAGE                         28720000
               WHEN PC-CALLBACK                                         28730000
                   PERFORM 3320-EDIT-CALLBACK                           28740000
               WHEN PC-STOCK-BAL-CORP                                   28750000
                   PERFORM 3330-EDIT-STOCK-BAL-CORP                     28760000
               WHEN PC-CUSTOMER                                         28770000
                   PERFORM 3340-EDIT-CUSTOMER                           28780000
               WHEN PC-NON-RETAIL                                       28790000
                   PERFORM 3350-EDIT-NON-RETAIL                         28800000
           END-EVALUATE.                                                28810000
           EVALUATE ASC-CONTNR-TYPE                                     28820000
               WHEN PC-TRAILER                                          28830000
                   PERFORM 3360-EDIT-TRAILER                            28840000
               WHEN PC-SECURE-TOTE                                      28850000
                   PERFORM 3370-EDIT-TOTE                               28860000
           END-EVALUATE.                                                28870000
                                                                        28880000
      ******************************************************************28890000
      ** EDIT THE HEADING INFO FOR DEFECTIVE/DAMAGE OR STOCK BAL-STORE *28900000
      ******************************************************************28910000
       3310-EDIT-DEF-DAMAGE.                                            28920000
           IF ASC-COMP-BY-INT NOT > SPACES                              28930000
               MOVE DP015-RED             TO MR-B-COMP-BY-INT-C         28940000
               MOVE DP015-REVERSE         TO MR-B-COMP-BY-INT-H         28950000
               IF ASC-NO-ERROR                                          28960000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           28970000
                   SET DP020-MSG-FATAL    TO TRUE                       28980000
                   MOVE -1                TO MR-B-COMP-BY-INT-L         28990000
                   SET DP030-SET-CURSOR-APPL-2                          29000000
                       ASC-ERROR          TO TRUE                       29010000
               END-IF                                                   29020000
           END-IF                                                       29030000
           IF ASC-COMP-BY-NAM NOT > SPACES                              29040000
               MOVE DP015-RED             TO MR-B-COMP-BY-NAM-C         29050000
               MOVE DP015-REVERSE         TO MR-B-COMP-BY-NAM-H         29060000
               IF ASC-NO-ERROR                                          29070000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           29080000
                   SET DP020-MSG-FATAL    TO TRUE                       29090000
                   MOVE -1                TO MR-B-COMP-BY-NAM-L         29100000
                   SET DP030-SET-CURSOR-APPL-2                          29110000
                       ASC-ERROR          TO TRUE                       29120000
               END-IF                                                   29130000
           END-IF.                                                      29140000
      ******************************************************************29150000
      ** EDIT THE HEADING INFO FOR CALLBACK TRANSFERS.                **29160000
      ******************************************************************29170000
       3320-EDIT-CALLBACK.                                              29180000
           IF ASC-COMP-BY-INT NOT > SPACES                              29190000
               MOVE DP015-RED             TO MR-C-COMP-BY-INT-C         29200000
               MOVE DP015-REVERSE         TO MR-C-COMP-BY-INT-H         29210000
               IF ASC-NO-ERROR                                          29220000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           29230000
                   SET DP020-MSG-FATAL    TO TRUE                       29240000
                   MOVE -1                TO MR-C-COMP-BY-INT-L         29250000
                   SET DP030-SET-CURSOR-APPL-2                          29260000
                       ASC-ERROR          TO TRUE                       29270000
               END-IF                                                   29280000
           END-IF                                                       29290000
           IF ASC-COMP-BY-NAM NOT > SPACES                              29300000
               MOVE DP015-RED             TO MR-C-COMP-BY-NAM-C         29310000
               MOVE DP015-REVERSE         TO MR-C-COMP-BY-NAM-H         29320000
               IF ASC-NO-ERROR                                          29330000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           29340000
                   SET DP020-MSG-FATAL    TO TRUE                       29350000
                   MOVE -1                TO MR-C-COMP-BY-NAM-L         29360000
                   SET DP030-SET-CURSOR-APPL-2                          29370000
                       ASC-ERROR          TO TRUE                       29380000
               END-IF                                                   29390000
           END-IF                                                       29400000
           IF ASC-CALLBACK-NBR > SPACES                                 29410000
               MOVE ASC-CALLBACK-NBR      TO DP010I-UNEDITED-FIELD      29420000
               MOVE +4                    TO DP010I-MAXIMUM-DIGITS      29430000
               MOVE +0                    TO DP010I-MAXIMUM-DECIMALS    29440000
               SET  DP010I-NEGATIVE-NOT-ALLOWED                         29450000
                                          TO TRUE                       29460000
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         29471002
                         USING DP010I-NUMERIC-EDIT-AREA                 29472002
               MOVE DP010I-NUMERIC-FIELD  TO ASC-CALLBACK-NBR-N         29480000
           END-IF.                                                      29490000
           IF ASC-CALLBACK-NBR NOT > '0000'                             29500000
               MOVE DP015-RED             TO MR-C-CALLBACK-NBR-C        29510000
               MOVE DP015-REVERSE         TO MR-C-CALLBACK-NBR-H        29520000
               IF ASC-NO-ERROR                                          29530000
                   MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER           29540000
                   SET DP020-MSG-FATAL    TO TRUE                       29550000
                   MOVE -1                TO MR-C-CALLBACK-NBR-L        29560000
                   SET DP030-SET-CURSOR-APPL-2                          29570000
                       ASC-ERROR          TO TRUE                       29580000
               END-IF                                                   29590000
           END-IF.                                                      29600000
      ******************************************************************29610000
      ** EDIT THE HEADING INFO FOR STOCK BALANCE - CORP TRANSFERS.    **29620000
      ******************************************************************29630000
       3330-EDIT-STOCK-BAL-CORP.                                        29640000
           IF ASC-COMP-BY-INT NOT > SPACES                              29650000
               MOVE DP015-RED             TO MR-D-COMP-BY-INT-C         29660000
               MOVE DP015-REVERSE         TO MR-D-COMP-BY-INT-H         29670000
               IF ASC-NO-ERROR                                          29680000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           29690000
                   SET DP020-MSG-FATAL    TO TRUE                       29700000
                   MOVE -1                TO MR-D-COMP-BY-INT-L         29710000
                   SET DP030-SET-CURSOR-APPL-2                          29720000
                       ASC-ERROR          TO TRUE                       29730000
               END-IF                                                   29740000
           END-IF                                                       29750000
           IF ASC-COMP-BY-NAM NOT > SPACES                              29760000
               MOVE DP015-RED             TO MR-D-COMP-BY-NAM-C         29770000
               MOVE DP015-REVERSE         TO MR-D-COMP-BY-NAM-H         29780000
               IF ASC-NO-ERROR                                          29790000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           29800000
                   SET DP020-MSG-FATAL    TO TRUE                       29810000
                   MOVE -1                TO MR-D-COMP-BY-NAM-L         29820000
                   SET DP030-SET-CURSOR-APPL-2                          29830000
                       ASC-ERROR          TO TRUE                       29840000
               END-IF                                                   29850000
           END-IF                                                       29860000
           IF ASC-APPROVAL-NBR > SPACES                                 29870000
               MOVE ASC-APPROVAL-NBR      TO DP010I-UNEDITED-FIELD      29880000
               MOVE +9                    TO DP010I-MAXIMUM-DIGITS      29890000
               MOVE +0                    TO DP010I-MAXIMUM-DECIMALS    29900000
               SET  DP010I-NEGATIVE-NOT-ALLOWED                         29910000
                                          TO TRUE                       29920000
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         29931002
                         USING DP010I-NUMERIC-EDIT-AREA                 29932002
               MOVE DP010I-NUMERIC-FIELD  TO ASC-APPROVAL-NBR-N         29940000
           END-IF.                                                      29950000
           IF ASC-APPROVAL-NBR NOT > '000000000'                        29960000
               MOVE DP015-RED             TO MR-D-APPROVAL-NBR-C        29970000
               MOVE DP015-REVERSE         TO MR-D-APPROVAL-NBR-H        29980000
               IF ASC-NO-ERROR                                          29990000
                   MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER           30000000
                   SET DP020-MSG-FATAL    TO TRUE                       30010000
                   MOVE -1                TO MR-D-APPROVAL-NBR-L        30020000
                   SET DP030-SET-CURSOR-APPL-2                          30030000
                       ASC-ERROR          TO TRUE                       30040000
               END-IF                                                   30050000
           END-IF.                                                      30060000
      ******************************************************************30070000
      ** EDIT THE HEADING INFO FOR CUSTOMER TRANSFERS.                **30080000
      ******************************************************************30090000
       3340-EDIT-CUSTOMER.                                              30100000
           IF ASC-COMP-BY-INT NOT > SPACES                              30110000
               MOVE DP015-RED             TO MR-E-COMP-BY-INT-C         30120000
               MOVE DP015-REVERSE         TO MR-E-COMP-BY-INT-H         30130000
               IF ASC-NO-ERROR                                          30140000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30150000
                   SET DP020-MSG-FATAL    TO TRUE                       30160000
                   MOVE -1                TO MR-E-COMP-BY-INT-L         30170000
                   SET DP030-SET-CURSOR-APPL-2                          30180000
                       ASC-ERROR          TO TRUE                       30190000
               END-IF                                                   30200000
           END-IF                                                       30210000
           IF ASC-COMP-BY-NAM NOT > SPACES                              30220000
               MOVE DP015-RED             TO MR-E-COMP-BY-NAM-C         30230000
               MOVE DP015-REVERSE         TO MR-E-COMP-BY-NAM-H         30240000
               IF ASC-NO-ERROR                                          30250000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30260000
                   SET DP020-MSG-FATAL    TO TRUE                       30270000
                   MOVE -1                TO MR-E-COMP-BY-NAM-L         30280000
                   SET DP030-SET-CURSOR-APPL-2                          30290000
                       ASC-ERROR          TO TRUE                       30300000
               END-IF                                                   30310000
           END-IF                                                       30320000
           IF ASC-REQ-BY-INT NOT > SPACES                               30330000
               MOVE DP015-RED             TO MR-E-REQ-BY-INT-C          30340000
               MOVE DP015-REVERSE         TO MR-E-REQ-BY-INT-H          30350000
               IF ASC-NO-ERROR                                          30360000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30370000
                   SET DP020-MSG-FATAL    TO TRUE                       30380000
                   MOVE -1                TO MR-E-REQ-BY-INT-L          30390000
                   SET DP030-SET-CURSOR-APPL-2                          30400000
                       ASC-ERROR          TO TRUE                       30410000
               END-IF                                                   30420000
           END-IF                                                       30430000
           IF ASC-REQ-BY-NAM NOT > SPACES                               30440000
               MOVE DP015-RED             TO MR-E-REQ-BY-NAM-C          30450000
               MOVE DP015-REVERSE         TO MR-E-REQ-BY-NAM-H          30460000
               IF ASC-NO-ERROR                                          30470000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30480000
                   SET DP020-MSG-FATAL    TO TRUE                       30490000
                   MOVE -1                TO MR-E-REQ-BY-NAM-L          30500000
                   SET DP030-SET-CURSOR-APPL-2                          30510000
                       ASC-ERROR          TO TRUE                       30520000
               END-IF                                                   30530000
           END-IF                                                       30540000
           IF ASC-CUST-NAME NOT > SPACES                                30550000
               MOVE DP015-RED             TO MR-E-CUST-NAME-C           30560000
               MOVE DP015-REVERSE         TO MR-E-CUST-NAME-H           30570000
               IF ASC-NO-ERROR                                          30580000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30590000
                   SET DP020-MSG-FATAL    TO TRUE                       30600000
                   MOVE -1                TO MR-E-CUST-NAME-L           30610000
                   SET DP030-SET-CURSOR-APPL-2                          30620000
                       ASC-ERROR          TO TRUE                       30630000
               END-IF                                                   30640000
           END-IF.                                                      30650000
           IF ASC-PHONE NOT > SPACES                                    30660000
               MOVE DP015-RED             TO MR-E-PHONE-AREA-C          30670000
                                             MR-E-PHONE-EXCH-C          30680000
                                             MR-E-PHONE-NBR-C           30690000
               MOVE DP015-REVERSE         TO MR-E-PHONE-AREA-H          30700000
                                             MR-E-PHONE-EXCH-H          30710000
                                             MR-E-PHONE-NBR-H           30720000
               IF ASC-NO-ERROR                                          30730000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30740000
                   SET DP020-MSG-FATAL    TO TRUE                       30750000
                   MOVE -1                TO MR-E-PHONE-AREA-L          30760000
                   SET DP030-SET-CURSOR-APPL-2                          30770000
                       ASC-ERROR          TO TRUE                       30780000
               END-IF                                                   30790000
           END-IF.                                                      30800000
      ******************************************************************30810000
      ** EDIT THE HEADING INFO FOR NON-RETAIL TRANSFERS.              **30820000
      ******************************************************************30830000
       3350-EDIT-NON-RETAIL.                                            30840000
           IF ASC-COMP-BY-INT NOT > SPACES                              30850000
               MOVE DP015-RED             TO MR-F-COMP-BY-INT-C         30860000
               MOVE DP015-REVERSE         TO MR-F-COMP-BY-INT-H         30870000
               IF ASC-NO-ERROR                                          30880000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           30890000
                   SET DP020-MSG-FATAL    TO TRUE                       30900000
                   MOVE -1                TO MR-F-COMP-BY-INT-L         30910000
                   SET DP030-SET-CURSOR-APPL-2                          30920000
                       ASC-ERROR          TO TRUE                       30930000
               END-IF                                                   30940000
           END-IF                                                       30950000
           IF ASC-COMP-BY-NAM NOT > SPACES                              30960000
               MOVE DP015-RED             TO MR-F-COMP-BY-NAM-C         30970000
               MOVE DP015-REVERSE         TO MR-F-COMP-BY-NAM-H         30980000
               IF ASC-NO-ERROR                                          30990000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31000000
                   SET DP020-MSG-FATAL    TO TRUE                       31010000
                   MOVE -1                TO MR-F-COMP-BY-NAM-L         31020000
                   SET DP030-SET-CURSOR-APPL-2                          31030000
                       ASC-ERROR          TO TRUE                       31040000
               END-IF                                                   31050000
           END-IF                                                       31060000
           IF ASC-REQ-BY-INT NOT > SPACES                               31070000
               MOVE DP015-RED             TO MR-F-REQ-BY-INT-C          31080000
               MOVE DP015-REVERSE         TO MR-F-REQ-BY-INT-H          31090000
               IF ASC-NO-ERROR                                          31100000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31110000
                   SET DP020-MSG-FATAL    TO TRUE                       31120000
                   MOVE -1                TO MR-F-REQ-BY-INT-L          31130000
                   SET DP030-SET-CURSOR-APPL-2                          31140000
                       ASC-ERROR          TO TRUE                       31150000
               END-IF                                                   31160000
           END-IF                                                       31170000
           IF ASC-REQ-BY-NAM NOT > SPACES                               31180000
               MOVE DP015-RED             TO MR-F-REQ-BY-NAM-C          31190000
               MOVE DP015-REVERSE         TO MR-F-REQ-BY-NAM-H          31200000
               IF ASC-NO-ERROR                                          31210000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31220000
                   SET DP020-MSG-FATAL    TO TRUE                       31230000
                   MOVE -1                TO MR-F-REQ-BY-NAM-L          31240000
                   SET DP030-SET-CURSOR-APPL-2                          31250000
                       ASC-ERROR          TO TRUE                       31260000
               END-IF                                                   31270000
           END-IF.                                                      31280000
      ******************************************************************31290000
      ** EDIT THE TRAILER INFORMATION.                                **31300000
      ******************************************************************31310000
       3360-EDIT-TRAILER.                                               31320000
           IF ASC-TRAILER-SEAL NOT > SPACES                             31330000
               MOVE DP015-RED             TO MR-H-TRLR-SEAL-C           31340000
               MOVE DP015-REVERSE         TO MR-H-TRLR-SEAL-H           31350000
               IF ASC-NO-ERROR                                          31360000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31370000
                   SET DP020-MSG-FATAL    TO TRUE                       31380000
                   MOVE -1                TO MR-H-TRLR-SEAL-L           31390000
                   SET DP030-SET-CURSOR-APPL-3                          31400000
                       ASC-ERROR          TO TRUE                       31410000
               END-IF                                                   31420000
           END-IF.                                                      31430000
           IF ASC-TRAILER-NBR NOT > SPACES                              31440000
               MOVE DP015-RED             TO MR-H-TRLR-NBR-C            31450000
               MOVE DP015-REVERSE         TO MR-H-TRLR-NBR-H            31460000
               IF ASC-NO-ERROR                                          31470000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31480000
                   SET DP020-MSG-FATAL    TO TRUE                       31490000
                   MOVE -1                TO MR-H-TRLR-NBR-L            31500000
                   SET DP030-SET-CURSOR-APPL-3                          31510000
                       ASC-ERROR          TO TRUE                       31520000
               END-IF                                                   31530000
           END-IF.                                                      31540000
      ******************************************************************31550000
      ** EDIT THE TOTE INFORMATION - ONLY REQUIRED FOR SECURE TOTES.  **31560000
      ******************************************************************31570000
       3370-EDIT-TOTE.                                                  31580000
           IF ASC-LG-TOTE-SEAL1 NOT > SPACES                            31590000
               MOVE DP015-RED             TO MR-G-LG-TOTE-SEAL1-C       31600000
               MOVE DP015-REVERSE         TO MR-G-LG-TOTE-SEAL1-H       31610000
               IF ASC-NO-ERROR                                          31620000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31630000
                   SET DP020-MSG-FATAL    TO TRUE                       31640000
                   MOVE -1                TO MR-G-LG-TOTE-SEAL1-L       31650000
                   SET DP030-SET-CURSOR-APPL-3                          31660000
                       ASC-ERROR          TO TRUE                       31670000
               END-IF                                                   31680000
           END-IF.                                                      31690000
           IF ASC-LG-TOTE-SEAL2 NOT > SPACES                            31700000
               MOVE DP015-RED             TO MR-G-LG-TOTE-SEAL2-C       31710000
               MOVE DP015-REVERSE         TO MR-G-LG-TOTE-SEAL2-H       31720000
               IF ASC-NO-ERROR                                          31730000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           31740000
                   SET DP020-MSG-FATAL    TO TRUE                       31750000
                   MOVE -1                TO MR-G-LG-TOTE-SEAL2-L       31760000
                   SET DP030-SET-CURSOR-APPL-3                          31770000
                       ASC-ERROR          TO TRUE                       31780000
               END-IF                                                   31790000
           END-IF.                                                      31800000
      *                                                                 31810000
      ******************************************************************31820000
      **  GET CURRENT DATE FOR THE HEADER INFO                          31830000
      ******************************************************************31840000
       3380-GET-CUR-DATE.                                               31850000
           EXEC CICS                                                    31860000
               ASKTIME ABSTIME (PV-ABSTIME)                             31870000
           END-EXEC.                                                    31880000
                                                                        31890000
           EXEC CICS                                                    31900000
               FORMATTIME ABSTIME  (PV-ABSTIME)                         31910000
                          MMDDYY   (SD-MMDDYY-FORMAT)                   31920000
                          DATESEP                                       31930000
           END-EXEC.                                                    31940000
                                                                        31950000
           MOVE SD-SYSTEM-MONTH           TO  PV-CURRENT-MONTH.         31960000
           MOVE SD-SYSTEM-DAY             TO  PV-CURRENT-DAY.           31970000
           MOVE SD-SYSTEM-YEAR            TO  PV-CURRENT-YEAR.          31980000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              31990000
                                                                        32000000
           MOVE PV-CURRENT-DATE              TO  DPG51-SYSTEM-DATE.     32010000
           SET  DPG51-ACTUAL-CALENDAR-ONLY                              32020000
                DPG51-DO-NOT-INCR-DECR-DATE                             32030000
                DPG52-LK-DTE-GREG          TO TRUE.                     32040000
                                                                        32050000
           MOVE PV-CURRENT-MONTH           TO  PV-GD-MONTH.             32060000
           MOVE PV-CURRENT-DAY             TO  PV-GD-DAY.               32070000
           MOVE PV-CURRENT-YEAR            TO  PV-GD-YEAR.              32080000
           MOVE PV-GREGORIAN-DATE          TO  DPG52-LK-DATE-INPUT.     32090000
                                                                        32100000
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING                      32110000
                     DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               32120000
                                                                        32130000
           EVALUATE TRUE                                                32140000
               WHEN DPG54-NO-ERROR                                      32150000
                   MOVE DPG55-DB2-ISO-DATE-FMT TO PV-CURRENT-ISO-DATE   32160000
               WHEN OTHER                                               32170000
                   MOVE '3380-GET-CUR-DATE'  TO DP013-PARAGRAPH         32180000
                   MOVE 'GET THE CURRENT DATE'                          32190000
                                             TO DP013-MESSAGE-TEXT (1)  32200000
                   MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (2)  32210000
                   SET DP013-OTHER-ABEND     TO TRUE                    32220000
                   PERFORM DP013-0000-PROCESS-ABEND                     32230000
           END-EVALUATE.                                                32240000
      *                                                                 32250000
      ******************************************************************32260000
      **  COMPARE DATES IN THE VALIDATE STORE PROCESS                   32270000
      ******************************************************************32280000
       3390-COMPARE-DATES.                                              32290000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              32300000
                                                                        32310000
           MOVE PV-CURRENT-DATE              TO  DPG51-SYSTEM-DATE.     32320000
           SET  DPG51-ACTUAL-CALENDAR-ONLY                              32330000
                DPG51-DO-NOT-INCR-DECR-DATE                             32340000
                DPG52-LK-DTE-GREG                                       32350000
                DPG53-LK-CMPR-DTE-GREG     TO  TRUE.                    32360000
                                                                        32370000
           MOVE PV-CURRENT-MONTH           TO  PV-GD-MONTH.             32380000
           MOVE PV-CURRENT-DAY             TO  PV-GD-DAY.               32390000
           MOVE PV-CURRENT-YEAR            TO  PV-GD-YEAR.              32400000
           MOVE PV-GREGORIAN-DATE          TO  DPG52-LK-DATE-INPUT.     32410000
                                                                        32420000
100404     MOVE XST00001-CLO-DTE           TO  PV-CLOSED-DATE.          32430000
           MOVE PV-CLOSED-MONTH            TO  PV-GD-MONTH.             32440000
           MOVE PV-CLOSED-DAY              TO  PV-GD-DAY.               32450000
           MOVE PV-CLOSED-YEAR             TO  PV-GD-YEAR.              32460000
           MOVE PV-GREGORIAN-DATE          TO  DPG53-LK-CMPR-DATE-INPUT.32470000
                                                                        32480000
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING                      32490000
                     DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               32500000
                                                                        32510000
           EVALUATE TRUE                                                32520000
               WHEN DPG54-NO-ERROR                                      32530000
                   CONTINUE                                             32540000
               WHEN OTHER                                               32550000
                   MOVE '3390-COMPARE-DATES' TO DP013-PARAGRAPH         32560000
                   MOVE 'COMPARE THE STORE CLOSING DATE TO THE CURRENT D32570000
      -                 'ATE'                TO DP013-MESSAGE-TEXT (1)  32580000
                   MOVE DPG51-SYSTEM-DATE    TO DP013-MESSAGE-TEXT (2)  32590000
                   MOVE DPG53-LK-CMPR-DATE-INPUT                        32600000
                                             TO DP013-MESSAGE-TEXT (3)  32610000
                   MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (4)  32620000
                   SET DP013-OTHER-ABEND     TO TRUE                    32630000
                   PERFORM DP013-0000-PROCESS-ABEND                     32640000
           END-EVALUATE.                                                32650000
      *                                                                 32660000
      ******************************************************************32670000
      ** EDIT THE RETAIL TRANSFER DETAIL INFORMATION.                 **32680000
      ******************************************************************32690000
       3400-EDIT-RTL-DETAIL-INFO.                                       32700000
           SET ASC-VALID-CALLBACK-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)      32710000
               PS-INVALID-DEPT-CL                                       32720000
               PS-FOUND-DUMMY-UPC-N                                     32730000
               PS-INVALID-UPC               TO TRUE                     32740000
                                                                        32750000
C83797******* IF PRICE VALUE ENTERED IS ZERO**********************      32760000
C83797     IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROES             32770000
C83797             MOVE DP015-RED       TO MR-I-PRICE-C(ASC-ITEM-SUB)   32780000
C83797             MOVE DP015-REVERSE   TO MR-I-PRICE-H(ASC-ITEM-SUB)   32790000
C83797             MOVE PC-TSYMSG-00342 TO DP020-MSG-NUMBER             32800000
C83797             SET DP020-MSG-FATAL  TO TRUE                         32810000
C83797             MOVE -1              TO MR-I-PRICE-L(ASC-ITEM-SUB)   32820000
C83797             SET DP030-SET-CURSOR-APPL-4 TO TRUE                  32830000
C83797             SET ASC-ERROR               TO TRUE                  32840000
C83797     END-IF.                                                      32850000
C83797                                                                  32860000
                                                                        32870000
           IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES               32880000
             EVALUATE TRUE                                              32890000
               WHEN ASC-UPC-DIGITS-9-13 (ASC-BLK-SUB ASC-ITEM-SUB)      32900000
                                                       = SPACES         32910000
                   MOVE ASC-UPC-DIGITS-1-8 (ASC-BLK-SUB ASC-ITEM-SUB)   32920000
                             TO PV-CHECK-DUMMY-SKU-DEPT-CL              32930000
                                DP040I-SKU-NUMBER                       32940000
P11870             PERFORM 3437-CHECK-APPLE-WATCHES                     32950000
P11870             PERFORM 3438-CHECK-PREMIUM-SUNGLASSES                32960000
070111             MOVE PV-DUMMY-SKU-DEPT TO XST00015-DEPT-NBR          32970000
070111             PERFORM 3435-CHECK-JEWELRY-DEPT                      32980000
111703             PERFORM 3406-CHECK-FOR-MOS-RTV                       32990000
111703             IF PS-VALID-XFER                                     33000000
111703                 PERFORM 3410-PROCESS-DUMMY-SKU                   33010000
111703             END-IF                                               33020000
               WHEN ASC-UPC-DIGITS-1-5 (ASC-BLK-SUB ASC-ITEM-SUB)       33030000
                                                       = ZEROS          33040000
                   MOVE ASC-UPC-DIGITS-6-13 (ASC-BLK-SUB ASC-ITEM-SUB)  33050000
                             TO PV-CHECK-DUMMY-SKU-DEPT-CL              33060000
                                DP040I-SKU-NUMBER                       33070000
P11870             PERFORM 3437-CHECK-APPLE-WATCHES                     33080000
P11870             PERFORM 3438-CHECK-PREMIUM-SUNGLASSES                33090000
070111             MOVE PV-DUMMY-SKU-DEPT TO XST00015-DEPT-NBR          33100000
070111             PERFORM 3435-CHECK-JEWELRY-DEPT                      33110000
111703             PERFORM 3406-CHECK-FOR-MOS-RTV                       33120000
111703             IF PS-VALID-XFER                                     33130000
111703                 PERFORM 3410-PROCESS-DUMMY-SKU                   33140000
111703             END-IF                                               33150000
               WHEN OTHER                                               33160000
                   PERFORM 3405-FORMAT-UPC                              33170000
                   MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)            33180000
                                 TO PV-HOLD-UPC-NBR                     33190000
                   IF (PV-KOHLS-UPC-DIGITS = '0400')    AND             33200000
                      (PV-KOHLS-DUMMY-SKU-000 = '000')                  33210000
                       PERFORM 3905-VALIDATE-UPC-DEPT-CLASS             33220000
                       IF PS-INVALID-DEPT-CL                            33230000
                           MOVE DP015-RED                               33240000
                                 TO MR-I-UPC-C (ASC-ITEM-SUB)           33250000
                           MOVE DP015-REVERSE                           33260000
                                 TO MR-I-UPC-H (ASC-ITEM-SUB)           33270000
                           IF ASC-NO-ERROR                              33280000
                              MOVE PC-TSYMSG-00110                      33290000
                                     TO DP020-MSG-NUMBER                33300000
                              SET DP020-MSG-FATAL  TO TRUE              33310000
                              MOVE -1 TO MR-I-UPC-L (ASC-ITEM-SUB)      33320000
                              SET DP030-SET-CURSOR-APPL-4               33330000
                                  ASC-ERROR        TO TRUE              33340000
                           END-IF                                       33350000
                       ELSE                                             33360000
                           MOVE PV-KOHLS-DEPT      TO PV-HOLD-DEPT      33370000
                           MOVE DK-SUBCLASS-NBR    TO PV-KOHLS-CL-9     33380000
                           MOVE PV-KOHLS-CL        TO PV-HOLD-CL        33390000
                           MOVE PV-KOHLS-DUMMY-SKU-000                  33400000
                                          TO PV-HOLD-DUMMY-SKU-000      33410000
                           MOVE PV-HOLD-DUMMY-SKU-N                     33420000
                                          TO DP040I-SKU-NUMBER          33430000
P11870                     PERFORM 3437-CHECK-APPLE-WATCHES             33440000
P11870                     PERFORM 3438-CHECK-PREMIUM-SUNGLASSES        33450000
                           MOVE PV-HOLD-DEPT-N TO PV-DUMMY-SKU-DEPT     33460000
070111                                            XST00015-DEPT-NBR     33470000
070111                     PERFORM 3435-CHECK-JEWELRY-DEPT              33480000
111703                     PERFORM 3406-CHECK-FOR-MOS-RTV               33490000
111703                     IF PS-VALID-XFER                             33500000
111703                         PERFORM 3910-SELECT-DUMMY-UPC            33510000
111703                         PERFORM 3403-CHECK-UPC-SECURE-TOTE       33520000
111703                     END-IF                                       33530000
                       END-IF                                           33540000
                   ELSE                                                 33550000
111703                 EVALUATE ASC-XFER-TYPE                           33560000
111703                     WHEN PC-DEFECTIVE-DAMAGE-SORT1               33570000
111703                     WHEN PC-DEFECTIVE-DAMAGE-SORT2               33580000
111703                         PERFORM 3430-SELECT-DEPT-ENT-ID          33590000
111703                 END-EVALUATE                                     33600000
111703                 IF PS-VALID-XFER                                 33610000
111703                     PERFORM 3420-PROCESS-UPC                     33620000
111703                 END-IF                                           33630000
                   END-IF                                               33640000
             END-EVALUATE                                               33650000
           END-IF.                                                      33660000
                                                                        33670000
      *- IF A QTY OR PRICE IS ENTERED, THEN A UPC MUST BE ENTERED       33680000
           IF (ASC-RTL-QTY      (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR 33690000
               ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)           33700000
               IF  ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES          33710000
                   MOVE DP015-RED             TO MR-I-UPC-C             33720000
                                        (ASC-ITEM-SUB)                  33730000
                   MOVE DP015-REVERSE         TO MR-I-UPC-H             33740000
                                        (ASC-ITEM-SUB)                  33750000
      *            -- MUST ENTER UPC --                                 33760000
                   IF ASC-NO-ERROR                                      33770000
                       MOVE PC-TSYMSG-00413   TO DP020-MSG-NUMBER       33780000
                       SET DP020-MSG-FATAL    TO TRUE                   33790000
                       MOVE -1                TO MR-I-UPC-L             33800000
                                        (ASC-ITEM-SUB)                  33810000
                       SET DP030-SET-CURSOR-APPL-4                      33820000
                           ASC-ERROR          TO TRUE                   33830000
                   END-IF                                               33840000
              END-IF                                                    33850000
           END-IF.                                                      33860000
           IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES             33870000
               MOVE ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)                33880000
                                          TO DP010I-UNEDITED-FIELD      33890000
SR3403         MOVE +8                    TO DP010I-MAXIMUM-DIGITS      33900000
               MOVE +2                    TO DP010I-MAXIMUM-DECIMALS    33910000
               SET  DP010I-NEGATIVE-NOT-ALLOWED                         33920000
                                          TO TRUE                       33930000
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         33941002
                         USING DP010I-NUMERIC-EDIT-AREA                 33942002
               IF DP010I-ERROR-DETECTED                                 33950000
                   MOVE DP015-RED             TO MR-I-PRICE-C           33960000
                                        (ASC-ITEM-SUB)                  33970000
                   MOVE DP015-REVERSE         TO MR-I-PRICE-H           33980000
                                        (ASC-ITEM-SUB)                  33990000
                   IF ASC-NO-ERROR                                      34000000
                       MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER       34010000
                       SET DP020-MSG-FATAL    TO TRUE                   34020000
                       MOVE -1                TO MR-I-PRICE-L           34030000
                                        (ASC-ITEM-SUB)                  34040000
                       SET DP030-SET-CURSOR-APPL-4                      34050000
                           ASC-ERROR          TO TRUE                   34060000
                   END-IF                                               34070000
               ELSE                                                     34080000
      *- USER MAY ENTER THE PRICE WITH OR WITHOUT A DECIMAL POINT       34090000
      *- IF ENTERED WITHOUT A DECIMAL POINT, 2 DECIMAL POSITIONS ARE    34100000
      *- ASSUMED.                                                       34110000
                   MOVE DP010I-NUMERIC-FIELD      TO PV-EDIT-PRICE      34120000
                   IF DP010I-DECIMAL-POINT-FOUND                        34130000
                       MOVE PV-EDIT-PRICE         TO ASC-PRICE-N        34140000
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     34150000
                   ELSE                                                 34160000
                       MOVE PV-EDIT-PRICE-4-DEC   TO ASC-PRICE-N        34170000
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     34180000
                   END-IF                                               34190000
                   IF (PS-VALID-UPC)                                    34200000
                       PERFORM 4600-VALIDATE-PRICE                      34210000
                   END-IF                                               34220000
               END-IF                                                   34230000
           ELSE                                                         34240000
      *- IF UPC OR QTY WAS ENTERED, PRICE IS REQUIRED                   34250000
               IF (ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR    34260000
                   ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)     34270000
                   SET DP020-MSG-FATAL    TO TRUE                       34280000
                   MOVE DP015-RED             TO MR-I-PRICE-C           34290000
                                        (ASC-ITEM-SUB)                  34300000
                   MOVE DP015-REVERSE         TO MR-I-PRICE-H           34310000
                                        (ASC-ITEM-SUB)                  34320000
      *            -- REQUIRED FIELD --                                 34330000
                   IF ASC-NO-ERROR                                      34340000
                       MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER       34350000
                       SET DP020-MSG-FATAL    TO TRUE                   34360000
                       MOVE -1                TO MR-I-PRICE-L           34370000
                                        (ASC-ITEM-SUB)                  34380000
                       SET DP030-SET-CURSOR-APPL-4                      34390000
                           ASC-ERROR          TO TRUE                   34400000
                   END-IF                                               34410000
               END-IF                                                   34420000
           END-IF.                                                      34430000
           IF ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES           34440000
      *- USE ENTERED QTY AS AN INDICATOR OF THE NUMBER OF LINES ENTERED 34450000
               ADD +1                    TO ASC-NBR-OF-LINES-ENTERED    34460000
               MOVE ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              34470000
                                          TO DP010I-UNEDITED-FIELD      34480000
               MOVE +3                    TO DP010I-MAXIMUM-DIGITS      34490000
               MOVE +0                    TO DP010I-MAXIMUM-DECIMALS    34500000
               SET  DP010I-NEGATIVE-NOT-ALLOWED                         34510000
                                          TO TRUE                       34520000
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         34531002
                         USING DP010I-NUMERIC-EDIT-AREA                 34532002
               IF DP010I-ERROR-DETECTED OR DP010I-DECIMAL-POINT-FOUND   34540000
      *        -- MUST BE NUMERIC --                                    34550000
                   SET DP020-MSG-FATAL    TO TRUE                       34560000
                   MOVE DP015-RED             TO MR-I-QTY-C             34570000
                                        (ASC-ITEM-SUB)                  34580000
                   MOVE DP015-REVERSE         TO MR-I-QTY-H             34590000
                                        (ASC-ITEM-SUB)                  34600000
                   IF ASC-NO-ERROR                                      34610000
                       MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER       34620000
                       SET DP020-MSG-FATAL    TO TRUE                   34630000
                       MOVE -1                TO MR-I-QTY-L             34640000
                                        (ASC-ITEM-SUB)                  34650000
                       SET DP030-SET-CURSOR-APPL-4                      34660000
                           ASC-ERROR          TO TRUE                   34670000
                   END-IF                                               34680000
               ELSE                                                     34690000
                   MOVE DP010I-NUMERIC-FIELD  TO PV-QUANTITY            34700000
                   MOVE PV-QUANTITY           TO                        34710000
                              ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    34720000
                   IF DP010I-NUMERIC-FIELD = 0                          34730000
                       SET DP020-MSG-FATAL    TO TRUE                   34740000
      *            -- MUST BE GREATER THAN ZERO --                      34750000
                       MOVE DP015-RED             TO MR-I-QTY-C         34760000
                                        (ASC-ITEM-SUB)                  34770000
                       MOVE DP015-REVERSE         TO MR-I-QTY-H         34780000
                                        (ASC-ITEM-SUB)                  34790000
                       IF ASC-NO-ERROR                                  34800000
                           MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER   34810000
                           SET DP020-MSG-FATAL    TO TRUE               34820000
                           MOVE -1                TO MR-I-QTY-L         34830000
                                        (ASC-ITEM-SUB)                  34840000
                           SET DP030-SET-CURSOR-APPL-4                  34850000
                               ASC-ERROR          TO TRUE               34860000
                       END-IF                                           34870000
                   END-IF                                               34880000
               END-IF                                                   34890000
      *- IF UPC OR PRICE WAS ENTERED, QTY IS REQUIRED                   34900000
           ELSE                                                         34910000
               IF (ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR    34920000
                   ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)       34930000
                   SET DP020-MSG-FATAL    TO TRUE                       34940000
                   MOVE DP015-RED             TO MR-I-QTY-C             34950000
                                        (ASC-ITEM-SUB)                  34960000
                   MOVE DP015-REVERSE         TO MR-I-QTY-H             34970000
                                        (ASC-ITEM-SUB)                  34980000
      *            -- REQUIRED FIELD --                                 34990000
                   IF ASC-NO-ERROR                                      35000000
                       MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER       35010000
                       SET DP020-MSG-FATAL    TO TRUE                   35020000
                       MOVE -1                TO MR-I-QTY-L             35030000
                                        (ASC-ITEM-SUB)                  35040000
                       SET DP030-SET-CURSOR-APPL-4                      35050000
                           ASC-ERROR          TO TRUE                   35060000
                   END-IF                                               35070000
               END-IF                                                   35080000
           END-IF.                                                      35090000
                                                                        35100000
      ******************************************************************35110000
      ** CHECK IF SKU MUST BE IN SECURE TOTE                          **35120000
      ******************************************************************35130000
       3402-CHECK-SKU-SECURE-TOTE.                                      35140000
070111     IF PS-DEPT-FOUND                                             35150000
               EVALUATE TRUE                                            35160000
                   WHEN ASC-CONTNR-TYPE = PC-SECURE-TOTE                35170000
                       CONTINUE                                         35180000
                   WHEN OTHER                                           35190000
                       MOVE DP015-RED                 TO MR-I-UPC-C     35200000
                                                (ASC-ITEM-SUB)          35210000
                       MOVE DP015-REVERSE             TO MR-I-UPC-H     35220000
                                                (ASC-ITEM-SUB)          35230000
                       IF ASC-NO-ERROR                                  35240000
                         MOVE PC-TSYMSG-01544       TO DP020-MSG-NUMBER 35250000
                           SET DP020-MSG-FATAL        TO TRUE           35260000
                           MOVE -1                    TO MR-I-UPC-L     35270000
                                                (ASC-ITEM-SUB)          35280000
                         SET DP030-SET-CURSOR-APPL-4                    35290000
                             ASC-ERROR              TO TRUE             35300000
                       END-IF                                           35310000
               END-EVALUATE                                             35320000
           END-IF.                                                      35330000
                                                                        35340000
      ******************************************************************35350000
      ** CHECK IF UPC MUST BE IN SECURE TOTE                          **35360000
      ******************************************************************35370000
       3403-CHECK-UPC-SECURE-TOTE.                                      35380000
070111     IF PS-DEPT-FOUND                                             35390000
               EVALUATE TRUE                                            35400000
                   WHEN ASC-CONTNR-TYPE = PC-SECURE-TOTE                35410000
                   WHEN ASC-CONTNR-TYPE = PC-HAND-CARRY        AND      35420000
                        PS-SECURE-HAND-CARRY-OK                         35430000
                       CONTINUE                                         35440000
                   WHEN OTHER                                           35450000
                       MOVE DP015-RED                 TO MR-I-UPC-C     35460000
                                                (ASC-ITEM-SUB)          35470000
                       MOVE DP015-REVERSE             TO MR-I-UPC-H     35480000
                                                (ASC-ITEM-SUB)          35490000
                       IF ASC-NO-ERROR                                  35500000
                         MOVE PC-TSYMSG-01544       TO DP020-MSG-NUMBER 35510000
                           SET DP020-MSG-FATAL        TO TRUE           35520000
                           MOVE -1                    TO MR-I-UPC-L     35530000
                                                (ASC-ITEM-SUB)          35540000
                         SET DP030-SET-CURSOR-APPL-4                    35550000
                             ASC-ERROR              TO TRUE             35560000
                       END-IF                                           35570000
               END-EVALUATE                                             35580000
           END-IF.                                                      35590000
                                                                        35600000
                                                                        35610000
      ******************************************************************35620000
      ** FORMAT UPC TO CHECK FOR KOHLS                                **35630000
      ******************************************************************35640000
       3405-FORMAT-UPC.                                                 35650000
           MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                      35660000
                                      TO DP010I-UNEDITED-FIELD          35670000
           MOVE +13                       TO DP010I-MAXIMUM-DIGITS      35680000
           MOVE +0                        TO DP010I-MAXIMUM-DECIMALS    35690000
           SET      DP010I-NEGATIVE-NOT-ALLOWED                         35700000
                                      TO TRUE                           35710000
           CALL DP010I-NUMERIC-EDIT-ROUTINE                             35720002
                      USING DP010I-NUMERIC-EDIT-AREA                    35721002
           IF DP010I-ERROR-DETECTED                                     35730000
               MOVE DP015-RED                 TO MR-I-UPC-C             35740000
                                    (ASC-ITEM-SUB)                      35750000
               MOVE DP015-REVERSE             TO MR-I-UPC-H             35760000
                                    (ASC-ITEM-SUB)                      35770000
               IF ASC-NO-ERROR                                          35780000
                   MOVE PC-TSYMSG-00342       TO DP020-MSG-NUMBER       35790000
                   SET DP020-MSG-FATAL        TO TRUE                   35800000
                   MOVE -1                    TO MR-I-UPC-L             35810000
                                    (ASC-ITEM-SUB)                      35820000
                   SET DP030-SET-CURSOR-APPL-4                          35830000
                       ASC-ERROR              TO TRUE                   35840000
               END-IF                                                   35850000
           ELSE                                                         35860000
               MOVE DP010I-NUM-FIELD-13-DIG-4-DEC                       35870000
                   TO ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)              35880000
                      DK-UPC-NBR                                        35890000
           END-IF.                                                      35900000
                                                                        35910000
111703***************************************************************** 35920000
111703*  REJECT SKU 000 OR DUMMY UPC FOR SORT1 XFER TYPE.               35930000
111703*  REJECT SKU 000 OR DUMMY UPC FOR SORT2 XFER TYPE                35940000
070111*        WHEN JEWELRY DEPT (FOUND ON XST_DEPT) AND                35950000
P11870*        WHEN UPC IS FOR PREMIUM SUNGLASSES (DEPT 431) AND        35960000
P11870*        WHEN UPC IS FOR APPLE WATCHES (DEPT 030).                35970000
111703***************************************************************** 35980000
111703 3406-CHECK-FOR-MOS-RTV.                                          35990000
111703     EVALUATE TRUE                                                36000000
111703         WHEN ASC-XFER-TYPE = PC-DEFECTIVE-DAMAGE-SORT1           36010000
111703             MOVE DP015-RED     TO MR-I-UPC-C (ASC-ITEM-SUB)      36020000
111703             MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)      36030000
111703             SET PS-INVALID-XFER TO TRUE                          36040000
111703             IF ASC-NO-ERROR                                      36050000
111703                 MOVE PC-TSYMSG-03200  TO DP020-MSG-NUMBER        36060000
111703                 SET DP020-MSG-FATAL   TO TRUE                    36070000
111703                 MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)      36080000
111703                 SET DP030-SET-CURSOR-APPL-4                      36090000
111703                     ASC-ERROR         TO TRUE                    36100000
111703             END-IF                                               36110000
070111         WHEN (ASC-XFER-TYPE = PC-DEFECTIVE-DAMAGE-SORT2)         36120000
070111             IF PS-DEPT-FOUND                                     36130000
111703                MOVE DP015-RED     TO MR-I-UPC-C (ASC-ITEM-SUB)   36140000
111703                MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)   36150000
111703                SET PS-INVALID-XFER TO TRUE                       36160000
111703                IF ASC-NO-ERROR                                   36170000
P11870                   MOVE PC-TSYMSG-03795  TO DP020-MSG-NUMBER      36180000
111703                   SET DP020-MSG-FATAL   TO TRUE                  36190000
111703                   MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)    36200000
111703                   SET DP030-SET-CURSOR-APPL-4                    36210000
111703                       ASC-ERROR         TO TRUE                  36220000
111703                END-IF                                            36230000
070111             END-IF                                               36240000
111703     END-EVALUATE.                                                36250000
                                                                        36260000
                                                                        36270000
      ******************************************************************36280000
      ** VALIDATE DEPT AND CLASS FOR DUMMY SKU                        **36290000
      ** GET DUMMY UPC FROM DUMMY SKU                                   36300000
      ******************************************************************36310000
       3410-PROCESS-DUMMY-SKU.                                          36320000
           MOVE ZERO TO ASC-ITEM-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         36330000
           PERFORM 3900-VALIDATE-SKU-DEPT-CLASS                         36340000
           IF PS-INVALID-DEPT-CL                                        36350000
               MOVE DP015-RED     TO MR-I-UPC-C (ASC-ITEM-SUB)          36360000
               MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)          36370000
               IF ASC-NO-ERROR                                          36380000
                   MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER             36390000
                   SET DP020-MSG-FATAL  TO TRUE                         36400000
                   MOVE -1              TO MR-I-UPC-L (ASC-ITEM-SUB)    36410000
                   SET DP030-SET-CURSOR-APPL-4                          36420000
                       ASC-ERROR        TO TRUE                         36430000
               END-IF                                                   36440000
           ELSE                                                         36450000
               PERFORM 3910-SELECT-DUMMY-UPC                            36460000
               IF PS-FOUND-DUMMY-UPC-N                                  36470000
                   MOVE DP015-RED     TO MR-I-UPC-C (ASC-ITEM-SUB)      36480000
                   MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)      36490000
                   IF ASC-NO-ERROR                                      36500000
                       MOVE PC-DUMMY-SKU-CONVERSION-MSG                 36510000
                                             TO DP020-MSG-TEXT          36520000
                       SET DP020-MSG-FATAL   TO TRUE                    36530000
                       MOVE -1            TO MR-I-UPC-L (ASC-ITEM-SUB)  36540000
                       SET DP030-SET-CURSOR-APPL-4                      36550000
                           ASC-ERROR         TO TRUE                    36560000
                   END-IF                                               36570000
               ELSE                                                     36580000
                   PERFORM 3402-CHECK-SKU-SECURE-TOTE                   36590000
               END-IF                                                   36600000
           END-IF.                                                      36610000
                                                                        36620000
      ******************************************************************36630000
      ** CHECK IF DUMMY UPC                                           **36640000
      ******************************************************************36650000
       3415-CHECK-IF-DUMMY-UPC.                                         36660000
           INITIALIZE DP040I-UPC-CHECK-DIGIT-PARMS.                     36670000
           MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)                    36680000
                             TO DP040I-UPC-CODE.                        36690000
           SET DP040I-EXTRACT-SKU-FROM-UPC TO TRUE.                     36700000
                                                                        36710000
           CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          36720006
                           USING DP040I-UPC-CHECK-DIGIT-PARMS           36721006
                                                                        36730000
           IF DP040I-UPC-NOT-DUMMY-UPC                                  36740000
               SET PS-FOUND-DUMMY-UPC-N TO TRUE                         36750000
           ELSE                                                         36760000
               SET PS-FOUND-DUMMY-UPC-Y TO TRUE                         36770000
           END-IF.                                                      36780000
                                                                        36790000
                                                                        36800000
      ******************************************************************36810000
      ** VALIDATE UPC, CHECK IF JEWELRY DEPT AND SECURE TOTE          **36820000
      ******************************************************************36830000
       3420-PROCESS-UPC.                                                36840000
           MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                      36850000
                                      TO DP010I-UNEDITED-FIELD          36860000
           MOVE +13                       TO DP010I-MAXIMUM-DIGITS      36870000
           MOVE +0                        TO DP010I-MAXIMUM-DECIMALS    36880000
           SET      DP010I-NEGATIVE-NOT-ALLOWED                         36890000
                                      TO TRUE                           36900000
           CALL DP010I-NUMERIC-EDIT-ROUTINE                             36911003
                         USING DP010I-NUMERIC-EDIT-AREA                 36912003
           IF DP010I-ERROR-DETECTED                                     36920000
               MOVE DP015-RED                 TO MR-I-UPC-C             36930000
                                    (ASC-ITEM-SUB)                      36940000
               MOVE DP015-REVERSE             TO MR-I-UPC-H             36950000
                                    (ASC-ITEM-SUB)                      36960000
               IF ASC-NO-ERROR                                          36970000
                   MOVE PC-TSYMSG-00342       TO DP020-MSG-NUMBER       36980000
                   SET DP020-MSG-FATAL        TO TRUE                   36990000
                   MOVE -1                    TO MR-I-UPC-L             37000000
                                    (ASC-ITEM-SUB)                      37010000
                   SET DP030-SET-CURSOR-APPL-4                          37020000
                       ASC-ERROR              TO TRUE                   37030000
               END-IF                                                   37040000
           ELSE                                                         37050000
               MOVE DP010I-NUM-FIELD-13-DIG-4-DEC                       37060000
                                          TO DK-UPC-NBR                 37070000
                                             ASC-UPC-N                  37080000
                                    (ASC-BLK-SUB ASC-ITEM-SUB)          37090000
                                                                        37100000
               PERFORM 3700-SELECT-UPC-NBR                              37110000
               IF PS-INVALID-UPC                                        37120000
                   MOVE DP015-RED               TO MR-I-UPC-C           37130000
                                    (ASC-ITEM-SUB)                      37140000
                   MOVE DP015-REVERSE           TO MR-I-UPC-H           37150000
                                    (ASC-ITEM-SUB)                      37160000
                   IF ASC-NO-ERROR                                      37170000
                       MOVE PC-TSYMSG-00100 TO DP020-MSG-NUMBER         37180000
                       SET DP020-MSG-FATAL      TO TRUE                 37190000
                       MOVE -1                  TO MR-I-UPC-L           37200000
                                    (ASC-ITEM-SUB)                      37210000
                       SET DP030-SET-CURSOR-APPL-4                      37220000
                           ASC-ERROR            TO TRUE                 37230000
                   END-IF                                               37240000
               ELSE                                                     37250000
P11870             IF PS-BLOCK-SUNGLASS-WATCHES                         37260000
P11870                 MOVE DP015-RED TO MR-I-UPC-C (ASC-ITEM-SUB)      37270000
P11870                 MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)  37280000
P11870                 SET PS-INVALID-XFER TO TRUE                      37290000
P11870                 MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER         37300000
P11870                 SET DP020-MSG-FATAL   TO TRUE                    37310000
P11870                 MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)      37320000
P11870                 SET DP030-SET-CURSOR-APPL-4                      37330000
P11870                     ASC-ERROR         TO TRUE                    37331000
P11870             ELSE                                                 37332000
070111                 MOVE SKXREF-DEPT     TO XST00015-DEPT-NBR        37333000
070111                 PERFORM 3435-CHECK-JEWELRY-DEPT                  37334000
                       PERFORM 3403-CHECK-UPC-SECURE-TOTE               37335000
P11870             END-IF                                               37336000
               END-IF                                                   37337000
           END-IF.                                                      37338000
                                                                        37339000
111703**************************************************************    37340000
111703* DEFECTIVE/DAMAGE SORT1 TRANSFERS CAN HAVE ONLY SORT1 ITEMS      37350000
111703* DEFECTIVE/DAMAGE SORT2 TRANSFERS CAN HAVE ONLY SORT2 ITEMS      37360000
111703**************************************************************    37370000
111703 3430-SELECT-DEPT-ENT-ID.                                         37380000
111703     INITIALIZE DCLXST00013.                                      37390000
                                                                        37400000
111703     EXEC SQL                                                     37410000
111703         SELECT  C.DEPT_NBR                                       37420000
111703                ,C.ENT_ID                                         37430000
P11870                ,C.MAJ_CL_NBR                                     37440000
P11870                ,C.SUB_CL_NBR                                     37450000
111703           INTO  :XST00013-DEPT-NBR                               37460000
111703                ,:XST00013-ENT-ID                                 37470000
P11870                ,:XST00013-MAJ-CL-NBR                             37480000
P11870                ,:XST00013-SUB-CL-NBR                             37490000
111703           FROM  XST_UPC        A                                 37500000
111703                ,XST_SKU        B                                 37510000
111703                ,XST_VND_STYL   C                                 37520000
111703          WHERE A.UPC_NBR        = :DK-UPC-NBR                    37530000
111703            AND A.LAST_ACTN_CDE IN  ('A', 'U')                    37540000
111703            AND A.INTR_UPC_ID    = B.INTR_UPC_ID                  37550000
111703            AND B.STYL_ID        = C.STYL_ID                      37560000
111703     END-EXEC.                                                    37570000
                                                                        37580000
111703     EVALUATE TRUE                                                37590000
111703         WHEN SQLCODE = ZERO                                      37600000
P11870             MOVE XST00013-DEPT-NBR   TO PV-DEPT-NBR              37610000
P11870             MOVE XST00013-MAJ-CL-NBR TO PV-MAJ-CL-NBR            37620000
P11870             MOVE XST00013-SUB-CL-NBR TO PV-SUB-CL-NBR            37621000
P11870* PREMIUM SUNGLASSES                                              37621100
P11870             IF PV-DEPT-NBR = 431 OR                              37621200
P11870* APPLE WATCHES                                                   37621300
P11870               (PV-DEPT-NBR = 30 AND                              37621400
P11870                PV-MAJ-CL-NBR = 10 AND                            37621500
P11870               (PV-SUB-CL-NBR = 11 OR                             37621600
P11870                PV-SUB-CL-NBR = 12))                              37621700
P11870                 SET PS-BLOCK-SUNGLASS-WATCHES TO TRUE            37621800
P11870             END-IF                                               37621900
111703             PERFORM 3432-SELECT-DC-RET-CDE                       37622000
111703         WHEN SQLCODE = +100                                      37623000
111703             SET PS-INVALID-XFER TO TRUE                          37624000
111703             MOVE DP015-RED               TO MR-I-UPC-C           37625000
111703                              (ASC-ITEM-SUB)                      37626000
111703             MOVE DP015-REVERSE           TO MR-I-UPC-H           37627000
111703                              (ASC-ITEM-SUB)                      37628000
111703             IF ASC-NO-ERROR                                      37629000
111703                 MOVE PC-TSYMSG-00100 TO DP020-MSG-NUMBER         37630000
111703                 SET DP020-MSG-FATAL      TO TRUE                 37640000
111703                 MOVE -1                  TO MR-I-UPC-L           37650000
111703                              (ASC-ITEM-SUB)                      37660000
111703                 SET DP030-SET-CURSOR-APPL-4                      37670000
111703                     ASC-ERROR            TO TRUE                 37680000
111703             END-IF                                               37690000
111703         WHEN OTHER                                               37700000
111703                 MOVE '3430-SELECT-DEPT-ENT-ID'                   37710000
111703                                     TO DP013-PARAGRAPH           37720000
111703                 MOVE 'SELECT DEPT ENT ID'                        37730000
111703                                     TO DP013-MESSAGE-TEXT (1)    37740000
111703                 MOVE SQLCA          TO DP013-SQLCA               37750000
111703                 MOVE 'XST_UPC'      TO DP013-DB2-TABLE-NAME (1)  37760000
111703                 MOVE 'XST_SKU'      TO DP013-DB2-TABLE-NAME (2)  37770000
111703                 MOVE 'XST_VND_STYL' TO DP013-DB2-TABLE-NAME (3)  37780000
111703                 SET DP013-DB2-ABEND TO TRUE                      37790000
111703                 PERFORM DP013-0000-PROCESS-ABEND                 37800000
111703     END-EVALUATE.                                                37810000
                                                                        37820000
111703**************************************************************    37830000
111703* GET THE DC RETURN CODE                                          37840000
111703**************************************************************    37850000
111703 3432-SELECT-DC-RET-CDE.                                          37860000
111703     INITIALIZE DCLXST00017.                                      37870000
                                                                        37880000
111703     EXEC SQL                                                     37890000
111703         SELECT  DC_RET_CDE                                       37900000
111703           INTO  :XST00017-DC-RET-CDE                             37910000
111703           FROM  XST_VND_DEPT                                     37920000
111703          WHERE   ENT_ID    =  :XST00013-ENT-ID                   37930000
111703            AND   DEPT_NBR  =  :XST00013-DEPT-NBR                 37940000
111703     END-EXEC.                                                    37950000
                                                                        37960000
111703     EVALUATE TRUE                                                37970000
111703         WHEN SQLCODE = ZERO                                      37980000
111703             PERFORM 3434-EVALUATE-DC-RET-CDE                     37990000
111703         WHEN SQLCODE = +100                                      38000000
111703             MOVE SPACES TO XST00017-DC-RET-CDE                   38010000
111703             PERFORM 3434-EVALUATE-DC-RET-CDE                     38020000
111703         WHEN OTHER                                               38030000
111703                 MOVE '3432-SELECT-DC-RET-CDE'                    38040000
111703                                     TO DP013-PARAGRAPH           38050000
111703                 MOVE 'SELECT DC RTN CDE'                         38060000
111703                                     TO DP013-MESSAGE-TEXT (1)    38070000
111703                 MOVE SQLCA          TO DP013-SQLCA               38080000
111703                 MOVE 'XST_VND_DEPT' TO DP013-DB2-TABLE-NAME (1)  38090000
111703                 SET DP013-DB2-ABEND TO TRUE                      38100000
111703                 PERFORM DP013-0000-PROCESS-ABEND                 38110000
111703     END-EVALUATE.                                                38120000
                                                                        38130000
111703**************************************************************    38140000
111703* EVALUATE THE DC RETURN CODE AND PROCESS ACCORDING TO            38150000
111703* SORT1 OR SORT2 DEPENDING ON TRANSFER TYPE                       38160000
111703**************************************************************    38170000
111703 3434-EVALUATE-DC-RET-CDE.                                        38180000
111703     MOVE XST00017-DC-RET-CDE TO PC-VND-DC-RET-CDE.               38190000
                                                                        38200000
111703     EVALUATE ASC-XFER-TYPE                                       38210000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           38220000
111703             IF NOT PC-MOS-RET-CDE THEN                           38230000
111703                 MOVE DP015-RED TO MR-I-UPC-C (ASC-ITEM-SUB)      38240000
111703                 MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)  38250000
111703                 SET PS-INVALID-XFER TO TRUE                      38260000
111703                 IF ASC-NO-ERROR                                  38270000
P11870                   IF PS-BLOCK-SUNGLASS-WATCHES                   38280000
P11870                      MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER    38290000
P11870                      SET DP020-MSG-FATAL  TO TRUE                38300000
P11870                      MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB) 38310000
P11870                      SET DP030-SET-CURSOR-APPL-4                 38320000
P11870                          ASC-ERROR        TO TRUE                38330000
P11870                   ELSE                                           38340000
070111                     MOVE XST00013-DEPT-NBR TO XST00015-DEPT-NBR  38350000
070111                     PERFORM 3435-CHECK-JEWELRY-DEPT              38360000
070111                     IF PS-DEPT-FOUND                             38370000
P11870                       MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER   38380000
070111                     ELSE                                         38390000
070111                       MOVE PC-TSYMSG-03192 TO DP020-MSG-NUMBER   38400000
070111                     END-IF                                       38410000
111703                     SET DP020-MSG-FATAL   TO TRUE                38420000
111703                     MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)  38430000
111703                     SET DP030-SET-CURSOR-APPL-4                  38440000
111703                         ASC-ERROR         TO TRUE                38450000
P11870                   END-IF                                         38460000
111703                 END-IF                                           38470000
111703             END-IF                                               38480000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           38481000
120203             IF PC-NON-RTV-RET-CDE THEN                           38482000
111703                 MOVE DP015-RED TO MR-I-UPC-C (ASC-ITEM-SUB)      38483000
111703                 MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)  38484000
111703                 SET PS-INVALID-XFER TO TRUE                      38485000
111703                 IF ASC-NO-ERROR                                  38486000
P11870                   IF PS-BLOCK-SUNGLASS-WATCHES                   38487000
P11870                      MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER    38488000
P11870                      SET DP020-MSG-FATAL  TO TRUE                38489000
P11870                      MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB) 38490000
P11870                      SET DP030-SET-CURSOR-APPL-4                 38500000
P11870                          ASC-ERROR        TO TRUE                38510000
P11870                   ELSE                                           38520000
070111                     MOVE XST00013-DEPT-NBR TO XST00015-DEPT-NBR  38530000
070111                     PERFORM 3435-CHECK-JEWELRY-DEPT              38540000
070111                     IF PS-DEPT-FOUND                             38550000
P11870                       MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER   38560000
070111                     ELSE                                         38570000
070111                       MOVE PC-TSYMSG-03193 TO DP020-MSG-NUMBER   38580000
070111                     END-IF                                       38590000
111703                     SET DP020-MSG-FATAL   TO TRUE                38600000
111703                     MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)  38610000
111703                     SET DP030-SET-CURSOR-APPL-4                  38620000
111703                         ASC-ERROR         TO TRUE                38630000
P11870                   END-IF                                         38640000
111703                 END-IF                                           38650000
111703             END-IF                                               38660000
111703     END-EVALUATE.                                                38670000
                                                                        38680000
111703*************************************************************     38690000
070111*    CERTAIN DEPARTMENTS MUST BE CALLBACKS                        38700000
111703*************************************************************     38710000
111703     IF PS-VALID-XFER                                             38720000
111703       MOVE ASC-TO-STORE-NBR-N TO DK-TO-STR-NBR                   38730000
070111           PERFORM 3436-CHECK-RTV-LOC                             38740000
070111           IF PS-RTV-FOUND                                        38750000
P11870             IF PS-BLOCK-SUNGLASS-WATCHES                         38760000
P11870               MOVE DP015-RED TO MR-I-UPC-C (ASC-ITEM-SUB)        38770000
P11870               MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)    38771000
P11870               SET PS-INVALID-XFER TO TRUE                        38772000
P11870               IF ASC-NO-ERROR                                    38773000
P11870                  MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER        38774000
P11870                  SET DP020-MSG-FATAL   TO TRUE                   38775000
P11870                  MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)     38776000
P11870                  SET DP030-SET-CURSOR-APPL-4                     38777000
P11870                      ASC-ERROR         TO TRUE                   38778000
P11870               END-IF                                             38779000
P11870             ELSE                                                 38779100
070111               MOVE XST00013-DEPT-NBR TO XST00015-DEPT-NBR        38779200
070111               PERFORM 3435-CHECK-JEWELRY-DEPT                    38779300
070111               IF PS-DEPT-FOUND                                   38779400
111703                 MOVE DP015-RED TO MR-I-UPC-C (ASC-ITEM-SUB)      38779500
111703                 MOVE DP015-REVERSE TO MR-I-UPC-H (ASC-ITEM-SUB)  38779600
111703                 SET PS-INVALID-XFER TO TRUE                      38779700
111703                 IF ASC-NO-ERROR                                  38779800
P11870                     MOVE PC-TSYMSG-03795 TO DP020-MSG-NUMBER     38779900
111703                     SET DP020-MSG-FATAL   TO TRUE                38780000
111703                     MOVE -1        TO MR-I-UPC-L (ASC-ITEM-SUB)  38790000
111703                     SET DP030-SET-CURSOR-APPL-4                  38800000
111703                         ASC-ERROR         TO TRUE                38810000
111703                 END-IF                                           38820000
111703               END-IF                                             38830000
P11870             END-IF                                               38840000
111703           END-IF                                                 38850000
111703     END-IF.                                                      38860000
070111                                                                  38870000
070111                                                                  38880000
111703*************************************************************     38890000
070111*    CHECK IF DEPARTMENT IS A JEWELRY DEPT                        38900000
111703*************************************************************     38910000
070111 3435-CHECK-JEWELRY-DEPT.                                         38920000
070111     EXEC SQL                                                     38930000
070111         SELECT 1                                                 38940000
070111           INTO :PV-NUM-ROWS                                      38950000
070111           FROM XST_DEPT                                          38960000
070111          WHERE  DEPT_NBR = :XST00015-DEPT-NBR                    38970000
070111            AND  BUS_GP_NBR IN (53, 54, 55, 56)                   38980000
070111     END-EXEC                                                     38990000
                                                                        39000000
070111     EVALUATE TRUE                                                39010000
070111         WHEN SQLCODE = ZERO                                      39020000
070111             SET PS-DEPT-FOUND TO TRUE                            39030000
070111         WHEN SQLCODE = +100                                      39040000
070111             SET PS-DEPT-NOT-FOUND TO TRUE                        39050000
070111         WHEN OTHER                                               39060000
070111             MOVE '3435-CHECK-JEWELRY-DEPT'                       39070000
070111                                       TO DP013-PARAGRAPH         39080000
070111             MOVE XST00015-DEPT-NBR    TO DP013-MESSAGE-TEXT (1)  39090000
070111             MOVE SQLCA                TO DP013-SQLCA             39100000
070111             MOVE 'XST_DEPT'           TO DP013-DB2-TABLE-NAME (1)39110000
070111             SET DP013-DB2-ABEND       TO TRUE                    39120000
070111             PERFORM DP013-0000-PROCESS-ABEND                     39130000
070111     END-EVALUATE.                                                39140000
                                                                        39150000
070111******************************************************************39160000
070111** CHECK TO SEE IF THE TO-LOC IS A VALID RTV LOCATION           **39170000
070111******************************************************************39180000
                                                                        39190000
070111 3436-CHECK-RTV-LOC.                                              39200000
                                                                        39210000
070111     EXEC SQL                                                     39220000
070111        SELECT DISTINCT(A.RTV_LOC_NBR)                            39230000
070111            INTO :XST00135-RTV-LOC-NBR                            39240000
070111          FROM  XST_RTV_LOC_RLTNSHP A                             39250000
070111          WHERE RTV_LOC_NBR = :DK-TO-STR-NBR                      39260000
070111            AND A.EFF_BEG_DTE = (SELECT MAX(EFF_BEG_DTE)          39270000
070111                FROM  XST_RTV_LOC_RLTNSHP B                       39280000
070111                   WHERE A.RTV_LOC_NBR = B.RTV_LOC_NBR)           39290000
070111     END-EXEC.                                                    39300000
                                                                        39310000
070111     EVALUATE TRUE                                                39320000
070111         WHEN SQLCODE = ZERO                                      39330000
070111             SET PS-RTV-FOUND TO TRUE                             39340000
070111         WHEN SQLCODE = +100                                      39350000
070111             SET PS-RTV-NOT-FOUND TO TRUE                         39360000
070111         WHEN OTHER                                               39370000
070111            MOVE '3436-CHECK-RTV-LOC'                             39380000
070111                                    TO DP013-PARAGRAPH            39390000
070111            MOVE 'SELECT RTV LOC   '                              39400000
070111                                    TO DP013-MESSAGE-TEXT (1)     39410000
070111            MOVE SQLCA          TO DP013-SQLCA                    39420000
070111            MOVE 'XST_RTV_LOC_RLTNSHP' TO DP013-DB2-TABLE-NAME (1)39430000
070111            SET DP013-DB2-ABEND TO TRUE                           39440000
070111            PERFORM DP013-0000-PROCESS-ABEND                      39450000
070111     END-EVALUATE.                                                39460000
P11870                                                                  39470000
P11870******************************************************************39480000
P11870** CHECK TO SEE IF THEY ARE TRANSFERRING APPLE WATCHES          **39490000
P11870** AND BLOCK THEM.                                                39500000
P11870******************************************************************39510000
P11870                                                                  39520000
P11870 3437-CHECK-APPLE-WATCHES.                                        39530000
P11870                                                                  39531000
P11870     IF PV-DUMMY-SKU-DEPT = 30 AND                                39532000
P11870        PV-DUMMY-SKU-CL-9 = 10 AND                                39533000
P11870       (PV-DUMMY-SKU-000  = 11 OR                                 39534000
P11870        PV-DUMMY-SKU-000  = 12)                                   39535000
P11870            MOVE PC-TSYMSG-03795  TO DP020-MSG-NUMBER             39536000
P11870            MOVE DP015-RED        TO MR-I-UPC-C (ASC-ITEM-SUB)    39537000
P11870            MOVE DP015-REVERSE    TO MR-I-UPC-H (ASC-ITEM-SUB)    39538000
P11870            SET DP020-MSG-FATAL   TO TRUE                         39539000
P11870            MOVE -1               TO MR-I-UPC-L (ASC-ITEM-SUB)    39540000
P11870            SET DP030-SET-CURSOR-APPL-4                           39541000
P11870                ASC-ERROR         TO TRUE                         39541100
P11870     END-IF.                                                      39541200
P11870                                                                  39541300
P11870******************************************************************39541400
P11870** CHECK TO SEE IF THEY ARE TRANSFERRING PREMIUM SUNGLASSES     **39541500
P11870** AND BLOCK THEM.                                                39541600
P11870******************************************************************39541700
P11870                                                                  39541800
P11870 3438-CHECK-PREMIUM-SUNGLASSES.                                   39541900
P11870                                                                  39542000
P11870     IF PV-DUMMY-SKU-DEPT = 431                                   39542100
P11870         MOVE PC-TSYMSG-03795  TO DP020-MSG-NUMBER                39542200
P11870         SET DP020-MSG-FATAL   TO TRUE                            39542300
P11870         MOVE -1               TO MR-I-UPC-L (ASC-ITEM-SUB)       39542400
P11870         MOVE DP015-RED        TO MR-I-UPC-C (ASC-ITEM-SUB)       39542500
P11870         MOVE DP015-REVERSE    TO MR-I-UPC-H (ASC-ITEM-SUB)       39542600
P11870         SET DP030-SET-CURSOR-APPL-4                              39542700
P11870             ASC-ERROR         TO TRUE                            39542800
P11870     END-IF.                                                      39542900
P11870                                                                  39543000
      ******************************************************************39544000
      ** EDIT THE NON-RETAIL TRANSFER DETAIL INFORMATION.             **39545000
      ******************************************************************39546000
       3450-EDIT-NRTL-DETAIL-INFO.                                      39547000
      *- IF DEPT OR QTY OR FIXTURE WAS ENTERED, DESCRIPTION IS REQUIRED 39548000
           IF (ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR     39549000
               ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR     39550000
               ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)         39560000
               IF ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB) NOT > SPACES 39570000
                   SET DP020-MSG-FATAL    TO TRUE                       39580000
                   MOVE DP015-RED             TO MR-J-DESC-C            39590000
                                        (ASC-ITEM-SUB)                  39600000
                   MOVE DP015-REVERSE         TO MR-J-DESC-H            39610000
                                        (ASC-ITEM-SUB)                  39620000
      *            -- REQUIRED FIELD --                                 39630000
                   IF ASC-NO-ERROR                                      39640000
                       MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER       39650000
                       SET DP020-MSG-FATAL    TO TRUE                   39660000
                       MOVE -1                TO MR-J-DESC-L            39670000
                                        (ASC-ITEM-SUB)                  39680000
                       SET DP030-SET-CURSOR-APPL-4                      39690000
                           ASC-ERROR          TO TRUE                   39700000
                   END-IF                                               39710000
               END-IF                                                   39720000
           END-IF.                                                      39730000
           IF ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES          39740000
      *- USE ENTERED QTY AS AN INDICATOR OF THE NUMBER OF LINES ENTERED 39750000
               ADD +1                    TO ASC-NBR-OF-LINES-ENTERED    39760000
               MOVE ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)             39770000
                                          TO DP010I-UNEDITED-FIELD      39780000
               MOVE +3                    TO DP010I-MAXIMUM-DIGITS      39790000
               MOVE +0                    TO DP010I-MAXIMUM-DECIMALS    39800000
               SET  DP010I-NEGATIVE-NOT-ALLOWED                         39810000
                                          TO TRUE                       39820000
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         39831003
                         USING DP010I-NUMERIC-EDIT-AREA                 39832003
               IF DP010I-ERROR-DETECTED OR DP010I-DECIMAL-POINT-FOUND   39840000
      *        -- MUST BE NUMERIC --                                    39850000
                   SET DP020-MSG-FATAL    TO TRUE                       39860000
                   MOVE DP015-RED             TO MR-J-QTY-C             39870000
                                        (ASC-ITEM-SUB)                  39880000
                   MOVE DP015-REVERSE         TO MR-J-QTY-H             39890000
                                        (ASC-ITEM-SUB)                  39900000
                   IF ASC-NO-ERROR                                      39910000
                       MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER       39920000
                       SET DP020-MSG-FATAL    TO TRUE                   39930000
                       MOVE -1                TO MR-J-QTY-L             39940000
                                        (ASC-ITEM-SUB)                  39950000
                       SET DP030-SET-CURSOR-APPL-4                      39960000
                           ASC-ERROR          TO TRUE                   39970000
                   END-IF                                               39980000
               ELSE                                                     39990000
                   MOVE DP010I-NUMERIC-FIELD  TO PV-QUANTITY            40000000
                   MOVE PV-QUANTITY           TO                        40010000
                              ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   40020000
                   IF DP010I-NUMERIC-FIELD = 0                          40030000
                       SET DP020-MSG-FATAL    TO TRUE                   40040000
      *            -- MUST BE GREATER THAN ZERO --                      40050000
                       MOVE DP015-RED             TO MR-J-QTY-C         40060000
                                        (ASC-ITEM-SUB)                  40070000
                       MOVE DP015-REVERSE         TO MR-J-QTY-H         40080000
                                        (ASC-ITEM-SUB)                  40090000
                       IF ASC-NO-ERROR                                  40100000
                           MOVE PC-TSYMSG-00342   TO DP020-MSG-NUMBER   40110000
                           SET DP020-MSG-FATAL    TO TRUE               40120000
                           MOVE -1                TO MR-J-QTY-L         40130000
                                        (ASC-ITEM-SUB)                  40140000
                           SET DP030-SET-CURSOR-APPL-4                  40150000
                               ASC-ERROR          TO TRUE               40160000
                       END-IF                                           40170000
                   END-IF                                               40180000
               END-IF                                                   40190000
      *- IF DEPT OR DESCRIPTION OR FIXTURE WAS ENTERED, QTY IS REQUIRED 40200000
           ELSE                                                         40210000
               IF (ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 40220000
                   ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 40230000
                   ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)     40240000
                   SET DP020-MSG-FATAL    TO TRUE                       40250000
                   MOVE DP015-RED             TO MR-J-QTY-C             40260000
                                        (ASC-ITEM-SUB)                  40270000
                   MOVE DP015-REVERSE         TO MR-J-QTY-H             40280000
                                        (ASC-ITEM-SUB)                  40290000
      *            -- REQUIRED FIELD --                                 40300000
                   IF ASC-NO-ERROR                                      40310000
                       MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER       40320000
                       SET DP020-MSG-FATAL    TO TRUE                   40330000
                       MOVE -1                TO MR-J-QTY-L             40340000
                                        (ASC-ITEM-SUB)                  40350000
                       SET DP030-SET-CURSOR-APPL-4                      40360000
                           ASC-ERROR          TO TRUE                   40370000
                   END-IF                                               40380000
               END-IF                                                   40390000
           END-IF.                                                      40400000
      ******************************************************************40410000
      ** WALK THROUGH BOTH BLOCKS OF THE ARRAY AND CHECK FOR THE TOTAL *40420000
      ** ACCUMULATED QUANTITY FOR A SKU/PRICE COMBINATION - MAXIMUM    *40430000
      ** ALLOWABLE TOTAL IS 999.                                       *40440000
      ******************************************************************40450000
       3460-EDIT-RTL-QTY.                                               40460000
           IF PWT-QTY-NOT-CHECKED (PV-BLOCK PV-ITEM)                    40470000
               IF ASC-RTL-QTY (PV-BLOCK PV-ITEM) > SPACES               40480000
                   MOVE ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)                40490000
                                           TO PV-HOLD-QTY               40500000
                   SET PWT-QTY-CHECKED (PV-BLOCK PV-ITEM)               40510000
                                           TO TRUE                      40520000
                   PERFORM 3470-ACCUM-QTY                               40530000
                     VARYING PV-BLOCK2                                  40540000
                       FROM PV-BLOCK BY 1 UNTIL                         40550000
                             PV-BLOCK2 > PC-MAX-BLOCKS-IN-ARRAY         40560000
                     AFTER PV-ITEM2                                     40570000
                       FROM 1 BY 1                                      40580000
                         UNTIL PV-ITEM2 >  PC-ITEMS-PER-RTL-PANEL       40590000
                ELSE                                                    40600000
                   SET PWT-QTY-CHECKED (PV-BLOCK PV-ITEM)               40610000
                                           TO TRUE                      40620000
                END-IF                                                  40630000
           END-IF.                                                      40640000
      ******************************************************************40650000
      ** FOR THE SAME SKU/PRICE COMBINATION, ACCUMULATE TOTAL QTY.     *40660000
      ******************************************************************40670000
       3470-ACCUM-QTY.                                                  40680000
           IF PWT-QTY-NOT-CHECKED (PV-BLOCK2 PV-ITEM2)                  40690000
               IF ASC-RTL-QTY (PV-BLOCK2 PV-ITEM2) > SPACES             40700000
                   IF ASC-KOHLS-UPC-DIGITS (PV-BLOCK2 PV-ITEM2)         40710000
                                          = '0400' AND                  40720000
                      ASC-KOHLS-DUMMY-SKU (PV-BLOCK2 PV-ITEM2)          40730000
                                          = '000'                       40740000
                       IF (ASC-KOHLS-UPC (PV-BLOCK2 PV-ITEM2) =         40750000
                           ASC-KOHLS-UPC  (PV-BLOCK PV-ITEM)) AND       40760000
                          (ASC-PRICE (PV-BLOCK2 PV-ITEM2) =             40770000
                           ASC-PRICE (PV-BLOCK PV-ITEM))                40780000
                            ADD ASC-RTL-QTY-N (PV-BLOCK2 PV-ITEM2)      40790000
                                            TO PV-HOLD-QTY              40800000
                            SET PWT-QTY-CHECKED (PV-BLOCK2 PV-ITEM2)    40810000
                                            TO TRUE                     40820000
                            IF PV-HOLD-QTY > PC-MAX-QTY                 40830000
                                SET PWT-QTY-ERROR (PV-BLOCK2 PV-ITEM2)  40840000
                                ASC-ERROR                  TO TRUE      40850000
                            END-IF                                      40860000
                       END-IF                                           40870000
                   ELSE                                                 40880000
                       IF (ASC-ITEM-NBR  (PV-BLOCK2 PV-ITEM2) =         40890000
                           ASC-ITEM-NBR  (PV-BLOCK PV-ITEM)) AND        40900000
                          (ASC-PRICE (PV-BLOCK2 PV-ITEM2) =             40910000
                           ASC-PRICE (PV-BLOCK PV-ITEM))                40920000
                            ADD ASC-RTL-QTY-N (PV-BLOCK2 PV-ITEM2)      40930000
                                            TO PV-HOLD-QTY              40940000
                            SET PWT-QTY-CHECKED (PV-BLOCK2 PV-ITEM2)    40950000
                                            TO TRUE                     40960000
                            IF PV-HOLD-QTY > PC-MAX-QTY                 40970000
                                SET PWT-QTY-ERROR (PV-BLOCK2 PV-ITEM2)  40980000
                                ASC-ERROR                  TO TRUE      40990000
                            END-IF                                      41000000
                       END-IF                                           41010000
                   END-IF                                               41020000
               ELSE                                                     41030000
                   SET PWT-QTY-CHECKED (PV-BLOCK2 PV-ITEM2)             41040000
                                           TO TRUE                      41050000
               END-IF                                                   41060000
           END-IF.                                                      41070000
       EJECT                                                            41080000
      ******************************************************************41090000
      ** AFTER TESTING FOR MAXIMUM ACCUMULATED QTY ERROR, FIND THE     *41100000
      ** FIRST FIELD IN ERROR AND SAVE THE BLOCK AND ITEM SO THE       *41110000
      ** CORRECT SCREEN CAN BE DISPLAYED WITH ERRORS HIGHLIGHTED.      *41120000
      ******************************************************************41130000
       3480-CHECK-FOR-QTY-ERROR.                                        41140000
           IF PWT-QTY-ERROR (PV-BLOCK PV-ITEM)                          41150000
               SET PS-QTY-ERROR-FOUND   TO TRUE                         41160000
               MOVE PV-BLOCK          TO ASC-BLK-SUB                    41170000
               MOVE PV-ITEM           TO PV-HOLD-ITEM                   41180000
           END-IF.                                                      41190000
                                                                        41200000
      *----------------------------------------------------------------*41210000
      *    READ XST_UPC AND XST_SKU_LOC USING THE ENTERED UPC NUMBER   *41220000
      *----------------------------------------------------------------*41230000
       3700-SELECT-UPC-NBR.                                             41240000
100404     INITIALIZE DCLXST00008.                                      41250000
100404     INITIALIZE DCLXST00010.                                      41260000
           PERFORM                                                      41270000
             WITH TEST AFTER                                            41280000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41290000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41300000
                    OR SQLCODE = ZERO                                   41310000
                    OR SQLCODE = +100                                   41320000
               EXEC SQL                                                 41330000
100404             SELECT B.UNT_RTL_AMT                                 41340000
100404                   ,B.UPC_STAT_CHG_DTE                            41350000
100404                   ,B.UNT_RTL_CHG_DTE                             41360000
100404                   ,B.LOC_SKU_STAT_CDE                            41370000
100404                   ,B.GP_RTL_AMT                                  41380000
100404                   ,B.GP_RTL_QTY                                  41390000
100404                   ,D.REGN_PRIC_IND                               41400000
100404                   ,B.INTR_UPC_ID                                 41410000
100404                   ,C.ITM_NBR                                     41420000
070111                   ,C.DEPT                                        41430000
100404               INTO :XST00008-UNT-RTL-AMT                         41440000
100404                   ,:PV-NREGN-UPC-STAT-CHG-DTE                    41450000
100404                   ,:PV-NREGN-UNT-RTL-CHG-DTE                     41460000
100404                   ,:PV-NREGN-LOC-SKU-STAT-CDE                    41470000
100404                   ,:XST00008-GP-RTL-AMT                          41480000
100404                    :PV-GP-RTL-AMT-NULL-IND                       41490000
100404                   ,:XST00008-GP-RTL-QTY                          41500000
100404                    :PV-GP-RTL-QTY-NULL-IND                       41510000
100404                   ,:XST00010-REGN-PRIC-IND                       41520000
100404                   ,:XST00008-INTR-UPC-ID                         41530000
100404                   ,:SKXREF-ITM-NBR                               41540000
070111                   ,:SKXREF-DEPT                                  41550000
100404                FROM XST_UPC     A                                41560000
100404                    ,XST_SKU_LOC B                                41570000
100404                    ,TSKXREF     C                                41580000
100404                    ,XST_SKU     D                                41590000
100404          WHERE  (A.UPC_NBR               =  :DK-UPC-NBR   AND    41600000
100404                  A.LAST_ACTN_CDE        IN ('A', 'U')     AND    41610000
100404                  A.INTR_UPC_ID           = B.INTR_UPC_ID  AND    41620000
100404                  B.LOC_NBR               = 0              AND    41630000
100404                  B.END_TMST             IS NULL           AND    41640000
100404                  B.LOC_SKU_STAT_CDE NOT IN ('98')         AND    41650000
100404                  B.INTR_UPC_ID           = C.INTR_UPC_ID  AND    41660000
100404                  C.SKU_STAT_CDE     NOT IN ('98')         AND    41670000
100404                  A.INTR_UPC_ID           = D.INTR_UPC_ID)        41680000
               END-EXEC                                                 41690000
                                                                        41700000
               EVALUATE TRUE                                            41710000
                   WHEN SQLCODE = ZERO                                  41720000
                       SET PS-VALID-UPC          TO TRUE                41730000
100404                 MOVE XST00008-UNT-RTL-AMT TO PV-CUR-RTL-AMT      41740000
100404                                             PV-NREGN-UNT-RTL-AMT 41750000
100404                 MOVE SKXREF-ITM-NBR       TO ASC-ITEM-NBR        41760000
100404                                  (ASC-BLK-SUB ASC-ITEM-SUB)      41770000
100404                 IF PV-GP-RTL-QTY-NULL-IND < 0                    41780000
100404                     MOVE ZEROS TO XST00008-GP-RTL-QTY            41790000
100404                 END-IF                                           41800000
100404                 IF PV-GP-RTL-AMT-NULL-IND < 0                    41810000
100404                     MOVE ZEROS TO XST00008-GP-RTL-AMT            41820000
100404                 END-IF                                           41830000
100404                 MOVE XST00008-GP-RTL-QTY   TO PV-GP-QTY          41840000
100404                 MOVE XST00008-GP-RTL-AMT   TO PV-GP-RTL-AMT      41850000
      **************************************************************    41860000
      * PS-NOT-1ST-MKDN => FROM AND TO STORE PRICES ARE EQUAL           41870000
      * PS-1ST-MKDN     => FROM AND TO STORE PRICES NOT EQUAL           41880000
      * PS-NOT-CLR-ITM  => ITEM NOT IN RED STATUS. LOCK GUN PRICE       41890000
      * PS-CLR-ITM      => ITEM IN RED STATUS. LOCK GUN PRICE NOT       41900000
      * PS-NOT-REGN-PRC-ITM => NEITHER STORE IN RCP                     41910000
      * PS-REGN-PRC-ITM     => AT LEAST ONE STORE IN RCP                41920000
      **************************************************************    41930000
                           EVALUATE ASC-XFER-TYPE                       41940000
111703                       WHEN PC-DEFECTIVE-DAMAGE-SORT1             41950000
111703                       WHEN PC-DEFECTIVE-DAMAGE-SORT2             41960000
                             WHEN PC-CALLBACK                           41970000
                                SET PS-NOT-CLR-ITM                      41980000
                                    PS-NOT-REGN-PRC-ITM                 41990000
                                    PS-NOT-1ST-MKDN      TO  TRUE       42000000
100404                       IF XST00010-REGN-PRIC-IND = PC-YES         42010000
                                MOVE ASC-FR-STORE-NBR TO DK-STORE-NBR   42020000
                                PERFORM 7800-CHECK-REGN-PRC             42030000
                                IF PS-REGN-CLR-FOUND                    42040000
                                    SET PS-REGN-PRC-ITM    TO TRUE      42050000
                                    SET PS-NOT-1ST-MKDN    TO TRUE      42060000
100404                                    MOVE PV-REGN-UNT-RTL-AMT      42070000
                                                     TO PV-CUR-RTL-AMT  42080000
                                    MOVE +1          TO PV-GP-QTY       42090000
100404                              IF PV-REGN-UPC-STAT-CHG-DTE <       42100000
100404                                  PV-REGN-UNT-RTL-CHG-DTE         42110000
                                        SET PS-CLR-ITM       TO  TRUE   42120000
                                    ELSE                                42130000
                                        SET PS-NOT-CLR-ITM   TO  TRUE   42140000
                                    END-IF                              42150000
                                END-IF                                  42160000
                             END-IF                                     42170000
100404                       IF (XST00010-REGN-PRIC-IND NOT = PC-YES)   42180000
                                OR (PS-NOT-REGN-PRC-ITM)                42190000
                                 PERFORM 4700-CHK-CLR-ITM-1ST-MKDN      42200000
                             END-IF                                     42210000
                                                                        42220000
                             WHEN  PC-STOCK-BAL-CORP                    42230000
                             WHEN  PC-STOCK-BAL-STORE                   42240000
                             WHEN  PC-CUSTOMER                          42250000
                                SET PS-NOT-CLR-ITM                      42260000
                                    PS-NOT-REGN-PRC-ITM                 42270000
                                    PS-1ST-MKDN      TO  TRUE           42280000
100404                       IF XST00010-REGN-PRIC-IND = PC-YES         42290000
                                MOVE ASC-TO-STORE-NBR TO DK-STORE-NBR   42300000
                                PERFORM 7800-CHECK-REGN-PRC             42310000
                                IF PS-REGN-CLR-FOUND                    42320000
                                    SET PS-REGN-PRC-ITM TO TRUE         42330000
                                    SET PS-NOT-CLR-ITM  TO TRUE         42340000
100404                              MOVE PV-REGN-UNT-RTL-AMT            42350000
                                                     TO PV-CUR-RTL-AMT  42360000
                                                        PV-TO-PRICE     42370000
                                    MOVE +1       TO PV-GP-QTY          42380000
                                ELSE                                    42390000
100404                              MOVE PV-NREGN-UNT-RTL-AMT TO        42400000
                                                         PV-TO-PRICE    42410000
                                END-IF                                  42420000
                                                                        42430000
                                MOVE ASC-FR-STORE-NBR TO DK-STORE-NBR   42440000
                                PERFORM 7800-CHECK-REGN-PRC             42450000
                                IF PS-REGN-CLR-FOUND                    42460000
                                    SET PS-REGN-PRC-ITM TO TRUE         42470000
                                    SET PS-NOT-CLR-ITM  TO TRUE         42480000
100404                              MOVE PV-REGN-UNT-RTL-AMT            42490000
                                                     TO PV-FROM-PRICE   42500000
                                ELSE                                    42510000
100404                              MOVE PV-NREGN-UNT-RTL-AMT           42520000
                                                     TO PV-FROM-PRICE   42530000
                                END-IF                                  42540000
                             END-IF                                     42550000
                                                                        42560000
                             IF XST00010-REGN-PRIC-IND = PC-YES         42570000
                                 IF PV-FROM-PRICE = PV-TO-PRICE         42580000
                                     SET PS-NOT-1ST-MKDN TO TRUE        42590000
                                 ELSE                                   42600000
                                     SET PS-1ST-MKDN    TO TRUE         42610000
                                 END-IF                                 42620000
                             END-IF                                     42630000
                                                                        42640000
100404                       IF (XST00010-REGN-PRIC-IND NOT = PC-YES)   42650000
                                OR (PS-NOT-REGN-PRC-ITM)                42660000
                                PERFORM 4700-CHK-CLR-ITM-1ST-MKDN       42670000
                             END-IF                                     42680000
                           END-EVALUATE                                 42690000
                       MOVE PV-CUR-RTL-AMT TO ASC-FILE-PRICE            42700000
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    42710000
                       IF PV-GP-QTY > +1                                42720000
                           COMPUTE PV-CUR-RTL-AMT =                     42730000
                                        PV-GP-RTL-AMT / PV-GP-QTY       42740000
                           SET ASC-GROUP-PRICED-ITEM                    42750000
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    42760000
                                                 TO TRUE                42770000
                       ELSE                                             42780000
                           SET ASC-NOT-GROUP-PRICED-ITEM                42790000
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    42800000
                                                 TO TRUE                42810000
                       END-IF                                           42820000
                   WHEN SQLCODE = -904                                  42830000
                   WHEN SQLCODE = -913                                  42840000
                       CONTINUE                                         42850000
                   WHEN SQLCODE = +100                                  42860000
                       SET PS-INVALID-UPC          TO TRUE              42870000
                   WHEN OTHER                                           42880000
                       MOVE '3700-SELECT-UPC-NBR'                       42890000
                                           TO DP013-PARAGRAPH           42900000
100404                 MOVE 'READ A ROW FROM XST_SKU_LOC'               42910000
                                           TO DP013-MESSAGE-TEXT (1)    42920000
                       MOVE SQLCA          TO DP013-SQLCA               42930000
100404                 MOVE 'XST_UPC'      TO DP013-DB2-TABLE-NAME (1)  42940000
100404                 MOVE 'XST_SKU_LOC'  TO DP013-DB2-TABLE-NAME (2)  42950000
                       SET DP013-DB2-ABEND TO TRUE                      42960000
                       PERFORM DP013-0000-PROCESS-ABEND                 42970000
               END-EVALUATE                                             42980000
           END-PERFORM.                                                 42990000
                                                                        43000000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          43010000
               MOVE '3700-SELECT-UPC-NBR'  TO DP013-PARAGRAPH           43020000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    43030000
                                           TO DP013-MESSAGE-TEXT (1)    43040000
100404         MOVE 'DATA FROM XST_SKU_LOC & XST_UPC'                   43050000
                                           TO DP013-MESSAGE-TEXT (2)    43060000
               MOVE SQLCA                  TO DP013-SQLCA               43070000
100404         MOVE 'XST_UPC'              TO DP013-DB2-TABLE-NAME (1)  43080000
100404         MOVE 'XST_SKU_LOC'          TO DP013-DB2-TABLE-NAME (2)  43090000
               SET DP013-DB2-ABEND         TO TRUE                      43100000
               PERFORM DP013-0000-PROCESS-ABEND                         43110000
           END-IF.                                                      43120000
           IF PS-VALID-UPC                                              43130000
               PERFORM 3800-GENERATE-INTERNAL-UPC                       43140000
           END-IF.                                                      43150000
                                                                        43160000
      ******************************************************************43170000
      *  GENERATE THE KOHL'S INTERNAL UPC NUMBER                        43180000
      ******************************************************************43190000
       3800-GENERATE-INTERNAL-UPC.                                      43200000
           SET PS-VALID-CHECK-DIGIT        TO TRUE.                     43210000
               EXEC SQL                                                 43220000
100404             SELECT UPC_NBR                                       43230000
100404               INTO :XST00012-UPC-NBR                             43240000
100404               FROM XST_UPC                                       43250000
100404              WHERE UPC_ID     =  :XST00008-INTR-UPC-ID           43260000
100404                AND LAST_ACTN_CDE IN ('A', 'U')                   43270000
               END-EXEC.                                                43280000
                                                                        43290000
               EVALUATE TRUE                                            43300000
                   WHEN SQLCODE = ZERO                                  43310000
100404                 MOVE XST00012-UPC-NBR TO DK-UPC-NBR              43320000
                                                PV-HOLD-UPC-NBR-9       43330000
                                                ASC-KOHLS-UPC           43340000
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   43350000
                                                                        43360000
                   WHEN SQLCODE = +100                                  43370000
                       SET PS-INVALID-UPC      TO TRUE                  43380000
                   WHEN OTHER                                           43390000
                        MOVE '3800-GENERATE-INTERNAL-UPC'               43400000
                                           TO DP013-PARAGRAPH           43410000
                        MOVE 'GENERATE INTERNAL UPC NUMBER'             43420000
                                           TO DP013-MESSAGE-TEXT (1)    43430000
                        MOVE SQLCA         TO DP013-SQLCA               43440000
100404                  MOVE 'XST_UPC'     TO DP013-DB2-TABLE-NAME (1)  43450000
                        SET DP013-DB2-ABEND                             43460000
                            DP013-XCTL-DISPLAY-RESTART                  43470000
                                           TO TRUE                      43480000
                        PERFORM DP013-0000-PROCESS-ABEND                43490000
               END-EVALUATE.                                            43500000
      *                                                                 43510000
       EJECT                                                            43520000
                                                                        43530000
                                                                        43540000
      ******************************************************************43550000
      ** VALIDATE EMBEDDED DEPT AND CLASS IN DUMMY SKU                **43560000
      ******************************************************************43570000
       3900-VALIDATE-SKU-DEPT-CLASS.                                    43580000
           MOVE PV-DUMMY-SKU-DEPT TO DK-DEPT-NBR.                       43590000
           MOVE PV-DUMMY-SKU-CL-9 TO DK-SUBCLASS-NBR.                   43600000
           MOVE ZERO              TO PV-DUMMY-SKU-CL-2.                 43610000
           MOVE PV-DUMMY-SKU-CL-9 TO DK-CLASS-NBR.                      43620000
                                                                        43630000
           PERFORM                                                      43640000
             WITH TEST AFTER                                            43650000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       43660000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  43670000
                    OR SQLCODE = ZERO                                   43680000
                    OR SQLCODE = +100                                   43690000
               EXEC SQL                                                 43700000
                   SELECT  COUNT(*)                                     43710000
                     INTO  :PV-READ-COUNT                               43720000
                     FROM  TSKXREF                                      43730000
                    WHERE  (DEPT        =  :DK-DEPT-NBR                 43740000
                      AND   CLASS       =  :DK-CLASS-NBR                43750000
                      AND   SUBCLASS    =  :DK-SUBCLASS-NBR)            43760000
               END-EXEC                                                 43770000
                                                                        43780000
               EVALUATE TRUE                                            43790000
                   WHEN SQLCODE = ZERO                                  43800000
                       IF PV-READ-COUNT > +0                            43810000
                           SET PS-VALID-DEPT-CL    TO TRUE              43820000
                       ELSE                                             43830000
                           SET PS-INVALID-DEPT-CL  TO TRUE              43840000
                       END-IF                                           43850000
                   WHEN SQLCODE = -904                                  43860000
                   WHEN SQLCODE = -913                                  43870000
                       CONTINUE                                         43880000
                   WHEN SQLCODE = +100                                  43890000
                       SET PS-INVALID-DEPT-CL      TO TRUE              43900000
                   WHEN OTHER                                           43910000
                       MOVE '3900-VALIDATE-SKU-DEPT-CLASS'              43920000
                                           TO DP013-PARAGRAPH           43930000
                       MOVE 'READ A ROW FROM TSKXREF'                   43940000
                                           TO DP013-MESSAGE-TEXT (1)    43950000
                       MOVE SQLCA          TO DP013-SQLCA               43960000
                       MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (1)  43970000
                       SET DP013-DB2-ABEND TO TRUE                      43980000
                       PERFORM DP013-0000-PROCESS-ABEND                 43990000
               END-EVALUATE                                             44000000
           END-PERFORM.                                                 44010000
                                                                        44020000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          44030000
               MOVE '3900-VALIDATE-SKU-DEPT-CLASS' TO DP013-PARAGRAPH   44040000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    44050000
                                           TO DP013-MESSAGE-TEXT (1)    44060000
               MOVE 'DATA FROM TSKXREF'    TO DP013-MESSAGE-TEXT (2)    44070000
               MOVE SQLCA                  TO DP013-SQLCA               44080000
               MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (1)  44090000
               SET DP013-DB2-ABEND         TO TRUE                      44100000
               PERFORM DP013-0000-PROCESS-ABEND                         44110000
           END-IF.                                                      44120000
                                                                        44130000
                                                                        44140000
      ******************************************************************44150000
      ** VALIDATE EMBEDDED DEPT AND CLASS IN UPC                      **44160000
      ******************************************************************44170000
       3905-VALIDATE-UPC-DEPT-CLASS.                                    44180000
           MOVE PV-KOHLS-DEPT     TO DK-DEPT-NBR.                       44190000
           MOVE PV-KOHLS-CL-9     TO DK-SUBCLASS-NBR.                   44200000
           MOVE ZERO              TO PV-KOHLS-CL-2.                     44210000
           MOVE PV-KOHLS-CL-9     TO DK-CLASS-NBR.                      44220000
                                                                        44230000
           PERFORM                                                      44240000
             WITH TEST AFTER                                            44250000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       44260000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  44270000
                    OR SQLCODE = ZERO                                   44280000
                    OR SQLCODE = +100                                   44290000
               EXEC SQL                                                 44300000
                   SELECT  COUNT(*)                                     44310000
                     INTO  :PV-READ-COUNT                               44320000
                     FROM  TSKXREF                                      44330000
                    WHERE  (DEPT        =  :DK-DEPT-NBR                 44340000
                      AND   CLASS       =  :DK-CLASS-NBR                44350000
                      AND   SUBCLASS    =  :DK-SUBCLASS-NBR)            44360000
               END-EXEC                                                 44370000
                                                                        44380000
               EVALUATE TRUE                                            44390000
                   WHEN SQLCODE = ZERO                                  44400000
                       IF PV-READ-COUNT > +0                            44410000
                           SET PS-VALID-DEPT-CL    TO TRUE              44420000
                       ELSE                                             44430000
                           SET PS-INVALID-DEPT-CL  TO TRUE              44440000
                       END-IF                                           44450000
                   WHEN SQLCODE = -904                                  44460000
                   WHEN SQLCODE = -913                                  44470000
                       CONTINUE                                         44480000
                   WHEN SQLCODE = +100                                  44490000
                       SET PS-INVALID-DEPT-CL      TO TRUE              44500000
                   WHEN OTHER                                           44510000
                       MOVE '3905-VALIDATE-UPC-DEPT-CLASS'              44520000
                                           TO DP013-PARAGRAPH           44530000
                       MOVE 'READ A ROW FROM TSKXREF'                   44540000
                                           TO DP013-MESSAGE-TEXT (1)    44550000
                       MOVE SQLCA          TO DP013-SQLCA               44560000
                       MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (1)  44570000
                       SET DP013-DB2-ABEND TO TRUE                      44580000
                       PERFORM DP013-0000-PROCESS-ABEND                 44590000
               END-EVALUATE                                             44600000
           END-PERFORM.                                                 44610000
                                                                        44620000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          44630000
               MOVE '3905-VALIDATE-UPC-DEPT-CLASS' TO DP013-PARAGRAPH   44640000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    44650000
                                           TO DP013-MESSAGE-TEXT (1)    44660000
               MOVE 'DATA FROM TSKXREF'    TO DP013-MESSAGE-TEXT (2)    44670000
               MOVE SQLCA                  TO DP013-SQLCA               44680000
               MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (1)  44690000
               SET DP013-DB2-ABEND         TO TRUE                      44700000
               PERFORM DP013-0000-PROCESS-ABEND                         44710000
           END-IF.                                                      44720000
                                                                        44730000
      ******************************************************************44740000
      ** CONVERT DUMMY SKU TO DUMMY UPC                               **44750000
      ******************************************************************44760000
       3910-SELECT-DUMMY-UPC.                                           44770000
           SET DP040I-GEN-INTERNAL-UPC-OPTION TO TRUE.                  44780000
                                                                        44790000
           CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          44800006
                           USING DP040I-UPC-CHECK-DIGIT-PARMS           44801006
                                                                        44810000
           IF DP040I-NO-ERROR-DETECTED                                  44820000
               SET PS-FOUND-DUMMY-UPC-Y TO TRUE                         44830000
               MOVE DP040I-UPC-CODE TO DK-UPC-NBR                       44840000
                             ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)       44850000
                             ASC-KOHLS-UPC (ASC-BLK-SUB ASC-ITEM-SUB)   44860000
           ELSE                                                         44870000
               SET PS-FOUND-DUMMY-UPC-N TO TRUE                         44880000
           END-IF.                                                      44890000
                                                                        44900000
      *                                                                 44910000
      *----------------------------------------------------------------*44920000
      *    INITIALIZE BLOCK & ITEM COUNTERS. GET TRANSFER TYPE         *44930000
      *    DESCRIPTION AND CONTAINER TYPE DESCRIPTION.                 *44940000
      *    DISPLAY THE PANEL TO USER.                                  *44950000
      *----------------------------------------------------------------*44960000
                                                                        44970000
       4000-BUILD-INITIAL-PANEL.                                        44980000
                                                                        44990000
           MOVE +1                 TO ASC-BLK-SUB.                      45000000
                                                                        45010000
           MOVE +0                 TO ASC-ITEM-SUB                      45020000
                                      ASC-HIGHEST-BLOCK-WRITTEN.        45030000
           PERFORM 4140-GET-XFER-DESC.                                  45040000
           PERFORM 4150-GET-CONTNR-DESC.                                45050000
                                                                        45060000
           SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       45070000
           MOVE -1          TO MR-A-TO-STORE-NBR-L.                     45080000
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        45090000
       EJECT                                                            45100000
                                                                        45110000
      *----------------------------------------------------------------*45120000
      *    GENERATE THE RANDOM DATA-LESS KEY CONTROL NUMBER.           *45130000
      *----------------------------------------------------------------*45140000
       4100-GET-CONTROL-NUMBER.                                         45150000
           SET PS-CONTROL-FOUND      TO TRUE                            45160000
           PERFORM WITH TEST AFTER                                      45170000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       45180000
               UNTIL   PS-CONTROL-NOT-FOUND                             45190000
                                                                        45200000
               EXEC SQL                                                 45210000
                   SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP            45220000
               END-EXEC                                                 45230000
                                                                        45240000
               MOVE PV-DB2-TIMESTAMP TO PV-TIMESTAMP                    45250000
               MOVE CORRESPONDING PV-TIMESTAMP-FIELDS                   45260000
                                         TO PV-RANDOM-KEY-FIELDS        45270000
               MOVE PV-RANDOM-KEY        TO PV-RANDOM-KEY-COMP-3        45280000
                                            DK-XFER-DKEY-ID             45290000
                                            ASC-CONTROL-NBR             45300000
                                            ASC-XFER-DKEY-ID            45310000
               PERFORM 4110-CHECK-TABLES                                45320000
           END-PERFORM.                                                 45330000
                                                                        45340000
       EJECT                                                            45350000
      *----------------------------------------------------------------*45360000
      *   CHECK THAT THE RANDOM CONTROL NUMBER DOES NOT ALREADY EXIST. *45370000
      *----------------------------------------------------------------*45380000
       4110-CHECK-TABLES.                                               45390000
           PERFORM WITH TEST AFTER                                      45400000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       45410000
               UNTIL   SQLCODE = +100 OR                                45420000
                       SQLCODE = ZERO OR                                45430000
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  45440000
                                                                        45450000
               EXEC SQL                                                 45460000
                    SELECT XFER_DKEY_ID                                 45470000
                      INTO :TFMSTR-XFER-DKEY-ID                         45480000
                      FROM TTFMSTR                                      45490000
                     WHERE XFER_DKEY_ID = :PV-RANDOM-KEY-COMP-3         45500000
               END-EXEC                                                 45510000
                                                                        45520000
               EVALUATE TRUE                                            45530000
                   WHEN SQLCODE = +100                                  45540000
                       PERFORM 4120-CHECK-TTFCUST                       45550000
                   WHEN SQLCODE = ZERO                                  45560000
                   WHEN SQLCODE = -904                                  45570000
                   WHEN SQLCODE = -913                                  45580000
                        CONTINUE                                        45590000
                   WHEN OTHER                                           45600000
                        MOVE '4110-CHECK-TABLES'                        45610000
                                           TO DP013-PARAGRAPH           45620000
                        MOVE 'SELECT RANDOM CONTROL NBR'                45630000
                                           TO DP013-MESSAGE-TEXT (1)    45640000
                        MOVE SQLCA         TO DP013-SQLCA               45650000
                        MOVE 'TTFMSTR'     TO DP013-DB2-TABLE-NAME (1)  45660000
                        SET DP013-DB2-ABEND                             45670000
                            DP013-XCTL-DISPLAY-RESTART                  45680000
                                           TO TRUE                      45690000
                        PERFORM DP013-0000-PROCESS-ABEND                45700000
               END-EVALUATE                                             45710000
           END-PERFORM.                                                 45720000
                                                                        45730000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           45740000
               MOVE '4110-CHECK-TABLES' TO DP013-PARAGRAPH              45750000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     45760000
                                           TO DP013-MESSAGE-TEXT (1)    45770000
               MOVE 'RANDOM CONTROL NUMBER'                             45780000
                                           TO DP013-MESSAGE-TEXT (2)    45790000
               MOVE SQLCA                  TO DP013-SQLCA               45800000
               MOVE 'TTFMSTR'              TO DP013-DB2-TABLE-NAME (1)  45810000
               SET DP013-DB2-ABEND                                      45820000
                   DP013-XCTL-DISPLAY-RESTART                           45830000
                                           TO TRUE                      45840000
               PERFORM DP013-0000-PROCESS-ABEND                         45850000
           END-IF.                                                      45860000
       EJECT                                                            45870000
      *----------------------------------------------------------------*45880000
      *   CHECK THAT THE RANDOM CONTROL NUMBER DOES NOT ALREADY EXIST. *45890000
      *----------------------------------------------------------------*45900000
       4120-CHECK-TTFCUST.                                              45910000
           PERFORM WITH TEST AFTER                                      45920000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       45930000
               UNTIL   SQLCODE = +100 OR                                45940000
                       SQLCODE = ZERO OR                                45950000
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  45960000
                                                                        45970000
               EXEC SQL                                                 45980000
                    SELECT XFER_DKEY_ID                                 45990000
                      INTO :TFCUST-XFER-DKEY-ID                         46000000
                      FROM TTFCUST                                      46010000
                     WHERE XFER_DKEY_ID = :PV-RANDOM-KEY-COMP-3         46020000
               END-EXEC                                                 46030000
                                                                        46040000
               EVALUATE TRUE                                            46050000
                   WHEN SQLCODE = ZERO                                  46060000
                   WHEN SQLCODE = -904                                  46070000
                   WHEN SQLCODE = -913                                  46080000
                        CONTINUE                                        46090000
                   WHEN SQLCODE = +100                                  46100000
                       SET PS-CONTROL-NOT-FOUND   TO TRUE               46110000
                   WHEN OTHER                                           46120000
                        MOVE '4120-CHECK-TTFCUST'                       46130000
                                           TO DP013-PARAGRAPH           46140000
                        MOVE 'SELECT RANDOM CONTROL NBR'                46150000
                                           TO DP013-MESSAGE-TEXT (1)    46160000
                        MOVE SQLCA         TO DP013-SQLCA               46170000
                        MOVE 'TTFCUST'     TO DP013-DB2-TABLE-NAME (1)  46180000
                        SET DP013-DB2-ABEND                             46190000
                            DP013-XCTL-DISPLAY-RESTART                  46200000
                                           TO TRUE                      46210000
                        PERFORM DP013-0000-PROCESS-ABEND                46220000
               END-EVALUATE                                             46230000
           END-PERFORM.                                                 46240000
                                                                        46250000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           46260000
               MOVE '4120-CHECK-TTFCUST' TO DP013-PARAGRAPH             46270000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46280000
                                           TO DP013-MESSAGE-TEXT (1)    46290000
               MOVE 'RANDOM CONTROL NUMBER'                             46300000
                                           TO DP013-MESSAGE-TEXT (2)    46310000
               MOVE SQLCA                  TO DP013-SQLCA               46320000
               MOVE 'TTFCUST'              TO DP013-DB2-TABLE-NAME (1)  46330000
               SET DP013-DB2-ABEND                                      46340000
                   DP013-XCTL-DISPLAY-RESTART                           46350000
                                           TO TRUE                      46360000
               PERFORM DP013-0000-PROCESS-ABEND                         46370000
           END-IF.                                                      46380000
       EJECT                                                            46390000
      *----------------------------------------------------------------*46400000
      * INSERT THE ROW INTO THE TRANSFER MASTER TABLE.                 *46410000
      *----------------------------------------------------------------*46420000
       4130-INSERT-ROW.                                                 46430000
           INITIALIZE DCLTTFMSTR.                                       46440000
           MOVE ASC-FR-STORE-NBR   TO DK-STORE-NBR.                     46450000
           MOVE ASC-XFER-TYPE      TO DK-XFER-TYPE.                     46460000
           MOVE ASC-CONTNR-TYPE    TO DK-CONTNR-TYPE.                   46470000
           MOVE ASC-FR-STR-OVRRID-IND      TO TFMSTR-FR-STR-OVRRID-IND. 46480000
           PERFORM WITH TEST AFTER                                      46490000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46500000
               UNTIL SQLCODE = 0 OR                                     46510000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    46520000
                                                                        46530000
               EXEC SQL                                                 46540000
                    INSERT                                              46550000
                      INTO TTFMSTR                                      46560000
                          (XFER_DKEY_ID                                 46570000
                         , ENTR_MTHD_TYP_CDE                            46580000
                         , XFER_TYP_CDE                                 46590000
                         , CONTNR_TYP_CDE                               46600000
                         , FR_STR_NBR                                   46610000
                         , CMPT_XFER_BEG_TMST                           46620000
                         , CMPT_XFER_END_TMST                           46630000
                         , WRKSHT_PROB_IND                              46640000
                         , FR_STR_OVRRID_IND)                           46650000
                    VALUES                                              46660000
                          (:DK-XFER-DKEY-ID                             46670000
                         , :PC-ENTRY-METHOD                             46680000
                         , :DK-XFER-TYPE                                46690000
                         , :DK-CONTNR-TYPE                              46700000
                         , :DK-STORE-NBR                                46710000
                         , CURRENT TIMESTAMP                            46720000
                         , :PC-MAX-TIMESTAMP                            46730000
                         , :PC-YES                                      46740000
                         , :TFMSTR-FR-STR-OVRRID-IND)                   46750000
               END-EXEC                                                 46760000
                                                                        46770000
               EVALUATE TRUE                                            46780000
                   WHEN SQLCODE = ZERO                                  46790000
                   WHEN SQLCODE = -904                                  46800000
                   WHEN SQLCODE = -913                                  46810000
                        CONTINUE                                        46820000
                   WHEN OTHER                                           46830000
                        MOVE '4130-INSERT-ROW'                          46840000
                                          TO DP013-PARAGRAPH            46850000
                        MOVE 'INSERT A ROW INTO THE TRANSFER TABLE'     46860000
                                          TO DP013-MESSAGE-TEXT(1)      46870000
                        MOVE SQLCA        TO DP013-SQLCA                46880000
                        MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)   46890000
                        SET DP013-DB2-ABEND                             46900000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          46910000
                        PERFORM DP013-0000-PROCESS-ABEND                46920000
               END-EVALUATE                                             46930000
           END-PERFORM.                                                 46940000
                                                                        46950000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           46960000
               MOVE '4130-INSERT-ROW' TO DP013-PARAGRAPH                46970000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     46980000
                                          TO DP013-MESSAGE-TEXT (1)     46990000
               MOVE 'A NEW TRANSFER'      TO DP013-MESSAGE-TEXT (2)     47000000
               MOVE SQLCA                 TO DP013-SQLCA                47010000
               MOVE 'TTFMSTR'             TO DP013-DB2-TABLE-NAME (1)   47020000
               SET DP013-DB2-ABEND                                      47030000
                   DP013-XCTL-DISPLAY-RESTART                           47040000
                                          TO TRUE                       47050000
               PERFORM DP013-0000-PROCESS-ABEND                         47060000
           END-IF.                                                      47070000
       EJECT                                                            47080000
      *----------------------------------------------------------------*47090000
      * GET TRANSFER DESCRIPTION                                       *47100000
      *----------------------------------------------------------------*47110000
       4140-GET-XFER-DESC.                                              47120000
           MOVE ASC-XFER-TYPE          TO DK-XFER-TYPE.                 47130000
           PERFORM WITH TEST AFTER                                      47140000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       47150000
               UNTIL   SQLCODE = +100 OR                                47160000
                       SQLCODE = ZERO OR                                47170000
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  47180000
                                                                        47190000
               EXEC SQL                                                 47200000
                  SELECT                                                47210000
                      TYP_1ST_LNE_DESC                                  47220000
                     ,TYP_2ND_LNE_DESC                                  47230000
                  INTO                                                  47240000
                      :TFTYCD-TYP-1ST-LNE-DESC                          47250000
                     ,:TFTYCD-TYP-2ND-LNE-DESC                          47260000
                  FROM                                                  47270000
                      TTFTYCD                                           47280000
                  WHERE   XFER_TYP_CDE   = :DK-XFER-TYPE                47290000
               END-EXEC                                                 47300000
                                                                        47310000
               EVALUATE TRUE                                            47320000
                   WHEN SQLCODE = ZERO                                  47330000
                      IF TFTYCD-TYP-2ND-LNE-DESC = SPACES               47340000
                          MOVE TFTYCD-TYP-1ST-LNE-DESC                  47350000
                                         TO ASC-XFER-DESC               47360000
                      ELSE                                              47370000
                          STRING                                        47380000
                              TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 47390000
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 47400000
                                         INTO ASC-XFER-DESC             47410000
                      END-IF                                            47420000
                   WHEN SQLCODE = +100                                  47430000
                       MOVE 'NOT FOUND'  TO ASC-XFER-DESC               47440000
                   WHEN SQLCODE = -904                                  47450000
                   WHEN SQLCODE = -913                                  47460000
                        CONTINUE                                        47470000
                   WHEN OTHER                                           47480000
                        MOVE '4140-GET-XFER-DESC'                       47490000
                                           TO DP013-PARAGRAPH           47500000
                        MOVE 'SELECT TRANSFER TYPE DESCRIPTION'         47510000
                                           TO DP013-MESSAGE-TEXT (1)    47520000
                        MOVE SQLCA         TO DP013-SQLCA               47530000
                        MOVE 'TTFTYCD'     TO DP013-DB2-TABLE-NAME (1)  47540000
                        SET DP013-DB2-ABEND                             47550000
                            DP013-XCTL-DISPLAY-RESTART                  47560000
                                           TO TRUE                      47570000
                        PERFORM DP013-0000-PROCESS-ABEND                47580000
               END-EVALUATE                                             47590000
           END-PERFORM.                                                 47600000
                                                                        47610000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           47620000
               MOVE '4140-GET-XFER-DESC' TO DP013-PARAGRAPH             47630000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     47640000
                                           TO DP013-MESSAGE-TEXT (1)    47650000
               MOVE 'TRANSFER TYPE DESCRIPTION'                         47660000
                                           TO DP013-MESSAGE-TEXT (2)    47670000
               MOVE SQLCA                  TO DP013-SQLCA               47680000
               MOVE 'TTFTYCD'              TO DP013-DB2-TABLE-NAME (1)  47690000
               SET DP013-DB2-ABEND                                      47700000
                   DP013-XCTL-DISPLAY-RESTART                           47710000
                                           TO TRUE                      47720000
               PERFORM DP013-0000-PROCESS-ABEND                         47730000
           END-IF.                                                      47740000
       EJECT                                                            47750000
      *----------------------------------------------------------------*47760000
      * GET CONTAINER DESCRIPTION                                      *47770000
      *----------------------------------------------------------------*47780000
       4150-GET-CONTNR-DESC.                                            47790000
           MOVE ASC-CONTNR-TYPE            TO DK-CONTNR-TYPE.           47800000
           PERFORM WITH TEST AFTER                                      47810000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       47820000
               UNTIL   SQLCODE = +100 OR                                47830000
                       SQLCODE = ZERO OR                                47840000
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  47850000
                                                                        47860000
               EXEC SQL                                                 47870000
                  SELECT                                                47880000
                      CONTNR_TYP_DESC                                   47890000
                  INTO                                                  47900000
                      :TFSHCT-CONTNR-TYP-DESC                           47910000
                  FROM                                                  47920000
                      TTFSHCT                                           47930000
                  WHERE   CONTNR_TYP_CDE   = :DK-CONTNR-TYPE            47940000
               END-EXEC                                                 47950000
                                                                        47960000
               EVALUATE TRUE                                            47970000
                   WHEN SQLCODE = ZERO                                  47980000
                        MOVE TFSHCT-CONTNR-TYP-DESC                     47990000
                                         TO ASC-CONTNR-DESC             48000000
                   WHEN SQLCODE = +100                                  48010000
                        MOVE 'NOT FOUND'  TO ASC-CONTNR-DESC            48020000
                   WHEN SQLCODE = -904                                  48030000
                   WHEN SQLCODE = -913                                  48040000
                        CONTINUE                                        48050000
                   WHEN OTHER                                           48060000
                        MOVE '4150-GET-CONTNR-DESC'                     48070000
                                           TO DP013-PARAGRAPH           48080000
                        MOVE 'SELECT CONTAINER DESCRIPTION'             48090000
                                           TO DP013-MESSAGE-TEXT (1)    48100000
                        MOVE SQLCA         TO DP013-SQLCA               48110000
                        MOVE 'TTFSHCT'     TO DP013-DB2-TABLE-NAME (1)  48120000
                        SET DP013-DB2-ABEND                             48130000
                            DP013-XCTL-DISPLAY-RESTART                  48140000
                                           TO TRUE                      48150000
                        PERFORM DP013-0000-PROCESS-ABEND                48160000
               END-EVALUATE                                             48170000
           END-PERFORM.                                                 48180000
                                                                        48190000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           48200000
               MOVE '4150-GET-CONTNR-DESC' TO DP013-PARAGRAPH           48210000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     48220000
                                           TO DP013-MESSAGE-TEXT (1)    48230000
               MOVE 'CONTAINER DESCRIPTION'                             48240000
                                           TO DP013-MESSAGE-TEXT (2)    48250000
               MOVE SQLCA                  TO DP013-SQLCA               48260000
               MOVE 'TTFSHCT'              TO DP013-DB2-TABLE-NAME (1)  48270000
               SET DP013-DB2-ABEND                                      48280000
                   DP013-XCTL-DISPLAY-RESTART                           48290000
                                           TO TRUE                      48300000
               PERFORM DP013-0000-PROCESS-ABEND                         48310000
           END-IF.                                                      48320000
       EJECT                                                            48330000
      *----------------------------------------------------------------*48340000
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *48350000
      *----------------------------------------------------------------*48360000
                                                                        48370000
       4400-MOVE-COMMAREA-TO-SCREEN.                                    48380000
           IF ASC-XFER-IS-NOT-COMPLETE                                  48390000
               MOVE PC-WORKSHEET-LITERAL       TO MR-A-LITERAL          48400000
               MOVE ASC-CONTROL-NBR            TO MR-A-CTL-NBR          48410000
           ELSE                                                         48420000
               MOVE PC-TRANSFER-LITERAL        TO MR-A-LITERAL          48430000
               MOVE ASC-FR-STORE-NBR           TO PV-DISP-FROM-STORE-NBR48440000
               MOVE ASC-XFER-SEQ-NBR           TO PV-DISP-SEQ-NBR       48450000
               MOVE PV-DISP-XFER-NBR           TO MR-A-CTL-NBR          48460000
           END-IF.                                                      48470000
           MOVE ASC-XFER-TYPE(2:1)             TO MR-A-XFER-TYPE.       48480000
           MOVE ASC-XFER-DESC                  TO MR-A-XFER-DESC.       48490000
           MOVE ASC-CONTNR-TYPE(2:1)           TO MR-A-CONT-TYPE.       48500000
           MOVE ASC-CONTNR-DESC                TO MR-A-CONT-DESC.       48510000
           MOVE ASC-TO-STORE-NBR               TO MR-A-TO-STORE-NBR.    48520000
           MOVE ASC-TO-STORE-NAM               TO MR-A-TO-STORE-NAM.    48530000
           SET DP030-ERASE                                              48540000
               DP030-SEND-MAP-AND-DATA (1)                              48550000
               DP030-SEND-MAP-AND-DATA (2)                              48560000
               DP030-SEND-MAP-AND-DATA (3)                              48570000
               DP030-SEND-MAP-AND-DATA (4) TO TRUE.                     48580000
           MOVE PC-COMMON-HEADER-MAP-NAME      TO DP030-MAP-NAME (1).   48590000
           MOVE 1                              TO PV-MAP-START-BYTE.    48600000
           MOVE MR-A-HEADER                    TO MD-MAP-DATA-AREA.     48610000
           MOVE LENGTH OF MR-A-HEADER          TO DP030-MAP-LENGTH (1). 48620000
           ADD DP030-MAP-LENGTH (1)            TO PV-MAP-START-BYTE.    48630000
           EVALUATE ASC-XFER-TYPE                                       48640000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           48650000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           48660000
               WHEN PC-STOCK-BAL-STORE                                  48670000
                   MOVE ASC-COMP-BY-INT        TO MR-B-COMP-BY-INT      48680000
                   MOVE ASC-COMP-BY-NAM        TO MR-B-COMP-BY-NAM      48690000
                   MOVE PC-COMPLETED-BY-MAP-NAME                        48700000
                                               TO DP030-MAP-NAME (2)    48710000
                   MOVE LENGTH OF MR-B-COMPLETED-BY                     48720000
                                               TO DP030-MAP-LENGTH (2)  48730000
                   MOVE MR-B-COMPLETED-BY      TO MD-MAP-DATA-AREA      48740000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   48750000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     48760000
               WHEN PC-CALLBACK                                         48770000
                   MOVE ASC-COMP-BY-INT        TO MR-C-COMP-BY-INT      48780000
                   MOVE ASC-COMP-BY-NAM        TO MR-C-COMP-BY-NAM      48790000
                   MOVE ASC-CALLBACK-NBR       TO MR-C-CALLBACK-NBR     48800000
                   MOVE PC-CALLBACK-MAP-NAME                            48810000
                                               TO DP030-MAP-NAME (2)    48820000
                   MOVE LENGTH OF MR-C-CALLBACK                         48830000
                                               TO DP030-MAP-LENGTH (2)  48840000
                   MOVE MR-C-CALLBACK          TO MD-MAP-DATA-AREA      48850000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   48860000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     48870000
               WHEN PC-STOCK-BAL-CORP                                   48880000
                   MOVE ASC-COMP-BY-INT        TO MR-D-COMP-BY-INT      48890000
                   MOVE ASC-COMP-BY-NAM        TO MR-D-COMP-BY-NAM      48900000
                   MOVE ASC-APPROVAL-NBR       TO MR-D-APPROVAL-NBR     48910000
                   MOVE PC-APPROVAL-MAP-NAME                            48920000
                                               TO DP030-MAP-NAME (2)    48930000
                   MOVE LENGTH OF MR-D-APPROVAL                         48940000
                                               TO DP030-MAP-LENGTH (2)  48950000
                   MOVE MR-D-APPROVAL          TO MD-MAP-DATA-AREA      48960000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   48970000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     48980000
               WHEN PC-CUSTOMER                                         48990000
                   MOVE ASC-COMP-BY-INT        TO MR-E-COMP-BY-INT      49000000
                   MOVE ASC-COMP-BY-NAM        TO MR-E-COMP-BY-NAM      49010000
                   MOVE ASC-REQ-BY-INT         TO MR-E-REQ-BY-INT       49020000
                   MOVE ASC-REQ-BY-NAM         TO MR-E-REQ-BY-NAM       49030000
                   MOVE ASC-CUST-NAME          TO MR-E-CUST-NAME        49040000
                   MOVE ASC-PHONE-AREA         TO MR-E-PHONE-AREA       49050000
                   MOVE ASC-PHONE-EXCH         TO MR-E-PHONE-EXCH       49060000
                   MOVE ASC-PHONE-NBR          TO MR-E-PHONE-NBR        49070000
                   MOVE ASC-ADDR1              TO MR-E-ADDR1            49080000
                   MOVE ASC-ADDR2              TO MR-E-ADDR2            49090000
                   MOVE ASC-CITY               TO MR-E-CITY             49100000
                   MOVE ASC-STATE              TO MR-E-STATE            49110000
                   MOVE ASC-ZIP                TO MR-E-ZIP              49120000
                   MOVE ASC-ZIP-EXT            TO MR-E-ZIP-EXT          49130000
                   MOVE PC-CUSTOMER-MAP-NAME                            49140000
                                               TO DP030-MAP-NAME (2)    49150000
                   MOVE LENGTH OF MR-E-CUSTOMER                         49160000
                                               TO DP030-MAP-LENGTH (2)  49170000
                   MOVE MR-E-CUSTOMER          TO MD-MAP-DATA-AREA      49180000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   49190000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     49200000
               WHEN PC-NON-RETAIL                                       49210000
                   MOVE ASC-COMP-BY-INT        TO MR-F-COMP-BY-INT      49220000
                   MOVE ASC-COMP-BY-NAM        TO MR-F-COMP-BY-NAM      49230000
                   MOVE ASC-REQ-BY-INT         TO MR-F-REQ-BY-INT       49240000
                   MOVE ASC-REQ-BY-NAM         TO MR-F-REQ-BY-NAM       49250000
                   MOVE ASC-ATTN-TO-INT        TO MR-F-ATTN-TO-INT      49260000
                   MOVE ASC-ATTN-TO-NAM        TO MR-F-ATTN-TO-NAM      49270000
                   MOVE PC-NON-RETAIL-MAP-NAME                          49280000
                                               TO DP030-MAP-NAME (2)    49290000
                   MOVE LENGTH OF MR-F-NON-RETAIL                       49300000
                                               TO DP030-MAP-LENGTH (2)  49310000
                   MOVE MR-F-NON-RETAIL        TO MD-MAP-DATA-AREA      49320000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   49330000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     49340000
           END-EVALUATE.                                                49350000
           EVALUATE ASC-CONTNR-TYPE                                     49360000
               WHEN PC-TRAILER                                          49370000
                   MOVE ASC-TRAILER-NBR        TO MR-H-TRLR-NBR         49380000
                   MOVE ASC-TRAILER-SEAL       TO MR-H-TRLR-SEAL        49390000
                   MOVE PC-TRAILER-MAP-NAME                             49400000
                                               TO DP030-MAP-NAME (3)    49410000
                   MOVE LENGTH OF MR-H-TRAILER                          49420000
                                               TO DP030-MAP-LENGTH (3)  49430000
                   MOVE MR-H-TRAILER           TO MD-MAP-DATA-AREA      49440000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))   49450000
                   ADD DP030-MAP-LENGTH (3)    TO PV-MAP-START-BYTE     49460000
               WHEN OTHER                                               49470000
                   MOVE ASC-LG-TOTE-SEAL1      TO MR-G-LG-TOTE-SEAL1    49480000
                   MOVE ASC-LG-TOTE-SEAL2      TO MR-G-LG-TOTE-SEAL2    49490000
                   MOVE ASC-SM-TOTE-SEAL       TO MR-G-SM-TOTE-SEAL     49500000
                   MOVE PC-TOTE-MAP-NAME                                49510000
                                               TO DP030-MAP-NAME (3)    49520000
                   MOVE LENGTH OF MR-G-TOTES                            49530000
                                               TO DP030-MAP-LENGTH (3)  49540000
                   MOVE MR-G-TOTES             TO MD-MAP-DATA-AREA      49550000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))   49560000
                   ADD DP030-MAP-LENGTH (3)    TO PV-MAP-START-BYTE     49570000
           END-EVALUATE.                                                49580000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         49590000
               PERFORM 4420-FORMAT-RTL-LIST-LINES                       49600000
                   VARYING ASC-ITEM-SUB                                 49610000
                   FROM 1 BY 1                                          49620000
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL          49630000
                   MOVE PC-RTL-DETAIL-MAP-NAME                          49640000
                                               TO DP030-MAP-NAME (4)    49650000
                   MOVE LENGTH OF MR-I-RTL-DETAIL                       49660000
                                               TO DP030-MAP-LENGTH (4)  49670000
                   MOVE MR-I-RTL-DETAIL        TO MD-MAP-DATA-AREA      49680000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))   49690000
                   ADD DP030-MAP-LENGTH (4)    TO PV-MAP-START-BYTE     49700000
           ELSE                                                         49710000
               PERFORM 4430-FORMAT-NRTL-LIST-LINES                      49720000
                   VARYING ASC-ITEM-SUB                                 49730000
                   FROM 1 BY 1                                          49740000
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL         49750000
                   MOVE PC-NRTL-DETAIL-MAP-NAME                         49760000
                                               TO DP030-MAP-NAME (4)    49770000
                   MOVE LENGTH OF MR-J-NRTL-DETAIL                      49780000
                                               TO DP030-MAP-LENGTH (4)  49790000
                   MOVE MR-J-NRTL-DETAIL       TO MD-MAP-DATA-AREA      49800000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))   49810000
                   ADD DP030-MAP-LENGTH (4)    TO PV-MAP-START-BYTE     49820000
           END-IF.                                                      49830000
       EJECT                                                            49840000
      *----------------------------------------------------------------*49850000
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP FOR *49860000
      *    RETAIL TRANSFER TYPES.                                      *49870000
      *----------------------------------------------------------------*49880000
                                                                        49890000
       4420-FORMAT-RTL-LIST-LINES.                                      49900000
      *                                                                 49910000
           IF ASC-BLK-SUB = +1                                          49920000
               MOVE ASC-ITEM-SUB       TO MR-I-LINE-NBR-N (ASC-ITEM-SUB)49930000
           ELSE                                                         49940000
               COMPUTE PV-LINE-NBR =                                    49950000
                         ASC-ITEM-SUB + PC-ITEMS-PER-RTL-PANEL          49960000
               MOVE PV-LINE-NBR        TO MR-I-LINE-NBR-N (ASC-ITEM-SUB)49970000
           END-IF.                                                      49980000
           MOVE ASC-UPC    (ASC-BLK-SUB ASC-ITEM-SUB)                   49990000
                                       TO MR-I-UPC   (ASC-ITEM-SUB)     50000000
           IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES             50010000
               INSPECT ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)             50020000
                 REPLACING LEADING ' ' BY '0'                           50030000
               IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) NUMERIC          50040000
                   MOVE ASC-PRICE-N (ASC-BLK-SUB ASC-ITEM-SUB)          50050000
                                       TO MR-I-PRICE-N (ASC-ITEM-SUB)   50060000
               ELSE                                                     50070000
                   MOVE ASC-PRICE   (ASC-BLK-SUB ASC-ITEM-SUB)          50080000
                                       TO MR-I-PRICE   (ASC-ITEM-SUB)   50090000
               END-IF                                                   50100000
           ELSE                                                         50110000
               MOVE SPACES             TO MR-I-PRICE   (ASC-ITEM-SUB)   50120000
           END-IF.                                                      50130000
           MOVE ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                  50140000
                                       TO MR-I-QTY   (ASC-ITEM-SUB).    50150000
       EJECT                                                            50160000
      *----------------------------------------------------------------*50170000
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP FOR *50180000
      *    NON-RETAIL TRANSFER TYPES.                                  *50190000
      *----------------------------------------------------------------*50200000
                                                                        50210000
       4430-FORMAT-NRTL-LIST-LINES.                                     50220000
      *                                                                 50230000
           IF ASC-BLK-SUB = +1                                          50240000
               MOVE ASC-ITEM-SUB       TO MR-J-LINE-NBR-N (ASC-ITEM-SUB)50250000
           ELSE                                                         50260000
               COMPUTE PV-LINE-NBR =                                    50270000
                         ASC-ITEM-SUB + PC-ITEMS-PER-NRTL-PANEL         50280000
               MOVE PV-LINE-NBR        TO MR-J-LINE-NBR-N (ASC-ITEM-SUB)50290000
           END-IF.                                                      50300000
           MOVE ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB)                50310000
                                       TO MR-J-DESC  (ASC-ITEM-SUB).    50320000
           MOVE ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB)                  50330000
                                       TO MR-J-FIXTURE (ASC-ITEM-SUB).  50340000
           MOVE ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB)                50350000
                                       TO MR-J-DEPT (ASC-ITEM-SUB).     50360000
           MOVE ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                 50370000
                                       TO MR-J-QTY   (ASC-ITEM-SUB).    50380000
      *----------------------------------------------------------------*50390000
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *50400000
      *----------------------------------------------------------------*50410000
       4500-READ-STORE.                                                 50420000
           PERFORM WITH TEST AFTER                                      50430000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       50440000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  50450000
                    OR SQLCODE = ZERO                                   50460000
                    OR SQLCODE = +100                                   50470000
               EXEC SQL                                                 50480000
100404             SELECT LOC_10_ABBR_NM                                50490000
100404                   ,LOC_TYP_CDE                                   50500000
100404                   ,CLO_DTE                                       50510000
100404                 INTO :XST00001-LOC-10-ABBR-NM                    50520000
100404                   ,  :XST00001-LOC-TYP-CDE                       50530000
100404                   ,  :XST00001-CLO-DTE                           50540000
100404                 FROM XST_LOC                                     50550000
100404                WHERE LOC_NBR = :DK-STORE-NBR                     50560000
               END-EXEC                                                 50570000
               EVALUATE TRUE                                            50580000
                   WHEN SQLCODE = ZERO                                  50590000
100404                 MOVE XST00001-LOC-10-ABBR-NM TO ASC-TO-STORE-NAM 50600000
100404                 MOVE XST00001-LOC-TYP-CDE   TO ASC-TO-STORE-TYPE 50610000
                       SET PS-STORE-FOUND  TO TRUE                      50620000
                   WHEN SQLCODE = -904                                  50630000
                   WHEN SQLCODE = -913                                  50640000
                   WHEN SQLCODE = +100                                  50650000
                       CONTINUE                                         50660000
                   WHEN OTHER                                           50670000
                        MOVE '4500-READ-STORE'                          50680000
                                          TO DP013-PARAGRAPH            50690000
                        MOVE 'READ A ROW FROM THE STORE TABLE'          50700000
                                          TO DP013-MESSAGE-TEXT(1)      50710000
                        MOVE SQLCA        TO DP013-SQLCA                50720000
100404                  MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)   50730000
                        SET DP013-DB2-ABEND                             50740000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          50750000
                        PERFORM DP013-0000-PROCESS-ABEND                50760000
               END-EVALUATE                                             50770000
           END-PERFORM.                                                 50780000
                                                                        50790000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           50800000
               MOVE '4500-READ-STORE' TO DP013-PARAGRAPH                50810000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ'       50820000
                                          TO DP013-MESSAGE-TEXT (1)     50830000
               MOVE 'THE STORE TABLE'     TO DP013-MESSAGE-TEXT (2)     50840000
               MOVE SQLCA                 TO DP013-SQLCA                50850000
100404         MOVE 'XST_LOC'             TO DP013-DB2-TABLE-NAME (1)   50860000
               SET DP013-DB2-ABEND                                      50870000
                   DP013-XCTL-DISPLAY-RESTART                           50880000
                                          TO TRUE                       50890000
               PERFORM DP013-0000-PROCESS-ABEND                         50900000
           END-IF.                                                      50910000
      *----------------------------------------------------------------*50920000
      *  CHECK THAT THE STORE IS OPEN, OPEN TO RECEIVE, AND THAT THE   *50930000
      *  STORE TYPE IS VALID FOR THIS TRANSFER TYPE.                   *50940000
      *----------------------------------------------------------------*50950000
       4510-VALIDATE-STORE.                                             50960000
           MOVE ASC-TO-STORE-NBR-N   TO DK-STORE-NBR.                   50970000
                                                                        50980000
100404     PERFORM 7600-CHECK-IF-STORE-OPEN.                            50990000
           IF PS-DC-NOT-FOUND                                           51000000
               MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C                 51010000
               MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H                51020000
               IF ASC-NO-ERROR                                          51030000
                   MOVE ASC-TO-STORE-NBR TO DP020-MSG-TEXT              51040000
                   MOVE PC-TSYMSG-01552  TO DP020-MSG-NUMBER            51050000
                   SET DP020-MSG-FATAL    TO TRUE                       51060000
                   MOVE -1            TO MR-A-TO-STORE-NBR-L            51070000
                   SET DP030-SET-CURSOR-APPL-1                          51080000
                       ASC-ERROR          TO TRUE                       51090000
               END-IF                                                   51100000
           ELSE                                                         51110000
               EVALUATE ASC-XFER-TYPE                                   51120000
111703            WHEN PC-DEFECTIVE-DAMAGE-SORT1                        51130000
111703            WHEN PC-DEFECTIVE-DAMAGE-SORT2                        51140000
070111                PERFORM 7520-SELECT-RTV-SITE                      51150000
070111                IF ASC-TO-STORE-NBR-N NOT = ASC-RTV-NBR           51160000
122403                    MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C      51170000
122403                    MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H     51180000
122403                    IF ASC-NO-ERROR                               51190000
122403                       MOVE PC-TSYMSG-03208  TO DP020-MSG-NUMBER  51200000
122403                       SET DP020-MSG-FATAL    TO TRUE             51210000
122403                       MOVE -1            TO MR-A-TO-STORE-NBR-L  51220000
122403                       SET DP030-SET-CURSOR-APPL-1                51230000
122403                       ASC-ERROR          TO TRUE                 51240000
122403                    END-IF                                        51250000
122403                END-IF                                            51260000
                  WHEN PC-CALLBACK                                      51270000
122403                IF ASC-TO-STORE-NBR-N NOT = PC-RTV-811            51280000
122403                    MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C      51290000
122403                    MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H     51300000
122403                    IF ASC-NO-ERROR                               51310000
122403                       MOVE PC-TSYMSG-03208  TO DP020-MSG-NUMBER  51320000
122403                       SET DP020-MSG-FATAL    TO TRUE             51330000
122403                       MOVE -1            TO MR-A-TO-STORE-NBR-L  51340000
122403                       SET DP030-SET-CURSOR-APPL-1                51350000
122403                       ASC-ERROR          TO TRUE                 51360000
122403                    END-IF                                        51370000
122403                END-IF                                            51380000
                                                                        51390000
                  WHEN PC-NON-RETAIL                                    51400000
                      IF ASC-TO-STORE-TYPE NOT = PC-DEPT-STR AND        51410000
                         ASC-TO-STORE-TYPE NOT = PC-RTV      AND        51420000
                         ASC-TO-STORE-TYPE NOT = PC-DC                  51430000
                           MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C     51440000
                           MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H    51450000
                           IF ASC-NO-ERROR                              51460000
                             MOVE PC-TSYMSG-01479  TO DP020-MSG-NUMBER  51470000
                             SET DP020-MSG-FATAL    TO TRUE             51480000
                             MOVE -1            TO MR-A-TO-STORE-NBR-L  51490000
                             SET DP030-SET-CURSOR-APPL-1                51500000
                             ASC-ERROR          TO TRUE                 51510000
                           END-IF                                       51520000
                      END-IF                                            51530000
                  WHEN OTHER                                            51540000
                      IF ASC-TO-STORE-TYPE NOT = PC-DEPT-STR            51550000
                          MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C      51560000
                          MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H     51570000
                          IF ASC-NO-ERROR                               51580000
                             MOVE PC-TSYMSG-01479  TO DP020-MSG-NUMBER  51590000
                             SET DP020-MSG-FATAL    TO TRUE             51600000
                             MOVE -1            TO MR-A-TO-STORE-NBR-L  51610000
                             SET DP030-SET-CURSOR-APPL-1                51620000
                             ASC-ERROR          TO TRUE                 51630000
                           END-IF                                       51640000
                      END-IF                                            51650000
               END-EVALUATE                                             51660000
           END-IF.                                                      51670000
100404         IF XST00001-CLO-DTE    = PC-DEFAULT-CLOSED-DATE          51680000
                   CONTINUE                                             51690000
               ELSE                                                     51700000
                   PERFORM 3390-COMPARE-DATES                           51710000
                   IF DPG55-DAYS-DIFFERENCE IS NEGATIVE                 51720000
                       COMPUTE PV-DAYS-DIFFERENCE  =                    51730000
                              DPG55-DAYS-DIFFERENCE  *  -1              51740000
                       IF PV-DAYS-DIFFERENCE > PC-DAYS-IN-ONE-WEEK      51750000
                               CONTINUE                                 51760000
                       ELSE                                             51770000
                           MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C     51780000
                           MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H    51790000
                           IF ASC-NO-ERROR                              51800000
                               MOVE ASC-TO-STORE-NBR                    51810000
                                                      TO DP020-MSG-TEXT 51820000
                               MOVE PC-TSYMSG-01521                     51830000
                                                    TO DP020-MSG-NUMBER 51840000
                               SET DP020-MSG-FATAL  TO TRUE             51850000
                               MOVE -1         TO MR-A-TO-STORE-NBR-L   51860000
                               SET DP030-SET-CURSOR-APPL-1              51870000
                                   ASC-ERROR          TO TRUE           51880000
                           END-IF                                       51890000
                       END-IF                                           51900000
                   ELSE                                                 51910000
                       MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C         51920000
                       MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H        51930000
                       IF ASC-NO-ERROR                                  51940000
                           MOVE ASC-TO-STORE-NBR TO DP020-MSG-TEXT      51950000
                           MOVE PC-TSYMSG-00844  TO DP020-MSG-NUMBER    51960000
                           SET DP020-MSG-FATAL    TO TRUE               51970000
                           MOVE -1            TO MR-A-TO-STORE-NBR-L    51980000
                           SET DP030-SET-CURSOR-APPL-1                  51990000
                               ASC-ERROR          TO TRUE               52000000
                       END-IF                                           52010000
                   END-IF                                               52020000
      *        END-IF                                                   52030000
           END-IF.                                                      52040000
060110     MOVE ASC-TO-STORE-NBR-N   TO PV-LOC-EXCLUDE.                 52050000
060110     IF PV-EXCLUDE                                                52060000
060110          MOVE DP015-RED    TO MR-A-TO-STORE-NBR-C                52070000
060110          MOVE DP015-REVERSE TO MR-A-TO-STORE-NBR-H               52080000
060110          IF ASC-NO-ERROR                                         52090000
060110               MOVE ASC-TO-STORE-NBR TO DP020-MSG-TEXT            52100000
060110               MOVE PC-TSYMSG-01479  TO DP020-MSG-NUMBER          52110000
060110               SET DP020-MSG-FATAL   TO TRUE                      52120000
060110               MOVE -1               TO MR-A-TO-STORE-NBR-L       52130000
060110               SET DP030-SET-CURSOR-APPL-1                        52140000
060110                   ASC-ERROR         TO TRUE                      52150000
060110           END-IF                                                 52160000
060110     END-IF.                                                      52170000
                                                                        52180000
                                                                        52190000
       EJECT                                                            52200000
                                                                        52210000
      *----------------------------------------------------------------*52220000
      *  VALIDATE PRICE VS GROUP AND TICKETED USER ENTERED             *52230000
      *----------------------------------------------------------------*52240000
       4600-VALIDATE-PRICE.                                             52250000
           IF ASC-GROUP-PRICED-ITEM   (ASC-BLK-SUB ASC-ITEM-SUB)        52260000
               IF ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)                 52270000
                                   NOT = PV-CUR-RTL-AMT                 52280000
                   SET DP020-MSG-FATAL    TO TRUE                       52290000
      * -- THIS IS A GROUP PRICED ITEM; TRANSFER PRICE SHOULD BE --     52300000
                   MOVE DP015-RED             TO MR-I-PRICE-C           52310000
                                        (ASC-ITEM-SUB)                  52320000
                   MOVE DP015-REVERSE         TO MR-I-PRICE-H           52330000
                                        (ASC-ITEM-SUB)                  52340000
                   IF ASC-NO-ERROR                                      52350000
                       MOVE PV-CUR-RTL-AMT    TO PV-PRICE               52360000
                       MOVE PV-PRICE       TO DP020-MSG-TEXT            52370000
                       SET DP020-MSG-FATAL TO TRUE                      52380000
                       MOVE -1             TO MR-I-PRICE-L              52390000
                                        (ASC-ITEM-SUB)                  52400000
                       SET DP030-SET-CURSOR-APPL-4                      52410000
                           ASC-ERROR          TO TRUE                   52420000
                       MOVE PC-TSYMSG-01542   TO DP020-MSG-NUMBER       52430000
                   END-IF                                               52440000
               END-IF                                                   52450000
           ELSE                                                         52460000
             EVALUATE ASC-XFER-TYPE                                     52470000
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT1                          52480000
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT2                          52490000
                WHEN PC-CALLBACK                                        52500000
                   IF PS-NOT-CLR-ITM AND                                52510000
                      ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             52520000
                                  NOT = PV-CUR-RTL-AMT                  52530000
                       SET DP020-MSG-FATAL    TO TRUE                   52540000
      * -- TICKET PRICE MUST MATCH CURRENT FILE PRICE --                52550000
                       MOVE DP015-RED             TO MR-I-PRICE-C       52560000
                                        (ASC-ITEM-SUB)                  52570000
                       MOVE DP015-REVERSE         TO MR-I-PRICE-H       52580000
                                        (ASC-ITEM-SUB)                  52590000
                       IF ASC-NO-ERROR                                  52600000
                           MOVE PV-CUR-RTL-AMT    TO PC-TKT-PRICE       52610000
                           MOVE PC-TKT-MSG        TO DP020-MSG-TEXT     52620000
                           SET DP020-MSG-FATAL    TO TRUE               52630000
                           MOVE -1                TO MR-I-PRICE-L       52640000
                                        (ASC-ITEM-SUB)                  52650000
                           SET DP030-SET-CURSOR-APPL-4                  52660000
                               ASC-ERROR          TO TRUE               52670000
                       END-IF                                           52680000
                   END-IF                                               52690000
                                                                        52700000
                   IF PS-CLR-ITM AND                                    52710000
                      ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             52720000
                                  < PV-CUR-RTL-AMT                      52730000
                       SET DP020-MSG-FATAL    TO TRUE                   52740000
      * -- RED TICKET PRICE MUST NOT BE LOWER THAN CURRENT FILE PRICE   52750000
                       MOVE DP015-RED             TO MR-I-PRICE-C       52760000
                                        (ASC-ITEM-SUB)                  52770000
                       MOVE DP015-REVERSE         TO MR-I-PRICE-H       52780000
                                        (ASC-ITEM-SUB)                  52790000
                       IF ASC-NO-ERROR                                  52800000
                           MOVE PV-CUR-RTL-AMT    TO PC-RED-TKT-PRICE   52810000
                           MOVE PC-RED-TKT-MSG    TO DP020-MSG-TEXT     52820000
                           SET DP020-MSG-FATAL    TO TRUE               52830000
                           MOVE -1                TO MR-I-PRICE-L       52840000
                                        (ASC-ITEM-SUB)                  52850000
                           SET DP030-SET-CURSOR-APPL-4                  52860000
                               ASC-ERROR          TO TRUE               52870000
                       END-IF                                           52880000
                   END-IF                                               52890000
                                                                        52900000
                 WHEN PC-STOCK-BAL-STORE                                52910000
                 WHEN PC-STOCK-BAL-CORP                                 52920000
                 WHEN PC-CUSTOMER                                       52930000
                   IF PS-REGN-PRC-ITM AND                               52940000
                      ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             52950000
                                  NOT = PV-TO-PRICE                     52960000
                       SET DP020-MSG-FATAL    TO TRUE                   52970000
      * -- RETICKET AND COMPLETE AN INSTORE PRICE CHANGE --             52980000
                       MOVE DP015-RED             TO MR-I-PRICE-C       52990000
                                        (ASC-ITEM-SUB)                  53000000
                       MOVE DP015-REVERSE         TO MR-I-PRICE-H       53010000
                                        (ASC-ITEM-SUB)                  53020000
                       IF ASC-NO-ERROR                                  53030000
                           MOVE PV-TO-PRICE       TO PC-RCP-PRICE       53040000
                           MOVE PC-RCP-MSG        TO DP020-MSG-TEXT     53050000
                           SET DP020-MSG-FATAL    TO TRUE               53060000
                           MOVE -1                TO MR-I-PRICE-L       53070000
                                        (ASC-ITEM-SUB)                  53080000
                           SET DP030-SET-CURSOR-APPL-4                  53090000
                               ASC-ERROR          TO TRUE               53100000
                       END-IF                                           53110000
                   END-IF                                               53120000
                                                                        53130000
                   IF PS-NOT-REGN-PRC-ITM AND                           53140000
                      PS-NOT-CLR-ITM AND                                53150000
                      ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             53160000
                                  NOT = PV-CUR-RTL-AMT                  53170000
                       SET DP020-MSG-FATAL    TO TRUE                   53180000
      * -- TICKET PRICE MUST MATCH CURRENT FILE PRICE --                53190000
                       MOVE DP015-RED             TO MR-I-PRICE-C       53200000
                                        (ASC-ITEM-SUB)                  53210000
                       MOVE DP015-REVERSE         TO MR-I-PRICE-H       53220000
                                        (ASC-ITEM-SUB)                  53230000
                       IF ASC-NO-ERROR                                  53240000
                           MOVE PV-CUR-RTL-AMT    TO PC-TKT-PRICE       53250000
                           MOVE PC-TKT-MSG        TO DP020-MSG-TEXT     53260000
                           SET DP020-MSG-FATAL    TO TRUE               53270000
                           MOVE -1                TO MR-I-PRICE-L       53280000
                                        (ASC-ITEM-SUB)                  53290000
                           SET DP030-SET-CURSOR-APPL-4                  53300000
                               ASC-ERROR          TO TRUE               53310000
                       END-IF                                           53320000
                   END-IF                                               53330000
                                                                        53340000
                   IF PS-NOT-REGN-PRC-ITM AND                           53350000
                      PS-CLR-ITM AND                                    53360000
                      ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             53370000
                                  < PV-CUR-RTL-AMT                      53380000
                       SET DP020-MSG-FATAL    TO TRUE                   53390000
      * -- RED TICKET PRICE MUST NOT BE LOWER THAN CURRENT FILE PRICE   53400000
                       MOVE DP015-RED             TO MR-I-PRICE-C       53410000
                                        (ASC-ITEM-SUB)                  53420000
                       MOVE DP015-REVERSE         TO MR-I-PRICE-H       53430000
                                        (ASC-ITEM-SUB)                  53440000
                       IF ASC-NO-ERROR                                  53450000
                           MOVE PV-CUR-RTL-AMT    TO PC-RED-TKT-PRICE   53460000
                           MOVE PC-RED-TKT-MSG    TO DP020-MSG-TEXT     53470000
                           SET DP020-MSG-FATAL    TO TRUE               53480000
                           MOVE -1                TO MR-I-PRICE-L       53490000
                                        (ASC-ITEM-SUB)                  53500000
                           SET DP030-SET-CURSOR-APPL-4                  53510000
                               ASC-ERROR          TO TRUE               53520000
                       END-IF                                           53530000
                   END-IF.                                              53540000
       EJECT                                                            53550000
                                                                        53560000
                                                                        53570000
      *----------------------------------------------------------------*53580000
      * BASED ON INDICATOR CHECK IF MARKDOWN                           *53590000
      *----------------------------------------------------------------*53600000
       4700-CHK-CLR-ITM-1ST-MKDN.                                       53610000
           SET PS-NOT-REGN-PRC-ITM TO TRUE.                             53620000
      ******** PRICES ARE EQUAL *****                                   53630000
           SET PS-NOT-1ST-MKDN    TO TRUE.                              53640000
100404     IF PV-NREGN-LOC-SKU-STAT-CDE =  PC-CLEARANCE                 53650000
100404         IF PV-NREGN-UPC-STAT-CHG-DTE <  PV-NREGN-UNT-RTL-CHG-DTE 53660000
                   SET PS-CLR-ITM TO TRUE                               53670000
               ELSE                                                     53680000
                   SET PS-NOT-CLR-ITM     TO  TRUE                      53690000
               END-IF                                                   53700000
           ELSE                                                         53710000
      ******** NOT IN RED TICKET ****                                   53720000
               SET PS-NOT-CLR-ITM TO TRUE                               53730000
           END-IF.                                                      53740000
                                                                        53750000
      *----------------------------------------------------------------*53760000
      *  UPDATE AND INSERT ROWS IN THE APPROPRIATE TABLES FOR A CREATE *53770000
      *  OR SUSPEND FUNCTION.                                          *53780000
      *----------------------------------------------------------------*53790000
       5000-CREATE-WORKSHEET.                                           53800000
           INITIALIZE DCLTTFMSTR.                                       53810000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          53820000
           MOVE ASC-TO-STORE-NBR-N         TO TFMSTR-TO-STR-NBR.        53830000
           MOVE ASC-COMP-BY-INT            TO TFMSTR-CPLD-INIT-1ST-NM.  53840000
           MOVE ASC-COMP-BY-NAM            TO TFMSTR-CPLD-LAST-NM.      53850000
           MOVE ASC-ERROR-SW               TO TFMSTR-WRKSHT-PROB-IND.   53860000
           EVALUATE ASC-XFER-TYPE                                       53870000
             WHEN PC-STOCK-BAL-CORP                                     53880000
               MOVE ASC-APPROVAL-NBR-N     TO TFMSTR-STK-BAL-APVL-NBR   53890000
             WHEN PC-CALLBACK                                           53900000
               MOVE ASC-CALLBACK-NBR-N     TO TFMSTR-CLBK-NBR           53910000
             WHEN PC-CUSTOMER                                           53920000
               MOVE ASC-REQ-BY-INT         TO TFMSTR-RQSTR-INIT-1ST-NM  53930000
               MOVE ASC-REQ-BY-NAM         TO TFMSTR-RQSTR-LAST-NM      53940000
             WHEN PC-NON-RETAIL                                         53950000
               MOVE ASC-REQ-BY-INT         TO TFMSTR-RQSTR-INIT-1ST-NM  53960000
               MOVE ASC-REQ-BY-NAM         TO TFMSTR-RQSTR-LAST-NM      53970000
               MOVE ASC-ATTN-TO-INT        TO TFMSTR-ATTN-INIT-1ST-NM   53980000
               MOVE ASC-ATTN-TO-NAM        TO TFMSTR-ATTN-LAST-NM       53990000
           END-EVALUATE.                                                54000000
           EVALUATE ASC-CONTNR-TYPE                                     54010000
             WHEN PC-TRAILER                                            54020000
               MOVE ASC-TRAILER-NBR        TO TFMSTR-TRLR-NBR           54030000
               MOVE ASC-TRAILER-SEAL       TO TFMSTR-TRLR-SEAL-ID       54040000
             WHEN OTHER                                                 54050000
               MOVE ASC-LG-TOTE-SEAL1      TO TFMSTR-LG-TTE-1ST-SEAL-ID 54060000
               MOVE ASC-LG-TOTE-SEAL2      TO TFMSTR-LG-TTE-2ND-SEAL-ID 54070000
               MOVE ASC-SM-TOTE-SEAL       TO TFMSTR-SM-TTE-BAG-SEAL-ID 54080000
           END-EVALUATE.                                                54090000
           PERFORM 5100-UPDATE-TTFMSTR.                                 54100000
           IF ASC-XFER-TYPE = PC-CUSTOMER                               54110000
               IF ASC-CUSTOMER-EXISTS                                   54120000
                   PERFORM 7300-UPDATE-TTFCUST                          54130000
               ELSE                                                     54140000
                   PERFORM 5200-INSERT-TTFCUST                          54150000
               END-IF                                                   54160000
           END-IF.                                                      54170000
           PERFORM 5500-DELETE-XFER-ITEMS.                              54180000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         54190000
               PERFORM 5300-CHECK-RETAIL-ITEMS                          54200000
                 VARYING PV-BLOCK                                       54210000
                   FROM 1 BY 1 UNTIL                                    54220000
                         PV-BLOCK     > PC-MAX-BLOCKS-IN-ARRAY          54230000
                 AFTER PV-ITEM                                          54240000
                   FROM 1 BY 1 UNTIL                                    54250000
                         PV-ITEM > PC-ITEMS-PER-RTL-PANEL               54260000
           ELSE                                                         54270000
               PERFORM 5400-CHECK-NON-RETAIL-ITEMS                      54280000
                 VARYING PV-BLOCK                                       54290000
                   FROM 1 BY 1 UNTIL                                    54300000
                         PV-BLOCK     > PC-MAX-BLOCKS-IN-ARRAY          54310000
                 AFTER PV-ITEM                                          54320000
                   FROM 1 BY 1 UNTIL                                    54330000
                         PV-ITEM > PC-ITEMS-PER-NRTL-PANEL              54340000
           END-IF.                                                      54350000
      *----------------------------------------------------------------*54360000
      *  UPDATE THE TRANSFER MASTER TABLE WITH ENTERED DATA.           *54370000
      *----------------------------------------------------------------*54380000
       5100-UPDATE-TTFMSTR.                                             54390000
           PERFORM                                                      54400000
             WITH TEST AFTER                                            54410000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       54420000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  54430000
                    OR SQLCODE = ZERO                                   54440000
                    OR SQLCODE = +100                                   54450000
               EXEC SQL                                                 54460000
                 UPDATE TTFMSTR                                         54470000
                   SET  TO_STR_NBR         = :TFMSTR-TO-STR-NBR         54480000
                       ,CPLD_INIT_1ST_NM   = :TFMSTR-CPLD-INIT-1ST-NM   54490000
                       ,CPLD_LAST_NM       = :TFMSTR-CPLD-LAST-NM       54500000
                       ,LG_TTE_1ST_SEAL_ID = :TFMSTR-LG-TTE-1ST-SEAL-ID 54510000
                       ,LG_TTE_2ND_SEAL_ID = :TFMSTR-LG-TTE-2ND-SEAL-ID 54520000
                       ,SM_TTE_BAG_SEAL_ID = :TFMSTR-SM-TTE-BAG-SEAL-ID 54530000
                       ,TRLR_NBR           = :TFMSTR-TRLR-NBR           54540000
                       ,TRLR_SEAL_ID       = :TFMSTR-TRLR-SEAL-ID       54550000
                       ,CLBK_NBR           = :TFMSTR-CLBK-NBR           54560000
                       ,STK_BAL_APVL_NBR   = :TFMSTR-STK-BAL-APVL-NBR   54570000
                       ,RQSTR_INIT_1ST_NM  = :TFMSTR-RQSTR-INIT-1ST-NM  54580000
                       ,RQSTR_LAST_NM      = :TFMSTR-RQSTR-LAST-NM      54590000
                       ,ATTN_INIT_1ST_NM   = :TFMSTR-ATTN-INIT-1ST-NM   54600000
                       ,ATTN_LAST_NM       = :TFMSTR-ATTN-LAST-NM       54610000
                       ,WRKSHT_PROB_IND    = :TFMSTR-WRKSHT-PROB-IND    54620000
                   WHERE (XFER_DKEY_ID  = :DK-XFER-DKEY-ID)             54630000
               END-EXEC                                                 54640000
               EVALUATE TRUE                                            54650000
                   WHEN SQLCODE = ZERO                                  54660000
                   WHEN SQLCODE = -904                                  54670000
                   WHEN SQLCODE = -913                                  54680000
                       CONTINUE                                         54690000
                   WHEN OTHER                                           54700000
                       MOVE '5100-UPDATE-TTFMSTR'                       54710000
                                           TO DP013-PARAGRAPH           54720000
                       MOVE 'UPDATE A ROW IN TTFMSTR'                   54730000
                                           TO DP013-MESSAGE-TEXT (1)    54740000
                       MOVE SQLCA          TO DP013-SQLCA               54750000
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  54760000
                       SET DP013-DB2-ABEND TO TRUE                      54770000
                       PERFORM DP013-0000-PROCESS-ABEND                 54780000
               END-EVALUATE                                             54790000
           END-PERFORM.                                                 54800000
                                                                        54810000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           54820000
              MOVE '5100-UPDATE-TTFMSTR'                                54830000
                                           TO DP013-PARAGRAPH           54840000
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'54850000
                                           TO DP013-MESSAGE-TEXT (1)    54860000
              MOVE 'IN THE TRANSFER MASTER TABLE'                       54870000
                                           TO DP013-MESSAGE-TEXT (2)    54880000
              MOVE SQLCA                   TO DP013-SQLCA               54890000
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  54900000
              SET DP013-DB2-ABEND          TO TRUE                      54910000
              PERFORM DP013-0000-PROCESS-ABEND                          54920000
           END-IF.                                                      54930000
       EJECT                                                            54940000
      *----------------------------------------------------------------*54950000
      * INSERT A ROW INTO THE TRANSFER CUSTOMER TABLE.                 *54960000
      *----------------------------------------------------------------*54970000
       5200-INSERT-TTFCUST.                                             54980000
           INITIALIZE DCLTTFMSTR.                                       54990000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          55000000
           MOVE ASC-CUST-NAME              TO TFCUST-CUST-NM.           55010000
           MOVE ASC-ADDR1                  TO TFCUST-CUST-1ST-LNE-ADDR. 55020000
           MOVE ASC-ADDR2                  TO TFCUST-CUST-2ND-LNE-ADDR. 55030000
           MOVE ASC-CITY                   TO TFCUST-CTY-NM.            55040000
           MOVE ASC-STATE                  TO TFCUST-ST-CDE.            55050000
           MOVE ASC-ZIP                    TO TFCUST-ZIP-CDE.           55060000
           MOVE ASC-ZIP-EXT                TO TFCUST-ZIP-EXT-CDE.       55070000
           MOVE ASC-PHONE                  TO TFCUST-PHN-NBR.           55080000
           PERFORM WITH TEST AFTER                                      55090000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       55100000
               UNTIL SQLCODE = 0 OR                                     55110000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    55120000
                                                                        55130000
               EXEC SQL                                                 55140000
                    INSERT                                              55150000
                      INTO TTFCUST                                      55160000
                          (XFER_DKEY_ID                                 55170000
                         , CUST_NM                                      55180000
                         , CUST_1ST_LNE_ADDR                            55190000
                         , CUST_2ND_LNE_ADDR                            55200000
                         , CTY_NM                                       55210000
                         , ST_CDE                                       55220000
                         , ZIP_CDE                                      55230000
                         , ZIP_EXT_CDE                                  55240000
                         , PHN_NBR)                                     55250000
                    VALUES                                              55260000
                          (:DK-XFER-DKEY-ID                             55270000
                         , :TFCUST-CUST-NM                              55280000
                         , :TFCUST-CUST-1ST-LNE-ADDR                    55290000
                         , :TFCUST-CUST-2ND-LNE-ADDR                    55300000
                         , :TFCUST-CTY-NM                               55310000
                         , :TFCUST-ST-CDE                               55320000
                         , :TFCUST-ZIP-CDE                              55330000
                         , :TFCUST-ZIP-EXT-CDE                          55340000
                         , :TFCUST-PHN-NBR)                             55350000
               END-EXEC                                                 55360000
                                                                        55370000
               EVALUATE TRUE                                            55380000
                   WHEN SQLCODE = 0                                     55390000
                        SET ASC-CUSTOMER-EXISTS   TO TRUE               55400000
                   WHEN SQLCODE = -904                                  55410000
                   WHEN SQLCODE = -913                                  55420000
                        CONTINUE                                        55430000
                   WHEN OTHER                                           55440000
                        MOVE '5200-INSERT-TTFCUST'                      55450000
                                          TO DP013-PARAGRAPH            55460000
                        MOVE 'INSERT A ROW INTO THE TTFCUST TABLE'      55470000
                                          TO DP013-MESSAGE-TEXT(1)      55480000
                        MOVE SQLCA        TO DP013-SQLCA                55490000
                        MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)   55500000
                        SET DP013-DB2-ABEND                             55510000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          55520000
                        PERFORM DP013-0000-PROCESS-ABEND                55530000
               END-EVALUATE                                             55540000
           END-PERFORM.                                                 55550000
                                                                        55560000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           55570000
               MOVE '5200-INSERT-TTFCUST' TO DP013-PARAGRAPH            55580000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     55590000
                                          TO DP013-MESSAGE-TEXT (1)     55600000
               MOVE 'A TRANSFER CUST'     TO DP013-MESSAGE-TEXT (2)     55610000
               MOVE SQLCA                 TO DP013-SQLCA                55620000
               MOVE 'TTFCUST'             TO DP013-DB2-TABLE-NAME (1)   55630000
               SET DP013-DB2-ABEND                                      55640000
                   DP013-XCTL-DISPLAY-RESTART                           55650000
                                          TO TRUE                       55660000
               PERFORM DP013-0000-PROCESS-ABEND                         55670000
           END-IF.                                                      55680000
       EJECT                                                            55690000
      *----------------------------------------------------------------*55700000
      * IF QTY PRESENT BEGIN TO INSERT RETAIL ITEMS                    *55710000
      *----------------------------------------------------------------*55720000
       5300-CHECK-RETAIL-ITEMS.                                         55730000
           IF ASC-RTL-QTY (PV-BLOCK PV-ITEM) > SPACES                   55740000
               PERFORM 5350-INSERT-RETAIL-ITEMS                         55750000
           END-IF.                                                      55760000
      *----------------------------------------------------------------*55770000
      * INSERT RETAIL ITEMS.                                           *55780000
      *----------------------------------------------------------------*55790000
       5350-INSERT-RETAIL-ITEMS.                                        55800000
           INITIALIZE DCLTTFITEM.                                       55810000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          55820000
           IF PV-BLOCK = +1                                             55830000
               MOVE PV-ITEM                TO TFITEM-XFER-LNE-NBR       55840000
           ELSE                                                         55850000
               COMPUTE TFITEM-XFER-LNE-NBR =                            55860000
                      PV-ITEM + PC-ITEMS-PER-RTL-PANEL                  55870000
           END-IF.                                                      55880000
           IF ASC-UPC (PV-BLOCK PV-ITEM) > SPACES                       55890000
               MOVE ASC-UPC-N (PV-BLOCK PV-ITEM)                        55900000
                                           TO TFITEM-SCN-UPC-NBR        55910000
           END-IF.                                                      55920000
           MOVE ASC-KOHLS-UPC (PV-BLOCK PV-ITEM)                        55930000
                                           TO TFITEM-KOHLS-UPC-NBR.     55940000
           MOVE ASC-ITEM-NBR (PV-BLOCK PV-ITEM)                         55950000
                                           TO TFITEM-ITM-NBR.           55960000
           IF ASC-PRICE (PV-BLOCK PV-ITEM) NUMERIC                      55970000
               MOVE ASC-PRICE-N (PV-BLOCK PV-ITEM)                      55980000
                                           TO TFITEM-XFER-PRIC-AMT      55990000
           ELSE                                                         56000000
               MOVE ZEROES                 TO TFITEM-XFER-PRIC-AMT      56010000
           END-IF.                                                      56020000
           MOVE ASC-FILE-PRICE (PV-BLOCK PV-ITEM)                       56030000
                                           TO TFITEM-CPLD-RTL-PRIC-AMT. 56040000
           MOVE ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)                        56050000
                                           TO TFITEM-XFER-QTY.          56060000
           PERFORM WITH TEST AFTER                                      56070000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       56080000
               UNTIL SQLCODE = 0 OR                                     56090000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    56100000
                                                                        56110000
               EXEC SQL                                                 56120000
                    INSERT                                              56130000
                      INTO TTFITEM                                      56140000
                          (XFER_DKEY_ID                                 56150000
                         , XFER_LNE_NBR                                 56160000
                         , CPLD_RTL_PRIC_AMT                            56170000
                         , SCN_UPC_NBR                                  56180000
                         , KOHLS_UPC_NBR                                56190000
                         , ITM_NBR                                      56200000
                         , XFER_PRIC_AMT                                56210000
                         , XFER_QTY)                                    56220000
                    VALUES                                              56230000
                          (:DK-XFER-DKEY-ID                             56240000
                         , :TFITEM-XFER-LNE-NBR                         56250000
                         , :TFITEM-CPLD-RTL-PRIC-AMT                    56260000
                         , :TFITEM-SCN-UPC-NBR                          56270000
                         , :TFITEM-KOHLS-UPC-NBR                        56280000
                         , :TFITEM-ITM-NBR                              56290000
                         , :TFITEM-XFER-PRIC-AMT                        56300000
                         , :TFITEM-XFER-QTY)                            56310000
               END-EXEC                                                 56320000
                                                                        56330000
               EVALUATE TRUE                                            56340000
                   WHEN SQLCODE = ZERO                                  56350000
                   WHEN SQLCODE = -904                                  56360000
                   WHEN SQLCODE = -913                                  56370000
                        CONTINUE                                        56380000
                   WHEN OTHER                                           56390000
                        MOVE '5350-INSERT-RETAIL-ITEMS'                 56400000
                                          TO DP013-PARAGRAPH            56410000
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      56420000
                                          TO DP013-MESSAGE-TEXT(1)      56430000
                        MOVE SQLCA        TO DP013-SQLCA                56440000
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   56450000
                        SET DP013-DB2-ABEND                             56460000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          56470000
                        PERFORM DP013-0000-PROCESS-ABEND                56480000
               END-EVALUATE                                             56490000
           END-PERFORM.                                                 56500000
                                                                        56510000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           56520000
               MOVE '5350-INSERT-RETAIL-ITEMS' TO DP013-PARAGRAPH       56530000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     56540000
                                          TO DP013-MESSAGE-TEXT (1)     56550000
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     56560000
               MOVE SQLCA                 TO DP013-SQLCA                56570000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   56580000
               SET DP013-DB2-ABEND                                      56590000
                   DP013-XCTL-DISPLAY-RESTART                           56600000
                                          TO TRUE                       56610000
               PERFORM DP013-0000-PROCESS-ABEND                         56620000
           END-IF.                                                      56630000
       EJECT                                                            56640000
      *----------------------------------------------------------------*56650000
      * IF QTY PRESENT BEGIN TO INSERT NON-RETAIL ITEMS                *56660000
      *----------------------------------------------------------------*56670000
       5400-CHECK-NON-RETAIL-ITEMS.                                     56680000
           IF ASC-NRTL-QTY (PV-BLOCK PV-ITEM) > SPACES                  56690000
               PERFORM 5450-INSERT-NON-RETAIL-ITEMS                     56700000
           END-IF.                                                      56710000
      *----------------------------------------------------------------*56720000
      * INSERT NON-RETAIL ITEMS.                                       *56730000
      *----------------------------------------------------------------*56740000
       5450-INSERT-NON-RETAIL-ITEMS.                                    56750000
           INITIALIZE DCLTTFITEM.                                       56760000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          56770000
           IF PV-BLOCK = +1                                             56780000
               MOVE PV-ITEM                TO TFITEM-XFER-LNE-NBR       56790000
           ELSE                                                         56800000
               COMPUTE TFITEM-XFER-LNE-NBR =                            56810000
                      PV-ITEM + PC-ITEMS-PER-NRTL-PANEL                 56820000
           END-IF.                                                      56830000
           MOVE ASC-ITEM-DESC1 (PV-BLOCK PV-ITEM)                       56840000
                                           TO TFITEM-NRTL-1ST-LNE-DESC. 56850000
           MOVE ASC-ITEM-DESC2 (PV-BLOCK PV-ITEM)                       56860000
                                           TO TFITEM-NRTL-2ND-LNE-DESC. 56870000
           MOVE ASC-NRTL-QTY-N (PV-BLOCK PV-ITEM)                       56880000
                                           TO TFITEM-XFER-QTY.          56890000
           MOVE ASC-NRTL-DEPT (PV-BLOCK PV-ITEM)                        56900000
                                           TO TFITEM-NRTL-DEPT-NBR      56910000
           MOVE ASC-FIXTURE  (PV-BLOCK PV-ITEM)                         56920000
                                           TO TFITEM-NRTL-FIXT-ID.      56930000
           PERFORM WITH TEST AFTER                                      56940000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       56950000
               UNTIL SQLCODE = 0 OR                                     56960000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    56970000
                                                                        56980000
               EXEC SQL                                                 56990000
                    INSERT                                              57000000
                      INTO TTFITEM                                      57010000
                          (XFER_DKEY_ID                                 57020000
                         , XFER_LNE_NBR                                 57030000
                         , NRTL_1ST_LNE_DESC                            57040000
                         , NRTL_2ND_LNE_DESC                            57050000
                         , NRTL_FIXT_ID                                 57060000
                         , NRTL_DEPT_NBR                                57070000
                         , XFER_QTY)                                    57080000
                    VALUES                                              57090000
                          (:DK-XFER-DKEY-ID                             57100000
                         , :TFITEM-XFER-LNE-NBR                         57110000
                         , :TFITEM-NRTL-1ST-LNE-DESC                    57120000
                         , :TFITEM-NRTL-2ND-LNE-DESC                    57130000
                         , :TFITEM-NRTL-FIXT-ID                         57140000
                         , :TFITEM-NRTL-DEPT-NBR                        57150000
                         , :TFITEM-XFER-QTY)                            57160000
               END-EXEC                                                 57170000
                                                                        57180000
               EVALUATE TRUE                                            57190000
                   WHEN SQLCODE = ZERO                                  57200000
                   WHEN SQLCODE = -904                                  57210000
                   WHEN SQLCODE = -913                                  57220000
                        CONTINUE                                        57230000
                   WHEN OTHER                                           57240000
                        MOVE '5450-INSERT-NON-RETAIL-ITEMS'             57250000
                                          TO DP013-PARAGRAPH            57260000
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      57270000
                                          TO DP013-MESSAGE-TEXT(1)      57280000
                        MOVE SQLCA        TO DP013-SQLCA                57290000
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   57300000
                        SET DP013-DB2-ABEND                             57310000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          57320000
                        PERFORM DP013-0000-PROCESS-ABEND                57330000
               END-EVALUATE                                             57340000
           END-PERFORM.                                                 57350000
                                                                        57360000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           57370000
               MOVE '5450-INSERT-NON-RETAIL-ITEMS' TO DP013-PARAGRAPH   57380000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     57390000
                                          TO DP013-MESSAGE-TEXT (1)     57400000
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     57410000
               MOVE SQLCA                 TO DP013-SQLCA                57420000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   57430000
               SET DP013-DB2-ABEND                                      57440000
                   DP013-XCTL-DISPLAY-RESTART                           57450000
                                          TO TRUE                       57460000
               PERFORM DP013-0000-PROCESS-ABEND                         57470000
           END-IF.                                                      57480000
       EJECT                                                            57490000
      *----------------------------------------------------------------*57500000
      * DELETE TRANSFER ITEMS                                          *57510000
      *----------------------------------------------------------------*57520000
       5500-DELETE-XFER-ITEMS.                                          57530000
           MOVE ASC-XFER-DKEY-ID    TO DK-XFER-DKEY-ID.                 57540000
           PERFORM WITH TEST AFTER                                      57550000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       57560000
               UNTIL SQLCODE = 0    OR                                  57570000
                     SQLCODE = +100 OR                                  57580000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    57590000
               EXEC SQL                                                 57600000
                    DELETE FROM TTFITEM                                 57610000
                    WHERE  (XFER_DKEY_ID   =  :DK-XFER-DKEY-ID)         57620000
               END-EXEC                                                 57630000
                                                                        57640000
               EVALUATE TRUE                                            57650000
                   WHEN SQLCODE = ZERO                                  57660000
                   WHEN SQLCODE = +100                                  57670000
                   WHEN SQLCODE = -904                                  57680000
                   WHEN SQLCODE = -913                                  57690000
                      CONTINUE                                          57700000
                   WHEN OTHER                                           57710000
                      MOVE '5500-DELETE-XFER-ITEMS'                     57720000
                                             TO DP013-PARAGRAPH         57730000
                      MOVE 'DELETE TRANSFER ITEM FOR KEY: '             57740000
                                             TO DP013-MESSAGE-TEXT (1)  57750000
                      MOVE DK-XFER-DKEY-ID   TO PV-DISPLAY-XFER-DKEY-ID 57760000
                      MOVE PV-DISPLAY-XFER-DKEY-ID                      57770000
                                             TO DP013-MESSAGE-TEXT (2)  57780000
                      MOVE SQLCA             TO DP013-SQLCA             57790000
                      MOVE 'TTFITEM'         TO DP013-DB2-TABLE-NAME (1)57800000
                      SET DP013-DB2-ABEND    TO TRUE                    57810000
               END-EVALUATE                                             57820000
           END-PERFORM.                                                 57830000
                                                                        57840000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           57850000
               MOVE '5500-DELETE-XFER-ITEMS'       TO DP013-PARAGRAPH   57860000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     57870000
                                          TO DP013-MESSAGE-TEXT (1)     57880000
               MOVE 'TRANSFER ITEMS FOR:' TO DP013-MESSAGE-TEXT (2)     57890000
               MOVE DK-XFER-DKEY-ID       TO PV-DISPLAY-XFER-DKEY-ID    57900000
               MOVE PV-DISPLAY-XFER-DKEY-ID                             57910000
                                          TO DP013-MESSAGE-TEXT (3)     57920000
               MOVE SQLCA                 TO DP013-SQLCA                57930000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   57940000
               SET DP013-DB2-ABEND                                      57950000
                   DP013-XCTL-DISPLAY-RESTART                           57960000
                                          TO TRUE                       57970000
               PERFORM DP013-0000-PROCESS-ABEND                         57980000
           END-IF.                                                      57990000
      *----------------------------------------------------------------*58000000
      * SELECT DATA FROM THE TRANSFER TABLES WHEN PROCESSING AN         58010000
      * EXISTING WORKSHEET FROM THE CRITERIA SPEC SCREEN.              *58020000
      *----------------------------------------------------------------*58030000
       6000-GET-CONTROL-INFO.                                           58040000
           PERFORM                                                      58050000
               WITH TEST AFTER                                          58060000
               VARYING PV-RETRY-COUNT                                   58070000
               FROM 1 BY 1                                              58080000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 58090000
                         OR (SQLCODE = ZERO)                            58100000
                         OR (SQLCODE = +100))                           58110000
      *                                                                 58120000
               EXEC SQL                                                 58130000
                   SELECT ENTR_MTHD_TYP_CDE                             58140000
                         ,XFER_TYP_CDE                                  58150000
                         ,CONTNR_TYP_CDE                                58160000
                         ,FR_STR_NBR                                    58170000
                         ,TO_STR_NBR                                    58180000
                         ,CPLD_INIT_1ST_NM                              58190000
                         ,CPLD_LAST_NM                                  58200000
                         ,LG_TTE_1ST_SEAL_ID                            58210000
                         ,LG_TTE_2ND_SEAL_ID                            58220000
                         ,SM_TTE_BAG_SEAL_ID                            58230000
                         ,TRLR_NBR                                      58240000
                         ,TRLR_SEAL_ID                                  58250000
                         ,CLBK_NBR                                      58260000
                         ,STK_BAL_APVL_NBR                              58270000
                         ,RQSTR_INIT_1ST_NM                             58280000
                         ,RQSTR_LAST_NM                                 58290000
                         ,ATTN_INIT_1ST_NM                              58300000
                         ,ATTN_LAST_NM                                  58310000
100404                   ,LOC_10_ABBR_NM                                58320000
                   INTO   :TFMSTR-ENTR-MTHD-TYP-CDE                     58330000
                         ,:TFMSTR-XFER-TYP-CDE                          58340000
                         ,:TFMSTR-CONTNR-TYP-CDE                        58350000
                         ,:TFMSTR-FR-STR-NBR                            58360000
                         ,:TFMSTR-TO-STR-NBR                            58370000
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      58380000
                         ,:TFMSTR-CPLD-LAST-NM                          58390000
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    58400000
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    58410000
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    58420000
                         ,:TFMSTR-TRLR-NBR                              58430000
                         ,:TFMSTR-TRLR-SEAL-ID                          58440000
                         ,:TFMSTR-CLBK-NBR                              58450000
                         ,:TFMSTR-STK-BAL-APVL-NBR                      58460000
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     58470000
                         ,:TFMSTR-RQSTR-LAST-NM                         58480000
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      58490000
                         ,:TFMSTR-ATTN-LAST-NM                          58500000
100404                   ,:XST00001-LOC-10-ABBR-NM                      58510000
                   FROM   TTFMSTR A                                     58520000
100404                   ,XST_LOC B                                     58530000
100404                   WHERE  A.XFER_DKEY_ID   = :DK-XFER-DKEY-ID  AND58540000
100404                          A.TO_STR_NBR     = B.LOC_NBR            58550000
               END-EXEC                                                 58560000
                                                                        58570000
               EVALUATE TRUE                                            58580000
                   WHEN SQLCODE = ZERO                                  58590000
                      MOVE TFMSTR-XFER-TYP-CDE  TO ASC-XFER-TYPE        58600000
                      MOVE TFMSTR-CONTNR-TYP-CDE TO ASC-CONTNR-TYPE     58610000
                      MOVE TFMSTR-TO-STR-NBR    TO ASC-TO-STORE-NBR-N   58620000
                      MOVE TFMSTR-FR-STR-NBR    TO ASC-FR-STORE-NBR     58630000
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      58640000
                                                TO ASC-COMP-BY-INT      58650000
                      MOVE TFMSTR-CPLD-LAST-NM  TO ASC-COMP-BY-NAM      58660000
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    58670000
                                                TO ASC-LG-TOTE-SEAL1    58680000
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    58690000
                                                TO ASC-LG-TOTE-SEAL2    58700000
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    58710000
                                                TO ASC-SM-TOTE-SEAL     58720000
                      MOVE TFMSTR-TRLR-NBR      TO ASC-TRAILER-NBR      58730000
                      MOVE TFMSTR-TRLR-SEAL-ID  TO ASC-TRAILER-SEAL     58740000
                      MOVE TFMSTR-CLBK-NBR      TO ASC-CALLBACK-NBR-N   58750000
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      58760000
                                                TO ASC-APPROVAL-NBR-N   58770000
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     58780000
                                                TO ASC-REQ-BY-INT       58790000
                      MOVE TFMSTR-RQSTR-LAST-NM TO ASC-REQ-BY-NAM       58800000
                      MOVE TFMSTR-ATTN-INIT-1ST-NM                      58810000
                                                TO ASC-ATTN-TO-INT      58820000
                      MOVE TFMSTR-ATTN-LAST-NM  TO ASC-ATTN-TO-NAM      58830000
100404                MOVE XST00001-LOC-10-ABBR-NM                      58840000
                                                TO ASC-TO-STORE-NAM     58850000
                      IF ASC-XFER-TYPE = PC-CUSTOMER                    58860000
                          PERFORM 6100-READ-CUSTOMER                    58870000
                      END-IF                                            58880000
                      IF ASC-XFER-TYPE NOT = PC-NON-RETAIL              58890000
                          INITIALIZE ASC-RETAIL-ITEM-ARRAY (1)          58900000
                                     ASC-RETAIL-ITEM-ARRAY (2)          58910000
                          PERFORM 6110-OPEN-RTL-CURSOR                  58920000
                          PERFORM 6120-READ-RTL-ITEMS-FROM-DB           58930000
                          PERFORM 6130-CLOSE-RTL-CURSOR                 58940000
                      ELSE                                              58950000
                          INITIALIZE ASC-NON-RETAIL-ITEM-ARRAY (1)      58960000
                                     ASC-NON-RETAIL-ITEM-ARRAY (2)      58970000
                          PERFORM 6210-OPEN-NRTL-CURSOR                 58980000
                          PERFORM 6220-READ-NRTL-ITEMS-FROM-DB          58990000
                          PERFORM 6230-CLOSE-NRTL-CURSOR                59000000
                      END-IF                                            59010000
                                                                        59020000
                   WHEN SQLCODE = +100                                  59030000
                   WHEN SQLCODE = -904                                  59040000
                   WHEN SQLCODE = -913                                  59050000
                       CONTINUE                                         59060000
                   WHEN OTHER                                           59070000
                       MOVE '6000-GET-CONTROL-INFO'                     59080000
                                         TO DP013-PARAGRAPH             59090000
                       MOVE 'SELECT TRANSFER DATA'                      59100000
                                         TO DP013-MESSAGE-TEXT (1)      59110000
                       MOVE SQLCA        TO DP013-SQLCA                 59120000
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    59130000
100404                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (2)    59140000
                       SET DP013-DB2-ABEND                              59150000
                           DP013-XCTL-DISPLAY-RESTART                   59160000
                                         TO TRUE                        59170000
                       PERFORM DP013-0000-PROCESS-ABEND                 59180000
               END-EVALUATE                                             59190000
           END-PERFORM.                                                 59200000
      *                                                                 59210000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          59220000
               MOVE '6000-GET-CONTROL-INFO'                             59230000
                                         TO DP013-PARAGRAPH             59240000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     59250000
                                         TO DP013-MESSAGE-TEXT (1)      59260000
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      59270000
               MOVE SQLCA                TO DP013-SQLCA                 59280000
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    59290000
100404         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (2)    59300000
               SET DP013-DB2-ABEND                                      59310000
                   DP013-XCTL-DISPLAY-RESTART                           59320000
                                         TO TRUE                        59330000
               PERFORM DP013-0000-PROCESS-ABEND                         59340000
           END-IF.                                                      59350000
       EJECT                                                            59360000
      *----------------------------------------------------------------*59370000
      * SELECT DATA FROM THE TRANSFER THE CUSTOMER TABLE.              *59380000
      *----------------------------------------------------------------*59390000
       6100-READ-CUSTOMER.                                              59400000
           INITIALIZE DCLTTFCUST.                                       59410000
           PERFORM WITH TEST AFTER                                      59420000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       59430000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  59440000
                    OR SQLCODE = ZERO                                   59450000
                    OR SQLCODE = +100                                   59460000
               EXEC SQL                                                 59470000
                   SELECT CUST_NM                                       59480000
                         ,CUST_1ST_LNE_ADDR                             59490000
                         ,CUST_2ND_LNE_ADDR                             59500000
                         ,CTY_NM                                        59510000
                         ,ST_CDE                                        59520000
                         ,ZIP_CDE                                       59530000
                         ,ZIP_EXT_CDE                                   59540000
                         ,PHN_NBR                                       59550000
                       INTO :TFCUST-CUST-NM                             59560000
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   59570000
                           ,:TFCUST-CUST-2ND-LNE-ADDR                   59580000
                           ,:TFCUST-CTY-NM                              59590000
                           ,:TFCUST-ST-CDE                              59600000
                           ,:TFCUST-ZIP-CDE                             59610000
                           ,:TFCUST-ZIP-EXT-CDE                         59620000
                           ,:TFCUST-PHN-NBR                             59630000
                       FROM TTFCUST                                     59640000
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           59650000
               END-EXEC                                                 59660000
               EVALUATE TRUE                                            59670000
                   WHEN SQLCODE = ZERO                                  59680000
                       SET ASC-CUSTOMER-EXISTS                          59690000
                                          TO TRUE                       59700000
                       MOVE TFCUST-CUST-NM                              59710000
                                          TO ASC-CUST-NAME              59720000
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    59730000
                                          TO ASC-ADDR1                  59740000
                       MOVE TFCUST-CUST-2ND-LNE-ADDR                    59750000
                                          TO ASC-ADDR2                  59760000
                       MOVE TFCUST-CTY-NM                               59770000
                                          TO ASC-CITY                   59780000
                       MOVE TFCUST-ST-CDE                               59790000
                                          TO ASC-STATE                  59800000
                       MOVE TFCUST-ZIP-CDE                              59810000
                                          TO ASC-ZIP                    59820000
                       MOVE TFCUST-ZIP-EXT-CDE                          59830000
                                          TO ASC-ZIP-EXT                59840000
                       MOVE TFCUST-PHN-NBR                              59850000
                                          TO ASC-PHONE                  59860000
                   WHEN SQLCODE = +100                                  59870000
                       SET ASC-CUSTOMER-DOES-NOT-EXIST                  59880000
                                          TO TRUE                       59890000
                       MOVE 'NOT FOUND'   TO ASC-CUST-NAME              59900000
                   WHEN SQLCODE = -904                                  59910000
                   WHEN SQLCODE = -913                                  59920000
                       CONTINUE                                         59930000
                   WHEN OTHER                                           59940000
                       MOVE '6100-READ-CUSTOMER'                        59950000
                                         TO DP013-PARAGRAPH             59960000
                       MOVE 'READ DATA FROM TTFCUST'                    59970000
                                         TO DP013-MESSAGE-TEXT (1)      59980000
                       MOVE SQLCA        TO DP013-SQLCA                 59990000
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    60000000
                       SET DP013-DB2-ABEND                              60010000
                           DP013-XCTL-DISPLAY-RESTART                   60020000
                                         TO TRUE                        60030000
                       PERFORM DP013-0000-PROCESS-ABEND                 60040000
               END-EVALUATE                                             60050000
           END-PERFORM.                                                 60060000
      *                                                                 60070000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          60080000
               MOVE '6100-READ-CUSTOMER'                                60090000
                                         TO DP013-PARAGRAPH             60100000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     60110000
                                         TO DP013-MESSAGE-TEXT (1)      60120000
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      60130000
               MOVE SQLCA                TO DP013-SQLCA                 60140000
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    60150000
               SET DP013-DB2-ABEND                                      60160000
                   DP013-XCTL-DISPLAY-RESTART                           60170000
                                         TO TRUE                        60180000
               PERFORM DP013-0000-PROCESS-ABEND                         60190000
           END-IF.                                                      60200000
           EJECT                                                        60210000
      *----------------------------------------------------------------*60220000
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *60230000
      *----------------------------------------------------------------*60240000
       6110-OPEN-RTL-CURSOR.                                            60250000
           PERFORM                                                      60260000
               WITH TEST AFTER                                          60270000
               VARYING PV-RETRY-COUNT                                   60280000
               FROM 1 BY 1                                              60290000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 60300000
                         OR (SQLCODE = ZERO))                           60310000
                   EXEC SQL                                             60320000
                        OPEN RTL-ITEM-CSR                               60330000
                   END-EXEC                                             60340000
                                                                        60350000
               EVALUATE TRUE                                            60360000
                   WHEN SQLCODE = ZERO                                  60370000
                   WHEN SQLCODE = -904                                  60380000
                   WHEN SQLCODE = -913                                  60390000
                       CONTINUE                                         60400000
                   WHEN OTHER                                           60410000
                       MOVE '6110-OPEN-RTL-CURSOR'                      60420000
                                         TO DP013-PARAGRAPH             60430000
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              60440000
                                         TO DP013-MESSAGE-TEXT (1)      60450000
                       MOVE SQLCA        TO DP013-SQLCA                 60460000
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    60470000
                       SET DP013-DB2-ABEND                              60480000
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           60490000
                       PERFORM DP013-0000-PROCESS-ABEND                 60500000
               END-EVALUATE                                             60510000
           END-PERFORM.                                                 60520000
      *                                                                 60530000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          60540000
               MOVE '6110-OPEN-RTL-CURSOR'   TO DP013-PARAGRAPH         60550000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   60560000
                                         TO DP013-MESSAGE-TEXT (1)      60570000
               MOVE SQLCA                TO DP013-SQLCA                 60580000
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    60590000
               SET DP013-DB2-ABEND                                      60600000
                   DP013-XCTL-DISPLAY-RESTART                           60610000
                                         TO TRUE                        60620000
               PERFORM DP013-0000-PROCESS-ABEND                         60630000
           END-IF.                                                      60640000
                                                                        60650000
       EJECT                                                            60660000
      *----------------------------------------------------------------*60670000
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *60680000
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *60690000
      *    BECOME FULL, STOP PROCESSING. (RETAIL TRANSFERS)            *60700000
      *----------------------------------------------------------------*60710000
                                                                        60720000
       6120-READ-RTL-ITEMS-FROM-DB.                                     60730000
                                                                        60740000
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       60750000
           PERFORM                                                      60760000
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           60770000
                                                                        60780000
               PERFORM 6140-FETCH-RTL-ITEMS                             60790000
                                                                        60800000
               IF  ASC-ITEMS-LEFT-ON-DB                                 60810000
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-RTL-PANEL     60820000
                       MOVE +2           TO ASC-BLK-SUB                 60830000
                       SUBTRACT PC-ITEMS-PER-RTL-PANEL FROM             60840000
                                         TFITEM-XFER-LNE-NBR            60850000
                   ELSE                                                 60860000
                       MOVE +1           TO ASC-BLK-SUB                 60870000
                   END-IF                                               60880000
                   MOVE TFITEM-XFER-LNE-NBR TO ASC-ITEM-SUB             60890000
                   MOVE TFITEM-XFER-QTY                  TO             60900000
                           ASC-RTL-QTY-N     (ASC-BLK-SUB ASC-ITEM-SUB) 60910000
                   MOVE TFITEM-CPLD-RTL-PRIC-AMT         TO             60920000
                           ASC-FILE-PRICE    (ASC-BLK-SUB ASC-ITEM-SUB) 60930000
                   IF TFITEM-SCN-UPC-NBR > 0                            60940000
                       MOVE TFITEM-SCN-UPC-NBR           TO             60950000
                           ASC-UPC-N         (ASC-BLK-SUB ASC-ITEM-SUB) 60960000
                   END-IF                                               60970000
                   MOVE TFITEM-ITM-NBR                   TO             60980000
                           ASC-ITEM-NBR      (ASC-BLK-SUB ASC-ITEM-SUB) 60990000
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             61000000
                           ASC-KOHLS-UPC     (ASC-BLK-SUB ASC-ITEM-SUB) 61010000
                   MOVE TFITEM-XFER-PRIC-AMT             TO             61020000
                           ASC-PRICE-N       (ASC-BLK-SUB ASC-ITEM-SUB) 61030000
               END-IF                                                   61040000
           END-PERFORM.                                                 61050000
                                                                        61060000
       EJECT                                                            61070000
      *----------------------------------------------------------------*61080000
      * CLOSE THE TRANSFER ITEM CURSOR.                                *61090000
      *----------------------------------------------------------------*61100000
                                                                        61110000
       6130-CLOSE-RTL-CURSOR.                                           61120000
           EXEC SQL                                                     61130000
               CLOSE RTL-ITEM-CSR                                       61140000
           END-EXEC                                                     61150000
      *                                                                 61160000
           EVALUATE TRUE                                                61170000
               WHEN SQLCODE = ZERO                                      61180000
                   CONTINUE                                             61190000
               WHEN OTHER                                               61200000
                   MOVE '6130-CLOSE-RTL-CURSOR'                         61210000
                                     TO DP013-PARAGRAPH                 61220000
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   61230000
                                     TO DP013-MESSAGE-TEXT (1)          61240000
                   MOVE SQLCA        TO DP013-SQLCA                     61250000
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        61260000
                   SET DP013-DB2-ABEND                                  61270000
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               61280000
                   PERFORM DP013-0000-PROCESS-ABEND                     61290000
           END-EVALUATE.                                                61300000
                                                                        61310000
       EJECT                                                            61320000
      *----------------------------------------------------------------*61330000
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *61340000
      *----------------------------------------------------------------*61350000
                                                                        61360000
       6140-FETCH-RTL-ITEMS.                                            61370000
                                                                        61380000
           EXEC SQL                                                     61390000
               FETCH RTL-ITEM-CSR                                       61400000
               INTO                                                     61410000
                      :TFITEM-XFER-LNE-NBR                              61420000
                    , :TFITEM-CPLD-RTL-PRIC-AMT                         61430000
                    , :TFITEM-SCN-UPC-NBR                               61440000
                    , :TFITEM-KOHLS-UPC-NBR                             61450000
                    , :TFITEM-ITM-NBR                                   61460000
                    , :TFITEM-XFER-PRIC-AMT                             61470000
                    , :TFITEM-XFER-QTY                                  61480000
           END-EXEC                                                     61490000
                                                                        61500000
           EVALUATE TRUE                                                61510000
               WHEN SQLCODE = ZERO                                      61520000
                    CONTINUE                                            61530000
               WHEN SQLCODE = +100                                      61540000
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         61550000
                                         TO TRUE                        61560000
               WHEN OTHER                                               61570000
                    MOVE '6140-FETCH-RTL-ITEMS'                         61580000
                                     TO DP013-PARAGRAPH                 61590000
                    MOVE 'FETCH RETAIL TRANSFER ITEM CURSOR'            61600000
                                     TO DP013-MESSAGE-TEXT (1)          61610000
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        61620000
                    MOVE SQLCA       TO DP013-SQLCA                     61630000
                    SET DP013-DB2-ABEND                                 61640000
                                     TO TRUE                            61650000
                    PERFORM DP013-0000-PROCESS-ABEND                    61660000
           END-EVALUATE.                                                61670000
                                                                        61680000
       EJECT                                                            61690000
      *----------------------------------------------------------------*61700000
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *61710000
      *----------------------------------------------------------------*61720000
       6210-OPEN-NRTL-CURSOR.                                           61730000
           PERFORM                                                      61740000
               WITH TEST AFTER                                          61750000
               VARYING PV-RETRY-COUNT                                   61760000
               FROM 1 BY 1                                              61770000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 61780000
                         OR (SQLCODE = ZERO))                           61790000
                   EXEC SQL                                             61800000
                        OPEN NRTL-ITEM-CSR                              61810000
                   END-EXEC                                             61820000
                                                                        61830000
               EVALUATE TRUE                                            61840000
                   WHEN SQLCODE = ZERO                                  61850000
                   WHEN SQLCODE = -904                                  61860000
                   WHEN SQLCODE = -913                                  61870000
                       CONTINUE                                         61880000
                   WHEN OTHER                                           61890000
                       MOVE '6210-OPEN-NRTL-CURSOR'                     61900000
                                         TO DP013-PARAGRAPH             61910000
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              61920000
                                         TO DP013-MESSAGE-TEXT (1)      61930000
                       MOVE SQLCA        TO DP013-SQLCA                 61940000
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    61950000
                       SET DP013-DB2-ABEND                              61960000
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           61970000
                       PERFORM DP013-0000-PROCESS-ABEND                 61980000
               END-EVALUATE                                             61990000
           END-PERFORM.                                                 62000000
      *                                                                 62010000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          62020000
               MOVE '6210-OPEN-NRTL-CURSOR'   TO DP013-PARAGRAPH        62030000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   62040000
                                         TO DP013-MESSAGE-TEXT (1)      62050000
               MOVE SQLCA                TO DP013-SQLCA                 62060000
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    62070000
               SET DP013-DB2-ABEND                                      62080000
                   DP013-XCTL-DISPLAY-RESTART                           62090000
                                         TO TRUE                        62100000
               PERFORM DP013-0000-PROCESS-ABEND                         62110000
           END-IF.                                                      62120000
                                                                        62130000
       EJECT                                                            62140000
      *----------------------------------------------------------------*62150000
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *62160000
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *62170000
      *    BECOME FULL, STOP PROCESSING. (NON-RETAIL TRANSFERS)        *62180000
      *----------------------------------------------------------------*62190000
                                                                        62200000
       6220-READ-NRTL-ITEMS-FROM-DB.                                    62210000
                                                                        62220000
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       62230000
           PERFORM                                                      62240000
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           62250000
                                                                        62260000
               PERFORM 6240-FETCH-NRTL-ITEMS                            62270000
                                                                        62280000
               IF  ASC-ITEMS-LEFT-ON-DB                                 62290000
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-NRTL-PANEL    62300000
                       MOVE +2           TO ASC-BLK-SUB                 62310000
                       SUBTRACT PC-ITEMS-PER-NRTL-PANEL FROM            62320000
                                         TFITEM-XFER-LNE-NBR            62330000
                   ELSE                                                 62340000
                       MOVE +1           TO ASC-BLK-SUB                 62350000
                   END-IF                                               62360000
                   MOVE TFITEM-XFER-LNE-NBR TO ASC-ITEM-SUB             62370000
                   MOVE TFITEM-NRTL-FIXT-ID              TO             62380000
                           ASC-FIXTURE       (ASC-BLK-SUB ASC-ITEM-SUB) 62390000
                   MOVE TFITEM-NRTL-DEPT-NBR             TO             62400000
                           ASC-NRTL-DEPT     (ASC-BLK-SUB ASC-ITEM-SUB) 62410000
                   MOVE TFITEM-NRTL-1ST-LNE-DESC         TO             62420000
                           ASC-ITEM-DESC1    (ASC-BLK-SUB ASC-ITEM-SUB) 62430000
                   MOVE TFITEM-NRTL-2ND-LNE-DESC         TO             62440000
                           ASC-ITEM-DESC2    (ASC-BLK-SUB ASC-ITEM-SUB) 62450000
                   MOVE TFITEM-XFER-QTY                  TO             62460000
                           ASC-NRTL-QTY-N    (ASC-BLK-SUB ASC-ITEM-SUB) 62470000
               END-IF                                                   62480000
           END-PERFORM.                                                 62490000
                                                                        62500000
       EJECT                                                            62510000
      *----------------------------------------------------------------*62520000
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *62530000
      *----------------------------------------------------------------*62540000
                                                                        62550000
       6230-CLOSE-NRTL-CURSOR.                                          62560000
           EXEC SQL                                                     62570000
               CLOSE NRTL-ITEM-CSR                                      62580000
           END-EXEC                                                     62590000
      *                                                                 62600000
           EVALUATE TRUE                                                62610000
               WHEN SQLCODE = ZERO                                      62620000
                   CONTINUE                                             62630000
               WHEN OTHER                                               62640000
                   MOVE '6230-CLOSE-NRTL-CURSOR'                        62650000
                                     TO DP013-PARAGRAPH                 62660000
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   62670000
                                     TO DP013-MESSAGE-TEXT (1)          62680000
                   MOVE SQLCA        TO DP013-SQLCA                     62690000
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        62700000
                   SET DP013-DB2-ABEND                                  62710000
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               62720000
                   PERFORM DP013-0000-PROCESS-ABEND                     62730000
           END-EVALUATE.                                                62740000
                                                                        62750000
       EJECT                                                            62760000
      *----------------------------------------------------------------*62770000
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *62780000
      *----------------------------------------------------------------*62790000
                                                                        62800000
       6240-FETCH-NRTL-ITEMS.                                           62810000
                                                                        62820000
           EXEC SQL                                                     62830000
               FETCH NRTL-ITEM-CSR                                      62840000
               INTO                                                     62850000
                      :TFITEM-XFER-LNE-NBR                              62860000
                    , :TFITEM-NRTL-1ST-LNE-DESC                         62870000
                    , :TFITEM-NRTL-2ND-LNE-DESC                         62880000
                    , :TFITEM-NRTL-FIXT-ID                              62890000
                    , :TFITEM-NRTL-DEPT-NBR                             62900000
                    , :TFITEM-XFER-QTY                                  62910000
           END-EXEC                                                     62920000
                                                                        62930000
           EVALUATE TRUE                                                62940000
               WHEN SQLCODE = ZERO                                      62950000
                    CONTINUE                                            62960000
               WHEN SQLCODE = +100                                      62970000
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         62980000
                                         TO TRUE                        62990000
               WHEN OTHER                                               63000000
                    MOVE '6240-FETCH-NRTL-ITEMS'                        63010000
                                     TO DP013-PARAGRAPH                 63020000
                    MOVE 'FETCH NON-RETAIL TRANSFER ITEM CURSOR'        63030000
                                     TO DP013-MESSAGE-TEXT (1)          63040000
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        63050000
                    MOVE SQLCA       TO DP013-SQLCA                     63060000
                    SET DP013-DB2-ABEND                                 63070000
                                     TO TRUE                            63080000
                    PERFORM DP013-0000-PROCESS-ABEND                    63090000
           END-EVALUATE.                                                63100000
                                                                        63110000
       EJECT                                                            63120000
      *----------------------------------------------------------------*63130000
      * PRODUCE THE LIST REPORT USING THE DRS FACILITY.                *63140000
      *----------------------------------------------------------------*63150000
       6500-PRINT-LIST.                                                 63160000
                                                                        63170000
           PERFORM 6510-INITIALIZE.                                     63180000
           MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              63190000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         63200000
               PERFORM 6520-PRINT-RTL-REPORT                            63210000
                 VARYING PV-BLOCK                                       63220000
                   FROM 1 BY 1 UNTIL                                    63230000
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              63240000
                 AFTER PV-ITEM                                          63250000
                   FROM 1 BY 1                                          63260000
                   UNTIL PV-ITEM >  PC-ITEMS-PER-RTL-PANEL              63270000
           ELSE                                                         63280000
               PERFORM 6530-PRINT-NRTL-REPORT                           63290000
                 VARYING PV-BLOCK                                       63300000
                   FROM 1 BY 1 UNTIL                                    63310000
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              63320000
                 AFTER PV-ITEM                                          63330000
                   FROM 1 BY 1                                          63340000
                   UNTIL PV-ITEM >  PC-ITEMS-PER-NRTL-PANEL             63350000
           END-IF.                                                      63360000
                                                                        63370000
           MOVE PC-TERM                TO DRS01-DRRB-FUNC.              63380000
           PERFORM 8000-LINK-TO-DRS.                                    63390000
                                                                        63400000
      *----------------------------------------------------------------*63410000
      * INITIALIZE VARIABLES FOR DRS PRINTING.                         *63420000
      *----------------------------------------------------------------*63430000
       6510-INITIALIZE.                                                 63440000
           PERFORM 8100-FORMAT-TIME.                                    63450000
                                                                        63460000
           IF TF001-PRINTER-DEST = 'XXXX'                               63470000
               MOVE 'R'                TO DRS02-DRIB-CLASS              63480000
               MOVE 'N'                TO DRS02-DRIB-HOLD               63490000
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               63500000
           ELSE                                                         63510000
               MOVE 'A'                TO DRS02-DRIB-CLASS              63520000
               MOVE 'N'                TO DRS02-DRIB-HOLD               63530000
               MOVE TF001-PRINTER-DEST TO DRS02-DRIB-DEST               63540000
           END-IF.                                                      63550000
                                                                        63560000
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              63570000
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          63580000
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          63590000
                                                                        63600000
           PERFORM 8000-LINK-TO-DRS.                                    63610000
                                                                        63620000
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         63630000
           MOVE 1                       TO DP132O-REPORT-NUMBER.        63640000
           MOVE ASC-CONTROL-NBR         TO HL3-CONTROL-NBR.             63650000
           MOVE ASC-TO-STORE-NBR        TO HL3-TO-STORE-NBR.            63660000
           MOVE ASC-TO-STORE-NAM        TO HL3-TO-STORE-NAM.            63670000
           MOVE ASC-XFER-TYPE           TO HL4-XFER-TYPE.               63680000
           MOVE ASC-XFER-DESC           TO HL4-XFER-DESC.               63690000
           MOVE ASC-CONTNR-TYPE         TO HL4-CONTNR-TYPE.             63700000
           MOVE ASC-CONTNR-DESC         TO HL4-CONTNR-DESC.             63710000
           MOVE ASC-COMP-BY-INT         TO HL5-COMP-BY-INT.             63720000
           MOVE ASC-COMP-BY-NAM         TO HL5-COMP-BY-NAM.             63730000
           EVALUATE ASC-XFER-TYPE                                       63740000
              WHEN PC-CALLBACK                                          63750000
                 MOVE PC-CALLBACK-LITERAL                               63760000
                                        TO HL5-LITERAL                  63770000
                 MOVE ASC-CALLBACK-NBR  TO HL5-FIELD                    63780000
              WHEN PC-STOCK-BAL-CORP                                    63790000
                 MOVE PC-APPROVAL-LITERAL                               63800000
                                        TO HL5-LITERAL                  63810000
                 MOVE ASC-APPROVAL-NBR  TO HL5-FIELD                    63820000
              WHEN PC-NON-RETAIL                                        63830000
                 MOVE PC-REQUESTOR-LITERAL                              63840000
                                        TO HL5-LITERAL                  63850000
                 MOVE ASC-REQ-BY-INT    TO PV-INT                       63860000
                 MOVE ASC-REQ-BY-NAM    TO PV-LAST-NAME                 63870000
                 MOVE PV-NAME           TO HL5-FIELD                    63880000
                 MOVE ASC-ATTN-TO-INT   TO HL6A-ATTN-TO-INT             63890000
                 MOVE ASC-ATTN-TO-NAM   TO HL6A-ATTN-TO-NAM             63900000
              WHEN PC-CUSTOMER                                          63910000
                 MOVE PC-REQUESTOR-LITERAL                              63920000
                                        TO HL5-LITERAL                  63930000
                 MOVE ASC-REQ-BY-INT    TO PV-INT                       63940000
                 MOVE ASC-REQ-BY-NAM    TO PV-LAST-NAME                 63950000
                 MOVE PV-NAME           TO HL5-FIELD                    63960000
                 MOVE ASC-CUST-NAME     TO HL6B-CUST-NAME               63970000
                 MOVE ASC-PHONE-AREA    TO HL6B-PHONE-AREA              63980000
                 MOVE ASC-PHONE-EXCH    TO HL6B-PHONE-EXCH              63990000
                 MOVE ASC-PHONE-NBR     TO HL6B-PHONE-NBR               64000000
                 MOVE ASC-ADDR1         TO HL7-ADDRESS                  64010000
                 MOVE ASC-CITY          TO HL7-CITY                     64020000
                 MOVE ASC-ADDR2         TO HL8-ADDRESS                  64030000
                 MOVE ASC-STATE         TO HL8-STATE                    64040000
                 MOVE ASC-ZIP           TO HL8-ZIP                      64050000
                 IF ASC-ZIP-EXT > SPACES                                64060000
                     MOVE ASC-ZIP-EXT   TO HL8-ZIP-EXT                  64070000
                     MOVE '-'           TO HL8-DASH                     64080000
                 END-IF                                                 64090000
           END-EVALUATE.                                                64100000
           EVALUATE ASC-CONTNR-TYPE                                     64110000
              WHEN PC-TRAILER                                           64120000
                 MOVE PC-TRLR-SEAL-LITERAL                              64130000
                                        TO HL9-LITERAL-1                64140000
                 MOVE ASC-TRAILER-SEAL  TO HL9-FIELD-1                  64150000
                 MOVE PC-TRLR-NBR-LITERAL                               64160000
                                        TO HL9-LITERAL-2                64170000
                 MOVE ASC-TRAILER-NBR   TO HL9-FIELD-2                  64180000
              WHEN OTHER                                                64190000
                 MOVE PC-LG-TOTE-LITERAL                                64200000
                                        TO HL9-LITERAL-1                64210000
                 MOVE ASC-LG-TOTE-SEAL1 TO PV-LG-TOTE-SEAL1             64220000
                 MOVE ASC-LG-TOTE-SEAL2 TO PV-LG-TOTE-SEAL2             64230000
                 MOVE PV-LG-TOTE-FIELD  TO HL9-FIELD-1                  64240000
                 MOVE PC-SM-TOTE-LITERAL                                64250000
                                        TO HL9-LITERAL-2                64260000
                 MOVE ASC-SM-TOTE-SEAL  TO HL9-FIELD-2                  64270000
           END-EVALUATE.                                                64280000
                                                                        64290000
           MOVE 99                      TO PV-LINE-COUNT.               64300000
           MOVE 0                       TO PV-PAGE-COUNT.               64310000
       EJECT                                                            64320000
      *----------------------------------------------------------------*64330000
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *64340000
      *  RETAIL TRANSFER TYPES.                                        *64350000
      *----------------------------------------------------------------*64360000
       6520-PRINT-RTL-REPORT.                                           64370000
           IF PV-LINE-COUNT > PC-LINE-MAX                               64380000
               PERFORM 8200-PRINT-HEADINGS                              64390000
           END-IF.                                                      64400000
           IF PV-BLOCK = +2                                             64410000
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-RTL-PANEL   64420000
           ELSE                                                         64430000
               MOVE PV-ITEM              TO PV-LINE-NBR                 64440000
           END-IF.                                                      64450000
           DIVIDE PV-ITEM BY +2                                         64460000
               GIVING PV-SUB                                            64470000
                 REMAINDER PV-REMAINDER.                                64480000
           IF  PV-REMAINDER > ZERO                                      64490000
               MOVE PV-LINE-NBR          TO DL1A-LIN1                   64500000
               MOVE ASC-UPC (PV-BLOCK PV-ITEM)                          64510000
                                         TO DL1A-UPC1                   64520000
               IF ASC-PRICE (PV-BLOCK PV-ITEM) > SPACES                 64530000
                   MOVE ASC-PRICE-N (PV-BLOCK PV-ITEM)                  64540000
                                         TO DL1A-PRC1                   64550000
               END-IF                                                   64560000
               MOVE ASC-RTL-QTY (PV-BLOCK PV-ITEM)                      64570000
                                         TO DL1A-QTY1                   64580000
           ELSE                                                         64590000
               MOVE PV-LINE-NBR          TO DL1A-LIN2                   64600000
               MOVE ASC-UPC (PV-BLOCK PV-ITEM)                          64610000
                                         TO DL1A-UPC2                   64620000
               IF ASC-PRICE (PV-BLOCK PV-ITEM) > SPACES                 64630000
                   MOVE ASC-PRICE-N (PV-BLOCK PV-ITEM)                  64640000
                                         TO DL1A-PRC2                   64650000
               END-IF                                                   64660000
               MOVE ASC-RTL-QTY (PV-BLOCK PV-ITEM)                      64670000
                                         TO DL1A-QTY2                   64680000
               MOVE DL1A-DETAIL-LINE-1A                                 64690000
                                         TO DRS01-COMM-DATA             64700000
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              64710000
               PERFORM 8000-LINK-TO-DRS                                 64720000
               ADD 1                     TO PV-LINE-COUNT               64730000
               MOVE SPACES               TO DL1A-DETAIL-LINE-1A         64740000
           END-IF                                                       64750000
           IF PV-BLOCK = +2 AND                                         64760000
              PV-ITEM  = +1                                             64770000
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             64780000
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              64790000
               PERFORM 8000-LINK-TO-DRS                                 64800000
               ADD 1                   TO PV-LINE-COUNT                 64810000
           END-IF.                                                      64820000
       EJECT                                                            64830000
      *----------------------------------------------------------------*64840000
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *64850000
      *  RETAIL TRANSFER TYPES.                                        *64860000
      *----------------------------------------------------------------*64870000
       6530-PRINT-NRTL-REPORT.                                          64880000
           IF PV-LINE-COUNT > PC-LINE-MAX                               64890000
               PERFORM 8200-PRINT-HEADINGS                              64900000
           END-IF.                                                      64910000
           IF PV-BLOCK = +2 AND                                         64920000
              PV-ITEM  = +1                                             64930000
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             64940000
               MOVE PC-SINGLE-SPACE    TO DRS01-COMM-CTL                64950000
               PERFORM 8000-LINK-TO-DRS                                 64960000
               ADD 1                   TO PV-LINE-COUNT                 64970000
           END-IF.                                                      64980000
           IF PV-BLOCK = +2                                             64990000
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-NRTL-PANEL  65000000
           ELSE                                                         65010000
               MOVE PV-ITEM              TO PV-LINE-NBR                 65020000
           END-IF.                                                      65030000
           MOVE PV-LINE-NBR              TO DL1B-LINE                   65040000
           MOVE ASC-ITEM-DESC (PV-BLOCK PV-ITEM)                        65050000
                                         TO DL1B-DESCRIPTION            65060000
           MOVE ASC-NRTL-QTY  (PV-BLOCK PV-ITEM)                        65070000
                                         TO DL1B-QTY                    65080000
           MOVE ASC-FIXTURE (PV-BLOCK PV-ITEM)                          65090000
                                         TO DL1B-FIXTURE                65100000
           MOVE ASC-NRTL-DEPT (PV-BLOCK PV-ITEM)                        65110000
                                         TO DL1B-DEPT                   65120000
           MOVE DL1B-DETAIL-LINE-1B                                     65130000
                                         TO DRS01-COMM-DATA             65140000
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               65150000
           PERFORM 8000-LINK-TO-DRS.                                    65160000
           ADD 1                       TO PV-LINE-COUNT.                65170000
       EJECT                                                            65180000
      *----------------------------------------------------------------*65190000
      *  UPDATE AND INSERT ROWS IN THE APPROPRIATE TABLES WHEN THE     *65200000
      *  COMPLETE TRANSFER FUNCTION IS SELECTED.                       *65210000
      *----------------------------------------------------------------*65220000
       7000-COMPLETE-TRANSFER.                                          65230000
           PERFORM 7100-PREPARE-COMPLETE.                               65240000
           INITIALIZE DCLTTFMSTR.                                       65250000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          65260000
           MOVE ASC-TO-STORE-NBR-N         TO TFMSTR-TO-STR-NBR.        65270000
           MOVE ASC-COMP-BY-INT            TO TFMSTR-CPLD-INIT-1ST-NM.  65280000
           MOVE ASC-COMP-BY-NAM            TO TFMSTR-CPLD-LAST-NM.      65290000
           MOVE DP020-USERID               TO TFMSTR-CPLD-XFER-USR-ID.  65300000
           MOVE PV-XFER-SEQ-NBR            TO TFMSTR-XFER-SEQ-NBR       65310000
                                              ASC-XFER-SEQ-NBR.         65320000
           MOVE ASC-ERROR-SW               TO TFMSTR-WRKSHT-PROB-IND.   65330000
           EVALUATE ASC-XFER-TYPE                                       65340000
             WHEN PC-STOCK-BAL-CORP                                     65350000
               MOVE ASC-APPROVAL-NBR-N     TO TFMSTR-STK-BAL-APVL-NBR   65360000
             WHEN PC-CALLBACK                                           65370000
               MOVE ASC-CALLBACK-NBR-N     TO TFMSTR-CLBK-NBR           65380000
             WHEN PC-CUSTOMER                                           65390000
               MOVE ASC-REQ-BY-INT         TO TFMSTR-RQSTR-INIT-1ST-NM  65400000
               MOVE ASC-REQ-BY-NAM         TO TFMSTR-RQSTR-LAST-NM      65410000
             WHEN PC-NON-RETAIL                                         65420000
               MOVE ASC-REQ-BY-INT         TO TFMSTR-RQSTR-INIT-1ST-NM  65430000
               MOVE ASC-REQ-BY-NAM         TO TFMSTR-RQSTR-LAST-NM      65440000
               MOVE ASC-ATTN-TO-INT        TO TFMSTR-ATTN-INIT-1ST-NM   65450000
               MOVE ASC-ATTN-TO-NAM        TO TFMSTR-ATTN-LAST-NM       65460000
           END-EVALUATE.                                                65470000
           EVALUATE ASC-CONTNR-TYPE                                     65480000
             WHEN PC-TRAILER                                            65490000
               MOVE ASC-TRAILER-NBR        TO TFMSTR-TRLR-NBR           65500000
               MOVE ASC-TRAILER-SEAL       TO TFMSTR-TRLR-SEAL-ID       65510000
             WHEN OTHER                                                 65520000
               MOVE ASC-LG-TOTE-SEAL1      TO TFMSTR-LG-TTE-1ST-SEAL-ID 65530000
               MOVE ASC-LG-TOTE-SEAL2      TO TFMSTR-LG-TTE-2ND-SEAL-ID 65540000
               MOVE ASC-SM-TOTE-SEAL       TO TFMSTR-SM-TTE-BAG-SEAL-ID 65550000
           END-EVALUATE.                                                65560000
           EXEC SQL                                                     65570000
               SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP                65580000
           END-EXEC.                                                    65590000
           PERFORM 7200-COMPLETE-TTFMSTR                                65600000
           IF ASC-XFER-TYPE = PC-CUSTOMER                               65610000
               IF ASC-CUSTOMER-EXISTS                                   65620000
                   PERFORM 7300-UPDATE-TTFCUST                          65630000
               ELSE                                                     65640000
                   PERFORM 5200-INSERT-TTFCUST                          65650000
               END-IF                                                   65660000
           END-IF.                                                      65670000
           PERFORM 5500-DELETE-XFER-ITEMS.                              65680000
           MOVE 0                    TO PV-LINE-NBR.                    65690000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         65700000
               PERFORM 9000-CHECK-RETAIL-ITEMS                          65710000
                 VARYING ASC-BLK-SUB                                    65720000
                   FROM 1 BY 1 UNTIL                                    65730000
                         ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY          65740000
                 AFTER ASC-ITEM-SUB                                     65750000
                   FROM 1 BY 1 UNTIL                                    65760000
                         ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL          65770000
           ELSE                                                         65780000
               PERFORM 9200-CHECK-NON-RETAIL-ITEMS                      65790000
                 VARYING ASC-BLK-SUB                                    65800000
                   FROM 1 BY 1 UNTIL                                    65810000
                         ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY          65820000
                 AFTER ASC-ITEM-SUB                                     65830000
                   FROM 1 BY 1 UNTIL                                    65840000
                         ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL         65850000
           END-IF.                                                      65860000
           PERFORM 7400-INSERT-STATUS.                                  65870000
      *----------------------------------------------------------------*65880000
      *  DETERMINE THE NEXT SEQUENCE NUMBER TO BE ASSIGNED AS THE      *65890000
      *  TRANSFER NUMBER FOR THIS STORE.                               *65900000
      *----------------------------------------------------------------*65910000
       7100-PREPARE-COMPLETE.                                           65920000
           MOVE ASC-FR-STORE-NBR   TO DK-STORE-NBR.                     65930000
           PERFORM                                                      65940000
               WITH TEST AFTER                                          65950000
               VARYING PV-RETRY-COUNT                                   65960000
               FROM 1 BY 1                                              65970000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 65980000
                         OR (SQLCODE = ZERO)                            65990000
                         OR (SQLCODE = +100))                           66000000
      *                                                                 66010000
               EXEC SQL                                                 66020000
                   SELECT MAX(XFER_SEQ_NBR)                             66030000
                   INTO   :PV-XFER-SEQ-NBR                              66040000
                          :PV-NULL-IND                                  66050000
                   FROM   TTFMSTR                                       66060000
                   WHERE  FR_STR_NBR     = :DK-STORE-NBR        AND     66070000
                          XFER_SEQ_NBR   IS NOT NULL                    66080000
               END-EXEC                                                 66090000
                                                                        66100000
               EVALUATE TRUE                                            66110000
                   WHEN SQLCODE = ZERO                                  66120000
                   WHEN SQLCODE = +100                                  66130000
                   WHEN SQLCODE = -904                                  66140000
                   WHEN SQLCODE = -913                                  66150000
                       CONTINUE                                         66160000
                   WHEN OTHER                                           66170000
                       MOVE '7100-PREPARE-COMPLETE'                     66180000
                                         TO DP013-PARAGRAPH             66190000
                       MOVE 'SELECT TRANSFER DATA'                      66200000
                                         TO DP013-MESSAGE-TEXT (1)      66210000
                       MOVE SQLCA        TO DP013-SQLCA                 66220000
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    66230000
                       SET DP013-DB2-ABEND                              66240000
                           DP013-XCTL-DISPLAY-RESTART                   66250000
                                         TO TRUE                        66260000
                       PERFORM DP013-0000-PROCESS-ABEND                 66270000
               END-EVALUATE                                             66280000
           END-PERFORM.                                                 66290000
      *                                                                 66300000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          66310000
               MOVE '7100-PREPARE-COMPLETE'                             66320000
                                         TO DP013-PARAGRAPH             66330000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     66340000
                                         TO DP013-MESSAGE-TEXT (1)      66350000
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      66360000
               MOVE SQLCA                TO DP013-SQLCA                 66370000
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    66380000
               SET DP013-DB2-ABEND                                      66390000
                   DP013-XCTL-DISPLAY-RESTART                           66400000
                                         TO TRUE                        66410000
               PERFORM DP013-0000-PROCESS-ABEND                         66420000
           END-IF.                                                      66430000
           IF SQLCODE = +100                                            66440000
               MOVE +1                    TO PV-XFER-SEQ-NBR            66450000
           ELSE                                                         66460000
               IF PV-NULL-IND < 0                                       66470000
                   MOVE +1                TO PV-XFER-SEQ-NBR            66480000
               ELSE                                                     66490000
                   ADD +1                 TO PV-XFER-SEQ-NBR            66500000
               END-IF                                                   66510000
           END-IF.                                                      66520000
       EJECT                                                            66530000
      *----------------------------------------------------------------*66540000
      *  UPDATE THE TRANSFER MASTER TABLE WITH COMPLETE TRANSFER DATA. *66550000
      *----------------------------------------------------------------*66560000
       7200-COMPLETE-TTFMSTR.                                           66570000
           PERFORM                                                      66580000
             WITH TEST AFTER                                            66590000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       66600000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  66610000
                    OR SQLCODE = ZERO                                   66620000
                    OR SQLCODE = +100                                   66630000
               EXEC SQL                                                 66640000
                 UPDATE TTFMSTR                                         66650000
                   SET  XFER_SEQ_NBR       = :TFMSTR-XFER-SEQ-NBR       66660000
                       ,TO_STR_NBR         = :TFMSTR-TO-STR-NBR         66670000
                       ,CMPT_XFER_END_TMST = :PV-DB2-TIMESTAMP          66680000
                       ,CPLD_INIT_1ST_NM   = :TFMSTR-CPLD-INIT-1ST-NM   66690000
                       ,CPLD_LAST_NM       = :TFMSTR-CPLD-LAST-NM       66700000
                       ,LG_TTE_1ST_SEAL_ID = :TFMSTR-LG-TTE-1ST-SEAL-ID 66710000
                       ,LG_TTE_2ND_SEAL_ID = :TFMSTR-LG-TTE-2ND-SEAL-ID 66720000
                       ,SM_TTE_BAG_SEAL_ID = :TFMSTR-SM-TTE-BAG-SEAL-ID 66730000
                       ,TRLR_NBR           = :TFMSTR-TRLR-NBR           66740000
                       ,TRLR_SEAL_ID       = :TFMSTR-TRLR-SEAL-ID       66750000
                       ,CLBK_NBR           = :TFMSTR-CLBK-NBR           66760000
                       ,STK_BAL_APVL_NBR   = :TFMSTR-STK-BAL-APVL-NBR   66770000
                       ,RQSTR_INIT_1ST_NM  = :TFMSTR-RQSTR-INIT-1ST-NM  66780000
                       ,RQSTR_LAST_NM      = :TFMSTR-RQSTR-LAST-NM      66790000
                       ,ATTN_INIT_1ST_NM   = :TFMSTR-ATTN-INIT-1ST-NM   66800000
                       ,ATTN_LAST_NM       = :TFMSTR-ATTN-LAST-NM       66810000
                       ,CPLD_XFER_USR_ID   = :TFMSTR-CPLD-XFER-USR-ID   66820000
                       ,WRKSHT_PROB_IND    = :TFMSTR-WRKSHT-PROB-IND    66830000
                   WHERE (XFER_DKEY_ID  = :DK-XFER-DKEY-ID)             66840000
               END-EXEC                                                 66850000
               EVALUATE TRUE                                            66860000
                   WHEN SQLCODE = ZERO                                  66870000
                   WHEN SQLCODE = -904                                  66880000
                   WHEN SQLCODE = -913                                  66890000
                       CONTINUE                                         66900000
                   WHEN OTHER                                           66910000
                       MOVE '7200-COMPLETE-TTFMSTR'                     66920000
                                           TO DP013-PARAGRAPH           66930000
                       MOVE 'UPDATE A ROW IN TTFMSTR. XFER KEY:'        66940000
                                           TO DP013-MESSAGE-TEXT (1)    66950000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 66960000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     66970000
                                             TO DP013-MESSAGE-TEXT (2)  66980000
                       MOVE SQLCA          TO DP013-SQLCA               66990000
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  67000000
                       SET DP013-DB2-ABEND TO TRUE                      67010000
                       PERFORM DP013-0000-PROCESS-ABEND                 67020000
               END-EVALUATE                                             67030000
           END-PERFORM.                                                 67040000
                                                                        67050000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           67060000
              MOVE '7200-COMPLETE-TTFMSTR'                              67070000
                                           TO DP013-PARAGRAPH           67080000
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'67090000
                                           TO DP013-MESSAGE-TEXT (1)    67100000
              MOVE 'IN THE TRANSFER MASTER TABLE. XFERE KEY:'           67110000
                                           TO DP013-MESSAGE-TEXT (2)    67120000
              MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID          67130000
              MOVE PV-DISPLAY-XFER-DKEY-ID TO DP013-MESSAGE-TEXT (3)    67140000
              MOVE SQLCA                   TO DP013-SQLCA               67150000
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  67160000
              SET DP013-DB2-ABEND          TO TRUE                      67170000
              PERFORM DP013-0000-PROCESS-ABEND                          67180000
           END-IF.                                                      67190000
       EJECT                                                            67200000
      *----------------------------------------------------------------*67210000
      * UPDATE A ROW IN THE TRANSFER CUSTOMER TABLE.                   *67220000
      *----------------------------------------------------------------*67230000
       7300-UPDATE-TTFCUST.                                             67240000
           INITIALIZE DCLTTFMSTR.                                       67250000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          67260000
           MOVE ASC-CUST-NAME              TO TFCUST-CUST-NM.           67270000
           MOVE ASC-ADDR1                  TO TFCUST-CUST-1ST-LNE-ADDR. 67280000
           MOVE ASC-ADDR2                  TO TFCUST-CUST-2ND-LNE-ADDR. 67290000
           MOVE ASC-CITY                   TO TFCUST-CTY-NM.            67300000
           MOVE ASC-STATE                  TO TFCUST-ST-CDE.            67310000
           MOVE ASC-ZIP                    TO TFCUST-ZIP-CDE.           67320000
           MOVE ASC-ZIP-EXT                TO TFCUST-ZIP-EXT-CDE.       67330000
           MOVE ASC-PHONE                  TO TFCUST-PHN-NBR.           67340000
           PERFORM WITH TEST AFTER                                      67350000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       67360000
               UNTIL SQLCODE = 0 OR                                     67370000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    67380000
                                                                        67390000
               EXEC SQL                                                 67400000
                    UPDATE TTFCUST                                      67410000
                       SET CUST_NM           = :TFCUST-CUST-NM          67420000
                         , CUST_1ST_LNE_ADDR = :TFCUST-CUST-1ST-LNE-ADDR67430000
                         , CUST_2ND_LNE_ADDR = :TFCUST-CUST-2ND-LNE-ADDR67440000
                         , CTY_NM            = :TFCUST-CTY-NM           67450000
                         , ST_CDE            = :TFCUST-ST-CDE           67460000
                         , ZIP_CDE           = :TFCUST-ZIP-CDE          67470000
                         , ZIP_EXT_CDE       = :TFCUST-ZIP-EXT-CDE      67480000
                         , PHN_NBR           = :TFCUST-PHN-NBR          67490000
                   WHERE (XFER_DKEY_ID       = :DK-XFER-DKEY-ID)        67500000
               END-EXEC                                                 67510000
                                                                        67520000
               EVALUATE TRUE                                            67530000
                   WHEN SQLCODE = ZERO                                  67540000
                   WHEN SQLCODE = -904                                  67550000
                   WHEN SQLCODE = -913                                  67560000
                        CONTINUE                                        67570000
                   WHEN OTHER                                           67580000
                        MOVE '7300-UPDATE-TTFCUST'                      67590000
                                          TO DP013-PARAGRAPH            67600000
                        MOVE 'UPDATE A ROW IN THE TTFCUST TABLE'        67610000
                                          TO DP013-MESSAGE-TEXT(1)      67620000
                        MOVE SQLCA        TO DP013-SQLCA                67630000
                        MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)   67640000
                        SET DP013-DB2-ABEND                             67650000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          67660000
                        PERFORM DP013-0000-PROCESS-ABEND                67670000
               END-EVALUATE                                             67680000
           END-PERFORM.                                                 67690000
                                                                        67700000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           67710000
               MOVE '7300-UPDATE-TTFCUST' TO DP013-PARAGRAPH            67720000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     67730000
                                          TO DP013-MESSAGE-TEXT (1)     67740000
               MOVE 'A TRANSFER CUST'     TO DP013-MESSAGE-TEXT (2)     67750000
               MOVE SQLCA                 TO DP013-SQLCA                67760000
               MOVE 'TTFCUST'             TO DP013-DB2-TABLE-NAME (1)   67770000
               SET DP013-DB2-ABEND                                      67780000
                   DP013-XCTL-DISPLAY-RESTART                           67790000
                                          TO TRUE                       67800000
               PERFORM DP013-0000-PROCESS-ABEND                         67810000
           END-IF.                                                      67820000
       EJECT                                                            67830000
      *----------------------------------------------------------------*67840000
      *  INSERT A ROW IN THE TRANSFER STATUS TABLE FOR COMPLETE XFER.  *67850000
      *----------------------------------------------------------------*67860000
       7400-INSERT-STATUS.                                              67870000
           PERFORM WITH TEST AFTER                                      67880000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       67890000
               UNTIL SQLCODE = 0 OR                                     67900000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    67910000
               EXEC SQL                                                 67920000
                    INSERT                                              67930000
                      INTO TTFSTAT                                      67940000
                          (XFER_DKEY_ID                                 67950000
                         , XFER_STAT_TMST                               67960000
                         , XFER_STAT_CDE)                               67970000
                    VALUES                                              67980000
                          (:DK-XFER-DKEY-ID                             67990000
                         , :PV-DB2-TIMESTAMP                            68000000
                         , :PC-COMPLETE-STATUS)                         68010000
               END-EXEC                                                 68020000
                                                                        68030000
               EVALUATE TRUE                                            68040000
                   WHEN SQLCODE = ZERO                                  68050000
                   WHEN SQLCODE = -904                                  68060000
                   WHEN SQLCODE = -913                                  68070000
                        CONTINUE                                        68080000
                   WHEN OTHER                                           68090000
                        MOVE '7400-INSERT-STATUS'                       68100000
                                          TO DP013-PARAGRAPH            68110000
                        MOVE 'INSERT A ROW INTO THE TTFSTAT TABLE'      68120000
                                          TO DP013-MESSAGE-TEXT(1)      68130000
                        MOVE SQLCA        TO DP013-SQLCA                68140000
                        MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)   68150000
                        SET DP013-DB2-ABEND                             68160000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          68170000
                        PERFORM DP013-0000-PROCESS-ABEND                68180000
               END-EVALUATE                                             68190000
           END-PERFORM.                                                 68200000
                                                                        68210000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           68220000
               MOVE '7400-INSERT-STATUS' TO DP013-PARAGRAPH             68230000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     68240000
                                          TO DP013-MESSAGE-TEXT (1)     68250000
               MOVE 'A TRANSFER STATUS'   TO DP013-MESSAGE-TEXT (2)     68260000
               MOVE SQLCA                 TO DP013-SQLCA                68270000
               MOVE 'TTFSTAT'             TO DP013-DB2-TABLE-NAME (1)   68280000
               SET DP013-DB2-ABEND                                      68290000
                   DP013-XCTL-DISPLAY-RESTART                           68300000
                                          TO TRUE                       68310000
               PERFORM DP013-0000-PROCESS-ABEND                         68320000
           END-IF.                                                      68330000
       EJECT                                                            68340000
      *----------------------------------------------------------------*68350000
      *  GET RTV LOCATION FOR DC/LOCATION                              *68360000
      *----------------------------------------------------------------*68370000
070111 7520-SELECT-RTV-SITE.                                            68380000
                                                                        68390000
070111     MOVE ASC-FR-STORE-NBR          TO XST00020-LOC-NBR.          68400000
070111     MOVE ASC-XFER-TYPE             TO XST00135-XFER-TYP-CDE.     68410000
                                                                        68420000
070111     PERFORM WITH TEST AFTER                                      68430000
070111         VARYING PV-RETRY-COUNT FROM 1 BY 1                       68440000
070111           UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  68450000
070111              OR SQLCODE = ZERO                                   68460000
070111              OR SQLCODE = +100                                   68470000
070111         EXEC SQL                                                 68480000
070111           SELECT  B.DC_NBR                                       68490000
                        ,C.RTV_LOC_NBR                                  68500000
070111             INTO  :XST00020-DC-NBR                               68510000
070111                  ,:XST00135-RTV-LOC-NBR                          68520000
070111             FROM  XST_DC_LOC_ASGMT   B                           68530000
070111                  ,XST_RTV_LOC_RLTNSHP C                          68540000
070111            WHERE  B.LOC_NBR      = :XST00020-LOC-NBR             68550000
070111              AND  B.EFF_BEG_DTE  =                               68560000
070111                        (SELECT MAX(EFF_BEG_DTE)                  68570000
070111                           FROM XST_DC_LOC_ASGMT                  68580000
070111                          WHERE LOC_NBR = B.LOC_NBR)              68590000
                    AND  B.DC_NBR  = C.LOC_NBR                          68600000
                    AND  XFER_TYP_CDE = :XST00135-XFER-TYP-CDE          68610000
                    AND  C.EFF_BEG_DTE  =                               68620000
                       (SELECT MAX(EFF_BEG_DTE)                         68630000
C83065                     FROM XST_RTV_LOC_RLTNSHP                     68640000
CRQFIX                     WHERE LOC_NBR = C.LOC_NBR AND                68650000
CRQFIX                     XFER_TYP_CDE = :XST00135-XFER-TYP-CDE)       68660000
070111         END-EXEC                                                 68670000
070111         EVALUATE TRUE                                            68680000
070111             WHEN SQLCODE = ZERO                                  68690000
070111             WHEN SQLCODE = +100                                  68700000
070111             WHEN SQLCODE = -904                                  68710000
070111             WHEN SQLCODE = -913                                  68720000
070111                 CONTINUE                                         68730000
070111             WHEN OTHER                                           68740000
070111             MOVE '7520-SELECT-RTV-SITE'                          68750000
070111                                       TO DP013-PARAGRAPH         68760000
070111             MOVE ASC-FR-STORE-NBR     TO DP013-MESSAGE-TEXT (1)  68770000
070111             MOVE SQLCA                TO DP013-SQLCA             68780000
070111            MOVE 'XST_RTV_LOC_RLTNSHP' TO DP013-DB2-TABLE-NAME (1)68790000
070111             SET DP013-DB2-ABEND       TO TRUE                    68800000
070111             PERFORM DP013-0000-PROCESS-ABEND                     68810000
070111         END-EVALUATE                                             68820000
070111     END-PERFORM.                                                 68830000
070111*                                                                 68840000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          68850000
               MOVE '7520-SELECT-RTV-SITE'                              68860000
                                     TO DP013-PARAGRAPH                 68870000
100404         MOVE 'SELECT DATA FROM XST_RTV_LOC_RLTNSHP'              68880000
                                     TO DP013-MESSAGE-TEXT (1)          68890000
               MOVE SQLCA            TO DP013-SQLCA                     68900000
100404         MOVE 'XST_RTV_LOC_RLTNSHP' TO DP013-DB2-TABLE-NAME (1)   68910000
               SET DP013-DB2-ABEND                                      68920000
                   DP013-XCTL-DISPLAY-RESTART                           68930000
                                 TO TRUE                                68940000
               PERFORM DP013-0000-PROCESS-ABEND                         68950000
           END-IF.                                                      68960000
                                                                        68970000
070111     IF SQLCODE = 0                                               68980000
070111         MOVE XST00135-RTV-LOC-NBR TO PV-DC                       68990000
070111                                      ASC-RTV-NBR                 69000000
070111         PERFORM 7601-GET-RTV-NAME                                69010000
070111     ELSE                                                         69020000
070111         MOVE PC-RTV-811           TO PV-DC                       69030000
070111                                      ASC-RTV-NBR                 69040000
070111         MOVE PC-RV-FINDLAY-NAME   TO XST00001-LOC-10-ABBR-NM     69050000
070111     END-IF.                                                      69060000
                                                                        69070000
      *----------------------------------------------------------------*69080000
      *  CHECK IF LOCATION OPEN                                        *69090000
      *----------------------------------------------------------------*69100000
100404 7600-CHECK-IF-STORE-OPEN.                                        69110000
100404     EXEC SQL                                                     69120000
100404         SELECT LOC_NBR                                           69130000
100404           INTO :XST00001-LOC-NBR                                 69140000
100404           FROM XST_LOC                                           69150000
100404          WHERE (LOC_NBR        = :DK-STORE-NBR                   69160000
100404            AND (CHAR(OPN_DTE) <= CURRENT DATE                    69170000
100404            AND  CHAR(CLO_DTE)  > CURRENT DATE))                  69180000
100404     END-EXEC                                                     69190000
                                                                        69200000
100404     EVALUATE TRUE                                                69210000
100404         WHEN SQLCODE = ZERO                                      69220000
100404             SET PS-DC-FOUND         TO TRUE                      69230000
100404         WHEN SQLCODE = +100                                      69240000
100404             SET PS-DC-NOT-FOUND     TO TRUE                      69250000
100404         WHEN OTHER                                               69260000
100404             MOVE '7600-CHECK-IF-STORE-OPEN'                      69270000
100404                                       TO DP013-PARAGRAPH         69280000
100404             MOVE DK-STORE-NBR         TO DP013-MESSAGE-TEXT (1)  69290000
100404             MOVE SQLCA                TO DP013-SQLCA             69300000
100404             MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)69310000
100404             SET DP013-DB2-ABEND       TO TRUE                    69320000
100404             PERFORM DP013-0000-PROCESS-ABEND                     69330000
100404     END-EVALUATE.                                                69340000
                                                                        69350000
      *----------------------------------------------------------------*69360000
      *  GET NAME OF RTV LOCATION                                      *69370000
      *----------------------------------------------------------------*69380000
070111 7601-GET-RTV-NAME.                                               69390000
070111     EXEC SQL                                                     69400000
070111         SELECT LOC_10_ABBR_NM                                    69410000
070111           INTO :XST00001-LOC-10-ABBR-NM                          69420000
070111           FROM XST_LOC                                           69430000
070111          WHERE  LOC_NBR        = :XST00135-RTV-LOC-NBR           69440000
070111     END-EXEC                                                     69450000
                                                                        69460000
070111     EVALUATE TRUE                                                69470000
070111         WHEN SQLCODE = ZERO                                      69480000
070111             CONTINUE                                             69490000
070111         WHEN SQLCODE = +100                                      69500000
070111             CONTINUE                                             69510000
070111         WHEN OTHER                                               69520000
070111             MOVE '7601-GET-RTV-NAME'                             69530000
070111                                       TO DP013-PARAGRAPH         69540000
070111             MOVE XST00135-RTV-LOC-NBR TO DP013-MESSAGE-TEXT (1)  69550000
070111             MOVE SQLCA                TO DP013-SQLCA             69560000
070111             MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)69570000
070111             SET DP013-DB2-ABEND       TO TRUE                    69580000
070111             PERFORM DP013-0000-PROCESS-ABEND                     69590000
070111     END-EVALUATE.                                                69600000
                                                                        69610000
070111     IF SQLCODE = 0                                               69620000
070111         CONTINUE                                                 69630000
070111     ELSE                                                         69640000
070111         MOVE 'NOTFOUND'           TO XST00001-LOC-10-ABBR-NM     69650000
070111     END-IF.                                                      69660000
                                                                        69670000
      *----------------------------------------------------------------*69680000
      *  GET UNIT PRICE                                                *69690000
      *----------------------------------------------------------------*69700000
       7800-CHECK-REGN-PRC.                                             69710000
           PERFORM                                                      69720000
               WITH TEST AFTER                                          69730000
               VARYING PV-RETRY-COUNT                                   69740000
               FROM 1 BY 1                                              69750000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 69760000
                   OR (SQLCODE = +0)                                    69770000
                   OR (SQLCODE = +100))                                 69780000
               EXEC SQL                                                 69790000
100404             SELECT  LOC_SKU_STAT_CDE                             69800000
100404                    ,UNT_RTL_AMT                                  69810000
100404                    ,UPC_STAT_CHG_DTE                             69820000
100404                    ,UNT_RTL_CHG_DTE                              69830000
100404               INTO :PV-REGN-LOC-SKU-STAT-CDE                     69840000
100404                   ,:XST00008-UNT-RTL-AMT                         69850000
100404                   ,:PV-REGN-UPC-STAT-CHG-DTE                     69860000
100404                   ,:PV-REGN-UNT-RTL-CHG-DTE                      69870000
100404               FROM  XST_SKU_LOC A                                69880000
100404              WHERE  A.INTR_UPC_ID  = :XST00008-INTR-UPC-ID       69890000
100404                AND  A.LOC_NBR      = :DK-STORE-NBR               69900000
100404                AND  A.BEG_TMST    <= CURRENT TIMESTAMP           69910000
100404                AND  (A.END_TMST    > CURRENT TIMESTAMP           69920000
100404                 OR  A.END_TMST IS NULL)                          69930000
               END-EXEC                                                 69940000
                                                                        69950000
               EVALUATE TRUE                                            69960000
                   WHEN SQLCODE = ZERO                                  69970000
                       SET PS-REGN-CLR-FOUND     TO TRUE                69980000
100404                 MOVE XST00008-UNT-RTL-AMT TO PV-REGN-UNT-RTL-AMT 69990000
                   WHEN SQLCODE = +100                                  70000000
                       SET PS-REGN-CLR-NOT-FOUND TO TRUE                70010000
                   WHEN SQLCODE = -904                                  70020000
                   WHEN SQLCODE = -913                                  70030000
                       CONTINUE                                         70040000
                   WHEN OTHER                                           70050000
                       MOVE '7800-CHECK-REGN-PRC'                       70060000
                                             TO DP013-PARAGRAPH         70070000
100404                 MOVE 'SELECT DATA FROM XST_SKU_LOC'              70080000
                                             TO DP013-MESSAGE-TEXT (1)  70090000
                       MOVE SQLCA            TO DP013-SQLCA             70100000
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)70110000
                       SET DP013-DB2-ABEND                              70120000
                           DP013-XCTL-DISPLAY-RESTART                   70130000
                                         TO TRUE                        70140000
                       PERFORM DP013-0000-PROCESS-ABEND                 70150000
               END-EVALUATE                                             70160000
           END-PERFORM.                                                 70170000
                                                                        70180000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          70190000
               MOVE '7800-CHECK-REGN-PRC'                               70200000
                                     TO DP013-PARAGRAPH                 70210000
100404         MOVE 'SELECT DATA FROM XST_SKU_LOC'                      70220000
                                     TO DP013-MESSAGE-TEXT (1)          70230000
               MOVE SQLCA            TO DP013-SQLCA                     70240000
100404         MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)        70250000
               SET DP013-DB2-ABEND                                      70260000
                   DP013-XCTL-DISPLAY-RESTART                           70270000
                                 TO TRUE                                70280000
               PERFORM DP013-0000-PROCESS-ABEND                         70290000
           END-IF.                                                      70300000
      *                                                                 70310000
      *----------------------------------------------------------------*70320000
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     70330000
      *----------------------------------------------------------------*70340000
       8000-LINK-TO-DRS.                                                70350000
                                                                        70360000
           EXEC CICS                                                    70370000
               LINK                                                     70380000
                   PROGRAM   ('DRS1INTC')                               70390000
                   COMMAREA  (DRS01-COMMAREA)                           70400000
           END-EXEC.                                                    70410000
                                                                        70420000
      *----------------------------------------------------------------*70430000
      * FORMAT THE REPORT HEADING DATE AND TIME FIELDS.                 70440000
      *----------------------------------------------------------------*70450000
       8100-FORMAT-TIME.                                                70460000
                                                                        70470000
           EXEC CICS                                                    70480000
               ASKTIME ABSTIME (PV-ABSTIME)                             70490000
           END-EXEC.                                                    70500000
                                                                        70510000
           EXEC CICS                                                    70520000
               FORMATTIME ABSTIME  (PV-ABSTIME)                         70530000
                          MMDDYY   (DP132O-RUN-DATE)                    70540000
                          DATESEP  ('/')                                70550000
                          TIME     (DP132O-RUN-TIME)                    70560000
                          TIMESEP  (':')                                70570000
           END-EXEC.                                                    70580000
                                                                        70590000
       EJECT                                                            70600000
      *----------------------------------------------------------------*70610000
      *  PRINT THE REPORT HEADING LINES.                                70620000
      *----------------------------------------------------------------*70630000
       8200-PRINT-HEADINGS.                                             70640000
           ADD 1                       TO PV-PAGE-COUNT.                70650000
           MOVE 11                     TO PV-LINE-COUNT.                70660000
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           70670000
           MOVE DP132O-STANDRD-HEADER-132-COLS                          70680000
                                       TO DRS01-COMM-DATA.              70690000
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               70700000
           PERFORM 8000-LINK-TO-DRS.                                    70710000
                                                                        70720000
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              70730000
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               70740000
           PERFORM 8000-LINK-TO-DRS.                                    70750000
                                                                        70760000
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              70770000
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               70780000
           PERFORM 8000-LINK-TO-DRS.                                    70790000
                                                                        70800000
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              70810000
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               70820000
           PERFORM 8000-LINK-TO-DRS.                                    70830000
                                                                        70840000
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              70850000
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               70860000
           PERFORM 8000-LINK-TO-DRS.                                    70870000
                                                                        70880000
           EVALUATE ASC-XFER-TYPE                                       70890000
               WHEN PC-NON-RETAIL                                       70900000
                   MOVE HL6A-HEADING-LINE-6A                            70910000
                                       TO DRS01-COMM-DATA               70920000
                   MOVE PC-SINGLE-SPACE                                 70930000
                                       TO DRS01-COMM-CTL                70940000
                   PERFORM 8000-LINK-TO-DRS                             70950000
                   ADD 1               TO PV-LINE-COUNT                 70960000
               WHEN PC-CUSTOMER                                         70970000
                   MOVE HL6B-HEADING-LINE-6B                            70980000
                                       TO DRS01-COMM-DATA               70990000
                   MOVE PC-SINGLE-SPACE                                 71000000
                                       TO DRS01-COMM-CTL                71010000
                   PERFORM 8000-LINK-TO-DRS                             71020000
                   MOVE HL7-HEADING-LINE-7                              71030000
                                       TO DRS01-COMM-DATA               71040000
                   MOVE PC-SINGLE-SPACE                                 71050000
                                       TO DRS01-COMM-CTL                71060000
                   PERFORM 8000-LINK-TO-DRS                             71070000
                   MOVE HL8-HEADING-LINE-8                              71080000
                                       TO DRS01-COMM-DATA               71090000
                   MOVE PC-SINGLE-SPACE                                 71100000
                                       TO DRS01-COMM-CTL                71110000
                   PERFORM 8000-LINK-TO-DRS                             71120000
                   ADD 3               TO PV-LINE-COUNT                 71130000
           END-EVALUATE.                                                71140000
                                                                        71150000
           MOVE HL9-HEADING-LINE-9     TO DRS01-COMM-DATA.              71160000
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               71170000
           PERFORM 8000-LINK-TO-DRS.                                    71180000
                                                                        71190000
           EVALUATE TRUE                                                71200000
               WHEN ASC-RETAIL-XFER                                     71210000
                   MOVE HL10A-HEADING-LINE-10A                          71220000
                                       TO DRS01-COMM-DATA               71230000
                   MOVE PC-DOUBLE-SPACE                                 71240000
                                       TO DRS01-COMM-CTL                71250000
                   PERFORM 8000-LINK-TO-DRS                             71260000
               WHEN OTHER                                               71270000
                   MOVE HL10B-HEADING-LINE-10B                          71280000
                                       TO DRS01-COMM-DATA               71290000
                   MOVE PC-DOUBLE-SPACE                                 71300000
                                       TO DRS01-COMM-CTL                71310000
                   PERFORM 8000-LINK-TO-DRS                             71320000
           END-EVALUATE.                                                71330000
                                                                        71340000
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              71350000
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               71360000
           PERFORM 8000-LINK-TO-DRS.                                    71370000
       EJECT                                                            71380000
      *----------------------------------------------------------------*71390000
      *                                                                 71400000
      *----------------------------------------------------------------*71410000
       9000-CHECK-RETAIL-ITEMS.                                         71420000
           IF ASC-RTL-ITEM-NOT-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB)       71430000
                 AND ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    71440000
               MOVE ASC-RTL-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)            71450000
                                       TO PV-HOLD-QTY                   71460000
               SET ASC-RTL-ITEM-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB)      71470000
                                       TO TRUE                          71480000
               PERFORM 9050-COMPLETE-RETAIL-ITEMS                       71490000
                 VARYING PV-BLOCK                                       71500000
                   FROM ASC-BLK-SUB BY 1 UNTIL                          71510000
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              71520000
                 AFTER PV-ITEM                                          71530000
                   FROM 1 BY 1                                          71540000
                     UNTIL PV-ITEM >  PC-ITEMS-PER-RTL-PANEL            71550000
               PERFORM 9100-INSERT-RETAIL-ITEMS                         71560000
           END-IF.                                                      71570000
      *----------------------------------------------------------------*71580000
      *  CHECK IF UPDATED AND KOHLS SKU OR DUMMY, COMBINE QTY           71590000
      *----------------------------------------------------------------*71600000
       9050-COMPLETE-RETAIL-ITEMS.                                      71610000
           IF ASC-RTL-ITEM-NOT-UPDATED (PV-BLOCK PV-ITEM)               71620000
               IF ASC-KOHLS-UPC-DIGITS (PV-BLOCK PV-ITEM)               71630000
                                           = '0400' AND                 71640000
                  ASC-KOHLS-DUMMY-SKU (PV-BLOCK PV-ITEM)                71650000
                                           = '000'                      71660000
                   IF (ASC-KOHLS-UPC (PV-BLOCK PV-ITEM) =               71670000
                       ASC-KOHLS-UPC  (ASC-BLK-SUB ASC-ITEM-SUB)) AND   71680000
                      (ASC-PRICE (PV-BLOCK PV-ITEM) =                   71690000
                       ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB))            71700000
                        ADD ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)            71710000
                                        TO PV-HOLD-QTY                  71720000
                        SET ASC-RTL-ITEM-UPDATED (PV-BLOCK PV-ITEM)     71730000
                                        TO TRUE                         71740000
                   END-IF                                               71750000
               ELSE                                                     71760000
                   IF (ASC-ITEM-NBR  (PV-BLOCK PV-ITEM) =               71770000
                       ASC-ITEM-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)) AND    71780000
                      (ASC-PRICE (PV-BLOCK PV-ITEM) =                   71790000
                       ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB))            71800000
                        ADD ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)            71810000
                                        TO PV-HOLD-QTY                  71820000
                        SET ASC-RTL-ITEM-UPDATED (PV-BLOCK PV-ITEM)     71830000
                                        TO TRUE                         71840000
                   END-IF                                               71850000
               END-IF                                                   71860000
           END-IF.                                                      71870000
       EJECT                                                            71880000
      *----------------------------------------------------------------*71890000
      *  INSERT ITEMS TO TTFITEM TABLE                                  71900000
      *----------------------------------------------------------------*71910000
       9100-INSERT-RETAIL-ITEMS.                                        71920000
           INITIALIZE DCLTTFITEM.                                       71930000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          71940000
           ADD +1                          TO PV-LINE-NBR.              71950000
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      71960000
           IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES               71970000
               MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)                71980000
                                           TO TFITEM-SCN-UPC-NBR        71990000
           END-IF.                                                      72000000
           MOVE ASC-KOHLS-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                72010000
                                           TO TFITEM-KOHLS-UPC-NBR.     72020000
           MOVE ASC-ITEM-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)                72030000
                                           TO TFITEM-ITM-NBR.           72040000
           MOVE ASC-PRICE-N (ASC-BLK-SUB ASC-ITEM-SUB)                  72050000
                                           TO TFITEM-XFER-PRIC-AMT.     72060000
           MOVE ASC-FILE-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)               72070000
                                           TO TFITEM-CPLD-RTL-PRIC-AMT. 72080000
           MOVE ASC-GROUP-PRICED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          72090000
                                           TO TFITEM-ITM-PRIC-MLT-IND.  72100000
           MOVE PV-HOLD-QTY                TO TFITEM-XFER-QTY.          72110000
           PERFORM WITH TEST AFTER                                      72120000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       72130000
               UNTIL SQLCODE = 0 OR                                     72140000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    72150000
                                                                        72160000
               EXEC SQL                                                 72170000
                    INSERT                                              72180000
                      INTO TTFITEM                                      72190000
                          (XFER_DKEY_ID                                 72200000
                         , XFER_LNE_NBR                                 72210000
                         , CPLD_RTL_PRIC_AMT                            72220000
                         , SCN_UPC_NBR                                  72230000
                         , KOHLS_UPC_NBR                                72240000
                         , ITM_NBR                                      72250000
                         , XFER_PRIC_AMT                                72260000
                         , ITM_PRIC_MLT_IND                             72270000
                         , XFER_QTY)                                    72280000
                    VALUES                                              72290000
                          (:DK-XFER-DKEY-ID                             72300000
                         , :TFITEM-XFER-LNE-NBR                         72310000
                         , :TFITEM-CPLD-RTL-PRIC-AMT                    72320000
                         , :TFITEM-SCN-UPC-NBR                          72330000
                         , :TFITEM-KOHLS-UPC-NBR                        72340000
                         , :TFITEM-ITM-NBR                              72350000
                         , :TFITEM-XFER-PRIC-AMT                        72360000
                         , :TFITEM-ITM-PRIC-MLT-IND                     72370000
                         , :TFITEM-XFER-QTY)                            72380000
               END-EXEC                                                 72390000
                                                                        72400000
               EVALUATE TRUE                                            72410000
                   WHEN SQLCODE = 0                                     72420000
                   WHEN SQLCODE = -904                                  72430000
                   WHEN SQLCODE = -913                                  72440000
                        CONTINUE                                        72450000
                   WHEN OTHER                                           72460000
                        MOVE '9100-INSERT-RETAIL-ITEMS'                 72470000
                                          TO DP013-PARAGRAPH            72480000
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      72490000
                                          TO DP013-MESSAGE-TEXT(1)      72500000
                        MOVE SQLCA        TO DP013-SQLCA                72510000
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   72520000
                        SET DP013-DB2-ABEND                             72530000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          72540000
                        PERFORM DP013-0000-PROCESS-ABEND                72550000
               END-EVALUATE                                             72560000
           END-PERFORM.                                                 72570000
                                                                        72580000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           72590000
               MOVE '9100-INSERT-RETAIL-ITEMS' TO DP013-PARAGRAPH       72600000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     72610000
                                          TO DP013-MESSAGE-TEXT (1)     72620000
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     72630000
               MOVE SQLCA                 TO DP013-SQLCA                72640000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   72650000
               SET DP013-DB2-ABEND                                      72660000
                   DP013-XCTL-DISPLAY-RESTART                           72670000
                                          TO TRUE                       72680000
               PERFORM DP013-0000-PROCESS-ABEND                         72690000
           END-IF.                                                      72700000
       EJECT                                                            72710000
      *----------------------------------------------------------------*72720000
      *  QTY NOT SPACE INSERT NON RETAIL ITEMS                          72730000
      *----------------------------------------------------------------*72740000
       9200-CHECK-NON-RETAIL-ITEMS.                                     72750000
           IF ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES          72760000
               PERFORM 9300-INSERT-NON-RETAIL-ITEMS                     72770000
           END-IF.                                                      72780000
      *----------------------------------------------------------------*72790000
      *  INSERTS ITEMS TO TTFITEM TABLE                                 72800000
      *----------------------------------------------------------------*72810000
       9300-INSERT-NON-RETAIL-ITEMS.                                    72820000
           INITIALIZE DCLTTFITEM.                                       72830000
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          72840000
           ADD +1                          TO PV-LINE-NBR.              72850000
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      72860000
           MOVE ASC-ITEM-DESC1 (ASC-BLK-SUB ASC-ITEM-SUB)               72870000
                                           TO TFITEM-NRTL-1ST-LNE-DESC. 72880000
           MOVE ASC-ITEM-DESC2 (ASC-BLK-SUB ASC-ITEM-SUB)               72890000
                                           TO TFITEM-NRTL-2ND-LNE-DESC. 72900000
           MOVE ASC-NRTL-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)               72910000
                                           TO TFITEM-XFER-QTY.          72920000
           MOVE ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB)                72930000
                                           TO TFITEM-NRTL-DEPT-NBR      72940000
           MOVE ASC-FIXTURE  (ASC-BLK-SUB ASC-ITEM-SUB)                 72950000
                                           TO TFITEM-NRTL-FIXT-ID.      72960000
           PERFORM WITH TEST AFTER                                      72970000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       72980000
               UNTIL SQLCODE = 0 OR                                     72990000
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    73000000
                                                                        73010000
               EXEC SQL                                                 73020000
                    INSERT                                              73030000
                      INTO TTFITEM                                      73040000
                          (XFER_DKEY_ID                                 73050000
                         , XFER_LNE_NBR                                 73060000
                         , NRTL_1ST_LNE_DESC                            73070000
                         , NRTL_2ND_LNE_DESC                            73080000
                         , NRTL_FIXT_ID                                 73090000
                         , NRTL_DEPT_NBR                                73100000
                         , XFER_QTY)                                    73110000
                    VALUES                                              73120000
                          (:DK-XFER-DKEY-ID                             73130000
                         , :TFITEM-XFER-LNE-NBR                         73140000
                         , :TFITEM-NRTL-1ST-LNE-DESC                    73150000
                         , :TFITEM-NRTL-2ND-LNE-DESC                    73160000
                         , :TFITEM-NRTL-FIXT-ID                         73170000
                         , :TFITEM-NRTL-DEPT-NBR                        73180000
                         , :TFITEM-XFER-QTY)                            73190000
               END-EXEC                                                 73200000
                                                                        73210000
               EVALUATE TRUE                                            73220000
                   WHEN SQLCODE = 0                                     73230000
                   WHEN SQLCODE = -904                                  73240000
                   WHEN SQLCODE = -913                                  73250000
                        CONTINUE                                        73260000
                   WHEN OTHER                                           73270000
                        MOVE '9300-INSERT-NON-RETAIL-ITEMS'             73280000
                                          TO DP013-PARAGRAPH            73290000
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      73300000
                                          TO DP013-MESSAGE-TEXT(1)      73310000
                        MOVE SQLCA        TO DP013-SQLCA                73320000
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   73330000
                        SET DP013-DB2-ABEND                             73340000
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          73350000
                        PERFORM DP013-0000-PROCESS-ABEND                73360000
               END-EVALUATE                                             73370000
           END-PERFORM.                                                 73380000
                                                                        73390000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           73400000
               MOVE '9300-INSERT-NON-RETAIL-ITEMS' TO DP013-PARAGRAPH   73410000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     73420000
                                          TO DP013-MESSAGE-TEXT (1)     73430000
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     73440000
               MOVE SQLCA                 TO DP013-SQLCA                73450000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   73460000
               SET DP013-DB2-ABEND                                      73470000
                   DP013-XCTL-DISPLAY-RESTART                           73480000
                                          TO TRUE                       73490000
               PERFORM DP013-0000-PROCESS-ABEND                         73500000
           END-IF.                                                      73510000
       EJECT                                                            73520000
      *----------------------------------------------------------------*73530000
      *    ABEND PROCESSOR MODULE                                      *73540000
      *----------------------------------------------------------------*73550000
                                                                        73560000
           COPY DPPD013.                                                73570000
