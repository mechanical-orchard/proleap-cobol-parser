000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             IMKUT033.                                00050000
000600 AUTHOR.                 D. THEEL                                 00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            2/20/2007                                00080000
000900 DATE-COMPILED.                     .                             00090000
001000                                                                  00100000
001100*                                                                 00110000
001200*-----------------------------------------------------------------00120000
001300*    CREATE ITEM DOMAIN STYLE EXTRACT RECORDS SPECIFICALLY        00130000
      *      FOR THE EDW                                                00130100
001400*-----------------------------------------------------------------00140000
001500*    THE PURPOSE OF THIS PROGRAM IS TO READ IN THE BMC UNLOAD ITEM00150000
001600*    STYLE EXTRACT FILE, GET THE PRIVATE LABEL CODE AND WRITE OUT 00160002
      *    A STYLE LEVEL DOMAIN FILE FOR EDW.  THE INPUT FILE IS        00160102
001900*    SORTED BY LBL SEQ NBR TO MINIMIZE DB2 CALLS TO GET LABEL     00180000
      *    TYPE CODE.                                                   00180100
      *    WR/PITS#     DATE        DESCRIPTION                         00190009
      *    --------   --------     ---------------------------------    00191009
      *    WR31820    02/20/2007   INITIAL CREATION.                    00191110
      *    WR32284    07/15/2008   INITIAL INSTALL.                     00191120
002000*-----------------------------------------------------------------00193018
002100                                                                  00193100
002200******************************************************************00194000
002300 ENVIRONMENT DIVISION.                                            00195000
002400******************************************************************00196000
002500                                                                  00197000
002600 CONFIGURATION SECTION.                                           00198000
002700                                                                  00199000
002800 SOURCE-COMPUTER.        IBM-3090.                                00200000
002900 OBJECT-COMPUTER.        IBM-3090.                                00210000
003000                                                                  00220000
003100 INPUT-OUTPUT SECTION.                                            00230000
003200                                                                  00240000
003300 FILE-CONTROL.                                                    00250000
003400                                                                  00260000
003500     SELECT STYLE-UNLOAD-IN                                       00270000
003600         ASSIGN TO INP01.                                         00280000
003700                                                                  00290000
003800     SELECT STYLE-EDW-OUT                                         00300011
003900         ASSIGN TO OUT01.                                         00310000
004000                                                                  00320000
004400******************************************************************00360000
004500 DATA DIVISION.                                                   00370000
004600******************************************************************00380000
004700                                                                  00390000
004800 FILE SECTION.                                                    00400000
004900                                                                  00410000
005000 FD  STYLE-UNLOAD-IN                                              00420000
005100     RECORDING MODE IS F                                          00430000
005200     BLOCK CONTAINS 0 RECORDS                                     00440000
005300     LABEL RECORDS ARE STANDARD.                                  00450000
005400 01  STYLE-UNLOAD-IN-REC                PIC X(145).               00460021
005500                                                                  00470100
005600 FD  STYLE-EDW-OUT                                                00540021
005700     RECORDING MODE IS F                                          00550012
005800     BLOCK CONTAINS 0 RECORDS                                     00560012
005900     LABEL RECORDS ARE STANDARD.                                  00570012
006000 01  STYLE-EDW-OUT-REC                  PIC X(250).               00580021
006100                                                                  00590012
006800******************************************************************00600000
006900 WORKING-STORAGE SECTION.                                         00610000
007000******************************************************************00620000
007100 01  ABEND-CODE                         PIC S9(04)  VALUE +0      00630000
007200                                                    COMP SYNC.    00640000
007300 01  PC-PROGRAM-CONSTANTS.                                        00650000
007400     05  PC-PGM-NAME             PIC  X(08)     VALUE 'IMKUT033'. 00660000
007600     05  PC-MAX-RETRIES          PIC S9(04)     VALUE +2          00670000
007700                                                     COMP SYNC.   00680000
006800******************************************************************00680010
006900*THESE VALUES MUST EQUAL THEIR CHARTC CODE ON TVSCHAR             00680020
007000******************************************************************00680030
           05  PC-FBRCN                PIC S9(04)     VALUE +1 COMP.    00680100
           05  PC-TKT-TYP              PIC S9(04)     VALUE +2 COMP.    00680200
           05  PC-LBL                  PIC S9(04)     VALUE +3 COMP.    00680300
           05  PC-RTL-CLSN             PIC S9(04)     VALUE +6 COMP.    00680400
           05  PC-PATRN                PIC S9(04)     VALUE +7 COMP.    00680500
           05  PC-KY-CLSN              PIC S9(04)     VALUE +8 COMP.    00680600
           05  PC-FNSH                 PIC S9(04)     VALUE +9 COMP.    00680700
           05  PC-HNG-FOLD             PIC S9(04)     VALUE +10 COMP.   00680800
           05  PC-ESL                  PIC S9(04)     VALUE +19 COMP.   00680900
           05  PC-CLLCTN               PIC S9(04)     VALUE +20 COMP.   00680910
           05  PC-RPT-HIER             PIC S9(04)     VALUE +21 COMP.   00681000
           05  PC-FUNC                 PIC S9(04)     VALUE +22 COMP.   00681100
           05  PC-SLHTT                PIC S9(04)     VALUE +23 COMP.   00681200
           05  PC-BDY-STYL             PIC S9(04)     VALUE +24 COMP.   00681300
           05  PC-CONST                PIC S9(04)     VALUE +25 COMP.   00681400
           05  PC-GNDR                 PIC S9(04)     VALUE +26 COMP.   00681500
           05  PC-PRIC-TIER            PIC S9(04)     VALUE +31 COMP.   00681600
           05  PC-LFSTYL               PIC S9(04)     VALUE +32 COMP.   00681700
007800                                                                  00750000
007900 01  PS-PROGRAM-SWITCHES.                                         00760000
008000     05  PS-INPUT-IND                   PIC X(01)    VALUE 'N'.   00770000
008100         88  END-OF-INPUT                            VALUE 'Y'.   00780000
009100                                                                  00880000
009200 01  PV-PROGRAM-VARIABLES.                                        00890000
009300     05  PV-STYLE-RECS-WRITTEN          PIC S9(09) VALUE +0  COMP.00900016
009400     05  PV-STYLE-RECS-READ             PIC S9(09) VALUE +0  COMP.00910000
           05  PV-IMTLBL-SELECT-CT            PIC S9(09) VALUE +0  COMP.00910100
009700     05  PV-PARAGRAPH-NAME              PIC  X(30)  VALUE SPACE.  00940000
009800     05  PV-DB2-OPERATION               PIC  X(30)  VALUE SPACE.  00950000
009900     05  PV-RETRY-COUNT                 PIC S9(04)  VALUE ZERO    00960000
010000                                                    COMP SYNC.    00970000
           05  PV-DISPLAY-RMS-STYL-ID         PIC  9(8) VALUE ZERO.     00980009
           05  PV-PREV-LBL-SEQ                PIC S9(04) VALUE +0 COMP. 00980010
009100                                                                  00990009
012700*--------------------------------------------------               01070000
012800*  COPYBOOK FOR BMC STYLE UNLOAD INPUT FILE.                      01080000
012900*--------------------------------------------------               01100000
013000     COPY IMRD050.                                                01110000
013100                                                                  01120000
012700*--------------------------------------------------               01126011
012800*  COPYBOOK FOR ITEM STYLE EDW EXTRACT OUTPUT FILE.               01127021
012900*--------------------------------------------------               01128011
013000     COPY IMRD067.                                                01129011
013100                                                                  01130011
015210*--------------------------------------------------               01401000
015220*  ITEM LABEL TABLE                                               01402000
015230*--------------------------------------------------               01403000
015240     EXEC SQL                                                     01404000
015250         INCLUDE IMT00000                                         01405003
015260     END-EXEC.                                                    01406000
015270                                                                  01407000
015300*--------------------------------------------------               01410000
015400*  COMMUNICATION AREA FOR DB2                                     01420000
015500*--------------------------------------------------               01430000
015600     EXEC SQL                                                     01440000
015700         INCLUDE SQLCA                                            01450000
015800     END-EXEC.                                                    01460000
015900                                                                  01470000
016000*--------------------------------------------------               01480000
016100*  DB2 SQL ERROR ROUTINE                                          01490000
016200*--------------------------------------------------               01500000
016300     COPY DPWS004.                                                01510000
016400                                                                  01520000
016500 PROCEDURE DIVISION.                                              01530000
016600*-----------------------------------------------------------------01540000
016700*  MAIN LINE OF THE PROGRAM PERFORMS THE                          01550000
016800*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. 01560000
016900*-----------------------------------------------------------------01570000
017000 0000-MAINLINE.                                                   01580000
017100                                                                  01590000
017200     PERFORM 0100-HOUSEKEEPING.                                   01600000
017300                                                                  01610000
017400     PERFORM 1000-PROCESS-INPUT-FILE                              01620000
017500         UNTIL END-OF-INPUT.                                      01630000
017600                                                                  01640000
017700     PERFORM 9000-EOJ.                                            01650000
017800     GOBACK.                                                      01660000
017900                                                                  01670000
018000*-----------------------------------------------------------------01680000
018100*  OPEN FILES AND PERFORM FIRST READ FROM INPUT FILE              01690000
018200*-----------------------------------------------------------------01700000
018300 0100-HOUSEKEEPING.                                               01710000
018400                                                                  01720000
018500     OPEN INPUT STYLE-UNLOAD-IN                                   01730000
018600          OUTPUT STYLE-EDW-OUT.                                   01740021
018800                                                                  01760000
020800     PERFORM 6000-READ-STYLE-UNLOAD-FILE.                         01960000
020900                                                                  01970000
021000     IF END-OF-INPUT                                              01980000
021100        DISPLAY '*** '                                            01990000
021200        DISPLAY '*** IMKUT033 - NO INPUT STYLE RECS FOUND'        02000000
021300        DISPLAY '*** '                                            02010000
021400        MOVE +4003 TO ABEND-CODE                                  02020000
021500        PERFORM 9999-ABEND                                        02030000
021600     END-IF.                                                      02040000
021700                                                                  02050000
021800*-----------------------------------------------------------------02060000
021900*  PROCESS ALL INPUT RECORDS AND FORMAT ITEM STYLE DOMAIN EXTRACT 02070000
022000*  RECORDS UNTIL END OF INPUT FILE.                               02080000
022100*-----------------------------------------------------------------02090000
022200 1000-PROCESS-INPUT-FILE.                                         02100000
022300                                                                  02110000
           MOVE IM050-RMS-STYL-ID TO PV-DISPLAY-RMS-STYL-ID.            02120009
           IF IM050-LBL-SEQ-NBR = ZERO                                  02120010
               MOVE SPACE TO IM067-LBL-TYP-CDE                          02120011
           ELSE                                                         02120012
               IF PV-PREV-LBL-SEQ = IM050-LBL-SEQ-NBR                   02120013
                   MOVE IMT00000-LBL-TYP-CDE TO IM067-LBL-TYP-CDE       02120015
               ELSE                                                     02120020
                   PERFORM 1400-GET-LBL-TYP-CDE                         02120030
               END-IF                                                   02120040
           END-IF.                                                      02291202
028360                                                                  02303021
022900     PERFORM 1200-MOVE-DATA-TO-OUTPUT-REC.                        02303100
028360                                                                  02303201
028600***  WRITE STYLE OUTPUT RECORD                                    02303321
028700     PERFORM 7000-WRITE-STYLE-OUTPUT-REC.                         02303421
                                                                        02303502
029200     PERFORM 6000-READ-STYLE-UNLOAD-FILE.                         02304000
024300                                                                  02310000
024400*-----------------------------------------------------------------02320000
024500* MOVE VALUES TO OUTPUT RECORD                                    02330000
024600*-----------------------------------------------------------------02340000
024700 1200-MOVE-DATA-TO-OUTPUT-REC.                                    02350000
024800                                                                  02360000
026000     MOVE IM050-RMS-STYL-ID       TO IM067-RMS-STYL-ID.           02360010
026100     MOVE IM050-DEPT-NBR          TO IM067-DEPT-NBR.              02360020
026000     MOVE IM050-MAJ-CL-NBR        TO IM067-MAJ-CL-NBR.            02360030
026000     MOVE IM050-SUB-CL-NBR        TO IM067-SUB-CL-NBR.            02360040
026100     MOVE IM050-VS-ID             TO IM067-VS-ID.                 02360050
026100     MOVE IM050-ENT-ID            TO IM067-ENT-ID.                02360060
026100     MOVE IM050-VS-NBR            TO IM067-VS-NBR.                02360070
026100     MOVE IM050-STKR-NBR          TO IM067-STKR-NBR.              02360080
026000     MOVE IM050-VS-DESC           TO IM067-VS-DESC.               02360090
026000     MOVE IM050-MAP-UNT-RTL-AMT   TO IM067-MAP-UNT-RTL-AMT.       02360091
           MOVE PC-LBL                  TO IM067-LBL-CHARTC-CDE.        02360092
           MOVE IM050-LBL-SEQ-NBR       TO IM067-LBL-CHARTC-SEQ.        02360093
           MOVE PC-TKT-TYP              TO IM067-TKT-TYP-CHARTC-CDE.    02360094
           MOVE IM050-TKT-TYP-SEQ-NBR   TO IM067-TKT-TYP-CHARTC-SEQ.    02360095
           MOVE PC-HNG-FOLD             TO IM067-HNG-FOLD-CHARTC-CDE.   02360096
           MOVE IM050-HNG-FOLD-SEQ-NBR  TO IM067-HNG-FOLD-CHARTC-SEQ.   02360097
           MOVE PC-KY-CLSN              TO IM067-KY-CLSN-CHARTC-CDE.    02360098
           MOVE IM050-KY-CLSN-SEQ-NBR   TO IM067-KY-CLSN-CHARTC-SEQ.    02360099
           MOVE PC-FBRCN                TO IM067-FBRCN-CHARTC-CDE.      02360100
           MOVE IM050-FBRCN-SEQ-NBR     TO IM067-FBRCN-CHARTC-SEQ.      02360101
           MOVE PC-FNSH                 TO IM067-FNSH-CHARTC-CDE.       02360102
           MOVE IM050-FNSH-SEQ-NBR      TO IM067-FNSH-CHARTC-SEQ.       02360103
           MOVE PC-RTL-CLSN             TO IM067-RTL-CLSN-CHARTC-CDE.   02360400
           MOVE IM050-RTL-CLSN-SEQ-NBR  TO IM067-RTL-CLSN-CHARTC-SEQ.   02360410
           MOVE PC-ESL                  TO IM067-ESL-CHARTC-CDE.        02360420
           MOVE IM050-ESL-SEQ-NBR       TO IM067-ESL-CHARTC-SEQ.        02360430
           MOVE PC-RPT-HIER             TO IM067-RPT-HIER-CHARTC-CDE.   02360440
           MOVE IM050-RPT-HIER-SEQ-NBR  TO IM067-RPT-HIER-CHARTC-SEQ.   02360450
           MOVE PC-BDY-STYL             TO IM067-BDY-STYL-CHARTC-CDE.   02360460
           MOVE IM050-BDY-STYL-SEQ-NBR  TO IM067-BDY-STYL-CHARTC-SEQ.   02360470
           MOVE PC-CONST                TO IM067-CONST-CHARTC-CDE.      02360480
           MOVE IM050-CONST-SEQ-NBR     TO IM067-CONST-CHARTC-SEQ.      02360490
           MOVE PC-FUNC                 TO IM067-FUNC-CHARTC-CDE.       02360491
           MOVE IM050-FUNC-SEQ-NBR      TO IM067-FUNC-CHARTC-SEQ.       02360492
           MOVE PC-GNDR                 TO IM067-GNDR-CHARTC-CDE.       02360493
           MOVE IM050-GNDR-SEQ-NBR      TO IM067-GNDR-CHARTC-SEQ.       02360494
           MOVE PC-PATRN                TO IM067-PATRN-CHARTC-CDE.      02360500
           MOVE IM050-PATRN-SEQ-NBR     TO IM067-PATRN-CHARTC-SEQ.      02360600
           MOVE PC-SLHTT                TO IM067-SLHTT-CHARTC-CDE.      02360700
           MOVE IM050-SLHTT-SEQ-NBR     TO IM067-SLHTT-CHARTC-SEQ.      02360800
           MOVE PC-CLLCTN               TO IM067-CLLCTN-CHARTC-CDE.     02361000
           MOVE IM050-CLLCTN-SEQ-NBR    TO IM067-CLLCTN-CHARTC-SEQ.     02361100
           MOVE PC-PRIC-TIER            TO IM067-PRIC-TIER-CHARTC-CDE.  02361700
           MOVE IM050-PRIC-TIER-SEQ-NBR TO IM067-PRIC-TIER-CHARTC-SEQ.  02361710
           MOVE PC-LFSTYL               TO IM067-LFSTYL-CHARTC-CDE.     02361800
           MOVE IM050-LFSTYL-SEQ-NBR    TO IM067-LFSTYL-CHARTC-SEQ.     02361810
028300                                                                  02410000
028400     MOVE SPACES                  TO IM067-ITEM-STYLE-FILLER.     02540021
028500                                                                  02550000
           MOVE IM050-LBL-SEQ-NBR       TO PV-PREV-LBL-SEQ.             02550100
028800                                                                  02580000
028941                                                                  02894300
028810*-----------------------------------------------------------------02894400
028820* GET THE LABEL TYPE CODE                                         02894500
028830* BASED ON THE INPUT FILE LABEL SEQ NBR.                          02894600
028840*-----------------------------------------------------------------02894700
028850 1400-GET-LBL-TYP-CDE.                                            02894800
028860                                                                  02894900
028870     PERFORM WITH TEST AFTER                                      02895200
028880         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02895300
028890           UNTIL SQLCODE = +0                                     02895400
028891              OR SQLCODE = +100                                   02895500
028893              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02895600
028894         EXEC SQL                                                 02895700
028895             SELECT LBL_TYP_CDE                                   02895800
028898               INTO :IMT00000-LBL-TYP-CDE                         02896100
028901               FROM IMT_LBL                                       02896400
028902              WHERE LBL_SEQ_NBR = :IM050-LBL-SEQ-NBR              02896600
                    WITH UR                                             02896906
028904         END-EXEC                                                 02897000
028905                                                                  02897100
028906         EVALUATE TRUE                                            02897200
028907             WHEN SQLCODE = -904                                  02897300
028908             WHEN SQLCODE = -913                                  02897400
028909                 CONTINUE                                         02897500
028910             WHEN SQLCODE = ZERO                                  02897600
                       ADD +1 TO PV-IMTLBL-SELECT-CT                    02897610
                       MOVE IMT00000-LBL-TYP-CDE TO IM067-LBL-TYP-CDE   02897620
028912             WHEN SQLCODE = +100                                  02897800
                       MOVE ' ' TO IMT00000-LBL-TYP-CDE                 02898024
028914             WHEN OTHER                                           02898200
028915                 DISPLAY '** '                                    02898300
028916                         PC-PGM-NAME                              02898400
028917                         ' - RMS STYL ID: '                       02898500
028918                         PV-DISPLAY-RMS-STYL-ID                   02898609
028924                 MOVE '1400-GET-LBL-TYP-CDE' TO PV-PARAGRAPH-NAME 02898700
028925                 MOVE 'SELECT FROM TVSCHVL'   TO PV-DB2-OPERATION 02898800
028926                 PERFORM 9998-SQL-ERROR                           02898900
028927         END-EVALUATE                                             02899000
028928     END-PERFORM.                                                 02899100
028929                                                                  02899200
028930     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02899300
028931         DISPLAY '** '                                            02899400
028932                 PC-PGM-NAME                                      02899500
028917                 ' - RMS STYL ID: '                               02899600
028918                 PV-DISPLAY-RMS-STYL-ID                           02899809
028937         MOVE '1400-GET-LBL-TYP-CDE'         TO PV-PARAGRAPH-NAME 02899900
028938         MOVE 'MAX RETRIES EXCEEDED-TVSCHVL'  TO PV-DB2-OPERATION 02900000
028939         PERFORM 9998-SQL-ERROR                                   02900100
028940     END-IF.                                                      02900200
028941                                                                  02900300
                                                                        02988621
029052*-----------------------------------------------------------------02988700
029060* READ THE TVNDSTL/TMDARVS UNLOAD INPUT FILE                      02988801
029100*-----------------------------------------------------------------02988900
029200 6000-READ-STYLE-UNLOAD-FILE.                                     02989000
029300                                                                  02989100
029310     INITIALIZE IM050-ITEM-STYLE-UNLD-REC.                        02989200
029320                                                                  02989300
029400     READ STYLE-UNLOAD-IN INTO IM050-ITEM-STYLE-UNLD-REC          02989400
029500        AT END                                                    02989500
029600           SET END-OF-INPUT TO TRUE                               02989600
029700        NOT AT END                                                02989700
029800           ADD +1   TO PV-STYLE-RECS-READ.                        02989800
029900                                                                  02989900
030000*-----------------------------------------------------------------02990000
028700 7000-WRITE-STYLE-OUTPUT-REC.                                     02990121
030500                                                                  02990200
030600     WRITE STYLE-EDW-OUT-REC                                      02990316
030600                              FROM IM067-ITEM-STYLE-EDW-REC.      02991021
030700                                                                  03000000
030800     ADD +1 TO PV-STYLE-RECS-WRITTEN.                             03010016
030900                                                                  03020000
042600*-----------------------------------------------------------------04170000
042700* 9000-EOJ-ROUTINE - CLOSES THE FILES ASSOCIATED WITH THE JOB.    04180000
042800*-----------------------------------------------------------------04190000
042900 9000-EOJ.                                                        04200000
043000                                                                  04210000
043100     DISPLAY ' '.                                                 04220000
043200     DISPLAY '============================================='.     04230000
043300     DISPLAY ' '.                                                 04240000
043400     DISPLAY ' ******  IMKUT033 PROCESSING SUMMARY  ******  '.    04250000
043500     PERFORM 9100-DISPLAY-PROCESSING-INFO.                        04260000
043600     DISPLAY '============================================='.     04270000
043700                                                                  04280000
043800                                                                  04290000
043900     CLOSE STYLE-UNLOAD-IN                                        04300000
044000           STYLE-EDW-OUT.                                         04310021
044200                                                                  04330000
044300*-----------------------------------------------------------------04340000
044400* DISPLAY PROCESSED RECORDS COUNTS                                04350000
044500*-----------------------------------------------------------------04360000
044600 9100-DISPLAY-PROCESSING-INFO.                                    04370000
044700                                                                  04380000
044800     DISPLAY ' '.                                                 04390000
044900     DISPLAY '    STYLE RECORDS READ     = '                      04400001
045000           PV-STYLE-RECS-READ.                                    04410001
045100     DISPLAY '    STYLE RECORDS WRITTEN  = '                      04420016
045200           PV-STYLE-RECS-WRITTEN.                                 04430016
044900     DISPLAY '    IMT LBL RECORDS READ   = '                      04430017
                 PV-IMTLBL-SELECT-CT.                                   04430018
045500     DISPLAY ' '.                                                 04460000
045600*-----------------------------------------------------------------04470000
045700* 9800-SQL-ABEND - DISPLAY DB2 ABEND INFO                         04480000
045800*-----------------------------------------------------------------04490000
045900 9998-SQL-ERROR.                                                  04500000
046000                                                                  04510000
046300     DISPLAY '** '                                                04540000
046400             PC-PGM-NAME                                          04550000
046500             ' ABEND IN PARAGRAPH '                               04560000
046600             PV-PARAGRAPH-NAME.                                   04570000
046700     DISPLAY '** '                                                04580000
046800             PC-PGM-NAME                                          04590000
046900             ' OPERATION = ' PV-DB2-OPERATION.                    04600000
047000                                                                  04610000
047100*    THE FOLLOWING COPYBOOK UTILIZES MODULE DSNTIAR TO FORMAT     04620000
047200*    THE INFO IN SQLCA INTO UNDERSTANDABLE VERBAGE.               04630000
047300     COPY DPPD004.                                                04640000
047400                                                                  04650000
047500     EXEC SQL                                                     04660000
047600         ROLLBACK                                                 04670000
047700     END-EXEC.                                                    04680000
047800                                                                  04690000
047900     MOVE +4013 TO ABEND-CODE                                     04700000
048000     PERFORM 9999-ABEND.                                          04710000
048100                                                                  04720000
048200*-----------------------------------------------------------------04730000
048300* 9999-ABEND - FORCES PROGRAM ABEND WITH RETURN CODE              04740000
048400*-----------------------------------------------------------------04750000
048500 9999-ABEND.                                                      04760000
048600                                                                  04770000
048700     CALL 'ILBOABN0' USING ABEND-CODE.                            04780000
048800                                                                  04790000
