000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.     DBKDM009.                                        00020099
000300 AUTHOR.         BARB KREBS.                                      00030099
000400 INSTALLATION.   KOHLS.                                           00040099
000500 DATE-WRITTEN.   JULY 1993.                                       00050099
000600***********************************************************       00060099
000700* 05/96 B.NEHRLING                                                00070099
000800*     PGM CHANGED TO FIX A BUG REGARDING VARCHAR COLUMNS          00080099
000900***********************************************************       00090099
001000* 04/97 D.ABT                                                     00100099
001100*     PGM CHANGED TO FIX VERSION 4 OPTION OF USER-DEFINED         00110099
001200*     COLUMN DEFAULT VALUES                                       00120099
001300***********************************************************       00130099
001400* 12/00 CRAIG K. MARTIN                                           00140099
001500*     PGM CHANGED TO ALLOW FOR NEW NAMING STANDARDS FOR           00150099
001600*      TABLES, VIEWS  AND DCLGENS                                 00160099
001700***********************************************************       00170099
001800* 10/02 TOM PETERSON                                              00180099
001900*     NEW NAMING STANDARDS FOR PEOPLESOFT DCLGENS                 00190099
002000***********************************************************       00200099
002100* 12/02 CRAIG MARTIN                                              00210099
002200*     FIX BUG OF INSERTING LOW-VALUES INTO COLUMN OBJ_QUAL_NM     00220099
002300*     INSTEAD OF NULLS. THIS PREVENTS DCLGEN FROM DISPLAYING      00230099
002400*     PROPERLY ON E.K.R.4. PARAGRAPH 5400-INSERT-XREF.            00240099
002500***********************************************************       00250099
002600* 03/03 TOM PETERSON                                              00260099
002700*     ADD SECOND TABLE DECLARE SECTION FOR PEOPLESOFT ALIAS       00270099
002800*     NAMES                                                       00280099
002900***********************************************************       00290099
003000* 06/09/04 CRAIG K. MARTIN                                        00300099
003100*     ADDED DB4T(CRM) AS A VALID SUBSYSTEM.                       00310099
003200***********************************************************       00320099
003300***********************************************************       00330099
003400* 07/04  BRAD DORN                                                00340099
003500*     ADDED SUPPORT FOR DB5P.  CHANGED PROGRAM TO SUPPORT         00350099
003600*     RUNNING ON INDIVIDUAL SUBSYSTEMS INSTEAD OF ONLY ON         00360099
003700*     DB2P.  THIS ELIMINATED DUPLICATE CODING OF SQL              00370099
003800*     STATEMENTS FOR EACH SUBSYSTEM.                              00380099
003900***********************************************************       00390099
004000***********************************************************       00400099
004100* 03/08  LARRY SCHLEICHER                                         00410099
004200*     ADDED SUPPORT FOR DB2 VERSION 8.  ALLOW THE LENGTH          00420099
004300*     OF TABLE NAMES TO INCREASE FROM 18 CHARACTERS TO 128.       00430099
004400***********************************************************       00440099
004500* 05/08  LARRY SCHLEICHER                                         00450099
004600*     CHANGED THE SETTING OF THE CURSOR FROM THE CMNEKTAB         00460099
004700*     FIELD TO THE CMNEKCRE FIELD.                                00470099
004800***********************************************************       00480099
004900* 05/10  LARRY SCHLEICHER                                         00490099
005000*     ALLOW THE LENGTH OF THE FIELD NAMES TO INCREASE FROM        00500099
005100*     18 CHARACTERS TO 30.                                        00510099
005110*     THE LIMIT OF THE LENGTH OF THE FIELD NAMES ON THE TABLE     00511099
005120*     HAS BEEN LIMITED TO 21 CHARACTERS.  WHEN THE TABLE          00512099
005300*     NAME OR TABLESPACE NAME AND A HYPHEN INSERTED BEFORE        00530099
005400*     THE FIELD NAME THE MAXIMUM LENTGH OF THE FIELD NAME WILL    00540099
005500*     BE 30 CHARACTER.  IF THE LENGTH OF THE FIELD NAME ON        00550099
005600*     THE TABLE IS GREATER THEN 21, AN ERROR MESSAGE WILL BE      00560099
005700*     DISPLAYED AND THE DCLGEN WILL NOT BE GENERATED.             00570099
005800***********************************************************       00580099
005900 ENVIRONMENT DIVISION.                                            00590099
006000 CONFIGURATION SECTION.                                           00600099
006100 SOURCE-COMPUTER.        IBM.                                     00610099
006200 OBJECT-COMPUTER.        IBM.                                     00620099
006300 INPUT-OUTPUT SECTION.                                            00630099
006400                                                                  00640099
006500 FILE-CONTROL.                                                    00650099
006600                                                                  00660099
006700     SELECT DCLGEN-FILE ASSIGN TO XRECOUT.                        00670099
006800                                                                  00680099
006900 DATA DIVISION.                                                   00690099
007000 FILE SECTION.                                                    00700099
007100 FD  DCLGEN-FILE                                                  00710099
007200     RECORDING MODE IS F                                          00720099
007300     LABEL RECORDS ARE STANDARD                                   00730099
007400     RECORD CONTAINS 080 CHARACTERS                               00740099
007500     BLOCK CONTAINS 0 RECORDS                                     00750099
007600     DATA RECORD IS DCLGEN-RECORD.                                00760099
007700 01  DCLGEN-RECORD          PIC X(080).                           00770099
007800                                                                  00780099
007900*                                                                 00790099
008000     EJECT                                                        00800099
008100 WORKING-STORAGE SECTION.                                         00810099
008200*                                                                 00820099
008300 01  CALL-FILLER         PIC X.                                   00830099
008400 01  ISP-FUNCTIONS.                                               00840099
008500     05  ISP-DISPLAY     PIC X(8) VALUE 'DISPLAY'.                00850099
008600     05  ISP-ADDPOP      PIC X(8) VALUE 'ADDPOP  '.               00860099
008700     05  ISP-REMPOP      PIC X(8) VALUE 'REMPOP  '.               00870099
008800     05  ISP-VDEFINE     PIC X(8) VALUE 'VDEFINE'.                00880099
008900     05  ISP-VDELETE     PIC X(8) VALUE 'VDELETE'.                00890099
009000     05  ISP-VGET        PIC X(8) VALUE 'VGET'.                   00900099
009100     05  ISP-VPUT        PIC X(8) VALUE 'VPUT'.                   00910099
009200     05  ISP-VRESET      PIC X(8) VALUE 'VRESET'.                 00920099
009300     05  ISP-VCOPY       PIC X(8) VALUE 'VCOPY'.                  00930099
009400     05  ISP-VREPLACE    PIC X(8) VALUE 'VREPLACE'.               00940099
009500     05  ISP-TBOPEN      PIC X(8) VALUE 'TBOPEN'.                 00950099
009600     05  ISP-TBCREATE    PIC X(8) VALUE 'TBCREATE'.               00960099
009700     05  ISP-TBCLOSE     PIC X(8) VALUE 'TBCLOSE'.                00970099
009800     05  ISP-TBEND       PIC X(8) VALUE 'TBEND  '.                00980099
009900     05  ISP-TBDISPL     PIC X(8) VALUE 'TBDISPL'.                00990099
010000     05  ISP-TBSORT      PIC X(8) VALUE 'TBSORT'.                 01000099
010100     05  ISP-TBTOP       PIC X(8) VALUE 'TBTOP'.                  01010099
010200     05  ISP-TBBOTTOM    PIC X(8) VALUE 'TBBOTTOM'.               01020099
010300     05  ISP-TBSKIP      PIC X(8) VALUE 'TBSKIP'.                 01030099
010400     05  ISP-TBADD       PIC X(8) VALUE 'TBADD '.                 01040099
010500     05  ISP-TBPUT       PIC X(8) VALUE 'TBPUT '.                 01050099
010600     05  ISP-TBMOD       PIC X(8) VALUE 'TBMOD '.                 01060099
010700     05  ISP-TBDELETE    PIC X(8) VALUE 'TBDELETE'.               01070099
010800     05  ISP-TBEXIST     PIC X(8) VALUE 'TBEXIST '.               01080099
010900     05  ISP-TBSCAN      PIC X(8) VALUE 'TBSCAN'.                 01090099
011000     05  ISP-TBPAD       PIC 9(8) COMP VALUE 0.                   01100099
011100     05  ISP-NEWCOPY     PIC X(8) VALUE 'NEWCOPY'.                01110099
011200     05  ISP-FTOPEN      PIC X(8) VALUE 'FTOPEN'.                 01120099
011300     05  ISP-FTINCL      PIC X(8) VALUE 'FTINCL'.                 01130099
011400     05  ISP-FTCLOSE     PIC X(8) VALUE 'FTCLOSE'.                01140099
011500     05  ISP-SELECT      PIC X(8) VALUE 'SELECT'.                 01150099
011600     05  ISP-BROWSE      PIC X(8) VALUE 'BROWSE'.                 01160099
011700     05  ISP-SETMSG      PIC X(8) VALUE 'SETMSG'.                 01170099
011800     05  ISP-CONTROL     PIC X(8) VALUE 'CONTROL'.                01180099
011900     05  ISP-NONDISPL    PIC X(8) VALUE 'NONDISPL'.               01190099
012000     05  ISP-SPLIT       PIC X(8) VALUE 'SPLIT'.                  01200099
012100     05  ISP-DISABLE     PIC X(8) VALUE 'DISABLE'.                01210099
012200     05  ISP-ENABLE      PIC X(8) VALUE 'ENABLE'.                 01220099
012300     05  ISP-NO          PIC X(8) VALUE 'NO'.                     01230099
012400     05  ISP-YES         PIC X(8) VALUE 'YES'.                    01240099
012500*                                                                 01250099
012600 01  ISP-MISC-DEFS.                                               01260099
012700     05  ISP-FORMAT      PIC X(8) VALUE 'CHAR'.                   01270099
012800     05  ISP-MOVE        PIC X(8) VALUE 'MOVE'.                   01280099
012900     05  ISP-WRITE       PIC X(8) VALUE 'WRITE'.                  01290099
013000     05  ISP-NOWRITE     PIC X(8) VALUE 'NOWRITE'.                01300099
013100     05  ISP-REPLACE     PIC X(8) VALUE 'REPLACE'.                01310099
013200     05  ISP-ORDERED     PIC X(8) VALUE 'ORDERED'.                01320099
013300     05  ISP-SHARED      PIC X(8) VALUE 'SHARED'.                 01330099
013400     05  ISP-PROFILE     PIC X(8) VALUE 'PROFILE'.                01340099
013500     05  ISP-ASIS        PIC X(8) VALUE 'ASIS'.                   01350099
013600     05  ISP-NOREAD      PIC X(8) VALUE 'NOREAD'.                 01360099
013700     05  ISP-NEXT        PIC X(8) VALUE 'NEXT'.                   01370099
013800     05  ISP-TEMP        PIC X(8) VALUE 'TEMP'.                   01380099
013900     05  ISP-PANEL       PIC X(8) VALUE  SPACES.                  01390099
014000     05  ISP-DUMMY       PIC X(8) VALUE  SPACES.                  01400099
014100     05  ISP-MSG         PIC X(8) VALUE  'CMN000  '.              01410099
014200     05  ISP-CSR         PIC X(8) VALUE  SPACES.                  01420099
014300     05  ISP-FIELD       PIC X(8) VALUE  SPACES.                  01430099
014400     05  ISP-SKEL        PIC X(8) VALUE  SPACES.                  01440099
014500     05  ISP-ERRORS      PIC X(8) VALUE 'ERRORS'.                 01450099
014600     05  ISP-RETURN      PIC X(8) VALUE 'RETURN'.                 01460099
014700     05  ISP-CANCEL      PIC X(8) VALUE 'CANCEL'.                 01470099
014800     05  ISP-SAVE        PIC X(8) VALUE 'SAVE'.                   01480099
014900     05  ISP-RESTORE     PIC X(8) VALUE 'RESTORE'.                01490099
015000     05  TBL-LIST-GT     PIC X(4) VALUE '(GT)'.                   01500099
015100*                                                                 01510099
015200***  DEFINE DATA TYPE PARAMETER FOR VARIABLE DEFINE SERVICE CALL. 01520099
015300*                                                                 01530099
015400 01  CHAR                PIC X(08)     VALUE 'CHAR    '.          01540099
015500                                                                  01550099
015600*                                                                 01560099
015700*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              01570099
015800*                                                                 01580099
015900     COPY DPWS023.                                                01590099
016000                                                                  01600099
016100*                                                                 01610099
016200*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                01620099
016300*                                                                 01630099
016400     COPY DPWS300.                                                01640099
016500                                                                  01650099
016600 01  VAR-SMSG                    PIC X(24)   VALUE SPACES.        01660099
016700 01  FILLER                      REDEFINES VAR-SMSG.              01670099
016800     05  VAR-SMSG-FILLER         PIC X(20).                       01680099
016900     05  VAR-SMSG-SQLCODE        PIC 9(4).                        01690099
017000 01  VAR-LMSG                    PIC X(72)   VALUE SPACES.        01700099
017100 01  PV-PROGRAM-VARIABLES.                                        01710099
017200     05  VAR-ZTEMPF              PIC X(44)   VALUE SPACES.        01720099
017300     05  VAR-DSNAME              PIC X(46)   VALUE SPACES.        01730099
017400     05  VAR-VOLUME              PIC X(06)   VALUE SPACES.        01740099
017500     05  VAR-PASSWORD            PIC X(08)   VALUE SPACES.        01750099
017600     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             01760099
017700         10  FILLER              PIC X(13)    VALUE               01770099
017800             'DYNALC ERROR '.                                     01780099
017900         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        01790099
018000         10  FILLER              PIC X(2)     VALUE '; '.         01800099
018100         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       01810099
018200         10  FILLER              PIC X(5)     VALUE ' DD; '.      01820099
018300         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       01830099
018400     05  PV-DCLGEN-DSNAME        PIC X(44)   VALUE SPACES.        01840099
018500     05  PV-COUNTR               PIC S9(4)   COMP.                01850099
018600     05  PV-NM-COUNTR            PIC S9(4)   COMP.                01860099
018700     05  PV-COUNTR1              PIC S9(4)   COMP.                01870099
018800     05  PV-LEN                  PIC S9(4)   VALUE ZEROS.         01880099
018900     05  PV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         01890099
019000                                              COMP SYNC.          01900099
019100     05  PV-COLNM-LENGTH         PIC S9(4)   COMP.                01910099
019200                                                                  01920099
019300***  DEFINE STORAGE FOR DIALOG VARIABLES.                         01930099
019400*                                                                 01940099
019500 01  WS-CK-TABLE         PIC X(18)     VALUE SPACES.              01950099
019600 01  WS-CK-TABLE-REDEFINE  REDEFINES WS-CK-TABLE.                 01960099
019700     05  WS-TBL-FIRST3   PIC X(03).                               01970099
019800     05  WS-TBL-USCORE   PIC X(01).                               01980099
019900     05  FILLER          PIC X(14).                               01990099
020000*                                                                 02000099
020100 01  WS-CK-TABLE2        PIC X(18)     VALUE SPACES.              02010099
020200 01  WS-CK-TABLE2-REDEFINE  REDEFINES WS-CK-TABLE2.               02020099
020300     05  FILLER           PIC X(04).                              02030099
020400     05  WS-TBL2-USCORE   PIC X(01).                              02040099
020500     05  FILLER           PIC X(13).                              02050099
020600*                                                                 02060099
020700 01  WS-CK-TABLE3        PIC X(18)     VALUE SPACES.              02070099
020800 01  WS-CK-TABLE3-REDEFINE  REDEFINES WS-CK-TABLE3.               02080099
020900     05  FILLER           PIC X(02).                              02090099
021000     05  WS-TBL3-USCORE   PIC X(01).                              02100099
021100     05  FILLER           PIC X(15).                              02110099
021200*                                                                 02120099
021300 01  WS-CK-TABLE4.                                                02130099
021400     05  WS-PS-REPLICATED PIC X(07)    VALUE SPACES.              02140099
021500         88  PS-REPLICATED             VALUES                     02150099
021600             'PS_XFT_', 'PS_XFV_', 'PS_XAT_', 'PS_XAV_'.          02160099
021700     05  WS-PS-NOT-REPLICATED REDEFINES WS-PS-REPLICATED.         02170099
021800         10  FILLER       PIC X(03).                              02180099
021900         10  WS-TBL4-456  PIC X(03).                              02190099
022000         10  FILLER       PIC X(01).                              02200099
022100     05  FILLER           PIC X(11)    VALUE SPACES.              02210099
023000*                                                                 02300099
023100 01  WS-CREATOR.                                                  02310099
023200     05  WS-CREATOR-1234  PIC X(04)    VALUE SPACES.              02320099
023300     05  FILLER           PIC X(04)    VALUE SPACES.              02330099
023400*                                                                 02340099
023700 01  WS-ZC-CNT            PIC 9(01)    VALUE ZERO.                02370099
023800 01  WS-ZE-CNT            PIC 9(01)    VALUE ZERO.                02380099
023900 01  WS-ZP-CNT            PIC 9(01)    VALUE ZERO.                02390099
024000*                                                                 02400099
024100 01  WS-TYPE              PIC X(01)    VALUE SPACE.               02410099
024200*                                                                 02420099
024300 01  WS-APPLID            PIC X(02)    VALUE SPACES.              02430099
024400*                                                                 02440099
024500 01  WS-TEMP-TABLE        PIC X(128).                             02450099
024600 01  WS-TEMP-TABLE-REDEF REDEFINES WS-TEMP-TABLE.                 02460099
024700     05  WS-FIRST3        PIC X(03).                              02470099
024800     05  WS-FIRST3-REDEF REDEFINES WS-FIRST3.                     02480099
024900         10  WS-FIRST3-12 PIC X(02).                              02490099
025000         10  WS-FIRST3-3  PIC X(01).                              02500099
025100     05  FILLER           PIC X(125).                             02510099
025200*                                                                 02520099
025300 01  WS-TEMP-DCLGEN.                                              02530099
025400     05  WS-DCLGEN-123        PIC X(03).                          02540099
025500     05  WS-DCLGEN-123-REDEF REDEFINES WS-DCLGEN-123.             02550099
025600         10  WS-DCLGEN-12     PIC X(02).                          02560099
025700         10  WS-DCLGEN-3      PIC X(01).                          02570099
025800     05  WS-DCLGEN-45678      PIC 9(05) VALUE 00000.              02580099
025900*                                                                 02590099
026000 01  WS-MAX-DCLGEN-NAME       PIC X(08) VALUE SPACES.             02600099
026100 01  WS-MAX-DCLGEN-NM REDEFINES WS-MAX-DCLGEN-NAME.               02610099
026200     05  FILLER               PIC X(03).                          02620099
026300     05  WS-MAX-DCLGEN-SEQNUM PIC 9(05).                          02630099
026400 01  WS-DATA5-NAME            PIC X(134) VALUE SPACES.            02640099
026500 01  WS-DATA1-NAME            PIC X(129) VALUE SPACES.            02650099
026600*                                                                 02660099
026700*                                                                 02670099
026800*                                                                 02680099
026900 01  VAR-CMNEKTAB        PIC X(43)     VALUE SPACES.              02690099
027000 01  VAR-CMNEKTAB-REDEFINE REDEFINES VAR-CMNEKTAB.                02700099
027100     05  FILLER          PIC X(01).                               02710099
027200     05  VAR-TAB         PIC X(42).                               02720099
027300 01  VAR-CMNEKTB2        PIC X(43)     VALUE SPACES.              02730099
027400 01  VAR-CMNEKTB3        PIC X(42)     VALUE SPACES.              02740099
027500 01  VAR-128-TABLE-NAME  PIC X(128)    VALUE SPACES.              02750099
027600 01  VAR-CMNEKCRE        PIC X(08)     VALUE SPACES.              02760099
027700 01  VAR-CMNEKCRE-REDEFINE REDEFINES VAR-CMNEKCRE.                02770099
027800     05  VAR-CRE         PIC X(07).                               02780099
027900     05  FILLER          PIC X(01).                               02790099
028000 01  WS-DCLGEN-NM        PIC X(08)     VALUE SPACES.              02800099
028100 01  FREE-SPACE          PIC X(80)     VALUE SPACES.              02810099
028200 01  ABEND-CODE                    PIC S9(4) VALUE ZERO           02820099
028300                                             COMP.                02830099
028400     88  ABEND-4013                          VALUE 4013.          02840099
028500                                                                  02850099
028600 01  PS-TABLE-VALIDITY             PIC X(1)  VALUE 'N'.           02860099
028700     88  PS-TABLE-IS-VALID                   VALUE 'Y'.           02870099
028800     88  PS-TABLE-IS-NOT-VALID               VALUE 'N'.           02880099
028900 01  PS-ALIAS-FOUND-SW             PIC X(1)  VALUE 'N'.           02890099
029000     88  PS-ALIAS-FOUND                      VALUE 'Y'.           02900099
029100     88  PS-ALIAS-NOT-FOUND                  VALUE 'N'.           02910099
029200 01  PS-ALLOCATE-SW                PIC X(1)  VALUE 'N'.           02920099
029300     88  PS-IS-ALLOCATED                     VALUE 'Y'.           02930099
029400     88  PS-IS-NOT-ALLOCATED                 VALUE 'N'.           02940099
029500 01  PS-DB2-ERROR-INDICATOR        PIC X(1)  VALUE 'N'.           02950099
029600     88  PS-DB2-ERROR                        VALUE 'Y'.           02960099
029700     88  PS-NO-DB2-ERROR                     VALUE 'N'.           02970099
029800 01  PS-NAME-ERROR-INDICATOR       PIC X(1)  VALUE 'N'.           02980099
029900     88  PS-NAME-ERROR                       VALUE 'Y'.           02990099
030000     88  PS-NO-NAME-ERROR                    VALUE 'N'.           03000099
030100 01  PS-USER-INPUT                 PIC X(1)  VALUE 'N'.           03010099
030200     88  PS-USER-INPUT-VALID                 VALUE 'Y'.           03020099
030300     88  PS-USER-INPUT-NOT-VALID             VALUE 'N'.           03030099
030400 01  WS-NEW-XREF-SW                PIC X(1)  VALUE 'N'.           03040099
030500     88  NEW-XREF                            VALUE 'Y'.           03050099
030600     88  OLD-XREF                            VALUE 'N'.           03060099
030700                                                                  03070099
030800 01  WS-NEW-TABLE-SW               PIC X(1)  VALUE 'N'.           03080099
030900     88  NEW-TABLE                           VALUE 'Y'.           03090099
031000     88  OLD-TABLE                           VALUE 'N'.           03100099
031100                                                                  03110099
031200**                                                                03120099
031300 01  DCLGEN-CONSTANTS.                                            03130099
031400     05  DCLGEN-AST.                                              03140099
031500         10  FILLER                PIC X(6)   VALUE SPACES.       03150099
031600         10  FILLER                PIC X(66)  VALUE ALL '*'.      03160099
031700     05  DCLGEN-DATA1.                                            03170099
031800         10  FILLER                PIC X(6)   VALUE SPACES.       03180099
031900         10  FILLER  PIC X(15)  VALUE '* DCLGEN TABLE('.          03190099
032000         10  DCLGEN-DATA1-NAME1    PIC X(50)  VALUE SPACES.       03200099
032100         10  FILLER                PIC X      VALUE '*'.          03210099
032200     05  DCLGEN-DATA1-2.                                          03220099
032300         10  FILLER                PIC X(6)   VALUE SPACES.       03230099
032400         10  FILLER  PIC X(02)  VALUE '* '.                       03240099
032500         10  DCLGEN-DATA1-NAME2    PIC X(63)  VALUE SPACES.       03250099
032600         10  FILLER                PIC X      VALUE '*'.          03260099
032700     05  DCLGEN-DATA1-3.                                          03270099
032800         10  FILLER                PIC X(6)   VALUE SPACES.       03280099
032900         10  FILLER  PIC X(02)  VALUE '* '.                       03290099
033000         10  DCLGEN-DATA1-NAME3    PIC X(16)  VALUE SPACES.       03300099
033100         10  FILLER                PIC X(47)  VALUE SPACES.       03310099
033200         10  FILLER                PIC X      VALUE '*'.          03320099
033300     05  DCLGEN-DATA2.                                            03330099
033400         10  FILLER                PIC X(6)   VALUE SPACES.       03340099
033500         10  FILLER                PIC X(9)   VALUE '*        '.  03350099
033600         10  DCLGEN-DATA2-LIBRARY  PIC X(43)  VALUE SPACES.       03360099
033700         10  FILLER                PIC X(13)  VALUE SPACES.       03370099
033800         10  FILLER                PIC X      VALUE '*'.          03380099
033900     05  DCLGEN-DATA3.                                            03390099
034000         10  FILLER                PIC X(6)   VALUE SPACES.       03400099
034100         10  FILLER  PIC X(15)  VALUE '*        APOST '.          03410099
034200         10  FILLER                PIC X(50)  VALUE SPACES.       03420099
034300         10  FILLER                PIC X      VALUE '*'.          03430099
034400     05  DCLGEN-DATA4.                                            03440099
034500         10  FILLER                PIC X(6)   VALUE SPACES.       03450099
034600         10  FILLER  PIC X(20)  VALUE '* ... IS THE DCLGEN '.     03460099
034700         10  FILLER  PIC X(20)  VALUE 'COMMAND THAT MADE TH'.     03470099
034800         10  FILLER  PIC X(20)  VALUE 'E FOLLOWING STATEMEN'.     03480099
034900         10  FILLER  PIC X(6)   VALUE 'TS   *'.                   03490099
035000     05  DCLGEN-DATA5.                                            03500099
035100         10  FILLER                PIC X(6)   VALUE SPACES.       03510099
035200         10  FILLER  PIC X(22)  VALUE '     EXEC SQL DECLARE '.   03520099
035300         10  DCLGEN-DATA5-NAME1 PIC X(44)   VALUE SPACES.         03530099
035400     05  DCLGEN-DATA5-2.                                          03540099
035500         10  FILLER                PIC X(6)   VALUE SPACES.       03550099
035600         10  FILLER     PIC X(5)   VALUE '-    '.                 03560099
035700         10  DCLGEN-DATA5-NAME2 PIC X(61)   VALUE SPACES.         03570099
035800     05  DCLGEN-DATA5-3.                                          03580099
035900         10  FILLER                PIC X(6)   VALUE SPACES.       03590099
036000         10  FILLER     PIC X(5)   VALUE '-    '.                 03600099
036100         10  DCLGEN-DATA5-NAME3 PIC X(29)   VALUE SPACES.         03610099
036200         10  FILLER             PIC X(32)   VALUE SPACES.         03620099
036300     05  DCLGEN-DATA6.                                            03630099
036400         10  FILLER                PIC X(6)   VALUE SPACES.       03640099
036500         10  FILLER  PIC X(20)  VALUE '* COBOL DECLARATION '.     03650099
036600         10  FILLER  PIC X(10)  VALUE 'FOR TABLE '.               03660099
036700         10  DCLGEN-DATA6-NAME1    PIC X(35) VALUE SPACES.        03670099
036800     05  DCLGEN-DATA6-2.                                          03680099
036900         10  FILLER                PIC X(6)   VALUE SPACES.       03690099
037000         10  FILLER  PIC X(02)  VALUE '* '.                       03700099
037100         10  DCLGEN-DATA6-NAME2 PIC X(63)   VALUE SPACES.         03710099
037200     05  DCLGEN-DATA6-3.                                          03720099
037300         10  FILLER                PIC X(6)   VALUE SPACES.       03730099
037400         10  FILLER  PIC X(02)  VALUE '* '.                       03740099
037500         10  DCLGEN-DATA6-NAME3 PIC X(30)   VALUE SPACES.         03750099
037600         10  FILLER                PIC X(33)  VALUE SPACES.       03760099
037700     05  DCLGEN-DATA7.                                            03770099
037800         10  FILLER                PIC X(6)   VALUE SPACES.       03780099
037900         10  FILLER  PIC X(5)   VALUE SPACES.                     03790099
038000         10  DCLGEN-DATA7-COL1  PIC XX      VALUE SPACES.         03800099
038100         10  DCLGEN-DATA7-COL2  PIC X(18)   VALUE SPACES.         03810099
038200         10  FILLER             PIC X       VALUE SPACES.         03820099
038300         10  DCLGEN-DATA7-COL3  PIC X(15)   VALUE SPACES.         03830099
038400         10  FILLER             PIC X       VALUE SPACES.         03840099
038500         10  DCLGEN-DATA7-COL4  PIC X(22)   VALUE SPACES.         03850099
038600         10  FILLER             PIC X(2)    VALUE SPACES.         03860099
038700     05  DCLGEN-DATA7A.                                           03870099
038800         10  FILLER                PIC X(6)   VALUE SPACES.       03880099
038900         10  FILLER  PIC X(5)   VALUE SPACES.                     03890099
039000         10  DCLGEN-DATA7A-COL1 PIC XX      VALUE SPACES.         03900099
039100         10  DCLGEN-DATA7A-COL2 PIC X(30)   VALUE SPACES.         03910099
039200         10  FILLER             PIC X(29)   VALUE SPACES.         03920099
039300     05  DCLGEN-DATA8.                                            03930099
039400         10  FILLER                PIC X(6)   VALUE SPACES.       03940099
039500         10  FILLER  PIC X(22)  VALUE '     ) END-EXEC.      '.   03950099
039600         10  FILLER  PIC X(44)  VALUE SPACES.                     03960099
039700     05  DCLGEN-DATA9.                                            03970099
039800         10  FILLER                PIC X(6)   VALUE SPACES.       03980099
039900         10  FILLER  PIC X(8)   VALUE ' 01  DCL'.                 03990099
040000         10  DCLGEN-DATA9-NAM  PIC X(9)    VALUE SPACES.          04000099
040100     05  DCLGEN-DATA10.                                           04010099
040200         10  FILLER                PIC X(6)   VALUE SPACES.       04020099
040300         10  DCLGEN-DATA10-10   PIC X(8)   VALUE '     10 '.      04030099
040400         10  DCLGEN-DATA10-N2   PIC X(30)   VALUE SPACES.         04040099
040500         10  DCLGEN-DATA10-N3   PIC X(5)    VALUE ' PIC '.        04050099
040600         10  DCLGEN-DATA10-N4   PIC X(22).                        04060099
040700     05  DCLGEN-DATA10A.                                          04070099
040800         10  FILLER                PIC X(6)   VALUE SPACES.       04080099
040900         10  FILLER             PIC X(4)   VALUE SPACES.          04090099
041000         10  FILLER             PIC X(8)   VALUE '     49 '.      04100099
041100         10  DCLGEN-DATA10A-N2   PIC X(39)   VALUE SPACES.        04110099
041200         10  FILLER             PIC X(18)   VALUE SPACES.         04120099
041300     05  DCLGEN-DATA10A1.                                         04130099
041400         10  FILLER             PIC X(49)  VALUE SPACES.          04140099
041500         10  FILLER             PIC X(4)    VALUE 'PIC '.         04150099
041600         10  DCLGEN-DATA10A-N3   PIC X(22).                       04160099
041700     05  DCLGEN-DATA10B.                                          04170099
041800         10  FILLER                PIC X(6)   VALUE SPACES.       04180099
041900         10  DCLGEN-DATA10B-10  PIC X(8)   VALUE '     10 '.      04190099
042000         10  DCLGEN-DATA10B-N2  PIC X(39)   VALUE SPACES.         04200099
042100         10  FILLER             PIC X(18)   VALUE SPACES.         04210099
042600     05  DCLGEN-DATA11.                                           04260099
042700         10  FILLER                PIC X(6)   VALUE SPACES.       04270099
042800         10  FILLER  PIC X(20)  VALUE '* THE NUMBER OF COLU'.     04280099
042900         10  FILLER  PIC X(20)  VALUE 'MNS DESCRIBED BY THI'.     04290099
043000         10  FILLER  PIC X(17)  VALUE 'S DECLARATION IS '.        04300099
043100         10  DCLGEN-DATA11-NUM      PIC ZZ9.                      04310099
043200         10  FILLER  PIC X(6)   VALUE '     *'.                   04320099
043300     05  DCLGEN-DATA12.                                           04330099
043400         10  FILLER                PIC X(6)   VALUE SPACES.       04340099
043500         10  FILLER  PIC X(14)  VALUE '* DECLARATION '.           04350099
043600         10  FILLER  PIC X(10)  VALUE 'FOR ALIAS '.               04360099
043700         10  DCLGEN-DATA12-PS-ID PIC X(2)    VALUE SPACES.        04370099
043800         10  DCLGEN-DATA12-USCOR PIC X(1)    VALUE SPACE.         04380099
043900         10  DCLGEN-DATA12-NAME  PIC X(18)   VALUE SPACES.        04390099
044000         10  FILLER  PIC X(14)  VALUE SPACES.                     04400099
044100     05  DCLGEN-DATA13.                                           04410099
044200         10  FILLER                PIC X(6)   VALUE SPACES.       04420099
044300         10  FILLER  PIC X(22)  VALUE '     EXEC SQL DECLARE '.   04430099
044400         10  DCLGEN-DATA13-PS-ID PIC X(2)    VALUE SPACES.        04440099
044500         10  DCLGEN-DATA13-USCOR PIC X(1)    VALUE SPACE.         04450099
044600         10  DCLGEN-DATA13-NAME  PIC X(18)   VALUE SPACES.        04460099
044700         10  FILLER  PIC X(23)  VALUE ' TABLE        '.           04470099
044800 01  WORK-AREA.                                                   04480099
044900     05  WA-01                  PIC X(3).                         04490099
045000     05  WA-02                  PIC 999.                          04500099
045100     05  WA-02R REDEFINES WA-02.                                  04510099
045200         10  WA-02R1            PIC X.                            04520099
045300         10  WA-02R2            PIC X.                            04530099
045400         10  WA-02R3            PIC X.                            04540099
045500     05  WA-03                  PIC X.                            04550099
045600     05  WA-04.                                                   04560099
045700         10  WA-04A             PIC XXX.                          04570099
045800         10  WA-04B             PIC 99.                           04580099
045900         10  WA-04BR REDEFINES WA-04B.                            04590099
046000             15  WA-04BR1       PIC X.                            04600099
046100             15  WA-04BR2       PIC X.                            04610099
046200         10  WA-04C             PIC X.                            04620099
046300     05  WA-05                  PIC X(7).                         04630099
046400     05  WA-06                  PIC X.                            04640099
046500     05  WA-VAR                 PIC 99999.                        04650099
046600     05  WA-VARR REDEFINES WA-VAR.                                04660099
046700         10  WA-VAR1           PIC X.                             04670099
046800         10  WA-VAR2           PIC X.                             04680099
046900         10  WA-VAR3           PIC X.                             04690099
047000         10  WA-VAR4           PIC X.                             04700099
047100         10  WA-VAR5           PIC X.                             04710099
047200 01  FIRST-SWITCH               PIC X       VALUE '1'.            04720099
047300 01  MEM-CRE                    PIC X       VALUE 'N'.            04730099
047400 01  WS-MEM-REP                 PIC X       VALUE 'N'.            04740099
047500 01  LNUM                       PIC S999    VALUE ZEROS.          04750099
047600 01  HOLD-NUM                   PIC S999    VALUE ZEROS.          04760099
047700 01  HOLD-NAME                  PIC X(39)   VALUE SPACES.         04770099
047800 01  INCORE-TABLE.                                                04780099
047900     05  INCORE-TABLE-LINE  OCCURS 200 TIMES.                     04790099
048000         10  INCORE-NAME        PIC X(30).                        04800099
048100         10  INCORE-COLTYPE     PIC X(8).                         04810099
048200         10  INCORE-LENGTH      PIC S9(4) USAGE COMP.             04820099
048300         10  INCORE-SCALE       PIC S9(4) USAGE COMP.             04830099
048400         10  INCORE-NULLS       PIC X(21).                        04840099
048500 01  HOLD-COLTYPE.                                                04850099
048600     05  COLTYPE1.                                                04860099
048700         10  TYPE1-COL1         PIC X(4).                         04870099
048800         10  TYPE1-COL2         PIC X.                            04880099
048900         10  TYPE1-COL3         PIC 9999.                         04890099
049000         10  TYPE1-COL4         PIC X.                            04900099
049100         10  TYPE1-COL5         PIC X(5).                         04910099
049200     05  COLTYPE2 REDEFINES COLTYPE1.                             04920099
049300         10  TYPE2-COL1         PIC X(7).                         04930099
049400         10  TYPE2-COL2         PIC X.                            04940099
049500         10  TYPE2-COL3         PIC 99999.                        04950099
049600         10  TYPE2-COL4         PIC X.                            04960099
049700         10  TYPE2-COL5         PIC X.                            04970099
049800     05  COLTYPE3 REDEFINES COLTYPE1.                             04980099
049900         10  TYPE3-COL1         PIC X(7).                         04990099
050000         10  TYPE3-COL2         PIC X.                            05000099
050100         10  TYPE3-COL3         PIC 999.                          05010099
050200         10  TYPE3-COL4         PIC XX.                           05020099
050300         10  TYPE3-COL5         PIC 9.                            05030099
050400         10  TYPE3-COL6         PIC X.                            05040099
050410     05  COLTYPE4 REDEFINES COLTYPE1.                             05041099
050420         10  TYPE4-COL1         PIC X(6).                         05042099
050430         10  TYPE4-COL2         PIC X.                            05043099
050440         10  TYPE4-COL3         PIC 999.                          05044099
050450         10  TYPE4-COL4         PIC X.                            05045099
050460         10  TYPE4-COL5         PIC X(4).                         05046099
050470     05  COLTYPE5 REDEFINES COLTYPE1.                             05047099
050480         10  TYPE5-COL1         PIC X(8).                         05048099
050490         10  TYPE5-COL2         PIC X.                            05049099
050491         10  TYPE5-COL3         PIC 99999.                        05049199
050492         10  TYPE5-COL4         PIC X.                            05049299
050493     05  COLTYPE6 REDEFINES COLTYPE1.                             05049399
050494         10  TYPE6-COL1         PIC X(11).                        05049499
050495         10  TYPE6-COL2         PIC X.                            05049599
050496         10  TYPE6-COL3         PIC 99.                           05049699
050497         10  TYPE6-COL4         PIC X.                            05049799
050500*                                                                 05050099
050600 01  PROGRAM-CONSTANTS.                                           05060099
050700     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'DBKDM009'.   05070099
050800     05  PC-DCLGEN-DDNAME          PIC X(08)  VALUE 'XRECOUT'.    05080099
050900*                                                                 05090099
051000 01  COMMON-NAMELIST.                                             05100099
051100     05  NAM-ZTEMPF      PIC X(08)     VALUE 'ZTEMPF'.            05110099
051200     05  NAM-SMSG        PIC X(08)     VALUE 'SMSG'.              05120099
051300     05  NAM-LMSG        PIC X(08)     VALUE 'LMSG'.              05130099
051400*                                                                 05140099
051500***  DEFINE DIALOG VARIABLE NAMES FOR DIALOG SERVICE CALLS.       05150099
051600*                                                                 05160099
051700 01  NAM-CMNEKTAB        PIC X(18)     VALUE 'CMNEKTAB'.          05170099
051800 01  NAM-CMNEKTB2        PIC X(18)     VALUE 'CMNEKTB2'.          05180099
051900 01  NAM-CMNEKTB3        PIC X(18)     VALUE 'CMNEKTB3'.          05190099
052000 01  NAM-CMNEKCRE        PIC X(08)     VALUE 'CMNEKCRE'.          05200099
052100*                                                                 05210099
052200***  DEFINE LENGTHS FOR DIALOG VARIABLES.                         05220099
052300*                                                                 05230099
052400 01  WS-DCLGEN-NAME-NULL PIC S9(04)    VALUE +0    COMP.          05240099
052500*                                                                 05250099
052600************************************************************      05260099
052700*    DBT_DCLGEN_XREF   DCLGEN                              *      05270099
052800************************************************************      05280099
052900     EXEC SQL                                                     05290099
053000         INCLUDE DBT00001                                         05300099
053100     END-EXEC.                                                    05310099
053200*                                                                 05320099
053300************************************************************      05330099
053400*    SYSIBM.SYSTABLES  DCLGEN                              *      05340099
053500************************************************************      05350099
053600     EXEC SQL                                                     05360099
053700         INCLUDE SYSTABLE                                         05370099
053800     END-EXEC.                                                    05380099
053900*                                                                 05390099
054000************************************************************      05400099
054100*    SYSIBM.SYSCOLUMNS DCLGEN                              *      05410099
054200************************************************************      05420099
054300     EXEC SQL                                                     05430099
054400         INCLUDE SYSCOL                                           05440099
054500     END-EXEC.                                                    05450099
054600*                                                                 05460099
054700************************************************************      05470099
054800*    DECLARE SYSCOLS_CURSOR CURSOR                         *      05480099
054900************************************************************      05490099
055000*                                                                 05500099
055100     EXEC SQL                                                     05510099
055200      DECLARE SYSCOLS_CURSOR CURSOR FOR                           05520099
055300      SELECT    NAME                                              05530099
055400               ,COLNO                                             05540099
055500               ,COLTYPE                                           05550099
055600               ,LENGTH                                            05560099
055700               ,SCALE                                             05570099
055800               ,NULLS                                             05580099
055900               ,DEFAULT                                           05590099
056000               ,KEYSEQ                                            05600099
056100               ,DEFAULTVALUE                                      05610099
056200      FROM      SYSIBM.SYSCOLUMNS                                 05620099
056300      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   05630099
056400      AND       TBCREATOR = :VAR-CMNEKCRE                         05640099
056500      ORDER BY  COLNO                                             05650099
056600      WITH UR                                                     05660099
056700     END-EXEC.                                                    05670099
056800                                                                  05680099
056900************************************************************      05690099
057000*    SQL COMMUNICATIONS AREA DCLGEN                        *      05700099
057100************************************************************      05710099
057200*                                                                 05720099
057300     EXEC SQL                                                     05730099
057400         INCLUDE SQLCA                                            05740099
057500     END-EXEC.                                                    05750099
057600*                                                                 05760099
057700*                                                                 05770099
057800 PROCEDURE DIVISION.                                              05780099
057900                                                                  05790099
058000************************************************************      05800099
058100*    VDEFINES FOR PANEL                                    *      05810099
058200************************************************************      05820099
058300     MOVE LENGTH OF VAR-ZTEMPF TO PV-FIELD-LENGTH.                05830099
058400     CALL 'ISPLINK' USING ISP-VDEFINE NAM-ZTEMPF VAR-ZTEMPF       05840099
058500                          ISP-FORMAT PV-FIELD-LENGTH.             05850099
058600     MOVE LENGTH OF VAR-SMSG TO PV-FIELD-LENGTH.                  05860099
058700     CALL 'ISPLINK' USING ISP-VDEFINE NAM-SMSG VAR-SMSG           05870099
058800                          ISP-FORMAT PV-FIELD-LENGTH.             05880099
058900     MOVE LENGTH OF VAR-LMSG TO PV-FIELD-LENGTH.                  05890099
059000     CALL 'ISPLINK' USING ISP-VDEFINE NAM-LMSG VAR-LMSG           05900099
059100                          ISP-FORMAT PV-FIELD-LENGTH.             05910099
059200     MOVE LENGTH OF VAR-CMNEKTAB TO PV-FIELD-LENGTH.              05920099
059300     CALL 'ISPLINK' USING ISP-VDEFINE                             05930099
059400         NAM-CMNEKTAB  VAR-CMNEKTAB  CHAR  PV-FIELD-LENGTH.       05940099
059500     MOVE LENGTH OF VAR-CMNEKTB2 TO PV-FIELD-LENGTH.              05950099
059600     CALL 'ISPLINK' USING ISP-VDEFINE                             05960099
059700         NAM-CMNEKTB2  VAR-CMNEKTB2  CHAR  PV-FIELD-LENGTH.       05970099
059800     MOVE LENGTH OF VAR-CMNEKTB3 TO PV-FIELD-LENGTH.              05980099
059900     CALL 'ISPLINK' USING ISP-VDEFINE                             05990099
060000         NAM-CMNEKTB3  VAR-CMNEKTB3  CHAR  PV-FIELD-LENGTH.       06000099
060100     MOVE LENGTH OF VAR-CMNEKCRE TO PV-FIELD-LENGTH.              06010099
060200     CALL 'ISPLINK' USING ISP-VDEFINE                             06020099
060300         NAM-CMNEKCRE  VAR-CMNEKCRE  CHAR  PV-FIELD-LENGTH.       06030099
060400                                                                  06040099
060500************************************************************      06050099
060600*    VGETS FROM PROFILES                                   *      06060099
060700************************************************************      06070099
060800                                                                  06080099
060900     CALL 'ISPLINK' USING ISP-VGET NAM-ZTEMPF ISP-SHARED.         06090099
061000     MOVE SPACES TO ISP-MSG.                                      06100099
061100                                                                  06110099
061200     PERFORM 1700-DISPLAY-PANEL.                                  06120099
061300     PERFORM 1500-PROCESS-PANEL                                   06130099
061400         UNTIL (RETURN-CODE NOT = 0).                             06140099
061500                                                                  06150099
061600     GOBACK.                                                      06160099
061700                                                                  06170099
061800************************************************************      06180099
061900*    PROCESS A PANEL                                       *      06190099
062000************************************************************      06200099
062100*                                                                 06210099
062200 1500-PROCESS-PANEL.                                              06220099
062300     MOVE VAR-CMNEKCRE TO WS-CREATOR.                             06230099
062400     INITIALIZE VAR-SMSG                                          06240099
062500                VAR-LMSG.                                         06250099
062600                                                                  06260099
062700     PERFORM 2100-EDIT-INPUT THRU 2100-EXIT.                      06270099
062800                                                                  06280099
062900     IF ((NOT PS-USER-INPUT-NOT-VALID)                            06290099
063000             AND (NOT PS-DB2-ERROR))                              06300099
063100         PERFORM 3000-ALLOCATE-TEMP-FILE                          06310099
063200         IF PS-IS-ALLOCATED                                       06320099
063300             PERFORM 4000-DB2-TABLE-FUNCTIONS THRU 4000-EXIT      06330099
063400             EVALUATE TRUE                                        06340099
063500                 WHEN WS-MEM-REP = 'Y'                            06350099
063600                     STRING WS-DCLGEN-NM DELIMITED BY SPACE       06360099
063700                            ' REPLACED'  DELIMITED BY SIZE        06370099
063800                         INTO VAR-SMSG                            06380099
063900                     MOVE 'CMN000' TO ISP-MSG                     06390099
064000                 WHEN ((MEM-CRE = 'Y')                            06400099
064100                         AND (NEW-XREF))                          06410099
064200                     STRING WS-DCLGEN-NM DELIMITED BY SPACE       06420099
064300                            ' CREATED'   DELIMITED BY SIZE        06430099
064400                         INTO VAR-SMSG                            06440099
064500                     MOVE 'CMN000' TO ISP-MSG                     06450099
064600                 WHEN ((MEM-CRE = 'Y')                            06460099
064700                         AND (DP023-MEMDISP-NEW))                 06470099
064800                     STRING WS-DCLGEN-NM DELIMITED BY SPACE       06480099
064900                            ' CREATED'   DELIMITED BY SIZE        06490099
065000                         INTO VAR-SMSG                            06500099
065100                     MOVE 'CMN000' TO ISP-MSG                     06510099
065200                 WHEN ((MEM-CRE = 'Y')                            06520099
065300                         AND (DP023-MEMDISP-UPDATE))              06530099
065400                     STRING WS-DCLGEN-NM DELIMITED BY SPACE       06540099
065500                            ' REPLACED'  DELIMITED BY SIZE        06550099
065600                         INTO VAR-SMSG                            06560099
065700                     MOVE 'CMN000' TO ISP-MSG                     06570099
065800             END-EVALUATE                                         06580099
065900         END-IF                                                   06590099
066000     END-IF.                                                      06600099
066100                                                                  06610099
066200     PERFORM 1700-DISPLAY-PANEL.                                  06620099
066300                                                                  06630099
066400************************************************************      06640099
066500*    DISPLAY THE PANEL                                     *      06650099
066600************************************************************      06660099
066700*                                                                 06670099
066800 1700-DISPLAY-PANEL.                                              06680099
066900                                                                  06690099
067000     MOVE SPACES TO WS-DCLGEN-NM.                                 06700099
067100     MOVE ZEROS TO LNUM.                                          06710099
067200     MOVE '1' TO FIRST-SWITCH.                                    06720099
067300     MOVE ZEROS TO HOLD-NUM.                                      06730099
067400     MOVE 'CMNEKCRE' TO ISP-CSR.                                  06740099
067500     MOVE 'CMNEKR4'  TO ISP-PANEL.                                06750099
067600     CALL 'ISPLINK' USING ISP-DISPLAY,                            06760099
067700                          ISP-PANEL,                              06770099
067800                          ISP-MSG,                                06780099
067900                          ISP-CSR.                                06790099
068000                                                                  06800099
068100************************************************************      06810099
068200* SET SWITCHES TO INDICATE WHAT OPTION HAS BEEN SPECIFIED  *      06820099
068300* BY THE USER                                              *      06830099
068400************************************************************      06840099
068500 2100-EDIT-INPUT.                                                 06850099
068600                                                                  06860099
068700     SET PS-NO-DB2-ERROR TO TRUE.                                 06870099
068900     SET PS-USER-INPUT-VALID TO TRUE.                             06890099
069000     MOVE 'N' TO WS-NEW-TABLE-SW.                                 06900099
069100     MOVE 'N' TO WS-NEW-XREF-SW.                                  06910099
069200     MOVE 'N' TO WS-MEM-REP.                                      06920099
069300                                                                  06930099
069400     IF (VAR-CMNEKTAB = SPACES  AND                               06940099
069500         VAR-CMNEKTB2 = SPACES  AND                               06950099
069600         VAR-CMNEKTB3 = SPACES) OR                                06960099
069700        VAR-CMNEKCRE = SPACES                                     06970099
069800          SET PS-USER-INPUT-NOT-VALID TO TRUE                     06980099
069900          MOVE 'N' TO MEM-CRE                                     06990099
070000          MOVE 'SPECIFY REQUIRED PARM' TO VAR-SMSG                07000099
070100          MOVE                                                    07010099
070200          'SUPPLY THE NAME OF THE DB2 TABLE AND ITS CREATOR'      07020099
070300              TO VAR-LMSG                                         07030099
070400          MOVE 'CMN000  ' TO ISP-MSG                              07040099
070500          GO TO 2100-EXIT                                         07050099
070600     ELSE                                                         07060099
070700         IF VAR-CMNEKTB2 NOT = SPACES                             07070099
070800             STRING VAR-CMNEKTAB        DELIMITED BY ' ',         07080099
070900                    VAR-CMNEKTB2        DELIMITED BY ' '          07090099
071000                 INTO VAR-128-TABLE-NAME                          07100099
071100             IF VAR-CMNEKTB3 NOT = SPACES                         07110099
071200                 STRING VAR-128-TABLE-NAME  DELIMITED BY ' '      07120099
071300                        VAR-CMNEKTB3        DELIMITED BY ' '      07130099
071400                     INTO VAR-128-TABLE-NAME                      07140099
071500             END-IF                                               07150099
071600         ELSE                                                     07160099
071700             IF VAR-CMNEKTB3 NOT = SPACES                         07170099
071800                 STRING VAR-CMNEKTAB        DELIMITED BY ' ',     07180099
071900                        VAR-CMNEKTB3        DELIMITED BY ' '      07190099
072000                     INTO VAR-128-TABLE-NAME                      07200099
072100             ELSE                                                 07210099
072200                 MOVE VAR-CMNEKTAB   TO VAR-128-TABLE-NAME        07220099
072300             END-IF                                               07230099
072400         END-IF                                                   07240099
072500     END-IF.                                                      07250099
072600                                                                  07260099
072700*    SET PS-USER-INPUT-VALID TO TRUE.                             07270099
072800     MOVE VAR-128-TABLE-NAME TO WS-CK-TABLE WS-CK-TABLE2          07280099
072900                          WS-CK-TABLE3 WS-CK-TABLE4.              07290099
073000                                                                  07300099
073600      IF SQLCODE NOT = 0                                          07360099
073700          SET PS-DB2-ERROR TO TRUE                                07370099
073800          MOVE 'N' TO MEM-CRE                                     07380099
073900          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     07390099
074000          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        07400099
074100          MOVE '2100-DETERMINE-SSID ABEND, CONTACT A DBA'         07410099
074200               TO VAR-LMSG                                        07420099
074300          MOVE 'CMN000  ' TO ISP-MSG                              07430099
074400          GO TO 2100-EXIT.                                        07440099
074500                                                                  07450099
074900     IF (WS-TBL-USCORE  = '_'   OR                                07490099
075000         WS-TBL2-USCORE = '_'   OR                                07500099
075100         WS-TBL3-USCORE = '_')                                    07510099
075200* NEW TABLE NAME                                                  07520099
075300         MOVE 'Y' TO WS-NEW-TABLE-SW                              07530099
075400         PERFORM 2200-CHECK-XREF-TABLE                            07540099
075500            THRU 2200-EXIT                                        07550099
075600     ELSE                                                         07560099
075700* OLD TABLE NAME                                                  07570099
075800         MOVE VAR-128-TABLE-NAME TO WS-DCLGEN-NM                  07580099
075900     END-IF.                                                      07590099
076000                                                                  07600099
076100* DETERMINE TARGET DCLGEN LIBRARY NAME                            07610099
076200     EVALUATE TRUE                                                07620099
076300         WHEN WS-CREATOR-1234 = 'DB2T'                            07630099
076400             MOVE 'TKMD.DB2.DCLGEN' TO PV-DCLGEN-DSNAME           07640099
076500         WHEN VAR-CRE = 'PKMO000'                                 07650099
076600         WHEN WS-CREATOR-1234 = 'DB1P'                            07660099
076700         WHEN WS-CREATOR-1234 = 'DB2P'                            07670099
076800         WHEN WS-CREATOR-1234 = 'DB3P'                            07680099
076900         WHEN WS-CREATOR-1234 = 'DB4P'                            07690099
077000         WHEN WS-CREATOR-1234 = 'DB5P'                            07700099
077100         WHEN WS-CREATOR-1234 = 'DB6P'                            07710099
077200         WHEN WS-CREATOR-1234 = 'DB7P'                            07720099
077300         WHEN WS-CREATOR-1234 = 'DB8P'                            07730099
077400         WHEN WS-CREATOR-1234 = 'DB9P'                            07740099
077500             MOVE 'PKMO.DB2.DCLGEN' TO PV-DCLGEN-DSNAME           07750099
077600         WHEN WS-CREATOR-1234 = 'DB20'                            07760099
077700         WHEN WS-CREATOR-1234 = 'DB21'                            07770099
077800         WHEN WS-CREATOR-1234 = 'DB22'                            07780099
077900         WHEN WS-CREATOR-1234 = 'DB23'                            07790099
078000         WHEN WS-CREATOR-1234 = 'DB24'                            07800099
078100         WHEN WS-CREATOR-1234 = 'DB25'                            07810099
078200         WHEN WS-CREATOR-1234 = 'DB26'                            07820099
078300         WHEN WS-CREATOR-1234 = 'DB27'                            07830099
078400         WHEN WS-CREATOR-1234 = 'DB28'                            07840099
078500         WHEN WS-CREATOR-1234 = 'DB29'                            07850099
078600             MOVE 'TKMD.DB2.TEAMTEST.DCLGEN' TO PV-DCLGEN-DSNAME  07860099
078700         WHEN WS-CREATOR-1234 = 'DB2Q'                            07870099
078800             MOVE 'QKMO.DB2.DCLGEN' TO PV-DCLGEN-DSNAME           07880099
078900         WHEN WS-CREATOR-1234 = 'DB2L'                            07890099
079000             MOVE 'LKMO.DB2.DCLGEN' TO PV-DCLGEN-DSNAME           07900099
079100         WHEN OTHER                                               07910099
079200             SET PS-USER-INPUT-NOT-VALID TO TRUE                  07920099
079300             MOVE 'N' TO MEM-CRE                                  07930099
079400             MOVE 'TABLE CREATOR INVALID' TO VAR-SMSG             07940099
079500             MOVE                                                 07950099
079600             'TABLE CREATOR INVALID - CORRECT AND RE-ENTER'       07960099
079700                  TO VAR-LMSG                                     07970099
079800             MOVE 'CMN000' TO ISP-MSG                             07980099
079900     END-EVALUATE.                                                07990099
080000                                                                  08000099
080100 2100-EXIT.                                                       08010099
080200     EXIT.                                                        08020099
080300     EJECT                                                        08030099
080400************************************************************      08040099
080500* CHECK TO SEE IF THE TABLE IS IN THE DBT_DCLGEN_XREF      *      08050099
080600* TABLE. IF SO THEN USE THE DCLGEN_NM. IF NOT CREATE ONE   *      08060099
080700************************************************************      08070099
080800 2200-CHECK-XREF-TABLE.                                           08080099
080900                                                                  08090099
084900     EXEC SQL                                                     08490099
085000         SELECT  DCLGEN_NM                                        08500099
085100           INTO :DBT00001-DCLGEN-NM                               08510099
085200           FROM  DB2PMVS.DB2PDBA.DBT_DCLGEN_XREF                  08520099
085300          WHERE  OBJ_NM       = :VAR-128-TABLE-NAME               08530099
085400            AND  DBMS_TYP_CDE = 'D'                               08540099
085500            AND  OBJ_QUAL_NM  IS NULL                             08550099
085600     END-EXEC.                                                    08560099
085700                                                                  08570099
085800     IF SQLCODE = ZERO                                            08580099
085900         MOVE DBT00001-DCLGEN-NM  TO  WS-DCLGEN-NM                08590099
086000         MOVE 'Y'                 TO  WS-MEM-REP                  08600099
086100         GO TO 2200-EXIT.                                         08610099
086200                                                                  08620099
086300     IF SQLCODE = +100                                            08630099
086400         MOVE 'Y'               TO WS-NEW-XREF-SW                 08640099
086500         INITIALIZE                WS-TEMP-TABLE                  08650099
086600         INITIALIZE                WS-TEMP-DCLGEN                 08660099
086700         INITIALIZE                WS-MAX-DCLGEN-NAME             08670099
087300         MOVE VAR-128-TABLE-NAME TO WS-TEMP-TABLE                 08730099
087400         MOVE WS-FIRST3         TO WS-DCLGEN-123                  08740099
087500         PERFORM 2300-OTHER-XREFS                                 08750099
087700         MOVE WS-TEMP-DCLGEN        TO WS-DCLGEN-NM               08770099
087800                                                                  08780099
087900         GO TO 2200-EXIT.                                         08790099
088000                                                                  08800099
088100     IF SQLCODE NOT = ZERO OR                                     08810099
088200        SQLCODE NOT = +100                                        08820099
088300         SET PS-DB2-ERROR TO TRUE                                 08830099
088400         MOVE 'N'         TO MEM-CRE                              08840099
088500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      08850099
088600         MOVE SQLCODE     TO VAR-SMSG-SQLCODE                     08860099
088700         MOVE '2200-CHECK-XREF-TABLE, CONTACT A DBA'              08870099
088800                          TO VAR-LMSG                             08880099
088900         MOVE 'CMN000'    TO ISP-MSG                              08890099
089000         GO TO 2200-EXIT.                                         08900099
089100                                                                  08910099
089200 2200-EXIT.                                                       08920099
089300     EXIT.                                                        08930099
089400     EJECT                                                        08940099
095700************************************************************      09570099
095800* DETERMINE WHETHER TABLE OR VIEW                          *      09580099
095900************************************************************      09590099
096000 2255-DETERMINE-TBL-OR-VW.                                        09600099
096100                                                                  09610099
096200     EXEC SQL                                                     09620099
096300         SELECT TYPE                                              09630099
096400           INTO :WS-TYPE                                          09640099
096500             FROM SYSIBM.SYSTABLES                                09650099
096600              WHERE NAME    = :VAR-128-TABLE-NAME                 09660099
096700                 AND CREATOR = :VAR-CMNEKCRE                      09670099
096800         WITH UR                                                  09680099
096900     END-EXEC.                                                    09690099
097000                                                                  09700099
097100     IF SQLCODE = +100                                            09710099
097200         SET PS-DB2-ERROR TO TRUE                                 09720099
097300         MOVE 'TABLE NOT FOUND' TO VAR-SMSG                       09730099
097400         MOVE 'N' TO MEM-CRE                                      09740099
097500         MOVE 'N' TO WS-MEM-REP                                   09750099
097600         MOVE                                                     09760099
097700         '2255-DETERMINE-TBL-OR-VW, CONTACT A DBA'                09770099
097800             TO VAR-LMSG                                          09780099
097900         MOVE 'CMN000  ' TO ISP-MSG                               09790099
098000     ELSE                                                         09800099
098100         IF SQLCODE NOT = ZERO                                    09810099
098200             SET PS-DB2-ERROR TO TRUE                             09820099
098300             MOVE 'N'         TO MEM-CRE                          09830099
098400             MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                  09840099
098500             MOVE SQLCODE     TO VAR-SMSG-SQLCODE                 09850099
098600             MOVE '2255-DETERMINE-TBL-OR-VW, CONTACT A DBA'       09860099
098700                              TO VAR-LMSG                         09870099
098800             MOVE 'CMN000'    TO ISP-MSG                          09880099
098900         END-IF                                                   09890099
099000     END-IF.                                                      09900099
099100                                                                  09910099
099200************************************************************      09920099
099300* CHECK TO SEE IF THERE ARE OTHER DCLGENS WITH THE FIRST   *      09930099
099400*  THREE CHARACTERS OF TABLE NAME. IF SO, WE WILL HAVE TO  *      09940099
099500*  ADD 1 TO THE SEQUENCE NUMBER AT THE END. IF THERE ARE NO*      09950099
099600*  TABLES WITH THESE THREE CHARACTERS, START SEQUENCE NUM- *      09960099
099700*  BER AT 00000.                                           *      09970099
099800************************************************************      09980099
099900 2300-OTHER-XREFS.                                                09990099
100000                                                                  10000099
100100     EXEC SQL                                                     10010099
100200         SELECT  MAX(DCLGEN_NM)                                   10020099
100300           INTO :WS-MAX-DCLGEN-NAME  :WS-DCLGEN-NAME-NULL         10030099
100400           FROM  DB2PMVS.DB2PDBA.DBT_DCLGEN_XREF                  10040099
100500           WHERE SUBSTR(DCLGEN_NM,1,3) = :WS-DCLGEN-123           10050099
100600             AND DBMS_TYP_CDE = 'D'                               10060099
100700     END-EXEC.                                                    10070099
100800                                                                  10080099
100900     EVALUATE TRUE                                                10090099
101000         WHEN SQLCODE = ZERO                                      10100099
101100             IF WS-DCLGEN-NAME-NULL = 0                           10110099
101200                 ADD 1 TO WS-MAX-DCLGEN-SEQNUM                    10120099
101300                 MOVE WS-MAX-DCLGEN-SEQNUM TO WS-DCLGEN-45678     10130099
101400             ELSE                                                 10140099
101500                 MOVE 00000           TO WS-DCLGEN-45678          10150099
101600             END-IF                                               10160099
101700         WHEN SQLCODE = +100                                      10170099
101800             MOVE 00000             TO WS-DCLGEN-45678            10180099
101900         WHEN OTHER                                               10190099
102000             SET PS-DB2-ERROR TO TRUE                             10200099
102100             MOVE 'N'         TO MEM-CRE                          10210099
102200             MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                  10220099
102300             MOVE SQLCODE     TO VAR-SMSG-SQLCODE                 10230099
102400             MOVE '2300-OTHER-XREFS, CONTACT A DBA'               10240099
102500                              TO VAR-LMSG                         10250099
102600             MOVE 'CMN000'    TO ISP-MSG                          10260099
102700     END-EVALUATE.                                                10270099
102800                                                                  10280099
102900************************************************************      10290099
103000* USE DYNALLOC TO ALLOCATE TEMP FILE THAT WILL BE DISPLAYED*      10300099
103100************************************************************      10310099
103200 3000-ALLOCATE-TEMP-FILE.                                         10320099
103300     SET PS-IS-NOT-ALLOCATED TO TRUE.                             10330099
103400                                                                  10340099
103500     INITIALIZE DP023-DYNALC-PARMS.                               10350099
103600     MOVE PC-DCLGEN-DDNAME TO DP023-DDNAME.                       10360099
103700     MOVE PV-DCLGEN-DSNAME TO DP023-DSNAME.                       10370099
103800     SET DP023-DISP-SHARE TO TRUE.                                10380099
103900     SET DP023-FREE-CLOSE-YES TO TRUE.                            10390099
104000     SET DP023-RECFM-FIXED-BLOCK TO TRUE.                         10400099
104100     MOVE LENGTH OF DCLGEN-RECORD TO DP023-RECSZ.                 10410099
104200     MOVE 1000 TO DP023-RECOUNT.                                  10420099
104300     MOVE WS-DCLGEN-NM TO DP023-MEMBER-NAME.                      10430099
104400     SET DP023-MEMDISP-LOCATE TO TRUE.                            10440099
104500     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     10450099
104600                                                                  10460099
104700     PERFORM DP023-0000-DYNALC.                                   10470099
104800                                                                  10480099
104900     IF ((DP023-LASTRC NOT = DP023-RC-MEMBER-DOESNT-EXIST)        10490099
105000             AND (DP023-LASTRC NOT = ZEROS))                      10500099
105100         SET PS-IS-NOT-ALLOCATED TO TRUE                          10510099
105200         MOVE DP023-DDNAME TO PV-DR-DDNAME                        10520099
105300         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           10530099
105400         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          10540099
105500         MOVE 'MBR LOCATE ERROR' TO VAR-SMSG                      10550099
105600         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG             10560099
105700         MOVE 'CMN000  ' TO ISP-MSG                               10570099
105800     ELSE                                                         10580099
105900         IF (DP023-LASTRC = DP023-RC-MEMBER-DOESNT-EXIST)         10590099
106000             SET DP023-MEMDISP-NEW TO TRUE                        10600099
106100         ELSE                                                     10610099
106200             SET DP023-MEMDISP-UPDATE TO TRUE                     10620099
106300         END-IF                                                   10630099
106400         PERFORM DP023-0000-DYNALC                                10640099
106500         IF DP023-LASTRC = ZERO                                   10650099
106600             SET PS-IS-ALLOCATED TO TRUE                          10660099
106700         ELSE                                                     10670099
106800             SET PS-IS-NOT-ALLOCATED TO TRUE                      10680099
106900             MOVE DP023-DDNAME TO PV-DR-DDNAME                    10690099
107000             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       10700099
107100             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      10710099
107200             MOVE 'MBR ALLOCATE ERROR' TO VAR-SMSG                10720099
107300             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG         10730099
107400             MOVE 'CMN000  ' TO ISP-MSG                           10740099
107500         END-IF                                                   10750099
107600     END-IF.                                                      10760099
107700                                                                  10770099
107800************************************************************      10780099
107900* MAIN-LINE LOGIC                                          *      10790099
108000************************************************************      10800099
108100 4000-DB2-TABLE-FUNCTIONS.                                        10810099
108200                                                                  10820099
108300     MOVE 'N' TO PS-TABLE-VALIDITY.                               10830099
108400                                                                  10840099
108500     EXEC SQL                                                     10850099
108600         SELECT '1'                                               10860099
108700           INTO :CALL-FILLER                                      10870099
108800             FROM SYSIBM.SYSTABLES                                10880099
108900               WHERE NAME    = :VAR-128-TABLE-NAME                10890099
109000                AND CREATOR = :VAR-CMNEKCRE                       10900099
109100                AND TYPE    IN ('G','T','V','M')                  10910099
109200         WITH UR                                                  10920099
109300     END-EXEC.                                                    10930099
109400                                                                  10940099
109500     IF SQLCODE = +100                                            10950099
109600         SET PS-DB2-ERROR TO TRUE                                 10960099
109700         MOVE 'TABLE NOT FOUND' TO VAR-SMSG                       10970099
109800         MOVE 'N' TO MEM-CRE                                      10980099
109900         MOVE 'N' TO WS-MEM-REP                                   10990099
110000         MOVE                                                     11000099
110100         '4000-SELECT-SYSTABLES ABEND, CONTACT A DBA'             11010099
110200             TO VAR-LMSG                                          11020099
110300         MOVE 'CMN000  ' TO ISP-MSG                               11030099
110400         GO TO 4000-EXIT.                                         11040099
110500                                                                  11050099
110600     IF SQLCODE NOT = ZERO                                        11060099
110700         SET PS-DB2-ERROR TO TRUE                                 11070099
110800         MOVE 'N'         TO MEM-CRE                              11080099
110900         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      11090099
111000         MOVE SQLCODE     TO VAR-SMSG-SQLCODE                     11100099
111100         MOVE '4000-SELECT-SYSTABLES ABEND, CONTACT A DBA'        11110099
111200                          TO VAR-LMSG                             11120099
111300         MOVE 'CMN000'    TO ISP-MSG                              11130099
111400         GO TO 4000-EXIT                                          11140099
111500     END-IF.                                                      11150099
111600                                                                  11160099
111700     PERFORM 4210-OPEN-SYSCOLS.                                   11170099
111800                                                                  11180099
111900     IF PS-DB2-ERROR                                              11190099
112000         GO TO 4000-EXIT.                                         11200099
112100                                                                  11210099
112200     MOVE SPACES TO INCORE-TABLE.                                 11220099
112210     SET PS-NO-NAME-ERROR TO TRUE.                                11221099
112300     PERFORM 4310-FETCH-SYSCOLS                                   11230099
112400         UNTIL SQLCODE NOT = ZERO                                 11240099
112500         OR PS-NAME-ERROR.                                        11250099
112600                                                                  11260099
112700     IF PS-DB2-ERROR                                              11270099
112800         GO TO 4000-EXIT.                                         11280099
112900                                                                  11290099
113000     PERFORM 4410-CLOSE-SYSCOLS.                                  11300099
113100                                                                  11310099
113200     IF PS-DB2-ERROR                                              11320099
113300       OR PS-NAME-ERROR                                           11330099
113400         GO TO 4000-EXIT.                                         11340099
113500                                                                  11350099
113600     PERFORM 5000-CREATE-DCLGEN-MEMBER.                           11360099
113700                                                                  11370099
113800     IF NEW-XREF                                                  11380099
113900         PERFORM 5400-INSERT-XREF                                 11390099
114000     END-IF.                                                      11400099
114100                                                                  11410099
114200     EXEC SQL                                                     11420099
114300          COMMIT                                                  11430099
114400     END-EXEC.                                                    11440099
114500                                                                  11450099
114600 4000-EXIT.                                                       11460099
114700     EXIT.                                                        11470099
114800     EJECT                                                        11480099
114900************************************************************      11490099
115000* OPEN SYSCOLS_CURSOR CURSOR                               *      11500099
115100************************************************************      11510099
115200 4210-OPEN-SYSCOLS.                                               11520099
115300                                                                  11530099
115400      EXEC SQL                                                    11540099
115500          OPEN SYSCOLS_CURSOR                                     11550099
115600      END-EXEC.                                                   11560099
115700                                                                  11570099
115800      IF SQLCODE NOT = 0                                          11580099
115900          SET PS-DB2-ERROR TO TRUE                                11590099
116000          MOVE 'N' TO MEM-CRE                                     11600099
116100          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     11610099
116200          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        11620099
116300          MOVE '4210-OPEN CURSOR ABEND, CONTACT A DBA'            11630099
116400               TO VAR-LMSG                                        11640099
116500          MOVE 'CMN000  ' TO ISP-MSG                              11650099
116600      END-IF.                                                     11660099
116700                                                                  11670099
116800************************************************************      11680099
116900* FETCH THE ROWS FROM SYSIBM.SYSCOLUMNS                    *      11690099
117000************************************************************      11700099
117100 4310-FETCH-SYSCOLS.                                              11710099
117200                                                                  11720099
117300     INITIALIZE DCLSYSCOLUMNS.                                    11730099
117400                                                                  11740099
117500     EXEC SQL                                                     11750099
117600         FETCH SYSCOLS_CURSOR                                     11760099
117700         INTO                                                     11770099
117800               :SYSCOL-NAME                                       11780099
117900              ,:SYSCOL-COLNO                                      11790099
118000              ,:SYSCOL-COLTYPE                                    11800099
118100              ,:SYSCOL-LENGTH                                     11810099
118200              ,:SYSCOL-SCALE                                      11820099
118300              ,:SYSCOL-NULLS                                      11830099
118400              ,:SYSCOL-DEFAULT                                    11840099
118500              ,:SYSCOL-KEYSEQ                                     11850099
118600              ,:SYSCOL-DEFAULTVALUE                               11860099
118700     END-EXEC.                                                    11870099
118800                                                                  11880099
118900     IF SQLCODE = ZERO                                            11890099
119000         ADD 1 TO LNUM                                            11900099
119010         MOVE ZERO TO PV-NM-COUNTR                                11901099
119100         INSPECT SYSCOL-NAME-TEXT TALLYING PV-NM-COUNTR           11910099
119200             FOR CHARACTERS BEFORE INITIAL SPACE                  11920099
119300         IF PV-NM-COUNTR > 21                                     11930099
119400             SET PS-NAME-ERROR TO TRUE                            11940099
119500             MOVE 'N' TO MEM-CRE                                  11950099
119600             MOVE 'COLUMN NAME LENGTH > 21 ' TO VAR-SMSG          11960099
119700             STRING SYSCOL-NAME-TEXT DELIMITED BY SPACE           11970099
119800                    ' IS TOO LONG'  DELIMITED BY SIZE             11980099
119900                 INTO VAR-LMSG                                    11990099
120000             MOVE 'CMN000  ' TO ISP-MSG                           12000099
120100         END-IF                                                   12010099
120200         MOVE SYSCOL-NAME-TEXT TO INCORE-NAME (LNUM)              12020099
120300         MOVE SYSCOL-COLTYPE TO INCORE-COLTYPE (LNUM)             12030099
120400         MOVE SYSCOL-LENGTH TO INCORE-LENGTH (LNUM)               12040099
120500         MOVE SYSCOL-SCALE TO INCORE-SCALE (LNUM)                 12050099
120600         IF SYSCOL-NULLS = 'Y'                                    12060099
120700             MOVE SPACES TO INCORE-NULLS (LNUM)                   12070099
120800         ELSE                                                     12080099
120900             IF SYSCOL-DEFAULT = 'N'                              12090099
121000                 MOVE 'NOT NULL ' TO INCORE-NULLS (LNUM)          12100099
121100             ELSE                                                 12110099
121200                 MOVE 'NOT NULL WITH DEFAULT' TO                  12120099
121300                           INCORE-NULLS (LNUM)                    12130099
121400             END-IF                                               12140099
121500         END-IF                                                   12150099
121600     ELSE                                                         12160099
121700         IF SQLCODE NOT = +100                                    12170099
121800             SET PS-DB2-ERROR TO TRUE                             12180099
121900             MOVE 'N' TO MEM-CRE                                  12190099
122000             MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                  12200099
122100             MOVE SQLCODE TO VAR-SMSG-SQLCODE                     12210099
122200             MOVE                                                 12220099
122300             '4310-FETCH-SYSCOLS ABEND, CONTACT A DBA'            12230099
122400                 TO VAR-LMSG                                      12240099
122500             MOVE 'CMN000  ' TO ISP-MSG                           12250099
122600         END-IF                                                   12260099
122700     END-IF.                                                      12270099
122800                                                                  12280099
122900************************************************************      12290099
123000* CLOSE SYSCOLS_CURSOR                                     *      12300099
123100************************************************************      12310099
123200 4410-CLOSE-SYSCOLS.                                              12320099
123300                                                                  12330099
123400     EXEC SQL                                                     12340099
123500         CLOSE SYSCOLS_CURSOR                                     12350099
123600     END-EXEC.                                                    12360099
123700                                                                  12370099
123800     IF SQLCODE NOT = ZERO                                        12380099
123900         SET PS-DB2-ERROR TO TRUE                                 12390099
124000         MOVE 'N' TO MEM-CRE                                      12400099
124100         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      12410099
124200         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         12420099
124300         MOVE '4410-CLOSE CURSOR ABEND, CONTACT A DBA'            12430099
124400              TO VAR-LMSG                                         12440099
124500         MOVE 'CMN000  ' TO ISP-MSG                               12450099
124600     END-IF.                                                      12460099
124700                                                                  12470099
124800************************************************************      12480099
124900* CREATE DCLGEN MEMBER                                     *      12490099
125000************************************************************      12500099
125100*                                                                 12510099
125200 5000-CREATE-DCLGEN-MEMBER.                                       12520099
125300     OPEN OUTPUT DCLGEN-FILE.                                     12530099
125400     MOVE SPACES TO DCLGEN-DATA1-NAME1.                           12540099
125500     MOVE SPACES TO DCLGEN-DATA1-NAME2.                           12550099
125600     MOVE SPACES TO DCLGEN-DATA1-NAME3.                           12560099
125700     MOVE SPACES TO WS-DATA1-NAME.                                12570099
125800     MOVE SPACES TO WS-DATA5-NAME.                                12580099
125900     STRING VAR-128-TABLE-NAME DELIMITED BY SPACE                 12590099
126000            ')' DELIMITED BY SIZE                                 12600099
126100         INTO WS-DATA1-NAME.                                      12610099
126200     MOVE WS-DATA1-NAME (1:50)  TO DCLGEN-DATA1-NAME1.            12620099
126300     MOVE WS-DATA1-NAME (51:63)  TO DCLGEN-DATA1-NAME2.           12630099
126400     MOVE WS-DATA1-NAME (114:16) TO DCLGEN-DATA1-NAME3.           12640099
126500     STRING VAR-128-TABLE-NAME DELIMITED BY SPACE                 12650099
126600                          ' TABLE' DELIMITED BY SIZE              12660099
126700                          INTO WS-DATA5-NAME.                     12670099
126800     MOVE WS-DATA5-NAME (1:44)    TO DCLGEN-DATA5-NAME1.          12680099
126900     MOVE WS-DATA5-NAME (45:61)   TO DCLGEN-DATA5-NAME2.          12690099
127000     MOVE WS-DATA5-NAME (106:29)  TO DCLGEN-DATA5-NAME3.          12700099
127100     MOVE VAR-128-TABLE-NAME (1:35)  TO DCLGEN-DATA6-NAME1.       12710099
127200     MOVE VAR-128-TABLE-NAME (36:93) TO DCLGEN-DATA6-NAME2.       12720099
127300     INITIALIZE DCLGEN-DATA2-LIBRARY.                             12730099
127400     STRING 'LIBRARY('                  DELIMITED BY SIZE         12740099
127500            PV-DCLGEN-DSNAME            DELIMITED BY SPACES       12750099
127600            '('                         DELIMITED BY SIZE         12760099
127700            WS-DCLGEN-NM                DELIMITED BY SPACES       12770099
127800            ')'                         DELIMITED BY SIZE         12780099
127900            ')'                         DELIMITED BY SIZE         12790099
128000         INTO DCLGEN-DATA2-LIBRARY.                               12800099
128100     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            12810099
128200     WRITE DCLGEN-RECORD.                                         12820099
128300     MOVE DCLGEN-DATA1 TO DCLGEN-RECORD.                          12830099
128400     WRITE DCLGEN-RECORD.                                         12840099
128500     IF DCLGEN-DATA1-NAME2 > SPACES                               12850099
128600         MOVE DCLGEN-DATA1-2 TO DCLGEN-RECORD                     12860099
128700         WRITE DCLGEN-RECORD                                      12870099
128800         IF DCLGEN-DATA1-NAME3 > SPACES                           12880099
128900             MOVE DCLGEN-DATA1-3 TO DCLGEN-RECORD                 12890099
129000             WRITE DCLGEN-RECORD                                  12900099
129100         END-IF                                                   12910099
129200     END-IF.                                                      12920099
129300     MOVE DCLGEN-DATA2 TO DCLGEN-RECORD.                          12930099
129400     WRITE DCLGEN-RECORD.                                         12940099
129500     MOVE DCLGEN-DATA3 TO DCLGEN-RECORD.                          12950099
129600     WRITE DCLGEN-RECORD.                                         12960099
129700     MOVE DCLGEN-DATA4 TO DCLGEN-RECORD.                          12970099
129800     WRITE DCLGEN-RECORD.                                         12980099
129900     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            12990099
130000     WRITE DCLGEN-RECORD.                                         13000099
130100     MOVE DCLGEN-DATA5 TO DCLGEN-RECORD.                          13010099
130200     WRITE DCLGEN-RECORD.                                         13020099
130300     IF DCLGEN-DATA5-NAME2 > SPACES                               13030099
130400         MOVE DCLGEN-DATA5-2 TO DCLGEN-RECORD                     13040099
130500         WRITE DCLGEN-RECORD                                      13050099
130600         IF DCLGEN-DATA5-NAME3 > SPACES                           13060099
130700             MOVE DCLGEN-DATA5-3 TO DCLGEN-RECORD                 13070099
130800             WRITE DCLGEN-RECORD                                  13080099
130900         END-IF                                                   13090099
131000     END-IF.                                                      13100099
131100     MOVE 1 TO LNUM.                                              13110099
131200     PERFORM 5100-CREATE-DECLARE                                  13120099
131300         UNTIL INCORE-TABLE-LINE (LNUM) = SPACES.                 13130099
131400     MOVE DCLGEN-DATA8 TO DCLGEN-RECORD.                          13140099
131500     WRITE DCLGEN-RECORD.                                         13150099
135400     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            13540099
135500     WRITE DCLGEN-RECORD.                                         13550099
135600     MOVE DCLGEN-DATA6 TO DCLGEN-RECORD.                          13560099
135700     WRITE DCLGEN-RECORD.                                         13570099
135800     IF DCLGEN-DATA6-NAME2 > SPACES                               13580099
135900         MOVE DCLGEN-DATA6-2 TO DCLGEN-RECORD                     13590099
136000         WRITE DCLGEN-RECORD                                      13600099
136100         IF DCLGEN-DATA6-NAME3 > SPACES                           13610099
136200             MOVE DCLGEN-DATA6-3 TO DCLGEN-RECORD                 13620099
136300             WRITE DCLGEN-RECORD                                  13630099
136400         END-IF                                                   13640099
136500     END-IF.                                                      13650099
136600     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            13660099
136700     WRITE DCLGEN-RECORD.                                         13670099
136800     MOVE SPACES TO DCLGEN-DATA9-NAM.                             13680099
136900     STRING WS-DCLGEN-NM DELIMITED BY SPACE                       13690099
137000            '.'          DELIMITED BY SIZE                        13700099
137100         INTO DCLGEN-DATA9-NAM.                                   13710099
137200     MOVE DCLGEN-DATA9 TO DCLGEN-RECORD.                          13720099
137300     WRITE DCLGEN-RECORD.                                         13730099
137400     MOVE 1 TO LNUM.                                              13740099
137500     PERFORM 5200-CREATE-COBOL THRU 5200-EXIT                     13750099
137600         UNTIL INCORE-TABLE-LINE (LNUM) = SPACES.                 13760099
137700     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            13770099
137800     WRITE DCLGEN-RECORD.                                         13780099
137900     MOVE HOLD-NUM TO  DCLGEN-DATA11-NUM.                         13790099
138000     MOVE DCLGEN-DATA11 TO DCLGEN-RECORD.                         13800099
138100     WRITE DCLGEN-RECORD.                                         13810099
138200     MOVE DCLGEN-AST TO DCLGEN-RECORD.                            13820099
138300     WRITE DCLGEN-RECORD.                                         13830099
138400     CLOSE DCLGEN-FILE.                                           13840099
138500     MOVE 'Y' TO MEM-CRE.                                         13850099
138600                                                                  13860099
138700 5100-CREATE-DECLARE.                                             13870099
138800     MOVE ZEROS TO PV-COLNM-LENGTH.                               13880099
138900     INSPECT INCORE-NAME (LNUM) TALLYING PV-COLNM-LENGTH          13890099
139000     FOR CHARACTERS BEFORE INITIAL SPACE.                         13900099
139100     IF PV-COLNM-LENGTH > 18                                      13910099
139200         IF FIRST-SWITCH = 1                                      13920099
139300             MOVE '( ' TO DCLGEN-DATA7A-COL1                      13930099
139400         ELSE                                                     13940099
139500             MOVE ' ,' TO DCLGEN-DATA7A-COL1                      13950099
139600         END-IF                                                   13960099
139700         MOVE INCORE-NAME (LNUM) TO DCLGEN-DATA7A-COL2            13970099
139800         MOVE DCLGEN-DATA7A TO DCLGEN-RECORD                      13980099
139900         WRITE DCLGEN-RECORD                                      13990099
140000         MOVE SPACES TO DCLGEN-DATA7-COL2                         14000099
140100         MOVE SPACES TO DCLGEN-DATA7-COL1                         14010099
140200     ELSE                                                         14020099
140300         IF FIRST-SWITCH = 1                                      14030099
140400             MOVE '( ' TO DCLGEN-DATA7-COL1                       14040099
140500         ELSE                                                     14050099
140600             MOVE ' ,' TO DCLGEN-DATA7-COL1                       14060099
140700         END-IF                                                   14070099
140800         MOVE INCORE-NAME (LNUM) TO DCLGEN-DATA7-COL2             14080099
140900     END-IF.                                                      14090099
141000     MOVE INCORE-COLTYPE (LNUM) TO DCLGEN-DATA7-COL3.             14100099
141100     IF INCORE-COLTYPE (LNUM) = 'TIMESTMP'                        14110099
141200         MOVE 'TIMESTAMP' TO DCLGEN-DATA7-COL3.                   14120099
141210     IF INCORE-COLTYPE (LNUM) = 'BIGINT'                          14121099
141220         MOVE 'BIG INTEGER' TO DCLGEN-DATA7-COL3.                 14122099
141300     MOVE SPACES TO HOLD-COLTYPE                                  14130099
141910     IF INCORE-COLTYPE (LNUM) = 'CHAR'                            14191099
141920         MOVE 'CHAR' TO TYPE1-COL1                                14192099
141930         MOVE '(' TO TYPE1-COL2                                   14193099
141940         MOVE INCORE-LENGTH (LNUM) TO TYPE1-COL3                  14194099
141950         MOVE ')' TO TYPE1-COL4                                   14195099
141960         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14196099
142000     IF INCORE-COLTYPE (LNUM) = 'VARCHAR'                         14200099
142100         MOVE 'VARCHAR' TO TYPE2-COL1                             14210099
142200         MOVE '(' TO TYPE2-COL2                                   14220099
142300         MOVE INCORE-LENGTH (LNUM) TO TYPE2-COL3                  14230099
142400         MOVE ')' TO TYPE2-COL4                                   14240099
142500         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14250099
142600     IF INCORE-COLTYPE (LNUM) = 'LONGVAR'                         14260099
142700         MOVE 'VARCHAR' TO TYPE2-COL1                             14270099
142800         MOVE '(' TO TYPE2-COL2                                   14280099
142900         MOVE INCORE-LENGTH (LNUM) TO TYPE2-COL3                  14290099
143000         MOVE ')' TO TYPE2-COL4                                   14300099
143100         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14310099
143200     IF INCORE-COLTYPE (LNUM) = 'DECIMAL'                         14320099
143300         MOVE 'DECIMAL' TO TYPE3-COL1                             14330099
143400         MOVE '(' TO TYPE3-COL2                                   14340099
143500         MOVE INCORE-LENGTH (LNUM) TO TYPE3-COL3                  14350099
143600         MOVE ', ' TO TYPE3-COL4                                  14360099
143700         MOVE INCORE-SCALE (LNUM) TO TYPE3-COL5                   14370099
143800         MOVE ')' TO TYPE3-COL6                                   14380099
143900         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14390099
143910     IF INCORE-COLTYPE (LNUM) = 'BINARY'                          14391099
143920         MOVE 'BINARY' TO TYPE4-COL1                              14392099
143930         MOVE '(' TO TYPE4-COL2                                   14393099
143940         MOVE INCORE-LENGTH (LNUM) TO TYPE4-COL3                  14394099
143950         MOVE ')' TO TYPE4-COL4                                   14395099
143960         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14396099
143970     IF INCORE-COLTYPE (LNUM) = 'VARBINARY'                       14397099
143980         MOVE 'VARBINRY' TO TYPE5-COL1                            14398099
143990         MOVE '(' TO TYPE5-COL2                                   14399099
143991         MOVE INCORE-LENGTH (LNUM) TO TYPE5-COL3                  14399199
143992         MOVE ')' TO TYPE5-COL4                                   14399299
143993         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14399399
143994     IF INCORE-COLTYPE (LNUM) = 'DECFLOAT'                        14399499
143995         MOVE 'DECIMAL FLT' TO TYPE6-COL1                         14399599
143996         MOVE '(' TO TYPE6-COL2                                   14399699
143997         MOVE INCORE-LENGTH (LNUM) TO TYPE6-COL3                  14399799
143998         MOVE ')' TO TYPE6-COL4                                   14399899
143999         MOVE HOLD-COLTYPE TO DCLGEN-DATA7-COL3.                  14399999
144000     MOVE INCORE-NULLS (LNUM) TO DCLGEN-DATA7-COL4.               14400099
144100     MOVE DCLGEN-DATA7 TO DCLGEN-RECORD.                          14410099
144200     WRITE DCLGEN-RECORD.                                         14420099
144300     MOVE ZEROS TO FIRST-SWITCH.                                  14430099
144400     ADD 1 TO LNUM.                                               14440099
144500                                                                  14450099
144600***********************************************************       14460099
144700***  CREATE THE COBOL PORTION OF THE DCLGEN ***************       14470099
144800***********************************************************       14480099
144900 5200-CREATE-COBOL.                                               14490099
145000     MOVE ZEROS TO PV-COUNTR.                                     14500099
145100     MOVE ZEROS TO PV-COUNTR1.                                    14510099
145200     MOVE SPACES TO DCLGEN-DATA10.                                14520099
145300     MOVE '     10' TO DCLGEN-DATA10-10.                          14530099
145400     MOVE '     10' TO DCLGEN-DATA10B-10.                         14540099
145500     IF NEW-TABLE                                                 14550099
145600         MOVE WS-DCLGEN-NM TO HOLD-NAME                           14560099
145700     ELSE                                                         14570099
145800         MOVE VAR-TAB TO HOLD-NAME                                14580099
145900     END-IF.                                                      14590099
146000     INSPECT HOLD-NAME TALLYING PV-COUNTR FOR CHARACTERS          14600099
146100         BEFORE INITIAL SPACE.                                    14610099
146200     ADD 1 TO PV-COUNTR.                                          14620099
146300     MOVE '-' TO HOLD-NAME (PV-COUNTR:1).                         14630099
146400     ADD 1 TO PV-COUNTR.                                          14640099
146500     INSPECT INCORE-NAME (LNUM) REPLACING ALL '_' BY '-'.         14650099
146600     MOVE INCORE-NAME (LNUM) TO HOLD-NAME (PV-COUNTR:30).         14660099
146700                                                                  14670099
146800     INSPECT HOLD-NAME TALLYING PV-COUNTR1 FOR CHARACTERS         14680099
146900         BEFORE INITIAL SPACE.                                    14690099
147800     IF PV-COUNTR1 = 30                                           14780099
147900         MOVE HOLD-NAME TO DCLGEN-DATA10B-N2                      14790099
148000         MOVE SPACES    TO HOLD-NAME                              14800099
148100         MOVE SPACES    TO DCLGEN-DATA10-N2                       14810099
148200         MOVE SPACES    TO DCLGEN-DATA10-10                       14820099
148300         MOVE DCLGEN-DATA10B TO DCLGEN-RECORD                     14830099
148400         WRITE DCLGEN-RECORD                                      14840099
148500     ELSE                                                         14850099
148600         MOVE HOLD-NAME TO DCLGEN-DATA10-N2                       14860099
148800     END-IF.                                                      14880099
148900     IF INCORE-COLTYPE (LNUM) = 'VARCHAR' OR 'LONGVAR'            14890099
149000         STRING HOLD-NAME DELIMITED BY SPACE                      14900099
149100                '.' DELIMITED BY SIZE                             14910099
149200                INTO DCLGEN-DATA10-N2                             14920099
149300         MOVE DCLGEN-DATA10 TO DCLGEN-RECORD                      14930099
149400         WRITE DCLGEN-RECORD                                      14940099
149500         PERFORM 5300-WRITE-49-REC                                14950099
149600         ADD 1 TO LNUM                                            14960099
149700         ADD 1 TO HOLD-NUM                                        14970099
149800         GO TO 5200-EXIT.                                         14980099
149900     MOVE 'PIC' TO DCLGEN-DATA10-N3.                              14990099
150000     MOVE SPACES TO WORK-AREA.                                    15000099
150100     IF INCORE-COLTYPE (LNUM) = ('INTEGER' OR 'SMALLINT' OR       15010099
150200         'DECIMAL' OR 'BIGINT' OR 'DECFLOAT')                     15020099
150300         MOVE 'S9(' TO WA-01                                      15030099
150400       ELSE                                                       15040099
150500         MOVE '*X(' TO WA-01.                                     15050099
150600     SUBTRACT INCORE-SCALE (LNUM) FROM INCORE-LENGTH (LNUM).      15060099
150700     IF INCORE-LENGTH (LNUM) = ZEROS                              15070099
150800         MOVE SPACES TO WA-01 WA-02R                              15080099
150900         MOVE 'S' TO  WA-03                                       15090099
151000       ELSE                                                       15100099
151100         MOVE INCORE-LENGTH (LNUM) TO WA-02                       15110099
151200         MOVE ')' TO WA-03.                                       15120099
151300     IF INCORE-COLTYPE (LNUM) = 'DATE'                            15130099
151400         MOVE 10 TO WA-02.                                        15140099
151500     IF INCORE-COLTYPE (LNUM) = 'SMALLINT'                        15150099
151600         MOVE 4 TO WA-02.                                         15160099
151700     IF INCORE-COLTYPE (LNUM) = 'INTEGER'                         15170099
151800         MOVE 9 TO WA-02.                                         15180099
151810     IF INCORE-COLTYPE (LNUM) = 'BIGINT'                          15181099
151820         MOVE 8 TO WA-02.                                         15182099
151900     IF INCORE-COLTYPE (LNUM) = 'TIME'                            15190099
152000         MOVE 8 TO WA-02.                                         15200099
152100     IF INCORE-COLTYPE (LNUM) = 'TIMESTMP'                        15210099
152200         MOVE 26 TO WA-02                                         15220099
152210     ELSE                                                         15221099
152300         IF INCORE-SCALE (LNUM) = ZERO                            15230099
152400             MOVE SPACES TO WA-04                                 15240099
152500           ELSE                                                   15250099
152600                 MOVE 'V9(' TO WA-04A                             15260099
152700                 MOVE INCORE-SCALE (LNUM) TO WA-04B               15270099
152800                 MOVE ')' TO WA-04C                               15280099
152810     END-IF.                                                      15281099
152900     IF INCORE-SCALE (LNUM) = ZERO AND                            15290099
153000        INCORE-COLTYPE (LNUM) = 'DECIMAL'                         15300099
153100         MOVE 'V' TO WA-04.                                       15310099
153200     MOVE SPACES TO WA-05.                                        15320099
153300     IF INCORE-COLTYPE (LNUM) = ('SMALLINT' OR 'INTEGER' OR       15330099
153310                                 'BIGINT')                        15331099
153400         MOVE '*COMP' TO WA-05.                                   15340099
153500     IF INCORE-COLTYPE (LNUM) = ('DECIMAL' OR 'DECFLOAT')         15350099
153600         MOVE '*COMP-3' TO WA-05.                                 15360099
153700     MOVE '.' TO WA-06.                                           15370099
153800     IF WA-02R1 = ZERO                                            15380099
153900         MOVE WA-02R2 TO WA-02R1                                  15390099
154000         MOVE WA-02R3 TO WA-02R2                                  15400099
154100         MOVE SPACE TO WA-02R3.                                   15410099
154200     IF WA-02R1 = ZERO                                            15420099
154300         MOVE WA-02R2 TO WA-02R1                                  15430099
154400         MOVE WA-02R3 TO WA-02R2                                  15440099
154500         MOVE SPACE TO WA-02R3.                                   15450099
154600     IF WA-04BR1 = ZERO                                           15460099
154700         MOVE WA-04BR2 TO WA-04BR1                                15470099
154800         MOVE ')' TO WA-04BR2                                     15480099
154900         MOVE SPACE TO WA-04C.                                    15490099
155000     STRING WA-01     DELIMITED BY SPACES                         15500099
155100            WA-02     DELIMITED BY SPACES                         15510099
155200            WA-03     DELIMITED BY SPACES                         15520099
155300            WA-04     DELIMITED BY SPACES                         15530099
155400            WA-05     DELIMITED BY SPACES                         15540099
155500            WA-06     DELIMITED BY SPACES                         15550099
155600         INTO DCLGEN-DATA10-N4.                                   15560099
155700     INSPECT DCLGEN-DATA10-N4 REPLACING ALL '*' BY ' '.           15570099
155800     MOVE DCLGEN-DATA10 TO DCLGEN-RECORD.                         15580099
155900     WRITE DCLGEN-RECORD.                                         15590099
156000     ADD 1 TO LNUM.                                               15600099
156100     ADD 1 TO HOLD-NUM.                                           15610099
156200 5200-EXIT.                                                       15620099
156300     EXIT.                                                        15630099
156400                                                                  15640099
156500 5300-WRITE-49-REC.                                               15650099
156600     MOVE ZEROS TO PV-COUNTR.                                     15660099
156700     MOVE ZEROS TO PV-LEN.                                        15670099
156800     IF NEW-TABLE                                                 15680099
156900         MOVE WS-DCLGEN-NM TO HOLD-NAME                           15690099
157000     ELSE                                                         15700099
157100         MOVE VAR-TAB      TO HOLD-NAME                           15710099
157200     END-IF.                                                      15720099
157300*    MOVE VAR-TAB TO HOLD-NAME.                                   15730099
157400     INSPECT HOLD-NAME TALLYING PV-COUNTR FOR CHARACTERS          15740099
157500         BEFORE INITIAL SPACE.                                    15750099
157600     ADD 1 TO PV-COUNTR.                                          15760099
157700     MOVE '-' TO HOLD-NAME (PV-COUNTR:1).                         15770099
157800     ADD 1 TO PV-COUNTR.                                          15780099
157900     INSPECT INCORE-NAME (LNUM) REPLACING ALL '_' BY '-'.         15790099
158000     INSPECT INCORE-NAME (LNUM) TALLYING PV-LEN FOR CHARACTERS    15800099
158100         BEFORE INITIAL SPACE.                                    15810099
158200     MOVE INCORE-NAME (LNUM) TO HOLD-NAME (PV-COUNTR:PV-LEN).     15820099
158300     ADD PV-LEN TO PV-COUNTR.                                     15830099
158400     MOVE '-LEN' TO HOLD-NAME (PV-COUNTR:4).                      15840099
158500     MOVE HOLD-NAME TO DCLGEN-DATA10A-N2.                         15850099
158600     MOVE 'S9(4) COMP.' TO DCLGEN-DATA10A-N3.                     15860099
158700     MOVE DCLGEN-DATA10A TO DCLGEN-RECORD.                        15870099
158800     WRITE DCLGEN-RECORD.                                         15880099
158900     MOVE DCLGEN-DATA10A1 TO DCLGEN-RECORD.                       15890099
159000     WRITE DCLGEN-RECORD.                                         15900099
159100     MOVE '-TEXT' TO HOLD-NAME (PV-COUNTR:5).                     15910099
159200     MOVE HOLD-NAME TO DCLGEN-DATA10A-N2.                         15920099
159300     MOVE INCORE-LENGTH (LNUM) TO WA-VAR.                         15930099
159400     MOVE SPACES TO DCLGEN-DATA10A-N3.                            15940099
159500     IF WA-VAR1 = ZERO                                            15950099
159600         MOVE WA-VAR2 TO WA-VAR1                                  15960099
159700         MOVE WA-VAR3 TO WA-VAR2                                  15970099
159800         MOVE WA-VAR4 TO WA-VAR3                                  15980099
159900         MOVE WA-VAR5 TO WA-VAR4                                  15990099
160000         MOVE SPACE TO WA-VAR5.                                   16000099
160100     IF WA-VAR1 = ZERO                                            16010099
160200         MOVE WA-VAR2 TO WA-VAR1                                  16020099
160300         MOVE WA-VAR3 TO WA-VAR2                                  16030099
160400         MOVE WA-VAR4 TO WA-VAR3                                  16040099
160500         MOVE WA-VAR5 TO WA-VAR4                                  16050099
160600         MOVE SPACE TO WA-VAR5.                                   16060099
160700     IF WA-VAR1 = ZERO                                            16070099
160800         MOVE WA-VAR2 TO WA-VAR1                                  16080099
160900         MOVE WA-VAR3 TO WA-VAR2                                  16090099
161000         MOVE WA-VAR4 TO WA-VAR3                                  16100099
161100         MOVE WA-VAR5 TO WA-VAR4                                  16110099
161200         MOVE SPACE TO WA-VAR5.                                   16120099
161300     IF WA-VAR1 = ZERO                                            16130099
161400         MOVE WA-VAR2 TO WA-VAR1                                  16140099
161500         MOVE WA-VAR3 TO WA-VAR2                                  16150099
161600         MOVE WA-VAR4 TO WA-VAR3                                  16160099
161700         MOVE WA-VAR5 TO WA-VAR4                                  16170099
161800         MOVE SPACE TO WA-VAR5.                                   16180099
161900     STRING 'X(' DELIMITED BY SIZE                                16190099
162000             WA-VAR DELIMITED BY SPACE                            16200099
162100             ').' DELIMITED BY SIZE                               16210099
162200             INTO DCLGEN-DATA10A-N3.                              16220099
162300     MOVE DCLGEN-DATA10A TO DCLGEN-RECORD.                        16230099
162400     WRITE DCLGEN-RECORD.                                         16240099
162500     MOVE DCLGEN-DATA10A1 TO DCLGEN-RECORD.                       16250099
162600     WRITE DCLGEN-RECORD.                                         16260099
162700                                                                  16270099
162800************************************************************      16280099
162900*  INSERT NEW DCLGEN INTO THE DBT_DCLGEN_XREF TABLE.       *      16290099
163000************************************************************      16300099
163100 5400-INSERT-XREF.                                                16310099
163200                                                                  16320099
163300     INITIALIZE DCLDBT00001.                                      16330099
163400                                                                  16340099
163500     MOVE 'D'               TO DBT00001-DBMS-TYP-CDE.             16350099
163600     MOVE VAR-128-TABLE-NAME TO DBT00001-OBJ-NM-TEXT.             16360099
163700     MOVE LENGTH OF VAR-128-TABLE-NAME TO DBT00001-OBJ-NM-LEN.    16370099
163800     MOVE WS-TEMP-DCLGEN    TO DBT00001-DCLGEN-NM.                16380099
165800                                                                  16580099
167300     EXEC SQL                                                     16730099
167400          INSERT INTO DB2PMVS.DB2PDBA.DBT_DCLGEN_XREF             16740099
167500            (OBJ_NM,                                              16750099
167600             DCLGEN_NM,                                           16760099
167700             DBMS_TYP_CDE)                                        16770099
167800          VALUES                                                  16780099
167900           (:DBT00001-OBJ-NM,                                     16790099
168000            :DBT00001-DCLGEN-NM,                                  16800099
168100            :DBT00001-DBMS-TYP-CDE)                               16810099
168200     END-EXEC.                                                    16820099
168400                                                                  16840099
168500     IF SQLCODE NOT = +0                                          16850099
168600         SET PS-DB2-ERROR TO TRUE                                 16860099
168700         MOVE 'N' TO MEM-CRE                                      16870099
168800         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      16880099
168900         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         16890099
169000         MOVE                                                     16900099
169100         '5400-INSERT-XREF ABEND, CONTACT A DBA'                  16910099
169200             TO VAR-LMSG                                          16920099
169300         MOVE 'CMN000  ' TO ISP-MSG                               16930099
169400     END-IF.                                                      16940099
169500                                                                  16950099
176300                                                                  17630099
176400*                                                                 17640099
176500*  DYNAMIC ALLOCATION ROUTINE                                     17650099
176600*                                                                 17660099
176700     COPY DPPD023.                                                17670099
