000100***************************************************************** 00224792
000200 IDENTIFICATION DIVISION.                                         00224892
000300***************************************************************** 00224992
000400                                                                  00225092
000500 PROGRAM-ID.             SAKRP005.                                00225192
000600 AUTHOR.                 CRAIG VOSKUIL - STRATAGEM.               00225292
000700 INSTALLATION.           KOHLS.                                   00225392
000800 DATE-WRITTEN            MARCH 1999.                              00225492
000900 DATE-COMPILED.                                                   00225592
001000                                                                  00225692
001100***************************************************************** 00225792
001200* * * *>>>   THIS PROGRAM MUST BE COMPILED COBOL/390   <<<* * * * 00225892
001300***************************************************************** 00225992
001400*                                                                 00226092
001500*  THIS PROGRAM WILL CREATE A DAILY CORPORATE SETTLEMENTS REPORT. 00226192
001600*                                                                 00226292
001700*   INPUT: INP01 - CONTAINS POS DATE, WHICH IS USED AS THE        00226392
001800*                  PROCESS DATE TO CREATE THE REPORT.             00226492
001900*  OUTPUT: RPT01 - REPORT SHOWING CORPORATE SETTLEMENTS BY STORE. 00226592
002000*                                                                 00226692
002700*  THE PROGRAM READS A CONTROL CARD FILE TO GET THE POS DATE.     00226792
002800*                                                                 00226892
002900*  THIS DATE IS PASSED TO THE KOHLS CALENDAR ROUTINE.  THE DATE   00226992
003000*  IS VALIDATED AND RETURNED IN DB2 DATE FORMAT.  THE REFORMATTED 00227092
003100*  DATE (PROCESS DATE) IS USED TO SELECT THE ROW FROM DB2 TABLE   00227192
003200*  TEPPART, WHERE SLS_DTE IS EQUAL TO THE PROCESS DATE.           00227292
003300*                                                                 00227392
003400*  THE PARTN_NBR SELECTED IS USED IN A CURSOR TO SELECT           00227492
003500*  UNAUDITED REGISTER TOTALS FROM THE TSASUM TABLE.               00227592
003600*                                                                 00227692
003700*  THE PARTN_NBR IS ALSO USED IN A SELECT OF SALES CORRECTION     00227792
003800*  DATA FROM THE TEPDKEY, TEPTRN AND TEPTND TABLES. COLUMNS       00227892
003900*  ARE ALSO SELECTED FROM THE TEPITM TABLE.                       00227992
004000*                                                                 00228092
004100***************************************************************** 00228192
004200*                                                                 00228292
004300*  CHANGED 07/26/99 BY PAT DOYLE                                  00228392
004400*       CHANGED CALCULATION OF MDSE SALES (UNAUDITED REGISTER     00228492
004500*       TOTALS) TO BE SALES - TAX - GIFT CARD SALES - GIFT        00228592
004600*       CERTIFICATE SALES - RETURNS.  (RETURNS ARE ALREADY        00228692
004700*       NEGATIVE ON THE TABLE, SO THEY ARE ADDED.)                00228792
004800*       THIS IS WHAT IS KNOWN AS 'NET' SALES = STATE TAXABLE      00228892
004900*       MERCHANDISE - RETURNS.                                    00228992
005000*                                                                 00229092
005100*  CHANGED 08/04/99 BY PAT DOYLE                                  00229192
005200*       CORRECTED CALCULATION OF SALES CORRECTION AMOUNTS.        00229292
005300*                                                                 00229392
005400*  CHANGED 11/19/99 BY MATT STIFF                                 00229492
005500*       ADDED TRANSACTION TYPE '24' TO THE SETTLEMENT CURSOR      00229592
005600*                                                                 00229692
005700*  CHANGED 01/22/01 BY GAYLE HAUPT                                00229792
005800*       ADDED THE TEPSVC TABLE IN ORDER TO IDENTIFY KMRC          00229892
005900*       ISSUES VS. TENDERS.  THIS WILL ALLOW KMRC CORRECTIONS     00229992
006000*       TO BE PROPERLY ENTERED INTO THE AUDITED SALES             00230092
006100*       CORRECTIONS; PREVIOUSLY, ANY NEGATIVE AMOUNTS             00230192
006200*       AUTOMATICALLY WENT INTO KMRC ISSUED; POSITIVE AMOUNTS     00230292
006300*       INTO KMRC TENDERED.                                       00230392
006400*                                                                 00230492
006500*  CHANGED 07/27/01 BY JENNIFER ENDRIES                           00230592
006600*       CHANGED REFERENCES OF ARKUP014-3 REPORT TO TCKRP014-3     00230692
006700*       REPORT.  DUE TO E-COMMERCE, THREE ADDITIONAL REPORTS      00230792
006800*       NEEDED TO BE REFERENCED.  TCKUP001-3 WAS ADDED FOR        00230892
006900*       BANKCARD, TCKUP000-3 WAS ADDED FOR DISCOVER AND           00230992
007000*       TCKUP002-3 WAS ADDED FOR AMEX.                            00231092
007100*                                                                 00231192
007200*  CHANGED 09/12/05 BY CAROLE MCCAMMON                            00231292
007300*       ADDED KOHL'S DEBIT TOTALS TO SETTLEMENT VERIFICATION      00231392
007400*       REPORT.                                                   00231492
007500***************************************************************** 00231592
007600*  CHANGED BY: JIM HUNTER              DATE: 10/17/2006           00231692
007700*                                      WR/IR PM00888251           00231792
007800*                                                                 00231892
007900*  ADDED A CURSOR TO PICK UP REGISTER ZERO TRANSACTION TOTALS,    00231992
008000*  WHICH ARE NOT INCLUDED IN THE TSASUM SUMMARY CURSOR.           00232092
008100*  FIND JH1017 TO SEE CHANGES.                                    00232192
008200***************************************************************** 00232292
008300*  CHANGED BY: STEVEN NOWAK            DATE: 09/25/2007           00232392
008400*                                      WR/IR PM00053316           00232492
008500*                                                                 00232592
008600*  REMOVE CODE RELATED TO KOHLS DEBIT SINCE NO LONGER EXITS       00232692
002200*                                                                 00232792
008700***************************************************************** 00232892
N2I201*  CHANGED 04/15/08 BY LYNN MCADAMS                               00232992
N2I201*  BLACK HAWK CHANGES (THIRD PARTY GIFT CARD) FOR NEXT GEN 2      00233092
P8612 ***************************************************************** 00233192
P8612 *  CHANGED 10/01/14 BY COGNIZANT            CHG0092405            00233292
P8612 *  ADDED WAYFAIR COMMISSION AND WAYFAID RETURN COMMISION RECORDS  00233392
P8612 *  TO THE REPORT.                                                 00233492
      ***************************************************************** 00233592
TPCDSC*  CHANGED 04/18/20 BY BARB SCHULTZ         CHG0242874            00233692
TPCDSC*  ADDED AND STR_GP_CDE   = 'A' TO TEPPART SQL.                   00233792
      ***************************************************************** 00233892
SEPHOR*  CHANGED 04/20/21 BY BARB SCHULTZ         CHG0255409            00233999
SEPHOR*  REMOVED WAYFAIR COMMISSION AND WAYFAIR RETURN COMMISSION CODE. 00234092
SEPHOR*  DELETED THE REG-ZERO CURSOR AND ALL OF THE PARAGRAPHS THAT     00234199
SEPHOR*  GO WITH THAT CURSOR.  ADDED SEPHORA CHARGE SALES, SEPHORA      00234299
SEPHOR*  CHARGE RETURNS, SEPHORA GIFT CARD TENDERS, AND SEPHORA GIFT    00234399
SEPHOR*  CARD SOLD TO THE REPORT.  ADDED THE LATE-CURSOR TO PICK UP     00234499
SEPHOR*  LATE VOID AFTERS TRANSACTIONS AND SUBTRACT THEM FROM THE       00234599
SEPHOR*  UNALLOCATED COLUMN.                                            00234699
SEPHOR***************************************************************** 00234799
SEPH02*  CHANGED 04/20/22 BY BARB SCHULTZ         CHG0269192            00234899
SEPH02*  CHANGED THE SEPHORA GIFT CARD DEPT FROM '070' TO '712'.        00234999
SEPH02*  ADDED TNDR_ID_SRC_CDE TO KNOW IF THE GIFT CARD IS SEPHORA.     00235099
SEPH02*  COMMENTED OUT ALL SEPHORA CHARGE CARD SALES AND RETURNS SINCE  00235199
SEPH02*  THIS IS NOT IN SCOPE RIGHT NOW AND REMOVED IT FROM THE REPORT. 00235299
SEPH02*  THIS BROUGHT OUR OCCURANCES OF DATA ON THE REPORT TO 14 INSTEAD00235399
SEPH02*  OF 15.                                                         00235499
SEPH02***************************************************************** 00235699
SEPH03*  CHANGED 08/31/22 BY BARB SCHULTZ         CHG0273953            00235899
SEPH03*  COMMENTED OUT THE SUBTRACTION OF SEPHORA GIFT CARD TOTALS      00235999
SEPH03*  BECAUSE THEY ARE ALREADY SUBTRACTED UNDER GDS.                 00236099
SEPH04***************************************************************** 00236299
SEPH04*  CHANGED 12/06/22 BY BARB SCHULTZ         CHG0278871            00236399
SEPH04*  SUBTRACTED SGS FROM TPC AFTER SGS HAS BEEN ADDED.              00236499
SEPH04*  SUBTRACTED SGT FROM GDT AFTER SGT HAS BEEN ADDED.              00236599
SEPHO4*  REMOVED WFS AND WRC FROM SUMMARY-CURSOR.                       00236699
COBRND***************************************************************** 00236799
COBRND*  CHANGED 03/02/23 BY BARB SCHULTZ         CHG0285913            00236899
COBRND*  ADDED THE NEW COBRAND TENDER VALUE - CVN AND KCP TO THE CURSOR.00236999
COBRND*  ALSO ADDED THE COBRAND VISA AND COBRAND PAYMENT TO THE REPORT. 00237099
COBRND*  SUBTRACTED COBRAND VISA FROM BCN AND SUBTRACTED COBRAND PAYMENT00237199
COBRND*  FROM KCP. SELECTED THE COBRAND-IND FROM TEPPAY TO KNOW IF      00237299
COBRND*  THE PAYMENT SHOULD BE SUBTRACTED FROM KCP.                     00237399
PAYVEN***************************************************************** 00237499
PAYVEN*  CHANGED 04/24/23 BY BARB SCHULTZ         CHG0287669            00237599
PAYVEN*  ADDED THE NEW PAYPAL TENDER VALUE - PPS AND PPR TO THE CURSOR. 00237699
PAYVEN*  ADDED THE NEW VENMO TENDER VALUE - VMS AND VMR TO THE CURSOR.  00237799
PAYVEN*  ALSO ADDED PAYPAL AND VENMO TO THE REPORT.                     00237899
COBTRL***************************************************************** 00237999
COBTRL*  CHANGED 10/23/23 BY JIM HUNTER           CHG0296519            00238099
COBTRL*  ADDING LOGIC TO ADJUST CATEGORIES FOR COBRAND TRAILING         00238299
COBTRL*  TRANSACTIONS.  THESE TRANSACTIONS ARE THOSE MADE AGAINST       00238399
COBTRL*  KOHL'S CHARGE ACCOUNTS FOR CUSTOMERS WHO NOW HAVE COBRAND      00238499
COBTRL*  ACCOUNTS INSTEAD.                                              00238599
COBTRL*  THEY WILL COME FROM THE TSASUM TABLE, REGISTER ZERO, CATEGORIES00238699
COBTRL*  TTN (COBRAND TRAILING NET) AND TTP (COBRAND TRAILING PAYMENTS).00238799
COBTRL*  TTN WILL BE SUBTRACTED FROM KCN BEFORE KCN IS REPORTED ON.     00238899
COBTRL*  TTN WILL BE ADDED TO CVN BEFORE CVN IS REPORTED ON.            00238999
COBTRL*  TTP WILL BE SUBTRACTED FROM KCP BEFORE KCP IS REPORTED ON.     00239099
COBTRL*  TTP WILL BE ADDED TO CVP BEFORE CVP IS REPORTED ON.            00239199
008800***************************************************************** 00239299
008900 ENVIRONMENT DIVISION.                                            00239399
009000***************************************************************** 00239499
009100                                                                  00239599
009200 CONFIGURATION SECTION.                                           00239699
009300                                                                  00239799
009400 SOURCE-COMPUTER.        IBM-3090.                                00239899
009500                                                                  00239999
009600 OBJECT-COMPUTER.        IBM-3090.                                00240099
009700                                                                  00240199
009800 INPUT-OUTPUT SECTION.                                            00240299
009900                                                                  00240399
010000 FILE-CONTROL.                                                    00240499
010100                                                                  00240599
010200     SELECT POS-DATE-CARD-FILE                                    00240699
010300         ASSIGN TO INP01.                                         00240799
010400                                                                  00240899
010500     SELECT SETTLEMENT-REPORT-FILE                                00240999
010600         ASSIGN TO RPT01.                                         00241099
010700                                                                  00241199
010800                                                                  00241299
010900******************************************************************00241399
011000 DATA DIVISION.                                                   00241499
011100******************************************************************00241599
011200                                                                  00241699
011300 FILE SECTION.                                                    00241799
011400                                                                  00241899
011500 FD  POS-DATE-CARD-FILE                                           00241999
011600     RECORDING MODE IS F                                          00242099
011700     BLOCK CONTAINS 0 RECORDS                                     00242199
011800     LABEL RECORDS ARE STANDARD.                                  00242299
011900                                                                  00242399
012000 01  POS-DATE-CARD-RECORD            PIC X(80).                   00242499
012100                                                                  00242599
012200 FD  SETTLEMENT-REPORT-FILE                                       00242699
012300     RECORDING MODE IS F                                          00242799
012400     BLOCK CONTAINS 0  RECORDS.                                   00242899
012500                                                                  00242999
012600 01  SETTLEMENT-REPORT-RECORD        PIC  X(132).                 00243099
012700                                                                  00243199
012800                                                                  00243299
012900******************************************************************00243399
013000 WORKING-STORAGE SECTION.                                         00243499
013100******************************************************************00243599
013200 01  FILLER                            PIC X(50)  VALUE           00243699
013300     ' *** WORKING STORAGE STARTS HERE FOR SAKRP005 *** '.        00243799
013400                                                                  00243899
013500******************************************************************00243999
013600* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    00244099
013700******************************************************************00244199
013800 01  CC-CONTROL-CARD.                                             00244299
013900     05  CC-CONTROL-CARD-DISPLAY.                                 00244399
014000         10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00244499
014100             88  CC-VALID-CONTROL-NAME        VALUE               00244599
014200                 'P.O.S. DATE = '.                                00244699
014300         10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00244799
014400         10  FILLER              PIC X(1)     VALUE SPACE.        00244899
014500         10  CC-RE-RING-IND      PIC X(1)     VALUE SPACE.        00244999
014600             88  CC-ALLOW-RE-RINGS            VALUE 'Y'.          00245099
014700             88  CC-DO-NOT-ALLOW-RE-RINGS     VALUE ' ',          00245199
014800                                                    LOW-VALUES.   00245299
014900     05  FILLER                  PIC X(58)    VALUE SPACE.        00245399
015000******************************************************************00245499
015100*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             00245599
015200******************************************************************00245699
015300     COPY DPWS500.                                                00245799
015400                                                                  00245899
015500 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00245999
015600                                                  COMP SYNC.      00246099
015700     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00246199
015800     88  AC-DB2-ERROR                             VALUE +4013.    00246299
015900     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00246399
016000                                                                  00246499
016100                                                                  00246599
016200                                                                  00246699
016300 01  PS-PROGRAM-SWITCHES.                                         00246799
016400     05  PS-END-OF-SUM-CURSOR-SW       PIC X(01)  VALUE 'N'.      00246899
016500         88  PS-END-OF-SUM-CURSOR                 VALUE 'Y'.      00246999
016800     05  PS-END-OF-STTL-CURSOR-SW      PIC X(01)  VALUE 'N'.      00247099
016900         88  PS-END-OF-STTL-CURSOR                VALUE 'Y'.      00247199
017000     05  PS-END-OF-ITEM-CURSOR-SW      PIC X(01)  VALUE 'N'.      00247299
017100         88  PS-END-OF-ITEM-CURSOR                VALUE 'Y'.      00247399
017200     05  PS-END-OF-TENDER-CURSOR-SW    PIC X(01)  VALUE 'N'.      00247499
017300         88  PS-END-OF-TENDER-CURSOR              VALUE 'Y'.      00247599
017400     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      00247699
017500         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      00247799
SEPHOR     05  PS-END-OF-LATE-CURSOR-SW      PIC X(01)  VALUE 'N'.      00247899
SEPHOR         88  PS-END-OF-LATE-CURSOR                VALUE 'Y'.      00247999
017600                                                                  00248099
017700     05  PS-NULL-IND1                  PIC S9(4)  VALUE ZERO COMP.00248199
017800                                                                  00248299
017900 01  PC-CONSTANTS.                                                00248399
SEPHOR     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +65.     00248499
018100     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00248599
018200                                                   COMP SYNC.     00248699
018300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00248799
018400                                                   'SAKRP005'.    00248899
018500     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       00248999
018600                                                                  00249099
018700     05  PC-BANKCARD-STTL-FILE1      PIC  X(10)    VALUE          00249199
018800                                                   'TCKRP006-2'.  00249299
N2I201     05  PC-DISCOVER-STTL-FILE1      PIC  X(10)    VALUE          00249399
N2I201                                                   'TCKRP006-6'.  00249499
019100     05  PC-AMEX-STTL-FILE1          PIC  X(10)    VALUE          00249599
019200                                                   'TCKRP006-4'.  00249699
019300                                                                  00249799
019400 01  PC-SETTLEMENT-LITERALS.                                      00249899
P8612      05  FILLER                      PIC X(19)     VALUE          00249999
P8612                                          'BANKCARD           '.   00250099
019700     05  FILLER                      PIC X(10)     VALUE          00250199
019800                                         'TCKRP006-2'.            00250299
019900     05  FILLER                      PIC X(12)     VALUE          00250399
020000                                         '            '.          00250499
P8612      05  FILLER                      PIC X(19)     VALUE          00250599
P8612                                          'AMERICAN EXPRESS   '.   00250699
020300     05  FILLER                      PIC X(10)     VALUE          00250799
020400                                         'TCKRP006-4'.            00250899
020500     05  FILLER                      PIC X(12)     VALUE          00250999
020600                                         '            '.          00251099
P8612      05  FILLER                      PIC X(19)     VALUE          00251199
P8612                                          'DISCOVER           '.   00251299
020900     05  FILLER                      PIC X(10)     VALUE          00251399
021000                                         'TCKRP006-6'.            00251499
021100     05  FILLER                      PIC X(12)     VALUE          00251599
021200                                         '            '.          00251699
P8612      05  FILLER                      PIC X(19)     VALUE          00251799
P8612                                          'DEBIT              '.   00251899
021500     05  FILLER                      PIC X(10)     VALUE          00251999
021600                                         'TCKRP002-1'.            00252099
021700     05  FILLER                      PIC X(12)     VALUE          00252199
021800                                         '            '.          00252299
COBRND     05  FILLER                      PIC X(19)     VALUE          00252399
COBRND                                         'COBRAND VISA       '.   00252499
COBRND     05  FILLER                      PIC X(10)     VALUE          00252599
COBRND                                         '          '.            00252699
COBRND     05  FILLER                      PIC X(12)     VALUE          00252799
COBRND                                         '            '.          00252899
PAYVEN     05  FILLER                      PIC X(19)     VALUE          00252999
PAYVEN                                         'PAYPAL             '.   00253099
PAYVEN     05  FILLER                      PIC X(10)     VALUE          00253199
PAYVEN                                         '          '.            00253299
PAYVEN     05  FILLER                      PIC X(12)     VALUE          00253399
PAYVEN                                         '            '.          00253499
PAYVEN     05  FILLER                      PIC X(19)     VALUE          00253599
PAYVEN                                         'VENMO              '.   00253699
PAYVEN     05  FILLER                      PIC X(10)     VALUE          00253799
PAYVEN                                         '          '.            00253899
PAYVEN     05  FILLER                      PIC X(12)     VALUE          00253999
PAYVEN                                         '            '.          00254099
N2I201     05  FILLER                      PIC X(06)     VALUE 'THIRD '.00254199
N2I201     05  FILLER                      PIC X(06)     VALUE 'PARTY '.00254299
N2I201     05  FILLER                      PIC X(06)     VALUE 'CARDS '.00254399
P8612      05  FILLER                      PIC X(01)     VALUE ' '.     00254499
N2I201     05  FILLER                      PIC X(10)     VALUE          00254599
N2I201                                         'AUKRP001-1'.            00254699
022400     05  FILLER                      PIC X(12)     VALUE          00254799
022500                                         '            '.          00254899
022600     05  FILLER                      PIC X(04)     VALUE 'KOHL'.  00254999
022700     05  FILLER                      PIC X(01)     VALUE QUOTE.   00255099
022800     05  FILLER                      PIC X(02)     VALUE 'S '.    00255199
022900     05  FILLER                      PIC X(06)     VALUE 'CHARGE'.00255299
P8612      05  FILLER                      PIC X(06)     VALUE SPACES.  00255399
023100     05  FILLER                      PIC X(10)     VALUE          00255499
023200                                         'ARKUT059-3'.            00255599
023300     05  FILLER                      PIC X(12)     VALUE          00255699
023400                                         '            '.          00255799
023500     05  FILLER                      PIC X(04)     VALUE 'KOHL'.  00255899
023600     05  FILLER                      PIC X(01)     VALUE QUOTE.   00255999
023700     05  FILLER                      PIC X(02)     VALUE 'S '.    00256099
023800     05  FILLER                      PIC X(08)     VALUE          00256199
023900                                         'PAYMENTS'.              00256299
P8612      05  FILLER                      PIC X(04)     VALUE SPACES.  00256399
024100     05  FILLER                      PIC X(10)     VALUE          00256499
024200                                         'ARKUT059-3'.            00256599
024300     05  FILLER                      PIC X(12)     VALUE          00256699
024400                                         '            '.          00256799
P8612      05  FILLER                      PIC X(19)     VALUE          00256899
P8612                                          'GIFT CARD SOLD     '.   00256999
N2I201     05  FILLER                      PIC X(10)     VALUE          00257099
N2I201                                         'SVKRP004-2'.            00257199
024900     05  FILLER                      PIC X(12)     VALUE          00257299
025000                                         '            '.          00257399
P8612      05  FILLER                      PIC X(19)     VALUE          00257499
P8612                                          'GIFT CARD TENDERED '.   00257599
N2I201     05  FILLER                      PIC X(10)     VALUE          00257699
N2I201                                         'SVKRP004-2'.            00257799
025500     05  FILLER                      PIC X(12)     VALUE          00257899
025600                                         '            '.          00257999
P8612      05  FILLER                      PIC X(19)     VALUE          00258099
P8612                                          'KMRC ISSUED        '.   00258199
N2I201     05  FILLER                      PIC X(10)     VALUE          00258299
N2I201                                         'SVKRP004-1'.            00258399
026100     05  FILLER                      PIC X(12)     VALUE          00258499
026200                                         '            '.          00258599
P8612      05  FILLER                      PIC X(19)     VALUE          00258699
P8612                                          'KMRC TENDERED      '.   00258799
N2I201     05  FILLER                      PIC X(10)     VALUE          00258899
N2I201                                         'SVKRP004-1'.            00258999
026700     05  FILLER                      PIC X(12)     VALUE          00259099
026800                                         '            '.          00259199
P8612      05  FILLER                      PIC X(19)     VALUE          00259299
P8612                                          'MDSE SALES         '.   00259399
N2I201     05  FILLER                      PIC X(10)     VALUE          00259499
N2I201                                         'FLASH     '.            00259599
027300     05  FILLER                      PIC X(12)     VALUE          00259699
027400                                         '            '.          00259799
SEPHOR     05  FILLER                      PIC X(19)     VALUE          00259899
SEPH02                                         'SEPHORA GF SOLD    '.   00259999
SEPHOR     05  FILLER                      PIC X(10)     VALUE          00260099
SEPHOR                                         '          '.            00260199
SEPHOR     05  FILLER                      PIC X(12)     VALUE          00260299
SEPHOR                                         '            '.          00260399
SEPHOR     05  FILLER                      PIC X(19)     VALUE          00260499
SEPH02                                         'SEPHORA GF TENDERED'.   00260599
SEPHOR     05  FILLER                      PIC X(10)     VALUE          00260699
SEPHOR                                         '          '.            00260799
SEPHOR     05  FILLER                      PIC X(12)     VALUE          00260899
SEPHOR                                         '            '.          00260999
COBRND     05  FILLER                      PIC X(19)     VALUE          00261099
COBRND                                         'COBRAND VISA PAYMNT'.   00261199
COBRND     05  FILLER                      PIC X(10)     VALUE          00261299
COBRND                                         '          '.            00261399
COBRND     05  FILLER                      PIC X(12)     VALUE          00261499
COBRND                                         '            '.          00261599
027500 01  FILLER REDEFINES PC-SETTLEMENT-LITERALS.                     00261699
PAYVEN     05  FILLER                      OCCURS 18 TIMES.             00261799
P8612          10  PC-STTL-TYPE            PIC X(19).                   00261899
027800         10  PC-STTL-FILE            PIC X(10).                   00261999
027900         10  PC-VERIF-FILE           PIC X(12).                   00262099
028000                                                                  00262199
028100 01  PV-MISC-COUNT-FIELDS            COMP-3.                      00262299
028200     05  PV-PAGE-CNT                 PIC S9(05)      VALUE ZERO.  00262399
028300     05  PV-LINE-CNT                 PIC S9(03)      VALUE ZERO.  00262499
028400     05  PV-LINE-CNT-AHEAD           PIC S9(03)      VALUE ZERO.  00262599
028500     05  PV-SUM-CURSOR-CNT           PIC S9(07)      VALUE ZERO.  00262699
028700     05  PV-STTL-CURSOR-CNT          PIC S9(07)      VALUE ZERO.  00262799
028700     05  PV-LATE-CURSOR-CNT          PIC S9(07)      VALUE ZERO.  00262899
COBTRL     05  PV-TTN-DOLLARS              PIC S9(06)V99   VALUE ZERO.  00262999
COBTRL     05  PV-TTP-DOLLARS              PIC S9(06)V99   VALUE ZERO.  00263099
028800******************************************************************00263399
028900*  FIELDS TO HOLD TOTALS FOR PRINTING A REPORT TOTAL LINE.        00263499
029000******************************************************************00263599
029100 01  PV-SETTLEMENT-TABLE             COMP-3.                      00263699
PAYVEN     05  FILLER                      OCCURS 18 TIMES.             00263799
029300         10  PV-STTL-UNAUD-REG-TOT   PIC S9(09)V99.               00263899
029400         10  PV-STTL-AUD-SALES-CORR  PIC S9(09)V99.               00263999
029500         10  PV-PRO-STTL-FROM-POS    PIC S9(09)V99.               00264099
029600                                                                  00264199
029700 01  PV-MISC-FIELDS.                                              00264299
029800     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   00264399
029900     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     00264499
030000                                                   COMP SYNC.     00264599
030100     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   00264699
030200     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   00264799
030300     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   00264899
030400     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   00264999
030500     05  PV-DISPLAY-PARTN-NBR        PIC  9999     VALUE ZERO.    00265099
030600     05  PV-EDIT-MASK                PIC  Z,ZZZ,ZZ9.              00265199
SEPHOR     05  PV-SEPHORA-GC               PIC  S9(7)V9(2) VALUE ZERO.  00265299
030700     05  PV-GIFT-CARD                PIC  S9(7)V9(2) VALUE ZERO.  00265399
030800     05  PV-GIFT-CERT                PIC  S9(7)V9(2) VALUE ZERO.  00265499
030900     05  PV-MDSE-SALE                PIC  S9(7)V9(2) VALUE ZERO.  00265599
N2I201     05  PV-THIRD-PARTY-CARD-SALES   PIC  S9(7)V9(2) VALUE ZERO.  00265699
SEPHOR     05  PV-TNDR-AMT                 PIC  S9(7)V9(2) COMP-3.      00265799
031100     05  PV-KOHLS-DEBIT-TRANS        PIC  S9(9)V9(2) COMP-3.      00265899
SEPHOR     05  PV-TNDR-AMT-D               PIC  S9(7)V9(2) VALUE ZERO.  00265999
SEPHOR     05  PV-PARTN-NBR-D              PIC   9(4)      VALUE ZERO.  00266099
SEPHOR     05  PV-STR-NBR-D                PIC   9(4)      VALUE ZERO.  00266199
SEPHOR     05  PV-RGST-ID-D                PIC   9(4)      VALUE ZERO.  00266299
SEPHOR     05  PV-TRN-NBR-D                PIC   9(4)      VALUE ZERO.  00266399
SEPHOR     05  PV-TRN-AMT-D                PIC  S9(7)V9(2) VALUE ZERO.  00266499
SEPHOR     05  PV-TNDR-SEQ-NBR-D           PIC   9(4)      VALUE ZERO.  00266599
SEPHOR     05  PV-TNDR-TYP-CDE-D           PIC   X(02)     VALUE SPACES.00266699
031200                                                                  00266799
031300 01  PV-SUBSCRIPTS                   COMP.                        00266899
031400     05  PV-STTL-SUB                 PIC S9(4)     VALUE ZERO.    00266999
031500                                                                  00267099
031600 01  PV-DATE-AND-TIME-FIELDS.                                     00267199
031700     05  PV-POS-CCYY-MM-DD           PIC X(10)     VALUE SPACE.   00267299
031800     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      00267399
031900         10  PV-POS-CCYY             PIC X(04).                   00267499
032000         10  FILLER                  PIC X(01).                   00267599
032100         10  PV-POS-MM               PIC X(02).                   00267699
032200         10  FILLER                  PIC X(01).                   00267799
032300         10  PV-POS-DD               PIC X(02).                   00267899
032400     05  PV-CURR-DATE-CCYYMMDD.                                   00267999
032500         10  PV-CURR-DATE-CCYY       PIC  9(04).                  00268099
032600         10  PV-CURR-DATE-MM         PIC  9(02).                  00268199
032700         10  PV-CURR-DATE-DD         PIC  9(02).                  00268299
032800     05  PV-CURR-TIME.                                            00268399
032900         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    00268499
033000         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    00268599
033100         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    00268699
033200                                                                  00268799
033300******************************************************************00268899
033400*  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT.  00268999
033500******************************************************************00269099
033600     COPY DPWS132.                                                00269199
033700                                                                  00269299
033800******************************************************************00269399
033900*  HEADING LINES FOR THE CORPORATE SETTLEMENTS REPORT.            00269499
034000******************************************************************00269599
034100 01  H2-HEADING-LINE-2.                                           00269699
034200     05  FILLER                      PIC  X(35)    VALUE SPACE.   00269799
034300     05  FILLER                      PIC  X(11)    VALUE          00269899
034400                                          'SETTLEMENT '.          00269999
034500     05  FILLER                      PIC  X(13)    VALUE          00270099
034600                                          'VERIFICATION '.        00270199
034700     05  FILLER                      PIC  X(07)    VALUE          00270299
034800                                          'REPORT '.              00270399
034900     05  FILLER                      PIC  X(04)    VALUE 'FOR '.  00270499
035000     05  FILLER                      PIC  X(11)    VALUE          00270599
035100                                          'PROCESSING '.          00270699
035200     05  FILLER                      PIC  X(06)    VALUE          00270799
035300                                          'DATE: '.               00270899
035400     05  H2-DATE.                                                 00270999
035500         10  H2-MM                   PIC  X(02)    VALUE SPACE.   00271099
035600         10  FILLER                  PIC  X(01)    VALUE '/'.     00271199
035700         10  H2-DD                   PIC  X(02)    VALUE SPACE.   00271299
035800         10  FILLER                  PIC  X(01)    VALUE '/'.     00271399
035900         10  H2-CCYY                 PIC  X(04)    VALUE SPACE.   00271499
036000     05  FILLER                      PIC  X(35)    VALUE SPACE.   00271599
036100                                                                  00271699
036200 01  H3-HEADING-LINE-3.                                           00271799
036300     05  FILLER                      PIC  X(62)    VALUE SPACE.   00271899
036400     05  FILLER                      PIC  X(08)    VALUE          00271999
036500                                          'PROPOSED'.             00272099
036600     05  FILLER                      PIC  X(62)    VALUE SPACES.  00272199
036700                                                                  00272299
036800 01  H4-HEADING-LINE-4.                                           00272399
036900     05  FILLER                      PIC  X(26)    VALUE SPACE.   00272499
037000     05  FILLER                      PIC  X(10)    VALUE          00272599
037100                                          'UNAUDITED '.           00272699
037200     05  FILLER                      PIC  X(03)    VALUE SPACES.  00272799
037300     05  FILLER                      PIC  X(08)    VALUE          00272899
037400                                          'AUDITED '.             00272999
037500     05  FILLER                      PIC  X(05)    VALUE 'SALES'. 00273099
037600     05  FILLER                      PIC  X(08)    VALUE SPACES.  00273199
037700     05  FILLER                      PIC  X(10)    VALUE          00273299
037800                                          'SETTLEMENT'.           00273399
037900     05  FILLER                      PIC  X(62)    VALUE SPACES.  00273499
038000                                                                  00273599
038100 01  H5-HEADING-LINE-5.                                           00273699
038200     05  FILLER                      PIC  X(20)    VALUE SPACES.  00273799
038300     05  FILLER                      PIC  X(09)    VALUE          00273899
038400                                          'REGISTER '.            00273999
038500     05  FILLER                      PIC  X(06)    VALUE 'TOTALS'.00274099
038600     05  FILLER                      PIC  X(06)    VALUE SPACES.  00274199
038700     05  FILLER                      PIC  X(11)    VALUE          00274299
038800                                          'CORRECTIONS'.          00274399
038900     05  FILLER                      PIC  X(10)    VALUE SPACES.  00274499
039000     05  FILLER                      PIC  X(05)    VALUE 'FROM '. 00274599
039100     05  FILLER                      PIC  X(03)    VALUE 'POS'.   00274699
039200     05  FILLER                      PIC  X(09)    VALUE SPACES.  00274799
039300     05  FILLER                      PIC  X(11)    VALUE          00274899
039400                                          'SETTLEMENT '.          00274999
039500     05  FILLER                      PIC  X(04)    VALUE 'FILE'.  00275099
039600     05  FILLER                      PIC  X(38)    VALUE SPACES.  00275199
039700                                                                  00275299
039800 01  H6-HEADING-LINE-6.                                           00275399
039900     05  FILLER                      PIC  X(74)    VALUE SPACES.  00275499
040000     05  FILLER                      PIC  X(28)    VALUE ALL '_'. 00275599
040100     05  FILLER                      PIC  X(30)    VALUE SPACE.   00275699
040200                                                                  00275799
COBTRL 01  T1-TRAILER-NOTE-LINE-1.                                      00275899
COBTRL     05  FILLER                      PIC  X(47)    VALUE          00275999
COBTRL        'COBRAND VISA, KOHLS CHARGE, KOHLS PAYMENTS AND '.        00276099
COBTRL     05  FILLER                      PIC  X(54)    VALUE          00276199
COBTRL        'COBRAND VISA PAYMNT ARE ADJUSTED FOR COBRAND TRAILING '. 00276299
COBTRL     05  FILLER                      PIC  X(31)    VALUE          00276399
COBTRL        'TRANSACTIONS '.                                          00276499
COBTRL                                                                  00276599
COBTRL 01  T2-TRAILER-NOTE-LINE-2.                                      00276699
COBTRL     05  FILLER                      PIC X(40)       VALUE        00276799
COBTRL        'UNDER THE UNAUDITED REGISTER TOTALS.'.                   00276899
COBTRL     05  FILLER                      PIC X(11)       VALUE        00277199
COBTRL        '     TTN = '.                                            00277299
COBTRL     05  T2-DISPLAY-TTN              PIC ZZZ,ZZZ.99- VALUE ZERO.  00277399
COBTRL     05  FILLER                      PIC X(11)       VALUE        00277999
COBTRL        '     TTP = '.                                            00278099
COBTRL     05  T2-DISPLAY-TTP              PIC ZZZ,ZZZ.99- VALUE ZERO.  00278199
COBTRL     05  FILLER                      PIC X(48)       VALUE SPACE. 00278299
COBTRL                                                                  00278399
040300******************************************************************00278499
040400*  DETAIL LINE PRINTED FIRST ON THE CORPORATE SETTLEMENTS REPORT. 00278599
040500******************************************************************00278699
040600 01  D1-DETAIL-LINE-1.                                            00278799
040700     05  D1-SYSTEM-TYPE              PIC  X(9)     VALUE SPACES.  00278899
040800     05  FILLER                      PIC  X(07)    VALUE          00278999
040900                                          'SYSTEMS'.              00279099
041000     05  FILLER                      PIC  X(116)   VALUE SPACES.  00279199
041100                                                                  00279299
041200 01  D2-DETAIL-LINE-2.                                            00279399
P8612      05  D2-STTL-TYPE                PIC  X(19)    VALUE SPACE.   00279499
P8612      05  FILLER                      PIC  X(02)    VALUE SPACE.   00279599
041500     05  D2-UNAUD-REG-TOTALS         PIC  ZZZ,ZZZ,ZZZ.99-         00279699
041600                                          VALUE ZERO.             00279799
041700     05  FILLER                      PIC  X(03)    VALUE SPACE.   00279899
041800     05  D2-AUD-SALES-CORR           PIC  ZZ,ZZZ,ZZZ.99-          00279999
041900                                          VALUE ZERO.             00280099
042000     05  FILLER                      PIC  X(03)    VALUE SPACE.   00280199
042100     05  D2-PRO-STTL-FROM-POS        PIC  ZZZ,ZZZ,ZZZ.99-         00280299
042200                                          VALUE ZERO.             00280399
042300     05  FILLER                      PIC  X(03)    VALUE SPACE.   00280499
042400     05  D2-STTL-JOB                 PIC  X(10)    VALUE SPACE.   00280599
042500     05  FILLER                      PIC  X(03)    VALUE SPACE.   00280699
042600     05  FILLER                      PIC  X(15)    VALUE ALL '_'. 00280799
042700     05  FILLER                      PIC  X(01)    VALUE SPACE.   00280899
042800                                                                  00280999
042900 01  D3-DETAIL-LINE-3.                                            00281099
043000     05  FILLER                      PIC X(132)    VALUE SPACES.  00281199
043100******************************************************************00281299
043200*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            00281399
043300******************************************************************00281499
043400     COPY DPWS004.                                                00281599
043500                                                                  00281699
043600******************************************************************00281799
043700*  DB2 COMMUNICATION AREA.                                        00281899
043800******************************************************************00281999
043900     EXEC SQL                                                     00282099
044000          INCLUDE SQLCA                                           00282199
044100     END-EXEC.                                                    00282299
044200                                                                  00282399
044300******************************************************************00282499
044400*  DB2 TABLE DB2PDBA.EPT_DR_CRD_TNDR CREDIT CARD TENDER TABLE     00282599
044500******************************************************************00282699
044600     EXEC SQL                                                     00282799
044700          INCLUDE EPT00002                                        00282899
044800     END-EXEC.                                                    00282999
044900                                                                  00283099
045000******************************************************************00283199
045100* CARD TABLE                                                      00283299
045200******************************************************************00283399
045300     EXEC SQL                                                     00283499
045400          INCLUDE TEPCRD                                          00283599
045500     END-EXEC.                                                    00283699
045600                                                                  00283799
045700******************************************************************00283899
045800*  DB2 TABLE DB2PDBA.TSASUM - SUMMARY TOTALS TABLE                00283999
045900******************************************************************00284099
046000     EXEC SQL                                                     00284199
046100          INCLUDE TSASUM                                          00284299
046200     END-EXEC.                                                    00284399
046300                                                                  00284499
046400******************************************************************00284599
046500*  DB2 TABLE DB2PDBA.TEPPART - COSA-PARTITIONING TABLE            00284699
046600******************************************************************00284799
046700     EXEC SQL                                                     00284899
046800          INCLUDE TEPPART                                         00284999
046900     END-EXEC.                                                    00285099
047000                                                                  00285199
047100******************************************************************00285299
047200*  DB2 TABLE DB2PDBA.TEPDKEY - COSA-PROCESSING DAY KEY TABLE      00285399
047300******************************************************************00285499
047400     EXEC SQL                                                     00285599
047500          INCLUDE TEPDKEY                                         00285699
047600     END-EXEC.                                                    00285799
047700                                                                  00285899
047800******************************************************************00285999
047900*  DB2 TABLE DB2PDBA.TEPTRN - COSA-TRANSACTION TABLE              00286099
048000******************************************************************00286199
048100     EXEC SQL                                                     00286299
048200          INCLUDE TEPTRN                                          00286399
048300     END-EXEC.                                                    00286499
048400                                                                  00286599
048500******************************************************************00286699
048600*  DB2 TABLE DB2PDBA.TEPTND - COSA-TENDER TABLE                   00286799
048700******************************************************************00286899
048800     EXEC SQL                                                     00286999
048900          INCLUDE TEPTND                                          00287099
049000     END-EXEC.                                                    00287199
049100                                                                  00287299
049200******************************************************************00287399
049300*  DB2 TABLE DB2PDBA.TEPITM - COSA-ITEM TABLE                     00287499
049400******************************************************************00287599
049500     EXEC SQL                                                     00287699
049600          INCLUDE TEPITM                                          00287799
049700     END-EXEC.                                                    00287899
049800                                                                  00287999
049900******************************************************************00288099
050000*  DB2 TABLE DB2PDBA.TEPSVC - COSA STORED VALUE CARD TABLE        00288199
050100******************************************************************00288299
050200     EXEC SQL                                                     00288399
050300          INCLUDE TEPSVC                                          00288499
050400     END-EXEC.                                                    00288599
050500                                                                  00288699
050500******************************************************************00288799
050500*  DB2 TABLE DB2PDBA.TEPVDA - COSA-VOIDED TRANSACTIONS            00288899
050500******************************************************************00288999
050500     EXEC SQL                                                     00289099
050500          INCLUDE TEPVDA                                          00289199
050500     END-EXEC.                                                    00289299
050500                                                                  00289399
COBRND******************************************************************00289499
COBRND*  DB2 TABLE DB2PDBA.TEPPAY - PAYMENT TABLE                       00289599
COBRND******************************************************************00289699
COBRND     EXEC SQL                                                     00289799
COBRND          INCLUDE TEPPAY                                          00289899
COBRND     END-EXEC.                                                    00289999
COBRND                                                                  00290099
050600******************************************************************00290199
050700*  CORPORATE SUMMARY CURSOR (FOR REGISTER TOTALS)                 00290299
050800******************************************************************00290399
050900     EXEC SQL                                                     00290499
051000       DECLARE SUMMARY-CURSOR CURSOR FOR                          00290599
051100            SELECT  PARTN_NBR                                     00290699
051200                   ,STR_NBR                                       00290799
051300                   ,RGST_ID                                       00290899
051400                   ,SUM_CTG_CDE                                   00290999
051500                   ,CTG_AMT                                       00291099
051600            FROM  TSASUM                                          00291199
051700            WHERE   PARTN_NBR      = :EPPART-PARTN-NBR            00291299
COBTRL              AND ((SUM_TYP_CDE    = 'D'                          00291399
051900                AND SUM_CTG_CDE IN ('BCS', 'BCR', 'AXS', 'AXR',   00291499
052000                                    'NCS', 'NCR', 'KCS', 'KCR',   00291599
052100                                    'KCP', 'GDS', 'GDT', 'KMI',   00291699
052200                                    'KMT', 'SAL', 'TAX', 'GTS',   00291799
N2I201                                    'RET', 'DBS', 'DBR', 'TPC',   00291899
SEPH04                                    'ATX',                        00291999
PAYVEN                                    'PPS', 'PPR', 'VMS', 'VMR',   00292099
COBRND                                    'SGS', 'SGT', 'CVN', 'CVP')   00292199
SEPHOR*                                   'SCS', 'SCR','SGS', 'SGT')    00292299
COBTRL                AND RGST_ID       <> 0)                           00292399
COBTRL              OR   (SUM_TYP_CDE   IN ('D','S')                    00292499
COBTRL                AND SUM_CTG_CDE IN ('TTP', 'TTN')                 00292599
COBTRL                AND RGST_ID        = 0))                          00292699
052500              WITH UR                                             00292799
052600     END-EXEC.                                                    00292899
052700                                                                  00292999
055400******************************************************************00293099
055500*  SETTLEMENT CURSOR (FOR SALES CORRECTIONS)                      00293199
055600******************************************************************00293299
055700     EXEC SQL                                                     00293399
055800       DECLARE SETTLEMENT-CURSOR CURSOR FOR                       00293499
055900            SELECT  C.PARTN_NBR                                   00293599
056000                   ,A.STR_NBR                                     00293699
056100                   ,A.RGST_ID                                     00293799
056200                   ,A.TRN_NBR                                     00293899
056300                   ,A.STRT_TM                                     00293999
056400                   ,A.SLS_CORR_SEQ_NBR                            00294099
056500                   ,B.TRN_TYP_CDE                                 00294199
056600                   ,B.TRN_TOT_AMT                                 00294299
056700                   ,B.SLS_TX_AMT                                  00294399
056800            FROM  TEPDKEY A                                       00294499
056900                 ,TEPTRN  B                                       00294599
057000                 ,TEPPART C                                       00294699
057100            WHERE   A.PRCG_DTE         = :EPDKEY-PRCG-DTE         00294799
057200              AND   A.SLS_DTE          = C.SLS_DTE                00294899
057300              AND   B.PARTN_NBR        = C.PARTN_NBR              00294999
057400              AND   A.STR_NBR          = B.STR_NBR                00295099
057500              AND   A.RGST_ID          = B.RGST_ID                00295199
057600              AND   A.TRN_NBR          = B.TRN_NBR                00295299
057700              AND   A.STRT_TM          = B.STRT_TM                00295399
057800              AND   A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR       00295499
057900              AND   A.SLS_CORR_SEQ_NBR <> 0                       00295599
058000              AND   VOID_ABRT_CDE     = 'N'                       00295699
058100              AND   TRN_STAT_CDE IN ('V', 'R', 'Z', 'L')          00295799
058200              AND   TRN_TYP_CDE                                   00295899
058300              IN ('01', '02', '11', '12', '22', '23', '24', '30') 00295999
058400              WITH UR                                             00296099
058500     END-EXEC.                                                    00296199
058600                                                                  00296299
058700******************************************************************00296399
058800*  TENDER CURSOR (FOR SALES CORRECTIONS)                          00296499
058900******************************************************************00296599
059000     EXEC SQL                                                     00296699
059100       DECLARE TENDER-CURSOR CURSOR FOR                           00296799
059200            SELECT  TNDR_AMT                                      00296899
059300                   ,TNDR_TYP_CDE                                  00296999
059400                   ,TNDR_ID_LEN_NBR                               00297099
059500                   ,TNDR_SEQ_NBR                                  00297199
SEPH02                   ,TNDR_ID_SRC_CDE                               00297299
059600            FROM  TEPTND                                          00297399
059700            WHERE   PARTN_NBR        = :EPPART-PARTN-NBR          00297499
059800              AND   STR_NBR          = :EPDKEY-STR-NBR            00297599
059900              AND   RGST_ID          = :EPDKEY-RGST-ID            00297699
060000              AND   TRN_NBR          = :EPDKEY-TRN-NBR            00297799
060100              AND   STRT_TM          = :EPDKEY-STRT-TM            00297899
060200              AND   SLS_CORR_SEQ_NBR = :EPDKEY-SLS-CORR-SEQ-NBR   00297999
060300              AND   TNDR_VOID_IND = 'N'                           00298099
060400              WITH UR                                             00298199
060500     END-EXEC.                                                    00298299
060600                                                                  00298399
060700******************************************************************00298499
060800*  ITEM CURSOR (CURSOR TO SELECT ITEM ROWS FOR DETERMINING        00298599
060900*  GIFT CARD PURCHASES                                            00298699
061000******************************************************************00298799
061100     EXEC SQL                                                     00298899
061200       DECLARE ITEM-CURSOR CURSOR FOR                             00298999
061300          SELECT DEPT_NBR                                         00299099
061400               , CUST_CHRGD_AMT                                   00299199
061500          FROM  TEPITM                                            00299299
061600          WHERE PARTN_NBR        = :EPPART-PARTN-NBR              00299399
061700            AND STR_NBR          = :EPDKEY-STR-NBR                00299499
061800            AND RGST_ID          = :EPDKEY-RGST-ID                00299599
061900            AND TRN_NBR          = :EPDKEY-TRN-NBR                00299699
062000            AND STRT_TM          = :EPDKEY-STRT-TM                00299799
062100            AND SLS_CORR_SEQ_NBR = :EPDKEY-SLS-CORR-SEQ-NBR       00299899
N2I201            AND (DEPT_NBR        = '833' OR                       00299999
N2I201                 DEPT_NBR        = '834' OR                       00300099
062400                 DEPT_NBR        = '981' OR                       00300199
SEPH02                 DEPT_NBR        = '712' OR                       00300299
062500                 DEPT_NBR        = '983')                         00300399
062600              WITH UR                                             00300499
062700     END-EXEC.                                                    00300599
SEPHOR                                                                  00300699
SEPHOR******************************************************************00300799
SEPHOR*  LATE CURSOR (CURSOR TO SELECT VOID LATE TRANSACTIONS)          00300899
SEPHOR******************************************************************00300999
SEPHOR     EXEC SQL                                                     00301099
SEPHOR       DECLARE LATE-CURSOR CURSOR FOR                             00301199
SEPHOR          SELECT D.PARTN_NBR                                      00301299
SEPHOR                ,D.STR_NBR                                        00301399
SEPHOR                ,D.RGST_ID                                        00301499
SEPHOR                ,D.TRN_NBR                                        00301599
SEPHOR                ,D.STRT_TM                                        00301699
SEPHOR                ,D.SLS_CORR_SEQ_NBR                               00301799
SEPHOR                ,E.TNDR_SEQ_NBR                                   00301899
SEPHOR                ,E.TNDR_AMT                                       00301999
SEPHOR                ,E.TNDR_TYP_CDE                                   00302099
SEPHOR                ,E.TNDR_ID_LEN_NBR                                00302199
SEPH02                ,E.TNDR_ID_SRC_CDE                                00302299
SEPHOR                                                                  00302399
SEPHOR          FROM TEPDKEY A                                          00302499
SEPHOR              ,TEPPART B                                          00302599
SEPHOR              ,TEPVDA  C                                          00302699
SEPHOR              ,TEPTRN  D                                          00302799
SEPHOR              ,TEPTND  E                                          00302899
SEPHOR                                                                  00302999
SEPHOR          WHERE A.PRCG_DTE = :EPDKEY-PRCG-DTE                     00303099
SEPHOR            AND A.SLS_DTE   = B.SLS_DTE                           00303199
SEPHOR            AND B.PARTN_NBR = C.PARTN_NBR                         00303299
SEPHOR                                                                  00303399
SEPHOR            AND A.STR_NBR = C.STR_NBR                             00303499
SEPHOR            AND A.RGST_ID = C.RGST_ID                             00303599
SEPHOR            AND A.TRN_NBR = C.TRN_NBR                             00303699
SEPHOR            AND A.STRT_TM = C.STRT_TM                             00303799
SEPHOR            AND A.SLS_CORR_SEQ_NBR = C.SLS_CORR_SEQ_NBR           00303899
SEPHOR                                                                  00303999
SEPHOR            AND C.PARTN_NBR    = D.PARTN_NBR                      00304099
SEPHOR            AND C.STR_NBR      = D.STR_NBR                        00304199
SEPHOR            AND C.RGST_ID      = D.RGST_ID                        00304299
SEPHOR            AND C.VOID_TRN_NBR = D.TRN_NBR                        00304399
SEPHOR                                                                  00304499
SEPHOR            AND C.PARTN_NBR    = E.PARTN_NBR                      00304599
SEPHOR            AND C.STR_NBR      = E.STR_NBR                        00304699
SEPHOR            AND C.RGST_ID      = E.RGST_ID                        00304799
SEPHOR            AND C.VOID_TRN_NBR = E.TRN_NBR                        00304899
SEPHOR            AND C.STRT_TM      = E.STRT_TM                        00304999
SEPHOR                                                                  00305099
SEPHOR            AND D.TRN_STAT_CDE = 'Z'                              00305199
SEPHOR                                                                  00305299
SEPHOR            AND E.TNDR_VOID_IND = 'N'                             00305399
SEPHOR                                                                  00305499
SEPHOR        WITH UR                                                   00305599
SEPHOR     END-EXEC.                                                    00305699
SEPHOR                                                                  00305799
062900***************************************************************** 00305899
063000* PROCEDURE DIVISION.                                           * 00305999
063100***************************************************************** 00306099
063200 PROCEDURE DIVISION.                                              00306199
063300                                                                  00306299
063400******************************************************************00306399
063500* 0000-MAINLINE-PARAGRAPH                                         00306499
063600*      PRODUCE CORPORATE SETTLEMENTS REPORT                       00306599
063700******************************************************************00306699
063800 0000-MAINLINE-PARAGRAPH.                                         00306799
063900                                                                  00306899
064000     PERFORM 1000-INITIALIZE-PROGRAM.                             00306999
064100                                                                  00307099
064200     PERFORM 2100-OPEN-SUMMARY-CURSOR.                            00307199
064300                                                                  00307299
064400     PERFORM 2200-FETCH-SUMMARY-CURSOR.                           00307399
064500                                                                  00307499
064600     PERFORM 2000-FETCH-SUMMARY-DATA                              00307599
064700       UNTIL PS-END-OF-SUM-CURSOR.                                00307699
064800                                                                  00307799
064900     PERFORM 2300-CLOSE-SUMMARY-CURSOR.                           00307899
065000                                                                  00307999
065700     PERFORM 3100-OPEN-SETTLEMENT-CURSOR.                         00308099
065800                                                                  00308199
065900     PERFORM 3200-FETCH-SETTLEMENT-CURSOR.                        00308299
066000                                                                  00308399
066100     PERFORM 3000-FETCH-SETTLEMENT-DATA                           00308499
066200       UNTIL PS-END-OF-STTL-CURSOR.                               00308599
066300                                                                  00308699
066400     PERFORM 3300-CLOSE-SETTLEMENT-CURSOR.                        00308799
066300                                                                  00308899
066900     PERFORM 4100-OPEN-LATE-CURSOR.                               00308999
066900     PERFORM 4200-FETCH-LATE-CURSOR                               00309099
066900         UNTIL PS-END-OF-LATE-CURSOR.                             00309199
066900     PERFORM 4300-CLOSE-LATE-CURSOR.                              00309299
066500                                                                  00309399
066600     PERFORM 5500-CALCULATE-SETTLEMENT                            00309499
066700         VARYING PV-STTL-SUB FROM 1 BY 1                          00309599
PAYVEN             UNTIL PV-STTL-SUB GREATER THAN 18.                   00309699
066900                                                                  00309799
067000     PERFORM 6000-PRINT-REPORT-TOTALS.                            00309899
067100                                                                  00309999
067200     DISPLAY '****************************************'           00310099
067300     DISPLAY '*************** SAKRP005 ***************'           00310199
067400     DISPLAY '****************************************'           00310299
067500     MOVE PV-SUM-CURSOR-CNT      TO PV-EDIT-MASK                  00310399
067600     INSPECT PV-EDIT-MASK REPLACING LEADING SPACE BY '.'          00310499
067700     DISPLAY 'SUMMARY ROWS FETCHED...........'                    00310599
067800         PV-EDIT-MASK                                             00310699
067900                                                                  00310799
068500     MOVE PV-STTL-CURSOR-CNT     TO PV-EDIT-MASK                  00310899
068600     INSPECT PV-EDIT-MASK REPLACING LEADING SPACE BY '.'          00310999
068700     DISPLAY 'SETTLEMENT ROWS FETCHED........'                    00311099
068800         PV-EDIT-MASK                                             00311199
068800                                                                  00311299
068800     MOVE PV-LATE-CURSOR-CNT     TO PV-EDIT-MASK                  00311399
068800     INSPECT PV-EDIT-MASK REPLACING LEADING SPACE BY '.'          00311499
068800     DISPLAY 'LATE VOID ROWS FETCHED.........'                    00311599
068800         PV-EDIT-MASK                                             00311699
068800                                                                  00311799
068900     DISPLAY '****************************************'           00311899
069000     DISPLAY '****************************************'           00311999
069100     DISPLAY '****************************************'           00312099
069200                                                                  00312199
069300     STOP RUN.                                                    00312299
069400                                                                  00312399
069500                                                                  00312499
069600******************************************************************00312599
069700* 1000-INITIALIZE-PROGRAM                                         00312699
069800*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS,   00312799
069900*     SELECT PARTN-NBR FROM TEPPART (REQUIRED FOR                 00312899
070000*     SETTLEMENT-CURSOR), OPEN SETTLEMENT-CURSOR,                 00312999
070100*     ATTEMPT FIRST FETCH OF CURSOR.                              00313099
070200******************************************************************00313199
070300                                                                  00313299
070400 1000-INITIALIZE-PROGRAM.                                         00313399
070500                                                                  00313499
070500     INITIALIZE PV-SUM-CURSOR-CNT                                 00313599
070500                PV-STTL-CURSOR-CNT                                00313699
070500                PV-LATE-CURSOR-CNT.                               00313799
070500                                                                  00313899
070600     OPEN INPUT  POS-DATE-CARD-FILE                               00313999
070700          OUTPUT SETTLEMENT-REPORT-FILE.                          00314099
070800                                                                  00314199
070900     PERFORM 1100-PROCESS-CONTROL-CARD.                           00314299
071000                                                                  00314399
071100     PERFORM 1200-FORMAT-HEADINGS.                                00314499
071200                                                                  00314599
071300     PERFORM 1300-INITIALIZE-TOTALS                               00314699
071400         VARYING PV-STTL-SUB FROM 1 BY 1                          00314799
PAYVEN             UNTIL PV-STTL-SUB GREATER THAN 18.                   00314899
071600                                                                  00314999
071700     PERFORM 1400-GET-DB2-PARTITION-NBR.                          00315099
071800                                                                  00315199
071900******************************************************************00315299
072000* 1100-PROCESS-CONTROL-CARD                                       00315399
072100*     READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL   00315499
072200*     DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.  00315599
072300******************************************************************00315699
072400                                                                  00315799
072500 1100-PROCESS-CONTROL-CARD.                                       00315899
072600                                                                  00315999
072700     PERFORM 1110-READ-POS-DATE-CARD-FILE.                        00316099
072800     CLOSE POS-DATE-CARD-FILE.                                    00316199
072900     IF PS-END-OF-CARD-FILE                                       00316299
073000         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   00316399
073100         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  00316499
073200         SET AC-CONTROL-CARD-ERROR TO TRUE                        00316599
073300         PERFORM 9999-ABEND                                       00316699
073400     END-IF.                                                      00316799
073500     DISPLAY PC-CURRENT-PROGRAM-NAME                              00316899
073600             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY  ')'.  00316999
073700     PERFORM 1115-CONVERT-INPUT-DATE.                             00317099
073800                                                                  00317199
073900******************************************************************00317299
074000* 1110-READ-POS-DATE-CARD-FILE                                    00317399
074100*     READ DATE CONTROL CARD.                                     00317499
074200******************************************************************00317599
074300 1110-READ-POS-DATE-CARD-FILE.                                    00317699
074400     READ POS-DATE-CARD-FILE INTO CC-CONTROL-CARD                 00317799
074500        AT END                                                    00317899
074600           SET PS-END-OF-CARD-FILE TO TRUE.                       00317999
074700                                                                  00318099
074800******************************************************************00318199
074900* 1115-CONVERT-INPUT-DATE                                         00318299
075000*     CALL KOHLS CALENDAR ROUTINE:                                00318399
075100*         PASS: CONTROL CARD POS DATE (MMDDYY FORMAT).            00318499
075200*       RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT). 00318599
075300******************************************************************00318699
075400                                                                  00318799
075500 1115-CONVERT-INPUT-DATE.                                         00318899
075600                                                                  00318999
075700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              00319099
075800                                                                  00319199
075900     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   00319299
076000     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   00319399
076100     SET  DPG52-LK-DTE-GREG            TO TRUE.                   00319499
076200     MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    00319599
076210                                                                  00319699
076300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    00319799
076400                                             DPG54 DPG55 DPG56.   00319899
076500     EVALUATE TRUE                                                00319999
076600         WHEN DPG54-SEVERE-ERROR                                  00320099
076700         WHEN DPG54-DATE-INVALID                                  00320199
076800             MOVE '1115-CONVERT-INPUT-DATE'                       00320299
076900                                           TO PV-PARAGRAPH-NAME   00320399
077000             MOVE 'ERROR CONVERTING INPUT CARD DATE'              00320499
077100                                           TO PV-OPERATION-MSG-1  00320599
077200             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                00320699
077300             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  00320799
077400             PERFORM 9999-ABEND                                   00320899
077500     END-EVALUATE.                                                00320999
077600                                                                  00321099
077700     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD       00321199
077800                                          EPDKEY-PRCG-DTE.        00321299
077900                                                                  00321399
078000******************************************************************00321499
078100* 1200-FORMAT-HEADINGS                                            00321599
078200*     GET CURRENT DATE AND TIME FROM SYSTEM.                      00321699
078300*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          00321799
078400*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              00321899
078500******************************************************************00321999
078600 1200-FORMAT-HEADINGS.                                            00322099
078700                                                                  00322199
078800     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   00322299
078900     ACCEPT PV-CURR-TIME FROM TIME.                               00322399
079000                                                                  00322499
079100     MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         00322599
079200     MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           00322699
079300     MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          00322799
079400                                                                  00322899
079500     MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          00322999
079600     MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        00323099
079700     MOVE PC-CURRENT-PROGRAM-NAME     TO DP132-PROGRAM-NAME.      00323199
079800     MOVE PC-REPORT-NBR-1             TO DP132-REPORT-NUMBER.     00323299
079900                                                                  00323399
080000     MOVE PV-POS-CCYY                 TO H2-CCYY.                 00323499
080100     MOVE PV-POS-MM                   TO H2-MM.                   00323599
080200     MOVE PV-POS-DD                   TO H2-DD.                   00323699
080300                                                                  00323799
080400******************************************************************00323899
080500* 1300-INITIALIZE-TOTALS                                          00323999
080600*     MOVE ZERO TO THE DOLLAR TOTALS                              00324099
080700*                                                                 00324199
080800******************************************************************00324299
080900 1300-INITIALIZE-TOTALS.                                          00324399
081000                                                                  00324499
081100     MOVE ZERO                   TO PV-STTL-UNAUD-REG-TOT         00324599
081200                                         (PV-STTL-SUB)            00324699
081300     MOVE ZERO                   TO PV-STTL-AUD-SALES-CORR        00324799
081400                                         (PV-STTL-SUB)            00324899
081500     MOVE ZERO                   TO PV-PRO-STTL-FROM-POS          00324999
081600                                         (PV-STTL-SUB).           00325099
081700                                                                  00325199
081800******************************************************************00325299
081900* 1400-GET-DB2-PARTITION-NBR                                      00325399
082000*     GET TODAY'S PARTITION NUMBER                                00325499
082100*                                                                 00325599
082200******************************************************************00325699
082300 1400-GET-DB2-PARTITION-NBR.                                      00325799
082400                                                                  00325899
082500     EXEC SQL                                                     00325999
082600         SELECT PARTN_NBR                                         00326099
082700           INTO :EPPART-PARTN-NBR                                 00326199
082800           FROM TEPPART                                           00326299
082900          WHERE SLS_DTE = :PV-POS-CCYY-MM-DD                      00326399
083000            AND DB_STRUC_CDE = 'O'                                00326499
TPCDSC            AND STR_GP_CDE   = 'A'                                00326599
083100                WITH UR                                           00326699
083200     END-EXEC.                                                    00326799
083300                                                                  00326899
083400     EVALUATE TRUE                                                00326999
083500         WHEN SQLCODE EQUAL ZERO                                  00327099
083600             CONTINUE                                             00327199
083700         WHEN SQLWARN0 NOT EQUAL SPACE                            00327299
083800         WHEN SQLCODE NOT EQUAL ZERO                              00327399
083900             MOVE '1400-GET-DB2-PARTITION-NBR'                    00327499
084000                                 TO PV-PARAGRAPH-NAME             00327599
084100             MOVE 'ERROR ON SELECT FROM TEPPART'                  00327699
084200                                 TO PV-DB2-OPERATION              00327799
084300             PERFORM 9100-SQL-ABEND                               00327899
084400     END-EVALUATE.                                                00327999
084500                                                                  00328099
084600******************************************************************00333499
084700* 2000-FETCH-SUMMARY-DATA                                         00333599
084800*     PROCESS CURSOR DATA                                         00333699
084900******************************************************************00333799
085000 2000-FETCH-SUMMARY-DATA.                                         00333899
085100                                                                  00333999
085200     EVALUATE SASUM-SUM-CTG-CDE                                   00334099
085300         WHEN 'BCS'                                               00334199
085400             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (1)     00334299
085500         WHEN 'BCR'                                               00334399
085600             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (1)     00334499
085700         WHEN 'AXS'                                               00334599
085800             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (2)     00334699
085900         WHEN 'AXR'                                               00334799
086000             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (2)     00334899
086100         WHEN 'NCS'                                               00334999
086200             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (3)     00335099
086300         WHEN 'NCR'                                               00335199
086400             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (3)     00335299
086500         WHEN 'DBS'                                               00335399
086600             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (04)    00335499
086700         WHEN 'DBR'                                               00335599
086800             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (04)    00335699
086900         WHEN 'KCS'                                               00335799
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (9)     00335899
087100         WHEN 'KCR'                                               00335999
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (9)     00336099
087100         WHEN 'ATX'                                               00336199
PAYVEN          SUBTRACT SASUM-CTG-AMT FROM PV-STTL-UNAUD-REG-TOT (9)   00336299
087300         WHEN 'KCP'                                               00336399
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (10)    00336499
087500         WHEN 'GDS'                                               00336599
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (11)    00336699
087700             SUBTRACT SASUM-CTG-AMT                               00336799
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (15)  00336899
087900         WHEN 'GDT'                                               00336999
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (12)    00337099
088100         WHEN 'KMI'                                               00337199
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (13)    00337299
088300         WHEN 'KMT'                                               00337399
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (14)    00337499
088500         WHEN 'SAL'                                               00337599
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (15)    00337699
088700         WHEN 'TAX'                                               00337799
088800             SUBTRACT SASUM-CTG-AMT                               00337899
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (15)  00337999
089000         WHEN 'GTS'                                               00338099
089100             SUBTRACT SASUM-CTG-AMT                               00338199
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (15)  00338299
089300         WHEN 'RET'                                               00338399
PAYVEN             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (15)  00338499
089500                                                                  00338599
N2I201         WHEN 'TPC'                                               00338699
PAYVEN             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (8)   00338799
N2I201             SUBTRACT SASUM-CTG-AMT                               00338899
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (15)  00338999
SEPH02         WHEN 'SGS'                                               00339099
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (16)    00339199
SEPH04             SUBTRACT SASUM-CTG-AMT                               00339299
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (8)   00339399
SEPH02         WHEN 'SGT'                                               00339499
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (17)    00339599
SEPH04             SUBTRACT SASUM-CTG-AMT                               00339699
PAYVEN                                 FROM PV-STTL-UNAUD-REG-TOT (12)  00339799
COBRND         WHEN 'CVN'                                               00339899
COBRND             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (5)   00339999
COBRND*          COBRAND NET NEEDS TO BE SUBTRACTED FROM BCN (BCS & BCR)00340099
COBRND             SUBTRACT SASUM-CTG-AMT                               00340199
COBRND                                 FROM PV-STTL-UNAUD-REG-TOT (1)   00340299
COBRND         WHEN 'CVP'                                               00340399
COBRND             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (18)  00340499
COBRND*          COBRAND PAYMENTS NEEDS TO BE SUBTRACTED FROM KCP       00340599
COBRND             SUBTRACT SASUM-CTG-AMT                               00340699
COBRND                                 FROM PV-STTL-UNAUD-REG-TOT (10)  00340799
COBTRL         WHEN 'TTN'                                               00340899
COBTRL*          COBRAND TRAIL TENDER ADD TO CVN AND SUBTRACT FROM KCN  00340999
COBTRL             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (5)   00341099
COBTRL                                      PV-TTN-DOLLARS              00341199
COBTRL             SUBTRACT SASUM-CTG-AMT                               00341499
COBTRL                                 FROM PV-STTL-UNAUD-REG-TOT (9)   00341599
COBTRL         WHEN 'TTP'                                               00341699
COBTRL*          COBRAND TRAIL PAYMENT ADD TO CVP AND SUBTRACT FROM KCP 00341799
COBTRL             ADD SASUM-CTG-AMT   TO   PV-STTL-UNAUD-REG-TOT (18)  00341899
COBTRL                                      PV-TTP-DOLLARS              00341999
COBTRL             SUBTRACT SASUM-CTG-AMT                               00342099
COBTRL                                 FROM PV-STTL-UNAUD-REG-TOT (10)  00342199
PAYVEN         WHEN 'PPS'                                               00342299
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (6)     00342399
PAYVEN         WHEN 'PPR'                                               00342499
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (6)     00342599
PAYVEN         WHEN 'VMS'                                               00342699
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (7)     00342799
PAYVEN         WHEN 'VMR'                                               00342899
PAYVEN             ADD SASUM-CTG-AMT   TO PV-STTL-UNAUD-REG-TOT (7)     00342999
090000     END-EVALUATE.                                                00343099
090100                                                                  00343199
090200     PERFORM 2200-FETCH-SUMMARY-CURSOR.                           00343299
090300                                                                  00343399
090400******************************************************************00343499
090500* 2100-OPEN-SUMMARY-CURSOR.                                       00343599
090600*     OPEN SUMMARY CURSOR                                         00343699
090700******************************************************************00343799
090800 2100-OPEN-SUMMARY-CURSOR.                                        00343899
090900                                                                  00343999
091000     EXEC SQL                                                     00344099
091100          OPEN SUMMARY-CURSOR                                     00344199
091200     END-EXEC.                                                    00344299
091300                                                                  00344399
091400     EVALUATE TRUE                                                00344499
091500         WHEN SQLCODE = ZERO                                      00344599
091600              CONTINUE                                            00344699
091700         WHEN OTHER                                               00344799
091800             MOVE '7000-OPEN-SUMMARY-CURSOR'                      00344899
091900                                            TO PV-PARAGRAPH-NAME  00344999
092000             MOVE 'ERROR ON OPEN OF SUMMARY-CURSOR'               00345099
092100                                            TO PV-DB2-OPERATION   00345199
092200             PERFORM 9100-SQL-ABEND                               00345299
092300     END-EVALUATE.                                                00345399
092400                                                                  00345499
092500******************************************************************00345599
092600* 2200-FETCH-SUMMARY-CURSOR                                       00345699
092700******************************************************************00345799
092800 2200-FETCH-SUMMARY-CURSOR.                                       00345899
092900                                                                  00345999
093000     EXEC SQL                                                     00346099
093100          FETCH SUMMARY-CURSOR                                    00346199
093200           INTO :SASUM-PARTN-NBR                                  00346299
093300               ,:SASUM-STR-NBR                                    00346399
093400               ,:SASUM-RGST-ID                                    00346499
093500               ,:SASUM-SUM-CTG-CDE                                00346599
093600               ,:SASUM-CTG-AMT                                    00346699
093700     END-EXEC.                                                    00346799
093800                                                                  00346899
093900     EVALUATE TRUE                                                00346999
094000         WHEN SQLCODE = ZERO                                      00347099
094100             ADD 1               TO PV-SUM-CURSOR-CNT             00347199
094200         WHEN SQLCODE = PC-ROW-NOT-FOUND                          00347299
094300             SET PS-END-OF-SUM-CURSOR TO TRUE                     00347399
094400         WHEN OTHER                                               00347499
094500             MOVE '2200-FETCH-SUMMARY-CURSOR'                     00347599
094600                                            TO PV-PARAGRAPH-NAME  00347699
094700             MOVE 'ERROR ON FETCH OF SUMMARY-CURSOR'              00347799
094800                                            TO PV-DB2-OPERATION   00347899
094900             PERFORM 9100-SQL-ABEND                               00347999
095000     END-EVALUATE.                                                00348099
095100                                                                  00348199
095200******************************************************************00348299
095300* 2300-CLOSE-SUMMARY-CURSOR                                       00348399
095400******************************************************************00348499
095500 2300-CLOSE-SUMMARY-CURSOR.                                       00348599
095600                                                                  00348699
095700     EXEC SQL                                                     00348799
095800          CLOSE SUMMARY-CURSOR                                    00348899
095900     END-EXEC.                                                    00348999
096000                                                                  00349099
096100     EVALUATE TRUE                                                00349199
096200         WHEN SQLCODE = ZERO                                      00349299
096300              CONTINUE                                            00349399
096400         WHEN OTHER                                               00349499
096500             MOVE '2300-CLOSE-SUMMARY-CURSOR'                     00349599
096600                                            TO PV-PARAGRAPH-NAME  00349699
096700             MOVE 'ERROR ON CLOSE OF SUMMARY-CURSOR'              00349799
096800                                            TO PV-DB2-OPERATION   00349899
096900             PERFORM 9100-SQL-ABEND                               00349999
097000     END-EVALUATE.                                                00350099
097100                                                                  00351099
120400******************************************************************00359799
120500* 3000-FETCH-SETTLEMENT-DATA                                      00359899
120600*     PROCESS CURSOR DATA                                         00359999
120700******************************************************************00360099
120800 3000-FETCH-SETTLEMENT-DATA.                                      00360199
120900                                                                  00360299
121000     IF EPTRN-TRN-TYP-CDE = '30'                                  00360399
COBRND         PERFORM 3005-READ-TEPPAY                                 00360499
COBRND         IF EPPAY-COBRND-IND = 'N'                                00360699
PAYVEN            ADD EPTRN-TRN-TOT-AMT   TO PV-STTL-AUD-SALES-CORR (10)00360799
COBRND         ELSE                                                     00360999
PAYVEN            ADD EPTRN-TRN-TOT-AMT   TO PV-STTL-AUD-SALES-CORR (18)00361099
COBRND         END-IF                                                   00361299
121200     ELSE                                                         00361399
COBRND         PERFORM 3010-PROCESS-TRANSACTION                         00361499
121400         PERFORM 3020-PROCESS-TENDERS                             00361599
121500     END-IF.                                                      00361699
121600                                                                  00361799
121700     PERFORM 3200-FETCH-SETTLEMENT-CURSOR.                        00361899
121800                                                                  00361999
COBRND******************************************************************00362099
COBRND* 3005-READ-TEPPAY.                                               00362199
COBRND******************************************************************00362299
COBRND 3005-READ-TEPPAY.                                                00362399
COBRND                                                                  00362499
COBRND      EXEC SQL                                                    00362599
COBRND          SELECT  COBRND_IND                                      00362699
COBRND            INTO :EPPAY-COBRND-IND                                00362799
COBRND            FROM  TEPPAY                                          00362899
COBRND           WHERE  PARTN_NBR        = :EPPART-PARTN-NBR            00362999
COBRND            AND   STR_NBR          = :EPDKEY-STR-NBR              00363099
COBRND            AND   RGST_ID          = :EPDKEY-RGST-ID              00363199
COBRND            AND   TRN_NBR          = :EPDKEY-TRN-NBR              00363299
COBRND            AND   STRT_TM          = :EPDKEY-STRT-TM              00363399
COBRND            AND   SLS_CORR_SEQ_NBR = :EPDKEY-SLS-CORR-SEQ-NBR     00363499
COBRND      END-EXEC.                                                   00363599
COBRND                                                                  00363699
COBRND      EVALUATE TRUE                                               00363799
COBRND          WHEN SQLCODE = ZERO                                     00363899
COBRND              CONTINUE                                            00363999
COBRND          WHEN OTHER                                              00364099
COBRND              MOVE '3005-READ-TEPPAY'                             00364199
COBRND                                   TO PV-PARAGRAPH-NAME           00364299
COBRND              MOVE 'ERROR ON READ OF TEPPAY'                      00364399
COBRND                                   TO PV-DB2-OPERATION            00364499
COBRND              PERFORM 9100-SQL-ABEND                              00364599
COBRND      END-EVALUATE.                                               00364699
COBRND                                                                  00364799
121900******************************************************************00364899
122000* 3010-PROCESS-TRANSACTION.                                       00364999
122100******************************************************************00365099
122200 3010-PROCESS-TRANSACTION.                                        00365199
122300                                                                  00365299
122400     MOVE ZERO               TO PV-GIFT-CARD.                     00365399
122500     MOVE ZERO               TO PV-GIFT-CERT.                     00365499
122600     MOVE ZERO               TO PV-MDSE-SALE.                     00365599
SEPH02     MOVE ZERO               TO PV-SEPHORA-GC.                    00365699
122700                                                                  00365799
122800     MOVE 'N'                TO PS-END-OF-ITEM-CURSOR-SW.         00365899
122900                                                                  00365999
123000     PERFORM 3070-OPEN-ITEM-CURSOR.                               00366099
123100                                                                  00366199
123200     PERFORM 3080-FETCH-ITEM-CURSOR                               00366299
123300         UNTIL PS-END-OF-ITEM-CURSOR.                             00366399
123400                                                                  00366499
123500     PERFORM 3090-CLOSE-ITEM-CURSOR.                              00366599
123600                                                                  00366699
PAYVEN     ADD PV-GIFT-CARD        TO PV-STTL-AUD-SALES-CORR (11).      00366799
PAYVEN     ADD PV-SEPHORA-GC       TO PV-STTL-AUD-SALES-CORR (16).      00366999
123800                                                                  00367199
123900     COMPUTE PV-MDSE-SALE =    EPTRN-TRN-TOT-AMT                  00367299
124000                             - EPTRN-SLS-TX-AMT                   00367399
124100                             - PV-GIFT-CARD                       00367499
124200                             - PV-GIFT-CERT                       00367599
SEPH02                             - PV-SEPHORA-GC                      00367699
124300     END-COMPUTE.                                                 00367799
PAYVEN     ADD PV-MDSE-SALE        TO PV-STTL-AUD-SALES-CORR (15).      00367899
124500                                                                  00368099
124600******************************************************************00368199
124700* 3020-PROCESS-TENDERS.                                           00368299
124800*     PROCESS TENDERS FOR A TRANSACTION.  THERE COULD BE MORE     00368399
124900*     THAN ONE TENDER PER TRANSACTION.                            00368499
125000******************************************************************00368599
125100 3020-PROCESS-TENDERS.                                            00368699
125200                                                                  00368799
125300     MOVE 'N' TO PS-END-OF-TENDER-CURSOR-SW.                      00368899
125400     PERFORM 3030-OPEN-TENDER-CURSOR.                             00368999
125500                                                                  00369099
125600     PERFORM 3040-FETCH-TENDER-CURSOR                             00369199
125700         UNTIL PS-END-OF-TENDER-CURSOR.                           00369299
125800                                                                  00369399
125900     PERFORM 3050-CLOSE-TENDER-CURSOR.                            00369499
126000                                                                  00369599
126100                                                                  00369699
126200******************************************************************00369799
126300*     OPEN TENDER CURSOR.                                         00369899
126400******************************************************************00369999
126500 3030-OPEN-TENDER-CURSOR.                                         00370099
126600                                                                  00370199
126700     EXEC SQL                                                     00370299
126800          OPEN TENDER-CURSOR                                      00370399
126900     END-EXEC.                                                    00370499
127000                                                                  00370599
127100     EVALUATE TRUE                                                00370699
127200         WHEN SQLCODE = ZERO                                      00370799
127300              CONTINUE                                            00370899
127400         WHEN OTHER                                               00370999
127500             MOVE '3030-OPEN-TENDER-CURSOR' TO PV-PARAGRAPH-NAME  00371099
127600             MOVE 'ERROR ON OPEN OF TENDER-CURSOR'                00371199
127700                                            TO PV-DB2-OPERATION   00371299
127800             PERFORM 9100-SQL-ABEND                               00371399
127900     END-EVALUATE.                                                00371499
128000                                                                  00371599
128100******************************************************************00371699
128200* 3040-FETCH-TENDER-CURSOR.                                       00371799
128300******************************************************************00371899
128400 3040-FETCH-TENDER-CURSOR.                                        00371999
128500                                                                  00372099
128600     EXEC SQL                                                     00372199
128700          FETCH TENDER-CURSOR                                     00372299
128800          INTO  :EPTND-TNDR-AMT                                   00372399
128900               ,:EPTND-TNDR-TYP-CDE                               00372499
129000               ,:EPTND-TNDR-ID-LEN-NBR                            00372599
129100               ,:EPTND-TNDR-SEQ-NBR                               00372699
SEPH02               ,:EPTND-TNDR-ID-SRC-CDE                            00372799
129200     END-EXEC.                                                    00372899
129300                                                                  00372999
129400     EVALUATE TRUE                                                00373099
129500         WHEN SQLCODE = ZERO                                      00373199
129600             PERFORM 3045-PROCESS-TENDER                          00373299
129700         WHEN SQLCODE = +100                                      00373399
129800             MOVE 'Y'        TO PS-END-OF-TENDER-CURSOR-SW        00373499
129900         WHEN OTHER                                               00373599
130000             MOVE '3040-FETCH-TENDER-CURSOR'                      00373699
130100                                            TO PV-PARAGRAPH-NAME  00373799
130200             MOVE 'ERROR ON SELECT OF TEPTND'                     00373899
130300                                            TO PV-DB2-OPERATION   00373999
130400             PERFORM 9100-SQL-ABEND                               00374099
130500     END-EVALUATE.                                                00374199
130600                                                                  00374299
130700 3045-PROCESS-TENDER.                                             00374399
130800                                                                  00374499
130900     EVALUATE EPTND-TNDR-TYP-CDE                                  00374599
131000         WHEN '02'                                                00374699
131100**  01/22/01  FIND OUT WHETHER KMRC WAS ISSUED OR TENDERED        00374799
131200             PERFORM 3046-KMRC-ISSUE-OR-TENDER                    00374899
131300*            (KMRC IS *ISSUED* ON A RETURN, OTHERWISE TENDERED)   00374999
131400             IF EPSVC-REQ-TYP-CDE = 'I'                           00375099
PAYVEN                ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (13)00375199
131600             ELSE                                                 00375399
PAYVEN                ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (14)00375499
131800             END-IF                                               00375699
131900         WHEN '04'                                                00375799
PAYVEN             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (9)    00375899
132100         WHEN '05'                                                00376099
132200         WHEN '06'                                                00376199
132300             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (1)    00376299
132400         WHEN '07'                                                00376399
132500             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (3)    00376499
132600         WHEN '08'                                                00376599
132700             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (2)    00376699
132800         WHEN '13'                                                00376799
132900*            (LENGTH = 5 IS GIFT CERTIFICATE, > 5 IS GIFT CARD)   00376899
133000             IF EPTND-TNDR-ID-LEN-NBR > 5                         00376999
SEPH02               IF EPTND-TNDR-ID-SRC-CDE = '14'                    00377099
SEPH02*  SALES CORRECTION WHEN USING A SEPHORA GIFT CARD AS TENDER      00377199
PAYVEN                ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (17)00377299
SEPH02               ELSE                                               00377499
PAYVEN                ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (12)00377599
SEPH02               END-IF                                             00377799
133200             END-IF                                               00377899
PAYVEN         WHEN '16'                                                00377999
PAYVEN             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (6)    00378099
PAYVEN         WHEN '17'                                                00378199
PAYVEN             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (7)    00378299
133300         WHEN '19'                                                00378399
133400             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (4)    00378499
COBRND         WHEN '24'                                                00378599
COBRND             ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (5)    00378699
SEPHOR*        WHEN '22'                                                00378799
SEPHOR*  SALES CORRECTION WHEN USING A SEPHORA CHARGE CARD              00378899
SEPHOR*            ADD EPTND-TNDR-AMT  TO PV-STTL-AUD-SALES-CORR (15)   00378999
133500     END-EVALUATE.                                                00379099
133600                                                                  00379199
133700******************************************************************00379299
133800* 3046-KMRC-ISSUE-OR-TENDER.                                      00379399
133900******************************************************************00379499
134000  3046-KMRC-ISSUE-OR-TENDER.                                      00379599
134100                                                                  00379699
134200      EXEC SQL                                                    00379799
134300          SELECT  REQ_TYP_CDE                                     00379899
134400            INTO :EPSVC-REQ-TYP-CDE                               00379999
134500            FROM  TEPSVC                                          00380099
134600           WHERE  PARTN_NBR        = :EPPART-PARTN-NBR            00380199
134700            AND   STR_NBR          = :EPDKEY-STR-NBR              00380299
134800            AND   RGST_ID          = :EPDKEY-RGST-ID              00380399
134900            AND   TRN_NBR          = :EPDKEY-TRN-NBR              00380499
135000            AND   STRT_TM          = :EPDKEY-STRT-TM              00380599
135100            AND   SLS_CORR_SEQ_NBR = :EPDKEY-SLS-CORR-SEQ-NBR     00380699
135200            AND   TNDR_SEQ_NBR     = :EPTND-TNDR-SEQ-NBR          00380799
135300      END-EXEC.                                                   00380899
135400                                                                  00380999
135500      EVALUATE TRUE                                               00381099
135600          WHEN SQLCODE = ZERO                                     00381199
135700              CONTINUE                                            00381299
135800          WHEN OTHER                                              00381399
135900              MOVE '3046-KMRC-ISSUE-OR-TENDER'                    00381499
136000                                   TO PV-PARAGRAPH-NAME           00381599
136100              MOVE 'ERROR ON OPEN OF TEPSVC'                      00381699
136200                                   TO PV-DB2-OPERATION            00381799
136300              PERFORM 9100-SQL-ABEND                              00381899
136400      END-EVALUATE.                                               00381999
136500                                                                  00382099
136600                                                                  00382199
136700******************************************************************00382299
136800* 3050-CLOSE-TENDER-CURSOR.                                       00382399
136900******************************************************************00382499
137000 3050-CLOSE-TENDER-CURSOR.                                        00382599
137100                                                                  00382699
137200     EXEC SQL                                                     00382799
137300          CLOSE TENDER-CURSOR                                     00382899
137400     END-EXEC.                                                    00382999
137500                                                                  00383099
137600     EVALUATE TRUE                                                00383199
137700         WHEN SQLCODE = ZERO                                      00383299
137800              CONTINUE                                            00383399
137900         WHEN OTHER                                               00383499
138000             MOVE '3050-CLOSE-TENDER-CURSOR' TO PV-PARAGRAPH-NAME 00383599
138100             MOVE 'ERROR ON CLOSE OF TENDER-CURSOR'               00383699
138200                                             TO PV-DB2-OPERATION  00383799
138300             PERFORM 9100-SQL-ABEND                               00383899
138400     END-EVALUATE.                                                00383999
138500                                                                  00384099
138600******************************************************************00384199
138700* 3070-OPEN-ITEM-CURSOR.                                          00384299
138800*     OPEN ITEM CURSOR                                            00384399
138900******************************************************************00384499
139000 3070-OPEN-ITEM-CURSOR.                                           00384599
139100                                                                  00384699
139200     EXEC SQL                                                     00384799
139300          OPEN ITEM-CURSOR                                        00384899
139400     END-EXEC.                                                    00384999
139500                                                                  00385099
139600     EVALUATE TRUE                                                00385199
139700         WHEN SQLCODE = ZERO                                      00385299
139800              CONTINUE                                            00385399
139900         WHEN OTHER                                               00385499
140000             MOVE '3070-OPEN-ITEM-CURSOR'   TO PV-PARAGRAPH-NAME  00385599
140100             MOVE 'ERROR ON OPEN OF ITEM-CURSOR'                  00385699
140200                                            TO PV-DB2-OPERATION   00385799
140300             PERFORM 9100-SQL-ABEND                               00385899
140400     END-EVALUATE.                                                00385999
140500                                                                  00386099
140600******************************************************************00386199
140700* 3080-FETCH-ITEM-CURSOR                                          00386299
140800*     PRINT REPORT TOTALS (IF DATA WAS PRESENT & REPORT CREATED), 00386399
140900*     CLOSE REPORT FILE.                                          00386499
141000******************************************************************00386599
141100 3080-FETCH-ITEM-CURSOR.                                          00386699
141200                                                                  00386799
141300     EXEC SQL                                                     00386899
141400          FETCH ITEM-CURSOR                                       00386999
141500          INTO  :EPITM-DEPT-NBR                                   00387099
141600               ,:EPITM-CUST-CHRGD-AMT                             00387199
141700     END-EXEC.                                                    00387299
141800                                                                  00387399
141900     EVALUATE TRUE                                                00387499
142000         WHEN SQLCODE = ZERO                                      00387599
142100             EVALUATE TRUE                                        00387699
N2I201                 WHEN EPITM-DEPT-NBR EQUAL 833 OR 834             00387799
N2I201                     ADD EPITM-CUST-CHRGD-AMT                     00387899
N2I201                                  TO PV-THIRD-PARTY-CARD-SALES    00387999
142500                 WHEN EPITM-DEPT-NBR EQUAL 981                    00388099
142600                     ADD EPITM-CUST-CHRGD-AMT TO PV-GIFT-CERT     00388199
142700                 WHEN EPITM-DEPT-NBR EQUAL 983                    00388299
142800                     ADD EPITM-CUST-CHRGD-AMT TO PV-GIFT-CARD     00388399
SEPH02*  ADDED SEPHORA GIFT CARD DEPT                                   00388499
SEPH02                 WHEN EPITM-DEPT-NBR EQUAL 712                    00388599
SEPH02                     ADD EPITM-CUST-CHRGD-AMT TO PV-SEPHORA-GC    00388699
142900             END-EVALUATE                                         00388799
143000         WHEN SQLCODE = +100                                      00388899
143100             MOVE 'Y'        TO PS-END-OF-ITEM-CURSOR-SW          00388999
143200         WHEN OTHER                                               00389099
143300             MOVE '3080-FETCH-ITEM-CURSOR'                        00389199
143400                                            TO PV-PARAGRAPH-NAME  00389299
143500             MOVE 'ERROR ON SELECT OF TEPITM'                     00389399
143600                                            TO PV-DB2-OPERATION   00389499
143700             PERFORM 9100-SQL-ABEND                               00389599
143800     END-EVALUATE.                                                00389699
143900                                                                  00389799
144000******************************************************************00389899
144100* 3090-CLOSE-ITEM-CURSOR                                          00389999
144200******************************************************************00390099
144300 3090-CLOSE-ITEM-CURSOR.                                          00390199
144400                                                                  00390299
144500     EXEC SQL                                                     00390399
144600          CLOSE ITEM-CURSOR                                       00390499
144700     END-EXEC.                                                    00390599
144800                                                                  00390699
144900     EVALUATE TRUE                                                00390799
145000         WHEN SQLCODE = ZERO                                      00390899
145100              CONTINUE                                            00390999
145200         WHEN OTHER                                               00391099
145300             MOVE '3090-CLOSE-ITEM-CURSOR'  TO PV-PARAGRAPH-NAME  00391199
145400             MOVE 'ERROR ON CLOSE OF ITEM-CURSOR'                 00391299
145500                                            TO PV-DB2-OPERATION   00391399
145600             PERFORM 9100-SQL-ABEND                               00391499
145700     END-EVALUATE.                                                00391599
145800                                                                  00391699
145900******************************************************************00391799
146000* 3100-OPEN-SETTLEMENT-CURSOR.                                    00391899
146100*     OPEN SETTLEMENT CURSOR                                      00391999
146200******************************************************************00392099
146300 3100-OPEN-SETTLEMENT-CURSOR.                                     00392199
146400                                                                  00392299
146500     EXEC SQL                                                     00392399
146600          OPEN SETTLEMENT-CURSOR                                  00392499
146700     END-EXEC.                                                    00392599
146800                                                                  00392699
146900     EVALUATE TRUE                                                00392799
147000         WHEN SQLCODE = ZERO                                      00392899
147100              CONTINUE                                            00392999
147200         WHEN OTHER                                               00393099
147300             MOVE '3100-OPEN-SETTLEMENT-CURSOR'                   00393199
147400                                            TO PV-PARAGRAPH-NAME  00393299
147500             MOVE 'ERROR ON OPEN OF SETTLEMENT-CURSOR'            00393399
147600                                            TO PV-DB2-OPERATION   00393499
147700             PERFORM 9100-SQL-ABEND                               00393599
147800     END-EVALUATE.                                                00393699
147900                                                                  00393799
148000******************************************************************00393899
148100* 3200-FETCH-SETTLEMENT-CURSOR                                    00393999
148200******************************************************************00394099
148300 3200-FETCH-SETTLEMENT-CURSOR.                                    00394199
148400                                                                  00394299
148500     EXEC SQL                                                     00394399
148600          FETCH SETTLEMENT-CURSOR                                 00394499
148700           INTO :EPPART-PARTN-NBR                                 00394599
148800               ,:EPDKEY-STR-NBR                                   00394699
148900               ,:EPDKEY-RGST-ID                                   00394799
149000               ,:EPDKEY-TRN-NBR                                   00394899
149100               ,:EPDKEY-STRT-TM                                   00394999
149200               ,:EPDKEY-SLS-CORR-SEQ-NBR                          00395099
149300               ,:EPTRN-TRN-TYP-CDE                                00395199
149400               ,:EPTRN-TRN-TOT-AMT                                00395299
149500               ,:EPTRN-SLS-TX-AMT                                 00395399
149600     END-EXEC.                                                    00395499
149700                                                                  00395599
149800     EVALUATE TRUE                                                00395699
149900         WHEN SQLCODE = ZERO                                      00395799
150000             ADD 1               TO PV-STTL-CURSOR-CNT            00395899
150100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          00395999
150200             SET PS-END-OF-STTL-CURSOR TO TRUE                    00396099
150300         WHEN OTHER                                               00396199
150400             MOVE '3200-FETCH-SETTLEMENT-CURSOR'                  00396299
150500                                            TO PV-PARAGRAPH-NAME  00396399
150600             MOVE 'ERROR ON FETCH OF SETTLEMENT-CURSOR'           00396499
150700                                            TO PV-DB2-OPERATION   00396599
150800             PERFORM 9100-SQL-ABEND                               00396699
150900     END-EVALUATE.                                                00396799
151000                                                                  00396899
151100******************************************************************00396999
151200* 3300-CLOSE-SETTLEMENT-CURSOR                                    00397099
151300******************************************************************00397199
151400 3300-CLOSE-SETTLEMENT-CURSOR.                                    00397299
151500                                                                  00397399
151600     EXEC SQL                                                     00397499
151700          CLOSE SETTLEMENT-CURSOR                                 00397599
151800     END-EXEC.                                                    00397699
151900                                                                  00397799
152000     EVALUATE TRUE                                                00397899
152100         WHEN SQLCODE = ZERO                                      00397999
152200              CONTINUE                                            00398099
152300         WHEN OTHER                                               00398199
152400             MOVE '3300-CLOSE-SETTLEMENT-CURSOR'                  00398299
152500                                            TO PV-PARAGRAPH-NAME  00398399
152600             MOVE 'ERROR ON CLOSE OF SETTLEMENT-CURSOR'           00398499
152700                                            TO PV-DB2-OPERATION   00398599
152800             PERFORM 9100-SQL-ABEND                               00398699
152900     END-EVALUATE.                                                00398799
SEPHOR                                                                  00398899
SEPHOR******************************************************************00398999
SEPHOR* PROCESS ANY VOID LATE TRANSACTIONS                              00399099
SEPHOR******************************************************************00399199
SEPHOR 4000-PROCESS-LATE-DATA.                                          00399299
SEPHOR                                                                  00399399
SEPHOR     MULTIPLY EPTND-TNDR-AMT BY -1                                00399499
SEPHOR          GIVING PV-TNDR-AMT.                                     00399599
SEPHOR                                                                  00399699
SEPHOR     EVALUATE EPTND-TNDR-TYP-CDE                                  00399799
SEPHOR       WHEN '02'                                                  00399899
SEPHOR         IF  PV-TNDR-AMT < 0                                      00399999
PAYVEN             ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (13)        00400099
SEPHOR         ELSE                                                     00400299
PAYVEN             ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (14)        00400399
SEPHOR         END-IF                                                   00400599
SEPHOR                                                                  00400699
SEPHOR       WHEN '04'                                                  00400799
PAYVEN         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (9)             00400899
SEPHOR                                                                  00401099
SEPHOR       WHEN '05'                                                  00401199
SEPHOR         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (1)             00401299
SEPHOR       WHEN '06'                                                  00401399
SEPHOR         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (1)             00401499
SEPHOR                                                                  00401599
SEPHOR       WHEN '07'                                                  00401699
SEPHOR         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (3)             00401799
SEPHOR       WHEN '08'                                                  00401899
SEPHOR         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (2)             00401999
SEPHOR       WHEN '13'                                                  00402099
SEPHOR         IF  EPTND-TNDR-ID-LEN-NBR > 5                            00402199
SEPH02            IF EPTND-TNDR-ID-SRC-CDE = '14'                       00402299
PAYVEN               ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (17)      00402399
SEPH02            ELSE                                                  00402599
PAYVEN               ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (12)      00402699
SEPH02            END-IF                                                00402899
SEPHOR         END-IF                                                   00402999
SEPHOR                                                                  00403099
PAYVEN       WHEN '16'                                                  00403199
PAYVEN         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (6)             00403299
PAYVEN       WHEN '17'                                                  00403399
PAYVEN         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (7)             00403499
SEPHOR       WHEN '19'                                                  00403599
SEPHOR         ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (4)             00403699
COBRND       WHEN '24'                                                  00403799
COBRND         ADD PV-TNDR-AMT   TO PV-STTL-UNAUD-REG-TOT (5)           00403899
SEPHOR*      SEPHORA CHARGE CARD                                        00403999
SEPHOR*      WHEN '22'                                                  00404099
SEPHOR*        ADD PV-TNDR-AMT TO PV-STTL-UNAUD-REG-TOT (15)            00404199
SEPHOR     END-EVALUATE.                                                00404299
SEPHOR                                                                  00404399
SEPHOR******************************************************************00404499
SEPHOR* OPEN LATE CURSOR                                                00404599
SEPHOR******************************************************************00404699
SEPHOR 4100-OPEN-LATE-CURSOR.                                           00404799
SEPHOR                                                                  00404899
SEPHOR     MOVE 'N' TO PS-END-OF-LATE-CURSOR-SW.                        00404999
SEPHOR                                                                  00405099
SEPHOR     EXEC SQL                                                     00405199
SEPHOR          OPEN LATE-CURSOR                                        00405299
SEPHOR     END-EXEC.                                                    00405399
SEPHOR                                                                  00405499
SEPHOR     EVALUATE TRUE                                                00405599
SEPHOR         WHEN SQLCODE = ZERO                                      00405699
SEPHOR             CONTINUE                                             00405799
SEPHOR                                                                  00405899
SEPHOR         WHEN OTHER                                               00405999
SEPHOR             MOVE '4100-OPEN-LATE-CURSOR'                         00406099
SEPHOR                                             TO PV-PARAGRAPH-NAME 00406199
SEPHOR             MOVE 'ERROR ON OPEN OF LATE-CURSOR'                  00406299
SEPHOR                                             TO PV-DB2-OPERATION  00406399
SEPHOR             PERFORM 9100-SQL-ABEND                               00406499
SEPHOR     END-EVALUATE.                                                00406599
SEPHOR                                                                  00406699
SEPHOR***************************************************************** 00406799
SEPHOR* FETCH LATE CURSOR                                               00406899
SEPHOR***************************************************************** 00406999
SEPHOR 4200-FETCH-LATE-CURSOR.                                          00407099
SEPHOR                                                                  00407199
SEPHOR     EXEC SQL                                                     00407299
SEPHOR          FETCH LATE-CURSOR                                       00407399
SEPHOR           INTO :EPTRN-PARTN-NBR                                  00407499
SEPHOR               ,:EPTRN-STR-NBR                                    00407599
SEPHOR               ,:EPTRN-RGST-ID                                    00407699
SEPHOR               ,:EPTRN-TRN-NBR                                    00407799
SEPHOR               ,:EPTRN-STRT-TM                                    00407899
SEPHOR               ,:EPTRN-SLS-CORR-SEQ-NBR                           00407999
SEPHOR               ,:EPTND-TNDR-SEQ-NBR                               00408099
SEPHOR               ,:EPTND-TNDR-AMT                                   00408199
SEPHOR               ,:EPTND-TNDR-TYP-CDE                               00408299
SEPHOR               ,:EPTND-TNDR-ID-LEN-NBR                            00408399
SEPH02               ,:EPTND-TNDR-ID-SRC-CDE                            00408499
SEPHOR     END-EXEC.                                                    00408599
SEPHOR                                                                  00408699
SEPHOR     EVALUATE TRUE                                                00408799
SEPHOR         WHEN SQLCODE = ZERO                                      00408899
SEPHOR             ADD 1 TO PV-LATE-CURSOR-CNT                          00408999
SEPHOR                                                                  00409099
SEPHOR             MOVE EPTRN-PARTN-NBR TO PV-PARTN-NBR-D               00409199
SEPHOR             MOVE EPTRN-STR-NBR   TO PV-STR-NBR-D                 00409299
SEPHOR             MOVE EPTRN-RGST-ID   TO PV-RGST-ID-D                 00409399
SEPHOR             MOVE EPTRN-TRN-NBR   TO PV-TRN-NBR-D                 00409499
SEPHOR             MOVE EPTND-TNDR-SEQ-NBR  TO PV-TNDR-SEQ-NBR-D        00409599
SEPHOR             MOVE EPTND-TNDR-TYP-CDE  TO PV-TNDR-TYP-CDE-D        00409699
SEPHOR             MOVE EPTND-TNDR-AMT TO PV-TNDR-AMT-D                 00409799
SEPHOR             DISPLAY '*****************'                          00409899
SEPHOR             DISPLAY 'FETCH LATE CURSOR'                          00409999
SEPHOR             DISPLAY 'PARTN ' PV-PARTN-NBR-D                      00410099
SEPHOR             DISPLAY 'STR   ' PV-STR-NBR-D                        00410199
SEPHOR             DISPLAY 'RGST  ' PV-RGST-ID-D                        00410299
SEPHOR             DISPLAY 'TRN   ' PV-TRN-NBR-D                        00410399
SEPHOR             DISPLAY 'TNDR-SEQ-NBR ' PV-TNDR-SEQ-NBR-D            00410499
SEPHOR             DISPLAY 'TNDR-TYP-CDE ' PV-TNDR-TYP-CDE-D            00410599
SEPHOR             DISPLAY 'TNDR-AMT ' PV-TNDR-AMT-D                    00410699
SEPHOR             DISPLAY '*****************'                          00410799
SEPHOR                                                                  00410899
SEPHOR             PERFORM 4000-PROCESS-LATE-DATA                       00410999
SEPHOR                                                                  00411099
SEPHOR         WHEN SQLCODE = PC-ROW-NOT-FOUND                          00411199
SEPHOR             SET PS-END-OF-LATE-CURSOR TO TRUE                    00411299
SEPHOR                                                                  00411399
SEPHOR         WHEN OTHER                                               00411499
SEPHOR             MOVE '4200-FETCH-LATE-CURSOR'                        00411599
SEPHOR                                            TO PV-PARAGRAPH-NAME  00411699
SEPHOR             MOVE 'ERROR ON FETCH OF LATE-CURSOR'                 00411799
SEPHOR                                            TO PV-DB2-OPERATION   00411899
SEPHOR             PERFORM 9100-SQL-ABEND                               00411999
SEPHOR     END-EVALUATE.                                                00412099
SEPHOR                                                                  00412199
SEPHOR******************************************************************00412299
SEPHOR* CLOSE LATE CURSOR                                               00412399
SEPHOR******************************************************************00412499
SEPHOR 4300-CLOSE-LATE-CURSOR.                                          00412599
SEPHOR                                                                  00412699
SEPHOR     EXEC SQL                                                     00412799
SEPHOR          CLOSE LATE-CURSOR                                       00412899
SEPHOR     END-EXEC.                                                    00412999
SEPHOR                                                                  00413099
SEPHOR     EVALUATE TRUE                                                00413199
SEPHOR         WHEN SQLCODE = ZERO                                      00413299
SEPHOR             CONTINUE                                             00413399
SEPHOR                                                                  00413499
SEPHOR         WHEN OTHER                                               00413599
SEPHOR             MOVE '4300-CLOSE-LATE-CURSOR'                        00413699
SEPHOR                                           TO PV-PARAGRAPH-NAME   00413799
SEPHOR             MOVE 'ERROR ON CLOSE OF LATE-CURSOR'                 00413899
SEPHOR                                           TO PV-DB2-OPERATION    00413999
SEPHOR             PERFORM 9100-SQL-ABEND                               00414099
SEPHOR     END-EVALUATE.                                                00414199
SEPHOR                                                                  00414299
156000******************************************************************00414399
156100* 5500-CALCULATE-SETTLEMENT                                       00414499
156200*     ADD UNAUDITED REGISTER TOTALS AND AUDITED SALES             00414599
156300*     CORRECTIONS TO GIVE PROPOSED SETTLEMENT                     00414699
156400*                                                                 00414799
156500******************************************************************00414899
156600 5500-CALCULATE-SETTLEMENT.                                       00414999
156700                                                                  00415099
156800     COMPUTE PV-PRO-STTL-FROM-POS (PV-STTL-SUB) =                 00415199
156900         PV-STTL-UNAUD-REG-TOT (PV-STTL-SUB) +                    00415299
157000         PV-STTL-AUD-SALES-CORR (PV-STTL-SUB).                    00415399
153000                                                                  00415499
153100******************************************************************00415599
153200* 6000-PRINT-REPORT-TOTALS                                        00415699
153300*     PRINT REPORT TOTALS (IF DATA WAS PRESENT & REPORT CREATED), 00415799
153400*     CLOSE REPORT FILE.                                          00415899
153500******************************************************************00415999
153600 6000-PRINT-REPORT-TOTALS.                                        00416099
153700                                                                  00416199
153800     PERFORM 8000-PRINT-HEADINGS.                                 00416299
153900                                                                  00416399
154000     MOVE 'EXTERNAL'             TO D1-SYSTEM-TYPE.               00416499
154100     MOVE D1-DETAIL-LINE-1       TO PV-PRINT-RECORD.              00416599
154200     MOVE +2                     TO PV-LINE-SPACING.              00416699
154300     PERFORM 8200-WRITE-REPORT-LINE.                              00416799
154400                                                                  00416899
154500     PERFORM 7000-PRINT-DETAIL-LINE                               00416999
154600         VARYING PV-STTL-SUB FROM 1 BY 1                          00417099
PAYVEN             UNTIL PV-STTL-SUB GREATER THAN 7.                    00417199
154800                                                                  00417399
154900     MOVE 'INTERNAL'             TO D1-SYSTEM-TYPE.               00417499
155000     MOVE D1-DETAIL-LINE-1       TO PV-PRINT-RECORD.              00417599
155100     MOVE +2                     TO PV-LINE-SPACING.              00417699
155200     PERFORM 8200-WRITE-REPORT-LINE.                              00417799
155300                                                                  00417899
155400     PERFORM 7000-PRINT-DETAIL-LINE                               00417999
PAYVEN         VARYING PV-STTL-SUB FROM 8 BY 1                          00418099
PAYVEN             UNTIL PV-STTL-SUB GREATER THAN 18.                   00418199
155700                                                                  00418499
COBTRL     MOVE T1-TRAILER-NOTE-LINE-1 TO PV-PRINT-RECORD.              00418599
COBTRL     MOVE +2                     TO PV-LINE-SPACING.              00418699
COBTRL     PERFORM 8200-WRITE-REPORT-LINE.                              00418799
COBTRL                                                                  00418899
COBTRL     MOVE PV-TTN-DOLLARS         TO T2-DISPLAY-TTN.               00418999
COBTRL     MOVE PV-TTP-DOLLARS         TO T2-DISPLAY-TTP.               00419099
COBTRL     MOVE T2-TRAILER-NOTE-LINE-2 TO PV-PRINT-RECORD.              00419199
COBTRL     MOVE +1                     TO PV-LINE-SPACING.              00419299
COBTRL     PERFORM 8200-WRITE-REPORT-LINE.                              00419399
COBTRL                                                                  00419499
155800     CLOSE SETTLEMENT-REPORT-FILE.                                00420499
155900                                                                  00420599
157200******************************************************************00420699
157300* 7000-PRINT-DETAIL-LINE                                          00420799
157400*     FORMAT AND PRINT REPORT DETAIL LINE.                        00420899
157500******************************************************************00420999
157600 7000-PRINT-DETAIL-LINE.                                          00421099
157700                                                                  00421199
157800     MOVE PC-STTL-TYPE (PV-STTL-SUB)                              00421299
157900                                 TO D2-STTL-TYPE                  00421399
158000     MOVE PV-STTL-UNAUD-REG-TOT (PV-STTL-SUB)                     00421499
158100                                 TO D2-UNAUD-REG-TOTALS           00421599
158200     MOVE PV-STTL-AUD-SALES-CORR (PV-STTL-SUB)                    00421699
158300                                 TO D2-AUD-SALES-CORR             00421799
158400     MOVE PV-PRO-STTL-FROM-POS (PV-STTL-SUB)                      00421899
158500                                 TO D2-PRO-STTL-FROM-POS          00421999
158600     MOVE PC-STTL-FILE (PV-STTL-SUB)                              00422099
158700                                 TO D2-STTL-JOB                   00422199
158800                                                                  00422299
158900     MOVE D2-DETAIL-LINE-2       TO PV-PRINT-RECORD.              00422399
159000     MOVE +2                     TO PV-LINE-SPACING.              00422499
159100     PERFORM 8200-WRITE-REPORT-LINE.                              00422599
159200                                                                  00422699
159300******************************************************************00422799
159400* 8000-PRINT-HEADINGS                                             00422899
159500*     PRINT THE HEADINGS FOR THE REPORT.                          00422999
159600******************************************************************00423099
159700 8000-PRINT-HEADINGS.                                             00423199
159800                                                                  00423299
159900     ADD +1                      TO PV-PAGE-CNT.                  00423399
160000     MOVE PV-PAGE-CNT TO DP132-PAGE-NUMBER.                       00423499
160100     MOVE DP132-STANDRD-HEADER-132-COLS                           00423599
160200                                 TO PV-PRINT-RECORD.              00423699
160300     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                          00423799
160400                                                                  00423899
160500     MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD.              00423999
160600     MOVE +1                     TO PV-LINE-SPACING.              00424099
160700     PERFORM 8200-WRITE-REPORT-LINE.                              00424199
160800                                                                  00424299
160900     MOVE H3-HEADING-LINE-3      TO PV-PRINT-RECORD.              00424399
161000     MOVE +3                     TO PV-LINE-SPACING.              00424499
161100     PERFORM 8200-WRITE-REPORT-LINE.                              00424599
161200                                                                  00424699
161300     MOVE H4-HEADING-LINE-4      TO PV-PRINT-RECORD.              00424799
161400     MOVE +1                     TO PV-LINE-SPACING.              00424899
161500     PERFORM 8200-WRITE-REPORT-LINE.                              00424999
161600                                                                  00425099
161700     MOVE H5-HEADING-LINE-5      TO PV-PRINT-RECORD.              00425199
161800     MOVE +1                     TO PV-LINE-SPACING.              00425299
161900     PERFORM 8200-WRITE-REPORT-LINE.                              00425399
162000                                                                  00425499
162100     MOVE H6-HEADING-LINE-6      TO PV-PRINT-RECORD.              00425599
162200     MOVE ZERO                   TO PV-LINE-SPACING.              00425699
162300     PERFORM 8200-WRITE-REPORT-LINE.                              00425799
162400                                                                  00425899
162500******************************************************************00425999
162600* 8100-WRITE-RPT-TOP-OF-PAGE                                      00426099
162700*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   00426199
162800******************************************************************00426299
162900 8100-WRITE-RPT-TOP-OF-PAGE.                                      00426399
163000                                                                  00426499
163100     WRITE SETTLEMENT-REPORT-RECORD                               00426599
163200       FROM PV-PRINT-RECORD                                       00426699
163300         AFTER ADVANCING PAGE.                                    00426799
163400     MOVE +1             TO PV-LINE-CNT.                          00426899
163500                                                                  00426999
163600******************************************************************00427099
163700* 8200-WRITE-REPORT-LINE                                          00427199
163800*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             00427299
163900******************************************************************00427399
164000 8200-WRITE-REPORT-LINE.                                          00427499
164100                                                                  00427599
164200     WRITE SETTLEMENT-REPORT-RECORD                               00427699
164300       FROM PV-PRINT-RECORD                                       00427799
164400         AFTER ADVANCING PV-LINE-SPACING.                         00427899
164500                                                                  00427999
164600     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          00428099
164700                                                                  00428199
164800******************************************************************00428299
164900* 9100-SQL-ABEND                                                  00428399
165000*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.00428499
165100******************************************************************00428599
165200 9100-SQL-ABEND.                                                  00428699
165300     DISPLAY '** ABEND     **'.                                   00428799
165400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        00428899
165500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              00428999
165600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               00429099
165700                                                                  00429199
165800******************************************************************00429299
165900* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     00429399
166000* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      00429499
166100******************************************************************00429599
166200     COPY DPPD004.                                                00429699
166300                                                                  00429799
166400     SET AC-DB2-ERROR TO TRUE.                                    00429899
166500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         00429999
166600                                                                  00430099
166700******************************************************************00430199
166800* 9999-ABEND                                                      00430299
166900*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  00430399
167000******************************************************************00430499
167100 9999-ABEND.                                                      00430599
167200     DISPLAY '** ABEND           **'.                             00430699
167300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  00430799
167400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        00430899
167500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       00430999
167600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       00431099
167700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         00440097
