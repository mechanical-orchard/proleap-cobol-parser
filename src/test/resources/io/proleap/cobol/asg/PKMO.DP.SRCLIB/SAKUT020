000100*----------------------------------------------------------       00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*----------------------------------------------------------       00030099
000400 PROGRAM-ID.    SAKUT020.                                         00040099
000500 AUTHOR.        SCOTT BARTELT                                     00050099
000600 DATE-WRITTEN.  DECEMBER, 2001.                                   00060099
000700                                                                  00070099
000800*----------------------------------------------------------       00080099
000900* THIS CREATES THE MISSED MARKUP AND MARKDOWN ACTIVITY            00090099
001000* DEPT/CLASS SUMMARY REPORT FOR EVEN EXCHANGES.                   00100099
001300*----------------------------------------------------------       00110099
001400*----------------------------------------------------------       00120099
001410* HISTORY LOG:                                                    00130099
001420*                                                                 00140099
001500* DATE: 04/20/12                                                  00150099
001600* WR/IR#:24719                                                    00160099
001700* PROGRAMMER: ROB SWAGER                                          00170099
001800* DESCRIPTION: RECOMPILE TO BRING IN CHANGED COPYBOOK MLRD017     00180099
003194*----------------------------------------------------------       00190099
003195 ENVIRONMENT DIVISION.                                            00200099
003196*----------------------------------------------------------       00210099
003197 CONFIGURATION SECTION.                                           00220099
003198 SOURCE-COMPUTER. IBM-3090.                                       00230099
003199 OBJECT-COMPUTER. IBM-3090.                                       00240099
003200                                                                  00250099
003300 INPUT-OUTPUT SECTION.                                            00260099
003400                                                                  00270099
003500 FILE-CONTROL.                                                    00280099
003600                                                                  00290099
003700     SELECT POS-MKUP-MKDN-FILE                                    00300099
003800       FILE STATUS IS SC-POS-MKUP-MKDN-FILE-STATUS                00310099
003900       ASSIGN TO INP01.                                           00320099
004000                                                                  00330099
004100     SELECT POS-DATE-FILE                                         00340099
004200       FILE STATUS IS SC-POS-DATE-FILE-STATUS                     00350099
004300       ASSIGN TO INP02.                                           00360099
004400                                                                  00370099
004860     SELECT RPT-MISSED-MKUP-MKDWN-ACT                             00380099
004870       ASSIGN TO RPT01.                                           00390099
004900                                                                  00400099
005000*----------------------------------------------------------       00410099
005100 DATA DIVISION.                                                   00420099
005200*----------------------------------------------------------       00430099
005300 FILE SECTION.                                                    00440099
005400                                                                  00450099
006801 FD  POS-MKUP-MKDN-FILE                                           00460099
006802     RECORDING MODE IS F                                          00470099
006803     BLOCK CONTAINS 0 RECORDS                                     00480099
006804     LABEL RECORDS ARE STANDARD.                                  00490099
006805 01  POS-MKUP-MKDN-REC                      PIC  X(200).          00500099
006894                                                                  00510099
006895 FD  POS-DATE-FILE                                                00520099
006896     RECORDING MODE IS F                                          00530099
006897     LABEL RECORDS ARE STANDARD                                   00540099
006898     RECORD CONTAINS 80 CHARACTERS                                00550099
006899     DATA RECORD IS POS-DATE-RECORD.                              00560099
006900 01  POS-DATE-RECORD                        PIC  X(080).          00570099
006910                                                                  00580099
007000 FD  RPT-MISSED-MKUP-MKDWN-ACT                                    00590099
008302     RECORDING MODE IS F                                          00600099
008303     BLOCK CONTAINS 0 RECORDS                                     00610099
008304     LABEL RECORDS ARE STANDARD.                                  00620099
008305 01  RPT-MISSED-MKUP-MKDWN-ACT-REC          PIC  X(132).          00630099
008306                                                                  00640099
008307*----------------------------------------------------------       00650099
008400 WORKING-STORAGE SECTION.                                         00660099
008401*----------------------------------------------------------       00670099
008403 01  ABEND-CODE                             PIC S9(004)           00680099
008404                                             VALUE +0             00690099
008405                                             COMP.                00700099
008407                                                                  00710099
008408*---------------------------------------------                    00720099
008409* RECORD LAYOUT FOR INPUT DATE CARD                               00730099
008410* (POS DATE)                                                      00740099
008420*---------------------------------------------                    00750099
008430 01  CC-POS-DATE-CARD.                                            00760099
008440   05  CC-POS-DATE-CARD-DISPLAY.                                  00770099
008450     10  CC-CONTROL-NAME                    PIC  X(014)           00780099
008460                                             VALUE SPACES.        00790099
008470       88  CC-VALID-CONTROL-NAME                                  00800099
008480             VALUE 'P.O.S. DATE = '.                              00810099
008490     10  CC-POS-DATE-MMDDYY                 PIC  9(006)           00820099
008500                                             VALUE ZEROES.        00830099
008501     10  FILLER                                                   00840099
008502        REDEFINES CC-POS-DATE-MMDDYY.                             00850099
008503       15  CC-POS-DATE-MM                   PIC  9(002).          00850199
008504       15  CC-POS-DATE-DD                   PIC  9(002).          00850299
008505       15  CC-POS-DATE-YY                   PIC  9(002).          00850399
008506   05  FILLER                               PIC  X(060)           00850499
008507                                             VALUE SPACES.        00850599
008508                                                                  00850699
008510*---------------------------------------------                    00850799
008520* PC- PROGRAM CONSTANTS                                           00850899
008530*---------------------------------------------                    00850999
008531 01  PC-PROGRAM-CONSTANTS.                                        00851099
008532   05  PC-PROGRAM-NAME                      PIC  X(008)           00852099
008533        VALUE 'SAKUT020'.                                         00853099
008534   05  PC-ALL                               PIC  X(003)           00853199
008535                                             VALUE 'ALL'.         00853299
008562                                                                  00853399
008564*---------------------------------------------                    00853499
008565* PS- PROGRAM SWITCHES                                            00853599
008566*---------------------------------------------                    00853699
008568 01  PS-PROGRAM-SWITCHES.                                         00853799
008569   05  PS-CONTINUE-PROCESSING-SW            PIC  X(001).          00853899
008570     88  PS-CONTINUE-PROCESSING              VALUE 'Y'.           00853999
008571     88  PS-END-PROCESSING                   VALUE 'N'.           00854099
008572                                                                  00855099
008573*---------------------------------------------                    00856099
008574* PV- PROGRAM WORKING VARIABLES                                   00857099
008575*---------------------------------------------                    00857199
008576 01  PV-PROGRAM-VARIABLES.                                        00857299
008577   05  PV-CC-GREG-CC-FMT-DATE               PIC  X(010).          00857399
008578   05  PV-CC-FISCAL-ACCT-MONTH              PIC  X(002).          00857499
008579   05  PV-CC-FISCAL-FP-ISO-FMT              PIC  X(010).          00857599
008580   05  PV-CC-PREV-FISCAL-MONTH-NAME         PIC  X(009).          00857699
008581   05  PV-CPU-DATE.                                               00857799
008582     10  PV-CPU-DATE-YY                     PIC  9(002)           00857899
008583                                             VALUE ZEROES.        00857999
008584     10  PV-CPU-DATE-MM                     PIC  9(002)           00858099
008585                                             VALUE ZEROES.        00858199
008586     10  PV-CPU-DATE-DD                     PIC  9(002)           00858299
008587                                             VALUE ZEROES.        00858399
008588   05  PV-HOLDING-FIELDS.                                         00858499
008589     10  PV-DEPT-HOLD                       PIC  9(003)           00858599
008590                                             VALUE ZEROES.        00858699
008591     10  PV-CLASS-HOLD                      PIC  9(002)           00858799
008592                                             VALUE ZEROES.        00858899
008593     10  PV-ACCT-MONTH-HOLD                 PIC  X(002)           00858999
008594                                             VALUE SPACES.        00859099
008595   05  PV-PAGE-COUNT                        PIC S9(004)           00859199
008596                                             VALUE +0             00859299
008600                                             COMP.                00859399
008643   05  PV-LINE-MISSED-AMT                   PIC S9(009)V99        00859499
008644                                             VALUE ZEROES         00859599
008645                                             COMP-3.              00859699
008646   05  PV-CORPORATE-TOTAL-FIELDS.                                 00859799
008648     10  PV-CORP-TOT-MISSED-MD-AMT          PIC S9(009)V99        00859899
008649                                             VALUE ZEROES         00859999
008650                                             COMP-3.              00860099
008652     10  PV-CORP-TOT-MISSED-MDC-AMT         PIC S9(009)V99        00861099
008653                                             VALUE ZEROES         00862099
008654                                             COMP-3.              00863099
008656     10  PV-CORP-TOT-MISSED-MU-AMT          PIC S9(009)V99        00864099
008657                                             VALUE ZEROES         00865099
008658                                             COMP-3.              00865199
008659     10  PV-CORP-TOT-NET-AMT                PIC S9(009)V99        00865299
008661                                             VALUE ZEROES         00865399
008662                                             COMP-3.              00865499
008663   05  PV-DEPT-TOTAL-FIELDS.                                      00865599
008664     10  PV-DEPT-TOT-MISSED-MD-AMT          PIC S9(009)V99        00865699
008666                                             VALUE ZEROES         00865799
008667                                             COMP-3.              00865899
008668     10  PV-DEPT-TOT-MISSED-MDC-AMT         PIC S9(009)V99        00865999
008670                                             VALUE ZEROES         00866099
008671                                             COMP-3.              00867099
008672     10  PV-DEPT-TOT-MISSED-MU-AMT          PIC S9(009)V99        00867199
008674                                             VALUE ZEROES         00867299
008675                                             COMP-3.              00867399
008677     10  PV-DEPT-TOT-NET-AMT                PIC S9(009)V99        00867499
008678                                             VALUE ZEROES         00867599
008679                                             COMP-3.              00867699
008680   05  PV-DEPT-CLS-TOTAL-FIELDS.                                  00867799
008682     10  PV-DEPT-CLS-TOT-MISSED-MD-AMT      PIC S9(009)V99        00867899
008683                                             VALUE ZEROES         00867999
008684                                             COMP-3.              00868099
008685     10  PV-DEPT-CLS-TOT-MISSED-MDC-AMT     PIC S9(009)V99        00868199
008687                                             VALUE ZEROES         00868299
008688                                             COMP-3.              00868399
008689     10  PV-DEPT-CLS-TOT-MISSED-MU-AMT      PIC S9(009)V99        00868499
008691                                             VALUE ZEROES         00868599
008692                                             COMP-3.              00868699
008693     10  PV-DEPT-CLS-TOT-NET-AMT            PIC S9(009)V99        00868799
008695                                             VALUE ZEROES         00868899
008696                                             COMP-3.              00868999
008697                                                                  00869099
008698*---------------------------------------------                    00869199
008699* PV-RPT- VARIABLES                                               00869299
008700*---------------------------------------------                    00869399
008701 01  PV-RPT-VARIABLES.                                            00869499
008715   05  PV-RPT-CURRENT-TIME.                                       00869599
008716     10  PV-RPT-CURRENT-HOUR                PIC  9(002)           00869699
008717                                             VALUE ZEROES.        00869799
008718     10  PV-RPT-CURRENT-MINUTE              PIC  9(002)           00869899
008719                                             VALUE ZEROES.        00869999
008720     10  FILLER                             PIC  9(004)           00870099
008721                                             VALUE ZEROES.        00871099
008722   05  PV-RPT-HEADING-LINE-1.                                     00872099
008723     10  FILLER                             PIC  X(025)           00872199
008724                                             VALUE SPACES.        00872299
008725     10  FILLER                             PIC  X(044)           00872399
008726           VALUE 'DEPARTMENT/CLASS SUMMARY OF MISSED MARKDOWN '.  00872499
008727     10  FILLER                             PIC  X(031)           00872599
008728           VALUE 'ACTIVITY ON EVEN EXCHANGES FOR '.               00872699
008729     10  PV-RPT-HEAD-DATE                   PIC  X(010).          00872799
008730     10  FILLER                             PIC  X(022)           00872899
008731                                             VALUE SPACES.        00872999
008740   05  PV-RPT-COL-HEADING-LINE-1.                                 00873099
008741     10  FILLER                             PIC  X(036)           00874099
008742                                             VALUE SPACES.        00874199
008743     10  FILLER                             PIC  X(006)           00874299
008744           VALUE 'MISSED'.                                        00874399
008745     10  FILLER                             PIC  X(016)           00874499
008746                                             VALUE SPACES.        00874599
008747     10  FILLER                             PIC  X(006)           00874699
008748           VALUE 'MISSED'.                                        00874799
008749     10  FILLER                             PIC  X(016)           00874899
008750                                             VALUE SPACES.        00874999
008751     10  FILLER                             PIC  X(006)           00875099
008752           VALUE 'MISSED'.                                        00875199
008753     10  FILLER                             PIC  X(046)           00875299
008754                                             VALUE SPACES.        00875399
008755   05  PV-RPT-COL-HEADING-LINE-2.                                 00875499
008756     10  FILLER                             PIC  X(035)           00875599
008757                                             VALUE SPACES.        00875699
008758     10  FILLER                             PIC  X(009)           00875799
008759           VALUE 'MARKDOWNS'.                                     00875899
008760     10  FILLER                             PIC  X(009)           00875999
008761                                             VALUE SPACES.        00876099
008762     10  FILLER                             PIC  X(016)           00876199
008763           VALUE 'MARKDOWN CANCELS'.                              00876299
008764     10  FILLER                             PIC  X(011)           00876399
008765                                             VALUE SPACES.        00876499
008766     10  FILLER                             PIC  X(007)           00876599
008767           VALUE 'MARKUPS'.                                       00876699
008768     10  FILLER                             PIC  X(017)           00876799
008769                                             VALUE SPACES.        00876899
008770     10  FILLER                             PIC  X(003)           00876999
008771           VALUE 'NET'.                                           00877099
008772     10  FILLER                             PIC  X(025)           00877199
008773                                             VALUE SPACES.        00877299
008774   05  PV-RPT-TOTAL-LINE.                                         00877399
008775     10  FILLER                             PIC  X(15)            00877499
008776                                             VALUE SPACES.        00877599
008777     10  PV-PRT-DEPT-NBR                    PIC  X(03)            00877699
008778                                             VALUE SPACES.        00877799
008779     10  PV-PRT-CLASS-NBR                   PIC  X(02)            00877899
008780                                             VALUE SPACES.        00877999
008781     10  FILLER                             PIC  X(016)           00878099
008782                                             VALUE SPACES.        00878199
008783     10  PV-PRT-TOT-MISSED-MD-AMT                                 00878299
008784           PIC Z,ZZZ,ZZ9.99-.                                     00878399
008785     10  FILLER                             PIC  X(009)           00878499
008786                                             VALUE SPACES.        00878599
008787     10  PV-PRT-TOT-MISSED-MDC-AMT                                00878699
008788           PIC Z,ZZZ,ZZ9.99-.                                     00878799
008789     10  FILLER                             PIC  X(009)           00878899
008790                                             VALUE SPACES.        00878999
008791     10  PV-PRT-TOT-MISSED-MU-AMT                                 00879099
008792           PIC Z,ZZZ,ZZ9.99-.                                     00879199
008793     10  FILLER                             PIC  X(009)           00879299
008794                                             VALUE SPACES.        00879399
008795     10  PV-PRT-TOT-NET-AMT                                       00879499
008796           PIC Z,ZZZ,ZZ9.99-.                                     00879599
008797     10  FILLER                             PIC  X(017)           00879699
008798                                             VALUE SPACES.        00879799
008799                                                                  00879899
008800*---------------------------------------------                    00879999
008801* SC- FILE STATUSES                                               00880099
008802*---------------------------------------------                    00880199
008803 01  SC-FILE-STATUS-CODES.                                        00880299
008804   05  SC-POS-MKUP-MKDN-FILE-STATUS         PIC  X(002)           00880399
008805                                             VALUE SPACES.        00880499
008806     88  SC-POS-MKUP-MKDN-FILE-OK            VALUE '00'.          00880599
008807     88  SC-POS-MKUP-MKDN-FILE-EOF           VALUE '10'.          00880699
008808   05  SC-POS-DATE-FILE-STATUS              PIC  X(002)           00880799
008809                                             VALUE SPACES.        00880899
008810     88  SC-POS-DATE-STATUS-OK               VALUE '00'.          00880999
008811                                                                  00881099
008812*---------------------------------------------                    00881199
008813* MERCHANDISE LEDGER MARKDOWN/MARKON RECORD                       00881299
008814* LAYOUT.                                                         00881399
008815*---------------------------------------------                    00881499
008816     COPY MLRD017.                                                00881599
008817                                                                  00881699
008818*---------------------------------------------                    00881799
008819* KOHLS STANDARD 132 BYTE REPORT LAYOUT.                          00881899
008820*---------------------------------------------                    00881999
008830     COPY DPWS132O.                                               00882099
008900                                                                  00883099
009000*---------------------------------------------                    00884099
009100* KOHLS DATE ROUTINE COPY MEMBERS.                                00885099
009200*---------------------------------------------                    00886099
009300     COPY DPWS500.                                                00887099
009400                                                                  00888099
042900*----------------------------------------------------------       00889099
043000 PROCEDURE DIVISION.                                              00890099
043100*----------------------------------------------------------       00900099
043200 0000-MAINLINE.                                                   00910099
043300                                                                  00920099
043301     PERFORM 1000-INITIALIZE.                                     00930099
043302                                                                  00940099
043305     PERFORM 2000-CREATE-MKUP-MKDWN-REPORT                        00950099
043306       UNTIL PS-END-PROCESSING.                                   00960099
043307                                                                  00970099
043308     PERFORM 9999-CLEAN-UP.                                       00980099
043309                                                                  00990099
044100     GOBACK.                                                      01000099
044200                                                                  01010099
044300*0000-EXIT.                                                       01020099
044400 EJECT                                                            01030099
044401                                                                  01040099
044402*----------------------------------------------------------       01050099
044403* 1000-INITIALIZE.                                                01060099
044406*----------------------------------------------------------       01070099
044407 1000-INITIALIZE.                                                 01080099
044408                                                                  01090099
044430     OPEN INPUT  POS-MKUP-MKDN-FILE                               01100099
044440                 POS-DATE-FILE                                    01110099
044462          OUTPUT RPT-MISSED-MKUP-MKDWN-ACT.                       01120099
044479                                                                  01130099
044484     IF NOT SC-POS-MKUP-MKDN-FILE-OK                              01140099
044485       DISPLAY ' '                                                01150099
044486       DISPLAY '** ABEND     **'                                  01160099
044487       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01170099
044488       DISPLAY '** PARAGRAPH **'                                  01180099
044489        '= 1000-INITIALIZE'                                       01190099
044490       DISPLAY '** POS MARKUP/MARKDOWN FILE OPEN ERROR'           01200099
044491       DISPLAY '** FILE STATUS IS = '                             01210099
044492        SC-POS-MKUP-MKDN-FILE-STATUS                              01220099
044493       MOVE +4005 TO ABEND-CODE                                   01230099
044494       CALL 'ILBOABN0' USING ABEND-CODE                           01240099
044495     END-IF.                                                      01250099
044496     IF NOT SC-POS-DATE-STATUS-OK                                 01260099
044497       DISPLAY ' '                                                01270099
044498       DISPLAY '** ABEND     **'                                  01280099
044499       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01290099
044500       DISPLAY '** PARAGRAPH **'                                  01300099
044510        '= 1000-INITIALIZE'                                       01310099
044520       DISPLAY '** POS CONTROL CARD FILE OPEN ERROR'              01320099
044530       DISPLAY '** FILE STATUS IS = '                             01330099
044540        SC-POS-DATE-FILE-STATUS                                   01340099
044541       MOVE +4005 TO ABEND-CODE                                   01350099
044542       CALL 'ILBOABN0' USING ABEND-CODE                           01360099
044543     END-IF.                                                      01370099
044544                                                                  01380099
044545     PERFORM 1100-RET-CONTROL-CARD-DATA.                          01390099
044546                                                                  01400099
044588*** PERFORM PRIMING READ                                          01410099
044589     PERFORM 8010-READ-MKUP-MKDN-FILE.                            01420099
044590     MOVE ML017-PC-DEPT-NBR  TO PV-DEPT-HOLD.                     01430099
044591     MOVE ML017-PC-CLASS-NBR TO PV-CLASS-HOLD.                    01440099
044592     MOVE ML017-PC-KOHLS-MM  TO PV-ACCT-MONTH-HOLD.               01450099
044593                                                                  01460099
044596     PERFORM 2050-NEW-PAGE.                                       01470099
044597                                                                  01480099
044598     SET PS-CONTINUE-PROCESSING TO TRUE.                          01490099
044599                                                                  01500099
044600*1000-EXIT.                                                       01510099
044601 EJECT                                                            01520099
044602                                                                  01530099
044603*----------------------------------------------------------       01540099
044604* 1100-RET-CONTROL-CARD-DATA.                                     01550099
044605*----------------------------------------------------------       01560099
044606 1100-RET-CONTROL-CARD-DATA.                                      01570099
044607                                                                  01580099
044608     READ POS-DATE-FILE                                           01590099
044609       INTO CC-POS-DATE-CARD                                      01600099
044610         AT END                                                   01610099
044611           DISPLAY ' '                                            01620099
044612           DISPLAY '** ABEND     **'                              01630099
044613           DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME          01640099
044614           DISPLAY '** PARAGRAPH **'                              01650099
044615            '= 1100-RET-CONTROL-CARD-DATA'                        01660099
044616           DISPLAY '** CONTROL CARD DATE RECORD IS MISSING'       01670099
044617           MOVE +4003 TO ABEND-CODE                               01680099
044618           CALL 'ILBOABN0' USING ABEND-CODE                       01690099
044619     END-READ.                                                    01700099
044620                                                                  01710099
044621*** CAPTURE DATA ON THE FISCAL MONTH OF THE CONTROL CARD          01720099
044622*** DATE                                                          01730099
044623     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         01740099
044624                                                                  01750099
044625     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       01760099
044626     SET DPG52-LK-DTE-GREG         TO TRUE.                       01770099
044627                                                                  01780099
044628     MOVE CC-POS-DATE-MMDDYY TO DPG52-LK-DATE-INPUT.              01790099
044629                                                                  01800099
044630     CALL DP500-KOHLS-CALENDAR-ROUTINE                            01810099
044631       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 01820099
044632                                                                  01830099
044633     EVALUATE TRUE                                                01840099
044634       WHEN DPG54-NO-ERROR                                        01850099
044635         CONTINUE                                                 01860099
044636       WHEN OTHER                                                 01870099
044637         DISPLAY ' '                                              01880099
044638         DISPLAY '** ABEND     **'                                01890099
044639         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            01900099
044640         DISPLAY '** PARAGRAPH **'                                01910099
044641          '= 1100-RET-CONTROL-CARD-DATA'                          01920099
044642         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        01930099
044643         MOVE +4019 TO ABEND-CODE                                 01940099
044644         CALL 'ILBOABN0' USING ABEND-CODE                         01950099
044645     END-EVALUATE.                                                01960099
044646                                                                  01970099
044647     MOVE DPG55-GREG-CC-DATE-FMT  TO PV-CC-GREG-CC-FMT-DATE.      01980099
044648     MOVE DPG56-FISCAL-PERIOD-NBR TO PV-CC-FISCAL-ACCT-MONTH      01990099
044649     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              02000099
044650     TO PV-CC-FISCAL-FP-ISO-FMT.                                  02010099
044651                                                                  02020099
044652*** CAPTURE DATA ON THE PREVIOUS FISCAL MONTH IN RESPECT          02030099
044653*** TO THE CONTROL CARD DATE                                      02040099
044654     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         02050099
044655                                                                  02060099
044656     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       02070099
044657     SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       02080099
044658                                                                  02090099
044659     SET DPG51-DECREMENT-DATE TO TRUE.                            02100099
044660     MOVE 1 TO DPG51-INCR-DECR-DAYS-9.                            02110099
044661                                                                  02120099
044662     MOVE PV-CC-FISCAL-FP-ISO-FMT TO DPG52-LK-DATE-INPUT.         02130099
044663                                                                  02140099
044664     CALL DP500-KOHLS-CALENDAR-ROUTINE                            02150099
044665       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 02160099
044666                                                                  02170099
044667     EVALUATE TRUE                                                02180099
044668       WHEN DPG54-NO-ERROR                                        02190099
044669         CONTINUE                                                 02200099
044670       WHEN OTHER                                                 02210099
044671         DISPLAY ' '                                              02220099
044672         DISPLAY '** ABEND     **'                                02230099
044673         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            02240099
044674         DISPLAY '** PARAGRAPH **'                                02250099
044675          '= 1100-RET-CONTROL-CARD-DATA'                          02260099
044676         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        02270099
044677         MOVE +4019 TO ABEND-CODE                                 02280099
044678         CALL 'ILBOABN0' USING ABEND-CODE                         02290099
044679     END-EVALUATE.                                                02300099
044680                                                                  02310099
044681     MOVE DPG56-FISCAL-PERIOD-NAME                                02320099
044682      TO PV-CC-PREV-FISCAL-MONTH-NAME.                            02330099
044683                                                                  02340099
044684*1100-EXIT.                                                       02350099
044685 EJECT                                                            02360099
044686                                                                  02370099
044687*----------------------------------------------------------       02380099
044688* 2000-CREATE-MKUP-MKDWN-REPORT.                                  02390099
044689*----------------------------------------------------------       02400099
044690 2000-CREATE-MKUP-MKDWN-REPORT.                                   02410099
044691                                                                  02420099
044692     IF ML017-PC-KOHLS-MM NOT = PV-ACCT-MONTH-HOLD                02430099
044693      AND SC-POS-MKUP-MKDN-FILE-OK                                02440099
044694        PERFORM 2020-WRITE-CLASS-DET                              02450099
044695        MOVE ZEROES TO PV-DEPT-CLS-TOT-MISSED-MD-AMT              02460099
044696                       PV-DEPT-CLS-TOT-MISSED-MDC-AMT             02470099
044697                       PV-DEPT-CLS-TOT-MISSED-MU-AMT              02480099
044698                       PV-DEPT-CLS-TOT-NET-AMT                    02490099
044699        MOVE ML017-PC-CLASS-NBR TO PV-CLASS-HOLD                  02500099
044700                                                                  02510099
044701        PERFORM 2030-WRITE-DEPT-DET                               02520099
044702        MOVE ZEROES TO PV-DEPT-TOT-MISSED-MD-AMT                  02530099
044703                       PV-DEPT-TOT-MISSED-MDC-AMT                 02540099
044704                       PV-DEPT-TOT-MISSED-MU-AMT                  02550099
044705                       PV-DEPT-TOT-NET-AMT                        02560099
044706                                                                  02570099
044707        PERFORM 2050-NEW-PAGE                                     02580099
044708        PERFORM 2040-WRITE-CORP-DET                               02590099
044709        MOVE ZEROES TO PV-CORP-TOT-MISSED-MD-AMT                  02600099
044710                       PV-CORP-TOT-MISSED-MDC-AMT                 02610099
044711                       PV-CORP-TOT-MISSED-MU-AMT                  02620099
044712                       PV-CORP-TOT-NET-AMT                        02630099
044713                                                                  02640099
044714        MOVE ML017-PC-DEPT-NBR  TO PV-DEPT-HOLD                   02650099
044715        MOVE ML017-PC-CLASS-NBR TO PV-CLASS-HOLD                  02660099
044716        MOVE ML017-PC-KOHLS-MM TO PV-ACCT-MONTH-HOLD              02670099
044717        PERFORM 2050-NEW-PAGE                                     02680099
044718     END-IF.                                                      02690099
044719                                                                  02700099
044720     IF ( (ML017-PC-DEPT-NBR  = PV-DEPT-HOLD                      02710099
044721            AND ML017-PC-CLASS-NBR NOT = PV-CLASS-HOLD)           02720099
044722       OR (ML017-PC-DEPT-NBR NOT = PV-DEPT-HOLD                   02730099
044723            AND ML017-PC-CLASS-NBR = PV-CLASS-HOLD)               02740099
044724       OR (ML017-PC-DEPT-NBR NOT = PV-DEPT-HOLD                   02750099
044725            AND ML017-PC-CLASS-NBR NOT = PV-CLASS-HOLD)           02760099
044726       OR (SC-POS-MKUP-MKDN-FILE-EOF)  )                          02770099
044727         PERFORM 2020-WRITE-CLASS-DET                             02780099
044728                                                                  02790099
044729         MOVE ZEROES TO PV-DEPT-CLS-TOT-MISSED-MD-AMT             02800099
044730                        PV-DEPT-CLS-TOT-MISSED-MDC-AMT            02810099
044731                        PV-DEPT-CLS-TOT-MISSED-MU-AMT             02820099
044732                        PV-DEPT-CLS-TOT-NET-AMT                   02830099
044733                                                                  02840099
044734         MOVE ML017-PC-CLASS-NBR TO PV-CLASS-HOLD                 02850099
044735     END-IF.                                                      02860099
044736                                                                  02870099
044737     IF ML017-PC-DEPT-NBR NOT = PV-DEPT-HOLD                      02880099
044738       PERFORM 2030-WRITE-DEPT-DET                                02890099
044739                                                                  02900099
044740       MOVE ZEROES TO PV-DEPT-TOT-MISSED-MD-AMT                   02910099
044741                      PV-DEPT-TOT-MISSED-MDC-AMT                  02920099
044742                      PV-DEPT-TOT-MISSED-MU-AMT                   02930099
044743                      PV-DEPT-TOT-NET-AMT                         02940099
044744                                                                  02950099
044745       MOVE ML017-PC-DEPT-NBR  TO PV-DEPT-HOLD                    02960099
044746       MOVE ML017-PC-CLASS-NBR TO PV-CLASS-HOLD                   02970099
044747       MOVE ML017-PC-KOHLS-MM TO PV-ACCT-MONTH-HOLD               02980099
044748                                                                  02990099
044749       PERFORM 2050-NEW-PAGE                                      03000099
044750     END-IF.                                                      03010099
044751                                                                  03020099
044752     PERFORM 2010-COMPUTE-TOTALS.                                 03030099
044753                                                                  03040099
044754     IF SC-POS-MKUP-MKDN-FILE-EOF                                 03050099
044755       SET PS-END-PROCESSING TO TRUE                              03060099
044756       PERFORM 2050-NEW-PAGE                                      03070099
044757       PERFORM 2040-WRITE-CORP-DET                                03080099
044758     END-IF.                                                      03090099
044759                                                                  03100099
044760     IF SC-POS-MKUP-MKDN-FILE-OK                                  03110099
044761       PERFORM 8010-READ-MKUP-MKDN-FILE                           03120099
044762       IF SC-POS-MKUP-MKDN-FILE-EOF                               03130099
044763         MOVE ZEROES TO ML017-PC-DEPT-NBR                         03140099
044764                        ML017-PC-CLASS-NBR                        03150099
044765       END-IF                                                     03160099
044766     END-IF.                                                      03170099
044767                                                                  03180099
044768*2000-EXIT.                                                       03190099
044770 EJECT                                                            03200099
044800                                                                  03210099
044865*----------------------------------------------------------       03220099
044866* 2010-COMPUTE-TOTALS.                                            03230099
044867*----------------------------------------------------------       03240099
044880 2010-COMPUTE-TOTALS.                                             03250099
044881                                                                  03260099
044882     IF ML017-MKDOWN AND ML017-MARKDOWN                           03270099
044883       COMPUTE PV-LINE-MISSED-AMT =                               03280099
044884                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      03290099
044885                    * ML017-PC-TOT-DOC-QTY                        03300099
044886       COMPUTE PV-CORP-TOT-MISSED-MD-AMT =                        03310099
044887                 PV-CORP-TOT-MISSED-MD-AMT                        03320099
044888                   + PV-LINE-MISSED-AMT                           03330099
044889       COMPUTE PV-DEPT-TOT-MISSED-MD-AMT =                        03340099
044890                 PV-DEPT-TOT-MISSED-MD-AMT                        03350099
044891                   + PV-LINE-MISSED-AMT                           03360099
044892       COMPUTE PV-DEPT-CLS-TOT-MISSED-MD-AMT =                    03370099
044893                 PV-DEPT-CLS-TOT-MISSED-MD-AMT                    03380099
044894                   + PV-LINE-MISSED-AMT                           03390099
044895     END-IF.                                                      03400099
044896                                                                  03410099
044897     IF ML017-MKDOWN AND ML017-MARKDOWN-CANCEL                    03420099
044898       COMPUTE PV-LINE-MISSED-AMT =                               03430099
044899                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      03440099
044900                    * ML017-PC-TOT-DOC-QTY                        03450099
044901       COMPUTE PV-CORP-TOT-MISSED-MDC-AMT =                       03460099
044902                 PV-CORP-TOT-MISSED-MDC-AMT                       03470099
044903                   + PV-LINE-MISSED-AMT                           03480099
044904       COMPUTE PV-DEPT-TOT-MISSED-MDC-AMT =                       03490099
044905                 PV-DEPT-TOT-MISSED-MDC-AMT                       03500099
044906                   + PV-LINE-MISSED-AMT                           03510099
044907       COMPUTE PV-DEPT-CLS-TOT-MISSED-MDC-AMT =                   03520099
044908                 PV-DEPT-CLS-TOT-MISSED-MDC-AMT                   03530099
044909                   + PV-LINE-MISSED-AMT                           03540099
044910     END-IF.                                                      03550099
044911                                                                  03560099
044912     IF ML017-MKUP AND ML017-MARKUP                               03570099
044913       COMPUTE PV-LINE-MISSED-AMT =                               03580099
044914                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      03590099
044915                    * ML017-PC-TOT-DOC-QTY                        03600099
044916       COMPUTE PV-CORP-TOT-MISSED-MU-AMT =                        03610099
044917                 PV-CORP-TOT-MISSED-MU-AMT                        03620099
044918                   + PV-LINE-MISSED-AMT                           03630099
044919       COMPUTE PV-DEPT-TOT-MISSED-MU-AMT =                        03640099
044920                 PV-DEPT-TOT-MISSED-MU-AMT                        03650099
044921                   + PV-LINE-MISSED-AMT                           03660099
044922       COMPUTE PV-DEPT-CLS-TOT-MISSED-MU-AMT =                    03670099
044923                 PV-DEPT-CLS-TOT-MISSED-MU-AMT                    03680099
044924                   + PV-LINE-MISSED-AMT                           03690099
044925     END-IF.                                                      03700099
044926                                                                  03710099
044927     COMPUTE PV-CORP-TOT-NET-AMT =                                03720099
044928               PV-CORP-TOT-MISSED-MD-AMT                          03730099
044929                 + PV-CORP-TOT-MISSED-MDC-AMT                     03740099
044930                 + PV-CORP-TOT-MISSED-MU-AMT.                     03750099
044931     COMPUTE PV-DEPT-TOT-NET-AMT =                                03760099
044932               PV-DEPT-TOT-MISSED-MD-AMT                          03770099
044933                 + PV-DEPT-TOT-MISSED-MDC-AMT                     03780099
044934                 + PV-DEPT-TOT-MISSED-MU-AMT.                     03790099
044935     COMPUTE PV-DEPT-CLS-TOT-NET-AMT =                            03800099
044936               PV-DEPT-CLS-TOT-MISSED-MD-AMT                      03810099
044937                 + PV-DEPT-CLS-TOT-MISSED-MDC-AMT                 03820099
044938                 + PV-DEPT-CLS-TOT-MISSED-MU-AMT.                 03830099
044939                                                                  03840099
044940*2010-EXIT.                                                       03850099
044941 EJECT                                                            03860099
044942                                                                  03870099
044943*----------------------------------------------------------       03880099
044944* 2020-WRITE-CLASS-DET.                                           03890099
044945*----------------------------------------------------------       03900099
044950 2020-WRITE-CLASS-DET.                                            03910099
044984                                                                  03920099
044985     MOVE PV-DEPT-HOLD  TO PV-PRT-DEPT-NBR.                       03930099
044987     MOVE PV-CLASS-HOLD TO PV-PRT-CLASS-NBR.                      03940099
044989     MOVE PV-DEPT-CLS-TOT-MISSED-MD-AMT                           03950099
044990       TO PV-PRT-TOT-MISSED-MD-AMT.                               03960099
044991     MOVE PV-DEPT-CLS-TOT-MISSED-MDC-AMT                          03970099
044992       TO PV-PRT-TOT-MISSED-MDC-AMT.                              03980099
044993     MOVE PV-DEPT-CLS-TOT-MISSED-MU-AMT                           03990099
044994       TO PV-PRT-TOT-MISSED-MU-AMT.                               04000099
044995     MOVE PV-DEPT-CLS-TOT-NET-AMT                                 04010099
044996       TO PV-PRT-TOT-NET-AMT.                                     04020099
044997                                                                  04030099
044998     MOVE PV-RPT-TOTAL-LINE                                       04040099
044999       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04050099
045000     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04060099
045001       AFTER ADVANCING 1 LINE.                                    04070099
045002                                                                  04080099
045003*2020-EXIT.                                                       04090099
045004 EJECT                                                            04100099
045005                                                                  04110099
045006*----------------------------------------------------------       04120099
045007* 2030-WRITE-DEPT-DET.                                            04130099
045008*----------------------------------------------------------       04140099
045009 2030-WRITE-DEPT-DET.                                             04150099
045010                                                                  04160099
045044     MOVE PV-DEPT-HOLD TO PV-PRT-DEPT-NBR.                        04170099
045045     MOVE SPACES       TO PV-PRT-CLASS-NBR.                       04180099
045046     MOVE PV-DEPT-TOT-MISSED-MD-AMT                               04190099
045047       TO PV-PRT-TOT-MISSED-MD-AMT.                               04200099
045048     MOVE PV-DEPT-TOT-MISSED-MDC-AMT                              04210099
045049       TO PV-PRT-TOT-MISSED-MDC-AMT.                              04220099
045050     MOVE PV-DEPT-TOT-MISSED-MU-AMT                               04230099
045051       TO PV-PRT-TOT-MISSED-MU-AMT.                               04240099
045052     MOVE PV-DEPT-TOT-NET-AMT                                     04250099
045053       TO PV-PRT-TOT-NET-AMT.                                     04260099
045054                                                                  04270099
045055     MOVE PV-RPT-TOTAL-LINE                                       04280099
045056       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04290099
045057     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04300099
045058       AFTER ADVANCING 3 LINES.                                   04310099
045059                                                                  04320099
045060*2030-EXIT.                                                       04330099
045061 EJECT                                                            04340099
045062                                                                  04350099
045063*----------------------------------------------------------       04360099
045064* 2040-WRITE-CORP-DET.                                            04370099
045065*----------------------------------------------------------       04380099
045066 2040-WRITE-CORP-DET.                                             04390099
045067                                                                  04400099
045069     MOVE PC-ALL TO PV-PRT-DEPT-NBR.                              04410099
045102     MOVE SPACES TO PV-PRT-CLASS-NBR.                             04420099
045103     MOVE PV-CORP-TOT-MISSED-MD-AMT                               04430099
045104       TO PV-PRT-TOT-MISSED-MD-AMT.                               04440099
045105     MOVE PV-CORP-TOT-MISSED-MDC-AMT                              04450099
045106       TO PV-PRT-TOT-MISSED-MDC-AMT.                              04460099
045107     MOVE PV-CORP-TOT-MISSED-MU-AMT                               04470099
045108       TO PV-PRT-TOT-MISSED-MU-AMT.                               04480099
045109     MOVE PV-CORP-TOT-NET-AMT                                     04490099
045110       TO PV-PRT-TOT-NET-AMT.                                     04500099
045111                                                                  04510099
045112     MOVE PV-RPT-TOTAL-LINE                                       04511099
045113       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04511199
045114     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04511299
045115       AFTER ADVANCING 3 LINES.                                   04511399
045116                                                                  04511499
045117*2040-EXIT.                                                       04511599
045118 EJECT                                                            04511699
045119                                                                  04511799
045120*----------------------------------------------------------       04511899
045121* 2050-NEW-PAGE.                                                  04511999
045122*----------------------------------------------------------       04512099
045123 2050-NEW-PAGE.                                                   04512199
045124                                                                  04512299
045125     ACCEPT PV-CPU-DATE FROM DATE.                                04512399
045134     MOVE PV-CPU-DATE-YY TO DP132O-RUN-YEAR.                      04512499
045135     MOVE PV-CPU-DATE-MM TO DP132O-RUN-MONTH.                     04512599
045136     MOVE PV-CPU-DATE-DD TO DP132O-RUN-DAY.                       04512699
045137                                                                  04512799
045138     ACCEPT PV-RPT-CURRENT-TIME FROM TIME.                        04512899
045139     MOVE PV-RPT-CURRENT-HOUR   TO DP132O-RUN-HOUR.               04512999
045140     MOVE PV-RPT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.             04513099
045141                                                                  04514099
045142     MOVE PC-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.               04514199
045143     MOVE '1'               TO DP132O-REPORT-NUMBER.              04514299
045144     ADD +1                 TO PV-PAGE-COUNT.                     04514399
045145     MOVE PV-PAGE-COUNT     TO DP132O-PAGE-NUMBER.                04514499
045146                                                                  04514599
045147     MOVE DP132O-STANDRD-HEADER-132-COLS                          04514699
045148       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04514799
045149     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04514899
045150       AFTER ADVANCING PAGE.                                      04514999
045151                                                                  04515099
045152     IF PV-ACCT-MONTH-HOLD = PV-CC-FISCAL-ACCT-MONTH              04515199
045153      OR SC-POS-MKUP-MKDN-FILE-EOF                                04515299
045154        MOVE PV-CC-GREG-CC-FMT-DATE       TO PV-RPT-HEAD-DATE     04515399
045155     ELSE                                                         04515499
045156        MOVE PV-CC-PREV-FISCAL-MONTH-NAME TO PV-RPT-HEAD-DATE     04515599
045157     END-IF.                                                      04515699
045164     MOVE PV-RPT-HEADING-LINE-1                                   04515799
045165       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04515899
045166     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04515999
045167       AFTER ADVANCING 1 LINE.                                    04516099
045168                                                                  04516199
045169     MOVE PV-RPT-COL-HEADING-LINE-1                               04516299
045170       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04516399
045171     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04516499
045172       AFTER ADVANCING 2 LINES.                                   04516599
045173                                                                  04516699
045174     MOVE PV-RPT-COL-HEADING-LINE-2                               04516799
045175       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04516899
045176     WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                          04516999
045177       AFTER ADVANCING 1 LINE.                                    04517099
045178                                                                  04517199
045179*2050-EXIT.                                                       04517299
045180 EJECT                                                            04517399
045181                                                                  04517499
045182*----------------------------------------------------------       04517599
045183* 8010-READ-MKUP-MKDN-FILE.                                       04517699
045184*----------------------------------------------------------       04517799
045185 8010-READ-MKUP-MKDN-FILE.                                        04517899
045186                                                                  04517999
045187     MOVE SPACES TO ML017-PRICE-CHANGE-RECORD.                    04518099
045188                                                                  04518199
045189     READ POS-MKUP-MKDN-FILE                                      04518299
045190       INTO ML017-PRICE-CHANGE-RECORD.                            04518399
045191                                                                  04518499
045192     IF NOT SC-POS-MKUP-MKDN-FILE-OK                              04518599
045193      AND NOT SC-POS-MKUP-MKDN-FILE-EOF                           04518699
045194       DISPLAY ' '                                                04518799
045195       DISPLAY '** ABEND     **'                                  04518899
045196       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              04518999
045197       DISPLAY '** PARAGRAPH **'                                  04519099
045198        '= 8010-READ-MKUP-MKDN-FILE'                              04519199
045199       DISPLAY '** POS-MKUP-MKDN-FILE READ ERROR'                 04519299
045200       DISPLAY '** FILE STATUS IS = '                             04519399
045201        SC-POS-MKUP-MKDN-FILE-STATUS                              04519499
045202       MOVE +4002 TO ABEND-CODE                                   04519599
045203       CALL 'ILBOABN0' USING ABEND-CODE                           04519699
045204     END-IF.                                                      04519799
045205                                                                  04519899
045206*8010-EXIT.                                                       04519999
045207 EJECT                                                            04520099
045210                                                                  04521099
045220*----------------------------------------------------------       04522099
045231* 9999-CLEAN-UP.                                                  04523099
045240*----------------------------------------------------------       04524099
045300 9999-CLEAN-UP.                                                   04525099
045301                                                                  04526099
045310     CLOSE POS-MKUP-MKDN-FILE                                     04527099
045311           POS-DATE-FILE                                          04528099
045320           RPT-MISSED-MKUP-MKDWN-ACT.                             04529099
045330                                                                  04530099
045400*9999-EXIT.                                                       04540099
045500 EJECT                                                            04550099
