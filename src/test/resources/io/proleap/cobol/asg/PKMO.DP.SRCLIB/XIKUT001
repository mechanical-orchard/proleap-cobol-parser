000100*                                                                 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*                                                                 00030000
000400 PROGRAM-ID.    XIKUT001.                                         00040099
000500*                                                                 00050000
000600 AUTHOR.        LYNN MCCANN.                                      00060047
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  01/08/04.                                         00080047
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100***************************************************************** 00110000
001200** THIS PROGRAM WILL GENERATE A USER EXTRACT FILE FOR EAI      ** 00120047
001300** COMPLIANCE. THIS FILE WILL BE IMPORTED INTO OTHER DOMAINS   ** 00130047
001400** FOR USE BY THAT DOMAINS APPLICATIONS.                       ** 00140099
001500***************************************************************** 00150000
001600                                                                  00160099
001700 ENVIRONMENT DIVISION.                                            00170000
001800*                                                                 00180000
001900 CONFIGURATION SECTION.                                           00190000
002000*                                                                 00200000
002100 SOURCE-COMPUTER.  IBM-3090.                                      00210000
002200 OBJECT-COMPUTER.  IBM-3090.                                      00220000
002300*                                                                 00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500*                                                                 00250000
002600 FILE-CONTROL.                                                    00260000
002700     SELECT SORTED-BC-EMPINFO-FILE                                00270099
002800         ASSIGN TO INP01.                                         00280099
002900                                                                  00290054
003000     SELECT SORTED-USERID-DFLTPRTR-FILE                           00300054
003100         ASSIGN TO INP02.                                         00310099
003200                                                                  00320083
003300     SELECT SORTED-GROUP-DFLTPRTR-FILE                            00330083
003400         ASSIGN TO INP03.                                         00340099
003500                                                                  00350054
003600     SELECT OUTPUT-USERINFO-FILE                                  00360047
003700         ASSIGN TO OUT01.                                         00370099
003800                                                                  00380084
003900     SELECT OUTPUT-GROUPINFO-FILE                                 00390084
004000         ASSIGN TO OUT02.                                         00400099
004100                                                                  00410089
004200     SELECT OUTPUT-SYS-USR-FILE                                   00420094
004300         ASSIGN TO OUT03.                                         00430099
004400                                                                  00440097
004500     SELECT OUTPUT-USR-TYP-FILE                                   00450097
004600         ASSIGN TO OUT04.                                         00460099
004700                                                                  00470099
004800 DATA DIVISION.                                                   00480000
004900*                                                                 00490000
005000 FILE SECTION.                                                    00500000
005100*                                                                 00510047
005200 FD  SORTED-BC-EMPINFO-FILE                                       00520099
005210     RECORDING MODE IS F                                          00521099
005220     LABEL RECORDS ARE OMITTED                                    00522099
005230     BLOCK CONTAINS 0 RECORDS                                     00523099
005240     RECORD CONTAINS 740 CHARACTERS                               00524099
005250     DATA RECORD IS SORTED-BC-EMPINFO-RECORD.                     00525099
005260                                                                  00526099
005400 01  SORTED-BC-EMPINFO-RECORD    PIC  X(740).                     00540099
005500*                                                                 00550047
005600 FD  SORTED-USERID-DFLTPRTR-FILE                                  00560054
005610     RECORDING MODE IS F                                          00561099
005620     LABEL RECORDS ARE OMITTED                                    00562099
005630     BLOCK CONTAINS 0 RECORDS                                     00563099
005640     RECORD CONTAINS 80 CHARACTERS                                00564099
005650     DATA RECORD IS SORTED-USERID-DFLTPRTR-RECORD.                00565099
005700                                                                  00570099
005800 01  SORTED-USERID-DFLTPRTR-RECORD                                00580099
005810                                 PIC  X(80).                      00581099
005900*                                                                 00590083
006000 FD  SORTED-GROUP-DFLTPRTR-FILE                                   00600083
006010     RECORDING MODE IS F                                          00601099
006020     LABEL RECORDS ARE OMITTED                                    00602099
006030     BLOCK CONTAINS 0 RECORDS                                     00603099
006040     RECORD CONTAINS 80 CHARACTERS                                00604099
006050     DATA RECORD IS SORTED-GROUP-DFLTPRTR-RECORD.                 00605099
006060                                                                  00606099
006200 01  SORTED-GROUP-DFLTPRTR-RECORD                                 00620099
006210                                 PIC  X(80).                      00621099
006300*                                                                 00630087
006400 FD  OUTPUT-USERINFO-FILE                                         00640047
006500     RECORDING MODE IS F                                          00650047
006600     LABEL RECORDS ARE OMITTED                                    00660047
006700     BLOCK CONTAINS 0 RECORDS                                     00670047
006800     RECORD CONTAINS 150 CHARACTERS                               00680047
006900     DATA RECORD IS XI-USERINFO-RECORD.                           00690099
007000                                                                  00700047
007100 01  XI-USERINFO-RECORD          PIC  X(150).                     00710099
007200*                                                                 00720084
007300 FD  OUTPUT-GROUPINFO-FILE                                        00730084
007400     RECORDING MODE IS F                                          00740084
007500     LABEL RECORDS ARE OMITTED                                    00750084
007600     BLOCK CONTAINS 0 RECORDS                                     00760084
007700     RECORD CONTAINS 49 CHARACTERS                                00770099
007800     DATA RECORD IS XI-GROUPINFO-RECORD.                          00780099
007900                                                                  00790084
008000 01  XI-GROUPINFO-RECORD         PIC  X(49).                      00800099
008100*                                                                 00810087
008200 FD  OUTPUT-SYS-USR-FILE                                          00820095
008300     RECORDING MODE IS F                                          00830087
008400     LABEL RECORDS ARE OMITTED                                    00840087
008500     BLOCK CONTAINS 0 RECORDS                                     00850087
008600     RECORD CONTAINS 10 CHARACTERS                                00860099
008700     DATA RECORD IS XI-SYS-USR-RECORD.                            00870099
008800                                                                  00880087
008900 01  XI-SYS-USR-RECORD           PIC  X(10).                      00890099
009000*                                                                 00900097
009100 FD  OUTPUT-USR-TYP-FILE                                          00910097
009200     RECORDING MODE IS F                                          00920097
009300     LABEL RECORDS ARE OMITTED                                    00930097
009400     BLOCK CONTAINS 0 RECORDS                                     00940097
009500     RECORD CONTAINS 22 CHARACTERS                                00950099
009600     DATA RECORD IS XI-USR-TYP-RECORD.                            00960099
009700                                                                  00970097
009800 01  XI-USR-TYP-RECORD           PIC  X(22).                      00980099
009900*                                                                 00990000
010000                                                                  01000099
010100 WORKING-STORAGE SECTION.                                         01010000
010200*                                                                 01020012
010300* COPYBOOK FOR BC EMPINFO EXTRACT                                 01030099
010400     COPY BCRD002.                                                01040099
010410*                                                                 01041099
010420* COPYBOOK FOR USER INFO EXTRACT                                  01042099
010430     COPY XIRD001.                                                01043099
010500*                                                                 01050084
010600* COPYBOOK FOR GROUP INFO EXTRACT                                 01060084
010700     COPY XIRD002.                                                01070099
010800*                                                                 01080087
010900* COPYBOOK FOR SYS-USR                                            01090094
011000     COPY XIRD003.                                                01100099
011100*                                                                 01110097
011200* COPYBOOK FOR USR-TYP                                            01120097
011300     COPY XIRD004.                                                01130099
011400*                                                                 01140049
011500* LAYOUT FOR SORTED DFLTPRTR FILE                                 01150055
011600 01  XI-DFLTPRTR-RECORD.                                          01160099
011700     05  XI-ID                     PIC  X(08)  VALUE SPACES.      01170099
011800     05  FILLER                    PIC  X(01).                    01180055
011900     05  XI-NAME                   PIC  X(40)  VALUE SPACES.      01190099
012000     05  FILLER                    PIC  X(01).                    01200055
012100     05  XI-USER-OR-GROUP-IND      PIC  X(01)  VALUE SPACES.      01210099
012200     05  FILLER                    PIC  X(01).                    01220055
012300     05  XI-REVOKE-IND             PIC  X(01)  VALUE SPACES.      01230099
012400     05  FILLER                    PIC  X(01).                    01240055
012500     05  XI-DFLTPRTR-ID            PIC  X(08)  VALUE SPACES.      01250099
013200                                                                  01320088
013300 01  PC-PROGRAM-CONSTANTS.                                        01330000
013400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'XIKUT001'.  01340099
013500     05  PC-COMMA                  PIC  X(01)  VALUE ','.         01350056
013600                                                                  01360026
013700 01  PV-PROGRAM-VARIABLES.                                        01370000
014100     05  PV-READ-DFLTPRTR-USER-RECS                               01410099
014201                                   PIC S9(09)  COMP SYNC          01420199
014202                                               VALUE ZERO.        01420299
014210     05  PV-READ-BC-RECS           PIC S9(09)  COMP SYNC          01421099
014220                                               VALUE ZERO.        01422099
014230     05  PV-READ-DFLTPRTR-GROUP-RECS                              01423099
014240                                   PIC S9(09)  COMP SYNC          01424099
014250                                               VALUE ZERO.        01425099
014260     05  PV-WRITE-USERINFO-RECS    PIC S9(09)  COMP SYNC          01426099
014280                                               VALUE ZERO.        01428099
014290     05  PV-WRITE-SYSUSR-RECS      PIC S9(09)  COMP SYNC          01429099
014291                                               VALUE ZERO.        01429199
014292     05  PV-WRITE-GROUPINFO-RECS   PIC S9(09)  COMP SYNC          01429299
014293                                               VALUE ZERO.        01429399
014294     05  PV-WRITE-USERTYPE-RECS    PIC S9(09)  COMP SYNC          01429499
014295                                               VALUE ZERO.        01429599
014300     05  PV-PRINT-NUM              PIC  ZZZZZZ9                   01430000
014400                                               VALUE ZERO.        01440000
014500     05  PV-EMPID                  PIC  X(07)  VALUE SPACES.      01450099
014600     05  PV-COUNTER                PIC 9(3)    VALUE ZERO.        01460052
014700     05  PV-UNSTRING-PTR           PIC S9(04)  COMP SYNC          01470056
014800                                               VALUE ZERO.        01480056
014900     05  PV-UNSTRING-DELIM         PIC  X(01)  VALUE SPACE.       01490056
014901     05  PV-DFLTPRTR-USERID        PIC  X(08)  VALUE SPACE.       01490199
014902     05  PV-BC-USERID              PIC  X(08)  VALUE SPACE.       01490299
015000*                                                                 01500052
015100 01  PS-PROGRAM-SWITCHES.                                         01510000
015200     05  PS-END-OF-BC-EMP-SW       PIC  X(01)  VALUE 'N'.         01520099
015300         88  PS-NOT-END-OF-BC-EMP              VALUE 'N'.         01530099
015400         88  PS-END-OF-BC-EMP                  VALUE 'Y'.         01540099
015500     05  PS-END-OF-DFLTPRTR-SW     PIC  X(01)  VALUE 'N'.         01550053
015600         88  PS-NOT-END-OF-DFLTPRTR            VALUE 'N'.         01560053
015700         88  PS-END-OF-DFLTPRTR                VALUE 'Y'.         01570053
017200                                                                  01720007
017300 PROCEDURE DIVISION.                                              01730000
017400***************************************************************** 01740000
017500**  THIS MODULE CONTROLS ALL PROCESSING DONE IN THIS PROGRAM.  ** 01750000
017600***************************************************************** 01760000
017700 0000-MAIN-DRIVER.                                                01770000
017800                                                                  01780000
017900     PERFORM 1000-INITIALIZATION.                                 01790000
018200     PERFORM 7000-READ-USERID-DFLTPRTR.                           01820080
018300     PERFORM 7100-READ-SORTED-BC-EMP.                             01830099
018400     PERFORM 2000-GATHER-USER-INFO                                01840060
018500         UNTIL ((PS-END-OF-DFLTPRTR)                              01850099
018600                 AND (PS-END-OF-BC-EMP)).                         01860099
018610                                                                  01861099
018700     SET PS-NOT-END-OF-DFLTPRTR TO TRUE.                          01870099
018900     PERFORM 7200-READ-GROUP-DFLTPRTR.                            01890084
019100     PERFORM 2500-GATHER-GROUP-INFO                               01910084
019200         UNTIL PS-END-OF-DFLTPRTR.                                01920099
019300                                                                  01930088
019400     PERFORM 2600-WRITE-USR-TYP-INFO.                             01940097
019500                                                                  01950097
019600     PERFORM 4000-TERMINATION.                                    01960006
019700                                                                  01970000
019800     GOBACK.                                                      01980000
019900                                                                  01990099
020000 1000-INITIALIZATION.                                             02000000
020100                                                                  02010007
020700     OPEN INPUT  SORTED-BC-EMPINFO-FILE                           02070099
020800                 SORTED-USERID-DFLTPRTR-FILE                      02080054
020900                 SORTED-GROUP-DFLTPRTR-FILE.                      02090098
021000     OPEN OUTPUT OUTPUT-USERINFO-FILE                             02100085
021100                 OUTPUT-GROUPINFO-FILE                            02110091
021200                 OUTPUT-SYS-USR-FILE                              02120098
021300                 OUTPUT-USR-TYP-FILE.                             02130098
021305                                                                  02130599
021310*1000-EXIT.                                                       02131099
021400                                                                  02140009
021700 2000-GATHER-USER-INFO.                                           02170053
021800                                                                  02180053
024710     EVALUATE TRUE                                                02471099
024720         WHEN (PV-DFLTPRTR-USERID = PV-BC-USERID)                 02472099
024730             INITIALIZE XI001-FORMATTED-OUTPUT-RECORD             02473099
024740                        XI003-FORMATTED-OUTPUT-RECORD             02474099
024750             MOVE BC002-EMPLOYEE-NUMBER TO XI001-EMP-ID           02475099
028200             PERFORM 2100-FORMAT-OUTPUT                           02820099
028300             PERFORM 2200-WRITE-OUTPUT-RECORD                     02830099
028310             PERFORM 7000-READ-USERID-DFLTPRTR                    02831099
028320             PERFORM 7100-READ-SORTED-BC-EMP                      02832099
028330         WHEN (PV-DFLTPRTR-USERID < PV-BC-USERID)                 02833099
028331* THERE WAS NO MATCH FOR THE USER IN THE BC FILE                  02833199
028332             INITIALIZE XI001-FORMATTED-OUTPUT-RECORD             02833299
028333                        XI003-FORMATTED-OUTPUT-RECORD             02833399
028340             PERFORM 2100-FORMAT-OUTPUT                           02834099
028350             PERFORM 2200-WRITE-OUTPUT-RECORD                     02835099
028360             PERFORM 7000-READ-USERID-DFLTPRTR                    02836099
028361*            DISPLAY 'NO MATCH IN BC FOR: ' XI-DFLTPRTR-RECORD    02836199
028370         WHEN OTHER                                               02837099
028371* THERE WAS DEFAULT PRINTER FOR THE USER IN THE BC FILE           02837199
028380             PERFORM 7100-READ-SORTED-BC-EMP                      02838099
028400     END-EVALUATE.                                                02840099
030000                                                                  03000067
030100*2000-EXIT.                                                       03010085
030110                                                                  03011099
030200****************************************************************  03020048
030300** FORMAT THE OUTPUT RECORD.                                  **  03030048
030400****************************************************************  03040048
030410                                                                  03041099
030500 2100-FORMAT-OUTPUT.                                              03050084
030600                                                                  03060048
030610* FORMAT THE NAME - SEPARATE INTO EACH FIELD                      03061099
030620     MOVE SPACE                    TO XI001-LAST-NAME             03062099
030630                                      XI001-FIRST-NAME            03063099
030640                                      XI001-MIDDLE-INIT.          03064099
030650     MOVE 1                        TO PV-UNSTRING-PTR.            03065099
030660     UNSTRING XI-NAME                                             03066099
030670         DELIMITED BY PC-COMMA                                    03067099
030680               OR ALL SPACES                                      03068099
030690         INTO         XI001-LAST-NAME                             03069099
030691         DELIMITER IN PV-UNSTRING-DELIM                           03069199
030692         POINTER      PV-UNSTRING-PTR                             03069299
030693     END-UNSTRING.                                                03069399
030694*                                                                 03069499
030695     UNSTRING XI-NAME                                             03069599
030696         DELIMITED BY PC-COMMA                                    03069699
030697               OR ALL SPACES                                      03069799
030698         INTO         XI001-FIRST-NAME                            03069899
030699         DELIMITER IN PV-UNSTRING-DELIM                           03069999
030700         POINTER      PV-UNSTRING-PTR                             03070099
030701     END-UNSTRING.                                                03070199
030702*                                                                 03070299
030703     UNSTRING XI-NAME                                             03070399
030704         DELIMITED BY PC-COMMA                                    03070499
030705               OR ALL SPACES                                      03070599
030706         INTO         XI001-MIDDLE-INIT                           03070699
030707         DELIMITER IN PV-UNSTRING-DELIM                           03070799
030708         POINTER      PV-UNSTRING-PTR                             03070899
030709     END-UNSTRING.                                                03070999
030710                                                                  03071099
030720     MOVE XI-ID                 TO XI001-EMPLOYEE-USER-ID.        03072099
030800* THE NAME FIELDS ARE SET ABOVE WHEN THE FIELD IS SPLIT APART.    03080058
030900     MOVE XI-REVOKE-IND         TO XI001-USR-RVKE-IND.            03090099
031000     MOVE XI-DFLTPRTR-ID        TO XI001-DFLT-PRTR-ID.            03100099
031300                                                                  03130096
031400* SET UP OUTPUT FOR SYS-USR FILE                                  03140096
031500     MOVE XI-ID                 TO XI003-USER-ID.                 03150099
031600     MOVE XI-USER-OR-GROUP-IND  TO XI003-USER-TYPE-CODE.          03160099
031700                                                                  03170099
031800*2100-EXIT.                                                       03180084
031900                                                                  03190099
032000****************************************************************  03200048
032100** FORMAT THE OUTPUT RECORD.                                  **  03210048
032200****************************************************************  03220048
032210                                                                  03221099
032300 2200-WRITE-OUTPUT-RECORD.                                        03230084
032400     WRITE XI-USERINFO-RECORD                                     03240099
032500         FROM XI001-FORMATTED-OUTPUT-RECORD.                      03250099
032700     ADD +1 TO PV-WRITE-USERINFO-RECS.                            03270099
032800                                                                  03280099
032900     WRITE XI-SYS-USR-RECORD                                      03290099
033000         FROM XI003-FORMATTED-OUTPUT-RECORD.                      03300099
033100     ADD +1 TO PV-WRITE-SYSUSR-RECS.                              03310099
033200                                                                  03320099
033300*2200-EXIT.                                                       03330084
033400                                                                  03340099
033500****************************************************************  03350084
033600*                                                                 03360099
033700****************************************************************  03370084
033800                                                                  03380084
033900 2500-GATHER-GROUP-INFO.                                          03390084
034000                                                                  03400099
034010     INITIALIZE XI002-FORMATTED-OUTPUT-RECORD.                    03401099
034100     MOVE XI-ID               TO XI002-GROUP-ID.                  03410099
034200     MOVE XI-NAME             TO XI002-GROUP-NAME.                03420099
034300     WRITE XI-GROUPINFO-RECORD                                    03430099
034400         FROM XI002-FORMATTED-OUTPUT-RECORD.                      03440099
034500     ADD +1 TO PV-WRITE-GROUPINFO-RECS.                           03450099
034800                                                                  03480096
034900* SET UP OUTPUT FOR SYS-USR FILE                                  03490096
035000     MOVE XI-ID                 TO XI003-USER-ID.                 03500099
035100     MOVE XI-USER-OR-GROUP-IND  TO XI003-USER-TYPE-CODE.          03510099
035200                                                                  03520099
035300     WRITE XI-SYS-USR-RECORD                                      03530099
035400         FROM XI003-FORMATTED-OUTPUT-RECORD.                      03540099
035500     ADD +1 TO PV-WRITE-SYSUSR-RECS.                              03550099
035501                                                                  03550199
035510     PERFORM 7200-READ-GROUP-DFLTPRTR.                            03551099
035600                                                                  03560099
035700*2500-EXIT.                                                       03570084
035800                                                                  03580099
036200 2600-WRITE-USR-TYP-INFO.                                         03620097
036300                                                                  03630099
036310     INITIALIZE XI004-FORMATTED-OUTPUT-RECORD.                    03631099
036400     MOVE 'U'                 TO XI004-USER-TYPE-CODE.            03640099
036500     MOVE 'USER'              TO XI004-USER-TYPE-DESC.            03650099
036600     WRITE XI-USR-TYP-RECORD                                      03660099
036700         FROM XI004-FORMATTED-OUTPUT-RECORD.                      03670099
036710     ADD +1 TO PV-WRITE-USERTYPE-RECS.                            03671099
036720                                                                  03672099
036800     INITIALIZE XI004-FORMATTED-OUTPUT-RECORD.                    03680099
036900     MOVE 'G'                 TO XI004-USER-TYPE-CODE.            03690099
037000     MOVE 'GROUP'             TO XI004-USER-TYPE-DESC.            03700099
037100     WRITE XI-USR-TYP-RECORD                                      03710099
037200         FROM XI004-FORMATTED-OUTPUT-RECORD.                      03720099
037210     ADD +1 TO PV-WRITE-USERTYPE-RECS.                            03721099
037300                                                                  03730099
037400*2600-EXIT.                                                       03740089
037500                                                                  03750099
037600****************************************************************  03760047
037700** CLOSE FILES                                                **  03770047
037800****************************************************************  03780047
037810                                                                  03781099
037900 4000-TERMINATION.                                                03790047
037910                                                                  03791099
038000     CLOSE SORTED-BC-EMPINFO-FILE                                 03800099
038100           SORTED-USERID-DFLTPRTR-FILE                            03810057
038200           SORTED-GROUP-DFLTPRTR-FILE                             03820084
038300           OUTPUT-USERINFO-FILE                                   03830085
038400           OUTPUT-GROUPINFO-FILE.                                 03840085
038410                                                                  03841099
038500     MOVE PV-READ-DFLTPRTR-USER-RECS TO PV-PRINT-NUM.             03850099
038600     DISPLAY PC-CURRENT-PROGRAM-NAME ' - DEFAULT PRINTER USER '   03860099
038601               'RECORDS READ: ' PV-PRINT-NUM.                     03860199
038602     MOVE PV-READ-BC-RECS TO PV-PRINT-NUM.                        03860299
038603     DISPLAY PC-CURRENT-PROGRAM-NAME ' - BUSINESS CONTINUITY '    03860399
038604               'EMPLOYEE RECORDS READ: ' PV-PRINT-NUM.            03860499
038605     MOVE PV-READ-DFLTPRTR-GROUP-RECS TO PV-PRINT-NUM.            03860599
038606     DISPLAY PC-CURRENT-PROGRAM-NAME ' - DEFAULT PRINTER GROUP '  03860699
038607               'RECORDS READ: ' PV-PRINT-NUM.                     03860799
038608     MOVE PV-WRITE-USERINFO-RECS TO PV-PRINT-NUM.                 03860899
038609     DISPLAY PC-CURRENT-PROGRAM-NAME ' - XI USER RECORDS '        03860999
038610               'WRITTEN: ' PV-PRINT-NUM.                          03861099
038611     MOVE PV-WRITE-GROUPINFO-RECS TO PV-PRINT-NUM.                03861199
038612     DISPLAY PC-CURRENT-PROGRAM-NAME ' - XI GROUP RECORDS '       03861299
038613               'WRITTEN: ' PV-PRINT-NUM.                          03861399
038614     MOVE PV-WRITE-SYSUSR-RECS TO PV-PRINT-NUM.                   03861499
038615     DISPLAY PC-CURRENT-PROGRAM-NAME ' - XI SYSTEM USER RECORDS ' 03861599
038616               'WRITTEN: ' PV-PRINT-NUM.                          03861699
038617     MOVE PV-WRITE-USERTYPE-RECS TO PV-PRINT-NUM.                 03861799
038618     DISPLAY PC-CURRENT-PROGRAM-NAME ' - XI USER TYPE RECORDS '   03861899
038619               'WRITTEN: ' PV-PRINT-NUM.                          03861999
038620                                                                  03862099
038630*4000-EXIT.                                                       03863099
038700                                                                  03870099
038800****************************************************************  03880053
038900** READ FROM SORTED-USERID-DFLTPRTR-FILE                      **  03890054
039000****************************************************************  03900053
039100                                                                  03910099
039200 7000-READ-USERID-DFLTPRTR.                                       03920055
039300                                                                  03930053
039400     READ SORTED-USERID-DFLTPRTR-FILE                             03940054
039500          INTO XI-DFLTPRTR-RECORD                                 03950099
039600          AT END                                                  03960053
039700             SET PS-END-OF-DFLTPRTR TO TRUE                       03970053
039710             MOVE HIGH-VALUES TO PV-DFLTPRTR-USERID               03971099
039800     END-READ.                                                    03980053
039810                                                                  03981099
039820     IF (NOT PS-END-OF-DFLTPRTR)                                  03982099
039850         MOVE XI-ID TO PV-DFLTPRTR-USERID                         03985099
039851         ADD +1 TO PV-READ-DFLTPRTR-USER-RECS                     03985199
039860     END-IF.                                                      03986099
039900                                                                  03990053
040000*7000-EXIT.                                                       04000099
040100                                                                  04010099
040200****************************************************************  04020055
040300** READ FROM THE SORTED USER FILE WITH TK AND EMPLID FIELDS   **  04030099
040400****************************************************************  04040055
040500                                                                  04050099
040600 7100-READ-SORTED-BC-EMP.                                         04060099
040700                                                                  04070055
040800     READ SORTED-BC-EMPINFO-FILE                                  04080099
040900          INTO BC002-EMPLOYEE-RECORD                              04090099
041000          AT END                                                  04100055
041100             SET PS-END-OF-BC-EMP TO TRUE                         04110099
041110             MOVE HIGH-VALUES TO PV-BC-USERID                     04111099
041200     END-READ.                                                    04120055
041300                                                                  04130055
041500     IF (NOT PS-END-OF-BC-EMP)                                    04150099
041530         MOVE BC002-EMPLOYEE-USER-ID TO PV-BC-USERID              04153099
041531         ADD +1 TO PV-READ-BC-RECS                                04153199
041540     END-IF.                                                      04154099
042300                                                                  04230057
042400*7100-EXIT.                                                       04240099
042500                                                                  04250099
042600****************************************************************  04260084
042700** READ FROM SORTED-GROUP-DFLTPRTR-FILE                      **   04270084
042800****************************************************************  04280084
042900                                                                  04290099
043000 7200-READ-GROUP-DFLTPRTR.                                        04300084
043100                                                                  04310084
043200     READ SORTED-GROUP-DFLTPRTR-FILE                              04320084
043300          INTO XI-DFLTPRTR-RECORD                                 04330099
043400          AT END                                                  04340084
043500             SET PS-END-OF-DFLTPRTR TO TRUE                       04350084
043600     END-READ.                                                    04360084
043610                                                                  04361099
043620     IF (NOT PS-END-OF-DFLTPRTR)                                  04362099
043640         ADD +1 TO PV-READ-DFLTPRTR-GROUP-RECS                    04364099
043650     END-IF.                                                      04365099
043700                                                                  04370084
043800*7200-EXIT.                                                       04380099
