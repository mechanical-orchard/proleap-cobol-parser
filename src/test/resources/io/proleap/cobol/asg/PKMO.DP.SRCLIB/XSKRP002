000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.         XSKRP002.                                    00030000
000400 AUTHOR.             JIM LEIKNESS.                                00040000
000500 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00050000
000600 DATE-WRITTEN.       12-27-2002.                                  00060000
000700 DATE-COMPILED.                                                   00070000
000710                                                                  00071000
000800******************************************************************00080000
000810*  COMPARES DATA FROM THE XSDOMAIN AND SYSTEM OF RECORD           00081000
000811*  XST_DC_LOC TABLES.                                             00081100
000820******************************************************************00082000
000830                                                                  00083000
000900 ENVIRONMENT DIVISION.                                            00090000
001000                                                                  00100000
001100 CONFIGURATION SECTION.                                           00110000
001200                                                                  00120000
001300 SOURCE-COMPUTER.    IBM-3090.                                    00130000
001400 OBJECT-COMPUTER.    IBM-3090.                                    00140000
001500                                                                  00150000
001600 INPUT-OUTPUT SECTION.                                            00160000
001700                                                                  00170000
001800 FILE-CONTROL.                                                    00180000
001900                                                                  00190000
002000     SELECT XST-INPUT-FILE       ASSIGN TO INP01.                 00200000
002100     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00210000
002200     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600 FILE SECTION.                                                    00260000
002700                                                                  00270000
002800 FD  RMS-INPUT-FILE                                               00280000
002900     RECORDING MODE IS F                                          00290000
003000     BLOCK CONTAINS 0 RECORDS                                     00300000
003100     LABEL RECORDS ARE OMITTED.                                   00310000
003200 01  RMS-INPUT-RECORD                    PIC  X(30).              00320000
003300                                                                  00330000
003400 FD  XST-INPUT-FILE                                               00340000
003500     RECORDING MODE IS F                                          00350000
003600     BLOCK CONTAINS 0 RECORDS                                     00360000
003700     LABEL RECORDS ARE OMITTED.                                   00370000
003800 01  XST-INPUT-RECORD                    PIC  X(14).              00380000
003900                                                                  00390000
004000 FD  ERROR-REPORT                                                 00400000
004100     RECORDING MODE IS F                                          00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     LABEL RECORDS ARE OMITTED.                                   00430000
004400 01  ERR-RPT-LINE                        PIC  X(200).             00440000
004500                                                                  00450000
004600 WORKING-STORAGE SECTION.                                         00460000
004700                                                                  00470000
004800     COPY HORD007.                                                00480000
004900                                                                  00490000
005000     COPY DPWS150O.                                               00500000
005100                                                                  00510000
005200 01 XST-REC.                                                      00520000
005300     05 XST-DC-LOC-NBR             PIC S9(04) COMP.               00530000
005400     05 XST-EFF-BEG-DTE            PIC X(10) VALUE SPACE.         00540000
005500     05 XST-DC-NBR                 PIC S9(04) COMP.               00550000
005900                                                                  00590000
006000 01 PC-PROGRAM-CONSTANTS.                                         00600000
006100     05 PC-PGM-NAME                PIC X(08)  VALUE 'XSKRP002'.   00610000
006200                                                                  00620000
006300 01 PV-PROGRAM-VARIABLES.                                         00630000
006400     05 PV-XST-KEY.                                               00640000
006500        10 PV-XST-DC-LOC-NBR       PIC 9(04).                     00650000
006600        10 PV-XST-EFF-BEG-DTE      PIC X(10) VALUE SPACE.         00660000
006700     05 PV-XST-DC-NBR              PIC 9(04).                     00670000
007000                                                                  00700000
007100     05 PV-RMS-KEY.                                               00710000
007200         10 PV-RMS-DC-LOC-NBR      PIC 9(04).                     00720000
007300         10 PV-RMS-EFF-BEG-DTE     PIC X(10) VALUE SPACE.         00730000
007400     05 PV-RMS-DC-NBR              PIC 9(04).                     00740000
007700                                                                  00770000
007800     05 PV-PAGE-CNT                 PIC S9(05)  VALUE ZERO.       00780000
007900     05 PV-LINE-CNT                 PIC S9(04)  COMP VALUE ZERO.  00790000
008000     05 PV-MAX-LINES                PIC S9(04)  COMP VALUE +71.   00800000
008100                                                                  00810000
008200     05 PV-DISPLAY-CNT              PIC ZZZZ9.                    00820000
008300     05 PV-NBR-ERRORS               PIC S9(04)  COMP              00830000
008400                                                VALUE ZERO.       00840000
008500     05 PV-DATE-YYMMDD.                                           00850000
008600          10 PV-YYMMDD-YY           PIC X(02)  VALUE SPACE.       00860000
008700          10 PV-YYMMDD-MM           PIC X(02)  VALUE SPACE.       00870000
008800          10 PV-YYMMDD-DD           PIC X(02)  VALUE SPACE.       00880000
008900     05 PV-TIME-HHMMSS.                                           00890000
009000          10 PV-HHMMSS-HH           PIC X(02)  VALUE SPACE.       00900000
009100          10 PV-HHMMSS-MM           PIC X(02)  VALUE SPACE.       00910000
009200          10 PV-HHMMSS-SS           PIC X(02)  VALUE SPACE.       00920000
009300     05 PV-MESSAGE                  PIC X(50)  VALUE SPACE.       00930000
009400                                                                  00940000
009500 01 RPT-TOTAL-LINE.                                               00950000
009600     05 FILLER     PIC  X(23) VALUE                               00960000
009700                         'TOTAL NUMBER OF ERRORS '.               00970000
009800     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00980000
009900                                                                  00990000
010000 01 RPT-END-OF-REPORT-LINE.                                       01000000
010100     05 FILLER     PIC  X(21) VALUE                               01010000
010200                            '*** END OF REPORT ***'.              01020000
010300 01 PA-PROGRAM-ACCUMULATORS.                                      01030000
010400     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              01040000
010500     05 PA-XST-RECS-READ       PIC 9(13) VALUE ZERO.              01050000
010600     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01060000
010700                                                                  01070000
010800 01 PS-PROGRAM-SWITCHES.                                          01080000
010900     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01090000
011000         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01100000
011100         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01110000
011200     05 PS-MORE-XST-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01120000
011300         88 PS-MORE-XST-INPUT-RECS           VALUE 'Y'.           01130000
011400         88 PS-END-OF-XST-INPUT-RECS         VALUE 'N'.           01140000
011500     05 PS-RMS-OR-XST-ERR        PIC X(01)   VALUE '0'.           01150000
011600         88 PS-RMS-ERROR                     VALUE '1'.           01160000
011700         88 PS-XST-ERROR                     VALUE '2'.           01170000
011800         88 PS-DATA-ERROR                    VALUE '3'.           01180000
011900                                                                  01190000
012000 01 RPT-REPORT-HEADING.                                           01200000
012100     05 FILLER     PIC  X(52)    VALUE SPACES.                    01210000
012200     05 FILLER     PIC  X(47)    VALUE                            01220000
012300         'XS DC LOCATION ASSIGNMENT DATA INTEGRITY ERRORS'.       01230000
012400                                                                  01240000
012500 01 RPT-COL-HEADING-1.                                            01250000
012600     05 FILLER     PIC  X(01) VALUE SPACE.                        01260000
012700     05 FILLER     PIC  X(07) VALUE ALL '-'.                      01270000
012800     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01280000
012900     05 FILLER     PIC  X(08) VALUE ALL '-'.                      01290000
013000                                                                  01300000
013100 01 RPT-COL-HEADING-2.                                            01310000
013200     05 FILLER     PIC  X(01) VALUE SPACE.                        01320000
013300     05 FILLER     PIC  X(07) VALUE 'LOC_NBR'.                    01330000
013400     05 FILLER     PIC  X(02) VALUE SPACE.                        01340000
013500     05 FILLER     PIC  X(07) VALUE 'EFF_BEG'.                    01350000
013600     05 FILLER     PIC  X(06) VALUE SPACE.                        01360000
013700     05 FILLER     PIC  X(08) VALUE 'XSDOMAIN'.                   01370000
013800     05 FILLER     PIC  X(04) VALUE SPACE.                        01380000
013900     05 FILLER     PIC  X(16) VALUE 'SYSTEM OF RECORD'.           01390000
014000     05 FILLER     PIC  X(04) VALUE SPACE.                        01400000
014100     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01410000
014400                                                                  01440000
014500 01 RPT-COL-HEADING-3.                                            01450000
014600     05 FILLER     PIC  X(10) VALUE SPACE.                        01460000
014900     05 FILLER     PIC  X(04) VALUE '_DTE'.                       01490000
015000     05 FILLER     PIC  X(10) VALUE SPACE.                        01500000
015100     05 FILLER     PIC  X(06) VALUE 'DC_NBR'.                     01510000
015200     05 FILLER     PIC  X(06) VALUE SPACE.                        01520000
015300     05 FILLER     PIC  X(06) VALUE 'DC_NBR'.                     01530000
015600                                                                  01560000
015700 01 RPT-COL-HEADING-4.                                            01570000
015800     05 FILLER     PIC  X(132) VALUE ALL '-'.                     01580000
015900                                                                  01590000
016000 01 DL-DETAIL-LINE.                                               01600000
016100     05 FILLER                PIC  X(01) VALUE SPACE.             01610000
016200     05 DL-DC-LOC-NBR         PIC  X(04) VALUE SPACE.             01620000
016300     05 FILLER                PIC  X(04) VALUE SPACE.             01630000
016400     05 DL-EFF-BEG-DTE        PIC  X(10) VALUE SPACE.             01640000
016500     05 FILLER                PIC  X(05) VALUE SPACE.             01650000
016600     05 DL-XST-DC-NBR         PIC  X(04) VALUE SPACE.             01660000
016700     05 FILLER                PIC  X(08) VALUE SPACE.             01670000
016800     05 DL-RMS-DC-NBR         PIC  X(04) VALUE SPACE.             01680000
016900     05 FILLER                PIC  X(15) VALUE SPACE.             01690000
017400     05 DL-MESSAGE            PIC  X(50) VALUE SPACE.             01740000
017500                                                                  01750000
017510******************************************************************01751000
017600 PROCEDURE DIVISION.                                              01760000
017610******************************************************************01761000
017800 0000-MAIN-MODULE.                                                01780000
017900                                                                  01790000
018000       OPEN INPUT RMS-INPUT-FILE                                  01800000
018100                  XST-INPUT-FILE                                  01810000
018200            OUTPUT ERROR-REPORT.                                  01820000
018300                                                                  01830000
018400       PERFORM 1000-INITIALIZE.                                   01840000
018500       PERFORM 7000-READ-XST-INPUT-FILE.                          01850000
018600       PERFORM 7100-READ-RMS-INPUT-FILE.                          01860000
018700                                                                  01870000
018800       PERFORM 2000-PROCESS-RECS                                  01880000
018900          UNTIL (PS-END-OF-XST-INPUT-RECS                         01890000
019000            AND PS-END-OF-RMS-INPUT-RECS).                        01900000
019100                                                                  01910000
019200       PERFORM 8400-WRITE-TOTALS.                                 01920000
019300                                                                  01930000
019400       CLOSE RMS-INPUT-FILE                                       01940000
019500             XST-INPUT-FILE                                       01950000
019600             ERROR-REPORT.                                        01960000
019700                                                                  01970000
019800       DISPLAY '**** XSKRP002 STATISTICS ****'                    01980000
019900       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     01990000
020000       DISPLAY 'TOTAL XST RECORDS READ : ' PA-XST-RECS-READ.      02000000
020100       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      02010000
020200       DISPLAY ' '                                                02020000
020300                                                                  02030000
020400       STOP RUN.                                                  02040000
020500                                                                  02050000
020600 1000-INITIALIZE.                                                 02060000
020700                                                                  02070000
020800       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02080000
020900       MOVE PV-YYMMDD-YY TO DP150O-RUN-YEAR.                      02090000
021000       MOVE PV-YYMMDD-MM TO DP150O-RUN-MONTH.                     02100000
021100       MOVE PV-YYMMDD-DD TO DP150O-RUN-DAY.                       02110000
021200                                                                  02120000
021300       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02130000
021400       MOVE PV-HHMMSS-HH TO DP150O-RUN-HOUR.                      02140000
021500       MOVE PV-HHMMSS-MM TO DP150O-RUN-MINUTE.                    02150000
021600       MOVE PC-PGM-NAME TO DP150O-PROGRAM-NAME.                   02160000
021700       MOVE 1        TO DP150O-REPORT-NUMBER.                     02170000
021800                                                                  02180000
021900       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02190000
022000       PERFORM 8200-WRITE-REPORT-HEADING.                         02200000
022100       PERFORM 8300-WRITE-COLUMN-HEADING.                         02210000
022200                                                                  02220000
022300 2000-PROCESS-RECS.                                               02230000
022400                                                                  02240000
022500       MOVE HO007-DCLOC-LOC-NBR     TO  PV-RMS-DC-LOC-NBR.        02250000
022600       MOVE HO007-DCLOC-EFF-BEG-DTE TO  PV-RMS-EFF-BEG-DTE.       02260000
022700       MOVE HO007-DCLOC-DC-NBR      TO  PV-RMS-DC-NBR.            02270000
023000                                                                  02300000
023100       MOVE XST-DC-LOC-NBR      TO  PV-XST-DC-LOC-NBR             02310000
023200       MOVE XST-EFF-BEG-DTE     TO  PV-XST-EFF-BEG-DTE.           02320000
023300       MOVE XST-DC-NBR          TO  PV-XST-DC-NBR.                02330000
023600                                                                  02360000
023700       IF PV-XST-EFF-BEG-DTE NOT > ZEROES                         02370000
023800           MOVE SPACES TO PV-XST-EFF-BEG-DTE                      02380000
023900       END-IF.                                                    02390000
024100                                                                  02410000
024200      IF PV-XST-KEY = PV-RMS-KEY                                  02420000
024400         PERFORM 3000-COMPARE-FIELDS                              02440000
024500         PERFORM 7000-READ-XST-INPUT-FILE                         02450000
024600         PERFORM 7100-READ-RMS-INPUT-FILE                         02460000
024700      ELSE                                                        02470000
024800         IF ((PV-RMS-KEY < PV-XST-KEY)                            02480000
024900             OR PS-END-OF-XST-INPUT-RECS) AND                     02490000
025000             PS-MORE-RMS-INPUT-RECS                               02500000
025100             MOVE '1' TO PS-RMS-OR-XST-ERR                        02510000
025200             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           02520000
025300                TO PV-MESSAGE                                     02530000
025400             PERFORM 8000-WRITE-OUTPUT-REC                        02540000
025500             PERFORM 7100-READ-RMS-INPUT-FILE                     02550000
025600          ELSE                                                    02560000
025700             IF ((PV-RMS-KEY > PV-XST-KEY)                        02570000
025800                OR PS-END-OF-RMS-INPUT-RECS) AND                  02580000
025900                PS-MORE-XST-INPUT-RECS                            02590000
026000                MOVE '2' TO PS-RMS-OR-XST-ERR                     02600000
026100                MOVE 'KEY ON XS DOMAIN TABLES ONLY' TO PV-MESSAGE 02610000
026200                PERFORM 8000-WRITE-OUTPUT-REC                     02620000
026300                PERFORM 7000-READ-XST-INPUT-FILE                  02630000
026400             END-IF                                               02640000
026500          END-IF                                                  02650000
026600      END-IF.                                                     02660000
026700                                                                  02670000
026800 3000-COMPARE-FIELDS.                                             02680000
026900                                                                  02690000
027000      EVALUATE TRUE                                               02700000
027100         WHEN PV-RMS-DC-NBR NOT = PV-XST-DC-NBR                   02710000
027200             MOVE '3' TO PS-RMS-OR-XST-ERR                        02720000
027300             MOVE 'DC NUMBERS DO NOT MATCH'                       02730000
027400                        TO PV-MESSAGE                             02740000
027500             PERFORM 8000-WRITE-OUTPUT-REC                        02750000
027600      END-EVALUATE.                                               02760000
027700                                                                  02770000
027800 7000-READ-XST-INPUT-FILE.                                        02780000
027900                                                                  02790000
028000       INITIALIZE XST-REC.                                        02800000
028100                                                                  02810000
028200       READ XST-INPUT-FILE INTO XST-REC                           02820000
028300           AT END SET PS-END-OF-XST-INPUT-RECS TO TRUE.           02830000
028400                                                                  02840000
028500       ADD 1 TO PA-XST-RECS-READ.                                 02850000
028600                                                                  02860000
028700 7100-READ-RMS-INPUT-FILE.                                        02870000
028800                                                                  02880000
028900       INITIALIZE HO007-DCLOCASG-DATA                             02890000
029000                                                                  02900000
029100       READ RMS-INPUT-FILE INTO HO007-DCLOCASG-DATA               02910000
029200            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          02920000
029300                                                                  02930000
029400       ADD 1 TO PA-RMS-RECS-READ.                                 02940000
029500                                                                  02950000
029600 8000-WRITE-OUTPUT-REC.                                           02960000
029800                                                                  02980000
029900       IF PS-RMS-ERROR                                            02990000
030000          MOVE SPACES TO DL-DETAIL-LINE                           03000000
030100          MOVE PV-RMS-DC-LOC-NBR      TO DL-DC-LOC-NBR            03010000
030200          MOVE PV-RMS-EFF-BEG-DTE     TO DL-EFF-BEG-DTE           03020000
030300          MOVE PV-RMS-DC-NBR          TO DL-RMS-DC-NBR            03030000
030600          MOVE PV-MESSAGE TO DL-MESSAGE                           03060000
030700       ELSE                                                       03070000
030800          IF PS-XST-ERROR                                         03080000
030900             MOVE SPACES TO DL-DETAIL-LINE                        03090000
031000             MOVE PV-XST-DC-LOC-NBR   TO DL-DC-LOC-NBR            03100000
031100             MOVE PV-XST-EFF-BEG-DTE  TO DL-EFF-BEG-DTE           03110000
031200             MOVE PV-XST-DC-NBR       TO DL-XST-DC-NBR            03120000
031500             MOVE PV-MESSAGE TO DL-MESSAGE                        03150000
031600          ELSE                                                    03160000
031700             MOVE SPACES TO DL-DETAIL-LINE                        03170000
031800             MOVE PV-RMS-DC-LOC-NBR   TO DL-DC-LOC-NBR            03180000
031900             MOVE PV-RMS-EFF-BEG-DTE  TO DL-EFF-BEG-DTE           03190000
032000             MOVE PV-RMS-DC-NBR       TO DL-RMS-DC-NBR            03200000
032500             MOVE PV-XST-DC-NBR       TO DL-XST-DC-NBR            03250000
032700             MOVE PV-MESSAGE TO DL-MESSAGE                        03270000
032800          END-IF                                                  03280000
032900       END-IF.                                                    03290000
033000                                                                  03300000
033100       IF PV-LINE-CNT > PV-MAX-LINES                              03310000
033200          PERFORM 8100-WRITE-STD-RPT-HEADING                      03320000
033300          PERFORM 8200-WRITE-REPORT-HEADING                       03330000
033400          PERFORM 8300-WRITE-COLUMN-HEADING                       03340000
033500       END-IF.                                                    03350000
033600                                                                  03360000
033700       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03370000
033800             AFTER ADVANCING 1 LINE.                              03380000
033900       ADD +1 TO PV-LINE-CNT.                                     03390000
034000                                                                  03400000
034010       MOVE 4095 TO RETURN-CODE.                                  03401000
034100       ADD 1 TO PA-ERROR-MESSAGES.                                03410000
034200                                                                  03420000
034300 8100-WRITE-STD-RPT-HEADING.                                      03430000
034400                                                                  03440000
034500       INITIALIZE PV-LINE-CNT.                                    03450000
034600       ADD 1  TO PV-PAGE-CNT.                                     03460000
034700       MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                    03470000
034800       WRITE ERR-RPT-LINE FROM DP150O-STANDRD-HEADER-150-COLS     03480000
034900             AFTER ADVANCING PAGE.                                03490000
035000       ADD +1 TO PV-LINE-CNT.                                     03500000
035100                                                                  03510000
035200 8200-WRITE-REPORT-HEADING.                                       03520000
035300                                                                  03530000
035400       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03540000
035500            AFTER ADVANCING 1 LINES.                              03550000
035600       ADD +1 TO PV-LINE-CNT.                                     03560000
035700                                                                  03570000
035800 8300-WRITE-COLUMN-HEADING.                                       03580000
035900                                                                  03590000
036000       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03600000
036100            AFTER ADVANCING 2 LINES.                              03610000
036200       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03620000
036300            AFTER ADVANCING 1 LINES.                              03630000
036400       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03640000
036500            AFTER ADVANCING 1 LINES.                              03650000
036600       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03660000
036700            AFTER ADVANCING 1 LINES.                              03670000
036800       ADD +5 TO PV-LINE-CNT.                                     03680000
036900                                                                  03690000
037000 8400-WRITE-TOTALS.                                               03700000
037100                                                                  03710000
037200       IF PV-LINE-CNT > PV-MAX-LINES                              03720000
037300          PERFORM 8100-WRITE-STD-RPT-HEADING                      03730000
037400          PERFORM 8200-WRITE-REPORT-HEADING                       03740000
037500          PERFORM 8300-WRITE-COLUMN-HEADING                       03750000
037600       END-IF.                                                    03760000
037700                                                                  03770000
037800      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    03780000
037900      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      03790000
038000            AFTER ADVANCING 2 LINES.                              03800000
038100      ADD +2 TO PV-LINE-CNT.                                      03810000
038200                                                                  03820000
038300      IF PV-LINE-CNT > PV-MAX-LINES                               03830000
038400         PERFORM 8100-WRITE-STD-RPT-HEADING                       03840000
038500         PERFORM 8200-WRITE-REPORT-HEADING                        03850000
038600         PERFORM 8300-WRITE-COLUMN-HEADING                        03860000
038700      END-IF.                                                     03870000
038800      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              03880000
038900            AFTER ADVANCING 1 LINES.                              03890000
039000                                                                  03900000
