000100******************************************************************00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300******************************************************************00030003
000400                                                                  00040003
000500 PROGRAM-ID.             ARKUT035.                                00050003
000600 AUTHOR.                 TAMARA KOLTUN.                           00060003
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070003
000800 DATE-WRITTEN            6-30-95.                                 00080003
000900 DATE-COMPILED.                                                   00090003
001000******************************************************************00100003
001100* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE GL WEEKLY POSTING     00110003
001200* FILE AND GL WEEKLY POSTING REPORT.                              00120003
001300******************************************************************00130003
001400                                                                  00140003
001500******************************************************************00150003
001600 ENVIRONMENT DIVISION.                                            00160003
001700******************************************************************00170003
001800                                                                  00180003
001900 CONFIGURATION SECTION.                                           00190003
002000                                                                  00200003
002100 SOURCE-COMPUTER.        IBM-3090.                                00210003
002200 OBJECT-COMPUTER.        IBM-3090.                                00220003
002300                                                                  00230003
002400 INPUT-OUTPUT SECTION.                                            00240003
002500                                                                  00250003
002600 FILE-CONTROL.                                                    00260003
002700                                                                  00270003
002800      SELECT GL-UPDATE-SUMMARY-FILE        ASSIGN TO INP01.       00280003
002900      SELECT GL-UPDATE-WEEKLY-FILE         ASSIGN TO OUT01.       00290003
003000      SELECT GL-UPDATE-WEEKLY-REPORT       ASSIGN TO RPT01.       00300003
003100                                                                  00310003
003200******************************************************************00320003
003300 DATA DIVISION.                                                   00330003
003400******************************************************************00340003
003500                                                                  00350003
003600 FILE SECTION.                                                    00360003
003700 FD  GL-UPDATE-SUMMARY-FILE                                       00370003
003800     LABEL RECORDS ARE STANDARD                                   00380003
003900     BLOCK CONTAINS 0 RECORDS                                     00390003
004000     RECORDING MODE IS F                                          00400003
004100     RECORD CONTAINS 81  CHARACTERS                               00410007
004200     DATA RECORD IS GL-UPDATE-SUMMARY-RECORD.                     00420003
004300                                                                  00430003
004400 01  GL-UPDATE-SUMMARY-RECORD        PIC X(81).                   00440007
004500                                                                  00450003
004600 FD  GL-UPDATE-WEEKLY-FILE                                        00460003
004700     LABEL RECORDS ARE STANDARD                                   00470003
004800     BLOCK CONTAINS 0 RECORDS                                     00480003
004900     RECORDING MODE IS F                                          00490003
005000     RECORD CONTAINS 180  CHARACTERS                              00500003
005100     DATA RECORD IS GL-UPDATE-WEEKLY-RECORD.                      00510003
005200                                                                  00520003
005300 01  GL-UPDATE-WEEKLY-RECORD         PIC X(180).                  00530003
005400                                                                  00540003
005500                                                                  00550003
005600 FD  GL-UPDATE-WEEKLY-REPORT                                      00560003
005700     LABEL RECORDS ARE STANDARD                                   00570003
005800     BLOCK CONTAINS 0 RECORDS                                     00580003
005900     RECORDING MODE IS F                                          00590003
006000     RECORD CONTAINS 132 CHARACTERS                               00600003
006100     DATA RECORD IS GL-UPDATE-WEEKLY-RPT-RECORD.                  00610003
006200                                                                  00620003
006300 01  GL-UPDATE-WEEKLY-RPT-RECORD     PIC X(132).                  00630003
006400                                                                  00640003
006500*------------------------------------------------------*          00650003
006600 WORKING-STORAGE SECTION.                                         00660003
006700*------------------------------------------------------*          00670003
006800 01 PC-PROGRAM-CONSTANTS.                                         00680003
006900    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'ARKUT035'.  00690003
007000    05 PC-DATE-MODULE                PIC X(08) VALUE 'DPKUT500'.  00700003
007100    05 PC-REPORT-NBR                 PIC 9(01) VALUE 1.           00710003
007200    05 PC-ACT-0020116                PIC 9(07) VALUE 0020116.     00720003
007300    05 PC-ACT-0010102                PIC 9(07) VALUE 0010102.     00730003
007400    05 PC-COMPANY                    PIC X(04) VALUE '0039'.      00740003
007500    05 PC-STORE-880                  PIC 9(04) VALUE 0880.        00750006
007600    05 PC-ACT-RECEIVABLE             PIC X(05) VALUE '10202'.     00760003
007700    05 PC-DEBIT                      PIC X(02) VALUE 'DR'.        00770003
007800    05 PC-CREDIT                     PIC X(02) VALUE 'CR'.        00780003
007900    05 PC-ACT-RECVBLE-DESCR          PIC X(25) VALUE              00790003
008000                                'ACCOUNTS RECEIVABLE TRADE'.      00800003
008100    05 PC-NEW-PAGE-IND               PIC S9(04) VALUE -1 COMP.    00810003
008200    05 PC-PLUS                       PIC  X(01) VALUE '+'.        00820003
008300    05 PC-MINUS                      PIC  X(01) VALUE '-'.        00830003
008400    05 PC-BACK-TO-PREV-WEEK          PIC  9(01) VALUE 4.          00840003
008500 01 PV-PROGRAM-VARIABLES.                                         00850003
008600    05 PV-ABEND-CODE                 PIC  9(04) VALUE 0.          00860003
008700    05 PV-SYSTEM-DATE.                                            00870003
008800       10 PV-SYSTEM-YY               PIC  9(02)    VALUE 0.       00880003
008900       10 PV-SYSTEM-MM               PIC  9(02)    VALUE 0.       00890003
009000       10 PV-SYSTEM-DD               PIC  9(02)    VALUE 0.       00900003
009100    05 PV-WORK-DATE.                                              00910003
009200       10 PV-WORK-MM                 PIC  9(02)    VALUE 0.       00920003
009300       10 PV-WORK-DD                 PIC  9(02)    VALUE 0.       00930003
009400       10 PV-WORK-YY                 PIC  9(02)    VALUE 0.       00940003
009500    05 PV-CURRENT-TIME.                                           00950003
009600       10 PV-CURRENT-HH              PIC 9(02)     VALUE 0.       00960003
009700       10 PV-CURRENT-MM              PIC 9(02)     VALUE 0.       00970003
009800       10 FILLER                     PIC 9(04)     VALUE ZERO.    00980003
009900    05 PV-LINE-COUNT                 PIC S9(04)    VALUE 61       00990003
010000                                                   COMP.          01000003
010100    05 PV-PAGE-COUNT                 PIC S9(04)    VALUE 0.       01010003
010200    05 PV-ACT-RECVBLE-AMT     PIC  ZZ,ZZZ,ZZZ,ZZZ.99.             01020018
010300    05 PV-ACCOUNT-HOLD               PIC  X(07) VALUE SPACE.      01030003
010310    05 PV-DESCRIPTION                PIC  X(32) VALUE SPACE.      01031013
010400    05 PV-TEMP-ACCOUNT-N             PIC 9(6).                    01040003
010500    05 PV-TEMP-ACCOUNT.                                           01050003
010600       10 PV-TEMP-ACCOUNT-1          PIC  X.                      01060003
010700       10 PV-TEMP-ACCOUNT-5          PIC  XXXXX.                  01070003
010800    05 PV-STORE-HOLD                 PIC  X(04) VALUE SPACE.      01080006
010900    05 PV-DB-CR-IND-HOLD             PIC  X(02) VALUE SPACE.      01090003
011000       88 PV-DEBIT                              VALUE '+'.        01100003
011100       88 PV-CREDIT                             VALUE '-'.        01110003
011200    05 PV-POSTING-REFORMAT.                                       01120003
011300       10 PV-POSTING-CCYY-REFORMAT   PIC 9(04) VALUE 0.           01130003
011400       10 PV-SLASH-1                 PIC X(01) VALUE SPACE.       01140003
011500       10 PV-POSTING-MM-REFORMAT     PIC 9(02) VALUE 0.           01150003
011600       10 PV-SLASH-2                 PIC X(01) VALUE SPACE.       01160003
011700       10 PV-POSTING-DD-REFORMAT     PIC 9(02) VALUE 0.           01170003
011800    05 PV-POSTING-DATE-HOLD.                                      01180003
011900       10 PV-POSTING-CCYY            PIC 9(04) VALUE 0.           01190003
012000       10 PV-POSTING-MM              PIC 9(02) VALUE 0.           01200003
012100       10 PV-POSTING-DD              PIC 9(02) VALUE 0.           01210003
012200                                                                  01220003
012300 01 PA-PROGRAM-ACCUMULATORS.                                      01230003
012400    05 PA-TOTAL-ACCUM               PIC S9(13)V99 COMP-3 VALUE 0. 01240015
012500    05 PA-ACCT-RECVBLE-CREDIT       PIC S9(11)V99 COMP-3 VALUE 0. 01250015
012600    05 PA-ACCT-RECVBLE-DEBIT        PIC S9(11)V99 COMP-3 VALUE 0. 01260015
012700    05 PA-CREDIT-GRAND-TOT-ACCUM    PIC S9(13)V99 COMP-3 VALUE 0. 01270015
012800    05 PA-DEBIT-GRAND-TOT-ACCUM     PIC S9(13)V99 COMP-3 VALUE 0. 01280015
012900 01 WU-WKLY-UPD-ACT-RCVBLE-REC.                                   01290003
013000     05  FILLER                       PIC   X(05) VALUE 'KDS'.    01300003
013100     05  WU-AR-ACCOUNT                PIC   X(10).                01310003
013200     05  FILLER                       PIC   X(16) VALUE SPACES.   01320003
013300     05  FILLER                       PIC   X(01) VALUE 'N'.      01330003
013400     05  WU-AR-STORE                  PIC   X(04).                01340003
013500     05  WU-AR-POSTING-DATE           PIC   X(08).                01350003
013600     05  WU-AR-DB-CR-IND              PIC   X(01).                01360003
013700         88  WU-AR-DEBIT                    VALUE 'D'.            01370003
013800         88  WU-AR-CREDIT                   VALUE 'C'.            01380003
013900     05  WU-AR-AMOUNT                 PIC   9(23)V999.            01390003
014000     05  FILLER                       PIC   X(01) VALUE SPACES.   01400003
014100     05  FILLER                       PIC   9(13)V99 VALUE ZEROS. 01410003
014200     05  FILLER                       PIC   X(03) VALUE SPACES.   01420003
014300     05  WU-AR-DESCRIPTION            PIC   X(30).                01430003
014400     05  FILLER                       PIC   X(71) VALUE SPACES.   01440003
014500 01 WU-WKLY-UPD-ACT-SUMMARY-REC.                                  01450003
014600     05  FILLER                       PIC   X(05) VALUE 'KDS'.    01460003
014700     05  WU-ACCOUNT                   PIC   X(10).                01470003
014800     05  FILLER                       PIC   X(16) VALUE SPACES.   01480003
014900     05  FILLER                       PIC   X(01) VALUE 'N'.      01490003
015000     05  WU-STORE                     PIC   X(04).                01500003
015100     05  WU-POSTING-DATE              PIC   X(08).                01510003
015200     05  WU-DB-CR-IND                 PIC   X(01).                01520003
015300         88  WU-DEBIT                    VALUE 'D'.               01530003
015400         88  WU-CREDIT                   VALUE 'C'.               01540003
015500     05  WU-AMOUNT                    PIC   9(23)V999.            01550003
015600     05  FILLER                       PIC   X(01) VALUE SPACES.   01560003
015700     05  FILLER                       PIC   9(13)V99 VALUE ZEROS. 01570003
015800     05  FILLER                       PIC   X(03) VALUE SPACES.   01580003
015900     05  WU-DESCRIPTION               PIC   X(30).                01590003
016000     05  FILLER                       PIC   X(71) VALUE SPACES.   01600003
016100                                                                  01610003
016200 01 PS-PROGRAM-SWITCHES.                                          01620003
016300    05 PS-END-OF-FILE-IND            PIC  X(01)    VALUE ' '.     01630003
016400       88 PS-EOF                                   VALUE 'E'.     01640003
016500    05 PS-INPUT-FILE-EMPTY-SW        PIC  X(01)    VALUE ' '.     01650003
016600       88 PS-INPUT-FILE-EMPTY                      VALUE 'E'.     01660003
016700    05 PS-INPUT-PROCESSED-INF        PIC  X(01)    VALUE ' '.     01670003
016800       88 PS-INPUT-PROCESSED                       VALUE 'P'.     01680003
016900    05 PS-FIRST-TIME-THRU-IND        PIC  X(01)    VALUE 'Y'.     01690003
017000       88 FIRST-TIME-THRU                          VALUE 'Y'.     01700003
017100       88 NOT-FIRST-TIME-THRU                      VALUE 'N'.     01710003
017200 01 GL-ADD-TO-SUMMARY-TABLE.                                      01720003
017300    05 GL-ADD-TO-SUMMARY-DATA  OCCURS 2 TIMES.                    01730003
017400       10 GL-SUMMARY-UPDATE-RECORD       PIC X(80).               01740003
017500                                                                  01750003
017600*** STANDARD HEADER LINE - 132 BYTES.                             01760003
017700     COPY DPWS132O.                                               01770003
017800     COPY DPWS500.                                                01780003
017900                                                                  01790003
018000****                                                              01800003
018100 01 GL-UPDATE-DAILY-REPORT-AREA.                                  01810003
018200    05 GL-HEADER-LINE-2.                                          01820003
018300       10 FILLER                     PIC  X(42)      VALUE SPACE. 01830003
018400       10 FILLER                     PIC  X(49)      VALUE        01840003
018500       'KOHLS CREDIT GENERAL LEDGER WEEKLY POSTING REPORT'.       01850003
018600       10 FILLER                     PIC  X(41)      VALUE SPACE. 01860003
018700                                                                  01870003
018800    05 GL-HEADER-LINE-3.                                          01880003
018900       10 FILLER                     PIC  X(56)      VALUE SPACE. 01890003
019000       10 FILLER                     PIC  X(13)      VALUE        01900003
019100                                                 'POSTING DATE '. 01910003
019200       10 GL-MM                      PIC 9(02).                   01920003
019300       10 FILLER                     PIC X(01) VALUE '/'.         01930003
019400       10 GL-DD                      PIC 9(02).                   01940003
019500       10 FILLER                     PIC X(01) VALUE '/'.         01950003
019600       10 GL-CCYY                    PIC 9(04).                   01960003
019700       10 FILLER                     PIC  X(55)      VALUE SPACE. 01970003
019800                                                                  01980003
019900    05 GL-HEADER-LINE-4.                                          01990003
020000       10 FILLER                     PIC  X(05)      VALUE SPACE. 02000003
020100       10 FILLER                     PIC  X(15)      VALUE        02010003
020200                                               'G/L ACCT NUMBER'. 02020003
020300       10 FILLER                     PIC  X(06)      VALUE SPACE. 02030003
020400       10 FILLER                     PIC  X(05)      VALUE        02040003
020500                                                'DR/CR'.          02050003
020600       10 FILLER                     PIC  X(06)      VALUE SPACE. 02060003
020700       10 FILLER                     PIC  X(23)      VALUE        02070003
020800                                       'TRANSACTION DESCRIPTION'. 02080003
020900       10 FILLER                     PIC  X(13)      VALUE SPACE. 02090003
021000       10 FILLER                     PIC  X(10)      VALUE        02100003
021100                                       'TRANS DATE'.              02110003
021200       10 FILLER                     PIC  X(07)      VALUE SPACE. 02120003
021300       10 FILLER                     PIC  X(13)      VALUE        02130003
021400                                       'DAILY AMOUNTS'.           02140003
021500       10 FILLER                     PIC  X(08)      VALUE SPACE. 02150003
021600       10 FILLER                     PIC  X(13)      VALUE        02160003
021700                                       'TOTAL AMOUNTS'.           02170003
021800       10 FILLER                     PIC  X(08)      VALUE SPACE. 02180003
021900    05 GL-DETAIL-LINE.                                            02190003
022000       10 FILLER                     PIC  X(05)      VALUE SPACE. 02200008
022100       10 GL-ASTERISK                PIC  X(01)      VALUE SPACE. 02210003
022200       10 GL-STORE-NBR               PIC  X(04).                  02220004
022300       10 FILLER                     PIC  X(01)      VALUE SPACE. 02230003
022400       10 GL-ACCOUNT-NUMBER          PIC  Z(07).                  02240003
022500       10 FILLER                     PIC  X(09)      VALUE SPACE. 02250003
022600       10 GL-CR-DB                   PIC  X(02).                  02260003
022700       10 FILLER                     PIC  X(08)      VALUE SPACE. 02270003
022800       10 GL-TRANS-DESCRIPTION       PIC  X(32).                  02280003
022900       10 FILLER                     PIC  X(05)      VALUE SPACE. 02290003
023000       10 GL-TRANS-DATE              PIC  X(08).                  02300003
023100       10 FILLER                     PIC  X(08)      VALUE SPACE. 02310003
023200       10 GL-DAILY-AMT               PIC  ZZ,ZZZ,ZZZ,ZZZ.ZZ.      02320018
023300       10 GL-DAILY-SIGN              PIC  X(01)      VALUE SPACE. 02330003
023400       10 FILLER                     PIC  X(05)      VALUE SPACE. 02340015
023500       10 GL-ACCT-RECVBLE-TOT        PIC  X(18)      VALUE SPACE. 02350015
023600       10 GL-TOT-SIGN                PIC  X(01)      VALUE SPACE. 02360003
023700*      10 FILLER                     PIC  X(02)      VALUE SPACE. 02370015
023800    05 GL-TOTAL-LINE.                                             02380003
023900       10 FILLER                     PIC  X(77)      VALUE SPACE. 02390003
024000       10 FILLER                     PIC  X(05)      VALUE        02400003
024100                                     'TOTAL'.                     02410003
024200       10 FILLER                     PIC  X(29)      VALUE SPACE. 02420015
024300       10 GL-TOTAL-AMT               PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ.99.   02430018
024400       10 GL-TOTAL-SIGN              PIC  X(01)      VALUE SPACE. 02440003
024500*      10 FILLER                     PIC  X(00)      VALUE SPACE. 02450015
024600    05 GL-GRAND-TOTAL-LINE-1.                                     02460003
024700       10 FILLER                     PIC  X(77)      VALUE SPACE. 02470003
024800       10 FILLER                     PIC  X(28)      VALUE        02480003
024900                                     'GRAND TOTAL DEBITS'.        02490003
025000       10 FILLER                     PIC  X(05)      VALUE SPACE. 02500019
025100       10 GL-DEBIT-AMT               PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ.99.   02510018
025200       10 GL-DEBIT-PLUS              PIC  X(01)      VALUE '+'.   02520003
025300*      10 FILLER                     PIC  X(06)      VALUE SPACE. 02530015
025400    05 GL-GRAND-TOTAL-LINE-2.                                     02540003
025500       10 FILLER                     PIC  X(77)      VALUE SPACE. 02550003
025600       10 FILLER                     PIC  X(28)      VALUE        02560016
025700                                     'GRAND TOTAL CREDITS'.       02570003
025800       10 FILLER                     PIC  X(05)      VALUE SPACE. 02580019
025900       10 GL-CREDIT-AMT              PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ.99.   02590018
026000       10 GL-DEBIT-MINUS             PIC  X(01)      VALUE '-'.   02600003
026100*      10 FILLER                     PIC  X(06)      VALUE SPACE. 02610015
026200    05 GL-EMPTY-LINE                 PIC  X(132) VALUE SPACE.     02620003
026300    05 GL-NO-ACTIVITY-MSG.                                        02630003
026400       10 FILLER                     PIC  X(05)      VALUE SPACE. 02640003
026500       10 FILLER                     PIC  X(32)      VALUE        02650003
026600                         '*** THERE WAS NO GL ACTIVITY ***'.      02660003
026700       10 FILLER                     PIC  X(95)      VALUE SPACE. 02670003
026800                                                                  02680003
026810*-------------------------------------------------------          02681005
026820* INPUT COPYBOOK                                                  02682005
026830*-------------------------------------------------------          02683005
026900     COPY ARRD022.                                                02690003
026910                                                                  02691005
027000********************************************************          02700003
027100 PROCEDURE DIVISION.                                              02710003
027200********************************************************          02720003
027300 0000-MAIN.                                                       02730003
027400     PERFORM 1000-INITIALIZATION       THRU 1000-EXIT.            02740003
027500     PERFORM 2000-PROCESS-INPUT        THRU 2000-EXIT             02750003
027600                            UNTIL PS-INPUT-PROCESSED              02760003
027700     IF PS-INPUT-FILE-EMPTY                                       02770003
027800        CONTINUE                                                  02780003
027900     ELSE                                                         02790003
028000        PERFORM 3000-WRITE-ACT-RECVBLE-RPT-DET                    02800003
028100                                         THRU 3000-EXIT           02810003
028200        PERFORM 4000-WRITE-GRAND-TOTALS  THRU 4000-EXIT           02820003
028300     END-IF.                                                      02830003
028400                                                                  02840003
028500     PERFORM     5000-FINISH   THRU 5000-EXIT.                    02850003
028600                                                                  02860003
028700 0000-EXIT.  STOP RUN.                                            02870003
028800                                                                  02880003
028900 1000-INITIALIZATION.                                             02890003
029000       ACCEPT PV-SYSTEM-DATE      FROM DATE.                      02900003
029100       MOVE PV-SYSTEM-MM      TO DP132O-RUN-MONTH.                02910003
029200*                               GL-MM.                            02920003
029300       MOVE PV-SYSTEM-DD      TO DP132O-RUN-DAY.                  02930003
029400*                               GL-DD.                            02940003
029500       MOVE PV-SYSTEM-YY      TO DP132O-RUN-YEAR.                 02950003
029600*                               GL-YY.                            02960003
029700                                                                  02970003
029800       ACCEPT PV-CURRENT-TIME     FROM TIME.                      02980003
029900       MOVE PV-CURRENT-HH     TO DP132O-RUN-HOUR.                 02990003
030000       MOVE PV-CURRENT-MM     TO DP132O-RUN-MINUTE.               03000003
030100                                                                  03010003
030200       MOVE PC-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.             03020003
030300       MOVE PC-REPORT-NBR     TO DP132O-REPORT-NUMBER.            03030003
030400                                                                  03040003
030500       PERFORM 1050-GET-POSTING-DATE  THRU 1050-EXIT.             03050003
030600                                                                  03060003
030700       INITIALIZE AR022-GL-INTERFACE.                             03070003
030800                                                                  03080003
030900       OPEN INPUT     GL-UPDATE-SUMMARY-FILE                      03090003
031000            OUTPUT    GL-UPDATE-WEEKLY-FILE                       03100003
031100                      GL-UPDATE-WEEKLY-REPORT.                    03110003
031200                                                                  03120003
031300       READ GL-UPDATE-SUMMARY-FILE INTO AR022-GL-INTERFACE        03130003
031400            AT END                                                03140003
031500                   DISPLAY '***********************************'  03150003
031600                   DISPLAY 'FROM ARKUT035: INPUT FILE IS EMPTY.'  03160003
031700                   DISPLAY '***********************************'  03170003
031800                   PERFORM 2300-REPORT-HEADERS     THRU 2300-EXIT 03180003
031900                   SET PS-INPUT-PROCESSED   TO TRUE               03190003
032000                   SET PS-INPUT-FILE-EMPTY  TO TRUE               03200003
032100                   WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM       03210003
032200                                             GL-NO-ACTIVITY-MSG   03220003
032300                         AFTER ADVANCING 2 LINES                  03230003
032400       END-READ.                                                  03240003
032500 1000-EXIT.  EXIT.                                                03250003
032600*----------------------------------------------------------------*03260003
032700* JOB EXECUTING THIS PROGRAM RUNS ON SUNDAYS. IF THERE IS A      *03270003
032800* DELAY IN THE SELECT SYSTEM, IT MIGHT RUN ON MONDAY  OR EVEN ON *03280003
032900* TUESDAY. THIS ROUTINE WILL GET THE RIGHT POSTING DATE (LAST    *03290003
033000* SATURDAY DATE).                                                *03300003
033100*----------------------------------------------------------------*03310003
033200 1050-GET-POSTING-DATE.                                           03320003
033300       MOVE PV-SYSTEM-MM              TO PV-WORK-MM.              03330003
033400       MOVE PV-SYSTEM-DD              TO PV-WORK-DD.              03340003
033500       MOVE PV-SYSTEM-YY              TO PV-WORK-YY.              03350003
033600       MOVE PV-SYSTEM-DATE            TO DPG51-SYSTEM-DATE.       03360003
033700       SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                    03370003
033800       SET DPG51-DECREMENT-DATE       TO TRUE.                    03380003
033900       SET DPG52-LK-DTE-GREG          TO TRUE.                    03390003
034000       MOVE PC-BACK-TO-PREV-WEEK      TO                          03400003
034100                                       DPG51-INCR-DECR-BUS-DAYS-9.03410003
034200       MOVE PV-WORK-DATE              TO DPG52-LK-DATE-INPUT.     03420003
034300                                                                  03430003
034400       CALL PC-DATE-MODULE   USING DPG51 DPG52 DPG53              03440003
034500                                   DPG54 DPG55 DPG56.             03450003
034600       IF (DPG54-NO-ERROR       OR                                03460003
034700           DPG54-WARNING-ERROR) AND                               03470003
034800           DPG54-DATE-VALID                                       03480003
034900           CONTINUE                                               03490003
035000       ELSE                                                       03500003
035100           IF DPG54-DATE-INVALID                                  03510003
035200             DISPLAY '*** ABEND ***'                              03520003
035300             DISPLAY '*** PROGRAM = ' PC-PROGRAM-NAME             03530003
035400             DISPLAY '*** PARA = 0001-INITIALIZATION'             03540003
035500             DISPLAY '*** BAD RESPONCE FROM DATE ROUTINE ***'     03550003
035600             MOVE  +4008  TO PV-ABEND-CODE                        03560003
035700             CALL 'ILBOABN0' USING PV-ABEND-CODE                  03570020
035800           END-IF                                                 03580003
035900       END-IF.                                                    03590003
036000       MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO  PV-POSTING-REFORMAT.   03600003
036100       MOVE PV-POSTING-CCYY-REFORMAT   TO PV-POSTING-CCYY         03610003
036200                                          GL-CCYY.                03620003
036300       MOVE PV-POSTING-MM-REFORMAT     TO PV-POSTING-MM           03630003
036400                                          GL-MM.                  03640003
036500       MOVE PV-POSTING-DD-REFORMAT     TO PV-POSTING-DD           03650003
036600                                          GL-DD.                  03660003
036700 1050-EXIT.  EXIT.                                                03670003
036800                                                                  03680003
036900 2000-PROCESS-INPUT.                                              03690003
037000      IF FIRST-TIME-THRU                                          03700003
037100         MOVE AR022-ACCOUNT      TO PV-ACCOUNT-HOLD               03710003
037200         MOVE AR022-STORE        TO PV-STORE-HOLD                 03720003
037300         MOVE AR022-DB-CR-IND    TO PV-DB-CR-IND-HOLD             03730003
037310         MOVE AR022-DESCRIPTION  TO PV-DESCRIPTION                03731013
037400       END-IF.                                                    03740014
037500                                                                  03750003
037600      IF PS-EOF                                                   03760003
037700         MOVE PA-TOTAL-ACCUM      TO  WU-AR-AMOUNT                03770003
037800                                      WU-AMOUNT                   03780003
037900         PERFORM 2100-WRITE-OUTPUT-FILE THRU 2100-EXIT            03790003
038000         MOVE PA-TOTAL-ACCUM      TO GL-TOTAL-AMT                 03800003
038100         IF PV-DEBIT                                              03810003
038200            MOVE PC-PLUS   TO GL-TOTAL-SIGN                       03820003
038300         ELSE                                                     03830003
038400            MOVE PC-MINUS  TO GL-TOTAL-SIGN                       03840003
038500         END-IF                                                   03850003
038600                                                                  03860003
038700         WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                 03870003
038800                                      GL-TOTAL-LINE               03880003
038900              AFTER ADVANCING 2 LINES                             03890003
039000         ADD   2                  TO PV-LINE-COUNT                03900003
039100         PERFORM 2200-ACCUM-GRAND-TOTALS  THRU 2200-EXIT          03910003
039200         SET PS-INPUT-PROCESSED  TO TRUE                          03920003
039300         GO TO 2000-EXIT                                          03930003
039400      END-IF                                                      03940003
039500                                                                  03950003
039600      PERFORM 2300-REPORT-HEADERS       THRU 2300-EXIT.           03960003
039700      PERFORM 2400-ACCOUNT-DETAILS      THRU 2400-EXIT.           03970003
039800      PERFORM 2900-READ-INPUT-FILE      THRU 2900-EXIT.           03980003
039900 2000-EXIT.  EXIT.                                                03990003
040000                                                                  04000003
040100 2100-WRITE-OUTPUT-FILE.                                          04010003
040200          WRITE   GL-UPDATE-WEEKLY-RECORD FROM                    04020003
040300                                  WU-WKLY-UPD-ACT-SUMMARY-REC.    04030011
040400*         IF (PV-ACCOUNT-HOLD  = PC-ACT-0020116 AND PV-DEBIT)     04040010
040500*            OR                                                   04050010
040600*            (PV-ACCOUNT-HOLD  = PC-ACT-0010102 AND PV-CREDIT)    04060010
040700*            CONTINUE                                             04070010
040800*         ELSE                                                    04080010
040900*            WRITE   GL-UPDATE-WEEKLY-RECORD FROM                 04090010
041000*                                 WU-WKLY-UPD-ACT-RCVBLE-REC      04100010
041100*         END-IF.                                                 04110010
041200 2100-EXIT.  EXIT.                                                04120003
041300                                                                  04130003
041400 2200-ACCUM-GRAND-TOTALS.                                         04140003
041500      IF PV-CREDIT                                                04150003
041600         ADD  PA-TOTAL-ACCUM  TO PA-CREDIT-GRAND-TOT-ACCUM        04160003
041700         MOVE PA-TOTAL-ACCUM  TO GL-CREDIT-AMT                    04170003
041800       ELSE                                                       04180003
041900         ADD  PA-TOTAL-ACCUM  TO PA-DEBIT-GRAND-TOT-ACCUM         04190003
042000         MOVE PA-TOTAL-ACCUM  TO GL-DEBIT-AMT                     04200003
042100      END-IF.                                                     04210003
042200 2200-EXIT.  EXIT.                                                04220003
042300                                                                  04230003
042400 2300-REPORT-HEADERS.                                             04240003
042500     IF PV-LINE-COUNT > 60                                        04250003
042600        ADD  1                 TO PV-PAGE-COUNT                   04260003
042700        MOVE PV-PAGE-COUNT                                        04270003
042800                               TO DP132O-PAGE-NUMBER              04280003
042900        MOVE 0                 TO PV-LINE-COUNT                   04290003
043000        WRITE GL-UPDATE-WEEKLY-RPT-RECORD FROM                    04300003
043100                             DP132O-STANDRD-HEADER-132-COLS       04310003
043200               AFTER ADVANCING PAGE                               04320003
043300        WRITE GL-UPDATE-WEEKLY-RPT-RECORD FROM                    04330003
043400                                        GL-HEADER-LINE-2          04340003
043500               AFTER ADVANCING 2 LINE                             04350003
043600        WRITE GL-UPDATE-WEEKLY-RPT-RECORD FROM                    04360003
043700                                        GL-HEADER-LINE-3          04370003
043800               AFTER ADVANCING 1 LINE                             04380003
043900        WRITE GL-UPDATE-WEEKLY-RPT-RECORD FROM                    04390003
044000                                        GL-HEADER-LINE-4          04400003
044100               AFTER ADVANCING 2 LINES                            04410003
044200        ADD  11                TO PV-LINE-COUNT                   04420003
044300                                                                  04430003
044400     END-IF.                                                      04440003
044500 2300-EXIT.  EXIT.                                                04450003
044600                                                                  04460003
044700 2400-ACCOUNT-DETAILS.                                            04470003
044800       EVALUATE TRUE                                              04480003
044900           WHEN  FIRST-TIME-THRU                                  04490003
045000           WHEN  AR022-STORE      NOT = PV-STORE-HOLD             04500003
045100           WHEN  AR022-ACCOUNT    NOT = PV-ACCOUNT-HOLD           04510003
045200           WHEN  AR022-DB-CR-IND  NOT = PV-DB-CR-IND-HOLD         04520003
045210           WHEN  AR022-DESCRIPTION NOT = PV-DESCRIPTION           04521013
045300               PERFORM 2210-FINISH-OLD-START-NEW-ACCT             04530003
045400                                             THRU 2210-EXIT       04540003
045500           WHEN  OTHER                                            04550003
045600               PERFORM 2220-WRITE-DETAIL-LINE THRU 2220-EXIT      04560003
045700               PERFORM 2230-ACCUMULATE-TOTALS THRU 2230-EXIT      04570003
045800               PERFORM 2240-CREATE-ACT-REC-OFFSETS                04580003
045900                                              THRU 2240-EXIT      04590003
046000       END-EVALUATE.                                              04600003
046100 2400-EXIT.  EXIT.                                                04610003
046200                                                                  04620003
046300 2210-FINISH-OLD-START-NEW-ACCT.                                  04630003
046400      IF FIRST-TIME-THRU                                          04640003
046500         SET NOT-FIRST-TIME-THRU   TO TRUE                        04650003
046600      ELSE                                                        04660003
046700          MOVE PA-TOTAL-ACCUM      TO GL-TOTAL-AMT                04670003
046800                                      WU-AR-AMOUNT                04680003
046900                                      WU-AMOUNT                   04690003
047000          IF PV-DEBIT                                             04700003
047100             MOVE PC-PLUS   TO GL-TOTAL-SIGN                      04710003
047200          ELSE                                                    04720003
047300             MOVE PC-MINUS  TO GL-TOTAL-SIGN                      04730003
047400          END-IF                                                  04740003
047500                                                                  04750003
047600          WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                04760003
047700                                      GL-TOTAL-LINE               04770003
047800              AFTER ADVANCING 2 LINES                             04780003
047900          ADD   2              TO PV-LINE-COUNT                   04790003
048000          PERFORM 2100-WRITE-OUTPUT-FILE  THRU 2100-EXIT          04800003
048100          PERFORM 2200-ACCUM-GRAND-TOTALS  THRU 2200-EXIT         04810003
048200          MOVE  0              TO PA-TOTAL-ACCUM                  04820003
048300      END-IF.                                                     04830003
048400                                                                  04840003
048500     IF PS-EOF                                                    04850003
048600        GO TO 2210-EXIT                                           04860003
048700     END-IF.                                                      04870003
048800                                                                  04880003
048900     IF (AR022-ACCOUNT =  PC-ACT-0020116 AND AR022-DEBIT)         04890003
049000        OR                                                        04900003
049100        (AR022-ACCOUNT =  PC-ACT-0010102 AND AR022-CREDIT)        04910003
049200        MOVE '*'       TO GL-ASTERISK                             04920003
049300     ELSE                                                         04930003
049400        MOVE ' '       TO GL-ASTERISK                             04940003
049500     END-IF                                                       04950003
049600                                                                  04960003
049700     MOVE AR022-STORE          TO GL-STORE-NBR.                   04970003
049800     MOVE AR022-ACCOUNT        TO GL-ACCOUNT-NUMBER.              04980003
049900     IF AR022-CREDIT                                              04990003
050000        MOVE PC-CREDIT      TO GL-CR-DB                           05000003
050100     ELSE                                                         05010003
050200        MOVE PC-DEBIT       TO GL-CR-DB                           05020003
050300     END-IF.                                                      05030003
050400     MOVE AR022-DESCRIPTION    TO GL-TRANS-DESCRIPTION.           05040003
050500     STRING AR022-DATE-MM                                         05050003
050600           '/'                                                    05060003
050700           AR022-DATE-DD                                          05070003
050800           '/'                                                    05080003
050900           AR022-DATE-YY                                          05090003
051000         DELIMITED BY SIZE                                        05100003
051100         INTO GL-TRANS-DATE                                       05110003
051200     END-STRING.                                                  05120003
051300     MOVE AR022-AMOUNT         TO GL-DAILY-AMT.                   05130003
051400     IF AR022-DEBIT                                               05140003
051500        MOVE PC-PLUS           TO GL-DAILY-SIGN                   05150003
051600     ELSE                                                         05160003
051700        MOVE PC-MINUS          TO GL-DAILY-SIGN                   05170003
051800     END-IF.                                                      05180003
051900                                                                  05190003
052000     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     05200003
052100                                        GL-EMPTY-LINE.            05210003
052200     ADD 1                     TO PV-LINE-COUNT.                  05220003
052300                                                                  05230003
052400     PERFORM 2215-SAVE-ACT-INFO         THRU 2215-EXIT.           05240003
052500     PERFORM 2220-WRITE-DETAIL-LINE     THRU 2220-EXIT.           05250003
052600                                                                  05260003
052700     MOVE ' '                  TO GL-ASTERISK.                    05270003
052800     MOVE SPACE                TO GL-STORE-NBR.                   05280003
052900     MOVE ZEROS                TO GL-ACCOUNT-NUMBER.              05290003
053000     MOVE SPACE                TO GL-CR-DB.                       05300003
053100     MOVE SPACE                TO GL-TRANS-DESCRIPTION.           05310003
053200     IF AR022-STORE   NOT = PV-STORE-HOLD                         05320003
053300        MOVE AR022-STORE    TO PV-STORE-HOLD                      05330003
053400     END-IF                                                       05340003
053500     IF AR022-ACCOUNT NOT = PV-ACCOUNT-HOLD                       05350003
053600        MOVE AR022-ACCOUNT  TO PV-ACCOUNT-HOLD                    05360003
053700     END-IF                                                       05370003
053800     IF AR022-DB-CR-IND NOT = PV-DB-CR-IND-HOLD                   05380003
053900        MOVE AR022-DB-CR-IND  TO PV-DB-CR-IND-HOLD                05390003
054000     END-IF                                                       05400003
054010     IF AR022-DESCRIPTION NOT = PV-DESCRIPTION                    05401013
054020        MOVE AR022-DESCRIPTION TO PV-DESCRIPTION                  05402013
054030     END-IF                                                       05403013
054100                                                                  05410003
054110* 4/21/06 LAS COMMENT OUT WRITE OF SETTING TRANSACTIONS           05411012
054120* OFFSETS NOW COMING FROM TANDEM.                                 05412012
054200*    PERFORM 2225-ACCOUNT-RECVBL-TRADE        THRU 2225-EXIT      05420009
054300     PERFORM 2230-ACCUMULATE-TOTALS           THRU 2230-EXIT      05430003
054400     PERFORM 2240-CREATE-ACT-REC-OFFSETS      THRU 2240-EXIT.     05440003
054500 2210-EXIT.  EXIT.                                                05450003
054600                                                                  05460003
054700 2215-SAVE-ACT-INFO.                                              05470003
054800****   MOVE AR022-GL-INTERFACE    TO WU-WKLY-UPD-ACT-SUMMARY-REC. 05480003
054900                                                                  05490003
055000       MOVE AR022-ACCOUNT         TO PV-TEMP-ACCOUNT-N.           05500003
055100       MOVE PV-TEMP-ACCOUNT-N     TO PV-TEMP-ACCOUNT.             05510003
055200       IF PV-TEMP-ACCOUNT-1 = "0"                                 05520003
055300          MOVE PV-TEMP-ACCOUNT-5  TO WU-ACCOUNT                   05530003
055400       ELSE                                                       05540003
055500          MOVE PV-TEMP-ACCOUNT    TO WU-ACCOUNT                   05550003
055600       END-IF.                                                    05560003
055700                                                                  05570003
055800       MOVE AR022-DESCRIPTION     TO WU-DESCRIPTION.              05580003
055900       MOVE AR022-STORE           TO WU-STORE.                    05590003
056000       IF AR022-CREDIT                                            05600003
056100          SET WU-CREDIT TO TRUE                                   05610003
056200       ELSE                                                       05620003
056300          SET WU-DEBIT TO TRUE                                    05630003
056400       END-IF.                                                    05640003
056500       MOVE PV-POSTING-DATE-HOLD  TO WU-POSTING-DATE.             05650003
056600       MOVE 0                     TO WU-AMOUNT.                   05660003
056700 2215-EXIT.  EXIT.                                                05670003
056800                                                                  05680003
056900 2220-WRITE-DETAIL-LINE.                                          05690003
057000     STRING AR022-DATE-MM                                         05700003
057100            '/'                                                   05710003
057200            AR022-DATE-DD                                         05720003
057300            '/'                                                   05730003
057400            AR022-DATE-YY                                         05740003
057500          DELIMITED BY SIZE                                       05750003
057600          INTO GL-TRANS-DATE                                      05760003
057700      END-STRING                                                  05770003
057800     MOVE AR022-AMOUNT         TO GL-DAILY-AMT                    05780003
057900     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     05790003
058000                                  GL-DETAIL-LINE                  05800003
058100           AFTER ADVANCING 1 LINE.                                05810003
058200     ADD   1                    TO PV-LINE-COUNT.                 05820003
058300 2220-EXIT.  EXIT.                                                05830003
058400                                                                  05840003
058500*2225-ACCOUNT-RECVBL-TRADE.                                       05850009
058600*    MOVE  PC-STORE-880           TO WU-AR-STORE.                 05860009
058700*                                                                 05870009
058800*    MOVE  PC-ACT-RECEIVABLE      TO WU-AR-ACCOUNT.               05880009
058900*    MOVE  0                      TO WU-AR-AMOUNT.                05890009
059000*    IF AR022-CREDIT                                              05900009
059100*       SET WU-AR-DEBIT TO TRUE                                   05910009
059200*    ELSE                                                         05920009
059300*       SET WU-AR-CREDIT TO TRUE                                  05930009
059400*    END-IF.                                                      05940009
059500*    MOVE  AR022-DESCRIPTION      TO WU-AR-DESCRIPTION.           05950009
059600*    MOVE  PV-POSTING-DATE-HOLD   TO WU-AR-POSTING-DATE.          05960009
059700*2225-EXIT.  EXIT.                                                05970009
059800                                                                  05980003
059900 2230-ACCUMULATE-TOTALS.                                          05990003
060000        ADD AR022-AMOUNT     TO     PA-TOTAL-ACCUM.               06000003
060100 2230-EXIT.  EXIT.                                                06010003
060200                                                                  06020003
060300 2240-CREATE-ACT-REC-OFFSETS.                                     06030003
060400                                                                  06040003
060500*     IF (AR022-ACCOUNT = PC-ACT-0020116 AND AR022-DEBIT)         06050009
060600*        OR                                                       06060009
060700*        (AR022-ACCOUNT = PC-ACT-0010102 AND AR022-CREDIT)        06070009
060800*         CONTINUE                                                06080009
060900*     ELSE                                                        06090009
061000         IF PV-CREDIT                                             06100003
061100             ADD AR022-AMOUNT     TO  PA-ACCT-RECVBLE-DEBIT       06110003
061200         ELSE                                                     06120003
061300             ADD AR022-AMOUNT     TO  PA-ACCT-RECVBLE-CREDIT      06130003
061400*        END-IF                                                   06140009
061500      END-IF.                                                     06150003
061600 2240-EXIT.  EXIT.                                                06160003
061700                                                                  06170003
061800                                                                  06180003
061900 2900-READ-INPUT-FILE.                                            06190003
062000       INITIALIZE AR022-GL-INTERFACE.                             06200003
062100       READ GL-UPDATE-SUMMARY-FILE INTO AR022-GL-INTERFACE        06210003
062200         AT END                                                   06220003
062300            SET PS-EOF    TO TRUE                                 06230003
062400       END-READ.                                                  06240003
062500 2900-EXIT.  EXIT.                                                06250003
062600                                                                  06260003
062700 3000-WRITE-ACT-RECVBLE-RPT-DET.                                  06270003
062800                                                                  06280003
062900     MOVE ' '                       TO GL-ASTERISK.               06290003
063000     MOVE PC-STORE-880              TO GL-STORE-NBR.              06300003
063100     MOVE PC-ACT-RECEIVABLE         TO GL-ACCOUNT-NUMBER.         06310003
063200     MOVE PC-DEBIT                  TO GL-CR-DB.                  06320003
063300     MOVE PC-ACT-RECVBLE-DESCR      TO GL-TRANS-DESCRIPTION.      06330003
063400     MOVE SPACE                     TO GL-TRANS-DATE.             06340003
063500     MOVE 0                         TO GL-DAILY-AMT.              06350003
063600     MOVE PA-ACCT-RECVBLE-DEBIT     TO PV-ACT-RECVBLE-AMT.        06360003
063700     MOVE PV-ACT-RECVBLE-AMT        TO GL-ACCT-RECVBLE-TOT.       06370003
063800     MOVE SPACE                     TO GL-DAILY-SIGN.             06380003
063900     MOVE PC-PLUS                   TO GL-TOT-SIGN.               06390003
064000                                                                  06400003
064100     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06410003
064200                                        GL-EMPTY-LINE             06420003
064300     ADD 1                        TO PV-LINE-COUNT                06430003
064400     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06440003
064500                                  GL-DETAIL-LINE                  06450003
064600           AFTER ADVANCING 1 LINE.                                06460003
064700     ADD   1                    TO PV-LINE-COUNT.                 06470003
064800                                                                  06480003
064900                                                                  06490003
065000     MOVE SPACE                   TO GL-STORE-NBR.                06500003
065100     MOVE ZEROS                   TO GL-ACCOUNT-NUMBER.           06510003
065200     MOVE PC-CREDIT               TO GL-CR-DB.                    06520003
065300     MOVE SPACE                   TO GL-TRANS-DESCRIPTION.        06530003
065400     MOVE SPACE                   TO GL-TRANS-DATE.               06540003
065500     MOVE PA-ACCT-RECVBLE-CREDIT  TO PV-ACT-RECVBLE-AMT           06550003
065600     MOVE PV-ACT-RECVBLE-AMT      TO GL-ACCT-RECVBLE-TOT.         06560003
065700     MOVE PC-MINUS                TO GL-TOT-SIGN.                 06570003
065800                                                                  06580003
065900     ADD 1                        TO PV-LINE-COUNT.               06590003
066000     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06600003
066100                                  GL-DETAIL-LINE                  06610003
066200           AFTER ADVANCING 1 LINE.                                06620003
066300     ADD   1                    TO PV-LINE-COUNT.                 06630003
066400 3000-EXIT.  EXIT.                                                06640003
066500                                                                  06650003
066600 4000-WRITE-GRAND-TOTALS.                                         06660003
066700     PERFORM 2300-REPORT-HEADERS     THRU 2300-EXIT.              06670003
066800                                                                  06680003
066900     ADD  PA-ACCT-RECVBLE-DEBIT      TO PA-DEBIT-GRAND-TOT-ACCUM  06690003
067000     ADD  PA-ACCT-RECVBLE-CREDIT     TO PA-CREDIT-GRAND-TOT-ACCUM 06700003
067100                                                                  06710003
067200     MOVE PA-DEBIT-GRAND-TOT-ACCUM   TO GL-DEBIT-AMT.             06720003
067300     MOVE PA-CREDIT-GRAND-TOT-ACCUM  TO GL-CREDIT-AMT.            06730003
067400     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06740003
067500                                     GL-EMPTY-LINE.               06750003
067600     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06760003
067700                                     GL-GRAND-TOTAL-LINE-1.       06770003
067800     WRITE GL-UPDATE-WEEKLY-RPT-RECORD   FROM                     06780003
067900                                     GL-GRAND-TOTAL-LINE-2.       06790003
068000 4000-EXIT.  EXIT.                                                06800003
068100                                                                  06810003
068200 5000-FINISH.                                                     06820003
068300     CLOSE  GL-UPDATE-SUMMARY-FILE                                06830003
068400            GL-UPDATE-WEEKLY-FILE                                 06840003
068500            GL-UPDATE-WEEKLY-REPORT.                              06850003
068600 5000-EXIT.  EXIT.                                                06860003
