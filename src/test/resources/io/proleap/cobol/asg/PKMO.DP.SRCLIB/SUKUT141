000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.   SUKUT141.                                          00050001
000600 AUTHOR.       RANDY DELAURA.                                     00060001
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070001
000800 DATE-WRITTEN. DECEMBER, 2008.                                    00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200*  THIS PROGRAM WILL UNSTRING DIRECTIVES FROM DEMATIC INTO COPY- *00120001
001300*  BOOK SURD086. RECORDS WILL THEN BE FORMATTED INTO OUTPUT COPY-*00130001
001400*  BOOK SURD050 FOR INPUT TO PGM SUKUT138.                       *00140016
001800******************************************************************00150001
001900******************************************************************00160001
002000 ENVIRONMENT DIVISION.                                            00170001
002100******************************************************************00180001
002200                                                                  00190001
002300 CONFIGURATION SECTION.                                           00200001
002400 SOURCE-COMPUTER.        IBM-3090.                                00210001
002500 OBJECT-COMPUTER.        IBM-3090.                                00220001
002600                                                                  00230001
002700 INPUT-OUTPUT SECTION.                                            00240001
002800 FILE-CONTROL.                                                    00250001
002900                                                                  00260001
003100     SELECT DEMATIC-INPUT-FILE            ASSIGN TO INP01.        00270002
003300     SELECT DEMATIC-EXTRACT-FILE          ASSIGN TO OUT01.        00280002
003500                                                                  00290001
003600******************************************************************00300001
003700 DATA DIVISION.                                                   00310001
003800******************************************************************00320001
003900                                                                  00330001
004000 FILE SECTION.                                                    00340001
004100                                                                  00350001
004900 FD  DEMATIC-INPUT-FILE                                           00360001
005000     RECORDING MODE IS V                                          00370001
005100     LABEL RECORDS ARE STANDARD                                   00380001
005110     BLOCK CONTAINS 701 RECORDS.                                  00390001
005120                                                                  00400001
005130 01  DEMATIC-INPUT-RECORD          PIC X(701).                    00410001
005140                                                                  00420001
005400 FD  DEMATIC-EXTRACT-FILE                                         00430001
005500     RECORDING MODE IS F                                          00440001
005600     LABEL RECORDS ARE STANDARD                                   00450001
005700     BLOCK CONTAINS 0 RECORDS.                                    00460001
005701                                                                  00470001
005702 01  DEMATIC-EXTRACT-RECORD        PIC X(1050).                   00480001
005710/                                                                 00490001
005720******************************************************************00500001
005730 WORKING-STORAGE SECTION.                                         00510001
005740******************************************************************00520001
005750                                                                  00530001
006300 01  PS-PROGRAM-SWITCHES.                                         00540001
006400     05  PS-END-OF-FILE-SW         PIC X(01)         VALUE 'N'.   00550002
006500         88  PS-END-OF-FILE                          VALUE 'Y'.   00560002
008100                                                                  00570001
008200 01  PC-PROGRAM-CONSTANTS.                                        00580001
008300     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)         VALUE        00590001
008400                                 'SUKUT141'.                      00600001
009400                                                                  00610001
009500 01  PV-PROGRAM-VARIABLES.                                        00620001
010500     05  PV-MASK                   PIC Z,ZZZ,Z99-.                00630011
010501     05  PV-INPUT-CNT              PIC S9(07) COMP-3 VALUE +0.    00640010
010502     05  PV-REFORMAT-CNT           PIC S9(07) COMP-3 VALUE +0.    00650010
010503     05  PV-ERROR-CNT              PIC S9(07) COMP-3 VALUE +0.    00660010
010504     05  PV-DELIMIT-CNT            PIC S9(03) COMP-3 VALUE +0.    00670010
010505     05  PV-DELIMIT-LIMIT          PIC S9(03) COMP-3 VALUE +34.   00680010
010507     05  PV-INPUT-AREA             PIC X(701)        VALUE SPACES.00690014
010510     05  PV-FORMAT-TMST.                                          00700003
010600         10  PV-FORMAT-TMST-DTE.                                  00710001
010700             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)    VALUE SPACES.00720001
010800             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)    VALUE '-'.   00730001
010900             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)    VALUE SPACES.00740001
011000             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)    VALUE '-'.   00750001
011100             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)    VALUE SPACES.00760001
011200             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)    VALUE '-'.   00770001
011300         10  PV-FORMAT-TMST-TM.                                   00780001
011400             15  PV-FORMAT-TMST-TM-HH   PIC X(02)    VALUE SPACES.00790001
011500             15  PV-FORMAT-TMST-TM-D1   PIC X(01)    VALUE '.'.   00800001
011600             15  PV-FORMAT-TMST-TM-MM   PIC X(02)    VALUE SPACES.00810001
011700             15  PV-FORMAT-TMST-TM-D2   PIC X(01)    VALUE '.'.   00820001
011800             15  PV-FORMAT-TMST-TM-SS   PIC X(02)    VALUE SPACES.00830001
011900             15  PV-FORMAT-TMST-TM-D3   PIC X(01)    VALUE '.'.   00840001
012000             15  PV-FORMAT-TMST-TM-NS   PIC X(06)    VALUE SPACES.00850001
013000/                                                                 00860001
013600******************************************************************00870001
013700*  OUTPUT DIRECTIVE TRACKING LAYOUT                               00880001
013800******************************************************************00890001
013900     COPY SURD050.                                                00900016
014000/                                                                 00910001
014600******************************************************************00920001
014700*  TEMPORARY COPYBOOK USED TO UNSTRING DEMATIC RAW DATA           00930001
014800******************************************************************00940001
014900     COPY SURD086.                                                00950016
024400/                                                                 00960001
024500******************************************************************00970001
024600 PROCEDURE DIVISION.                                              00980001
024700******************************************************************00990001
024800******************************************************************01000001
024900*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *01010001
025000******************************************************************01020001
025100 0000-PROGRAM-MAINLINE.                                           01030001
025200                                                                  01040001
025210     OPEN INPUT  DEMATIC-INPUT-FILE                               01050002
025220          OUTPUT DEMATIC-EXTRACT-FILE.                            01060002
025230                                                                  01070002
025300     PERFORM 1000-PROCESS-INPUT                                   01080002
025310        THRU 1000-PROCESS-INPUT-EXIT                              01090002
025320            UNTIL ( PS-END-OF-FILE ).                             01100002
025400                                                                  01110001
025401     PERFORM 8000-DISPLAY-CNTS                                    01120010
025402        THRU 8000-DISPLAY-CNTS-EXIT.                              01130010
025403                                                                  01140010
025410     CLOSE DEMATIC-INPUT-FILE                                     01150002
025420           DEMATIC-EXTRACT-FILE.                                  01160002
025430                                                                  01170002
026230     STOP RUN.                                                    01180001
026240/                                                                 01190001
026250******************************************************************01200001
026260* 1000-PROCESS-INPUT                                             *01210002
026270******************************************************************01220001
026280 1000-PROCESS-INPUT.                                              01230002
026290                                                                  01240001
026291     READ DEMATIC-INPUT-FILE INTO PV-INPUT-AREA                   01250014
026292         AT END SET PS-END-OF-FILE TO TRUE                        01260002
026293                GO TO 1000-PROCESS-INPUT-EXIT.                    01270002
026500                                                                  01280001
026501     ADD +1 TO PV-INPUT-CNT.                                      01290010
026502     INITIALIZE SU050-DIRECTIV-TRACKING-DATA.                     01300005
026503     MOVE PV-INPUT-AREA TO SU050-RAW-DATA.                        01310017
026504                                                                  01320005
026505     MOVE +0 TO PV-DELIMIT-CNT.                                   01330013
026505** ADDED CHECK TO REPLACE UPSIDE DOWN CARROT WITH '^'.            01340018
026505     INSPECT PV-INPUT-AREA                                        01350018
026505            REPLACING ALL X'B0' BY X'5F'.                         01360018
026506     INSPECT PV-INPUT-AREA                                        01370018
026507            TALLYING PV-DELIMIT-CNT FOR ALL '^'.                  01380010
026530                                                                  01390005
026540     IF ( PV-DELIMIT-CNT NOT = PV-DELIMIT-LIMIT )                 01400010
026550         MOVE 'X' TO SU050-RECORD-TYPE                            01410007
026560         PERFORM 2000-WRITE-OUTPUT                                01420007
026570            THRU 2000-WRITE-OUTPUT-EXIT                           01430007
026571         ADD +1   TO PV-ERROR-CNT                                 01440011
026580         GO TO 1000-PROCESS-INPUT-EXIT                            01450007
026590     END-IF.                                                      01460007
026591                                                                  01470007
026592     PERFORM 1010-UNSTRING                                        01480007
026593        THRU 1010-UNSTRING-EXIT.                                  01490007
027000     PERFORM 1050-FORMAT-OUTPUT                                   01500004
027100        THRU 1050-FORMAT-OUTPUT-EXIT.                             01510004
027110     PERFORM 2000-WRITE-OUTPUT                                    01520007
027120        THRU 2000-WRITE-OUTPUT-EXIT.                              01530007
027200                                                                  01540004
027300     ADD +1 TO PV-REFORMAT-CNT.                                   01550010
027400                                                                  01560010
028010 1000-PROCESS-INPUT-EXIT.                                         01570002
028020     EXIT.                                                        01580002
028100/                                                                 01590001
028110***************************************************************** 01600007
028120* 1010-UNSTRING                                                   01610007
028130******************************************************************01620007
028200 1010-UNSTRING.                                                   01630007
028201                                                                  01640007
028202     UNSTRING PV-INPUT-AREA DELIMITED BY '^'                      01650014
028203         INTO SU086-MESSAGE-TYPE-ONE                              01660007
028204              SU086-MESSAGE-TYPE-TWO                              01670007
028205              SU086-COMMAND                                       01680007
028206              SU086-CONTAINER-ID                                  01690007
028207              SU086-WAVE-ID                                       01700007
028208              SU086-ORDER-ID                                      01710007
028209              SU086-SHIPMENT-ID                                   01720007
028210              SU086-MINIMUM-WEIGHT                                01730007
028211              SU086-MAXIMUM-WEIGHT                                01740007
028212              SU086-EXPECTED-WEIGHT                               01750007
028213              SU086-CHECK-WEIGHT-FLAG                             01760007
028214              SU086-QC-FLAG                                       01770007
028215              SU086-EOW-FLAG                                      01780007
028216              SU086-PRIORITY                                      01790007
028217              SU086-MISSION-TYPE                                  01800007
028218              SU086-DIRECTIV-REASON-CDE                           01810007
028219              SU086-ORIG-CASI-CDE                                 01820007
028220              SU086-CURR-CASI-CDE                                 01830007
028221              SU086-CART-STAT-CDE                                 01840007
028222              SU086-AUD-GROUP-NBR                                 01850007
028223              SU086-AUD-STAT-CDE                                  01860007
028224              SU086-AUD-FALR-RSN-NM                               01870007
028225              SU086-AUD-CART-BEG-DTE                              01880007
028226              SU086-PO-LNE-NBR                                    01890007
028227              SU086-PRE-PACK-ID                                   01900007
028228              SU086-STR-ZN-ID                                     01910007
028229              SU086-VNDR-NAME                                     01920007
028230              SU086-SEASET-SHRT-NM                                01930007
028231              SU086-STR-NBR                                       01940007
028232              SU086-CRE-BY-USR-ID                                 01950007
028233              SU086-SEND-DTE                                      01960007
028234              SU086-SEND-TM                                       01970007
028235              SU086-COUNT-ELEMENTS                                01980007
028236              SU086-LOGICAL-DEST                                  01990007
028237              SU086-STATUS                                        02000007
028238     END-UNSTRING.                                                02010007
028239                                                                  02020007
028240 1010-UNSTRING-EXIT.                                              02030007
028300     EXIT.                                                        02040007
028400/                                                                 02050007
066722***************************************************************** 02060001
066723* 1050-FORMAT-OUTPUT                                              02070002
066725******************************************************************02080001
066726 1050-FORMAT-OUTPUT.                                              02090004
066740*                                                                 02100001
066750* KEY FIELDS                                                      02110001
066760*                                                                 02120001
066770     MOVE SU086-CONTAINER-ID  TO SU050-BRCD-NBR.                  02130004
066773     MOVE SU086-SEND-DTE-CCYY TO PV-FORMAT-TMST-DTE-CY.           02140004
066775     MOVE SU086-SEND-DTE-MM   TO PV-FORMAT-TMST-DTE-MM.           02150004
066777     MOVE SU086-SEND-DTE-DD   TO PV-FORMAT-TMST-DTE-DD.           02160004
066780     MOVE SU086-SEND-TM-HR    TO PV-FORMAT-TMST-TM-HH.            02170004
066782     MOVE SU086-SEND-TM-MIN   TO PV-FORMAT-TMST-TM-MM.            02180004
066784     MOVE SU086-SEND-TM-SEC   TO PV-FORMAT-TMST-TM-SS.            02190004
066786     MOVE SU086-SEND-TM-NS    TO PV-FORMAT-TMST-TM-NS.            02200004
066787     MOVE PV-FORMAT-TMST      TO SU050-CRE-TMST.                  02210008
066790*                                                                 02220001
066800* COMPARE-FIELDS                                                  02230001
066900*                                                                 02240001
067000     MOVE SU086-COMMAND              TO SU050-CNVYR-PRC-ACTN-CDE. 02250004
067100     MOVE SU086-ORDER-ID             TO SU050-PO-NBR.             02260007
067200     MOVE SU086-SHIPMENT-ID          TO SU050-RCVR-SEQ-NBR.       02270007
067300     MOVE SU086-PO-LNE-NBR           TO SU050-PO-LNE-NBR.         02280007
067400     MOVE SU086-DIRECTIV-REASON-CDE  TO SU050-DIRECTIV-REASON-CDE.02290007
067500     MOVE SU086-ORIG-CASI-CDE        TO SU050-ORIG-CASI-CDE.      02300007
067600     MOVE SU086-CURR-CASI-CDE        TO SU050-CURR-CASI-CDE.      02310007
067700     MOVE SU086-CART-STAT-CDE        TO SU050-CART-STAT-CDE.      02320007
067800     MOVE SU086-LOGICAL-DEST         TO SU050-LOGICAL-DEST.       02330007
067900     MOVE SU086-AUD-GROUP-NBR        TO SU050-AUD-CNTL-NBR.       02340007
067910     MOVE SU086-AUD-STAT-CDE         TO SU050-AUD-STAT-CDE.       02350007
067920     MOVE SU086-AUD-FALR-RSN-NM      TO SU050-AUD-FALR-RSN-NM.    02360007
067930                                                                  02370001
067962     MOVE SU086-AUD-CART-BEG-CCYY    TO SU050-AUD-CART-BEG-CCYY.  02380007
067963     MOVE SU086-AUD-CART-BEG-MM      TO SU050-AUD-CART-BEG-MM.    02390007
067964     MOVE SU086-AUD-CART-BEG-DD      TO SU050-AUD-CART-BEG-DD.    02400007
067965                                                                  02410007
067966     MOVE SU086-PRE-PACK-ID          TO SU050-PRE-PACK-ID.        02420007
067967     MOVE SU086-STR-ZN-ID            TO SU050-STR-ZN-ID.          02430007
067968     MOVE SU086-SEASET-SHRT-NM       TO SU050-SEASET-SHRT-NM.     02440007
067969     MOVE SU086-STR-NBR              TO SU050-STR-NBR.            02450007
067970     MOVE SU086-VNDR-NAME            TO SU050-VNDR-NAME.          02460007
067980     MOVE SU086-CRE-BY-USR-ID        TO SU050-CRE-BY-USR-ID.      02470007
067990     MOVE SU086-MISSION-TYPE         TO SU050-UNIQUE-IND.         02480007
068021                                                                  02490007
068023 1050-FORMAT-OUTPUT-EXIT.                                         02500006
068024     EXIT.                                                        02510006
068030/                                                                 02520001
068031******************************************************************02530007
068032* 2000-WRITE-OUTPUT                                               02540007
068034******************************************************************02550007
068040 2000-WRITE-OUTPUT.                                               02560007
068041                                                                  02570007
068042     INSPECT SU050-RAW-DATA                                       02580008
068043         REPLACING ALL LOW-VALUES BY SPACES.                      02590008
068044                                                                  02600008
068045     WRITE DEMATIC-EXTRACT-RECORD                                 02610008
068046         FROM SU050-DIRECTIV-TRACKING-DATA.                       02620008
068047                                                                  02630008
068048 2000-WRITE-OUTPUT-EXIT.                                          02640008
068050     EXIT.                                                        02650007
068060/                                                                 02660007
068070 8000-DISPLAY-CNTS.                                               02670010
068071                                                                  02680010
068072     DISPLAY '**********************************'.                02690011
068073     MOVE PV-INPUT-CNT    TO PV-MASK.                             02700010
068074     DISPLAY ' INPUT RECORDS READ: ' PV-MASK.                     02710010
068075     MOVE PV-REFORMAT-CNT TO PV-MASK.                             02720010
068076     DISPLAY 'RECORDS REFORMATTED: ' PV-MASK.                     02730010
068077     MOVE PV-ERROR-CNT    TO PV-MASK.                             02740010
068078     DISPLAY ' UNABLE TO REFORMAT: ' PV-MASK.                     02750010
068079     DISPLAY '**********************************'.                02760011
068080                                                                  02770010
068082 8000-DISPLAY-CNTS-EXIT.                                          02780010
068083     EXIT.                                                        02790010
