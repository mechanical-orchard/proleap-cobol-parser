000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    RCKUT186.                                         00050000
000600 AUTHOR.        DENISE HAHN                                       00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   NOVEMBER, 2021.                                   00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL TAKE THE SEPHORA SPLIT ASN FILE AND GENERATE  00120000
001300* ANOTHER FILE DOWN TO THE CARTON-UPC LEVEL                       00130000
001400*                                                                 00140000
001410* INPUT FILE IS FROM RCKUT181 - FORMAT RCRD001 (600 CHARACTERS)   00141000
001420* OUTPUT - FORMAT RCRD112 (1100 CHARACTERS)                       00142000
001450*                                                                 00145000
001507******************************************************************00150700
001508                                                                  00150800
001509******************************************************************00150900
001510 ENVIRONMENT DIVISION.                                            00151000
001520******************************************************************00152000
001530                                                                  00153000
001540 CONFIGURATION SECTION.                                           00154000
001550                                                                  00155000
001560 SOURCE-COMPUTER.        IBM-3090.                                00156000
001570 OBJECT-COMPUTER.        IBM-3090.                                00157000
001580                                                                  00158000
001590 INPUT-OUTPUT SECTION.                                            00159000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT ASN-SEPHORA-FILE                                      00190000
002000        ASSIGN TO INP01.                                          00200000
002100                                                                  00210000
002200     SELECT  ASN-SEPHORA-SSCC-FILE                                00220000
002300        ASSIGN TO OUT01.                                          00230000
002400                                                                  00240000
002500     SELECT  ASN-ERROR-FILE                                       00250017
002600        ASSIGN TO OUT02.                                          00260017
002700                                                                  00270017
003100                                                                  00310000
003200******************************************************************00320000
003300 DATA DIVISION.                                                   00330000
003400******************************************************************00340000
003500                                                                  00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800                                                                  00380000
003900 FD  ASN-SEPHORA-FILE                                             00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     RECORDING MODE IS F                                          00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     RECORD CONTAINS 600 CHARACTERS.                              00430000
004400                                                                  00440000
004500 01  ASN-SEPHORA-RECORD          PIC  X(600).                     00450000
004600                                                                  00460000
004610                                                                  00461000
004692 FD  ASN-SEPHORA-SSCC-FILE                                        00469200
004693     RECORDING MODE IS F                                          00469300
004694     LABEL RECORDS ARE STANDARD                                   00469400
004695     RECORD CONTAINS 1100 CHARACTERS.                             00469500
004696                                                                  00469600
004697 01  ASN-SEPHORA-SSCC-RECORD     PIC  X(1100).                    00469700
004698                                                                  00469800
004699 FD  ASN-ERROR-FILE                                               00469917
004700     LABEL RECORDS ARE STANDARD                                   00470017
004701     RECORDING MODE IS F                                          00470117
004702     BLOCK CONTAINS 0 RECORDS                                     00470217
004703     RECORD CONTAINS 600 CHARACTERS.                              00470317
004704                                                                  00470417
004705 01  ASN-ERROR-RECORD            PIC  X(600).                     00470517
004706                                                                  00470617
004707                                                                  00470717
004708                                                                  00470800
004710******************************************************************00471000
004720 WORKING-STORAGE SECTION.                                         00472000
004730******************************************************************00473000
004740*-----------------------------------------------------------------00474000
004750*                                                                 00475000
004760*-----------------------------------------------------------------00476000
004770 01  ABEND-CODE                     PIC S9(04) VALUE +0           00477000
004780                                               COMP SYNC.         00478000
004790                                                                  00479000
004800*-----------------------------------------------------------------00480000
004900* DB2 KEYS                                                        00490000
005000*-----------------------------------------------------------------00500000
005100 01  DK-DB2-KEYS.                                                 00510000
005200     05  DK-OPER-UNT-ID             PIC  S9(4) COMP.              00520000
005300                                                                  00530000
005400*-----------------------------------------------------------------00540000
005500* PROGRAM CONSTANTS                                               00550000
005600*-----------------------------------------------------------------00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE              00580000
005900         'RCKUT186'.                                              00590000
006000                                                                  00600000
006100*-----------------------------------------------------------------00610000
006200* PROGRAM SWITCHES                                                00620000
006300*-----------------------------------------------------------------00630000
006400 01  PS-PROGRAM-SWITCHES.                                         00640000
006500     05  PS-END-OF-FILE-SW          PIC  X(01) VALUE 'N'.         00650000
006600         88  PS-END-OF-FILE                    VALUE 'Y'.         00660000
006700         88  PS-END-OF-FILE-NO                 VALUE 'N'.         00670000
006800     05  PS-ERROR-SW                PIC  X(01) VALUE 'N'.         00680000
006900         88  PS-ERROR                          VALUE 'Y'.         00690000
007000         88  PS-ERROR-NO                       VALUE 'N'.         00700000
007100     05  PS-DETAIL-CREATED-SW       PIC  X(01) VALUE 'Y'.         00710005
007200         88  PS-DETAIL-CREATED                 VALUE 'Y'.         00720005
007300         88  PS-DETAIL-NOT-CREATED             VALUE 'N'.         00730005
008330                                                                  00833000
008340*-----------------------------------------------------------------00834000
008350* PROGRAM VARIABLES                                               00835000
008360*-----------------------------------------------------------------00836000
008370*                                                                 00837003
008380 01  PV-PROGRAM-VARIABLES.                                        00838004
008390     05  PV-CURRENT-TMST             PIC  X(26)  VALUE SPACES.    00839004
008400     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             00840004
008500         10  PV-CURRENT-DATE         PIC  X(10).                  00850004
008600         10  FILLER                  PIC  X(01).                  00860004
008700         10  PV-CURRENT-TIME         PIC  X(08).                  00870004
008800         10  FILLER                  PIC  X(07).                  00880004
008900     05  PV-READ-COUNT               PIC  9(09)  VALUE ZEROS.     00890005
009000     05  PV-ERROR-COUNT              PIC  9(09)  VALUE ZEROS.     00900018
009220     05  PV-HEADER-COUNT             PIC  9(09)  VALUE ZEROS.     00922005
009230     05  PV-DETAIL-COUNT             PIC  9(09)  VALUE ZEROS.     00923005
009240     05  PV-CARTON-COUNT             PIC  9(09)  VALUE ZEROS.     00924005
009250     05  PV-HDR-OUT01-COUNT          PIC  9(09)  VALUE ZEROS.     00925005
009260     05  PV-DTL-OUT01-COUNT          PIC  9(09)  VALUE ZEROS.     00926005
009270     05  PV-CRTN-OUT01-COUNT         PIC  9(09)  VALUE ZEROS.     00927005
009280     05  PV-VENDOR-PO                PIC  X(10).                  00928005
009290     05  PV-VENDOR-PO-N  REDEFINES  PV-VENDOR-PO.                 00929005
009300         10 FILLER                   PIC  9(01).                  00930005
009301         10 PV-VENDOR-PO-R           PIC  9(09).                  00930105
009304     05  PV-SSCC-COUNT               PIC  9(09)  VALUE ZEROS.     00930406
009305     05  PV-ASN-DTL-NO-CARTONS-CNT   PIC  9(09)  VALUE ZEROS.     00930506
009308     05  PV-OUT01-COUNT              PIC  9(09)  VALUE ZEROS.     00930806
009309     05  PV-OUT02-COUNT              PIC  9(09)  VALUE ZEROS.     00930918
009321     05  PV-DISP-PO                  PIC  9(09)  VALUE ZEROS.     00932106
009370     05  PV-DISP-COUNT              PIC  ZZZ,ZZZ,ZZ9              00937005
009380                                                VALUE ZEROS.      00938005
009390     05  PV-DISP-SQLCODE            PIC  -999   VALUE ZEROS.      00939005
009401                                                                  00940108
009402     05  PV-SUB                     PIC S9(04)  VALUE ZERO        00940206
009403                                                 COMP SYNC.       00940306
009410                                                                  00941008
009430     05  PV-PREV-DIST-CNTR          PIC  9(04)  VALUE ZEROES.     00943005
009470     05  PV-PREV-PO-NBR             PIC  9(09)  VALUE ZEROS.      00947004
009471     05  PV-PREV-ASNHDR-NBR         PIC  X(30)  VALUE SPACES.     00947104
009490     05  PV-PREV-PO-LINE-NBR        PIC  X(04)  VALUE SPACES.     00949005
009510                                                                  00951008
009520     05  PV-PARAGRAPH-NAME          PIC  X(30) VALUE SPACES.      00952007
009530     05  PV-DB2-OPERATION-ATTEMPTED PIC  X(30) VALUE SPACES.      00953007
009540                                                                  00954000
009550*-----------------------------------------------------------------00955000
009560*  INPUT/OUTPUT OUT01 RECORD LAYOUT                               00956000
009570*-----------------------------------------------------------------00957000
009580     COPY RCRD001.                                                00958000
009590                                                                  00959000
009600*-----------------------------------------------------------------00960000
009700*  OUT01 RECORD LAYOUT                                            00970000
009800*-----------------------------------------------------------------00980000
009900     COPY RCRD112.                                                00990000
010000                                                                  01000000
010100*-----------------------------------------------------------------01010000
010200*  DB2 FORMATTED MESSAGE AREA                                     01020000
010300*-----------------------------------------------------------------01030000
010400     COPY DPWS004.                                                01040000
010500                                                                  01050000
010600*-----------------------------------------------------------------01060000
010700*  XLT_LOC                                                        01070000
010800*-----------------------------------------------------------------01080000
010900     EXEC SQL                                                     01090000
011000          INCLUDE XLT00010                                        01100000
011100     END-EXEC.                                                    01110000
011200                                                                  01120000
011910*-----------------------------------------------------------------01191021
011920*  TPURITM                                                        01192021
011930*-----------------------------------------------------------------01193021
011940     EXEC SQL                                                     01194021
011950          INCLUDE TPURITM                                         01195021
011960     END-EXEC.                                                    01196021
011970                                                                  01197021
012000*-----------------------------------------------------------------01200000
012100*  TPOINST - PO INSTRUCTION                                       01210003
012200*-----------------------------------------------------------------01220000
012300     EXEC SQL                                                     01230000
012400          INCLUDE TPOINST                                         01240003
012500     END-EXEC.                                                    01250000
012600                                                                  01260000
012610*-----------------------------------------------------------------01261003
012620*  TINSTCD - PO INSTRUCTION CODE                                  01262003
012630*-----------------------------------------------------------------01263003
012640     EXEC SQL                                                     01264003
012650          INCLUDE TINSTCD                                         01265003
012660     END-EXEC.                                                    01266003
012670                                                                  01267003
012700*-----------------------------------------------------------------01270000
012800*  COMMUNICATIONS AREA FOR DB2                                    01280000
012900*-----------------------------------------------------------------01290000
013000     EXEC SQL                                                     01300000
013100          INCLUDE SQLCA                                           01310000
013200     END-EXEC.                                                    01320000
013300                                                                  01330000
013400                                                                  01340000
013500******************************************************************01350000
013600 PROCEDURE DIVISION.                                              01360000
013700******************************************************************01370000
013800                                                                  01380000
013900                                                                  01390000
014000*-----------------------------------------------------------------01400000
014100* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01410000
014200*      PROGRAM.                                                   01420000
014300*-----------------------------------------------------------------01430000
014400 0000-PROGRAM-MAINLINE.                                           01440000
014500                                                                  01450000
014600     DISPLAY ' '.                                                 01460000
014700     DISPLAY ' RCKUT186 - START'                                  01470000
014800                                                                  01480000
014900     EXEC SQL                                                     01490000
015000          SELECT CURRENT TIMESTAMP                                01500000
015100            INTO :PV-CURRENT-TMST                                 01510000
015200            FROM SYSIBM.SYSDUMMY1                                 01520000
015300     END-EXEC.                                                    01530000
015400                                                                  01540000
015500     DISPLAY ' CURR-TMST: ' PV-CURRENT-TMST                       01550000
015600             ' DATE-TIME: ' PV-CURRENT-DATE                       01560000
015700             ' - '          PV-CURRENT-TIME.                      01570000
015800                                                                  01580000
015900     SET PS-END-OF-FILE-NO TO TRUE.                               01590000
016000                                                                  01600000
016100     OPEN INPUT  ASN-SEPHORA-FILE.                                01610009
016200     OPEN OUTPUT ASN-SEPHORA-SSCC-FILE                            01620017
016300                  ASN-ERROR-FILE.                                 01630017
016500                                                                  01650000
017100     PERFORM 8000-READ-INPUT.                                     01710000
017200                                                                  01720000
017300     IF PS-END-OF-FILE                                            01730000
017400        DISPLAY '*                                            *'  01740000
017500        DISPLAY '* NO SEPHORA ASNS TO PROCESS - EMPTY FILE    *'  01750000
017600        DISPLAY '*                                            *'  01760000
018010     ELSE                                                         01801000
018100         MOVE RC001-DIST-CNTR   TO  PV-PREV-DIST-CNTR             01810003
018200         MOVE RC001-PO-NBR      TO  PV-PREV-PO-NBR                01820003
018300         MOVE RC001-PO-LINE-NBR TO  PV-PREV-PO-LINE-NBR           01830000
018301                                                                  01830104
018302         DISPLAY 'ASNHDR-NBR:'     RC001-ASNHDR-NBR               01830206
018303                 '   DIST-CNTR:'   RC001-DIST-CNTR                01830304
018304                 '   PO:'          RC001-PO-NBR                   01830404
018305                                                                  01830515
018306         MOVE RC001-ASNHDR-NBR  TO  PV-PREV-ASNHDR-NBR            01830610
018310                                                                  01831003
018311         MOVE RC001-PO-NBR      TO  POINST-PO-NBR                 01831103
018320         PERFORM 3000-GET-VENDOR-PO                               01832003
018330                                                                  01833003
018400         PERFORM 2000-PROCESS-FILE                                01840000
018500             UNTIL PS-END-OF-FILE                                 01850000
018600                OR PS-ERROR                                       01860000
018700     END-IF.                                                      01870000
018800                                                                  01880000
018900     CLOSE ASN-SEPHORA-FILE                                       01890000
019000           ASN-SEPHORA-SSCC-FILE                                  01900017
019100           ASN-ERROR-FILE.                                        01910017
019300                                                                  01930000
019400     DISPLAY ' '                                                  01940000
019500     MOVE PV-READ-COUNT                  TO  PV-DISP-COUNT        01950000
019600     DISPLAY ' RECORDS READ:           '     PV-DISP-COUNT        01960000
019700     DISPLAY ' '                                                  01970000
019800                                                                  01980000
019900     MOVE PV-HEADER-COUNT                TO  PV-DISP-COUNT        01990000
020000     DISPLAY ' HEADER COUNT:           '     PV-DISP-COUNT        02000000
020100                                                                  02010000
020200     MOVE PV-DETAIL-COUNT                TO  PV-DISP-COUNT        02020000
020300     DISPLAY ' DETAIL COUNT:           '     PV-DISP-COUNT        02030000
020400                                                                  02040000
020500     MOVE PV-CARTON-COUNT                TO  PV-DISP-COUNT        02050000
020600     DISPLAY ' CARTON COUNT:           '     PV-DISP-COUNT        02060000
020700                                                                  02070000
020710     MOVE PV-ERROR-COUNT                 TO  PV-DISP-COUNT        02071018
020720     DISPLAY ' ERROR COUNT:            '     PV-DISP-COUNT        02072018
020730                                                                  02073018
020800     DISPLAY ' '                                                  02080000
020900     DISPLAY '* SEPHORA ASN SSCC --------------------- RCRD112'.  02090000
021000                                                                  02100000
021100     MOVE PV-HDR-OUT01-COUNT             TO  PV-DISP-COUNT        02110000
021200     DISPLAY ' HDR OUT01 COUNT:        '     PV-DISP-COUNT        02120000
021300                                                                  02130000
021400     MOVE PV-DTL-OUT01-COUNT             TO  PV-DISP-COUNT        02140000
021500     DISPLAY ' DTL OUT01 COUNT:        '     PV-DISP-COUNT        02150000
021600                                                                  02160000
021700     MOVE PV-CRTN-OUT01-COUNT            TO PV-DISP-COUNT         02170000
021800     DISPLAY ' CRTN OUT01 COUNT:       '    PV-DISP-COUNT         02180000
021900     DISPLAY ' '                                                  02190000
022000                                                                  02200000
022100     MOVE PV-OUT01-COUNT                 TO PV-DISP-COUNT         02210000
022200     DISPLAY ' TOTAL OUT01 COUNT:      '    PV-DISP-COUNT         02220000
022300     DISPLAY ' '                                                  02230000
022310                                                                  02231018
022400     MOVE PV-OUT02-COUNT                 TO PV-DISP-COUNT         02240018
022500     DISPLAY ' TOTAL OUT02 COUNT:      '    PV-DISP-COUNT         02250018
022600     DISPLAY ' '                                                  02260018
025480                                                                  02548000
025490     DISPLAY ' RCKUT186 - END'.                                   02549000
025500     DISPLAY ' '.                                                 02550000
025600                                                                  02560000
025700     STOP RUN.                                                    02570000
025800                                                                  02580000
025900                                                                  02590000
026000*-----------------------------------------------------------------02600000
026100*  PROCESS ASN INPUT FILE                                         02610000
026200*-----------------------------------------------------------------02620000
026300 2000-PROCESS-FILE.                                               02630000
026400                                                                  02640000
026500*                                                                 02650000
026600* CHECK IF ASN IS THE SAME AS PREVIOUS ASN                        02660000
026700*                                                                 02670000
026800*    IF THE ASN MATCHES THE PREVIOUS ASN                          02680000
027100*                                 - WRITE TO OUT01 FILE           02710000
027400*                                                                 02740000
027520     IF   RC001-ASNHDR-NBR  =  PV-PREV-ASNHDR-NBR                 02752004
027521          CONTINUE                                                02752104
027522     ELSE                                                         02752204
027523         PERFORM 3100-CHECK-PREV-NO-CRTNS                         02752314
027524         DISPLAY 'ASNHDR-NBR:'     RC001-ASNHDR-NBR               02752406
027525                 '   DIST-CNTR:'   RC001-DIST-CNTR                02752504
027526                 '   PO:'          RC001-PO-NBR                   02752604
027530         MOVE RC001-ASNHDR-NBR  TO  PV-PREV-ASNHDR-NBR            02753004
027531                                                                  02753111
027532         MOVE RC001-PO-NBR  TO  POINST-PO-NBR                     02753211
027533         PERFORM 3000-GET-VENDOR-PO                               02753311
027536         MOVE RC001-PO-NBR  TO  PV-PREV-PO-NBR                    02753620
027540     END-IF                                                       02754004
027600*                                                                 02760000
027628     IF  RC001-PO-NBR      =  PV-PREV-PO-NBR                      02762803
027629         CONTINUE                                                 02762903
027630     ELSE                                                         02763003
027631         PERFORM 3100-CHECK-PREV-NO-CRTNS                         02763114
027632         DISPLAY 'ASNHDR-NBR:'     RC001-ASNHDR-NBR               02763206
027633                 '   DIST-CNTR:'   RC001-DIST-CNTR                02763304
027634                 '   PO:'          RC001-PO-NBR                   02763404
027636         MOVE RC001-PO-NBR  TO  POINST-PO-NBR                     02763603
027640         PERFORM 3000-GET-VENDOR-PO                               02764003
027641         MOVE RC001-PO-NBR  TO  PV-PREV-PO-NBR                    02764103
027650     END-IF.                                                      02765003
027660                                                                  02766000
027900     PERFORM 4000-SPLIT-OFF-SSCC.                                 02790003
030800                                                                  03080000
030900     PERFORM 8000-READ-INPUT.                                     03090000
030910                                                                  03091004
032800                                                                  03280000
032900                                                                  03290000
033000*-----------------------------------------------------------------03300000
033100*  SELECT VENDOR PO                                               03310003
033200*-----------------------------------------------------------------03320000
033300 3000-GET-VENDOR-PO.                                              03330003
033310                                                                  03331003
033320     EXEC SQL                                                     03332003
033330          SELECT RTRIM(SUBSTR(INSTR_DESC,13,10))                  03333003
033340            INTO :INSTCD-INSTR-DESC                               03334003
033350            FROM TINSTCD A                                        03335003
033360               , TPOINST B                                        03336003
033370          WHERE UPPER(A.INSTR_DESC) LIKE 'SEPHORA PO #%'          03337003
033380            AND B.INSTR_NBR = A.INSTR_NBR                         03338003
033390            AND B.RECIP_CDE = 'VN'                                03339003
033391            AND B.PO_NBR    = :POINST-PO-NBR                      03339103
033392     END-EXEC.                                                    03339203
033393                                                                  03339303
033394     EVALUATE TRUE                                                03339403
033395         WHEN SQLCODE = ZERO                                      03339503
033396              MOVE INSTCD-INSTR-DESC(1:10) TO PV-VENDOR-PO        03339603
033398                                                                  03339803
033399         WHEN SQLCODE = +100                                      03339903
033400              MOVE ZEROES                  TO PV-VENDOR-PO        03340003
033402                                                                  03340220
033410         WHEN SQLWARN0 NOT = SPACES                               03341003
033420         WHEN SQLCODE < +0                                        03342003
033430         WHEN SQLCODE > +0                                        03343003
033450             DISPLAY ' '                                          03345003
033460             DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY 03346003
033470                                                                  03347003
033480             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03348003
033481             MOVE POINST-PO-NBR    TO  PV-DISP-PO                 03348103
033490             SET PS-ERROR          TO  TRUE                       03349003
033491             DISPLAY '******************************************' 03349103
033492             DISPLAY '*ABEND                                   *' 03349203
033493             DISPLAY '*PROGRAM   = RCKUT186                    *' 03349303
033494             DISPLAY '*DB2 OPER  = SELECT ON TINSTCD TPOINST   *' 03349422
033495             DISPLAY '*PARAGRAPH = 3000-GET-VENDOR-PO          *' 03349522
033496             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03349603
033497             DISPLAY '*PO-NBR  = ' RC001-PO-NBR                   03349703
033498                     '    **   '   PV-DISP-PO                     03349803
033499             DISPLAY '******************************************' 03349903
033500             PERFORM 9100-SQL-ABEND                               03350003
033510     END-EVALUATE.                                                03351003
033600                                                                  03360000
035095                                                                  03509500
035145*----------------------------------------------------------------*03514514
035146* THIS WILL CHECK IF THE PREVIOUS HEADER OR DETAIL WERE PROCESSED 03514614
035147* AND THERE WERE NO SSCC ON THE ASN                               03514714
035148* ASN DATA WILL BE WRITTEN TO THE OUTPUT FILE WITH NO CARTON DATA 03514814
035149*----------------------------------------------------------------*03514914
035150 3100-CHECK-PREV-NO-CRTNS.                                        03515014
035151                                                                  03515114
035152     IF  PS-DETAIL-NOT-CREATED                                    03515214
035153         PERFORM 4320-ASN-DTL-NO-CARTONS                          03515314
035154         ELSE                                                     03515414
035155         IF  RC001-CARTON-IND  =  'N'  AND                        03515514
035156             RC001-PO-NBR      =  PV-PREV-PO-NBR  AND             03515614
035157             RC001-PO-LINE-NBR NOT = PV-PREV-PO-LINE-NBR AND      03515714
035158             PV-PREV-PO-LINE-NBR NOT = '0000'  AND                03515814
035159             PS-DETAIL-NOT-CREATED                                03515914
035160             PERFORM 4320-ASN-DTL-NO-CARTONS                      03516014
035161         END-IF                                                   03516114
035162     END-IF.                                                      03516214
035170                                                                  03517014
035200                                                                  03520014
035279*----------------------------------------------------------------*03527900
035280* SPLIT THE ASN FILE TO ONLY WRITE OUT THE CARTON RECORDS        *03528000
035281*                                                                *03528100
035282* ASN - HEADER - RC001-CARTON-IND = BLANK                        *03528200
035283* ASN - DETAIL - RC001-CARTON-IND = N                            *03528300
035284* ASN - CARTON - RC001-CARTON-IND = Y                            *03528400
035285*                THERE ARE UP TO 10 CARTONS (SSCC) PER CARTON    *03528500
035286*                RECORD.  EACH CARTON WILL BE WRITTEN OUT        *03528600
035287*                SEPARATELY.                                     *03528700
035288*----------------------------------------------------------------*03528800
035289 4000-SPLIT-OFF-SSCC.                                             03528900
035290                                                                  03529000
035291     IF  RC001-PO-LINE-NBR = 0                                    03529120
035292         CONTINUE                                                 03529220
035293     ELSE                                                         03529320
035294         PERFORM 4010-CHECK-PO-LINE-STATUS                        03529420
035295     END-IF.                                                      03529520
035296                                                                  03529620
035297     IF  RC001-CARTON-IND  =  SPACES                              03529720
035298         ADD  1  TO  PV-HDR-OUT01-COUNT                           03529820
035299         PERFORM 4100-HEADER-RECORD                               03529920
035300         SET  PS-DETAIL-NOT-CREATED  TO  TRUE                     03530020
035301     ELSE                                                         03530120
035302         IF  RC001-CARTON-IND  =  'N'                             03530220
035303             ADD  1  TO  PV-DTL-OUT01-COUNT                       03530303
035304             PERFORM 4200-DETAIL-RECORD                           03530400
035305             SET  PS-DETAIL-NOT-CREATED  TO  TRUE                 03530500
035306             MOVE RC001-PO-LINE-NBR TO PV-PREV-PO-LINE-NBR        03530600
035307         ELSE                                                     03530700
035308             IF  RC001-CARTON-IND  =  'Y'                         03530800
035309                 ADD  1  TO  PV-CRTN-OUT01-COUNT                  03530903
035310                 PERFORM 4300-CARTON-RECORD                       03531000
035311                 SET  PS-DETAIL-CREATED  TO  TRUE                 03531100
035312             END-IF                                               03531200
035313         END-IF                                                   03531300
035314     END-IF.                                                      03531400
035315                                                                  03531500
035316                                                                  03531620
035317*-----------------------------------------------------------------03531720
035318*  CHECK IF PO LINE STATUS                                        03531820
035319*  CM - COMPLETE                                                  03531920
035320*  CB - CANCEL BALANCE                                            03532020
035321*  CA - CANCELED                                                  03532120
035322*-----------------------------------------------------------------03532220
035323 4010-CHECK-PO-LINE-STATUS.                                       03532320
035324                                                                  03532420
035325     MOVE RC001-PO-NBR      TO  PURITM-PO-NBR.                    03532520
035326     MOVE RC001-PO-LINE-NBR TO  PURITM-PO-LNE-NBR.                03532620
035327                                                                  03532720
035328     EXEC SQL                                                     03532820
035329          SELECT STATUS_CDE                                       03532920
035330            INTO :PURITM-STATUS-CDE                               03533023
035331            FROM TPURITM                                          03533120
035332           WHERE PO_NBR         = :PURITM-PO-NBR                  03533224
035333             AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR              03533324
035334             AND VER_STATUS_CDE = 'A'                             03533420
035335             AND STATUS_CDE    IN ('CA','CM','CB')                03533524
035336     END-EXEC.                                                    03533620
035337                                                                  03533720
035338     EVALUATE TRUE                                                03533820
035339         WHEN SQLCODE = ZERO                                      03533920
035341             PERFORM 8110-WRITE-OUT02                             03534120
035342             ADD +1 TO PV-ERROR-COUNT                             03534220
035345                                                                  03534520
035346         WHEN SQLCODE = +100                                      03534620
035347              CONTINUE                                            03534720
035348                                                                  03534820
035349         WHEN SQLWARN0 NOT = SPACES                               03534920
035350         WHEN SQLCODE < +0                                        03535020
035351         WHEN SQLCODE > +0                                        03535120
035353             DISPLAY ' '                                          03535320
035354             DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY 03535420
035355                                                                  03535520
035356             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03535620
035357             MOVE PURITM-PO-NBR    TO  PV-DISP-PO                 03535720
035358             SET PS-ERROR          TO  TRUE                       03535820
035359             DISPLAY '******************************************' 03535920
035360             DISPLAY '*ABEND                                   *' 03536020
035361             DISPLAY '*PROGRAM   = RCKUT186                    *' 03536120
035362             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 03536221
035363             DISPLAY '*PARAGRAPH = 4010-CHECK-PO-LINE-STATUS   *' 03536321
035364             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03536420
035365             DISPLAY '*PO-NBR  = ' RC001-PO-NBR                   03536520
035366                     '    **   '   PV-DISP-PO                     03536620
035367             DISPLAY '******************************************' 03536720
035368             PERFORM 9100-SQL-ABEND                               03536820
035369     END-EVALUATE.                                                03536920
035370                                                                  03537020
035371                                                                  03537120
035372*----------------------------------------------------------------*03537220
035373* HEADER RECORD INFORMATION                                      *03537320
035374*----------------------------------------------------------------*03537420
035375 4100-HEADER-RECORD.                                              03537520
035376                                                                  03537620
035377     MOVE SPACES  TO  RC112-ASN-TRANSCRIPTION-RECORD.             03537720
035378                                                                  03537820
035379     MOVE ZEROES  TO  RC112-DIST-CNTR                             03537920
035380                      RC112-EDI-VEND-ID                           03538020
035381                      RC112-PO-NBR                                03538120
035382                      RC112-STORE-NBR                             03538220
035383                      RC112-SEQUENCE-NBR                          03538320
035384                      RC112-DEPT-NBR                              03538420
035385                      RC112-BUYER-NBR                             03538520
035386                      RC112-DATE-SHIPPED                          03538620
035387                      RC112-PO-DATE                               03538720
035388                      RC112-REQ-SHIP-DATE                         03538820
035389                      RC112-CANCEL-DATE                           03538920
035390                      RC112-CANCEL-EXT-DATE                       03539020
035391                      RC112-AD-DATE                               03539120
035392                      RC112-CARR-VEND-ID                          03539220
035393                      RC112-SHIPMENT-WEIGHT                       03539320
035394                      RC112-CARTON-CNT-STORE                      03539420
035395                      RC112-CARTON-CNT-PO                         03539520
035396                      RC112-CARTON-CNT-SHPMT                      03539620
035397                      RC112-ISA-NBR                               03539720
035398                      RC112-DIST-PACK-QTY                         03539820
035399                      RC112-UPC-NBR                               03539920
035400                      RC112-UNIT-COST                             03540020
035401                      RC112-UNIT-RETAIL                           03540120
035402                      RC112-QTY-ORDERED                           03540220
035403                      RC112-QTY-SHIPPED                           03540320
035404                      RC112-QTY-SHIPPED-VAR                       03540420
035405                      RC112-PR-CHG-EFF-DAYS                       03540520
035406                      RC112-CARTON-NBR                            03540620
035407                      RC112-CARTON-QTY                            03540720
035408                      RC112-CTN-UPC                               03540820
035409                      RC112-VEND-ORD-NBR.                         03540920
035410                                                                  03541020
035411     MOVE SPACES  TO  RC112-OPERATING-COMPANY                     03541120
035412                      RC112-CARRIER-SCAC-CODE                     03541220
035413                      RC112-BILL-OF-LADING-NBR                    03541320
035414                      RC112-PO-LINE-NBR                           03541420
035415                      RC112-CARTON-IND                            03541520
035416                      RC112-ASNHDR-NBR                            03541620
035417                      RC112-EDI-VEND-NAME                         03541720
035418                      RC112-ORIG-BOL-NBR                          03541820
035419                      RC112-SEQ-NBR-IND                           03541920
035420                      RC112-DEPT-DESC                             03542020
035421                      RC112-BUYER-NAME                            03542120
035422                      RC112-ANALYST-NAME                          03542220
035423                      RC112-CARRIER-NAME                          03542320
035424                      RC112-PRO-NBR                               03542420
035425                      RC112-TRAILER-NBR                           03542520
035426                      RC112-SHIP-WEIGHT-UM                        03542620
035427                      RC112-SPECIAL-INSTR-1                       03542720
035428                      RC112-SPECIAL-INSTR-2                       03542820
035429                      RC112-SPECIAL-INSTR-3                       03542920
035430                      RC112-ASNORD-EARLY-LTE-CDE                  03543020
035431                      RC112-ASNORD-MTCH-PO-CDE                    03543120
035432                      RC112-VENDOR-TRSCP-IND                      03543220
035433                      RC112-LINE-ERROR-IND                        03543320
035434                      RC112-CONT-NBR                              03543420
035435                      RC112-MAN-SEG-IND                           03543520
035436                      RC112-CARR-AUTH-ID                          03543620
035437                      RC112-HDR-FILLER                            03543720
035438                      RC112-SKU-DEPT-NBR                          03543820
035439                      RC112-SKU-CLASS-NBR                         03543920
035440                      RC112-SKU-SEQ-NBR                           03544020
035441                      RC112-UPC-DESC                              03544120
035442                      RC112-VENDOR-STYLE                          03544220
035443                      RC112-SIZE                                  03544320
035444                      RC112-COLOR                                 03544420
035445                      RC112-QTY-ORDERED-UM                        03544520
035446                      RC112-QTY-SHIPPED-UM                        03544620
035447                      RC112-ASDTPL-ALLOC-IND                      03544720
035448                      RC112-ASDTPL-MATCH-IND                      03544820
035449                      RC112-ASDTPL-PR-DISC-IND                    03544920
035450                      RC112-ASDTPL-PR-VAR-IND                     03545020
035451                      RC112-SKU-NBR                               03545120
035452                      RC112-DTL-FILLER                            03545220
035453                      RC112-CRTN-UNIQUE-SW                        03545320
035454                      RC112-CARTON-FIL                            03545420
035455                      RC112-ASN-DATE                              03545520
035456                      RC112-ASN-TIME.                             03545620
035457                                                                  03545720
035458     MOVE RC001-OPERATING-COMPANY  TO RC112-OPERATING-COMPANY.    03545820
035459     MOVE RC001-DIST-CNTR          TO RC112-DIST-CNTR.            03545920
035460     MOVE RC001-EDI-VEND-ID        TO RC112-EDI-VEND-ID.          03546020
035461     MOVE RC001-CARRIER-SCAC-CODE  TO RC112-CARRIER-SCAC-CODE.    03546120
035462     MOVE RC001-BILL-OF-LADING-NBR TO RC112-BILL-OF-LADING-NBR.   03546220
035463     MOVE RC001-PO-NBR             TO RC112-PO-NBR.               03546320
035464     MOVE RC001-STORE-NBR          TO RC112-STORE-NBR.            03546420
035465     MOVE RC001-PO-LINE-NBR        TO RC112-PO-LINE-NBR.          03546520
035466     MOVE RC001-SEQUENCE-NBR       TO RC112-SEQUENCE-NBR.         03546620
035467     MOVE RC001-CARTON-IND         TO RC112-CARTON-IND.           03546720
035468     MOVE RC001-ASNHDR-NBR         TO RC112-ASNHDR-NBR.           03546820
035469     MOVE RC001-EDI-VEND-NAME      TO RC112-EDI-VEND-NAME.        03546920
035470     MOVE RC001-ORIG-BOL-NBR       TO RC112-ORIG-BOL-NBR.         03547020
035471     MOVE RC001-SEQ-NBR-IND        TO RC112-SEQ-NBR-IND.          03547120
035472     MOVE RC001-DEPT-NBR           TO RC112-DEPT-NBR.             03547220
035473     MOVE RC001-DEPT-DESC          TO RC112-DEPT-DESC.            03547320
035474     MOVE RC001-BUYER-NBR          TO RC112-BUYER-NBR.            03547420
035475     MOVE RC001-BUYER-NAME         TO RC112-BUYER-NAME.           03547520
035476     MOVE RC001-ANALYST-NAME       TO RC112-ANALYST-NAME.         03547620
035477     MOVE RC001-DATE-SHIPPED       TO RC112-DATE-SHIPPED.         03547720
035478     MOVE RC001-PO-DATE            TO RC112-PO-DATE.              03547820
035479     MOVE RC001-REQ-SHIP-DATE      TO RC112-REQ-SHIP-DATE.        03547920
035480     MOVE RC001-CANCEL-DATE        TO RC112-CANCEL-DATE.          03548020
035481     MOVE RC001-CANCEL-EXT-DATE    TO RC112-CANCEL-EXT-DATE.      03548120
035482     MOVE RC001-AD-DATE            TO RC112-AD-DATE.              03548220
035483     MOVE RC001-CARR-VEND-ID       TO RC112-CARR-VEND-ID.         03548320
035484     MOVE RC001-CARRIER-NAME       TO RC112-CARRIER-NAME.         03548420
035485     MOVE RC001-PRO-NBR            TO RC112-PRO-NBR.              03548520
035486     MOVE RC001-TRAILER-NBR        TO RC112-TRAILER-NBR.          03548620
035487     MOVE RC001-SHIPMENT-WEIGHT    TO RC112-SHIPMENT-WEIGHT.      03548720
035488     MOVE RC001-SHIP-WEIGHT-UM     TO RC112-SHIP-WEIGHT-UM.       03548820
035489     MOVE RC001-CARTON-CNT-STORE   TO RC112-CARTON-CNT-STORE.     03548920
035490     MOVE RC001-CARTON-CNT-PO      TO RC112-CARTON-CNT-PO.        03549020
035491     MOVE RC001-CARTON-CNT-SHPMT   TO RC112-CARTON-CNT-SHPMT.     03549120
035492     MOVE RC001-SPECIAL-INSTR-1    TO RC112-SPECIAL-INSTR-1.      03549220
035493     MOVE RC001-SPECIAL-INSTR-2    TO RC112-SPECIAL-INSTR-2.      03549320
035494     MOVE RC001-SPECIAL-INSTR-3    TO RC112-SPECIAL-INSTR-3.      03549420
035495     MOVE RC001-ASNORD-EARLY-LTE-CDE                              03549520
035496                                   TO RC112-ASNORD-EARLY-LTE-CDE. 03549620
035497     MOVE RC001-ASNORD-MTCH-PO-CDE TO RC112-ASNORD-MTCH-PO-CDE.   03549720
035498     MOVE RC001-VENDOR-TRSCP-IND   TO RC112-VENDOR-TRSCP-IND.     03549820
035499     MOVE RC001-LINE-ERROR-IND     TO RC112-LINE-ERROR-IND.       03549920
035500     MOVE RC001-CONT-NBR           TO RC112-CONT-NBR.             03550020
035501     MOVE ZEROES                   TO RC112-ISA-NBR.              03550120
035502     MOVE RC001-MAN-SEG-IND        TO RC112-MAN-SEG-IND.          03550220
035503     MOVE RC001-CARR-AUTH-ID       TO RC112-CARR-AUTH-ID.         03550320
035504     MOVE RC001-HDR-FILLER         TO RC112-HDR-FILLER.           03550420
035505     MOVE PV-VENDOR-PO             TO RC112-VEND-ORD-NBR.         03550520
035506                                                                  03550620
035507                                                                  03550720
035508*----------------------------------------------------------------*03550820
035509* DETAIL RECORD INFORMATION                                      *03550920
035510*----------------------------------------------------------------*03551020
035511 4200-DETAIL-RECORD.                                              03551120
035512                                                                  03551220
035513     MOVE RC001-SKU-DEPT-NBR       TO RC112-SKU-DEPT-NBR.         03551320
035514     MOVE RC001-SKU-CLASS-NBR      TO RC112-SKU-CLASS-NBR.        03551420
035515     MOVE RC001-SKU-SEQ-NBR        TO RC112-SKU-SEQ-NBR.          03551520
035516     MOVE RC001-DIST-PACK-QTY      TO RC112-DIST-PACK-QTY.        03551620
035517     MOVE RC001-UPC-NBR            TO RC112-UPC-NBR.              03551720
035518     MOVE RC001-UPC-DESC           TO RC112-UPC-DESC.             03551820
035519     MOVE RC001-VENDOR-STYLE       TO RC112-VENDOR-STYLE.         03551920
035520     MOVE RC001-SIZE               TO RC112-SIZE.                 03552020
035521     MOVE RC001-COLOR              TO RC112-COLOR.                03552120
035522     MOVE RC001-UNIT-COST          TO RC112-UNIT-COST.            03552220
035523     MOVE RC001-UNIT-RETAIL        TO RC112-UNIT-RETAIL.          03552320
035524     MOVE RC001-QTY-ORDERED        TO RC112-QTY-ORDERED.          03552420
035525     MOVE RC001-QTY-ORDERED-UM     TO RC112-QTY-ORDERED-UM.       03552520
035526     MOVE RC001-QTY-SHIPPED        TO RC112-QTY-SHIPPED.          03552620
035527     MOVE RC001-QTY-SHIPPED-UM     TO RC112-QTY-SHIPPED-UM.       03552720
035528     MOVE RC001-QTY-SHIPPED-VAR    TO RC112-QTY-SHIPPED-VAR.      03552820
035529     MOVE RC001-PR-CHG-EFF-DAYS    TO RC112-PR-CHG-EFF-DAYS.      03552920
035530     MOVE RC001-ASDTPL-ALLOC-IND   TO RC112-ASDTPL-ALLOC-IND.     03553020
035531     MOVE RC001-ASDTPL-MATCH-IND   TO RC112-ASDTPL-MATCH-IND.     03553120
035532     MOVE RC001-ASDTPL-PR-DISC-IND TO RC112-ASDTPL-PR-DISC-IND.   03553220
035533     MOVE RC001-ASDTPL-PR-VAR-IND  TO RC112-ASDTPL-PR-VAR-IND.    03553320
035534     MOVE RC001-SKU-NBR            TO RC112-SKU-NBR.              03553420
035535     MOVE RC001-DTL-FILLER         TO RC112-DTL-FILLER.           03553520
035536                                                                  03553620
035537                                                                  03553720
035538*----------------------------------------------------------------*03553820
035539* CARTON RECORDS                                                 *03553920
035540*----------------------------------------------------------------*03554020
035541 4300-CARTON-RECORD.                                              03554120
035542                                                                  03554220
035543     PERFORM 4310-PROCESS-ASN-CARTONS                             03554320
035544             VARYING PV-SUB                                       03554420
035545                FROM 1 BY 1                                       03554520
035546               UNTIL PV-SUB > 10 OR                               03554620
035547                     RC001-CARTON-NBR(PV-SUB) = 0.                03554720
035548                                                                  03554820
035549                                                                  03554920
035550 4310-PROCESS-ASN-CARTONS.                                        03555020
035551                                                                  03555120
035552     MOVE RC001-PO-LINE-NBR        TO RC112-PO-LINE-NBR.          03555220
035553     MOVE RC001-CARTON-NBR(PV-SUB) TO RC112-CARTON-NBR.           03555320
035554     MOVE RC001-CARTON-QTY(PV-SUB) TO RC112-CARTON-QTY.           03555420
035555     MOVE RC001-CTN-UPC(PV-SUB)    TO RC112-CTN-UPC.              03555520
035556     MOVE SPACE                    TO RC112-CRTN-UNIQUE-SW.       03555620
035557     MOVE RC001-CARTON-FIL(PV-SUB) TO RC112-CARTON-FIL.           03555720
035558     MOVE PV-CURRENT-DATE          TO RC112-ASN-DATE.             03555820
035559     MOVE PV-CURRENT-TIME          TO RC112-ASN-TIME.             03555920
035560                                                                  03556000
035570     PERFORM 8100-WRITE-OUT01.                                    03557003
035580     ADD  1  TO  PV-SSCC-COUNT.                                   03558000
035590                                                                  03559000
035600                                                                  03560000
035700*----------------------------------------------------------------*03570000
035800* BULK ASN - HAS HEADER & DETAIL - NO CARTON RECORDS             *03580000
035900*----------------------------------------------------------------*03590000
036000 4320-ASN-DTL-NO-CARTONS.                                         03600000
036100                                                                  03610000
036110     MOVE PV-PREV-PO-LINE-NBR      TO RC112-PO-LINE-NBR           03611000
036120     MOVE ZEROES                   TO RC112-CARTON-NBR            03612000
036130                                      RC112-CARTON-QTY            03613000
036140                                      RC112-CTN-UPC.              03614000
036150     MOVE SPACE                    TO RC112-CRTN-UNIQUE-SW        03615000
036160                                      RC112-CARTON-FIL.           03616000
036170     MOVE PV-CURRENT-DATE          TO RC112-ASN-DATE.             03617000
036180     MOVE PV-CURRENT-TIME          TO RC112-ASN-TIME.             03618000
036190                                                                  03619000
036200     PERFORM 8100-WRITE-OUT01.                                    03620003
036300     ADD  1  TO  PV-ASN-DTL-NO-CARTONS-CNT.                       03630000
036400                                                                  03640000
036500                                                                  03650000
036600*----------------------------------------------------------------*03660000
036700* READ INPUT ASN FILE                                            *03670000
036800*----------------------------------------------------------------*03680000
036900 8000-READ-INPUT.                                                 03690000
037000                                                                  03700000
037100     READ  ASN-SEPHORA-FILE                                       03710007
037200           INTO  RC001-ASN-TRANSCRIPTION-RECORD                   03720000
037300           AT END                                                 03730000
037400                 SET PS-END-OF-FILE  TO  TRUE                     03740000
037500           NOT AT END                                             03750000
037600                 ADD 1  TO  PV-READ-COUNT                         03760000
037700                 IF  RC001-CARTON-IND  =  SPACES                  03770000
037800                     ADD 1  TO  PV-HEADER-COUNT                   03780000
037900                 END-IF                                           03790000
038000                 IF  RC001-CARTON-IND  =  'N'                     03800000
038100                     ADD 1  TO  PV-DETAIL-COUNT                   03810000
038200                 END-IF                                           03820000
038300                 IF  RC001-CARTON-IND  =  'Y'                     03830000
038400                     ADD 1  TO  PV-CARTON-COUNT                   03840000
038410                     INSPECT RC001-PO-LINE-NBR                    03841016
038420                             REPLACING LEADING ' ' BY '0'         03842016
038500                 END-IF                                           03850000
038520*!!!                                                              03852017
038530                 IF  RC001-PO-LINE-NBR = HIGH-VALUES OR           03853017
038540                     RC001-PO-LINE-NBR = 0                        03854017
038550                     PERFORM 8110-WRITE-OUT02                     03855017
038560                     ADD +1 TO PV-ERROR-COUNT                     03856017
038561                     MOVE ZEROES  TO  RC001-PO-LINE-NBR           03856119
038570                 END-IF                                           03857017
038580*!!!                                                              03858017
038600     END-READ.                                                    03860000
038700                                                                  03870000
038800                                                                  03880000
038900                                                                  03890000
039000*----------------------------------------------------------------*03900000
039100* OUTPUT FILE 1 - SEPHORA SSCC                                   *03910003
039200*----------------------------------------------------------------*03920000
039300 8100-WRITE-OUT01.                                                03930000
039400                                                                  03940000
039500     IF  RC001-CARTON-IND  =  SPACES                              03950000
039600         ADD  1  TO  PV-HDR-OUT01-COUNT                           03960000
039700     ELSE                                                         03970000
039800         IF  RC001-CARTON-IND  =  'N'                             03980000
039900             ADD  1  TO  PV-DTL-OUT01-COUNT                       03990000
040000         ELSE                                                     04000000
040100             IF  RC001-CARTON-IND  =  'Y'                         04010000
040200                 ADD  1  TO  PV-CRTN-OUT01-COUNT                  04020000
040300             END-IF                                               04030000
040400         END-IF                                                   04040000
040500     END-IF.                                                      04050000
040600                                                                  04060000
040700     WRITE ASN-SEPHORA-SSCC-RECORD                                04070003
040800           FROM  RC112-ASN-TRANSCRIPTION-RECORD.                  04080003
040900                                                                  04090000
041000     ADD  1  TO  PV-OUT01-COUNT.                                  04100000
042300                                                                  04230000
042700                                                                  04270000
042702*----------------------------------------------------------------*04270217
042703* OUTPUT FILE 2 - ERROR FILE                                     *04270317
042704*----------------------------------------------------------------*04270417
042705 8110-WRITE-OUT02.                                                04270517
042706                                                                  04270617
042719     WRITE ASN-ERROR-RECORD                                       04271917
042720           FROM  RC001-ASN-TRANSCRIPTION-RECORD.                  04272017
042721                                                                  04272117
042722     ADD  1  TO  PV-OUT02-COUNT.                                  04272217
042723                                                                  04272317
042724                                                                  04272417
042725                                                                  04272517
042726*-----------------------------------------------------------------04272600
042727*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04272700
042728*  ERROR OR WARNING CODE OCCURS.                                  04272800
042729*-----------------------------------------------------------------04272900
042730 9100-SQL-ABEND.                                                  04273000
042731                                                                  04273100
042732     DISPLAY '9100-SQL-ABEND'.                                    04273200
042733     DISPLAY '** ABEND     **'.                                   04273300
042734     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04273400
042735     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04273500
042736     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     04273600
042740                                                                  04274000
042750******************************************************************04275000
042760* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04276000
042770* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04277000
042780* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04278000
042790* FORMAT.                                                         04279000
042800******************************************************************04280000
042900     COPY DPPD004.                                                04290000
043000                                                                  04300000
043100     MOVE +4013                  TO ABEND-CODE.                   04310000
043200     CALL 'ILBOABN0' USING ABEND-CODE.                            04320000
043300                                                                  04330000
