000100 IDENTIFICATION DIVISION.                                         00010017
000200*                                                                 00020016
000300 PROGRAM-ID.             CEKRP013.                                00030016
000400 AUTHOR.                 BETH A. BILSKI.                          00040016
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050016
000600 DATE-WRITTEN            08/94.                                   00060016
000700 DATE-COMPILED.                                                   00070016
000800*                                                                 00080016
000900***************************************************************   00090016
001000*                                                             *   00100016
001100*  THIS PROGRAM CREATES THE CENTRAL STOCK INVENTORY REPORT.   *   00110016
001200*                                                             *   00120016
001300***************************************************************   00130016
001400*  CHANGED: NOV 1998                                          *   00140016
001500*  BY:      KAREN WALL                                        *   00150016
001600*  DESCRIPTION:  MADE CHANGES SO THAT THERE WILL ALWAYS BE A  *   00160016
001700*                SKU ON THE FIRST LINE OF A PAGE BREAK.  IF   *   00170016
001800*                THERE ISN'T THIS POSES RANDOM SORT PROBLEMS  *   00180016
001900*                ON RDS SINCE RDS SORTS ON THE COLUMN NUMBER  *   00190016
002000*                THAT CONTAINS THE SKU.                       *   00200016
002100***************************************************************   00210016
002200*  CHANGED: APRIL 1999                                        *   00220016
002300*  BY:      ROBIN CHMIEL                                      *   00230016
002400*  DESCRIPTION:  ADDED DATA EXTRACT DATE TO THE REPORTS.      *   00240016
002401*                                                                 00240117
002410*  CHANGED: AUG   2011                                        *   00241032
002420*  BY:      CHRISTINE TWIEHAUS                                *   00242019
002430*  DESCRIPTION:WR39442 (EFC3) ADD LOCATIONS TO HEADING TO     *   00243032
002440*              ACCOMMODATE CREATING SEPERATE RDS REPORTS,     *   00244032
002450*              CORRECTED ALIGNMENT OF COLUMNS (SIZE,COLOR,ETC)*   00245032
002500***************************************************************   00250016
002600*                                                                 00260016
002700 ENVIRONMENT DIVISION.                                            00270016
002800 INPUT-OUTPUT SECTION.                                            00280016
002900*                                                                 00290016
003000 FILE-CONTROL.                                                    00300016
003100*                                                                 00310016
003200     SELECT CE-FILE            ASSIGN TO UT-S-INP01.              00320016
003300*                                                                 00330016
003400     SELECT CE-FILE2           ASSIGN TO UT-S-INP02.              00340016
003500*                                                                 00350016
003600     SELECT CE-REPORT-FILE     ASSIGN TO UT-S-RPT01.              00360016
003700*                                                                 00370016
003800     SELECT CE-RECAP-FILE      ASSIGN TO UT-S-RPT02.              00380016
003900*                                                                 00390016
004000*                                                                 00400016
004100 DATA DIVISION.                                                   00410016
004200*                                                                 00420016
004300 FILE SECTION.                                                    00430016
004400*                                                                 00440016
004500 FD  CE-FILE                                                      00450016
004600     RECORDING MODE IS F                                          00460016
004700     LABEL RECORDS ARE STANDARD                                   00470016
004800     RECORD CONTAINS 175                                          00480016
004900     BLOCK CONTAINS 0 RECORDS                                     00490016
005000     DATA RECORD IS CE-RECORD.                                    00500016
005100 01  CE-RECORD                       PIC X(175).                  00510016
005200*                                                                 00520016
005300 FD  CE-FILE2                                                     00530016
005400     RECORDING MODE IS F                                          00540016
005500     LABEL RECORDS ARE STANDARD                                   00550016
005600     RECORD CONTAINS 50                                           00560016
005700     BLOCK CONTAINS 0 RECORDS                                     00570016
005800     DATA RECORD IS CE-RECORD2.                                   00580016
005900 01  CE-RECORD2                      PIC X(50).                   00590016
006000*                                                                 00600016
006100 FD  CE-REPORT-FILE                                               00610016
006200     RECORDING MODE IS F                                          00620016
006300     BLOCK CONTAINS 0 RECORDS                                     00630016
006400     RECORD CONTAINS 132 CHARACTERS                               00640016
006500     LABEL RECORDS ARE OMITTED                                    00650016
006600     DATA RECORD IS CE-REPORT-RECORD.                             00660016
006700 01  CE-REPORT-RECORD                PIC  X(132).                 00670016
006800*                                                                 00680016
006900 FD  CE-RECAP-FILE                                                00690016
007000     RECORDING MODE IS F                                          00700016
007100     BLOCK CONTAINS 0 RECORDS                                     00710016
007200     RECORD CONTAINS 132 CHARACTERS                               00720016
007300     LABEL RECORDS ARE OMITTED                                    00730016
007400     DATA RECORD IS CE-RECAP-RECORD.                              00740016
007500 01  CE-RECAP-RECORD                 PIC  X(132).                 00750016
007600*                                                                 00760016
007700*                                                                 00770016
007800*                                                                 00780016
007900 WORKING-STORAGE SECTION.                                         00790016
008000 01  PS-SWITCHES.                                                 00800016
008100     05  PS-EOF-FILE-SW              PIC  X(03)    VALUE 'N'.     00810016
008200         88  PS-EOF-FILE                           VALUE 'Y'.     00820016
008300     05  PS-EOF-FILE2-SW             PIC  X(03)    VALUE 'N'.     00830016
008400         88  PS-EOF-FILE2                          VALUE 'Y'.     00840016
008500* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      00850016
008600     05  PS-LOC-SW                   PIC  X(03)    VALUE 'N'.     00860016
008700         88  PS-LOC-FILE-BREAK                     VALUE 'Y'.     00870016
008800         88  PS-LOC-FILE-BREAK-NO                  VALUE 'N'.     00880016
008900     05  PS-FIRST-TIME-SW            PIC  X(03)    VALUE 'Y'.     00890016
009000         88  PS-FIRST-TIME                         VALUE 'Y'.     00900016
009100         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00910016
009200     05  PS-PRINT-SKU-SW             PIC  X(03)    VALUE 'N'.     00920016
009300         88  PS-PRINT-SKU-TOTALS                   VALUE 'Y'.     00930016
009400         88  PS-NO-PRINT-SKU-TOTALS                VALUE 'N'.     00940016
009500     05  PS-PRINT-MULTI-SKU-SW       PIC  X(03)    VALUE 'N'.     00950016
009600         88  PS-PRINT-MULTI-SKUS                   VALUE 'Y'.     00960016
009700         88  PS-NO-PRINT-MULTI-SKUS                VALUE 'N'.     00970016
009800     05  PS-END-OF-CURSOR-SW         PIC  X(03)    VALUE 'N'.     00980016
009900         88  PS-END-OF-CURSOR                      VALUE 'Y'.     00990016
010000         88  PS-NOT-END-OF-CURSOR                  VALUE 'N'.     01000016
010100     05  PS-END-OF-TABLE-SW          PIC  X(03)    VALUE 'N'.     01010016
010200         88  PS-END-OF-TABLE                       VALUE 'Y'.     01020016
010300         88  PS-NOT-END-OF-TABLE                   VALUE 'N'.     01030016
010400*                                                                 01040016
010500 01  CD-CPU-DATE.                                                 01050016
010600     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    01060016
010700     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    01070016
010800     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    01080016
010900*                                                                 01090016
011000 01  CT-CPU-TIME.                                                 01100016
011100     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01110016
011200     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    01120016
011300     03  FILLER                      PIC  9(04)    VALUE ZERO.    01130016
011400*                                                                 01140016
011500 01  RFMT-DATE.                                                   01150016
011600     05  RFMT-DATE-MM                PIC  9(02)    VALUE ZERO.    01160016
011700     05  RFMT-SLASH-1                PIC  X(01)    VALUE '/'.     01170016
011800     05  RFMT-DATE-DD                PIC  9(02)    VALUE ZERO.    01180016
011900     05  RFMT-SLASH-2                PIC  X(01)    VALUE '/'.     01190016
012000     05  RFMT-DATE-CCYY              PIC  9(04)    VALUE ZERO.    01200016
012100*                                                                 01210016
012200 01  PC-PROGRAM-CONSTANTS.                                        01220016
012300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01230016
012400                                          'CEKRP013'.             01240016
012500                                                                  01250016
012600     05  PC-MORE-DATES               PIC  X(06)    VALUE ', MORE'.01260016
012700     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     01270016
012800     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +85      01280016
012900                                                   COMP SYNC.     01290016
013000     05  PC-1                        PIC  9(02)    VALUE 1.       01300016
013100     05  PC-2                        PIC  9(02)    VALUE 2.       01310016
013200*                                                                 01320016
013300 01  PV-PROGRAM-VARIABLES.                                        01330016
013400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01340016
013500                                                   COMP SYNC.     01350016
013600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01360016
013700     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01370016
013800     05  PV-RETRY-COUNT              PIC S9(04)    VALUE ZERO     01380016
013900                                                   COMP SYNC.     01390016
014000     05  PV-LINE-COUNT               PIC S9(04)    VALUE +80      01400016
014100                                                   COMP SYNC.     01410016
014200     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01420016
014300                                                   COMP SYNC.     01430016
014400     05  PV-DELETE-COUNT             PIC S9(03)    VALUE ZERO     01440016
014500                                                   COMP-3.        01450016
014600     05  PV-DATE-COUNT               PIC S9(03)    VALUE ZERO     01460016
014700                                                   COMP-3.        01470016
014800     05  PV-TOT-RETAIL               PIC S9(09)V99 VALUE ZERO.    01480016
014810* CT WR39442 START                                                01481022
014820     05  PV-LOC-NBR                  PIC S9(04) COMP              01482022
014830                                                VALUE ZERO.       01483022
014840* CT WR39442 END                                                  01484022
014900*                                                                 01490016
015000*                                                                 01500016
015100*----------------------------------------------------------------*01510016
015200* CHANGED PV-PREV-SKU FROM X(10) TO 9(8).         WR # 230ZZ     *01520016
015300*----------------------------------------------------------------*01530016
015400     05  PV-SAVE-FIELDS.                                          01540016
015500         10  PV-SAVE-BUYER           PIC  X(03).                  01550016
015600         10  PV-SAVE-DEPT            PIC  X(03).                  01560016
015700*        10  PV-PREV-SKU             PIC  X(10)    VALUE SPACES.  01570016
015800         10  PV-PREV-SKU             PIC  9(08)    VALUE ZEROES.  01580016
015900* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      01590016
016000         10  PV-PREV-CNTRL-STK-ID   PIC  X(04)    VALUE SPACES.   01600016
016100*----------------------------------------------------------------*01610016
016200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *01620016
016300*----------------------------------------------------------------*01630016
016400*                                                                 01640016
016500     05  PV-DEPT-TOTALS                            COMP-3.        01650016
016600         10  PV-LAST-PULL-TOT        PIC S9(12)    VALUE ZERO.    01660016
016700         10  PV-AVAIL-TOT            PIC S9(12)    VALUE ZERO.    01670016
016800         10  PV-TOT-RETAIL-TOT       PIC S9(12)V99 VALUE ZERO.    01680016
016900* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      01690016
017000     05  PV-LOC-TOTALS                            COMP-3.         01700016
017100         10  PV-LOC-AVAIL-TOT        PIC S9(12)    VALUE ZERO.    01710016
017200         10  PV-LOC-TOT-RETAIL-TOT   PIC S9(12)V99 VALUE ZERO.    01720016
017300* RMK 04/2010 - END                                               01730016
017400     05  PV-COMP-TOTALS                            COMP-3.        01740016
017500         10  PV-COMP-LPULL-TOT       PIC S9(12)    VALUE ZERO.    01750016
017600         10  PV-COMP-AVAIL-TOT       PIC S9(12)    VALUE ZERO.    01760016
017700         10  PV-COMP-TOT-RETAIL-TOT  PIC S9(12)V99 VALUE ZERO.    01770016
017800     05  PV-SKU-TOTALS                             COMP-3.        01780016
017900         10  PV-SKU-AVAIL-TOT        PIC S9(12)    VALUE ZERO.    01790016
018000         10  PV-SKU-TOT-RETAIL-TOT   PIC S9(12)V99 VALUE ZERO.    01800016
018100     05  PV-UNIQ-SKU-TOT             PIC S9(12)    VALUE ZEROS.   01810016
018200     05  PV-RECAP-TOTALS                           COMP-3.        01820016
018300         10  PV-RT-AVAILABLE         PIC S9(12)    VALUE ZERO.    01830016
018400         10  PV-RT-TOT-RETAIL        PIC S9(12)V99 VALUE ZERO.    01840016
018500*                                                                 01850016
018600 01  COMPANY-RECAP-TABLE.                                         01860016
018700     05  RECAP-TABLE  OCCURS 50 TIMES INDEXED BY CS-IDX.          01870035
018800         10  RECAP-CSLOC-NBR         PIC 9(04).                   01880016
018900         10  RECAP-CSLOC-NAME        PIC X(10).                   01890016
019000         10  RECAP-SKU-CNT           PIC 9(09).                   01900016
019100         10  RECAP-AVAILABLE         PIC 9(12).                   01910016
019200         10  RECAP-TOT-RETAIL        PIC 9(12)V99.                01920016
019300*                                                                 01930016
019400     COPY DPWS132O.                                               01940016
019500*                                                                 01950016
019600*                                                                 01960016
019700 01  HL1-HEADING-LINE-1.                                          01970016
019710* CT WR39442 START                                                01971022
019800     05  FILLER                      PIC  X(01)    VALUE SPACES.  01980020
019900     05  FILLER                      PIC  X(14)    VALUE          01990021
020000         'DC LOCATION - '.                                        02000021
020003     05  HL1-OPER-UNT                PIC  X(04)    VALUE SPACES.  02000318
020004     05  FILLER                      PIC  X(01)    VALUE SPACES.  02000421
020005     05  HL1-DC-STORE-NAME           PIC  X(25)    VALUE SPACES.  02000521
020400     05  FILLER                      PIC  X(07)    VALUE SPACES.  02040020
020410* CT WR39442 END                                                  02041021
020500     05  FILLER                      PIC  X(30)    VALUE          02050016
020600         'CENTRAL STOCK INVENTORY REPORT'.                        02060016
020700     05  FILLER                      PIC  X(14)    VALUE SPACES.  02070016
020800     05  FILLER                      PIC  X(20)    VALUE          02080016
020900         'DATA EXTRACT DATE:  '.                                  02090016
021000     05  HL1-EXTRACT-DATE            PIC  X(10)    VALUE SPACES.  02100016
021100     05  HL1-MORE-EXTRACT-DATES      PIC  X(06)    VALUE SPACES.  02110016
021200                                                                  02120016
021300 01  HL2-HEADING-LINE-2.                                          02130016
021400     05  FILLER                      PIC  X(20)    VALUE SPACES.  02140016
021500     05  FILLER                      PIC  X(21)    VALUE          02150016
021600         'RETAIL      LAST PULL'.                                 02160016
021700     05  FILLER                      PIC  X(55)    VALUE SPACES.  02170016
021800     05  FILLER                      PIC  X(03)    VALUE          02180016
021900         'C/S'.                                                   02190016
022000     05  FILLER                      PIC  X(33)    VALUE SPACES.  02200016
022100                                                                  02210016
022200 01  HL3-HEADING-LINE-3.                                          02220016
022300     05  FILLER                      PIC  X(36)    VALUE          02230016
022400         ' BUYER  SKU         PRICE       DATE'.                  02240016
022500     05  FILLER                      PIC  X(06)    VALUE SPACE.   02250016
022600     05  FILLER                      PIC  X(28)    VALUE          02260016
022700         'SKU DESCRIPTION        STYLE'.                          02270016
022800     05  FILLER                      PIC  X(12)    VALUE SPACE.   02280016
022900     05  FILLER                      PIC  X(48)    VALUE          02290016
023000         'SIZE  COLOR   LOC  AVAILABLE    TOTAL RETAIL    '.      02300016
023100     05  FILLER                      PIC  X(02)    VALUE SPACE.   02310016
023200                                                                  02320016
023300********  HL4-HEADING-LINE-4 AND HL5-HEADING-LINE-5 USED          02330016
023400********  FOR COMPANY RECAP REPORT                                02340016
023500 01  HL4-HEADING-LINE-4.                                          02350016
023600     05  FILLER                      PIC  X(34)    VALUE          02360016
023700         ' CENTRAL STOCK       NUMBER OF    '.                    02370016
023800     05  FILLER                      PIC  X(33)    VALUE          02380016
023900         'AVAILABLE              TOTAL     '.                     02390016
024000     05  FILLER                      PIC  X(65)    VALUE SPACE.   02400016
024100                                                                  02410016
024200 01  HL5-HEADING-LINE-5.                                          02420016
024300     05  FILLER                      PIC  X(34)    VALUE          02430016
024400         ' LOCATION              SKUS       '.                    02440016
024500     05  FILLER                      PIC  X(34)    VALUE          02450016
024600         'QUANTITY              RETAIL      '.                    02460016
024700     05  FILLER                      PIC  X(64)    VALUE SPACE.   02470016
024800                                                                  02480016
024900 01  DTL-DETAIL-LINE.                                             02490016
025000     05  FILLER                      PIC  X(01)    VALUE SPACES.  02500016
025100     05  DDL-BUYER                   PIC  X(03).                  02510016
025200     05  FILLER                      PIC  X(04)    VALUE SPACES.  02520016
025300*----------------------------------------------------------------*02530016
025400* CHANGED DDL-SKU FROM X(10) TO 9(8).            WR # 230ZZ      *02540016
025500*----------------------------------------------------------------*02550016
025600*    05  DDL-SKU                     PIC  X(10).                  02560016
025700     05  DDL-SKU                     PIC  9(08)    VALUE ZEROES.  02570016
025800*----------------------------------------------------------------*02580016
025900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02590016
026000*----------------------------------------------------------------*02600016
026100     05  FILLER                      PIC  X(02)    VALUE SPACE.   02610016
026200     05  DDL-RETAIL-PRICE            PIC  ZZZZZZZ.99.             02620016
026300     05  DDL-RETAIL-PRICE-X REDEFINES DDL-RETAIL-PRICE PIC X(10). 02630016
026400     05  FILLER                      PIC  X(02)    VALUE SPACE.   02640016
026500     05  DDL-LAST-PULL-DTE           PIC  X(08).                  02650016
026600     05  FILLER                      PIC  X(02)    VALUE SPACES.  02660016
026700     05  DDL-SKU-DESC                PIC  X(21).                  02670016
026800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02680016
026900     05  DDL-STYLE                   PIC  X(15).                  02690016
026910* CT WR39442 START                                                02691031
027000     05  FILLER                      PIC  X(04)    VALUE SPACES.  02700030
027010* CT WR39442 END                                                  02701031
027100     05  DDL-SIZE                    PIC  X(04).                  02710016
027200     05  FILLER                      PIC  X(02)    VALUE SPACES.  02720016
027300     05  DDL-COLOR                   PIC  X(05).                  02730016
027400     05  FILLER                      PIC  X(02)    VALUE SPACES.  02740030
027500     05  DDL-CSLOC                   PIC  X(04).                  02750016
027600     05  FILLER                      PIC  X(02)    VALUE SPACES.  02760016
027700     05  DDL-AVAIL                   PIC  ZZZZZZZZ9.              02770016
027800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02780016
027900     05  DDL-TOT-RETAIL              PIC  ZZZ,ZZZ,ZZ9.99.         02790016
027910* CT WR39442 START                                                02791031
028000     05  FILLER                      PIC  X(05).                  02800029
028010* CT WR39442 END                                                  02801031
028100                                                                  02810016
028200 01  TOT-SKU-LINE.                                                02820016
028300     05  FILLER                      PIC  X(01)    VALUE SPACES.  02830016
028400     05  DDL-TOT-SKU-BUYER           PIC  X(03).                  02840016
028500     05  FILLER                      PIC  X(04)    VALUE SPACES.  02850016
028600*----------------------------------------------------------------*02860016
028700* CHANGED DDL-TOT-SKU FROM X(10) TO 9(8).         ** WR # 230ZZ  *02870016
028800*----------------------------------------------------------------*02880016
028900*    05  DDL-TOT-SKU                 PIC  X(10).                  02890016
029000     05  DDL-TOT-SKU                 PIC  9(08)    VALUE ZEROES.  02900016
029100*----------------------------------------------------------------*02910016
029200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02920016
029300*----------------------------------------------------------------*02930016
029400     05  FILLER                      PIC  X(24)    VALUE SPACES.  02940016
029500     05  DDL-TOT-SKU-DESC            PIC  X(21).                  02950016
029600     05  FILLER                      PIC  X(21)    VALUE SPACES.  02960016
029700     05  FILLER                      PIC  X(09)    VALUE          02970016
029800         'SKU TOTAL'.                                             02980016
029900     05  FILLER                      PIC  X(06)    VALUE SPACES.  02990016
030000     05  TOT-SKU-AVAIL               PIC  ZZZZZZZZ9.              03000016
030100     05  FILLER                      PIC  X(02)    VALUE SPACES.  03010016
030200     05  TOT-SKU-TOT-RETAIL          PIC  Z,ZZZ,ZZZ,ZZ9.99.       03020016
030300     05  FILLER                      PIC  X(06)    VALUE SPACES.  03030016
030400                                                                  03040016
030500 01  TOT-DEPT-LINE.                                               03050016
030600     05  FILLER                      PIC  X(08)    VALUE SPACES.  03060016
030700     05  TOT-DEPT                    PIC  X(03)    VALUE SPACE.   03070016
030800     05  FILLER                      PIC  X(14)    VALUE          03080016
030900         '  DEPT  TOTALS'.                                        03090016
031000     05  FILLER                      PIC  X(70)    VALUE SPACES.  03100016
031100     05  TOT-AVAIL                   PIC  Z,ZZZ,ZZZ,ZZ9.          03110016
031200     05  FILLER                      PIC  X(01)    VALUE SPACES.  03120016
031300     05  TOT-TOT-RETAIL              PIC  ZZ,ZZZ,ZZZ,ZZ9.99.      03130016
031400     05  FILLER                      PIC  X(06)    VALUE SPACES.  03140016
031500                                                                  03150016
031600* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      03160016
031700 01  TOT-LOC-LINE.                                                03170016
031800     05  FILLER                      PIC  X(08)    VALUE SPACES.  03180016
031900     05  FILLER                      PIC  X(15)    VALUE          03190016
032000         'LOCATION TOTALS'.                                       03200016
032100     05  FILLER                      PIC  X(72)    VALUE SPACES.  03210016
032200     05  TOT-LOC-AVAIL               PIC  Z,ZZZ,ZZZ,ZZ9.          03220016
032300     05  FILLER                      PIC  X(01)    VALUE SPACES.  03230016
032400     05  TOT-LOC-TOT-RETAIL          PIC  ZZ,ZZZ,ZZZ,ZZ9.99.      03240016
032500     05  FILLER                      PIC  X(06)    VALUE SPACES.  03250016
032600                                                                  03260016
032700 01  TOT-COMP-LINE.                                               03270016
032800     05  FILLER                      PIC  X(06)    VALUE SPACES.  03280016
032900     05  FILLER                      PIC  X(14)    VALUE          03290016
033000         'COMPANY TOTALS'.                                        03300016
033100     05  FILLER                      PIC  X(75)    VALUE SPACES.  03310016
033200     05  TOT-COMP-AVAIL              PIC  Z,ZZZ,ZZZ,ZZ9.          03320016
033300     05  FILLER                      PIC  X(01)    VALUE SPACES.  03330016
033400     05  TOT-COMP-TOT-RETAIL         PIC  ZZ,ZZZ,ZZZ,ZZ9.99.      03340016
033500     05  FILLER                      PIC  X(06)    VALUE SPACES.  03350016
033600                                                                  03360016
033700 01  RECAP-DETAIL-LINE.                                           03370016
033800     05  FILLER                      PIC  X(01)    VALUE SPACES.  03380016
033900     05  RDL-CSLOC-NBR               PIC  9(04)    VALUE ZEROS.   03390016
034000     05  FILLER                      PIC  X(01)    VALUE '-'.     03400016
034100     05  RDL-CSLOC-NAME              PIC  X(10)    VALUE SPACES.  03410016
034200     05  FILLER                      PIC  X(06)    VALUE SPACES.  03420016
034300     05  RDL-SKU-CNT                 PIC  ZZZZZZ9.                03430016
034400     05  FILLER                      PIC  X(05)    VALUE SPACES.  03440016
034500     05  RDL-AVAILABLE               PIC  ZZZZZZZZ9.              03450016
034600     05  FILLER                      PIC  X(05)    VALUE SPACES.  03460016
034700     05  RDL-TOT-RETAIL              PIC  ZZZ,ZZZ,ZZ9.99.         03470016
034800     05  FILLER                      PIC  X(72)    VALUE SPACES.  03480016
034900                                                                  03490016
035000 01  RECAP-TOTAL-LINE.                                            03500016
035100     05  FILLER                      PIC  X(01)    VALUE SPACES.  03510016
035200     05  FILLER                      PIC  X(05)    VALUE 'TOTAL'. 03520016
035300     05  FILLER                      PIC  X(16)    VALUE SPACES.  03530016
035400     05  RTL-SKU-CNT                 PIC  ZZZZZZ9.                03540016
035500     05  FILLER                      PIC  X(05)    VALUE SPACES.  03550016
035600     05  RTL-AVAILABLE               PIC  ZZZZZZZZ9.              03560016
035700     05  FILLER                      PIC  X(05)    VALUE SPACES.  03570016
035800     05  RTL-TOTAL-RETAIL            PIC  ZZZ,ZZZ,ZZ9.99.         03580016
035900     05  FILLER                      PIC  X(72)    VALUE SPACES.  03590016
036000                                                                  03600016
036100 01  LEGEND-LINE.                                                 03610016
036200     05  FILLER                      PIC  X(01)    VALUE SPACES.  03620016
036300     05  LL-LEGEND                   PIC  X(13)    VALUE SPACES.  03630016
036400     05  FILLER                      PIC  X(118)   VALUE SPACES.  03640016
036500                                                                  03650016
036600 01  BL-BLANK-LINE                   PIC X(132)    VALUE SPACES.  03660016
036700*                                                                 03670016
036800                                                                  03680016
036900 01  PR-PRINT-NO-DETAIL.                                          03690016
037000     05  FILLER                      PIC X(02)  VALUE SPACES.     03700016
037100     05  FILLER                      PIC X(35)  VALUE             03710016
037200         '*** THERE WAS NO DATA TO REPORT ON '.                   03720016
037300     05  FILLER                      PIC X(24)  VALUE             03730016
037400         'FOR THIS TIME PERIOD ***'.                              03740016
037500                                                                  03750016
037600 01  PR-PRINT-FINAL.                                              03760016
037700     05  FILLER                      PIC X(53)  VALUE SPACES.     03770016
037800     05  FILLER                      PIC X(21)  VALUE             03780016
037900         '*** END OF REPORT ***'.                                 03790016
038000                                                                  03800016
038100     COPY CERD010.                                                03810016
038200                                                                  03820016
038300     COPY CERD011.                                                03830016
038400                                                                  03840016
038500* COPYBOOK FOR SQL ERROR PROCESSING                               03850016
038600     COPY DPWS004.                                                03860016
038700*                                                                 03870016
038800* DB2 WORK AREAS                                                  03880016
038900*---------------------------------------------------------------* 03890016
039000*    DB2 AREA FOR XLT_LOC (XLT00010)                            * 03900016
039100*---------------------------------------------------------------* 03910016
039200     EXEC SQL                                                     03920016
039300          INCLUDE XLT00010                                        03930016
039400     END-EXEC.                                                    03940016
039500*                                                                 03950016
039600*---------------------------------------------------------------* 03960016
039700*   DB2  AREA  FOR COMMUNICATION                                * 03970016
039800*---------------------------------------------------------------* 03980016
039900     EXEC SQL                                                     03990016
040000          INCLUDE SQLCA                                           04000016
040100     END-EXEC.                                                    04010016
040200*                                                                 04020016
040300     EXEC SQL                                                     04030016
040400         DECLARE CS_CSR CURSOR FOR                                04040016
040500             SELECT LOC_NBR                                       04050016
040600                  , LOC_10_ABBR_NM                                04060016
040700               FROM XLT_LOC                                       04070016
040800              WHERE LOC_TYP_CDE = 'CS'                            04080016
040900                AND CLO_DTE >= CURRENT DATE                       04090016
041000                AND OPN_DTE <= CURRENT DATE                       04100016
041100              ORDER BY 1                                          04110016
041200     END-EXEC.                                                    04120016
041300/                                                                 04130016
041400***************************************************************** 04140016
041500 PROCEDURE DIVISION.                                              04150016
041600***************************************************************** 04160016
041700*                                                                 04170016
041800 0000-MAINLINE.                                                   04180016
041900***************************************************************** 04190016
042000*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04200016
042100***************************************************************** 04210016
042200     PERFORM 1000-INITIALIZE.                                     04220016
042300*                                                                 04230016
042400     IF  PS-EOF-FILE                                              04240016
042500         PERFORM 6900-NO-DETAIL                                   04250016
042600     ELSE                                                         04260016
042700* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      04270016
042800         PERFORM 1500-MAIN-LOOP                                   04280016
042900           UNTIL  PS-EOF-FILE                                     04290016
043000     END-IF.                                                      04300016
043100                                                                  04310016
043200     PERFORM 9000-END-PROCESS.                                    04320016
043300*                                                                 04330016
043400     STOP RUN.                                                    04340016
043500*                                                                 04350016
043600 1000-INITIALIZE.                                                 04360016
043700***************************************************************** 04370016
043800*  PROGRAM INITIALIZATION                                       * 04380016
043900*    -- OPEN INPUT AND OUTPUT FILES.                            * 04390016
044000*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 04400016
044100*       THE REPORT HEADINGS.                                    * 04410016
044200***************************************************************** 04420016
044300     OPEN  INPUT  CE-FILE                                         04430016
044400                  CE-FILE2                                        04440016
044500           OUTPUT CE-REPORT-FILE                                  04450016
044600                  CE-RECAP-FILE.                                  04460016
044700*                                                                 04470016
044800     ACCEPT CD-CPU-DATE FROM DATE.                                04480016
044900     ACCEPT CT-CPU-TIME FROM TIME.                                04490016
045000*                                                                 04500016
045100     PERFORM 1010-INITIALIZE-RECAP-TABLE.                         04510016
045200     PERFORM 1020-LOAD-RECAP-TABLE.                               04520016
045300     PERFORM 1200-INITIALIZE-HEADINGS.                            04530016
045400     PERFORM 7000-READ-CE-FILE.                                   04540016
045500* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      04550016
045510* CT WR39442 START                                                04551018
045600     MOVE CE010-CNTRL-STK-ID TO PV-PREV-CNTRL-STK-ID              04560017
045610                                HL1-OPER-UNT                      04561026
045611                                PV-LOC-NBR.                       04561131
045612     PERFORM 1050-GET-HEADING-LOC-NAME.                           04561221
045613     MOVE XLT00010-LOC-NM    TO HL1-DC-STORE-NAME.                04561325
045620* CT WR39442 END                                                  04562022
045700     SET PS-FIRST-TIME-NO TO TRUE.                                04570016
045800     PERFORM 7100-READ-CE-FILE2.                                  04580016
045900     PERFORM 6999-PRINT-HEADINGS.                                 04590016
046000     MOVE CE010-DEPT   TO PV-SAVE-DEPT.                           04600016
046100     MOVE CE010-BUYER  TO PV-SAVE-BUYER.                          04610016
046200*                                                                 04620016
046300***************************************************************** 04630016
046400*  INITIALIZE RECAP TABLE                                       * 04640016
046500***************************************************************** 04650016
046600 1010-INITIALIZE-RECAP-TABLE.                                     04660016
046700     PERFORM VARYING CS-IDX FROM 1 BY 1                           04670016
046800            UNTIL CS-IDX > 50                                     04680035
046900        MOVE ZEROS    TO RECAP-CSLOC-NBR (CS-IDX)                 04690016
047000                         RECAP-SKU-CNT (CS-IDX)                   04700016
047100                         RECAP-AVAILABLE (CS-IDX)                 04710016
047200                         RECAP-TOT-RETAIL (CS-IDX)                04720016
047300        MOVE SPACES   TO RECAP-CSLOC-NAME (CS-IDX)                04730016
047400     END-PERFORM.                                                 04740016
047500*                                                                 04750016
047600***************************************************************** 04760016
047700*  LOAD RECAP TABLE                                             * 04770016
047800***************************************************************** 04780016
047900 1020-LOAD-RECAP-TABLE.                                           04790016
048000     EXEC SQL                                                     04800016
048100         OPEN CS_CSR                                              04810016
048200     END-EXEC.                                                    04820016
048300                                                                  04830016
048400     EVALUATE TRUE                                                04840016
048500         WHEN SQLCODE = ZERO                                      04850016
048600             CONTINUE                                             04860016
048700         WHEN OTHER                                               04870016
048800             MOVE '1020-LOAD-RECAP-TABLE' TO PV-ABEND-PARAGRAPH   04880016
048900             MOVE 'SQL ERROR OPENING CURSOR' TO                   04890016
049000                            PV-DB2-OPERATION-ATTEMPTED            04900016
049100             PERFORM 9999-SQL-ERROR                               04910016
049200     END-EVALUATE.                                                04920016
049300                                                                  04930016
049400     PERFORM  1030-FETCH-CURSOR.                                  04940016
049500                                                                  04950016
049600     PERFORM VARYING CS-IDX FROM 1 BY 1                           04960016
049700         UNTIL CS-IDX > 50 OR PS-END-OF-CURSOR                    04970035
049800         MOVE XLT00010-LOC-NBR TO RECAP-CSLOC-NBR (CS-IDX)        04980016
049900         MOVE XLT00010-LOC-10-ABBR-NM  TO                         04990016
050000                             RECAP-CSLOC-NAME (CS-IDX)            05000016
050100         PERFORM 1030-FETCH-CURSOR                                05010016
050200     END-PERFORM.                                                 05020016
050300                                                                  05030016
050400     EXEC SQL                                                     05040016
050500         CLOSE CS_CSR                                             05050016
050600     END-EXEC.                                                    05060016
050700                                                                  05070016
050800     EVALUATE TRUE                                                05080016
050900         WHEN SQLCODE = ZERO                                      05090016
051000             CONTINUE                                             05100016
051100         WHEN OTHER                                               05110016
051200             MOVE '1020-LOAD-RECAP-TABLE' TO PV-ABEND-PARAGRAPH   05120016
051300             MOVE 'SQL ERROR CLOSING CURSOR' TO                   05130016
051400                            PV-DB2-OPERATION-ATTEMPTED            05140016
051500             PERFORM 9999-SQL-ERROR                               05150016
051600     END-EVALUATE.                                                05160016
051700*                                                                 05170016
051800***************************************************************** 05180016
051900*    FETCH DATA FROM XLT_LOC (XLT00010)                         * 05190016
052000***************************************************************** 05200016
052100 1030-FETCH-CURSOR.                                               05210016
052200     EXEC SQL                                                     05220016
052300         FETCH CS_CSR                                             05230016
052400          INTO :XLT00010-LOC-NBR                                  05240016
052500             , :XLT00010-LOC-10-ABBR-NM                           05250016
052600     END-EXEC.                                                    05260016
052700                                                                  05270016
052800     EVALUATE TRUE                                                05280016
052900         WHEN SQLCODE = ZERO                                      05290016
053000             CONTINUE                                             05300016
053100         WHEN SQLCODE = +100                                      05310016
053200             SET PS-END-OF-CURSOR  TO TRUE                        05320016
053300         WHEN OTHER                                               05330016
053400             MOVE '1030-FETCH-CURSOR    ' TO PV-ABEND-PARAGRAPH   05340016
053500             MOVE 'SQL ERROR FETCHING DATA ' TO                   05350016
053600                            PV-DB2-OPERATION-ATTEMPTED            05360016
053700             PERFORM 9999-SQL-ERROR                               05370016
053800     END-EVALUATE.                                                05380016
053900*                                                                 05390016
053901* CT WR39442 START                                                05390122
053910***************************************************************** 05391022
053920*    SELECT HEADING LOCATION NAME VIA INPUT LOCATION            * 05392022
053930***************************************************************** 05393022
053940 1050-GET-HEADING-LOC-NAME.                                       05394022
053950     EXEC SQL                                                     05395022
053960         SELECT  LOC_NM                                           05396022
053981           INTO  :XLT00010-LOC-NM                                 05398122
053982           FROM  XLT_LOC                                          05398222
053983          WHERE  LOC_NBR = :PV-LOC-NBR                            05398322
053990     END-EXEC.                                                    05399022
053991                                                                  05399122
053992     EVALUATE TRUE                                                05399222
053993         WHEN SQLCODE = ZERO                                      05399322
053994             CONTINUE                                             05399422
053995         WHEN SQLCODE = +100                                      05399522
053996             MOVE 'UNKNOWN' TO XLT00010-LOC-NM                    05399624
053997         WHEN OTHER                                               05399722
053998             MOVE '1050-SELECT XLT_LOC  ' TO PV-ABEND-PARAGRAPH   05399822
053999             MOVE 'SQL ERROR SELECTING DATA ' TO                  05399922
054000                            PV-DB2-OPERATION-ATTEMPTED            05400022
054001             PERFORM 9999-SQL-ERROR                               05400122
054002     END-EVALUATE.                                                05400222
054003*                                                                 05400322
054004* CT WR39442 END                                                  05400422
054010 1200-INITIALIZE-HEADINGS.                                        05401016
054100***************************************************************** 05410016
054200*  INITIALIZE REPORT HEADINGS                                   * 05420016
054300***************************************************************** 05430016
054400     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              05440016
054500     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             05450016
054600     MOVE CD-DAY                 TO DP132O-RUN-DAY.               05460016
054700     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              05470016
054800     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            05480016
054900     MOVE 'CEKRP013'             TO DP132O-PROGRAM-NAME.          05490016
055000     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05500016
055100*                                                                 05510016
055200*                                                                 05520016
055300* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      05530016
055400***************************************************************** 05540016
055500*  PERFORM LOOP UNTIL EOF                                       * 05550016
055600***************************************************************** 05560016
055700 1500-MAIN-LOOP.                                                  05570016
055800     PERFORM 2000-MAIN-PROCESS                                    05580016
055900         UNTIL  PS-LOC-FILE-BREAK                                 05590016
056000         OR     PS-EOF-FILE                                       05600016
056100         SET PS-LOC-FILE-BREAK-NO TO TRUE.                        05610016
056200     MOVE PV-SAVE-DEPT TO TOT-DEPT.                               05620016
056300     PERFORM 6750-PRINT-TOTALS.                                   05630016
056400     PERFORM 6800-PRINT-LOC-TOTAL.                                05640016
056500     PERFORM 6999-PRINT-HEADINGS.                                 05650016
056600     MOVE ZERO TO PV-DATE-COUNT.                                  05660016
056700     MOVE ZERO TO PV-LOC-AVAIL-TOT.                               05670016
056800     MOVE ZERO TO PV-LOC-TOT-RETAIL-TOT.                          05680016
056900     MOVE CE010-DEPT  TO PV-SAVE-DEPT.                            05690016
057000     MOVE CE010-BUYER TO PV-SAVE-BUYER.                           05700016
057100     MOVE ZEROES      TO PV-AVAIL-TOT.                            05710016
057200     MOVE ZEROES      TO PV-TOT-RETAIL-TOT.                       05720016
057300* RMK 04/2010 - END                                               05730016
057400*                                                                 05740016
057500 2000-MAIN-PROCESS.                                               05750016
057600*                                                                 05760016
057700     IF CE010-SKU-NBR NOT EQUAL PV-PREV-SKU                       05770016
057800         SET PS-NO-PRINT-MULTI-SKUS  TO   TRUE                    05780016
057900         ADD 1 TO PV-UNIQ-SKU-TOT                                 05790016
058000         IF PS-PRINT-SKU-TOTALS                                   05800016
058100             PERFORM 6500-PRINT-SKU-TOTALS                        05810016
058200             SET PS-NO-PRINT-SKU-TOTALS  TO TRUE                  05820016
058300         END-IF                                                   05830016
058400         IF  PV-SAVE-DEPT = CE010-DEPT                            05840016
058500             CONTINUE                                             05850016
058600         ELSE                                                     05860016
058700             MOVE PV-SAVE-DEPT TO TOT-DEPT                        05870016
058800             PERFORM 6750-PRINT-TOTALS                            05880016
058900             MOVE ZEROES     TO  PV-AVAIL-TOT                     05890016
059000                                 PV-TOT-RETAIL-TOT                05900016
059100             MOVE CE010-DEPT TO PV-SAVE-DEPT                      05910016
059200             PERFORM 6999-PRINT-HEADINGS                          05920016
059300         END-IF                                                   05930016
059400         PERFORM 3000-PROCESS-DETAIL-RECORD                       05940016
059500     ELSE                                                         05950016
059600         PERFORM 4000-MULTI-SKUS                                  05960016
059700         MOVE CE010-BUYER  TO PV-SAVE-BUYER                       05970016
059800         IF  PV-SAVE-DEPT = CE010-DEPT                            05980016
059900             CONTINUE                                             05990016
060000         ELSE                                                     06000016
060100             MOVE PV-SAVE-DEPT TO TOT-DEPT                        06010016
060200             PERFORM 6750-PRINT-TOTALS                            06020016
060300             MOVE ZEROES     TO  PV-AVAIL-TOT                     06030016
060400                                 PV-TOT-RETAIL-TOT                06040016
060500             MOVE CE010-DEPT TO PV-SAVE-DEPT                      06050016
060600             PERFORM 6999-PRINT-HEADINGS                          06060016
060700         END-IF                                                   06070016
060800     END-IF.                                                      06080016
060900                                                                  06090016
061000     PERFORM 7000-READ-CE-FILE.                                   06100016
061100*                                                                 06110016
061200*                                                                 06120016
061300 3000-PROCESS-DETAIL-RECORD.                                      06130016
061400                                                                  06140016
061500     MOVE CE010-BUYER                TO  DDL-BUYER.               06150016
061600     MOVE CE010-SKU-NBR              TO  DDL-SKU.                 06160016
061700     MOVE CE010-CUR-UNIT-RTL-AMT     TO  DDL-RETAIL-PRICE.        06170016
061800     IF  CE010-PULL-MM = '00'                                     06180016
061900         MOVE SPACES                 TO  DDL-LAST-PULL-DTE        06190016
062000     ELSE                                                         06200016
062100         MOVE CE010-LAST-PULL-DATE   TO  DDL-LAST-PULL-DTE        06210016
062200     END-IF.                                                      06220016
062300     MOVE CE010-SKU-DESC             TO  DDL-SKU-DESC.            06230016
062400     MOVE CE010-VENDOR-STYLE-CODE    TO  DDL-STYLE.               06240016
062500     MOVE CE010-SIZE-DESC            TO  DDL-SIZE.                06250016
062600     MOVE CE010-COLOR-DESC           TO  DDL-COLOR.               06260016
062700     MOVE CE010-CNTRL-STK-ID         TO  DDL-CSLOC.               06270016
062800     MOVE CE010-AVAILABLE            TO  DDL-AVAIL.               06280016
062900     COMPUTE PV-TOT-RETAIL =                                      06290016
063000          CE010-CUR-UNIT-RTL-AMT * CE010-AVAILABLE                06300016
063100     MOVE PV-TOT-RETAIL              TO  DDL-TOT-RETAIL.          06310016
063200     ADD  CE010-AVAILABLE            TO  PV-AVAIL-TOT             06320016
063300* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      06330016
063400                                         PV-LOC-AVAIL-TOT         06340016
063500                                         PV-COMP-AVAIL-TOT.       06350016
063600     ADD  PV-TOT-RETAIL              TO  PV-TOT-RETAIL-TOT        06360016
063700* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      06370016
063800                                         PV-LOC-TOT-RETAIL-TOT    06380016
063900                                         PV-COMP-TOT-RETAIL-TOT.  06390016
064000     MOVE CE010-AVAILABLE            TO  PV-SKU-AVAIL-TOT.        06400016
064100     MOVE PV-TOT-RETAIL              TO  PV-SKU-TOT-RETAIL-TOT.   06410016
064200     MOVE CE010-SKU-NBR              TO  PV-PREV-SKU.             06420016
064300     PERFORM 5000-SEARCH-RECAP-TABLE.                             06430016
064400     PERFORM 6000-PRINT-DETAIL-LINE.                              06440016
064500*                                                                 06450016
064600 4000-MULTI-SKUS.                                                 06460016
064700     MOVE SPACES                     TO  DDL-RETAIL-PRICE-X.      06470016
064800     MOVE CE010-CNTRL-STK-ID         TO  DDL-CSLOC.               06480016
064900     MOVE CE010-AVAILABLE            TO  DDL-AVAIL.               06490016
065000     COMPUTE PV-TOT-RETAIL =                                      06500016
065100          CE010-CUR-UNIT-RTL-AMT * CE010-AVAILABLE                06510016
065200     MOVE PV-TOT-RETAIL              TO  DDL-TOT-RETAIL.          06520016
065300     ADD  CE010-AVAILABLE            TO  PV-AVAIL-TOT             06530016
065400                                         PV-COMP-AVAIL-TOT        06540016
065500* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      06550016
065600                                         PV-LOC-AVAIL-TOT         06560016
065700                                         PV-SKU-AVAIL-TOT.        06570016
065800     ADD  PV-TOT-RETAIL              TO  PV-TOT-RETAIL-TOT        06580016
065900* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      06590016
066000                                         PV-LOC-TOT-RETAIL-TOT    06600016
066100                                         PV-COMP-TOT-RETAIL-TOT   06610016
066200                                         PV-SKU-TOT-RETAIL-TOT.   06620016
066300                                                                  06630016
066400     SET PS-PRINT-SKU-TOTALS  TO   TRUE.                          06640016
066500     SET PS-PRINT-MULTI-SKUS  TO   TRUE.                          06650016
066600     PERFORM 5000-SEARCH-RECAP-TABLE.                             06660016
066700     PERFORM 6000-PRINT-DETAIL-LINE.                              06670016
066800*                                                                 06680016
066900 5000-SEARCH-RECAP-TABLE.                                         06690016
067000     SET CS-IDX TO 1.                                             06700016
067100     SEARCH RECAP-TABLE                                           06710016
067200         VARYING CS-IDX                                           06720016
067300              AT END SET PS-END-OF-TABLE TO TRUE                  06730016
067400         WHEN RECAP-CSLOC-NBR (CS-IDX) = CE010-CNTRL-STK-ID       06740016
067500              ADD CE010-AVAILABLE TO RECAP-AVAILABLE (CS-IDX)     06750016
067600              ADD PV-TOT-RETAIL   TO RECAP-TOT-RETAIL (CS-IDX)    06760016
067700              ADD 1               TO RECAP-SKU-CNT (CS-IDX)       06770016
067800     END-SEARCH.                                                  06780016
067900*                                                                 06790016
068000 6000-PRINT-DETAIL-LINE.                                          06800016
068100*                                                                 06810016
068200     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            06820016
068300         PERFORM 6999-PRINT-HEADINGS                              06830016
068400     END-IF.                                                      06840016
068500*                                                                 06850016
068600     WRITE CE-REPORT-RECORD                                       06860016
068700       FROM DTL-DETAIL-LINE                                       06870016
068800         AFTER ADVANCING 1 LINE                                   06880016
068900*        AFTER ADVANCING 2 LINE                                   06890016
069000     ADD 2                      TO PV-LINE-COUNT.                 06900016
069100     INITIALIZE DTL-DETAIL-LINE.                                  06910016
069200                                                                  06920016
069300 6500-PRINT-SKU-TOTALS.                                           06930016
069400*                                                                 06940016
069500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            06950016
069600         PERFORM 6999-PRINT-HEADINGS                              06960016
069700     ELSE                                                         06970016
069800         MOVE SPACES           TO DDL-TOT-SKU-BUYER               06980016
069900*        MOVE SPACES           TO DDL-TOT-SKU                     06990016
070000         MOVE ZEROES           TO DDL-TOT-SKU                     07000016
070100         MOVE SPACES           TO DDL-TOT-SKU-DESC                07010016
070200     END-IF.                                                      07020016
070300*                                                                 07030016
070400     MOVE  PV-SKU-AVAIL-TOT    TO TOT-SKU-AVAIL.                  07040016
070500     MOVE  PV-SKU-TOT-RETAIL-TOT TO TOT-SKU-TOT-RETAIL.           07050016
070600*                                                                 07060016
070700     WRITE CE-REPORT-RECORD                                       07070016
070800       FROM TOT-SKU-LINE                                          07080016
070900         AFTER ADVANCING 1 LINE                                   07090016
071000     WRITE CE-REPORT-RECORD                                       07100016
071100       FROM BL-BLANK-LINE                                         07110016
071200         AFTER ADVANCING 1 LINE                                   07120016
071300     ADD 2                      TO PV-LINE-COUNT.                 07130016
071400                                                                  07140016
071500 6750-PRINT-TOTALS.                                               07150016
071600*                                                                 07160016
071700     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            07170016
071800         PERFORM 6999-PRINT-HEADINGS                              07180016
071900     END-IF.                                                      07190016
072000*                                                                 07200016
072100     MOVE  PV-AVAIL-TOT    TO TOT-AVAIL.                          07210016
072200     MOVE  PV-TOT-RETAIL-TOT TO TOT-TOT-RETAIL.                   07220016
072300*                                                                 07230016
072400     WRITE CE-REPORT-RECORD                                       07240016
072500       FROM TOT-DEPT-LINE                                         07250016
072600         AFTER ADVANCING 2 LINE.                                  07260016
072700                                                                  07270016
072800                                                                  07280016
072900* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      07290016
073000 6800-PRINT-LOC-TOTAL.                                            07300016
073100*                                                                 07310016
073200     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            07320016
073300         PERFORM 6999-PRINT-HEADINGS                              07330016
073400     END-IF.                                                      07340016
073500*                                                                 07350016
073600     MOVE  PV-LOC-AVAIL-TOT    TO TOT-LOC-AVAIL.                  07360016
073700     MOVE  PV-LOC-TOT-RETAIL-TOT TO TOT-LOC-TOT-RETAIL.           07370016
073800*                                                                 07380016
073900     WRITE CE-REPORT-RECORD                                       07390016
074000       FROM TOT-LOC-LINE                                          07400016
074100         AFTER ADVANCING 2 LINE.                                  07410016
074200     ADD 2                     TO PV-LINE-COUNT.                  07420016
074300                                                                  07430016
074400 6850-PRINT-COMP-TOTAL.                                           07440016
074500*                                                                 07450016
074600* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      07460016
074700*    PERFORM 6999-PRINT-HEADINGS.                                 07470016
074800*                                                                 07480016
074900     MOVE  PV-COMP-AVAIL-TOT    TO TOT-COMP-AVAIL.                07490016
075000     MOVE  PV-COMP-TOT-RETAIL-TOT TO TOT-COMP-TOT-RETAIL.         07500016
075100*                                                                 07510016
075200     WRITE CE-REPORT-RECORD                                       07520016
075300       FROM TOT-COMP-LINE                                         07530016
075400         AFTER ADVANCING 2 LINE.                                  07540016
075500                                                                  07550016
075600 6875-PRINT-RECAP.                                                07560016
075700     MOVE PC-2                   TO DP132O-REPORT-NUMBER.         07570016
075800     MOVE 1                      TO PV-PAGE-COUNT.                07580016
075900     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           07590016
076000***                                                               07600016
076100     WRITE CE-RECAP-RECORD                                        07610016
076200       FROM DP132O-STANDRD-HEADER-132-COLS                        07620016
076300         AFTER ADVANCING PAGE.                                    07630016
076400***                                                               07640016
076500     WRITE CE-RECAP-RECORD                                        07650016
076600       FROM DP132O-CNFDL-HDR-132-COLS                             07660016
076700         AFTER ADVANCING 1 LINE.                                  07670016
076800***                                                               07680016
076900     WRITE CE-RECAP-RECORD                                        07690016
077000       FROM HL1-HEADING-LINE-1                                    07700016
077100         AFTER ADVANCING 2 LINE.                                  07710016
077200***                                                               07720016
077300     MOVE 'COMPANY RECAP'    TO LL-LEGEND.                        07730016
077400     WRITE CE-RECAP-RECORD                                        07740016
077500       FROM LEGEND-LINE                                           07750016
077600         AFTER ADVANCING 2 LINE.                                  07760016
077700                                                                  07770016
077800     WRITE CE-RECAP-RECORD                                        07780016
077900       FROM HL4-HEADING-LINE-4                                    07790016
078000         AFTER ADVANCING 2 LINE.                                  07800016
078100                                                                  07810016
078200     WRITE CE-RECAP-RECORD                                        07820016
078300       FROM HL5-HEADING-LINE-5                                    07830016
078400         AFTER ADVANCING 1 LINE.                                  07840016
078500                                                                  07850016
078600     WRITE CE-RECAP-RECORD                                        07860016
078700       FROM BL-BLANK-LINE                                         07870016
078800         AFTER ADVANCING 1 LINE.                                  07880016
078900                                                                  07890016
079000     MOVE 10                     TO PV-LINE-COUNT.                07900016
079100* GET STUFF FROM TABLE                                            07910016
079200     PERFORM VARYING CS-IDX FROM 1 BY 1                           07920016
079300         UNTIL RECAP-CSLOC-NBR (CS-IDX) = ZEROS                   07930016
079400            MOVE RECAP-CSLOC-NBR (CS-IDX) TO RDL-CSLOC-NBR        07940016
079500            MOVE RECAP-CSLOC-NAME (CS-IDX) TO RDL-CSLOC-NAME      07950016
079600            MOVE RECAP-SKU-CNT (CS-IDX) TO RDL-SKU-CNT            07960016
079700            MOVE RECAP-AVAILABLE (CS-IDX) TO RDL-AVAILABLE        07970016
079800            MOVE RECAP-TOT-RETAIL (CS-IDX) TO RDL-TOT-RETAIL      07980016
079900            ADD  RECAP-AVAILABLE (CS-IDX) TO PV-RT-AVAILABLE      07990016
080000            ADD  RECAP-TOT-RETAIL (CS-IDX) TO PV-RT-TOT-RETAIL    08000016
080100            WRITE CE-RECAP-RECORD FROM RECAP-DETAIL-LINE          08010016
080200                AFTER ADVANCING 1 LINE                            08020016
080300     END-PERFORM.                                                 08030016
080400                                                                  08040016
080500     MOVE PV-UNIQ-SKU-TOT TO RTL-SKU-CNT.                         08050016
080600     MOVE PV-RT-AVAILABLE TO RTL-AVAILABLE.                       08060016
080700     MOVE PV-RT-TOT-RETAIL TO RTL-TOTAL-RETAIL.                   08070016
080800                                                                  08080016
080900     WRITE CE-RECAP-RECORD                                        08090016
081000       FROM RECAP-TOTAL-LINE                                      08100016
081100         AFTER ADVANCING 2 LINE.                                  08110016
081200                                                                  08120016
081300 6900-NO-DETAIL.                                                  08130016
081400***************************************************************** 08140016
081500*  PRINT NO DETAIL LINE                                         * 08150016
081600***************************************************************** 08160016
081700     WRITE CE-REPORT-RECORD                                       08170016
081800       FROM PR-PRINT-NO-DETAIL                                    08180016
081900         AFTER ADVANCING 3 LINE.                                  08190016
082000*                                                                 08200016
082100     WRITE CE-REPORT-RECORD                                       08210016
082200       FROM PR-PRINT-FINAL                                        08220016
082300         AFTER ADVANCING 3 LINE.                                  08230016
082400*                                                                 08240016
082500*                                                                 08250016
082600 6999-PRINT-HEADINGS.                                             08260016
082700***************************************************************** 08270016
082800*  HEADING ROUTINE.                                             * 08280016
082900***************************************************************** 08290016
083000     ADD 1                       TO PV-PAGE-COUNT.                08300016
083100     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           08310016
083200***                                                               08320016
083300     WRITE CE-REPORT-RECORD                                       08330016
083400       FROM DP132O-STANDRD-HEADER-132-COLS                        08340016
083500         AFTER ADVANCING PAGE.                                    08350016
083600***                                                               08360016
083700     WRITE CE-REPORT-RECORD                                       08370016
083800       FROM DP132O-CNFDL-HDR-132-COLS                             08380016
083900         AFTER ADVANCING 1 LINE.                                  08390016
084000***                                                               08400016
084100     MOVE CE011-TMST-MM   TO RFMT-DATE-MM.                        08410016
084200     MOVE CE011-TMST-DD   TO RFMT-DATE-DD.                        08420016
084300     MOVE CE011-TMST-CCYY TO RFMT-DATE-CCYY.                      08430016
084400     MOVE RFMT-DATE TO HL1-EXTRACT-DATE.                          08440016
084500     IF PV-DATE-COUNT > +1                                        08450016
084600         MOVE PC-MORE-DATES TO HL1-MORE-EXTRACT-DATES             08460016
084700     ELSE                                                         08470016
084800         MOVE SPACES TO HL1-MORE-EXTRACT-DATES                    08480016
084900     END-IF.                                                      08490016
085000     WRITE CE-REPORT-RECORD                                       08500016
085100       FROM HL1-HEADING-LINE-1                                    08510016
085200         AFTER ADVANCING 2 LINE.                                  08520016
085300***                                                               08530016
085400     WRITE CE-REPORT-RECORD                                       08540016
085500       FROM HL2-HEADING-LINE-2                                    08550016
085600         AFTER ADVANCING 2 LINE.                                  08560016
085700***                                                               08570016
085800     WRITE CE-REPORT-RECORD                                       08580016
085900       FROM HL3-HEADING-LINE-3                                    08590016
086000         AFTER ADVANCING 1 LINE.                                  08600016
086100*                                                                 08610016
086200***                                                               08620016
086300     MOVE SPACES TO CE-REPORT-RECORD.                             08630016
086400     WRITE CE-REPORT-RECORD                                       08640016
086500         AFTER ADVANCING 1 LINE.                                  08650016
086600*                                                                 08660016
086700     MOVE 10                     TO PV-LINE-COUNT.                08670016
086800                                                                  08680016
086900***************************************************************** 08690016
087000*  DETERMINE IF THE PAGE BREAK OCCURS DURING A MULTI SKU PRINT OR 08700016
087100*  A SKU TABULATION -- IF SO, PUT OUT THE CURRENT BUYER AND SKU   08710016
087200*  INFORMATION ALONG WITH THE MULTI SKU INFORMATION OR SKU TOTAL  08720016
087300*  ON THE FIRST LINE OF THE DETAIL ON THAT PAGE -- FOR RDS SORTING08730016
087400*  PURPOSES.                                                      08740016
087500***************************************************************** 08750016
087600                                                                  08760016
087700     IF CE010-SKU-NBR EQUAL PV-PREV-SKU  AND                      08770016
087800        PS-PRINT-MULTI-SKUS                                       08780016
087900          MOVE PV-SAVE-BUYER         TO DDL-BUYER                 08790016
088000          MOVE PV-PREV-SKU           TO DDL-SKU                   08800016
088100          MOVE '(CONTINUED)'         TO DDL-SKU-DESC.             08810031
088200                                                                  08820016
088300     IF PS-PRINT-SKU-TOTALS           AND                         08830016
088400        PS-NO-PRINT-MULTI-SKUS                                    08840016
088500          MOVE PV-SAVE-BUYER         TO DDL-TOT-SKU-BUYER         08850016
088600          MOVE PV-PREV-SKU           TO DDL-TOT-SKU               08860016
088700          MOVE '(CONTINUED)'         TO DDL-TOT-SKU-DESC.         08870016
088800                                                                  08880016
088900*                                                                 08890016
089000 7000-READ-CE-FILE.                                               08900016
089100     READ CE-FILE INTO CE010-SKU-RECORD                           08910016
089200         AT END                                                   08920016
089300            SET PS-EOF-FILE TO TRUE.                              08930016
089400* RMK 04/2010 - REQUEST #38216 - ADD LOC 809                      08940016
089500     IF CE010-CNTRL-STK-ID NOT = PV-PREV-CNTRL-STK-ID             08950016
089600     AND PS-FIRST-TIME-NO                                         08960016
089700        SET PS-LOC-FILE-BREAK TO TRUE                             08970016
089800        MOVE CE010-CNTRL-STK-ID TO PV-PREV-CNTRL-STK-ID           08980017
089802* CT WR39442 START                                                08980221
089810                                   HL1-OPER-UNT                   08981021
089811                                   PV-LOC-NBR                     08981126
089812        PERFORM 1050-GET-HEADING-LOC-NAME                         08981222
089813        MOVE XLT00010-LOC-NM    TO HL1-DC-STORE-NAME              08981325
089814     END-IF.                                                      08981421
089820* CT WR39442 END                                                  08982018
089900*                                                                 08990016
090000 7100-READ-CE-FILE2.                                              09000016
090100                                                                  09010016
090200     PERFORM UNTIL PS-EOF-FILE2                                   09020016
090300         READ CE-FILE2                                            09030016
090400             AT END                                               09040016
090500                SET PS-EOF-FILE2 TO TRUE                          09050016
090600         END-READ                                                 09060016
090700         IF PS-EOF-FILE2                                          09070016
090800             CONTINUE                                             09080016
090900         ELSE                                                     09090016
091000             ADD 1 TO PV-DATE-COUNT                               09100016
091100             IF PV-DATE-COUNT = +1                                09110016
091200                 MOVE CE-RECORD2 TO CE011-DATE-TIME-RECORD        09120016
091300             END-IF                                               09130016
091400         END-IF                                                   09140016
091500     END-PERFORM.                                                 09150016
091600                                                                  09160016
091700*                                                                 09170016
091800 9000-END-PROCESS.                                                09180016
091900***************************************************************** 09190016
092000*  CLOSE FILES.                                                   09200016
092100***************************************************************** 09210016
092200                                                                  09220016
092300     PERFORM 6850-PRINT-COMP-TOTAL.                               09230016
092400     PERFORM 6875-PRINT-RECAP.                                    09240016
092500                                                                  09250016
092600     WRITE CE-REPORT-RECORD                                       09260016
092700       FROM PR-PRINT-FINAL                                        09270016
092800         AFTER ADVANCING 3 LINE.                                  09280016
092900*                                                                 09290016
093000     CLOSE CE-FILE                                                09300016
093100           CE-FILE2                                               09310016
093200           CE-REPORT-FILE                                         09320016
093300           CE-RECAP-FILE.                                         09330016
093400*                                                                 09340016
093500***************************************************************** 09350016
093600*  SQL ERROR PROCESSING                                           09360016
093700***************************************************************** 09370016
093800 9999-SQL-ERROR.                                                  09380016
093900     DISPLAY '** ABEND         ** = SQLERROR'.                    09390016
094000     DISPLAY '** PROGRAM       ** = CEKRP013'.                    09400016
094100     DISPLAY '** PARAGRAPH     ** = ' PV-ABEND-PARAGRAPH.         09410016
094200     DISPLAY '** OPERATION     ** = ' PV-DB2-OPERATION-ATTEMPTED. 09420016
094300                                                                  09430016
094400                                                                  09440016
094500***************************************************************** 09450016
094600*   THIS COPYBOOK CONTAINS THE PROCEDURE DIVISION STATEMENTS      09460016
094700*   THAT ARE REQUIRED  TO UTILIZE THE DB2 ABEND MODULE 'DSNTIAR'  09470016
094800*   AND CONVERT THE SQLCA INFORMATION INTO A READABLE FORMAT.     09480016
094900***************************************************************** 09490016
095000     COPY DPPD004.                                                09500016
095100                                                                  09510016
095200     MOVE +4013 TO PV-ABEND-CODE.                                 09520016
095300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09530016
095400                                                                  09540016
