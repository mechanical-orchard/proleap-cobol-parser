000100***************************************************************** 00010062
000200 IDENTIFICATION DIVISION.                                         00020062
000300***************************************************************** 00030062
000400                                                                  00040062
000500 PROGRAM-ID.             SFKUT005.                                00050062
000600 AUTHOR.                 COGNIZANT.                               00060062
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070062
000800 DATE-WRITTEN            MARCH 2016.                              00080062
000900 DATE-COMPILED.                                                   00090062
001000                                                                  00100062
001100***************************************************************** 00110062
001200*  DESCRIPTION:                                                   00120062
001300*  THIS PROGRAM WILL FORMAT THE BUSINESS GROUP FLOOR PAD FILE TO  00130062
001400*  ASSOCIATE BUSINESS GROUP FLOORPAD FILE LAYOUT.                 00140062
001500*                                                                 00150062
001600*  INPUT:  BUSINESS GROUP FLOORPAD FILE                           00160062
001700*  OUTPUT: ASSOCIATE BUSINESS GROUP FLOORPAD FILE                 00170062
001800*                                                                 00180062
001900***************************************************************** 00190062
002000*----------------------------------------------------------------*00200062
002100* HISTORY LOG:                                                   *00210062
002200*                                                                *00220062
002300* DATE:        03/28/2016                                        *00230062
002400* WR/IR#:      CHG0146661                                        *00240064
002500* PROGRAMMER:  COGNIZANT                                         *00250062
002600* DESCRIPTION: INITIAL VERSION CREATED FOR RMS9 RETIREMENT       *00260062
002700*              PROJECT                                           *00270062
002800*                                                                *00280062
002900*----------------------------------------------------------------*00290062
003000***************************************************************** 00300062
003100 ENVIRONMENT DIVISION.                                            00310062
003200***************************************************************** 00320062
003300 CONFIGURATION SECTION.                                           00330062
003400 SOURCE-COMPUTER.        IBM-3090.                                00340062
003500 OBJECT-COMPUTER.        IBM-3090.                                00350062
003600                                                                  00360062
003700 INPUT-OUTPUT SECTION.                                            00370062
003800                                                                  00380062
003900 FILE-CONTROL.                                                    00390062
004000                                                                  00400062
004100     SELECT BUSGRP-FLRPAD-IN-FILE                                 00410062
004200         ASSIGN TO INP01.                                         00420062
004300                                                                  00430062
004400     SELECT BUSGRP-FLRPAD-OUT-FILE                                00440062
004500         ASSIGN TO OUT01.                                         00450062
004600                                                                  00460062
004700******************************************************************00470062
004800 DATA DIVISION.                                                   00480062
004900******************************************************************00490062
005000 FILE SECTION.                                                    00500062
005100                                                                  00510062
005200 FD  BUSGRP-FLRPAD-IN-FILE                                        00520062
005300     RECORDING MODE IS F                                          00530062
005400     BLOCK CONTAINS 0 RECORDS                                     00540062
005500     LABEL RECORDS ARE STANDARD                                   00550062
005600     RECORD CONTAINS 37 CHARACTERS.                               00560062
005700                                                                  00570062
005800 01  BUSGRP-FLRPAD-IN-RECORD     PIC X(37).                       00580062
005900                                                                  00590062
006000 FD  BUSGRP-FLRPAD-OUT-FILE                                       00600062
006100     RECORDING MODE IS F                                          00610062
006200     BLOCK CONTAINS 0 RECORDS                                     00620062
006300     LABEL RECORDS ARE STANDARD                                   00630062
006400     RECORD CONTAINS 80 CHARACTERS.                               00640062
006500                                                                  00650062
006600 01  BUSGRP-FLRPAD-OUT-RECORD    PIC X(80).                       00660062
006700                                                                  00670062
006800******************************************************************00680062
006900 WORKING-STORAGE SECTION.                                         00690062
007000******************************************************************00700062
007100 01  FILLER                            PIC X(50)  VALUE           00710062
007200     ' *** WORKING STORAGE STARTS HERE FOR SFKUT005 *** '.        00720062
007300                                                                  00730062
007400 01  PS-PROGRAM-SWITCHES.                                         00740062
007500     05  PS-END-OF-FILE-SW             PIC X(01)  VALUE 'N'.      00750062
007600         88  PS-NOT-END-OF-FILE                   VALUE 'N'.      00760062
007700         88  PS-END-OF-FILE                       VALUE 'Y'.      00770062
007800                                                                  00780062
007900 01  PC-CONSTANTS.                                                00790062
008000     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           00800062
008100                                                 'SFKUT005'.      00810062
008200 01  PV-PROGRAM-VARIABLES.                                        00820062
008300     05  PV-READ-COUNT                 PIC  9(09) VALUE ZEROES.   00830062
008400     05  PV-WRITE-COUNT                PIC  9(09) VALUE ZEROES.   00840062
008500                                                                  00850062
008600 01  ABEND-CODE                        PIC S9(04) VALUE +0.       00860062
008700                                                                  00870062
008800*----------------------------------------------------------       00880062
008900* RMS BUSINESS GROUP FLOOR PAD RECORD LAYOUT                      00890062
009000*----------------------------------------------------------       00900062
009100  01 PV-FLR-PAD-BUS-GRP-IN-REC.                                   00910062
009200     05 PV-IN-FP-BG-BUS-GRP-NBR         PIC 9(3)  VALUE ZEROES.   00920062
009300     05 PV-IN-FP-BG-FILLER2             PIC X(02) VALUE SPACES.   00930062
009400     05 PV-IN-FP-BG-EFF-BEG-DTE         PIC X(10) VALUE SPACES.   00940062
009500     05 PV-IN-FP-BG-FILLER3             PIC X     VALUE SPACES.   00950062
009600     05 PV-IN-FP-BG-EFF-END-DTE         PIC X(10) VALUE SPACES.   00960062
009700     05 PV-IN-FP-BG-FILLER4             PIC X     VALUE SPACES.   00970062
009800     05 PV-IN-FP-BG-FLR-PAD-ID          PIC 9(10) VALUE ZEROES.   00980062
009900                                                                  00990062
010000*----------------------------------------------------------       01000062
010100* ASSOCIATE BUSINESS GROUP FLOOR PAD RECORD LAYOUT                01010062
010200*----------------------------------------------------------       01020062
010300  01 PV-FLR-PAD-BUS-GRP-OUT-REC.                                  01030062
010400     05 PV-OUT-FP-BG-FILLER1            PIC X     VALUE SPACES.   01040062
010500     05 PV-OUT-FP-BG-BUS-GRP-NBR        PIC 9(3)  VALUE ZEROES.   01050062
010600     05 PV-OUT-FP-BG-FILLER2            PIC X     VALUE SPACES.   01060062
010700     05 PV-OUT-FP-BG-EFF-BEG-DTE        PIC X(10) VALUE SPACES.   01070062
010800     05 PV-OUT-FP-BG-FILLER3            PIC X     VALUE SPACES.   01080062
010900     05 PV-OUT-FP-BG-EFF-END-DTE        PIC X(10) VALUE SPACES.   01090062
011000     05 PV-OUT-FP-BG-FILLER4            PIC X(02) VALUE SPACES.   01100062
011100     05 PV-OUT-FP-BG-FLR-PAD-ID         PIC 9(10) VALUE ZEROES.   01110062
011200     05 PV-OUT-FP-BG-FILLER5            PIC X(42) VALUE SPACES.   01120062
011300                                                                  01130062
011400 PROCEDURE DIVISION.                                              01140062
011500                                                                  01150062
011600 0000-MAINLINE-PARA.                                              01160062
011700                                                                  01170062
011800     PERFORM 1000-INITIALIZE.                                     01180062
011900                                                                  01190062
012000     PERFORM 2000-PROCESS-RECORDS                                 01200062
012100           UNTIL PS-END-OF-FILE.                                  01210062
012200                                                                  01220062
012300     PERFORM 9000-EOJ-ROUTINE.                                    01230062
012400                                                                  01240062
012500     STOP RUN.                                                    01250062
012600                                                                  01260062
012700******************************************************************01270062
012800* 1000-INITIALIZE                                                 01280062
012900*     INITIALIZE THE VARIABLES, OPEN THE INPUT AND OUTPUT FILES   01290062
013000*     AND READ THE INPUT FILE                                     01300062
013100******************************************************************01310062
013200 1000-INITIALIZE.                                                 01320062
013300                                                                  01330062
013400     DISPLAY 'PROGRAM - ' PC-PROGRAM-NAME.                        01340062
013500     INITIALIZE PV-PROGRAM-VARIABLES                              01350062
013600                PV-FLR-PAD-BUS-GRP-IN-REC                         01360062
013700                PV-FLR-PAD-BUS-GRP-OUT-REC.                       01370062
013800                                                                  01380062
013900     OPEN INPUT  BUSGRP-FLRPAD-IN-FILE                            01390062
014000          OUTPUT BUSGRP-FLRPAD-OUT-FILE.                          01400062
014100                                                                  01410062
014200     PERFORM 2100-READ-INPUT-FILE.                                01420062
014300                                                                  01430062
014400******************************************************************01440062
014500* 2000-PROCESS-RECORDS                                            01450062
014600* FORMATS THE ASSOCIATE BUSINESS GROUP FLOORPAD FILE              01460062
014700******************************************************************01470062
014800 2000-PROCESS-RECORDS.                                            01480062
014900                                                                  01490062
015000     MOVE PV-IN-FP-BG-BUS-GRP-NBR    TO PV-OUT-FP-BG-BUS-GRP-NBR. 01500062
015100     MOVE PV-IN-FP-BG-EFF-BEG-DTE    TO PV-OUT-FP-BG-EFF-BEG-DTE. 01510062
015200                                                                  01520062
015300     IF PV-IN-FP-BG-EFF-END-DTE = SPACES                          01530062
015400        MOVE '~~~~~~~~~~'            TO PV-OUT-FP-BG-EFF-END-DTE  01540062
015500     ELSE                                                         01550062
015600        MOVE PV-IN-FP-BG-EFF-END-DTE TO PV-OUT-FP-BG-EFF-END-DTE  01560062
015700     END-IF.                                                      01570062
015800                                                                  01580062
015900     MOVE PV-IN-FP-BG-FLR-PAD-ID     TO PV-OUT-FP-BG-FLR-PAD-ID.  01590062
016000                                                                  01600062
016100     PERFORM 3000-WRITE-OUTPUT-FILE.                              01610062
016200     PERFORM 2100-READ-INPUT-FILE.                                01620062
016300                                                                  01630062
016400******************************************************************01640062
016500* 2100-READ-INPUT-FILE                                            01650062
016600*      READ THE RECORDS IN BUSINESS GROUP FLOORPAD FILE           01660062
016700******************************************************************01670062
016800 2100-READ-INPUT-FILE.                                            01680062
016900                                                                  01690062
017000     READ BUSGRP-FLRPAD-IN-FILE INTO PV-FLR-PAD-BUS-GRP-IN-REC    01700062
017100        AT END                                                    01710062
017200           SET PS-END-OF-FILE TO TRUE                             01720062
017300        NOT AT END                                                01730062
017400           ADD 1               TO PV-READ-COUNT                   01740062
017500     END-READ.                                                    01750062
017600                                                                  01760062
017700******************************************************************01770062
017800* 3000-WRITE-OUTPUT-FILE                                          01780062
017900*      WRITE THE RECORDS TO ASSOCIATE BUSINESS GROUP FLOORPAD     01790062
018000*      OUTPUT FILE                                                01800062
018100******************************************************************01810062
018200 3000-WRITE-OUTPUT-FILE.                                          01820062
018300                                                                  01830062
018400     WRITE BUSGRP-FLRPAD-OUT-RECORD FROM                          01840062
018500                                    PV-FLR-PAD-BUS-GRP-OUT-REC.   01850062
018600     ADD 1                    TO PV-WRITE-COUNT.                  01860062
018700                                                                  01870062
018800******************************************************************01880062
018900* 9000-EOJ-ROUTINE                                                01890062
019000*      CLOSE THE INPUT AND OUTPUT FILES, DISPLAY THE MESSAGES     01900062
019100*      AND TERMINATE THE PROCESS.                                 01910062
019200******************************************************************01920062
019300 9000-EOJ-ROUTINE.                                                01930062
019400                                                                  01940062
019500     CLOSE BUSGRP-FLRPAD-IN-FILE                                  01950062
019600           BUSGRP-FLRPAD-OUT-FILE.                                01960062
019700                                                                  01970062
019800     IF PV-READ-COUNT = 0                                         01980062
019900        DISPLAY 'INPUT BUSINESS GROUP FLOORPAD FILE IS EMPTY'     01990062
020000     END-IF.                                                      02000062
020100                                                                  02010062
020200     DISPLAY 'BUSINESS GROUP FLOORPAD READ    : ' PV-READ-COUNT.  02020062
020300     DISPLAY 'BUSINESS GROUP FLOORPAD WRITTEN : ' PV-WRITE-COUNT. 02030062
020400                                                                  02040062
