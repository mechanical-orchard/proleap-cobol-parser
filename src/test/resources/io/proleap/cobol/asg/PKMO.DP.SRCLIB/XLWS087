000100****************************************************************  00010000
000200* XLWS087    COMMAREA FOR UPC VALIDATION MODULE   LRECL =  600 *  00020000
000300****************************************************************  00030000
000400* XLWS087:                                                        00040000
000500*                                                                 00050000
000600*  THIS CONTAINS THE PARAMETER LIST NEEDED TO CALL THE            00060000
000700*  KOHL'S UPC VALIDATION ROUTINE, XLKUT087.                       00070000
000800*                                                                 00080000
000900*  IN CICS DO THIS:                                               00090000
001000*      CALL XL087-LOCATION-MODULE USING DFHEIBLK                  00100000
001100*                                       XL087-COMMAREA            00110000
001200*                                       XL087-RECORD              00120000
001300*                                                                 00130000
001400*  IN BATCH DO THIS:                                              00140000
001500*      CALL XL087-LOCATION-MODULE USING XL087-RECORD              00150000
001600****************************************************************  00160000
001800******************************************************************00180000
001900*  THIS MEMBER IS THE COMMUNICATION AREA USED WITH THE UPC       *00190000
002000*  VALIDATION MODULE - XLKUT087 (BATCH AND CICS)                 *00200000
002100******************************************************************00210000
002200 01  XL087-RECORD.                                                00220000
002300     05  XL087-REQUIRED-DATA.                                     00230000
002400         10  XL087-UPC                       PIC  X(18).          00240000
002500*                                                                 00250000
003300         10  XL087-CALLING-PROGRAM           PIC  X(08).          00330000
003400*                                                                 00340000
003500     05  XL087-RETURN-CODE-DATA.                                  00350000
003600         10  XL087-RETURN-CODE               PIC  X(02).          00360000
003700             88  XL087-CALL-SUCCESSFUL                 VALUE '00'.00370000
003800             88  XL087-BAD-CHECK-DIGIT                 VALUE '01'.00380000
003900             88  XL087-NOT-FOUND                       VALUE '02'.00390000
004000             88  XL087-NOT-NUMERIC                     VALUE '03'.00400000
004100             88  XL087-INVALID-UPC-FORMAT              VALUE '04'.00410000
004200             88  XL087-DATABASE-CONTENTION             VALUE '05'.00420000
004300             88  XL087-DB2-ERROR                       VALUE '06'.00430000
004400         10  XL087-SQLCODE                   PIC  ZZZZZZZZ9-.     00440000
004500         10  XL087-PARAGRAPH                 PIC  X(20).          00450000
004600         10  XL087-DATABASE                  PIC  X(20).          00460000
004700         10  XL087-RETURN-MESSAGE            PIC  X(100).         00470000
004800         10  XL087-SQLCA                     PIC  X(100).         00480000
004900*                                                                 00490000
005000     05  XL087-RETURN-INFORMATION.                                00500000
005100*                                                                 00510000
005200         10  XL087-BARCODE-TYPE              PIC  X(01).          00520000
005300             88  XL087-GTIN-15-TYPE                    VALUE '1'. 00530009
005310             88  XL087-GTIN-14-TYPE                    VALUE '2'. 00531009
005400             88  XL087-EAN-13-TYPE                     VALUE '3'. 00540009
005500             88  XL087-UPC-12-TYPE                     VALUE '4'. 00550009
005600             88  XL087-UPC-E-6-TYPE                    VALUE '5'. 00560009
005700*                                                                 00570000
005800         10  XL087-EXPANDED-UPC-A            PIC  X(12).          00580000
005900*                                                                 00590000
006000         10  XL087-RETURN-UPC                PIC  9(14).          00600000
006100         10  XL087-UPC-X.                                         00610000
006200             15  XL087-UPC-NUM               PIC  9(18).          00620000
006300         10  XL087-RETURN-UPC-15 REDEFINES XL087-UPC-X.           00630007
006400             15  XL087-UPC-15-DIGIT-NBR      PIC  9(15).          00640007
006500             15  XL087-STRIP-3-DIGIT         PIC  X(03).          00650007
006510         10  XL087-RETURN-UPC-14 REDEFINES XL087-UPC-X.           00651007
006520             15  XL087-UPC-14-DIGIT-NBR      PIC  9(14).          00652007
006530             15  XL087-STRIP-4-DIGIT         PIC  X(04).          00653007
006600         10  XL087-RETURN-UPC-13 REDEFINES XL087-UPC-X.           00660000
006700             15  XL087-UPC-13-DIGIT-NBR      PIC  9(13).          00670002
006800             15  XL087-STRIP-5-DIGIT         PIC  X(05).          00680000
006900         10  XL087-RETURN-UPC-12 REDEFINES XL087-UPC-X.           00690000
007000             15  XL087-UPC-12-DIGIT-NBR      PIC  9(12).          00700002
007100             15  XL087-STRIP-6-DIGIT         PIC  X(06).          00710000
007200*                                                                 00720000
007300         10  XL087-WORKING-UPC               PIC  X(18).          00730000
007400         10  XL087-UPC-REDEF-14 REDEFINES XL087-WORKING-UPC.      00740000
007500             15  FILLER                      PIC  X(04).          00750000
007600             15  XL087-UPC-14                PIC  9(14).          00760000
007700         10  XL087-UPC-REDEF-13 REDEFINES XL087-WORKING-UPC.      00770000
007800             15  FILLER                      PIC  X(05).          00780000
007900             15  XL087-UPC-13                PIC  9(13).          00790000
008000         10  XL087-UPC-REDEF-12 REDEFINES XL087-WORKING-UPC.      00800000
008100             15  FILLER                      PIC  X(06).          00810000
008200             15  XL087-UPC-12                PIC  9(12).          00820000
008300*                                                                 00830000
008400         10  XL087-15-DIGIT-UPC              PIC  X(15).          00840008
008500         10  XL087-15-UPC-SW                 PIC  X(01).          00850008
008600             88  XL087-15-VALID-UPC-YES                VALUE 'Y'. 00860008
008700             88  XL087-15-VALID-UPC-NO                 VALUE 'N'. 00870008
008800         10  XL087-UPC-15-STRIP-DIGITS       PIC  X(03).          00880008
008900         10  XL087-15-CHECK-DIGIT            PIC  X(01).          00890008
009000         10  XL087-15-VALID-CK-DIGIT-SW      PIC  X(01).          00900008
009100             88  XL087-15-VALID-CK-DIGIT-YES           VALUE 'Y'. 00910008
009200             88  XL087-15-VALID-CK-DIGIT-NO            VALUE 'N'. 00920008
009210*                                                                 00921008
009220         10  XL087-14-DIGIT-UPC              PIC  X(14).          00922008
009230         10  XL087-14-UPC-SW                 PIC  X(01).          00923008
009240             88  XL087-14-VALID-UPC-YES                VALUE 'Y'. 00924008
009250             88  XL087-14-VALID-UPC-NO                 VALUE 'N'. 00925008
009260         10  XL087-UPC-14-STRIP-DIGITS       PIC  X(04).          00926008
009270         10  XL087-14-CHECK-DIGIT            PIC  X(01).          00927008
009280         10  XL087-14-VALID-CK-DIGIT-SW      PIC  X(01).          00928008
009290             88  XL087-14-VALID-CK-DIGIT-YES           VALUE 'Y'. 00929008
009291             88  XL087-14-VALID-CK-DIGIT-NO            VALUE 'N'. 00929108
009300*                                                                 00930000
009400         10  XL087-13-DIGIT-UPC              PIC  X(13).          00940000
009500         10  XL087-13-UPC-SW                 PIC  X(01).          00950000
009600             88  XL087-13-VALID-UPC-YES                VALUE 'Y'. 00960000
009700             88  XL087-13-VALID-UPC-NO                 VALUE 'N'. 00970000
009800         10  XL087-UPC-13-STRIP-DIGITS       PIC  X(05).          00980000
009900         10  XL087-13-CHECK-DIGIT            PIC  X(01).          00990000
010000         10  XL087-13-VALID-CK-DIGIT-SW      PIC  X(01).          01000000
010100             88  XL087-13-VALID-CK-DIGIT-YES           VALUE 'Y'. 01010000
010200             88  XL087-13-VALID-CK-DIGIT-NO            VALUE 'N'. 01020000
010300*                                                                 01030000
010400         10  XL087-12-DIGIT-UPC              PIC  X(12).          01040000
010500         10  XL087-12-UPC-SW                 PIC  X(01).          01050000
010600             88  XL087-12-VALID-UPC-YES                VALUE 'Y'. 01060000
010700             88  XL087-12-VALID-UPC-NO                 VALUE 'N'. 01070000
010800         10  XL087-UPC-12-STRIP-DIGITS       PIC  X(06).          01080000
010900         10  XL087-12-CHECK-DIGIT            PIC  X(01).          01090000
011000         10  XL087-12-VALID-CK-DIGIT-SW      PIC  X(01).          01100000
011100             88  XL087-12-VALID-CK-DIGIT-YES           VALUE 'Y'. 01110000
011200             88  XL087-12-VALID-CK-DIGIT-NO            VALUE 'N'. 01120000
011300*                                                                 01130000
011400     05  XL087-SUB                           PIC S9(4) COMP       01140000
011500                                                       VALUE ZERO.01150000
011600     05  XL087-UPC-CHECKER                   PIC  X(18).          01160000
011700* VALID PATTERNS                                                  01170000
011800         88  XL087-VALID-UPC-FORMAT VALUES  '999999999999999999'  01180000
011900                                            '99999999999999999B'  01190000
012000                                            '9999999999999999BB'  01200000
012100                                            '999999999999999BBB'  01210000
012200                                            '99999999999999BBBB'  01220000
012300                                            '9999999999999BBBBB'  01230000
012310                                            '999999999999BBBBBB'  01231006
012400                                            '9999999BBBBBBBBBBB'  01240000
012500                                            '999999BBBBBBBBBBBB'. 01250000
012600         88  XL087-UPC-18-DIGIT     VALUE   '999999999999999999'. 01260000
012700         88  XL087-UPC-17-DIGIT     VALUE   '99999999999999999B'. 01270000
012800         88  XL087-UPC-16-DIGIT     VALUE   '9999999999999999BB'. 01280000
012900         88  XL087-UPC-15-DIGIT     VALUE   '999999999999999BBB'. 01290000
013000         88  XL087-UPC-14-DIGIT     VALUE   '99999999999999BBBB'. 01300000
013100         88  XL087-UPC-13-DIGIT     VALUE   '9999999999999BBBBB'. 01310000
013200         88  XL087-UPC-12-DIGIT     VALUE   '999999999999BBBBBB'. 01320000
013210         88  XL087-UPC-07-DIGIT     VALUE   '9999999BBBBBBBBBBB'. 01321000
013220         88  XL087-UPC-06-DIGIT     VALUE   '999999BBBBBBBBBBBB'. 01322000
013221     05  XL087-UPC-EDIT-MASK REDEFINES XL087-UPC-CHECKER.         01322100
013222         10  XL087-UPC-CHAR           PIC  X(01)                  01322201
013223                                                  OCCURS 18 TIMES.01322300
013224                                                                  01322400
013225*                                                                 01322500
013226     05  FILLER                              PIC  X(176).         01322603
013230 01  XL087-COMMAREA                   PIC X(01).                  01323000
013240 01  XL087-LOCATION-MODULE            PIC X(08) VALUE 'XLKUT087'. 01324000
