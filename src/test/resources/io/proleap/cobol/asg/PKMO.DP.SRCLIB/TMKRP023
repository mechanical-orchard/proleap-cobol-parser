000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TMKRP023.                                00050099
000600 AUTHOR.                 TKMA497.                                 00060099
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MARCH 2004.                              00080099
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM EXTRACTS "TROUBLE" INFORMATION FROM TROUBLE       *00120099
001300* TABLES AND COUNTS UP AND REPORTS TOTALS OF 804, 805 AND 806    *00130099
    00* TROUBLES BY MONTH.                                             *00140099
001400*----------------------------------------------------------------*00150099
001500                                                                  00160000
001600******************************************************************00170000
001700 ENVIRONMENT DIVISION.                                            00180000
001800******************************************************************00190000
001900                                                                  00200000
002000 CONFIGURATION SECTION.                                           00210000
002100                                                                  00220000
002200 SOURCE-COMPUTER.        IBM-3090.                                00230000
002300 OBJECT-COMPUTER.        IBM-3090.                                00240000
002400                                                                  00250000
002500 INPUT-OUTPUT SECTION.                                            00260000
002600                                                                  00270000
002700 FILE-CONTROL.                                                    00280000
002800                                                                  00290000
002000     SELECT FFA-REPORT-FILE           ASSIGN TO RPT01.            00300099
002100                                                                  00310099
002300 DATA DIVISION.                                                   00320099
003400                                                                  00330099
002500 FILE SECTION.                                                    00340099
003300 FD  FFA-REPORT-FILE                                              00350099
003400     RECORDING MODE IS F                                          00360099
003500     LABEL RECORDS ARE STANDARD                                   00370099
003600     BLOCK CONTAINS 0 RECORDS.                                    00380099
003700                                                                  00390099
003800 01  FFA-REPORT-RECORD          PIC X(132).                       00400099
004400*------------------------------------------------------*          00410099
004500 WORKING-STORAGE SECTION.                                         00420099
004600*------------------------------------------------------*          00430099
004700 01 PC-PROGRAM-CONSTANTS.                                         00440099
004800    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'TMKRP023'.  00450099
          05 PC-VENDOR-SUMMARY             PIC X(46) VALUE              00460099
020600              'CORP VENDOR SUMMARY - ALL VENDORS FOR ALL DC''S'.  00470099
          05 PC-DC-SUMMARY                 PIC X(46) VALUE              00480099
020600               'CORP DC SUMMARY - BY DC FOR ALL VENDORS       '.  00490099
026700    05 PC-NO-DATA-LINE.                                           00500099
026800       10  FILLER                    PIC X(02)  VALUE SPACE.      00510099
026900       10  FILLER                    PIC X(23)  VALUE             00520099
027000                                     '** NO DATA TO REPORT **'.   00530099
027100       10  FILLER                    PIC X(108) VALUE SPACE.      00540099
027300    05 PC-END-REPORT-LINE.                                        00550099
027400       10  FILLER                    PIC X(02)  VALUE SPACE.      00560099
027500       10  FILLER                    PIC X(16)  VALUE             00570099
027600                                     '** END REPORT **'.          00580099
027700       10  FILLER                    PIC X(116) VALUE SPACE.      00590099
026500    05 PC-BLANK-LINE                 PIC X(132) VALUE SPACES.     00600099
006300    05 PC-MAX-REPORT-LINES           PIC S9(04) VALUE +60         00610099
006400                                                COMP SYNC.        00620099
004900    05 PC-DEFAULT-CC-DATE            PIC X(10) VALUE '9999-09-09'.00630099
005000    05 PC-DEFAULT-DATE-TIME          PIC X(14) VALUE              00640099
005100                                                 '99990909090909'.00650099
005200    05 PC-DEFAULT-TIMESTAMP          PIC X(26) VALUE              00660099
005300                                     '9999-09-09-09.09.09.999999'.00670099
006700    05  PC-SPECIAL-RUN-NOTE          PIC X(27)     VALUE          00680099
006800                                    '** SPECIAL REQUESTED RUN **'.00690099
005400    05 PC-ZERO                       PIC 9(01) VALUE 0.           00700099
005500    05 PC-ONE                        PIC 9(01) VALUE 1.           00710099
005700    05 PC-SEVEN                      PIC 9(02) VALUE 7.           00720099
005800    05 PC-TWENTY-EIGHT               PIC 9(02) VALUE 28.          00730099
006500    05 PC-A                          PIC X(01) VALUE 'A'.         00740099
006700    05 PC-3ZEROS                     PIC X(03) VALUE '000'.       00750005
007400 01 DK-DATABASE-KEYS.                                             00760099
007500    05 DK-START-EXTRACT              PIC X(26) VALUE SPACE.       00770099
007600    05 DK-END-EXTRACT                PIC X(26) VALUE SPACE.       00780099
007700                                                                  00790099
007800 01 PV-PROGRAM-VARIABLES.                                         00800099
007900    05 PV-ABEND-CODE                 PIC  9(04) VALUE 0.          00810099
012600    05  PV-LINE-COUNT                PIC S9(04)    VALUE +80      00820099
012700                                                   COMP.          00830099
012600    05  PV-LINE-ADVANCE              PIC S9(04)    VALUE +1       00840099
012700                                                   COMP.          00850099
012800    05  PV-PAGE-NUMBER               PIC  S9(04)   VALUE ZERO     00860099
012900                                                   COMP.          00870099
008100    05 PV-CURRENT-DB2-DATE           PIC  X(10).                  00880099
008600    05 PV-CURR-DATE.                                              00890099
008700       10 PV-CURRENT-DB2-CCYY.                                    00900099
008800          15 PV-CURRENT-DB2-CC       PIC  9(02)    VALUE 0.       00910099
008900          15 PV-CURRENT-DB2-YY       PIC  9(02)    VALUE 0.       00920099
009000       10 FILLER                     PIC  X(01)    VALUE '-'.     00930099
009100       10 PV-CURRENT-DB2-MM          PIC  9(02)    VALUE 0.       00940099
009200       10 FILLER                     PIC  X(01)    VALUE '-'.     00950099
009300       10 PV-CURRENT-DB2-DD          PIC  9(02)    VALUE 0.       00960099
009400    05 PV-CURRENT-DATE.                                           00970000
009500       10 PV-CURRENT-CCYY.                                        00980099
009600          15 PV-CURRENT-CC           PIC  9(02)    VALUE 0.       00990099
009700          15 PV-CURRENT-YY           PIC  9(02)    VALUE 0.       01000099
009800       10 PV-CURRENT-MM              PIC  9(02)    VALUE 0.       01010099
009900       10 PV-CURRENT-DD              PIC  9(02)    VALUE 0.       01020099
013400    05  PV-CURRENT-TIME              PIC X(08)     VALUE SPACE.   01030099
009800    05  PV-CURRENT-TIME-RDF REDEFINES PV-CURRENT-TIME.            01040099
009900       10 PV-CURRENT-HOUR            PIC 9(02).                   01050099
010000       10 FILLER                     PIC X(01).                   01060099
010100       10 PV-CURRENT-MINUTE          PIC 9(02).                   01070099
010200       10 FILLER                     PIC X(01).                   01080099
010300       10 PV-CURRENT-SECOND          PIC 9(02).                   01090099
010400    05 PV-PARA-NAME                  PIC  X(30)    VALUE SPACE.   01100099
010800    05 PV-BEG-DATE.                                               01110099
010900       10 PV-BEG-YYYY.                                            01120099
011000          15 PV-BEG-CC               PIC  9(02)    VALUE 0.       01130099
011100          15 PV-BEG-YY               PIC  9(02)    VALUE 0.       01140099
011200       10 PV-BEG-MM                  PIC  9(02)    VALUE 0.       01150099
011300       10 PV-BEG-DD                  PIC  9(02)    VALUE 0.       01160099
011400    05 PV-END-DATE.                                               01170099
011500       10 PV-END-YYYY.                                            01180099
011600          15 PV-END-CC               PIC  9(02)    VALUE 0.       01190099
011700          15 PV-END-YY               PIC  9(02)    VALUE 0.       01200099
011800       10 PV-END-MM                  PIC  9(02)    VALUE 0.       01210099
011900       10 PV-END-DD                  PIC  9(02)    VALUE 0.       01220099
012400    05 PV-DATE-AREA.                                              01230099
012500       10 PV-DATE-AREA-MM            PIC  9(02)    VALUE 0.       01240099
012600       10 PV-DATE-AREA-DD            PIC  9(02)    VALUE 0.       01250099
012700       10 PV-DATE-AREA-CC            PIC  9(02)    VALUE 0.       01260099
012800       10 PV-DATE-AREA-YY            PIC  9(02)    VALUE 0.       01270099
015200    05 PV-START-EXTRACT              PIC X(10)     VALUE SPACE.   01280099
015300    05 FILLER  REDEFINES PV-START-EXTRACT.                        01290099
015400       10 PV-START-EXTRACT-YYYY      PIC 9999.                    01300099
015500       10 PV-START-EXTRACT-1ST       PIC X.                       01310099
015600       10 PV-START-EXTRACT-MM        PIC 99.                      01320099
015700       10 PV-START-EXTRACT-2ND       PIC X.                       01330099
015800       10 PV-START-EXTRACT-DD        PIC 99.                      01340099
015900    05 PV-END-EXTRACT                PIC X(10)     VALUE SPACE.   01350016
016000    05 FILLER  REDEFINES PV-END-EXTRACT.                          01360099
016100       10 PV-END-EXTRACT-YYYY        PIC 9999.                    01370099
016200       10 PV-END-EXTRACT-1ST         PIC X.                       01380099
016300       10 PV-END-EXTRACT-MM          PIC 99.                      01390099
016400       10 PV-END-EXTRACT-2ND         PIC X.                       01400099
016500       10 PV-END-EXTRACT-DD          PIC 99.                      01410099
015900    05 PV-NOTIF-DATE                 PIC X(10)     VALUE SPACE.   01420099
016000    05 FILLER  REDEFINES PV-NOTIF-DATE.                           01430099
016100       10 FILLER                     PIC X(05).                   01440099
016300       10 PV-NOTIF-MM                PIC 99.                      01450099
016400       10 FILLLER                    PIC X(03).                   01460099
016600    05 PV-ABEND-PARA-NAME            PIC X(30)     VALUE SPACE.   01470000
016700    05 PV-DB2-OPERATION-MSG-1        PIC X(40)     VALUE SPACE.   01480099
016800    05 PV-DB2-OPERATION-MSG-2        PIC X(40)     VALUE SPACE.   01490099
016900    05 PV-DB2-TABLE-1                PIC X(20)     VALUE SPACE.   01500099
016900    05 PV-DB2-TABLE-2                PIC X(20)     VALUE SPACE.   01510099
017000    05 PV-SQLCODE                    PIC Z(8)9-.                  01520099
017100    05 PV-PARAGRAPH-NAME             PIC X(30)     VALUE SPACE.   01530099
          05 PV-804-JANUARY                PIC S9(5)     VALUE ZERO     01540099
                                                         COMP-3.        01550099
          05 PV-804-FEBRUARY               PIC S9(5)     VALUE ZERO     01560099
                                                         COMP-3.        01570099
          05 PV-804-MARCH                  PIC S9(5)     VALUE ZERO     01580099
                                                         COMP-3.        01590099
          05 PV-804-APRIL                  PIC S9(5)     VALUE ZERO     01600099
                                                         COMP-3.        01610099
          05 PV-804-MAY                    PIC S9(5)     VALUE ZERO     01620099
                                                         COMP-3.        01630099
          05 PV-804-JUNE                   PIC S9(5)     VALUE ZERO     01640099
                                                         COMP-3.        01650099
          05 PV-804-JULY                   PIC S9(5)     VALUE ZERO     01660099
                                                         COMP-3.        01670099
          05 PV-804-AUGUST                 PIC S9(5)     VALUE ZERO     01680099
                                                         COMP-3.        01690099
          05 PV-804-SEPTEMBER              PIC S9(5)     VALUE ZERO     01700099
                                                         COMP-3.        01710099
          05 PV-804-OCTOBER                PIC S9(5)     VALUE ZERO     01720099
                                                         COMP-3.        01730099
          05 PV-804-NOVEMBER               PIC S9(5)     VALUE ZERO     01740099
                                                         COMP-3.        01750099
          05 PV-804-DECEMBER               PIC S9(5)     VALUE ZERO     01760099
                                                         COMP-3.        01770099
          05 PV-804-YTD                    PIC S9(7)     VALUE ZERO     01780099
                                                         COMP-3.        01790099
          05 PV-805-JANUARY                PIC S9(5)     VALUE ZERO     01800099
                                                         COMP-3.        01810099
          05 PV-805-FEBRUARY               PIC S9(5)     VALUE ZERO     01820099
                                                         COMP-3.        01830099
          05 PV-805-MARCH                  PIC S9(5)     VALUE ZERO     01840099
                                                         COMP-3.        01850099
          05 PV-805-APRIL                  PIC S9(5)     VALUE ZERO     01860099
                                                         COMP-3.        01870099
          05 PV-805-MAY                    PIC S9(5)     VALUE ZERO     01880099
                                                         COMP-3.        01890099
          05 PV-805-JUNE                   PIC S9(5)     VALUE ZERO     01900099
                                                         COMP-3.        01910099
          05 PV-805-JULY                   PIC S9(5)     VALUE ZERO     01920099
                                                         COMP-3.        01930099
          05 PV-805-AUGUST                 PIC S9(5)     VALUE ZERO     01940099
                                                         COMP-3.        01950099
          05 PV-805-SEPTEMBER              PIC S9(5)     VALUE ZERO     01960099
                                                         COMP-3.        01970099
          05 PV-805-OCTOBER                PIC S9(5)     VALUE ZERO     01980099
                                                         COMP-3.        01990099
          05 PV-805-NOVEMBER               PIC S9(5)     VALUE ZERO     02000099
                                                         COMP-3.        02010099
          05 PV-805-DECEMBER               PIC S9(5)     VALUE ZERO     02020099
                                                         COMP-3.        02030099
          05 PV-805-YTD                    PIC S9(7)     VALUE ZERO     02040099
                                                         COMP-3.        02050099
          05 PV-806-JANUARY                PIC S9(5)     VALUE ZERO     02060099
                                                         COMP-3.        02070099
          05 PV-806-FEBRUARY               PIC S9(5)     VALUE ZERO     02080099
                                                         COMP-3.        02090099
          05 PV-806-MARCH                  PIC S9(5)     VALUE ZERO     02100099
                                                         COMP-3.        02110099
          05 PV-806-APRIL                  PIC S9(5)     VALUE ZERO     02120099
                                                         COMP-3.        02130099
          05 PV-806-MAY                    PIC S9(5)     VALUE ZERO     02140099
                                                         COMP-3.        02150099
          05 PV-806-JUNE                   PIC S9(5)     VALUE ZERO     02160099
                                                         COMP-3.        02170099
          05 PV-806-JULY                   PIC S9(5)     VALUE ZERO     02180099
                                                         COMP-3.        02190099
          05 PV-806-AUGUST                 PIC S9(5)     VALUE ZERO     02200099
                                                         COMP-3.        02210099
          05 PV-806-SEPTEMBER              PIC S9(5)     VALUE ZERO     02220099
                                                         COMP-3.        02230099
          05 PV-806-OCTOBER                PIC S9(5)     VALUE ZERO     02240099
                                                         COMP-3.        02250099
          05 PV-806-NOVEMBER               PIC S9(5)     VALUE ZERO     02260099
                                                         COMP-3.        02270099
          05 PV-806-DECEMBER               PIC S9(5)     VALUE ZERO     02280099
                                                         COMP-3.        02290099
          05 PV-806-YTD                    PIC S9(7)     VALUE ZERO     02300099
                                                         COMP-3.        02310099
          05 PV-SUBTOT-JANUARY             PIC S9(5)     VALUE ZERO     02320099
                                                         COMP-3.        02330099
          05 PV-SUBTOT-FEBRUARY            PIC S9(5)     VALUE ZERO     02340099
                                                         COMP-3.        02350099
          05 PV-SUBTOT-MARCH               PIC S9(5)     VALUE ZERO     02360099
                                                         COMP-3.        02370099
          05 PV-SUBTOT-APRIL               PIC S9(5)     VALUE ZERO     02380099
                                                         COMP-3.        02390099
          05 PV-SUBTOT-MAY                 PIC S9(5)     VALUE ZERO     02400099
                                                         COMP-3.        02410099
          05 PV-SUBTOT-JUNE                PIC S9(5)     VALUE ZERO     02420099
                                                         COMP-3.        02430099
          05 PV-SUBTOT-JULY                PIC S9(5)     VALUE ZERO     02440099
                                                         COMP-3.        02450099
          05 PV-SUBTOT-AUGUST              PIC S9(5)     VALUE ZERO     02460099
                                                         COMP-3.        02470099
          05 PV-SUBTOT-SEPTEMBER            PIC S9(5)     VALUE ZERO    02480099
                                                         COMP-3.        02490099
          05 PV-SUBTOT-OCTOBER             PIC S9(5)     VALUE ZERO     02500099
                                                         COMP-3.        02510099
          05 PV-SUBTOT-NOVEMBER            PIC S9(5)     VALUE ZERO     02520099
                                                         COMP-3.        02530099
          05 PV-SUBTOT-DECEMBER            PIC S9(5)     VALUE ZERO     02540099
                                                         COMP-3.        02550099
          05 PV-SUBTOT-YTD                 PIC S9(7)     VALUE ZERO     02560099
                                                         COMP-3.        02570099
          05 PV-FINTOT-JANUARY             PIC S9(5)     VALUE ZERO     02580099
                                                         COMP-3.        02590099
          05 PV-FINTOT-FEBRUARY            PIC S9(5)     VALUE ZERO     02600099
                                                         COMP-3.        02610099
          05 PV-FINTOT-MARCH               PIC S9(5)     VALUE ZERO     02620099
                                                         COMP-3.        02630099
          05 PV-FINTOT-APRIL               PIC S9(5)     VALUE ZERO     02640099
                                                         COMP-3.        02650099
          05 PV-FINTOT-MAY                 PIC S9(5)     VALUE ZERO     02660099
                                                         COMP-3.        02670099
          05 PV-FINTOT-JUNE                PIC S9(5)     VALUE ZERO     02680099
                                                         COMP-3.        02690099
          05 PV-FINTOT-JULY                PIC S9(5)     VALUE ZERO     02700099
                                                         COMP-3.        02710099
          05 PV-FINTOT-AUGUST              PIC S9(5)     VALUE ZERO     02720099
                                                         COMP-3.        02730099
          05 PV-FINTOT-SEPTEMBER           PIC S9(5)     VALUE ZERO     02740099
                                                         COMP-3.        02750099
          05 PV-FINTOT-OCTOBER             PIC S9(5)     VALUE ZERO     02760099
                                                         COMP-3.        02770099
          05 PV-FINTOT-NOVEMBER            PIC S9(5)     VALUE ZERO     02780099
                                                         COMP-3.        02790099
          05 PV-FINTOT-DECEMBER            PIC S9(5)     VALUE ZERO     02800099
                                                         COMP-3.        02810099
          05 PV-FINTOT-YTD                 PIC S9(7)     VALUE ZERO     02820099
                                                         COMP-3.        02830099
          05 PV-HOLD-DC                    PIC X(40)     VALUE SPACE.   02840099
          05 PV-HOLD-VENDOR-NAME           PIC X(40)     VALUE SPACE.   02850099
          05 PV-HOLD-TRBL-DESC             PIC X(10)     VALUE SPACE.   02860099
          05 PV-HOLD-OPER-UNT-ID           PIC S9(4)     VALUE ZERO     02870099
                                                         COMP.          02880099
          05 PV-HOLD-TRBL-RSN-CDE          PIC S9(4)     VALUE ZERO     02890099
                                                         COMP.          02900099
020300 01 PS-PROGRAM-SWITCHES.                                          02910000
020400    05 PS-FIRST-TIME-SW              PIC X(01)     VALUE SPACE.   02920099
020500       88 PS-FIRST-TIME              VALUE 'Y'.                   02930099
020400    05 PS-NEW-VENDOR-SW              PIC X(01)     VALUE SPACE.   02940099
020500       88 PS-NEW-VENDOR              VALUE 'Y'.                   02950099
020400    05 PS-NEW-DC-SW                  PIC X(01)     VALUE SPACE.   02960099
020500       88 PS-NEW-DC                  VALUE 'Y'.                   02970099
020400    05 PS-END-OF-DATA-SW             PIC X(01)     VALUE SPACE.   02980000
020500       88 PS-EOD                     VALUE 'Y'.                   02990000
020600       88 PS-NOT-EOD                 VALUE 'N'.                   03000000
020700    05 PS-RUN-TYPE-SW                PIC X(01)     VALUE SPACE.   03010000
020800       88 PS-SPECIAL-RUN             VALUE 'S'.                   03020000
020900       88 PS-NORMAL-RUN              VALUE 'N'.                   03030000
021000 01 PS-DETERMINE-DATE-RANGE-SW       PIC X(01)     VALUE SPACE.   03040000
021100    88 PS-DETERMINE-DT-RANGE         VALUE 'Y'.                   03050000
021200    88 PS-DO-NOT-DETERMINE-DT-RANGE  VALUE 'N'.                   03060000
021600                                                                  03070000
021700 01 CC-CONTROL-CARD-PARAMETERS.                                   03080000
021800    05 CC-BEG-DATE.                                               03090000
021900       10 CC-BEG-YYYY                 PIC 9(04) VALUE 0.          03100000
022000       10 FILLER                      PIC X(01) VALUE SPACE.      03110000
022100       10 CC-BEG-MM                   PIC 9(02) VALUE 0.          03120000
022200       10 FILLER                      PIC X(01) VALUE SPACE.      03130000
022300       10 CC-BEG-DD                   PIC 9(02) VALUE 0.          03140000
022400    05 FILLER                       PIC X(01) VALUE SPACE.        03150000
022500    05 CC-END-DATE.                                               03160000
022600       10 CC-END-YYYY                 PIC 9(04) VALUE 0.          03170000
022700       10 FILLER                      PIC X(01) VALUE SPACE.      03180099
022800       10 CC-END-MM                   PIC 9(02) VALUE 0.          03190099
022900       10 FILLER                      PIC X(01) VALUE SPACE.      03200099
023000       10 CC-END-DD                   PIC 9(02) VALUE 0.          03210099
023100    05 FILLER                       PIC X(01) VALUE SPACE.        03220099
023200    05 CC-MODE-IND                  PIC X(01) VALUE SPACE.        03230099
023300       88 CC-VALID-MODE-IND         VALUE 'M'.                    03240099
023300*      88 CC-VALID-MODE-IND         VALUE 'W', 'M'.               03250099
023600*      88 CC-WEEKLY-EXTRACT         VALUE 'W'.                    03260099
023700       88 CC-MONTHLY-EXTRACT        VALUE 'M'.                    03270099
024100    05 FILLER                       PIC X(01) VALUE SPACE.        03280099
024200    05 CC-TIMEFRAME-IND             PIC X(01) VALUE SPACE.        03290099
024300       88 CC-VALID-TIMEFRAME-IND    VALUE ' ', 'A'.               03300099
024400       88 CC-ACTUAL-TIMEFRAME       VALUE 'A'.                    03310099
024500    05 FILLER                       PIC X(59) VALUE SPACE.        03320099
024600                                                                  03330099
017900     COPY DPWS132O.                                               03340099
018000                                                                  03350099
018100 01  HL1-HEADING-LINE.                                            03360099
018200     05  FILLER                      PIC  X(02)    VALUE SPACES.  03370099
018300     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  03380099
018400     05  FILLER                      PIC  X(07)    VALUE SPACES.  03390099
018500     05  FILLER                      PIC  X(50)    VALUE          03400099
018600           'MONTHLY FALSE FAILED AUDITS SUMMARY REPORT ENDING '.  03410099
018700     05  HL1-REPORT-DATE             PIC  X(10)    VALUE SPACES.  03420099
019000     05  FILLER                      PIC  X(32)    VALUE SPACES.  03430099
020300 01  HL2-HEADING-LINE.                                            03440099
020400     05  FILLER                      PIC  X(02)    VALUE SPACES.  03450099
020500     05  HL2-SUMMARY-TYPE            PIC  X(46)    VALUE SPACES.  03460099
020400     05  FILLER                      PIC  X(06)    VALUE SPACES.  03470099
020500     05  FILLER                      PIC  X(30)    VALUE          03480099
020600                               ' JAN  FEB  MAR  APR  MAY  JUN '.  03490099
020500     05  FILLER                      PIC  X(30)    VALUE          03500099
020600                               ' JUL  AUG  SEP  OCT  NOV  DEC '.  03510099
020400     05  FILLER                      PIC  X(18)    VALUE          03520099
                                                 '      YTD         '.  03530099
026500 01  DL1-DETAIL-LINE.                                             03540099
021100     05  FILLER                      PIC  X(01)    VALUE SPACES.  03550099
021100     05  DL1-VENDOR-NAME             PIC  X(40)    VALUE SPACES.  03560099
           05  DL1-DC REDEFINES DL1-VENDOR-NAME.                        03570099
               10  DL1-DC-X.                                            03580099
                   15  DL1-DC-NBR          PIC  9(03).                  03590099
               10  DL1-HYPHEN              PIC  X(03).                  03600099
               10  DL1-DC-NAME             PIC  X(34).                  03610099
021100     05  FILLER                      PIC  X(01)    VALUE SPACES.  03620099
           05  DL1-TRBL-DESC               PIC  X(10)    VALUE SPACES.  03630099
           05  FILLER                      PIC  X(02)    VALUE SPACES.  03640099
           05  DL1-JANUARY                 PIC  ZZZZ.                   03650099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03660099
           05  DL1-FEBRUARY                PIC  ZZZZ.                   03670099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03680099
           05  DL1-MARCH                   PIC  ZZZZ.                   03690099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03700099
           05  DL1-APRIL                   PIC  ZZZZ.                   03710099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03720099
           05  DL1-MAY                     PIC  ZZZZ.                   03730099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03740099
           05  DL1-JUNE                    PIC  ZZZZ.                   03750099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03760099
           05  DL1-JULY                    PIC  ZZZZ.                   03770099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03780099
           05  DL1-AUGUST                  PIC  ZZZZ.                   03790099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03800099
           05  DL1-SEPTEMBER               PIC  ZZZZ.                   03810099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03820099
           05  DL1-OCTOBER                 PIC  ZZZZ.                   03830099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03840099
           05  DL1-NOVEMBER                PIC  ZZZZ.                   03850099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03860099
           05  DL1-DECEMBER                PIC  ZZZZ.                   03870099
           05  FILLER                      PIC  X(01)    VALUE SPACES.  03880099
           05  DL1-YTD                     PIC  Z,ZZZ,ZZ9.              03890099
           05  FILLER                      PIC  X(09)    VALUE SPACES.  03900099
024700                                                                  03910099
024800     COPY DPWS500.                                                03920099
024900                                                                  03930099
024800     COPY XLWS071.                                                03940099
024900                                                                  03950099
025000     COPY TMRD002.                                                03960099
025400*                                                                 03970099
025200*** DB2 MESSAGE AREAS ****                                        03980099
025300     COPY DPWS004.                                                03990099
025400*                                                                 04000099
025500     EXEC SQL                                                     04010099
025600          INCLUDE SQLCA                                           04020099
025700     END-EXEC.                                                    04030099
025800                                                                  04040099
026300     EXEC SQL                                                     04050099
026400          INCLUDE TTRBNTF                                         04060099
026500     END-EXEC.                                                    04070099
027000                                                                  04080099
026300     EXEC SQL                                                     04090099
026400          INCLUDE TTRBRSN                                         04100099
026500     END-EXEC.                                                    04110099
027000                                                                  04120099
027100     EXEC SQL                                                     04130099
027200          INCLUDE TCOCNTL                                         04140099
027300     END-EXEC.                                                    04150099
027400                                                                  04160099
027500     EXEC SQL                                                     04170099
027600          INCLUDE TENTNME                                         04180099
027700     END-EXEC.                                                    04190099
027400                                                                  04200099
027500     EXEC SQL                                                     04210099
027600          INCLUDE TPURCHS                                         04220099
027700     END-EXEC.                                                    04230099
                                                                        04240099
027900      EXEC SQL                                                    04250099
028000          DECLARE TROUBLE-VEND-CSR CURSOR FOR                     04260099
028100             SELECT                                               04270099
                         A.TRBL_RSN_CDE                                 04280099
031000                  ,DATE(A.NOTIF_TMST)                             04290099
                        ,B.TRBL_SHT_DESC                                04300099
                        ,D.ENT_NAME_DESC                                04310099
030700             FROM TTRBNTF A                                       04320099
                       ,TTRBRSN B                                       04330099
                       ,TPURCHS C                                       04340099
                       ,TENTNME D                                       04350099
030900             WHERE DATE(A.NOTIF_TMST) <= :PV-END-EXTRACT          04360099
031000               AND DATE(A.NOTIF_TMST) >= :PV-START-EXTRACT        04370099
                     AND A.TRBL_RSN_CDE IN (804,805,806)                04380099
                     AND A.TRBL_RSN_CDE      = B.TRBL_RSN_CDE           04390099
                     AND C.PO_NBR            = A.PO_NBR                 04400099
                     AND C.VER_STATUS_CDE    = 'A'                      04410099
                     AND D.ENT_ID            = C.ENT_ID                 04420099
                     AND D.TYPE_CDE          = '01'                     04430099
                ORDER BY 4,1                                            04440099
031300          FOR FETCH ONLY                                          04450099
031400      END-EXEC.                                                   04460099
027900      EXEC SQL                                                    04470099
028000          DECLARE TROUBLE-CSR CURSOR FOR                          04480099
028100             SELECT                                               04490099
                         A.OPER_UNT_ID                                  04500099
                        ,A.TRBL_RSN_CDE                                 04510099
031000                  ,DATE(A.NOTIF_TMST)                             04520099
                        ,B.TRBL_SHT_DESC                                04530099
030700             FROM TTRBNTF A                                       04540099
                       ,TTRBRSN B                                       04550099
030900             WHERE DATE(A.NOTIF_TMST) <= :PV-END-EXTRACT          04560099
031000               AND DATE(A.NOTIF_TMST) >= :PV-START-EXTRACT        04570099
                     AND A.TRBL_RSN_CDE IN (804,805,806)                04580099
                     AND A.TRBL_RSN_CDE      = B.TRBL_RSN_CDE           04590099
                ORDER BY 1,2                                            04600099
031300          FOR FETCH ONLY                                          04610099
031400      END-EXEC.                                                   04620099
                                                                        04630099
031600******************************************************************04640099
031500                                                                  04650099
032000********************************************************          04660099
032100 PROCEDURE DIVISION.                                              04670099
032200********************************************************          04680099
032300 0000-MAIN.                                                       04690099
032400                                                                  04700099
032500     PERFORM 1000-INITIALIZATION.                                 04710099
           SET PS-FIRST-TIME               TO TRUE.                     04720099
                                                                        04730099
           MOVE PC-DC-SUMMARY              TO HL2-SUMMARY-TYPE          04740099
037500     PERFORM 1700-OPEN-TRBL-CSR.                                  04750099
032600     PERFORM 3000-DC-SUMMARY UNTIL PS-EOD.                        04760099
088500     EXEC SQL                                                     04770099
088600          CLOSE TROUBLE-CSR                                       04780099
088700     END-EXEC.                                                    04790099
           IF NOT PS-FIRST-TIME                                         04800099
               IF PS-NEW-DC                                             04810099
                   MOVE PV-HOLD-DC         TO DL1-DC                    04820099
               ELSE                                                     04830099
                   MOVE SPACES             TO DL1-DC-X                  04840099
                                              DL1-HYPHEN                04850099
                                              DL1-DC-NAME               04860099
               END-IF                                                   04870099
               MOVE PV-HOLD-TRBL-DESC      TO DL1-TRBL-DESC             04880099
               PERFORM 4000-SET-UP-TRBL-LINE                            04890099
               PERFORM 5100-ACCUM-SUBTOT-MONTHS                         04900099
               PERFORM 5200-ACCUM-FINTOT-MONTHS                         04910099
               PERFORM 8000-PRINT-DETAIL                                04920099
               MOVE PV-HOLD-OPER-UNT-ID    TO DL1-DC-NBR                04930099
               MOVE '-'                    TO DL1-HYPHEN                04940099
               PERFORM 3110-DC-NAME                                     04950099
               MOVE 'TOTAL:'               TO DL1-TRBL-DESC             04960099
               PERFORM 4100-SET-UP-SUBTOT-LINE                          04970099
               PERFORM 8000-PRINT-DETAIL                                04980099
               PERFORM 8020-PRINT-BLANK-LINE                            04990099
               MOVE 'TOTAL OF ALL DC''S:'  TO DL1-VENDOR-NAME           05000099
               PERFORM 4200-SET-UP-FINTOT-LINE                          05010099
               PERFORM 8000-PRINT-DETAIL                                05020099
           END-IF.                                                      05030099
                                                                        05040099
           INITIALIZE PS-NEW-DC-SW                                      05050099
           SET PS-NOT-EOD                                               05060099
               PS-FIRST-TIME               TO TRUE.                     05070099
           MOVE +80                        TO PV-LINE-COUNT             05080099
                                                                        05090099
           MOVE PC-VENDOR-SUMMARY          TO HL2-SUMMARY-TYPE          05100099
037500     PERFORM 1600-OPEN-TRBL-VEND-CSR.                             05110099
032600     PERFORM 2000-VENDOR-SUMMARY UNTIL PS-EOD.                    05120099
088500     EXEC SQL                                                     05130099
088600          CLOSE TROUBLE-VEND-CSR                                  05140099
088700     END-EXEC.                                                    05150099
           IF NOT PS-FIRST-TIME                                         05160099
               IF PS-NEW-VENDOR                                         05170099
                   MOVE PV-HOLD-VENDOR-NAME                             05180099
                                           TO DL1-VENDOR-NAME           05190099
                   MOVE +2 TO PV-LINE-ADVANCE                           05200099
               ELSE                                                     05210099
                   MOVE SPACES             TO DL1-VENDOR-NAME           05220099
               END-IF                                                   05230099
               MOVE PV-HOLD-TRBL-DESC      TO DL1-TRBL-DESC             05240099
               PERFORM 4000-SET-UP-TRBL-LINE                            05250099
               PERFORM 8000-PRINT-DETAIL                                05260099
               PERFORM 5100-ACCUM-SUBTOT-MONTHS                         05270099
               PERFORM 5200-ACCUM-FINTOT-MONTHS                         05280099
               MOVE PV-HOLD-VENDOR-NAME    TO DL1-VENDOR-NAME           05290099
               MOVE 'TOTAL:'               TO DL1-TRBL-DESC             05300099
               PERFORM 4100-SET-UP-SUBTOT-LINE                          05310099
               PERFORM 8000-PRINT-DETAIL                                05320099
               MOVE +2                     TO PV-LINE-ADVANCE           05330099
               MOVE 'TOTAL OF ALL VENDORS:'                             05340099
                                           TO DL1-VENDOR-NAME           05350099
               PERFORM 4200-SET-UP-FINTOT-LINE                          05360099
               PERFORM 8000-PRINT-DETAIL                                05370099
               PERFORM 5300-INIT-TRBL-MONTHS                            05380099
               PERFORM 5400-INIT-SUBTOT-MONTHS                          05390099
               PERFORM 5500-INIT-FINTOT-MONTHS                          05400099
           END-IF.                                                      05410099
                                                                        05420099
088900     WRITE FFA-REPORT-RECORD                                      05430099
               FROM PC-END-REPORT-LINE                                  05440099
               AFTER ADVANCING 1.                                       05450099
                                                                        05460099
032900     CLOSE  FFA-REPORT-FILE.                                      05470099
088900                                                                  05480099
033200     STOP RUN.                                                    05490099
033300                                                                  05500099
033400 1000-INITIALIZATION.                                             05510099
033500     MOVE PC-PROGRAM-NAME TO DP132O-PROGRAM-NAME                  05520099
033600     EXEC SQL                                                     05530099
033800         SELECT  CURRENT DATE                                     05540099
034100           INTO  :PV-CURRENT-DB2-DATE                             05550099
034300           FROM  TCOCNTL                                          05560099
034400          WHERE  OPER_UNT_ID = 90                                 05570099
034500     END-EXEC.                                                    05580099
034600                                                                  05590099
034700     EVALUATE TRUE                                                05600099
034800         WHEN SQLCODE = ZERO                                      05610099
034900             MOVE PV-CURRENT-DB2-DATE    TO PV-CURR-DATE          05620099
035000             MOVE PV-CURRENT-DB2-CC      TO PV-CURRENT-CC         05630099
035100             MOVE PV-CURRENT-DB2-YY      TO PV-CURRENT-YY         05640099
                                                  DP132O-RUN-YEAR       05650099
035300             MOVE PV-CURRENT-DB2-MM      TO PV-CURRENT-MM         05660099
                                                  DP132O-RUN-MONTH      05670099
035500             MOVE PV-CURRENT-DB2-DD      TO PV-CURRENT-DD         05680099
                                                  DP132O-RUN-DAY        05690099
035700         WHEN OTHER                                               05700099
035800              MOVE '1000-INITIALIZATION'      TO                  05710099
035900                   PV-ABEND-PARA-NAME                             05720099
036000              MOVE 'SET DATE   '       TO PV-DB2-OPERATION-MSG-1  05730099
036100              MOVE 'NONE   '           TO PV-DB2-TABLE-1          05740099
036200              PERFORM 9998-SQL-ABEND                              05750099
036300     END-EVALUATE.                                                05760099
034900     EXEC SQL                                                     05770099
035000         SET :PV-CURRENT-TIME   = CURRENT TIME                    05780099
035100     END-EXEC.                                                    05790099
035200     IF SQLCODE = 0                                               05800099
035300         MOVE PV-CURRENT-HOUR          TO DP132O-RUN-HOUR         05810099
035300         MOVE PV-CURRENT-MINUTE        TO DP132O-RUN-MINUTE       05820099
035400     ELSE                                                         05830099
035500         MOVE '1000-INITIALIZE'        TO PV-PARAGRAPH-NAME       05840099
035600         MOVE 'SET THE CURRENT TIME'   TO PV-DB2-OPERATION-MSG-1  05850099
035800         PERFORM 9998-SQL-ABEND                                   05860099
035900     END-IF.                                                      05870099
036400     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                05880099
036500                                                                  05890000
036600     DISPLAY 'CONTROL CARD SET-UP FOR THIS RUN IS:  '             05900033
036700             CC-CONTROL-CARD-PARAMETERS.                          05910033
036800                                                                  05920033
036900       PERFORM 1100-CHECK-CC-PARAMETERS                           05930099
037000       PERFORM 1200-SET-DATABASE-KEYS                             05940099
037100       OPEN OUTPUT FFA-REPORT-FILE                                05950099
086200       DISPLAY 'TROUBLE PULL BEGIN DATE IS:  '                    05960099
086300                TM002-RUN-BEGIN-DATE                              05970099
086400             '  AND TROUBLE PULL END DATE IS:    '                05980099
086500              TM002-RUN-END-DATE.                                 05990099
037600                                                                  06000000
037900 1100-CHECK-CC-PARAMETERS.                                        06010000
038000     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-PARA-NAME            06020000
038100                                                                  06030000
038200     IF NOT CC-VALID-MODE-IND                                     06040000
038300        DISPLAY '***************************'                     06050000
038400        DISPLAY 'CONTROL PARAMETERS: '                            06060000
038500                 CC-CONTROL-CARD-PARAMETERS                       06070000
038600        DISPLAY 'MODE INDICATOR "' CC-MODE-IND '"'                06080000
038700                ' IS INVALID.'                                    06090000
038800        DISPLAY 'RUN ABORTED'                                     06100000
038900        DISPLAY '***************************'                     06110000
039000        MOVE 4003  TO PV-ABEND-CODE                               06120000
039100        PERFORM 9999-ABORT                                        06130099
039200     END-IF                                                       06140000
039300                                                                  06150000
039400     IF NOT CC-VALID-TIMEFRAME-IND                                06160000
039500        DISPLAY '***************************'                     06170000
039600        DISPLAY 'CONTROL PARAMETERS: '                            06180000
039700                 CC-CONTROL-CARD-PARAMETERS                       06190000
039800        DISPLAY 'TIME INDICATOR "' CC-TIMEFRAME-IND '"'           06200099
039900                ' IS INVALID.'                                    06210000
040000        DISPLAY 'RUN ABORTED'                                     06220000
040100        DISPLAY '***************************'                     06230000
040200        MOVE 4003  TO PV-ABEND-CODE                               06240000
040300        PERFORM 9999-ABORT                                        06250099
040400     END-IF                                                       06260000
040500                                                                  06270000
040600     IF CC-BEG-DATE IS  = PC-DEFAULT-CC-DATE AND                  06280000
040700        CC-END-DATE IS  = PC-DEFAULT-CC-DATE                      06290000
040800        SET PS-NORMAL-RUN   TO TRUE                               06300099
           ELSE                                                         06310099
               PERFORM 1110-SPECIAL-RUN                                 06320099
041000     END-IF.                                                      06330000
       1110-SPECIAL-RUN.                                                06340099
038000     MOVE '1110-SPECIAL-RUN' TO PV-PARA-NAME                      06350099
041200     SET PS-SPECIAL-RUN      TO TRUE                              06360099
041300                                                                  06370000
041400     MOVE CC-BEG-YYYY        TO PV-BEG-YYYY                       06380099
041500     MOVE CC-BEG-MM          TO PV-BEG-MM                         06390099
041600     MOVE CC-BEG-DD          TO PV-BEG-DD                         06400099
041700     MOVE CC-END-YYYY        TO PV-END-YYYY                       06410099
041800     MOVE CC-END-MM          TO PV-END-MM                         06420099
041900     MOVE CC-END-DD          TO PV-END-DD                         06430099
042000                                                                  06440000
042100     IF  PV-BEG-DATE IS NOT < PV-END-DATE  AND                    06450000
042200         PV-BEG-DATE IS NOT = PV-END-DATE                         06460000
042300         DISPLAY '***************************'                    06470000
042400         DISPLAY 'CONTROL PARAMETERS: '                           06480000
042500                  CC-CONTROL-CARD-PARAMETERS                      06490000
042600         DISPLAY                                                  06500000
042700           'THE BEGINNING DATE MUST BE LESS THAN OR EQUAL TO THE E06510000
042800-          'NDING DATE'                                           06520000
042900         DISPLAY 'RUN ABORTED'                                    06530000
043000         DISPLAY '***************************'                    06540000
043100         MOVE 4003  TO PV-ABEND-CODE                              06550000
043200         PERFORM 9999-ABORT                                       06560099
043300     END-IF                                                       06570099
043400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06580099
043500     SET DPG51-FISCAL-454-CALENDAR   TO TRUE                      06590099
043600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      06600099
043700     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      06610099
043800                                                                  06620099
043900     MOVE PV-BEG-CC                  TO PV-DATE-AREA-CC           06630099
044000     MOVE PV-BEG-YY                  TO PV-DATE-AREA-YY           06640099
044100     MOVE PV-BEG-MM                  TO PV-DATE-AREA-MM           06650099
044200     MOVE PV-BEG-DD                  TO PV-DATE-AREA-DD           06660099
044300     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       06670099
044500     PERFORM 9100-CALL-DATE-MODULE                                06680099
044700     IF DPG54-DATE-INVALID                                        06690099
044800        DISPLAY '***************************'                     06700099
044900        DISPLAY 'CONTROL PARAMETERS: '                            06710099
045000                 CC-CONTROL-CARD-PARAMETERS                       06720099
045100        DISPLAY 'BEGINNING DATE  '                                06730099
045200                CC-BEG-DATE                                       06740099
045300                ' IS INVALID.'                                    06750099
045400        DISPLAY 'RUN ABORTED'                                     06760099
045500        DISPLAY '***************************'                     06770099
045600        MOVE 4003  TO PV-ABEND-CODE                               06780099
045700        PERFORM 9999-ABORT                                        06790099
045800     END-IF.                                                      06800099
045900                                                                  06810099
046000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06820099
046100     SET DPG51-FISCAL-454-CALENDAR   TO TRUE                      06830099
046200     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      06840099
046300     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      06850099
046400                                                                  06860099
046500     MOVE PV-END-CC                  TO PV-DATE-AREA-CC           06870099
046600     MOVE PV-END-YY                  TO PV-DATE-AREA-YY           06880099
046700     MOVE PV-END-MM                  TO PV-DATE-AREA-MM           06890099
046800     MOVE PV-END-DD                  TO PV-DATE-AREA-DD           06900099
046900     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       06910099
047000                                                                  06920099
047100     PERFORM 9100-CALL-DATE-MODULE                                06930099
047200                                                                  06940099
047300     IF DPG54-DATE-INVALID                                        06950099
047400        DISPLAY '***************************'                     06960099
047500        DISPLAY 'CONTROL PARAMETERS: '                            06970099
047600                 CC-CONTROL-CARD-PARAMETERS                       06980099
047700        DISPLAY 'ENDING DATE '                                    06990099
047800                CC-END-DATE                                       07000099
047900                ' IS INVALID.'                                    07010099
048000        DISPLAY 'RUN ABORTED'                                     07020099
048100        DISPLAY '***************************'                     07030099
048200        MOVE 4003  TO PV-ABEND-CODE                               07040099
048300        PERFORM 9999-ABORT                                        07050099
048400     END-IF.                                                      07060099
048500                                                                  07070099
048800 1200-SET-DATABASE-KEYS.                                          07080099
048900     IF PS-NORMAL-RUN                                             07090099
049000        PERFORM 1210-DETERMINE-DATE-RANGE                         07100099
049100     ELSE                                                         07110099
049200        MOVE CC-BEG-DATE         TO PV-START-EXTRACT              07120099
049300        MOVE CC-END-DATE         TO PV-END-EXTRACT                07130099
              MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          07140099
049400     END-IF.                                                      07150099
      *** THIS REPORT STARTS AT THE BEGINNING OF THE YEAR               07160099
049500     MOVE '01'                   TO PV-START-EXTRACT-MM           07170099
049500                                    PV-START-EXTRACT-DD           07180099
           STRING PV-END-EXTRACT-MM '/'                                 07190099
                  PV-END-EXTRACT-DD '/'                                 07200099
                  PV-END-EXTRACT-YYYY DELIMITED BY SIZE                 07210099
                                     INTO HL1-REPORT-DATE.              07220099
049600     DISPLAY '**************************************************'.07230099
049610     DISPLAY 'EXTRACT START:  ' PV-START-EXTRACT.                 07240099
049700     DISPLAY 'EXTRACT END  :  ' PV-END-EXTRACT.                   07250099
049710     DISPLAY '**************************************************'.07260099
049800                                                                  07270099
050100 1210-DETERMINE-DATE-RANGE.                                       07280000
062400     MOVE '1210-DETERMINE-DATE-RANGE'  TO PV-PARA-NAME            07290099
062500*** GET START/END DATES OF THE PREVIOUS MONTH.                    07300000
062600     MOVE   PV-CURRENT-CC      TO  PV-DATE-AREA-CC                07310000
062700     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                07320000
062800     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                07330000
062900     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                07340000
063000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56               07350000
063100     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            07360000
063200                                                                  07370000
063300     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          07380024
063400                                                                  07390000
063500     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      07400000
063600     SET DPG51-DECREMENT-DATE       TO TRUE.                      07410000
063700     SET DPG52-LK-DTE-GREG-CC       TO TRUE.                      07420000
063800                                                                  07430000
063900     PERFORM 9100-CALL-DATE-MODULE                                07440099
064000     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           07450000
064100                                  PV-START-EXTRACT                07460000
064200     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           07470000
064300                                  PV-END-EXTRACT.                 07480000
086700                                                                  07490000
086800 1600-OPEN-TRBL-VEND-CSR.                                         07500099
086900     EXEC SQL                                                     07510099
087000          OPEN TROUBLE-VEND-CSR                                   07520099
087100     END-EXEC.                                                    07530099
087200                                                                  07540000
087300     EVALUATE TRUE                                                07550099
087400         WHEN SQLCODE = ZERO                                      07560099
087500              CONTINUE                                            07570099
087600         WHEN OTHER                                               07580099
087700              MOVE '1600-OPEN-TRBL-VEND-CSR'                      07590099
087700                                       TO PV-ABEND-PARA-NAME      07600099
087800              MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-1  07610099
087900              MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1          07620099
087900              MOVE 'TTRBRSN'           TO PV-DB2-TABLE-2          07630099
088000              PERFORM 9998-SQL-ABEND                              07640099
088100        END-EVALUATE.                                             07650000
086800 1700-OPEN-TRBL-CSR.                                              07660099
086900     EXEC SQL                                                     07670099
087000          OPEN TROUBLE-CSR                                        07680099
087100     END-EXEC.                                                    07690099
087200                                                                  07700099
087300     EVALUATE TRUE                                                07710099
087400         WHEN SQLCODE = ZERO                                      07720099
087500              CONTINUE                                            07730099
087600         WHEN OTHER                                               07740099
087700              MOVE '1700-OPEN-TRBL-CSR'                           07750099
087700                                       TO PV-ABEND-PARA-NAME      07760099
087800              MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-1  07770099
087900              MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1          07780099
087900              MOVE 'TTRBRSN'           TO PV-DB2-TABLE-2          07790099
088000              PERFORM 9998-SQL-ABEND                              07800099
088100        END-EVALUATE.                                             07810099
088300                                                                  07820000
089000 2000-VENDOR-SUMMARY.                                             07830099
089100     EXEC SQL                                                     07840099
089200       FETCH TROUBLE-VEND-CSR                                     07850099
              INTO  :TRBNTF-TRBL-RSN-CDE                                07860099
                   ,:PV-NOTIF-DATE                                      07870099
                   ,:TRBRSN-TRBL-SHT-DESC                               07880099
                   ,:ENTNME-ENT-NAME-DESC                               07890099
091800     END-EXEC.                                                    07900099
091900                                                                  07910099
092000     EVALUATE TRUE                                                07920099
092100         WHEN SQLCODE = ZERO                                      07930099
092200              PERFORM 2100-PROCESS-ROW                            07940099
092300         WHEN SQLCODE = +100                                      07950099
                    IF PS-FIRST-TIME                                    07960099
088200                  PERFORM 8100-PRINT-PAGE-HEADING                 07970099
                        MOVE PC-NO-DATA-LINE TO FFA-REPORT-RECORD       07980099
                        MOVE +3              TO PV-LINE-ADVANCE         07990099
                        PERFORM 8010-PRINT-LINE                         08000099
                    END-IF                                              08010099
092400              SET  PS-EOD              TO TRUE                    08020099
092500         WHEN OTHER                                               08030099
092600              MOVE '2000-VENDOR-SUMMARY' TO PV-ABEND-PARA-NAME    08040099
092700              MOVE 'FETCH TROUBLE-CSR' TO PV-DB2-OPERATION-MSG-1  08050099
092900              MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1          08060099
092900              MOVE 'TTRBRSN'           TO PV-DB2-TABLE-2          08070099
093000              PERFORM 9998-SQL-ABEND                              08080099
093100        END-EVALUATE.                                             08090099
093300                                                                  08100099
093400 2100-PROCESS-ROW.                                                08110099
           IF PS-FIRST-TIME                                             08120099
               MOVE ENTNME-ENT-NAME-DESC TO PV-HOLD-VENDOR-NAME         08130099
               MOVE TRBNTF-TRBL-RSN-CDE  TO PV-HOLD-TRBL-RSN-CDE        08140099
               MOVE TRBRSN-TRBL-SHT-DESC TO PV-HOLD-TRBL-DESC           08150099
               SET PS-NEW-VENDOR         TO TRUE                        08160099
               INITIALIZE PS-FIRST-TIME-SW                              08170099
           END-IF                                                       08180099
           IF ENTNME-ENT-NAME-DESC   = PV-HOLD-VENDOR-NAME              08190099
             AND TRBNTF-TRBL-RSN-CDE = PV-HOLD-TRBL-RSN-CDE             08200099
               PERFORM 5000-ACCUM-TRBL-MONTHS                           08210099
           ELSE                                                         08220099
               IF PS-NEW-VENDOR                                         08230099
                   MOVE PV-HOLD-VENDOR-NAME                             08240099
                                           TO DL1-VENDOR-NAME           08250099
      ***  IF NOT AT TOP OF PAGE                                        08260099
                   IF PV-LINE-COUNT NOT = +80                           08270099
                       MOVE +2 TO PV-LINE-ADVANCE                       08280099
                   END-IF                                               08290099
                   INITIALIZE PS-NEW-VENDOR-SW                          08300099
               ELSE                                                     08310099
                   MOVE SPACES             TO DL1-VENDOR-NAME           08320099
               END-IF                                                   08330099
               MOVE PV-HOLD-TRBL-DESC      TO DL1-TRBL-DESC             08340099
               PERFORM 4000-SET-UP-TRBL-LINE                            08350099
               PERFORM 8000-PRINT-DETAIL                                08360099
               MOVE TRBNTF-TRBL-RSN-CDE    TO PV-HOLD-TRBL-RSN-CDE      08370099
               MOVE TRBRSN-TRBL-SHT-DESC   TO PV-HOLD-TRBL-DESC         08380099
               IF ENTNME-ENT-NAME-DESC NOT = PV-HOLD-VENDOR-NAME        08390099
                   PERFORM 5100-ACCUM-SUBTOT-MONTHS                     08400099
                   MOVE PV-HOLD-VENDOR-NAME                             08410099
                                           TO DL1-VENDOR-NAME           08420099
                   MOVE 'TOTAL:'           TO DL1-TRBL-DESC             08430099
                   PERFORM 4100-SET-UP-SUBTOT-LINE                      08440099
                   PERFORM 8000-PRINT-DETAIL                            08450099
                   PERFORM 5200-ACCUM-FINTOT-MONTHS                     08460099
                   MOVE ENTNME-ENT-NAME-DESC                            08470099
                                           TO PV-HOLD-VENDOR-NAME       08480099
                   PERFORM 5400-INIT-SUBTOT-MONTHS                      08490099
                   SET PS-NEW-VENDOR       TO TRUE                      08500099
                   PERFORM 5300-INIT-TRBL-MONTHS                        08510099
               END-IF                                                   08520099
               PERFORM 5000-ACCUM-TRBL-MONTHS                           08530099
           END-IF.                                                      08540099
                                                                        08550099
089000 3000-DC-SUMMARY.                                                 08560099
089100     EXEC SQL                                                     08570099
089200       FETCH TROUBLE-CSR                                          08580099
              INTO  :TRBNTF-OPER-UNT-ID                                 08590099
                   ,:TRBNTF-TRBL-RSN-CDE                                08600099
                   ,:PV-NOTIF-DATE                                      08610099
                   ,:TRBRSN-TRBL-SHT-DESC                               08620099
091800     END-EXEC.                                                    08630099
091900                                                                  08640099
092000     EVALUATE TRUE                                                08650099
092100         WHEN SQLCODE = ZERO                                      08660099
092200              PERFORM 3100-PROCESS-ROW                            08670099
092300         WHEN SQLCODE = +100                                      08680099
                    IF PS-FIRST-TIME                                    08690099
088200                  PERFORM 8100-PRINT-PAGE-HEADING                 08700099
                        MOVE PC-NO-DATA-LINE TO FFA-REPORT-RECORD       08710099
                        MOVE +3              TO PV-LINE-ADVANCE         08720099
                        PERFORM 8010-PRINT-LINE                         08730099
                        MOVE PC-END-REPORT-LINE                         08740099
                                             TO FFA-REPORT-RECORD       08750099
                        MOVE +3              TO PV-LINE-ADVANCE         08760099
                        PERFORM 8010-PRINT-LINE                         08770099
                    END-IF                                              08780099
092400              SET  PS-EOD              TO TRUE                    08790099
092500         WHEN OTHER                                               08800099
092600              MOVE '3000-DC-SUMMARY'   TO PV-ABEND-PARA-NAME      08810099
092700              MOVE 'FETCH TROUBLE-CSR' TO PV-DB2-OPERATION-MSG-1  08820099
092900              MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1          08830099
092900              MOVE 'TTRBRSN'           TO PV-DB2-TABLE-2          08840099
093000              PERFORM 9998-SQL-ABEND                              08850099
093100        END-EVALUATE.                                             08860099
093400 3100-PROCESS-ROW.                                                08870099
           IF PS-FIRST-TIME                                             08880099
               MOVE TRBNTF-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID         08890099
               MOVE TRBNTF-TRBL-RSN-CDE  TO PV-HOLD-TRBL-RSN-CDE        08900099
               MOVE TRBRSN-TRBL-SHT-DESC TO PV-HOLD-TRBL-DESC           08910099
               SET PS-NEW-DC             TO TRUE                        08920099
               INITIALIZE PS-FIRST-TIME-SW                              08930099
           END-IF                                                       08940099
           IF TRBNTF-OPER-UNT-ID      = PV-HOLD-OPER-UNT-ID             08950099
             AND TRBNTF-TRBL-RSN-CDE = PV-HOLD-TRBL-RSN-CDE             08960099
               PERFORM 5000-ACCUM-TRBL-MONTHS                           08970099
           ELSE                                                         08980099
               IF PS-NEW-DC                                             08990099
                   MOVE PV-HOLD-OPER-UNT-ID                             09000099
                                           TO DL1-DC-NBR                09010099
                   MOVE ' - '              TO DL1-HYPHEN                09020099
                   PERFORM 3110-DC-NAME                                 09030099
                   MOVE DL1-DC             TO PV-HOLD-DC                09040099
               ELSE                                                     09050099
                   MOVE SPACES             TO DL1-DC-X                  09060099
                                              DL1-HYPHEN                09070099
                                              DL1-DC-NAME               09080099
               END-IF                                                   09090099
               MOVE PV-HOLD-TRBL-DESC      TO DL1-TRBL-DESC             09100099
               PERFORM 4000-SET-UP-TRBL-LINE                            09110099
               PERFORM 8000-PRINT-DETAIL                                09120099
               MOVE TRBNTF-TRBL-RSN-CDE    TO PV-HOLD-TRBL-RSN-CDE      09130099
               MOVE TRBRSN-TRBL-SHT-DESC   TO PV-HOLD-TRBL-DESC         09140099
               IF TRBNTF-OPER-UNT-ID NOT = PV-HOLD-OPER-UNT-ID          09150099
                   PERFORM 5100-ACCUM-SUBTOT-MONTHS                     09160099
                   MOVE PV-HOLD-DC         TO DL1-DC                    09170099
                   MOVE 'TOTAL:'           TO DL1-TRBL-DESC             09180099
                   PERFORM 4100-SET-UP-SUBTOT-LINE                      09190099
                   PERFORM 8000-PRINT-DETAIL                            09200099
                   PERFORM 5200-ACCUM-FINTOT-MONTHS                     09210099
                   MOVE TRBNTF-OPER-UNT-ID TO PV-HOLD-OPER-UNT-ID       09220099
                   PERFORM 5400-INIT-SUBTOT-MONTHS                      09230099
                   SET PS-NEW-DC           TO TRUE                      09240099
                   PERFORM 5300-INIT-TRBL-MONTHS                        09250099
               END-IF                                                   09260099
               PERFORM 5000-ACCUM-TRBL-MONTHS                           09270099
           END-IF.                                                      09280099
100100                                                                  09290099
094300 3110-DC-NAME.                                                    09300099
000398     INITIALIZE XL071-COMMAREA-REC                                09310099
           MOVE PV-HOLD-OPER-UNT-ID TO XL071-LOCATION-NUMBER            09320099
000398     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC          09330099
                                                                        09340099
105300     EVALUATE TRUE                                                09350099
105400         WHEN XL071-NO-ERRORS                                     09360099
105600             MOVE XL071-LOC-NM        TO DL1-DC-NAME              09370099
105400         WHEN XL071-LOC-NOT-FOUND                                 09380099
                   MOVE 'NOT FOUND'         TO DL1-DC-NAME              09390099
106500         WHEN XL071-BAD-DB2-RETURN                                09400099
106600             MOVE '3110-DC-NAME     ' TO PV-ABEND-PARA-NAME       09410099
106700             MOVE 'SELECT LOCATION NAME'                          09420099
106800                                      TO PV-DB2-OPERATION-MSG-1   09430099
106900             MOVE 'XLT_LOC'           TO PV-DB2-TABLE-1           09440099
106900             MOVE 'XLT_LOC_TYP_CDE'   TO PV-DB2-TABLE-2           09450099
                   MOVE XL071-SQLCA         TO SQLCA                    09460099
107000             PERFORM 9998-SQL-ABEND                               09470099
107100     END-EVALUATE.                                                09480099
                                                                        09490099
       4000-SET-UP-TRBL-LINE.                                           09500099
           EVALUATE PV-HOLD-TRBL-RSN-CDE                                09510099
               WHEN 804                                                 09520099
                   MOVE PV-804-JANUARY         TO DL1-JANUARY           09530099
                   MOVE PV-804-FEBRUARY        TO DL1-FEBRUARY          09540099
                   MOVE PV-804-MARCH           TO DL1-MARCH             09550099
                   MOVE PV-804-APRIL           TO DL1-APRIL             09560099
                   MOVE PV-804-MAY             TO DL1-MAY               09570099
                   MOVE PV-804-JUNE            TO DL1-JUNE              09580099
                   MOVE PV-804-JULY            TO DL1-JULY              09590099
                   MOVE PV-804-AUGUST          TO DL1-AUGUST            09600099
                   MOVE PV-804-SEPTEMBER       TO DL1-SEPTEMBER         09610099
                   MOVE PV-804-OCTOBER         TO DL1-OCTOBER           09620099
                   MOVE PV-804-NOVEMBER        TO DL1-NOVEMBER          09630099
                   MOVE PV-804-DECEMBER        TO DL1-DECEMBER          09640099
                   MOVE PV-804-YTD             TO DL1-YTD               09650099
               WHEN 805                                                 09660099
                   MOVE PV-805-JANUARY         TO DL1-JANUARY           09670099
                   MOVE PV-805-FEBRUARY        TO DL1-FEBRUARY          09680099
                   MOVE PV-805-MARCH           TO DL1-MARCH             09690099
                   MOVE PV-805-APRIL           TO DL1-APRIL             09700099
                   MOVE PV-805-MAY             TO DL1-MAY               09710099
                   MOVE PV-805-JUNE            TO DL1-JUNE              09720099
                   MOVE PV-805-JULY            TO DL1-JULY              09730099
                   MOVE PV-805-AUGUST          TO DL1-AUGUST            09740099
                   MOVE PV-805-SEPTEMBER       TO DL1-SEPTEMBER         09750099
                   MOVE PV-805-OCTOBER         TO DL1-OCTOBER           09760099
                   MOVE PV-805-NOVEMBER        TO DL1-NOVEMBER          09770099
                   MOVE PV-805-DECEMBER        TO DL1-DECEMBER          09780099
                   MOVE PV-805-YTD             TO DL1-YTD               09790099
               WHEN 806                                                 09800099
                   MOVE PV-806-JANUARY         TO DL1-JANUARY           09810099
                   MOVE PV-806-FEBRUARY        TO DL1-FEBRUARY          09820099
                   MOVE PV-806-MARCH           TO DL1-MARCH             09830099
                   MOVE PV-806-APRIL           TO DL1-APRIL             09840099
                   MOVE PV-806-MAY             TO DL1-MAY               09850099
                   MOVE PV-806-JUNE            TO DL1-JUNE              09860099
                   MOVE PV-806-JULY            TO DL1-JULY              09870099
                   MOVE PV-806-AUGUST          TO DL1-AUGUST            09880099
                   MOVE PV-806-SEPTEMBER       TO DL1-SEPTEMBER         09890099
                   MOVE PV-806-OCTOBER         TO DL1-OCTOBER           09900099
                   MOVE PV-806-NOVEMBER        TO DL1-NOVEMBER          09910099
                   MOVE PV-806-DECEMBER        TO DL1-DECEMBER          09920099
                   MOVE PV-806-YTD             TO DL1-YTD               09930099
           END-EVALUATE.                                                09940099
       4100-SET-UP-SUBTOT-LINE.                                         09950099
           MOVE PV-SUBTOT-JANUARY      TO DL1-JANUARY                   09960099
           MOVE PV-SUBTOT-FEBRUARY     TO DL1-FEBRUARY                  09970099
           MOVE PV-SUBTOT-MARCH        TO DL1-MARCH                     09980099
           MOVE PV-SUBTOT-APRIL        TO DL1-APRIL                     09990099
           MOVE PV-SUBTOT-MAY          TO DL1-MAY                       10000099
           MOVE PV-SUBTOT-JUNE         TO DL1-JUNE                      10010099
           MOVE PV-SUBTOT-JULY         TO DL1-JULY                      10020099
           MOVE PV-SUBTOT-AUGUST       TO DL1-AUGUST                    10030099
           MOVE PV-SUBTOT-SEPTEMBER    TO DL1-SEPTEMBER                 10040099
           MOVE PV-SUBTOT-OCTOBER      TO DL1-OCTOBER                   10050099
           MOVE PV-SUBTOT-NOVEMBER     TO DL1-NOVEMBER                  10060099
           MOVE PV-SUBTOT-DECEMBER     TO DL1-DECEMBER                  10070099
           MOVE PV-SUBTOT-YTD          TO DL1-YTD.                      10080099
       4200-SET-UP-FINTOT-LINE.                                         10090099
           MOVE SPACES                 TO DL1-TRBL-DESC                 10100099
           MOVE PV-FINTOT-JANUARY      TO DL1-JANUARY                   10110099
           MOVE PV-FINTOT-FEBRUARY     TO DL1-FEBRUARY                  10120099
           MOVE PV-FINTOT-MARCH        TO DL1-MARCH                     10130099
           MOVE PV-FINTOT-APRIL        TO DL1-APRIL                     10140099
           MOVE PV-FINTOT-MAY          TO DL1-MAY                       10150099
           MOVE PV-FINTOT-JUNE         TO DL1-JUNE                      10160099
           MOVE PV-FINTOT-JULY         TO DL1-JULY                      10170099
           MOVE PV-FINTOT-AUGUST       TO DL1-AUGUST                    10180099
           MOVE PV-FINTOT-SEPTEMBER    TO DL1-SEPTEMBER                 10190099
           MOVE PV-FINTOT-OCTOBER      TO DL1-OCTOBER                   10200099
           MOVE PV-FINTOT-NOVEMBER     TO DL1-NOVEMBER                  10210099
           MOVE PV-FINTOT-DECEMBER     TO DL1-DECEMBER                  10220099
           MOVE PV-FINTOT-YTD          TO DL1-YTD.                      10230099
                                                                        10240099
       5000-ACCUM-TRBL-MONTHS.                                          10250099
           EVALUATE TRBNTF-TRBL-RSN-CDE                                 10260099
               WHEN 804                                                 10270099
                   PERFORM 5010-804-MONTHS                              10280099
               WHEN 805                                                 10290099
                   PERFORM 5020-805-MONTHS                              10300099
               WHEN 806                                                 10310099
                   PERFORM 5030-806-MONTHS                              10320099
           END-EVALUATE.                                                10330099
       5010-804-MONTHS.                                                 10340099
           EVALUATE PV-NOTIF-MM                                         10350099
               WHEN 1                                                   10360099
                  ADD +1 TO PV-804-JANUARY                              10370099
                            PV-804-YTD                                  10380099
               WHEN 2                                                   10390099
                  ADD +1 TO PV-804-FEBRUARY                             10400099
                            PV-804-YTD                                  10410099
               WHEN 3                                                   10420099
                  ADD +1 TO PV-804-MARCH                                10430099
                            PV-804-YTD                                  10440099
               WHEN 4                                                   10450099
                  ADD +1 TO PV-804-APRIL                                10460099
                            PV-804-YTD                                  10470099
               WHEN 5                                                   10480099
                  ADD +1 TO PV-804-MAY                                  10490099
                            PV-804-YTD                                  10500099
               WHEN 6                                                   10510099
                  ADD +1 TO PV-804-JUNE                                 10520099
                            PV-804-YTD                                  10530099
               WHEN 7                                                   10540099
                  ADD +1 TO PV-804-JULY                                 10550099
                            PV-804-YTD                                  10560099
               WHEN 8                                                   10570099
                  ADD +1 TO PV-804-AUGUST                               10580099
                            PV-804-YTD                                  10590099
               WHEN 9                                                   10600099
                  ADD +1 TO PV-804-SEPTEMBER                            10610099
                            PV-804-YTD                                  10620099
               WHEN 10                                                  10630099
                  ADD +1 TO PV-804-OCTOBER                              10640099
                            PV-804-YTD                                  10650099
               WHEN 11                                                  10660099
                  ADD +1 TO PV-804-NOVEMBER                             10670099
                            PV-804-YTD                                  10680099
               WHEN 12                                                  10690099
                  ADD +1 TO PV-804-DECEMBER                             10700099
                            PV-804-YTD                                  10710099
           END-EVALUATE.                                                10720099
       5020-805-MONTHS.                                                 10730099
           EVALUATE PV-NOTIF-MM                                         10740099
               WHEN 1                                                   10750099
                  ADD +1 TO PV-805-JANUARY                              10760099
                            PV-805-YTD                                  10770099
               WHEN 2                                                   10780099
                  ADD +1 TO PV-805-FEBRUARY                             10790099
                            PV-805-YTD                                  10800099
               WHEN 3                                                   10810099
                  ADD +1 TO PV-805-MARCH                                10820099
                            PV-805-YTD                                  10830099
               WHEN 4                                                   10840099
                  ADD +1 TO PV-805-APRIL                                10850099
                            PV-805-YTD                                  10860099
               WHEN 5                                                   10870099
                  ADD +1 TO PV-805-MAY                                  10880099
                            PV-805-YTD                                  10890099
               WHEN 6                                                   10900099
                  ADD +1 TO PV-805-JUNE                                 10910099
                            PV-805-YTD                                  10920099
               WHEN 7                                                   10930099
                  ADD +1 TO PV-805-JULY                                 10940099
                            PV-805-YTD                                  10950099
               WHEN 8                                                   10960099
                  ADD +1 TO PV-805-AUGUST                               10970099
                            PV-805-YTD                                  10980099
               WHEN 9                                                   10990099
                  ADD +1 TO PV-805-SEPTEMBER                            11000099
                            PV-805-YTD                                  11010099
               WHEN 10                                                  11020099
                  ADD +1 TO PV-805-OCTOBER                              11030099
                            PV-805-YTD                                  11040099
               WHEN 11                                                  11050099
                  ADD +1 TO PV-805-NOVEMBER                             11060099
                            PV-805-YTD                                  11070099
               WHEN 12                                                  11080099
                  ADD +1 TO PV-805-DECEMBER                             11090099
                            PV-805-YTD                                  11100099
           END-EVALUATE.                                                11110099
       5030-806-MONTHS.                                                 11120099
           EVALUATE PV-NOTIF-MM                                         11130099
               WHEN 1                                                   11140099
                  ADD +1 TO PV-806-JANUARY                              11150099
                            PV-806-YTD                                  11160099
               WHEN 2                                                   11170099
                  ADD +1 TO PV-806-FEBRUARY                             11180099
                            PV-806-YTD                                  11190099
               WHEN 3                                                   11200099
                  ADD +1 TO PV-806-MARCH                                11210099
                            PV-806-YTD                                  11220099
               WHEN 4                                                   11230099
                  ADD +1 TO PV-806-APRIL                                11240099
                            PV-806-YTD                                  11250099
               WHEN 5                                                   11260099
                  ADD +1 TO PV-806-MAY                                  11270099
                            PV-806-YTD                                  11280099
               WHEN 6                                                   11290099
                  ADD +1 TO PV-806-JUNE                                 11300099
                            PV-806-YTD                                  11310099
               WHEN 7                                                   11320099
                  ADD +1 TO PV-806-JULY                                 11330099
                            PV-806-YTD                                  11340099
               WHEN 8                                                   11350099
                  ADD +1 TO PV-806-AUGUST                               11360099
                            PV-806-YTD                                  11370099
               WHEN 9                                                   11380099
                  ADD +1 TO PV-806-SEPTEMBER                            11390099
                            PV-806-YTD                                  11400099
               WHEN 10                                                  11410099
                  ADD +1 TO PV-806-OCTOBER                              11420099
                            PV-806-YTD                                  11430099
               WHEN 11                                                  11440099
                  ADD +1 TO PV-806-NOVEMBER                             11450099
                            PV-806-YTD                                  11460099
               WHEN 12                                                  11470099
                  ADD +1 TO PV-806-DECEMBER                             11480099
                            PV-806-YTD                                  11490099
           END-EVALUATE.                                                11500099
       5100-ACCUM-SUBTOT-MONTHS.                                        11510099
           ADD PV-804-JANUARY           TO PV-SUBTOT-JANUARY            11520099
           ADD PV-804-FEBRUARY          TO PV-SUBTOT-FEBRUARY           11530099
           ADD PV-804-MARCH             TO PV-SUBTOT-MARCH              11540099
           ADD PV-804-APRIL             TO PV-SUBTOT-APRIL              11550099
           ADD PV-804-MAY               TO PV-SUBTOT-MAY                11560099
           ADD PV-804-JUNE              TO PV-SUBTOT-JUNE               11570099
           ADD PV-804-JULY              TO PV-SUBTOT-JULY               11580099
           ADD PV-804-AUGUST            TO PV-SUBTOT-AUGUST             11590099
           ADD PV-804-SEPTEMBER         TO PV-SUBTOT-SEPTEMBER          11600099
           ADD PV-804-OCTOBER           TO PV-SUBTOT-OCTOBER            11610099
           ADD PV-804-NOVEMBER          TO PV-SUBTOT-NOVEMBER           11620099
           ADD PV-804-DECEMBER          TO PV-SUBTOT-DECEMBER           11630099
           ADD PV-804-YTD               TO PV-SUBTOT-YTD.               11640099
           ADD PV-805-JANUARY           TO PV-SUBTOT-JANUARY            11650099
           ADD PV-805-FEBRUARY          TO PV-SUBTOT-FEBRUARY           11660099
           ADD PV-805-MARCH             TO PV-SUBTOT-MARCH              11670099
           ADD PV-805-APRIL             TO PV-SUBTOT-APRIL              11680099
           ADD PV-805-MAY               TO PV-SUBTOT-MAY                11690099
           ADD PV-805-JUNE              TO PV-SUBTOT-JUNE               11700099
           ADD PV-805-JULY              TO PV-SUBTOT-JULY               11710099
           ADD PV-805-AUGUST            TO PV-SUBTOT-AUGUST             11720099
           ADD PV-805-SEPTEMBER         TO PV-SUBTOT-SEPTEMBER          11730099
           ADD PV-805-OCTOBER           TO PV-SUBTOT-OCTOBER            11740099
           ADD PV-805-NOVEMBER          TO PV-SUBTOT-NOVEMBER           11750099
           ADD PV-805-DECEMBER          TO PV-SUBTOT-DECEMBER           11760099
           ADD PV-805-YTD               TO PV-SUBTOT-YTD.               11770099
           ADD PV-806-JANUARY           TO PV-SUBTOT-JANUARY            11780099
           ADD PV-806-FEBRUARY          TO PV-SUBTOT-FEBRUARY           11790099
           ADD PV-806-MARCH             TO PV-SUBTOT-MARCH              11800099
           ADD PV-806-APRIL             TO PV-SUBTOT-APRIL              11810099
           ADD PV-806-MAY               TO PV-SUBTOT-MAY                11820099
           ADD PV-806-JUNE              TO PV-SUBTOT-JUNE               11830099
           ADD PV-806-JULY              TO PV-SUBTOT-JULY               11840099
           ADD PV-806-AUGUST            TO PV-SUBTOT-AUGUST             11850099
           ADD PV-806-SEPTEMBER         TO PV-SUBTOT-SEPTEMBER          11860099
           ADD PV-806-OCTOBER           TO PV-SUBTOT-OCTOBER            11870099
           ADD PV-806-NOVEMBER          TO PV-SUBTOT-NOVEMBER           11880099
           ADD PV-806-DECEMBER          TO PV-SUBTOT-DECEMBER           11890099
           ADD PV-806-YTD               TO PV-SUBTOT-YTD.               11900099
       5200-ACCUM-FINTOT-MONTHS.                                        11910099
           ADD PV-SUBTOT-JANUARY        TO PV-FINTOT-JANUARY            11920099
           ADD PV-SUBTOT-FEBRUARY       TO PV-FINTOT-FEBRUARY           11930099
           ADD PV-SUBTOT-MARCH          TO PV-FINTOT-MARCH              11940099
           ADD PV-SUBTOT-APRIL          TO PV-FINTOT-APRIL              11950099
           ADD PV-SUBTOT-MAY            TO PV-FINTOT-MAY                11960099
           ADD PV-SUBTOT-JUNE           TO PV-FINTOT-JUNE               11970099
           ADD PV-SUBTOT-JULY           TO PV-FINTOT-JULY               11980099
           ADD PV-SUBTOT-AUGUST         TO PV-FINTOT-AUGUST             11990099
           ADD PV-SUBTOT-SEPTEMBER      TO PV-FINTOT-SEPTEMBER          12000099
           ADD PV-SUBTOT-OCTOBER        TO PV-FINTOT-OCTOBER            12010099
           ADD PV-SUBTOT-NOVEMBER       TO PV-FINTOT-NOVEMBER           12020099
           ADD PV-SUBTOT-DECEMBER       TO PV-FINTOT-DECEMBER           12030099
           ADD PV-SUBTOT-YTD            TO PV-FINTOT-YTD.               12040099
                                                                        12050099
       5300-INIT-TRBL-MONTHS.                                           12060099
           INITIALIZE PV-804-JANUARY                                    12070099
                      PV-804-FEBRUARY                                   12080099
                      PV-804-MARCH                                      12090099
                      PV-804-APRIL                                      12100099
                      PV-804-MAY                                        12110099
                      PV-804-JUNE                                       12120099
                      PV-804-JULY                                       12130099
                      PV-804-AUGUST                                     12140099
                      PV-804-SEPTEMBER                                  12150099
                      PV-804-OCTOBER                                    12160099
                      PV-804-NOVEMBER                                   12170099
                      PV-804-DECEMBER                                   12180099
                      PV-804-YTD                                        12190099
                      PV-805-JANUARY                                    12200099
                      PV-805-FEBRUARY                                   12210099
                      PV-805-MARCH                                      12220099
                      PV-805-APRIL                                      12230099
                      PV-805-MAY                                        12240099
                      PV-805-JUNE                                       12250099
                      PV-805-JULY                                       12260099
                      PV-805-AUGUST                                     12270099
                      PV-805-SEPTEMBER                                  12280099
                      PV-805-OCTOBER                                    12290099
                      PV-805-NOVEMBER                                   12300099
                      PV-805-DECEMBER                                   12310099
                      PV-805-YTD                                        12320099
                      PV-806-JANUARY                                    12330099
                      PV-806-FEBRUARY                                   12340099
                      PV-806-MARCH                                      12350099
                      PV-806-APRIL                                      12360099
                      PV-806-MAY                                        12370099
                      PV-806-JUNE                                       12380099
                      PV-806-JULY                                       12390099
                      PV-806-AUGUST                                     12400099
                      PV-806-SEPTEMBER                                  12410099
                      PV-806-OCTOBER                                    12420099
                      PV-806-NOVEMBER                                   12430099
                      PV-806-DECEMBER                                   12440099
                      PV-806-YTD.                                       12450099
       5400-INIT-SUBTOT-MONTHS.                                         12460099
           INITIALIZE PV-SUBTOT-JANUARY                                 12470099
                      PV-SUBTOT-FEBRUARY                                12480099
                      PV-SUBTOT-MARCH                                   12490099
                      PV-SUBTOT-APRIL                                   12500099
                      PV-SUBTOT-MAY                                     12510099
                      PV-SUBTOT-JUNE                                    12520099
                      PV-SUBTOT-JULY                                    12530099
                      PV-SUBTOT-AUGUST                                  12540099
                      PV-SUBTOT-SEPTEMBER                               12550099
                      PV-SUBTOT-OCTOBER                                 12560099
                      PV-SUBTOT-NOVEMBER                                12570099
                      PV-SUBTOT-DECEMBER                                12580099
                      PV-SUBTOT-YTD.                                    12590099
       5500-INIT-FINTOT-MONTHS.                                         12600099
           INITIALIZE PV-FINTOT-JANUARY                                 12610099
                      PV-FINTOT-FEBRUARY                                12620099
                      PV-FINTOT-MARCH                                   12630099
                      PV-FINTOT-APRIL                                   12640099
                      PV-FINTOT-MAY                                     12650099
                      PV-FINTOT-JUNE                                    12660099
                      PV-FINTOT-JULY                                    12670099
                      PV-FINTOT-AUGUST                                  12680099
                      PV-FINTOT-SEPTEMBER                               12690099
                      PV-FINTOT-OCTOBER                                 12700099
                      PV-FINTOT-NOVEMBER                                12710099
                      PV-FINTOT-DECEMBER                                12720099
                      PV-FINTOT-YTD.                                    12730099
087800****************************************************************  12740099
088200 8000-PRINT-DETAIL.                                               12750099
           ADD PV-LINE-ADVANCE        TO PV-LINE-COUNT                  12760099
           IF PS-NEW-DC                                                 12770099
               ADD +1                 TO PV-LINE-COUNT                  12780099
           END-IF                                                       12790099
           IF PV-LINE-COUNT > PC-MAX-REPORT-LINES                       12800099
               PERFORM 8100-PRINT-PAGE-HEADING                          12810099
           END-IF                                                       12820099
           IF PS-NEW-DC                                                 12830099
               PERFORM 8020-PRINT-BLANK-LINE                            12840099
               INITIALIZE PS-NEW-DC-SW                                  12850099
           END-IF                                                       12860099
           WRITE FFA-REPORT-RECORD FROM DL1-DETAIL-LINE                 12870099
           AFTER ADVANCING PV-LINE-ADVANCE                              12880099
           MOVE +1 TO PV-LINE-ADVANCE.                                  12890099
088200 8010-PRINT-LINE.                                                 12900099
           WRITE FFA-REPORT-RECORD                                      12910099
           AFTER ADVANCING PV-LINE-ADVANCE.                             12920099
088200 8020-PRINT-BLANK-LINE.                                           12930099
           WRITE FFA-REPORT-RECORD FROM PC-BLANK-LINE                   12940099
           AFTER ADVANCING 1.                                           12950099
088200 8100-PRINT-PAGE-HEADING.                                         12960099
088500     ADD +1                     TO PV-PAGE-NUMBER                 12970099
088600     MOVE +5                    TO PV-LINE-COUNT                  12980099
088700     MOVE PV-PAGE-NUMBER        TO DP132O-PAGE-NUMBER             12990099
088800     MOVE 1                     TO DP132O-REPORT-NUMBER           13000099
088900     WRITE FFA-REPORT-RECORD                                      13010099
089000         FROM DP132O-STANDRD-HEADER-132-COLS                      13020099
089100         AFTER ADVANCING PAGE                                     13030099
089200     WRITE FFA-REPORT-RECORD                                      13040099
089300         FROM HL1-HEADING-LINE                                    13050099
089400         AFTER ADVANCING 2                                        13060099
089500     WRITE FFA-REPORT-RECORD                                      13070099
089600         FROM HL2-HEADING-LINE                                    13080099
089700         AFTER ADVANCING 2.                                       13090099
091900                                                                  13100099
110100 9100-CALL-DATE-MODULE.                                           13110000
110200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            13120000
110300                           USING DPG51 DPG52 DPG53                13130000
110400                                 DPG54 DPG55 DPG56.               13140000
110500     IF  PV-PARA-NAME = '1110-SPECIAL-RUN'                        13150099
110600       AND DPG54-DATE-INVALID                                     13160099
110700         CONTINUE                                                 13170099
110900     ELSE                                                         13180099
111100         EVALUATE TRUE                                            13190099
111200             WHEN DPG54-SEVERE-ERROR                              13200099
111300                 DISPLAY '** ABEND **'                            13210099
111400                 DISPLAY '** PGM = TMKRP023'                      13220099
111500                 DISPLAY PV-PARA-NAME                             13230099
111600             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  13240099
111700                 DISPLAY '** ERROR MESSAGE = '                    13250099
111800                     DPG54-ERROR-MESSAGE                          13260099
111900                 DISPLAY '** DPG51 = ' DPG51                      13270099
112000                 DISPLAY '** DPG52 = ' DPG52                      13280099
112100                 DISPLAY '** DPG53 = ' DPG53                      13290099
112200                 DISPLAY '** DPG54 = ' DPG54                      13300099
112300                 MOVE +4003 TO PV-ABEND-CODE                      13310099
112400                 CALL 'ILBOABN0' USING PV-ABEND-CODE              13320099
112500             WHEN OTHER                                           13330099
112600                 CONTINUE                                         13340099
112700         END-EVALUATE                                             13350099
           END-IF.                                                      13360099
812900                                                                  13370099
113000 9998-SQL-ABEND.                                                  13380000
113100     MOVE SQLCODE     TO PV-SQLCODE.                              13390000
113200     DISPLAY '** ABEND           ** = SQLABEND'.                  13400000
113300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          13410000
113400     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        13420099
113500     DISPLAY '** TABLE 1         ** = ' PV-DB2-TABLE-1.           13430099
113500     DISPLAY '** TABLE 2         ** = ' PV-DB2-TABLE-2.           13440099
113600     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   13450099
113700     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   13460099
113800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               13470099
113900     COPY DPPD004.                                                13480099
114000                                                                  13490099
114100     MOVE +4013                  TO PV-ABEND-CODE.                13500099
114200     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       13510099
114400                                                                  13520099
114500 9999-ABORT.                                                      13530099
114600      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                    13540099
114700      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      13550099
114900                                                                  13560099
