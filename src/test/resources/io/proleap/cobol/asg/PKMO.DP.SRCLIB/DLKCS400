000100 TITLE 'TEMP ASSOCIATE LIST'.                                     00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    DLKCS400.                                         00030000
000400 AUTHOR.        THERESE RAMSEYER.                                 00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  DECEMBER 2003.                                    00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00070111
263627*----------------------------------------------------------------*00071011
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00072011
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00073011
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00074011
263627*----------------------------------------------------------------*00075011
009461* CHANGED 10/24/2022    BY BOB MCASEY      WR: CHG0279137         00076013
009491* ADD COPYBOOK DPWS930 CHANGE CICS ARCHITECTURE CALL TO           00077013
009491* TO USE CICS ARCHITECTURE CA                                     00078013
263627*----------------------------------------------------------------*00079013
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 DATA DIVISION.                                                   00100000
001100 WORKING-STORAGE SECTION.                                         00110000
001200                                                                  00120000
001300 01  DK-DB2-KEYS.                                                 00130000
001400     05  DK-DC-NBR                    PIC S9(04) COMP VALUE ZERO. 00140000
001500                                                                  00150000
001600                                                                  00160000
001700 01  PC-PROGRAM-CONSTANTS.                                        00170000
001800     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00180000
001900                                                    'DLK400  '.   00190000
002000     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00200000
002100                                                    'DLKM400 '.   00210000
002200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00220000
002300                                                    'DLKCS400'.   00230000
002400     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00240000
002500     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00250000
002600     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00260000
002700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00270000
002800                                                    COMP SYNC.    00280000
002900     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00290000
003000                                                    COMP SYNC.    00300000
003100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00310000
003200                                                    +1000000      00320000
003300                                                    COMP-3.       00330000
003400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00340000
003500                                                    COMP SYNC.    00350000
003600     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00360000
003700                                                    COMP-3.       00370000
003800     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00380000
003900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00390000
004000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00400000
004100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00410000
004200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00420000
004300*                                                                 00430000
004400     05  PC-TSYMSG-NUMBERS.                                       00440000
004500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00450000
004600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00460000
004700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00470000
004800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00480000
004900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00490000
005000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00500000
005100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00510000
005200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00520000
005300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00530000
005400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00540000
005500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00550000
005600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00560000
005700         10  PC-TSYMSG-01305            PIC  9(05)  VALUE 01305.  00570000
005800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00580000
005900         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00590000
006000         10  PC-TSYMSG-03181            PIC  9(05)  VALUE 03181.  00600000
006100         10  PC-TSYMSG-03184            PIC  9(05)  VALUE 03184.  00610000
006200         10  PC-TSYMSG-03185            PIC  9(05)  VALUE 03185.  00620000
006300         10  PC-TSYMSG-03186            PIC  9(05)  VALUE 03186.  00630000
006400         10  PC-TSYMSG-03199            PIC  9(05)  VALUE 03199.  00640000
006500         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00650000
006600*                                                                 00660000
006700 01  PS-PROGRAM-SWITCHES.                                         00670000
006800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00680000
006900         88  PS-NO-ERROR                            VALUE 'N'.    00690000
007000         88  PS-ERROR                               VALUE 'Y'.    00700000
007100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00710000
007200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00720000
007300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00730000
007400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00740000
007500         88  PS-DONE                                VALUE 'Y'.    00750000
007600         88  PS-NOT-DONE                            VALUE 'N'.    00760000
007700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    00770000
007800         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    00780000
007900         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    00790000
008000     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    00800000
008100         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    00810000
008200         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    00820000
008300*                                                                 00830000
008400 01  PV-PROGRAM-VARIABLES.                                        00840000
008500     05  PV-SUB                         PIC S9(04)  VALUE +0      00850000
008600                                                    COMP SYNC.    00860000
008700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00870000
008800                                                    COMP SYNC.    00880000
008900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00890000
009000                                                    COMP-3.       00900000
009100     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00910000
009200                                                    COMP-3.       00920000
009300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00930000
009400                                                    COMP-3.       00940000
009500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00950000
009600                                                    COMP-3.       00960000
009700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00970000
009800                                                    COMP-3.       00980000
009900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00990000
010000                                                    COMP-3.       01000000
010100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01010000
010200                                                    COMP-3.       01020000
010300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01030000
010400                                                    COMP SYNC.    01040000
010500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01050000
010600                                                    COMP SYNC.    01060000
010700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01070000
010800                                                    COMP SYNC.    01080000
010900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01090000
011000                                                    COMP SYNC.    01100000
011100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01110000
011200                                                    COMP SYNC.    01120000
011300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01130000
011400                                                    COMP SYNC.    01140000
011500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01150000
011600                                                    COMP SYNC.    01160000
011700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01170000
011800                                                    COMP SYNC.    01180000
011900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01190000
012000                                                    COMP SYNC.    01200000
012100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01210000
012200                                                    COMP SYNC.    01220000
012300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01230000
012400                                                    COMP SYNC.    01240000
012500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01250000
012600                                                    COMP SYNC.    01260000
012700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01270000
012800                                                    COMP SYNC.    01280000
012900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01290000
013000                                                    COMP SYNC.    01300000
013100     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01310000
013200                                                    COMP SYNC.    01320000
013300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01330000
013400                                                    COMP SYNC.    01340000
013500                                                                  01350000
013600                                                                  01360000
013700     05  PV-USER-CODE-SEQ             PIC X(24) VALUE             01370000
013800                                      '** USER CODE SEQUENCE **'. 01380000
013900     05  PV-LAST-NAME-SEQ             PIC X(24) VALUE             01390000
014000                                      '** LAST NAME SEQUENCE **'. 01400000
014100     05  PV-ALL-TEMPS                 PIC X(25) VALUE             01410000
014200                                      '   ALL TEMP ASSOCIATES   '.01420000
014300     05  PV-ALL                       PIC X(03) VALUE 'ALL'.      01430000
014400     05  PV-CORPORATE                 PIC  9(03) VALUE 090.       01440000
014500     05  PV-USER-NBR-NUMERIC          PIC S9(04) COMP.            01450000
014600     05  PV-COMMAREA-LENGTH           PIC S9(04) COMP VALUE ZERO. 01460000
014700     05  PV-SOFT-ABORT-MSG.                                       01470000
014800         10  FILLER            PIC X(12) VALUE ' DLKCS400 - '.    01480000
014900         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01490000
015000         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01500000
015100         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01510000
015200         10  PV-SOFT-PARAGRAPH PIC X(30).                         01520000
015300     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    01530000
015400                                                                  01540000
015500******************************************************************01550000
015600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01560000
015700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01570000
015800**  APPLICATION-SPECIFIC COMMAREA.                              **01580000
015900******************************************************************01590000
016000 01  LQW-LIST-QUEUE-WORK-AREA.                                    01600000
016100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01610000
016200     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           01620000
016300                                        INDEXED BY LQW-IDX.       01630000
016400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01640000
016500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01650000
016600         10  LQW-SELECTED-SW            PIC  X(01).               01660000
016700             88  LQW-SELECT                         VALUE 'S'.    01670000
016800             88  LQW-DESELECT                       VALUE ' '.    01680000
016900                                                                  01690000
017000         10  LQW-ACTION                 PIC  X(03).               01700000
017100         10  LQW-USER-CODE            PIC  X(08).                 01710000
017200         10  LQW-LAST-NAME            PIC  X(30).                 01720000
017300         10  LQW-FIRST-NAME           PIC  X(20).                 01730000
017400         10  LQW-ACTIVE               PIC  X(01).                 01740000
017500         10  LQW-DC-ADD               PIC  9(04).                 01750000
017600/                                                                 01760000
017700*---------------------------------------------------------------* 01770000
017800*  RECORD LAYOUT FOR THE TEMP ASSOC SELECTION TEMP STORAGE QUEUE.*01780000
017900*---------------------------------------------------------------* 01790000
018000                                                                  01800000
018100     COPY DLWS008.                                                01810000
018200                                                                  01820000
018300*---------------------------------------------------------------* 01830000
018400*  RECORD LAYOUT FOR THE TEMP ASSOC INFO SUB-ROUTINE            .*01840000
018500*---------------------------------------------------------------* 01850000
018600                                                                  01860000
018700     COPY XLWS067.                                                01870000
018800/                                                                 01880000
018900*---------------------------------------------------------------* 01890000
019000*    MAP LAYOUT                                                 * 01900000
019100*---------------------------------------------------------------* 01910000
019200                                                                  01920000
019300     COPY DLKM400.                                                01930000
019400*                                                                 01940000
019500 01  MR-OCCURS-LAYOUT                   REDEFINES  DLK400O.       01950000
019600     05  FILLER                         PIC X(115).               01960004
019700     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          01970000
019800         10  MR-SELECTL                 PIC S9(04) COMP.          01980000
019900         10  MR-SELECTA                 PIC  X(01).               01990000
020000         10  MR-SELECTC                 PIC  X(01).               02000000
020100         10  MR-SELECTH                 PIC  X(01).               02010000
020200         10  MR-SELECTI                 PIC  X(01).               02020000
020300                                                                  02030000
020400         10  MR-ACTIONL                 PIC S9(04) COMP.          02040000
020500         10  MR-ACTIONA                 PIC  X(01).               02050000
020600         10  MR-ACTIONC                 PIC  X(01).               02060000
020700         10  MR-ACTIONH                 PIC  X(01).               02070000
020800         10  MR-ACTION                  PIC  X(03).               02080000
020900                                                                  02090000
021000         10  MR-USER-CODE-L           PIC S9(04) COMP.            02100000
021100         10  MR-USER-CODEA            PIC  X(01).                 02110000
021200         10  MR-USER-CODEC            PIC  X(01).                 02120000
021300         10  MR-USER-CODEH            PIC  X(01).                 02130000
021400         10  MR-USER-CODE             PIC  X(08).                 02140000
021500                                                                  02150000
021600         10  MR-LAST-NAME-L           PIC S9(04) COMP.            02160000
021700         10  MR-LAST-NAMEA            PIC  X(01).                 02170000
021800         10  MR-LAST-NAMEC            PIC  X(01).                 02180000
021900         10  MR-LAST-NAMEH            PIC  X(01).                 02190000
022000         10  MR-LAST-NAME             PIC  X(30).                 02200000
022100                                                                  02210000
022200         10  MR-FIRST-NAME-L          PIC S9(04) COMP.            02220000
022300         10  MR-FIRST-NAMEA           PIC  X(01).                 02230000
022400         10  MR-FIRST-NAMEC           PIC  X(01).                 02240000
022500         10  MR-FIRST-NAMEH           PIC  X(01).                 02250000
022600         10  MR-FIRST-NAME            PIC  X(20).                 02260000
022700                                                                  02270000
022800         10  MR-ACTIVE-L              PIC S9(04) COMP.            02280000
022900         10  MR-ACTIVEA               PIC  X(01).                 02290000
023000         10  MR-ACTIVEC               PIC  X(01).                 02300000
023100         10  MR-ACTIVEH               PIC  X(01).                 02310000
023200         10  MR-ACTIVE                PIC  X(01).                 02320000
023300                                                                  02330000
023400         10  MR-DC-ADD-L              PIC S9(04) COMP.            02340000
023500         10  MR-DC-ADDA               PIC  X(01).                 02350000
023600         10  MR-DC-ADDC               PIC  X(01).                 02360000
023700         10  MR-DC-ADDH               PIC  X(01).                 02370000
023800         10  MR-DC-ADD                PIC  Z(04).                 02380000
023900/                                                                 02390000
024000*---------------------------------------------------------------* 02400000
024100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02410000
024200*---------------------------------------------------------------* 02420000
024300                                                                  02430000
024400     COPY DPWS015.                                                02440000
024500                                                                  02450000
024600*---------------------------------------------------------------* 02460000
024700*    FUNCTION KEYS COPYBOOK.                                    * 02470000
024800*---------------------------------------------------------------* 02480000
024900                                                                  02490000
025000     COPY DPWS016.                                                02500000
025100                                                                  02510000
025200*---------------------------------------------------------------* 02520000
025300*    NUMERIC EDIT LAYOUT.                                       * 02530000
025400*---------------------------------------------------------------* 02540000
025500                                                                  02550000
025600     COPY DPWS010I.                                               02560000
025700                                                                  02570000
025800*---------------------------------------------------------------* 02580000
025900*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 02590000
026000*---------------------------------------------------------------* 02600000
026100                                                                  02610000
026200     COPY DPWS030.                                                02620000
1022RM     COPY DPWS930.                                                02621012
026300                                                                  02630000
026400*---------------------------------------------------------------* 02640000
026500*    STANDARD COMMAREA.                                         * 02650000
026600*---------------------------------------------------------------* 02660000
026700                                                                  02670000
026800     COPY DPWS020.                                                02680000
026900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02690000
027000                                                                  02700000
027100*---------------------------------------------------------------* 02710000
027200* INTER-APPLICATION COMMAREA.                                   * 02720000
027300*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02730000
027400*             SPEC SCREEN.                                      * 02740000
027500*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02750000
027600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02760000
027700*---------------------------------------------------------------* 02770000
027800                                                                  02780000
027900         10  INTER-APPL-COMM-AREA       PIC X(200).               02790000
028000     COPY DLWS002.                                                02800000
028100*---------------------------------------------------------------* 02810000
028200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02820000
028300*---------------------------------------------------------------* 02830000
028400         10  ASC-SPECIFIC-COMMAREA.                               02840000
028500             15  ASC-LIST-KEYS.                                   02850000
028600                 20  ASC-KEY-OPER-UNT-ID                          02860000
028700                                      PIC S9(05) COMP.            02870000
028800                 20  ASC-KEY-OPER-DESC                            02880000
028900                                      PIC X(40).                  02890000
029000                                                                  02900000
029100             15  ASC-KEYS-BEFORE-SORT.                            02910000
029200                 20  ASC-OPER-UNT-ID-ORIG                         02920000
029300                                      PIC S9(05) COMP.            02930000
029400                 20  ASC-OPER-DESC-ORIG                           02940000
029500                                      PIC X(40).                  02950000
029600                                                                  02960000
029700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02970000
029800                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  02980000
029900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   02990000
030000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03000000
030100                                                                  03010000
030200                 20  ASC-ITEM-ARRAY.                              03020000
030300                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        03030000
030400                         30  ASC-LIST-ITEM-NUMBER                 03040000
030500                                                     PIC S9(09)   03050000
030600                                                     COMP-3.      03060000
030700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03070000
030800                             88  ASC-VALID-SELECT    VALUE ' '    03080000
030900                                                           'S'    03090000
031000                                                           'B'    03100000
031100                                                           'E'.   03110000
031200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03120000
031300                             88  ASC-TEMP-SELECT     VALUE 'S'.   03130000
031400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03140000
031500                             88  ASC-TEMP-END        VALUE 'E'.   03150000
031600                         30  ASC-SELECTED-SW         PIC  X(01).  03160000
031700                             88  ASC-NO-SELECT       VALUE ' '.   03170000
031800                             88  ASC-SELECT          VALUE 'S'.   03180000
031900                             88  ASC-BEGIN           VALUE 'B'.   03190000
032000                             88  ASC-END             VALUE 'E'.   03200000
032100                         30  ASC-ACTION               PIC  X(03). 03210000
032200                                                                  03220000
032300                         30  ASC-USER-CODE            PIC  X(08). 03230000
032400                         30  ASC-LAST-NAME            PIC  X(30). 03240000
032500                         30  ASC-FIRST-NAME           PIC  X(20). 03250000
032600                         30  ASC-ACTIVE               PIC  X(01). 03260000
032700                         30  ASC-DC-ADD               PIC  9(04). 03270000
032800                                                                  03280000
032900             15  ASC-BLK-SUB                         PIC S9(04)   03290000
033000                                                          COMP    03300000
033100                                                          SYNC.   03310000
033200             15  ASC-ITEM-SUB                        PIC S9(04)   03320000
033300                                                          COMP    03330000
033400                                                          SYNC.   03340000
033500             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   03350000
033600                                                          COMP-3. 03360000
033700             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03370000
033800                                                          COMP-3. 03380000
033900             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03390000
034000                                                          COMP-3. 03400000
034100             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03410000
034200                                                          COMP-3. 03420000
034300             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03430000
034400                                                          COMP-3. 03440000
034500             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03450000
034600                                                          COMP    03460000
034700                                                          SYNC.   03470000
034800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03480000
034900                                                          COMP-3. 03490000
035000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03500000
035100                                                          COMP-3. 03510000
035200             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03520000
035300                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03530000
035400                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03540000
035500             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03550000
035600                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03560000
035700                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03570000
035800             15  ASC-LIST-QUEUE-NAME.                             03580000
035900                 20  ASC-LIST-TERM-ID                PIC  X(04).  03590000
036000                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03600000
036100                                                          COMP-3. 03610000
036200                 20  ASC-LIST-SEQ                    PIC  9(01).  03620000
036300             15  ASC-SEL-QUEUE-NAME.                              03630000
036400                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03640000
036500                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   03650000
036600                                                          COMP-3. 03660000
036700                 20  ASC-SEL-SEQ                     PIC  9(01).  03670000
036800                                                                  03680000
036900             15  ASC-OPER-UNT-ID-NS                  PIC  9(05).  03690000
037000             15  ASC-OPER-UNT-ID-TXT                 PIC  X(05).  03700000
037100             15  ASC-CURSOR-SW                       PIC  X(01).  03710000
037200                 88  ASC-NO-CURSOR                   VALUE 'Z'.   03720000
037300                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   03730000
037400                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   03740000
037500                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   03750000
037600             15  ASC-SIGNON-SW                       PIC X(01).   03760000
037700                 88  ASC-CORPORATE-SIGNON            VALUE 'C'.   03770000
037800                 88  ASC-NON-CORPORATE-SIGNON        VALUE 'N'.   03780000
037900             15  ASC-SEQUENCE-SW.                                 03790000
038000                 20  ASC-SORT-SEQUENCE               PIC  X(01).  03800000
038100                     88  ASC-USER-CODE-SEQ           VALUE 'U'.   03810000
038200                     88  ASC-LAST-NAME-SEQ           VALUE 'L'.   03820000
038300             15  ASC-LIST-SW.                                     03830000
038400                 20  ASC-LIST-DISPLAY                PIC  X(01).  03840000
038500                     88  ASC-DC-LIST-DISPLAY         VALUE 'D'.   03850000
038600                     88  ASC-ALL-LIST-DISPLAY        VALUE 'A'.   03860000
038700             15  ASC-START-ITEM-REQUEST.                          03870000
038800                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  03880000
038900             15  ASC-FUNCTION-SW                     PIC X(01).   03890000
039000                 88  ASC-ADD-FUNCTION                VALUE 'A'.   03900000
039100                 88  ASC-UPDATE-FUNCTION             VALUE 'U'.   03910000
039200                 88  ASC-INQUIRY-FUNCTION            VALUE 'I'.   03920000
039300                 88  ASC-OTHER-FUNCTION              VALUE 'O'.   03930000
039400/                                                                 03940000
039500*---------------------------------------------------------------* 03950000
039600*    ABEND PROCESSING COPYBOOK.                                 * 03960000
039700*---------------------------------------------------------------* 03970000
039800                                                                  03980000
039900     COPY DPWS013.                                                03990000
040000*----------------------------------------------------------------*04000000
040100**  SECURITY SUBROUTINE PARAMETERS                                04010000
040200*----------------------------------------------------------------*04020000
040300     COPY DPWS008.                                                04030000
040400                                                                  04040000
040500/                                                                 04050000
040600*    DLT_TMP_EMP                                                  04060000
040700     EXEC SQL                                                     04070000
040800          INCLUDE DLT00002                                        04080000
040900     END-EXEC.                                                    04090000
041000                                                                  04100000
041100*    XLT_LOC                                                      04110000
041200     EXEC SQL                                                     04120000
041300          INCLUDE XLT00010                                        04130000
041400     END-EXEC.                                                    04140000
041500                                                                  04150000
041600*    DB2 AREA FOR COMMUNICATIONS                                * 04160000
041700     EXEC SQL                                                     04170000
041800          INCLUDE SQLCA                                           04180000
041900     END-EXEC.                                                    04190000
042000/                                                                 04200000
042100*    USER-CODE CURSOR FOR DC NBR                                  04210000
042200     EXEC SQL                                                     04220000
042300         DECLARE USER-CODE-DC-CSR CURSOR FOR                      04230000
042400             SELECT  TMP.TMP_USR_ID                               04240000
042500                 ,   TMP.DC_NBR                                   04250000
042600                 ,   TMP.FRST_NM                                  04260000
042700                 ,   TMP.LAST_NM                                  04270000
042800                 ,   TMP.ACTV_IND                                 04280000
042900             FROM   DLT_TMP_EMP TMP                               04290000
043000             WHERE   TMP.DC_NBR  = :DK-DC-NBR                     04300000
043100             ORDER BY SMALLINT(REPLACE(TMP.TMP_USR_ID,'TP','0'))  04310008
043200     END-EXEC.                                                    04320000
043300                                                                  04330000
043400*    USER-CODE CURSOR FOR ALL TEMP ASSOCS                         04340000
043500     EXEC SQL                                                     04350000
043600         DECLARE USER-CODE-ALL-CSR CURSOR FOR                     04360000
043700             SELECT  TMP.TMP_USR_ID                               04370000
043800                 ,   TMP.DC_NBR                                   04380000
043900                 ,   TMP.FRST_NM                                  04390000
044000                 ,   TMP.LAST_NM                                  04400000
044100                 ,   TMP.ACTV_IND                                 04410000
044200             FROM   DLT_TMP_EMP TMP                               04420000
044300             ORDER BY SMALLINT(REPLACE(TMP.TMP_USR_ID,'TP','0'))  04430008
044400     END-EXEC.                                                    04440000
044500                                                                  04450000
044501******Ù                                                           04460009
044510*NOTE: THE ORDER BY CLAUSE FOR THE CURSOR BOTH ABOVE AND BELOW    04470009
044520****** IS DEFINED TO ORDER THE ID'S ACCORDING TO THE FOLLOWING    04480009
044530*      PATTERN: TP1, TP2, ..., TP10, ETC. IF THERE IS A  CSR      04490010
044540*      PROBLEM, FIRST CHECK TO MAKE SURE THAT ALL OF THE ID'S     04500010
044550*      IN THE TEST TABLE ARE FOLLOWING THE PATTERN AND DO NOT HAVE04510010
044560*      LEADING SPACES OR ZEROES OR USE 'TEMP' INSTEAD OF 'TP'.    04520010
044570                                                                  04530009
044600*    LAST-NAME CURSOR FOR DC NBR                                  04540000
044700     EXEC SQL                                                     04550000
044800         DECLARE LAST-NAME-DC-CSR CURSOR FOR                      04560000
044900             SELECT  TMP.TMP_USR_ID                               04570000
045000                 ,   TMP.DC_NBR                                   04580000
045100                 ,   TMP.FRST_NM                                  04590000
045200                 ,   TMP.LAST_NM                                  04600000
045300                 ,   TMP.ACTV_IND                                 04610000
045400             FROM   DLT_TMP_EMP TMP                               04620000
045500             WHERE   TMP.DC_NBR  = :DK-DC-NBR                     04630000
045600             ORDER BY TMP.LAST_NM ASC                             04640000
045700                     ,TMP.FRST_NM ASC                             04650000
045800     END-EXEC.                                                    04660000
045900                                                                  04670000
046000*    LAST-NAME CURSOR FOR ALL TEMP ASSOCS                         04680000
046100     EXEC SQL                                                     04690000
046200         DECLARE LAST-NAME-ALL-CSR CURSOR FOR                     04700000
046300             SELECT  TMP.TMP_USR_ID                               04710000
046400                 ,   TMP.DC_NBR                                   04720000
046500                 ,   TMP.FRST_NM                                  04730000
046600                 ,   TMP.LAST_NM                                  04740000
046700                 ,   TMP.ACTV_IND                                 04750000
046800             FROM   DLT_TMP_EMP TMP                               04760000
046900             ORDER BY TMP.LAST_NM ASC                             04770000
047000                     ,TMP.FRST_NM ASC                             04780000
047100     END-EXEC.                                                    04790000
047200                                                                  04800000
047300 EJECT                                                            04810000
047400 LINKAGE SECTION.                                                 04820000
047500                                                                  04830000
047600 01  DFHCOMMAREA.                                                 04840000
047700     05  FILLER                         OCCURS  1 TO 4072 TIMES   04850000
047800                                        DEPENDING ON EIBCALEN.    04860000
047900         10  FILLER                     PIC X.                    04870000
048000                                                                  04880000
048100/                                                                 04890000
048200 PROCEDURE DIVISION.                                              04900000
048300******************************************************************04910000
048400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04920000
048500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04930000
048600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04940000
048700******************************************************************04950000
048800 0000-MAIN-MODULE.                                                04960000
048900     INITIALIZE DP030-CICS-API-FIELDS.                            04970000
049000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04980000
049100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04990000
049200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05000000
049300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05010000
049400     MOVE LENGTH OF DLK400I        TO DP030-MAP-LENGTH (1).       05020000
049500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05030000
049600     PERFORM 0001-CALL-CICS-ARCH-API.                             05040000
049700*                                                                 05050000
049800     PERFORM 1000-CONTROL-PROCESSING                              05060000
049900*                                                                 05070000
050000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05080000
050100     PERFORM 0001-CALL-CICS-ARCH-API.                             05090000
050200                                                                  05100000
050300******************************************************************05110000
050400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05120000
050500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05130000
050600******************************************************************05140000
050700 0001-CALL-CICS-ARCH-API.                                         05150000
050800     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     05160012
050900                                     DFHCOMMAREA                  05170012
051000                                     DP030-CICS-API-FIELDS        05180012
051100                                     DP020-STANDARD-COMMAREA      05190012
051200                                     DLK400I.                     05200012
051300*                                                                 05210000
051400     IF  DP030-RC-CALL-SUCCESSFUL                                 05220000
051500         CONTINUE                                                 05230000
051600     ELSE                                                         05240000
051700         SET DP013-NO-ROLLBACK                                    05250000
051800             DP013-XCTL-DISPLAY-RESTART                           05260000
051900             DP013-CICS-ABEND      TO TRUE                        05270000
052000         MOVE '0001-CALL-CICS-ARCH-API'                           05280000
052100                                   TO DP013-PARAGRAPH             05290000
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05311012
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05312012
052400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05320000
052500         PERFORM DP013-0000-PROCESS-ABEND                         05330000
052600     END-IF.                                                      05340000
052700*----------------------------------------------------------------*05350000
052800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05360000
052900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05370000
053000*                                                                *05380000
053100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05390000
053200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05400000
053300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05410000
053400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05420000
053500*----------------------------------------------------------------*05430000
053600                                                                  05440000
053700 1000-CONTROL-PROCESSING.                                         05450000
053800                                                                  05460000
053900     EVALUATE TRUE                                                05470000
054000         WHEN DP020-NEXT-ACT-INITIAL                              05480000
054100             INITIALIZE ASC-SPECIFIC-COMMAREA                     05490000
054200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05500000
054300                                      ASC-SEL-TERM-ID             05510000
054400             MOVE DP020-SRC-TASK-NUMBER                           05520000
054500                                   TO ASC-LIST-TASK-NUMBER        05530000
054600                                      ASC-SEL-TASK-NUMBER         05540000
054700             MOVE PC-LIST-QUEUE-SEQ                               05550000
054800                                   TO ASC-LIST-SEQ                05560000
054900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 05570000
055000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05580000
055100***-----$TEMPLATE NOTE$-------------------------------------------05590000
055200*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05600000
055300*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05610000
055400*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05620000
055500***---------------------------------------------------------------05630000
055600             IF  PS-COMMAREA-NOT-VALID                            05640000
055700***              MOVE PC-TSYMSG-99901                             05650000
055800***                                TO DP020-MSG-NUMBER            05660000
055900***              SET DP020-MSG-FATAL                              05670000
056000***                                TO TRUE                        05680000
056100                 SET DP020-NEXT-ACT-APPL-ERROR                    05690000
056200                                   TO TRUE                        05700000
056300             ELSE                                                 05710000
056400                IF ASC-USER-CODE-SEQ                              05720000
056500                   MOVE PV-USER-CODE-SEQ  TO ASEQMSGO             05730000
056600                   PERFORM 4000U-BUILD-INITIAL-PANEL              05740000
056700                ELSE                                              05750000
056800                   MOVE PV-LAST-NAME-SEQ  TO ASEQMSGO             05760000
056900                   PERFORM 4000L-BUILD-INITIAL-PANEL              05770000
057000                END-IF                                            05780000
057100             END-IF                                               05790000
057200                                                                  05800000
057300         WHEN DP020-NEXT-ACT-READ-MAP                             05810000
057400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05820000
057500                                   TO PV-TOP-ITEM                 05830000
057600             PERFORM 2000-PROCESS-PANEL                           05840000
057700                                                                  05850000
057800         WHEN DP020-NEXT-ACT-RETURN                               05860000
057900                                                                  05870000
058000             IF ASC-ADD-FUNCTION OR ASC-UPDATE-FUNCTION           05880000
058100                 MOVE ASC-KEY-OPER-UNT-ID                         05890000
058200                                       TO DK-DC-NBR               05900000
058300                 PERFORM 2050-DELETE-LIST-QUEUE                   05910000
058400                 IF ASC-USER-CODE-SEQ                             05920000
058500                    MOVE PV-USER-CODE-SEQ  TO ASEQMSGO            05930000
058600                    PERFORM 4000U-BUILD-INITIAL-PANEL             05940000
058700                 ELSE                                             05950000
058800                    MOVE PV-LAST-NAME-SEQ  TO ASEQMSGO            05960000
058900                    PERFORM 4000L-BUILD-INITIAL-PANEL             05970000
059000                 END-IF                                           05980000
059100             ELSE                                                 05990000
059200                 MOVE ASC-ITEM-AT-TOP-OF-PANEL                    06000000
059300                                      TO PV-TOP-ITEM              06010000
059400                 MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL 06020000
059500                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             06030000
059600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06040000
059700             END-IF                                               06050000
059800                                                                  06060000
059900         WHEN OTHER                                               06070000
060000             SET DP013-LOGIC-ABEND TO TRUE                        06080000
060100             SET DP013-NO-ROLLBACK TO TRUE                        06090000
060200             MOVE '1000-CONTROL-PROCESSING'                       06100000
060300                                   TO DP013-PARAGRAPH             06110000
060400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06120000
060500                                   TO DP013-MESSAGE-TEXT(1)       06130000
060600             PERFORM DP013-0000-PROCESS-ABEND                     06140000
060700     END-EVALUATE.                                                06150000
060800                                                                  06160000
060900 EJECT                                                            06170000
061000*----------------------------------------------------------------*06180000
061100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06190000
061200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06200000
061300*----------------------------------------------------------------*06210000
061400                                                                  06220000
061500 1100-PROCESS-INTER-APPL-COMM.                                    06230000
061600                                                                  06240000
061700     SET PS-COMMAREA-VALID         TO TRUE.                       06250000
061800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06260000
061900                                                                  06270000
062000     MOVE DP020-LOCATION-NBR          TO DK-DC-NBR                06280006
062100                                         DL002-OPER-UNT-ID        06290000
062200                                         ADCO                     06300000
062300                                         ASC-KEY-OPER-UNT-ID      06310000
062400                                         ASC-OPER-UNT-ID-ORIG.    06320000
062500                                                                  06330000
062600     PERFORM 7010-LOCATION-DESC.                                  06340000
062700                                                                  06350000
062800     IF DP020-LOCATION-NBR = PV-CORPORATE                         06360006
062900        MOVE PV-ALL-TEMPS  TO ASC-KEY-OPER-DESC                   06370000
063000        MOVE PV-ALL        TO ASC-OPER-UNT-ID-TXT                 06380000
063100     END-IF.                                                      06390000
063200                                                                  06400000
063300     MOVE ASC-KEY-OPER-DESC           TO ADCNMEO.                 06410000
063400     MOVE PV-USER-CODE-SEQ            TO ASEQMSGO.                06420000
063500*    USER CODE SEQUENCE IS DEFAULT                                06430000
063600     SET ASC-USER-CODE-SEQ                                        06440000
063700         DL002-SORT-SEQ-USER-CODE     TO TRUE.                    06450000
063800*    CORPORATE SIGNON WILL AUTOMATICALLY DISPLAY ALL TEMP ASSOCS  06460000
063900     IF DP020-LOCATION-NBR = PV-CORPORATE                         06470006
064000        SET ASC-ALL-LIST-DISPLAY                                  06480000
064100            ASC-CORPORATE-SIGNON      TO TRUE                     06490000
064200     ELSE                                                         06500000
064300        SET ASC-DC-LIST-DISPLAY                                   06510000
064400            ASC-NON-CORPORATE-SIGNON  TO TRUE                     06520000
064500     END-IF.                                                      06530000
064600                                                                  06540000
064700 EJECT                                                            06550000
064800*----------------------------------------------------------------*06560000
064900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06570000
065000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06580000
065100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06590000
065200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06600000
065300* FUNCTION KEYS CAN GET THIS FAR.                                *06610000
065400*----------------------------------------------------------------*06620000
065500                                                                  06630000
065600 2000-PROCESS-PANEL.                                              06640000
065700     EVALUATE TRUE                                                06650000
065800         WHEN DP020-SRC-AID = DP016-CLEAR                         06660000
065900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06670000
066000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06680000
066100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06690000
066200                                                                  06700000
066300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06710000
066400             MOVE ASC-KEY-OPER-UNT-ID                             06720000
066500                                   TO DK-DC-NBR                   06730000
066600             PERFORM 2050-DELETE-LIST-QUEUE                       06740000
066700             SET ASC-USER-CODE-SEQ                                06750000
066800                 DL002-SORT-SEQ-USER-CODE TO TRUE                 06760000
066900             PERFORM 4000U-BUILD-INITIAL-PANEL                    06770000
067000                                                                  06780000
067100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    06790000
067200             PERFORM 2140-DESELECT-ALL-ITEMS                      06800000
067300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06810000
067400                                                                  06820000
067500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  06830000
067600             PERFORM 2150-SELECT-ALL-ITEMS                        06840000
067700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06850000
067800                                                                  06860000
067900         WHEN OTHER                                               06870000
068000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06880000
068100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06890000
068200             IF  PS-NO-ERROR                                      06900000
068300                 SET DP030-CONTINUE-GO                            06910000
068400                                 TO TRUE                          06920000
068500                 PERFORM 2100-CHECK-FUNCTION-KEY                  06930000
068600             ELSE                                                 06940000
068700                 SET DP030-OVERRIDE-GO                            06950000
068800                                 TO TRUE                          06960000
068900             END-IF                                               06970000
069000     END-EVALUATE.                                                06980000
069100 EJECT                                                            06990000
069200*----------------------------------------------------------------*07000000
069300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07010000
069400*----------------------------------------------------------------*07020000
069500 2050-DELETE-LIST-QUEUE.                                          07030000
069600                                                                  07040000
069700     EXEC CICS                                                    07050000
069800         DELETEQ TS                                               07060000
069900             QUEUE (ASC-LIST-QUEUE-NAME)                          07070000
070000             RESP  (PV-CICS-RESP)                                 07080000
070100     END-EXEC.                                                    07090000
070200                                                                  07100000
070300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07110000
070400        (PV-CICS-RESP = DFHRESP(QIDERR))                          07120000
070500         CONTINUE                                                 07130000
070600     ELSE                                                         07140000
070700         SET DP013-CICS-ABEND      TO TRUE                        07150000
070800         SET DP013-NO-ROLLBACK     TO TRUE                        07160000
070900                                                                  07170000
071000         MOVE '2050-DELETE-LIST-QUEUE'                            07180000
071100                                   TO DP013-PARAGRAPH             07190000
071200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07200000
071300                                   TO DP013-MESSAGE-TEXT (1)      07210000
071400         PERFORM DP013-0000-PROCESS-ABEND                         07220000
071500     END-IF.                                                      07230000
071600                                                                  07240000
071700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  07250000
071800/                                                                 07260000
071900*----------------------------------------------------------------*07270000
072000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*07280000
072100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *07290000
072200* CICS ARCHITECTURE API.                                         *07300000
072300*----------------------------------------------------------------*07310000
072400 2100-CHECK-FUNCTION-KEY.                                         07320000
072500                                                                  07330000
072600     IF ASC-USER-CODE-SEQ                                         07340000
072700        MOVE PV-USER-CODE-SEQ  TO ASEQMSGO                        07350000
072800        SET DL002-SORT-SEQ-USER-CODE TO TRUE                      07360000
072900     ELSE                                                         07370000
073000        MOVE PV-LAST-NAME-SEQ  TO ASEQMSGO                        07380000
073100        SET DL002-SORT-SEQ-LAST-NAME TO TRUE                      07390000
073200     END-IF.                                                      07400000
073300                                                                  07410000
073400     EVALUATE TRUE                                                07420000
073500         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               07430000
073600*            ADD (DLKCS401)                                       07440000
073700             SET ASC-ADD-FUNCTION     TO TRUE                     07450000
073800                                                                  07460000
073900         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               07470000
074000*            INQUIRY (DLKCS403)                                   07480000
074100             SET ASC-INQUIRY-FUNCTION  TO TRUE                    07490000
074200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07500000
074300                 INITIALIZE DL002-INTER-APPL-COMMAREA             07510000
074400                 MOVE ASC-OPER-UNT-ID-ORIG  TO DL002-OPER-UNT-ID  07520000
074500                 MOVE ASC-OPER-DESC-ORIG    TO DL002-OPER-DESC    07530000
074600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                07540000
074700                                TO DL002-NUMBER-OF-SELECTED-ITEMS 07550000
074800                 PERFORM 5000-PREPARE-SEL-QUEUE                   07560000
074900             ELSE                                                 07570000
075000                 SET DP030-OVERRIDE-GO                            07580000
075100                                   TO TRUE                        07590000
075200                 MOVE PC-TSYMSG-00057                             07600000
075300                                   TO DP020-MSG-NUMBER            07610000
075400                 SET DP020-MSG-WARNING                            07620000
075500                                   TO TRUE                        07630000
075600             END-IF                                               07640000
075700                                                                  07650000
075800                                                                  07660000
075900         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               07670000
076000*            UPDATE (DLKCS402)                                    07680000
076100             SET ASC-OTHER-FUNCTION   TO TRUE                     07690000
076200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07700000
076300                 INITIALIZE DL002-INTER-APPL-COMMAREA             07710000
076400                 MOVE ASC-OPER-UNT-ID-ORIG  TO DL002-OPER-UNT-ID  07720000
076500                 MOVE ASC-OPER-DESC-ORIG    TO DL002-OPER-DESC    07730000
076600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                07740000
076700                                TO DL002-NUMBER-OF-SELECTED-ITEMS 07750000
076800                 PERFORM 5000-PREPARE-SEL-QUEUE                   07760000
076900             ELSE                                                 07770000
077000                 SET DP030-OVERRIDE-GO                            07780000
077100                                   TO TRUE                        07790000
077200                 MOVE PC-TSYMSG-00057                             07800000
077300                                   TO DP020-MSG-NUMBER            07810000
077400                 SET DP020-MSG-WARNING                            07820000
077500                                   TO TRUE                        07830000
077600             END-IF                                               07840000
077700                                                                  07850000
077800         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               07860000
077900*            DC LIST PF17                                         07870000
078000             SET ASC-OTHER-FUNCTION   TO TRUE                     07880000
078100             PERFORM 2050-DELETE-LIST-QUEUE                       07890000
078200             EVALUATE TRUE                                        07900000
078300                WHEN ASC-ALL-LIST-DISPLAY                         07910000
078400                 AND ASC-CORPORATE-SIGNON                         07920000
078500                 AND ASC-USER-CODE-SEQ                            07930000
078600                     PERFORM 4000U-BUILD-INITIAL-PANEL            07940000
078700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07950000
078800                                                                  07960000
078900                WHEN ASC-ALL-LIST-DISPLAY                         07970000
079000                 AND ASC-CORPORATE-SIGNON                         07980000
079100                 AND ASC-LAST-NAME-SEQ                            07990000
079200                     PERFORM 4000L-BUILD-INITIAL-PANEL            08000000
079300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08010000
079400                                                                  08020000
079500                WHEN ASC-USER-CODE-SEQ                            08030000
079600                     SET ASC-DC-LIST-DISPLAY TO TRUE              08040000
079700                     PERFORM 4000U-BUILD-INITIAL-PANEL            08050000
079800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08060000
079900                                                                  08070000
080000                WHEN ASC-LAST-NAME-SEQ                            08080000
080100                     SET ASC-DC-LIST-DISPLAY TO TRUE              08090000
080200                     PERFORM 4000L-BUILD-INITIAL-PANEL            08100000
080300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08110000
080400                                                                  08120000
080500             END-EVALUATE                                         08130000
080600                                                                  08140000
080700         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               08150000
080800*            ALL TEMPS  PF23                                      08160000
080900             SET ASC-OTHER-FUNCTION                               08170000
081000                 ASC-ALL-LIST-DISPLAY TO TRUE                     08180000
081100             PERFORM 2050-DELETE-LIST-QUEUE                       08190000
081200             EVALUATE TRUE                                        08200000
081300                WHEN ASC-USER-CODE-SEQ                            08210000
081400                     PERFORM 4000U-BUILD-INITIAL-PANEL            08220000
081500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08230000
081600                                                                  08240000
081700                WHEN ASC-LAST-NAME-SEQ                            08250000
081800                     PERFORM 4000L-BUILD-INITIAL-PANEL            08260000
081900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08270000
082000                                                                  08280000
082100             END-EVALUATE                                         08290000
082200                                                                  08300000
082300         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               08310000
082400*            CHANGE SORT  PF24                                    08320000
082500             SET ASC-OTHER-FUNCTION   TO TRUE                     08330000
082600             PERFORM 2050-DELETE-LIST-QUEUE                       08340000
082700             EVALUATE TRUE                                        08350000
082800                WHEN ASC-USER-CODE-SEQ                            08360000
082900                 AND ASC-DC-LIST-DISPLAY                          08370000
083000                     MOVE PV-LAST-NAME-SEQ  TO ASEQMSGO           08380000
083100                     SET ASC-LAST-NAME-SEQ                        08390000
083200                         DL002-SORT-SEQ-LAST-NAME TO TRUE         08400000
083300                     PERFORM 4000L-BUILD-INITIAL-PANEL            08410000
083400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08420000
083500                                                                  08430000
083600                WHEN ASC-LAST-NAME-SEQ                            08440000
083700                 AND ASC-DC-LIST-DISPLAY                          08450000
083800                     MOVE PV-USER-CODE-SEQ  TO ASEQMSGO           08460000
083900                     SET ASC-USER-CODE-SEQ                        08470000
084000                         DL002-SORT-SEQ-USER-CODE TO TRUE         08480000
084100                     PERFORM 4000U-BUILD-INITIAL-PANEL            08490000
084200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08500000
084300                                                                  08510000
084400                WHEN ASC-USER-CODE-SEQ                            08520000
084500                 AND ASC-ALL-LIST-DISPLAY                         08530000
084600                     MOVE PV-LAST-NAME-SEQ    TO ASEQMSGO         08540000
084700                     MOVE PV-ALL-TEMPS        TO ADCNMEO          08550000
084800                     SET ASC-LAST-NAME-SEQ                        08560000
084900                         DL002-SORT-SEQ-LAST-NAME TO TRUE         08570000
085000                     PERFORM 4000L-BUILD-INITIAL-PANEL            08580000
085100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08590000
085200                                                                  08600000
085300                WHEN ASC-LAST-NAME-SEQ                            08610000
085400                 AND ASC-ALL-LIST-DISPLAY                         08620000
085500                     MOVE PV-USER-CODE-SEQ    TO ASEQMSGO         08630000
085600                     MOVE PV-ALL-TEMPS        TO ADCNMEO          08640000
085700                     SET ASC-USER-CODE-SEQ                        08650000
085800                         DL002-SORT-SEQ-USER-CODE TO TRUE         08660000
085900                     PERFORM 4000U-BUILD-INITIAL-PANEL            08670000
086000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08680000
086100                                                                  08690000
086200             END-EVALUATE                                         08700000
086300                                                                  08710000
086400         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  08720000
086500             SET ASC-OTHER-FUNCTION   TO TRUE                     08730000
086600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              08740000
086700                 INITIALIZE DL002-INTER-APPL-COMMAREA             08750000
086800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                08760000
086900                                TO DL002-NUMBER-OF-SELECTED-ITEMS 08770000
087000                 PERFORM 5000-PREPARE-SEL-QUEUE                   08780000
087100             ELSE                                                 08790000
087200                 SET DP030-OVERRIDE-GO                            08800000
087300                                   TO TRUE                        08810000
087400                 MOVE PC-TSYMSG-00057                             08820000
087500                                   TO DP020-MSG-NUMBER            08830000
087600                 SET DP020-MSG-WARNING                            08840000
087700                                   TO TRUE                        08850000
087800             END-IF                                               08860000
087900                                                                  08870000
088000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  08880000
088100             MOVE +1               TO PV-TOP-ITEM                 08890000
088200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08900000
088300                                                                  08910000
088400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   08920000
088500             PERFORM 2110-BROWSE-BACKWARD                         08930000
088600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08940000
088700                                                                  08950000
088800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   08960000
088900             PERFORM 2120-BROWSE-FORWARD                          08970000
089000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08980000
089100                                                                  08990000
089200         WHEN DP020-SRC-AID = DP016-ENTER                         09000000
089300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09010000
089400             IF  PS-ERROR                                         09020000
089500                 CONTINUE                                         09030000
089600             ELSE                                                 09040000
089700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09050000
089800             END-IF                                               09060000
089900                                                                  09070000
090000         WHEN OTHER                                               09080000
090100             SET DP013-NO-ROLLBACK                                09090000
090200                 DP013-XCTL-DISPLAY-RESTART                       09100000
090300                 DP013-CICS-ABEND  TO TRUE                        09110000
090400             MOVE '2100-CHECK-FUNCTION-KEY'                       09120000
090500                                   TO DP013-PARAGRAPH             09130000
090600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09140000
090700                                   TO DP013-MESSAGE-TEXT (1)      09150000
090800             PERFORM DP013-0000-PROCESS-ABEND                     09160000
090900     END-EVALUATE.                                                09170000
091000                                                                  09180000
091100/                                                                 09190000
091200*----------------------------------------------------------------*09200000
091300* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     09210000
091400*----------------------------------------------------------------*09220000
091500 2105-RACF-ACCESS.                                                09230000
091600                                                                  09240000
091700      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  09250000
091800      SET DP008-ACCESS-TYPE-USE          TO TRUE                  09260000
091900                                                                  09270000
092000      EXEC CICS                                                   09280000
092100         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 09290000
092200              COMMAREA (DP008-SECURITY-COMMAREA)                  09300000
092300              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             09310000
092400      END-EXEC                                                    09320000
092500                                                                  09330000
092600      IF DP008-CALL-SUCCESSFUL                                    09340000
092700         IF DP008-ACCESS-ALLOWED                                  09350000
092800             SET PS-ACCESS-ALLOWED TO TRUE                        09360000
092900         ELSE                                                     09370000
093000             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    09380000
093100         END-IF                                                   09390000
093200     ELSE                                                         09400000
093300         MOVE '2105-RACF-ACCESS'                                  09410000
093400                               TO DP013-PARAGRAPH                 09420000
093500          MOVE 'UNABLE TO ACCESS CICS'                            09430000
093600                               TO DP013-MESSAGE-TEXT (1)          09440000
093700          MOVE SQLCA                 TO DP013-SQLCA               09450000
093800          SET DP013-DB2-ABEND                                     09460000
093900              DP013-XCTL-DISPLAY-RESTART                          09470000
094000                               TO TRUE                            09480000
094100          PERFORM DP013-0000-PROCESS-ABEND                        09490000
094200      END-IF.                                                     09500000
094300                                                                  09510000
094400*                                                                 09520000
094500*----------------------------------------------------------------*09530000
094600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *09540000
094700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *09550000
094800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *09560000
094900*    MESSAGE.                                                    *09570000
095000*----------------------------------------------------------------*09580000
095100                                                                  09590000
095200 2110-BROWSE-BACKWARD.                                            09600000
095300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    09610000
095400         GIVING PV-TOP-ITEM.                                      09620000
095500*                                                                 09630000
095600     IF  ((PV-TOP-ITEM < +1)                                      09640000
095700       OR (PV-TOP-ITEM = +1))                                     09650000
095800         MOVE +1                   TO PV-TOP-ITEM                 09660000
095900*        -- TOP OF LIST --                                        09670000
096000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            09680000
096100         SET DP020-MSG-INFORMATIONAL TO TRUE                      09690000
096200     END-IF.                                                      09700000
096300                                                                  09710000
096400 EJECT                                                            09720000
096500*----------------------------------------------------------------*09730000
096600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *09740000
096700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *09750000
096800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *09760000
096900*----------------------------------------------------------------*09770000
097000                                                                  09780000
097100 2120-BROWSE-FORWARD.                                             09790000
097200                                                                  09800000
097300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              09810000
097400         GIVING PV-TOP-ITEM.                                      09820000
097500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   09830000
097600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            09840000
097700                                   TO PV-TOP-ITEM                 09850000
097800*        -- BOTTOM OF LIST --                                     09860000
097900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            09870000
098000         SET DP020-MSG-INFORMATIONAL                              09880000
098100                                   TO TRUE                        09890000
098200     ELSE                                                         09900000
098300         COMPUTE PV-BOTTOM-ITEM =                                 09910000
098400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 09920000
098500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            09930000
098600*            -- BOTTOM OF LIST --                                 09940000
098700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            09950000
098800             SET DP020-MSG-INFORMATIONAL                          09960000
098900                                   TO TRUE                        09970000
099000         END-IF                                                   09980000
099100     END-IF.                                                      09990000
099200 EJECT                                                            10000000
099300*----------------------------------------------------------------*10010000
099400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10020000
099500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *10030000
099600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *10040000
099700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *10050000
099800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *10060000
099900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *10070000
100000*----------------------------------------------------------------*10080000
100100                                                                  10090000
100200 2130-CHECK-FOR-JUMP-BROWSE.                                      10100000
100300     IF ASTRTITL > ZERO                                           10110005
100400         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      10120005
100500     ELSE                                                         10130005
100600         IF ASTRTITF = DP015-ERASE-EOF                            10140005
100700             INITIALIZE ASC-START-ITEM-REQUEST                    10150005
100800         END-IF                                                   10160005
100900     END-IF.                                                      10170005
101000                                                                  10180005
101100     SET PS-NO-ERROR               TO TRUE.                       10190000
101200     IF (ASC-START-ITEM-REQUEST = SPACE)                          10200000
101300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10210000
101400                                   TO PV-TOP-ITEM                 10220000
101500     ELSE                                                         10230000
101600         MOVE ASC-START-ITEM-REQUEST                              10240000
101700                                   TO DP010I-UNEDITED-FIELD       10250000
101800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       10260000
101900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     10270000
102000         SET DP010I-NEGATIVE-NOT-ALLOWED                          10280000
102100                                   TO TRUE                        10290000
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10301011
263627              USING DP010I-NUMERIC-EDIT-AREA                      10302011
102300                                                                  10310000
102400         IF  NOT DP010I-ERROR-DETECTED                            10320000
102500             MOVE DP010I-NUMERIC-FIELD                            10330000
102600                                   TO  ASC-START-ITEM-REQUEST-N   10340000
102700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  10350000
102800                 IF  ASC-START-ITEM-REQUEST-N >                   10360000
102900                                          ASC-NUMBER-OF-ITEMS-READ10370000
103000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         10380000
103100                     COMPUTE PV-TOP-ITEM =                        10390000
103200                             ASC-NUMBER-OF-ITEMS-READ             10400000
103300                             - PC-ITEMS-PER-PANEL + 1             10410000
103400                     IF  PV-TOP-ITEM < +1                         10420000
103500                         MOVE +1   TO PV-TOP-ITEM                 10430000
103600                         MOVE PC-TSYMSG-00070                     10440000
103700                                   TO DP020-MSG-NUMBER            10450000
103800                         SET DP020-MSG-INFORMATIONAL              10460000
103900                                   TO TRUE                        10470000
104000                     END-IF                                       10480000
104100                 ELSE                                             10490000
104200                     MOVE ASC-START-ITEM-REQUEST-N                10500000
104300                                   TO PV-TOP-ITEM                 10510000
104400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      10520000
104500                     COMPUTE PV-BOTTOM-ITEM =                     10530000
104600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     10540000
104700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ10550000
104800*                        -- BOTTOM OF LIST --                     10560000
104900                         MOVE PC-TSYMSG-00070                     10570000
105000                                   TO DP020-MSG-NUMBER            10580000
105100                         SET DP020-MSG-INFORMATIONAL              10590000
105200                                   TO TRUE                        10600000
105300                     END-IF                                       10610000
105400                 END-IF                                           10620000
105500             ELSE                                                 10630000
105600*                --- VALUE OUT OF RANGE ----                      10640000
105700                 MOVE PC-TSYMSG-00101                             10650000
105800                                   TO DP020-MSG-NUMBER            10660000
105900                 MOVE -1           TO ASTRTITL                    10670000
106000                 SET DP030-SET-CURSOR-APPL-1                      10680000
106100                                   TO TRUE                        10690000
106200                 MOVE DP015-REVERSE                               10700000
106300                                   TO ASTRTITH                    10710000
106400                 MOVE DP015-RED    TO ASTRTITC                    10720000
106500                 MOVE DP015-UNP-NUM-BRT-MDT                       10730000
106600                                   TO ASTRTITA                    10740000
106700                 SET DP020-MSG-FATAL                              10750000
106800                                   TO TRUE                        10760000
106900                 SET PS-ERROR      TO TRUE                        10770000
107000             END-IF                                               10780000
107100                                                                  10790000
107200         ELSE                                                     10800000
107300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10810000
107400             MOVE -1               TO ASTRTITL                    10820000
107500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10830000
107600             MOVE DP015-REVERSE    TO ASTRTITH                    10840000
107700             MOVE DP015-RED        TO ASTRTITC                    10850000
107800             MOVE DP015-UNP-NUM-BRT-MDT                           10860000
107900                                   TO ASTRTITA                    10870000
108000             SET DP020-MSG-FATAL   TO TRUE                        10880000
108100             SET PS-ERROR          TO TRUE                        10890000
108200         END-IF                                                   10900000
108300     END-IF.                                                      10910000
108400 EJECT                                                            10920000
108500*----------------------------------------------------------------*10930000
108600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *10940000
108700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *10950000
108800*----------------------------------------------------------------*10960000
108900 2140-DESELECT-ALL-ITEMS.                                         10970000
109000     MOVE +1                       TO ASC-BLK-SUB.                10980000
109100                                                                  10990000
109200     PERFORM 2141-CLEAR-SELECTED-INDS                             11000000
109300         VARYING ASC-ITEM-SUB                                     11010000
109400         FROM 1 BY 1                                              11020000
109500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11030000
109600                                                                  11040000
109700     ADD +1                        TO ASC-BLK-SUB.                11050000
109800                                                                  11060000
109900     PERFORM 2141-CLEAR-SELECTED-INDS                             11070000
110000         VARYING ASC-ITEM-SUB                                     11080000
110100         FROM 1 BY 1                                              11090000
110200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11100000
110300                                                                  11110000
110400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11120000
110500                                   TO PV-LIST-ITEM-NUMBER.        11130000
110600                                                                  11140000
110700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11150000
110800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11160000
110900                                                                  11170000
111000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11180000
111100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11190000
111200         MOVE +1                   TO ASC-BLK-SUB                 11200000
111300                                                                  11210000
111400         PERFORM 5100-WRITE-TEMP-STORAGE                          11220000
111500                                                                  11230000
111600         MOVE +1                   TO PV-BLOCK-NUMBER             11240000
111700                                                                  11250000
111800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11260000
111900             PV-FIRST-BLOCK-IN-ARRAY - 1                          11270000
112000                                                                  11280000
112100         PERFORM                                                  11290000
112200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11300000
112300                                                                  11310000
112400             PERFORM 4410-READ-TEMP-STORAGE                       11320000
112500                                                                  11330000
112600             PERFORM 2141-CLEAR-SELECTED-INDS                     11340000
112700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 11350000
112800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11360000
112900                                                                  11370000
113000             PERFORM 5100-WRITE-TEMP-STORAGE                      11380000
113100                                                                  11390000
113200             ADD +1                TO PV-BLOCK-NUMBER             11400000
113300                                                                  11410000
113400         END-PERFORM                                              11420000
113500                                                                  11430000
113600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11440000
113700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11450000
113800                                                                  11460000
113900         PERFORM                                                  11470000
114000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11480000
114100                   ASC-HIGHEST-BLOCK-WRITTEN                      11490000
114200                                                                  11500000
114300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11510000
114400                                   TO PV-BLOCK-NUMBER             11520000
114500                                                                  11530000
114600             PERFORM 4410-READ-TEMP-STORAGE                       11540000
114700                                                                  11550000
114800             PERFORM 2141-CLEAR-SELECTED-INDS                     11560000
114900                 VARYING ASC-ITEM-SUB                             11570000
115000                 FROM 1 BY 1                                      11580000
115100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11590000
115200                                                                  11600000
115300             PERFORM 5100-WRITE-TEMP-STORAGE                      11610000
115400                                                                  11620000
115500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11630000
115600                                                                  11640000
115700         END-PERFORM                                              11650000
115800                                                                  11660000
115900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11670000
116000                                   TO PV-BLOCK-NUMBER             11680000
116100                                                                  11690000
116200         PERFORM 4410-READ-TEMP-STORAGE                           11700000
116300     END-IF.                                                      11710000
116400                                                                  11720000
116500                                                                  11730000
116600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 11740000
116700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.11750000
116800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  11760000
116900                                                                  11770000
117000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11780000
117100                                                                  11790000
117200 EJECT                                                            11800000
117300*----------------------------------------------------------------*11810000
117400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *11820000
117500*----------------------------------------------------------------*11830000
117600                                                                  11840000
117700 2141-CLEAR-SELECTED-INDS.                                        11850000
117800                                                                  11860000
117900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11870000
118000             NOT EQUAL ZERO                                       11880000
118100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11890000
118200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          11900000
118300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    11910000
118400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11920000
118500                                   TO TRUE                        11930000
118600         END-IF                                                   11940000
118700     END-IF.                                                      11950000
118800                                                                  11960000
118900 EJECT                                                            11970000
119000*----------------------------------------------------------------*11980000
119100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *11990000
119200*  FOR ALL ITEMS.                                                *12000000
119300*----------------------------------------------------------------*12010000
119400                                                                  12020000
119500 2150-SELECT-ALL-ITEMS.                                           12030000
119600                                                                  12040000
119700     MOVE +1                       TO ASC-BLK-SUB.                12050000
119800                                                                  12060000
119900     PERFORM 2151-SET-SELECTED-INDS                               12070000
120000         VARYING ASC-ITEM-SUB                                     12080000
120100         FROM 1 BY 1                                              12090000
120200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12100000
120300                                                                  12110000
120400     ADD +1                        TO ASC-BLK-SUB.                12120000
120500                                                                  12130000
120600     PERFORM 2151-SET-SELECTED-INDS                               12140000
120700         VARYING ASC-ITEM-SUB                                     12150000
120800         FROM 1 BY 1                                              12160000
120900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12170000
121000                                                                  12180000
121100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12190000
121200                                   TO PV-LIST-ITEM-NUMBER.        12200000
121300                                                                  12210000
121400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12220000
121500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12230000
121600                                                                  12240000
121700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12250000
121800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    12260000
121900         MOVE +1                   TO ASC-BLK-SUB                 12270000
122000                                                                  12280000
122100         PERFORM 5100-WRITE-TEMP-STORAGE                          12290000
122200                                                                  12300000
122300         MOVE +1                   TO PV-BLOCK-NUMBER             12310000
122400                                                                  12320000
122500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12330000
122600             PV-FIRST-BLOCK-IN-ARRAY - 1                          12340000
122700                                                                  12350000
122800         PERFORM                                                  12360000
122900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12370000
123000                                                                  12380000
123100             PERFORM 4410-READ-TEMP-STORAGE                       12390000
123200                                                                  12400000
123300             PERFORM 2151-SET-SELECTED-INDS                       12410000
123400                 VARYING ASC-ITEM-SUB                             12420000
123500                 FROM 1 BY 1                                      12430000
123600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12440000
123700                                                                  12450000
123800             PERFORM 5100-WRITE-TEMP-STORAGE                      12460000
123900                                                                  12470000
124000             ADD +1                TO PV-BLOCK-NUMBER             12480000
124100                                                                  12490000
124200         END-PERFORM                                              12500000
124300                                                                  12510000
124400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12520000
124500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12530000
124600                                                                  12540000
124700         PERFORM                                                  12550000
124800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12560000
124900                   ASC-HIGHEST-BLOCK-WRITTEN                      12570000
125000                                                                  12580000
125100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12590000
125200                                   TO PV-BLOCK-NUMBER             12600000
125300                                                                  12610000
125400             PERFORM 4410-READ-TEMP-STORAGE                       12620000
125500                                                                  12630000
125600             PERFORM 2151-SET-SELECTED-INDS                       12640000
125700                 VARYING ASC-ITEM-SUB                             12650000
125800                 FROM 1 BY 1                                      12660000
125900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12670000
126000                                                                  12680000
126100             PERFORM 5100-WRITE-TEMP-STORAGE                      12690000
126200                                                                  12700000
126300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12710000
126400                                                                  12720000
126500         END-PERFORM                                              12730000
126600                                                                  12740000
126700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12750000
126800                                   TO PV-BLOCK-NUMBER             12760000
126900                                                                  12770000
127000         PERFORM 4410-READ-TEMP-STORAGE                           12780000
127100     END-IF.                                                      12790000
127200                                                                  12800000
127300                                                                  12810000
127400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             12820000
127500                       ASC-NUMBER-OF-SELECTED-ITEMS.              12830000
127600                                                                  12840000
127700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12850000
127800                                                                  12860000
127900 EJECT                                                            12870000
128000*----------------------------------------------------------------*12880000
128100*    MARK EACH ITEM AS BEING SELECTED.                           *12890000
128200*----------------------------------------------------------------*12900000
128300                                                                  12910000
128400 2151-SET-SELECTED-INDS.                                          12920000
128500                                                                  12930000
128600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12940000
128700             NOT EQUAL ZERO                                       12950000
128800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             12960000
128900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             12970000
129000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        12980000
129100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12990000
129200                               TO  TRUE                           13000000
129300         END-IF                                                   13010000
129400     END-IF.                                                      13020000
129500******************************************************************13030000
129600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13040000
129700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13050000
129800******************************************************************13060000
129900 2200-MOVE-SCREEN-TO-COMMAREA.                                    13070000
130000                                                                  13080000
130100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13090000
130200     MOVE +1                       TO PV-SUB.                     13100000
130300*                                                                 13110000
130400     PERFORM 3100-SET-SUBSCRIPTS.                                 13120000
130500     IF  ASTRTITL > ZERO                                          13130000
130600         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13140000
130700     ELSE                                                         13150000
130800         IF  ASTRTITF = DP015-ERASE-EOF                           13160000
130900             INITIALIZE ASC-START-ITEM-REQUEST                    13170000
131000         END-IF                                                   13180000
131100     END-IF.                                                      13190000
131200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13200000
131300         VARYING PV-SUB                                           13210000
131400         FROM 1 BY 1                                              13220000
131500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13230000
131600******************************************************************13240000
131700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13250000
131800******************************************************************13260000
131900 2210-MOVE-LINES-TO-COMMAREA.                                     13270000
132000     IF  MR-SELECTL (PV-SUB) > ZERO                               13280000
132100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             13290000
132200         MOVE MR-SELECTI (PV-SUB)                                 13300000
132300                                   TO ASC-TEMP-SELECTED-SW        13310000
132400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13320000
132500     ELSE                                                         13330000
132600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                13340000
132700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     13350000
132800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        13360000
132900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13370000
133000         END-IF                                                   13380000
133100     END-IF.                                                      13390000
133200     ADD +1                        TO ASC-ITEM-SUB.               13400000
133300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13410000
133400         ADD +1                    TO ASC-BLK-SUB                 13420000
133500         MOVE +1                   TO ASC-ITEM-SUB                13430000
133600     END-IF.                                                      13440000
133700******************************************************************13450000
133800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13460000
133900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13470000
134000******************************************************************13480000
134100 3000-EDIT-DATA-IN-COMMAREA.                                      13490000
134200     SET PS-NO-ERROR               TO TRUE.                       13500000
134300     PERFORM 3200-RESET-ATTRIBUTES.                               13510000
134400     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13520000
134500**                                                                13530000
134600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13540000
134700* EDITTING IS DONE FROM THE BOTTOM UP.                            13550000
134800**                                                                13560000
134900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13570000
135000         ASC-ITEMS-DISPLAYED - 1.                                 13580000
135100     PERFORM 3100-SET-SUBSCRIPTS.                                 13590000
135200     PERFORM 3300-EDIT-SELECTIONS                                 13600000
135300         VARYING PV-SUB                                           13610000
135400         FROM PV-SUB BY -1                                        13620000
135500         UNTIL PV-SUB < +1                                        13630000
135600*                                                                 13640000
135700     IF  PS-NO-ERROR                                              13650000
135800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13660000
135900     END-IF.                                                      13670000
136000*                                                                 13680000
136100     IF  ((PS-NO-ERROR)                                           13690000
136200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   13700000
136300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    13710000
136400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  13720000
136500     END-IF.                                                      13730000
136600 EJECT                                                            13740000
136700*----------------------------------------------------------------*13750000
136800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13760000
136900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13770000
137000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13780000
137100*                                                                *13790000
137200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13800000
137300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13810000
137400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13820000
137500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13830000
137600*----------------------------------------------------------------*13840000
137700                                                                  13850000
137800 3100-SET-SUBSCRIPTS.                                             13860000
137900                                                                  13870000
138000     COMPUTE ASC-ITEM-SUB =                                       13880000
138100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13890000
138200                                                                  13900000
138300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13910000
138400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13920000
138500                                                                  13930000
138600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13940000
138700     ELSE                                                         13950000
138800         MOVE +1                     TO ASC-BLK-SUB               13960000
138900     END-IF.                                                      13970000
139000******************************************************************13980000
139100** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13990000
139200******************************************************************14000000
139300                                                                  14010000
139400 3200-RESET-ATTRIBUTES.                                           14020000
139500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   14030000
139600     MOVE DP015-GREEN              TO ASTRTITC.                   14040000
139700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   14050000
139800*                                                                 14060000
139900     PERFORM                                                      14070000
140000         VARYING PV-SUB                                           14080000
140100         FROM 1 BY 1                                              14090000
140200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        14100000
140300         MOVE DP015-UNP-ALP-NOR-OFF                               14110000
140400                                   TO MR-SELECTA (PV-SUB)         14120000
140500         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         14130000
140600         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         14140000
140700     END-PERFORM.                                                 14150000
140800******************************************************************14160000
140900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14170000
141000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14180000
141100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14190000
141200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14200000
141300******************************************************************14210000
141400 3300-EDIT-SELECTIONS.                                            14220000
141500     EVALUATE TRUE                                                14230000
141600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14240000
141700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14250000
141800                 CONTINUE                                         14260000
141900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14270000
142000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14280000
142100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14290000
142200                 MOVE ASC-TEMP-SELECTED-SW                        14300000
142300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14310000
142400                                TO ASC-SELECTED-SW                14320000
142500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14330000
142600             END-IF                                               14340000
142700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14350000
142800                 = SPACE                                          14360000
142900             EVALUATE TRUE                                        14370000
143000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14380000
143100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14390000
143200                     MOVE SPACE TO ASC-SELECTED-SW                14400000
143300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14410000
143400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14420000
143500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14430000
143600                     MOVE SPACE TO ASC-SELECTED-SW                14440000
143700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14450000
143800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14460000
143900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14470000
144000                     MOVE SPACE TO ASC-SELECTED-SW                14480000
144100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14490000
144200             END-EVALUATE                                         14500000
144300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14510000
144400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14520000
144500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14530000
144600             END-IF                                               14540000
144700             PERFORM 3310-EDIT-RANGE                              14550000
144800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14560000
144900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14570000
145000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14580000
145100             END-IF                                               14590000
145200             PERFORM 3310-EDIT-RANGE                              14600000
145300         WHEN OTHER                                               14610000
145400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14620000
145500             SET DP020-MSG-FATAL    TO TRUE                       14630000
145600             MOVE -1                TO MR-SELECTL (PV-SUB)        14640000
145700             SET DP030-SET-CURSOR-APPL-1                          14650000
145800                                    TO TRUE                       14660000
145900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14670000
146000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14680000
146100             SET PS-ERROR TO TRUE                                 14690000
146200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14700000
146300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14710000
146400                 MOVE SPACE         TO ASC-SELECTED-SW            14720000
146500                                        (ASC-BLK-SUB ASC-ITEM-SUB)14730000
146600             END-IF                                               14740000
146700     END-EVALUATE.                                                14750000
146800                                                                  14760000
146900     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14770000
147000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14780000
147100     IF  ASC-ITEM-SUB < 1                                         14790000
147200         SUBTRACT +1 FROM ASC-BLK-SUB                             14800000
147300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14810000
147400     END-IF.                                                      14820000
147500******************************************************************14830000
147600** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **14840000
147700** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **14850000
147800** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**14860000
147900** THE ENDING.                                                  **14870000
148000******************************************************************14880000
148100 3310-EDIT-RANGE.                                                 14890000
148200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                14900000
148300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   14910000
148400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)14920000
148500                                   TO ASC-SELECTED-SW             14930000
148600                                        (ASC-BLK-SUB ASC-ITEM-SUB)14940000
148700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 14950000
148800         ELSE                                                     14960000
148900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     14970000
149000                 CONTINUE                                         14980000
149100             ELSE                                                 14990000
149200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        15000000
149300                 MOVE PC-TSYMSG-00054                             15010000
149400                                   TO DP020-MSG-NUMBER            15020000
149500                 SET DP020-MSG-FATAL                              15030000
149600                                   TO TRUE                        15040000
149700                 MOVE -1           TO MR-SELECTL (PV-SUB)         15050000
149800                 SET DP030-SET-CURSOR-APPL-1                      15060000
149900                                   TO TRUE                        15070000
150000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         15080000
150100                 MOVE DP015-UNDERLINE                             15090000
150200                                   TO MR-SELECTH (PV-SUB)         15100000
150300                 SET PS-ERROR      TO TRUE                        15110000
150400             END-IF                                               15120000
150500         END-IF                                                   15130000
150600     ELSE                                                         15140000
150700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15150000
150800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15160000
150900                                   TO ASC-SELECTED-SW             15170000
151000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15180000
151100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15190000
151200         ELSE                                                     15200000
151300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15210000
151400                 CONTINUE                                         15220000
151500             ELSE                                                 15230000
151600*                -- ONLY ONE END-OF-RANGE ALLOWED --              15240000
151700                 MOVE PC-TSYMSG-00055                             15250000
151800                                   TO DP020-MSG-NUMBER            15260000
151900                 SET DP020-MSG-FATAL                              15270000
152000                                   TO TRUE                        15280000
152100                 MOVE -1           TO MR-SELECTL (PV-SUB)         15290000
152200                 SET DP030-SET-CURSOR-APPL-1                      15300000
152300                                   TO TRUE                        15310000
152400                 SET PS-ERROR      TO TRUE                        15320000
152500             END-IF                                               15330000
152600         END-IF                                                   15340000
152700     END-IF.                                                      15350000
152800*                                                                 15360000
152900******************************************************************15370000
153000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **15380000
153100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15390000
153200******************************************************************15400000
153300 3400-CHECK-RANGE-SEQUENCE.                                       15410000
153400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15420000
153500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15430000
153600       AND  ASC-START-OF-SELECTED-RANGE >                         15440000
153700                                         ASC-END-OF-SELECTED-RANGE15450000
153800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15460000
153900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15470000
154000         SET DP020-MSG-FATAL TO TRUE                              15480000
154100         SET PS-ERROR TO TRUE                                     15490000
154200         PERFORM 3410-POSITION-AT-ERROR                           15500000
154300     END-IF.                                                      15510000
154400******************************************************************15520000
154500** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15530000
154600** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15540000
154700** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15550000
154800******************************************************************15560000
154900 3410-POSITION-AT-ERROR.                                          15570000
155000     SET DP030-SET-CURSOR-APPL-1                                  15580000
155100                                   TO TRUE.                       15590000
155200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15600000
155300                    - PV-TOP-ITEM + 1.                            15610000
155400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15620000
155500         CONTINUE                                                 15630000
155600     ELSE                                                         15640000
155700         MOVE -1                   TO MR-SELECTL (PV-SUB)         15650000
155800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15660000
155900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15670000
156000     END-IF.                                                      15680000
156100*                                                                 15690000
156200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15700000
156300                    - PV-TOP-ITEM + 1.                            15710000
156400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15720000
156500         CONTINUE                                                 15730000
156600     ELSE                                                         15740000
156700         MOVE -1                   TO MR-SELECTL (PV-SUB)         15750000
156800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15760000
156900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15770000
157000     END-IF.                                                      15780000
157100 EJECT                                                            15790000
157200*----------------------------------------------------------------*15800000
157300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15810000
157400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15820000
157500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15830000
157600*----------------------------------------------------------------*15840000
157700                                                                  15850000
157800 3500-MARK-RANGE-AS-SELECTED.                                     15860000
157900     MOVE +1                       TO  ASC-BLK-SUB.               15870000
158000     PERFORM 3510-MARK-SELECTED-INDS                              15880000
158100         VARYING ASC-ITEM-SUB                                     15890000
158200         FROM 1 BY 1                                              15900000
158300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15910000
158400                                                                  15920000
158500     ADD +1                        TO ASC-BLK-SUB.                15930000
158600     PERFORM 3510-MARK-SELECTED-INDS                              15940000
158700         VARYING ASC-ITEM-SUB                                     15950000
158800         FROM 1 BY 1                                              15960000
158900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15970000
159000                                                                  15980000
159100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15990000
159200                                   TO  PV-LIST-ITEM-NUMBER.       16000000
159300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16010000
159400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16020000
159500               PC-ITEMS-PER-PANEL).                               16030000
159600                                                                  16040000
159700     MOVE ASC-START-OF-SELECTED-RANGE                             16050000
159800                                   TO PV-START-OF-SELECTED-RANGE. 16060000
159900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            16070000
160000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  16080000
160100               PC-ITEMS-PER-PANEL).                               16090000
160200                                                                  16100000
160300     MOVE ASC-END-OF-SELECTED-RANGE                               16110000
160400                                   TO  PV-END-OF-SELECTED-RANGE.  16120000
160500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             16130000
160600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    16140000
160700               PC-ITEMS-PER-PANEL).                               16150000
160800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             16160000
160900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             16170000
161000                                                                  16180000
161100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    16190000
161200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        16200000
161300         MOVE +1                   TO ASC-BLK-SUB                 16210000
161400         PERFORM 5100-WRITE-TEMP-STORAGE                          16220000
161500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16230000
161600             PV-FIRST-BLOCK-IN-ARRAY - 1                          16240000
161700                                                                  16250000
161800         PERFORM                                                  16260000
161900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16270000
162000                   PV-PREV-BLOCK-IN-ARRAY                         16280000
162100             MOVE PV-FIRST-BLOCK-IN-RANGE                         16290000
162200                                   TO PV-BLOCK-NUMBER             16300000
162300             PERFORM 4410-READ-TEMP-STORAGE                       16310000
162400             PERFORM 3510-MARK-SELECTED-INDS                      16320000
162500                 VARYING ASC-ITEM-SUB                             16330000
162600                 FROM 1 BY 1                                      16340000
162700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16350000
162800             PERFORM 5100-WRITE-TEMP-STORAGE                      16360000
162900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16370000
163000         END-PERFORM                                              16380000
163100                                                                  16390000
163200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16400000
163300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16410000
163400         PERFORM                                                  16420000
163500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16430000
163600                   PV-LAST-BLOCK-IN-RANGE                         16440000
163700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16450000
163800                                   TO PV-BLOCK-NUMBER             16460000
163900             PERFORM 4410-READ-TEMP-STORAGE                       16470000
164000             PERFORM 3510-MARK-SELECTED-INDS                      16480000
164100                 VARYING ASC-ITEM-SUB                             16490000
164200                 FROM 1 BY 1                                      16500000
164300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16510000
164400             PERFORM 5100-WRITE-TEMP-STORAGE                      16520000
164500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16530000
164600         END-PERFORM                                              16540000
164700                                                                  16550000
164800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16560000
164900                                   TO PV-BLOCK-NUMBER             16570000
165000         PERFORM 4410-READ-TEMP-STORAGE                           16580000
165100     END-IF.                                                      16590000
165200                                                                  16600000
165300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16610000
165400                                      ASC-END-OF-SELECTED-RANGE.  16620000
165500                                                                  16630000
165600 EJECT                                                            16640000
165700*----------------------------------------------------------------*16650000
165800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16660000
165900*----------------------------------------------------------------*16670000
166000                                                                  16680000
166100 3510-MARK-SELECTED-INDS.                                         16690000
166200                                                                  16700000
166300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16710000
166400                                ASC-ITEM-SUB) >                   16720000
166500         ASC-START-OF-SELECTED-RANGE)                             16730000
166600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16740000
166700                                ASC-ITEM-SUB) =                   16750000
166800         ASC-START-OF-SELECTED-RANGE)                             16760000
166900                                                                  16770000
167000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16780000
167100                                    ASC-ITEM-SUB) <               16790000
167200             ASC-END-OF-SELECTED-RANGE)                           16800000
167300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16810000
167400                                    ASC-ITEM-SUB) =               16820000
167500             ASC-END-OF-SELECTED-RANGE)                           16830000
167600                                                                  16840000
167700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16850000
167800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16860000
167900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16870000
168000                               TO TRUE                            16880000
168100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16890000
168200                               TO TRUE                            16900000
168300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16910000
168400             END-IF                                               16920000
168500         END-IF                                                   16930000
168600     END-IF.                                                      16940000
168700                                                                  16950000
168800*----------------------------------------------------------------*16960000
168900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16970000
169000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16980000
169100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16990000
169200*    DISPLAY THE PANEL TO USER.                                  *17000000
169300*                                                                *17010000
169400*    THE CURSOR WILL EITHER DISPLAY TEMPS FOR A SINGLE DC BASED  *17020000
169500*    ON THE SIGNON LOC - OR - ALL TEMPS IF SIGNON = 090          *17030000
169600*----------------------------------------------------------------*17040000
169700*===> LAST-NAME SEQUENCE                                          17050000
169800 4000L-BUILD-INITIAL-PANEL.                                       17060000
169900                                                                  17070000
170000*    DISPLAY ONLY TEMP ASSOCS FOR THE SPECIFIC SIGNON LOC         17080000
170100     IF ASC-DC-LIST-DISPLAY                                       17090000
170200        INITIALIZE                  ASC-BLOCK-ENTRIES (1)         17100000
170300                                    ASC-BLOCK-ENTRIES (2)         17110000
170400        MOVE +1                 TO ASC-BLK-SUB                    17120000
170500        SET ASC-ITEMS-LEFT-ON-DB                                  17130000
170600                                TO TRUE                           17140000
170700                                                                  17150000
170800        MOVE +0                 TO ASC-ITEM-SUB                   17160000
170900                                   ASC-NUMBER-OF-ITEMS-READ       17170000
171000                                   ASC-NUMBER-OF-SELECTED-ITEMS   17180000
171100                                   ASC-HIGHEST-BLOCK-WRITTEN      17190000
171200                                   ASC-START-OF-SELECTED-RANGE    17200000
171300                                   ASC-END-OF-SELECTED-RANGE      17210000
171400                                   ASC-ITEM-AT-TOP-OF-PANEL       17220000
171500*       PERFORM 4100LD-PREPARE-CURSOR                             17230000
171600                                                                  17240000
171700        PERFORM 4010LD-OPEN-CURSOR                                17250000
171800                                                                  17260000
171900        PERFORM 4300LD-READ-ITEMS-FROM-DB                         17270000
172000                                                                  17280000
172100        PERFORM 4020LD-CLOSE-CURSOR                               17290000
172200                                                                  17300000
172300        MOVE +1                   TO  PV-TOP-ITEM                 17310000
172400        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       17320000
172500            MOVE -1               TO MR-SELECTL (1)               17330000
172600            MOVE ASC-KEY-OPER-UNT-ID         TO ADCO              17340000
172700            MOVE ASC-KEY-OPER-DESC           TO ADCNMEO           17350000
172800            PERFORM VARYING PV-SUB                                17360000
172900                    FROM PC-ITEMS-PER-PANEL BY -1                 17370000
173000                    UNTIL PV-SUB < +1                             17380000
173100                MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)    17390000
173200            END-PERFORM                                           17400000
173300            SET DP020-MSG-FATAL                                   17410000
173400                DP030-SET-CURSOR-APPL-1                           17420000
173500                DP030-OVERRIDE-APPL-ERROR TO TRUE                 17430000
173600            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            17440000
173700        ELSE                                                      17450000
173800            MOVE -1               TO MR-SELECTL (1)               17460000
173900            SET DP030-SET-CURSOR-APPL-1                           17470000
174000                                  TO TRUE                         17480000
174100            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                  17490000
174200        END-IF                                                    17500000
174300     ELSE                                                         17510000
174400*    DISPLAY ALL THE TEMP ASSOCS BECAUSE SIGNON LOC = 090         17520000
174500        INITIALIZE                  ASC-BLOCK-ENTRIES (1)         17530000
174600                                    ASC-BLOCK-ENTRIES (2)         17540000
174700        MOVE +1                 TO ASC-BLK-SUB                    17550000
174800        SET ASC-ITEMS-LEFT-ON-DB                                  17560000
174900                                TO TRUE                           17570000
175000                                                                  17580000
175100        MOVE +0                 TO ASC-ITEM-SUB                   17590000
175200                                   ASC-NUMBER-OF-ITEMS-READ       17600000
175300                                   ASC-NUMBER-OF-SELECTED-ITEMS   17610000
175400                                   ASC-HIGHEST-BLOCK-WRITTEN      17620000
175500                                   ASC-START-OF-SELECTED-RANGE    17630000
175600                                   ASC-END-OF-SELECTED-RANGE      17640000
175700                                   ASC-ITEM-AT-TOP-OF-PANEL       17650000
175800*       PERFORM 4100LA-PREPARE-CURSOR                             17660000
175900                                                                  17670000
176000        PERFORM 4010LA-OPEN-CURSOR                                17680000
176100                                                                  17690000
176200        PERFORM 4300LA-READ-ITEMS-FROM-DB                         17700000
176300                                                                  17710000
176400        PERFORM 4020LA-CLOSE-CURSOR                               17720000
176500                                                                  17730000
176600        MOVE +1                   TO  PV-TOP-ITEM                 17740000
176700        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       17750000
176800            MOVE -1               TO MR-SELECTL (1)               17760000
176900            MOVE ASC-OPER-UNT-ID-TXT         TO ADCO              17770000
177000            MOVE ASC-KEY-OPER-DESC           TO ADCNMEO           17780000
177100            PERFORM VARYING PV-SUB                                17790000
177200                    FROM PC-ITEMS-PER-PANEL BY -1                 17800000
177300                    UNTIL PV-SUB < +1                             17810000
177400                MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)    17820000
177500            END-PERFORM                                           17830000
177600            SET DP020-MSG-FATAL                                   17840000
177700                DP030-SET-CURSOR-APPL-1                           17850000
177800                DP030-OVERRIDE-APPL-ERROR TO TRUE                 17860000
177900            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            17870000
178000        ELSE                                                      17880000
178100            MOVE -1               TO MR-SELECTL (1)               17890000
178200            SET DP030-SET-CURSOR-APPL-1                           17900000
178300                                  TO TRUE                         17910000
178400            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                  17920000
178500        END-IF                                                    17930000
178600     END-IF.                                                      17940000
178700/                                                                 17950000
178800*----------------------------------------------------------------*17960000
178900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17970000
179000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *17980000
179100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17990000
179200*    DISPLAY THE PANEL TO USER.                                  *18000000
179300*                                                                *18010000
179400*    THE CURSOR WILL EITHER DISPLAY TEMPS FOR A SINGLE DC BASED  *18020000
179500*    ON THE SIGNON LOC - OR - ALL TEMPS IF SIGNON = 090          *18030000
179600*----------------------------------------------------------------*18040000
179700*===> USER-CODE SEQUENCE (DEFAULT)                                18050000
179800 4000U-BUILD-INITIAL-PANEL.                                       18060000
179900                                                                  18070000
180000*    DISPLAY ONLY TEMP ASSOCS FOR THE SPECIFIC SIGNON LOC         18080000
180100     IF ASC-DC-LIST-DISPLAY                                       18090000
180200        INITIALIZE                  ASC-BLOCK-ENTRIES (1)         18100000
180300                                    ASC-BLOCK-ENTRIES (2)         18110000
180400        MOVE +1                 TO ASC-BLK-SUB                    18120000
180500        SET ASC-ITEMS-LEFT-ON-DB                                  18130000
180600                                TO TRUE                           18140000
180700                                                                  18150000
180800        MOVE +0                 TO ASC-ITEM-SUB                   18160000
180900                                   ASC-NUMBER-OF-ITEMS-READ       18170000
181000                                   ASC-NUMBER-OF-SELECTED-ITEMS   18180000
181100                                   ASC-HIGHEST-BLOCK-WRITTEN      18190000
181200                                   ASC-START-OF-SELECTED-RANGE    18200000
181300                                   ASC-END-OF-SELECTED-RANGE      18210000
181400                                   ASC-ITEM-AT-TOP-OF-PANEL       18220000
181500*       PERFORM 4100UD-PREPARE-CURSOR                             18230000
181600                                                                  18240000
181700        PERFORM 4010UD-OPEN-CURSOR                                18250000
181800                                                                  18260000
181900        PERFORM 4300UD-READ-ITEMS-FROM-DB                         18270000
182000                                                                  18280000
182100        PERFORM 4020UD-CLOSE-CURSOR                               18290000
182200                                                                  18300000
182300        MOVE +1                   TO  PV-TOP-ITEM                 18310000
182400        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       18320000
182500            MOVE -1               TO MR-SELECTL (1)               18330000
182600            MOVE ASC-KEY-OPER-UNT-ID         TO ADCO              18340000
182700            MOVE ASC-KEY-OPER-DESC           TO ADCNMEO           18350000
182800            PERFORM VARYING PV-SUB                                18360000
182900                    FROM PC-ITEMS-PER-PANEL BY -1                 18370000
183000                    UNTIL PV-SUB < +1                             18380000
183100                MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)    18390000
183200            END-PERFORM                                           18400000
183300            SET DP020-MSG-FATAL                                   18410000
183400                DP030-SET-CURSOR-APPL-1                           18420000
183500                DP030-OVERRIDE-APPL-ERROR TO TRUE                 18430000
183600            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            18440000
183700     ELSE                                                         18450000
183800         MOVE -1               TO MR-SELECTL (1)                  18460000
183900         SET DP030-SET-CURSOR-APPL-1                              18470000
184000                               TO TRUE                            18480000
184100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     18490000
184200     ELSE                                                         18500000
184300*    DISPLAY ALL THE TEMP ASSOCS BECAUSE SIGNON LOC = 090         18510000
184400        INITIALIZE                  ASC-BLOCK-ENTRIES (1)         18520000
184500                                    ASC-BLOCK-ENTRIES (2)         18530000
184600        MOVE +1                 TO ASC-BLK-SUB                    18540000
184700        SET ASC-ITEMS-LEFT-ON-DB                                  18550000
184800                                TO TRUE                           18560000
184900                                                                  18570000
185000        MOVE +0                 TO ASC-ITEM-SUB                   18580000
185100                                   ASC-NUMBER-OF-ITEMS-READ       18590000
185200                                   ASC-NUMBER-OF-SELECTED-ITEMS   18600000
185300                                   ASC-HIGHEST-BLOCK-WRITTEN      18610000
185400                                   ASC-START-OF-SELECTED-RANGE    18620000
185500                                   ASC-END-OF-SELECTED-RANGE      18630000
185600                                   ASC-ITEM-AT-TOP-OF-PANEL       18640000
185700*       PERFORM 4100UA-PREPARE-CURSOR                             18650000
185800                                                                  18660000
185900        PERFORM 4010UA-OPEN-CURSOR                                18670000
186000                                                                  18680000
186100        PERFORM 4300UA-READ-ITEMS-FROM-DB                         18690000
186200                                                                  18700000
186300        PERFORM 4020UA-CLOSE-CURSOR                               18710000
186400                                                                  18720000
186500        MOVE +1                   TO  PV-TOP-ITEM                 18730000
186600        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       18740000
186700            MOVE -1               TO MR-SELECTL (1)               18750000
186800            MOVE ASC-OPER-UNT-ID-TXT         TO ADCO              18760000
186900            MOVE ASC-KEY-OPER-DESC           TO ADCNMEO           18770000
187000            PERFORM VARYING PV-SUB                                18780000
187100                    FROM PC-ITEMS-PER-PANEL BY -1                 18790000
187200                    UNTIL PV-SUB < +1                             18800000
187300                MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)    18810000
187400            END-PERFORM                                           18820000
187500            SET DP020-MSG-FATAL                                   18830000
187600                DP030-SET-CURSOR-APPL-1                           18840000
187700                DP030-OVERRIDE-APPL-ERROR TO TRUE                 18850000
187800            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            18860000
187900        ELSE                                                      18870000
188000            MOVE -1               TO MR-SELECTL (1)               18880000
188100            SET DP030-SET-CURSOR-APPL-1                           18890000
188200                                  TO TRUE                         18900000
188300            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                  18910000
188400        END-IF                                                    18920000
188500     END-IF.                                                      18930000
188600                                                                  18940000
188700*----------------------------------------------------------------*18950000
188800* OPEN CALLS                                                     *18960000
188900*----------------------------------------------------------------*18970000
189000 4010LA-OPEN-CURSOR.                                              18980000
189100                                                                  18990000
189200     PERFORM 7100LA-OPEN-LAST-NAME-ALL-CSR.                       19000000
189300                                                                  19010000
189400 4010LD-OPEN-CURSOR.                                              19020000
189500                                                                  19030000
189600     MOVE ASC-KEY-OPER-UNT-ID         TO DK-DC-NBR                19040000
189700     PERFORM 7100LD-OPEN-LAST-NAME-DC-CSR.                        19050000
189800                                                                  19060000
189900 4010UA-OPEN-CURSOR.                                              19070000
190000                                                                  19080000
190100     PERFORM 7100UA-OPEN-USER-CODE-ALL-CSR.                       19090000
190200                                                                  19100000
190300 4010UD-OPEN-CURSOR.                                              19110000
190400                                                                  19120000
190500     MOVE ASC-KEY-OPER-UNT-ID         TO DK-DC-NBR                19130000
190600     PERFORM 7100UD-OPEN-USER-CODE-DC-CSR.                        19140000
190700/                                                                 19150000
190800*----------------------------------------------------------------*19160000
190900* CLOSE CALLS                                                    *19170000
191000*----------------------------------------------------------------*19180000
191100 4020LA-CLOSE-CURSOR.                                             19190000
191200     PERFORM 7120LA-CLOSE-LAST-NAME-ALL-CSR.                      19200000
191300                                                                  19210000
191400 4020LD-CLOSE-CURSOR.                                             19220000
191500     PERFORM 7120LD-CLOSE-LAST-NAME-DC-CSR.                       19230000
191600                                                                  19240000
191700 4020UA-CLOSE-CURSOR.                                             19250000
191800     PERFORM 7120UA-CLOSE-USER-CODE-ALL-CSR.                      19260000
191900                                                                  19270000
192000 4020UD-CLOSE-CURSOR.                                             19280000
192100     PERFORM 7120UD-CLOSE-USER-CODE-DC-CSR.                       19290000
192200/                                                                 19300000
192300*----------------------------------------------------------------*19310000
192400*    SET UP THE HOST VARIABLES.                                  *19320000
192500*----------------------------------------------------------------*19330000
192600*                                                                 19340000
192700*4100LA-PREPARE-CURSOR.                                           19350000
192800*    CONTINUE.                                                    19360000
192900*                                                                 19370000
193000*4100LD-PREPARE-CURSOR.                                           19380000
193100*    CONTINUE.                                                    19390000
193200*                                                                 19400000
193300*4100UA-PREPARE-CURSOR.                                           19410000
193400*    CONTINUE.                                                    19420000
193500*                                                                 19430000
193600*4100UD-PREPARE-CURSOR.                                           19440000
193700*    CONTINUE.                                                    19450000
193800*                                                                 19460000
193900/                                                                 19470000
194000*----------------------------------------------------------------*19480000
194100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *19490000
194200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *19500000
194300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *19510000
194400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *19520000
194500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *19530000
194600*                                                                *19540000
194700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *19550000
194800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *19560000
194900*    UPON INITIALIZATION.                                        *19570000
195000*                                                                *19580000
195100* !! THIS IS READING IN LAST NAME ORDER FOR ALL TEMP ASSOCS      *19590000
195200*                                                                *19600000
195300*----------------------------------------------------------------*19610000
195400                                                                  19620000
195500 4300LA-READ-ITEMS-FROM-DB.                                       19630000
195600                                                                  19640000
195700     PERFORM                                                      19650000
195800         VARYING PV-READ-COUNT                                    19660000
195900         FROM 1 BY 1                                              19670000
196000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    19680000
196100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         19690000
196200                                                                  19700000
196300         PERFORM 4310LA-FETCH                                     19710000
196400                                                                  19720000
196500         IF  ASC-ITEMS-LEFT-ON-DB                                 19730000
196600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                19740000
196700                 ADD +1            TO ASC-ITEM-SUB                19750000
196800             ELSE                                                 19760000
196900                 ADD +1            TO ASC-BLK-SUB                 19770000
197000                 MOVE +1           TO ASC-ITEM-SUB                19780000
197100                                                                  19790000
197200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         19800000
197300                     MOVE +1       TO ASC-BLK-SUB                 19810000
197400                     SET ASC-BLOCK-MODIFIED (1)                   19820000
197500                                   TO TRUE                        19830000
197600                     PERFORM 5100-WRITE-TEMP-STORAGE              19840000
197700                     MOVE ASC-BLOCK-ENTRIES                       19850000
197800                               (PC-MAX-BLOCKS-IN-ARRAY)           19860000
197900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 19870000
198000                     ADD +1        TO ASC-BLK-SUB                 19880000
198100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   19890000
198200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      19900000
198300                                   TO TRUE                        19910000
198400                 END-IF                                           19920000
198500             END-IF                                               19930000
198600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19940000
198700             MOVE ASC-NUMBER-OF-ITEMS-READ                        19950000
198800                                   TO ASC-LIST-ITEM-NUMBER        19960000
198900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19970000
199000*            LOAD CURSOR FIELDS TO ASC                            19980000
199100             MOVE DLT00002-TMP-USR-ID                             19990000
199200                                      TO ASC-USER-CODE            20000000
199300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20010000
199400             MOVE DLT00002-DC-NBR                                 20020000
199500                                      TO ASC-DC-ADD               20030000
199600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20040000
199700             MOVE DLT00002-FRST-NM    TO ASC-FIRST-NAME           20050000
199800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20060000
199900             MOVE DLT00002-LAST-NM    TO ASC-LAST-NAME            20070000
200000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20080000
200100             MOVE DLT00002-ACTV-IND                               20090000
200200                                      TO ASC-ACTIVE               20100000
200300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20110000
200400                                                                  20120000
200500         END-IF                                                   20130000
200600     END-PERFORM.                                                 20140000
200700                                                                  20150000
200800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20160000
200900         MOVE +1               TO ASC-BLK-SUB                     20170000
201000         PERFORM 5100-WRITE-TEMP-STORAGE                          20180000
201100         ADD +1                TO ASC-BLK-SUB                     20190000
201200         PERFORM 5100-WRITE-TEMP-STORAGE                          20200000
201300                                                                  20210000
201400         MOVE 1                TO ASC-BLK-SUB                     20220000
201500                                  PV-BLOCK-NUMBER                 20230000
201600         PERFORM 4410-READ-TEMP-STORAGE                           20240000
201700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20250000
201800             MOVE 2            TO ASC-BLK-SUB                     20260000
201900                                  PV-BLOCK-NUMBER                 20270000
202000             PERFORM 4410-READ-TEMP-STORAGE                       20280000
202100         END-IF                                                   20290000
202200     END-IF.                                                      20300000
202300*----------------------------------------------------------------*20310000
202400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20320000
202500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20330000
202600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20340000
202700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20350000
202800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20360000
202900*                                                                *20370000
203000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20380000
203100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20390000
203200*    UPON INITIALIZATION.                                        *20400000
203300*                                                                *20410000
203400* !! THIS IS READING IN LAST NAME ORDER FOR A SPECIFIC DC        *20420000
203500*                                                                *20430000
203600*----------------------------------------------------------------*20440000
203700                                                                  20450000
203800 4300LD-READ-ITEMS-FROM-DB.                                       20460000
203900                                                                  20470000
204000     PERFORM                                                      20480000
204100         VARYING PV-READ-COUNT                                    20490000
204200         FROM 1 BY 1                                              20500000
204300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20510000
204400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20520000
204500                                                                  20530000
204600         PERFORM 4310LD-FETCH                                     20540000
204700                                                                  20550000
204800         IF  ASC-ITEMS-LEFT-ON-DB                                 20560000
204900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20570000
205000                 ADD +1            TO ASC-ITEM-SUB                20580000
205100             ELSE                                                 20590000
205200                 ADD +1            TO ASC-BLK-SUB                 20600000
205300                 MOVE +1           TO ASC-ITEM-SUB                20610000
205400                                                                  20620000
205500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20630000
205600                     MOVE +1       TO ASC-BLK-SUB                 20640000
205700                     SET ASC-BLOCK-MODIFIED (1)                   20650000
205800                                   TO TRUE                        20660000
205900                     PERFORM 5100-WRITE-TEMP-STORAGE              20670000
206000                     MOVE ASC-BLOCK-ENTRIES                       20680000
206100                               (PC-MAX-BLOCKS-IN-ARRAY)           20690000
206200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20700000
206300                     ADD +1        TO ASC-BLK-SUB                 20710000
206400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20720000
206500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20730000
206600                                   TO TRUE                        20740000
206700                 END-IF                                           20750000
206800             END-IF                                               20760000
206900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20770000
207000             MOVE ASC-NUMBER-OF-ITEMS-READ                        20780000
207100                                   TO ASC-LIST-ITEM-NUMBER        20790000
207200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20800000
207300*            LOAD CURSOR FIELDS TO ASC                            20810000
207400             MOVE DLT00002-TMP-USR-ID                             20820000
207500                                      TO ASC-USER-CODE            20830000
207600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20840000
207700             MOVE DLT00002-DC-NBR                                 20850000
207800                                      TO ASC-DC-ADD               20860000
207900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20870000
208000             MOVE DLT00002-FRST-NM    TO ASC-FIRST-NAME           20880000
208100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20890000
208200             MOVE DLT00002-LAST-NM    TO ASC-LAST-NAME            20900000
208300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20910000
208400             MOVE DLT00002-ACTV-IND                               20920000
208500                                      TO ASC-ACTIVE               20930000
208600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20940000
208700                                                                  20950000
208800         END-IF                                                   20960000
208900     END-PERFORM.                                                 20970000
209000                                                                  20980000
209100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20990000
209200         MOVE +1               TO ASC-BLK-SUB                     21000000
209300         PERFORM 5100-WRITE-TEMP-STORAGE                          21010000
209400         ADD +1                TO ASC-BLK-SUB                     21020000
209500         PERFORM 5100-WRITE-TEMP-STORAGE                          21030000
209600                                                                  21040000
209700         MOVE 1                TO ASC-BLK-SUB                     21050000
209800                                  PV-BLOCK-NUMBER                 21060000
209900         PERFORM 4410-READ-TEMP-STORAGE                           21070000
210000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21080000
210100             MOVE 2            TO ASC-BLK-SUB                     21090000
210200                                  PV-BLOCK-NUMBER                 21100000
210300             PERFORM 4410-READ-TEMP-STORAGE                       21110000
210400         END-IF                                                   21120000
210500     END-IF.                                                      21130000
210600/                                                                 21140000
210700*----------------------------------------------------------------*21150000
210800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21160000
210900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21170000
211000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21180000
211100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21190000
211200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21200000
211300*                                                                *21210000
211400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21220000
211500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21230000
211600*    UPON INITIALIZATION.                                        *21240000
211700*                                                                *21250000
211800* !! THIS IS READING IN USER CODE ORDER FOR ALL TEMP ASSOCS      *21260000
211900*                                                                *21270000
212000*----------------------------------------------------------------*21280000
212100 4300UA-READ-ITEMS-FROM-DB.                                       21290000
212200                                                                  21300000
212300     PERFORM                                                      21310000
212400         VARYING PV-READ-COUNT                                    21320000
212500         FROM 1 BY 1                                              21330000
212600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21340000
212700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21350000
212800                                                                  21360000
212900         PERFORM 4310UA-FETCH                                     21370000
213000                                                                  21380000
213100         IF  ASC-ITEMS-LEFT-ON-DB                                 21390000
213200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21400000
213300                 ADD +1            TO ASC-ITEM-SUB                21410000
213400             ELSE                                                 21420000
213500                 ADD +1            TO ASC-BLK-SUB                 21430000
213600                 MOVE +1           TO ASC-ITEM-SUB                21440000
213700                                                                  21450000
213800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21460000
213900                     MOVE +1       TO ASC-BLK-SUB                 21470000
214000                     SET ASC-BLOCK-MODIFIED (1)                   21480000
214100                                   TO TRUE                        21490000
214200                     PERFORM 5100-WRITE-TEMP-STORAGE              21500000
214300                     MOVE ASC-BLOCK-ENTRIES                       21510000
214400                               (PC-MAX-BLOCKS-IN-ARRAY)           21520000
214500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21530000
214600                     ADD +1        TO ASC-BLK-SUB                 21540000
214700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21550000
214800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21560000
214900                                   TO TRUE                        21570000
215000                 END-IF                                           21580000
215100             END-IF                                               21590000
215200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21600000
215300             MOVE ASC-NUMBER-OF-ITEMS-READ                        21610000
215400                                   TO ASC-LIST-ITEM-NUMBER        21620000
215500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21630000
215600*            LOAD CURSOR FIELDS TO ASC                            21640000
215700             MOVE DLT00002-TMP-USR-ID                             21650000
215800                                      TO ASC-USER-CODE            21660000
215900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21670000
216000             MOVE DLT00002-DC-NBR                                 21680000
216100                                      TO ASC-DC-ADD               21690000
216200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21700000
216300             MOVE DLT00002-FRST-NM    TO ASC-FIRST-NAME           21710000
216400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21720000
216500             MOVE DLT00002-LAST-NM    TO ASC-LAST-NAME            21730000
216600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21740000
216700             MOVE DLT00002-ACTV-IND                               21750000
216800                                      TO ASC-ACTIVE               21760000
216900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21770000
217000                                                                  21780000
217100         END-IF                                                   21790000
217200     END-PERFORM.                                                 21800000
217300                                                                  21810000
217400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21820000
217500         MOVE +1               TO ASC-BLK-SUB                     21830000
217600         PERFORM 5100-WRITE-TEMP-STORAGE                          21840000
217700         ADD +1                TO ASC-BLK-SUB                     21850000
217800         PERFORM 5100-WRITE-TEMP-STORAGE                          21860000
217900                                                                  21870000
218000         MOVE 1                TO ASC-BLK-SUB                     21880000
218100                                  PV-BLOCK-NUMBER                 21890000
218200         PERFORM 4410-READ-TEMP-STORAGE                           21900000
218300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21910000
218400             MOVE 2            TO ASC-BLK-SUB                     21920000
218500                                  PV-BLOCK-NUMBER                 21930000
218600             PERFORM 4410-READ-TEMP-STORAGE                       21940000
218700         END-IF                                                   21950000
218800     END-IF.                                                      21960000
218900/                                                                 21970000
219000*----------------------------------------------------------------*21980000
219100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21990000
219200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *22000000
219300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *22010000
219400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *22020000
219500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *22030000
219600*                                                                *22040000
219700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *22050000
219800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *22060000
219900*    UPON INITIALIZATION.                                        *22070000
220000*                                                                *22080000
220100* !! THIS IS READING IN USER CODE ORDER BY SPECIFIC DC           *22090000
220200*                                                                *22100000
220300*----------------------------------------------------------------*22110000
220400 4300UD-READ-ITEMS-FROM-DB.                                       22120000
220500                                                                  22130000
220600     PERFORM                                                      22140000
220700         VARYING PV-READ-COUNT                                    22150000
220800         FROM 1 BY 1                                              22160000
220900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    22170000
221000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         22180000
221100                                                                  22190000
221200         PERFORM 4310UD-FETCH                                     22200000
221300                                                                  22210000
221400         IF  ASC-ITEMS-LEFT-ON-DB                                 22220000
221500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                22230000
221600                 ADD +1            TO ASC-ITEM-SUB                22240000
221700             ELSE                                                 22250000
221800                 ADD +1            TO ASC-BLK-SUB                 22260000
221900                 MOVE +1           TO ASC-ITEM-SUB                22270000
222000                                                                  22280000
222100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         22290000
222200                     MOVE +1       TO ASC-BLK-SUB                 22300000
222300                     SET ASC-BLOCK-MODIFIED (1)                   22310000
222400                                   TO TRUE                        22320000
222500                     PERFORM 5100-WRITE-TEMP-STORAGE              22330000
222600                     MOVE ASC-BLOCK-ENTRIES                       22340000
222700                               (PC-MAX-BLOCKS-IN-ARRAY)           22350000
222800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 22360000
222900                     ADD +1        TO ASC-BLK-SUB                 22370000
223000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   22380000
223100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      22390000
223200                                   TO TRUE                        22400000
223300                 END-IF                                           22410000
223400             END-IF                                               22420000
223500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    22430000
223600             MOVE ASC-NUMBER-OF-ITEMS-READ                        22440000
223700                                   TO ASC-LIST-ITEM-NUMBER        22450000
223800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22460000
223900*            LOAD CURSOR FIELDS TO ASC                            22470000
224000             MOVE DLT00002-TMP-USR-ID                             22480000
224100                                      TO ASC-USER-CODE            22490000
224200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22500000
224300             MOVE DLT00002-DC-NBR                                 22510000
224400                                      TO ASC-DC-ADD               22520000
224500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22530000
224600             MOVE DLT00002-FRST-NM    TO ASC-FIRST-NAME           22540000
224700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22550000
224800             MOVE DLT00002-LAST-NM    TO ASC-LAST-NAME            22560000
224900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22570000
225000             MOVE DLT00002-ACTV-IND                               22580000
225100                                      TO ASC-ACTIVE               22590000
225200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22600000
225300                                                                  22610000
225400         END-IF                                                   22620000
225500     END-PERFORM.                                                 22630000
225600                                                                  22640000
225700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22650000
225800         MOVE +1               TO ASC-BLK-SUB                     22660000
225900         PERFORM 5100-WRITE-TEMP-STORAGE                          22670000
226000         ADD +1                TO ASC-BLK-SUB                     22680000
226100         PERFORM 5100-WRITE-TEMP-STORAGE                          22690000
226200                                                                  22700000
226300         MOVE 1                TO ASC-BLK-SUB                     22710000
226400                                  PV-BLOCK-NUMBER                 22720000
226500         PERFORM 4410-READ-TEMP-STORAGE                           22730000
226600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22740000
226700             MOVE 2            TO ASC-BLK-SUB                     22750000
226800                                  PV-BLOCK-NUMBER                 22760000
226900             PERFORM 4410-READ-TEMP-STORAGE                       22770000
227000         END-IF                                                   22780000
227100     END-IF.                                                      22790000
227200                                                                  22800000
227300/                                                                 22810000
227400*----------------------------------------------------------------*22820000
227500* FETCH CALLS                                                    *22830000
227600*----------------------------------------------------------------*22840000
227700 4310LA-FETCH.                                                    22850000
227800                                                                  22860000
227900     PERFORM 7110LA-FETCH-LAST-NAME-ALL-CSR.                      22870000
228000                                                                  22880000
228100 4310LD-FETCH.                                                    22890000
228200                                                                  22900000
228300     PERFORM 7110LD-FETCH-LAST-NAME-DC-CSR.                       22910000
228400                                                                  22920000
228500 4310UA-FETCH.                                                    22930000
228600                                                                  22940000
228700     PERFORM 7110UA-FETCH-USER-CODE-ALL-CSR.                      22950000
228800                                                                  22960000
228900 4310UD-FETCH.                                                    22970000
229000                                                                  22980000
229100     PERFORM 7110UD-FETCH-USER-CODE-DC-CSR.                       22990000
229200/                                                                 23000000
229300*----------------------------------------------------------------*23010000
229400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23020000
229500*----------------------------------------------------------------*23030000
229600                                                                  23040000
229700 4400-MOVE-COMMAREA-TO-SCREEN.                                    23050000
229800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23060000
229900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23070000
230000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23080000
230100             MOVE +1    TO ASC-BLK-SUB                            23090000
230200             PERFORM 5100-WRITE-TEMP-STORAGE                      23100000
230300             ADD +1     TO ASC-BLK-SUB                            23110000
230400             PERFORM 5100-WRITE-TEMP-STORAGE                      23120000
230500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23130000
230600                 GIVING PV-BLOCK-NUMBER                           23140000
230700                 REMAINDER PV-REMAINDER                           23150000
230800             IF  PV-REMAINDER > ZERO                              23160000
230900                 ADD +1 TO PV-BLOCK-NUMBER                        23170000
231000             END-IF                                               23180000
231100             MOVE +1    TO ASC-BLK-SUB                            23190000
231200             PERFORM 4410-READ-TEMP-STORAGE                       23200000
231300             ADD +1     TO ASC-BLK-SUB                            23210000
231400                           PV-BLOCK-NUMBER                        23220000
231500             PERFORM 4410-READ-TEMP-STORAGE                       23230000
231600     END-IF.                                                      23240000
231700     MOVE +1            TO ASC-BLK-SUB.                           23250000
231800     COMPUTE ASC-ITEM-SUB =                                       23260000
231900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23270000
232000         + PC-ITEMS-PER-PANEL).                                   23280000
232100*                                                                 23290000
232200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23300000
232300         ADD +1         TO ASC-BLK-SUB                            23310000
232400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23320000
232500     END-IF.                                                      23330000
232600*                                                                 23340000
232700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23350000
232800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23360000
232900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23370000
233000     PERFORM 4420-FORMAT-LIST-LINES                               23380000
233100         VARYING PV-SUB                                           23390000
233200         FROM PC-ITEMS-PER-PANEL BY -1                            23400000
233300         UNTIL PV-SUB < +1.                                       23410000
233400*                                                                 23420000
233500     COMPUTE ASC-ITEMS-DISPLAYED =                                23430000
233600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23440000
233700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23450000
233800                                      ASTRTITO.                   23460000
233900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23470000
234000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23480000
234100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23490000
234200                                   TO ASELITO.                    23500000
234300                                                                  23510000
234400*    HEADINGS                                                     23520000
234500                                                                  23530000
234600     IF ASC-USER-CODE-SEQ                                         23540000
234700        MOVE PV-USER-CODE-SEQ TO ASEQMSGO                         23550000
234800     END-IF.                                                      23560000
234900                                                                  23570000
235000     IF ASC-LAST-NAME-SEQ                                         23580000
235100        MOVE PV-LAST-NAME-SEQ TO ASEQMSGO                         23590000
235200     END-IF.                                                      23600000
235300                                                                  23610000
235400     IF ASC-ALL-LIST-DISPLAY                                      23620000
235500        MOVE PV-ALL                   TO ADCO                     23630000
235600        MOVE PV-ALL-TEMPS             TO ADCNMEO                  23640000
235700     ELSE                                                         23650000
235800        MOVE ASC-KEY-OPER-UNT-ID      TO ASC-OPER-UNT-ID-NS       23660000
235900        MOVE ASC-OPER-UNT-ID-NS       TO ASC-OPER-UNT-ID-TXT      23670000
236000        MOVE ASC-OPER-UNT-ID-TXT      TO ADCO                     23680000
236100        MOVE ASC-KEY-OPER-DESC        TO ADCNMEO                  23690000
236200     END-IF.                                                      23700000
236300                                                                  23710000
236400*                                                                 23720000
236500     IF  DP020-MSG-NUMBER-X = SPACE                               23730000
236600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23740000
236700*            --- MORE ITEMS TO DISPLAY ----                       23750000
236800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23760000
236900             SET DP020-MSG-INFORMATIONAL TO TRUE                  23770000
237000         END-IF                                                   23780000
237100     END-IF.                                                      23790000
237200*----------------------------------------------------------------*23800000
237300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23810000
237400*----------------------------------------------------------------*23820000
237500                                                                  23830000
237600 4410-READ-TEMP-STORAGE.                                          23840000
237700                                                                  23850000
237800     EXEC CICS                                                    23860000
237900         READQ TS                                                 23870000
238000             QUEUE (ASC-LIST-QUEUE-NAME)                          23880000
238100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23890000
238200             ITEM  (PV-BLOCK-NUMBER)                              23900000
238300             RESP  (PV-CICS-RESP)                                 23910000
238400     END-EXEC.                                                    23920000
238500                                                                  23930000
238600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23940000
238700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23950000
238800         CONTINUE                                                 23960000
238900     ELSE                                                         23970000
239000         SET DP013-CICS-ABEND     TO TRUE                         23980000
239100         SET DP013-NO-ROLLBACK    TO TRUE                         23990000
239200         MOVE '4410-READ-TEMP-STORAGE'                            24000000
239300                                  TO DP013-PARAGRAPH              24010000
239400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24020000
239500                                  TO DP013-MESSAGE-TEXT(1)        24030000
239600         PERFORM DP013-0000-PROCESS-ABEND                         24040000
239700     END-IF.                                                      24050000
239800                                                                  24060000
239900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24070000
240000*                                                                 24080000
240100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24090000
240200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24100000
240300     END-IF.                                                      24110000
240400 EJECT                                                            24120000
240500*----------------------------------------------------------------*24130000
240600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24140000
240700*----------------------------------------------------------------*24150000
240800                                                                  24160000
240900 4420-FORMAT-LIST-LINES.                                          24170000
241000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24180000
241100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24190000
241200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           24200000
241300         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           24210000
241400         MOVE SPACE              TO MR-SELECTI (PV-SUB)           24220000
241500                                    MR-ACTION (PV-SUB)            24230000
241600                                    MR-USER-CODE (PV-SUB)         24240000
241700                                    MR-LAST-NAME (PV-SUB)         24250000
241800                                    MR-FIRST-NAME (PV-SUB)        24260000
241900                                    MR-ACTIVE (PV-SUB)            24270000
242000         MOVE ZEROES             TO MR-DC-ADD (PV-SUB)            24280000
242100     ELSE                                                         24290000
242200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24300000
242300                                                   > SPACE        24310000
242400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24320000
242500                                 TO MR-SELECTI (PV-SUB)           24330000
242600         ELSE                                                     24340000
242700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24350000
242800                                 TO MR-SELECTI (PV-SUB)           24360000
242900         END-IF                                                   24370000
243000*                                                                 24380000
243100         IF  DP030-SET-CURSOR-TRAILER                             24390000
243200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24400000
243300                 > SPACE)                                         24410000
243400               OR (PV-SUB = 1))                                   24420000
243500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24430000
243600                MOVE -1          TO MR-SELECTL (PV-SUB)           24440000
243700             END-IF                                               24450000
243800         END-IF                                                   24460000
243900*                                                                 24470000
244000         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24480000
244100             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           24490000
244200                                 TO MR-ACTION (PV-SUB)            24500000
244300                                                                  24510000
244400             MOVE ASC-USER-CODE (ASC-BLK-SUB ASC-ITEM-SUB)        24520000
244500                                 TO MR-USER-CODE (PV-SUB)         24530000
244600             MOVE ASC-LAST-NAME (ASC-BLK-SUB ASC-ITEM-SUB)        24540000
244700                                 TO MR-LAST-NAME (PV-SUB)         24550000
244800             MOVE ASC-FIRST-NAME (ASC-BLK-SUB ASC-ITEM-SUB)       24560000
244900                                 TO MR-FIRST-NAME (PV-SUB)        24570000
245000             MOVE ASC-ACTIVE (ASC-BLK-SUB ASC-ITEM-SUB)           24580000
245100                                 TO MR-ACTIVE (PV-SUB)            24590000
245200             MOVE ASC-DC-ADD (ASC-BLK-SUB ASC-ITEM-SUB)           24600000
245300                                 TO MR-DC-ADD (PV-SUB)            24610000
245400         END-IF                                                   24620000
245500     END-IF.                                                      24630000
245600     SUBTRACT +1 FROM ASC-ITEM-SUB                                24640000
245700     IF  ASC-ITEM-SUB < + 1                                       24650000
245800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24660000
245900         MOVE +1                 TO ASC-BLK-SUB                   24670000
246000     END-IF.                                                      24680000
246100******************************************************************24690000
246200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24700000
246300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24710000
246400** ISSUE A WARNING.                                             **24720000
246500******************************************************************24730000
246600 4430-CHECK-FOR-BEGIN-AND-END.                                    24740000
246700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24750000
246800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24760000
246900*            -- NO END-OF-RANGE SPECFIED ---                      24770000
247000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24780000
247100             SET DP020-MSG-WARNING TO TRUE                        24790000
247200             PERFORM 4431-POSITION-AT-WARNING                     24800000
247300         END-IF                                                   24810000
247400     ELSE                                                         24820000
247500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24830000
247600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24840000
247700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24850000
247800             SET DP020-MSG-WARNING TO TRUE                        24860000
247900             PERFORM 4431-POSITION-AT-WARNING                     24870000
248000         END-IF                                                   24880000
248100     END-IF.                                                      24890000
248200******************************************************************24900000
248300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24910000
248400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24920000
248500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24930000
248600** POSITION THE CURSOR THERE.                                   **24940000
248700******************************************************************24950000
248800 4431-POSITION-AT-WARNING.                                        24960000
248900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24970000
249000                    - PV-TOP-ITEM + 1.                            24980000
249100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24990000
249200         CONTINUE                                                 25000000
249300     ELSE                                                         25010000
249400         SET DP030-SET-CURSOR-APPL-1                              25020000
249500                                   TO TRUE                        25030000
249600         MOVE -1                   TO MR-SELECTL (PV-SUB)         25040000
249700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25050000
249800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25060000
249900     END-IF.                                                      25070000
250000*                                                                 25080000
250100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25090000
250200                    - PV-TOP-ITEM + 1.                            25100000
250300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25110000
250400         CONTINUE                                                 25120000
250500     ELSE                                                         25130000
250600         SET DP030-SET-CURSOR-APPL-1                              25140000
250700                                   TO TRUE                        25150000
250800         MOVE -1                   TO MR-SELECTL (PV-SUB)         25160000
250900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25170000
251000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25180000
251100     END-IF.                                                      25190000
251200 EJECT                                                            25200000
251300*----------------------------------------------------------------*25210000
251400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25220000
251500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25230000
251600* FOR THE SELECTED ITEMS QUEUE.                                  *25240000
251700*                                                                *25250000
251800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25260000
251900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25270000
252000* THE ARRAY IS FULL.                                             *25280000
252100*----------------------------------------------------------------*25290000
252200                                                                  25300000
252300 5000-PREPARE-SEL-QUEUE.                                          25310000
252400                                                                  25320000
252500     MOVE +1                   TO  ASC-BLK-SUB.                   25330000
252600     PERFORM 5100-WRITE-TEMP-STORAGE.                             25340000
252700     ADD +1                    TO  ASC-BLK-SUB.                   25350000
252800     PERFORM 5100-WRITE-TEMP-STORAGE.                             25360000
252900                                                                  25370000
253000     MOVE ASC-SEL-QUEUE-NAME   TO  DL002-SEL-QUEUE-NAME.          25380000
253100     PERFORM 6010-DELETE-SEL-QUEUE.                               25390000
253200                                                                  25400000
253300     SET ASC-UPDATE-TSQ        TO  TRUE.                          25410000
253400                                                                  25420000
253500     SET DL008-IDX             TO  1.                             25430000
253600     MOVE ZERO                 TO DL002-NUMBER-OF-TS-ITEMS.       25440000
253700     INITIALIZE DL008-SELECTED-ITEM-ARRAY.                        25450000
253800                                                                  25460000
253900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25470000
254000             VARYING PV-ITEM                                      25480000
254100             FROM 1 BY 1                                          25490000
254200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25500000
254300                                                                  25510000
254400     IF  DL008-IDX > 1                                            25520000
254500         PERFORM 5205-WRITE-SEL-QUEUE                             25530000
254600         ADD +1                TO DL002-NUMBER-OF-TS-ITEMS        25540000
254700     END-IF.                                                      25550000
254800/                                                                 25560000
254900*----------------------------------------------------------------*25570000
255000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25580000
255100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25590000
255200*----------------------------------------------------------------*25600000
255300                                                                  25610000
255400 5100-WRITE-TEMP-STORAGE.                                         25620000
255500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25630000
255600                                   TO PV-LIST-ITEM-NUMBER.        25640000
255700     COMPUTE PV-BLOCK-NUMBER =                                    25650000
255800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25660000
255900                                                                  25670000
256000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25680000
256100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25690000
256200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25700000
256300             PERFORM 5105-REWRITE-ASC-LISTQ                       25710000
256400         END-IF                                                   25720000
256500     ELSE                                                         25730000
256600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25740000
256700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25750000
256800         PERFORM 5110-WRITE-ASC-LISTQ                             25760000
256900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25770000
257000     END-IF.                                                      25780000
257100                                                                  25790000
257200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25800000
257300******************************************************************25810000
257400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25820000
257500** SPECIFIC COMMAREA.                                           **25830000
257600******************************************************************25840000
257700 5105-REWRITE-ASC-LISTQ.                                          25850000
257800     EXEC CICS                                                    25860000
257900         WRITEQ TS                                                25870000
258000             QUEUE (ASC-LIST-QUEUE-NAME)                          25880000
258100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25890000
258200             ITEM  (PV-BLOCK-NUMBER)                              25900000
258300             REWRITE                                              25910000
258400             RESP  (PV-CICS-RESP)                                 25920000
258500     END-EXEC.                                                    25930000
258600                                                                  25940000
258700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25950000
258800         CONTINUE                                                 25960000
258900     ELSE                                                         25970000
259000         SET DP013-CICS-ABEND            TO TRUE                  25980000
259100         SET DP013-NO-ROLLBACK           TO TRUE                  25990000
259200         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26000000
259300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26010000
259400                                         TO DP013-MESSAGE-TEXT(1) 26020000
259500         PERFORM DP013-0000-PROCESS-ABEND                         26030000
259600     END-IF.                                                      26040000
259700                                                                  26050000
259800******************************************************************26060000
259900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26070000
260000** SPECIFIC COMMAREA.                                           **26080000
260100******************************************************************26090000
260200 5110-WRITE-ASC-LISTQ.                                            26100000
260300     EXEC CICS                                                    26110000
260400         WRITEQ TS                                                26120000
260500             QUEUE (ASC-LIST-QUEUE-NAME)                          26130000
260600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26140000
260700             ITEM  (PV-BLOCK-NUMBER)                              26150000
260800             RESP  (PV-CICS-RESP)                                 26160000
260900     END-EXEC.                                                    26170000
261000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26180000
261100         SET DP013-CICS-ABEND      TO TRUE                        26190000
261200         SET DP013-NO-ROLLBACK     TO TRUE                        26200000
261300         MOVE '5110-WRITE-ASC-LISTQ'                              26210000
261400                                   TO DP013-PARAGRAPH             26220000
261500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26230000
261600                                   TO DP013-MESSAGE-TEXT(1)       26240000
261700         PERFORM DP013-0000-PROCESS-ABEND                         26250000
261800     END-IF.                                                      26260000
261900/                                                                 26270000
262000*----------------------------------------------------------------*26280000
262100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26290000
262200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26300000
262300*----------------------------------------------------------------*26310000
262400                                                                  26320000
262500 5200-FILL-SEL-QUEUE-RECORD.                                      26330000
262600                                                                  26340000
262700     PERFORM 6112-READ-LIST-QUEUE.                                26350000
262800                                                                  26360000
262900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26370000
263000         PERFORM                                                  26380000
263100         VARYING LQW-IDX                                          26390000
263200         FROM 1 BY 1                                              26400000
263300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26410000
263400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26420000
263500                                                                  26430000
263600             IF  LQW-SELECT (LQW-IDX)                             26440000
263700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26450000
263800                               TO DL008-ITEM (DL008-IDX)          26460000
263900                 MOVE LQW-USER-CODE (LQW-IDX)                     26470000
264000                               TO DL008-USER-CODE                 26480000
264100                                    (DL008-IDX)                   26490000
264200                 MOVE LQW-LAST-NAME (LQW-IDX)                     26500000
264300                               TO DL008-LAST-NAME                 26510000
264400                                    (DL008-IDX)                   26520000
264500                 MOVE LQW-FIRST-NAME (LQW-IDX)                    26530000
264600                               TO DL008-FIRST-NAME                26540000
264700                                    (DL008-IDX)                   26550000
264800                 MOVE LQW-ACTIVE (LQW-IDX)                        26560000
264900                               TO DL008-ACTIVE                    26570000
265000                                    (DL008-IDX)                   26580000
265100                 MOVE LQW-DC-ADD (LQW-IDX)                        26590000
265200                               TO DL008-ADDED-BY-DC-NBR           26600000
265300                                    (DL008-IDX)                   26610000
265400                 MOVE LQW-ACTION (LQW-IDX)                        26620000
265500                               TO DL008-ACTION-SW (DL008-IDX)     26630000
265600                 SET DL008-IDX UP BY 1                            26640000
265700                 IF  DL008-IDX > DL008-MAX-ITEMS                  26650000
265800                     PERFORM 5205-WRITE-SEL-QUEUE                 26660000
265900                     ADD +1    TO DL002-NUMBER-OF-TS-ITEMS        26670000
266000                     INITIALIZE DL008-SELECTED-ITEM-ARRAY         26680000
266100                     SET DL008-IDX TO  1                          26690000
266200                 END-IF                                           26700000
266300             END-IF                                               26710000
266400         END-PERFORM                                              26720000
266500     END-IF.                                                      26730000
266600                                                                  26740000
266700*----------------------------------------------------------------*26750000
266800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26760000
266900*----------------------------------------------------------------*26770000
267000                                                                  26780000
267100 5205-WRITE-SEL-QUEUE.                                            26790000
267200                                                                  26800000
267300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26810000
267400                                   TO DL008-SELECTED-ITEMS.       26820000
267500                                                                  26830000
267600     EXEC CICS                                                    26840000
267700          WRITEQ TS                                               26850000
267800              QUEUE (ASC-SEL-QUEUE-NAME)                          26860000
267900              FROM  (DL008-TEMP-ASSOC-SELECT-RECORD)              26870000
268000              ITEM  (PV-SEL-QUEUE-ITEM)                           26880000
268100              RESP  (PV-CICS-RESP)                                26890000
268200     END-EXEC.                                                    26900000
268300                                                                  26910000
268400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26920000
268500         CONTINUE                                                 26930000
268600     ELSE                                                         26940000
268700         SET DP013-CICS-ABEND      TO TRUE                        26950000
268800         SET DP013-NO-ROLLBACK     TO TRUE                        26960000
268900         MOVE '5205-WRITE-SEL-QUEUE'                              26970000
269000                                   TO DP013-PARAGRAPH             26980000
269100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26990000
269200                                   TO DP013-MESSAGE-TEXT(1)       27000000
269300         PERFORM DP013-0000-PROCESS-ABEND                         27010000
269400     END-IF.                                                      27020000
269500 EJECT                                                            27030000
269600******************************************************************27040000
269700** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27050000
269800** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27060000
269900** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27070000
270000** THE USER.                                                    **27080000
270100******************************************************************27090000
270200 6000-REFRESH-PANEL-FROM-TEMP.                                    27100000
270300     IF  ASC-UPDATE-TSQ                                           27110000
270400         SET ASC-NO-TSQ-UPDATE TO TRUE                            27120000
270500         MOVE ZERO                 TO PV-SAVE-ITEM                27130000
270600                                      PV-SEL-QUEUE-ITEM           27140000
270700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27150000
270800                                   TO PV-HOLD-SELECTED-ITEMS      27160000
270900         MOVE +1                   TO PV-ITEMS-PROCESSED          27170000
271000         PERFORM 6100-UPDATE-TSQ                                  27180000
271100             UNTIL PV-ITEMS-PROCESSED >                           27190000
271200                                     PV-HOLD-SELECTED-ITEMS       27200000
271300         PERFORM 6010-DELETE-SEL-QUEUE                            27210000
271400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27220000
271500                    ASC-BLOCK-ENTRIES (2)                         27230000
271600     END-IF.                                                      27240000
271700                                                                  27250000
271800*----------------------------------------------------------------*27260000
271900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27270000
272000*----------------------------------------------------------------*27280000
272100 6010-DELETE-SEL-QUEUE.                                           27290000
272200                                                                  27300000
272300     EXEC CICS                                                    27310000
272400         DELETEQ TS                                               27320000
272500             QUEUE (ASC-SEL-QUEUE-NAME)                           27330000
272600             RESP  (PV-CICS-RESP)                                 27340000
272700     END-EXEC.                                                    27350000
272800*                                                                 27360000
272900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27370000
273000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27380000
273100         CONTINUE                                                 27390000
273200     ELSE                                                         27400000
273300         SET DP013-CICS-ABEND TO TRUE                             27410000
273400         SET DP013-NO-ROLLBACK TO TRUE                            27420000
273500         MOVE '6010-DELETE-SEL-QUEUE'                             27430000
273600                        TO DP013-PARAGRAPH                        27440000
273700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27450000
273800                        TO DP013-MESSAGE-TEXT (1)                 27460000
273900         PERFORM DP013-0000-PROCESS-ABEND                         27470000
274000     END-IF.                                                      27480000
274100                                                                  27490000
274200*----------------------------------------------------------------*27500000
274300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27510000
274400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27520000
274500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27530000
274600*    THE TEMP QUEUE.                                             *27540000
274700*----------------------------------------------------------------*27550000
274800                                                                  27560000
274900 6100-UPDATE-TSQ.                                                 27570000
275000                                                                  27580000
275100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             27590000
275200     PERFORM 6105-READ-SEL-QUEUE.                                 27600000
275300     PERFORM                                                      27610000
275400         VARYING DL008-IDX                                        27620000
275500         FROM 1 BY 1                                              27630000
275600         UNTIL ((PV-ITEMS-PROCESSED >                             27640000
275700                              PV-HOLD-SELECTED-ITEMS)             27650000
275800         OR (DL008-IDX GREATER THAN DL008-MAX-ITEMS))             27660000
275900         IF  DL008-ACTION-SW (DL008-IDX) > SPACE                  27670000
276000             PERFORM 6110-PROCESS-ITEMS                           27680000
276100         END-IF                                                   27690000
276200         ADD +1                TO PV-ITEMS-PROCESSED              27700000
276300     END-PERFORM.                                                 27710000
276400     PERFORM 6111-WRITE-LIST-QUEUE.                               27720000
276500*----------------------------------------------------------------*27730000
276600*    READ THE LIST QUEUE RECORD.                                 *27740000
276700*----------------------------------------------------------------*27750000
276800                                                                  27760000
276900 6105-READ-SEL-QUEUE.                                             27770000
277000                                                                  27780000
277100     EXEC CICS                                                    27790000
277200          READQ TS                                                27800000
277300              QUEUE (ASC-SEL-QUEUE-NAME)                          27810000
277400              INTO  (DL008-TEMP-ASSOC-SELECT-RECORD)              27820000
277500              ITEM  (PV-SEL-QUEUE-ITEM)                           27830000
277600              RESP  (PV-CICS-RESP)                                27840000
277700     END-EXEC.                                                    27850000
277800*                                                                 27860000
277900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27870000
278000         CONTINUE                                                 27880000
278100     ELSE                                                         27890000
278200         SET DP013-CICS-ABEND      TO  TRUE                       27900000
278300         SET DP013-NO-ROLLBACK     TO  TRUE                       27910000
278400         MOVE '6105-READ-SEL-QUEUE'                               27920000
278500                                   TO  DP013-PARAGRAPH            27930000
278600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           27940000
278700                                   TO  DP013-MESSAGE-TEXT(1)      27950000
278800         PERFORM DP013-0000-PROCESS-ABEND                         27960000
278900     END-IF.                                                      27970000
279000 EJECT                                                            27980000
279100*----------------------------------------------------------------*27990000
279200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28000000
279300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28010000
279400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28020000
279500*----------------------------------------------------------------*28030000
279600                                                                  28040000
279700 6110-PROCESS-ITEMS.                                              28050000
279800                                                                  28060000
279900     COMPUTE PV-ITEM = 1 + ((DL008-ITEM (DL008-IDX) - 1)          28070000
280000                     / PC-ITEMS-PER-PANEL).                       28080000
280100                                                                  28090000
280200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28100000
280300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28110000
280400             PERFORM 6111-WRITE-LIST-QUEUE                        28120000
280500         END-IF                                                   28130000
280600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28140000
280700                                                                  28150000
280800         PERFORM 6112-READ-LIST-QUEUE                             28160000
280900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28170000
281000             CONTINUE                                             28180000
281100         END-IF                                                   28190000
281200     END-IF.                                                      28200000
281300                                                                  28210000
281400     COMPUTE PV-SUB = (DL008-ITEM (DL008-IDX)                     28220000
281500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28230000
281600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28240000
281700     MOVE LQW-SELECTED-SW (PV-SUB)                                28250000
281800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28260000
281900     EVALUATE TRUE                                                28270000
282000         WHEN DL008-INQ (DL008-IDX)                               28280000
282100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28290000
282200                                                                  28300000
282300         WHEN DL008-UPD (DL008-IDX)                               28310000
282400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28320000
282500              MOVE DL008-LAST-NAME (DL008-IDX)                    28330000
282600                               TO LQW-LAST-NAME (PV-SUB)          28340000
282700              MOVE DL008-FIRST-NAME (DL008-IDX)                   28350000
282800                               TO LQW-FIRST-NAME (PV-SUB)         28360000
282900              MOVE DL008-ACTIVE (DL008-IDX)                       28370000
283000                               TO LQW-ACTIVE (PV-SUB)             28380000
283100                                                                  28390000
283200         WHEN DL008-DEL (DL008-IDX)                               28400000
283300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28410000
283400                                                                  28420000
283500         WHEN DL008-ERR (DL008-IDX)                               28430000
283600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28440000
283700     END-EVALUATE.                                                28450000
283800                                                                  28460000
283900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28470000
284000                                                                  28480000
284100*----------------------------------------------------------------*28490000
284200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28500000
284300*----------------------------------------------------------------*28510000
284400                                                                  28520000
284500 6111-WRITE-LIST-QUEUE.                                           28530000
284600                                                                  28540000
284700     EXEC CICS                                                    28550000
284800         WRITEQ TS                                                28560000
284900             QUEUE (ASC-LIST-QUEUE-NAME)                          28570000
285000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28580000
285100             ITEM  (PV-SAVE-ITEM)                                 28590000
285200             REWRITE                                              28600000
285300             RESP  (PV-CICS-RESP)                                 28610000
285400     END-EXEC.                                                    28620000
285500*                                                                 28630000
285600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28640000
285700         CONTINUE                                                 28650000
285800     ELSE                                                         28660000
285900         SET DP013-CICS-ABEND  TO  TRUE                           28670000
286000         SET DP013-NO-ROLLBACK TO  TRUE                           28680000
286100         MOVE '6111-WRITE-LIST-QUEUE'                             28690000
286200                               TO  DP013-PARAGRAPH                28700000
286300         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28710000
286400                               TO  DP013-MESSAGE-TEXT(1)          28720000
286500         PERFORM DP013-0000-PROCESS-ABEND                         28730000
286600     END-IF.                                                      28740000
286700                                                                  28750000
286800 EJECT                                                            28760000
286900*----------------------------------------------------------------*28770000
287000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*28780000
287100*----------------------------------------------------------------*28790000
287200                                                                  28800000
287300 6112-READ-LIST-QUEUE.                                            28810000
287400                                                                  28820000
287500     EXEC CICS                                                    28830000
287600         READQ TS                                                 28840000
287700             QUEUE (ASC-LIST-QUEUE-NAME)                          28850000
287800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     28860000
287900             ITEM  (PV-ITEM)                                      28870000
288000             RESP  (PV-CICS-RESP)                                 28880000
288100     END-EXEC.                                                    28890000
288200*                                                                 28900000
288300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28910000
288400         CONTINUE                                                 28920000
288500     ELSE                                                         28930000
288600         SET DP013-CICS-ABEND        TO TRUE                      28940000
288700         SET DP013-NO-ROLLBACK       TO TRUE                      28950000
288800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           28960000
288900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    28970000
289000                                     TO DP013-MESSAGE-TEXT(1)     28980000
289100         PERFORM DP013-0000-PROCESS-ABEND                         28990000
289200     END-IF.                                                      29000000
289300/                                                                 29010000
289400                                                                  29020000
289500 7010-LOCATION-DESC.                                              29030000
289600     MOVE DP020-LOCATION-NBR          TO XLT00010-LOC-NBR         29040006
289700                                                                  29050000
289800     EXEC SQL                                                     29060000
289900         SELECT  LOC_NM                                           29070000
290000           INTO  :XLT00010-LOC-NM                                 29080000
290100           FROM  XLT_LOC                                          29090000
290200         WHERE LOC_NBR        = :XLT00010-LOC-NBR                 29100000
290300     END-EXEC                                                     29110000
290400                                                                  29120000
290500     EVALUATE TRUE                                                29130000
290600         WHEN SQLCODE = ZERO                                      29140000
290700             MOVE XLT00010-LOC-NM     TO ASC-KEY-OPER-DESC        29150000
290800                                         DL002-OPER-DESC          29160000
290900                                         ASC-OPER-DESC-ORIG       29170000
291000         WHEN SQLCODE = +100                                      29180000
291100             MOVE ALL '?'             TO ASC-KEY-OPER-DESC        29190000
291200         WHEN SQLCODE = -904                                      29200000
291300         WHEN SQLCODE = -911                                      29210000
291400         WHEN SQLCODE = -913                                      29220000
291500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29230000
291600             MOVE '7010-LOCATION-DESC'      TO PV-SOFT-PARAGRAPH  29240000
291700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29250000
291800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29260000
291900               TO PV-COMMAREA-LENGTH                              29270000
292000             EXEC CICS                                            29280000
292100                  WRITEQ TD                                       29290000
292200                   QUEUE  ('CSSL')                                29300000
292300                    FROM  (PV-CICS-MSG-AREA2)                     29310000
292400                  LENGTH  (PV-COMMAREA-LENGTH)                    29320000
292500                    RESP  (PV-CICS-RESP)                          29330000
292600             END-EXEC                                             29340000
292700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29350000
292800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29360000
292900             PERFORM 9900-SOFT-ABORT                              29370000
293000         WHEN OTHER                                               29380000
293100              MOVE '7010-LOCATION-DESC'                           29390000
293200                               TO DP013-PARAGRAPH                 29400000
293300              MOVE 'GET LOCATION DESCRIPTION'                     29410000
293400                               TO DP013-MESSAGE-TEXT (1)          29420000
293500              MOVE SQLCA       TO DP013-SQLCA                     29430000
293600              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        29440000
293700              SET DP013-DB2-ABEND                                 29450000
293800                  DP013-XCTL-DISPLAY-RESTART                      29460000
293900                                   TO TRUE                        29470000
294000                  PERFORM DP013-0000-PROCESS-ABEND                29480000
294100     END-EVALUATE.                                                29490000
294200                                                                  29500000
294300                                                                  29510000
294400/                                                                 29520000
294500*----------------------------------------------------------------*29530000
294600* OPEN CURSOR(S)                                                 *29540000
294700*----------------------------------------------------------------*29550000
294800                                                                  29560000
294900 7100LA-OPEN-LAST-NAME-ALL-CSR.                                   29570000
295000                                                                  29580000
295100     EXEC SQL                                                     29590000
295200         OPEN LAST-NAME-ALL-CSR                                   29600000
295300     END-EXEC                                                     29610000
295400                                                                  29620000
295500     EVALUATE TRUE                                                29630000
295600         WHEN SQLCODE = ZERO                                      29640000
295700             CONTINUE                                             29650000
295800         WHEN SQLCODE = -904                                      29660000
295900         WHEN SQLCODE = -911                                      29670000
296000         WHEN SQLCODE = -913                                      29680000
296100             MOVE '7100LD-OPEN-LAST-NAME-ALL-CSR'                 29690000
296200                                      TO DP013-PARAGRAPH          29700000
296300             MOVE 'DB2 TIMEOUT ATTEMPTING TO OPEN CSR'            29710000
296400                                      TO DP013-MESSAGE-TEXT (1)   29720000
296500             MOVE SQLCA               TO DP013-SQLCA              29730000
296600             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 29740000
296700             SET DP013-DB2-ABEND                                  29750000
296800                 DP013-XCTL-DISPLAY-RESTART                       29760000
296900                                      TO TRUE                     29770000
297000             PERFORM DP013-0000-PROCESS-ABEND                     29780000
297100         WHEN SQLWARN0 NOT = SPACES                               29790000
297200         WHEN SQLCODE < ZERO                                      29800000
297300         WHEN SQLCODE > ZERO                                      29810000
297400             MOVE '7100LD-OPEN-LAST-NAME-ALL-CSR'                 29820000
297500                                      TO DP013-PARAGRAPH          29830000
297600             MOVE 'OPEN LAST NAME ALL CURSOR - '                  29840000
297700                                      TO DP013-MESSAGE-TEXT (1)   29850000
297800             MOVE SQLCA               TO DP013-SQLCA              29860000
297900             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 29870000
298000             SET DP013-DB2-ABEND                                  29880000
298100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29890000
298200             PERFORM DP013-0000-PROCESS-ABEND                     29900000
298300     END-EVALUATE.                                                29910000
298400                                                                  29920000
298500 7100LD-OPEN-LAST-NAME-DC-CSR.                                    29930000
298600                                                                  29940000
298700     EXEC SQL                                                     29950000
298800         OPEN LAST-NAME-DC-CSR                                    29960000
298900     END-EXEC                                                     29970000
299000                                                                  29980000
299100     EVALUATE TRUE                                                29990000
299200         WHEN SQLCODE = ZERO                                      30000000
299300             CONTINUE                                             30010000
299400         WHEN SQLCODE = -904                                      30020000
299500         WHEN SQLCODE = -911                                      30030000
299600         WHEN SQLCODE = -913                                      30040000
299700             MOVE '7100LD-OPEN-LAST-NAME-DC-CSR'                  30050000
299800                                      TO DP013-PARAGRAPH          30060000
299900             MOVE 'DB2 TIMEOUT ATTEMPTING TO OPEN CSR'            30070000
300000                                      TO DP013-MESSAGE-TEXT (1)   30080000
300100             MOVE SQLCA               TO DP013-SQLCA              30090000
300200             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30100000
300300             SET DP013-DB2-ABEND                                  30110000
300400                 DP013-XCTL-DISPLAY-RESTART                       30120000
300500                                      TO TRUE                     30130000
300600             PERFORM DP013-0000-PROCESS-ABEND                     30140000
300700         WHEN SQLWARN0 NOT = SPACES                               30150000
300800         WHEN SQLCODE < ZERO                                      30160000
300900         WHEN SQLCODE > ZERO                                      30170000
301000             MOVE '7100LD-OPEN-LAST-NAME-DC-CSR'                  30180000
301100                                      TO DP013-PARAGRAPH          30190000
301200             MOVE 'OPEN LAST NAME DC CURSOR - '                   30200000
301300                                      TO DP013-MESSAGE-TEXT (1)   30210000
301400             MOVE SQLCA               TO DP013-SQLCA              30220000
301500             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30230000
301600             SET DP013-DB2-ABEND                                  30240000
301700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30250000
301800             PERFORM DP013-0000-PROCESS-ABEND                     30260000
301900     END-EVALUATE.                                                30270000
302000                                                                  30280000
302100 7100UA-OPEN-USER-CODE-ALL-CSR.                                   30290000
302200                                                                  30300000
302300     EXEC SQL                                                     30310000
302400         OPEN USER-CODE-ALL-CSR                                   30320000
302500     END-EXEC                                                     30330000
302600                                                                  30340000
302700     EVALUATE TRUE                                                30350000
302800         WHEN SQLCODE = ZERO                                      30360000
302900             CONTINUE                                             30370000
303000         WHEN SQLCODE = -904                                      30380000
303100         WHEN SQLCODE = -911                                      30390000
303200         WHEN SQLCODE = -913                                      30400000
303300             MOVE '7100UA-OPEN-USER-CODE-ALL-CSR'                 30410000
303400                                      TO DP013-PARAGRAPH          30420000
303500             MOVE 'DB2 TIMEOUT ATTEMPTING TO OPEN CSR'            30430000
303600                                      TO DP013-MESSAGE-TEXT (1)   30440000
303700             MOVE SQLCA               TO DP013-SQLCA              30450000
303800             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30460000
303900             SET DP013-DB2-ABEND                                  30470000
304000                 DP013-XCTL-DISPLAY-RESTART                       30480000
304100                                      TO TRUE                     30490000
304200             PERFORM DP013-0000-PROCESS-ABEND                     30500000
304300         WHEN SQLWARN0 NOT = SPACES                               30510000
304400         WHEN SQLCODE < ZERO                                      30520000
304500         WHEN SQLCODE > ZERO                                      30530000
304600             MOVE '7100UA-OPEN-USER-CODE-ALL-CSR'                 30540000
304700                                      TO DP013-PARAGRAPH          30550000
304800             MOVE 'OPEN USER CODE ALL CURSOR - '                  30560000
304900                                      TO DP013-MESSAGE-TEXT (1)   30570000
305000             MOVE SQLCA               TO DP013-SQLCA              30580000
305100             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30590000
305200             SET DP013-DB2-ABEND                                  30600000
305300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30610000
305400             PERFORM DP013-0000-PROCESS-ABEND                     30620000
305500     END-EVALUATE.                                                30630000
305600                                                                  30640000
305700 7100UD-OPEN-USER-CODE-DC-CSR.                                    30650000
305800                                                                  30660000
305900     EXEC SQL                                                     30670000
306000         OPEN USER-CODE-DC-CSR                                    30680000
306100     END-EXEC                                                     30690000
306200                                                                  30700000
306300     EVALUATE TRUE                                                30710000
306400         WHEN SQLCODE = ZERO                                      30720000
306500             CONTINUE                                             30730000
306600         WHEN SQLCODE = -904                                      30740000
306700         WHEN SQLCODE = -911                                      30750000
306800         WHEN SQLCODE = -913                                      30760000
306900             MOVE '7100UD-OPEN-USER-CODE-DC-CSR'                  30770000
307000                                      TO DP013-PARAGRAPH          30780000
307100             MOVE 'DB2 TIMEOUT ATTEMPTING TO OPEN CSR'            30790000
307200                                      TO DP013-MESSAGE-TEXT (1)   30800000
307300             MOVE SQLCA               TO DP013-SQLCA              30810000
307400             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30820000
307500             SET DP013-DB2-ABEND                                  30830000
307600                 DP013-XCTL-DISPLAY-RESTART                       30840000
307700                                      TO TRUE                     30850000
307800             PERFORM DP013-0000-PROCESS-ABEND                     30860000
307900         WHEN SQLWARN0 NOT = SPACES                               30870000
308000         WHEN SQLCODE < ZERO                                      30880000
308100         WHEN SQLCODE > ZERO                                      30890000
308200             MOVE '7100UD-OPEN-USER-CODE-DC-CSR'                  30900000
308300                                      TO DP013-PARAGRAPH          30910000
308400             MOVE 'OPEN USER CODE DC CURSOR - '                   30920000
308500                                      TO DP013-MESSAGE-TEXT (1)   30930000
308600             MOVE SQLCA               TO DP013-SQLCA              30940000
308700             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 30950000
308800             SET DP013-DB2-ABEND                                  30960000
308900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30970000
309000             PERFORM DP013-0000-PROCESS-ABEND                     30980000
309100     END-EVALUATE.                                                30990000
309200                                                                  31000000
309300*----------------------------------------------------------------*31010000
309400*  FETCH CURSOR(S)                                               *31020000
309500*----------------------------------------------------------------*31030000
309600 7110LA-FETCH-LAST-NAME-ALL-CSR.                                  31040000
309700                                                                  31050000
309800     EXEC SQL                                                     31060000
309900         FETCH LAST-NAME-ALL-CSR                                  31070000
310000         INTO                                                     31080000
310100             :DLT00002-TMP-USR-ID                                 31090000
310200         ,   :DLT00002-DC-NBR                                     31100000
310300         ,   :DLT00002-FRST-NM                                    31110000
310400         ,   :DLT00002-LAST-NM                                    31120000
310500         ,   :DLT00002-ACTV-IND                                   31130000
310600     END-EXEC                                                     31140000
310700                                                                  31150000
310800     EVALUATE TRUE                                                31160000
310900         WHEN SQLCODE = ZERO                                      31170000
311000             CONTINUE                                             31180000
311100         WHEN SQLCODE = +100                                      31190000
311200              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 31200000
311300                                                                  31210000
311400         WHEN SQLCODE = -904                                      31220000
311500         WHEN SQLCODE = -911                                      31230000
311600         WHEN SQLCODE = -913                                      31240000
311700             MOVE '7110LA-FETCH-LAST-NAME-ALL-CSR'                31250000
311800                                      TO DP013-PARAGRAPH          31260000
311900             MOVE 'DB2 TIMEOUT ATTEMPTING TO FETCH CSR'           31270000
312000                                      TO DP013-MESSAGE-TEXT (1)   31280000
312100             MOVE SQLCA               TO DP013-SQLCA              31290000
312200             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 31300000
312300             SET DP013-DB2-ABEND                                  31310000
312400                 DP013-XCTL-DISPLAY-RESTART                       31320000
312500                                      TO TRUE                     31330000
312600             PERFORM DP013-0000-PROCESS-ABEND                     31340000
312700         WHEN SQLWARN0 NOT = SPACE                                31350000
312800         WHEN SQLCODE NOT = ZERO                                  31360000
312900              MOVE '7110LA-FETCH-LAST-NAME-ALL-CSR'               31370000
313000                               TO DP013-PARAGRAPH                 31380000
313100              MOVE 'FETCH LAST NAME ALL CURSOR'                   31390000
313200                               TO DP013-MESSAGE-TEXT (1)          31400000
313300              MOVE SQLCA       TO DP013-SQLCA                     31410000
313400              SET DP013-DB2-ABEND                                 31420000
313500                               TO TRUE                            31430000
313600              PERFORM DP013-0000-PROCESS-ABEND                    31440000
313700     END-EVALUATE.                                                31450000
313800                                                                  31460000
313900 7110LD-FETCH-LAST-NAME-DC-CSR.                                   31470000
314000                                                                  31480000
314100     EXEC SQL                                                     31490000
314200         FETCH LAST-NAME-DC-CSR                                   31500000
314300         INTO                                                     31510000
314400             :DLT00002-TMP-USR-ID                                 31520000
314500         ,   :DLT00002-DC-NBR                                     31530000
314600         ,   :DLT00002-FRST-NM                                    31540000
314700         ,   :DLT00002-LAST-NM                                    31550000
314800         ,   :DLT00002-ACTV-IND                                   31560000
314900     END-EXEC                                                     31570000
315000                                                                  31580000
315100     EVALUATE TRUE                                                31590000
315200         WHEN SQLCODE = ZERO                                      31600000
315300             CONTINUE                                             31610000
315400         WHEN SQLCODE = +100                                      31620000
315500              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 31630000
315600                                                                  31640000
315700         WHEN SQLCODE = -904                                      31650000
315800         WHEN SQLCODE = -911                                      31660000
315900         WHEN SQLCODE = -913                                      31670000
316000             MOVE '7110LD-FETCH-LAST-NAME-DC-CSR'                 31680000
316100                                      TO DP013-PARAGRAPH          31690000
316200             MOVE 'DB2 TIMEOUT ATTEMPTING TO FETCH CSR'           31700000
316300                                      TO DP013-MESSAGE-TEXT (1)   31710000
316400             MOVE SQLCA               TO DP013-SQLCA              31720000
316500             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 31730000
316600             SET DP013-DB2-ABEND                                  31740000
316700                 DP013-XCTL-DISPLAY-RESTART                       31750000
316800                                      TO TRUE                     31760000
316900             PERFORM DP013-0000-PROCESS-ABEND                     31770000
317000         WHEN SQLWARN0 NOT = SPACE                                31780000
317100         WHEN SQLCODE NOT = ZERO                                  31790000
317200              MOVE '7110LD-FETCH-LAST-NAME-DC-CSR'                31800000
317300                               TO DP013-PARAGRAPH                 31810000
317400              MOVE 'FETCH LAST NAME DC CURSOR'                    31820000
317500                               TO DP013-MESSAGE-TEXT (1)          31830000
317600              MOVE SQLCA       TO DP013-SQLCA                     31840000
317700              SET DP013-DB2-ABEND                                 31850000
317800                               TO TRUE                            31860000
317900              PERFORM DP013-0000-PROCESS-ABEND                    31870000
318000     END-EVALUATE.                                                31880000
318100                                                                  31890000
318200 7110UA-FETCH-USER-CODE-ALL-CSR.                                  31900000
318300                                                                  31910000
318400     EXEC SQL                                                     31920000
318500         FETCH USER-CODE-ALL-CSR                                  31930000
318600         INTO                                                     31940000
318700             :DLT00002-TMP-USR-ID                                 31950000
318800         ,   :DLT00002-DC-NBR                                     31960000
318900         ,   :DLT00002-FRST-NM                                    31970000
319000         ,   :DLT00002-LAST-NM                                    31980000
319100         ,   :DLT00002-ACTV-IND                                   31990000
319200     END-EXEC                                                     32000000
319300                                                                  32010000
319400     EVALUATE TRUE                                                32020000
319500         WHEN SQLCODE = ZERO                                      32030000
319600             CONTINUE                                             32040000
319700         WHEN SQLCODE = +100                                      32050000
319800              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 32060000
319900                                                                  32070000
320000         WHEN SQLCODE = -904                                      32080000
320100         WHEN SQLCODE = -911                                      32090000
320200         WHEN SQLCODE = -913                                      32100000
320300             MOVE '7110UA-FETCH-USER-CODE-ALL-CSR'                32110000
320400                                      TO DP013-PARAGRAPH          32120000
320500             MOVE 'DB2 TIMEOUT ATTEMPTING TO FETCH CSR'           32130000
320600                                      TO DP013-MESSAGE-TEXT (1)   32140000
320700             MOVE SQLCA               TO DP013-SQLCA              32150000
320800             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 32160000
320900             SET DP013-DB2-ABEND                                  32170000
321000                 DP013-XCTL-DISPLAY-RESTART                       32180000
321100                                      TO TRUE                     32190000
321200             PERFORM DP013-0000-PROCESS-ABEND                     32200000
321300         WHEN SQLWARN0 NOT = SPACE                                32210000
321400         WHEN SQLCODE NOT = ZERO                                  32220000
321500              MOVE '7110UA-FETCH-USER-CODE-ALL-CSR'               32230000
321600                               TO DP013-PARAGRAPH                 32240000
321700              MOVE 'FETCH USER CODE ALL CURSOR'                   32250000
321800                               TO DP013-MESSAGE-TEXT (1)          32260000
321900              MOVE SQLCA       TO DP013-SQLCA                     32270000
322000              SET DP013-DB2-ABEND                                 32280000
322100                               TO TRUE                            32290000
322200              PERFORM DP013-0000-PROCESS-ABEND                    32300000
322300     END-EVALUATE.                                                32310000
322400                                                                  32320000
322500 7110UD-FETCH-USER-CODE-DC-CSR.                                   32330000
322600                                                                  32340000
322700     EXEC SQL                                                     32350000
322800         FETCH USER-CODE-DC-CSR                                   32360000
322900         INTO                                                     32370000
323000             :DLT00002-TMP-USR-ID                                 32380000
323100         ,   :DLT00002-DC-NBR                                     32390000
323200         ,   :DLT00002-FRST-NM                                    32400000
323300         ,   :DLT00002-LAST-NM                                    32410000
323400         ,   :DLT00002-ACTV-IND                                   32420000
323500     END-EXEC                                                     32430000
323600                                                                  32440000
323700     EVALUATE TRUE                                                32450000
323800         WHEN SQLCODE = ZERO                                      32460000
323900             CONTINUE                                             32470000
324000         WHEN SQLCODE = +100                                      32480000
324100              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 32490000
324200                                                                  32500000
324300         WHEN SQLCODE = -904                                      32510000
324400         WHEN SQLCODE = -911                                      32520000
324500         WHEN SQLCODE = -913                                      32530000
324600             MOVE '7110UD-FETCH-USER-CODE-DC-CSR'                 32540000
324700                                      TO DP013-PARAGRAPH          32550000
324800             MOVE 'DB2 TIMEOUT ATTEMPTING TO FETCH CSR'           32560000
324900                                      TO DP013-MESSAGE-TEXT (1)   32570000
325000             MOVE SQLCA               TO DP013-SQLCA              32580000
325100             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 32590000
325200             SET DP013-DB2-ABEND                                  32600000
325300                 DP013-XCTL-DISPLAY-RESTART                       32610000
325400                                      TO TRUE                     32620000
325500             PERFORM DP013-0000-PROCESS-ABEND                     32630000
325600         WHEN SQLWARN0 NOT = SPACE                                32640000
325700         WHEN SQLCODE NOT = ZERO                                  32650000
325800              MOVE '7110UD-FETCH-USER-CODE-DC-CSR'                32660000
325900                               TO DP013-PARAGRAPH                 32670000
326000              MOVE 'FETCH USER CODE DC CURSOR'                    32680000
326100                               TO DP013-MESSAGE-TEXT (1)          32690000
326200              MOVE SQLCA       TO DP013-SQLCA                     32700000
326300              SET DP013-DB2-ABEND                                 32710000
326400                               TO TRUE                            32720000
326500              PERFORM DP013-0000-PROCESS-ABEND                    32730000
326600     END-EVALUATE.                                                32740000
326700                                                                  32750000
326800*----------------------------------------------------------------*32760000
326900*  CLOSE CURSOR(S)                                               *32770000
327000*----------------------------------------------------------------*32780000
327100 7120LA-CLOSE-LAST-NAME-ALL-CSR.                                  32790000
327200                                                                  32800000
327300     EXEC SQL                                                     32810000
327400         CLOSE LAST-NAME-ALL-CSR                                  32820000
327500     END-EXEC                                                     32830000
327600                                                                  32840000
327700     EVALUATE TRUE                                                32850000
327800         WHEN SQLCODE = ZERO                                      32860000
327900             CONTINUE                                             32870000
328000         WHEN SQLWARN0 NOT = SPACES                               32880000
328100         WHEN SQLCODE < ZERO                                      32890000
328200         WHEN SQLCODE > ZERO                                      32900000
328300             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 32910000
328400             MOVE '7120LA-CLOSE-LAST-NAME-ALL-CSR'                32920000
328500                                      TO DP013-PARAGRAPH          32930000
328600             MOVE 'CLOSE LAST NAME ALL CURSOR'                    32940000
328700                                      TO DP013-MESSAGE-TEXT (1)   32950000
328800             MOVE SQLCA               TO DP013-SQLCA              32960000
328900             SET DP013-DB2-ABEND                                  32970000
329000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32980000
329100             PERFORM DP013-0000-PROCESS-ABEND                     32990000
329200     END-EVALUATE.                                                33000000
329300                                                                  33010000
329400 7120LD-CLOSE-LAST-NAME-DC-CSR.                                   33020000
329500                                                                  33030000
329600     EXEC SQL                                                     33040000
329700         CLOSE LAST-NAME-DC-CSR                                   33050000
329800     END-EXEC                                                     33060000
329900                                                                  33070000
330000     EVALUATE TRUE                                                33080000
330100         WHEN SQLCODE = ZERO                                      33090000
330200             CONTINUE                                             33100000
330300         WHEN SQLWARN0 NOT = SPACES                               33110000
330400         WHEN SQLCODE < ZERO                                      33120000
330500         WHEN SQLCODE > ZERO                                      33130000
330600             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 33140000
330700             MOVE '7120LD-CLOSE-LAST-NAME-DC-CSR'                 33150000
330800                                      TO DP013-PARAGRAPH          33160000
330900             MOVE 'CLOSE LAST NAME DC CURSOR'                     33170000
331000                                      TO DP013-MESSAGE-TEXT (1)   33180000
331100             MOVE SQLCA               TO DP013-SQLCA              33190000
331200             SET DP013-DB2-ABEND                                  33200000
331300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33210000
331400             PERFORM DP013-0000-PROCESS-ABEND                     33220000
331500     END-EVALUATE.                                                33230000
331600                                                                  33240000
331700 7120UA-CLOSE-USER-CODE-ALL-CSR.                                  33250000
331800                                                                  33260000
331900     EXEC SQL                                                     33270000
332000         CLOSE USER-CODE-ALL-CSR                                  33280000
332100     END-EXEC                                                     33290000
332200                                                                  33300000
332300     EVALUATE TRUE                                                33310000
332400         WHEN SQLCODE = ZERO                                      33320000
332500             CONTINUE                                             33330000
332600         WHEN SQLWARN0 NOT = SPACES                               33340000
332700         WHEN SQLCODE < ZERO                                      33350000
332800         WHEN SQLCODE > ZERO                                      33360000
332900             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 33370000
333000             MOVE '7120UA-CLOSE-USER-CODE-ALL-CSR'                33380000
333100                                      TO DP013-PARAGRAPH          33390000
333200             MOVE 'CLOSE USER CODE ALL CURSOR'                    33400000
333300                                      TO DP013-MESSAGE-TEXT (1)   33410000
333400             MOVE SQLCA               TO DP013-SQLCA              33420000
333500             SET DP013-DB2-ABEND                                  33430000
333600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33440000
333700             PERFORM DP013-0000-PROCESS-ABEND                     33450000
333800     END-EVALUATE.                                                33460000
333900                                                                  33470000
334000 7120UD-CLOSE-USER-CODE-DC-CSR.                                   33480000
334100                                                                  33490000
334200     EXEC SQL                                                     33500000
334300         CLOSE USER-CODE-DC-CSR                                   33510000
334400     END-EXEC                                                     33520000
334500                                                                  33530000
334600     EVALUATE TRUE                                                33540000
334700         WHEN SQLCODE = ZERO                                      33550000
334800             CONTINUE                                             33560000
334900         WHEN SQLWARN0 NOT = SPACES                               33570000
335000         WHEN SQLCODE < ZERO                                      33580000
335100         WHEN SQLCODE > ZERO                                      33590000
335200             MOVE 'DLT_TMP_EMP'       TO DP013-DB2-TABLE-NAME (1) 33600000
335300             MOVE '7120UD-CLOSE-USER-CODE-DC-CSR'                 33610000
335400                                      TO DP013-PARAGRAPH          33620000
335500             MOVE 'CLOSE USER CODE DC CURSOR'                     33630000
335600                                      TO DP013-MESSAGE-TEXT (1)   33640000
335700             MOVE SQLCA               TO DP013-SQLCA              33650000
335800             SET DP013-DB2-ABEND                                  33660000
335900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33670000
336000             PERFORM DP013-0000-PROCESS-ABEND                     33680000
336100     END-EVALUATE.                                                33690000
336200/                                                                 33700000
336300*                                                                 33710000
336400/                                                                 33720000
336500 9900-SOFT-ABORT.                                                 33730000
336600                                                                  33740000
336700     EXEC CICS SYNCPOINT                                          33750000
336800          ROLLBACK                                                33760000
336900     END-EXEC.                                                    33770000
337000                                                                  33780000
337100     SET  PS-ERROR                                                33790000
337200          PS-SOFT-ABORT-ERROR                                     33800000
337300          DP020-MSG-FATAL       TO  TRUE.                         33810000
337400/                                                                 33820000
337500*----------------------------------------------------------------*33830000
337600*    ABEND PROCESSOR MODULE                                      *33840000
337700*----------------------------------------------------------------*33850000
337800                                                                  33860000
337900     COPY DPPD013.                                                33870000
