000100 IDENTIFICATION DIVISION.                                         00010005
000200                                                                  00020005
000300 PROGRAM-ID.      SAKUT114.                                       00030005
000400 AUTHOR.          DAVID WELLER.                                   00040005
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050005
000600 DATE-WRITTEN.    08/24/13.                                       00060005
000700 DATE-COMPILED.                                                   00070005
000800                                                                  00080005
000900******************************************************************00090005
001000*            ***  BRICK & MORTAR TSAADSU LOADER ***               00100005
001100*=================================================================00110005
001200*                                                                 00120005
001300*  SHIP-FROM-STORE HAS NO CASH OFFICE, SO THE TSAADSU TABLE       00130005
001400*  WILL NOT BE GETTING LOADED FROM THAT SOURCE.  THIS PROGRAM     00140005
001500*  WILL COPY DATA FROM THE TSASUM TABLE INTO A EXTRACT FILE WHICH 00150005
001510*  WILL BE USED TO UPDATE THE TSAADSU TABLE FOR THE SHIP-FROM-    00160005
      *  STORE STORE.                                                   00170005
001700*                                                                 00180005
001800*  THIS PROGRAM WILL RUN ON A DAILY BASIS                         00190005
002000*                                                                 00200005
002100*  INPUT: INP01 - CONTAINS POS DATE, WHICH IS USED AS THE         00210005
002200*                  PROCESS DATE.                                  00220005
002300*                                                                 00230005
002400*========================== CHANGE LOG ===========================00240005
002500*  AUTH      BY       DATE                 DESCRIPTION            00250005
002600*=================================================================00260005
000000* CHG0053632 TKMA602  08-24-13   CREATE PROGRAM                   00270005
002800*                                                                 00280005
002900******************************************************************00280105
102913* CHG0066778 TKMAE97  10-29-13   ADD IN POC REGISTER RANGE        00280205
102913*                                                                 00280305
102913******************************************************************00280405
8446E * 8446E      TKMA555  02-20-14   ADD IN BPS                       00280505
8446E *                                                                 00280605
8446E ******************************************************************00280705
052914* CHG0082892 TKMAE97  05-29-14   INCREASE POC REGISTER RANGE TO   00280805
052914*                                70-89 AS WELL AS INCLUSION OF    00280905
052914*                                THE DBS (DEBIT) CATEGORY.        00281005
052914******************************************************************00282005
012815* CHG0102523 TKMAE97  01/28/15   ASSIGN CORRECT TSAADSU           00283005
012815*                                CATEGORY TO DEBIT TOTALS (DBN)   00284005
012815*                                INSTEAD OF (DBS) AND REMOVE      00285005
012815*                                POC REGISTER RANGE FROM THE      00286005
012815*                                CURSOR. (REG 70-89)              00287005
012815******************************************************************00288005
BOSS  * CHG0188487 TKMA555  01-25-18   ADD IN BOS, BSR, BPR.            00289005
BOSS  *                                                                 00290005
BOSS  ******************************************************************00291005
255393* CHG0255393 TKMAC09  03-19-21   ADDED LOGIC FOR SEPHORA.         00291106
255393*  ADD TSASUM CODES:  'SCS' - SEPHORA CHARGE SALES                00291206
255393*                     'SCR' - SEPHORA CHARGE SALES                00291306
255393*                     'SGS' - SEPHORA GIFT CARD SALES             00291406
255393*                     'SGT' - SEPHORA GIFT CARD TENDERS           00291506
255393*  ADD TSAADSU CODES: 'SCN' - SEPHORA CHARGE NET                  00291606
255393*                     'SGS' - SEPHORA GIFT CARD SALES             00291706
255393*                     'SGT' - SEPHORA GIFT CARD TENDERS           00291806
255393******************************************************************00291906
267791* CHG0267791 TKMAC09  03-11-22   REMOVING SEPHORA CATEGORIES      00292006
267791*                                ADDED PREV YEAR BECAUSE THEY WILL00292106
267791*                                NOT BE IN CASH OFFICE.           00292206
267791******************************************************************00292506
PAYVEN* CHG0289270 TKMAC09  05-30-23   ADD LOGIC FOR PAYPAL AND VENMO.  00292614
PAYVEN*  ADD TSASUM CODES:  'PPS' - PAYPAL CHARGE SALES                 00292707
PAYVEN*                     'PPR' - PAYPAL CHARGE RETURNS               00292807
PAYVEN*                     'VMS' - VENMO CHARGE SALES                  00292907
PAYVEN*                     'VMR' - VENMO CHARGE RETURNS                00293007
PAYVEN*  ADD TSAADSU CODES: 'PPN' - PAYPAL CHARGE NET                   00293107
PAYVEN*                     'VMN' - VENMO CHARGE NET                    00293207
PAYVEN******************************************************************00293707
003000                                                                  00293805
003100 ENVIRONMENT DIVISION.                                            00293905
003200 CONFIGURATION SECTION.                                           00294005
003300                                                                  00295005
003400 SOURCE-COMPUTER.        IBM-3090.                                00296005
003500 OBJECT-COMPUTER.        IBM-3090.                                00297005
003600                                                                  00298005
003700 INPUT-OUTPUT SECTION.                                            00299005
003800 FILE-CONTROL.                                                    00300005
003900                                                                  00310005
004000     SELECT POS-DATE-CARD-FILE ASSIGN TO INP01.                   00320005
004100     SELECT TSAADSU-FILE       ASSIGN TO OUT01.                   00330005
004200                                                                  00340005
004300 DATA DIVISION.                                                   00350005
004400 FILE SECTION.                                                    00360005
004500                                                                  00370005
004600 FD  POS-DATE-CARD-FILE                                           00380005
004700     RECORDING MODE IS F                                          00390005
004800     BLOCK CONTAINS 0 RECORDS                                     00400005
004900     LABEL RECORDS ARE STANDARD.                                  00410005
005000                                                                  00420005
005100 01  POS-DATE-CARD-RECORD             PIC  X(80).                 00430005
005200                                                                  00440005
005300 FD  TSAADSU-FILE                                                 00450005
005400     RECORDING MODE IS F                                          00460005
005500     BLOCK CONTAINS 0 RECORDS                                     00470005
005600     LABEL RECORDS ARE STANDARD.                                  00480005
005700                                                                  00490005
005800 01  TSAADSU-REC                      PIC  X(28).                 00500005
005900                                                                  00510005
006000                                                                  00520005
006100******************************************************************00530005
006200*                       WORKING STORAGE                           00540005
006300******************************************************************00550005
006400 WORKING-STORAGE SECTION.                                         00560005
006500                                                                  00570005
006600 01  W-START                          PIC  X(50)    VALUE         00580005
006700     ' *** WORKING STORAGE STARTS HERE FOR SAKUT114 *** '.        00590005
006800                                                                  00600005
006900******************************************************************00610005
007000*                          SWITCHES                               00620005
007100******************************************************************00630005
007200 01  PS-PROGRAM-SWITCHES.                                         00640005
007300                                                                  00650005
007600     05  PS-END-OF-SUM-CURSOR-SW      PIC  X(01)    VALUE 'N'.    00660005
007700         88  PS-END-OF-SUM-CURSOR                   VALUE 'Y'.    00670005
007800     05  PS-END-OF-CARD-FILE-SW       PIC  X(01)    VALUE 'N'.    00680005
007900         88  PS-END-OF-CARD-FILE                    VALUE 'Y'.    00690005
008000                                                                  00700005
008100******************************************************************00710005
008200*                         CONSTANTS                               00720005
008300******************************************************************00730005
008400 01  PC-CONSTANTS.                                                00740005
008500                                                                  00750005
008600     05  PC-JOB-NAME                  PIC  X(08)    VALUE         00760005
008700                                                    'SAK135  '.   00770005
008800     05  PC-PGM-NAME                  PIC  X(08)    VALUE         00780005
008900                                                    'SAKUT114'.   00790005
009000                                                                  00800005
009100     05  PC-ROW-NOT-FOUND             PIC S9(04)    VALUE +100    00810005
009200                                                    COMP SYNC.    00820005
009300     05  PC-SUM-CTG-CDE               PIC  X(03).                 00830005
012000         88  PC-SUM-CTG-CDE-KMT                     VALUE 'KMT'.  00840005
012000         88  PC-SUM-CTG-CDE-POS                     VALUE 'POS'.  00850005
012000         88  PC-SUM-CTG-CDE-GTT                     VALUE 'GTT'.  00860005
012000         88  PC-SUM-CTG-CDE-GDT                     VALUE 'GDT'.  00870005
012000         88  PC-SUM-CTG-CDE-TAX                     VALUE 'TAX'.  00880005
012000         88  PC-SUM-CTG-CDE-GTS                     VALUE 'GTS'.  00890005
012000         88  PC-SUM-CTG-CDE-GDS                     VALUE 'GDS'.  00900005
012000         88  PC-SUM-CTG-CDE-CRI                     VALUE 'CRI'.  00910005
012000         88  PC-SUM-CTG-CDE-KMI                     VALUE 'KMI'.  00920005
012000         88  PC-SUM-CTG-CDE-POR                     VALUE 'POR'.  00930005
012000         88  PC-SUM-CTG-CDE-KCP                     VALUE 'KCP'.  00940005
012000         88  PC-SUM-CTG-CDE-NSF                     VALUE 'NSF'.  00950005
012000         88  PC-SUM-CTG-CDE-ECR                     VALUE 'ECR'.  00960005
012000         88  PC-SUM-CTG-CDE-BCS                     VALUE 'BCS'.  00970005
012000         88  PC-SUM-CTG-CDE-BCR                     VALUE 'BCR'.  00980005
012000         88  PC-SUM-CTG-CDE-NCS                     VALUE 'NCS'.  00990005
012000         88  PC-SUM-CTG-CDE-NCR                     VALUE 'NCR'.  01000005
012000         88  PC-SUM-CTG-CDE-AXS                     VALUE 'AXS'.  01010005
012000         88  PC-SUM-CTG-CDE-AXR                     VALUE 'AXR'.  01020005
012000         88  PC-SUM-CTG-CDE-KCS                     VALUE 'KCS'.  01030005
012000         88  PC-SUM-CTG-CDE-KCR                     VALUE 'KCR'.  01040005
012000         88  PC-SUM-CTG-CDE-RET                     VALUE 'RET'.  01050005
012000         88  PC-SUM-CTG-CDE-SAL                     VALUE 'SAL'.  01060005
012000         88  PC-SUM-CTG-CDE-SHS                     VALUE 'SHS'.  01070005
012000         88  PC-SUM-CTG-CDE-SHR                     VALUE 'SHR'.  01080005
012000         88  PC-SUM-CTG-CDE-GWS                     VALUE 'GWS'.  01090005
012000         88  PC-SUM-CTG-CDE-GWR                     VALUE 'GWR'.  01100005
012000         88  PC-SUM-CTG-CDE-SFS                     VALUE 'SFS'.  01110005
8446E          88  PC-SUM-CTG-CDE-BPS                     VALUE 'BPS'.  01120005
BOSS           88  PC-SUM-CTG-CDE-BOS                     VALUE 'BOS'.  01130005
BOSS           88  PC-SUM-CTG-CDE-BSR                     VALUE 'BSR'.  01140005
BOSS           88  PC-SUM-CTG-CDE-BPR                     VALUE 'BPR'.  01150005
052914         88  PC-SUM-CTG-CDE-DBS                     VALUE 'DBS'.  01160005
PAYVEN         88  PC-SUM-CTG-CDE-PPS                     VALUE 'PPS'.  01161007
PAYVEN         88  PC-SUM-CTG-CDE-PPR                     VALUE 'PPR'.  01162007
PAYVEN         88  PC-SUM-CTG-CDE-VMS                     VALUE 'VMS'.  01163007
PAYVEN         88  PC-SUM-CTG-CDE-VMR                     VALUE 'VMR'.  01164007
012100                                                                  01170005
012200******************************************************************01180005
012300*                      ACCUMULATORS                               01190005
012400******************************************************************01200005
012500 01  PA-ACCULATORS.                                               01210005
012600                                                                  01220005
012800     05  PA-SUM-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01230005
012900                                                                  01240005
013000     05  PA-TSAADSU-WRITTEN           PIC  9(07)    VALUE ZEROS.  01250005
013100                                                                  01260005
013100 01  DK-DB2-KEYS.                                                 01270005
013100     05  DK-BEGIN-DATE-ISO       PIC X(10)    VALUE SPACES.       01280005
013100     05  DK-END-DATE-ISO         PIC X(10)    VALUE SPACES.       01290005
013100                                                                  01300005
013200******************************************************************01310005
013300*                       VARIABLES                                 01320005
013400******************************************************************01330005
013500 01  PV-VARIABLES.                                                01340005
013600     05  PV-SQL                       PIC S9(04)    VALUE ZEROS.  01350005
013700     05  PV-PARAGRAPH-NAME            PIC  X(30)    VALUE SPACES. 01360005
013800     05  PV-DB2-TABLE-NAME            PIC  X(12)    VALUE SPACES. 01370005
013900     05  PV-DB2-OPERATION-MSG         PIC  X(60)    VALUE SPACES. 01380005
014000     05  PV-OPERATION-MSG-1           PIC  X(40)    VALUE SPACES. 01390005
014100     05  PV-OPERATION-MSG-2           PIC  X(40)    VALUE SPACES. 01400005
014200                                                                  01410005
014300     05  PV-ABEND-PARTN-NBR           PIC  9(04)    VALUE ZEROS.  01420005
014400     05  PV-ABEND-STR-NBR             PIC  9(04)    VALUE ZEROS.  01430005
014500     05  PV-ABEND-SUM-CTG-CDE         PIC  X(03)    VALUE SPACES. 01440005
014600                                                                  01450005
014700 01  PV-DB2-VARIABLES.                                            01460005
014800                                                                  01470005
015100     05  PV-DB2-SUM                   PIC S9(09)V99 COMP-3        01480005
015200                                                    VALUE ZERO.   01490005
015300                                                                  01500005
015400******************************************************************01510005
015500*                       WORK AREA                                 01520005
015600******************************************************************01530005
015700 01  PV-MISC-FIELDS.                                              01540005
015800                                                                  01550005
015900     05  PV-HOLD-SLSDTE               PIC X(10)     VALUE SPACES. 01560005
015900     05  PV-HOLD-STR-NBR              PIC 9(04)     VALUE ZEROES. 01570005
015900     05  PV-SLSDTE                    PIC X(10)     VALUE SPACES. 01580005
057500     05  PV-STM-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01590005
057500     05  PV-SFS-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01600005
8446E      05  PV-BPS-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01610005
BOSS       05  PV-BPR-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01620005
BOSS       05  PV-BOS-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01630005
BOSS       05  PV-BSR-TOTAL                 PIC S9(7)V99  VALUE ZERO.   01631005
057500     05  PV-DISPLAY-STM-TOTAL         PIC ZZZZZZ9.99.             01632005
057500     05  PV-DISPLAY-SFS-TOTAL         PIC ZZZZZZ9.99.             01633005
8446E      05  PV-DISPLAY-BPS-TOTAL         PIC ZZZZZZ9.99.             01634005
BOSS       05  PV-DISPLAY-BPR-TOTAL         PIC ZZZZZZ9.99.             01635005
BOSS       05  PV-DISPLAY-BOS-TOTAL         PIC ZZZZZZ9.99.             01636005
BOSS       05  PV-DISPLAY-BSR-TOTAL         PIC ZZZZZZ9.99.             01637005
015900     05  PV-DPG52-LK-DATE-INPUT       PIC X(10)     VALUE SPACES. 01638005
015900     05  PV-STR-NBR                   PIC S9(04)    COMP          01639005
016000                                                    VALUE ZERO.   01640005
016100                                                                  01650005
020600     05  PV-BCN-AMT                   PIC S9(09)V99 COMP-3        01660005
020700                                                    VALUE ZERO.   01670005
020600     05  PV-NCN-AMT                   PIC S9(09)V99 COMP-3        01680005
020700                                                    VALUE ZERO.   01690005
020600     05  PV-AEN-AMT                   PIC S9(09)V99 COMP-3        01700005
020700                                                    VALUE ZERO.   01710005
020600     05  PV-KCN-AMT                   PIC S9(09)V99 COMP-3        01720005
020700                                                    VALUE ZERO.   01730005
020600     05  PV-STM-AMT                   PIC S9(09)V99 COMP-3        01740005
020700                                                    VALUE ZERO.   01750005
020600     05  PV-TAX-AMT                   PIC S9(09)V99 COMP-3        01760005
020700                                                    VALUE ZERO.   01770005
020600     05  PV-GDS-AMT                   PIC S9(09)V99 COMP-3        01780005
020700                                                    VALUE ZERO.   01790005
020600     05  PV-GTS-AMT                   PIC S9(09)V99 COMP-3        01800005
020700                                                    VALUE ZERO.   01810005
020600     05  PV-KMT-AMT                   PIC S9(09)V99 COMP-3        01820005
020700                                                    VALUE ZERO.   01830005
020600     05  PV-POS-AMT                   PIC S9(09)V99 COMP-3        01840005
020700                                                    VALUE ZERO.   01850005
020600     05  PV-GTT-AMT                   PIC S9(09)V99 COMP-3        01860005
020700                                                    VALUE ZERO.   01870005
020600     05  PV-GDT-AMT                   PIC S9(09)V99 COMP-3        01880005
020700                                                    VALUE ZERO.   01890005
020600     05  PV-CRI-AMT                   PIC S9(09)V99 COMP-3        01900005
020700                                                    VALUE ZERO.   01910005
020600     05  PV-KMI-AMT                   PIC S9(09)V99 COMP-3        01920005
020700                                                    VALUE ZERO.   01930005
020600     05  PV-POR-AMT                   PIC S9(09)V99 COMP-3        01940005
020700                                                    VALUE ZERO.   01950005
020600     05  PV-KCP-AMT                   PIC S9(09)V99 COMP-3        01960005
020700                                                    VALUE ZERO.   01970005
020600     05  PV-NSF-AMT                   PIC S9(09)V99 COMP-3        01980005
020700                                                    VALUE ZERO.   01990005
020600     05  PV-ECR-AMT                   PIC S9(09)V99 COMP-3        02000005
020700                                                    VALUE ZERO.   02010005
020600     05  PV-TMR-AMT                   PIC S9(09)V99 COMP-3        02020005
020700                                                    VALUE ZERO.   02030005
020600     05  PV-SHS-AMT                   PIC S9(09)V99 COMP-3        02040005
020700                                                    VALUE ZERO.   02050005
020600     05  PV-SHR-AMT                   PIC S9(09)V99 COMP-3        02060005
020700                                                    VALUE ZERO.   02070005
020600     05  PV-GWS-AMT                   PIC S9(09)V99 COMP-3        02080005
020700                                                    VALUE ZERO.   02090005
020600     05  PV-GWR-AMT                   PIC S9(09)V99 COMP-3        02100005
020700                                                    VALUE ZERO.   02110005
020600     05  PV-SFS-AMT                   PIC S9(09)V99 COMP-3        02120005
020700                                                    VALUE ZERO.   02130005
8446E      05  PV-BPS-AMT                   PIC S9(09)V99 COMP-3        02140005
8446E                                                     VALUE ZERO.   02150005
BOSS       05  PV-BPR-AMT                   PIC S9(09)V99 COMP-3        02160005
BOSS                                                      VALUE ZERO.   02170005
BOSS       05  PV-BOS-AMT                   PIC S9(09)V99 COMP-3        02170105
BOSS                                                      VALUE ZERO.   02170205
BOSS       05  PV-BSR-AMT                   PIC S9(09)V99 COMP-3        02170305
BOSS                                                      VALUE ZERO.   02170405
052914     05  PV-DBS-AMT                   PIC S9(09)V99 COMP-3        02170505
052914                                                    VALUE ZERO.   02170605
PAYVEN     05  PV-PPN-AMT                   PIC S9(09)V99 COMP-3        02170708
PAYVEN                                                    VALUE ZERO.   02170808
PAYVEN     05  PV-VMN-AMT                   PIC S9(09)V99 COMP-3        02170908
PAYVEN                                                    VALUE ZERO.   02171008
020800                                                                  02171105
020900******************************************************************02171205
021000*                       DATE/TIME                                 02171305
021100******************************************************************02171405
021200 01  PV-DATE-AND-TIME-FIELDS.                                     02172005
021300                                                                  02173005
021400     05  PV-POS-CCYY-MM-DD            PIC  X(10)    VALUE SPACE.  02174005
021500     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      02175005
021600         10  PV-POS-CCYY              PIC  X(04).                 02176005
021700         10  FILLER                   PIC  X(01).                 02177005
021800         10  PV-POS-MM                PIC  X(02).                 02178005
021900         10  FILLER                   PIC  X(01).                 02179005
022000         10  PV-POS-DD                PIC  X(02).                 02180005
022100                                                                  02190005
022200     05  PV-CURR-DATE-CCYYMMDD.                                   02200005
022300         10  PV-CURR-DATE-CCYY        PIC  9(04).                 02210005
022400         10  PV-CURR-DATE-MM          PIC  9(02).                 02220005
022500         10  PV-CURR-DATE-DD          PIC  9(02).                 02230005
022600                                                                  02240005
022700     05  PV-CURR-TIME.                                            02250005
022800         10  PV-CURR-TIME-HH          PIC  9(02)    VALUE ZERO.   02260005
022900         10  PV-CURR-TIME-MM          PIC  9(02)    VALUE ZERO.   02270005
023000         10  PV-CURR-TIME-SSHH        PIC  9(04)    VALUE ZERO.   02280005
023100                                                                  02290005
023200     05  PV-POS-DATE-FORMATTED        PIC  X(10)    VALUE SPACE.  02300005
023300     05  PV-SLS-DTE-MM-DD-CCYY.                                   02310005
023400         10  PV-SLS-DTE-MM            PIC  X(02)    VALUE SPACE.  02320005
023500         10  FILLER                   PIC  X(01)    VALUE '/'.    02330005
023600         10  PV-SLS-DTE-DD            PIC  X(02)    VALUE SPACE.  02340005
023700         10  FILLER                   PIC  X(01)    VALUE '/'.    02350005
023800         10  PV-SLS-DTE-CCYY          PIC  X(04)    VALUE SPACE.  02360005
023900                                                                  02370005
024000******************************************************************02380005
024100*               SYSTEM TIME AND DATE VARIABLES                    02390005
024200******************************************************************02400005
024300 01  SYS-DATE-TIME.                                               02410005
024400     05  SYS-DATE                     PIC  X(08)    VALUE SPACES. 02420005
024500     05  SYS-TIME                     PIC  X(08)    VALUE SPACES. 02430005
024600                                                                  02440005
024700 01  ST-BEG-TIME.                                                 02450005
024800     05  ST-BEG-HR                    PIC  9(02)    VALUE ZEROS.  02460005
024900     05  FILLER                       PIC  X(01)    VALUE ':'.    02470005
025000     05  ST-BEG-MN                    PIC  9(02)    VALUE ZEROS.  02480005
025100                                                                  02490005
025200 01  ST-END-TIME.                                                 02500005
025300     05  ST-END-HR                    PIC  9(02)    VALUE ZEROS.  02510005
025400     05  FILLER                       PIC  X(01)    VALUE ':'.    02520005
025500     05  ST-END-MN                    PIC  9(02)    VALUE ZEROS.  02530005
025600                                                                  02540005
025700 01  SD-EDIT-DATE.                                                02550005
025800     05  SD-MONTH                     PIC  9(02)    VALUE ZEROS.  02560005
025900     05  FILLER                       PIC  X(01)    VALUE '-'.    02570005
026000     05  SD-DAY                       PIC  9(02)    VALUE ZEROS.  02580005
026100     05  FILLER                       PIC  X(01)    VALUE '-'.    02590005
026200     05  SD-CENT                      PIC  9(02)    VALUE ZEROS.  02600005
026300     05  SD-YEAR                      PIC  9(02)    VALUE ZEROS.  02610005
026400                                                                  02620005
026500******************************************************************02630005
026600*                        ERROR HANDLING                           02640005
026700******************************************************************02650005
026800 01  ABEND-CODE                       PIC S9(04)    VALUE ZEROS   02660005
026900                                                    COMP SYNC.    02670005
027000     88  ABEND-4001-WRITE-ERROR                     VALUE +4001.  02680005
027100     88  ABEND-4002-READ-ERROR                      VALUE +4002.  02690005
027200     88  ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.  02700005
027300     88  ABEND-4004-TABLE-ERROR                     VALUE +4004.  02710005
027400     88  ABEND-4005-OPEN-ERROR                      VALUE +4005.  02720005
027500     88  ABEND-4006-CLOSE-ERROR                     VALUE +4006.  02730005
027600     88  ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.  02740005
027700     88  ABEND-4008-DATA-ERROR                      VALUE +4008.  02750005
027800     88  ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.  02760005
027900     88  ABEND-4013-DB2-ERROR                       VALUE +4013.  02770005
028000     88  ABEND-4019-CAL-SUB-ERROR                   VALUE +4019.  02780005
028100     88  ABEND-4444-FORCED-ABEND                    VALUE +4444.  02790005
028200                                                                  02800005
028300                                                                  02810005
028400******************************************************************02820005
028500* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    02830005
028600******************************************************************02840005
028700 01  CC-CONTROL-CARD.                                             02850005
028800                                                                  02860005
029500    05  CC-CONTROL-CARD-DISPLAY.                                  02870005
029500        10  CC-START-DATE       PIC X(10)    VALUE SPACES.        02880005
029500        10  FILLER              PIC X        VALUE SPACE.         02890005
029500        10  CC-END-DATE         PIC X(10)    VALUE SPACES.        02900005
029500        10  FILLER              PIC X(59)    VALUE SPACE.         02910005
029600                                                                  02920005
029700******************************************************************02930005
029800*  TSAADSU - STORE TOTALS RECORD LAYOUT                           02940005
029900******************************************************************02950005
030000     COPY SARD007.                                                02960005
030100                                                                  02970005
030200******************************************************************02980005
030300*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             02990005
030400******************************************************************03000005
030500     COPY DPWS500.                                                03010005
030600                                                                  03020005
030700******************************************************************03030005
030800*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            03040005
030900******************************************************************03050005
031000     COPY DPWS004.                                                03060005
031100                                                                  03070005
031200******************************************************************03080005
031300*  DB2 MESSAGE AREA                                               03090005
031400******************************************************************03100005
031500     COPY SQLCA2.                                                 03110005
031600                                                                  03120005
031700******************************************************************03130005
031800*  DB2 COMMUNICATION AREA.                                        03140005
031900******************************************************************03150005
032000     EXEC SQL                                                     03160005
032100          INCLUDE SQLCA                                           03170005
032200     END-EXEC.                                                    03180005
032300                                                                  03190005
032400******************************************************************03200005
032500*  DB2 TABLE XST_LOC - STORE LOCATION TABLE                       03210005
032600******************************************************************03220005
032700     EXEC SQL                                                     03230005
032800          INCLUDE XST00001                                        03240005
032900     END-EXEC.                                                    03250005
033000                                                                  03260005
033100******************************************************************03270005
033200*  DB2 TABLE TSASUM - TOTALS BY STORE REGISTER TABLE              03280005
033300******************************************************************03290005
033400     EXEC SQL                                                     03300005
033500          INCLUDE TSASUM                                          03310005
033600     END-EXEC.                                                    03320005
033700                                                                  03330005
033800******************************************************************03340005
033900*  DB2 TABLE TEPPART - PARTITION TABLE                            03350005
034000******************************************************************03360005
034100     EXEC SQL                                                     03370005
034200          INCLUDE TEPPART                                         03380005
034300     END-EXEC.                                                    03390005
034400                                                                  03400005
036100******************************************************************03410005
036200*  SUM-CURSOR -- CURSOR TO SUM CTG_AMT GROUPED BY THE VARIOUS     03420005
036300*  CATEGORY CODES.                                                03430005
036400******************************************************************03440005
036500     EXEC SQL                                                     03450005
036600       DECLARE SUM-CURSOR CURSOR FOR                              03460005
036700            SELECT  SLS_DTE                                       03470005
007900                   ,A.STR_NBR                                     03480005
036700                   ,SUM(CTG_AMT) AS PV-DB2-SUM                    03490005
036800                   ,SUM_CTG_CDE                                   03500005
036900              FROM  TSASUM  A                                     03510005
036900                 ,  TEPPART B                                     03520005
035100                 ,  XST_LOC C                                     03530005
037000             WHERE  A.PARTN_NBR   = B.PARTN_NBR                   03540005
037000               AND  B.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO          03550005
037000                                AND   :DK-END-DATE-ISO            03560005
037100               AND  A.STR_NBR     = C.LOC_NBR                     03570005
035200               AND  C.E_BUS_IND   = 'N'                           03580005
035300               AND  C.LOC_TYP_CDE = 'DS'                          03590005
037200               AND  SUM_TYP_CDE IN ('D', 'S')                     03600005
052914*              SHIP FROM STORE IS REGISTERS 90 TO 95              03610005
012815               AND  RGST_ID  BETWEEN 90 AND 95                    03620005
037400          GROUP BY  SLS_DTE, A.STR_NBR, SUM_CTG_CDE               03630005
037400          ORDER BY  SLS_DTE, A.STR_NBR, SUM_CTG_CDE               03640005
037500           WITH UR                                                03650005
037600     END-EXEC.                                                    03660005
037700                                                                  03670005
037800                                                                  03680005
037900                                                                  03690005
038000 PROCEDURE DIVISION.                                              03700005
038100******************************************************************03710005
038200* MAINLINE                                                        03720005
038300******************************************************************03730005
038400 0000-MAINLINE-PARAGRAPH.                                         03740005
038500                                                                  03750005
038600     PERFORM 1000-INITIALIZE-PROGRAM.                             03761013
038700                                                                  03770005
038800     PERFORM 2000-PROCESS-SUM-CTG-CDE                             03780005
007700       UNTIL PS-END-OF-SUM-CURSOR.                                03790005
039000                                                                  03800005
039100     PERFORM 9900-END-PROC.                                       03810005
039200                                                                  03820005
039300     STOP RUN.                                                    03830005
039400                                                                  03840005
039500                                                                  03850005
039600******************************************************************03860005
039700* OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS,       03870005
039800* FIND PARTITION NUMBER, OPEN MASTER-CURSOR                       03880005
039900******************************************************************03890005
040000 1000-INITIALIZE-PROGRAM.                                         03900005
040100                                                                  03910005
040200     OPEN INPUT  POS-DATE-CARD-FILE.                              03920005
040300     OPEN OUTPUT TSAADSU-FILE.                                    03930005
040400                                                                  03940005
040500     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 03950005
040600                                                                  03960005
040700     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            03970005
040800     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            03980005
040900                                                                  03990005
041000     MOVE SYS-DATE (1:2) TO SD-CENT.                              04000005
041100     MOVE SYS-DATE (3:2) TO SD-YEAR.                              04010005
041200     MOVE SYS-DATE (5:2) TO SD-MONTH.                             04020005
041300     MOVE SYS-DATE (7:2) TO SD-DAY.                               04030005
041400                                                                  04040005
041500     PERFORM 1100-PROCESS-CONTROL-CARD.                           04050005
041600                                                                  04060005
042100                                                                  04070005
042200******************************************************************04080005
042300* READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL       04090005
042400* DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.      04100005
042500******************************************************************04110005
042600 1100-PROCESS-CONTROL-CARD.                                       04120005
042700                                                                  04130005
042800     PERFORM 1110-READ-POS-DATE-CARD-FILE.                        04140005
042700                                                                  04150005
043200     IF PS-END-OF-CARD-FILE                                       04160005
043300         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   04170005
043400         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  04180005
043500                                                                  04190005
043600         SET ABEND-4003-CTRL-CARD-ERROR TO TRUE                   04200005
043700         PERFORM 9200-ABEND                                       04210005
043800     END-IF.                                                      04220005
042900                                                                  04230005
043000     CLOSE POS-DATE-CARD-FILE.                                    04240005
044500                                                                  04250005
044600                                                                  04260005
044700******************************************************************04270005
044800* READ DATE CONTROL CARD.                                         04280005
044900******************************************************************04290005
045000 1110-READ-POS-DATE-CARD-FILE.                                    04300005
045100                                                                  04310005
045200     READ POS-DATE-CARD-FILE INTO CC-CONTROL-CARD                 04320005
045300        AT END                                                    04330005
045400            SET PS-END-OF-CARD-FILE TO TRUE                       04340005
045500        NOT AT END                                                04350005
045500            MOVE CC-START-DATE        TO PV-DPG52-LK-DATE-INPUT   04360005
045500            PERFORM 1125-VALIDATE-INPUT-DATE                      04370005
045500            MOVE CC-START-DATE        TO DK-BEGIN-DATE-ISO        04380005
045500                                                                  04390005
045500            MOVE CC-END-DATE          TO PV-DPG52-LK-DATE-INPUT   04400005
045500            PERFORM 1125-VALIDATE-INPUT-DATE                      04410005
045500            MOVE CC-END-DATE          TO DK-END-DATE-ISO          04420005
045500                                                                  04430005
045500            DISPLAY                                               04440005
045500            '** CONTROL CARD = ' CC-CONTROL-CARD-DISPLAY.         04450005
045500                                                                  04460005
045500                                                                  04470005
045700******************************************************************04480005
045800* CALL KOHLS CALENDAR ROUTINE:                                    04490005
045900*     PASS: CONTROL CARD POS DATE (CCYY-MM-DD FORMAT).            04500005
046000*   RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT).     04510005
046100******************************************************************04520005
042900 1125-VALIDATE-INPUT-DATE.                                        04530005
046300                                                                  04540005
046400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04550005
046500                                                                  04560005
046600     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   04570005
046700     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   04580005
046800     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   04590005
046900                                                                  04600005
047000     MOVE PV-DPG52-LK-DATE-INPUT       TO DPG52-LK-DATE-INPUT.    04610005
047100                                                                  04620005
047200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    04630005
047300                                             DPG54 DPG55 DPG56.   04640005
047400     EVALUATE TRUE                                                04650005
047500         WHEN DPG54-SEVERE-ERROR                                  04660005
047600         WHEN DPG54-DATE-INVALID                                  04670005
047700             MOVE '1125-VALIDATE-INPUT-DATE'                      04680005
047800                                       TO PV-PARAGRAPH-NAME       04690005
047900             MOVE 'ERROR CONVERTING INPUT CARD DATE'              04700005
048000                                       TO PV-OPERATION-MSG-1      04710005
048100             SET ABEND-4019-CAL-SUB-ERROR                         04720005
048200                                       TO TRUE                    04730005
048300             MOVE DPG54-ERROR-MESSAGE                             04740005
048400                                       TO PV-OPERATION-MSG-2      04750005
048500             PERFORM 9200-ABEND                                   04760005
048600     END-EVALUATE.                                                04770005
048700                                                                  04780005
049100                                                                  04790005
055500******************************************************************04800005
055600* 2000-PROCESS-SUM-CTG-CDE                                        04810005
055800*     - OPEN, FETCH & CLOSE SUM-CURSOR                            04820005
055800*     - WRITE THE STORES CATEGORIES                               04830005
056000******************************************************************04840005
056100 2000-PROCESS-SUM-CTG-CDE.                                        04850005
056200                                                                  04860005
056900     PERFORM 3000-OPEN-SUM-CURSOR.                                04870005
057000     PERFORM 3100-FETCH-SUM-CURSOR                                04880005
057100        UNTIL PS-END-OF-SUM-CURSOR.                               04890005
057200     PERFORM 3200-CLOSE-SUM-CURSOR.                               04900005
057300                                                                  04910005
057400     PERFORM 4000-MOVE-SUM-CTG-CDE-AMT.                           04920005
060100                                                                  04930005
063900******************************************************************04940005
064000*  OPEN THE SUM-CURSOR                                            04950005
064100******************************************************************04960005
064200 3000-OPEN-SUM-CURSOR.                                            04970005
064300                                                                  04980005
064400     EXEC SQL                                                     04990005
064500          OPEN SUM-CURSOR                                         05000005
064600     END-EXEC.                                                    05010005
064700                                                                  05020005
064800     EVALUATE TRUE                                                05030005
064900         WHEN SQLCODE = ZERO                                      05040005
065000             CONTINUE                                             05050005
065100                                                                  05060005
065200         WHEN SQLWARN0 NOT EQUAL SPACE                            05070005
065300         WHEN SQLCODE NOT EQUAL ZERO                              05080005
065400             MOVE SQLCODE TO PV-SQL                               05090005
065500                                                                  05100005
065600             MOVE '3000-OPEN-SUM-CURSOR' TO PV-PARAGRAPH-NAME     05110005
065700             MOVE 'TSASUM'               TO PV-DB2-TABLE-NAME     05120005
065800                                                                  05130005
065900             STRING 'ERROR ON OPEN OF SUM-CURSOR - SQLCODE = '    05140005
066000                PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG05150005
066100             END-STRING                                           05160005
066200                                                                  05170005
066300             SET ABEND-4005-OPEN-ERROR TO TRUE                    05180005
066400             PERFORM 9100-SQL-ABEND                               05190005
066500     END-EVALUATE.                                                05200005
066600                                                                  05210005
066700                                                                  05220005
066800******************************************************************05230005
066900*  FETCH THE SUM CURSOR.                                          05240005
067000******************************************************************05250005
067100 3100-FETCH-SUM-CURSOR.                                           05260005
067200                                                                  05270005
067300     EXEC SQL                                                     05280005
067400          FETCH SUM-CURSOR                                        05290005
067500           INTO :PV-SLSDTE                                        05300005
067500               ,:PV-STR-NBR                                       05310005
067500               ,:PV-DB2-SUM                                       05320005
067600               ,:SASUM-SUM-CTG-CDE                                05330005
067700     END-EXEC.                                                    05340005
067800                                                                  05350005
067900     EVALUATE TRUE                                                05360005
068000         WHEN SQLCODE = ZERO                                      05370005
068100             ADD 1 TO PA-SUM-CURSOR-CNT                           05380005
068200                                                                  05390005
068300         WHEN SQLCODE = PC-ROW-NOT-FOUND                          05400005
068400             SET PS-END-OF-SUM-CURSOR  TO TRUE                    05410005
068500                                                                  05420005
068600         WHEN SQLWARN0 NOT EQUAL SPACE                            05430005
068700         WHEN SQLCODE NOT EQUAL ZERO                              05440005
068800             MOVE SQLCODE TO PV-SQL                               05450005
068900                                                                  05460005
069100             MOVE PV-STR-NBR        TO PV-ABEND-STR-NBR           05470005
069200             MOVE SASUM-SUM-CTG-CDE TO PV-ABEND-SUM-CTG-CDE       05480005
069300                                                                  05490005
069400             MOVE '3100-FETCH-SUM-CURSOR' TO PV-PARAGRAPH-NAME    05500005
069500             MOVE 'TSASUM'                TO PV-DB2-TABLE-NAME    05510005
069600                                                                  05520005
069700             STRING 'ERROR ON FETCH OF SUM-CURSOR - SQLCODE = '   05530005
069800                PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG05540005
069900             END-STRING                                           05550005
070000                                                                  05560005
070100             SET ABEND-4002-READ-ERROR TO TRUE                    05570005
070200             PERFORM 9100-SQL-ABEND                               05580005
070300     END-EVALUATE.                                                05590005
070400                                                                  05600005
070500                                                                  05610005
070600     IF SQLCODE = ZERO                                            05620005
070600         IF PV-SLSDTE NOT EQUAL PV-HOLD-SLSDTE OR                 05630005
070600            PV-STR-NBR NOT EQUAL PV-HOLD-STR-NBR                  05640005
070600             PERFORM 4000-MOVE-SUM-CTG-CDE-AMT                    05650005
070700             MOVE PV-SLSDTE     TO PV-HOLD-SLSDTE                 05660005
070700             MOVE PV-STR-NBR    TO PV-HOLD-STR-NBR                05670005
070600         END-IF                                                   05680005
070800                                                                  05690005
070700         MOVE SASUM-SUM-CTG-CDE TO PC-SUM-CTG-CDE                 05700005
070900         PERFORM 3150-EVALUATE-SUM-CTG-CDE                        05710005
071000     END-IF.                                                      05720005
071100                                                                  05730005
071200                                                                  05740005
071300******************************************************************05750005
071400* EVALUATE THE DIFFERENT SUM-CTG-CDE AND PROCESS ACCORDINGLY      05760005
071500******************************************************************05770005
071600 3150-EVALUATE-SUM-CTG-CDE.                                       05780005
071700                                                                  05790005
071700     EVALUATE TRUE                                                05800005
071700         WHEN PC-SUM-CTG-CDE-BCS                                  05810005
071700         WHEN PC-SUM-CTG-CDE-BCR                                  05820005
071700             ADD PV-DB2-SUM            TO PV-BCN-AMT              05830005
071700                                                                  05840005
071700         WHEN PC-SUM-CTG-CDE-NCS                                  05850005
071700         WHEN PC-SUM-CTG-CDE-NCR                                  05860005
071700             ADD PV-DB2-SUM            TO PV-NCN-AMT              05870005
071700                                                                  05880005
071700         WHEN PC-SUM-CTG-CDE-AXS                                  05890005
071700         WHEN PC-SUM-CTG-CDE-AXR                                  05900005
071700             ADD PV-DB2-SUM            TO PV-AEN-AMT              05910005
071700                                                                  05920005
071700         WHEN PC-SUM-CTG-CDE-KCS                                  05930005
071700         WHEN PC-SUM-CTG-CDE-KCR                                  05940005
071700             ADD PV-DB2-SUM            TO PV-KCN-AMT              05950005
071700                                                                  05960005
071700         WHEN PC-SUM-CTG-CDE-SAL                                  05970005
071700             ADD PV-DB2-SUM            TO PV-STM-AMT              05980005
071700                                                                  05990005
071700         WHEN PC-SUM-CTG-CDE-TAX                                  06000005
071700             SUBTRACT PV-DB2-SUM     FROM PV-STM-AMT              06010005
071700             MOVE PV-DB2-SUM           TO PV-TAX-AMT              06020005
071700                                                                  06030005
071700         WHEN PC-SUM-CTG-CDE-GDS                                  06040005
071700             SUBTRACT PV-DB2-SUM     FROM PV-STM-AMT              06050005
071700             MOVE PV-DB2-SUM           TO PV-GDS-AMT              06060005
071700                                                                  06070005
071700         WHEN PC-SUM-CTG-CDE-GTS                                  06080005
071700             SUBTRACT PV-DB2-SUM     FROM PV-STM-AMT              06090005
071700             MOVE PV-DB2-SUM           TO PV-GTS-AMT              06100005
071700                                                                  06110005
071700         WHEN PC-SUM-CTG-CDE-KMT                                  06120005
071700             MOVE PV-DB2-SUM           TO PV-KMT-AMT              06130005
071700                                                                  06140005
071700         WHEN PC-SUM-CTG-CDE-POS                                  06150005
071700             MOVE PV-DB2-SUM           TO PV-POS-AMT              06160005
071700                                                                  06170005
071700         WHEN PC-SUM-CTG-CDE-GTT                                  06180005
071700             MOVE PV-DB2-SUM           TO PV-GTT-AMT              06190005
071700                                                                  06200005
071700         WHEN PC-SUM-CTG-CDE-GDT                                  06210005
071700             MOVE PV-DB2-SUM           TO PV-GDT-AMT              06220005
071700                                                                  06230005
071700         WHEN PC-SUM-CTG-CDE-CRI                                  06240005
071700             MOVE PV-DB2-SUM           TO PV-CRI-AMT              06250005
071700                                                                  06260005
071700         WHEN PC-SUM-CTG-CDE-KMI                                  06270005
071700             MOVE PV-DB2-SUM           TO PV-KMI-AMT              06280005
071700                                                                  06290005
071700         WHEN PC-SUM-CTG-CDE-POR                                  06300005
071700             MOVE PV-DB2-SUM           TO PV-POR-AMT              06310005
071700                                                                  06320005
071700         WHEN PC-SUM-CTG-CDE-KCP                                  06330005
071700             MOVE PV-DB2-SUM           TO PV-KCP-AMT              06340005
071700                                                                  06350005
071700         WHEN PC-SUM-CTG-CDE-NSF                                  06360005
071700             MOVE PV-DB2-SUM           TO PV-NSF-AMT              06370005
071700                                                                  06380005
071700         WHEN PC-SUM-CTG-CDE-ECR                                  06390005
071700             MOVE PV-DB2-SUM           TO PV-ECR-AMT              06400005
071700                                                                  06410005
071700         WHEN PC-SUM-CTG-CDE-RET                                  06420005
071700             MOVE PV-DB2-SUM           TO PV-TMR-AMT              06430005
071700                                                                  06440005
071700         WHEN PC-SUM-CTG-CDE-SHS                                  06450005
071700             MOVE PV-DB2-SUM           TO PV-SHS-AMT              06460005
071700                                                                  06470005
071700         WHEN PC-SUM-CTG-CDE-SHR                                  06480005
071700             MOVE PV-DB2-SUM           TO PV-SHR-AMT              06490005
071700                                                                  06500005
071700         WHEN PC-SUM-CTG-CDE-GWS                                  06510005
071700             MOVE PV-DB2-SUM           TO PV-GWS-AMT              06520005
071700                                                                  06530005
071700         WHEN PC-SUM-CTG-CDE-GWR                                  06540005
071700             MOVE PV-DB2-SUM           TO PV-GWR-AMT              06550005
071800                                                                  06560005
079200         WHEN PC-SUM-CTG-CDE-SFS                                  06570005
079300             MOVE PV-DB2-SUM           TO PV-SFS-AMT              06580005
8446E                                                                   06590005
8446E          WHEN PC-SUM-CTG-CDE-BPS                                  06600005
8446E              MOVE PV-DB2-SUM           TO PV-BPS-AMT              06610005
BOSS                                                                    06620005
BOSS           WHEN PC-SUM-CTG-CDE-BPR                                  06630005
BOSS               MOVE PV-DB2-SUM           TO PV-BPR-AMT              06640005
BOSS                                                                    06650005
BOSS           WHEN PC-SUM-CTG-CDE-BOS                                  06660005
BOSS               MOVE PV-DB2-SUM           TO PV-BOS-AMT              06670005
BOSS                                                                    06680005
BOSS           WHEN PC-SUM-CTG-CDE-BSR                                  06690005
BOSS               MOVE PV-DB2-SUM           TO PV-BSR-AMT              06691005
052914                                                                  06691105
052914         WHEN PC-SUM-CTG-CDE-DBS                                  06691205
052914             MOVE PV-DB2-SUM           TO PV-DBS-AMT              06691305
PAYVEN                                                                  06691409
PAYVEN         WHEN PC-SUM-CTG-CDE-PPS                                  06691509
PAYVEN         WHEN PC-SUM-CTG-CDE-PPR                                  06691609
PAYVEN             ADD PV-DB2-SUM            TO PV-PPN-AMT              06691709
PAYVEN                                                                  06691910
PAYVEN         WHEN PC-SUM-CTG-CDE-VMS                                  06692010
PAYVEN         WHEN PC-SUM-CTG-CDE-VMR                                  06692110
PAYVEN             ADD PV-DB2-SUM            TO PV-VMN-AMT              06692210
PAYVEN                                                                  06692410
079400     END-EVALUATE.                                                06692510
079500                                                                  06692610
079600                                                                  06692710
079700******************************************************************06692810
079800*  CLOSE THE SUM CURSOR.                                          06692910
079900******************************************************************06693010
080000 3200-CLOSE-SUM-CURSOR.                                           06693110
080100                                                                  06693210
080200     EXEC SQL                                                     06694005
080300          CLOSE SUM-CURSOR                                        06695005
080400     END-EXEC.                                                    06696005
080500                                                                  06697005
080600     EVALUATE TRUE                                                06698005
080700         WHEN SQLCODE = ZERO                                      06699005
080800              CONTINUE                                            06700005
080900                                                                  06710005
081000         WHEN SQLWARN0 NOT EQUAL SPACE                            06720005
081100         WHEN SQLCODE NOT EQUAL ZERO                              06730005
081200             MOVE SQLCODE TO PV-SQL                               06740005
081300                                                                  06750005
081400             MOVE '3200-CLOSE-SUM-CURSOR' TO PV-PARAGRAPH-NAME    06760005
081500             MOVE 'TSASUM'                TO PV-DB2-TABLE-NAME    06770005
081600                                                                  06780005
081700             STRING 'ERROR ON CLOSE OF SUM-CURSOR - SQLCODE = '   06790005
081800                PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG06800005
081900             END-STRING                                           06810005
082000                                                                  06820005
082100             SET ABEND-4006-CLOSE-ERROR TO TRUE                   06830005
082200             PERFORM 9100-SQL-ABEND                               06840005
082300     END-EVALUATE.                                                06850005
082400                                                                  06860005
082500                                                                  06870005
082600******************************************************************06880005
082700*  MOVE AMOUNTS AND CATEGORIES IN PREPARATION FOR INSERTION       06890005
082800*  INTO TSAADSU TABLE.                                            06900005
083000******************************************************************06910005
083100 4000-MOVE-SUM-CTG-CDE-AMT.                                       06920005
083200                                                                  06930005
083300     MOVE PV-HOLD-SLSDTE               TO SA007-SLS-DTE.          06940005
083400     MOVE PV-HOLD-STR-NBR              TO SA007-STR-NBR.          06950005
083500     MOVE 'N'                          TO SA007-ADJ-IND.          06960005
083600                                                                  06970005
091700     IF PV-TAX-AMT NOT EQUAL 0                                    06980005
091700         MOVE PV-TAX-AMT               TO SA007-ORIG-AMT          06990005
091800                                          SA007-ADJ-AMT           07000005
091900         MOVE 'TAX'                    TO SA007-SUM-CTG-CDE       07010005
092000         PERFORM 4100-WRITE-TSAADSU                               07020005
091800     END-IF.                                                      07030005
083600                                                                  07040005
091700     IF PV-GDS-AMT NOT EQUAL 0                                    07050005
091800         MOVE PV-GDS-AMT               TO SA007-ORIG-AMT          07060005
091900                                          SA007-ADJ-AMT           07070005
092000         MOVE 'GDS'                    TO SA007-SUM-CTG-CDE       07080005
091700         PERFORM 4100-WRITE-TSAADSU                               07090005
091800     END-IF.                                                      07100005
091800                                                                  07110005
091700     IF PV-GTS-AMT NOT EQUAL 0                                    07120005
091900         MOVE PV-GTS-AMT               TO SA007-ORIG-AMT          07130005
092000                                          SA007-ADJ-AMT           07140005
091700         MOVE 'GTS'                    TO SA007-SUM-CTG-CDE       07150005
091800         PERFORM 4100-WRITE-TSAADSU                               07160005
091800     END-IF.                                                      07170005
091900                                                                  07180005
091700     IF PV-KMT-AMT NOT EQUAL 0                                    07190005
091900         MOVE PV-KMT-AMT               TO SA007-ORIG-AMT          07200005
091900                                          SA007-ADJ-AMT           07210005
091900         MOVE 'KMT'                    TO SA007-SUM-CTG-CDE       07220005
091900         PERFORM 4100-WRITE-TSAADSU                               07230005
091800     END-IF.                                                      07240005
091900                                                                  07250005
091700     IF PV-POS-AMT NOT EQUAL 0                                    07260005
091900         MOVE PV-POS-AMT               TO SA007-ORIG-AMT          07270005
091900                                          SA007-ADJ-AMT           07280005
091900         MOVE 'POS'                    TO SA007-SUM-CTG-CDE       07290005
091900         PERFORM 4100-WRITE-TSAADSU                               07300005
091800     END-IF.                                                      07310005
091900                                                                  07320005
091700     IF PV-GTT-AMT NOT EQUAL 0                                    07330005
091900         MOVE PV-GTT-AMT               TO SA007-ORIG-AMT          07340005
091900                                          SA007-ADJ-AMT           07350005
091900         MOVE 'GTT'                    TO SA007-SUM-CTG-CDE       07360005
091900         PERFORM 4100-WRITE-TSAADSU                               07370005
091800     END-IF.                                                      07380005
091900                                                                  07390005
091700     IF PV-GDT-AMT NOT EQUAL 0                                    07400005
091900         MOVE PV-GDT-AMT               TO SA007-ORIG-AMT          07410005
091900                                          SA007-ADJ-AMT           07420005
091900         MOVE 'GDT'                    TO SA007-SUM-CTG-CDE       07430005
091900         PERFORM 4100-WRITE-TSAADSU                               07440005
091800     END-IF.                                                      07450005
091900                                                                  07460005
091700     IF PV-CRI-AMT NOT EQUAL 0                                    07470005
091900         MOVE PV-CRI-AMT               TO SA007-ORIG-AMT          07480005
091900                                          SA007-ADJ-AMT           07490005
091900         MOVE 'CRI'                    TO SA007-SUM-CTG-CDE       07500005
091900         PERFORM 4100-WRITE-TSAADSU                               07510005
091800     END-IF.                                                      07520005
091900                                                                  07530005
091700     IF PV-KMI-AMT NOT EQUAL 0                                    07540005
091900         MOVE PV-KMI-AMT               TO SA007-ORIG-AMT          07550005
091900                                          SA007-ADJ-AMT           07560005
091900         MOVE 'KMI'                    TO SA007-SUM-CTG-CDE       07570005
091900         PERFORM 4100-WRITE-TSAADSU                               07580005
091800     END-IF.                                                      07590005
091900                                                                  07600005
091700     IF PV-POR-AMT NOT EQUAL 0                                    07610005
091900         MOVE PV-POR-AMT               TO SA007-ORIG-AMT          07620005
091900                                          SA007-ADJ-AMT           07630005
091900         MOVE 'POR'                    TO SA007-SUM-CTG-CDE       07640005
091900         PERFORM 4100-WRITE-TSAADSU                               07650005
091800     END-IF.                                                      07660005
091900                                                                  07670005
091700     IF PV-KCP-AMT NOT EQUAL 0                                    07680005
091900         MOVE PV-KCP-AMT               TO SA007-ORIG-AMT          07690005
091900                                          SA007-ADJ-AMT           07700005
091900         MOVE 'KCP'                    TO SA007-SUM-CTG-CDE       07710005
091900         PERFORM 4100-WRITE-TSAADSU                               07720005
091800     END-IF.                                                      07730005
091900                                                                  07740005
091700     IF PV-NSF-AMT NOT EQUAL 0                                    07750005
091900         MOVE PV-NSF-AMT               TO SA007-ORIG-AMT          07760005
091900                                          SA007-ADJ-AMT           07770005
091900         MOVE 'NSF'                    TO SA007-SUM-CTG-CDE       07780005
091900         PERFORM 4100-WRITE-TSAADSU                               07790005
091800     END-IF.                                                      07800005
091900                                                                  07810005
091700     IF PV-ECR-AMT NOT EQUAL 0                                    07820005
091900         MOVE PV-ECR-AMT               TO SA007-ORIG-AMT          07830005
091900                                          SA007-ADJ-AMT           07840005
091900         MOVE 'ECR'                    TO SA007-SUM-CTG-CDE       07850005
091900         PERFORM 4100-WRITE-TSAADSU                               07860005
091800     END-IF.                                                      07870005
091900                                                                  07880005
091700     IF PV-SHS-AMT NOT EQUAL 0                                    07890005
091900         MOVE PV-SHS-AMT               TO SA007-ORIG-AMT          07900005
091900                                          SA007-ADJ-AMT           07910005
091900         MOVE 'SHS'                    TO SA007-SUM-CTG-CDE       07920005
091900         PERFORM 4100-WRITE-TSAADSU                               07930005
091800     END-IF.                                                      07940005
091900                                                                  07950005
091700     IF PV-SHR-AMT NOT EQUAL 0                                    07960005
091900         MOVE PV-SHR-AMT               TO SA007-ORIG-AMT          07970005
091900                                          SA007-ADJ-AMT           07980005
091900         MOVE 'SHR'                    TO SA007-SUM-CTG-CDE       07990005
091900         PERFORM 4100-WRITE-TSAADSU                               08000005
091800     END-IF.                                                      08010005
091900                                                                  08020005
091700     IF PV-GWS-AMT NOT EQUAL 0                                    08030005
091900         MOVE PV-GWS-AMT               TO SA007-ORIG-AMT          08040005
091900                                          SA007-ADJ-AMT           08050005
091900         MOVE 'GWS'                    TO SA007-SUM-CTG-CDE       08060005
091900         PERFORM 4100-WRITE-TSAADSU                               08070005
091800     END-IF.                                                      08080005
091900                                                                  08090005
091700     IF PV-GWR-AMT NOT EQUAL 0                                    08100005
091900         MOVE PV-GWR-AMT               TO SA007-ORIG-AMT          08110005
091900                                          SA007-ADJ-AMT           08120005
091900         MOVE 'GWR'                    TO SA007-SUM-CTG-CDE       08130005
091900         PERFORM 4100-WRITE-TSAADSU                               08140005
091800     END-IF.                                                      08150005
091900                                                                  08160005
091700     IF PV-SFS-AMT NOT EQUAL 0                                    08170005
091700         MOVE PV-SFS-AMT               TO SA007-ORIG-AMT          08180005
091800                                          SA007-ADJ-AMT           08190005
091900         MOVE 'SFS'                    TO SA007-SUM-CTG-CDE       08200005
092000         PERFORM 4100-WRITE-TSAADSU                               08210005
057500         ADD PV-SFS-AMT                TO PV-SFS-TOTAL            08220005
091800     END-IF.                                                      08230005
091900                                                                  08240005
8446E      IF PV-BPS-AMT NOT EQUAL 0                                    08250005
8446E          MOVE PV-BPS-AMT               TO SA007-ORIG-AMT          08260005
8446E                                           SA007-ADJ-AMT           08270005
8446E          MOVE 'BPS'                    TO SA007-SUM-CTG-CDE       08280005
8446E          PERFORM 4100-WRITE-TSAADSU                               08290005
8446E          ADD PV-BPS-AMT                TO PV-BPS-TOTAL            08300005
8446E      END-IF.                                                      08310005
8446E                                                                   08320005
BOSS       IF PV-BPR-AMT NOT EQUAL 0                                    08330005
BOSS           MOVE PV-BPR-AMT               TO SA007-ORIG-AMT          08340005
BOSS                                            SA007-ADJ-AMT           08350005
BOSS           MOVE 'BPR'                    TO SA007-SUM-CTG-CDE       08360005
BOSS           PERFORM 4100-WRITE-TSAADSU                               08370005
BOSS           ADD PV-BPR-AMT                TO PV-BPR-TOTAL            08380005
BOSS       END-IF.                                                      08381005
BOSS                                                                    08381105
BOSS       IF PV-BOS-AMT NOT EQUAL 0                                    08381205
BOSS           MOVE PV-BOS-AMT               TO SA007-ORIG-AMT          08381305
BOSS                                            SA007-ADJ-AMT           08381405
BOSS           MOVE 'BOS'                    TO SA007-SUM-CTG-CDE       08381505
BOSS           PERFORM 4100-WRITE-TSAADSU                               08381605
BOSS           ADD PV-BOS-AMT                TO PV-BOS-TOTAL            08381705
BOSS       END-IF.                                                      08381805
BOSS                                                                    08381905
BOSS       IF PV-BSR-AMT NOT EQUAL 0                                    08382005
BOSS           MOVE PV-BSR-AMT               TO SA007-ORIG-AMT          08382105
BOSS                                            SA007-ADJ-AMT           08382205
BOSS           MOVE 'BSR'                    TO SA007-SUM-CTG-CDE       08382305
BOSS           PERFORM 4100-WRITE-TSAADSU                               08382405
BOSS           ADD PV-BSR-AMT                TO PV-BSR-TOTAL            08382505
BOSS       END-IF.                                                      08382605
BOSS                                                                    08382705
052914     IF PV-DBS-AMT NOT EQUAL 0                                    08382805
052914         MOVE PV-DBS-AMT               TO SA007-ORIG-AMT          08382905
052914                                          SA007-ADJ-AMT           08383005
012815         MOVE 'DBN'                    TO SA007-SUM-CTG-CDE       08384005
052914         PERFORM 4100-WRITE-TSAADSU                               08385005
052914     END-IF.                                                      08386005
052914                                                                  08387005
091700     IF PV-TMR-AMT NOT EQUAL 0                                    08388005
091900         MOVE PV-TMR-AMT               TO SA007-ORIG-AMT          08389005
091900                                          SA007-ADJ-AMT           08390005
091900         MOVE 'TMR'                    TO SA007-SUM-CTG-CDE       08400005
091900         PERFORM 4100-WRITE-TSAADSU                               08410005
091800     END-IF.                                                      08420005
091900                                                                  08430005
091700     IF PV-BCN-AMT NOT EQUAL 0                                    08440005
091900         MOVE PV-BCN-AMT               TO SA007-ORIG-AMT          08450005
091900                                          SA007-ADJ-AMT           08460005
091900         MOVE 'BCN'                    TO SA007-SUM-CTG-CDE       08470005
091900         PERFORM 4100-WRITE-TSAADSU                               08480005
091800     END-IF.                                                      08490005
091900                                                                  08500005
091700     IF PV-NCN-AMT NOT EQUAL 0                                    08510005
091900         MOVE PV-NCN-AMT               TO SA007-ORIG-AMT          08520005
091900                                          SA007-ADJ-AMT           08530005
091900         MOVE 'NCN'                    TO SA007-SUM-CTG-CDE       08540005
091900         PERFORM 4100-WRITE-TSAADSU                               08550005
091800     END-IF.                                                      08560005
091900                                                                  08570005
091700     IF PV-AEN-AMT NOT EQUAL 0                                    08580005
091900         MOVE PV-AEN-AMT               TO SA007-ORIG-AMT          08590005
091900                                          SA007-ADJ-AMT           08600005
091900         MOVE 'AEN'                    TO SA007-SUM-CTG-CDE       08610005
091900         PERFORM 4100-WRITE-TSAADSU                               08620005
091800     END-IF.                                                      08630005
091900                                                                  08640005
091700     IF PV-KCN-AMT NOT EQUAL 0                                    08650005
091900         MOVE PV-KCN-AMT               TO SA007-ORIG-AMT          08660005
091900                                          SA007-ADJ-AMT           08670005
091900         MOVE 'KCN'                    TO SA007-SUM-CTG-CDE       08680005
091900         PERFORM 4100-WRITE-TSAADSU                               08690005
091800     END-IF.                                                      08700005
091900                                                                  08710005
091700     IF PV-STM-AMT NOT EQUAL 0                                    08720005
091900         MOVE PV-STM-AMT               TO SA007-ORIG-AMT          08730005
091900                                          SA007-ADJ-AMT           08740005
091900         MOVE 'STM'                    TO SA007-SUM-CTG-CDE       08750005
091900         PERFORM 4100-WRITE-TSAADSU                               08760005
057500         ADD PV-STM-AMT                TO PV-STM-TOTAL            08770005
091800     END-IF.                                                      08780005
PAYVEN                                                                  08790109
PAYVEN     IF PV-PPN-AMT NOT EQUAL 0                                    08791009
PAYVEN         MOVE PV-PPN-AMT               TO SA007-ORIG-AMT          08792009
PAYVEN                                          SA007-ADJ-AMT           08793009
PAYVEN         MOVE 'PPN'                    TO SA007-SUM-CTG-CDE       08794009
PAYVEN     PERFORM 4100-WRITE-TSAADSU.                                  08795009
PAYVEN                                                                  08796009
PAYVEN     IF PV-VMN-AMT NOT EQUAL 0                                    08797009
PAYVEN         MOVE PV-VMN-AMT               TO SA007-ORIG-AMT          08797109
PAYVEN                                          SA007-ADJ-AMT           08797209
PAYVEN         MOVE 'VMN'                    TO SA007-SUM-CTG-CDE       08797309
PAYVEN     PERFORM 4100-WRITE-TSAADSU.                                  08797409
PAYVEN                                                                  08798009
057500     INITIALIZE PV-BCN-AMT                                        08800005
057500                PV-NCN-AMT                                        08810005
057500                PV-AEN-AMT                                        08820005
057500                PV-KCN-AMT                                        08830005
057500                PV-STM-AMT                                        08840005
057500                PV-TAX-AMT                                        08850005
057500                PV-GDS-AMT                                        08860005
057500                PV-GTS-AMT                                        08870005
057500                PV-KMT-AMT                                        08880005
057500                PV-POS-AMT                                        08890005
057500                PV-GTT-AMT                                        08900005
057500                PV-GDT-AMT                                        08910005
057500                PV-CRI-AMT                                        08920005
057500                PV-KMI-AMT                                        08930005
057500                PV-POR-AMT                                        08940005
057500                PV-KCP-AMT                                        08950005
057500                PV-NSF-AMT                                        08960005
057500                PV-ECR-AMT                                        08970005
057500                PV-TMR-AMT                                        08980005
057500                PV-SHS-AMT                                        08990005
057500                PV-SHR-AMT                                        09000005
057500                PV-GWS-AMT                                        09010005
057500                PV-GWR-AMT                                        09020005
052914                PV-DBS-AMT                                        09030005
8446E                 PV-BPS-AMT                                        09040005
BOSS                  PV-BPR-AMT                                        09050005
BOSS                  PV-BOS-AMT                                        09050105
BOSS                  PV-BSR-AMT                                        09050205
059800                PV-SFS-AMT                                        09050308
PAYVEN                PV-PPN-AMT                                        09050408
PAYVEN                PV-VMN-AMT.                                       09050508
097300                                                                  09050605
097400                                                                  09050705
097500******************************************************************09050805
097600* WRITE THE TSAADSU RECORDS                                       09050905
097700******************************************************************09051005
097800 4100-WRITE-TSAADSU.                                              09051105
097900                                                                  09051205
098000     WRITE TSAADSU-REC FROM SA007-TSAADSU-REC.                    09052005
098100                                                                  09053005
098200     ADD 1 TO PA-TSAADSU-WRITTEN.                                 09054005
098300                                                                  09055005
098400                                                                  09056005
098500******************************************************************09057005
098600* ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.    09058005
098700******************************************************************09059005
098800 9100-SQL-ABEND.                                                  09060005
098900                                                                  09070005
099000     MOVE SQLCODE    TO SQLCODE2.                                 09080005
099100     MOVE SQLERRD(3) TO SQLERRD3.                                 09090005
099200                                                                  09100005
099300     DISPLAY '** ABEND           ** = SQLABEND'.                  09110005
099400     DISPLAY '** PROGRAM         ** = ' PC-PGM-NAME.              09120005
099500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        09130005
099600     DISPLAY '** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME.        09140005
099700     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG.     09150005
099800     DISPLAY '** PARTN NBR       ** = ' PV-ABEND-PARTN-NBR.       09160005
099900     DISPLAY '** STORE NBR       ** = ' PV-ABEND-STR-NBR.         09170005
100000     DISPLAY '** CTG CODE        ** = ' PV-ABEND-SUM-CTG-CDE.     09180005
100100     DISPLAY '** SQLCODE         ** = ' SQLCODE2.                 09190005
100200     DISPLAY '** ROWS PROCESSED  ** = ' SQLERRD3.                 09200005
100300     DISPLAY '** SQLERRM         ** = ' SQLERRM.                  09210005
100400     DISPLAY '** SQLERRMC        ** = ' SQLERRMC.                 09220005
100500                                                                  09230005
100600******************************************************************09240005
100700*  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   09250005
100800*  MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        09260005
100900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     09270005
101000*  FORMAT.                                                        09280005
101100******************************************************************09290005
101200                                                                  09300005
101300     COPY DPPD004.                                                09310005
101400                                                                  09320005
101500     CALL 'ILBOABN0' USING ABEND-CODE.                            09330005
101600                                                                  09340005
101700                                                                  09350005
101800******************************************************************09360005
101900*  ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                     09370005
102000******************************************************************09380005
102100 9200-ABEND.                                                      09390005
102200                                                                  09400005
102300     PERFORM 9900-END-PROC.                                       09410005
102400                                                                  09420005
102500     DISPLAY '** ABEND           **'.                             09430005
102600     DISPLAY '** PROGRAM         ** = ' PC-PGM-NAME.              09440005
102700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        09450005
102800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       09460005
102900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       09470005
103000                                                                  09480005
103100     CALL 'ILBOABN0' USING ABEND-CODE.                            09490005
103200                                                                  09500005
103300                                                                  09510005
103400******************************************************************09520005
103500* PREFORMS TASK TERMINATION PROCESSING                            09530005
103600******************************************************************09540005
103700 9900-END-PROC.                                                   09550005
103800                                                                  09560005
103900     CLOSE TSAADSU-FILE.                                          09570005
104000                                                                  09580005
104300     PERFORM 9999-CONTROLS.                                       09590005
104400                                                                  09600005
107400                                                                  09610005
107500******************************************************************09620005
107600* DISPLAY CONTROLS FROM THE PROGRAM                               09630005
107700******************************************************************09640005
107800 9999-CONTROLS.                                                   09650005
107900                                                                  09660005
108000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 09670005
108100                                                                  09680005
108200     MOVE SYS-TIME (1:2) TO ST-END-HR.                            09690005
108300     MOVE SYS-TIME (3:2) TO ST-END-MN.                            09700005
108400                                                                  09710005
108500     DISPLAY '                    '.                              09720005
108600     DISPLAY '**********************'.                            09730005
108700     DISPLAY '   SAKUT114 CONTROLS  '.                            09740005
108800     DISPLAY '**********************'.                            09750005
108900     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         09760005
109000     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          09770005
109100     DISPLAY 'END TIME  = ' ST-END-TIME.                          09780005
109200     DISPLAY '======================'.                            09790005
109500     DISPLAY 'SUM CURSOR ROWS FETCHED    = '                      09800005
109600                                PA-SUM-CURSOR-CNT.                09810005
109700     DISPLAY '                    '.                              09820005
109800     DISPLAY 'TSAADSU WRITTEN = ' PA-TSAADSU-WRITTEN.             09830005
109900     DISPLAY '                    '.                              09840005
110000                                                                  09850005
057500     MOVE PV-STM-TOTAL     TO PV-DISPLAY-STM-TOTAL.               09860005
057500     MOVE PV-SFS-TOTAL     TO PV-DISPLAY-SFS-TOTAL.               09870005
8446E      MOVE PV-BPS-TOTAL     TO PV-DISPLAY-BPS-TOTAL.               09880005
BOSS       MOVE PV-BPR-TOTAL     TO PV-DISPLAY-BPR-TOTAL.               09890005
BOSS       MOVE PV-BOS-TOTAL     TO PV-DISPLAY-BOS-TOTAL.               09900005
BOSS       MOVE PV-BSR-TOTAL     TO PV-DISPLAY-BSR-TOTAL.               09910005
057500     DISPLAY 'PV-STM-TOTAL = ' PV-DISPLAY-STM-TOTAL.              09920005
057500     DISPLAY 'PV-SFS-TOTAL = ' PV-DISPLAY-SFS-TOTAL.              09930005
8446E      DISPLAY 'PV-BPS-TOTAL = ' PV-DISPLAY-BPS-TOTAL.              09940005
BOSS       DISPLAY 'PV-BPR-TOTAL = ' PV-DISPLAY-BPR-TOTAL.              09950005
BOSS       DISPLAY 'PV-BOS-TOTAL = ' PV-DISPLAY-BOS-TOTAL.              09960005
BOSS       DISPLAY 'PV-BSR-TOTAL = ' PV-DISPLAY-BSR-TOTAL.              09970005
110100                                                                  09980005
