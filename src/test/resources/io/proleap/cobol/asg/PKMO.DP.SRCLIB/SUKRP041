000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             SUKRP041.                                00040001
000500 AUTHOR.                 LARRY SCHLEICHER.                        00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            APRIL 2005.                              00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  THIS PROGRAM WILL CREATE THE WEEKLY, MONTHLY, SEASONAL       * 00100001
001100*  AND YEARLY CARTONS SCAN BASED RECEIVED BY DC REPORT          * 00110001
001200***************************************************************** 00120001
001300 ENVIRONMENT DIVISION.                                            00130001
001400***************************************************************** 00140001
001500 CONFIGURATION SECTION.                                           00150001
001600 SOURCE-COMPUTER.        IBM-3090.                                00160001
001700 OBJECT-COMPUTER.        IBM-3090.                                00170001
001800                                                                  00180001
001900 INPUT-OUTPUT SECTION.                                            00190001
002000 FILE-CONTROL.                                                    00200001
002100*                                                                 00210001
002200     SELECT NEW-CONTROL-FILE                                      00220001
002300         ASSIGN TO SYSIN.                                         00230018
002400*                                                                 00240001
002500     SELECT INPUT-FILE                                            00250001
002600         ASSIGN TO INP01.                                         00260018
002700*                                                                 00270001
002800     SELECT REPORT-FILE                                           00280001
002900         ASSIGN TO RPT01.                                         00290001
003000*                                                                 00300001
003100***************************************************************** 00310001
003200 DATA DIVISION.                                                   00320001
003300***************************************************************** 00330001
003400 FILE SECTION.                                                    00340001
003500*                                                                 00350001
003600 FD  NEW-CONTROL-FILE                                             00360001
003700     RECORDING MODE IS F                                          00370001
003800     BLOCK CONTAINS 0 RECORDS.                                    00380001
003900 01  NEW-CONTROL-RECORD               PIC X(080).                 00390001
004000                                                                  00400001
004100*                                                                 00410001
004200 FD  INPUT-FILE                                                   00420001
004300     RECORDING MODE IS F                                          00430001
004400     BLOCK CONTAINS 0  RECORDS.                                   00440001
004500 01  INPUT-RECORD                    PIC  X(200).                 00450004
004600*                                                                 00460001
004700 FD  REPORT-FILE                                                  00470001
004800     RECORDING MODE IS F                                          00480001
004900     BLOCK CONTAINS 0  RECORDS.                                   00490001
005000 01  REPORT-RECORD                   PIC  X(132).                 00500001
005100*                                                                 00510001
005200***************************************************************** 00520001
005300 WORKING-STORAGE SECTION.                                         00530001
005400*                                                                 00540001
005500 01  PROGRAM-SWITCHES.                                            00550001
005600     05  PS-EOF-INPUT-SW              PIC X(01) VALUE 'N'.        00560004
005700         88  PS-EOF-INPUT                       VALUE 'Y'.        00570004
005800*                                                                 00580001
005900 01  PV-PROGRAM-CONSTANTS.                                        00590001
006000     05  PC-SUKRP041                 PIC X(08) VALUE  'SUKRP041'. 00600001
006100     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00610001
006200*                                                                 00620001
006300 01  DK-KEY-FIELDS.                                               00630001
006400     05  DK-STR-NBR                  PIC  S9(4) COMP  VALUE 0.    00640001
006500*                                                                 00650001
006600 01  PV-PROGRAM-VARIABLES.                                        00660001
006700     05  PV-DATE                     PIC X(10).                   00670001
006800                                                                  00680001
006900     05  PV-DISP-OPER                PIC 9(04).                   00690001
007000     05  PV-DISP-COUNT               PIC 9(09)V99.                00700001
007100     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       00710001
007200     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00720001
007300     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00730001
007400                                                   COMP-3.        00740001
007500     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00750001
007600                                                   COMP-3.        00760001
007700     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00770001
007800                                                   COMP-3.        00780001
007900 01  PV-DC-COUNTS.                                                00790009
008000     05  PV-OUTBOUND-SMO             PIC S9(9) COMP.              00800001
008100     05  PV-OUTBOUND-ASN             PIC S9(9) COMP.              00810001
008200     05  PV-OUTBOUND-CPS             PIC S9(9) COMP.              00820001
008300     05  PV-DISTHD-P2L               PIC S9(9) COMP.              00830001
008400     05  PV-SULBXF-COUNT             PIC S9(9) COMP.              00840001
008500     05  PV-SULBXF-P2L               PIC S9(9) COMP.              00850001
008600     05  PV-TOT-CTNS-RECEIVED        PIC S9(9) COMP.              00860001
008700     05  PV-TOT-CTNS-CHECKIN         PIC S9(9) COMP.              00870001
008800     05  PV-TOT-CTNS-PHYSICAL        PIC S9(9) COMP.              00880001
008900     05  PV-TOT-SML                  PIC S9(9) COMP.              00890001
009000     05  PV-TOT-P2L                  PIC S9(9) COMP.              00900001
009100 01  PV-CORP-COUNTS.                                              00910009
009200     05  PV-OUTBOUND-SMO-CORP        PIC S9(9) COMP.              00920001
009300     05  PV-OUTBOUND-ASN-CORP        PIC S9(9) COMP.              00930001
009400     05  PV-OUTBOUND-CPS-CORP        PIC S9(9) COMP.              00940001
009500     05  PV-DISTHD-P2L-CORP          PIC S9(9) COMP.              00950001
009600     05  PV-SULBXF-P2L-CORP          PIC S9(9) COMP.              00960001
009700     05  PV-TOT-CTNS-RECEIVED-CORP   PIC S9(9) COMP.              00970001
009800     05  PV-TOT-CTNS-CHECKIN-CORP    PIC S9(9) COMP.              00980001
009900     05  PV-TOT-CTNS-PHYSICAL-CORP   PIC S9(9) COMP.              00990001
010000     05  PV-TOT-SML-CORP             PIC S9(9) COMP.              01000001
010100     05  PV-TOT-P2L-CORP             PIC S9(9) COMP.              01010001
010200 01  PV-PCT-FIELDS.                                               01020009
010300     05  PV-WORKING-PCT              PIC S9(9)V9999 COMP-3.       01030001
010400     05  PV-UCC128-PCT               PIC S9(9)V9 COMP-3.          01040001
010500     05  PV-PHYSICAL-PCT             PIC S9(9)V9 COMP-3.          01050001
010600     05  PV-SML-PCT                  PIC S9(9)V9 COMP-3.          01060001
010700     05  PV-SML-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01070001
010800     05  PV-SML-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01080001
010900     05  PV-SML-SMOOTHING-PCT        PIC S9(9)V9 COMP-3.          01090001
011000     05  PV-P2L-SML-PCT              PIC S9(9)V9 COMP-3.          01100001
011100     05  PV-P2L-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01110001
011200     05  PV-P2L-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01120001
011300 01  PV-DATE-FIELDS.                                              01130015
011400     05  PV-TODAYS-DATE.                                          01140001
011500         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01150001
011600         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01160001
011700         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01170001
011800     05  PV-TODAYS-TIME.                                          01180001
011900         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01190001
012000         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01200001
012100         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01210001
012200         10  FILLER                  PIC 9(02) VALUE ZERO.        01220001
012300     05  PV-COMPARE-DATE.                                         01230001
012400         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        01240001
012500         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        01250001
012600         10  FILLER                  PIC X(01) VALUE '-'.         01260001
012700         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        01270001
012800         10  FILLER                  PIC X(01) VALUE '-'.         01280001
012900         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        01290001
013000*                                                                 01300001
013100 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01310001
013200                                                 COMP SYNC.       01320001
013300*                                                                 01330001
013400******************************************************************01340001
013500*  DB2 FORMATTED MESSAGE AREA                                     01350001
013600******************************************************************01360001
013700     COPY DPWS004.                                                01370001
013800*                                                                 01380001
013900*    DATE CONTROL CARD                                            01390001
014000     COPY SURD032.                                                01400001
014100                                                                  01410001
014200     COPY SURD059.                                                01420001
014300*                                                                 01430001
014400******************************************************************01440001
014500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01450001
014600******************************************************************01460001
014700     COPY DPWS132O.                                               01470001
014800*                                                                 01480001
014900 01  HEADING-LINES.                                               01490001
015000     05  HEADING-LINE-1.                                          01500001
015100         10  FILLER                  PIC  X(46)    VALUE SPACES.  01510001
015200         10  HEAD1-PERIOD            PIC  X(07).                  01520001
015300         10  FILLER                  PIC  X(36)    VALUE          01530001
015400             ' - CARTONS SCAN BASED RECEIVED BY DC'.              01540001
015500         10  FILLER                  PIC  X(43)    VALUE SPACES.  01550001
015600*                                                                 01560001
015700     05  HEADING-LINE-2.                                          01570001
015800         10  FILLER                  PIC  X(51)    VALUE SPACES.  01580001
015900         10  FILLER                  PIC  X(05)    VALUE          01590001
016000             'FROM '.                                             01600001
016100         10  HEADING-2-FROM-DTE      PIC  X(10)    VALUE SPACES.  01610001
016200         10  FILLER                  PIC  X(04)    VALUE          01620001
016300             ' TO '.                                              01630001
016400         10  HEADING-2-TO-DTE        PIC  X(10)    VALUE SPACES.  01640001
016500         10  FILLER                  PIC  X(52)    VALUE SPACES.  01650001
016600*                                                                 01660001
016700     05  HEADING-LINE-3.                                          01670001
016800         10  FILLER                  PIC  X(32)    VALUE SPACES.  01680001
016900         10  FILLER                  PIC  X(05)    VALUE          01690001
017000             'TOTAL'.                                             01700001
017100         10  FILLER                  PIC  X(06)    VALUE SPACES.  01710001
017200         10  FILLER                  PIC  X(05)    VALUE          01720001
017300             'TOTAL'.                                             01730001
017400         10  FILLER                  PIC  X(06)    VALUE SPACES.  01740001
017500         10  FILLER                  PIC  X(05)    VALUE          01750001
017600             'TOTAL'.                                             01760001
017700         10  FILLER                  PIC  X(73)    VALUE SPACES.  01770001
017800*                                                                 01780001
017900     05  HEADING-LINE-4.                                          01790001
018000         10  FILLER                  PIC  X(31)    VALUE SPACES.  01800001
018100         10  FILLER                  PIC  X(07)    VALUE          01810001
018200             'CARTONS'.                                           01820001
018300         10  FILLER                  PIC  X(04)    VALUE SPACES.  01830001
018400         10  FILLER                  PIC  X(07)    VALUE          01840001
018500             'CARTONS'.                                           01850001
018600         10  FILLER                  PIC  X(04)    VALUE SPACES.  01860001
018700         10  FILLER                  PIC  X(07)    VALUE          01870001
018800             'CARTONS'.                                           01880001
018900* DMH    10  FILLER                  PIC  X(06)    VALUE SPACES.  01890019
019000         10  FILLER                  PIC  X(05)    VALUE SPACES.  01900019
019100         10  FILLER                  PIC  X(21)    VALUE          01910001
019200             '-------------- S M L '.                             01920001
019300         10  FILLER                  PIC  X(16)    VALUE          01930001
019400             '----------------'.                                  01940001
019500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01950001
019600         10  FILLER                  PIC  X(27)    VALUE          01960001
019700             '--------- P 2 L -----------'.                       01970001
019800         10  FILLER                  PIC  X        VALUE SPACE.   01980019
019900*                                                                 01990001
020000     05  HEADING-LINE-5.                                          02000001
020100         10  FILLER                  PIC  X(03)    VALUE          02010001
020200             ' DC'.                                               02020001
020300         10  FILLER                  PIC  X(28)    VALUE SPACES.  02030001
020400         10  FILLER                  PIC  X(08)    VALUE          02040001
020500             'RECEIVED'.                                          02050001
020600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02060001
020700         10  FILLER                  PIC  X(07)    VALUE          02070001
020800             'CHECKIN'.                                           02080001
020900         10  FILLER                  PIC  X(04)    VALUE SPACES.  02090001
021000         10  FILLER                  PIC  X(08)    VALUE          02100001
021100             'PHYSICAL'.                                          02110001
021200* DMH    10  FILLER                  PIC  X(07)    VALUE SPACES.  02120019
021300         10  FILLER                  PIC  X(06)    VALUE SPACES.  02130019
021400         10  FILLER                  PIC  X(05)    VALUE          02140001
021500             'TOTAL'.                                             02150001
021600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02160001
021700         10  FILLER                  PIC  X(07)    VALUE          02170001
021800             'CHECKIN'.                                           02180001
021900         10  FILLER                  PIC  X(02)    VALUE SPACES.  02190001
022000         10  FILLER                  PIC  X(08)    VALUE          02200001
022100             'PHYSICAL'.                                          02210001
022200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02220001
022300         10  FILLER                  PIC  X(09)    VALUE          02230001
022400             'SMOOTHING'.                                         02240001
022500         10  FILLER                  PIC  X(04)    VALUE SPACES.  02250001
022600         10  FILLER                  PIC  X(05)    VALUE          02260001
022700             'TOTAL'.                                             02270001
022800         10  FILLER                  PIC  X(03)    VALUE SPACES.  02280001
022900         10  FILLER                  PIC  X(07)    VALUE          02290001
023000             'CHECKIN'.                                           02300001
023100         10  FILLER                  PIC  X(02)    VALUE SPACES.  02310001
023200         10  FILLER                  PIC  X(08)    VALUE          02320001
023300             'PHYSICAL'.                                          02330001
023400         10  FILLER                  PIC  X        VALUE SPACE.   02340019
023500*                                                                 02350001
023600 01  DETAIL-LINES.                                                02360001
023700     05  DETAIL-LINE1.                                            02370001
023800         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02380001
023900         10  FILLER                 PIC  X(01)     VALUE SPACES.  02390001
024000         10  DL1-OPER-DESC          PIC  X(22)     VALUE SPACES.  02400014
024100         10  DL1-TOT-CARTN-RECVD    PIC  ZZZ,ZZZ,ZZ9.             02410001
024200         10  DL1-TOT-CARTN-CHCKIN   PIC  ZZZ,ZZZ,ZZ9.             02420001
024300         10  DL1-TOT-CARTN-PHYSCL   PIC  ZZZ,ZZZ,ZZ9.             02430001
024400* DMH    10  FILLER                 PIC  X(02)     VALUE SPACES.  02440019
024500         10  FILLER                 PIC  X(01)     VALUE SPACES.  02450019
024600         10  DL1-SML-TOTAL          PIC  ZZZ,ZZZ,ZZ9.             02460001
024700         10  DL1-SML-CKECKIN        PIC  ZZ,ZZZ,ZZ9.              02470001
024800         10  DL1-SML-PHYSICAL       PIC  ZZ,ZZZ,ZZ9.              02480001
024900         10  DL1-SML-SMOOTHING      PIC  ZZZZZ,ZZ9.               02490001
025000         10  DL1-P2L-TOTAL          PIC  ZZ,ZZZ,ZZ9.              02500001
025100         10  DL1-P2L-CHECKIN        PIC  ZZ,ZZZ,ZZ9.              02510001
025200         10  DL1-P2L-PHYSICAL       PIC  ZZ,ZZZ,ZZ9.              02520001
025300         10  FILLER                  PIC  X        VALUE SPACE.   02530019
025400*                                                                 02540001
025500     05  DETAIL-LINE2.                                            02550001
025600         10  FILLER                 PIC  X(44)     VALUE SPACES.  02560001
025700         10  DL2-TOT-CRT-CHKIN-PCT  PIC  ZZZ.9.                   02570001
025800         10  FILLER                 PIC  X(06)     VALUE SPACES.  02580001
025900         10  DL2-TOT-CRT-PHYSCL-PCT PIC  ZZZ.9.                   02590001
026000* DMH    10  FILLER                 PIC  X(08)     VALUE SPACES.  02600019
026100         10  FILLER                 PIC  X(07)     VALUE SPACES.  02610019
026200         10  DL2-SML-TOTAL-PCT      PIC  ZZZ.9.                   02620001
026300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02630001
026400         10  DL2-SML-CKECKIN-PCT    PIC  ZZZ.9.                   02640001
026500         10  FILLER                 PIC  X(05)     VALUE SPACES.  02650001
026600         10  DL2-SML-PHYSICAL-PCT   PIC  ZZZ.9.                   02660001
026700         10  FILLER                 PIC  X(04)     VALUE SPACES.  02670001
026800         10  DL2-SML-SMOOTHING-PCT  PIC  ZZZ.9.                   02680001
026900         10  FILLER                 PIC  X(05)     VALUE SPACES.  02690001
027000         10  DL2-P2L-TOTAL-PCT      PIC  ZZZ.9.                   02700001
027100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02710001
027200         10  DL2-P2L-CHECKIN-PCT    PIC  ZZZ.9.                   02720001
027300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02730001
027400         10  DL2-P2L-PHYSICAL-PCT   PIC  ZZZ.9.                   02740001
027500         10  FILLER                  PIC  X        VALUE SPACE.   02750019
027600*                                                                 02760001
027700 01  MISCELLANEOUS-LINES.                                         02770001
027800     05  END-OF-REPORT-LINE.                                      02780001
027900         10  FILLER                  PIC  X(54)    VALUE SPACES.  02790001
028000         10  FILLER                  PIC  X(44)    VALUE          02800001
028100             '  ** END OF REPORT **                       '.      02810001
028200         10  FILLER                  PIC  X(44)    VALUE SPACES.  02820001
028300*                                                                 02830001
028400*                                                                 02840001
028500*DB2 AREA FOR XLT_LOC                                             02850020
028600     EXEC SQL                                                     02860020
028700          INCLUDE XLT00010                                        02870020
028800     END-EXEC.                                                    02880020
028900*                                                                 02890001
029000*                                                                 02900001
029100***************************************************************** 02910001
029200*  DB2 COMMUNICATION AREA                                         02920001
029300***************************************************************** 02930001
029400     EXEC SQL                                                     02940001
029500         INCLUDE SQLCA                                            02950001
029600     END-EXEC.                                                    02960001
029700                                                                  02970001
029800***************************************************************** 02980001
029900*  DB2 COMMUNICATION AREA2                                        02990001
030000***************************************************************** 03000001
030100     COPY SQLCA2.                                                 03010001
030200                                                                  03020001
030300                                                                  03030001
030400***************************************************************** 03040001
030500 PROCEDURE DIVISION.                                              03050001
030600*                                                                 03060001
030700 0000-MAINLINE-PROCESSING.                                        03070001
030800******************************************************************03080001
030900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03090001
031000******************************************************************03100001
031100     DISPLAY '****** STARTING SUKRP041 ******'.                   03110001
031200*                                                                 03120001
031300*OPEN FILES.                                                      03130001
031400     OPEN INPUT  NEW-CONTROL-FILE                                 03140001
031500                 INPUT-FILE                                       03150001
031600          OUTPUT REPORT-FILE.                                     03160001
031700*                                                                 03170001
031800     PERFORM 1000-INITIALIZATION.                                 03180001
031900*                                                                 03190001
032000     PERFORM 1500-PAGE-BREAK.                                     03200001
032100     PERFORM 2000-PROCESS-DCS                                     03210005
032200         UNTIL PS-EOF-INPUT.                                      03220005
032300     PERFORM 2300-CORP-TOTALS.                                    03230005
032400                                                                  03240001
032500*                                                                 03250001
032600     CLOSE NEW-CONTROL-FILE                                       03260001
032700           REPORT-FILE                                            03270001
032800           INPUT-FILE.                                            03280001
032900     GOBACK.                                                      03290001
033000*                                                                 03300001
033100******************************************************************03310001
033200 1000-INITIALIZATION.                                             03320001
033300******************************************************************03330001
033400**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03340001
033500******************************************************************03350001
033600                                                                  03360001
033700     ACCEPT PV-TODAYS-DATE                                        03370001
033800       FROM DATE.                                                 03380001
033900*                                                                 03390001
034000     ACCEPT PV-TODAYS-TIME                                        03400001
034100       FROM TIME.                                                 03410001
034200*                                                                 03420001
034300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  03430001
034400                                PV-COMPARE-DATE-MM.               03440001
034500     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    03450001
034600                                PV-COMPARE-DATE-DD.               03460001
034700     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   03470001
034800                                PV-COMPARE-DATE-YY.               03480001
034900     IF PV-COMPARE-DATE-YY  >  80                                 03490001
035000         MOVE  19            TO PV-COMPARE-DATE-CC                03500001
035100     ELSE                                                         03510001
035200         MOVE  20            TO PV-COMPARE-DATE-CC                03520001
035300     END-IF.                                                      03530001
035400*                                                                 03540001
035500     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  03550001
035600     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                03560001
035700*                                                                 03570001
035800     MOVE PC-SUKRP041        TO DP132O-PROGRAM-NAME.              03580001
035900     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             03590001
036000*                                                                 03600001
036100     MOVE +0                 TO PV-PAGE-COUNT.                    03610001
036200                                                                  03620001
036300     PERFORM 8000-READ-CONTROL-REC.                               03630001
036400     MOVE SU032-FROM-DATE      TO HEADING-2-FROM-DTE.             03640001
036500     MOVE SU032-TO-DATE        TO HEADING-2-TO-DTE.               03650001
036600     EVALUATE SU032-RPT-TYPE                                      03660001
036700         WHEN 'W'                                                 03670001
036800             MOVE '  WEEK '               TO HEAD1-PERIOD         03680001
036900         WHEN 'M'                                                 03690001
037000             MOVE ' MONTH '               TO HEAD1-PERIOD         03700001
037100         WHEN 'S'                                                 03710001
037200             MOVE 'SEASON '               TO HEAD1-PERIOD         03720001
037300         WHEN 'C'                                                 03730001
037400         WHEN 'F'                                                 03740001
037500             MOVE '  YEAR '               TO HEAD1-PERIOD         03750001
037600         WHEN 'T'                                                 03760001
037700             MOVE '   YTD '               TO HEAD1-PERIOD         03770001
037800         WHEN OTHER                                               03780001
037900             MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH         03790002
038000             MOVE 'INVALID REPORT TYPE  ' TO PV-DB2-FUNCTION      03800002
038100             PERFORM 9100-SQL-ABEND                               03810002
038200     END-EVALUATE.                                                03820002
038300     INITIALIZE PV-DC-COUNTS                                      03830009
038400                PV-CORP-COUNTS.                                   03840009
038500*                                                                 03850001
038600******************************************************************03860001
038700**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03870001
038800**  PAGES (AS NEEDED).                                            03880001
038900******************************************************************03890001
039000 1500-PAGE-BREAK.                                                 03900001
039100*                                                                 03910001
039200     ADD +1                   TO PV-PAGE-COUNT.                   03920001
039300     MOVE PV-PAGE-COUNT       TO DP132O-PAGE-NUMBER.              03930001
039400*                                                                 03940001
039500     WRITE REPORT-RECORD                                          03950001
039600       FROM DP132O-STANDRD-HEADER-132-COLS                        03960001
039700         AFTER ADVANCING PAGE.                                    03970001
039800*                                                                 03980001
039900     WRITE REPORT-RECORD                                          03990001
040000       FROM HEADING-LINE-1                                        04000001
040100         AFTER ADVANCING 2 LINES.                                 04010001
040200*                                                                 04020001
040300     WRITE REPORT-RECORD                                          04030001
040400       FROM HEADING-LINE-2                                        04040001
040500         AFTER ADVANCING 1 LINE.                                  04050001
040600*                                                                 04060001
040700     WRITE REPORT-RECORD                                          04070001
040800       FROM HEADING-LINE-3                                        04080001
040900         AFTER ADVANCING 2 LINE.                                  04090001
041000*                                                                 04100001
041100     WRITE REPORT-RECORD                                          04110001
041200       FROM HEADING-LINE-4                                        04120001
041300         AFTER ADVANCING 1 LINE.                                  04130001
041400*                                                                 04140001
041500     WRITE REPORT-RECORD                                          04150001
041600       FROM HEADING-LINE-5                                        04160001
041700         AFTER ADVANCING 1 LINE.                                  04170001
041800*                                                                 04180001
041900     MOVE +6                 TO PV-LINE-COUNT.                    04190001
042000*                                                                 04200001
042100*                                                                 04210001
042200******************************************************************04220001
042300 2000-PROCESS-DCS.                                                04230001
042400     PERFORM 4000-READ-INPUT-RECORD                               04240015
042500       WITH TEST AFTER                                            04250016
042600       UNTIL                                                      04260015
042700        (SU059-DATE       = SU032-FROM-DATE OR                    04270015
042800         SU059-DATE       > SU032-FROM-DATE) AND                  04280015
042900        (SU059-DATE       < SU032-TO-DATE OR                      04290015
043000         SU059-DATE       = SU032-TO-DATE) OR                     04300015
043100        PS-EOF-INPUT.                                             04310016
043200                                                                  04320017
043300     IF (SU059-OPER-UNT-ID NOT = DK-STR-NBR) OR                   04330011
043400         PS-EOF-INPUT                                             04340011
043500         IF DK-STR-NBR > 0                                        04350010
043600             PERFORM 2200-CALCULATE-PERCENTAGES                   04360010
043700             PERFORM 3000-PRINT-DETAIL-LINE                       04370010
043800         END-IF                                                   04380010
043900         IF NOT PS-EOF-INPUT                                      04390010
044000             MOVE SU059-OPER-UNT-ID        TO DK-STR-NBR          04400008
044100             PERFORM 7000-SELECT-DC-NAME                          04410015
044200             INITIALIZE PV-DC-COUNTS                              04420009
044300         END-IF                                                   04430010
044400     END-IF.                                                      04440008
044500     IF NOT PS-EOF-INPUT                                          04450013
044600         PERFORM 2100-SUMM-DC                                     04460013
044700     END-IF.                                                      04470013
044800                                                                  04480001
044900*                                                                 04490001
045000 2100-SUMM-DC.                                                    04500001
045100     MOVE SU059-DATE               TO PV-DATE.                    04510001
045200     COMPUTE PV-TOT-CTNS-RECEIVED =                               04520001
045300             PV-TOT-CTNS-RECEIVED +                               04530001
045400             SU059-TOT-CTNS-RECEIVED.                             04540002
045500     COMPUTE PV-TOT-CTNS-CHECKIN =                                04550001
045600             PV-TOT-CTNS-CHECKIN +                                04560001
045700             SU059-TOT-CTNS-CHECKIN.                              04570002
045800     COMPUTE PV-TOT-CTNS-PHYSICAL =                               04580001
045900             PV-TOT-CTNS-PHYSICAL +                               04590001
046000             SU059-TOT-CTNS-PHYSICAL.                             04600002
046100     COMPUTE PV-TOT-SML =                                         04610001
046200             PV-TOT-SML +                                         04620001
046300             SU059-TOT-SML.                                       04630002
046400     COMPUTE PV-OUTBOUND-ASN =                                    04640001
046500             PV-OUTBOUND-ASN +                                    04650001
046600             SU059-OUTBOUND-ASN.                                  04660002
046700     COMPUTE PV-OUTBOUND-CPS =                                    04670001
046800             PV-OUTBOUND-CPS +                                    04680001
046900             SU059-OUTBOUND-CPS.                                  04690002
047000     COMPUTE PV-OUTBOUND-SMO =                                    04700001
047100             PV-OUTBOUND-SMO +                                    04710001
047200             SU059-OUTBOUND-SMO.                                  04720002
047300     COMPUTE PV-TOT-P2L =                                         04730001
047400             PV-TOT-P2L +                                         04740001
047500             SU059-TOT-P2L.                                       04750002
047600     COMPUTE PV-SULBXF-P2L =                                      04760001
047700             PV-SULBXF-P2L +                                      04770001
047800             SU059-SULBXF-P2L.                                    04780002
047900     COMPUTE PV-DISTHD-P2L =                                      04790001
048000             PV-DISTHD-P2L +                                      04800001
048100             SU059-DISTHD-P2L.                                    04810002
048200                                                                  04820001
048300 2200-CALCULATE-PERCENTAGES.                                      04830001
048400                                                                  04840001
048500     IF PV-TOT-CTNS-CHECKIN > 0 AND                               04850001
048600        PV-TOT-CTNS-RECEIVED > 0                                  04860001
048700         COMPUTE PV-WORKING-PCT =                                 04870001
048800                (PV-TOT-CTNS-CHECKIN /                            04880001
048900                 PV-TOT-CTNS-RECEIVED)                            04890001
049000         COMPUTE PV-UCC128-PCT ROUNDED =                          04900001
049100                 PV-WORKING-PCT * 100                             04910001
049200     ELSE                                                         04920001
049300         MOVE 0        TO PV-UCC128-PCT                           04930001
049400     END-IF.                                                      04940001
049500                                                                  04950001
049600     IF PV-TOT-CTNS-PHYSICAL > 0 AND                              04960001
049700        PV-TOT-CTNS-RECEIVED > 0                                  04970001
049800         COMPUTE PV-WORKING-PCT =                                 04980001
049900                (PV-TOT-CTNS-PHYSICAL /                           04990001
050000                 PV-TOT-CTNS-RECEIVED)                            05000001
050100         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        05010001
050200                 PV-WORKING-PCT * 100                             05020001
050300     ELSE                                                         05030001
050400         MOVE 0        TO PV-PHYSICAL-PCT                         05040001
050500     END-IF.                                                      05050001
050600                                                                  05060001
050700     IF PV-TOT-SML > 0 AND                                        05070001
050800        PV-TOT-CTNS-RECEIVED > 0                                  05080001
050900         COMPUTE PV-WORKING-PCT =                                 05090001
051000                (PV-TOT-SML /                                     05100001
051100                 PV-TOT-CTNS-RECEIVED)                            05110001
051200         COMPUTE PV-SML-PCT ROUNDED =                             05120001
051300                 PV-WORKING-PCT * 100                             05130001
051400     ELSE                                                         05140001
051500         MOVE 0        TO PV-SML-PCT                              05150001
051600     END-IF.                                                      05160001
051700                                                                  05170001
051800     IF PV-OUTBOUND-ASN > 0 AND                                   05180001
051900        PV-TOT-SML > 0                                            05190001
052000         COMPUTE PV-WORKING-PCT =                                 05200001
052100                (PV-OUTBOUND-ASN /                                05210001
052200                 PV-TOT-SML)                                      05220001
052300         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     05230001
052400                 PV-WORKING-PCT * 100                             05240001
052500     ELSE                                                         05250001
052600         MOVE 0        TO PV-SML-CHECKIN-PCT                      05260001
052700     END-IF.                                                      05270001
052800                                                                  05280001
052900     IF PV-OUTBOUND-CPS > 0 AND                                   05290001
053000        PV-TOT-SML > 0                                            05300001
053100         COMPUTE PV-WORKING-PCT =                                 05310001
053200                (PV-OUTBOUND-CPS /                                05320001
053300                 PV-TOT-SML)                                      05330001
053400         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    05340001
053500                 PV-WORKING-PCT * 100                             05350001
053600     ELSE                                                         05360001
053700         MOVE 0        TO PV-SML-PHYSICAL-PCT                     05370001
053800     END-IF.                                                      05380001
053900                                                                  05390001
054000     IF PV-OUTBOUND-SMO > 0 AND                                   05400001
054100        PV-TOT-SML > 0                                            05410001
054200         COMPUTE PV-WORKING-PCT =                                 05420001
054300                (PV-OUTBOUND-SMO /                                05430001
054400                 PV-TOT-SML)                                      05440001
054500         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   05450001
054600                 PV-WORKING-PCT * 100                             05460001
054700     ELSE                                                         05470001
054800         MOVE 0        TO PV-SML-SMOOTHING-PCT                    05480001
054900     END-IF.                                                      05490001
055000                                                                  05500001
055100     IF PV-TOT-P2L > 0 AND                                        05510001
055200        PV-TOT-CTNS-RECEIVED > 0                                  05520001
055300         COMPUTE PV-WORKING-PCT =                                 05530001
055400                (PV-TOT-P2L /                                     05540001
055500                 PV-TOT-CTNS-RECEIVED)                            05550001
055600         COMPUTE PV-P2L-SML-PCT ROUNDED =                         05560001
055700                 PV-WORKING-PCT * 100                             05570001
055800     ELSE                                                         05580001
055900         MOVE 0        TO PV-P2L-SML-PCT                          05590001
056000     END-IF.                                                      05600001
056100                                                                  05610001
056200     IF PV-SULBXF-P2L > 0 AND                                     05620001
056300        PV-TOT-P2L > 0                                            05630001
056400         COMPUTE PV-WORKING-PCT =                                 05640001
056500                (PV-SULBXF-P2L /                                  05650001
056600                 PV-TOT-P2L)                                      05660001
056700         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     05670001
056800                 PV-WORKING-PCT * 100                             05680001
056900     ELSE                                                         05690001
057000         MOVE 0        TO PV-P2L-CHECKIN-PCT                      05700001
057100     END-IF.                                                      05710001
057200                                                                  05720001
057300     IF PV-DISTHD-P2L > 0 AND                                     05730001
057400        PV-TOT-P2L > 0                                            05740001
057500         COMPUTE PV-WORKING-PCT =                                 05750001
057600                (PV-DISTHD-P2L /                                  05760001
057700                 PV-TOT-P2L)                                      05770001
057800         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    05780001
057900                 PV-WORKING-PCT * 100                             05790001
058000     ELSE                                                         05800001
058100         MOVE 0        TO PV-P2L-PHYSICAL-PCT                     05810001
058200     END-IF.                                                      05820001
058300                                                                  05830001
058400     COMPUTE PV-TOT-CTNS-RECEIVED-CORP =                          05840001
058500             PV-TOT-CTNS-RECEIVED-CORP +                          05850001
058600             PV-TOT-CTNS-RECEIVED.                                05860001
058700     COMPUTE PV-TOT-CTNS-CHECKIN-CORP =                           05870009
058800             PV-TOT-CTNS-CHECKIN-CORP +                           05880009
058900             PV-TOT-CTNS-CHECKIN.                                 05890009
059000     COMPUTE PV-TOT-CTNS-PHYSICAL-CORP =                          05900009
059100             PV-TOT-CTNS-PHYSICAL-CORP +                          05910009
059200             PV-TOT-CTNS-PHYSICAL.                                05920009
059300     COMPUTE PV-TOT-SML-CORP =                                    05930009
059400             PV-TOT-SML-CORP +                                    05940009
059500             PV-TOT-SML                                           05950009
059600     COMPUTE PV-TOT-P2L-CORP =                                    05960009
059700             PV-TOT-P2L-CORP +                                    05970009
059800             PV-TOT-P2L                                           05980009
059900     COMPUTE PV-OUTBOUND-SMO-CORP =                               05990001
060000             PV-OUTBOUND-SMO-CORP +                               06000001
060100             PV-OUTBOUND-SMO.                                     06010001
060200     COMPUTE PV-OUTBOUND-ASN-CORP =                               06020001
060300             PV-OUTBOUND-ASN-CORP +                               06030001
060400             PV-OUTBOUND-ASN.                                     06040001
060500     COMPUTE PV-OUTBOUND-CPS-CORP =                               06050001
060600             PV-OUTBOUND-CPS-CORP +                               06060001
060700             PV-OUTBOUND-CPS.                                     06070001
060800     COMPUTE PV-DISTHD-P2L-CORP =                                 06080001
060900             PV-DISTHD-P2L-CORP +                                 06090001
061000             PV-DISTHD-P2L.                                       06100001
061100     COMPUTE PV-SULBXF-P2L-CORP =                                 06110001
061200             PV-SULBXF-P2L-CORP +                                 06120001
061300             PV-SULBXF-P2L.                                       06130001
061400                                                                  06140001
061500 2300-CORP-TOTALS.                                                06150005
061600                                                                  06160005
061700     IF PV-TOT-CTNS-CHECKIN-CORP > 0 AND                          06170005
061800        PV-TOT-CTNS-RECEIVED-CORP > 0                             06180005
061900         COMPUTE PV-WORKING-PCT =                                 06190012
062000                (PV-TOT-CTNS-CHECKIN-CORP /                       06200005
062100                 PV-TOT-CTNS-RECEIVED-CORP)                       06210005
062200         COMPUTE PV-UCC128-PCT ROUNDED =                          06220012
062300                 PV-WORKING-PCT * 100                             06230012
062400     ELSE                                                         06240005
062500         MOVE 0        TO PV-UCC128-PCT                           06250005
062600     END-IF.                                                      06260005
062700                                                                  06270005
062800     IF PV-TOT-CTNS-PHYSICAL-CORP > 0 AND                         06280005
062900        PV-TOT-CTNS-RECEIVED-CORP > 0                             06290005
063000         COMPUTE PV-WORKING-PCT =                                 06300005
063100                (PV-TOT-CTNS-PHYSICAL-CORP /                      06310005
063200                 PV-TOT-CTNS-RECEIVED-CORP)                       06320005
063300         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        06330005
063400                 PV-WORKING-PCT * 100                             06340005
063500     ELSE                                                         06350005
063600         MOVE 0      TO PV-PHYSICAL-PCT                           06360005
063700     END-IF.                                                      06370005
063800                                                                  06380005
063900     IF PV-TOT-SML-CORP > 0 AND                                   06390005
064000        PV-TOT-CTNS-RECEIVED-CORP > 0                             06400005
064100         COMPUTE PV-WORKING-PCT =                                 06410005
064200                (PV-TOT-SML-CORP /                                06420005
064300                 PV-TOT-CTNS-RECEIVED-CORP)                       06430005
064400         COMPUTE PV-SML-PCT ROUNDED =                             06440005
064500                 PV-WORKING-PCT * 100                             06450005
064600     ELSE                                                         06460005
064700         MOVE 0    TO PV-SML-PCT                                  06470005
064800     END-IF.                                                      06480005
064900                                                                  06490005
065000     IF PV-OUTBOUND-ASN-CORP > 0 AND                              06500005
065100        PV-TOT-SML-CORP > 0                                       06510005
065200         COMPUTE PV-WORKING-PCT =                                 06520005
065300                (PV-OUTBOUND-ASN-CORP /                           06530005
065400                 PV-TOT-SML-CORP)                                 06540005
065500         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     06550005
065600                 PV-WORKING-PCT * 100                             06560005
065700     ELSE                                                         06570005
065800         MOVE 0    TO PV-SML-CHECKIN-PCT                          06580005
065900     END-IF.                                                      06590005
066000                                                                  06600005
066100     IF PV-OUTBOUND-CPS-CORP > 0 AND                              06610005
066200        PV-TOT-SML-CORP > 0                                       06620005
066300         COMPUTE PV-WORKING-PCT =                                 06630005
066400                (PV-OUTBOUND-CPS-CORP /                           06640005
066500                 PV-TOT-SML-CORP)                                 06650005
066600         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    06660005
066700                 PV-WORKING-PCT * 100                             06670005
066800     ELSE                                                         06680005
066900         MOVE 0    TO PV-SML-PHYSICAL-PCT                         06690005
067000     END-IF.                                                      06700005
067100                                                                  06710005
067200     IF PV-OUTBOUND-SMO-CORP > 0 AND                              06720005
067300        PV-TOT-SML-CORP > 0                                       06730005
067400         COMPUTE PV-WORKING-PCT =                                 06740005
067500                (PV-OUTBOUND-SMO-CORP /                           06750005
067600                 PV-TOT-SML-CORP)                                 06760005
067700         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   06770005
067800                 PV-WORKING-PCT * 100                             06780005
067900     ELSE                                                         06790005
068000         MOVE 0    TO PV-SML-SMOOTHING-PCT                        06800005
068100     END-IF.                                                      06810005
068200                                                                  06820005
068300     IF PV-TOT-P2L-CORP > 0 AND                                   06830005
068400        PV-TOT-CTNS-RECEIVED-CORP > 0                             06840005
068500         COMPUTE PV-WORKING-PCT =                                 06850005
068600                (PV-TOT-P2L-CORP /                                06860005
068700                 PV-TOT-CTNS-RECEIVED-CORP)                       06870005
068800         COMPUTE PV-P2L-SML-PCT ROUNDED =                         06880005
068900                 PV-WORKING-PCT * 100                             06890005
069000     ELSE                                                         06900005
069100         MOVE 0    TO PV-P2L-SML-PCT                              06910005
069200     END-IF.                                                      06920005
069300                                                                  06930005
069400     IF PV-SULBXF-P2L-CORP > 0 AND                                06940005
069500        PV-TOT-P2L-CORP > 0                                       06950005
069600         COMPUTE PV-WORKING-PCT =                                 06960005
069700                (PV-SULBXF-P2L-CORP /                             06970005
069800                 PV-TOT-P2L-CORP)                                 06980005
069900         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     06990005
070000                 PV-WORKING-PCT * 100                             07000005
070100     ELSE                                                         07010005
070200         MOVE 0    TO PV-P2L-CHECKIN-PCT                          07020005
070300     END-IF.                                                      07030005
070400                                                                  07040005
070500     IF PV-DISTHD-P2L-CORP > 0 AND                                07050005
070600        PV-TOT-P2L-CORP > 0                                       07060005
070700         COMPUTE PV-WORKING-PCT =                                 07070005
070800                (PV-DISTHD-P2L-CORP /                             07080005
070900                 PV-TOT-P2L-CORP)                                 07090005
071000         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    07100005
071100                 PV-WORKING-PCT * 100                             07110005
071200     ELSE                                                         07120005
071300         MOVE 0    TO PV-P2L-PHYSICAL-PCT                         07130005
071400     END-IF.                                                      07140005
071500                                                                  07150005
071600     ADD +1                  TO PV-LINE-COUNT                     07160005
071700     PERFORM 3100-PRINT-CORP-DETAIL-LINE.                         07170005
071800                                                                  07180005
071900*                                                                 07190001
072000******************************************************************07200001
072100 3000-PRINT-DETAIL-LINE.                                          07210001
072200*                                                                 07220001
072300     MOVE DK-STR-NBR               TO DL1-OPER-UNT.               07230001
072400     MOVE XLT00010-LOC-NM          TO DL1-OPER-DESC.              07240020
072500     MOVE PV-TOT-CTNS-RECEIVED     TO DL1-TOT-CARTN-RECVD.        07250001
072600     MOVE PV-TOT-CTNS-CHECKIN      TO DL1-TOT-CARTN-CHCKIN.       07260001
072700     MOVE PV-TOT-CTNS-PHYSICAL     TO DL1-TOT-CARTN-PHYSCL.       07270001
072800     MOVE PV-TOT-SML               TO DL1-SML-TOTAL.              07280001
072900     MOVE PV-OUTBOUND-ASN          TO DL1-SML-CKECKIN.            07290001
073000     MOVE PV-OUTBOUND-CPS          TO DL1-SML-PHYSICAL.           07300001
073100     MOVE PV-OUTBOUND-SMO          TO DL1-SML-SMOOTHING.          07310001
073200     MOVE PV-TOT-P2L               TO DL1-P2L-TOTAL.              07320001
073300     MOVE PV-SULBXF-P2L            TO DL1-P2L-CHECKIN.            07330001
073400     MOVE PV-DISTHD-P2L            TO DL1-P2L-PHYSICAL.           07340001
073500*                                                                 07350001
073600     MOVE PV-UCC128-PCT            TO DL2-TOT-CRT-CHKIN-PCT.      07360001
073700     MOVE PV-PHYSICAL-PCT          TO DL2-TOT-CRT-PHYSCL-PCT.     07370001
073800     MOVE PV-SML-PCT               TO DL2-SML-TOTAL-PCT.          07380001
073900     MOVE PV-SML-CHECKIN-PCT       TO DL2-SML-CKECKIN-PCT.        07390001
074000     MOVE PV-SML-PHYSICAL-PCT      TO DL2-SML-PHYSICAL-PCT.       07400001
074100     MOVE PV-SML-SMOOTHING-PCT     TO DL2-SML-SMOOTHING-PCT.      07410001
074200     MOVE PV-P2L-SML-PCT           TO DL2-P2L-TOTAL-PCT.          07420001
074300     MOVE PV-P2L-CHECKIN-PCT       TO DL2-P2L-CHECKIN-PCT.        07430001
074400     MOVE PV-P2L-PHYSICAL-PCT      TO DL2-P2L-PHYSICAL-PCT.       07440001
074500                                                                  07450001
074600*                                                                 07460001
074700     ADD +3 TO PV-LINE-COUNT.                                     07470001
074800     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07480001
074900         PERFORM 1500-PAGE-BREAK                                  07490001
075000     END-IF.                                                      07500001
075100*                                                                 07510001
075200     WRITE REPORT-RECORD                                          07520001
075300       FROM DETAIL-LINE1                                          07530001
075400         AFTER ADVANCING 2 LINE.                                  07540001
075500*                                                                 07550001
075600     WRITE REPORT-RECORD                                          07560001
075700       FROM DETAIL-LINE2                                          07570001
075800         AFTER ADVANCING 1 LINE.                                  07580001
075900*                                                                 07590001
076000*                                                                 07600001
076100******************************************************************07610001
076200 3100-PRINT-CORP-DETAIL-LINE.                                     07620001
076300*                                                                 07630001
076400     MOVE 0                         TO DL1-OPER-UNT.              07640001
076500     MOVE 'CORPORATE TOTALS'        TO DL1-OPER-DESC.             07650001
076600     MOVE PV-TOT-CTNS-RECEIVED-CORP TO DL1-TOT-CARTN-RECVD.       07660001
076700     MOVE PV-TOT-CTNS-CHECKIN-CORP  TO DL1-TOT-CARTN-CHCKIN.      07670001
076800     MOVE PV-TOT-CTNS-PHYSICAL-CORP TO DL1-TOT-CARTN-PHYSCL.      07680001
076900     MOVE PV-TOT-SML-CORP           TO DL1-SML-TOTAL.             07690001
077000     MOVE PV-OUTBOUND-ASN-CORP      TO DL1-SML-CKECKIN.           07700001
077100     MOVE PV-OUTBOUND-CPS-CORP      TO DL1-SML-PHYSICAL.          07710001
077200     MOVE PV-OUTBOUND-SMO-CORP      TO DL1-SML-SMOOTHING.         07720001
077300     MOVE PV-TOT-P2L-CORP           TO DL1-P2L-TOTAL.             07730001
077400     MOVE PV-SULBXF-P2L-CORP        TO DL1-P2L-CHECKIN.           07740001
077500     MOVE PV-DISTHD-P2L-CORP        TO DL1-P2L-PHYSICAL.          07750001
077600*                                                                 07760001
077700     MOVE PV-UCC128-PCT             TO DL2-TOT-CRT-CHKIN-PCT.     07770001
077800     MOVE PV-PHYSICAL-PCT           TO DL2-TOT-CRT-PHYSCL-PCT.    07780001
077900     MOVE PV-SML-PCT                TO DL2-SML-TOTAL-PCT.         07790001
078000     MOVE PV-SML-CHECKIN-PCT        TO DL2-SML-CKECKIN-PCT.       07800001
078100     MOVE PV-SML-PHYSICAL-PCT       TO DL2-SML-PHYSICAL-PCT.      07810001
078200     MOVE PV-SML-SMOOTHING-PCT      TO DL2-SML-SMOOTHING-PCT.     07820001
078300     MOVE PV-P2L-SML-PCT            TO DL2-P2L-TOTAL-PCT.         07830001
078400     MOVE PV-P2L-CHECKIN-PCT        TO DL2-P2L-CHECKIN-PCT.       07840001
078500     MOVE PV-P2L-PHYSICAL-PCT       TO DL2-P2L-PHYSICAL-PCT.      07850001
078600                                                                  07860001
078700*                                                                 07870001
078800     ADD +5 TO PV-LINE-COUNT.                                     07880001
078900     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         07890001
079000         PERFORM 1500-PAGE-BREAK                                  07900001
079100     END-IF.                                                      07910001
079200*                                                                 07920001
079300     WRITE REPORT-RECORD                                          07930001
079400       FROM DETAIL-LINE1                                          07940001
079500         AFTER ADVANCING 2 LINES.                                 07950001
079600*                                                                 07960001
079700     WRITE REPORT-RECORD                                          07970001
079800       FROM DETAIL-LINE2                                          07980001
079900         AFTER ADVANCING 1 LINE.                                  07990001
080000*                                                                 08000001
080100     WRITE REPORT-RECORD                                          08010001
080200       FROM END-OF-REPORT-LINE                                    08020001
080300         AFTER ADVANCING 2 LINES.                                 08030001
080400                                                                  08040001
080500 4000-READ-INPUT-RECORD.                                          08050001
080600     READ INPUT-FILE                                              08060001
080700       INTO SU059-RECORD                                          08070004
080800         AT END                                                   08080004
080900             SET PS-EOF-INPUT         TO TRUE                     08090004
081000         NOT AT END                                               08100004
081100             CONTINUE                                             08110004
081200     END-READ.                                                    08120004
081300*                                                                 08130001
081400 7000-SELECT-DC-NAME.                                             08140015
081500                                                                  08150001
081600     EXEC SQL                                                     08160001
081700        SELECT  LOC_NM                                            08170020
081800          INTO  :XLT00010-LOC-NM                                  08180020
081900          FROM  XLT_LOC                                           08190020
082000         WHERE  LOC_NBR     = :DK-STR-NBR                         08200020
082100     END-EXEC.                                                    08210001
082200                                                                  08220001
082300     EVALUATE TRUE                                                08230001
082400         WHEN SQLCODE = +0                                        08240001
082500             CONTINUE                                             08250001
082600         WHEN SQLCODE < ZERO                                      08260001
082700         WHEN SQLCODE > ZERO                                      08270001
082800         WHEN SQLWARN0 NOT = SPACE                                08280001
082900             MOVE '7000-SELECT-DC-NAME'                           08290020
083000                                      TO PV-PARAGRAPH             08300001
083100             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08310020
083200             PERFORM 9100-SQL-ABEND                               08320001
083300     END-EVALUATE.                                                08330001
083400                                                                  08340001
083500                                                                  08350001
083600 8000-READ-CONTROL-REC.                                           08360001
083700                                                                  08370001
083800     READ NEW-CONTROL-FILE INTO                                   08380001
083900           SU032-DATE-CONTROL-REC                                 08390001
084000     AT END                                                       08400001
084100         CONTINUE                                                 08410003
084200     NOT AT END                                                   08420001
084300         DISPLAY 'DATE CONTROL CARD:'                             08430001
084400         DISPLAY SU032-DATE-CONTROL-REC                           08440001
084500         DISPLAY SPACES                                           08450001
084600     END-READ.                                                    08460001
084700                                                                  08470001
084800 9100-SQL-ABEND.                                                  08480001
084900     MOVE SQLCODE                     TO SQLCODE2.                08490001
085000     MOVE SQLERRD(3)                  TO SQLERRD3.                08500001
085100                                                                  08510001
085200     DISPLAY '** ABEND **         ** = SQLERROR'.                 08520001
085300     DISPLAY '** PROGRAM   ** = ' PC-SUKRP041.                    08530001
085400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08540001
085500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08550001
085600                                                                  08560001
085700     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                08570001
085800     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                08580001
085900     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 08590001
086000     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                08600001
086100                                                                  08610001
086200                                                                  08620001
086300     MOVE +4013                       TO ABEND-CODE.              08630001
086400     CALL 'ILBOABN0' USING ABEND-CODE.                            08640001
