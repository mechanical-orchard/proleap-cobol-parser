000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    CNKCS217.                                         00040071
000500 AUTHOR.        LYNN MCADAMS.                                     00050028
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  OCTOBER, 2000.                                    00070028
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000*---------------------------------------------------------------* 00100001
001100*    Y217 - PRINTER MAINTENANCE     - PRINTER TYPE LIST         * 00110071
001200*    THIS PROGRAM WILL PRODUCE A LIST OF EXISTING PRINTER TYPES.* 00120093
001300*    THIS SCREEN IS ACCESSED BY PRESSING F24 FROM THE           * 00130093
001400*    PRINTER MAINT. CRIT SPEC.  (CNKCS214).                     * 00140093
001500*                                                               * 00150001
001600*---------------------------------------------------------------* 00160001
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00161095
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162095
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00163095
263455*----------------------------------------------------------------*00164095
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00165096
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00166096
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00167096
CICS  *-----------------------------------------------------------------00168096
001700 EJECT                                                            00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900                                                                  00190001
002000 DATA DIVISION.                                                   00200001
002100                                                                  00210001
002200 WORKING-STORAGE SECTION.                                         00220001
002300                                                                  00230001
002400 01  DK-DB2-KEYS.                                                 00240001
002500     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00250006
002600                                                    COMP.         00260006
002700     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00270006
002800                                                    COMP.         00280006
002900     05  DK-PRINTER-ID                  PIC  X(08)  VALUE SPACES. 00290018
003000     05  DK-PRTR-SEL-TYPE               PIC  X(01)  VALUE SPACES. 00300045
003100                                                                  00310001
003200                                                                  00320001
003300 01  PC-PROGRAM-CONSTANTS.                                        00330001
003400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CNK217  '.  00340074
003500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CNKM217 '.  00350073
003600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CNKCS217'.  00360071
003700     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00370001
003800     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00380001
003900     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00390001
004000     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '2'.         00400089
004100     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +13          00410085
004200                                               COMP SYNC.         00420085
004300     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00430085
004400                                               COMP SYNC.         00440085
004500     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00450085
004600                                               COMP-3.            00460085
004700     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00470085
004800                                               COMP SYNC.         00480085
004900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00490085
005000                                               COMP-3.            00500085
005100     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00510085
005200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00520085
005300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00530085
005400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00540085
005500                                                                  00550085
005600     05  PC-ALL                    PIC  X(01)  VALUE 'A'.         00560085
005700     05  PC-LABEL                  PIC  X(01)  VALUE 'L'.         00570085
005800     05  PC-LINE                   PIC  X(01)  VALUE 'N'.         00580085
005900*                                                                 00590085
006000*----------------------------------------------------------------*00600085
006100*  SYSTEM MESSAGES                                               *00610085
006200*----------------------------------------------------------------*00620085
006300*   00005 = INVALID VALUE                                        *00630085
006400*   00008 = MUST BE NUMERIC                                      *00640085
006500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00650085
006600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00660085
006700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00670085
006800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00680085
006900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00690085
007000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00700085
007100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00710085
007200*   00069 - TOP OF LIST                                          *00720085
007300*   00070 - BOTTOM OF LIST                                       *00730085
007400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00740085
007500*   00279 - MORE ITEMS TO DISPLAY                                *00750085
007600*----------------------------------------------------------------*00760085
007700     05  PC-TSYMSG-NUMBERS.                                       00770085
007800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00780085
007900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00790085
008000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00800085
008100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00810085
008200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00820085
008300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00830085
008400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00840085
008500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00850085
008600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00860085
008700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00870085
008800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00880085
008900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00890085
009000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00900085
009100*                                                                 00910085
009200 01  PS-PROGRAM-SWITCHES.                                         00920085
009300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00930085
009400         88  PS-NO-ERROR                            VALUE 'Y'.    00940085
009500         88  PS-ERROR                               VALUE 'N'.    00950085
009600     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    00960085
009700         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    00970085
009800         88  PS-BLOCK-ERROR                         VALUE 'N'.    00980085
009900     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   00990085
010000         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   01000085
010100         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   01010085
010200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01020085
010300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01030085
010400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01040085
010500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01050085
010600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01060085
010700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01070085
010800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01080085
010900         88  PS-LIST-END                            VALUE 'Y'.    01090085
011000         88  PS-NO-LIST-END                         VALUE 'N'.    01100085
011100*                                                                 01110085
011200*                                                                 01120085
011300 01  PV-PROGRAM-VARIABLES.                                        01130085
011400     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01140085
011500                                        COMP SYNC.                01150085
011600     05  PV-SUB                         PIC S9(04)  VALUE +0      01160085
011700                                                    COMP SYNC.    01170085
011800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01180085
011900                                                    COMP SYNC.    01190085
012000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01200085
012100                                                    COMP-3.       01210085
012200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01220085
012300                                                    COMP-3.       01230085
012400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01240085
012500                                                    COMP-3.       01250085
012600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01260085
012700                                                    COMP-3.       01270085
012800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01280085
012900                                                    COMP-3.       01290085
013000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01300085
013100                                                    COMP-3.       01310085
013200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01320085
013300                                                    COMP-3.       01330085
013400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01340085
013500                                                    COMP SYNC.    01350085
013600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01360085
013700                                                    COMP SYNC.    01370085
013800     05  PV-ITEM                        PIC S9(04)  VALUE +0      01380085
013900                                                    COMP SYNC.    01390085
014000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01400085
014100                                                    COMP SYNC.    01410085
014200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01420085
014300                                                    COMP SYNC.    01430085
014400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01440085
014500                                                    COMP SYNC.    01450085
014600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01460085
014700                                                    COMP SYNC.    01470085
014800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01480085
014900                                                    COMP SYNC.    01490085
015000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01500085
015100                                                    COMP SYNC.    01510085
015200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01520085
015300                                                    COMP SYNC.    01530085
015400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01540085
015500                                                    COMP SYNC.    01550085
015600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01560085
015700                                                    COMP SYNC.    01570085
015800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01580085
015900                                                    COMP SYNC.    01590085
016000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01600085
016100                                                    COMP SYNC.    01610085
016200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01620085
016300                                                    COMP SYNC.    01630085
016400     05  PV-SOFT-ABORT-MSG.                                       01640085
016500         10  FILLER            PIC X(12) VALUE ' CNKCS217 - '.    01650085
016600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01660085
016700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01670085
016800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01680085
016900         10  PV-SOFT-PARAGRAPH PIC X(30).                         01690085
017000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01700085
017100                                                     COMP SYNC.   01710085
017200                                                                  01720085
017300                                                                  01730085
017400                                                                  01740085
017500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01750085
017600                                                     COMP SYNC.   01760085
017700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01770085
017800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01780085
017900******************************************************************01790085
018000**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01800085
018100**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01810085
018200**  APPLICATION-SPECIFIC COMMAREA.                              **01820085
018300******************************************************************01830085
018400 01  LQW-LIST-QUEUE-WORK-AREA.                                    01840085
018500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01850085
018600     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           01860085
018700                                        INDEXED BY LQW-IDX.       01870085
018800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01880085
018900         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01890085
019000         10  LQW-SELECTED-SW            PIC  X(01).               01900085
019100             88  LQW-SELECT                         VALUE 'S'.    01910085
019200             88  LQW-DESELECT                       VALUE ' '.    01920085
019300         10  LQW-ACTION                 PIC  X(03).               01930085
019400             88  LQW-DEL                            VALUE 'DEL'.  01940085
019500             88  LQW-INQ                            VALUE 'INQ'.  01950085
019600             88  LQW-UPD                            VALUE 'UPD'.  01960085
019700             88  LQW-ERR                            VALUE 'ERR'.  01970085
019800             88  LQW-PRT                            VALUE 'PRT'.  01980085
019900         10  LQW-PRINTER-TYP            PIC  X(08).               01990085
020000         10  LQW-MANF-DESC              PIC  X(20).               02000085
020100         10  LQW-MODEL-DESC             PIC  X(25).               02010085
020200         10  LQW-PAPR-TRK-QTY-X         PIC  9(04).               02020085
020300         10  LQW-PAPR-TRK-R REDEFINES                             02030085
020400             LQW-PAPR-TRK-QTY-X.                                  02040085
020500             15  LQW-PAPR-TRK-QTY       PIC  Z(04).               02050085
020600         10  LQW-AUTO-CTR-IND           PIC  X(01).               02060085
020700         10  LQW-BAR-CDE-IND            PIC  X(01).               02070085
020800         10  LQW-PRTR-CNTL-IND          PIC  X(01).               02080085
020900                                                                  02090085
021000                                                                  02100085
021100*---------------------------------------------------------------* 02110085
021200* SELECTON QUEUE LAYOUT                                         * 02120085
021300*---------------------------------------------------------------* 02130085
021400     COPY CNWS163.                                                02140085
021500                                                                  02150085
021600                                                                  02160085
021700*---------------------------------------------------------------* 02170085
021800*    MAP LAYOUT                                                 * 02180085
021900*---------------------------------------------------------------* 02190085
022000                                                                  02200085
022100     COPY CNKM217.                                                02210085
022200*                                                                 02220085
022300 01  MR-OCCURS-LAYOUT                   REDEFINES  CNK217O.       02230085
022400     05  FILLER                         PIC X(42).                02240085
022500     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          02250085
022600         10  MR-SELECTL                 PIC S9(04) COMP.          02260085
022700         10  MR-SELECTA                 PIC  X(01).               02270085
022800         10  MR-SELECTC                 PIC  X(01).               02280085
022900         10  MR-SELECTH                 PIC  X(01).               02290085
023000         10  MR-SELECTI                 PIC  X(01).               02300085
023100                                                                  02310085
023200         10  MR-ACTIONL                 PIC S9(04) COMP.          02320085
023300         10  MR-ACTIONA                 PIC  X(01).               02330085
023400         10  MR-ACTIONC                 PIC  X(01).               02340085
023500         10  MR-ACTIONH                 PIC  X(01).               02350085
023600         10  MR-ACTION                  PIC  X(03).               02360085
023700                                                                  02370085
023800         10  MR-PRINTER-TYPL            PIC S9(04) COMP.          02380085
023900         10  MR-PRINTER-TYPA            PIC  X(01).               02390085
024000         10  MR-PRINTER-TYPC            PIC  X(01).               02400085
024100         10  MR-PRINTER-TYPH            PIC  X(01).               02410085
024200         10  MR-PRINTER-TYP             PIC  X(08).               02420085
024300                                                                  02430085
024400         10  MR-MANF-DESCL              PIC S9(04) COMP.          02440085
024500         10  MR-MANF-DESCA              PIC  X(01).               02450085
024600         10  MR-MANF-DESCC              PIC  X(01).               02460085
024700         10  MR-MANF-DESCH              PIC  X(01).               02470085
024800         10  MR-MANF-DESC               PIC  X(20).               02480085
024900                                                                  02490085
025000         10  MR-MODEL-DESCL             PIC S9(04) COMP.          02500085
025100         10  MR-MODEL-DESCA             PIC  X(01).               02510085
025200         10  MR-MODEL-DESCC             PIC  X(01).               02520085
025300         10  MR-MODEL-DESCH             PIC  X(01).               02530085
025400         10  MR-MODEL-DESC              PIC  X(25).               02540085
025500                                                                  02550085
025600         10  MR-PAPR-TRK-QTYL           PIC S9(04) COMP.          02560085
025700         10  MR-PAPR-TRK-QTYA           PIC  X(01).               02570085
025800         10  MR-PAPR-TRK-QTYC           PIC  X(01).               02580085
025900         10  MR-PAPR-TRK-QTYH           PIC  X(01).               02590085
026000         10  MR-PAPR-TRK-QTY-X.                                   02600085
026100             15  MR-PAPR-TRK-QTY        PIC  Z(04).               02610085
026200                                                                  02620085
026300         10  MR-AUTO-CTR-INDL           PIC S9(04) COMP.          02630085
026400         10  MR-AUTO-CTR-INDA           PIC  X(01).               02640085
026500         10  MR-AUTO-CTR-INDC           PIC  X(01).               02650085
026600         10  MR-AUTO-CTR-INDH           PIC  X(01).               02660085
026700         10  MR-AUTO-CTR-IND            PIC  X(01).               02670085
026800                                                                  02680085
026900         10  MR-BAR-CDE-INDL            PIC S9(04) COMP.          02690085
027000         10  MR-BAR-CDE-INDA            PIC  X(01).               02700085
027100         10  MR-BAR-CDE-INDC            PIC  X(01).               02710085
027200         10  MR-BAR-CDE-INDH            PIC  X(01).               02720085
027300         10  MR-BAR-CDE-IND             PIC  X(01).               02730085
027400                                                                  02740085
027500         10  MR-PRTR-CNTL-INDL          PIC S9(04) COMP.          02750085
027600         10  MR-PRTR-CNTL-INDA          PIC  X(01).               02760085
027700         10  MR-PRTR-CNTL-INDC          PIC  X(01).               02770085
027800         10  MR-PRTR-CNTL-INDH          PIC  X(01).               02780085
027900         10  MR-PRTR-CNTL-IND           PIC  X(01).               02790085
028000                                                                  02800085
028100*    05  FILLER                         PIC  X(38).               02810085
028200     05  FILLER                         PIC  X(12).               02820085
028300                                                                  02830085
028400                                                                  02840085
028500*----------------------------------------------------------------*02850085
028600**  SECURITY SUBROUTINE PARAMETERS                                02860085
028700*----------------------------------------------------------------*02870085
028800     COPY DPWS008.                                                02880085
028900                                                                  02890085
029000                                                                  02900085
029100*---------------------------------------------------------------* 02910085
029200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02920085
029300*---------------------------------------------------------------* 02930085
029400                                                                  02940085
029500     COPY DPWS015.                                                02950085
029600                                                                  02960085
029700*---------------------------------------------------------------* 02970085
029800*    FUNCTION KEYS COPYBOOK.                                    * 02980085
029900*---------------------------------------------------------------* 02990085
030000                                                                  03000085
030100     COPY DPWS016.                                                03010085
030200                                                                  03020085
030300*---------------------------------------------------------------* 03030085
030400*    NUMERIC EDIT LAYOUT.                                       * 03040085
030500*---------------------------------------------------------------* 03050085
030600                                                                  03060085
030700     COPY DPWS010I.                                               03070085
030800 EJECT                                                            03080085
030900*---------------------------------------------------------------* 03090085
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 03100096
031100*---------------------------------------------------------------* 03110085
031200                                                                  03120085
031300     COPY DPWS030.                                                03130085
CICS       COPY DPWS930.                                                03131096
031400 EJECT                                                            03140085
031500*---------------------------------------------------------------* 03150085
031600*    STANDARD COMMAREA.                                         * 03160085
031700*---------------------------------------------------------------* 03170085
031800                                                                  03180085
031900     COPY DPWS020.                                                03190085
032000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03200085
032100                                                                  03210085
032200*---------------------------------------------------------------* 03220085
032300* INTER-APPLICATION COMMAREA.                                   * 03230085
032400*   CNWS161 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03240085
032500*             SPEC SCREEN.                                      * 03250085
032600*   CNWS162 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03260085
032700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03270085
032800*---------------------------------------------------------------* 03280085
032900                                                                  03290085
033000         10  INTER-APPL-COMM-AREA       PIC X(200).               03300085
033100     COPY CNWS161.                                                03310085
033200     COPY CNWS162.                                                03320085
033300*---------------------------------------------------------------* 03330085
033400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03340085
033500*---------------------------------------------------------------* 03350085
033600         10  ASC-SPECIFIC-COMMAREA.                               03360085
033700             15  ASC-OPER-UNT-ID        PIC  X(04).               03370085
033800             15  ASC-FCLTY-ID           PIC  X(04).               03380085
033900             15  ASC-FCLTY-NME          PIC  X(25).               03390085
034000             15  ASC-PRINTER-ID         PIC  X(08).               03400085
034100             15  ASC-PRTR-TYP-CDE       PIC  X(08).               03410085
034200             15  ASC-PRTR-SELECT-TYPE   PIC  X(01).               03420085
034300                 88  ASC-SELECT-SRC-VALID     VALUE 'A' 'L' 'N'   03430085
034400                                                    ' '.          03440085
034500                 88  ASC-PRINTER-TYPE-ENTERED VALUE 'A' 'L' 'N'.  03450085
034600                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      03460085
034700                 88  ASC-SELECT-SRC-LABEL         VALUE 'L'.      03470085
034800                 88  ASC-SELECT-SRC-LINE          VALUE 'N'.      03480085
034900             15  ASC-BLK-SUB                  PIC S9(04) COMP     03490085
035000                                                         SYNC.    03500085
035100             15  ASC-ITEM-SUB                 PIC S9(04) COMP     03510085
035200                                                         SYNC.    03520085
035300             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  03530085
035400             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  03540085
035500             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  03550085
035600             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  03560085
035700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  03570085
035800             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     03580085
035900                                                         SYNC.    03590085
036000             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  03600085
036100             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  03610085
036200             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03620085
036300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     03630085
036400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     03640085
036500             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03650085
036600                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03660085
036700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03670085
036800             15  ASC-LIST-QUEUE-NAME.                             03680085
036900                 20  ASC-LIST-TERM-ID         PIC  X(04).         03690085
037000                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03700085
037100                 20  ASC-LIST-SEQ             PIC  9(01).         03710085
037200                                                                  03720085
037300             15  ASC-START-ITEM-REQUEST.                          03730085
037400                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03740085
037500                                                                  03750085
037600             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03760085
037700             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03770085
037800*                                                                 03780085
037900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03790085
038000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03800085
038100             15  ASC-SEL-QUEUE-NAME.                              03810085
038200                 20  ASC-SEL-TERM-ID          PIC  X(04).         03820085
038300                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03830085
038400                 20  ASC-SEL-SEQ              PIC  9(01).         03840085
038500             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  03850085
038600                                                                  03860085
038700*-----------------------------------------------------------------03870085
038800                                                                  03880085
038900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03890085
039000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03900085
039100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03910085
039200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03920085
039300                                                                  03930085
039400                 20  ASC-ITEM-ARRAY.                              03940085
039500                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        03950085
039600                         30  ASC-LIST-ITEM-NUMBER                 03960085
039700                                                     PIC S9(09)   03970085
039800                                                     COMP-3.      03980085
039900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03990085
040000                             88  ASC-VALID-SELECT    VALUE ' '    04000085
040100                                                           'S'    04010085
040200                                                           'B'    04020085
040300                                                           'E'.   04030085
040400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04040085
040500                             88  ASC-TEMP-SELECT     VALUE 'S'.   04050085
040600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04060085
040700                             88  ASC-TEMP-END        VALUE 'E'.   04070085
040800                         30  ASC-SELECTED-SW         PIC  X(01).  04080085
040900                             88  ASC-NO-SELECT       VALUE ' '.   04090085
041000                             88  ASC-SELECT          VALUE 'S'.   04100085
041100                             88  ASC-BEGIN           VALUE 'B'.   04110085
041200                             88  ASC-END             VALUE 'E'.   04120085
041300                         30  ASC-ACTION              PIC  X(03).  04130085
041400                         30  ASC-PRINTER-TYP         PIC  X(08).  04140085
041500                         30  ASC-MANF-DESC           PIC  X(20).  04150085
041600                         30  ASC-MODEL-DESC          PIC  X(25).  04160085
041700                         30  ASC-PAPR-TRK-QTY-X      PIC  9(04).  04170085
041800                         30  ASC-PAPR-TRKR REDEFINES              04180085
041900                             ASC-PAPR-TRK-QTY-X.                  04190085
042000                             35  ASC-PAPR-TRK-QTY    PIC  Z(04).  04200085
042100                         30  ASC-AUTO-CTR-IND        PIC  X(01).  04210085
042200                         30  ASC-BAR-CDE-IND         PIC  X(01).  04220085
042300                         30  ASC-PRTR-CNTL-IND       PIC  X(01).  04230085
042400                                                                  04240085
042500     EJECT                                                        04250085
042600*---------------------------------------------------------------* 04260085
042700*    ABEND PROCESSING COPYBOOK.                                 * 04270085
042800*---------------------------------------------------------------* 04280085
042900                                                                  04290085
043000     COPY DPWS013.                                                04300085
043100                                                                  04310085
043200 EJECT                                                            04320085
043300*---------------------------------------------------------------* 04330085
043400*    TPRTRTY -  PRINTER TYPE                                    * 04340085
043500*---------------------------------------------------------------* 04350085
043600     EXEC SQL                                                     04360085
043700          INCLUDE TPRTRTY                                         04370085
043800     END-EXEC.                                                    04380085
043900*---------------------------------------------------------------* 04390085
044000*---------------------------------------------------------------* 04400085
044100*    DB2 AREA FOR COMMUNICATIONS                                * 04410085
044200*---------------------------------------------------------------* 04420085
044300     EXEC SQL                                                     04430085
044400          INCLUDE SQLCA                                           04440085
044500     END-EXEC.                                                    04450085
044600                                                                  04460085
044700                                                                  04470085
044800*---------------------------------------------------------------* 04480085
044900*    PRINTER TYPE CURSOR                                        * 04490085
045000*---------------------------------------------------------------* 04500085
045100     EXEC SQL                                                     04510085
045200        DECLARE PRTR-TYPE-CSR CURSOR FOR                          04520085
045300           SELECT  PRTR_TYP_CDE                                   04530085
045400                  ,PRTR_MFR_DESC                                  04540085
045500                  ,PRTR_MDL_DESC                                  04550085
045600                  ,PAPR_TRK_QTY                                   04560085
045700                  ,AUTO_CTTR_IND                                  04570085
045800                  ,PRT_BRCDE_IND                                  04580085
045900                  ,PRTR_CNTL_IND                                  04590085
046000           FROM  TPRTRTY                                          04600085
046100       ORDER BY  PRTR_TYP_CDE                                     04610085
046200     END-EXEC.                                                    04620085
046300*                                                                 04630085
046400*                                                                 04640085
046500 LINKAGE SECTION.                                                 04650085
046600                                                                  04660085
046700 01  DFHCOMMAREA.                                                 04670085
046800     05  FILLER                         OCCURS  1 TO 4072 TIMES   04680085
046900                                        DEPENDING ON EIBCALEN.    04690085
047000         10  FILLER                     PIC X.                    04700085
047100                                                                  04710085
047200 EJECT                                                            04720085
047300 PROCEDURE DIVISION.                                              04730085
047400******************************************************************04740085
047500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04750085
047600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04760085
047700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04770085
047800******************************************************************04780085
047900 0000-MAIN-MODULE.                                                04790085
048000     INITIALIZE DP030-CICS-API-FIELDS.                            04800085
048100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04810085
048200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04820085
048300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04830085
048400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04840085
048500     MOVE LENGTH OF CNK217I        TO DP030-MAP-LENGTH (1).       04850085
048600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04860085
048700     PERFORM 0001-CALL-CICS-ARCH-API.                             04870085
048800                                                                  04880085
048900     PERFORM 1000-CONTROL-PROCESSING                              04890085
049000                                                                  04900085
049100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04910085
049200     PERFORM 0001-CALL-CICS-ARCH-API.                             04920085
049300                                                                  04930085
049400******************************************************************04940085
049500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **04950085
049600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **04960085
049700******************************************************************04970085
049800 0001-CALL-CICS-ARCH-API.                                         04980085
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04990096
050000                                    DFHCOMMAREA                   05000096
050100                                    DP030-CICS-API-FIELDS         05010096
050200                                    DP020-STANDARD-COMMAREA       05020096
050300                                    CNK217I.                      05030096
050400                                                                  05040085
050500     IF  DP030-RC-CALL-SUCCESSFUL                                 05050085
050600         CONTINUE                                                 05060085
050700     ELSE                                                         05070085
050800         SET DP013-NO-ROLLBACK                                    05080085
050900             DP013-XCTL-DISPLAY-RESTART                           05090085
051000             DP013-CICS-ABEND      TO TRUE                        05100085
051100         MOVE '0001-CALL-CICS-ARCH-API'                           05110085
051200                                   TO DP013-PARAGRAPH             05120085
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05121096
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05122096
051500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05150085
051600         PERFORM DP013-0000-PROCESS-ABEND                         05160085
051700     END-IF.                                                      05170085
051800*----------------------------------------------------------------*05180085
051900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05190085
052000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05200085
052100*                                                                *05210085
052200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05220085
052300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05230085
052400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05240085
052500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05250085
052600*----------------------------------------------------------------*05260085
052700                                                                  05270085
052800 1000-CONTROL-PROCESSING.                                         05280085
052900                                                                  05290085
053000     EVALUATE TRUE                                                05300085
053100         WHEN DP020-NEXT-ACT-INITIAL                              05310085
053200             INITIALIZE ASC-SPECIFIC-COMMAREA                     05320085
053300             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05330085
053400                                      ASC-SEL-TERM-ID             05340085
053500             MOVE DP020-SRC-TASK-NUMBER                           05350085
053600                                   TO ASC-LIST-TASK-NUMBER        05360085
053700                                      ASC-SEL-TASK-NUMBER         05370085
053800             MOVE PC-LIST-QUEUE-SEQ                               05380085
053900                                   TO ASC-LIST-SEQ                05390085
054000             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 05400085
054100             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05410085
054200***-----$TEMPLATE NOTE$-------------------------------------------05420085
054300*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05430085
054400*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05440085
054500*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05450085
054600***---------------------------------------------------------------05460085
054700             IF  PS-COMMAREA-NOT-VALID                            05470085
054800                 SET DP020-NEXT-ACT-APPL-ERROR                    05480085
054900                                   TO TRUE                        05490085
055000             ELSE                                                 05500085
055100                 PERFORM 4000-BUILD-INITIAL-PANEL                 05510085
055200             END-IF                                               05520085
055300                                                                  05530085
055400         WHEN DP020-NEXT-ACT-READ-MAP                             05540085
055500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05550085
055600                                   TO PV-TOP-ITEM                 05560085
055700             PERFORM 2000-PROCESS-PANEL                           05570085
055800                                                                  05580085
055900*F3-END                                                           05590085
056000         WHEN DP020-NEXT-ACT-RETURN                               05600085
056100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05610085
056200                                   TO PV-TOP-ITEM                 05620085
056300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    05630085
056400             IF CN162-ADD                                         05640094
056500                PERFORM 2050-DELETE-LIST-QUEUE                    05650094
056600                PERFORM 4000-BUILD-INITIAL-PANEL                  05660094
056700             ELSE                                                 05670094
056800                PERFORM 6000-REFRESH-PANEL-FROM-TEMP              05680094
056900                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              05690094
057000             END-IF                                               05700094
057100                                                                  05710094
057200         WHEN OTHER                                               05720085
057300             SET DP013-LOGIC-ABEND TO TRUE                        05730085
057400             SET DP013-NO-ROLLBACK TO TRUE                        05740085
057500             MOVE '1000-CONTROL-PROCESSING'                       05750085
057600                                   TO DP013-PARAGRAPH             05760085
057700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05770085
057800                                   TO DP013-MESSAGE-TEXT(1)       05780085
057900             PERFORM DP013-0000-PROCESS-ABEND                     05790085
058000     END-EVALUATE.                                                05800085
058100                                                                  05810085
058200 EJECT                                                            05820085
058300*----------------------------------------------------------------*05830085
058400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05840085
058500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05850085
058600*----------------------------------------------------------------*05860085
058700                                                                  05870085
058800 1100-PROCESS-INTER-APPL-COMM.                                    05880085
058900                                                                  05890085
059000     SET PS-COMMAREA-VALID         TO TRUE.                       05900085
059100     MOVE SPACES                   TO ASC-START-ITEM-REQUEST.     05910085
059200                                                                  05920085
059300*IF COMING FROM CRIT SPEC (CNKCS214)                              05930085
059400     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          05940086
059500         MOVE CN161-OPER-UNT-ID       TO ASC-OPER-UNT-ID          05950085
059600         MOVE CN161-FCLTY-ID          TO ASC-FCLTY-ID             05960085
059700         MOVE CN161-FCLTY-NME         TO ASC-FCLTY-NME            05970085
059800         MOVE CN161-PRINTER-ID        TO ASC-PRINTER-ID           05980085
059900         MOVE CN161-PRINTER-SELECT-TYPE                           05990085
060000                                      TO ASC-PRTR-SELECT-TYPE     06000085
060100     ELSE                                                         06010089
060200         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           06020089
060300         SET  PS-COMMAREA-NOT-VALID TO TRUE                       06030089
060400     END-IF.                                                      06040086
060500*                                                                 06050086
060600*                                                                 06060086
060700*----------------------------------------------------------------*06070085
060800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06080085
060900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06090085
061000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06100085
061100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06110085
061200* FUNCTION KEYS CAN GET THIS FAR.                                *06120085
061300*----------------------------------------------------------------*06130085
061400                                                                  06140085
061500 2000-PROCESS-PANEL.                                              06150085
061600     EVALUATE TRUE                                                06160085
061700         WHEN DP020-SRC-AID = DP016-CLEAR                         06170085
061800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06180085
061900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06190085
062000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06200085
062100                                                                  06210085
062200*F5-REFRESH                                                       06220085
062300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06230085
062400             PERFORM 2050-DELETE-LIST-QUEUE                       06240085
062500             PERFORM 4000-BUILD-INITIAL-PANEL                     06250085
062600                                                                  06260085
062700*F9-DESELECT                                                      06270085
062800         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    06280085
062900             PERFORM 2140-DESELECT-ALL-ITEMS                      06290085
063000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06300085
063100                                                                  06310085
063200*F21-SELECT ALL                                                   06320085
063300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  06330085
063400             PERFORM 2150-SELECT-ALL-ITEMS                        06340085
063500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06350085
063600                                                                  06360085
063700         WHEN OTHER                                               06370085
063800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06380085
063900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06390085
064000             IF  PS-NO-ERROR                                      06400085
064100                 SET DP030-CONTINUE-GO                            06410085
064200                                 TO TRUE                          06420085
064300                 PERFORM 2100-CHECK-FUNCTION-KEY                  06430085
064400             ELSE                                                 06440085
064500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06450085
064600                 SET DP030-OVERRIDE-GO                            06460085
064700                                 TO TRUE                          06470085
064800             END-IF                                               06480085
064900     END-EVALUATE.                                                06490085
065000 EJECT                                                            06500085
065100*----------------------------------------------------------------*06510085
065200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *06520085
065300*----------------------------------------------------------------*06530085
065400 2050-DELETE-LIST-QUEUE.                                          06540085
065500                                                                  06550085
065600     EXEC CICS                                                    06560085
065700         DELETEQ TS                                               06570085
065800             QUEUE (ASC-LIST-QUEUE-NAME)                          06580085
065900             RESP  (PV-CICS-RESP)                                 06590085
066000     END-EXEC.                                                    06600085
066100                                                                  06610085
066200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06620085
066300        (PV-CICS-RESP = DFHRESP(QIDERR))                          06630085
066400         CONTINUE                                                 06640085
066500     ELSE                                                         06650085
066600         SET DP013-CICS-ABEND      TO TRUE                        06660085
066700         SET DP013-NO-ROLLBACK     TO TRUE                        06670085
066800                                                                  06680085
066900         MOVE '2050-DELETE-LIST-QUEUE'                            06690085
067000                                   TO DP013-PARAGRAPH             06700085
067100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    06710085
067200                                   TO DP013-MESSAGE-TEXT (1)      06720085
067300         PERFORM DP013-0000-PROCESS-ABEND                         06730085
067400     END-IF.                                                      06740085
067500                                                                  06750085
067600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  06760085
067700 EJECT                                                            06770085
067800*----------------------------------------------------------------*06780085
067900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*06790085
068000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *06800085
068100* CICS ARCHITECTURE API.                                         *06810085
068200*----------------------------------------------------------------*06820085
068300 2100-CHECK-FUNCTION-KEY.                                         06830085
068400                                                                  06840085
068500     EVALUATE TRUE                                                06850085
068600*                                                                 06860085
068700* F13 - PRINTER TYPE ADD   (LOCAL-FUNC-01)                        06870085
068800* GOES TO CNKCS218 TO PROCESS PRINTER TYPE ADD                    06880086
068900* SINCE USER DOES NOT SELECT A LIST ITEM, SELECT QUEUE NOT USED   06890085
069000*                                                                 06900086
069100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06910085
069200                 INITIALIZE CN162-INTER-APPL-COMMAREA             06920085
069300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                06930085
069400                                TO CN162-NUMBER-OF-SELECTED-ITEMS 06940085
069500                 SET CN162-ADD  TO TRUE                           06950094
069600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06960085
069700*                                                                 06970085
069800* F15 - PRINTER TYPE UPDATE  (LOCAL-FUNC-02)                      06980085
069900*       GOES TO CNKCS218 TO PROCESS PRINTER TYPE UPDATE           06990091
070000*       SINCE USER SELECTS A LIST ITEM, SELECT QUEUE IS USED      07000091
070100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              07010085
070200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07020085
070300                 INITIALIZE CN162-INTER-APPL-COMMAREA             07030085
070400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                07040085
070500                                TO CN162-NUMBER-OF-SELECTED-ITEMS 07050085
070600                 SET CN162-UPD  TO TRUE                           07060094
070700                 PERFORM 5000-PREPARE-SEL-QUEUE                   07070085
070800             ELSE                                                 07080085
070900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07090085
071000                 SET DP030-OVERRIDE-GO                            07100085
071100                                   TO TRUE                        07110085
071200                 MOVE PC-TSYMSG-00057                             07120085
071300                                   TO DP020-MSG-NUMBER            07130085
071400                 SET DP020-MSG-WARNING                            07140085
071500                                   TO TRUE                        07150085
071600             END-IF                                               07160085
071700*                                                                 07170085
071800* F16 - PRINTER TYPE DELETE   (LOCAL-FUNC-03)                     07180085
071900*       GOES TO CNKCS218 TO PROCESS PRINTER TYPE DELETE           07190091
072000*       SINCE USER SELECTS A LIST ITEM, SELECT QUEUE IS USED      07200091
072100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07210085
072200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07220085
072300                 INITIALIZE CN162-INTER-APPL-COMMAREA             07230085
072400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                07240085
072500                                TO CN162-NUMBER-OF-SELECTED-ITEMS 07250085
072600                 SET CN162-DEL  TO TRUE                           07260094
072700                 PERFORM 5000-PREPARE-SEL-QUEUE                   07270085
072800             ELSE                                                 07280085
072900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07290085
073000                 SET DP030-OVERRIDE-GO                            07300085
073100                                   TO TRUE                        07310085
073200                 MOVE PC-TSYMSG-00057                             07320085
073300                                   TO DP020-MSG-NUMBER            07330085
073400                 SET DP020-MSG-WARNING                            07340085
073500                                   TO TRUE                        07350085
073600             END-IF                                               07360085
073700*                                                                 07370085
073800*                                                                 07380085
073900* F6 - FIRST PAGE                                                 07390085
074000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  07400085
074100             MOVE +1               TO PV-TOP-ITEM                 07410085
074200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07420085
074300*                                                                 07430085
074400* F7 - PREVIOUS PAGE                                              07440085
074500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   07450085
074600             PERFORM 2110-BROWSE-BACKWARD                         07460085
074700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07470085
074800*                                                                 07480085
074900* F8 - NEXT PAGE                                                  07490085
075000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   07500085
075100             PERFORM 2120-BROWSE-FORWARD                          07510085
075200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07520085
075300*                                                                 07530085
075400* ENTER KEY                                                       07540085
075500         WHEN DP020-SRC-AID = DP016-ENTER                         07550085
075600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   07560085
075700             IF  PS-ERROR                                         07570085
075800                 CONTINUE                                         07580085
075900             ELSE                                                 07590085
076000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07600085
076100             END-IF                                               07610085
076200                                                                  07620085
076300         WHEN OTHER                                               07630085
076400             SET DP013-NO-ROLLBACK                                07640085
076500                 DP013-XCTL-DISPLAY-RESTART                       07650085
076600                 DP013-CICS-ABEND  TO TRUE                        07660085
076700             MOVE '2100-CHECK-FUNCTION-KEY'                       07670085
076800                                   TO DP013-PARAGRAPH             07680085
076900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07690085
077000                                   TO DP013-MESSAGE-TEXT (1)      07700085
077100             PERFORM DP013-0000-PROCESS-ABEND                     07710085
077200     END-EVALUATE.                                                07720085
077300*                                                                 07730086
077400*                                                                 07740086
077500*----------------------------------------------------------------*07750085
077600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07760085
077700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07770085
077800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07780085
077900*    MESSAGE.                                                    *07790085
078000*----------------------------------------------------------------*07800085
078100                                                                  07810085
078200 2110-BROWSE-BACKWARD.                                            07820085
078300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07830085
078400         GIVING PV-TOP-ITEM.                                      07840085
078500*                                                                 07850085
078600     IF  ((PV-TOP-ITEM < +1)                                      07860085
078700       OR (PV-TOP-ITEM = +1))                                     07870085
078800         MOVE +1                   TO PV-TOP-ITEM                 07880085
078900*        -- TOP OF LIST --                                        07890085
079000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07900085
079100         SET DP020-MSG-INFORMATIONAL TO TRUE                      07910085
079200     END-IF.                                                      07920085
079300                                                                  07930085
079400 EJECT                                                            07940085
079500*----------------------------------------------------------------*07950085
079600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07960085
079700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07970085
079800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07980085
079900*----------------------------------------------------------------*07990085
080000                                                                  08000085
080100 2120-BROWSE-FORWARD.                                             08010085
080200                                                                  08020085
080300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              08030085
080400         GIVING PV-TOP-ITEM.                                      08040085
080500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   08050085
080600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08060085
080700                                   TO PV-TOP-ITEM                 08070085
080800*        -- BOTTOM OF LIST --                                     08080085
080900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08090085
081000         SET DP020-MSG-INFORMATIONAL                              08100085
081100                                   TO TRUE                        08110085
081200     ELSE                                                         08120085
081300         COMPUTE PV-BOTTOM-ITEM =                                 08130085
081400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08140085
081500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            08150085
081600*            -- BOTTOM OF LIST --                                 08160085
081700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08170085
081800             SET DP020-MSG-INFORMATIONAL                          08180085
081900                                   TO TRUE                        08190085
082000         END-IF                                                   08200085
082100     END-IF.                                                      08210085
082200 EJECT                                                            08220085
082300*----------------------------------------------------------------*08230085
082400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08240085
082500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08250085
082600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08260085
082700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *08270085
082800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *08280085
082900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *08290085
083000*----------------------------------------------------------------*08300085
083100                                                                  08310085
083200 2130-CHECK-FOR-JUMP-BROWSE.                                      08320085
083300     SET PS-NO-ERROR               TO TRUE.                       08330085
083400     IF (ASC-START-ITEM-REQUEST = SPACE)                          08340085
083500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08350085
083600                                   TO PV-TOP-ITEM                 08360085
083700     ELSE                                                         08370085
083800         MOVE ASC-START-ITEM-REQUEST                              08380085
083900                                   TO DP010I-UNEDITED-FIELD       08390085
084000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       08400085
084100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     08410085
084200         SET DP010I-NEGATIVE-NOT-ALLOWED                          08420085
084300                                   TO TRUE                        08430085
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08441095
263455              USING DP010I-NUMERIC-EDIT-AREA                      08442095
084500                                                                  08450085
084600         IF  NOT DP010I-ERROR-DETECTED                            08460085
084700             MOVE DP010I-NUMERIC-FIELD                            08470085
084800                                   TO  ASC-START-ITEM-REQUEST-N   08480085
084900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  08490085
085000                 IF  ASC-START-ITEM-REQUEST-N >                   08500085
085100                                          ASC-NUMBER-OF-ITEMS-READ08510085
085200                     MOVE SPACES TO ASC-START-ITEM-REQUEST        08520085
085300                     COMPUTE PV-TOP-ITEM =                        08530085
085400                             ASC-NUMBER-OF-ITEMS-READ             08540085
085500                             - PC-ITEMS-PER-PANEL + 1             08550085
085600                     IF  PV-TOP-ITEM < +1                         08560085
085700                         MOVE +1   TO PV-TOP-ITEM                 08570085
085800                         MOVE PC-TSYMSG-00070                     08580085
085900                                   TO DP020-MSG-NUMBER            08590085
086000                         SET DP020-MSG-INFORMATIONAL              08600085
086100                                   TO TRUE                        08610085
086200                     END-IF                                       08620085
086300                 ELSE                                             08630085
086400                     MOVE ASC-START-ITEM-REQUEST-N                08640085
086500                                   TO PV-TOP-ITEM                 08650085
086600                     MOVE SPACES   TO ASC-START-ITEM-REQUEST      08660085
086700                     COMPUTE PV-BOTTOM-ITEM =                     08670085
086800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08680085
086900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ08690085
087000*                        -- BOTTOM OF LIST --                     08700085
087100                         MOVE PC-TSYMSG-00070                     08710085
087200                                   TO DP020-MSG-NUMBER            08720085
087300                         SET DP020-MSG-INFORMATIONAL              08730085
087400                                   TO TRUE                        08740085
087500                     END-IF                                       08750085
087600                 END-IF                                           08760085
087700             ELSE                                                 08770085
087800*                --- VALUE OUT OF RANGE ----                      08780085
087900                 MOVE PC-TSYMSG-00101                             08790085
088000                                   TO DP020-MSG-NUMBER            08800085
088100                 MOVE -1           TO ASTRTITL                    08810085
088200                 SET DP030-SET-CURSOR-APPL-1                      08820085
088300                                   TO TRUE                        08830085
088400                 MOVE DP015-REVERSE                               08840085
088500                                   TO ASTRTITH                    08850085
088600                 MOVE DP015-RED    TO ASTRTITC                    08860085
088700                 MOVE DP015-UNP-NUM-BRT-MDT                       08870085
088800                                   TO ASTRTITA                    08880085
088900                 SET DP020-MSG-FATAL                              08890085
089000                                   TO TRUE                        08900085
089100                 SET PS-ERROR      TO TRUE                        08910085
089200             END-IF                                               08920085
089300                                                                  08930085
089400         ELSE                                                     08940085
089500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08950085
089600             MOVE -1               TO ASTRTITL                    08960085
089700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08970085
089800             MOVE DP015-REVERSE    TO ASTRTITH                    08980085
089900             MOVE DP015-RED        TO ASTRTITC                    08990085
090000             MOVE DP015-UNP-NUM-BRT-MDT                           09000085
090100                                   TO ASTRTITA                    09010085
090200             SET DP020-MSG-FATAL   TO TRUE                        09020085
090300             SET PS-ERROR          TO TRUE                        09030085
090400         END-IF                                                   09040085
090500     END-IF.                                                      09050085
090600 EJECT                                                            09060085
090700*----------------------------------------------------------------*09070085
090800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *09080085
090900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *09090085
091000*----------------------------------------------------------------*09100085
091100 2140-DESELECT-ALL-ITEMS.                                         09110085
091200     MOVE +1                       TO ASC-BLK-SUB.                09120085
091300                                                                  09130085
091400     PERFORM 2141-CLEAR-SELECTED-INDS                             09140085
091500         VARYING ASC-ITEM-SUB                                     09150085
091600         FROM 1 BY 1                                              09160085
091700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09170085
091800                                                                  09180085
091900     ADD +1                        TO ASC-BLK-SUB.                09190085
092000                                                                  09200085
092100     PERFORM 2141-CLEAR-SELECTED-INDS                             09210085
092200         VARYING ASC-ITEM-SUB                                     09220085
092300         FROM 1 BY 1                                              09230085
092400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09240085
092500                                                                  09250085
092600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               09260085
092700                                   TO PV-LIST-ITEM-NUMBER.        09270085
092800                                                                  09280085
092900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09290085
093000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    09300085
093100                                                                  09310085
093200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09320085
093300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      09330085
093400         MOVE +1                   TO ASC-BLK-SUB                 09340085
093500                                                                  09350085
093600         PERFORM 5100-WRITE-TEMP-STORAGE                          09360085
093700                                                                  09370085
093800         MOVE +1                   TO PV-BLOCK-NUMBER             09380085
093900                                                                  09390085
094000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09400085
094100             PV-FIRST-BLOCK-IN-ARRAY - 1                          09410085
094200                                                                  09420085
094300         PERFORM                                                  09430085
094400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09440085
094500                                                                  09450085
094600             PERFORM 4410-READ-TEMP-STORAGE                       09460085
094700                                                                  09470085
094800             PERFORM 2141-CLEAR-SELECTED-INDS                     09480085
094900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 09490085
095000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09500085
095100                                                                  09510085
095200             PERFORM 5100-WRITE-TEMP-STORAGE                      09520085
095300                                                                  09530085
095400             ADD +1                TO PV-BLOCK-NUMBER             09540085
095500                                                                  09550085
095600         END-PERFORM                                              09560085
095700                                                                  09570085
095800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09580085
095900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09590085
096000                                                                  09600085
096100         PERFORM                                                  09610085
096200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09620085
096300                   ASC-HIGHEST-BLOCK-WRITTEN                      09630085
096400                                                                  09640085
096500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09650085
096600                                   TO PV-BLOCK-NUMBER             09660085
096700                                                                  09670085
096800             PERFORM 4410-READ-TEMP-STORAGE                       09680085
096900                                                                  09690085
097000             PERFORM 2141-CLEAR-SELECTED-INDS                     09700085
097100                 VARYING ASC-ITEM-SUB                             09710085
097200                 FROM 1 BY 1                                      09720085
097300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09730085
097400                                                                  09740085
097500             PERFORM 5100-WRITE-TEMP-STORAGE                      09750085
097600                                                                  09760085
097700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09770085
097800                                                                  09780085
097900         END-PERFORM                                              09790085
098000                                                                  09800085
098100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             09810085
098200                                   TO PV-BLOCK-NUMBER             09820085
098300                                                                  09830085
098400         PERFORM 4410-READ-TEMP-STORAGE                           09840085
098500     END-IF.                                                      09850085
098600                                                                  09860085
098700                                                                  09870085
098800     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 09880085
098900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.09890085
099000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  09900085
099100                                                                  09910085
099200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        09920085
099300                                                                  09930085
099400 EJECT                                                            09940085
099500*----------------------------------------------------------------*09950085
099600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *09960085
099700*----------------------------------------------------------------*09970085
099800                                                                  09980085
099900 2141-CLEAR-SELECTED-INDS.                                        09990085
100000                                                                  10000085
100100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10010085
100200             NOT EQUAL ZERO                                       10020085
100300         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10030085
100400             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          10040085
100500                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    10050085
100600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10060085
100700                                   TO TRUE                        10070085
100800         END-IF                                                   10080085
100900     END-IF.                                                      10090085
101000                                                                  10100085
101100 EJECT                                                            10110085
101200*----------------------------------------------------------------*10120085
101300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *10130085
101400*  FOR ALL ITEMS.                                                *10140085
101500*----------------------------------------------------------------*10150085
101600                                                                  10160085
101700 2150-SELECT-ALL-ITEMS.                                           10170085
101800                                                                  10180085
101900     MOVE +1                       TO ASC-BLK-SUB.                10190085
102000                                                                  10200085
102100     PERFORM 2151-SET-SELECTED-INDS                               10210085
102200         VARYING ASC-ITEM-SUB                                     10220085
102300         FROM 1 BY 1                                              10230085
102400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10240085
102500                                                                  10250085
102600     ADD +1                        TO ASC-BLK-SUB.                10260085
102700                                                                  10270085
102800     PERFORM 2151-SET-SELECTED-INDS                               10280085
102900         VARYING ASC-ITEM-SUB                                     10290085
103000         FROM 1 BY 1                                              10300085
103100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 10310085
103200                                                                  10320085
103300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               10330085
103400                                   TO PV-LIST-ITEM-NUMBER.        10340085
103500                                                                  10350085
103600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10360085
103700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    10370085
103800                                                                  10380085
103900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10390085
104000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    10400085
104100         MOVE +1                   TO ASC-BLK-SUB                 10410085
104200                                                                  10420085
104300         PERFORM 5100-WRITE-TEMP-STORAGE                          10430085
104400                                                                  10440085
104500         MOVE +1                   TO PV-BLOCK-NUMBER             10450085
104600                                                                  10460085
104700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10470085
104800             PV-FIRST-BLOCK-IN-ARRAY - 1                          10480085
104900                                                                  10490085
105000         PERFORM                                                  10500085
105100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       10510085
105200                                                                  10520085
105300             PERFORM 4410-READ-TEMP-STORAGE                       10530085
105400                                                                  10540085
105500             PERFORM 2151-SET-SELECTED-INDS                       10550085
105600                 VARYING ASC-ITEM-SUB                             10560085
105700                 FROM 1 BY 1                                      10570085
105800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10580085
105900                                                                  10590085
106000             PERFORM 5100-WRITE-TEMP-STORAGE                      10600085
106100                                                                  10610085
106200             ADD +1                TO PV-BLOCK-NUMBER             10620085
106300                                                                  10630085
106400         END-PERFORM                                              10640085
106500                                                                  10650085
106600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10660085
106700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     10670085
106800                                                                  10680085
106900         PERFORM                                                  10690085
107000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       10700085
107100                   ASC-HIGHEST-BLOCK-WRITTEN                      10710085
107200                                                                  10720085
107300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          10730085
107400                                   TO PV-BLOCK-NUMBER             10740085
107500                                                                  10750085
107600             PERFORM 4410-READ-TEMP-STORAGE                       10760085
107700                                                                  10770085
107800             PERFORM 2151-SET-SELECTED-INDS                       10780085
107900                 VARYING ASC-ITEM-SUB                             10790085
108000                 FROM 1 BY 1                                      10800085
108100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          10810085
108200                                                                  10820085
108300             PERFORM 5100-WRITE-TEMP-STORAGE                      10830085
108400                                                                  10840085
108500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      10850085
108600                                                                  10860085
108700         END-PERFORM                                              10870085
108800                                                                  10880085
108900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10890085
109000                                   TO PV-BLOCK-NUMBER             10900085
109100                                                                  10910085
109200         PERFORM 4410-READ-TEMP-STORAGE                           10920085
109300     END-IF.                                                      10930085
109400                                                                  10940085
109500                                                                  10950085
109600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             10960085
109700                       ASC-NUMBER-OF-SELECTED-ITEMS.              10970085
109800                                                                  10980085
109900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10990085
110000                                                                  11000085
110100 EJECT                                                            11010085
110200*----------------------------------------------------------------*11020085
110300*    MARK EACH ITEM AS BEING SELECTED.                           *11030085
110400*----------------------------------------------------------------*11040085
110500                                                                  11050085
110600 2151-SET-SELECTED-INDS.                                          11060085
110700                                                                  11070085
110800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           11080085
110900             NOT EQUAL ZERO                                       11090085
111000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11100085
111100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             11110085
111200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        11120085
111300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  11130085
111400                               TO  TRUE                           11140085
111500         END-IF                                                   11150085
111600     END-IF.                                                      11160085
111700******************************************************************11170085
111800** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **11180085
111900** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **11190085
112000******************************************************************11200085
112100 2200-MOVE-SCREEN-TO-COMMAREA.                                    11210085
112200                                                                  11220085
112300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             11230085
112400     MOVE +1                       TO PV-SUB.                     11240085
112500                                                                  11250085
112600     PERFORM 3100-SET-SUBSCRIPTS.                                 11260085
112700     IF  ASTRTITL > ZERO                                          11270085
112800         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          11280085
112900     ELSE                                                         11290085
113000         IF  ASTRTITF = DP015-ERASE-EOF                           11300085
113100             INITIALIZE ASC-START-ITEM-REQUEST                    11310085
113200         END-IF                                                   11320085
113300     END-IF.                                                      11330085
113400                                                                  11340085
113500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          11350085
113600         VARYING PV-SUB                                           11360085
113700         FROM 1 BY 1                                              11370085
113800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      11380085
113900******************************************************************11390085
114000** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**11400085
114100******************************************************************11410085
114200 2210-MOVE-LINES-TO-COMMAREA.                                     11420085
114300     IF  MR-SELECTL (PV-SUB) > ZERO                               11430085
114400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             11440085
114500         MOVE MR-SELECTI (PV-SUB)                                 11450085
114600                                   TO ASC-TEMP-SELECTED-SW        11460085
114700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11470085
114800     ELSE                                                         11480085
114900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                11490085
115000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     11500085
115100                 MOVE SPACES       TO ASC-TEMP-SELECTED-SW        11510085
115200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      11520085
115300         END-IF                                                   11530085
115400     END-IF.                                                      11540085
115500                                                                  11550085
115600     ADD +1                        TO ASC-ITEM-SUB.               11560085
115700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        11570085
115800         ADD +1                    TO ASC-BLK-SUB                 11580085
115900         MOVE +1                   TO ASC-ITEM-SUB                11590085
116000     END-IF.                                                      11600085
116100******************************************************************11610085
116200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **11620085
116300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **11630085
116400******************************************************************11640085
116500 3000-EDIT-DATA-IN-COMMAREA.                                      11650085
116600     SET PS-NO-ERROR               TO TRUE.                       11660085
116700     PERFORM 3200-RESET-ATTRIBUTES.                               11670085
116800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     11680085
116900                                                                  11690085
117000**                                                                11700085
117100* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              11710085
117200* EDITTING IS DONE FROM THE BOTTOM UP.                            11720085
117300**                                                                11730085
117400     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       11740085
117500         ASC-ITEMS-DISPLAYED - 1.                                 11750085
117600     PERFORM 3100-SET-SUBSCRIPTS.                                 11760085
117700                                                                  11770085
117800      IF  PS-NO-ERROR                                             11780085
117900          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       11790085
118000      END-IF.                                                     11800085
118100                                                                  11810085
118200     IF  PS-NO-ERROR                                              11820085
118300         PERFORM 3400-CHECK-RANGE-SEQUENCE                        11830085
118400     END-IF.                                                      11840085
118500                                                                  11850085
118600     IF  ((PS-NO-ERROR)                                           11860085
118700       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   11870085
118800       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    11880085
118900             PERFORM 3500-MARK-RANGE-AS-SELECTED                  11890085
119000     END-IF.                                                      11900085
119100                                                                  11910085
119200                                                                  11920085
119300*----------------------------------------------------------------*11930085
119400* 3005-EDIT-COMMAREA-BLOCKS                                      *11940085
119500*----------------------------------------------------------------*11950085
119600 3005-EDIT-COMMAREA-BLOCKS.                                       11960085
119700     MOVE +1                       TO PV-BLOCK-NUMBER.            11970085
119800     MOVE +1                       TO ASC-BLK-SUB.                11980085
119900     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               11990085
120000                                                                  12000085
120100     COMPUTE PV-BLOCK-NUMBER  =                                   12010085
120200             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            12020085
120300             PC-ITEMS-PER-PANEL.                                  12030085
120400                                                                  12040085
120500     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          12050085
120600                                                                  12060085
120700     PERFORM                                                      12070085
120800        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         12080085
120900           OR PS-ERROR                                            12090085
121000           OR PS-BLOCK-ERROR                                      12100085
121100                                                                  12110085
121200              COMPUTE PV-ITEMS-HOLD  =                            12120085
121300                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       12130085
121400                      PC-ITEMS-PER-PANEL - 1                      12140085
121500                                                                  12150085
121600               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     12160085
121700                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             12170085
121800                       FROM  PV-ITEMS-HOLD                        12180085
121900                     GIVING  PV-ITEMS-DIFF                        12190085
122000                   SUBTRACT  PV-ITEMS-DIFF                        12200085
122100                       FROM  PC-ITEMS-PER-PANEL                   12210085
122200                     GIVING  PV-ITEMS-HOLD                        12220085
122300                       MOVE  PV-ITEMS-HOLD TO PV-SUB              12230085
122400                                              ASC-ITEM-SUB        12240085
122500                                              ASC-ITEMS-DISPLAYED 12250085
122600               ELSE                                               12260085
122700                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            12270085
122800                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      12280085
122900               END-IF                                             12290085
123000                                                                  12300085
123100               PERFORM 3300-EDIT-SELECTIONS                       12310085
123200                       VARYING PV-SUB                             12320085
123300                          FROM PV-SUB BY -1                       12330085
123400                          UNTIL PV-SUB < +1                       12340085
123500                                                                  12350085
123600                                                                  12360085
123700               MOVE +1               TO ASC-BLK-SUB               12370085
123800                                                                  12380085
123900               PERFORM 5105-REWRITE-ASC-LISTQ                     12390085
124000                                                                  12400085
124100               MOVE +1                TO ASC-BLK-SUB              12410085
124200                                                                  12420085
124300               IF  PS-BLOCK-ERROR                                 12430085
124400                   SET  PS-ERROR     TO TRUE                      12440085
124500                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      12450085
124600                                     TO PV-TOP-ITEM               12460085
124700               ELSE                                               12470085
124800                   ADD  +1           TO PV-BLOCK-NUMBER           12480085
124900                   IF  PV-BLOCK-NUMBER >                          12490085
125000                       ASC-HIGHEST-BLOCK-WRITTEN                  12500085
125100                       MOVE +2       TO ASC-BLK-SUB               12510085
125200                       PERFORM 4410-READ-TEMP-STORAGE             12520085
125300                       MOVE +1       TO ASC-BLK-SUB               12530085
125400                   ELSE                                           12540085
125500                       PERFORM 4410-READ-TEMP-STORAGE             12550085
125600                       ADD  +1        TO PV-BLOCK-NUMBER          12560085
125700                       MOVE +2        TO ASC-BLK-SUB              12570085
125800                       PERFORM 4410-READ-TEMP-STORAGE             12580085
125900                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          12590085
126000                       MOVE +1        TO ASC-BLK-SUB              12600085
126100               END-IF                                             12610085
126200           END-IF                                                 12620085
126300     END-PERFORM.                                                 12630085
126400                                                                  12640085
126500     IF  PV-ORIGINAL-BLOCK  = +1    OR                            12650085
126600         PS-ERROR                   OR                            12660085
126700         PS-BLOCK-ERROR                                           12670085
126800             CONTINUE                                             12680085
126900     ELSE                                                         12690085
127000         MOVE +1                 TO PV-BLOCK-NUMBER               12700085
127100         MOVE +1                 TO ASC-BLK-SUB                   12710085
127200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  12720085
127300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           12730085
127400         PERFORM 4410-READ-TEMP-STORAGE                           12740085
127500                                                                  12750085
127600         PERFORM                                                  12760085
127700            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             12770085
127800               OR PS-ERROR                                        12780085
127900               OR PS-BLOCK-ERROR                                  12790085
128000                                                                  12800085
128100                  COMPUTE PV-ITEMS-HOLD  =                        12810085
128200                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   12820085
128300                          PC-ITEMS-PER-PANEL - 1                  12830085
128400                                                                  12840085
128500                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    12850085
128600                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          12860085
128700                          FROM  PV-ITEMS-HOLD                     12870085
128800                        GIVING  PV-ITEMS-DIFF                     12880085
128900                      SUBTRACT  PV-ITEMS-DIFF                     12890085
129000                          FROM  PC-ITEMS-PER-PANEL                12900085
129100                        GIVING  PV-ITEMS-HOLD                     12910085
129200                          MOVE  PV-ITEMS-HOLD TO PV-SUB           12920085
129300                                                 ASC-ITEM-SUB     12930085
129400                                              ASC-ITEMS-DISPLAYED 12940085
129500                  ELSE                                            12950085
129600                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         12960085
129700                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   12970085
129800                  END-IF                                          12980085
129900                                                                  12990085
130000                  PERFORM 3300-EDIT-SELECTIONS                    13000085
130100                          VARYING PV-SUB                          13010085
130200                             FROM PV-SUB BY -1                    13020085
130300                            UNTIL PV-SUB < +1                     13030085
130400                                                                  13040085
130500                                                                  13050085
130600                  MOVE +1               TO ASC-BLK-SUB            13060085
130700                                                                  13070085
130800                  PERFORM 5105-REWRITE-ASC-LISTQ                  13080085
130900                                                                  13090085
131000                  MOVE +1                TO ASC-BLK-SUB           13100085
131100                                                                  13110085
131200                  IF  PS-BLOCK-ERROR                              13120085
131300                      SET  PS-ERROR     TO TRUE                   13130085
131400                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   13140085
131500                                        TO PV-TOP-ITEM            13150085
131600                  ELSE                                            13160085
131700                      ADD  +1            TO PV-BLOCK-NUMBER       13170085
131800                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     13180085
131900                          MOVE +2        TO ASC-BLK-SUB           13190085
132000                          PERFORM 4410-READ-TEMP-STORAGE          13200085
132100                          MOVE +1        TO ASC-BLK-SUB           13210085
132200                      ELSE                                        13220085
132300                          PERFORM 4410-READ-TEMP-STORAGE          13230085
132400                          ADD  +1        TO PV-BLOCK-NUMBER       13240085
132500                          MOVE +2        TO ASC-BLK-SUB           13250085
132600                          PERFORM 4410-READ-TEMP-STORAGE          13260085
132700                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       13270085
132800                          MOVE +1        TO ASC-BLK-SUB           13280085
132900                      END-IF                                      13290085
133000                  END-IF                                          13300085
133100     END-PERFORM.                                                 13310085
133200                                                                  13320085
133300                                                                  13330085
133400*----------------------------------------------------------------*13340085
133500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13350085
133600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13360085
133700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13370085
133800*                                                                *13380085
133900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13390085
134000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13400085
134100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13410085
134200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13420085
134300*----------------------------------------------------------------*13430085
134400                                                                  13440085
134500 3100-SET-SUBSCRIPTS.                                             13450085
134600                                                                  13460085
134700     COMPUTE ASC-ITEM-SUB =                                       13470085
134800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13480085
134900                                                                  13490085
135000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13500085
135100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13510085
135200                                                                  13520085
135300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13530085
135400     ELSE                                                         13540085
135500         MOVE +1                     TO ASC-BLK-SUB               13550085
135600     END-IF.                                                      13560085
135700******************************************************************13570085
135800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13580085
135900******************************************************************13590085
136000                                                                  13600085
136100 3200-RESET-ATTRIBUTES.                                           13610085
136200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    13620085
136300     MOVE DP015-GREEN              TO ASTRTITC                    13630085
136400     MOVE DP015-UNDERLINE          TO ASTRTITH                    13640085
136500                                                                  13650085
136600     PERFORM                                                      13660085
136700         VARYING PV-SUB                                           13670085
136800         FROM 1 BY 1                                              13680085
136900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        13690085
137000         MOVE DP015-UNP-ALP-NOR-OFF                               13700085
137100                                   TO MR-SELECTA (PV-SUB)         13710085
137200         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         13720085
137300         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         13730085
137400     END-PERFORM.                                                 13740085
137500******************************************************************13750085
137600** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **13760085
137700** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **13770085
137800** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **13780085
137900** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **13790085
138000******************************************************************13800085
138100 3300-EDIT-SELECTIONS.                                            13810085
138200     EVALUATE TRUE                                                13820085
138300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13830085
138400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         13840085
138500                 CONTINUE                                         13850085
138600         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         13860085
138700             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        13870085
138800                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   13880085
138900                 MOVE ASC-TEMP-SELECTED-SW                        13890085
139000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13900085
139100                                TO ASC-SELECTED-SW                13910085
139200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13920085
139300             END-IF                                               13930085
139400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13940085
139500                 = SPACES                                         13950085
139600             EVALUATE TRUE                                        13960085
139700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       13970085
139800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS13980085
139900                     MOVE SPACES TO ASC-SELECTED-SW               13990085
140000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14000085
140100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14010085
140200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14020085
140300                     MOVE SPACES TO ASC-SELECTED-SW               14030085
140400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14040085
140500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14050085
140600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14060085
140700                     MOVE SPACES TO ASC-SELECTED-SW               14070085
140800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14080085
140900             END-EVALUATE                                         14090085
141000         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14100085
141100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14110085
141200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14120085
141300             END-IF                                               14130085
141400             PERFORM 3310-EDIT-RANGE                              14140085
141500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14150085
141600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14160085
141700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14170085
141800             END-IF                                               14180085
141900             PERFORM 3310-EDIT-RANGE                              14190085
142000         WHEN OTHER                                               14200085
142100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14210085
142200             SET DP020-MSG-FATAL    TO TRUE                       14220085
142300             MOVE -1                TO MR-SELECTL (PV-SUB)        14230085
142400             SET DP030-SET-CURSOR-APPL-1                          14240085
142500                                    TO TRUE                       14250085
142600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14260085
142700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14270085
142800             SET PS-ERROR TO TRUE                                 14280085
142900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14290085
143000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14300085
143100                 MOVE SPACES        TO ASC-SELECTED-SW            14310085
143200                                        (ASC-BLK-SUB ASC-ITEM-SUB)14320085
143300             END-IF                                               14330085
143400     END-EVALUATE.                                                14340085
143500                                                                  14350085
143600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14360085
143700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14370085
143800     IF  ASC-ITEM-SUB < 1                                         14380085
143900         SUBTRACT +1 FROM ASC-BLK-SUB                             14390085
144000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14400085
144100     END-IF.                                                      14410085
144200                                                                  14420085
144300                                                                  14430085
144400******************************************************************14440085
144500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **14450085
144600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **14460085
144700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**14470085
144800** THE ENDING.                                                  **14480085
144900******************************************************************14490085
145000 3310-EDIT-RANGE.                                                 14500085
145100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                14510085
145200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   14520085
145300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)14530085
145400                                   TO ASC-SELECTED-SW             14540085
145500                                        (ASC-BLK-SUB ASC-ITEM-SUB)14550085
145600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 14560085
145700         ELSE                                                     14570085
145800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     14580085
145900                 CONTINUE                                         14590085
146000             ELSE                                                 14600085
146100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        14610085
146200                 MOVE PC-TSYMSG-00054                             14620085
146300                                   TO DP020-MSG-NUMBER            14630085
146400                 SET DP020-MSG-FATAL                              14640085
146500                                   TO TRUE                        14650085
146600                 MOVE -1           TO MR-SELECTL (PV-SUB)         14660085
146700                 SET DP030-SET-CURSOR-APPL-1                      14670085
146800                                   TO TRUE                        14680085
146900                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         14690085
147000                 MOVE DP015-UNDERLINE                             14700085
147100                                   TO MR-SELECTH (PV-SUB)         14710085
147200                 SET PS-ERROR      TO TRUE                        14720085
147300             END-IF                                               14730085
147400         END-IF                                                   14740085
147500     ELSE                                                         14750085
147600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     14760085
147700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 14770085
147800                                   TO ASC-SELECTED-SW             14780085
147900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   14790085
148000             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   14800085
148100         ELSE                                                     14810085
148200             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       14820085
148300                 CONTINUE                                         14830085
148400             ELSE                                                 14840085
148500*                -- ONLY ONE END-OF-RANGE ALLOWED --              14850085
148600                 MOVE PC-TSYMSG-00055                             14860085
148700                                   TO DP020-MSG-NUMBER            14870085
148800                 SET DP020-MSG-FATAL                              14880085
148900                                   TO TRUE                        14890085
149000                 MOVE -1           TO MR-SELECTL (PV-SUB)         14900085
149100                 SET DP030-SET-CURSOR-APPL-1                      14910085
149200                                   TO TRUE                        14920085
149300                 SET PS-ERROR      TO TRUE                        14930085
149400             END-IF                                               14940085
149500         END-IF                                                   14950085
149600     END-IF.                                                      14960085
149700*                                                                 14970085
149800******************************************************************14980085
149900** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **14990085
150000** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15000085
150100******************************************************************15010085
150200 3400-CHECK-RANGE-SEQUENCE.                                       15020085
150300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15030085
150400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15040085
150500       AND  ASC-START-OF-SELECTED-RANGE >                         15050085
150600                                         ASC-END-OF-SELECTED-RANGE15060085
150700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15070085
150800         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15080085
150900         SET DP020-MSG-FATAL TO TRUE                              15090085
151000         SET PS-ERROR TO TRUE                                     15100085
151100         PERFORM 3410-POSITION-AT-ERROR                           15110085
151200     END-IF.                                                      15120085
151300******************************************************************15130085
151400** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15140085
151500** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15150085
151600** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15160085
151700******************************************************************15170085
151800 3410-POSITION-AT-ERROR.                                          15180085
151900     SET DP030-SET-CURSOR-APPL-1                                  15190085
152000                                   TO TRUE.                       15200085
152100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15210085
152200                    - PV-TOP-ITEM + 1.                            15220085
152300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15230085
152400         CONTINUE                                                 15240085
152500     ELSE                                                         15250085
152600         MOVE -1                   TO MR-SELECTL (PV-SUB)         15260085
152700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15270085
152800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15280085
152900     END-IF.                                                      15290085
153000                                                                  15300085
153100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15310085
153200                    - PV-TOP-ITEM + 1.                            15320085
153300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15330085
153400         CONTINUE                                                 15340085
153500     ELSE                                                         15350085
153600         MOVE -1                   TO MR-SELECTL (PV-SUB)         15360085
153700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15370085
153800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15380085
153900     END-IF.                                                      15390085
154000 EJECT                                                            15400085
154100*----------------------------------------------------------------*15410085
154200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15420085
154300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15430085
154400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15440085
154500*----------------------------------------------------------------*15450085
154600                                                                  15460085
154700 3500-MARK-RANGE-AS-SELECTED.                                     15470085
154800     MOVE +1                       TO  ASC-BLK-SUB.               15480085
154900     PERFORM 3510-MARK-SELECTED-INDS                              15490085
155000         VARYING ASC-ITEM-SUB                                     15500085
155100         FROM 1 BY 1                                              15510085
155200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15520085
155300                                                                  15530085
155400     ADD +1                        TO ASC-BLK-SUB.                15540085
155500     PERFORM 3510-MARK-SELECTED-INDS                              15550085
155600         VARYING ASC-ITEM-SUB                                     15560085
155700         FROM 1 BY 1                                              15570085
155800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15580085
155900                                                                  15590085
156000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15600085
156100                                   TO  PV-LIST-ITEM-NUMBER.       15610085
156200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15620085
156300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         15630085
156400               PC-ITEMS-PER-PANEL).                               15640085
156500                                                                  15650085
156600     MOVE ASC-START-OF-SELECTED-RANGE                             15660085
156700                                   TO PV-START-OF-SELECTED-RANGE. 15670085
156800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            15680085
156900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  15690085
157000               PC-ITEMS-PER-PANEL).                               15700085
157100                                                                  15710085
157200     MOVE ASC-END-OF-SELECTED-RANGE                               15720085
157300                                   TO  PV-END-OF-SELECTED-RANGE.  15730085
157400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             15740085
157500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    15750085
157600               PC-ITEMS-PER-PANEL).                               15760085
157700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             15770085
157800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             15780085
157900                                                                  15790085
158000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    15800085
158100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        15810085
158200         MOVE +1                   TO ASC-BLK-SUB                 15820085
158300         PERFORM 5100-WRITE-TEMP-STORAGE                          15830085
158400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15840085
158500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15850085
158600                                                                  15860085
158700         PERFORM                                                  15870085
158800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      15880085
158900                   PV-PREV-BLOCK-IN-ARRAY                         15890085
159000             MOVE PV-FIRST-BLOCK-IN-RANGE                         15900085
159100                                   TO PV-BLOCK-NUMBER             15910085
159200             PERFORM 4410-READ-TEMP-STORAGE                       15920085
159300             PERFORM 3510-MARK-SELECTED-INDS                      15930085
159400                 VARYING ASC-ITEM-SUB                             15940085
159500                 FROM 1 BY 1                                      15950085
159600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15960085
159700             PERFORM 5100-WRITE-TEMP-STORAGE                      15970085
159800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     15980085
159900         END-PERFORM                                              15990085
160000                                                                  16000085
160100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16010085
160200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16020085
160300         PERFORM                                                  16030085
160400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16040085
160500                   PV-LAST-BLOCK-IN-RANGE                         16050085
160600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16060085
160700                                   TO PV-BLOCK-NUMBER             16070085
160800             PERFORM 4410-READ-TEMP-STORAGE                       16080085
160900             PERFORM 3510-MARK-SELECTED-INDS                      16090085
161000                 VARYING ASC-ITEM-SUB                             16100085
161100                 FROM 1 BY 1                                      16110085
161200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16120085
161300             PERFORM 5100-WRITE-TEMP-STORAGE                      16130085
161400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16140085
161500         END-PERFORM                                              16150085
161600                                                                  16160085
161700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16170085
161800                                   TO PV-BLOCK-NUMBER             16180085
161900         PERFORM 4410-READ-TEMP-STORAGE                           16190085
162000     END-IF.                                                      16200085
162100                                                                  16210085
162200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16220085
162300                                      ASC-END-OF-SELECTED-RANGE.  16230085
162400                                                                  16240085
162500 EJECT                                                            16250085
162600*----------------------------------------------------------------*16260085
162700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16270085
162800*----------------------------------------------------------------*16280085
162900                                                                  16290085
163000 3510-MARK-SELECTED-INDS.                                         16300085
163100                                                                  16310085
163200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16320085
163300                                ASC-ITEM-SUB) >                   16330085
163400         ASC-START-OF-SELECTED-RANGE)                             16340085
163500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16350085
163600                                ASC-ITEM-SUB) =                   16360085
163700         ASC-START-OF-SELECTED-RANGE)                             16370085
163800                                                                  16380085
163900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16390085
164000                                    ASC-ITEM-SUB) <               16400085
164100             ASC-END-OF-SELECTED-RANGE)                           16410085
164200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16420085
164300                                    ASC-ITEM-SUB) =               16430085
164400             ASC-END-OF-SELECTED-RANGE)                           16440085
164500                                                                  16450085
164600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16460085
164700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16470085
164800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16480085
164900                               TO TRUE                            16490085
165000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16500085
165100                               TO TRUE                            16510085
165200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16520085
165300             END-IF                                               16530085
165400         END-IF                                                   16540085
165500     END-IF.                                                      16550085
165600                                                                  16560085
165700                                                                  16570085
165800*----------------------------------------------------------------*16580085
165900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16590085
166000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16600085
166100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16610085
166200*    DISPLAY THE PANEL TO USER.                                  *16620085
166300*----------------------------------------------------------------*16630085
166400                                                                  16640085
166500 4000-BUILD-INITIAL-PANEL.                                        16650085
166600                                                                  16660085
166700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16670085
166800                                 ASC-BLOCK-ENTRIES (2).           16680085
166900     MOVE +1                 TO ASC-BLK-SUB.                      16690085
167000     SET ASC-ITEMS-LEFT-ON-DB                                     16700085
167100                             TO TRUE.                             16710085
167200                                                                  16720085
167300     MOVE +0                 TO ASC-ITEM-SUB                      16730085
167400                                ASC-NUMBER-OF-ITEMS-READ          16740085
167500                                ASC-NUMBER-OF-SELECTED-ITEMS      16750085
167600                                ASC-HIGHEST-BLOCK-WRITTEN         16760085
167700                                ASC-START-OF-SELECTED-RANGE       16770085
167800                                ASC-END-OF-SELECTED-RANGE         16780085
167900                                ASC-ITEM-AT-TOP-OF-PANEL.         16790085
168000                                                                  16800085
168100     PERFORM 4100-PREPARE-CURSOR                                  16810085
168200                                                                  16820085
168300     PERFORM 4010-OPEN-CURSOR.                                    16830085
168400                                                                  16840085
168500     PERFORM 4300-READ-ITEMS-FROM-DB.                             16850085
168600                                                                  16860085
168700     PERFORM 4020-CLOSE-CURSOR.                                   16870085
168800                                                                  16880085
168900     MOVE +1                   TO  PV-TOP-ITEM.                   16890085
169000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          16900085
169100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    16910085
169200         SET DP020-MSG-FATAL   TO  TRUE                           16920085
169300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               16930085
169400     ELSE                                                         16940085
169500         MOVE -1               TO MR-SELECTL (1)                  16950085
169600         SET DP030-SET-CURSOR-APPL-1                              16960085
169700                               TO TRUE                            16970085
169800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     16980085
169900     END-IF.                                                      16990085
170000 EJECT                                                            17000085
170100*                                                                 17010085
170200*----------------------------------------------------------------*17020085
170300* OPEN THE PRINTER TYPE CURSOR                                   *17030085
170400*----------------------------------------------------------------*17040085
170500 4010-OPEN-CURSOR.                                                17050085
170600     PERFORM                                                      17060085
170700         WITH TEST AFTER                                          17070085
170800         VARYING PV-RETRY-COUNTER                                 17080085
170900         FROM 1 BY 1                                              17090085
171000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17100085
171100                   OR (SQLCODE = ZERO))                           17110085
171200                                                                  17120085
171300         EXEC SQL                                                 17130085
171400              OPEN PRTR-TYPE-CSR                                  17140085
171500         END-EXEC                                                 17150085
171600                                                                  17160085
171700         EVALUATE TRUE                                            17170085
171800             WHEN SQLCODE = ZERO                                  17180085
171900             WHEN SQLCODE = -904                                  17190085
172000             WHEN SQLCODE = -913                                  17200085
172100                 CONTINUE                                         17210085
172200             WHEN SQLWARN0 NOT = SPACES                           17220085
172300             WHEN SQLCODE < ZERO                                  17230085
172400             WHEN SQLCODE > ZERO                                  17240085
172500                 MOVE '4010-OPEN-CURSOR'                          17250085
172600                                   TO DP013-PARAGRAPH             17260085
172700                 MOVE 'OPEN PRINTER TYPE CURSOR - '               17270085
172800                                   TO DP013-MESSAGE-TEXT (1)      17280085
172900                 MOVE SQLCA        TO DP013-SQLCA                 17290085
173000                 MOVE 'TPRTRTY '   TO DP013-DB2-TABLE-NAME (1)    17300085
173100                 SET DP013-DB2-ABEND                              17310085
173200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17320085
173300                 PERFORM DP013-0000-PROCESS-ABEND                 17330085
173400         END-EVALUATE                                             17340085
173500     END-PERFORM                                                  17350085
173600                                                                  17360085
173700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17370085
173800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             17380085
173900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   17390085
174000                                   TO DP013-MESSAGE-TEXT (1)      17400085
174100         MOVE SQLCA                TO DP013-SQLCA                 17410085
174200         MOVE 'TPRTRTY '           TO DP013-DB2-TABLE-NAME (1)    17420085
174300         SET DP013-DB2-ABEND                                      17430085
174400             DP013-XCTL-DISPLAY-RESTART                           17440085
174500                                   TO TRUE                        17450085
174600         PERFORM DP013-0000-PROCESS-ABEND                         17460085
174700     END-IF.                                                      17470085
174800                                                                  17480085
174900 EJECT                                                            17490085
175000*                                                                 17500085
175100*----------------------------------------------------------------*17510085
175200* CLOSE THE PRINTER TYPE CURSOR                                  *17520085
175300*----------------------------------------------------------------*17530085
175400 4020-CLOSE-CURSOR.                                               17540085
175500         EXEC SQL                                                 17550085
175600              CLOSE PRTR-TYPE-CSR                                 17560085
175700         END-EXEC                                                 17570085
175800     EVALUATE TRUE                                                17580085
175900         WHEN SQLCODE = ZERO                                      17590085
176000             CONTINUE                                             17600085
176100         WHEN SQLWARN0 NOT = SPACES                               17610085
176200         WHEN SQLCODE < ZERO                                      17620085
176300         WHEN SQLCODE > ZERO                                      17630085
176400             MOVE '4020-CLOSE-CURSOR'                             17640085
176500                               TO DP013-PARAGRAPH                 17650085
176600             MOVE 'CLOSE PRINTER TYPE CURSOR '                    17660085
176700                               TO DP013-MESSAGE-TEXT (1)          17670085
176800             MOVE SQLCA        TO DP013-SQLCA                     17680085
176900             MOVE 'TPRTRTY '   TO DP013-DB2-TABLE-NAME (1)        17690085
177000             SET DP013-DB2-ABEND                                  17700085
177100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17710085
177200             PERFORM DP013-0000-PROCESS-ABEND                     17720085
177300     END-EVALUATE.                                                17730085
177400                                                                  17740085
177500 EJECT                                                            17750085
177600*----------------------------------------------------------------*17760085
177700*    SET UP THE HOST VARIABLES.                                  *17770085
177800*----------------------------------------------------------------*17780085
177900                                                                  17790085
178000 4100-PREPARE-CURSOR.                                             17800085
178100                                                                  17810085
178200     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 17820085
178300     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    17830085
178400     MOVE ASC-PRINTER-ID       TO DK-PRINTER-ID.                  17840085
178500     MOVE ASC-PRTR-SELECT-TYPE TO DK-PRTR-SEL-TYPE.               17850085
178600                                                                  17860085
178700*----------------------------------------------------------------*17870085
178800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *17880085
178900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *17890085
179000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *17900085
179100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *17910085
179200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *17920085
179300*                                                                *17930085
179400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *17940085
179500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *17950085
179600*    UPON INITIALIZATION.                                        *17960085
179700*----------------------------------------------------------------*17970085
179800 4300-READ-ITEMS-FROM-DB.                                         17980085
179900                                                                  17990085
180000     PERFORM                                                      18000085
180100         VARYING PV-READ-COUNT                                    18010085
180200         FROM 1 BY 1                                              18020085
180300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    18030085
180400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         18040085
180500                                                                  18050085
180600         PERFORM 4310-FETCH                                       18060085
180700                                                                  18070085
180800         IF  ASC-ITEMS-LEFT-ON-DB                                 18080085
180900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                18090085
181000                 ADD +1            TO ASC-ITEM-SUB                18100085
181100             ELSE                                                 18110085
181200                 ADD +1            TO ASC-BLK-SUB                 18120085
181300                 MOVE +1           TO ASC-ITEM-SUB                18130085
181400                                                                  18140085
181500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         18150085
181600                     MOVE +1       TO ASC-BLK-SUB                 18160085
181700                     SET ASC-BLOCK-MODIFIED (1)                   18170085
181800                                   TO TRUE                        18180085
181900                     PERFORM 5100-WRITE-TEMP-STORAGE              18190085
182000                     MOVE ASC-BLOCK-ENTRIES                       18200085
182100                               (PC-MAX-BLOCKS-IN-ARRAY)           18210085
182200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 18220085
182300                     ADD +1        TO ASC-BLK-SUB                 18230085
182400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   18240085
182500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      18250085
182600                                   TO TRUE                        18260085
182700                 END-IF                                           18270085
182800             END-IF                                               18280085
182900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18290085
183000             MOVE ASC-NUMBER-OF-ITEMS-READ                        18300085
183100                                   TO ASC-LIST-ITEM-NUMBER        18310085
183200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18320085
183300             MOVE SPACES           TO  ASC-ACTION                 18330085
183400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18340085
183500             MOVE PRTRTY-PRTR-TYP-CDE                             18350085
183600                              TO  ASC-PRINTER-TYP                 18360085
183700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18370085
183800             MOVE PRTRTY-PRTR-MFR-DESC                            18380085
183900                              TO  ASC-MANF-DESC                   18390085
184000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18400085
184100             MOVE PRTRTY-PRTR-MDL-DESC                            18410085
184200                              TO  ASC-MODEL-DESC                  18420085
184300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18430085
184400             MOVE PRTRTY-PAPR-TRK-QTY                             18440085
184500                              TO  ASC-PAPR-TRK-QTY                18450085
184600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18460085
184700             MOVE PRTRTY-AUTO-CTTR-IND                            18470085
184800                              TO  ASC-AUTO-CTR-IND                18480085
184900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18490085
185000             MOVE PRTRTY-PRT-BRCDE-IND                            18500085
185100                              TO  ASC-BAR-CDE-IND                 18510085
185200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18520085
185300             MOVE PRTRTY-PRTR-CNTL-IND                            18530085
185400                              TO  ASC-PRTR-CNTL-IND               18540085
185500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18550085
185600         END-IF                                                   18560085
185700     END-PERFORM.                                                 18570085
185800                                                                  18580085
185900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18590085
186000         MOVE +1               TO ASC-BLK-SUB                     18600085
186100         PERFORM 5100-WRITE-TEMP-STORAGE                          18610085
186200         ADD +1                TO ASC-BLK-SUB                     18620085
186300         PERFORM 5100-WRITE-TEMP-STORAGE                          18630085
186400                                                                  18640085
186500         MOVE 1                TO ASC-BLK-SUB                     18650085
186600                                  PV-BLOCK-NUMBER                 18660085
186700         PERFORM 4410-READ-TEMP-STORAGE                           18670085
186800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18680085
186900             MOVE 2            TO ASC-BLK-SUB                     18690085
187000                                  PV-BLOCK-NUMBER                 18700085
187100             PERFORM 4410-READ-TEMP-STORAGE                       18710085
187200         END-IF                                                   18720085
187300     END-IF.                                                      18730085
187400 EJECT                                                            18740085
187500*----------------------------------------------------------------*18750085
187600*    FETCH THE PRTR TYPE CURSOR                                  *18760085
187700*----------------------------------------------------------------*18770085
187800 4310-FETCH.                                                      18780085
187900           EXEC SQL                                               18790085
188000                FETCH PRTR-TYPE-CSR                               18800085
188100                 INTO  :PRTRTY-PRTR-TYP-CDE                       18810085
188200                     , :PRTRTY-PRTR-MFR-DESC                      18820085
188300                     , :PRTRTY-PRTR-MDL-DESC                      18830085
188400                     , :PRTRTY-PAPR-TRK-QTY                       18840085
188500                     , :PRTRTY-AUTO-CTTR-IND                      18850085
188600                     , :PRTRTY-PRT-BRCDE-IND                      18860085
188700                     , :PRTRTY-PRTR-CNTL-IND                      18870085
188800           END-EXEC                                               18880085
188900                                                                  18890085
189000           EVALUATE TRUE                                          18900085
189100               WHEN SQLCODE = ZERO                                18910085
189200               WHEN SQLCODE = +100                                18920085
189300                    CONTINUE                                      18930085
189400               WHEN SQLWARN0 NOT = SPACES                         18940085
189500               WHEN SQLCODE NOT = ZERO                            18950085
189600                    MOVE '4310-FETCH-CURSOR'                      18960085
189700                                     TO DP013-PARAGRAPH           18970085
189800                    MOVE 'FETCH PRINTER TYPE CURSOR'              18980085
189900                                     TO DP013-MESSAGE-TEXT (1)    18990085
190000                    MOVE SQLCA       TO DP013-SQLCA               19000085
190100                    SET DP013-DB2-ABEND                           19010085
190200                                     TO TRUE                      19020085
190300                    PERFORM DP013-0000-PROCESS-ABEND              19030085
190400           END-EVALUATE.                                          19040085
190500                                                                  19050085
190600     IF  SQLCODE EQUAL +100                                       19060085
190700         SET ASC-NO-ITEMS-LEFT-ON-DB                              19070085
190800                                   TO TRUE                        19080085
190900     END-IF.                                                      19090085
191000                                                                  19100085
191100                                                                  19110085
191200*----------------------------------------------------------------*19120085
191300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *19130085
191400*----------------------------------------------------------------*19140085
191500                                                                  19150085
191600 4400-MOVE-COMMAREA-TO-SCREEN.                                    19160085
191700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             19170085
191800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          19180085
191900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          19190085
192000             MOVE +1    TO ASC-BLK-SUB                            19200085
192100             PERFORM 5100-WRITE-TEMP-STORAGE                      19210085
192200             ADD +1     TO ASC-BLK-SUB                            19220085
192300             PERFORM 5100-WRITE-TEMP-STORAGE                      19230085
192400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             19240085
192500                 GIVING PV-BLOCK-NUMBER                           19250085
192600                 REMAINDER PV-REMAINDER                           19260085
192700             IF  PV-REMAINDER > ZERO                              19270085
192800                 ADD +1 TO PV-BLOCK-NUMBER                        19280085
192900             END-IF                                               19290085
193000             MOVE +1    TO ASC-BLK-SUB                            19300085
193100             PERFORM 4410-READ-TEMP-STORAGE                       19310085
193200             ADD +1     TO ASC-BLK-SUB                            19320085
193300                           PV-BLOCK-NUMBER                        19330085
193400             PERFORM 4410-READ-TEMP-STORAGE                       19340085
193500     END-IF.                                                      19350085
193600     MOVE +1            TO ASC-BLK-SUB.                           19360085
193700     COMPUTE ASC-ITEM-SUB =                                       19370085
193800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              19380085
193900         + PC-ITEMS-PER-PANEL).                                   19390085
194000*                                                                 19400085
194100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19410085
194200         ADD +1         TO ASC-BLK-SUB                            19420085
194300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19430085
194400     END-IF.                                                      19440085
194500*                                                                 19450085
194600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           19460085
194700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                19470085
194800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        19480085
194900     PERFORM 4420-FORMAT-LIST-LINES                               19490085
195000         VARYING PV-SUB                                           19500085
195100         FROM PC-ITEMS-PER-PANEL BY -1                            19510085
195200         UNTIL PV-SUB < +1.                                       19520085
195300*                                                                 19530085
195400     COMPUTE ASC-ITEMS-DISPLAYED =                                19540085
195500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          19550085
195600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    19560085
195700                                      ASTRTITO.                   19570085
195800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    19580085
195900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    19590085
196000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            19600085
196100                                   TO ASELITO.                    19610085
196200*                                                                 19620085
196300     IF  DP020-MSG-NUMBER-X = SPACES                              19630085
196400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  19640085
196500*            --- MORE ITEMS TO DISPLAY ----                       19650085
196600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            19660085
196700             SET DP020-MSG-INFORMATIONAL TO TRUE                  19670085
196800         END-IF                                                   19680085
196900     END-IF.                                                      19690085
197000*----------------------------------------------------------------*19700085
197100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *19710085
197200*----------------------------------------------------------------*19720085
197300                                                                  19730085
197400 4410-READ-TEMP-STORAGE.                                          19740085
197500                                                                  19750085
197600     EXEC CICS                                                    19760085
197700         READQ TS                                                 19770085
197800             QUEUE (ASC-LIST-QUEUE-NAME)                          19780085
197900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19790085
198000             ITEM  (PV-BLOCK-NUMBER)                              19800085
198100             RESP  (PV-CICS-RESP)                                 19810085
198200     END-EXEC.                                                    19820085
198300                                                                  19830085
198400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       19840085
198500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     19850085
198600         CONTINUE                                                 19860085
198700     ELSE                                                         19870085
198800         SET DP013-CICS-ABEND     TO TRUE                         19880085
198900         SET DP013-NO-ROLLBACK    TO TRUE                         19890085
199000         MOVE '4410-READ-TEMP-STORAGE'                            19900085
199100                                  TO DP013-PARAGRAPH              19910085
199200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      19920085
199300                                  TO DP013-MESSAGE-TEXT(1)        19930085
199400         PERFORM DP013-0000-PROCESS-ABEND                         19940085
199500     END-IF.                                                      19950085
199600                                                                  19960085
199700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             19970085
199800*                                                                 19980085
199900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         19990085
200000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               20000085
200100     END-IF.                                                      20010085
200200 EJECT                                                            20020085
200300*----------------------------------------------------------------*20030085
200400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *20040085
200500*----------------------------------------------------------------*20050085
200600                                                                  20060085
200700 4420-FORMAT-LIST-LINES.                                          20070085
200800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      20080085
200900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                20090085
201000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           20100085
201100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           20110085
201200         MOVE SPACES             TO MR-SELECTI (PV-SUB)           20120085
201300                                    MR-ACTION (PV-SUB)            20130085
201400                                    MR-PRINTER-TYP (PV-SUB)       20140085
201500                                    MR-MANF-DESC   (PV-SUB)       20150085
201600                                    MR-MODEL-DESC (PV-SUB)        20160085
201700                                    MR-AUTO-CTR-IND (PV-SUB)      20170085
201800                                    MR-BAR-CDE-IND (PV-SUB)       20180085
201900                                    MR-PRTR-CNTL-IND (PV-SUB)     20190085
202000         MOVE ZEROES             TO MR-PAPR-TRK-QTY (PV-SUB)      20200085
202100     ELSE                                                         20210085
202200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      20220085
202300                                                   > SPACES       20230085
202400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20240085
202500                                 TO MR-SELECTI (PV-SUB)           20250085
202600         ELSE                                                     20260085
202700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      20270085
202800                                 TO MR-SELECTI (PV-SUB)           20280085
202900         END-IF                                                   20290085
203000                                                                  20300085
203100         IF  DP030-SET-CURSOR-TRAILER                             20310085
203200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)20320085
203300                 > SPACE)                                         20330085
203400               OR (PV-SUB = 1))                                   20340085
203500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20350085
203600                MOVE -1          TO MR-SELECTL (PV-SUB)           20360085
203700             END-IF                                               20370085
203800         END-IF                                                   20380085
203900*                                                                 20390085
204000*                                                                 20400085
204100         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               20410085
204200                                 TO MR-ACTION (PV-SUB)            20420085
204300         MOVE ASC-PRINTER-TYP  (ASC-BLK-SUB ASC-ITEM-SUB)         20430085
204400                                 TO MR-PRINTER-TYP (PV-SUB)       20440085
204500         MOVE ASC-MANF-DESC   (ASC-BLK-SUB ASC-ITEM-SUB)          20450085
204600                                 TO MR-MANF-DESC (PV-SUB)         20460085
204700         MOVE ASC-MODEL-DESC  (ASC-BLK-SUB ASC-ITEM-SUB)          20470085
204800                                 TO MR-MODEL-DESC (PV-SUB)        20480085
204900         MOVE ASC-PAPR-TRK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         20490085
205000                                 TO MR-PAPR-TRK-QTY (PV-SUB)      20500085
205100         MOVE ASC-AUTO-CTR-IND  (ASC-BLK-SUB ASC-ITEM-SUB)        20510085
205200                                 TO MR-AUTO-CTR-IND (PV-SUB)      20520085
205300         MOVE ASC-BAR-CDE-IND  (ASC-BLK-SUB ASC-ITEM-SUB)         20530085
205400                                 TO MR-BAR-CDE-IND (PV-SUB)       20540085
205500         MOVE ASC-PRTR-CNTL-IND (ASC-BLK-SUB ASC-ITEM-SUB)        20550085
205600                                 TO MR-PRTR-CNTL-IND (PV-SUB)     20560085
205700     END-IF.                                                      20570085
205800                                                                  20580085
205900     SUBTRACT +1 FROM ASC-ITEM-SUB                                20590085
206000     IF  ASC-ITEM-SUB < + 1                                       20600085
206100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20610085
206200         MOVE +1                 TO ASC-BLK-SUB                   20620085
206300     END-IF.                                                      20630085
206400******************************************************************20640085
206500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **20650085
206600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **20660085
206700** ISSUE A WARNING.                                             **20670085
206800******************************************************************20680085
206900 4430-CHECK-FOR-BEGIN-AND-END.                                    20690085
207000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20700085
207100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20710085
207200*            -- NO END-OF-RANGE SPECFIED ---                      20720085
207300             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            20730085
207400             SET DP020-MSG-WARNING TO TRUE                        20740085
207500             PERFORM 4431-POSITION-AT-WARNING                     20750085
207600         END-IF                                                   20760085
207700     ELSE                                                         20770085
207800         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     20780085
207900*            -- NO BEGINNING-OF-RANGE SPECFIED ---                20790085
208000             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            20800085
208100             SET DP020-MSG-WARNING TO TRUE                        20810085
208200             PERFORM 4431-POSITION-AT-WARNING                     20820085
208300         END-IF                                                   20830085
208400     END-IF.                                                      20840085
208500******************************************************************20850085
208600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **20860085
208700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **20870085
208800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **20880085
208900** POSITION THE CURSOR THERE.                                   **20890085
209000******************************************************************20900085
209100 4431-POSITION-AT-WARNING.                                        20910085
209200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20920085
209300                    - PV-TOP-ITEM + 1.                            20930085
209400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20940085
209500         CONTINUE                                                 20950085
209600     ELSE                                                         20960085
209700         SET DP030-SET-CURSOR-APPL-1                              20970085
209800                                   TO TRUE                        20980085
209900         MOVE -1                   TO MR-SELECTL (PV-SUB)         20990085
210000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21000085
210100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         21010085
210200     END-IF.                                                      21020085
210300                                                                  21030085
210400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21040085
210500                    - PV-TOP-ITEM + 1.                            21050085
210600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21060085
210700         CONTINUE                                                 21070085
210800     ELSE                                                         21080085
210900         SET DP030-SET-CURSOR-APPL-1                              21090085
211000                                   TO TRUE                        21100085
211100         MOVE -1                   TO MR-SELECTL (PV-SUB)         21110085
211200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21120085
211300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         21130085
211400     END-IF.                                                      21140085
211500                                                                  21150085
211600                                                                  21160085
211700*----------------------------------------------------------------*21170085
211800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *21180085
211900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *21190085
212000* FOR THE SELECTED ITEMS QUEUE.                                  *21200085
212100*                                                                *21210085
212200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *21220085
212300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *21230085
212400* THE ARRAY IS FULL.                                             *21240085
212500*----------------------------------------------------------------*21250085
212600                                                                  21260085
212700 5000-PREPARE-SEL-QUEUE.                                          21270085
212800                                                                  21280085
212900     MOVE +1                   TO  ASC-BLK-SUB.                   21290085
213000     PERFORM 5100-WRITE-TEMP-STORAGE.                             21300085
213100     ADD +1                    TO  ASC-BLK-SUB.                   21310085
213200     PERFORM 5100-WRITE-TEMP-STORAGE.                             21320085
213300                                                                  21330085
213400     MOVE ASC-SEL-QUEUE-NAME   TO  CN162-SEL-QUEUE-NAME.          21340085
213500     PERFORM 6010-DELETE-SEL-QUEUE.                               21350085
213600                                                                  21360085
213700     SET ASC-UPDATE-TSQ        TO  TRUE.                          21370085
213800                                                                  21380085
213900     SET CN163-IDX             TO  1.                             21390085
214000     MOVE ZERO                 TO CN162-NUMBER-OF-TS-ITEMS.       21400085
214100     INITIALIZE CN163-SELECTED-ITEM-ARRAY.                        21410085
214200                                                                  21420085
214300     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           21430085
214400             VARYING PV-ITEM                                      21440085
214500             FROM 1 BY 1                                          21450085
214600             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     21460085
214700                                                                  21470085
214800     IF  CN163-IDX > 1                                            21480085
214900         PERFORM 5205-WRITE-SEL-QUEUE                             21490085
215000         ADD +1                TO CN162-NUMBER-OF-TS-ITEMS        21500085
215100     END-IF.                                                      21510085
215200 EJECT                                                            21520085
215300*----------------------------------------------------------------*21530085
215400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *21540085
215500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *21550085
215600*----------------------------------------------------------------*21560085
215700                                                                  21570085
215800 5100-WRITE-TEMP-STORAGE.                                         21580085
215900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     21590085
216000                                   TO PV-LIST-ITEM-NUMBER.        21600085
216100     COMPUTE PV-BLOCK-NUMBER =                                    21610085
216200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21620085
216300                                                                  21630085
216400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             21640085
216500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             21650085
216600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      21660085
216700             PERFORM 5105-REWRITE-ASC-LISTQ                       21670085
216800         END-IF                                                   21680085
216900     ELSE                                                         21690085
217000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       21700085
217100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            21710085
217200         PERFORM 5110-WRITE-ASC-LISTQ                             21720085
217300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   21730085
217400     END-IF.                                                      21740085
217500                                                                  21750085
217600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21760085
217700******************************************************************21770085
217800** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **21780085
217900** SPECIFIC COMMAREA.                                           **21790085
218000******************************************************************21800085
218100 5105-REWRITE-ASC-LISTQ.                                          21810085
218200     EXEC CICS                                                    21820085
218300         WRITEQ TS                                                21830085
218400             QUEUE (ASC-LIST-QUEUE-NAME)                          21840085
218500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21850085
218600             ITEM  (PV-BLOCK-NUMBER)                              21860085
218700             REWRITE                                              21870085
218800             RESP  (PV-CICS-RESP)                                 21880085
218900     END-EXEC.                                                    21890085
219000                                                                  21900085
219100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           21910085
219200         CONTINUE                                                 21920085
219300     ELSE                                                         21930085
219400         SET DP013-CICS-ABEND            TO TRUE                  21940085
219500         SET DP013-NO-ROLLBACK           TO TRUE                  21950085
219600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       21960085
219700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     21970085
219800                                         TO DP013-MESSAGE-TEXT(1) 21980085
219900         PERFORM DP013-0000-PROCESS-ABEND                         21990085
220000     END-IF.                                                      22000085
220100                                                                  22010085
220200******************************************************************22020085
220300** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **22030085
220400** SPECIFIC COMMAREA.                                           **22040085
220500******************************************************************22050085
220600 5110-WRITE-ASC-LISTQ.                                            22060085
220700     EXEC CICS                                                    22070085
220800         WRITEQ TS                                                22080085
220900             QUEUE (ASC-LIST-QUEUE-NAME)                          22090085
221000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22100085
221100             ITEM  (PV-BLOCK-NUMBER)                              22110085
221200             RESP  (PV-CICS-RESP)                                 22120085
221300     END-EXEC.                                                    22130085
221400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      22140085
221500         SET DP013-CICS-ABEND      TO TRUE                        22150085
221600         SET DP013-NO-ROLLBACK     TO TRUE                        22160085
221700         MOVE '5110-WRITE-ASC-LISTQ'                              22170085
221800                                   TO DP013-PARAGRAPH             22180085
221900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           22190085
222000                                   TO DP013-MESSAGE-TEXT(1)       22200085
222100         PERFORM DP013-0000-PROCESS-ABEND                         22210085
222200     END-IF.                                                      22220085
222300 EJECT                                                            22230085
222400*----------------------------------------------------------------*22240085
222500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *22250085
222600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *22260085
222700*----------------------------------------------------------------*22270085
222800                                                                  22280085
222900 5200-FILL-SEL-QUEUE-RECORD.                                      22290085
223000                                                                  22300085
223100     PERFORM 6112-READ-LIST-QUEUE.                                22310085
223200                                                                  22320085
223300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       22330085
223400         PERFORM                                                  22340085
223500         VARYING LQW-IDX                                          22350085
223600         FROM 1 BY 1                                              22360085
223700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            22370085
223800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          22380085
223900                                                                  22390085
224000             IF  LQW-SELECT (LQW-IDX)                             22400085
224100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              22410085
224200                                  TO CN163-ITEM (CN163-IDX)       22420085
224300                 MOVE SPACE       TO CN163-ACTION-SW (CN163-IDX)  22430086
224400                                                                  22440085
224500                 MOVE LQW-PRINTER-TYP (LQW-IDX)                   22450085
224600                                  TO CN163-PRTR-TYP-CDE           22460085
224700                                      (CN163-IDX)                 22470085
224800                 MOVE LQW-MANF-DESC   (LQW-IDX)                   22480085
224900                                  TO CN163-MANF-DESC              22490085
225000                                      (CN163-IDX)                 22500085
225100                 MOVE LQW-MODEL-DESC  (LQW-IDX)                   22510085
225200                                  TO CN163-MODEL-DESC             22520085
225300                                      (CN163-IDX)                 22530085
225400                 MOVE LQW-PAPR-TRK-QTY (LQW-IDX)                  22540085
225500                                  TO  CN163-PAPER-TRK-QTY         22550085
225600                                       (CN163-IDX)                22560085
225700                 MOVE LQW-AUTO-CTR-IND (LQW-IDX)                  22570085
225800                                  TO  CN163-AUTO-CTR-IND          22580085
225900                                       (CN163-IDX)                22590085
226000                 MOVE LQW-BAR-CDE-IND (LQW-IDX)                   22600085
226100                                  TO  CN163-BAR-CDE-IND           22610085
226200                                       (CN163-IDX)                22620085
226300                 MOVE LQW-PRTR-CNTL-IND (LQW-IDX)                 22630085
226400                                  TO  CN163-PRTR-CNTL-IND         22640085
226500                                       (CN163-IDX)                22650085
226600                                                                  22660085
226700                 SET CN163-IDX UP BY 1                            22670085
226800                 IF  CN163-IDX > CN163-MAX-ITEMS                  22680085
226900                     PERFORM 5205-WRITE-SEL-QUEUE                 22690085
227000                     ADD +1        TO CN162-NUMBER-OF-TS-ITEMS    22700085
227100                     INITIALIZE CN163-SELECTED-ITEM-ARRAY         22710085
227200                     SET CN163-IDX TO  1                          22720085
227300                 END-IF                                           22730085
227400             END-IF                                               22740085
227500         END-PERFORM                                              22750085
227600     END-IF.                                                      22760085
227700                                                                  22770085
227800*----------------------------------------------------------------*22780085
227900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *22790085
228000*----------------------------------------------------------------*22800085
228100                                                                  22810085
228200 5205-WRITE-SEL-QUEUE.                                            22820085
228300                                                                  22830085
228400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            22840085
228500                                   TO CN163-SELECTED-ITEMS.       22850085
228600                                                                  22860085
228700     EXEC CICS                                                    22870085
228800          WRITEQ TS                                               22880085
228900              QUEUE (ASC-SEL-QUEUE-NAME)                          22890085
229000              FROM  (CN163-SELECT-RECORD)                         22900085
229100              ITEM  (PV-SEL-QUEUE-ITEM)                           22910085
229200              RESP  (PV-CICS-RESP)                                22920085
229300     END-EXEC.                                                    22930085
229400                                                                  22940085
229500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22950085
229600         CONTINUE                                                 22960085
229700     ELSE                                                         22970085
229800         SET DP013-CICS-ABEND      TO TRUE                        22980085
229900         SET DP013-NO-ROLLBACK     TO TRUE                        22990085
230000         MOVE '5205-WRITE-SEL-QUEUE'                              23000085
230100                                   TO DP013-PARAGRAPH             23010085
230200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          23020085
230300                                   TO DP013-MESSAGE-TEXT(1)       23030085
230400         PERFORM DP013-0000-PROCESS-ABEND                         23040085
230500     END-IF.                                                      23050085
230600 EJECT                                                            23060085
230700******************************************************************23070085
230800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **23080085
230900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **23090085
231000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **23100085
231100** THE USER.                                                    **23110085
231200******************************************************************23120085
231300 6000-REFRESH-PANEL-FROM-TEMP.                                    23130085
231400     IF  ASC-UPDATE-TSQ                                           23140085
231500         SET ASC-NO-TSQ-UPDATE TO TRUE                            23150085
231600         MOVE ZERO                 TO PV-SAVE-ITEM                23160085
231700                                      PV-SEL-QUEUE-ITEM           23170085
231800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        23180085
231900                                   TO PV-HOLD-SELECTED-ITEMS      23190085
232000         MOVE +1                   TO PV-ITEMS-PROCESSED          23200085
232100         PERFORM 6100-UPDATE-TSQ                                  23210085
232200             UNTIL PV-ITEMS-PROCESSED >                           23220085
232300                                     PV-HOLD-SELECTED-ITEMS       23230085
232400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         23240085
232500                    ASC-BLOCK-ENTRIES (2)                         23250085
232600     END-IF.                                                      23260085
232700                                                                  23270085
232800*----------------------------------------------------------------*23280085
232900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *23290085
233000*----------------------------------------------------------------*23300085
233100 6010-DELETE-SEL-QUEUE.                                           23310085
233200                                                                  23320085
233300     EXEC CICS                                                    23330085
233400         DELETEQ TS                                               23340085
233500             QUEUE (ASC-SEL-QUEUE-NAME)                           23350085
233600             RESP  (PV-CICS-RESP)                                 23360085
233700     END-EXEC.                                                    23370085
233800                                                                  23380085
233900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      23390085
234000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         23400085
234100         CONTINUE                                                 23410085
234200     ELSE                                                         23420085
234300         SET DP013-CICS-ABEND TO TRUE                             23430085
234400         SET DP013-NO-ROLLBACK TO TRUE                            23440085
234500         MOVE '6010-DELETE-SEL-QUEUE'                             23450085
234600                        TO DP013-PARAGRAPH                        23460085
234700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         23470085
234800                        TO DP013-MESSAGE-TEXT (1)                 23480085
234900         PERFORM DP013-0000-PROCESS-ABEND                         23490085
235000     END-IF.                                                      23500085
235100                                                                  23510085
235200*----------------------------------------------------------------*23520085
235300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *23530085
235400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *23540085
235500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *23550085
235600*    THE TEMP QUEUE.                                             *23560085
235700*----------------------------------------------------------------*23570085
235800                                                                  23580085
235900 6100-UPDATE-TSQ.                                                 23590085
236000                                                                  23600085
236100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             23610085
236200     PERFORM 6105-READ-SEL-QUEUE.                                 23620085
236300     PERFORM                                                      23630085
236400         VARYING CN163-IDX                                        23640085
236500         FROM 1 BY 1                                              23650085
236600         UNTIL ((PV-ITEMS-PROCESSED >                             23660085
236700                              PV-HOLD-SELECTED-ITEMS)             23670085
236800         OR (CN163-IDX GREATER THAN CN163-MAX-ITEMS))             23680085
236900         IF  CN163-ACTION-SW (CN163-IDX) > SPACES                 23690085
237000             PERFORM 6110-PROCESS-ITEMS                           23700085
237100         END-IF                                                   23710085
237200         ADD +1                TO PV-ITEMS-PROCESSED              23720085
237300     END-PERFORM.                                                 23730085
237400     PERFORM 6111-WRITE-LIST-QUEUE.                               23740085
237500*----------------------------------------------------------------*23750085
237600*    READ THE LIST QUEUE RECORD.                                 *23760085
237700*----------------------------------------------------------------*23770085
237800                                                                  23780085
237900 6105-READ-SEL-QUEUE.                                             23790085
238000                                                                  23800085
238100     EXEC CICS                                                    23810085
238200          READQ TS                                                23820085
238300              QUEUE (ASC-SEL-QUEUE-NAME)                          23830085
238400              INTO  (CN163-SELECT-RECORD)                         23840085
238500              ITEM  (PV-SEL-QUEUE-ITEM)                           23850085
238600              RESP  (PV-CICS-RESP)                                23860085
238700     END-EXEC.                                                    23870085
238800                                                                  23880085
238900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23890085
239000         CONTINUE                                                 23900085
239100     ELSE                                                         23910085
239200         SET DP013-CICS-ABEND      TO  TRUE                       23920085
239300         SET DP013-NO-ROLLBACK     TO  TRUE                       23930085
239400         MOVE '6105-READ-SEL-QUEUE'                               23940085
239500                                   TO  DP013-PARAGRAPH            23950085
239600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           23960085
239700                                   TO  DP013-MESSAGE-TEXT(1)      23970085
239800         PERFORM DP013-0000-PROCESS-ABEND                         23980085
239900     END-IF.                                                      23990085
240000 EJECT                                                            24000085
240100*----------------------------------------------------------------*24010085
240200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*24020085
240300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*24030085
240400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *24040085
240500*----------------------------------------------------------------*24050085
240600                                                                  24060085
240700 6110-PROCESS-ITEMS.                                              24070085
240800                                                                  24080085
240900     COMPUTE PV-ITEM = 1 + ((CN163-ITEM (CN163-IDX) - 1)          24090085
241000                     / PC-ITEMS-PER-PANEL).                       24100085
241100                                                                  24110085
241200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           24120085
241300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          24130085
241400             PERFORM 6111-WRITE-LIST-QUEUE                        24140085
241500         END-IF                                                   24150085
241600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    24160085
241700                                                                  24170085
241800         PERFORM 6112-READ-LIST-QUEUE                             24180085
241900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               24190085
242000             CONTINUE                                             24200085
242100         END-IF                                                   24210085
242200     END-IF.                                                      24220085
242300                                                                  24230085
242400     COMPUTE PV-SUB = (CN163-ITEM (CN163-IDX)                     24240085
242500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              24250085
242600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         24260085
242700     MOVE LQW-SELECTED-SW (PV-SUB)                                24270085
242800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  24280085
242900     EVALUATE TRUE                                                24290085
243000         WHEN CN163-INQ (CN163-IDX)                               24300085
243100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             24310085
243200                                                                  24320085
243300*FIELDS THAT CAN BE UPDATED:  MANF DESC, MODEL DESC, PRTR TRK QTY,24330090
243400*AUTO CUT IND, BARCODE CAPABLE IND, PRTR CONTROL IND              24340090
243500         WHEN CN163-UPD (CN163-IDX)                               24350085
243600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             24360085
243700              MOVE CN163-MANF-DESC (CN163-IDX)                    24370087
243800                               TO LQW-MANF-DESC (PV-SUB)          24380086
243900              MOVE CN163-MODEL-DESC (CN163-IDX)                   24390087
244000                               TO LQW-MODEL-DESC (PV-SUB)         24400086
244100              MOVE CN163-PAPER-TRK-QTY (CN163-IDX)                24410087
244200                               TO LQW-PAPR-TRK-QTY (PV-SUB)       24420086
244300              MOVE CN163-AUTO-CTR-IND (CN163-IDX)                 24430087
244400                               TO LQW-AUTO-CTR-IND (PV-SUB)       24440086
244500              MOVE CN163-BAR-CDE-IND (CN163-IDX)                  24450087
244600                               TO LQW-BAR-CDE-IND (PV-SUB)        24460086
244700              MOVE CN163-PRTR-CNTL-IND (CN163-IDX)                24470087
244800                               TO LQW-PRTR-CNTL-IND (PV-SUB)      24480086
244900                                                                  24490085
245000         WHEN CN163-DEL (CN163-IDX)                               24500085
245100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             24510085
245200                                                                  24520085
245300         WHEN CN163-ERR (CN163-IDX)                               24530085
245400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             24540085
245500     END-EVALUATE.                                                24550085
245600                                                                  24560085
245700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                24570085
245800                                                                  24580085
245900*----------------------------------------------------------------*24590085
246000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN Y218.             *24600092
246100*----------------------------------------------------------------*24610085
246200                                                                  24620085
246300 6111-WRITE-LIST-QUEUE.                                           24630085
246400                                                                  24640085
246500     EXEC CICS                                                    24650085
246600         WRITEQ TS                                                24660085
246700             QUEUE (ASC-LIST-QUEUE-NAME)                          24670085
246800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     24680085
246900             ITEM  (PV-SAVE-ITEM)                                 24690085
247000             REWRITE                                              24700085
247100             RESP  (PV-CICS-RESP)                                 24710085
247200     END-EXEC.                                                    24720085
247300*                                                                 24730085
247400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24740085
247500         CONTINUE                                                 24750085
247600     ELSE                                                         24760085
247700         SET DP013-CICS-ABEND  TO  TRUE                           24770085
247800         SET DP013-NO-ROLLBACK TO  TRUE                           24780085
247900         MOVE '6111-WRITE-LIST-QUEUE'                             24790085
248000                               TO  DP013-PARAGRAPH                24800085
248100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  24810085
248200                               TO  DP013-MESSAGE-TEXT(1)          24820085
248300         PERFORM DP013-0000-PROCESS-ABEND                         24830085
248400     END-IF.                                                      24840085
248500                                                                  24850085
248600 EJECT                                                            24860085
248700*----------------------------------------------------------------*24870085
248800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*24880085
248900*----------------------------------------------------------------*24890085
249000                                                                  24900085
249100 6112-READ-LIST-QUEUE.                                            24910085
249200                                                                  24920085
249300     EXEC CICS                                                    24930085
249400         READQ TS                                                 24940085
249500             QUEUE (ASC-LIST-QUEUE-NAME)                          24950085
249600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     24960085
249700             ITEM  (PV-ITEM)                                      24970085
249800             RESP  (PV-CICS-RESP)                                 24980085
249900     END-EXEC.                                                    24990085
250000                                                                  25000085
250100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25010085
250200         CONTINUE                                                 25020085
250300     ELSE                                                         25030085
250400         SET DP013-CICS-ABEND        TO TRUE                      25040085
250500         SET DP013-NO-ROLLBACK       TO TRUE                      25050085
250600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           25060085
250700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    25070085
250800                                     TO DP013-MESSAGE-TEXT(1)     25080085
250900         PERFORM DP013-0000-PROCESS-ABEND                         25090085
251000     END-IF.                                                      25100085
251100                                                                  25110085
251200                                                                  25120085
251300*----------------------------------------------------------------*25130085
251400*    ABEND PROCESSOR MODULE                                      *25140085
251500*----------------------------------------------------------------*25150085
251600                                                                  25160085
251700     COPY DPPD013.                                                25170085
