000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS215.                                         00020000
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-05-94                                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    E215 - PACK SLIP LINE SUMMARY LIST                           00080000
000900*                                                                 00090000
001000*    DISPLAY A LIST OF PACK SLIP LINES BASED ON CRITERIA SPECIFIED00100000
001100*                                                                 00110000
001200*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00120000
001300*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00130000
001400*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00140000
001500*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00150000
001600*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00160000
001700*                                                                 00170000
001800*    DC-154: DISABLE THE F13, F15, F16, AND F23 KEYS IF:          00180000
001900*               THE RECEIVER HAS A STATUS OF 'CM' OR 'VE', OR     00190000
002000*               ANY OF THE RECEIPT LINES ARE VERIFIED ('VE').     00200000
002100*            BY M. FURLICK 6/23/94.                               00210000
002200*    913-PROB:IF SQLCODE = -904, -911, -913, PUT THE MESSAGE      00220000
002300*             TO SCREEN INSTEAD OF ABENDING THE TRANSACTION.      00230000
002400*            BY H. KIM     08/10/95.                              00240000
002500*                                                                 00250000
002600******************************************************************00260000
002610*---------------------------------------------------------------* 00261005
002620* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00262006
002630* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00263006
002640* MAKING THE CALL DYNAMIC VS STATIC.                              00264006
002650*---------------------------------------------------------------* 00265006
002700 ENVIRONMENT DIVISION.                                            00270000
002800 DATA DIVISION.                                                   00280000
002900 WORKING-STORAGE SECTION.                                         00290000
003000                                                                  00300000
003100 01  PC-PROGRAM-CONSTANTS.                                        00310000
003200     05  PC-LOCATION-MODULE           PIC X(08) VALUE 'XLKUT071'. 00320000
003300     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC215A  '. 00330000
003400     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM215 '. 00340000
003500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS215'. 00350000
003600     05  PC-RCKUP006                  PIC X(8)  VALUE 'RCKUP006'. 00360000
003700     05  PC-FA-SYTM                   PIC X(10) VALUE 'F/A SYTM'. 00370006
003800     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00380000
003900     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00390000
004000     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +6          00400000
004100                                                COMP SYNC.        00410000
004200     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00420000
004300                                                COMP SYNC.        00430000
004400     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00440000
004500                                                COMP SYNC.        00450000
004600     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00460000
004700                                                COMP SYNC.        00470000
004800     05  PC-INQ                       PIC X(03) VALUE 'INQ'.      00480000
004900     05  PC-UPD                       PIC X(03) VALUE 'UPD'.      00490000
005000     05  PC-DEL                       PIC X(03) VALUE 'DEL'.      00500000
005100     05  PC-ERR                       PIC X(03) VALUE 'ERR'.      00510000
005200     05  PC-0                         PIC 9(04) COMP VALUE 0.     00520000
005300     05  PC-01                        PIC X(02) VALUE '01'.       00530000
005400     05  PC-VE                        PIC X(02) VALUE 'VE'.       00540000
005500     05  PC-CM                        PIC X(02) VALUE 'CM'.       00550000
005600     05  PC-AC                        PIC X(02) VALUE 'AC'.       00560000
005700     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00570000
005800     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00580000
005900     05  PC-INTER-APPL-CODES.                                     00590000
006000         10  PC-INTER-APPL-LIST       PIC X(01) VALUE '1'.        00600000
006100         10  PC-INTER-APPL-MAINT      PIC X(01) VALUE '2'.        00610000
006200                                                                  00620000
006300     05 PC-TSYMSG-NUMBERS.                                        00630000
006400         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00640000
006500*            INVALID VALUE                                        00650000
006600         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00660000
006700*            MUST BE NUMERIC                                      00670000
006800         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00680000
006900*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00690000
007000         10  PC-TSYMSG-00047          PIC 9(5)  VALUE 00047.      00700000
007100*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNTION  00710000
007200         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00720000
007300*            NO END OF RANGE HAS BEEN SPECIFIED                   00730000
007400         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00740000
007500*            END OF RANGE PRECEDES START OF RANGE                 00750000
007600         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00760000
007700*            NO START OF RANGE HAS BEEN SPECIFIED                 00770000
007800         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00780000
007900*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00790000
008000         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00800000
008100*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00810000
008200         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00820000
008300*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00830000
008400         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00840000
008500*            UPDATE(S) SUCCESSFUL                                 00850000
008600         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00860000
008700*            TOP OF LIST                                          00870000
008800         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00880000
008900*            BOTTOM OF LIST                                       00890000
009000         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00900000
009100*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00910000
009200         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      00920000
009300*            DATA DOES NOT EXIST                                  00930000
009400         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00940000
009500*            MORE ITEMS TO DISPLAY                                00950000
009600         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      00960000
009700*       WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL CALL 00970000
009800*       HELP DESK                                                 00980000
009900         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      00990000
010000*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         01000000
010100         10  PC-TSYMSG-00735          PIC 9(5)  VALUE 00735.      01010000
010200*            STORE DISTRO NOT ALLOWED UNLESS PACK SLIP ASSIGNED.  01020000
010300         10  PC-TSYMSG-00815          PIC 9(5)  VALUE 00815.      01030000
010400*       OPERATING UNIT AND FACILITY ID REQUIRED FOR THIS FUNCTION 01040000
010500         10  PC-TSYMSG-00966          PIC 9(5)  VALUE 00966.      01050000
010600*            INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS    01060000
010700         10  PC-TSYMSG-03249          PIC 9(5)  VALUE 03249.      01070000
010800*            UNABLE TO PERFORM FUNCTION, NO PBS ERRORS EXIST      01080000
010900         10  PC-TSYMSG-03348          PIC 9(5)  VALUE 03348.      01090000
011000*            UNABLE TO UPDATE/DELETE FREE-ASTRAY PACKSLIP         01100000
011100                                                                  01110000
011200 01  PS-PROGRAM-SWITCHES.                                         01120000
011300     05  PS-PBS-ORDER-SW              PIC  X    VALUE 'N'.        01130000
011400         88  PS-NOT-PBS-ORDER                   VALUE 'N'.        01140000
011500         88  PS-PBS-ORDER                       VALUE 'Y'.        01150000
011600     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01160000
011700         88  PS-NO-ERROR                        VALUE 'N'.        01170000
011800         88  PS-ERROR                           VALUE 'Y'.        01180000
011900     05  PS-SEARCH-STYLE-SW           PIC  X    VALUE 'N'.        01190000
012000         88  PS-INVALID-SEARCH-STYLE            VALUE 'N'.        01200000
012100         88  PS-VALID-SEARCH-STYLE              VALUE 'Y'.        01210000
012200     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01220000
012300         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01230000
012400         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01240000
012500     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X     VALUE 'N'.       01250000
012600         88  PS-ORIG-ASN-PKSLIP-YES              VALUE 'Y'.       01260000
012700         88  PS-ORIG-ASN-PKSLIP-NO               VALUE 'N'.       01270000
012800     05  PS-FREE-ASTRAY-SLIP-SW       PIC  X     VALUE 'N'.       01280000
012900         88  PS-FREE-ASTRAY-SLIP-YES             VALUE 'Y'.       01290000
013000         88  PS-FREE-ASTRAY-SLIP-NO              VALUE 'N'.       01300000
013100                                                                  01310000
013200 01  DK-DB2-KEYS.                                                 01320000
013300     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01330000
013400     05  DK-PKSL-NBR                  PIC X(10) VALUE SPACES.     01340000
013500     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01350000
013600     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    01360000
013700     05  DK-SEQ-NBR-B                 PIC S9(4) COMP VALUE +0.    01370000
013800     05  DK-SEQ-NBR-E                 PIC S9(4) COMP VALUE        01380000
013900                                                +9999.            01390000
014000     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    01400000
014100     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    01410000
014200     05  DK-ORD-LNE-NBR               PIC S9(9) COMP VALUE +0.    01420000
014300                                                                  01430000
014400 01  PV-PROGRAM-VARIABLES.                                        01440000
014500     05  PV-SUB                       PIC S9(4) VALUE ZERO        01450000
014600                                                COMP SYNC.        01460000
014700     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01470000
014800                                                COMP SYNC.        01480000
014900     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01490000
015000                                                COMP-3.           01500000
015100     05  PV-PBS-COUNT                 PIC S9(9) VALUE ZERO        01510000
015200                                                COMP-3.           01520000
015300     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01530000
015400                                                COMP-3.           01540000
015500     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01550000
015600                                                COMP-3.           01560000
015700     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01570000
015800                                                COMP-3.           01580000
015900     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01590000
016000                                                COMP-3.           01600000
016100     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01610000
016200                                                COMP-3.           01620000
016300     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01630000
016400                                                COMP-3.           01640000
016500     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01650000
016600                                                COMP SYNC.        01660000
016700     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01670000
016800                                                COMP SYNC.        01680000
016900     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01690000
017000                                                COMP SYNC.        01700000
017100     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01710000
017200                                                COMP SYNC.        01720000
017300     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01730000
017400                                                COMP SYNC.        01740000
017500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01750000
017600                                                COMP SYNC.        01760000
017700     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01770000
017800                                                COMP SYNC.        01780000
017900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01790000
018000                                                COMP SYNC.        01800000
018100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01810000
018200                                                COMP SYNC.        01820000
018300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01830000
018400                                                COMP SYNC.        01840000
018500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01850000
018600                                                COMP SYNC.        01860000
018700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01870000
018800                                                COMP SYNC.        01880000
018900     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01890000
019000                                                COMP SYNC.        01900000
019100     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01910000
019200                                                COMP SYNC.        01920000
019300     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        01930000
019400                                                COMP SYNC.        01940000
019500     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        01950000
019600                                                COMP SYNC.        01960000
019700     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        01970000
019800                                                COMP SYNC.        01980000
019900     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01990000
020000                                                COMP-3.           02000000
020100     05  PV-DB2-CURSOR-FIELDS.                                    02010000
020200         10  PV-PKSL-LNE-NBR          PIC S9(9) VALUE ZERO        02020000
020300                                                COMP SYNC.        02030000
020400         10  PV-PKSL-ITM-QTY          PIC S9(9) VALUE ZERO        02040000
020500                                                COMP SYNC.        02050000
020600         10  PV-VEND-STYL-NAME        PIC X(20) VALUE SPACES.     02060000
020700         10  PV-UNT-COST-AMT          PIC S9(4)V9(3)              02070000
020800                                                VALUE ZERO        02080000
020900                                                COMP-3.           02090000
021000         10  PV-COLOR-DESC            PIC X(25) VALUE SPACES.     02100000
021100         10  PV-VEND-DESC             PIC X(25) VALUE SPACES.     02110000
021200         10  PV-SIZE-DESC             PIC X(25) VALUE SPACES.     02120000
021300         10  PV-PKSL-STAT-CDE         PIC X(02) VALUE SPACES.     02130000
021400         10  PV-SEQ-NBR               PIC S9(4) VALUE ZERO        02140000
021500                                                COMP.             02150000
021600 01  LQW-LIST-QUEUE-WORK-AREA.                                    02160000
021700     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02170000
021800     05  LQW-ITEM-ENTRIES             OCCURS 6 TIMES              02180000
021900                                      INDEXED BY LQW-IDX.         02190000
022000         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02200000
022100         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02210000
022200         10  LQW-SELECTED-SW          PIC X(01).                  02220000
022300             88  LQW-SELECT                      VALUE 'S'.       02230000
022400             88  LQW-DESELECT                    VALUE ' '.       02240000
022500         10  LQW-ACTION               PIC X(03).                  02250000
022600         10  LQW-PKSL-LNE-NBR         PIC 9(04).                  02260000
022700         10  LQW-VEND-STYL-NAME       PIC X(20).                  02270000
022800         10  LQW-PKSL-ITM-QTY         PIC 9(06).                  02280000
022900         10  LQW-UNT-COST-AMT         PIC 9(4)V9(3).              02290000
023000         10  LQW-COLOR-DESC           PIC X(25).                  02300000
023100         10  LQW-VEND-DESC            PIC X(25).                  02310000
023200         10  LQW-SIZE-DESC            PIC X(25).                  02320000
023300                                                                  02330000
023400******************************************************************02340000
023500*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02350000
023600******************************************************************02360000
023700     COPY RCWS013.                                                02370000
023800                                                                  02380000
023900*----------------------------------------------------------------*02390000
024000*  COPYBOOK FOR LOCATION CALL MODULE                              02400000
024100*-----------------------------------------------------------------02410000
024200     COPY XLWS071.                                                02420000
024300                                                                  02430000
024400******************************************************************02440000
024500*    BMS MAP                                                      02450000
024600******************************************************************02460000
024700     COPY RCKM215.                                                02470000
024800                                                                  02480000
024900 01  MR-OCCURS-LAYOUT                 REDEFINES RC215AO.          02490000
025000** CHG0094517  CHANGED FILLER FROM 147 TO 148                     02500004
025100     05  FILLER                       PIC X(148).                 02510002
025200     05  MR-SCROLL-AREA               OCCURS 6 TIMES.             02520000
025300         10  MR-SELECTL               PIC S9(4) COMP.             02530000
025400         10  MR-SELECTA               PIC X.                      02540000
025500         10  MR-SELECTC               PIC X.                      02550000
025600         10  MR-SELECTH               PIC X.                      02560000
025700         10  MR-SELECTI               PIC X.                      02570000
025800                                                                  02580000
025900         10  MR-ACTIONL               PIC S9(4) COMP.             02590000
026000         10  MR-ACTIONA               PIC X.                      02600000
026100         10  MR-ACTIONC               PIC X.                      02610000
026200         10  MR-ACTIONH               PIC X.                      02620000
026300         10  MR-ACTION                PIC XXX.                    02630000
026400                                                                  02640000
026500         10  MR-PKSL-LNE-NBR-L        PIC S9(4) COMP.             02650000
026600         10  MR-PKSL-LNE-NBR-A        PIC X.                      02660000
026700         10  MR-PKSL-LNE-NBR-C        PIC X.                      02670000
026800         10  MR-PKSL-LNE-NBR-H        PIC X.                      02680000
026900         10  MR-PKSL-LNE-NBR          PIC X(04).                  02690000
027000                                                                  02700000
027100         10  MR-VEND-STYL-NAME-L      PIC S9(4) COMP.             02710000
027200         10  MR-VEND-STYL-NAME-A      PIC X.                      02720000
027300         10  MR-VEND-STYL-NAME-C      PIC X.                      02730000
027400         10  MR-VEND-STYL-NAME-H      PIC X.                      02740000
027500         10  MR-VEND-STYL-NAME        PIC X(20).                  02750000
027600                                                                  02760000
027700         10  MR-PKSL-ITM-QTY-L        PIC S9(4) COMP.             02770000
027800         10  MR-PKSL-ITM-QTY-A        PIC X.                      02780000
027900         10  MR-PKSL-ITM-QTY-C        PIC X.                      02790000
028000         10  MR-PKSL-ITM-QTY-H        PIC X.                      02800000
028100         10  MR-PKSL-ITM-QTY.                                     02810000
028200             15  MR-PKSL-ITM-QTY-EDITTED                          02820000
028300                                      PIC ZZZ,ZZ9.                02830000
028400                                                                  02840000
028500         10  MR-UNT-COST-AMT-L        PIC S9(4) COMP.             02850000
028600         10  MR-UNT-COST-AMT-A        PIC X.                      02860000
028700         10  MR-UNT-COST-AMT-C        PIC X.                      02870000
028800         10  MR-UNT-COST-AMT-H        PIC X.                      02880000
028900         10  MR-UNT-COST-AMT.                                     02890000
029000             15  MR-UNT-COST-AMT-EDITTED                          02900000
029100                                      PIC ZZZZ.999.               02910000
029200                                                                  02920000
029300         10  MR-COLOR-DESC-L          PIC S9(4) COMP.             02930000
029400         10  MR-COLOR-DESC-A          PIC X.                      02940000
029500         10  MR-COLOR-DESC-C          PIC X.                      02950000
029600         10  MR-COLOR-DESC-H          PIC X.                      02960000
029700         10  MR-COLOR-DESC            PIC X(25).                  02970000
029800                                                                  02980000
029900         10  MR-VEND-DESC-L           PIC S9(4) COMP.             02990000
030000         10  MR-VEND-DESC-A           PIC X.                      03000000
030100         10  MR-VEND-DESC-C           PIC X.                      03010000
030200         10  MR-VEND-DESC-H           PIC X.                      03020000
030300         10  MR-VEND-DESC             PIC X(25).                  03030000
030400                                                                  03040000
030500         10  MR-SIZE-DESC-L           PIC S9(4) COMP.             03050000
030600         10  MR-SIZE-DESC-A           PIC X.                      03060000
030700         10  MR-SIZE-DESC-C           PIC X.                      03070000
030800         10  MR-SIZE-DESC-H           PIC X.                      03080000
030900         10  MR-SIZE-DESC             PIC X(25).                  03090000
031000                                                                  03100000
031100                                                                  03110000
031200******************************************************************03120000
031300*    BMS ATTRIBUTES                                               03130000
031400******************************************************************03140000
031500     COPY DPWS015.                                                03150000
031600                                                                  03160000
031700******************************************************************03170000
031800*    FUNCTION KEYS                                                03180000
031900******************************************************************03190000
032000     COPY DPWS016.                                                03200000
032100                                                                  03210000
032200******************************************************************03220000
032300*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   03230000
032400******************************************************************03240000
032500     COPY DPWS010I.                                               03250000
032600                                                                  03260000
032700******************************************************************03270000
032800*    PARAMETER LIST FOR CICS API                                  03280000
032900******************************************************************03290000
033000     COPY DPWS030.                                                03300000
033010     COPY DPWS930.                                                03301006
033100                                                                  03310000
033200******************************************************************03320000
033300*    GLOBAL COMMUNICATION AREA                                    03330000
033400******************************************************************03340000
033500     COPY DPWS020.                                                03350000
033600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03360000
033700                                                                  03370000
033800******************************************************************03380000
033900*    INTER-APPLICATION COMMUNICATION AREA                         03390000
034000*    RCWS012 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    03400000
034100******************************************************************03410000
034200         10  INTER-APPL-COMM-AREA       PIC X(200).               03420000
034300     COPY RCWS012.                                                03430000
034400     COPY RCWS015.                                                03440000
034500                                                                  03450000
034600******************************************************************03460000
034700*    APPLICATION SPECIFIC COMMUNICATION AREA                      03470000
034800******************************************************************03480000
034900         10  ASC-SPECIFIC-COMMAREA.                               03490000
035000             15  ASC-LIST-KEYS.                                   03500000
035100                 20  ASC-KEY-SEARCH-STYLE       PIC X(20).        03510000
035200** CHG0094517  CHANGED PO-NBR FROM 7 TO 8                         03520004
035300                 20  ASC-KEY-PO-NBR             PIC 9(08).        03530001
035400                 20  ASC-KEY-PKSL-NBR           PIC X(10).        03540000
035500                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        03550000
035600                 20  ASC-KEY-REC-SEQ-NBR        PIC 9(04).        03560000
035700                 20  ASC-KEY-STR-DEST-NBR       PIC 9(04).        03570000
035800                 20  ASC-KEY-SEQ-NBR            PIC S9(04) COMP.  03580000
035900                 20  ASC-KEY-OPER-UNT-ID        PIC 9(04).        03590000
036000                 20  ASC-KEY-FCLTY-ID           PIC 9(04).        03600000
036100                 20  ASC-KEY-PRO-NBR            PIC X(16).        03610000
036200                 20  ASC-KEY-BOL-NBR            PIC X(16).        03620000
036300                 20  ASC-KEY-PKSL-STAT-CDE      PIC X(02).        03630000
036400             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               03640000
036500                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       03650000
036600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03660000
036700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03670000
036800                                                                  03680000
036900                 20  ASC-ITEM-ARRAY.                              03690000
037000                     25  ASC-ITEM-ENTRIES  OCCURS 6 TIMES.        03700000
037100                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    03710000
037200                                                     COMP-3.      03720000
037300                         30  ASC-TEMP-SELECTED-SW    PIC X.       03730000
037400                             88  ASC-VALID-SELECT    VALUE ' '    03740000
037500                                                           'S'    03750000
037600                                                           'B'    03760000
037700                                                           'E'.   03770000
037800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03780000
037900                             88  ASC-TEMP-SELECT     VALUE 'S'.   03790000
038000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03800000
038100                             88  ASC-TEMP-END        VALUE 'E'.   03810000
038200                         30  ASC-SELECTED-SW         PIC  X.      03820000
038300                             88  ASC-NO-SELECT       VALUE ' '.   03830000
038400                             88  ASC-SELECT          VALUE 'S'.   03840000
038500                             88  ASC-BEGIN           VALUE 'B'.   03850000
038600                             88  ASC-END             VALUE 'E'.   03860000
038700                         30  ASC-ACTION              PIC XXX.     03870000
038800                         30  ASC-PKSL-LNE-NBR.                    03880000
038900                             35  ASC-PKSL-LNE-NBR-N  PIC 9(04).   03890000
039000                         30  ASC-VEND-STYL-NAME      PIC X(20).   03900000
039100                         30  ASC-PKSL-ITM-QTY.                    03910000
039200                             35  ASC-PKSL-ITM-QTY-N  PIC 9(06).   03920000
039300                         30  ASC-UNT-COST-AMT.                    03930000
039400                             35  ASC-UNT-COST-AMT-N  PIC          03940000
039500                                                     9(4)V9(3).   03950000
039600                         30  ASC-COLOR-DESC          PIC X(25).   03960000
039700                         30  ASC-VEND-DESC           PIC X(25).   03970000
039800                         30  ASC-SIZE-DESC           PIC X(25).   03980000
039900                                                                  03990000
040000             15  ASC-BLK-SUB                         PIC S9(4)    04000000
040100                                                     COMP SYNC.   04010000
040200             15  ASC-ITEM-SUB                        PIC S9(4)    04020000
040300                                                     COMP SYNC.   04030000
040400             15  ASC-SEL-SUB                         PIC S9(4)    04040000
040500                                                     COMP.        04050000
040600             15  ASC-SEL-ITEM                        PIC S9(4)    04060000
040700                                                     COMP.        04070000
040800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    04080000
040900                                                     COMP-3.      04090000
041000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    04100000
041100                                                     COMP-3.      04110000
041200             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    04120000
041300                                                     COMP-3.      04130000
041400             15  ASC-ITEMS-DISPLAYED                 PIC S999     04140000
041500                                                     COMP-3.      04150000
041600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    04160000
041700                                                     COMP-3.      04170000
041800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    04180000
041900                                                     COMP-3.      04190000
042000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    04200000
042100                                                     COMP SYNC.   04210000
042200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    04220000
042300                                                     COMP-3.      04230000
042400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    04240000
042500                                                     COMP-3.      04250000
042600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       04260000
042700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04270000
042800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04280000
042900             15  ASC-LIST-QUEUE-NAME.                             04290000
043000                 20  ASC-LIST-TERM-ID                PIC X(4).    04300000
043100                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    04310000
043200                                                     COMP-3.      04320000
043300                 20  ASC-LIST-SEQ                    PIC 9.       04330000
043400             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    04340000
043500             15  ASC-SEL-QUEUE-NAME-OUT.                          04350000
043600                 20  ASC-SEL-TERM-ID                 PIC X(4).    04360000
043700                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    04370000
043800                                                     COMP-3.      04380000
043900                 20  ASC-SEL-SEQ                     PIC 9.       04390000
044000             15  ASC-START-ITEM-REQUEST.                          04400000
044100                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    04410000
044200             15  ASC-PACK-SLIP-ITEM-SW               PIC X.       04420000
044300                 88  ASC-MORE-PACK-SLIP-ITEMS        VALUE 'Y'.   04430000
044400                 88  ASC-NO-MORE-PACK-SLIP-ITEMS     VALUE 'N'.   04440000
044500             15  ASC-READ-ONLY-SW                    PIC X.       04450000
044600                 88  ASC-READ-ONLY                   VALUE 'R'.   04460000
044700                 88  ASC-UPDATES-ALLOWED             VALUE 'U'.   04470000
044800             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    04480000
044900                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   04490000
045000             15  ASC-RECEIVER-FOUND-SW               PIC X.       04500000
045100                 88  ASC-RECEIVER-FOUND              VALUE 'Y'.   04510000
045200                 88  ASC-NO-RECEIVER-FOUND           VALUE 'N'.   04520000
045300             15  ASC-PACK-BY-ST-IND                  PIC X.       04530000
045400             15  ASC-HOLD-INTER-APPL                 PIC X(200).  04540000
045500                                                                  04550000
045600******************************************************************04560000
045700*    ABEND PROCESSING                                             04570000
045800******************************************************************04580000
045900     COPY DPWS013.                                                04590000
046000                                                                  04600000
046100******************************************************************04610000
046200*    DB2 SQL COMMUNICATION AREA                                   04620000
046300******************************************************************04630000
046400     EXEC SQL                                                     04640000
046500          INCLUDE SQLCA                                           04650000
046600     END-EXEC.                                                    04660000
046700                                                                  04670000
046800*----------------------------------------------------------------*04680000
046900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT UNIT      04690000
047000*  LOCATION TABLE                                                 04700000
047100*----------------------------------------------------------------*04710000
047200     EXEC SQL                                                     04720000
047300         INCLUDE TSHUNLO                                          04730000
047400     END-EXEC.                                                    04740000
047500                                                                  04750000
047600******************************************************************04760000
047700*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        04770000
047800******************************************************************04780000
047900     EXEC SQL                                                     04790000
048000          INCLUDE TPKSLIP                                         04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300*----------------------------------------------------------------*04830000
048400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI04840000
048500*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         04850000
048600*----------------------------------------------------------------*04860000
048700     EXEC SQL                                                     04870000
048800         INCLUDE TINPKSU                                          04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100******************************************************************04910000
049200*    DB2 DCLGEN FOR THE RECEIVER TABLE                            04920000
049300******************************************************************04930000
049400     EXEC SQL                                                     04940000
049500          INCLUDE TRECEIV                                         04950000
049600     END-EXEC.                                                    04960000
049700                                                                  04970000
049800******************************************************************04980000
049900*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       04990000
050000******************************************************************05000000
050100     EXEC SQL                                                     05010000
050200          INCLUDE TRECITM                                         05020000
050300     END-EXEC.                                                    05030000
050400                                                                  05040000
050500******************************************************************05050000
050600*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          05060000
050700******************************************************************05070000
050800     EXEC SQL                                                     05080000
050900          INCLUDE TPKITEM                                         05090000
051000     END-EXEC.                                                    05100000
051100                                                                  05110000
051200******************************************************************05120000
051300*    DB2 DCLGEN FOR UNMATCHED PACK SLIP ITEM TABLE                05130000
051400******************************************************************05140000
051500     EXEC SQL                                                     05150000
051600          INCLUDE TUNPKSL                                         05160000
051700     END-EXEC.                                                    05170000
051800                                                                  05180000
051900******************************************************************05190000
052000*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05200000
052100******************************************************************05210000
052200     EXEC SQL                                                     05220000
052300          INCLUDE TPURCHS                                         05230000
052400     END-EXEC.                                                    05240000
052500                                                                  05250000
052600******************************************************************05260000
052700*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     05270000
052800******************************************************************05280000
052900     EXEC SQL                                                     05290000
053000          INCLUDE TPURITM                                         05300000
053100     END-EXEC.                                                    05310000
053200                                                                  05320000
053300******************************************************************05330000
053400*    DB2 DCLGEN FOR SKU TABLE                                     05340000
053500******************************************************************05350000
053600     EXEC SQL                                                     05360000
053700          INCLUDE XLT00003                                        05370000
053800     END-EXEC.                                                    05380000
053900                                                                  05390000
054000******************************************************************05400000
054100*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  05410000
054200******************************************************************05420000
054300     EXEC SQL                                                     05430000
054400          INCLUDE TENTNME                                         05440000
054500     END-EXEC.                                                    05450000
054600                                                                  05460000
054700******************************************************************05470000
054800*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PACK SLIP ITEMS       05480000
054900******************************************************************05490000
055000     EXEC SQL                                                     05500000
055100          DECLARE ITEM-CURSOR CURSOR FOR                          05510000
055200           SELECT A.PKSL_LNE_NBR,                                 05520000
055300                  A.PKSL_ITM_QTY,                                 05530000
055400                  B.VEND_STYL_NAME,                               05540000
055500                  B.UNT_COST_AMT,                                 05550000
055600                  D.CSTM_CLOR_DESC,                               05560000
055700                  B.SKU_DESC,                                     05570000
055800                  B.SIZE_DESC,                                    05580000
055900                  C.PKSL_STAT_CDE,                                05590000
056000                  C.SEQ_NBR                                       05600000
056100             FROM TPKITEM A,                                      05610000
056200                  TPURITM B,                                      05620000
056300                  TPKSLIP C,                                      05630000
056400                  XLT_SKU D                                       05640000
056500            WHERE A.PO_NBR         = :DK-PO-NBR                   05650000
056600              AND B.PO_NBR         = :DK-PO-NBR                   05660000
056700              AND C.PO_NBR         = :DK-PO-NBR                   05670000
056800              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                05680000
056900                                 AND :DK-SEQ-NBR-E                05690000
057000              AND A.SEQ_NBR        = C.SEQ_NBR                    05700000
057100              AND A.PKSL_LNE_NBR   = B.APP_PO_LNE_NBR             05710000
057200              AND A.VER_STAT_CDE   = :PC-ACTIVE                   05720000
057300              AND C.VER_STAT_CDE   = :PC-ACTIVE                   05730000
057400              AND A.PURITM_VER_NBR = B.VER_NBR                    05740000
057500              AND C.REC_SEQ_NBR    > 0                            05750000
057600              AND C.OPER_UNT_ID    = :DK-OPER-UNT-ID              05760000
057700              AND C.FCLTY_ID       = :DK-FCLTY-ID                 05770000
057800              AND D.ITM_NBR        = B.ITM_NBR                    05780000
057900       UNION                                                      05790000
058000           SELECT A.PKSL_LNE_NBR,                                 05800000
058100                  A.PKSL_ITM_QTY,                                 05810000
058200                  B.VEND_STYL_NAME,                               05820000
058300                  B.UNT_COST_AMT,                                 05830000
058400                  D.CSTM_CLOR_DESC,                               05840000
058500                  B.SKU_DESC,                                     05850000
058600                  B.SIZE_DESC,                                    05860000
058700                  C.PKSL_STAT_CDE,                                05870000
058800                  C.SEQ_NBR                                       05880000
058900             FROM TPKITEM A,                                      05890000
059000                  TPURITM B,                                      05900000
059100                  TPKSLIP C,                                      05910000
059200                  XLT_SKU D                                       05920000
059300            WHERE A.PO_NBR         = :DK-PO-NBR                   05930000
059400              AND B.PO_NBR         = :DK-PO-NBR                   05940000
059500              AND C.PO_NBR         = :DK-PO-NBR                   05950000
059600              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                05960000
059700                                 AND :DK-SEQ-NBR-E                05970000
059800              AND A.SEQ_NBR        = C.SEQ_NBR                    05980000
059900              AND A.PKSL_LNE_NBR   = B.APP_PO_LNE_NBR             05990000
060000              AND A.VER_STAT_CDE   = :PC-ACTIVE                   06000000
060100              AND B.VER_STATUS_CDE = :PC-ACTIVE                   06010000
060200              AND C.VER_STAT_CDE   = :PC-ACTIVE                   06020000
060300              AND C.REC_SEQ_NBR    = 0                            06030000
060400              AND C.OPER_UNT_ID    = :DK-OPER-UNT-ID              06040000
060500              AND C.FCLTY_ID       = :DK-FCLTY-ID                 06050000
060600              AND D.ITM_NBR        = B.ITM_NBR                    06060000
060700       UNION                                                      06070000
060800           SELECT A.PKSL_LNE_NBR,                                 06080000
060900                  A.PKSL_ITM_QTY,                                 06090000
061000                  A.VEND_STYL_NAME,                               06100000
061100                  A.UNT_COST_AMT,                                 06110000
061200                  A.COLOR_DESC,                                   06120000
061300                  A.VEND_DESC,                                    06130000
061400                  A.SIZE_DESC,                                    06140000
061500                  C.PKSL_STAT_CDE,                                06150000
061600                  C.SEQ_NBR                                       06160000
061700             FROM TUNPKSL A,                                      06170000
061800                  TPKSLIP C                                       06180000
061900            WHERE A.PO_NBR        = :DK-PO-NBR                    06190000
062000              AND C.PO_NBR        = :DK-PO-NBR                    06200000
062100              AND C.SEQ_NBR  BETWEEN :DK-SEQ-NBR-B                06210000
062200                                 AND :DK-SEQ-NBR-E                06220000
062300              AND A.SEQ_NBR       = C.SEQ_NBR                     06230000
062400              AND A.VER_STAT_CDE  = :PC-ACTIVE                    06240000
062500              AND C.VER_STAT_CDE  = :PC-ACTIVE                    06250000
062600              AND C.OPER_UNT_ID   = :DK-OPER-UNT-ID               06260000
062700              AND C.FCLTY_ID      = :DK-FCLTY-ID                  06270000
062800         ORDER BY 1                                               06280000
062900     END-EXEC.                                                    06290000
063000                                                                  06300000
063100******************************************************************06310000
063200*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      06320000
063300******************************************************************06330000
063400                                                                  06340000
063500 LINKAGE SECTION.                                                 06350000
063600                                                                  06360000
063700 01  DFHCOMMAREA.                                                 06370000
063800     05  FILLER                       OCCURS 1 TO 4072 TIMES      06380000
063900                                      DEPENDING ON EIBCALEN.      06390000
064000         10  FILLER                   PIC X.                      06400000
064100                                                                  06410000
064200                                                                  06420000
064300 PROCEDURE DIVISION.                                              06430000
064400                                                                  06440000
064500 0000-MAIN-MODULE.                                                06450000
064600                                                                  06460000
064700     INITIALIZE DP030-CICS-API-FIELDS.                            06470000
064800                                                                  06480000
064900     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         06490000
065000     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            06500000
065100     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           06510000
065200                                                                  06520000
065300     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         06530000
065400                                                                  06540000
065500     MOVE LENGTH OF RC215AI      TO DP030-MAP-LENGTH (1).         06550000
065600     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       06560000
065700                                                                  06570000
065800                                                                  06580000
065900     PERFORM 0001-CALL-CICS-ARCH-API.                             06590000
066000     PERFORM 1000-CONTROL-PROCESSING.                             06600000
066100                                                                  06610000
066200     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       06620000
066300                                                                  06630000
066400     PERFORM 0001-CALL-CICS-ARCH-API.                             06640000
066500                                                                  06650000
066600 0001-CALL-CICS-ARCH-API.                                         06660000
066700                                                                  06670000
066810     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06681006
066900                                    DFHCOMMAREA                   06690006
067000                                    DP030-CICS-API-FIELDS         06700006
067100                                    DP020-STANDARD-COMMAREA       06710006
067200                                    RC215AI.                      06720006
067300                                                                  06730000
067400     IF DP030-RC-CALL-SUCCESSFUL                                  06740000
067500         CONTINUE                                                 06750000
067600     ELSE                                                         06760000
067700         SET DP013-CICS-ABEND                                     06770000
067800             DP013-NO-ROLLBACK                                    06780000
067900             DP013-XCTL-DISPLAY-RESTART                           06790000
068000                                 TO TRUE                          06800000
068100         MOVE '0001-CALL-CICS-ARCH-API'                           06810000
068200                                 TO DP013-PARAGRAPH               06820000
068210         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O06821006
068220-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06822006
068500         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        06850000
068600                                                                  06860000
068700         PERFORM DP013-0000-PROCESS-ABEND.                        06870000
068800                                                                  06880000
068900 1000-CONTROL-PROCESSING.                                         06890000
069000                                                                  06900000
069100     EVALUATE TRUE                                                06910000
069200                                                                  06920000
069300         WHEN DP030-RC-APPL-ERROR                                 06930000
069400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06940000
069500                                 TO PV-TOP-ITEM                   06950000
069600              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06960000
069700                                                                  06970000
069800              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06980000
069900                                                                  06990000
070000              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07000000
070100                                                                  07010000
070200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07020000
070300                                                                  07030000
070400                                                                  07040000
070500         WHEN DP020-NEXT-ACT-INITIAL                              07050000
070600              INITIALIZE ASC-SPECIFIC-COMMAREA                    07060000
070700              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              07070000
070800                                    ASC-SEL-TERM-ID               07080000
070900              MOVE DP020-SRC-TASK-NUMBER                          07090000
071000                                 TO ASC-LIST-TASK-NUMBER          07100000
071100                                    ASC-SEL-TASK-NUMBER           07110000
071200              MOVE PC-LIST-QUEUE-SEQ                              07120000
071300                                 TO ASC-LIST-SEQ                  07130000
071400              MOVE PC-SEL-QUEUE-SEQ                               07140000
071500                                 TO ASC-SEL-SEQ                   07150000
071600                                                                  07160000
071700              SET PS-NO-ERROR    TO TRUE                          07170000
071800                                                                  07180000
071900              PERFORM 1100-PROCESS-INTER-APPL-COMM                07190000
072000                                                                  07200000
072100              IF PS-NO-ERROR                                      07210000
072200                  MOVE INTER-APPL-COMM-AREA                       07220000
072300                                    TO ASC-HOLD-INTER-APPL        07230000
072400                  PERFORM 4000-BUILD-INITIAL-PANEL                07240000
072500              END-IF                                              07250000
072600                                                                  07260000
072700         WHEN DP020-NEXT-ACT-READ-MAP                             07270000
072800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07280000
072900                                 TO PV-TOP-ITEM                   07290000
073000                                                                  07300000
073100              PERFORM 2000-PROCESS-PANEL                          07310000
073200                                                                  07320000
073300         WHEN DP020-NEXT-ACT-RETURN                               07330000
073400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07340000
073500                                 TO PV-TOP-ITEM                   07350000
073600              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07360000
073700              MOVE ASC-HOLD-INTER-APPL                            07370000
073800                                 TO INTER-APPL-COMM-AREA          07380000
073900*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     07390000
074000*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        07400000
074100*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      07410000
074200                                                                  07420000
074300              PERFORM 2050-DELETE-LIST-QUEUE                      07430000
074400              PERFORM 4000-BUILD-INITIAL-PANEL                    07440000
074500                                                                  07450000
074600                                                                  07460000
074700                                                                  07470000
074800         WHEN OTHER                                               07480000
074900              SET DP013-LOGIC-ABEND                               07490000
075000                  DP013-NO-ROLLBACK                               07500000
075100                                 TO TRUE                          07510000
075200              MOVE '1000-CONTROL-PROCESSING'                      07520000
075300                                 TO DP013-PARAGRAPH               07530000
075400              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   07540000
075500                                 TO DP013-MESSAGE-TEXT(1)         07550000
075600                                                                  07560000
075700              PERFORM DP013-0000-PROCESS-ABEND                    07570000
075800                                                                  07580000
075900     END-EVALUATE.                                                07590000
076000                                                                  07600000
076100 1100-PROCESS-INTER-APPL-COMM.                                    07610000
076200                                                                  07620000
076300     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       07630000
076400                                                                  07640000
076500     EVALUATE DP020-INT-APPL-FORMAT-IND                           07650000
076600         WHEN PC-INTER-APPL-MAINT                                 07660000
076700             MOVE RC012-OPER-UNT-ID                               07670000
076800                                 TO ASC-KEY-OPER-UNT-ID           07680000
076900                                    DK-OPER-UNT-ID                07690000
077000             MOVE RC012-FCLTY-ID TO ASC-KEY-FCLTY-ID              07700000
077100                                    DK-FCLTY-ID                   07710000
077200             MOVE RC012-PO-NBR   TO ASC-KEY-PO-NBR                07720000
077300                                    DK-PO-NBR                     07730000
077400             MOVE RC012-SEQ-NBR  TO ASC-KEY-SEQ-NBR               07740000
077500             MOVE RC012-REC-SEQ-NBR                               07750000
077600                                 TO ASC-KEY-REC-SEQ-NBR           07760000
077700                                    DK-REC-SEQ-NBR                07770000
077800             MOVE RC012-PKSL-NBR TO ASC-KEY-PKSL-NBR              07780000
077900             MOVE RC012-STR-NBR  TO ASC-KEY-STR-DEST-NBR          07790000
078000                                                                  07800000
078100         WHEN PC-INTER-APPL-LIST                                  07810000
078200             EVALUATE TRUE                                        07820000
078300                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS = ZERO       07830000
078400                     SET ASC-NO-TSQ-UPDATE                        07840000
078500                                 TO TRUE                          07850000
078600                     SET DP020-MSG-FATAL                          07860000
078700                         DP020-NEXT-ACT-APPL-ERROR                07870000
078800                         PS-ERROR                                 07880000
078900                                 TO TRUE                          07890000
079000                     MOVE PC-TSYMSG-00057                         07900000
079100                                 TO DP020-MSG-NUMBER              07910000
079200                                                                  07920000
079300                 WHEN RC015-NUMBER-OF-SELECTED-ITEMS > 1          07930000
079400                     SET ASC-NO-TSQ-UPDATE                        07940000
079500                                 TO TRUE                          07950000
079600                     SET DP020-MSG-FATAL                          07960000
079700                         DP020-NEXT-ACT-APPL-ERROR                07970000
079800                         PS-ERROR                                 07980000
079900                                 TO TRUE                          07990000
080000                     MOVE PC-TSYMSG-00047                         08000000
080100                                 TO DP020-MSG-NUMBER              08010000
080200                                                                  08020000
080300                 WHEN OTHER                                       08030000
080400                     SET ASC-USE-SELECTION-QUEUE                  08040000
080500                                 TO TRUE                          08050000
080600                     MOVE RC015-NUMBER-OF-SELECTED-ITEMS          08060000
080700                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  08070000
080800                     MOVE RC015-NUMBER-OF-TS-ITEMS                08080000
080900                                 TO ASC-NUMBER-OF-TS-ITEMS        08090000
081000                     MOVE RC015-SEL-QUEUE-NAME                    08100000
081100                                 TO ASC-SEL-QUEUE-NAME-IN         08110000
081200                     PERFORM 1120-PREPARE-LIST-ENTRY              08120000
081300         END-EVALUATE                                             08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081600*---------------------------------------------------------------* 08160000
081700*    ENTRY IS FROM A LIST.  GET THE KEYS FROM THE TEMP STORAGE  * 08170000
081800*    QUEUE PASSED FROM THE LIST.                                * 08180000
081900*---------------------------------------------------------------* 08190000
082000 1120-PREPARE-LIST-ENTRY.                                         08200000
082100     MOVE RC013-MAX-ITEMS           TO ASC-SEL-SUB.               08210000
082200     MOVE ZERO                      TO ASC-SEL-ITEM.              08220000
082300     MOVE RC015-PO-NBR              TO ASC-KEY-PO-NBR             08230000
082400                                       DK-PO-NBR.                 08240000
082500     MOVE RC015-OPER-UNT-ID         TO ASC-KEY-OPER-UNT-ID        08250000
082600                                       DK-OPER-UNT-ID.            08260000
082700     MOVE RC015-FCLTY-ID            TO ASC-KEY-FCLTY-ID           08270000
082800                                       DK-FCLTY-ID.               08280000
082900     PERFORM 2300-GET-NEXT-RECORD.                                08290000
083000                                                                  08300000
083100 2000-PROCESS-PANEL.                                              08310000
083200                                                                  08320000
083300     EVALUATE TRUE                                                08330000
083400                                                                  08340000
083500         WHEN DP020-SRC-AID = DP016-CLEAR                         08350000
083600              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      08360000
083700                                                                  08370000
083800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08380000
083900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08390000
084000                                                                  08400000
084100                                                                  08410000
084200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08420000
084300                                                                  08430000
084400              PERFORM 2050-DELETE-LIST-QUEUE                      08440000
084500              PERFORM 4000-BUILD-INITIAL-PANEL                    08450000
084600                                                                  08460000
084700                                                                  08470000
084800         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   08480000
084900                                                                  08490000
085000              PERFORM 2140-DESELECT-ALL-ITEMS                     08500000
085100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08510000
085200                                                                  08520000
085300                                                                  08530000
085400         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 08540000
085500                                                                  08550000
085600              PERFORM 2150-SELECT-ALL-ITEMS                       08560000
085700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08570000
085800                                                                  08580000
085900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08590000
086000             IF ASC-USE-SELECTION-QUEUE                           08600000
086100                 PERFORM 6200-DEL-LIST-QUEUE                      08610000
086200                 PERFORM 2300-GET-NEXT-RECORD                     08620000
086300                 PERFORM 4000-BUILD-INITIAL-PANEL                 08630000
086400                 PERFORM 3200-RESET-ATTRIBUTES                    08640000
086500             ELSE                                                 08650000
086600*                --- BOTTOM OF LIST ---                           08660000
086700                 MOVE PC-TSYMSG-00070                             08670000
086800                                   TO DP020-MSG-NUMBER            08680000
086900                 SET DP020-MSG-INFORMATIONAL                      08690000
087000                                   TO TRUE                        08700000
087100             END-IF                                               08710000
087200                                                                  08720000
087300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08730000
087400             IF ASC-USE-SELECTION-QUEUE                           08740000
087500                 PERFORM 6200-DEL-LIST-QUEUE                      08750000
087600                 PERFORM 2310-GET-PREV-RECORD                     08760000
087700                 PERFORM 4000-BUILD-INITIAL-PANEL                 08770000
087800                 PERFORM 3200-RESET-ATTRIBUTES                    08780000
087900             ELSE                                                 08790000
088000*                --- TOP OF LIST ---                              08800000
088100                 MOVE PC-TSYMSG-00069                             08810000
088200                                   TO DP020-MSG-NUMBER            08820000
088300                 SET DP020-MSG-INFORMATIONAL                      08830000
088400                                   TO TRUE                        08840000
088500             END-IF                                               08850000
088600                                                                  08860000
088700         WHEN OTHER                                               08870000
088800                                                                  08880000
088900              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                08890000
089000              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08900000
089100                                                                  08910000
089200              IF PS-NO-ERROR                                      08920000
089300                  SET DP030-CONTINUE-GO                           08930000
089400                                 TO TRUE                          08940000
089500                                                                  08950000
089600                  PERFORM 2100-CHECK-FUNCTION-KEY                 08960000
089700              ELSE                                                08970000
089800                  SET DP030-OVERRIDE-GO                           08980000
089900                                 TO TRUE                          08990000
090000              END-IF                                              09000000
090100                                                                  09010000
090200     END-EVALUATE.                                                09020000
090300                                                                  09030000
090400 2050-DELETE-LIST-QUEUE.                                          09040000
090500                                                                  09050000
090600     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             09060000
090700                          RESP  (PV-CICS-RESP)                    09070000
090800                          END-EXEC.                               09080000
090900                                                                  09090000
091000     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      09100000
091100        (PV-CICS-RESP = DFHRESP (QIDERR))                         09110000
091200         CONTINUE                                                 09120000
091300     ELSE                                                         09130000
091400         SET DP013-CICS-ABEND                                     09140000
091500             DP013-NO-ROLLBACK   TO TRUE                          09150000
091600         MOVE '2050-DELETE-LIST-QUEUE'                            09160000
091700                                 TO DP013-PARAGRAPH               09170000
091800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 09180000
091900                                 TO DP013-MESSAGE-TEXT (1)        09190000
092000                                                                  09200000
092100         PERFORM DP013-0000-PROCESS-ABEND.                        09210000
092200                                                                  09220000
092300     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    09230000
092400                                                                  09240000
092500 2100-CHECK-FUNCTION-KEY.                                         09250000
092600                                                                  09260000
092700     EVALUATE TRUE                                                09270000
092800*F24 CARTON LIST (SUKCS555)                                       09280000
092900         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               09290000
093000             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               09300000
093100                 PERFORM 2101-REAL-PFKEY-CHECK                    09310000
093200             ELSE                                                 09320000
093300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09330000
093400                 SET DP030-OVERRIDE-GO                            09340000
093500                                   TO TRUE                        09350000
093600                 MOVE PC-TSYMSG-00057                             09360000
093700                                   TO DP020-MSG-NUMBER            09370000
093800                 SET DP020-MSG-WARNING                            09380000
093900                                   TO TRUE                        09390000
094000             END-IF                                               09400000
094100         WHEN OTHER                                               09410000
094200*DC-154 FROM HERE                                                 09420000
094300           IF  ASC-KEY-PKSL-STAT-CDE = PC-AC AND                  09430000
094400                  (DP020-SRC-AID EQUAL DP016-PF13                 09440000
094500               OR  DP020-SRC-AID EQUAL DP016-PF15                 09450000
094600               OR  DP020-SRC-AID EQUAL DP016-PF17                 09460000
094700               OR  DP020-SRC-AID EQUAL DP016-PF21                 09470000
094800               OR  DP020-SRC-AID EQUAL DP016-PF23)                09480000
094900                   MOVE PC-TSYMSG-00966                           09490000
095000                                       TO DP020-MSG-NUMBER        09500000
095100                   SET PS-ERROR                                   09510000
095200                       DP030-OVERRIDE-GO                          09520000
095300                       DP020-MSG-FATAL TO  TRUE                   09530000
095400           ELSE                                                   09540000
095500               IF  ASC-READ-ONLY                                  09550000
095600                   IF (DP020-SRC-AID EQUAL DP016-PF13             09560000
095700                   OR  DP020-SRC-AID EQUAL DP016-PF15             09570000
095800                   OR  DP020-SRC-AID EQUAL DP016-PF16             09580000
095900                   OR  DP020-SRC-AID EQUAL DP016-PF23)            09590000
096000                       MOVE PC-TSYMSG-00966                       09600000
096100                                       TO DP020-MSG-NUMBER        09610000
096200                       SET PS-ERROR                               09620000
096300                           DP030-OVERRIDE-GO                      09630000
096400                           DP020-MSG-FATAL TO  TRUE               09640000
096500                   ELSE                                           09650000
096600                       IF ASC-KEY-OPER-UNT-ID = PC-0              09660000
096700                       AND (DP020-SRC-AID EQUAL DP016-PF17        09670000
096800                       OR   DP020-SRC-AID EQUAL DP016-PF21        09680000
096900                       OR   DP020-SRC-AID EQUAL DP016-PF22        09690000
097000                       OR   DP020-SRC-AID EQUAL DP016-PF23)       09700000
097100                           MOVE PC-TSYMSG-00815                   09710000
097200                                           TO DP020-MSG-NUMBER    09720000
097300                           SET PS-ERROR                           09730000
097400                               DP030-OVERRIDE-GO                  09740000
097500                               DP020-MSG-FATAL TO  TRUE           09750000
097600                       ELSE                                       09760000
097700                           PERFORM 2101-REAL-PFKEY-CHECK          09770000
097800                       END-IF                                     09780000
097900                   END-IF                                         09790000
098000               ELSE                                               09800000
098100                   IF ASC-KEY-OPER-UNT-ID = PC-0                  09810000
098200                   AND (DP020-SRC-AID EQUAL DP016-PF17            09820000
098300                   OR   DP020-SRC-AID EQUAL DP016-PF21            09830000
098400                   OR   DP020-SRC-AID EQUAL DP016-PF22            09840000
098500                   OR   DP020-SRC-AID EQUAL DP016-PF23)           09850000
098600                       MOVE PC-TSYMSG-00815                       09860000
098700                                       TO DP020-MSG-NUMBER        09870000
098800                       SET PS-ERROR                               09880000
098900                           DP030-OVERRIDE-GO                      09890000
099000                           DP020-MSG-FATAL TO  TRUE               09900000
099100                   ELSE                                           09910000
099200                     IF  DP020-SRC-AID EQUAL DP016-PF15           09920000
099300                     OR  DP020-SRC-AID EQUAL DP016-PF16           09930000
099400                       IF ASC-NO-RECEIVER-FOUND AND               09940000
099500                          ASC-KEY-STR-DEST-NBR > 0                09950000
099600                           PERFORM 2102-PBS-CHECK                 09960000
099700                       END-IF                                     09970000
099800                       IF (ASC-RECEIVER-FOUND AND                 09980000
099900                           ASC-PACK-BY-ST-IND = 'Y') OR           09990000
100000                           PS-PBS-ORDER                           10000000
100100                                                                  10010000
100200                           PERFORM 2104-CHK-PKSL-ORIGIN           10020000
100300                           IF PS-ORIG-ASN-PKSLIP-YES              10030000
100400                              PERFORM 2103-CHECK-INACTV-PBS       10040000
100500                              IF PV-PBS-COUNT = 0                 10050000
100600                                  MOVE PC-TSYMSG-03249            10060000
100700                                               TO DP020-MSG-NUMBER10070000
100800                                  SET PS-ERROR                    10080000
100900                                      DP030-OVERRIDE-GO           10090000
101000                                      DP020-MSG-FATAL TO  TRUE    10100000
101100                              END-IF                              10110000
101200                           ELSE                                   10120000
101300                               IF PS-FREE-ASTRAY-SLIP-YES         10130000
101400                                  MOVE PC-TSYMSG-03348            10140000
101500                                               TO DP020-MSG-NUMBER10150000
101600                                  SET PS-ERROR                    10160000
101700                                      DP030-OVERRIDE-GO           10170000
101800                                      DP020-MSG-FATAL TO  TRUE    10180000
101900                               END-IF                             10190000
102000                           END-IF                                 10200000
102100                       END-IF                                     10210000
102200                     END-IF                                       10220000
102300                     PERFORM 2101-REAL-PFKEY-CHECK                10230000
102400                   END-IF                                         10240000
102500               END-IF                                             10250000
102600           END-IF                                                 10260000
102700*DC-154 TO HERE                                                   10270000
102800     END-EVALUATE.                                                10280000
102900                                                                  10290000
103000                                                                  10300000
103100 2101-REAL-PFKEY-CHECK.                                           10310000
103200                                                                  10320000
103300     EVALUATE TRUE                                                10330000
103400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID) OR              10340000
103500              DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               10350000
103600             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    10360000
103700                                 TO RC015-NUMBER-OF-SELECTED-ITEMS10370000
103800             MOVE ASC-KEY-PO-NBR                                  10380000
103900                                 TO RC015-PO-NBR                  10390000
104000             MOVE ASC-KEY-PKSL-NBR                                10400000
104100                                 TO RC015-PKSL-NBR                10410000
104200             MOVE ASC-KEY-REC-SEQ-NBR                             10420000
104300                                 TO RC015-REC-SEQ-NBR             10430000
104400             MOVE ASC-KEY-SEQ-NBR                                 10440000
104500                                 TO RC015-SEQ-NBR                 10450000
104600             MOVE ASC-KEY-OPER-UNT-ID                             10460000
104700                                 TO RC015-OPER-UNT-ID             10470000
104800             MOVE ASC-KEY-FCLTY-ID                                10480000
104900                                 TO RC015-FCLTY-ID                10490000
105000             MOVE ASC-KEY-STR-DEST-NBR                            10500000
105100                                 TO RC015-STR-NBR                 10510000
105200             IF DP020-FK-INT-APPL-FORMAT-IND(DP020-SRC-AID)       10520000
105300                                 = '1'                            10530000
105400                 MOVE 'Y'      TO RC015-DISPLAY-Z-OTR             10540000
105500             ELSE                                                 10550000
105600                MOVE 'N'      TO RC015-DISPLAY-Z-OTR              10560000
105700             END-IF                                               10570000
105800             PERFORM 5000-PREPARE-SEL-QUEUE                       10580000
105900                                                                  10590000
106000         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 10600000
106100             MOVE +1             TO PV-TOP-ITEM                   10610000
106200                                                                  10620000
106300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10630000
106400             PERFORM 3200-RESET-ATTRIBUTES                        10640000
106500                                                                  10650000
106600                                                                  10660000
106700         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  10670000
106800                                                                  10680000
106900             PERFORM 2110-BROWSE-BACKWARD                         10690000
107000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10700000
107100             PERFORM 3200-RESET-ATTRIBUTES                        10710000
107200                                                                  10720000
107300                                                                  10730000
107400         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  10740000
107500                                                                  10750000
107600             PERFORM 2120-BROWSE-FORWARD                          10760000
107700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10770000
107800             PERFORM 3200-RESET-ATTRIBUTES                        10780000
107900                                                                  10790000
108000                                                                  10800000
108100         WHEN DP020-SRC-AID = DP016-ENTER                         10810000
108200                                                                  10820000
108300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10830000
108400                                                                  10840000
108500             IF PS-NO-ERROR                                       10850000
108600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10860000
108700             END-IF                                               10870000
108800                                                                  10880000
108900                                                                  10890000
109000         WHEN OTHER                                               10900000
109100             SET DP013-CICS-ABEND                                 10910000
109200                 DP013-NO-ROLLBACK                                10920000
109300                 DP013-XCTL-DISPLAY-RESTART                       10930000
109400                                 TO TRUE                          10940000
109500             MOVE '2100-CHECK-FUNCTION-KEY'                       10950000
109600                                 TO DP013-PARAGRAPH               10960000
109700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10970000
109800                                 TO DP013-MESSAGE-TEXT (1)        10980000
109900                                                                  10990000
110000             PERFORM DP013-0000-PROCESS-ABEND                     11000000
110100     END-EVALUATE.                                                11010000
110200                                                                  11020000
110300 2102-PBS-CHECK.                                                  11030000
110400                                                                  11040000
110500     INITIALIZE XL071-COMMAREA-REC.                               11050000
110600     MOVE ASC-KEY-STR-DEST-NBR  TO XL071-LOCATION-NUMBER.         11060000
110700                                                                  11070000
110800     CALL PC-LOCATION-MODULE  USING                               11080000
110900                                    DFHEIBLK                      11090000
111000                                    XL071-COMMAREA                11100000
111100                                    XL071-COMMAREA-REC.           11110000
111200                                                                  11120000
111300                                                                  11130000
111400     IF XL071-BAD-DB2-RETURN                                      11140000
111500         MOVE '2102-PBS-CHECK'                                    11150000
111600                                 TO DP013-PARAGRAPH               11160000
111700         MOVE 'CALL LOCATION MOD '                                11170000
111800                                 TO DP013-MESSAGE-TEXT (1)        11180000
111900         MOVE XL071-SQLCA    TO SQLCA                             11190000
112000         MOVE SQLCA          TO DP013-SQLCA                       11200000
112100         MOVE 'XLT00010'     TO DP013-DB2-TABLE-NAME (1)          11210000
112200         SET DP013-DB2-ABEND TO TRUE                              11220000
112300         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   11230000
112400         PERFORM DP013-0000-PROCESS-ABEND                         11240000
112500     END-IF.                                                      11250000
112600     IF XL071-LOC-TYP-CDE = 'DS'                                  11260000
112700         SET PS-PBS-ORDER      TO TRUE                            11270000
112800     ELSE                                                         11280000
112900         SET PS-NOT-PBS-ORDER  TO TRUE                            11290000
113000     END-IF.                                                      11300000
113100                                                                  11310000
113200 2103-CHECK-INACTV-PBS.                                           11320000
113300                                                                  11330000
113400     MOVE 0    TO PV-PBS-COUNT.                                   11340000
113500     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    11350000
113600     MOVE ASC-KEY-SEQ-NBR        TO DK-SEQ-NBR-B.                 11360000
113700                                                                  11370000
113800     EXEC SQL                                                     11380000
113900         SELECT  COUNT(*)                                         11390000
114000         INTO   :PV-PBS-COUNT                                     11400000
114100         FROM   TSHUNLO A                                         11410000
114200             ,  TPKSLIP B                                         11420000
114300             ,  TINPKSU C                                         11430000
114400         WHERE  A.SCN_LOC_ID                                      11440000
114500                       IN ('PBSA','PBSB','PBSC','PBSD','PBSE')    11450000
114600           AND  A.SHIPT_UNT_ID = C.SHIPT_UNT_ID                   11460000
114700           AND  B.PO_NBR       = :DK-PO-NBR                       11470000
114800           AND  B.SEQ_NBR      = :DK-SEQ-NBR-B                    11480000
114900           AND  B.PO_NBR       = C.PO_NBR                         11490000
115000           AND  B.SEQ_NBR      = C.SEQ_NBR                        11500000
115100           AND  B.VER_STAT_CDE = 'A'                              11510000
115200     END-EXEC.                                                    11520000
115300                                                                  11530000
115400     EVALUATE TRUE                                                11540000
115500         WHEN SQLCODE = ZERO                                      11550000
115600              CONTINUE                                            11560000
115700         WHEN SQLCODE = -904                                      11570000
115800         WHEN SQLCODE = -911                                      11580000
115900         WHEN SQLCODE = -913                                      11590000
116000              PERFORM 9900-SOFT-ABORT                             11600000
116100                                                                  11610000
116200         WHEN SQLWARN0 NOT = SPACES                               11620000
116300         WHEN SQLCODE  NOT = ZERO                                 11630000
116400              MOVE '2103-CHECK-INACTV-PBS'                        11640000
116500                             TO DP013-PARAGRAPH                   11650000
116600              MOVE 'UNSUCCESSFUL SELECT OF PACKSLIP'              11660000
116700                             TO DP013-MESSAGE-TEXT (1)            11670000
116800              MOVE SQLCA     TO DP013-SQLCA                       11680000
116900              MOVE 'TSHUNLO' TO DP013-DB2-TABLE-NAME (1)          11690000
117000              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          11700000
117100              MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (1)          11710000
117200              SET DP013-DB2-ABEND                                 11720000
117300                  DP013-XCTL-DISPLAY-RESTART                      11730000
117400                             TO TRUE                              11740000
117500                                                                  11750000
117600              PERFORM DP013-0000-PROCESS-ABEND                    11760000
117700     END-EVALUATE.                                                11770000
117800                                                                  11780000
117900******************************************************************11790000
118000**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **11800000
118100******************************************************************11810000
118200 2104-CHK-PKSL-ORIGIN.                                            11820000
118300                                                                  11830000
118400     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    11840000
118500                                                                  11850000
118600         EXEC SQL                                                 11860000
118700           SELECT A.CRE_UID                                       11870000
118800              ,   A.PKSL_NBR                                      11880000
118900           INTO  :PKSLIP-CRE-UID                                  11890000
119000             ,   :PKSLIP-PKSL-NBR                                 11900000
119100           FROM   TPKSLIP A                                       11910000
119200           WHERE  A.PO_NBR       = :DK-PO-NBR                     11920000
119300             AND  A.SEQ_NBR      = :ASC-KEY-SEQ-NBR               11930000
119400             AND  A.CRE_TMST =                                    11940000
119500                (SELECT MIN(CRE_TMST)                             11950000
119600                  FROM   TPKSLIP B                                11960000
119700                  WHERE A.PO_NBR = B.PO_NBR                       11970000
119800                  AND   A.SEQ_NBR = B.SEQ_NBR)                    11980000
119900         END-EXEC.                                                11990000
120000                                                                  12000000
120100         EVALUATE TRUE                                            12010000
120200             WHEN SQLCODE = ZERO                                  12020000
120300                  IF PKSLIP-CRE-UID = PC-RCKUP006                 12030000
120400                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          12040000
120500                  END-IF                                          12050000
120600                  IF PKSLIP-PKSL-NBR = PC-FA-SYTM                 12060000
120700                     SET PS-FREE-ASTRAY-SLIP-YES  TO TRUE         12070000
120800                  END-IF                                          12080000
120900             WHEN SQLCODE = +100                                  12090000
121000                  CONTINUE                                        12100000
121100             WHEN SQLCODE = -904                                  12110000
121200             WHEN SQLCODE = -911                                  12120000
121300             WHEN SQLCODE = -913                                  12130000
121400                  CONTINUE                                        12140000
121500                                                                  12150000
121600             WHEN SQLWARN0 NOT = SPACES                           12160000
121700             WHEN SQLCODE  NOT = ZERO                             12170000
121800                  MOVE '2104-CHK-PKSL-ORIGIN'                     12180000
121900                                   TO DP013-PARAGRAPH             12190000
122000                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          12200000
122100                                   TO DP013-MESSAGE-TEXT (1)      12210000
122200                  MOVE SQLCA       TO DP013-SQLCA                 12220000
122300                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    12230000
122400                  SET DP013-DB2-ABEND                             12240000
122500                      DP013-XCTL-DISPLAY-RESTART                  12250000
122600                                   TO TRUE                        12260000
122700                  PERFORM DP013-0000-PROCESS-ABEND                12270000
122800         END-EVALUATE.                                            12280000
122900                                                                  12290000
123000/                                                                 12300000
123100 2110-BROWSE-BACKWARD.                                            12310000
123200                                                                  12320000
123300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12330000
123400         GIVING PV-TOP-ITEM.                                      12340000
123500                                                                  12350000
123600     IF PV-TOP-ITEM NOT > +1                                      12360000
123700         MOVE +1                 TO PV-TOP-ITEM                   12370000
123800         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              12380000
123900         SET DP020-MSG-INFORMATIONAL                              12390000
124000                                 TO TRUE.                         12400000
124100                                                                  12410000
124200 2120-BROWSE-FORWARD.                                             12420000
124300                                                                  12430000
124400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12440000
124500         GIVING PV-TOP-ITEM.                                      12450000
124600                                                                  12460000
124700     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    12470000
124800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12480000
124900                                 TO PV-TOP-ITEM                   12490000
125000         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              12500000
125100         SET DP020-MSG-INFORMATIONAL                              12510000
125200                                 TO TRUE                          12520000
125300     ELSE                                                         12530000
125400         COMPUTE PV-BOTTOM-ITEM =                                 12540000
125500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12550000
125600         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             12560000
125700             MOVE PC-TSYMSG-00070                                 12570000
125800                                 TO DP020-MSG-NUMBER              12580000
125900             SET DP020-MSG-INFORMATIONAL                          12590000
126000                                 TO TRUE.                         12600000
126100                                                                  12610000
126200 2130-CHECK-FOR-JUMP-BROWSE.                                      12620000
126300                                                                  12630000
126400     SET PS-NO-ERROR             TO TRUE.                         12640000
126500                                                                  12650000
126600     IF ASC-KEY-SEARCH-STYLE > SPACES                             12660000
126700         PERFORM 2400-CHECK-FOR-SEARCH-STYLE                      12670000
126800     END-IF.                                                      12680000
126900                                                                  12690000
127000     IF ASC-START-ITEM-REQUEST = SPACE                            12700000
127100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12710000
127200                                 TO PV-TOP-ITEM                   12720000
127300     ELSE                                                         12730000
127400         MOVE ASC-START-ITEM-REQUEST                              12740000
127500                                 TO DP010I-UNEDITED-FIELD         12750000
127600         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         12760000
127700         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       12770000
127800         SET DP010I-NEGATIVE-NOT-ALLOWED                          12780000
127900                                 TO TRUE                          12790000
128000                                                                  12800000
128110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12811005
128120              USING DP010I-NUMERIC-EDIT-AREA                      12812005
128200                                                                  12820000
128300         IF NOT DP010I-ERROR-DETECTED                             12830000
128400             MOVE DP010I-NUMERIC-FIELD                            12840000
128500                                 TO ASC-START-ITEM-REQUEST-N      12850000
128600             IF ASC-START-ITEM-REQUEST-N > ZERO                   12860000
128700                IF ASC-START-ITEM-REQUEST-N >                     12870000
128800                                          ASC-NUMBER-OF-ITEMS-READ12880000
128900                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        12890000
129000                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ12900000
129100                                          - PC-ITEMS-PER-PANEL + 112910000
129200                    IF PV-TOP-ITEM < +1                           12920000
129300                        MOVE +1  TO PV-TOP-ITEM                   12930000
129400                        MOVE PC-TSYMSG-00070                      12940000
129500                                 TO DP020-MSG-NUMBER              12950000
129600                        SET DP020-MSG-INFORMATIONAL               12960000
129700                                 TO TRUE                          12970000
129800                    END-IF                                        12980000
129900                ELSE                                              12990000
130000                    MOVE ASC-START-ITEM-REQUEST-N                 13000000
130100                                 TO PV-TOP-ITEM                   13010000
130200                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        13020000
130300                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        13030000
130400                                            PC-ITEMS-PER-PANEL - 113040000
130500                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  13050000
130600                         MOVE PC-TSYMSG-00070                     13060000
130700                                 TO DP020-MSG-NUMBER              13070000
130800                         SET DP020-MSG-INFORMATIONAL              13080000
130900                                 TO TRUE                          13090000
131000                    END-IF                                        13100000
131100                END-IF                                            13110000
131200             ELSE                                                 13120000
131300                 MOVE PC-TSYMSG-00101                             13130000
131400                                 TO DP020-MSG-NUMBER              13140000
131500                 SET DP030-SET-CURSOR-APPL-1                      13150000
131600                                 TO TRUE                          13160000
131700                 MOVE -1         TO ASTRTITL                      13170000
131800                 MOVE DP015-UNP-NUM-BRT-MDT                       13180000
131900                                 TO ASTRTITA                      13190000
132000                 MOVE DP015-RED  TO ASTRTITC                      13200000
132100                 MOVE DP015-REVERSE                               13210000
132200                                 TO ASTRTITH                      13220000
132300                 SET PS-ERROR                                     13230000
132400                     DP020-MSG-FATAL                              13240000
132500                                 TO TRUE                          13250000
132600             END-IF                                               13260000
132700         ELSE                                                     13270000
132800             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             13280000
132900             SET DP030-SET-CURSOR-APPL-1                          13290000
133000                                 TO TRUE                          13300000
133100             MOVE -1             TO ASTRTITL                      13310000
133200             MOVE DP015-UNP-NUM-BRT-MDT                           13320000
133300                                 TO ASTRTITA                      13330000
133400             MOVE DP015-RED      TO ASTRTITC                      13340000
133500             MOVE DP015-REVERSE  TO ASTRTITH                      13350000
133600             SET PS-ERROR                                         13360000
133700                 DP020-MSG-FATAL TO TRUE                          13370000
133800         END-IF                                                   13380000
133900     END-IF.                                                      13390000
134000                                                                  13400000
134100 2140-DESELECT-ALL-ITEMS.                                         13410000
134200                                                                  13420000
134300     MOVE +1                     TO ASC-BLK-SUB.                  13430000
134400                                                                  13440000
134500     PERFORM 2141-CLEAR-SELECTED-INDS                             13450000
134600             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13460000
134700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13470000
134800                                                                  13480000
134900     ADD +1                      TO ASC-BLK-SUB.                  13490000
135000                                                                  13500000
135100     PERFORM 2141-CLEAR-SELECTED-INDS                             13510000
135200             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13520000
135300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13530000
135400                                                                  13540000
135500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              13550000
135600                                 TO PV-LIST-ITEM-NUMBER.          13560000
135700                                                                  13570000
135800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13580000
135900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).13590000
136000                                                                  13600000
136100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13610000
136200              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13620000
136300         MOVE +1                 TO ASC-BLK-SUB                   13630000
136400                                                                  13640000
136500         PERFORM 5100-WRITE-TEMP-STORAGE                          13650000
136600                                                                  13660000
136700         MOVE +1                 TO PV-BLOCK-NUMBER               13670000
136800                                                                  13680000
136900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13690000
137000                                       PV-FIRST-BLOCK-IN-ARRAY - 113700000
137100                                                                  13710000
137200         PERFORM                                                  13720000
137300           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         13730000
137400                                                                  13740000
137500                 PERFORM 4410-READ-TEMP-STORAGE                   13750000
137600                                                                  13760000
137700                 PERFORM 2141-CLEAR-SELECTED-INDS                 13770000
137800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13780000
137900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13790000
138000                                                                  13800000
138100                 PERFORM 5100-WRITE-TEMP-STORAGE                  13810000
138200                                                                  13820000
138300                 ADD +1          TO PV-BLOCK-NUMBER               13830000
138400                                                                  13840000
138500         END-PERFORM                                              13850000
138600                                                                  13860000
138700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13870000
138800                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY13880000
138900                                                                  13890000
139000         PERFORM                                                  13900000
139100           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         13910000
139200                                         ASC-HIGHEST-BLOCK-WRITTEN13920000
139300                                                                  13930000
139400                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      13940000
139500                                 TO PV-BLOCK-NUMBER               13950000
139600                                                                  13960000
139700                 PERFORM 4410-READ-TEMP-STORAGE                   13970000
139800                                                                  13980000
139900                 PERFORM 2141-CLEAR-SELECTED-INDS                 13990000
140000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14000000
140100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14010000
140200                                                                  14020000
140300                 PERFORM 5100-WRITE-TEMP-STORAGE                  14030000
140400                                                                  14040000
140500                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        14050000
140600                                                                  14060000
140700         END-PERFORM                                              14070000
140800                                                                  14080000
140900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14090000
141000                                 TO PV-BLOCK-NUMBER               14100000
141100                                                                  14110000
141200         PERFORM 4410-READ-TEMP-STORAGE                           14120000
141300                                                                  14130000
141400     END-IF.                                                      14140000
141500                                                                  14150000
141600     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  14160000
141700                                    ASC-START-OF-SELECTED-RANGE   14170000
141800                                    ASC-END-OF-SELECTED-RANGE.    14180000
141900                                                                  14190000
142000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14200000
142100                                                                  14210000
142200 2141-CLEAR-SELECTED-INDS.                                        14220000
142300                                                                  14230000
142400     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO14240000
142500        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           14250000
142600            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          14260000
142700                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     14270000
142800                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  14280000
142900                                 TO TRUE.                         14290000
143000                                                                  14300000
143100 2150-SELECT-ALL-ITEMS.                                           14310000
143200                                                                  14320000
143300     MOVE +1                     TO ASC-BLK-SUB.                  14330000
143400                                                                  14340000
143500     PERFORM 2151-SET-SELECTED-INDS                               14350000
143600             VARYING ASC-ITEM-SUB FROM 1 BY 1                     14360000
143700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14370000
143800                                                                  14380000
143900     ADD +1                      TO ASC-BLK-SUB.                  14390000
144000                                                                  14400000
144100     PERFORM 2151-SET-SELECTED-INDS                               14410000
144200             VARYING ASC-ITEM-SUB FROM 1 BY 1                     14420000
144300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14430000
144400                                                                  14440000
144500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              14450000
144600                                 TO PV-LIST-ITEM-NUMBER.          14460000
144700                                                                  14470000
144800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14480000
144900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).14490000
145000                                                                  14500000
145100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14510000
145200              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)14520000
145300         MOVE +1                 TO ASC-BLK-SUB                   14530000
145400                                                                  14540000
145500         PERFORM 5100-WRITE-TEMP-STORAGE                          14550000
145600                                                                  14560000
145700         MOVE +1                 TO PV-BLOCK-NUMBER               14570000
145800                                                                  14580000
145900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14590000
146000                                       PV-FIRST-BLOCK-IN-ARRAY - 114600000
146100                                                                  14610000
146200         PERFORM                                                  14620000
146300           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         14630000
146400                                                                  14640000
146500                 PERFORM 4410-READ-TEMP-STORAGE                   14650000
146600                                                                  14660000
146700                 PERFORM 2151-SET-SELECTED-INDS                   14670000
146800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14680000
146900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14690000
147000                                                                  14700000
147100                 PERFORM 5100-WRITE-TEMP-STORAGE                  14710000
147200                                                                  14720000
147300                 ADD +1          TO PV-BLOCK-NUMBER               14730000
147400                                                                  14740000
147500         END-PERFORM                                              14750000
147600                                                                  14760000
147700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14770000
147800                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY14780000
147900                                                                  14790000
148000         PERFORM                                                  14800000
148100           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         14810000
148200                                         ASC-HIGHEST-BLOCK-WRITTEN14820000
148300                                                                  14830000
148400                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      14840000
148500                                 TO PV-BLOCK-NUMBER               14850000
148600                                                                  14860000
148700                 PERFORM 4410-READ-TEMP-STORAGE                   14870000
148800                                                                  14880000
148900                 PERFORM 2151-SET-SELECTED-INDS                   14890000
149000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14900000
149100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14910000
149200                                                                  14920000
149300                 PERFORM 5100-WRITE-TEMP-STORAGE                  14930000
149400                                                                  14940000
149500                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        14950000
149600                                                                  14960000
149700         END-PERFORM                                              14970000
149800                                                                  14980000
149900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14990000
150000                                 TO PV-BLOCK-NUMBER               15000000
150100                                                                  15010000
150200         PERFORM 4410-READ-TEMP-STORAGE                           15020000
150300     END-IF.                                                      15030000
150400                                                                  15040000
150500     MOVE ASC-NUMBER-OF-ITEMS-READ                                15050000
150600                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 15060000
150700                                                                  15070000
150800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15080000
150900                                                                  15090000
151000 2151-SET-SELECTED-INDS.                                          15100000
151100                                                                  15110000
151200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO15120000
151300        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              15130000
151400            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             15140000
151500                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15150000
151600                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  15160000
151700                                 TO TRUE                          15170000
151800        END-IF                                                    15180000
151900     END-IF.                                                      15190000
152000                                                                  15200000
152100 2200-MOVE-SCREEN-TO-COMMAREA.                                    15210000
152200                                                                  15220000
152300     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               15230000
152400     MOVE +1                     TO PV-SUB.                       15240000
152500                                                                  15250000
152600     PERFORM 3100-SET-SUBSCRIPTS.                                 15260000
152700                                                                  15270000
152800     IF ASTYLEL > ZERO                                            15280000
152900         MOVE ASTYLEI            TO ASC-KEY-SEARCH-STYLE          15290000
153000     ELSE                                                         15300000
153100         IF ASTYLEF = DP015-ERASE-EOF                             15310000
153200             MOVE SPACES         TO ASC-KEY-SEARCH-STYLE          15320000
153300         END-IF                                                   15330000
153400     END-IF.                                                      15340000
153500                                                                  15350000
153600     IF ASTRTITL > ZERO                                           15360000
153700         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        15370000
153800     ELSE                                                         15380000
153900         IF ASTRTITF = DP015-ERASE-EOF                            15390000
154000             INITIALIZE ASC-START-ITEM-REQUEST                    15400000
154100         END-IF                                                   15410000
154200     END-IF.                                                      15420000
154300                                                                  15430000
154400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15440000
154500             VARYING PV-SUB  FROM 1 BY 1                          15450000
154600             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                15460000
154700                                                                  15470000
154800 2210-MOVE-LINES-TO-COMMAREA.                                     15480000
154900                                                                  15490000
155000     IF MR-SELECTL (PV-SUB) > ZERO                                15500000
155100         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  15510000
155200                                 TO TRUE                          15520000
155300         MOVE MR-SELECTI (PV-SUB)                                 15530000
155400                                 TO ASC-TEMP-SELECTED-SW          15540000
155500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     15550000
155600     ELSE                                                         15560000
155700         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 15570000
155800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15580000
155900                                 TO TRUE                          15590000
156000             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          15600000
156100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     15610000
156200         END-IF                                                   15620000
156300     END-IF.                                                      15630000
156400                                                                  15640000
156500     ADD +1                      TO ASC-ITEM-SUB.                 15650000
156600                                                                  15660000
156700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15670000
156800         ADD  +1                 TO ASC-BLK-SUB                   15680000
156900         MOVE +1                 TO ASC-ITEM-SUB                  15690000
157000     END-IF.                                                      15700000
157100                                                                  15710000
157200******************************************************************15720000
157300* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *15730000
157400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15740000
157500******************************************************************15750000
157600 2300-GET-NEXT-RECORD.                                            15760000
157700                                                                  15770000
157800     ADD +1                        TO ASC-SEL-SUB.                15780000
157900                                                                  15790000
158000     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             15800000
158100         ADD +1                    TO ASC-SEL-ITEM                15810000
158200         MOVE +1                   TO ASC-SEL-SUB                 15820000
158300     END-IF.                                                      15830000
158400                                                                  15840000
158500     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 15850000
158600         PERFORM 9100-READ-SEL-QUEUE                              15860000
158700         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       15870000
158800             MOVE RC013-PKSL-NBR     (ASC-SEL-SUB)                15880000
158900                                   TO ASC-KEY-PKSL-NBR            15890000
159000             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB)                15900000
159100                                   TO ASC-KEY-REC-SEQ-NBR         15910000
159200                                      DK-REC-SEQ-NBR              15920000
159300             MOVE RC013-STR-NBR      (ASC-SEL-SUB)                15930000
159400                                   TO ASC-KEY-STR-DEST-NBR        15940000
159500             MOVE RC013-SEQ-NBR      (ASC-SEL-SUB)                15950000
159600                                   TO ASC-KEY-SEQ-NBR             15960000
159700                                      DK-SEQ-NBR-B                15970000
159800                                      DK-SEQ-NBR-E                15980000
159900             IF RC013-OPER-UNT-ID (ASC-SEL-SUB) = PC-0 AND        15990000
160000                DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-LIST    16000000
160100                 MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)             16010000
160200                                    TO ASC-KEY-OPER-UNT-ID        16020000
160300                                       DK-OPER-UNT-ID             16030000
160400             END-IF                                               16040000
160500             SET RC013-INQ (ASC-SEL-SUB)                          16050000
160600                                   TO TRUE                        16060000
160700             PERFORM 9200-REWRITE-LIST-QUEUE                      16070000
160800         ELSE                                                     16080000
160900             SUBTRACT +1 FROM ASC-SEL-SUB                         16090000
161000*            --- BOTTOM OF LIST ---                               16100000
161100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16110000
161200             SET DP020-MSG-INFORMATIONAL                          16120000
161300                                   TO TRUE                        16130000
161400         END-IF                                                   16140000
161500     ELSE                                                         16150000
161600         SUBTRACT +1 FROM ASC-SEL-ITEM                            16160000
161700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16170000
161800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16180000
161900         SET DP020-MSG-INFORMATIONAL                              16190000
162000                                   TO TRUE                        16200000
162100     END-IF.                                                      16210000
162200                                                                  16220000
162300/                                                                 16230000
162400******************************************************************16240000
162500* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *16250000
162600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16260000
162700******************************************************************16270000
162800 2310-GET-PREV-RECORD.                                            16280000
162900                                                                  16290000
163000     SUBTRACT +1 FROM ASC-SEL-SUB.                                16300000
163100                                                                  16310000
163200     IF ASC-SEL-SUB < +1                                          16320000
163300         SUBTRACT +1 FROM ASC-SEL-ITEM                            16330000
163400         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16340000
163500     END-IF.                                                      16350000
163600                                                                  16360000
163700     IF ASC-SEL-ITEM > ZERO                                       16370000
163800         PERFORM 9100-READ-SEL-QUEUE                              16380000
163900         MOVE RC013-PKSL-NBR     (ASC-SEL-SUB)                    16390000
164000                                   TO ASC-KEY-PKSL-NBR            16400000
164100         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB)                    16410000
164200                                   TO ASC-KEY-REC-SEQ-NBR         16420000
164300         MOVE RC013-STR-NBR      (ASC-SEL-SUB)                    16430000
164400                                   TO ASC-KEY-STR-DEST-NBR        16440000
164500         MOVE RC013-SEQ-NBR      (ASC-SEL-SUB)                    16450000
164600                                   TO ASC-KEY-SEQ-NBR             16460000
164700                                      DK-SEQ-NBR-B                16470000
164800                                      DK-SEQ-NBR-E                16480000
164900     ELSE                                                         16490000
165000         MOVE +1                   TO ASC-SEL-ITEM                16500000
165100                                      ASC-SEL-SUB                 16510000
165200*        --- TOP OF LIST ---                                      16520000
165300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16530000
165400         SET DP020-MSG-INFORMATIONAL                              16540000
165500                                   TO TRUE                        16550000
165600     END-IF.                                                      16560000
165700                                                                  16570000
165800/                                                                 16580000
165900******************************************************************16590000
166000* THE USER CAN CHANGE THE SEARCH FOR VENDOR STYLE FIELD TO       *16600000
166100* REPOSITION THE LIST TO THE NEXT VENDOR STYLE THAT IS EQUAL OR  *16610000
166200* GREATER THAN THE SEARCH FOR VENDOR STYLE ENTERED.              *16620000
166300******************************************************************16630000
166400 2400-CHECK-FOR-SEARCH-STYLE.                                     16640000
166500                                                                  16650000
166600     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   16660000
166700                                                                  16670000
166800     PERFORM 2500-SEARCH-LISTQ-CNTL                               16680000
166900         VARYING PV-ITEM                                          16690000
167000         FROM 1 BY 1                                              16700000
167100         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                16710000
167200         OR ASC-KEY-SEARCH-STYLE < LQW-VEND-STYL-NAME (LQW-IDX)   16720000
167300         OR ASC-KEY-SEARCH-STYLE = LQW-VEND-STYL-NAME (LQW-IDX).  16730000
167400                                                                  16740000
167500     IF PS-INVALID-SEARCH-STYLE                                   16750000
167600         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            16760000
167700         MOVE -1                   TO ASTYLEL                     16770000
167800         SET DP030-SET-CURSOR-APPL-1                              16780000
167900                                   TO TRUE                        16790000
168000         MOVE DP015-REVERSE        TO ASTYLEH                     16800000
168100         MOVE DP015-YELLOW         TO ASTYLEC                     16810000
168200         MOVE DP015-UNP-ALP-BRT-MDT                               16820000
168300                                   TO ASTYLEA                     16830000
168400         SET DP020-MSG-WARNING     TO TRUE                        16840000
168500         SET PS-ERROR              TO TRUE                        16850000
168600     END-IF.                                                      16860000
168700                                                                  16870000
168800******************************************************************16880000
168900*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *16890000
169000*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *16900000
169100******************************************************************16910000
169200 2500-SEARCH-LISTQ-CNTL.                                          16920000
169300                                                                  16930000
169400     PERFORM 6112-READ-LIST-QUEUE.                                16940000
169500                                                                  16950000
169600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           16960000
169700         PERFORM                                                  16970000
169800             VARYING LQW-IDX                                      16980000
169900             FROM 1 BY 1                                          16990000
170000             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   17000000
170100             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             17010000
170200                 IF ASC-KEY-SEARCH-STYLE =                        17020000
170300                    LQW-VEND-STYL-NAME (LQW-IDX)  OR              17030000
170400                    ASC-KEY-SEARCH-STYLE <                        17040000
170500                    LQW-VEND-STYL-NAME (LQW-IDX)                  17050000
170600                     SET PS-VALID-SEARCH-STYLE                    17060000
170700                                 TO TRUE                          17070000
170800                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          17080000
170900                                 TO ASC-START-ITEM-REQUEST-N      17090000
171000                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            17100000
171100                     ADD ASC-HIGHEST-BLOCK-WRITTEN                17110000
171200                                 TO PV-ITEM                       17120000
171300                 END-IF                                           17130000
171400         END-PERFORM                                              17140000
171500     END-IF.                                                      17150000
171600                                                                  17160000
171700/                                                                 17170000
171800 3000-EDIT-DATA-IN-COMMAREA.                                      17180000
171900                                                                  17190000
172000     SET PS-NO-ERROR             TO TRUE.                         17200000
172100                                                                  17210000
172200     PERFORM 3200-RESET-ATTRIBUTES.                               17220000
172300                                                                  17230000
172400     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       17240000
172500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17250000
172600                                          ASC-ITEMS-DISPLAYED - 1.17260000
172700     PERFORM 3100-SET-SUBSCRIPTS.                                 17270000
172800                                                                  17280000
172900     PERFORM 3300-EDIT-SELECTIONS                                 17290000
173000             VARYING PV-SUB  FROM PV-SUB BY -1                    17300000
173100             UNTIL   PV-SUB < +1.                                 17310000
173200                                                                  17320000
173300     IF PS-NO-ERROR                                               17330000
173400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17340000
173500     END-IF.                                                      17350000
173600                                                                  17360000
173700     IF PS-NO-ERROR AND                                           17370000
173800        ASC-START-OF-SELECTED-RANGE > ZERO AND                    17380000
173900        ASC-END-OF-SELECTED-RANGE > ZERO                          17390000
174000                                                                  17400000
174100         PERFORM 3500-MARK-RANGE-AS-SELECTED                      17410000
174200     END-IF.                                                      17420000
174300                                                                  17430000
174400                                                                  17440000
174500 3100-SET-SUBSCRIPTS.                                             17450000
174600                                                                  17460000
174700     COMPUTE ASC-ITEM-SUB =                                       17470000
174800                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.17480000
174900                                                                  17490000
175000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17500000
175100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17510000
175200         MOVE PC-MAX-BLOCKS-IN-ARRAY                              17520000
175300                                 TO ASC-BLK-SUB                   17530000
175400     ELSE                                                         17540000
175500         MOVE +1                 TO ASC-BLK-SUB                   17550000
175600     END-IF.                                                      17560000
175700                                                                  17570000
175800 3200-RESET-ATTRIBUTES.                                           17580000
175900                                                                  17590000
176000     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     17600000
176100     MOVE DP015-GREEN            TO ASTRTITC.                     17610000
176200     MOVE DP015-UNDERLINE        TO ASTRTITH.                     17620000
176300                                                                  17630000
176400     IF  ASC-READ-ONLY                                            17640000
176500         MOVE DP015-ASK-NOR-OFF  TO ASTYLEA                       17650000
176600         MOVE DP015-BLUE         TO ASTYLEC                       17660000
176700         MOVE DP015-HL-OFF       TO ASTYLEH                       17670000
176800     ELSE                                                         17680000
176900         MOVE DP015-UNP-ALP-NOR-OFF                               17690000
177000                                 TO ASTYLEA                       17700000
177100         MOVE DP015-GREEN        TO ASTYLEC                       17710000
177200         MOVE DP015-UNDERLINE    TO ASTYLEH                       17720000
177300     END-IF.                                                      17730000
177400                                                                  17740000
177500     IF DP020-NEXT-ACT-RETURN OR                                  17750000
177600        DP020-NEXT-ACT-READ-MAP                                   17760000
177700         PERFORM VARYING PV-SUB  FROM 1 BY 1                      17770000
177800                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             17780000
177900                 MOVE DP015-UNP-ALP-NOR-OFF                       17790000
178000                                 TO MR-SELECTA (PV-SUB)           17800000
178100                 MOVE DP015-GREEN                                 17810000
178200                                 TO MR-SELECTC (PV-SUB)           17820000
178300                 MOVE DP015-UNDERLINE                             17830000
178400                                 TO MR-SELECTH (PV-SUB)           17840000
178500         END-PERFORM                                              17850000
178600     ELSE                                                         17860000
178700         PERFORM VARYING PV-SUB  FROM 1 BY 1                      17870000
178800                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              17880000
178900                 MOVE DP015-UNP-ALP-NOR-OFF                       17890000
179000                                 TO MR-SELECTA (PV-SUB)           17900000
179100                 MOVE DP015-GREEN                                 17910000
179200                                 TO MR-SELECTC (PV-SUB)           17920000
179300                 MOVE DP015-UNDERLINE                             17930000
179400                                 TO MR-SELECTH (PV-SUB)           17940000
179500         END-PERFORM                                              17950000
179600     END-IF.                                                      17960000
179700                                                                  17970000
179800 3300-EDIT-SELECTIONS.                                            17980000
179900                                                                  17990000
180000     EVALUATE TRUE                                                18000000
180100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   18010000
180200                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18020000
180300              CONTINUE                                            18030000
180400                                                                  18040000
180500         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        18050000
180600              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18060000
180700                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  18070000
180800                  MOVE ASC-TEMP-SELECTED-SW                       18080000
180900                                        (ASC-BLK-SUB ASC-ITEM-SUB)18090000
181000                                 TO ASC-SELECTED-SW               18100000
181100                                        (ASC-BLK-SUB ASC-ITEM-SUB)18110000
181200              END-IF                                              18120000
181300                                                                  18130000
181400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   18140000
181500                                                             SPACE18150000
181600              EVALUATE TRUE                                       18160000
181700                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     18170000
181800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18180000
181900                     MOVE SPACE  TO ASC-SELECTED-SW               18190000
182000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18200000
182100                                                                  18210000
182200                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     18220000
182300                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   18230000
182400                       MOVE SPACE                                 18240000
182500                                 TO ASC-SELECTED-SW               18250000
182600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18260000
182700                                                                  18270000
182800                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     18280000
182900                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     18290000
183000                       MOVE SPACE                                 18300000
183100                                 TO ASC-SELECTED-SW               18310000
183200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18320000
183300             END-EVALUATE                                         18330000
183400                                                                  18340000
183500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18350000
183600              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           18360000
183700                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   18370000
183800              END-IF                                              18380000
183900                                                                  18390000
184000              PERFORM 3310-EDIT-RANGE                             18400000
184100                                                                  18410000
184200         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            18420000
184300              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18430000
184400                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   18440000
184500              END-IF                                              18450000
184600                                                                  18460000
184700              PERFORM 3310-EDIT-RANGE                             18470000
184800                                                                  18480000
184900         WHEN OTHER                                               18490000
185000              MOVE PC-TSYMSG-00005                                18500000
185100                                 TO DP020-MSG-NUMBER              18510000
185200              SET PS-ERROR                                        18520000
185300                  DP020-MSG-FATAL                                 18530000
185400                  DP030-SET-CURSOR-APPL-1                         18540000
185500                                 TO TRUE                          18550000
185600              MOVE -1            TO MR-SELECTL (PV-SUB)           18560000
185700              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           18570000
185800              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           18580000
185900              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18590000
186000                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18600000
186100                  MOVE SPACE     TO ASC-SELECTED-SW               18610000
186200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18620000
186300              END-IF                                              18630000
186400     END-EVALUATE.                                                18640000
186500                                                                  18650000
186600     SUBTRACT +1 FROM PV-ITEM-IN-USE                              18660000
186700                      ASC-ITEM-SUB.                               18670000
186800     IF ASC-ITEM-SUB < 1                                          18680000
186900         SUBTRACT +1 FROM ASC-BLK-SUB                             18690000
187000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB.                 18700000
187100                                                                  18710000
187200 3310-EDIT-RANGE.                                                 18720000
187300                                                                  18730000
187400     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 18740000
187500        IF ASC-START-OF-SELECTED-RANGE = ZERO                     18750000
187600            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  18760000
187700                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  18770000
187800            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   18780000
187900        ELSE                                                      18790000
188000            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18800000
188100                CONTINUE                                          18810000
188200            ELSE                                                  18820000
188300                MOVE PC-TSYMSG-00054                              18830000
188400                                 TO DP020-MSG-NUMBER              18840000
188500                SET DP020-MSG-FATAL                               18850000
188600                    PS-ERROR                                      18860000
188700                    DP030-SET-CURSOR-APPL-1                       18870000
188800                                 TO TRUE                          18880000
188900                MOVE -1          TO MR-SELECTL (PV-SUB)           18890000
189000                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           18900000
189100                MOVE DP015-UNDERLINE                              18910000
189200                                 TO MR-SELECTH (PV-SUB)           18920000
189300            END-IF                                                18930000
189400        END-IF                                                    18940000
189500     ELSE                                                         18950000
189600         IF ASC-END-OF-SELECTED-RANGE = ZERO                      18960000
189700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18970000
189800                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18980000
189900             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     18990000
190000         ELSE                                                     19000000
190100             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        19010000
190200                 CONTINUE                                         19020000
190300             ELSE                                                 19030000
190400                MOVE PC-TSYMSG-00055                              19040000
190500                                 TO DP020-MSG-NUMBER              19050000
190600                SET DP020-MSG-FATAL                               19060000
190700                    PS-ERROR                                      19070000
190800                    DP030-SET-CURSOR-APPL-1                       19080000
190900                                 TO TRUE                          19090000
191000                MOVE -1          TO MR-SELECTL (PV-SUB)           19100000
191100             END-IF                                               19110000
191200         END-IF                                                   19120000
191300     END-IF.                                                      19130000
191400                                                                  19140000
191500 3400-CHECK-RANGE-SEQUENCE.                                       19150000
191600                                                                  19160000
191700     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    19170000
191800        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    19180000
191900        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   19190000
192000         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              19200000
192100         SET PS-ERROR                                             19210000
192200             DP020-MSG-FATAL     TO TRUE                          19220000
192300                                                                  19230000
192400         PERFORM 3410-POSITION-AT-ERROR.                          19240000
192500                                                                  19250000
192600 3410-POSITION-AT-ERROR.                                          19260000
192700                                                                  19270000
192800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         19280000
192900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               19290000
193000                                                  PV-TOP-ITEM + 1.19300000
193100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19310000
193200         CONTINUE                                                 19320000
193300     ELSE                                                         19330000
193400         MOVE -1                 TO MR-SELECTL (PV-SUB)           19340000
193500         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           19350000
193600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           19360000
193700     END-IF.                                                      19370000
193800                                                                  19380000
193900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.19390000
194000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19400000
194100         CONTINUE                                                 19410000
194200     ELSE                                                         19420000
194300         MOVE -1                 TO MR-SELECTL (PV-SUB)           19430000
194400         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           19440000
194500         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           19450000
194600     END-IF.                                                      19460000
194700                                                                  19470000
194800 3500-MARK-RANGE-AS-SELECTED.                                     19480000
194900                                                                  19490000
195000     MOVE +1                     TO ASC-BLK-SUB.                  19500000
195100                                                                  19510000
195200     PERFORM 3510-MARK-SELECTED-INDS                              19520000
195300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    19530000
195400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           19540000
195500                                                                  19550000
195600     ADD +1                      TO ASC-BLK-SUB.                  19560000
195700                                                                  19570000
195800     PERFORM 3510-MARK-SELECTED-INDS                              19580000
195900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    19590000
196000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           19600000
196100                                                                  19610000
196200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              19620000
196300                                 TO PV-LIST-ITEM-NUMBER.          19630000
196400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        19640000
196500                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).19650000
196600     MOVE ASC-START-OF-SELECTED-RANGE                             19660000
196700                                 TO PV-START-OF-SELECTED-RANGE.   19670000
196800     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        19680000
196900             ((PV-START-OF-SELECTED-RANGE - 1) /                  19690000
197000                                              PC-ITEMS-PER-PANEL).19700000
197100     MOVE ASC-END-OF-SELECTED-RANGE                               19710000
197200                                 TO PV-END-OF-SELECTED-RANGE.     19720000
197300     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         19730000
197400             ((PV-END-OF-SELECTED-RANGE - 1) /                    19740000
197500                                              PC-ITEMS-PER-PANEL).19750000
197600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.19760000
197700                                                                  19770000
197800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19780000
197900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19790000
198000         MOVE +1                 TO ASC-BLK-SUB                   19800000
198100                                                                  19810000
198200         PERFORM 5100-WRITE-TEMP-STORAGE                          19820000
198300                                                                  19830000
198400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19840000
198500                                       PV-FIRST-BLOCK-IN-ARRAY - 119850000
198600                                                                  19860000
198700         PERFORM                                                  19870000
198800           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 19880000
198900                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  19890000
199000                                                                  19900000
199100                 PERFORM 4410-READ-TEMP-STORAGE                   19910000
199200                                                                  19920000
199300                 PERFORM 3510-MARK-SELECTED-INDS                  19930000
199400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        19940000
199500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL19950000
199600                                                                  19960000
199700                 PERFORM 5100-WRITE-TEMP-STORAGE                  19970000
199800                                                                  19980000
199900                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       19990000
200000         END-PERFORM                                              20000000
200100                                                                  20010000
200200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20020000
200300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY20030000
200400         PERFORM                                                  20040000
200500           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  20050000
200600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      20060000
200700                                 TO PV-BLOCK-NUMBER               20070000
200800                                                                  20080000
200900                 PERFORM 4410-READ-TEMP-STORAGE                   20090000
201000                                                                  20100000
201100                 PERFORM 3510-MARK-SELECTED-INDS                  20110000
201200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        20120000
201300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL20130000
201400                                                                  20140000
201500                 PERFORM 5100-WRITE-TEMP-STORAGE                  20150000
201600                                                                  20160000
201700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        20170000
201800         END-PERFORM                                              20180000
201900                                                                  20190000
202000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20200000
202100                                 TO PV-BLOCK-NUMBER               20210000
202200                                                                  20220000
202300         PERFORM 4410-READ-TEMP-STORAGE                           20230000
202400                                                                  20240000
202500     END-IF.                                                      20250000
202600                                                                  20260000
202700     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   20270000
202800                                    ASC-END-OF-SELECTED-RANGE.    20280000
202900                                                                  20290000
203000 3510-MARK-SELECTED-INDS.                                         20300000
203100                                                                  20310000
203200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     20320000
203300                                       ASC-START-OF-SELECTED-RANGE20330000
203400        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  20340000
203500                                         ASC-END-OF-SELECTED-RANGE20350000
203600           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           20360000
203700               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          20370000
203800                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               20380000
203900                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     20390000
204000                                 TO TRUE                          20400000
204100               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  20410000
204200           END-IF                                                 20420000
204300        END-IF                                                    20430000
204400     END-IF.                                                      20440000
204500                                                                  20450000
204600 4000-BUILD-INITIAL-PANEL.                                        20460000
204700                                                                  20470000
204800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             20480000
204900                ASC-BLOCK-ENTRIES (2).                            20490000
205000     MOVE +1                     TO ASC-BLK-SUB.                  20500000
205100     SET ASC-MORE-PACK-SLIP-ITEMS                                 20510000
205200                                 TO TRUE.                         20520000
205300                                                                  20530000
205400     MOVE ZERO                   TO ASC-ITEM-SUB                  20540000
205500                                    ASC-NUMBER-OF-ITEMS-READ      20550000
205600                                    ASC-NUMBER-OF-SELECTED-ITEMS  20560000
205700                                    ASC-HIGHEST-BLOCK-WRITTEN     20570000
205800                                    ASC-START-OF-SELECTED-RANGE   20580000
205900                                    ASC-END-OF-SELECTED-RANGE     20590000
206000                                    ASC-ITEM-AT-TOP-OF-PANEL.     20600000
206100                                                                  20610000
206200     PERFORM 4010-FORMAT-KEYS.                                    20620000
206300     PERFORM 4100-GET-TRECEIV.                                    20630000
206400     PERFORM 4020-GET-VENDOR-NAME.                                20640000
206500                                                                  20650000
206600     PERFORM 4030-OPEN-CURSOR.                                    20660000
206700                                                                  20670000
206800     PERFORM 4040-GET-PACK-SLIP-ITEMS.                            20680000
206900                                                                  20690000
207000     PERFORM 4050-CLOSE-CURSOR.                                   20700000
207100                                                                  20710000
207200     MOVE +1                     TO PV-TOP-ITEM.                  20720000
207300                                                                  20730000
207400     MOVE -1                     TO ASTYLEL                       20740000
207500     SET DP030-SET-CURSOR-APPL-1                                  20750000
207600                             TO TRUE                              20760000
207700                                                                  20770000
207800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20780000
207900                                                                  20790000
208000 4010-FORMAT-KEYS.                                                20800000
208100                                                                  20810000
208200     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    20820000
208300     MOVE ASC-KEY-REC-SEQ-NBR    TO DK-REC-SEQ-NBR.               20830000
208400     MOVE ASC-KEY-PKSL-NBR       TO DK-PKSL-NBR.                  20840000
208500     MOVE ASC-KEY-SEQ-NBR        TO DK-SEQ-NBR-B                  20850000
208600                                    DK-SEQ-NBR-E.                 20860000
208700     MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID.               20870000
208800     MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID.                  20880000
208900                                                                  20890000
209000 4020-GET-VENDOR-NAME.                                            20900000
209100                                                                  20910000
209200         EXEC SQL                                                 20920000
209300              SELECT B.ENT_NAME_DESC                              20930000
209400                INTO :ENTNME-ENT-NAME-DESC                        20940000
209500                FROM TPURCHS A,                                   20950000
209600                     TENTNME B                                    20960000
209700               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                20970000
209800                 AND A.PO_NBR         = :DK-PO-NBR                20980000
209900                 AND A.ENT_ID         = B.ENT_ID                  20990000
210000                 AND B.TYPE_CDE       = :PC-01                    21000000
210100         END-EXEC                                                 21010000
210200                                                                  21020000
210300         EVALUATE TRUE                                            21030000
210400             WHEN SQLCODE = ZERO                                  21040000
210500             WHEN SQLCODE = +100                                  21050000
210600                  CONTINUE                                        21060000
210700             WHEN SQLCODE = -904                                  21070000
210800             WHEN SQLCODE = -911                                  21080000
210900             WHEN SQLCODE = -913                                  21090000
211000                  PERFORM 9900-SOFT-ABORT                         21100000
211100                                                                  21110000
211200             WHEN SQLWARN0 NOT = SPACES                           21120000
211300             WHEN SQLCODE  NOT = ZERO                             21130000
211400                  MOVE '4020-GET-VENDOR-NAME'                     21140000
211500                                 TO DP013-PARAGRAPH               21150000
211600                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       21160000
211700                                 TO DP013-MESSAGE-TEXT (1)        21170000
211800                  MOVE SQLCA     TO DP013-SQLCA                   21180000
211900                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      21190000
212000                  SET DP013-DB2-ABEND                             21200000
212100                      DP013-XCTL-DISPLAY-RESTART                  21210000
212200                                 TO TRUE                          21220000
212300                                                                  21230000
212400                  PERFORM DP013-0000-PROCESS-ABEND                21240000
212500         END-EVALUATE.                                            21250000
212600                                                                  21260000
212700     IF SQLCODE = ZERO                                            21270000
212800         MOVE ENTNME-ENT-NAME-DESC                                21280000
212900                                 TO ASC-KEY-VENDOR-NAME           21290000
213000     ELSE                                                         21300000
213100         IF SQLCODE = +100                                        21310000
213200             MOVE 'VENDOR NOT FOUND'                              21320000
213300                                 TO ASC-KEY-VENDOR-NAME           21330000
213400         END-IF                                                   21340000
213500     END-IF.                                                      21350000
213600                                                                  21360000
213700 4030-OPEN-CURSOR.                                                21370000
213800                                                                  21380000
213900         EXEC SQL                                                 21390000
214000              OPEN ITEM-CURSOR                                    21400000
214100         END-EXEC                                                 21410000
214200                                                                  21420000
214300         EVALUATE TRUE                                            21430000
214400             WHEN SQLCODE = ZERO                                  21440000
214500                  CONTINUE                                        21450000
214600             WHEN SQLCODE = -904                                  21460000
214700             WHEN SQLCODE = -911                                  21470000
214800             WHEN SQLCODE = -913                                  21480000
214900                  PERFORM 9900-SOFT-ABORT                         21490000
215000                                                                  21500000
215100             WHEN SQLWARN0 NOT = SPACES                           21510000
215200             WHEN SQLCODE  NOT = ZERO                             21520000
215300                  MOVE '4030-OPEN-CURSOR'                         21530000
215400                                 TO DP013-PARAGRAPH               21540000
215500                  MOVE 'UNSUCCESSFUL PACK SLIP ITEM CURSOR OPEN'  21550000
215600                                 TO DP013-MESSAGE-TEXT (1)        21560000
215700                  MOVE SQLCA TO DP013-SQLCA                       21570000
215800                  MOVE 'TPKITEM' TO DP013-DB2-TABLE-NAME (1)      21580000
215900                  MOVE 'TUNPKSL' TO DP013-DB2-TABLE-NAME (2)      21590000
216000                  SET DP013-XCTL-DISPLAY-RESTART                  21600000
216100                      DP013-DB2-ABEND                             21610000
216200                                 TO TRUE                          21620000
216300                                                                  21630000
216400                  PERFORM DP013-0000-PROCESS-ABEND                21640000
216500         END-EVALUATE.                                            21650000
216600                                                                  21660000
216700 4040-GET-PACK-SLIP-ITEMS.                                        21670000
216800                                                                  21680000
216900     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   21690000
217000         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    21700000
217100               ASC-NO-MORE-PACK-SLIP-ITEMS                        21710000
217200                                                                  21720000
217300         PERFORM 4042-FETCH-PACK-SLIP-ITEM                        21730000
217400                                                                  21740000
217500         IF ASC-MORE-PACK-SLIP-ITEMS                              21750000
217600             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 21760000
217700                 ADD +1          TO ASC-ITEM-SUB                  21770000
217800             ELSE                                                 21780000
217900                 ADD +1          TO ASC-BLK-SUB                   21790000
218000                 MOVE +1         TO ASC-ITEM-SUB                  21800000
218100                                                                  21810000
218200                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          21820000
218300                     MOVE +1     TO ASC-BLK-SUB                   21830000
218400                     SET ASC-BLOCK-MODIFIED (1)                   21840000
218500                                 TO TRUE                          21850000
218600                                                                  21860000
218700                     PERFORM 5100-WRITE-TEMP-STORAGE              21870000
218800                                                                  21880000
218900                     MOVE ASC-BLOCK-ENTRIES                       21890000
219000                                          (PC-MAX-BLOCKS-IN-ARRAY)21900000
219100                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)21910000
219200                     ADD +1      TO ASC-BLK-SUB                   21920000
219300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21930000
219400                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     21940000
219500                                 TO TRUE                          21950000
219600                 END-IF                                           21960000
219700             END-IF                                               21970000
219800             MOVE PV-PKSL-LNE-NBR                                 21980000
219900                                 TO DK-ORD-LNE-NBR                21990000
220000             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      22000000
220100             MOVE ASC-NUMBER-OF-ITEMS-READ                        22010000
220200                                 TO ASC-LIST-ITEM-NUMBER          22020000
220300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22030000
220400             MOVE PV-PKSL-STAT-CDE                                22040000
220500                                 TO ASC-KEY-PKSL-STAT-CDE         22050000
220600             MOVE PV-PKSL-LNE-NBR                                 22060000
220700                                 TO ASC-PKSL-LNE-NBR-N            22070000
220800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22080000
220900             MOVE PV-PKSL-ITM-QTY                                 22090000
221000                                 TO ASC-PKSL-ITM-QTY-N            22100000
221100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22110000
221200             MOVE PV-VEND-STYL-NAME                               22120000
221300                                 TO ASC-VEND-STYL-NAME            22130000
221400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22140000
221500             MOVE PV-UNT-COST-AMT                                 22150000
221600                                 TO ASC-UNT-COST-AMT-N            22160000
221700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22170000
221800             MOVE PV-COLOR-DESC  TO ASC-COLOR-DESC                22180000
221900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22190000
222000             MOVE PV-VEND-DESC   TO ASC-VEND-DESC                 22200000
222100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22210000
222200             MOVE PV-SIZE-DESC   TO ASC-SIZE-DESC                 22220000
222300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22230000
222400*MIKE, ADD RECITM SELECT AND CHECK|                               22240000
222500         END-IF                                                   22250000
222600     END-PERFORM.                                                 22260000
222700                                                                  22270000
222800     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           22280000
222900         MOVE +1                 TO ASC-BLK-SUB                   22290000
223000                                                                  22300000
223100         PERFORM 5100-WRITE-TEMP-STORAGE                          22310000
223200                                                                  22320000
223300         ADD +1                  TO ASC-BLK-SUB                   22330000
223400                                                                  22340000
223500         PERFORM 5100-WRITE-TEMP-STORAGE                          22350000
223600                                                                  22360000
223700         MOVE +1                 TO ASC-BLK-SUB                   22370000
223800                                    PV-BLOCK-NUMBER               22380000
223900                                                                  22390000
224000         PERFORM 4410-READ-TEMP-STORAGE                           22400000
224100                                                                  22410000
224200         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         22420000
224300             MOVE +2             TO ASC-BLK-SUB                   22430000
224400                                    PV-BLOCK-NUMBER               22440000
224500                                                                  22450000
224600             PERFORM 4410-READ-TEMP-STORAGE                       22460000
224700         END-IF                                                   22470000
224800     END-IF.                                                      22480000
224900                                                                  22490000
225000 4042-FETCH-PACK-SLIP-ITEM.                                       22500000
225100                                                                  22510000
225200     EXEC SQL                                                     22520000
225300          FETCH  ITEM-CURSOR                                      22530000
225400           INTO :PV-PKSL-LNE-NBR,                                 22540000
225500                :PV-PKSL-ITM-QTY,                                 22550000
225600                :PV-VEND-STYL-NAME,                               22560000
225700                :PV-UNT-COST-AMT,                                 22570000
225800                :PV-COLOR-DESC,                                   22580000
225900                :PV-VEND-DESC,                                    22590000
226000                :PV-SIZE-DESC,                                    22600000
226100                :PV-PKSL-STAT-CDE,                                22610000
226200                :PV-SEQ-NBR                                       22620000
226300     END-EXEC.                                                    22630000
226400                                                                  22640000
226500     EVALUATE TRUE                                                22650000
226600         WHEN SQLCODE = ZERO                                      22660000
226700              MOVE PV-SEQ-NBR    TO ASC-KEY-SEQ-NBR               22670000
226800         WHEN SQLCODE = +100                                      22680000
226900              SET ASC-NO-MORE-PACK-SLIP-ITEMS                     22690000
227000                                 TO TRUE                          22700000
227100         WHEN SQLCODE = -904                                      22710000
227200         WHEN SQLCODE = -911                                      22720000
227300         WHEN SQLCODE = -913                                      22730000
227400              PERFORM 9900-SOFT-ABORT                             22740000
227500                                                                  22750000
227600         WHEN SQLWARN0 NOT = SPACES                               22760000
227700         WHEN SQLCODE  NOT = ZERO                                 22770000
227800              MOVE '4042-FETCH-PACK-SLIP-ITEM'                    22780000
227900                                 TO DP013-PARAGRAPH               22790000
228000              MOVE 'UNSUCCESSFUL FETCH PACK SLIP ITEM CURSOR'     22800000
228100                                 TO DP013-MESSAGE-TEXT (1)        22810000
228200              MOVE SQLCA         TO DP013-SQLCA                   22820000
228300              MOVE 'TPKITEM'     TO DP013-DB2-TABLE-NAME (1)      22830000
228400              MOVE 'TUNPKSL'     TO DP013-DB2-TABLE-NAME (2)      22840000
228500              SET DP013-DB2-ABEND                                 22850000
228600                  DP013-XCTL-DISPLAY-RESTART                      22860000
228700                                 TO TRUE                          22870000
228800                                                                  22880000
228900              PERFORM DP013-0000-PROCESS-ABEND                    22890000
229000     END-EVALUATE.                                                22900000
229100                                                                  22910000
229200                                                                  22920000
229300 4050-CLOSE-CURSOR.                                               22930000
229400                                                                  22940000
229500     EXEC SQL                                                     22950000
229600          CLOSE ITEM-CURSOR                                       22960000
229700     END-EXEC.                                                    22970000
229800                                                                  22980000
229900     EVALUATE TRUE                                                22990000
230000         WHEN SQLCODE = ZERO                                      23000000
230100              CONTINUE                                            23010000
230200         WHEN SQLCODE = -904                                      23020000
230300         WHEN SQLCODE = -911                                      23030000
230400         WHEN SQLCODE = -913                                      23040000
230500              PERFORM 9900-SOFT-ABORT                             23050000
230600                                                                  23060000
230700         WHEN SQLWARN0 NOT = SPACES                               23070000
230800         WHEN SQLCODE  NOT = ZERO                                 23080000
230900              MOVE '4050-CLOSE-CURSOR'                            23090000
231000                                 TO DP013-PARAGRAPH               23100000
231100              MOVE 'UNSUCCESSFUL PACK SLIP ITEM CURSOR CLOSE'     23110000
231200                                 TO DP013-MESSAGE-TEXT (1)        23120000
231300              MOVE SQLCA TO DP013-SQLCA                           23130000
231400              MOVE 'TPKITEM '    TO DP013-DB2-TABLE-NAME (1)      23140000
231500              MOVE 'TUNPKSL '    TO DP013-DB2-TABLE-NAME (2)      23150000
231600              SET DP013-DB2-ABEND                                 23160000
231700                  DP013-XCTL-DISPLAY-RESTART                      23170000
231800                                 TO TRUE                          23180000
231900                                                                  23190000
232000              PERFORM DP013-0000-PROCESS-ABEND                    23200000
232100     END-EVALUATE.                                                23210000
232200/                                                                 23220000
232300 4100-GET-TRECEIV.                                                23230000
232400                                                                  23240000
232500         EXEC SQL                                                 23250000
232600              SELECT                                              23260000
232700                     STATUS_CDE                                   23270000
232800                  ,  PACK_BY_ST_IND                               23280000
232900                INTO                                              23290000
233000                     :RECEIV-STATUS-CDE                           23300000
233100                  ,  :RECEIV-PACK-BY-ST-IND                       23310000
233200                FROM                                              23320000
233300                     TRECEIV                                      23330000
233400               WHERE                                              23340000
233500                     ORD_NBR          =  :DK-PO-NBR               23350000
233600                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          23360000
233700                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          23370000
233800                AND  FCLTY_ID         =  :DK-FCLTY-ID             23380000
233900                AND  VER_STATUS_CDE   =  :PC-ACTIVE               23390000
234000         END-EXEC                                                 23400000
234100                                                                  23410000
234200         EVALUATE TRUE                                            23420000
234300             WHEN SQLCODE = ZERO                                  23430000
234400                 SET ASC-RECEIVER-FOUND  TO TRUE                  23440000
234500                 MOVE RECEIV-PACK-BY-ST-IND TO ASC-PACK-BY-ST-IND 23450000
234600             WHEN SQLCODE = +100                                  23460000
234700                 SET ASC-NO-RECEIVER-FOUND  TO TRUE               23470000
234800             WHEN SQLCODE = -904                                  23480000
234900             WHEN SQLCODE = -911                                  23490000
235000             WHEN SQLCODE = -913                                  23500000
235100                  PERFORM 9900-SOFT-ABORT                         23510000
235200                                                                  23520000
235300             WHEN SQLWARN0 NOT = SPACES                           23530000
235400             WHEN SQLCODE  NOT = ZERO                             23540000
235500                  MOVE '4100-GET-TRECEIV'                         23550000
235600                                 TO DP013-PARAGRAPH               23560000
235700                  MOVE 'UNSUCCESSFUL SELECT OF RECEIVER STATUS'   23570000
235800                                 TO DP013-MESSAGE-TEXT (1)        23580000
235900                  MOVE SQLCA     TO DP013-SQLCA                   23590000
236000                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      23600000
236100                  SET DP013-DB2-ABEND                             23610000
236200                      DP013-XCTL-DISPLAY-RESTART                  23620000
236300                                 TO TRUE                          23630000
236400                                                                  23640000
236500                  PERFORM DP013-0000-PROCESS-ABEND                23650000
236600         END-EVALUATE.                                            23660000
236700                                                                  23670000
236800     IF  RECEIV-STATUS-CDE EQUAL PC-VE                            23680000
236900         SET ASC-READ-ONLY       TO  TRUE                         23690000
237000     ELSE                                                         23700000
237100         PERFORM 4110-CHECK-RECITM                                23710000
237200     END-IF.                                                      23720000
237300                                                                  23730000
237400 4110-CHECK-RECITM.                                               23740000
237500                                                                  23750000
237600     MOVE ZERO           TO  PV-DB2-COUNT.                        23760000
237700                                                                  23770000
237800         EXEC SQL                                                 23780000
237900              SELECT                                              23790000
238000                     COUNT(*)                                     23800000
238100                INTO                                              23810000
238200                     :PV-DB2-COUNT :PV-NULL-IND                   23820000
238300                FROM                                              23830000
238400                     TRECITM                                      23840000
238500               WHERE                                              23850000
238600                     ORD_NBR          =  :DK-PO-NBR               23860000
238700                AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR          23870000
238800                AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID          23880000
238900                AND  FCLTY_ID         =  :DK-FCLTY-ID             23890000
239000                AND  VER_STATUS_CDE   =  :PC-ACTIVE               23900000
239100                AND  STATUS_CDE       =  :PC-VE                   23910000
239200         END-EXEC                                                 23920000
239300                                                                  23930000
239400         EVALUATE TRUE                                            23940000
239500             WHEN SQLCODE = ZERO                                  23950000
239600             WHEN SQLCODE = +100                                  23960000
239700                  CONTINUE                                        23970000
239800             WHEN SQLCODE = -904                                  23980000
239900             WHEN SQLCODE = -911                                  23990000
240000             WHEN SQLCODE = -913                                  24000000
240100                  PERFORM 9900-SOFT-ABORT                         24010000
240200                                                                  24020000
240300             WHEN SQLWARN0 NOT = SPACES                           24030000
240400             WHEN SQLCODE  NOT = ZERO                             24040000
240500                  MOVE '4110-CHECK-TRECITM'                       24050000
240600                                 TO DP013-PARAGRAPH               24060000
240700                  MOVE 'UNSUCCESSFUL COUNT OF STATUS "VE"'        24070000
240800                                 TO DP013-MESSAGE-TEXT (1)        24080000
240900                  MOVE SQLCA     TO DP013-SQLCA                   24090000
241000                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      24100000
241100                  SET DP013-DB2-ABEND                             24110000
241200                      DP013-XCTL-DISPLAY-RESTART                  24120000
241300                                 TO TRUE                          24130000
241400                                                                  24140000
241500                  PERFORM DP013-0000-PROCESS-ABEND                24150000
241600         END-EVALUATE.                                            24160000
241700                                                                  24170000
241800     IF  PV-DB2-COUNT GREATER THAN ZERO                           24180000
241900         SET ASC-READ-ONLY       TO  TRUE                         24190000
242000     ELSE                                                         24200000
242100         SET ASC-UPDATES-ALLOWED TO  TRUE                         24210000
242200     END-IF.                                                      24220000
242300/                                                                 24230000
242400 4400-MOVE-COMMAREA-TO-SCREEN.                                    24240000
242500                                                                  24250000
242600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         24260000
242700           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         24270000
242800           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            24280000
242900             MOVE +1             TO ASC-BLK-SUB                   24290000
243000                                                                  24300000
243100             PERFORM 5100-WRITE-TEMP-STORAGE                      24310000
243200                                                                  24320000
243300             ADD +1              TO ASC-BLK-SUB                   24330000
243400                                                                  24340000
243500             PERFORM 5100-WRITE-TEMP-STORAGE                      24350000
243600                                                                  24360000
243700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             24370000
243800                 GIVING PV-BLOCK-NUMBER                           24380000
243900                 REMAINDER PV-REMAINDER                           24390000
244000             IF PV-REMAINDER > ZERO                               24400000
244100                 ADD +1          TO PV-BLOCK-NUMBER               24410000
244200             END-IF                                               24420000
244300             MOVE +1             TO ASC-BLK-SUB                   24430000
244400                                                                  24440000
244500             PERFORM 4410-READ-TEMP-STORAGE                       24450000
244600                                                                  24460000
244700             ADD +1              TO ASC-BLK-SUB                   24470000
244800                                    PV-BLOCK-NUMBER               24480000
244900                                                                  24490000
245000             PERFORM 4410-READ-TEMP-STORAGE                       24500000
245100                                                                  24510000
245200     END-IF.                                                      24520000
245300                                                                  24530000
245400     MOVE +1                     TO ASC-BLK-SUB.                  24540000
245500     COMPUTE ASC-ITEM-SUB =                                       24550000
245600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24560000
245700                       + PC-ITEMS-PER-PANEL).                     24570000
245800                                                                  24580000
245900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         24590000
246000         ADD +1                  TO ASC-BLK-SUB                   24600000
246100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24610000
246200     END-IF.                                                      24620000
246300                                                                  24630000
246400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           24640000
246500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                24650000
246600                                                                  24660000
246700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        24670000
246800                                                                  24680000
246900     PERFORM 4420-FORMAT-LIST-LINES                               24690000
247000         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            24700000
247100         UNTIL   PV-SUB < +1.                                     24710000
247200                                                                  24720000
247300     COMPUTE ASC-ITEMS-DISPLAYED =                                24730000
247400                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).24740000
247500     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      24750000
247600                                    ASTRTITO.                     24760000
247700     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                24770000
247800                                 TO AENDITO.                      24780000
247900     MOVE ASC-NUMBER-OF-ITEMS-READ                                24790000
248000                                 TO ATOTITO.                      24800000
248100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            24810000
248200                                 TO ASELITO.                      24820000
248300                                                                  24830000
248400     MOVE ASC-KEY-PO-NBR         TO APOO.                         24840000
248500     MOVE ASC-KEY-PKSL-NBR       TO APKSLIPO.                     24850000
248600     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       24860000
248700     MOVE ASC-KEY-REC-SEQ-NBR    TO ARECSEQO.                     24870000
248800     MOVE ASC-KEY-STR-DEST-NBR   TO ASTRO.                        24880000
248900                                                                  24890000
249000     IF DP020-MSG-NUMBER-X = SPACE                                24900000
249100        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    24910000
249200            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              24920000
249300            SET DP020-MSG-INFORMATIONAL                           24930000
249400                                 TO TRUE                          24940000
249500        END-IF                                                    24950000
249600     END-IF.                                                      24960000
249700                                                                  24970000
249800 4410-READ-TEMP-STORAGE.                                          24980000
249900                                                                  24990000
250000     EXEC CICS READQ TS                                           25000000
250100               QUEUE (ASC-LIST-QUEUE-NAME)                        25010000
250200               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            25020000
250300               ITEM  (PV-BLOCK-NUMBER)                            25030000
250400               RESP  (PV-CICS-RESP)                               25040000
250500     END-EXEC.                                                    25050000
250600                                                                  25060000
250700     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     25070000
250800         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      25080000
250900         CONTINUE                                                 25090000
251000     ELSE                                                         25100000
251100         SET DP013-CICS-ABEND                                     25110000
251200             DP013-NO-ROLLBACK   TO TRUE                          25120000
251300         MOVE '4410-READ-TEMP-STORAGE'                            25130000
251400                                 TO DP013-PARAGRAPH               25140000
251500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   25150000
251600                                 TO DP013-MESSAGE-TEXT (1)        25160000
251700                                                                  25170000
251800         PERFORM DP013-0000-PROCESS-ABEND                         25180000
251900     END-IF.                                                      25190000
252000                                                                  25200000
252100     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     25210000
252200                                 TO TRUE.                         25220000
252300                                                                  25230000
252400     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          25240000
252500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               25250000
252600     END-IF.                                                      25260000
252700                                                                  25270000
252800 4420-FORMAT-LIST-LINES.                                          25280000
252900                                                                  25290000
253000     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       25300000
253100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25310000
253200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     25320000
253300         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     25330000
253400                                    MR-ACTION        (PV-SUB)     25340000
253500                                    MR-PKSL-LNE-NBR  (PV-SUB)     25350000
253600                                    MR-VEND-STYL-NAME(PV-SUB)     25360000
253700                                    MR-PKSL-ITM-QTY  (PV-SUB)     25370000
253800                                    MR-UNT-COST-AMT  (PV-SUB)     25380000
253900                                    MR-COLOR-DESC    (PV-SUB)     25390000
254000                                    MR-VEND-DESC     (PV-SUB)     25400000
254100                                    MR-SIZE-DESC     (PV-SUB)     25410000
254200     ELSE                                                         25420000
254300         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     25430000
254400                                                             SPACE25440000
254500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25450000
254600                                 TO MR-SELECTI (PV-SUB)           25460000
254700         ELSE                                                     25470000
254800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      25480000
254900                                 TO MR-SELECTI (PV-SUB)           25490000
255000         END-IF                                                   25500000
255100                                                                  25510000
255200         IF DP030-SET-CURSOR-TRAILER                              25520000
255300            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  25530000
255400                                                             SPACE25540000
255500               OR PV-SUB = 1                                      25550000
255600                SET DP030-SET-CURSOR-APPL-1                       25560000
255700                                 TO TRUE                          25570000
255800                MOVE -1          TO MR-SELECTL (PV-SUB)           25580000
255900            END-IF                                                25590000
256000         END-IF                                                   25600000
256100                                                                  25610000
256200         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            25620000
256300             MOVE ASC-ACTION         (ASC-BLK-SUB ASC-ITEM-SUB)   25630000
256400                                 TO MR-ACTION          (PV-SUB)   25640000
256500             MOVE ASC-PKSL-LNE-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)   25650000
256600                                 TO MR-PKSL-LNE-NBR    (PV-SUB)   25660000
256700             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   25670000
256800                                 TO MR-VEND-STYL-NAME  (PV-SUB)   25680000
256900             MOVE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   25690000
257000                                 TO MR-PKSL-ITM-QTY-EDITTED       25700000
257100                                                       (PV-SUB)   25710000
257200             MOVE ASC-UNT-COST-AMT-N (ASC-BLK-SUB ASC-ITEM-SUB)   25720000
257300                                 TO MR-UNT-COST-AMT-EDITTED       25730000
257400                                                       (PV-SUB)   25740000
257500             MOVE ASC-COLOR-DESC     (ASC-BLK-SUB ASC-ITEM-SUB)   25750000
257600                                 TO MR-COLOR-DESC      (PV-SUB)   25760000
257700             MOVE ASC-VEND-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   25770000
257800                                 TO MR-VEND-DESC       (PV-SUB)   25780000
257900             MOVE ASC-SIZE-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   25790000
258000                                 TO MR-SIZE-DESC       (PV-SUB)   25800000
258100         END-IF                                                   25810000
258200     END-IF.                                                      25820000
258300                                                                  25830000
258400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               25840000
258500                                                                  25850000
258600     IF ASC-ITEM-SUB < +1                                         25860000
258700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25870000
258800         MOVE +1                 TO ASC-BLK-SUB.                  25880000
258900                                                                  25890000
259000 4430-CHECK-FOR-BEGIN-AND-END.                                    25900000
259100                                                                  25910000
259200     IF ASC-START-OF-SELECTED-RANGE > ZERO                        25920000
259300        IF ASC-END-OF-SELECTED-RANGE = ZERO                       25930000
259400            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              25940000
259500            SET DP020-MSG-WARNING                                 25950000
259600                                 TO TRUE                          25960000
259700                                                                  25970000
259800            PERFORM 4431-POSITION-AT-WARNING                      25980000
259900                                                                  25990000
260000         END-IF                                                   26000000
260100     ELSE                                                         26010000
260200         IF ASC-END-OF-SELECTED-RANGE > ZERO                      26020000
260300             MOVE PC-TSYMSG-00053                                 26030000
260400                                 TO DP020-MSG-NUMBER              26040000
260500             SET DP020-MSG-WARNING                                26050000
260600                                 TO TRUE                          26060000
260700                                                                  26070000
260800             PERFORM 4431-POSITION-AT-WARNING                     26080000
260900                                                                  26090000
261000         END-IF                                                   26100000
261100     END-IF.                                                      26110000
261200                                                                  26120000
261300 4431-POSITION-AT-WARNING.                                        26130000
261400                                                                  26140000
261500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               26150000
261600                                                  PV-TOP-ITEM + 1.26160000
261700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       26170000
261800         CONTINUE                                                 26180000
261900     ELSE                                                         26190000
262000         SET DP030-SET-CURSOR-APPL-1                              26200000
262100                                 TO TRUE                          26210000
262200         MOVE -1                 TO MR-SELECTL (PV-SUB)           26220000
262300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           26230000
262400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           26240000
262500     END-IF.                                                      26250000
262600                                                                  26260000
262700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.26270000
262800                                                                  26280000
262900     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       26290000
263000         CONTINUE                                                 26300000
263100     ELSE                                                         26310000
263200         SET DP030-SET-CURSOR-APPL-1                              26320000
263300                                 TO TRUE                          26330000
263400         MOVE -1                 TO MR-SELECTL (PV-SUB)           26340000
263500         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           26350000
263600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           26360000
263700     END-IF.                                                      26370000
263800                                                                  26380000
263900 5000-PREPARE-SEL-QUEUE.                                          26390000
264000                                                                  26400000
264100     MOVE +1                     TO ASC-BLK-SUB.                  26410000
264200                                                                  26420000
264300     PERFORM 5100-WRITE-TEMP-STORAGE.                             26430000
264400                                                                  26440000
264500     ADD +1                      TO ASC-BLK-SUB.                  26450000
264600                                                                  26460000
264700     PERFORM 5100-WRITE-TEMP-STORAGE.                             26470000
264800                                                                  26480000
264900     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         26490000
265000                                                                  26500000
265100     PERFORM 6010-DELETE-SEL-QUEUE.                               26510000
265200                                                                  26520000
265300     SET ASC-UPDATE-TSQ      TO TRUE.                             26530000
265400                                                                  26540000
265500                                                                  26550000
265600     SET RC013-IDX               TO 1.                            26560000
265700     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     26570000
265800     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        26580000
265900                                                                  26590000
266000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           26600000
266100         VARYING PV-ITEM  FROM 1 BY 1                             26610000
266200         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.             26620000
266300                                                                  26630000
266400     IF RC013-IDX > 1                                             26640000
266500         PERFORM 5205-WRITE-SEL-QUEUE                             26650000
266600         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      26660000
266700     END-IF.                                                      26670000
266800                                                                  26680000
266900 5100-WRITE-TEMP-STORAGE.                                         26690000
267000                                                                  26700000
267100     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    26710000
267200                                 TO PV-LIST-ITEM-NUMBER.          26720000
267300     COMPUTE PV-BLOCK-NUMBER = 1 +                                26730000
267400                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).26740000
267500                                                                  26750000
267600     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           26760000
267700        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       26770000
267800                                                                  26780000
267900            PERFORM 5105-REWRITE-ASC-LISTQ                        26790000
268000                                                                  26800000
268100        END-IF                                                    26810000
268200     ELSE                                                         26820000
268300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       26830000
268400                                     ASC-HIGHEST-BLOCK-WRITTEN + 126840000
268500         PERFORM 5110-WRITE-ASC-LISTQ                             26850000
268600                                                                  26860000
268700         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     26870000
268800     END-IF.                                                      26880000
268900                                                                  26890000
269000     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     26900000
269100                                 TO TRUE.                         26910000
269200                                                                  26920000
269300 5105-REWRITE-ASC-LISTQ.                                          26930000
269400                                                                  26940000
269500     EXEC CICS WRITEQ TS                                          26950000
269600               QUEUE   (ASC-LIST-QUEUE-NAME)                      26960000
269700               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           26970000
269800               ITEM    (PV-BLOCK-NUMBER)                          26980000
269900               REWRITE                                            26990000
270000               RESP    (PV-CICS-RESP)                             27000000
270100     END-EXEC.                                                    27010000
270200                                                                  27020000
270300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       27030000
270400         SET DP013-CICS-ABEND                                     27040000
270500             DP013-NO-ROLLBACK   TO TRUE                          27050000
270600         MOVE '5105-REWRITE-ASC-LISTQ'                            27060000
270700                                 TO DP013-PARAGRAPH               27070000
270800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'27080000
270900                                 TO DP013-MESSAGE-TEXT (1)        27090000
271000         PERFORM DP013-0000-PROCESS-ABEND                         27100000
271100     END-IF.                                                      27110000
271200                                                                  27120000
271300 5110-WRITE-ASC-LISTQ.                                            27130000
271400                                                                  27140000
271500     EXEC CICS WRITEQ TS                                          27150000
271600               QUEUE (ASC-LIST-QUEUE-NAME)                        27160000
271700               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            27170000
271800               ITEM  (PV-BLOCK-NUMBER)                            27180000
271900               RESP  (PV-CICS-RESP)                               27190000
272000     END-EXEC.                                                    27200000
272100                                                                  27210000
272200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      27220000
272300         SET DP013-CICS-ABEND                                     27230000
272400             DP013-NO-ROLLBACK   TO TRUE                          27240000
272500         MOVE '5110-WRITE-ASC-LISTQ'                              27250000
272600                                 TO DP013-PARAGRAPH               27260000
272700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  27270000
272800                                 TO DP013-MESSAGE-TEXT (1)        27280000
272900         PERFORM DP013-0000-PROCESS-ABEND                         27290000
273000     END-IF.                                                      27300000
273100                                                                  27310000
273200 5200-FILL-SEL-QUEUE-RECORD.                                      27320000
273300                                                                  27330000
273400     PERFORM 6112-READ-LIST-QUEUE.                                27340000
273500                                                                  27350000
273600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           27360000
273700         PERFORM                                                  27370000
273800         VARYING LQW-IDX  FROM 1 BY 1                             27380000
273900         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  27390000
274000                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27400000
274100                                                                  27410000
274200             IF LQW-SELECT (LQW-IDX)                              27420000
274300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27430000
274400                                 TO RC013-ITEM         (RC013-IDX)27440000
274500                 MOVE LQW-PKSL-LNE-NBR     (LQW-IDX)              27450000
274600                                 TO RC013-PKSL-LNE-NBR-N          27460000
274700                                                       (RC013-IDX)27470000
274800                 MOVE SPACE      TO RC013-ACTION-SW    (RC013-IDX)27480000
274900                 SET RC013-IDX UP BY 1                            27490000
275000                 IF RC013-IDX > RC013-MAX-ITEMS                   27500000
275100                                                                  27510000
275200                     PERFORM 5205-WRITE-SEL-QUEUE                 27520000
275300                                                                  27530000
275400                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      27540000
275500                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         27550000
275600                     SET RC013-IDX                                27560000
275700                                 TO 1                             27570000
275800                 END-IF                                           27580000
275900             END-IF                                               27590000
276000         END-PERFORM                                              27600000
276100     END-IF.                                                      27610000
276200                                                                  27620000
276300 5205-WRITE-SEL-QUEUE.                                            27630000
276400                                                                  27640000
276500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27650000
276600                                 TO RC013-SELECTED-ITEMS.         27660000
276700                                                                  27670000
276800     EXEC CICS WRITEQ TS                                          27680000
276900               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     27690000
277000               FROM  (RC013-DC-SELECT-RECORD)                     27700000
277100               ITEM  (PV-SEL-QUEUE-ITEM)                          27710000
277200               RESP  (PV-CICS-RESP)                               27720000
277300     END-EXEC.                                                    27730000
277400                                                                  27740000
277500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       27750000
277600         SET DP013-CICS-ABEND                                     27760000
277700             DP013-NO-ROLLBACK   TO TRUE                          27770000
277800         MOVE '5205-WRITE-SEL-QUEUE'                              27780000
277900                                 TO DP013-PARAGRAPH               27790000
278000         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   27800000
278100                                 TO DP013-MESSAGE-TEXT (1)        27810000
278200         PERFORM DP013-0000-PROCESS-ABEND                         27820000
278300     END-IF.                                                      27830000
278400                                                                  27840000
278500 6000-REFRESH-PANEL-FROM-TEMP.                                    27850000
278600                                                                  27860000
278700     IF ASC-UPDATE-TSQ                                            27870000
278800         SET ASC-NO-TSQ-UPDATE   TO TRUE                          27880000
278900         MOVE ZERO               TO PV-SAVE-ITEM                  27890000
279000                                    PV-SEL-QUEUE-ITEM             27900000
279100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27910000
279200                                 TO PV-HOLD-SELECTED-ITEMS        27920000
279300         PERFORM 6100-UPDATE-TSQ                                  27930000
279400           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS27940000
279500                                                                  27950000
279600         PERFORM 6010-DELETE-SEL-QUEUE                            27960000
279700                                                                  27970000
279800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27980000
279900                    ASC-BLOCK-ENTRIES (2)                         27990000
280000                                                                  28000000
280100         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 28010000
280200                GIVING    PV-BLOCK-NUMBER                         28020000
280300                REMAINDER PV-REMAINDER                            28030000
280400                                                                  28040000
280500         IF PV-REMAINDER > ZERO                                   28050000
280600             ADD +1              TO PV-BLOCK-NUMBER               28060000
280700         END-IF                                                   28070000
280800                                                                  28080000
280900         MOVE +1                 TO ASC-BLK-SUB                   28090000
281000                                                                  28100000
281100         PERFORM 4410-READ-TEMP-STORAGE                           28110000
281200                                                                  28120000
281300         ADD +1                  TO ASC-BLK-SUB                   28130000
281400                            PV-BLOCK-NUMBER                       28140000
281500         PERFORM 4410-READ-TEMP-STORAGE                           28150000
281600                                                                  28160000
281700     END-IF.                                                      28170000
281800                                                                  28180000
281900 6010-DELETE-SEL-QUEUE.                                           28190000
282000                                                                  28200000
282100     EXEC CICS DELETEQ TS                                         28210000
282200               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     28220000
282300               RESP  (PV-CICS-RESP)                               28230000
282400     END-EXEC.                                                    28240000
282500                                                                  28250000
282600     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     28260000
282700         (PV-CICS-RESP = DFHRESP (QIDERR)))                       28270000
282800         CONTINUE                                                 28280000
282900     ELSE                                                         28290000
283000         SET DP013-CICS-ABEND                                     28300000
283100             DP013-NO-ROLLBACK   TO TRUE                          28310000
283200         MOVE '6010-DELETE-SEL-QUEUE'                             28320000
283300                                 TO DP013-PARAGRAPH               28330000
283400         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  28340000
283500                                 TO DP013-MESSAGE-TEXT (1)        28350000
283600         PERFORM DP013-0000-PROCESS-ABEND                         28360000
283700     END-IF.                                                      28370000
283800                                                                  28380000
283900 6100-UPDATE-TSQ.                                                 28390000
284000                                                                  28400000
284100     ADD 1                       TO PV-SEL-QUEUE-ITEM.            28410000
284200                                                                  28420000
284300     PERFORM 6105-READ-SEL-QUEUE.                                 28430000
284400                                                                  28440000
284500     PERFORM                                                      28450000
284600     VARYING RC013-IDX  FROM 1 BY 1                               28460000
284700     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       28470000
284800             RC013-IDX > RC013-MAX-ITEMS                          28480000
284900                                                                  28490000
285000         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   28500000
285100            PERFORM 6110-PROCESS-ITEMS                            28510000
285200            SET PS-WRITE-LIST-QUEUE                               28520000
285300                                 TO TRUE                          28530000
285400         END-IF                                                   28540000
285500                                                                  28550000
285600         ADD +1                  TO PV-ITEMS-PROCESSED            28560000
285700     END-PERFORM.                                                 28570000
285800                                                                  28580000
285900     IF PS-WRITE-LIST-QUEUE                                       28590000
286000         PERFORM 6111-WRITE-LIST-QUEUE                            28600000
286100     END-IF.                                                      28610000
286200                                                                  28620000
286300                                                                  28630000
286400 6105-READ-SEL-QUEUE.                                             28640000
286500                                                                  28650000
286600     EXEC CICS READQ TS                                           28660000
286700               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     28670000
286800               INTO  (RC013-DC-SELECT-RECORD)                     28680000
286900               ITEM  (PV-SEL-QUEUE-ITEM)                          28690000
287000               RESP  (PV-CICS-RESP)                               28700000
287100     END-EXEC.                                                    28710000
287200                                                                  28720000
287300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       28730000
287400         SET DP013-CICS-ABEND                                     28740000
287500             DP013-NO-ROLLBACK   TO TRUE                          28750000
287600         MOVE '6105-READ-SEL-QUEUE'                               28760000
287700                                 TO DP013-PARAGRAPH               28770000
287800         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    28780000
287900                                 TO DP013-MESSAGE-TEXT (1)        28790000
288000         PERFORM DP013-0000-PROCESS-ABEND                         28800000
288100     END-IF.                                                      28810000
288200                                                                  28820000
288300 6110-PROCESS-ITEMS.                                              28830000
288400                                                                  28840000
288500     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          28850000
288600                                            / PC-ITEMS-PER-PANEL).28860000
288700                                                                  28870000
288800     IF PV-ITEM NOT = PV-SAVE-ITEM                                28880000
288900        IF PV-SAVE-ITEM NOT = ZERO                                28890000
289000                                                                  28900000
289100            PERFORM 6111-WRITE-LIST-QUEUE                         28910000
289200                                                                  28920000
289300        END-IF                                                    28930000
289400        MOVE PV-ITEM             TO PV-SAVE-ITEM                  28940000
289500                                                                  28950000
289600        PERFORM 6112-READ-LIST-QUEUE                              28960000
289700        IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                     28970000
289800            CONTINUE                                              28980000
289900        END-IF                                                    28990000
290000     END-IF.                                                      29000000
290100                                                                  29010000
290200     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   29020000
290300                                    LQW-LIST-ITEM-NUMBER (1)) + 1.29030000
290400     SET LQW-DESELECT (PV-SUB)   TO TRUE                          29040000
290500     MOVE LQW-SELECTED-SW (PV-SUB)                                29050000
290600                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).29060000
290700     EVALUATE TRUE                                                29070000
290800         WHEN RC013-INQ (RC013-IDX)                               29080000
290900              MOVE PC-INQ        TO LQW-ACTION (PV-SUB)           29090000
291000                                                                  29100000
291100         WHEN RC013-UPD (RC013-IDX)                               29110000
291200              MOVE PC-UPD        TO LQW-ACTION (PV-SUB)           29120000
291300                                                                  29130000
291400         WHEN RC013-DEL (RC013-IDX)                               29140000
291500              MOVE PC-DEL        TO LQW-ACTION (PV-SUB)           29150000
291600                                                                  29160000
291700         WHEN RC013-ERR (RC013-IDX)                               29170000
291800              MOVE PC-ERR        TO LQW-ACTION (PV-SUB)           29180000
291900     END-EVALUATE.                                                29190000
292000                                                                  29200000
292100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29210000
292200                                                                  29220000
292300 6111-WRITE-LIST-QUEUE.                                           29230000
292400                                                                  29240000
292500     EXEC CICS WRITEQ TS                                          29250000
292600               QUEUE (ASC-LIST-QUEUE-NAME)                        29260000
292700               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   29270000
292800               ITEM  (PV-SAVE-ITEM)                               29280000
292900               REWRITE                                            29290000
293000               RESP  (PV-CICS-RESP)                               29300000
293100     END-EXEC.                                                    29310000
293200                                                                  29320000
293300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       29330000
293400         SET DP013-CICS-ABEND                                     29340000
293500             DP013-NO-ROLLBACK   TO TRUE                          29350000
293600         MOVE '6111-WRITE-LIST-QUEUE'                             29360000
293700                                 TO DP013-PARAGRAPH               29370000
293800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'29380000
293900                                 TO DP013-MESSAGE-TEXT(1)         29390000
294000         PERFORM DP013-0000-PROCESS-ABEND                         29400000
294100     END-IF.                                                      29410000
294200                                                                  29420000
294300 6112-READ-LIST-QUEUE.                                            29430000
294400                                                                  29440000
294500     EXEC CICS READQ TS                                           29450000
294600               QUEUE (ASC-LIST-QUEUE-NAME)                        29460000
294700               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   29470000
294800               ITEM  (PV-ITEM)                                    29480000
294900               RESP  (PV-CICS-RESP)                               29490000
295000     END-EXEC.                                                    29500000
295100                                                                  29510000
295200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       29520000
295300         SET DP013-CICS-ABEND                                     29530000
295400             DP013-NO-ROLLBACK   TO TRUE                          29540000
295500         MOVE '6112-READ-LIST-QUEUE'                              29550000
295600                                 TO DP013-PARAGRAPH               29560000
295700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   29570000
295800                                 TO DP013-MESSAGE-TEXT(1)         29580000
295900         PERFORM DP013-0000-PROCESS-ABEND                         29590000
296000     END-IF.                                                      29600000
296100                                                                  29610000
296200/                                                                 29620000
296300******************************************************************29630000
296400* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *29640000
296500******************************************************************29650000
296600 6200-DEL-LIST-QUEUE.                                             29660000
296700                                                                  29670000
296800     EXEC CICS                                                    29680000
296900         DELETEQ TS                                               29690000
297000             QUEUE (ASC-LIST-QUEUE-NAME)                          29700000
297100             RESP  (PV-CICS-RESP)                                 29710000
297200     END-EXEC.                                                    29720000
297300                                                                  29730000
297400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      29740000
297500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         29750000
297600         CONTINUE                                                 29760000
297700     ELSE                                                         29770000
297800        SET DP013-CICS-ABEND       TO TRUE                        29780000
297900        SET DP013-NO-ROLLBACK      TO TRUE                        29790000
298000        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             29800000
298100        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               29810000
298200                                   TO DP013-MESSAGE-TEXT (1)      29820000
298300        PERFORM DP013-0000-PROCESS-ABEND                          29830000
298400     END-IF.                                                      29840000
298500                                                                  29850000
298600/                                                                 29860000
298700******************************************************************29870000
298800* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *29880000
298900******************************************************************29890000
299000 9100-READ-SEL-QUEUE.                                             29900000
299100     EXEC CICS                                                    29910000
299200         READQ TS                                                 29920000
299300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        29930000
299400             INTO  (RC013-DC-SELECT-RECORD)                       29940000
299500             ITEM  (ASC-SEL-ITEM)                                 29950000
299600             RESP  (PV-CICS-RESP)                                 29960000
299700     END-EXEC.                                                    29970000
299800                                                                  29980000
299900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        29990000
300000         CONTINUE                                                 30000000
300100     ELSE                                                         30010000
300200         SET DP013-LOGIC-ABEND                                    30020000
300300             DP013-NO-ROLLBACK     TO TRUE                        30030000
300400         MOVE '9100-READ-SEL-QUEUE'                               30040000
300500                                   TO DP013-PARAGRAPH             30050000
300600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    30060000
300700                                   TO DP013-MESSAGE-TEXT (1)      30070000
300800         PERFORM DP013-0000-PROCESS-ABEND                         30080000
300900     END-IF.                                                      30090000
301000                                                                  30100000
301100/                                                                 30110000
301200******************************************************************30120000
301300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *30130000
301400******************************************************************30140000
301500 9200-REWRITE-LIST-QUEUE.                                         30150000
301600     EXEC CICS                                                    30160000
301700          WRITEQ TS                                               30170000
301800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     30180000
301900              FROM    (RC013-DC-SELECT-RECORD)                    30190000
302000              ITEM    (ASC-SEL-ITEM)                              30200000
302100              RESP    (PV-CICS-RESP)                              30210000
302200              REWRITE                                             30220000
302300     END-EXEC.                                                    30230000
302400                                                                  30240000
302500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    30250000
302600         SET DP013-CICS-ABEND                                     30260000
302700             DP013-NO-ROLLBACK     TO TRUE                        30270000
302800         MOVE '9200-REWRITE-LIST-QUEUE'                           30280000
302900                                   TO DP013-PARAGRAPH             30290000
303000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30300000
303100                                   TO DP013-MESSAGE-TEXT (1)      30310000
303200         PERFORM DP013-0000-PROCESS-ABEND                         30320000
303300     END-IF.                                                      30330000
303400                                                                  30340000
303500******************************************************************30350000
303600*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *30360000
303700*    AND THE ERROR SWITCHES.                                     *30370000
303800******************************************************************30380000
303900 9900-SOFT-ABORT.                                                 30390000
304000     SET PS-ERROR        TO TRUE.                                 30400000
304100     SET DP020-MSG-FATAL TO TRUE.                                 30410000
304200     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    30420000
304300     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       30430000
304400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          30440000
304500     PERFORM 0001-CALL-CICS-ARCH-API.                             30450000
304600******************************************************************30460000
304700*    ABEND PROCESSING                                             30470000
304800******************************************************************30480000
304900     COPY DPPD013.                                                30490000
