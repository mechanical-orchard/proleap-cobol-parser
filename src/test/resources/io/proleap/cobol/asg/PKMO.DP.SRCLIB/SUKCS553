000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS553.                                         00040000
000500 AUTHOR.        LYNN MCADAMS.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  APRIL, 2000.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S553 - PO/RECEIVER CARTON LIST PROGRAM.                    * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM CREATES A SCREEN THAT WILL LIST ALL CARTONS   * 00130000
001400*    (SERIAL SHIP CODES) FOR A PO/RECEIVER.  THE SCREEN CAN     * 00140000
001500*    EITHER BE ACCESSED FROM THE CRIT SPEC SCREEN (F24) OR FROM * 00150000
001600*    THE PO/RECEIVER CHECK-IN STATUS SCREEN (F23).              * 00160000
001800*---------------------------------------------------------------* 00171049
001500*    CHANGES                                                     *00172049
      *    MADE BY: CHERI PARMLEY                                      *00173049
      *    DATE:    09/24/2014                                         *00174049
      *                                                                *00175049
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00176049
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00177049
      *                                                                *00178049
001600*----------------------------------------------------------------*00179049
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00179254
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00179354
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00179454
001130*                                                                 00179555
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00179655
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00179755
263968*---------------------------------------------------------------* 00179854
001800*                                                                 00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002600     05  DK-OPER-UNT-ID                 PIC S9(04) COMP VALUE +0. 00260000
002700     05  DK-SCAC-ID                     PIC  X(04).               00270000
002800     05  DK-VEH-NBR                     PIC  X(10).               00280000
002900     05  DK-TRIP-ID                     PIC S9(09) COMP VALUE +0. 00290000
003000     05  DK-PO-NBR                      PIC S9(09) COMP VALUE +0. 00300000
003100     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP VALUE +0. 00310000
003200                                                                  00320000
003300 01  PC-PROGRAM-CONSTANTS.                                        00330000
003400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340000
003500                                                    'SUK553  '.   00350000
003600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360000
003700                                                    'SUKM553 '.   00370000
003800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380000
003900                                                    'SUKCS553'.   00390000
004000     05  PC-LOCATION-MODULE             PIC X(08)   VALUE         00400041
004100                                                    'XLKUT071'.   00410041
004200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00420000
004300     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00430000
004400     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00440000
004500     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00450000
004600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00460000
004700                                                    COMP SYNC.    00470000
004800     05  PC-MAX-ITEMS                   PIC S9(09) VALUE +1000000 00480000
004900                                                    COMP-3.       00490000
005000     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00500000
005100                                                    COMP SYNC.    00510000
005200     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00520000
005300                                                    COMP SYNC.    00530000
005400     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00540000
005500                                                    COMP-3.       00550000
005600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00560000
005700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00570000
005800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00580000
005900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00590000
006000     05  PC-NEW                         PIC  X(02)  VALUE 'NW'.   00600000
006100     05  PC-SLASH                       PIC  X(01)  VALUE '/'.    00610000
006200     05  PC-COLON                       PIC  X(01)  VALUE ':'.    00620000
006300     05  PC-ZERO                        PIC  S9(04) VALUE ZERO    00630000
006400                                                    COMP.         00640000
006500     05  PC-01                     PIC  X(02)  VALUE '01'.        00650000
006600     05  PC-A                      PIC  X(01)  VALUE 'A'.         00660000
006700*                                                                 00670000
006800*                                                                 00680000
006900*----------------------------------------------------------------*00690000
007000*  DESCRIPTION CONSTANTS                                         *00700000
007100*----------------------------------------------------------------*00710000
007200*                                                                 00720000
007300*----------------------------------------------------------------*00730000
007400*  SYSTEM MESSAGES                                               *00740000
007500*----------------------------------------------------------------*00750000
007600*   00005 = INVALID VALUE                                        *00760000
007700*   00007 = REQUIRED ENTRY                                       *00770000
007800*   00008 = MUST BE NUMERIC                                      *00780000
007900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00790000
008000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00800000
008100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00810000
008200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00820000
008300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00830000
008400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00840000
008500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00850000
008600*   00069 - TOP OF LIST                                          *00860000
008700*   00070 - BOTTOM OF LIST                                       *00870000
008800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00880000
008900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00890000
009000*   00279 - MORE ITEMS TO DISPLAY                                *00900000
009100*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00910000
009200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00920000
009300*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*00930000
009400*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *00940000
009500*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *00950000
009600*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*00960000
009700*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00970000
009800*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB00980000
009900*   99901 = INVALID COMMAND WAS ENTERED                          *00990000
010000*----------------------------------------------------------------*01000000
010100     05  PC-TSYMSG-NUMBERS.                                       01010000
010200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01020000
010300         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01030000
010400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01040000
010500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01050000
010600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01060000
010700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01070000
010800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01080000
010900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01090000
011000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01100000
011100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01110000
011200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01120000
011300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01130000
011400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01140000
011500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01150000
011600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01160000
011700         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01170000
011800         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01180000
011900         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01190000
012000         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01200000
012100         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01210000
012200         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01220000
012300         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01230000
012400         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01240000
012500         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01250000
012600         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  01260000
012700         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  01270000
012800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01280000
012900                                                                  01290000
013000 01  PS-PROGRAM-SWITCHES.                                         01300000
013100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01310000
013200         88  PS-NO-ERROR                            VALUE 'Y'.    01320000
013300         88  PS-ERROR                               VALUE 'N'.    01330000
013400*                                                                 01340000
013500     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01350000
013600         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01360000
013700         88  PS-BLOCK-ERROR                         VALUE 'N'.    01370000
013800*                                                                 01380000
013900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01390000
014000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01400000
014100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01410000
014200*                                                                 01420000
014300     05  PS-EO-CARTON-CSR-SW            PIC  X(01)  VALUE  'N'.   01430000
014400         88  PS-EO-CARTON-CSR                       VALUE  'Y'.   01440000
014500         88  PS-NOT-EO-CARTON-CSR                   VALUE  'N'.   01450000
014600*                                                                 01460000
014700     05  PS-EO-SHIPT-CSR-SW             PIC  X(01)  VALUE  'N'.   01470000
014800         88  PS-EO-SHIPT-CSR                        VALUE  'Y'.   01480000
014900         88  PS-NOT-EO-SHIPT-CSR                    VALUE  'N'.   01490000
015000*                                                                 01500000
015100     05  PS-USE-SHIPT-CSR-SW            PIC  X(01)  VALUE  'N'.   01510000
015200         88  PS-USE-SHIPT-CSR                       VALUE  'Y'.   01520000
015300*                                                                 01530000
015400     05  PS-EOF-SULBXF-CSR-SW           PIC  X(01)  VALUE  'N'.   01540000
015500         88  PS-EOF-SULBXF-CSR                      VALUE  'Y'.   01550000
015600         88  PS-NOT-EOF-SULBXF-CSR                  VALUE  'N'.   01560000
015700*                                                                 01570000
015800     05  PS-SULBXF-FOUND-SW             PIC  X(01)  VALUE  'N'.   01580000
015900         88  PS-SULBXF-FOUND                        VALUE  'Y'.   01590000
016000         88  PS-NO-SULBXF-FOUND                     VALUE  'N'.   01600000
016100*                                                                 01610000
016200     05  PS-ACTIVE-STAT-SW              PIC  X(01)  VALUE  'N'.   01620000
016300         88  PS-NO-ACTIVE-FND                       VALUE  'Y'.   01630000
016400         88  PS-ACTIVE-FND                          VALUE  'N'.   01640000
016500*                                                                 01650000
016600     05  PS-INACTIVE-STAT-SW            PIC  X(01)  VALUE  'N'.   01660000
016700         88  PS-NO-INACTIVE-FND                     VALUE  'Y'.   01670000
016800*                                                                 01680000
016900     05  PS-CARTON-CSR-SW               PIC  X(01)  VALUE  'N'.   01690000
017000         88  PS-CARTON-CSR-FIRST                    VALUE  'Y'.   01700000
017100         88  PS-NOT-CARTON-CSR-FIRST                VALUE  'N'.   01710000
017200*                                                                 01720000
017300     05  PS-RECORD-IND-SW               PIC  X(01)  VALUE  'N'.   01730000
017400         88  PS-MORE-RECORDS                        VALUE  'Y'.   01740000
017500         88  PS-NO-MORE-RECORDS                     VALUE  'N'.   01750000
017600*                                                                 01760000
017700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01770000
017800         88  PS-LIST-END                            VALUE 'Y'.    01780000
017900         88  PS-NO-LIST-END                         VALUE 'N'.    01790000
018000*                                                                 01800000
018100*                                                                 01810004
018200     05  PS-PBS-ERROR-CTN-FOUND-SW      PIC  X(01)  VALUE 'N'.    01820004
018300         88  PS-PBS-ERROR-CTN-FOUND                 VALUE 'Y'.    01830004
018400         88  PS-PBS-ERROR-CTN-FOUND-NO              VALUE 'N'.    01840004
018500*                                                                 01850004
018600*                                                                 01860000
018700 01  PV-PROGRAM-VARIABLES.                                        01870000
018800     05  PV-CICS-RESP                   PIC S9(08)  VALUE ZEROS   01880031
018900                                        COMP SYNC.                01890000
019000     05  PV-SUB                         PIC S9(04)  VALUE +0      01900000
019100                                                    COMP SYNC.    01910000
019200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01920000
019300                                                    COMP SYNC.    01930000
019400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01940000
019500                                                    COMP-3.       01950000
019600     05  PV-DB2-COUNT-CARTONS           PIC S9(09)  VALUE +0      01960027
019700                                                    COMP-3.       01970027
019800     05  PV-DB2-COUNT-PBS-ERRORS        PIC S9(09)  VALUE +0      01980027
019900                                                    COMP-3.       01990027
020000     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02000000
020100                                                    COMP SYNC.    02010000
020200     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02020000
020300     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02030000
020400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02040000
020500                                                    COMP-3.       02050000
020600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02060000
020700                                                    COMP-3.       02070000
020800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02080000
020900                                                    COMP-3.       02090000
021000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02100000
021100                                                    COMP-3.       02110000
021200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02120000
021300                                                    COMP-3.       02130000
021400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02140000
021500                                                    COMP-3.       02150000
021600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02160000
021700                                                    COMP SYNC.    02170000
021800     05  PV-ITEM                        PIC S9(04)  VALUE +0      02180000
021900                                                    COMP SYNC.    02190000
022000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02200000
022100                                                    COMP SYNC.    02210000
022200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02220000
022300                                                    COMP SYNC.    02230000
022400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02240000
022500                                                    COMP SYNC.    02250000
022600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02280000
022900                                                    COMP SYNC.    02290000
023000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02300000
023100                                                    COMP SYNC.    02310000
023200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02320000
023300                                                    COMP SYNC.    02330000
023400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02340000
023500                                                    COMP SYNC.    02350000
023600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02360000
023700                                                    COMP SYNC.    02370000
023800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02380000
023900                                                    COMP SYNC.    02390000
024000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02400000
024100                                                    COMP SYNC.    02410000
024200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02420000
024300                                                    COMP SYNC.    02430000
024400     05  PV-UNION-TYPE                  PIC  X(01).               02440000
024500     05  PV-UNION-TYPE-2                PIC  X(01).               02450000
024600*                                                                 02460000
024700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02470000
024800                                                     COMP SYNC.   02480000
024900     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.02490000
025000     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.02500000
025100     05  PV-CICS-MSG-HOLD.                                        02510000
025200         10  FILLER                      PIC  X(01)  VALUE SPACES.02520000
025300         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACES.02530000
025400     05  PV-CICS-MSG-HOLD2.                                       02540000
025500         10  FILLER                      PIC  X(01)  VALUE SPACES.02550000
025600         10  PV-CICS-MSG-DATA2          PIC  X(99)  VALUE SPACES. 02560000
025700*                                                                 02570000
025800     05  PV-DTE-TME.                                              02580000
025900         10  PV-DTE                     PIC  X(10)  VALUE SPACES. 02590000
026000         10  FILLER                     PIC  X(01)  VALUE SPACES. 02600000
026100         10  PV-TME                     PIC  X(07)  VALUE SPACES. 02610000
026200*                                                                 02620000
026300 01  DN-DB2-NULL-INDICATORS.                                      02630000
026400     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROS.  02640031
026500*                                                                 02650000
026600 01  WS-SHUNLO-CRE-TMST.                                          02660000
026700     05  WS-SHUNLO-CRE-TMST-DATE        PIC X(10).                02670000
026800     05  WS-FILLER                      PIC X(01).                02680000
026900     05  WS-SHUNLO-CRE-TMST-TIME        PIC X(05).                02690000
027000 01  WS-SULXBF-LST-STAT-TMST.                                     02700000
027100     05  WS-SULBXF-LAST-STAT-DATE       PIC X(10).                02710000
027200     05  WS-FILLER                      PIC X(01).                02720000
027300     05  WS-SULBXF-LAST-STAT-TIME       PIC X(05).                02730000
027400*                                                                 02740000
027500 01  PV-TMST-BREAKDOWN.                                           02750000
027600     05  PV-TMST                        PIC X(26)   VALUE SPACES. 02760000
027700     05  PV-TMST-R REDEFINES  PV-TMST.                            02770000
027800         10   PV-TMST-CC                PIC X(02).                02780000
027900         10   PV-TMST-YY                PIC X(02).                02790000
028000         10   FILLER                    PIC X(01).                02800000
028100         10   PV-TMST-MM                PIC X(02).                02810000
028200         10   FILLER                    PIC X(01).                02820000
028300         10   PV-TMST-DD                PIC X(02).                02830000
028400         10   FILLER                    PIC X(01).                02840000
028500         10   PV-TMST-HRS               PIC X(02).                02850000
028600         10   FILLER                    PIC X(01).                02860000
028700         10   PV-TMST-MIN               PIC X(02).                02870000
028800         10   FILLER                    PIC X(01).                02880000
028900         10   PV-TMST-SEC               PIC X(02).                02890000
029000         10   FILLER                    PIC X(07).                02900000
029100     05  PV-DATE-TIME                   PIC X(26)   VALUE SPACES. 02910000
029200     05  PV-DATE-TIME-DISPLAY REDEFINES PV-DATE-TIME.             02920000
029300         10   PV-DISPLAY-MM             PIC X(02).                02930000
029400         10   PV-SLASH-1                PIC X(01).                02940000
029500         10   PV-DISPLAY-DD             PIC X(02).                02950000
029600         10   PV-SLASH-2                PIC X(01).                02960000
029700         10   PV-DISPLAY-CC             PIC X(02).                02970000
029800         10   PV-DISPLAY-YY             PIC X(02).                02980000
029900         10   PV-SPACES                 PIC X(01).                02990000
030000         10   PV-DISPLAY-HRS            PIC X(02).                03000000
030100         10   PV-COLON                  PIC X(01).                03010000
030200         10   PV-DISPLAY-MIN            PIC X(02).                03020000
030300         10   FILLER                    PIC X(10).                03030000
030400                                                                  03040000
030500 01  WS-ENROUTE-BREAKDOWN.                                        03050000
030600     05  WS-ENROUTE                     PIC X(07).                03060000
030700                                                                  03070000
030800     05  PV-ENROUTE-DISPLAY             PIC X(07)                 03080000
030900                                  VALUE 'ENROUTE'.                03090000
031000*                                                                 03100000
031100     05  PV-PO-RECEIVER.                                          03110000
      *CLP 09/24/2014                                                   03111049
031200         10  PV-PO-NBR      PIC 9(08).                            03120049
031300         10  FILLER         PIC X(01)  VALUE '-'.                 03130000
031400         10  PV-RECEIVER    PIC 9(03).                            03140000
031500*                                                                 03150000
031600     05  PV-OPER-UNT-ID                  PIC  S9(04) COMP.        03160000
031700     05  PV-FCLTY-ID                     PIC  S9(04) COMP.        03170000
031800     05  PV-SCAC-CDE                     PIC  X(04).              03180000
031900     05  PV-VEH-NBR                      PIC  X(10).              03190000
032000     05  PV-TRIP-ID                      PIC  S9(09) COMP.        03200000
032100     05  PV-DISP-TRIP                    PIC  S9(09) VALUE ZEROS. 03210034
032200     05  PV-SHIPT-UNT-ID                 PIC  S9(18) COMP-3.      03220000
032300     05  PV-DISP-SHIPT-ID                PIC  S9(18) VALUE ZEROS. 03230035
032400                                                                  03240031
      *CLP 09/24/2014                                                   03241049
032500     05  PV-DISP-PO                      PIC   9(08) VALUE ZEROS. 03250049
032600     05  PV-DISP-RCVR                    PIC   9(04) VALUE ZEROS. 03260031
032700     05  PV-DISP-CRE-TMST                PIC   X(26) VALUE SPACES.03270035
032800*                                                                 03280000
032900     05  PV-SEL-TERM-ID                  PIC  X(04).              03290000
033000     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03300000
033100     05  PV-SEL-SEQ                      PIC  9(01).              03310000
033200     05  PV-XREF-ROWS                    PIC  9(05).              03320000
033300*                                                                 03330000
033400*---------------------------------------------------------------* 03340000
033500*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03350000
033600*   THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          * 03360000
033700*   APPLICATION-SPECIFIC COMMAREA.                              * 03370000
033800*   ALL LQW LEVEL 10'S MUST MATCH ASC LEVEL 30'S.               * 03380000
033900*---------------------------------------------------------------* 03390000
034000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03400000
034100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACES. 03410000
034200     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           03420000
034300                                        INDEXED BY LQW-IDX.       03430000
034400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03440000
034500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03450000
034600         10  LQW-SELECTED-SW            PIC  X(01).               03460000
034700             88  LQW-SELECT                         VALUE 'S'.    03470000
034800             88  LQW-DESELECT                       VALUE ' '.    03480000
034900*                                                                 03490000
035000         10  LQW-ACTION                 PIC  X(03).               03500000
035100         10  LQW-SERIAL-SHIP-CDE        PIC  9(18).               03510000
035200         10  LQW-STR-NBR                PIC  9(04).               03520025
035300         10  LQW-CRE-SRC                PIC  X(03).               03530000
035400         10  LQW-DATE-TIME              PIC  X(16).               03540000
035500         10  LQW-LN-TRIP-ID             PIC  9(09).               03550000
035600         10  LQW-SCAC-CDE               PIC  X(04).               03560000
035700         10  LQW-VEH-NBR                PIC  X(10).               03570000
035800         10  LQW-CSR-IND                PIC  X(01).               03580000
035900         10  LQW-LBL-TYP-CDE            PIC  X(01).               03590000
036000         10  LQW-PBS-ERROR-SW           PIC  X(01).               03600005
036100             88  LQW-PBS-ERR-YES                   VALUE 'Y'.     03610004
036200             88  LQW-PBS-ERR-NO                    VALUE 'N'.     03620004
036300         10  LQW-ACTV-IND               PIC  X(01).               03630045
036400*                                                                 03640000
036500*                                                                 03650000
036600*---------------------------------------------------------------* 03660000
036700*  SELECTION QUEUE LAYOUT                                       * 03670000
036800*---------------------------------------------------------------* 03680000
036900     COPY SUWS004.                                                03690000
037000                                                                  03700000
037100                                                                  03710000
037200*---------------------------------------------------------------* 03720000
037300*    MAP LAYOUT                                                 * 03730000
037400*---------------------------------------------------------------* 03740000
037500*                                                                 03750000
037600     COPY SUKM553.                                                03760000
037700*                                                                 03770000
037800*DEFINITIONS MATCH SUKM553 MAPSET                                 03780000
      *CLP 09/24/2014                                                   03781051
037900 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK553O.       03790000
038000     05  FILLER                         PIC X(136).               03800053
038100     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          03810000
038200         10  MR-SELECTL                 PIC S9(04) COMP.          03820000
038300         10  MR-SELECTA                 PIC  X(01).               03830000
038400         10  MR-SELECTC                 PIC  X(01).               03840000
038500         10  MR-SELECTH                 PIC  X(01).               03850000
038600         10  MR-SELECTI                 PIC  X(01).               03860000
038700                                                                  03870000
038800         10  MR-ACTIONL                 PIC S9(04) COMP.          03880000
038900         10  MR-ACTIONA                 PIC  X(01).               03890000
039000         10  MR-ACTIONC                 PIC  X(01).               03900000
039100         10  MR-ACTIONH                 PIC  X(01).               03910000
039200         10  MR-ACTION                  PIC  X(03).               03920000
039300                                                                  03930000
039400         10  MR-SHIPL                   PIC S9(04) COMP.          03940000
039500         10  MR-SHIPA                   PIC  X(01).               03950000
039600         10  MR-SHIPC                   PIC  X(01).               03960000
039700         10  MR-SHIPH                   PIC  X(01).               03970000
039800         10  MR-SHIP                    PIC  X(18).               03980000
039900                                                                  03990045
040000         10  MR-ACTVL                   PIC S9(04) COMP.          04000045
040100         10  MR-ACTVA                   PIC  X(01).               04010045
040200         10  MR-ACTVC                   PIC  X(01).               04020045
040300         10  MR-ACTVH                   PIC  X(01).               04030045
040400         10  MR-ACTV                    PIC  X(01).               04040045
040500                                                                  04050000
040600         10  MR-STRL                    PIC S9(04) COMP.          04060000
040700         10  MR-STRA                    PIC  X(01).               04070000
040800         10  MR-STRC                    PIC  X(01).               04080000
040900         10  MR-STRH                    PIC  X(01).               04090000
041000         10  MR-STR                     PIC  X(04).               04100025
041100                                                                  04110000
041200         10  MR-SRCL                    PIC S9(04) COMP.          04120000
041300         10  MR-SRCA                    PIC  X(01).               04130000
041400         10  MR-SRCC                    PIC  X(01).               04140000
041500         10  MR-SRCH                    PIC  X(01).               04150000
041600         10  MR-SRC                     PIC  X(03).               04160000
041700                                                                  04170000
041800         10  MR-DATE-TIMEL              PIC S9(04) COMP.          04180000
041900         10  MR-DATE-TIMEA              PIC  X(01).               04190000
042000         10  MR-DATE-TIMEC              PIC  X(01).               04200000
042100         10  MR-DATE-TIMEH              PIC  X(01).               04210000
042200         10  MR-DATE-TIME               PIC  X(16).               04220000
042300                                                                  04230000
042400         10  MR-TRIPL                   PIC S9(04) COMP.          04240000
042500         10  MR-TRIPA                   PIC  X(01).               04250000
042600         10  MR-TRIPC                   PIC  X(01).               04260000
042700         10  MR-TRIPH                   PIC  X(01).               04270000
042800         10  MR-TRIP                    PIC  X(09).               04280000
042900                                                                  04290000
043000         10  MR-SCACL                   PIC S9(04) COMP.          04300000
043100         10  MR-SCACA                   PIC  X(01).               04310000
043200         10  MR-SCACC                   PIC  X(01).               04320000
043300         10  MR-SCACH                   PIC  X(01).               04330000
043400         10  MR-SCAC                    PIC  X(04).               04340000
043500                                                                  04350000
043600         10  MR-TRLRL                   PIC S9(04) COMP.          04360000
043700         10  MR-TRLRA                   PIC  X(01).               04370000
043800         10  MR-TRLRC                   PIC  X(01).               04380000
043900         10  MR-TRLRH                   PIC  X(01).               04390000
044000         10  MR-TRLR                    PIC  X(10).               04400000
044100                                                                  04410000
044200     05  FILLER                         PIC  X(12).               04420000
044300*                                                                 04430000
044400***************************************************************** 04440041
044500*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04450041
044600*             LOCATION MODULE (XLKUT071)                        * 04460041
044700***************************************************************** 04470041
044800     COPY XLWS071.                                                04480041
044900                                                                  04490041
045000*---------------------------------------------------------------* 04500000
045100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04510000
045200*---------------------------------------------------------------* 04520000
045300                                                                  04530000
045400     COPY DPWS015.                                                04540025
045500                                                                  04550000
045600*---------------------------------------------------------------* 04560000
045700*    FUNCTION KEYS COPYBOOK.                                    * 04570000
045800*---------------------------------------------------------------* 04580000
045900                                                                  04590000
046000     COPY DPWS016.                                                04600025
046100                                                                  04610000
046200*----------------------------------------------------------------*04620000
046300**  SECURITY SUBROUTINE PARAMETERS                                04630000
046400*----------------------------------------------------------------*04640000
046500                                                                  04650000
046600     COPY DPWS008.                                                04660025
046700                                                                  04670000
046800*---------------------------------------------------------------* 04680000
046900*    NUMERIC EDIT LAYOUT.                                       * 04690000
047000*---------------------------------------------------------------* 04700000
047100                                                                  04710000
047200     COPY DPWS010I.                                               04720025
047300 EJECT                                                            04730000
047400*---------------------------------------------------------------* 04740000
047500*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04750055
047600*---------------------------------------------------------------* 04760000
047700                                                                  04770000
047800     COPY DPWS030.                                                04780025
047800     COPY DPWS930.                                                04781055
047900 EJECT                                                            04790000
048000*---------------------------------------------------------------* 04800000
048100*    STANDARD COMMAREA.                                         * 04810000
048200*---------------------------------------------------------------* 04820000
048300                                                                  04830000
048400     COPY DPWS020.                                                04840025
048500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04850000
048600                                                                  04860000
048700*---------------------------------------------------------------* 04870000
048800* INTER-APPLICATION COMMAREA.                                   * 04880000
048900*   SUWS002 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04890000
049000*             SPEC SCREEN.                                      * 04900000
049100*   SUWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04910000
049200*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04920000
049300*---------------------------------------------------------------* 04930000
049400*                                                                 04940000
049500         10  INTER-APPL-COMM-AREA       PIC X(200).               04950000
049600     COPY SUWS002.                                                04960025
049700     COPY SUWS003.                                                04970025
049800*---------------------------------------------------------------* 04980000
049900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04990000
050000*  ASC LEVEL 30'S MUST MATCH LQW LEVEL 10'S.                    * 05000000
050100*---------------------------------------------------------------* 05010000
050200         10  ASC-SPECIFIC-COMMAREA.                               05020000
050300             15  ASC-OPER-UNT-ID          PIC S9(04) COMP.        05030000
050400             15  ASC-FCLTY-NME            PIC X(25).              05040000
050500             15  ASC-TOT-CRTNS            PIC S9(05) COMP.        05050025
      *CLP 09/24/2014                                                   05051049
050600             15  ASC-PO-RECEIVER.                                 05060000
050700                 20  ASC-PO-NBR           PIC 9(08).              05070049
050800                 20  FILLER               PIC X(01).              05080000
050900                 20  ASC-RECEIVER         PIC 9(03).              05090000
051000             15  ASC-TOT-CRTNS-ERR        PIC S9(05) COMP.        05100025
051100             15  ASC-ENT-NAME-DESC        PIC X(30).              05110000
051200                                                                  05120025
051300             15  ASC-SHIPT-UNT-ID         PIC S9(18)V COMP-3.     05130000
051400             15  ASC-SHIPT-UNT-SRC-ID     PIC X(03).              05140000
051500             15  ASC-TRIP-ID              PIC S9(09) COMP.        05150000
051600             15  ASC-SCAC                 PIC X(04).              05160000
051700             15  ASC-TRLR-NBR             PIC X(10).              05170000
051800             15  ASC-DATE                 PIC X(10).              05180000
051900             15  ASC-TIME                 PIC X(05).              05190000
052000*                                                                 05200000
052100             15  ASC-BLK-SUB                  PIC S9(04) COMP     05210000
052200                                                         SYNC.    05220000
052300             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05230000
052400                                                         SYNC.    05240000
052500             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05250000
052600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05260000
052700             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05270000
052800             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05280000
052900             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05290000
053000             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05300000
053100                                                         SYNC.    05310000
053200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05320000
053300             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05330000
053400             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05340000
053500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05350000
053600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05360000
053700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05370000
053800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05380000
053900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05390000
054000             15  ASC-LIST-QUEUE-NAME.                             05400000
054100                 20  ASC-LIST-TERM-ID         PIC  X(04).         05410000
054200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05420000
054300                 20  ASC-LIST-SEQ             PIC  9(01).         05430000
054400             15  ASC-SEL-QUEUE-NAME.                              05440000
054500                 20  ASC-SEL-TERM-ID          PIC  X(04).         05450000
054600                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05460000
054700                 20  ASC-SEL-SEQ              PIC  9(01).         05470000
054800             15  ASC-SEL-QUEUE-NAME-ORIG.                         05480000
054900                 20  ASC-SEL-TERM-ID-ORIG     PIC  X(04).         05490000
055000                 20  ASC-SEL-TASK-NUMBER-ORIG PIC S9(05) COMP-3.  05500000
055100                 20  ASC-SEL-SEQ-ORIG         PIC  9(01).         05510000
055200             15  ASC-START-ITEM-REQUEST.                          05520000
055300                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05530000
055400             15  ASC-CSR-SW                   PIC  X(02).         05540000
055500                 88  ASC-NO-CSR                      VALUE 'Z '.  05550000
055600                 88  ASC-CARTON-CSR                  VALUE 'A '.  05560000
055700             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05570000
055800             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05580000
055900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05590000
056000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05600000
056100             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05610000
056200                                                                  05620000
056300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05630000
056400                 20  ASC-BLOCK-MODIFIED-SW          PIC X(01).    05640000
056500                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    05650000
056600                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    05660000
056700                                                                  05670000
056800                 20  ASC-ITEM-ARRAY.                              05680000
056900                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        05690000
057000                         30  ASC-LIST-ITEM-NUMBER                 05700000
057100                                        PIC S9(09)  COMP-3.       05710000
057200                         30  ASC-TEMP-SELECTED-SW PIC X(01).      05720000
057300                             88  ASC-VALID-SELECT   VALUE ' '     05730000
057400                                                          'S'     05740000
057500                                                          'B'     05750000
057600                                                          'E'.    05760000
057700                             88  ASC-TEMP-NO-SELECT VALUE ' '.    05770000
057800                             88  ASC-TEMP-SELECT    VALUE 'S'.    05780000
057900                             88  ASC-TEMP-BEGIN     VALUE 'B'.    05790000
058000                             88  ASC-TEMP-END       VALUE 'E'.    05800000
058100                         30  ASC-SELECTED-SW        PIC X(01).    05810000
058200                             88  ASC-NO-SELECT      VALUE ' '.    05820000
058300                             88  ASC-SELECT         VALUE 'S'.    05830000
058400                             88  ASC-BEGIN          VALUE 'B'.    05840000
058500                             88  ASC-END            VALUE 'E'.    05850000
058600                         30  ASC-ACTION             PIC X(03).    05860000
058700                         30  ASC-SERIAL-SHIP-CDE    PIC S9(18).   05870000
058800                         30  ASC-STR-NBR            PIC 9(04).    05880025
058900                         30  ASC-CRE-SRC            PIC X(03).    05890000
059000                         30  ASC-DATE-TIME          PIC X(16).    05900000
059100                         30  ASC-LN-TRIP-ID         PIC 9(09).    05910000
059200                         30  ASC-SCAC-CDE           PIC X(04).    05920000
059300                         30  ASC-VEH-NBR            PIC X(10).    05930000
059400                         30  ASC-CSR-IND            PIC X(01).    05940000
059500                         30  ASC-LBL-TYP-CDE        PIC X(01).    05950000
059600                             88  ASC-P2L-LBL      VALUE 'P'.      05960000
059700                         30  ASC-PBS-ERROR-SW       PIC X(01).    05970004
059800                             88  ASC-PBS-ERR-YES    VALUE 'Y'.    05980004
059900                             88  ASC-PBS-ERR-NO     VALUE 'N'.    05990004
060000                         30  ASC-ACTV-IND           PIC X(01).    06000045
060100******************************************************************06010000
060200                                                                  06020000
060300 EJECT                                                            06030000
060400*---------------------------------------------------------------* 06040000
060500*    ABEND PROCESSING COPYBOOK.                                 * 06050000
060600*---------------------------------------------------------------* 06060000
060700                                                                  06070000
060800     COPY DPWS013.                                                06080000
060900*                                                                 06090000
061000*---------------------------------------------------------------* 06100000
061100*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 06110000
061200*---------------------------------------------------------------* 06120000
061300     EXEC SQL                                                     06130000
061400          INCLUDE TPURCHS                                         06140000
061500     END-EXEC.                                                    06150000
061600*                                                                 06160000
061700*---------------------------------------------------------------* 06170000
061800*    DB2 AREA FOR THE VENDOR TABLE                              * 06180000
061900*---------------------------------------------------------------* 06190000
062000     EXEC SQL                                                     06200000
062100          INCLUDE TENTNME                                         06210000
062200     END-EXEC.                                                    06220000
062300                                                                  06230000
062400*                                                                 06240000
062500*---------------------------------------------------------------* 06250000
062600*    DB2 AREA FOR THE SHIPMENT TABLE                            * 06260000
062700*---------------------------------------------------------------* 06270000
062800     EXEC SQL                                                     06280000
062900          INCLUDE TSHIPMT                                         06290000
063000     END-EXEC.                                                    06300000
063100                                                                  06310000
063200*                                                                 06320000
063300*---------------------------------------------------------------* 06330000
063400*    DB2 AREA FOR THE PO SHIPMENT TABLE                         * 06340000
063500*---------------------------------------------------------------* 06350000
063600     EXEC SQL                                                     06360000
063700          INCLUDE TSHPTPO                                         06370000
063800     END-EXEC.                                                    06380000
063900                                                                  06390000
064000*                                                                 06400000
064100*---------------------------------------------------------------* 06410000
064200*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 06420000
064300*---------------------------------------------------------------* 06430000
064400     EXEC SQL                                                     06440000
064500          INCLUDE TPKSLIP                                         06450000
064600     END-EXEC.                                                    06460000
064700                                                                  06470000
064800*                                                                 06480000
064900*---------------------------------------------------------------* 06490000
065000*    DB2 AREA FOR THE PACKSLIP/SHIPMENT UNIT ASSOCIATION TABLE *  06500000
065100*---------------------------------------------------------------* 06510000
065200     EXEC SQL                                                     06520000
065300          INCLUDE TINPKSU                                         06530000
065400     END-EXEC.                                                    06540000
065500                                                                  06550000
065600*                                                                 06560000
065700*---------------------------------------------------------------* 06570000
065800*    DB2 AREA FOR THE SHIPMENT UNIT LOCATION TABLE              * 06580000
065900*---------------------------------------------------------------* 06590000
066000     EXEC SQL                                                     06600000
066100          INCLUDE TSHUNLO                                         06610000
066200     END-EXEC.                                                    06620000
066300                                                                  06630000
066400*                                                                 06640000
066500*---------------------------------------------------------------* 06650000
066600*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 06660000
066700*---------------------------------------------------------------* 06670000
066800     EXEC SQL                                                     06680000
066900          INCLUDE TVHTRIP                                         06690000
067000     END-EXEC.                                                    06700000
067100                                                                  06710000
067200*                                                                 06720000
067300*---------------------------------------------------------------* 06730000
067400*    DB2 AREA FOR THE SHIPPING UNIT TABLE                       * 06740000
067500*---------------------------------------------------------------* 06750000
067600     EXEC SQL                                                     06760000
067700          INCLUDE TSHPUNT                                         06770000
067800     END-EXEC.                                                    06780000
067900                                                                  06790000
068000*                                                                 06800000
068100*---------------------------------------------------------------* 06810000
068200*    DB2 AREA FOR THE SHIPPING UNIT UPC ASSOCIATION TABLE       * 06820000
068300*---------------------------------------------------------------* 06830000
068400     EXEC SQL                                                     06840000
068500          INCLUDE TSHUUPC                                         06850000
068600     END-EXEC.                                                    06860000
068700                                                                  06870000
068800*                                                                 06880000
068900*---------------------------------------------------------------* 06890000
069000*    DB2 AREA FOR THE SHIPPING UNIT CROSS REFERENCE TABLE       * 06900000
069100*---------------------------------------------------------------* 06910000
069200     EXEC SQL                                                     06920000
069300          INCLUDE TSULBXF                                         06930000
069400     END-EXEC.                                                    06940000
069500                                                                  06950000
069600*                                                                 06960000
069700*---------------------------------------------------------------* 06970000
069800*    DB2 AREA FOR COMMUNICATIONS                                * 06980000
069900*---------------------------------------------------------------* 06990000
070000     EXEC SQL                                                     07000000
070100          INCLUDE SQLCA                                           07010000
070200     END-EXEC.                                                    07020000
070300                                                                  07030000
070400*---------------------------------------------------------------* 07040000
070500*  CSR TO SELECT CARTONS THAT ARE ASSIGNED TO THE               * 07050000
070600*  PO/RECEIVER BEING PROCESSED.                                 * 07060000
070700*  A SELECT - CARTONS CHECKED IN THAT HAVE ERRORS               * 07070030
070800*  B SELECT - CARTONS CHECKED IN THAT DO NOT HAVE ERRORS        * 07080030
070900*  C SELECT - ERROR CARTONS THAT HAVE NOT BEEN CHECKED IN       * 07090030
071000*  D SELECT - CARTONS THAT HAVE NOT BEEN CHECKED IN AND         * 07100030
071100*             DO NOT HAVE ERRORS                                * 07110030
071200*---------------------------------------------------------------* 07120000
071300     EXEC SQL                                                     07130000
071400          DECLARE CARTON-CSR CURSOR FOR                           07140016
071500          SELECT 'A'                                              07150015
071600                , E.TRIP_ID                                       07160015
071700                , B.PO_NBR                                        07170015
071800                , B.REC_SEQ_NBR                                   07180015
071900                , C.SEQ_NBR                                       07190015
072000                , D.SHIPT_UNT_ID                                  07200015
072100                , H.DEST_OPER_UNT_ID                              07210015
072200                , H.SHIPT_UNT_SRC_ID                              07220015
072300                , E.CRE_TMST                                      07230015
072400                , DATE(E.CRE_TMST)                                07240015
072500                , TIME(E.CRE_TMST)                                07250015
072600             FROM TSHIPMT A                                       07260015
072700                , TSHPTPO B                                       07270015
072800                , TPKSLIP C                                       07280015
072900                , TINPKSU D                                       07290015
073000                , TSHUNLO E                                       07300015
073100                , TVHTRIP F                                       07310015
073200                , TSHPUNT H                                       07320015
073300            WHERE A.SHIPT_ID       = B.SHIPT_ID                   07330015
073400              AND A.TRIP_ID        = F.TRIP_ID                    07340015
073500              AND B.PO_NBR         = :DK-PO-NBR                   07350020
073600              AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              07360020
073700              AND B.PO_NBR         = C.PO_NBR                     07370015
073800              AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                07380015
073900              AND B.PRIM_SHIPT_IND = 'Y'                          07390015
074000              AND C.VER_STAT_CDE   = 'A'                          07400015
074100              AND B.PO_NBR         = D.PO_NBR                     07410015
074200              AND D.SEQ_NBR        = C.SEQ_NBR                    07420015
074300              AND E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               07430015
074400              AND E.SHIPT_UNT_ID   = H.SHIPT_UNT_ID               07440015
074500              AND E.SCN_LOC_ID    IN ('RECV','WRCV')              07450048
074600              AND E.ACTV_CDE       = 'A'                          07460015
074700              AND H.ACTV_IND       = 'A'                          07470015
074800              AND EXISTS                                          07480015
074900               (SELECT G.SHIPT_UNT_ID                             07490015
075000                FROM TSHUNLO G                                    07500015
075100                WHERE G.SHIPT_UNT_ID = E.SHIPT_UNT_ID             07510015
075200                AND G.ACTV_CDE       = 'I'                        07520015
075300                AND G.SCN_LOC_ID     IN                           07530015
075400                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE'))          07540015
075500         UNION                                                    07550017
075600          SELECT 'B'                                              07560015
075700                , E.TRIP_ID                                       07570015
075800                , B.PO_NBR                                        07580015
075900                , B.REC_SEQ_NBR                                   07590015
076000                , C.SEQ_NBR                                       07600015
076100                , D.SHIPT_UNT_ID                                  07610015
076200                , H.DEST_OPER_UNT_ID                              07620015
076300                , H.SHIPT_UNT_SRC_ID                              07630015
076400                , E.CRE_TMST                                      07640015
076500                , DATE(E.CRE_TMST)                                07650015
076600                , TIME(E.CRE_TMST)                                07660015
076700             FROM TSHIPMT A                                       07670015
076800                , TSHPTPO B                                       07680015
076900                , TPKSLIP C                                       07690015
077000                , TINPKSU D                                       07700015
077100                , TSHUNLO E                                       07710015
077200                , TVHTRIP F                                       07720015
077300                , TSHPUNT H                                       07730015
077400            WHERE A.SHIPT_ID       = B.SHIPT_ID                   07740015
077500              AND A.TRIP_ID        = F.TRIP_ID                    07750015
077600              AND B.PO_NBR         = :DK-PO-NBR                   07760020
077700              AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              07770020
077800              AND B.PO_NBR         = C.PO_NBR                     07780015
077900              AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                07790015
078000              AND B.PRIM_SHIPT_IND = 'Y'                          07800015
078100              AND C.VER_STAT_CDE   = 'A'                          07810015
078200              AND B.PO_NBR         = D.PO_NBR                     07820015
078300              AND D.SEQ_NBR        = C.SEQ_NBR                    07830015
078400              AND E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               07840015
078500              AND E.SHIPT_UNT_ID   = H.SHIPT_UNT_ID               07850015
078600              AND E.SCN_LOC_ID    IN ('RECV','WRCV')              07860048
078700              AND E.ACTV_CDE       = 'A'                          07870015
078800              AND H.ACTV_IND       = 'A'                          07880015
078900              AND NOT EXISTS                                      07890015
079000               (SELECT G.SHIPT_UNT_ID                             07900015
079100                FROM TSHUNLO G                                    07910015
079200                WHERE G.SHIPT_UNT_ID = E.SHIPT_UNT_ID             07920015
079300                AND G.ACTV_CDE       = 'I'                        07930015
079400                AND G.SCN_LOC_ID     IN                           07940015
079500                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE'))          07950015
079600         UNION                                                    07960015
079700          SELECT 'C'                                              07970015
079800                , F.TRIP_ID                                       07980020
079900                , B.PO_NBR                                        07990015
080000                , B.REC_SEQ_NBR                                   08000015
080100                , C.SEQ_NBR                                       08010015
080200                , D.SHIPT_UNT_ID                                  08020015
080300                , H.DEST_OPER_UNT_ID                              08030015
080400                , H.SHIPT_UNT_SRC_ID                              08040015
080500                , E.CRE_TMST                                      08050015
080600                , DATE(E.CRE_TMST)                                08060015
080700                , TIME(E.CRE_TMST)                                08070015
080800             FROM TSHIPMT A                                       08080015
080900                , TSHPTPO B                                       08090015
081000                , TPKSLIP C                                       08100015
081100                , TINPKSU D                                       08110015
081200                , TSHUNLO E                                       08120015
081300                , TVHTRIP F                                       08130015
081400                , TSHPUNT H                                       08140015
081500            WHERE A.SHIPT_ID       = B.SHIPT_ID                   08150015
081600              AND A.TRIP_ID        = F.TRIP_ID                    08160015
081700              AND B.PO_NBR         = :DK-PO-NBR                   08170020
081800              AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR              08180020
081900              AND B.PO_NBR         = C.PO_NBR                     08190015
082000              AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                08200015
082100              AND B.PRIM_SHIPT_IND = 'Y'                          08210015
082200              AND C.VER_STAT_CDE   = 'A'                          08220015
082300              AND B.PO_NBR         = D.PO_NBR                     08230015
082400              AND D.SEQ_NBR        = C.SEQ_NBR                    08240015
082500              AND E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               08250015
082600              AND E.SHIPT_UNT_ID   = H.SHIPT_UNT_ID               08260015
082700              AND E.SCN_LOC_ID     IN                             08270015
082800                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE')           08280015
082900              AND E.ACTV_CDE       = 'I'                          08290015
083000              AND H.ACTV_IND       = 'A'                          08300015
083100              AND NOT EXISTS                                      08310015
083200               (SELECT G.SHIPT_UNT_ID                             08320015
083300                FROM TSHUNLO G                                    08330015
083400                WHERE G.SHIPT_UNT_ID = E.SHIPT_UNT_ID             08340015
083500                AND G.ACTV_CDE       = 'A'                        08350015
083600                AND G.SCN_LOC_ID    IN ('RECV','WRCV'))           08360048
083700              AND E.CRE_TMST         =                            08370024
083800               (SELECT MAX(F.CRE_TMST)                            08380024
083900                FROM TSHUNLO F                                    08390024
084000                WHERE E.SHIPT_UNT_ID = F.SHIPT_UNT_ID)            08400024
084100         UNION                                                    08410015
084200           SELECT 'D'                                             08420015
084300                , F.TRIP_ID                                       08430015
084400                , B.PO_NBR                                        08440015
084500                , B.REC_SEQ_NBR                                   08450015
084600                , C.SEQ_NBR                                       08460015
084700                , D.SHIPT_UNT_ID                                  08470015
084800                , G.DEST_OPER_UNT_ID                              08480015
084900                , G.SHIPT_UNT_SRC_ID                              08490015
085000                , C.CRE_TMST                                      08500015
085100                , DATE(C.CRE_TMST)                                08510015
085200                , TIME(C.CRE_TMST)                                08520015
085300             FROM TSHIPMT A                                       08530015
085400                , TSHPTPO B                                       08540015
085500                , TPKSLIP C                                       08550015
085600                , TINPKSU D                                       08560015
085700                , TVHTRIP F                                       08570015
085800                , TSHPUNT G                                       08580015
085900           WHERE A.SHIPT_ID       = B.SHIPT_ID                    08590015
086000             AND A.TRIP_ID        = F.TRIP_ID                     08600015
086100             AND B.PO_NBR         = :DK-PO-NBR                    08610020
086200             AND B.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               08620020
086300             AND B.PO_NBR         = C.PO_NBR                      08630015
086400             AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                 08640015
086500             AND B.PRIM_SHIPT_IND = 'Y'                           08650015
086600             AND C.VER_STAT_CDE   = 'A'                           08660015
086700             AND B.PO_NBR         = D.PO_NBR                      08670015
086800             AND D.SEQ_NBR        = C.SEQ_NBR                     08680015
086900             AND D.SHIPT_UNT_ID   = G.SHIPT_UNT_ID                08690015
087000             AND G.ACTV_IND       = 'A'                           08700015
087100             AND NOT EXISTS                                       08710015
087200               (SELECT H.SHIPT_UNT_ID                             08720015
087300                FROM TSHUNLO H                                    08730015
087400                WHERE H.SHIPT_UNT_ID = D.SHIPT_UNT_ID             08740015
087500                AND H.SCN_LOC_ID   IN                             08750015
087600             ('RECV','WRCV','PBSA','PBSB','PBSC','PBSD','PBSE'))  08760048
087700         ORDER BY 1                                               08770015
087800         WITH UR                                                  08780046
087900     END-EXEC.                                                    08790001
088000*                                                                 08800001
088100*---------------------------------------------------------------* 08810001
088200*  SHIPT CSR                                                    * 08820001
088300*---------------------------------------------------------------* 08830001
088400     EXEC SQL                                                     08840001
088500          DECLARE SHIPT-CSR CURSOR FOR                            08850001
088600              SELECT  'A'                                         08860001
088700                   , A.SHIPT_UNT_ID                               08870001
088800                   , C.DEST_OPER_UNT_ID                           08880001
088900                   , C.SHIPT_UNT_SRC_ID                           08890001
089000                   , A.CRE_TMST                                   08900001
089100                   , DATE(A.CRE_TMST)                             08910001
089200                   , TIME(A.CRE_TMST)                             08920001
089300                   , D.OWNER_SCAC_ID                              08930001
089400                   , D.VEH_NBR                                    08940001
089500              FROM   TSHUNLO A                                    08950001
089600                   , TSHUUPC B                                    08960001
089700                   , TSHPUNT C                                    08970001
089800                   , TVHTRIP D                                    08980001
089900              WHERE A.TRIP_ID        = :DK-TRIP-ID                08990001
090000                AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID             09000001
090100                AND A.SHIPT_UNT_ID   = C.SHIPT_UNT_ID             09010001
090200                AND A.TRIP_ID        = D.TRIP_ID                  09020001
090300                AND A.SCN_LOC_ID    IN ('RECV','WRCV')            09030048
090400                AND A.ACTV_CDE       = 'A'                        09040001
090500                AND B.TRN_NBR        = :DK-PO-NBR                 09050001
090600                AND C.ACTV_IND       = 'A'                        09060001
090700                AND NOT EXISTS                                    09070001
090800                 (SELECT C.SHIPT_UNT_ID                           09080001
090900                  FROM TINPKSU C                                  09090001
091000                  WHERE A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID)         09100001
091100           UNION                                                  09110001
091200              SELECT 'B'                                          09120001
091300                   , A.SHIPT_UNT_ID                               09130001
091400                   , C.DEST_OPER_UNT_ID                           09140001
091500                   , C.SHIPT_UNT_SRC_ID                           09150001
091600                   , A.CRE_TMST                                   09160001
091700                   , DATE(A.CRE_TMST)                             09170001
091800                   , TIME(A.CRE_TMST)                             09180001
091900                   , D.OWNER_SCAC_ID                              09190001
092000                   , D.VEH_NBR                                    09200001
092100              FROM   TSHUNLO A                                    09210001
092200                   , TSHUUPC B                                    09220001
092300                   , TSHPUNT C                                    09230001
092400                   , TVHTRIP D                                    09240001
092500                   , TINPKSU E                                    09250001
092600                   , TPKSLIP F                                    09260001
092700              WHERE A.TRIP_ID        = :DK-TRIP-ID                09270001
092800                AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID             09280001
092900                AND A.SHIPT_UNT_ID   = C.SHIPT_UNT_ID             09290001
093000                AND A.TRIP_ID        = D.TRIP_ID                  09300001
093100                AND A.SCN_LOC_ID    IN ('RECV','WRCV')            09310048
093200                AND A.ACTV_CDE       = 'A'                        09320001
093300                AND B.TRN_NBR        = :DK-PO-NBR                 09330001
093400                AND A.SHIPT_UNT_ID   = E.SHIPT_UNT_ID             09340001
093500                AND C.ACTV_IND       = 'A'                        09350001
093600                AND E.PO_NBR         = F.PO_NBR                   09360001
093700                AND E.SEQ_NBR        = F.SEQ_NBR                  09370001
093800                AND F.REC_SEQ_NBR    = 0                          09380001
093900                AND F.VER_STAT_CDE   = 'A'                        09390001
094000         UNION                                                    09400001
094100          SELECT 'C'                                              09410001
094200               , E.SHIPT_UNT_ID                                   09420001
094300               , H.DEST_OPER_UNT_ID                               09430001
094400               , H.SHIPT_UNT_SRC_ID                               09440001
094500               , E.CRE_TMST                                       09450001
094600               , DATE(E.CRE_TMST)                                 09460001
094700               , TIME(E.CRE_TMST)                                 09470001
094800               , I.OWNER_SCAC_ID                                  09480001
094900               , I.VEH_NBR                                        09490001
095000             FROM                                                 09500001
095100                  TPKSLIP C                                       09510001
095200                , TINPKSU D                                       09520001
095300                , TSHUNLO E                                       09530001
095400                , TSHPUNT H                                       09540001
095500                , TVHTRIP I                                       09550001
095600            WHERE E.TRIP_ID        = :DK-TRIP-ID                  09560001
095700              AND C.PO_NBR        = :DK-PO-NBR                    09570001
095800              AND C.PKSL_STAT_CDE = 'DE'                          09580001
095900              AND C.PO_NBR        = D.PO_NBR                      09590001
096000              AND C.SEQ_NBR       = D.SEQ_NBR                     09600001
096100              AND D.SHIPT_UNT_ID  = E.SHIPT_UNT_ID                09610001
096200              AND E.SHIPT_UNT_ID  = H.SHIPT_UNT_ID                09620001
096300              AND E.SCN_LOC_ID   IN ('RECV','WRCV')               09630048
096400              AND E.ACTV_CDE      = 'A'                           09640001
096500              AND H.ACTV_IND      = 'A'                           09650001
096600              AND E.TRIP_ID       = I.TRIP_ID                     09660001
096700         WITH UR                                                  09670046
096800     END-EXEC.                                                    09680001
096900*                                                                 09690001
097000*---------------------------------------------------------------* 09700001
097100*  ACTIVE STATUS CSR                                            * 09710001
097200*---------------------------------------------------------------* 09720001
097300     EXEC SQL                                                     09730001
097400          DECLARE ACTIVE-STAT-CSR CURSOR FOR                      09740001
097500              SELECT                                              09750001
097600                     STAT_CDE                                     09760001
097700                   , SHIPT_UNT_ID                                 09770001
097800                   , CART_LBL_TYP_CDE                             09780001
097900                   , CRE_TMST                                     09790001
098000                   , DEST_OPER_UNT_ID                             09800001
098100              FROM   TSULBXF                                      09810001
098200              WHERE SHIPT_UNT_ID     = :SHUNLO-SHIPT-UNT-ID       09820001
098300                AND CRE_TMST         = :SHUNLO-CRE-TMST           09830001
098400                AND STAT_CDE         = 'A'                        09840001
098500              ORDER BY CRE_TMST                                   09850001
098600                      ,DEST_OPER_UNT_ID                           09860001
098700     END-EXEC.                                                    09870001
098800*                                                                 09880001
098900*                                                                 09890001
099000*---------------------------------------------------------------* 09900001
099100*  INACTIVE STATUS CSR                                          * 09910001
099200*---------------------------------------------------------------* 09920001
099300     EXEC SQL                                                     09930001
099400          DECLARE INACTIVE-STAT-CSR CURSOR FOR                    09940001
099500              SELECT                                              09950001
099600                     STAT_CDE                                     09960001
099700                   , SHIPT_UNT_ID                                 09970001
099800                   , CART_LBL_TYP_CDE                             09980001
099900                   , CRE_TMST                                     09990001
100000                   , DEST_OPER_UNT_ID                             10000001
100100              FROM   TSULBXF                                      10010001
100200              WHERE SHIPT_UNT_ID     = :SHUNLO-SHIPT-UNT-ID       10020001
100300                AND CRE_TMST         = :SHUNLO-CRE-TMST           10030001
100400                AND STAT_CDE         = 'I'                        10040001
100500              ORDER BY CRE_TMST                                   10050001
100600                      ,DEST_OPER_UNT_ID                           10060001
100700     END-EXEC.                                                    10070001
100800*                                                                 10080001
100900*                                                                 10090001
101000***************************************************************   10100001
101100*                                                                 10110001
101200 LINKAGE SECTION.                                                 10120001
101300                                                                  10130001
101400 01  DFHCOMMAREA.                                                 10140001
101500     05  FILLER                         OCCURS  1 TO 4072 TIMES   10150001
101600                                        DEPENDING ON EIBCALEN.    10160001
101700         10  FILLER                     PIC X.                    10170001
101800                                                                  10180001
101900 EJECT                                                            10190001
102000*                                                                 10200001
102100*                                                                 10210001
102200 PROCEDURE DIVISION.                                              10220001
102300*---------------------------------------------------------------* 10230001
102400*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 10240001
102500*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 10250001
102600*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 10260001
102700*---------------------------------------------------------------* 10270001
102800 0000-MAIN-MODULE.                                                10280001
102900     INITIALIZE DP030-CICS-API-FIELDS.                            10290001
103000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10300001
103100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10310001
103200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10320001
103300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10330001
103400     MOVE LENGTH OF SUK553I        TO DP030-MAP-LENGTH (1).       10340001
103500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10350001
103600     PERFORM 0001-CALL-CICS-ARCH-API.                             10360001
103700*                                                                 10370001
103800     PERFORM 1000-CONTROL-PROCESSING                              10380001
103900                                                                  10390001
104000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10400001
104100     PERFORM 0001-CALL-CICS-ARCH-API.                             10410001
104200*                                                                 10420001
104300*                                                                 10430001
104400*---------------------------------------------------------------* 10440001
104500*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 10450001
104600*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 10460001
104700*---------------------------------------------------------------* 10470001
104800 0001-CALL-CICS-ARCH-API.                                         10480001
104900*    CALL 'DPKCS030' USING DFHEIBLK                               10490055
104900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10491055
105000                           DFHCOMMAREA                            10500001
105100                           DP030-CICS-API-FIELDS                  10510001
105200                           DP020-STANDARD-COMMAREA                10520001
105300                           SUK553I.                               10530001
105400*                                                                 10540001
105500     IF DP030-RC-CALL-SUCCESSFUL                                  10550001
105600         CONTINUE                                                 10560001
105700     ELSE                                                         10570001
105800         SET DP013-NO-ROLLBACK                                    10580001
105900             DP013-XCTL-DISPLAY-RESTART                           10590001
106000             DP013-CICS-ABEND      TO TRUE                        10600001
106100         MOVE '0001-CALL-CICS-ARCH-API'                           10610001
106200                                   TO DP013-PARAGRAPH             10620001
106300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX10630055
106400*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      10640055
106300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O10641055
106400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10642055
106500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10650001
106600         PERFORM DP013-0000-PROCESS-ABEND                         10660001
106700     END-IF.                                                      10670001
106800*                                                                 10680001
106900*                                                                 10690001
107000*----------------------------------------------------------------*10700001
107100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10710001
107200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10720001
107300*                                                                *10730001
107400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10740001
107500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10750001
107600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10760001
107700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10770001
107800*----------------------------------------------------------------*10780001
107900 1000-CONTROL-PROCESSING.                                         10790001
108000     EVALUATE TRUE                                                10800001
108100         WHEN DP020-NEXT-ACT-INITIAL                              10810001
108200             INITIALIZE ASC-SPECIFIC-COMMAREA                     10820001
108300             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10830001
108400                                      ASC-SEL-TERM-ID             10840001
108500                                      ASC-SEL-TERM-ID-ORIG        10850001
108600             MOVE DP020-SRC-TASK-NUMBER                           10860001
108700                                   TO ASC-LIST-TASK-NUMBER        10870001
108800                                      ASC-SEL-TASK-NUMBER         10880001
108900                                      ASC-SEL-TASK-NUMBER-ORIG    10890001
109000             MOVE PC-LIST-QUEUE-SEQ                               10900001
109100                                   TO ASC-LIST-SEQ                10910001
109200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10920001
109300                                      ASC-SEL-SEQ-ORIG            10930001
109400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10940001
109500                                                                  10950001
109600             PERFORM 4000-BUILD-INITIAL-PANEL                     10960001
109700                                                                  10970001
109800         WHEN DP020-NEXT-ACT-READ-MAP                             10980001
109900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10990001
110000                                   TO PV-TOP-ITEM                 11000001
110100             PERFORM 2000-PROCESS-PANEL                           11010001
110200                                                                  11020001
110300         WHEN DP020-NEXT-ACT-RETURN                               11030001
110400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11040001
110500                                   TO PV-TOP-ITEM                 11050001
110600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11060001
110700             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 11070001
110800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11080001
110900                                                                  11090001
111000         WHEN OTHER                                               11100001
111100             SET DP013-LOGIC-ABEND TO TRUE                        11110001
111200             SET DP013-NO-ROLLBACK TO TRUE                        11120001
111300             MOVE '1000-CONTROL-PROCESSING'                       11130001
111400                                   TO DP013-PARAGRAPH             11140001
111500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11150001
111600                                   TO DP013-MESSAGE-TEXT(1)       11160001
111700             PERFORM DP013-0000-PROCESS-ABEND                     11170001
111800     END-EVALUATE.                                                11180001
111900                                                                  11190001
112000 EJECT                                                            11200001
112100*                                                                 11210001
112200*                                                                 11220001
112300*----------------------------------------------------------------*11230001
112400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11240001
112500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11250001
112600*----------------------------------------------------------------*11260001
112700 1100-PROCESS-INTER-APPL-COMM.                                    11270001
112800     SET PS-COMMAREA-VALID         TO TRUE.                       11280001
112900     MOVE SPACES                   TO ASC-START-ITEM-REQUEST.     11290001
113000                                                                  11300001
113100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          11310001
113200         MOVE SU002-OPER-UNT-ID      TO ASC-OPER-UNT-ID           11320001
113300                                        DK-OPER-UNT-ID            11330042
113400         IF SU002-FCLTY-NME = SPACES                              11340041
113500            PERFORM 1500-GET-FACILITY-NAME                        11350041
113600            IF XL071-NO-ERRORS                                    11360041
113700                MOVE XL071-LOC-NM  TO ASC-FCLTY-NME               11370043
113800            ELSE                                                  11380041
113900                MOVE SPACES        TO ASC-FCLTY-NME               11390043
114000            END-IF                                                11400041
114100         ELSE                                                     11410041
114200            MOVE SU002-FCLTY-NME   TO ASC-FCLTY-NME               11420043
114300         END-IF                                                   11430041
114400                                                                  11440043
114500         MOVE SU002-SCAC             TO ASC-SCAC                  11450001
114600         MOVE SU002-TRLR-NBR         TO ASC-TRLR-NBR              11460001
114700         MOVE SU002-TRIP-ID          TO ASC-TRIP-ID               11470001
114800         MOVE SU002-PO-NBR           TO ASC-PO-NBR                11480001
114900         MOVE SU002-REC-SEQ-NBR      TO ASC-RECEIVER              11490001
115000         MOVE SU002-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID          11500001
115100     END-IF.                                                      11510001
115200                                                                  11520001
115300     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              11530001
115400       IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                      11540001
115500         MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID           11550001
115600                                        DK-OPER-UNT-ID            11560043
115700                                                                  11570043
115800         IF SU003-FCLTY-NME = SPACES                              11580043
115900            PERFORM 1500-GET-FACILITY-NAME                        11590043
116000            IF XL071-NO-ERRORS                                    11600043
116100                MOVE XL071-LOC-NM  TO ASC-FCLTY-NME               11610043
116200            ELSE                                                  11620043
116300                MOVE SPACES        TO ASC-FCLTY-NME               11630043
116400            END-IF                                                11640043
116500         ELSE                                                     11650043
116600            MOVE SU003-FCLTY-NME   TO ASC-FCLTY-NME               11660043
116700         END-IF                                                   11670043
116800                                                                  11680043
116900         MOVE SU003-SCAC-CDE         TO ASC-SCAC                  11690001
117000         MOVE SU003-TRLR-NBR         TO ASC-TRLR-NBR              11700001
117100         MOVE SU003-TRIP-ID          TO ASC-TRIP-ID               11710001
117200         MOVE SU003-PO-NBR           TO ASC-PO-NBR                11720001
117300         MOVE SU003-REC-SEQ-NBR      TO ASC-RECEIVER              11730001
117400         MOVE SU003-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID          11740001
117500                                                                  11750001
117600         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    11760001
117700         MOVE SU003-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  11770001
117800*******  MOVE SU003-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      11780001
117900         MOVE SU003-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-ORIG 11790001
118000         PERFORM 1120-PREPARE-LIST-ENTRY                          11800001
118100       ELSE                                                       11810001
118200         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           11820001
118300         SET  PS-COMMAREA-NOT-VALID TO TRUE                       11830001
118400       END-IF                                                     11840001
118500     END-IF.                                                      11850001
118600*                                                                 11860001
118700*                                                                 11870001
118800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11880001
118900 1120-PREPARE-LIST-ENTRY.                                         11890001
119000                                                                  11900001
119100     MOVE SU004-MAX-ITEMS          TO ASC-SEL-SUB.                11910001
119200     MOVE ZERO                     TO ASC-SEL-ITEM.               11920001
119300     PERFORM 1130-GET-NEXT-RECORD.                                11930001
119400*                                                                 11940001
119500*                                                                 11950001
119600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11960001
119700* GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED   *11970001
119800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11980001
119900 1130-GET-NEXT-RECORD.                                            11990001
120000                                                                  12000001
120100     ADD +1                       TO ASC-SEL-SUB.                 12010001
120200                                                                  12020001
120300     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            12030001
120400         ADD +1                   TO ASC-SEL-ITEM                 12040001
120500         MOVE +1                  TO ASC-SEL-SUB                  12050001
120600     END-IF.                                                      12060001
120700                                                                  12070001
120800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12080001
120900         PERFORM 9100-READ-SEL-QUEUE                              12090001
121000         IF  SU004-ITEM (ASC-SEL-SUB) > ZERO                      12100001
121100             MOVE SU004-OPER-UNT-ID (ASC-SEL-SUB)                 12110001
121200                                  TO PV-OPER-UNT-ID               12120001
121300             MOVE SU004-FCLTY-ID   (ASC-SEL-SUB)                  12130001
121400                                  TO PV-FCLTY-ID                  12140001
121500             MOVE SU004-PO-NBR      (ASC-SEL-SUB)                 12150001
121600                                  TO PV-PO-NBR                    12160001
121700                                     ASC-PO-NBR                   12170001
121800             MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB)                 12180001
121900                                  TO PV-RECEIVER                  12190001
122000                                     ASC-RECEIVER                 12200001
122100             MOVE SU004-TRIP-ID     (ASC-SEL-SUB)                 12210001
122200                                  TO PV-TRIP-ID                   12220001
122300             MOVE SU004-SCAC-CDE    (ASC-SEL-SUB)                 12230001
122400                                  TO PV-SCAC-CDE                  12240001
122500             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 12250001
122600                                  TO PV-VEH-NBR                   12260001
122700             MOVE SU004-SHIPT-UNT-ID (ASC-SEL-SUB)                12270001
122800                                  TO PV-SHIPT-UNT-ID              12280001
122900                                     ASC-SHIPT-UNT-ID             12290001
123000                                                                  12300001
123100             SET SU004-INQ (ASC-SEL-SUB)                          12310001
123200                                  TO TRUE                         12320001
123300             SET SU003-UPDATE-TSQ TO TRUE                         12330001
123400             PERFORM 9200-REWRITE-SEL-QUEUE                       12340001
123500         ELSE                                                     12350001
123600             SUBTRACT +1 FROM ASC-SEL-SUB                         12360001
123700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             12370001
123800             SET DP020-MSG-INFORMATIONAL                          12380001
123900                 PS-LIST-END             TO TRUE                  12390001
124000         END-IF                                                   12400001
124100     ELSE                                                         12410001
124200         SUBTRACT +1 FROM ASC-SEL-ITEM                            12420001
124300         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  12430001
124400         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             12440001
124500         SET DP020-MSG-INFORMATIONAL                              12450001
124600             PS-LIST-END             TO TRUE                      12460001
124700     END-IF.                                                      12470001
124800*                                                                 12480001
124900*                                                                 12490001
125000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12500001
125100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *12510001
125200*    PROCESSED.                                                  *12520001
125300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*12530001
125400 1140-GET-PREV-RECORD.                                            12540001
125500                                                                  12550001
125600     SUBTRACT +1 FROM ASC-SEL-SUB.                                12560001
125700                                                                  12570001
125800     IF  ASC-SEL-SUB < +1                                         12580001
125900         SUBTRACT +1 FROM ASC-SEL-ITEM                            12590001
126000         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  12600001
126100     END-IF.                                                      12610001
126200                                                                  12620001
126300     IF  ASC-SEL-ITEM > ZERO                                      12630001
126400         PERFORM 9100-READ-SEL-QUEUE                              12640001
126500             MOVE SU004-OPER-UNT-ID (ASC-SEL-SUB)                 12650001
126600                                  TO PV-OPER-UNT-ID               12660001
126700             MOVE SU004-FCLTY-ID   (ASC-SEL-SUB)                  12670001
126800                                  TO PV-FCLTY-ID                  12680001
126900             MOVE SU004-PO-NBR      (ASC-SEL-SUB)                 12690001
127000                                  TO PV-PO-NBR                    12700001
127100                                     ASC-PO-NBR                   12710001
127200             MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB)                 12720001
127300                                  TO PV-RECEIVER                  12730001
127400                                     ASC-RECEIVER                 12740001
127500             MOVE SU004-TRIP-ID     (ASC-SEL-SUB)                 12750001
127600                                  TO PV-TRIP-ID                   12760001
127700             MOVE SU004-SCAC-CDE    (ASC-SEL-SUB)                 12770001
127800                                  TO PV-SCAC-CDE                  12780001
127900             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 12790001
128000                                  TO PV-VEH-NBR                   12800001
128100             MOVE SU004-SHIPT-UNT-ID (ASC-SEL-SUB)                12810001
128200                                  TO PV-SHIPT-UNT-ID              12820001
128300                                     ASC-SHIPT-UNT-ID             12830001
128400         SET SU004-INQ (ASC-SEL-SUB)                              12840001
128500                                  TO TRUE                         12850001
128600         SET SU003-UPDATE-TSQ TO TRUE                             12860001
128700         PERFORM 9200-REWRITE-SEL-QUEUE                           12870001
128800     ELSE                                                         12880001
128900         MOVE +1                  TO ASC-SEL-ITEM                 12890001
129000                                     ASC-SEL-SUB                  12900001
129100         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             12910001
129200         SET DP020-MSG-INFORMATIONAL                              12920001
129300             PS-LIST-END             TO TRUE                      12930001
129400     END-IF.                                                      12940001
129500*                                                                 12950001
129600*----------------------------------------------------------------*12960041
129700*       GET THE FACILITY NAME                                    *12970041
129800*----------------------------------------------------------------*12980041
129900 1500-GET-FACILITY-NAME.                                          12990041
130000* LOCATION HIERARCY DOMAIN TABLE XL00010                          13000041
130100                                                                  13010041
130200     INITIALIZE XL071-COMMAREA-REC.                               13020041
130300     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               13030041
130400                                                                  13040041
130500     CALL PC-LOCATION-MODULE  USING                               13050041
130600                                    DFHEIBLK                      13060041
130700                                    XL071-COMMAREA                13070041
130800                                    XL071-COMMAREA-REC.           13080041
130900                                                                  13090041
131000     EVALUATE TRUE                                                13100041
131100         WHEN XL071-NO-ERRORS                                     13110041
131200              CONTINUE                                            13120041
131300                                                                  13130041
131400         WHEN OTHER                                               13140041
131500              INITIALIZE PV-CICS-MSG-AREA                         13150041
131600              STRING ' SUKCS553 - CALL XLTUT071 -'                13160041
131700                     ' SQLCODE=' XL071-SQLCODE                    13170041
131800                     ' TABLE='   XL071-DB2-TABLE                  13180041
131900                                              DELIMITED BY SIZE   13190041
132000                                         INTO PV-CICS-MSG-AREA    13200041
132100              PERFORM 9900-WRITE-CICS-LOG                         13210041
132200                                                                  13220041
132300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13230041
132400              PERFORM 9900A-SOFT-ABORT                            13240041
132500     END-EVALUATE.                                                13250041
132600                                                                  13260041
132700*                                                                 13270001
132800*----------------------------------------------------------------*13280001
132900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *13290001
133000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13300001
133100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13310001
133200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13320001
133300* FUNCTION KEYS CAN GET THIS FAR.                                *13330001
133400*----------------------------------------------------------------*13340001
133500 2000-PROCESS-PANEL.                                              13350001
133600     EVALUATE TRUE                                                13360001
133700         WHEN DP020-SRC-AID = DP016-CLEAR                         13370001
133800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13380001
133900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13390001
134000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13400001
134100                                                                  13410001
134200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13420001
134300             PERFORM 2050-DELETE-LIST-QUEUE                       13430001
134400             PERFORM 4000-BUILD-INITIAL-PANEL                     13440001
134500                                                                  13450001
134600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13460001
134700             PERFORM 2140-DESELECT-ALL-ITEMS                      13470001
134800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13480001
134900                                                                  13490001
135000         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 13500001
135100              PERFORM 2150-SELECT-ALL-ITEMS                       13510001
135200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                13520001
135300*LMM NEXT REC SEL F20                                             13530037
135400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13540037
135500             IF  ASC-USE-SELECTION-QUEUE                          13550037
135600                 PERFORM 1130-GET-NEXT-RECORD                     13560037
135700                 IF PS-LIST-END                                   13570037
135800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13580037
135900                     SET PS-NO-LIST-END TO TRUE                   13590037
136000                 ELSE                                             13600037
136100                     PERFORM 2050-DELETE-LIST-QUEUE               13610037
136200                     PERFORM 3200-RESET-ATTRIBUTES                13620037
136300                     PERFORM 4000-BUILD-INITIAL-PANEL             13630037
136400                 END-IF                                           13640037
136500              ELSE                                                13650037
136600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13660037
136700*                --- BOTTOM OF LIST ---                           13670037
136800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         13680037
136900                 SET DP020-MSG-INFORMATIONAL TO TRUE              13690037
137000             END-IF                                               13700037
137100                                                                  13710037
137200*LMM PREV REC SEL F19                                             13720037
137300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13730037
137400             IF  ASC-USE-SELECTION-QUEUE                          13740037
137500                 PERFORM 1140-GET-PREV-RECORD                     13750037
137600                 IF PS-LIST-END                                   13760037
137700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13770037
137800                     SET PS-NO-LIST-END TO TRUE                   13780037
137900                 ELSE                                             13790037
138000                     PERFORM 2050-DELETE-LIST-QUEUE               13800037
138100                     PERFORM 3200-RESET-ATTRIBUTES                13810037
138200                     PERFORM 4000-BUILD-INITIAL-PANEL             13820037
138300                 END-IF                                           13830037
138400             ELSE                                                 13840037
138500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13850037
138600                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         13860037
138700                 SET DP020-MSG-INFORMATIONAL TO TRUE              13870037
138800             END-IF                                               13880037
138900                                                                  13890037
139000         WHEN OTHER                                               13900001
139100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13910001
139200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13920001
139300                                                                  13930001
139400             IF  PS-NO-ERROR                                      13940001
139500                 SET DP030-CONTINUE-GO                            13950001
139600                                 TO TRUE                          13960001
139700                 PERFORM 2100-CHECK-FUNCTION-KEY                  13970001
139800             ELSE                                                 13980001
139900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13990001
140000                 SET DP030-OVERRIDE-GO                            14000001
140100                                 TO TRUE                          14010001
140200             END-IF                                               14020001
140300     END-EVALUATE.                                                14030001
140400 EJECT                                                            14040001
140500*                                                                 14050001
140600*                                                                 14060001
140700*----------------------------------------------------------------*14070001
140800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14080001
140900*----------------------------------------------------------------*14090001
141000 2050-DELETE-LIST-QUEUE.                                          14100001
141100     EXEC CICS                                                    14110001
141200         DELETEQ TS                                               14120001
141300           QUEUE (ASC-LIST-QUEUE-NAME)                            14130001
141400            RESP (PV-CICS-RESP)                                   14140001
141500     END-EXEC.                                                    14150001
141600                                                                  14160001
141700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14170001
141800        (PV-CICS-RESP = DFHRESP(QIDERR))                          14180001
141900         CONTINUE                                                 14190001
142000     ELSE                                                         14200001
142100         SET DP013-CICS-ABEND      TO TRUE                        14210001
142200         SET DP013-NO-ROLLBACK     TO TRUE                        14220001
142300                                                                  14230001
142400         MOVE '2050-DELETE-LIST-QUEUE'                            14240001
142500                                   TO DP013-PARAGRAPH             14250001
142600         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14260001
142700                                   TO DP013-MESSAGE-TEXT (1)      14270001
142800         PERFORM DP013-0000-PROCESS-ABEND                         14280001
142900     END-IF.                                                      14290001
143000                                                                  14300001
143100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14310001
143200 EJECT                                                            14320001
143300*                                                                 14330001
143400*                                                                 14340001
143500*----------------------------------------------------------------*14350001
143600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14360001
143700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14370001
143800* CICS ARCHITECTURE API.                                         *14380001
143900*----------------------------------------------------------------*14390001
144000 2100-CHECK-FUNCTION-KEY.                                         14400001
144100*******************************************                       14410001
144200* F23 - CARTON DETAIL LIST (LOCAL-FUNC-01)                        14420001
144300*******************************************                       14430001
144400*                                                                 14440001
144500     EVALUATE TRUE                                                14450001
144600*                                                                 14460001
144700* F23 - CARTON DETAIL LIST (LOCAL-FUNC-01)                        14470001
144800*                                                                 14480001
144900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14490001
145000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14500001
145100                 INITIALIZE SU003-INTER-APPL-COMMAREA             14510001
145200                 SET SU003-UPDATE-TSQ TO TRUE                     14520001
145300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14530001
145400                                TO SU003-NUMBER-OF-SELECTED-ITEMS 14540001
145500                 MOVE ASC-OPER-UNT-ID                             14550001
145600                                TO SU003-OPER-UNT-ID              14560001
145700                 MOVE ASC-SHIPT-UNT-ID                            14570001
145800                                TO SU003-SHIPT-UNT-ID             14580001
145900                 MOVE ASC-PO-NBR                                  14590001
146000                                TO SU003-PO-NBR                   14600001
146100                 MOVE ASC-RECEIVER                                14610001
146200                                TO SU003-REC-SEQ-NBR              14620001
146300                 MOVE ASC-SCAC                                    14630001
146400                                TO SU003-SCAC-CDE                 14640001
146500                 MOVE ASC-TRLR-NBR                                14650001
146600                                TO SU003-TRLR-NBR                 14660001
146700                 MOVE ASC-TRIP-ID                                 14670001
146800                                TO SU003-TRIP-ID                  14680001
146900                 PERFORM 5000-PREPARE-SEL-QUEUE                   14690001
147000             ELSE                                                 14700001
147100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14710001
147200                 SET DP030-OVERRIDE-GO                            14720001
147300                                   TO TRUE                        14730001
147400                 MOVE PC-TSYMSG-00057                             14740001
147500                                   TO DP020-MSG-NUMBER            14750001
147600                 SET DP020-MSG-WARNING                            14760001
147700                                   TO TRUE                        14770001
147800             END-IF                                               14780001
147900*                                                                 14790001
148000* F6 - FIRST PAGE (AUTOMATICALLY GOES BACK TO PAGE 1)             14800001
148100*                                                                 14810001
148200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14820001
148300             MOVE +1               TO PV-TOP-ITEM                 14830001
148400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14840001
148500*                                                                 14850001
148600* F7 - PREVIOUS PAGE                                              14860001
148700*                                                                 14870001
148800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14880001
148900             PERFORM 2110-BROWSE-BACKWARD                         14890001
149000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14900001
149100*                                                                 14910001
149200* F8 - NEXT PAGE                                                  14920001
149300*                                                                 14930001
149400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14940001
149500             PERFORM 2120-BROWSE-FORWARD                          14950001
149600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14960001
149700*                                                                 14970001
149800* ENTER KEY                                                       14980001
149900*                                                                 14990001
150000         WHEN DP020-SRC-AID = DP016-ENTER                         15000001
150100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15010001
150200             IF  PS-ERROR                                         15020001
150300                 CONTINUE                                         15030001
150400             ELSE                                                 15040001
150500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15050001
150600             END-IF                                               15060001
150700                                                                  15070001
150800         WHEN OTHER                                               15080001
150900             SET DP013-NO-ROLLBACK                                15090001
151000                 DP013-XCTL-DISPLAY-RESTART                       15100001
151100                 DP013-CICS-ABEND  TO TRUE                        15110001
151200             MOVE '2100-CHECK-FUNCTION-KEY'                       15120001
151300                                   TO DP013-PARAGRAPH             15130001
151400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15140001
151500                                   TO DP013-MESSAGE-TEXT (1)      15150001
151600             PERFORM DP013-0000-PROCESS-ABEND                     15160001
151700     END-EVALUATE.                                                15170001
151800*                                                                 15180001
151900*                                                                 15190001
152000*----------------------------------------------------------------*15200001
152100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15210001
152200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15220001
152300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15230001
152400*    MESSAGE.                                                    *15240001
152500*----------------------------------------------------------------*15250001
152600 2110-BROWSE-BACKWARD.                                            15260001
152700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15270001
152800         GIVING PV-TOP-ITEM.                                      15280001
152900                                                                  15290001
153000     IF  ((PV-TOP-ITEM < +1)                                      15300001
153100       OR (PV-TOP-ITEM = +1))                                     15310001
153200         MOVE +1                   TO PV-TOP-ITEM                 15320001
153300*        -- TOP OF LIST --                                        15330001
153400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15340001
153500         SET DP020-MSG-INFORMATIONAL                              15350001
153600                                   TO TRUE                        15360001
153700     END-IF.                                                      15370001
153800 EJECT                                                            15380001
153900*                                                                 15390001
154000*                                                                 15400001
154100*----------------------------------------------------------------*15410001
154200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15420001
154300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15430001
154400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15440001
154500*----------------------------------------------------------------*15450001
154600 2120-BROWSE-FORWARD.                                             15460001
154700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15470001
154800         GIVING PV-TOP-ITEM.                                      15480001
154900                                                                  15490001
155000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15500001
155100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15510001
155200                                   TO PV-TOP-ITEM                 15520001
155300*        -- BOTTOM OF LIST --                                     15530001
155400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15540001
155500         SET DP020-MSG-INFORMATIONAL                              15550001
155600                                   TO TRUE                        15560001
155700     ELSE                                                         15570001
155800         COMPUTE PV-BOTTOM-ITEM =                                 15580001
155900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15590001
156000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15600001
156100*            -- BOTTOM OF LIST --                                 15610001
156200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15620001
156300             SET DP020-MSG-INFORMATIONAL                          15630001
156400                                   TO TRUE                        15640001
156500         END-IF                                                   15650001
156600     END-IF.                                                      15660001
156700 EJECT                                                            15670001
156800*                                                                 15680001
156900*                                                                 15690001
157000*----------------------------------------------------------------*15700001
157100*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *15710001
157200*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *15720001
157300*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *15730001
157400*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *15740001
157500*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *15750001
157600*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15760001
157700*----------------------------------------------------------------*15770001
157800 2130-CHECK-FOR-JUMP-BROWSE.                                      15780001
157900     SET PS-NO-ERROR               TO TRUE.                       15790001
158000     IF (ASC-START-ITEM-REQUEST = SPACES)                         15800001
158100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15810001
158200                                   TO PV-TOP-ITEM                 15820001
158300     ELSE                                                         15830001
158400         MOVE ASC-START-ITEM-REQUEST                              15840001
158500                                   TO DP010I-UNEDITED-FIELD       15850001
158600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15860001
158700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15870001
158800         SET DP010I-NEGATIVE-NOT-ALLOWED                          15880001
158900                                   TO TRUE                        15890001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15901054
263968              USING DP010I-NUMERIC-EDIT-AREA                      15902054
159100                                                                  15910001
159200         IF  NOT DP010I-ERROR-DETECTED                            15920001
159300             MOVE DP010I-NUMERIC-FIELD                            15930001
159400                                   TO ASC-START-ITEM-REQUEST-N    15940001
159500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15950001
159600                 IF  ASC-START-ITEM-REQUEST-N >                   15960001
159700                                          ASC-NUMBER-OF-ITEMS-READ15970001
159800                     MOVE SPACES TO ASC-START-ITEM-REQUEST        15980001
159900                     COMPUTE PV-TOP-ITEM =                        15990001
160000                             ASC-NUMBER-OF-ITEMS-READ             16000001
160100                             - PC-ITEMS-PER-PANEL + 1             16010001
160200                     IF  PV-TOP-ITEM < +1                         16020001
160300                         MOVE +1   TO PV-TOP-ITEM                 16030001
160400                         MOVE PC-TSYMSG-00070                     16040001
160500                                   TO DP020-MSG-NUMBER            16050001
160600                         SET DP020-MSG-INFORMATIONAL              16060001
160700                                   TO TRUE                        16070001
160800                     END-IF                                       16080001
160900                 ELSE                                             16090001
161000                     MOVE ASC-START-ITEM-REQUEST-N                16100001
161100                                   TO PV-TOP-ITEM                 16110001
161200                     MOVE SPACES   TO ASC-START-ITEM-REQUEST      16120001
161300                     COMPUTE PV-BOTTOM-ITEM =                     16130001
161400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16140001
161500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16150001
161600*                        -- BOTTOM OF LIST --                     16160001
161700                         MOVE PC-TSYMSG-00070                     16170001
161800                                   TO DP020-MSG-NUMBER            16180001
161900                         SET DP020-MSG-INFORMATIONAL              16190001
162000                                   TO TRUE                        16200001
162100                     END-IF                                       16210001
162200                 END-IF                                           16220001
162300             ELSE                                                 16230001
162400*                --- VALUE OUT OF RANGE ----                      16240001
162500                 MOVE PC-TSYMSG-00101                             16250001
162600                                   TO DP020-MSG-NUMBER            16260001
162700                 MOVE -1           TO ASTRTITL                    16270001
162800                 SET DP030-SET-CURSOR-APPL-1                      16280001
162900                                   TO TRUE                        16290001
163000                 MOVE DP015-REVERSE                               16300001
163100                                   TO ASTRTITH                    16310001
163200                 MOVE DP015-RED    TO ASTRTITC                    16320001
163300                 MOVE DP015-UNP-NUM-BRT-MDT                       16330001
163400                                   TO ASTRTITA                    16340001
163500                 SET DP020-MSG-FATAL                              16350001
163600                                   TO TRUE                        16360001
163700                 SET PS-ERROR      TO TRUE                        16370001
163800             END-IF                                               16380001
163900                                                                  16390001
164000         ELSE                                                     16400001
164100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16410001
164200             MOVE -1               TO ASTRTITL                    16420001
164300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16430001
164400             MOVE DP015-REVERSE    TO ASTRTITH                    16440001
164500             MOVE DP015-RED        TO ASTRTITC                    16450001
164600             MOVE DP015-UNP-NUM-BRT-MDT                           16460001
164700                                   TO ASTRTITA                    16470001
164800             SET DP020-MSG-FATAL   TO TRUE                        16480001
164900             SET PS-ERROR          TO TRUE                        16490001
165000         END-IF                                                   16500001
165100     END-IF.                                                      16510001
165200 EJECT                                                            16520001
165300*                                                                 16530001
165400*                                                                 16540001
165500*----------------------------------------------------------------*16550001
165600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16560001
165700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16570001
165800*    (F9)                                                        *16580001
165900*----------------------------------------------------------------*16590001
166000 2140-DESELECT-ALL-ITEMS.                                         16600001
166100     MOVE +1                       TO ASC-BLK-SUB.                16610001
166200                                                                  16620001
166300     PERFORM 2141-CLEAR-SELECTED-INDS                             16630001
166400         VARYING ASC-ITEM-SUB                                     16640001
166500         FROM 1 BY 1                                              16650001
166600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16660001
166700                                                                  16670001
166800     ADD +1                        TO ASC-BLK-SUB.                16680001
166900                                                                  16690001
167000     PERFORM 2141-CLEAR-SELECTED-INDS                             16700001
167100         VARYING ASC-ITEM-SUB                                     16710001
167200         FROM 1 BY 1                                              16720001
167300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16730001
167400                                                                  16740001
167500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16750001
167600                                   TO PV-LIST-ITEM-NUMBER.        16760001
167700                                                                  16770001
167800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16780001
167900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16790001
168000                                                                  16800001
168100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16810001
168200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16820001
168300         MOVE +1                   TO ASC-BLK-SUB                 16830001
168400                                                                  16840001
168500         PERFORM 5100-WRITE-TEMP-STORAGE                          16850001
168600                                                                  16860001
168700         MOVE +1                   TO PV-BLOCK-NUMBER             16870001
168800                                                                  16880001
168900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16890001
169000             PV-FIRST-BLOCK-IN-ARRAY - 1                          16900001
169100                                                                  16910001
169200         PERFORM                                                  16920001
169300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16930001
169400                                                                  16940001
169500             PERFORM 4410-READ-TEMP-STORAGE                       16950001
169600                                                                  16960001
169700             PERFORM 2141-CLEAR-SELECTED-INDS                     16970001
169800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16980001
169900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16990001
170000                                                                  17000001
170100             PERFORM 5100-WRITE-TEMP-STORAGE                      17010001
170200                                                                  17020001
170300             ADD +1                TO PV-BLOCK-NUMBER             17030001
170400                                                                  17040001
170500         END-PERFORM                                              17050001
170600                                                                  17060001
170700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17070001
170800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17080001
170900                                                                  17090001
171000         PERFORM                                                  17100001
171100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17110001
171200                   ASC-HIGHEST-BLOCK-WRITTEN                      17120001
171300                                                                  17130001
171400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17140001
171500                                   TO PV-BLOCK-NUMBER             17150001
171600                                                                  17160001
171700             PERFORM 4410-READ-TEMP-STORAGE                       17170001
171800                                                                  17180001
171900             PERFORM 2141-CLEAR-SELECTED-INDS                     17190001
172000                 VARYING ASC-ITEM-SUB                             17200001
172100                 FROM 1 BY 1                                      17210001
172200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17220001
172300                                                                  17230001
172400             PERFORM 5100-WRITE-TEMP-STORAGE                      17240001
172500                                                                  17250001
172600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17260001
172700                                                                  17270001
172800         END-PERFORM                                              17280001
172900                                                                  17290001
173000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17300001
173100                                   TO PV-BLOCK-NUMBER             17310001
173200                                                                  17320001
173300         PERFORM 4410-READ-TEMP-STORAGE                           17330001
173400     END-IF.                                                      17340001
173500                                                                  17350001
173600                                                                  17360001
173700     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.17370001
173800     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 17380001
173900     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   17390001
174000                                                                  17400001
174100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17410001
174200                                                                  17420001
174300 EJECT                                                            17430001
174400*                                                                 17440001
174500*                                                                 17450001
174600*----------------------------------------------------------------*17460001
174700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17470001
174800*----------------------------------------------------------------*17480001
174900 2141-CLEAR-SELECTED-INDS.                                        17490001
175000     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          17500001
175100             NOT EQUAL ZERO                                       17510001
175200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17520001
175300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17530001
175400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17540001
175500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17550001
175600                                   TO TRUE                        17560001
175700         END-IF                                                   17570001
175800     END-IF.                                                      17580001
175900                                                                  17590001
176000 EJECT                                                            17600001
176100*                                                                 17610001
176200*                                                                 17620001
176300*----------------------------------------------------------------*17630001
176400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17640001
176500*  FOR ALL ITEMS (F21).                                          *17650001
176600*----------------------------------------------------------------*17660001
176700 2150-SELECT-ALL-ITEMS.                                           17670001
176800     MOVE +1                       TO ASC-BLK-SUB.                17680001
176900                                                                  17690001
177000     PERFORM 2151-SET-SELECTED-INDS                               17700001
177100         VARYING ASC-ITEM-SUB                                     17710001
177200         FROM 1 BY 1                                              17720001
177300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17730001
177400                                                                  17740001
177500     ADD +1                        TO ASC-BLK-SUB.                17750001
177600                                                                  17760001
177700     PERFORM 2151-SET-SELECTED-INDS                               17770001
177800         VARYING ASC-ITEM-SUB                                     17780001
177900         FROM 1 BY 1                                              17790001
178000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17800001
178100                                                                  17810001
178200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17820001
178300                                   TO PV-LIST-ITEM-NUMBER.        17830001
178400                                                                  17840001
178500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17850001
178600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17860001
178700*10/13/00- BEGIN                                                  17870001
178800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            17880001
178900         MOVE +1                   TO ASC-BLK-SUB                 17890001
179000                                                                  17900001
179100         PERFORM 5100-WRITE-TEMP-STORAGE                          17910001
179200         MOVE +2                   TO ASC-BLK-SUB                 17920001
179300         PERFORM 5100-WRITE-TEMP-STORAGE                          17930001
179400         MOVE +1                   TO ASC-BLK-SUB                 17940001
179500         MOVE +1                   TO PV-BLOCK-NUMBER             17950001
179600     END-IF.                                                      17960001
179700*10/13/00- END                                                    17970001
179800                                                                  17980001
179900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17990001
180000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18000001
180100         MOVE +1                   TO ASC-BLK-SUB                 18010001
180200                                                                  18020001
180300         PERFORM 5100-WRITE-TEMP-STORAGE                          18030001
180400                                                                  18040001
180500         MOVE +1                   TO PV-BLOCK-NUMBER             18050001
180600                                                                  18060001
180700                                                                  18070001
180800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18080001
180900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18090001
181000         MOVE +1                   TO ASC-BLK-SUB                 18100001
181100                                                                  18110001
181200         PERFORM 5100-WRITE-TEMP-STORAGE                          18120001
181300                                                                  18130001
181400         MOVE +1                   TO PV-BLOCK-NUMBER             18140001
181500                                                                  18150001
181600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18160001
181700             PV-FIRST-BLOCK-IN-ARRAY - 1                          18170001
181800                                                                  18180001
181900         PERFORM                                                  18190001
182000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18200001
182100                                                                  18210001
182200             PERFORM 4410-READ-TEMP-STORAGE                       18220001
182300                                                                  18230001
182400             PERFORM 2151-SET-SELECTED-INDS                       18240001
182500                 VARYING ASC-ITEM-SUB                             18250001
182600                 FROM 1 BY 1                                      18260001
182700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18270001
182800                                                                  18280001
182900             PERFORM 5100-WRITE-TEMP-STORAGE                      18290001
183000                                                                  18300001
183100             ADD +1                TO PV-BLOCK-NUMBER             18310001
183200                                                                  18320001
183300         END-PERFORM                                              18330001
183400                                                                  18340001
183500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18350001
183600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18360001
183700                                                                  18370001
183800         PERFORM                                                  18380001
183900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18390001
184000                   ASC-HIGHEST-BLOCK-WRITTEN                      18400001
184100                                                                  18410001
184200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18420001
184300                                   TO PV-BLOCK-NUMBER             18430001
184400                                                                  18440001
184500             PERFORM 4410-READ-TEMP-STORAGE                       18450001
184600                                                                  18460001
184700             PERFORM 2151-SET-SELECTED-INDS                       18470001
184800                 VARYING ASC-ITEM-SUB                             18480001
184900                 FROM 1 BY 1                                      18490001
185000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18500001
185100                                                                  18510001
185200             PERFORM 5100-WRITE-TEMP-STORAGE                      18520001
185300                                                                  18530001
185400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18540001
185500                                                                  18550001
185600         END-PERFORM                                              18560001
185700                                                                  18570001
185800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18580001
185900                                   TO PV-BLOCK-NUMBER             18590001
186000                                                                  18600001
186100         PERFORM 4410-READ-TEMP-STORAGE                           18610001
186200     END-IF.                                                      18620001
186300                                                                  18630001
186400                                                                  18640001
186500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18650001
186600                       ASC-NUMBER-OF-SELECTED-ITEMS.              18660001
186700                                                                  18670001
186800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18680001
186900                                                                  18690001
187000 EJECT                                                            18700001
187100*                                                                 18710001
187200*                                                                 18720001
187300*----------------------------------------------------------------*18730001
187400*    MARK EACH ITEM AS BEING SELECTED.                           *18740001
187500*----------------------------------------------------------------*18750001
187600 2151-SET-SELECTED-INDS.                                          18760001
187700                                                                  18770001
187800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18780001
187900             NOT EQUAL ZERO                                       18790001
188000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18800001
188100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18810001
188200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18820001
188300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18830001
188400                                   TO TRUE                        18840001
188500         END-IF                                                   18850001
188600     END-IF.                                                      18860001
188700                                                                  18870001
188800 EJECT                                                            18880001
188900*                                                                 18890001
189000*                                                                 18900001
189100*----------------------------------------------------------------*18910001
189200*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *18920001
189300*  SCREEN INTO THE COMMAREA.  ALL EDITING IS DONE IN THE COMM.   *18930001
189400*----------------------------------------------------------------*18940001
189500 2200-MOVE-SCREEN-TO-COMMAREA.                                    18950001
189600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18960001
189700     MOVE +1                       TO PV-SUB.                     18970001
189800                                                                  18980001
189900     PERFORM 3100-SET-SUBSCRIPTS.                                 18990001
190000                                                                  19000001
190100     IF  ASTRTITL > ZERO                                          19010001
190200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      19020001
190300     ELSE                                                         19030001
190400         IF  ASTRTITF = DP015-ERASE-EOF                           19040001
190500             INITIALIZE ASC-START-ITEM-REQUEST                    19050001
190600         END-IF                                                   19060001
190700     END-IF.                                                      19070001
190800                                                                  19080001
190900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19090001
191000         VARYING PV-SUB                                           19100001
191100         FROM 1 BY 1                                              19110001
191200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19120001
191300*                                                                 19130001
191400*                                                                 19140001
191500*----------------------------------------------------------------*19150001
191600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *19160001
191700*----------------------------------------------------------------*19170001
191800 2210-MOVE-LINES-TO-COMMAREA.                                     19180001
191900     IF  MR-SELECTL (PV-SUB) > ZERO                               19190001
192000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19200001
192100         MOVE MR-SELECTI (PV-SUB)                                 19210001
192200                                   TO ASC-TEMP-SELECTED-SW        19220001
192300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19230001
192400     ELSE                                                         19240001
192500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19250001
192600                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19260001
192700                 MOVE SPACES       TO ASC-TEMP-SELECTED-SW        19270001
192800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19280001
192900         END-IF                                                   19290001
193000     END-IF.                                                      19300001
193100                                                                  19310001
193200     ADD +1                        TO ASC-ITEM-SUB.               19320001
193300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19330001
193400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     19340001
193500             COMPUTE PV-BLOCK-NUMBER  =                           19350001
193600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         19360001
193700                    PC-ITEMS-PER-PANEL                            19370001
193800             PERFORM 5105-REWRITE-ASC-LISTQ                       19380001
193900         END-IF                                                   19390001
194000         ADD +1                    TO ASC-BLK-SUB                 19400001
194100         MOVE +1                   TO ASC-ITEM-SUB                19410001
194200     ELSE                                                         19420001
194300     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             19430001
194400         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     19440001
194500             COMPUTE PV-BLOCK-NUMBER  =                           19450001
194600                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         19460001
194700                    PC-ITEMS-PER-PANEL                            19470001
194800             PERFORM 5105-REWRITE-ASC-LISTQ                       19480001
194900         END-IF                                                   19490001
195000     END-IF.                                                      19500001
195100*                                                                 19510001
195200*                                                                 19520001
195300*----------------------------------------------------------------*19530001
195400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *19540001
195500*  COMMAREA (EDITING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   *19550001
195600*----------------------------------------------------------------*19560001
195700 3000-EDIT-DATA-IN-COMMAREA.                                      19570001
195800     SET PS-NO-ERROR               TO TRUE.                       19580001
195900     PERFORM 3200-RESET-ATTRIBUTES.                               19590001
196000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19600001
196100                                                                  19610001
196200**                                                                19620001
196300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19630001
196400* EDITING IS DONE FROM THE BOTTOM UP.                             19640001
196500**                                                                19650001
196600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19660001
196700         ASC-ITEMS-DISPLAYED - 1.                                 19670001
196800     PERFORM 3100-SET-SUBSCRIPTS.                                 19680001
196900                                                                  19690001
197000     IF  PS-NO-ERROR                                              19700001
197100         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        19710001
197200     END-IF.                                                      19720001
197300                                                                  19730001
197400     IF  PS-NO-ERROR                                              19740001
197500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19750001
197600     END-IF.                                                      19760001
197700*                                                                 19770001
197800     IF  ((PS-NO-ERROR)                                           19780001
197900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19790001
198000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19800001
198100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19810001
198200     END-IF.                                                      19820001
198300*                                                                 19830001
198400*                                                                 19840001
198500*----------------------------------------------------------------*19850001
198600*   3005-EDIT-COMMAREA-BLOCKS                                    *19860001
198700*----------------------------------------------------------------*19870001
198800 3005-EDIT-COMMAREA-BLOCKS.                                       19880001
198900     MOVE +1                       TO PV-BLOCK-NUMBER.            19890001
199000     MOVE +1                       TO ASC-BLK-SUB.                19900001
199100     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               19910001
199200                                                                  19920001
199300     COMPUTE PV-BLOCK-NUMBER  =                                   19930001
199400        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 19940001
199500            PC-ITEMS-PER-PANEL.                                   19950001
199600                                                                  19960001
199700     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          19970001
199800                                                                  19980001
199900     PERFORM                                                      19990001
200000       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          20000001
200100          OR PS-ERROR                                             20010001
200200          OR PS-BLOCK-ERROR                                       20020001
200300                                                                  20030001
200400             COMPUTE PV-ITEMS-HOLD  =                             20040001
200500                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        20050001
200600                     PC-ITEMS-PER-PANEL - 1                       20060001
200700                                                                  20070001
200800             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       20080001
200900                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               20090001
201000                     FROM  PV-ITEMS-HOLD                          20100001
201100                   GIVING  PV-ITEMS-DIFF                          20110001
201200                 SUBTRACT  PV-ITEMS-DIFF                          20120001
201300                     FROM  PC-ITEMS-PER-PANEL                     20130001
201400                   GIVING  PV-ITEMS-HOLD                          20140001
201500                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              20150001
201600                                              ASC-ITEM-SUB        20160001
201700                                              ASC-ITEMS-DISPLAYED 20170001
201800             ELSE                                                 20180001
201900                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              20190001
202000                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        20200001
202100             END-IF                                               20210001
202200                                                                  20220001
202300             PERFORM 3300-EDIT-SELECTIONS                         20230001
202400                     VARYING PV-SUB                               20240001
202500                        FROM PV-SUB BY -1                         20250001
202600                       UNTIL PV-SUB < +1                          20260001
202700                                                                  20270001
202800             MOVE +1               TO ASC-BLK-SUB                 20280001
202900                                                                  20290001
203000             PERFORM 5105-REWRITE-ASC-LISTQ                       20300001
203100                                                                  20310001
203200             MOVE +1                TO ASC-BLK-SUB                20320001
203300                                                                  20330001
203400             IF  PS-BLOCK-ERROR                                   20340001
203500                 SET  PS-ERROR     TO TRUE                        20350001
203600                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        20360001
203700                                   TO PV-TOP-ITEM                 20370001
203800             ELSE                                                 20380001
203900                 ADD  +1           TO PV-BLOCK-NUMBER             20390001
204000                 IF  PV-BLOCK-NUMBER >                            20400001
204100                     ASC-HIGHEST-BLOCK-WRITTEN                    20410001
204200                     MOVE +2       TO ASC-BLK-SUB                 20420001
204300                     PERFORM 4410-READ-TEMP-STORAGE               20430001
204400                     MOVE +1       TO ASC-BLK-SUB                 20440001
204500                 ELSE                                             20450001
204600                     PERFORM 4410-READ-TEMP-STORAGE               20460001
204700                     ADD  +1        TO PV-BLOCK-NUMBER            20470001
204800                     MOVE +2        TO ASC-BLK-SUB                20480001
204900                     PERFORM 4410-READ-TEMP-STORAGE               20490001
205000                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            20500001
205100                     MOVE +1        TO ASC-BLK-SUB                20510001
205200                 END-IF                                           20520001
205300             END-IF                                               20530001
205400     END-PERFORM.                                                 20540001
205500                                                                  20550001
205600     IF  PV-ORIGINAL-BLOCK  = +1    OR                            20560001
205700         PS-ERROR                   OR                            20570001
205800         PS-BLOCK-ERROR                                           20580001
205900         CONTINUE                                                 20590001
206000     ELSE                                                         20600001
206100         MOVE +1                 TO PV-BLOCK-NUMBER               20610001
206200         MOVE +1                 TO ASC-BLK-SUB                   20620001
206300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20630001
206400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           20640001
206500         PERFORM 4410-READ-TEMP-STORAGE                           20650001
206600                                                                  20660001
206700         PERFORM                                                  20670001
206800           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              20680001
206900              OR PS-ERROR                                         20690001
207000              OR PS-BLOCK-ERROR                                   20700001
207100                                                                  20710001
207200                 COMPUTE PV-ITEMS-HOLD  =                         20720001
207300                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    20730001
207400                         PC-ITEMS-PER-PANEL - 1                   20740001
207500                                                                  20750001
207600                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     20760001
207700                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           20770001
207800                         FROM  PV-ITEMS-HOLD                      20780001
207900                       GIVING  PV-ITEMS-DIFF                      20790001
208000                     SUBTRACT  PV-ITEMS-DIFF                      20800001
208100                         FROM  PC-ITEMS-PER-PANEL                 20810001
208200                       GIVING  PV-ITEMS-HOLD                      20820001
208300                         MOVE  PV-ITEMS-HOLD TO PV-SUB            20830001
208400                                                ASC-ITEM-SUB      20840001
208500                                               ASC-ITEMS-DISPLAYED20850001
208600                 ELSE                                             20860001
208700                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          20870001
208800                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    20880001
208900                 END-IF                                           20890001
209000                                                                  20900001
209100                 PERFORM 3300-EDIT-SELECTIONS                     20910001
209200                         VARYING PV-SUB                           20920001
209300                            FROM PV-SUB BY -1                     20930001
209400                           UNTIL PV-SUB < +1                      20940001
209500                                                                  20950001
209600                 MOVE +1               TO ASC-BLK-SUB             20960001
209700                                                                  20970001
209800                 PERFORM 5105-REWRITE-ASC-LISTQ                   20980001
209900                                                                  20990001
210000                 MOVE +1                TO ASC-BLK-SUB            21000001
210100                                                                  21010001
210200                 IF  PS-BLOCK-ERROR                               21020001
210300                     SET  PS-ERROR     TO TRUE                    21030001
210400                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    21040001
210500                                       TO PV-TOP-ITEM             21050001
210600                 ELSE                                             21060001
210700                     ADD  +1            TO PV-BLOCK-NUMBER        21070001
210800                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      21080001
210900                         MOVE +2        TO ASC-BLK-SUB            21090001
211000                         PERFORM 4410-READ-TEMP-STORAGE           21100001
211100                         MOVE +1        TO ASC-BLK-SUB            21110001
211200                     ELSE                                         21120001
211300                         PERFORM 4410-READ-TEMP-STORAGE           21130001
211400                         ADD  +1        TO PV-BLOCK-NUMBER        21140001
211500                         MOVE +2        TO ASC-BLK-SUB            21150001
211600                         PERFORM 4410-READ-TEMP-STORAGE           21160001
211700                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        21170001
211800                         MOVE +1        TO ASC-BLK-SUB            21180001
211900                     END-IF                                       21190001
212000                 END-IF                                           21200001
212100     END-PERFORM.                                                 21210001
212200*                                                                 21220001
212300*                                                                 21230001
212400*----------------------------------------------------------------*21240001
212500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21250001
212600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21260001
212700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21270001
212800*                                                                *21280001
212900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21290001
213000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21300001
213100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21310001
213200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21320001
213300*----------------------------------------------------------------*21330001
213400 3100-SET-SUBSCRIPTS.                                             21340001
213500     COMPUTE ASC-ITEM-SUB =                                       21350001
213600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21360001
213700                                                                  21370001
213800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21380001
213900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21390001
214000                                                                  21400001
214100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21410001
214200     ELSE                                                         21420001
214300         MOVE +1                     TO ASC-BLK-SUB               21430001
214400     END-IF.                                                      21440001
214500*                                                                 21450001
214600*                                                                 21460001
214700*----------------------------------------------------------------*21470001
214800*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *21480001
214900*----------------------------------------------------------------*21490001
215000 3200-RESET-ATTRIBUTES.                                           21500001
215100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   21510001
215200     MOVE DP015-GREEN              TO ASTRTITC.                   21520001
215300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   21530001
215400                                                                  21540001
215500     PERFORM                                                      21550001
215600         VARYING PV-SUB                                           21560001
215700         FROM 1 BY 1                                              21570001
215800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        21580001
215900         MOVE DP015-UNP-ALP-NOR-OFF                               21590001
216000                                   TO MR-SELECTA (PV-SUB)         21600001
216100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         21610001
216200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         21620001
216300         MOVE DP015-HL-OFF         TO MR-SCACH (PV-SUB)           21630001
216400         MOVE DP015-BLUE           TO MR-SCACC (PV-SUB)           21640001
216500     END-PERFORM.                                                 21650001
216600*                                                                 21660001
216700*                                                                 21670001
216800*----------------------------------------------------------------*21680001
216900*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *21690001
217000*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *21700001
217100*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *21710001
217200*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *21720001
217300*----------------------------------------------------------------*21730001
217400 3300-EDIT-SELECTIONS.                                            21740001
217500     EVALUATE TRUE                                                21750001
217600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21760001
217700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         21770001
217800                 CONTINUE                                         21780001
217900                                                                  21790001
218000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         21800001
218100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21810001
218200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS21820001
218300                 MOVE ASC-TEMP-SELECTED-SW                        21830001
218400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21840001
218500                                   TO ASC-SELECTED-SW             21850001
218600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21860001
218700             END-IF                                               21870001
218800                                                                  21880001
218900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21890001
219000                 = SPACES                                         21900001
219100                                                                  21910001
219200             EVALUATE TRUE                                        21920001
219300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       21930001
219400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21940001
219500                     MOVE SPACES   TO ASC-SELECTED-SW             21950001
219600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21960001
219700                                                                  21970001
219800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        21980001
219900                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 21990001
220000                     MOVE SPACES   TO ASC-SELECTED-SW             22000001
220100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22010001
220200                                                                  22020001
220300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22030001
220400                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   22040001
220500                     MOVE SPACES   TO ASC-SELECTED-SW             22050001
220600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22060001
220700             END-EVALUATE                                         22070001
220800                                                                  22080001
220900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22090001
221000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22100001
221100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22110001
221200             END-IF                                               22120001
221300             PERFORM 3310-EDIT-RANGE                              22130001
221400                                                                  22140001
221500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22150001
221600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22160001
221700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22170001
221800             END-IF                                               22180001
221900             PERFORM 3310-EDIT-RANGE                              22190001
222000                                                                  22200001
222100         WHEN OTHER                                               22210001
222200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            22220001
222300             SET DP020-MSG-FATAL   TO TRUE                        22230001
222400             MOVE -1               TO MR-SELECTL (PV-SUB)         22240001
222500             SET DP030-SET-CURSOR-APPL-1                          22250001
222600                                   TO TRUE                        22260001
222700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         22270001
222800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         22280001
222900             SET PS-ERROR          TO TRUE                        22290001
223000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22300001
223100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22310001
223200                 MOVE SPACES       TO ASC-SELECTED-SW             22320001
223300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22330001
223400             END-IF                                               22340001
223500     END-EVALUATE.                                                22350001
223600                                                                  22360001
223700                                                                  22370001
223800     SUBTRACT +1                   FROM PV-ITEM-IN-USE.           22380001
223900     SUBTRACT +1                   FROM ASC-ITEM-SUB.             22390001
224000                                                                  22400001
224100     IF  ASC-ITEM-SUB < 1                                         22410001
224200         SUBTRACT +1 FROM ASC-BLK-SUB                             22420001
224300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22430001
224400     END-IF.                                                      22440001
224500*                                                                 22450001
224600*                                                                 22460001
224700*----------------------------------------------------------------*22470001
224800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *22480001
224900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *22490001
225000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *22500001
225100*  THE ENDING.                                                   *22510001
225200*----------------------------------------------------------------*22520001
225300 3310-EDIT-RANGE.                                                 22530001
225400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22540001
225500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   22550001
225600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)22560001
225700                                   TO ASC-SELECTED-SW             22570001
225800                                        (ASC-BLK-SUB ASC-ITEM-SUB)22580001
225900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22590001
226000         ELSE                                                     22600001
226100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22610001
226200                 CONTINUE                                         22620001
226300             ELSE                                                 22630001
226400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22640001
226500                 MOVE PC-TSYMSG-00054                             22650001
226600                                       TO DP020-MSG-NUMBER        22660001
226700                 MOVE -1               TO ASTRTITL                22670001
226800                 SET DP020-MSG-FATAL                              22680001
226900                     DP030-SET-CURSOR-APPL-1                      22690001
227000                     PS-ERROR          TO TRUE                    22700001
227100             END-IF                                               22710001
227200         END-IF                                                   22720001
227300     ELSE                                                         22730001
227400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22740001
227500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22750001
227600                                   TO ASC-SELECTED-SW             22760001
227700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22770001
227800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22780001
227900         ELSE                                                     22790001
228000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22800001
228100                 CONTINUE                                         22810001
228200             ELSE                                                 22820001
228300*                -- ONLY ONE END-OF-RANGE ALLOWED --              22830001
228400                 MOVE PC-TSYMSG-00055                             22840001
228500                                        TO DP020-MSG-NUMBER       22850001
228600                 MOVE -1                TO ASTRTITL               22860001
228700                 SET DP020-MSG-FATAL                              22870001
228800                     DP030-SET-CURSOR-APPL-1                      22880001
228900                     PS-ERROR           TO TRUE                   22890001
229000             END-IF                                               22900001
229100         END-IF                                                   22910001
229200     END-IF.                                                      22920001
229300*                                                                 22930001
229400*                                                                 22940001
229500*----------------------------------------------------------------*22950001
229600*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *22960001
229700*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *22970001
229800*----------------------------------------------------------------*22980001
229900 3400-CHECK-RANGE-SEQUENCE.                                       22990001
230000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23000001
230100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23010001
230200       AND  ASC-START-OF-SELECTED-RANGE >                         23020001
230300                                         ASC-END-OF-SELECTED-RANGE23030001
230400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23040001
230500         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            23050001
230600         SET DP020-MSG-FATAL       TO TRUE                        23060001
230700         SET PS-ERROR              TO TRUE                        23070001
230800         PERFORM 3410-POSITION-AT-ERROR                           23080001
230900     END-IF.                                                      23090001
231000*                                                                 23100001
231100*                                                                 23110001
231200*----------------------------------------------------------------*23120001
231300*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *23130001
231400*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CSR     *23140001
231500*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *23150001
231600*----------------------------------------------------------------*23160001
231700 3410-POSITION-AT-ERROR.                                          23170001
231800     SET DP030-SET-CURSOR-APPL-1                                  23180001
231900                                   TO TRUE.                       23190001
232000     MOVE -1                       TO ASTRTITL                    23200001
232100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23210001
232200                    - PV-TOP-ITEM + 1.                            23220001
232300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23230001
232400         CONTINUE                                                 23240001
232500     END-IF.                                                      23250001
232600*                                                                 23260001
232700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23270001
232800                    - PV-TOP-ITEM + 1.                            23280001
232900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23290001
233000         CONTINUE                                                 23300001
233100     END-IF.                                                      23310001
233200 EJECT                                                            23320001
233300*                                                                 23330001
233400*                                                                 23340001
233500*----------------------------------------------------------------*23350001
233600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23360001
233700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23370001
233800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23380001
233900*----------------------------------------------------------------*23390001
234000 3500-MARK-RANGE-AS-SELECTED.                                     23400001
234100     MOVE +1                       TO ASC-BLK-SUB.                23410001
234200                                                                  23420001
234300     PERFORM 3510-MARK-SELECTED-INDS                              23430001
234400         VARYING ASC-ITEM-SUB                                     23440001
234500         FROM 1 BY 1                                              23450001
234600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23460001
234700                                                                  23470001
234800     ADD +1                        TO ASC-BLK-SUB.                23480001
234900                                                                  23490001
235000     PERFORM 3510-MARK-SELECTED-INDS                              23500001
235100         VARYING ASC-ITEM-SUB                                     23510001
235200         FROM 1 BY 1                                              23520001
235300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23530001
235400                                                                  23540001
235500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23550001
235600                                   TO PV-LIST-ITEM-NUMBER.        23560001
235700                                                                  23570001
235800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23580001
235900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23590001
236000               PC-ITEMS-PER-PANEL).                               23600001
236100                                                                  23610001
236200     MOVE ASC-START-OF-SELECTED-RANGE                             23620001
236300                                   TO PV-START-OF-SELECTED-RANGE. 23630001
236400                                                                  23640001
236500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            23650001
236600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  23660001
236700               PC-ITEMS-PER-PANEL).                               23670001
236800                                                                  23680001
236900     MOVE ASC-END-OF-SELECTED-RANGE                               23690001
237000                                   TO PV-END-OF-SELECTED-RANGE.   23700001
237100                                                                  23710001
237200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             23720001
237300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    23730001
237400               PC-ITEMS-PER-PANEL).                               23740001
237500                                                                  23750001
237600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             23760001
237700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             23770001
237800                                                                  23780001
237900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23790001
238000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23800001
238100         MOVE +1                   TO ASC-BLK-SUB                 23810001
238200         PERFORM 5100-WRITE-TEMP-STORAGE                          23820001
238300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23830001
238400             PV-FIRST-BLOCK-IN-ARRAY - 1                          23840001
238500                                                                  23850001
238600         PERFORM                                                  23860001
238700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      23870001
238800                   PV-PREV-BLOCK-IN-ARRAY                         23880001
238900             MOVE PV-FIRST-BLOCK-IN-RANGE                         23890001
239000                                   TO PV-BLOCK-NUMBER             23900001
239100             PERFORM 4410-READ-TEMP-STORAGE                       23910001
239200             PERFORM 3510-MARK-SELECTED-INDS                      23920001
239300                 VARYING ASC-ITEM-SUB                             23930001
239400                 FROM 1 BY 1                                      23940001
239500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23950001
239600             PERFORM 5100-WRITE-TEMP-STORAGE                      23960001
239700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23970001
239800         END-PERFORM                                              23980001
239900                                                                  23990001
240000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24000001
240100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24010001
240200         PERFORM                                                  24020001
240300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24030001
240400                   PV-LAST-BLOCK-IN-RANGE                         24040001
240500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24050001
240600                                   TO PV-BLOCK-NUMBER             24060001
240700             PERFORM 4410-READ-TEMP-STORAGE                       24070001
240800             PERFORM 3510-MARK-SELECTED-INDS                      24080001
240900                 VARYING ASC-ITEM-SUB                             24090001
241000                 FROM 1 BY 1                                      24100001
241100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24110001
241200             PERFORM 5100-WRITE-TEMP-STORAGE                      24120001
241300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24130001
241400         END-PERFORM                                              24140001
241500                                                                  24150001
241600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24160001
241700                                   TO PV-BLOCK-NUMBER             24170001
241800         PERFORM 4410-READ-TEMP-STORAGE                           24180001
241900     END-IF.                                                      24190001
242000                                                                  24200001
242100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24210001
242200                                      ASC-END-OF-SELECTED-RANGE.  24220001
242300                                                                  24230001
242400 EJECT                                                            24240001
242500*                                                                 24250001
242600*                                                                 24260001
242700*----------------------------------------------------------------*24270001
242800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24280001
242900*----------------------------------------------------------------*24290001
243000 3510-MARK-SELECTED-INDS.                                         24300001
243100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         24310001
243200         ASC-START-OF-SELECTED-RANGE)                             24320001
243300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         24330001
243400         ASC-START-OF-SELECTED-RANGE)                             24340001
243500                                                                  24350001
243600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     24360001
243700             ASC-END-OF-SELECTED-RANGE)                           24370001
243800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     24380001
243900             ASC-END-OF-SELECTED-RANGE)                           24390001
244000                                                                  24400001
244100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24410001
244200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   24420001
244300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   24430001
244400                                   TO TRUE                        24440001
244500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              24450001
244600                                   TO TRUE                        24460001
244700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS24470001
244800             END-IF                                               24480001
244900         END-IF                                                   24490001
245000     END-IF.                                                      24500001
245100 EJECT                                                            24510001
245200*                                                                 24520001
245300*                                                                 24530001
245400*----------------------------------------------------------------*24540001
245500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *24550001
245600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *24560001
245700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *24570001
245800*    DISPLAY THE PANEL TO USER.                                  *24580001
245900*----------------------------------------------------------------*24590001
246000 4000-BUILD-INITIAL-PANEL.                                        24600001
246100     INITIALIZE ASC-BLOCK-ENTRIES (1)                             24610001
246200                ASC-BLOCK-ENTRIES (2).                            24620001
246300                                                                  24630001
246400     MOVE +1                       TO ASC-BLK-SUB.                24640001
246500                                                                  24650001
246600     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       24660001
246700                                                                  24670001
246800     MOVE +0                       TO ASC-ITEM-SUB                24680001
246900                                      ASC-NUMBER-OF-ITEMS-READ    24690001
247000                                      ASC-NUMBER-OF-SELECTED-ITEMS24700001
247100                                      ASC-HIGHEST-BLOCK-WRITTEN   24710001
247200                                      ASC-START-OF-SELECTED-RANGE 24720001
247300                                      ASC-END-OF-SELECTED-RANGE   24730001
247400                                      ASC-ITEM-AT-TOP-OF-PANEL.   24740001
247500                                                                  24750001
247600     PERFORM 4100-PREPARE-CSR.                                    24760001
247700                                                                  24770001
247800     IF DK-REC-SEQ-NBR = 0                                        24780001
247900         PERFORM 4030-OPEN-SHIPT-CSR                              24790001
248000         SET PS-USE-SHIPT-CSR TO TRUE                             24800001
248100     ELSE                                                         24810001
248200        PERFORM 4010-OPEN-CARTON-CSR                              24820001
248300        SET PS-CARTON-CSR-FIRST TO TRUE                           24830001
248400     END-IF                                                       24840001
248500                                                                  24850001
248600     PERFORM 4300-READ-ITEMS-FROM-DB.                             24860001
248700                                                                  24870001
248800     IF PS-USE-SHIPT-CSR                                          24880001
248900        PERFORM 4040-CLOSE-SHIPT-CSR                              24890001
249000     ELSE                                                         24900001
249100        PERFORM 4020-CLOSE-CARTON-CSR                             24910001
249200     END-IF.                                                      24920001
249300                                                                  24930001
249400                                                                  24940001
249500     MOVE +1                   TO  PV-TOP-ITEM.                   24950001
249600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24960001
249700         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    24970001
249800         SET DP020-MSG-FATAL   TO  TRUE                           24980001
249900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24990001
250000     ELSE                                                         25000001
250100         MOVE -1               TO MR-SELECTL (1)                  25010001
250200         SET DP030-SET-CURSOR-APPL-1                              25020001
250300                               TO TRUE                            25030001
250400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25040001
250500     END-IF.                                                      25050001
250600 EJECT                                                            25060001
250700*                                                                 25070001
250800*                                                                 25080001
250900*----------------------------------------------------------------*25090001
251000* OPEN CARTON CSR.                                               *25100001
251100*----------------------------------------------------------------*25110001
251200 4010-OPEN-CARTON-CSR.                                            25120001
251300     PERFORM                                                      25130001
251400         WITH TEST AFTER                                          25140001
251500         VARYING PV-RETRY-COUNTER                                 25150001
251600         FROM 1 BY 1                                              25160001
251700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25170001
251800                   OR (SQLCODE = ZERO))                           25180001
251900                                                                  25190001
252000                  EXEC SQL                                        25200001
252100                       OPEN CARTON-CSR                            25210001
252200                  END-EXEC                                        25220001
252300                                                                  25230001
252400         EVALUATE TRUE                                            25240001
252500             WHEN SQLCODE = ZERO                                  25250001
252600             WHEN SQLCODE = -904                                  25260001
252700             WHEN SQLCODE = -913                                  25270001
252800                  CONTINUE                                        25280001
252900             WHEN OTHER                                           25290036
253000                  MOVE DK-PO-NBR              TO PV-DISP-PO       25300036
253100                  MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR     25310036
253200                  STRING  ' SUKCS553- 4010-  '   DELIMITED BY SIZE25320036
253300                          ' PO  -'               DELIMITED BY SIZE25330036
253400                          PV-DISP-PO             DELIMITED BY SIZE25340036
253500                          ' RCVR-'               DELIMITED BY SIZE25350036
253600                          PV-DISP-RCVR           DELIMITED BY SIZE25360036
253700                                         INTO PV-CICS-MSG-AREA    25370036
253800                  PERFORM 9900-WRITE-CICS-LOG                     25380041
253900                                                                  25390036
254000                  MOVE '4010-OPEN-CARTON-CSR'                     25400001
254100                                   TO DP013-PARAGRAPH             25410001
254200                  MOVE 'OPEN CARTON CSR - '                       25420001
254300                                   TO DP013-MESSAGE-TEXT (1)      25430001
254400                  MOVE SQLCA       TO DP013-SQLCA                 25440001
254500                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    25450001
254600                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    25460001
254700                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)    25470001
254800                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)    25480001
254900                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)    25490001
255000                  SET DP013-DB2-ABEND                             25500001
255100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          25510001
255200                  PERFORM DP013-0000-PROCESS-ABEND                25520001
255300         END-EVALUATE                                             25530001
255400     END-PERFORM.                                                 25540001
255500                                                                  25550001
255600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25560001
255700         MOVE '4010-OPEN-CARTON-CSR' TO DP013-PARAGRAPH           25570001
255800         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       25580001
255900                                   TO DP013-MESSAGE-TEXT (1)      25590001
256000         MOVE SQLCA                TO DP013-SQLCA                 25600001
256100         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             25610001
256200         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             25620001
256300         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)             25630001
256400         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)             25640001
256500         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)             25650001
256600         SET DP013-DB2-ABEND                                      25660001
256700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   25670001
256800         PERFORM DP013-0000-PROCESS-ABEND                         25680001
256900     END-IF.                                                      25690001
257000 EJECT                                                            25700001
257100*                                                                 25710001
257200*                                                                 25720001
257300*----------------------------------------------------------------*25730001
257400* CLOSE CARTON CSR.                                              *25740001
257500*----------------------------------------------------------------*25750001
257600 4020-CLOSE-CARTON-CSR.                                           25760001
257700             EXEC SQL                                             25770001
257800                  CLOSE CARTON-CSR                                25780001
257900             END-EXEC                                             25790001
258000                                                                  25800001
258100     EVALUATE TRUE                                                25810001
258200         WHEN SQLCODE = ZERO                                      25820001
258300              CONTINUE                                            25830001
258400         WHEN OTHER                                               25840036
258500              MOVE DK-PO-NBR              TO PV-DISP-PO           25850036
258600              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         25860036
258700              STRING  ' SUKCS553- 4020-  '   DELIMITED BY SIZE    25870036
258800                      ' PO  -'               DELIMITED BY SIZE    25880036
258900                      PV-DISP-PO             DELIMITED BY SIZE    25890036
259000                      ' RCVR-'               DELIMITED BY SIZE    25900036
259100                      PV-DISP-RCVR           DELIMITED BY SIZE    25910036
259200                                     INTO PV-CICS-MSG-AREA        25920036
259300              PERFORM 9900-WRITE-CICS-LOG                         25930041
259400                                                                  25940036
259500              MOVE '4020-CLOSE-CARTON-CSR'                        25950001
259600                                   TO DP013-PARAGRAPH             25960001
259700              MOVE 'CLOSE CARTON CSR'                             25970001
259800                                   TO DP013-MESSAGE-TEXT (1)      25980001
259900              MOVE SQLCA           TO DP013-SQLCA                 25990001
260000              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        26000001
260100              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        26010001
260200              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)        26020001
260300              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)        26030001
260400              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)        26040001
260500              SET DP013-DB2-ABEND                                 26050001
260600                  DP013-XCTL-DISPLAY-RESTART                      26060001
260700                                   TO TRUE                        26070001
260800              PERFORM DP013-0000-PROCESS-ABEND                    26080001
260900     END-EVALUATE.                                                26090001
261000 EJECT                                                            26100001
261100*                                                                 26110001
261200*                                                                 26120001
261300*----------------------------------------------------------------*26130001
261400* OPEN SHIPT-CSR.                                                *26140001
261500*----------------------------------------------------------------*26150001
261600 4030-OPEN-SHIPT-CSR.                                             26160001
261700     PERFORM                                                      26170001
261800         WITH TEST AFTER                                          26180001
261900         VARYING PV-RETRY-COUNTER                                 26190001
262000         FROM 1 BY 1                                              26200001
262100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26210001
262200                   OR (SQLCODE = ZERO))                           26220001
262300                                                                  26230001
262400                  EXEC SQL                                        26240001
262500                       OPEN SHIPT-CSR                             26250001
262600                  END-EXEC                                        26260001
262700                                                                  26270001
262800         EVALUATE TRUE                                            26280001
262900             WHEN SQLCODE = ZERO                                  26290001
263000             WHEN SQLCODE = -904                                  26300001
263100             WHEN SQLCODE = -913                                  26310001
263200                  CONTINUE                                        26320001
263300             WHEN OTHER                                           26330036
263400                  MOVE DK-PO-NBR              TO PV-DISP-PO       26340036
263500                  MOVE DK-TRIP-ID             TO PV-DISP-TRIP     26350036
263600                  STRING  ' SUKCS553- 4030-  '   DELIMITED BY SIZE26360036
263700                          ' PO  -'               DELIMITED BY SIZE26370036
263800                          PV-DISP-PO             DELIMITED BY SIZE26380036
263900                          ' TRIP-'               DELIMITED BY SIZE26390036
264000                          PV-DISP-TRIP           DELIMITED BY SIZE26400036
264100                                         INTO PV-CICS-MSG-AREA    26410036
264200                  PERFORM 9900-WRITE-CICS-LOG                     26420041
264300                                                                  26430036
264400                  MOVE '4030-OPEN-SHIPT-CSR'                      26440001
264500                                   TO DP013-PARAGRAPH             26450001
264600                  MOVE 'OPEN SHIPT CSR - '                        26460001
264700                                   TO DP013-MESSAGE-TEXT (1)      26470001
264800                  MOVE SQLCA       TO DP013-SQLCA                 26480001
264900                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)    26490001
265000                  MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)    26500001
265100                  MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)    26510001
265200                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)    26520001
265300                  SET DP013-DB2-ABEND                             26530001
265400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          26540001
265500                  PERFORM DP013-0000-PROCESS-ABEND                26550001
265600         END-EVALUATE                                             26560001
265700     END-PERFORM.                                                 26570001
265800                                                                  26580001
265900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26590001
266000         MOVE '4030-OPEN-SHIPT-CSR' TO DP013-PARAGRAPH            26600001
266100         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       26610001
266200                                   TO DP013-MESSAGE-TEXT (1)      26620001
266300         MOVE SQLCA                TO DP013-SQLCA                 26630001
266400         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)             26640001
266500         MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)             26650001
266600         MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)             26660001
266700         MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)             26670001
266800         SET DP013-DB2-ABEND                                      26680001
266900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   26690001
267000         PERFORM DP013-0000-PROCESS-ABEND                         26700001
267100     END-IF.                                                      26710001
267200 EJECT                                                            26720001
267300*                                                                 26730001
267400*                                                                 26740001
267500*----------------------------------------------------------------*26750001
267600* CLOSE SHIPT CSR.                                               *26760001
267700*----------------------------------------------------------------*26770001
267800 4040-CLOSE-SHIPT-CSR.                                            26780001
267900             EXEC SQL                                             26790001
268000                  CLOSE SHIPT-CSR                                 26800001
268100             END-EXEC                                             26810001
268200                                                                  26820001
268300     EVALUATE TRUE                                                26830001
268400         WHEN SQLCODE = ZERO                                      26840001
268500              CONTINUE                                            26850001
268600         WHEN OTHER                                               26860036
268700              MOVE DK-PO-NBR              TO PV-DISP-PO           26870036
268800              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         26880036
268900              STRING  ' SUKCS553- 4040-  '   DELIMITED BY SIZE    26890036
269000                      ' PO  -'               DELIMITED BY SIZE    26900036
269100                      PV-DISP-PO             DELIMITED BY SIZE    26910036
269200                      ' TRIP-'               DELIMITED BY SIZE    26920036
269300                      PV-DISP-TRIP           DELIMITED BY SIZE    26930036
269400                                     INTO PV-CICS-MSG-AREA        26940036
269500              PERFORM 9900-WRITE-CICS-LOG                         26950041
269600                                                                  26960036
269700              MOVE '4040-CLOSE-SHIPT-CSR'                         26970001
269800                                   TO DP013-PARAGRAPH             26980001
269900              MOVE 'CLOSE SHIPT CSR'                              26990001
270000                                   TO DP013-MESSAGE-TEXT (1)      27000001
270100              MOVE SQLCA           TO DP013-SQLCA                 27010001
270200              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        27020001
270300              MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)        27030001
270400              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)        27040001
270500              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)        27050001
270600              SET DP013-DB2-ABEND                                 27060001
270700                  DP013-XCTL-DISPLAY-RESTART                      27070001
270800                                   TO TRUE                        27080001
270900              PERFORM DP013-0000-PROCESS-ABEND                    27090001
271000     END-EVALUATE.                                                27100001
271100 EJECT                                                            27110001
271200*                                                                 27120001
271300*                                                                 27130001
271400*----------------------------------------------------------------*27140001
271500*    SET UP THE HOST VARIABLES.                                  *27150001
271600*    PERFORM THIS PARA WHEN MULTIPLE CSRS.                       *27160001
271700*----------------------------------------------------------------*27170001
271800 4100-PREPARE-CSR.                                                27180001
271900     SET ASC-NO-CSR                     TO TRUE.                  27190001
272000                                                                  27200001
272100     MOVE ASC-OPER-UNT-ID               TO DK-OPER-UNT-ID.        27210001
272200     MOVE ASC-SCAC                      TO DK-SCAC-ID.            27220001
272300     MOVE ASC-TRLR-NBR                  TO DK-VEH-NBR.            27230001
272400     MOVE ASC-TRIP-ID                   TO DK-TRIP-ID.            27240001
272500     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             27250001
272600     MOVE ASC-RECEIVER                  TO DK-REC-SEQ-NBR.        27260001
272700*                                                                 27270001
272800*                                                                 27280001
272900*----------------------------------------------------------------*27290001
273000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27300001
273100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27310001
273200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27320001
273300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27330001
273400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27340001
273500*                                                                *27350001
273600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27360001
273700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27370001
273800*    UPON INITIALIZATION.                                        *27380001
273900*----------------------------------------------------------------*27390001
274000 4300-READ-ITEMS-FROM-DB.                                         27400001
274100     PERFORM                                                      27410001
274200         VARYING PV-READ-COUNT                                    27420001
274300         FROM 1 BY 1                                              27430001
274400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    27440001
274500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         27450001
274600******************************************************************27460001
274700                                                                  27470001
274800     IF PS-USE-SHIPT-CSR                                          27480001
274900         PERFORM 4330-FETCH-SHIPT-CSR                             27490001
275000         PERFORM 4312-GET-CRTN-ERR-COUNT                          27500038
275100     ELSE                                                         27510001
275200         PERFORM 4310-FETCH-CARTON-CSR                            27520001
275300         PERFORM 4312-GET-CRTN-ERR-COUNT                          27530027
275400     END-IF                                                       27540001
275500                                                                  27550001
275600         IF  ASC-ITEMS-LEFT-ON-DB                                 27560001
275700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                27570001
275800                 ADD +1            TO ASC-ITEM-SUB                27580001
275900             ELSE                                                 27590001
276000                 ADD +1            TO ASC-BLK-SUB                 27600001
276100                 MOVE +1           TO ASC-ITEM-SUB                27610001
276200                                                                  27620001
276300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         27630001
276400                     MOVE +1       TO ASC-BLK-SUB                 27640001
276500                     SET ASC-BLOCK-MODIFIED (1)                   27650001
276600                                   TO TRUE                        27660001
276700                     PERFORM 5100-WRITE-TEMP-STORAGE              27670001
276800                     MOVE ASC-BLOCK-ENTRIES                       27680001
276900                               (PC-MAX-BLOCKS-IN-ARRAY)           27690001
277000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 27700001
277100                     ADD +1        TO ASC-BLK-SUB                 27710001
277200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27720001
277300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      27730001
277400                                   TO TRUE                        27740001
277500                 END-IF                                           27750001
277600             END-IF                                               27760001
277700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    27770001
277800             MOVE ASC-NUMBER-OF-ITEMS-READ                        27780001
277900                                   TO ASC-LIST-ITEM-NUMBER        27790001
278000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27800001
278100******************************************************************27810001
278200*GET VENDOR NAME                                                  27820001
278300         PERFORM 4320-GET-VENDOR-NAME                             27830001
278400******************************************************************27840001
278500                MOVE SPACES                                       27850001
278600                                 TO ASC-ACTION                    27860001
278700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    27870001
278800                MOVE SHUNLO-SHIPT-UNT-ID                          27880001
278900                                 TO  ASC-SERIAL-SHIP-CDE          27890001
279000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27900001
279100                MOVE PV-UNION-TYPE                                27910001
279200                                 TO ASC-CSR-IND                   27920001
279300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27930001
279400                MOVE SHPUNT-DEST-OPER-UNT-ID                      27940035
279500                                  TO ASC-STR-NBR                  27950001
279600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27960001
279700******************************************************************27970001
279800              IF DN-VEH-NBR = -1                                  27980001
279900                 MOVE SPACES TO ASC-VEH-NBR                       27990001
280000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28000001
280100              ELSE                                                28010001
280200                 MOVE VHTRIP-VEH-NBR    TO ASC-VEH-NBR            28020001
280300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28030001
280400              END-IF                                              28040001
280500******************************************************************28050001
280600              MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC-CDE           28060001
280700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28070001
280800******************************************************************28080001
280900              EVALUATE TRUE                                       28090001
281000                WHEN PV-UNION-TYPE = 'A'                          28100001
281100                WHEN PV-UNION-TYPE = 'B'                          28110019
281200                  MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE        28120001
281300                  MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME        28130001
281400                  MOVE PV-DTE-TME  TO  ASC-DATE-TIME              28140001
281500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28150001
281600                WHEN PV-UNION-TYPE = 'C'                          28160019
281700                WHEN PV-UNION-TYPE = 'D'                          28170019
281800                  MOVE WS-ENROUTE  TO  PV-TME                     28180001
281900                  MOVE PV-TME  TO  ASC-DATE-TIME                  28190001
282000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28200001
282100              END-EVALUATE                                        28210001
282200******************************************************************28220004
282300              IF PS-PBS-ERROR-CTN-FOUND                           28230004
282400                 MOVE PC-ERR TO  ASC-CRE-SRC                      28240005
282500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28250004
282600                 SET ASC-PBS-ERR-YES (ASC-BLK-SUB ASC-ITEM-SUB)   28260006
282700                                      TO TRUE                     28270004
282800              ELSE                                                28280004
282900                 MOVE SHPUNT-SHIPT-UNT-SRC-ID                     28290004
283000                                 TO  ASC-CRE-SRC                  28300004
283100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28310004
283200                 SET ASC-PBS-ERR-NO  (ASC-BLK-SUB ASC-ITEM-SUB)   28320006
283300                                      TO TRUE                     28330004
283400              END-IF                                              28340004
283500******************************************************************28350001
283600             IF PS-USE-SHIPT-CSR                                  28360001
283700                MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE          28370001
283800                MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME          28380001
283900                MOVE PV-DTE-TME  TO  ASC-DATE-TIME                28390001
284000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28400001
284100                MOVE ASC-TRIP-ID                                  28410001
284200                              TO ASC-LN-TRIP-ID                   28420001
284300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28430001
284400             ELSE                                                 28440001
284500                MOVE SHUNLO-TRIP-ID                               28450001
284600                              TO ASC-LN-TRIP-ID                   28460001
284700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28470001
284800             END-IF                                               28480001
284900                                                                  28490036
285000              EVALUATE TRUE                                       28500001
285100                WHEN PV-UNION-TYPE = 'B'                          28510019
285200                    PERFORM 4350-GET-UCC128-STATUS                28520001
285300              END-EVALUATE                                        28530001
285400         END-IF                                                   28540001
285500     END-PERFORM.                                                 28550001
285600******************************************************************28560001
285700       IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                        28570001
285800           MOVE +1                   TO ASC-BLK-SUB               28580001
285900           PERFORM 5100-WRITE-TEMP-STORAGE                        28590001
286000           ADD +1                    TO ASC-BLK-SUB               28600001
286100           PERFORM 5100-WRITE-TEMP-STORAGE                        28610001
286200                                                                  28620001
286300           MOVE 1                    TO ASC-BLK-SUB               28630001
286400                                        PV-BLOCK-NUMBER           28640001
286500           PERFORM 4410-READ-TEMP-STORAGE                         28650001
286600           IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1           28660001
286700               MOVE 2                TO ASC-BLK-SUB               28670001
286800                                        PV-BLOCK-NUMBER           28680001
286900               PERFORM 4410-READ-TEMP-STORAGE                     28690001
287000           END-IF                                                 28700001
287100       END-IF.                                                    28710001
287200*                                                                 28720001
287300*                                                                 28730001
287400*----------------------------------------------------------------*28740001
287500*    FETCH CARTON CSR.                                           *28750001
287600*----------------------------------------------------------------*28760001
287700 4310-FETCH-CARTON-CSR.                                           28770001
287800              EXEC SQL                                            28780001
287900                   FETCH CARTON-CSR                               28790001
288000                    INTO :PV-UNION-TYPE                           28800001
288100                        ,:SHUNLO-TRIP-ID                          28810001
288200                        ,:SHPTPO-PO-NBR                           28820001
288300                        ,:SHPTPO-REC-SEQ-NBR                      28830001
288400                        ,:PKSLIP-SEQ-NBR                          28840001
288500                        ,:INPKSU-SHIPT-UNT-ID                     28850001
288600                        ,:SHPUNT-DEST-OPER-UNT-ID                 28860001
288700                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 28870001
288800                        ,:SHUNLO-CRE-TMST                         28880001
288900                        ,:WS-SHUNLO-CRE-TMST-DATE                 28890001
289000                        ,:WS-SHUNLO-CRE-TMST-TIME                 28900001
289100              END-EXEC                                            28910001
289200                                                                  28920001
289300     EVALUATE TRUE                                                28930001
289400         WHEN SQLCODE = ZERO                                      28940001
289500              ADD +1 TO PV-DB2-COUNT-CARTONS                      28950039
289600              MOVE PV-DB2-COUNT-CARTONS TO ASC-TOT-CRTNS          28960040
289700              MOVE INPKSU-SHIPT-UNT-ID                            28970001
289800                                TO SHUNLO-SHIPT-UNT-ID            28980001
289900              EVALUATE TRUE                                       28990001
290000                WHEN PV-UNION-TYPE = 'A'                          29000018
290100                WHEN PV-UNION-TYPE = 'B'                          29010018
290200                      MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R        29020001
290300                      MOVE PV-TMST-CC         TO PV-DISPLAY-CC    29030001
290400                      MOVE PV-TMST-YY         TO PV-DISPLAY-YY    29040001
290500                      MOVE PC-SLASH           TO PV-SLASH-1       29050001
290600                      MOVE PV-TMST-MM         TO PV-DISPLAY-MM    29060001
290700                      MOVE PC-SLASH           TO PV-SLASH-2       29070001
290800                      MOVE PV-TMST-DD         TO PV-DISPLAY-DD    29080001
290900                      MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS   29090001
291000                      MOVE PC-COLON           TO PV-COLON         29100001
291100                      MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN   29110001
291200                                                                  29120001
291300                      MOVE PV-DATE-TIME-DISPLAY                   29130001
291400                                       TO  WS-SHUNLO-CRE-TMST     29140001
291500                WHEN PV-UNION-TYPE = 'C'                          29150018
291600                WHEN PV-UNION-TYPE = 'D'                          29160018
291700                      MOVE PV-ENROUTE-DISPLAY                     29170001
291800                                       TO  WS-ENROUTE             29180001
291900              END-EVALUATE                                        29190001
292000              EVALUATE TRUE                                       29200021
292100                WHEN PV-UNION-TYPE = 'A'                          29210021
292200                WHEN PV-UNION-TYPE = 'C'                          29220021
292300                    SET PS-PBS-ERROR-CTN-FOUND TO TRUE            29230021
292400                WHEN PV-UNION-TYPE = 'B'                          29240021
292500                WHEN PV-UNION-TYPE = 'D'                          29250021
292600                    SET PS-PBS-ERROR-CTN-FOUND-NO TO TRUE         29260021
292700              END-EVALUATE                                        29270021
292800                                                                  29280001
292900              PERFORM 4340-GET-VEHICLE                            29290001
293000                                                                  29300001
293100         WHEN SQLCODE = +100                                      29310001
293200              IF PS-CARTON-CSR-FIRST                              29320001
293300                 PERFORM 4030-OPEN-SHIPT-CSR                      29330001
293400                 PERFORM 4330-FETCH-SHIPT-CSR                     29340001
293500                 PERFORM 4312-GET-CRTN-ERR-COUNT                  29350039
293600                 IF PS-EO-SHIPT-CSR                               29360001
293700*                   PERFORM 4040-CLOSE-SHIPT-CSR                  29370001
293800                    SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE           29380001
293900                    SET PS-EO-CARTON-CSR TO TRUE                  29390001
294000                 ELSE                                             29400001
294100                    SET PS-USE-SHIPT-CSR TO TRUE                  29410001
294200                 END-IF                                           29420001
294300              ELSE                                                29430001
294400                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              29440001
294500                 SET PS-EO-CARTON-CSR TO TRUE                     29450001
294600              END-IF                                              29460001
294700                                                                  29470001
294800         WHEN OTHER                                               29480031
294900              MOVE DK-PO-NBR              TO PV-DISP-PO           29490031
295000              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         29500031
295100              STRING  ' SUKCS553- 4310-  '      DELIMITED BY SIZE 29510031
295200                      ' PO  -'                  DELIMITED BY SIZE 29520031
295300                      PV-DISP-PO                DELIMITED BY SIZE 29530031
295400                      ' RCVR-'                  DELIMITED BY SIZE 29540031
295500                      PV-DISP-RCVR              DELIMITED BY SIZE 29550031
295600                                     INTO PV-CICS-MSG-AREA        29560031
295700              PERFORM 9900-WRITE-CICS-LOG                         29570041
295800                                                                  29580031
295900              MOVE '4310-FETCH-CARTON-CSR'                        29590001
296000                                   TO DP013-PARAGRAPH             29600001
296100              MOVE 'FETCH CARTON CSR'                             29610001
296200                                   TO DP013-MESSAGE-TEXT (1)      29620001
296300              MOVE SQLCA           TO DP013-SQLCA                 29630001
296400              SET DP013-DB2-ABEND  TO TRUE                        29640001
296500              PERFORM DP013-0000-PROCESS-ABEND                    29650001
296600     END-EVALUATE.                                                29660001
296700                                                                  29670001
296800     IF PS-CARTON-CSR-FIRST                                       29680001
296900         SET PS-NOT-CARTON-CSR-FIRST TO TRUE                      29690001
297000     END-IF.                                                      29700001
297100*                                                                 29710001
297200 4312-GET-CRTN-ERR-COUNT.                                         29720027
297300         EXEC SQL                                                 29730027
297400             SELECT COUNT(*)                                      29740027
297500               INTO :PV-DB2-COUNT-PBS-ERRORS                      29750028
297600               FROM TPKSLIP A                                     29760027
297700                  , TINPKSU B                                     29770027
297800                  , TSHUNLO C                                     29780027
297900              WHERE A.PO_NBR       = :DK-PO-NBR                   29790027
298000                AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR              29800027
298100                AND A.VER_STAT_CDE = :PC-A                        29810027
298200                AND A.PO_NBR       = B.PO_NBR                     29820027
298300                AND A.SEQ_NBR      = B.SEQ_NBR                    29830027
298400                AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID               29840027
298500                AND C.SCN_LOC_ID IN                               29850027
298600                   ('PBSA', 'PBSB', 'PBSC', 'PBSD', 'PBSE')       29860027
298700         END-EXEC                                                 29870027
298800                                                                  29880027
298900         EVALUATE TRUE                                            29890027
299000             WHEN SQLCODE = +0                                    29900027
299100                  MOVE PV-DB2-COUNT-PBS-ERRORS TO                 29910040
299200                       ASC-TOT-CRTNS-ERR                          29920040
299300             WHEN SQLCODE = +100                                  29930027
299400             WHEN SQLCODE = -904                                  29940027
299500             WHEN SQLCODE = -913                                  29950027
299600                  CONTINUE                                        29960027
299700             WHEN OTHER                                           29970033
299800                  MOVE DK-PO-NBR              TO PV-DISP-PO       29980033
299900                  MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR     29990033
300000                  STRING  ' SUKCS553- 4312-  '   DELIMITED BY SIZE30000033
300100                          ' PO  -'               DELIMITED BY SIZE30010033
300200                          PV-DISP-PO             DELIMITED BY SIZE30020033
300300                          ' RCVR-'               DELIMITED BY SIZE30030033
300400                          PV-DISP-RCVR           DELIMITED BY SIZE30040033
300500                                         INTO PV-CICS-MSG-AREA    30050033
300600                  PERFORM 9900-WRITE-CICS-LOG                     30060041
300700                                                                  30070033
300800                  MOVE '4312-GET-CRTN-ERR-COUNT'                  30080033
300900                                  TO DP013-PARAGRAPH              30090033
301000                  MOVE 'UNSUCCESSFUL CRTN ERROR COUNT'            30100033
301100                                  TO DP013-MESSAGE-TEXT (1)       30110033
301200                  MOVE SQLCA      TO DP013-SQLCA                  30120033
301300                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     30130033
301400                  MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME (2)     30140033
301500                  MOVE 'TSHUNLO ' TO DP013-DB2-TABLE-NAME (3)     30150033
301600                  SET DP013-DB2-ABEND                             30160033
301700                      DP013-XCTL-DISPLAY-RESTART                  30170033
301800                                  TO TRUE                         30180033
301900                  PERFORM DP013-0000-PROCESS-ABEND                30190033
302000         END-EVALUATE.                                            30200029
302100*                                                                 30210027
302200*----------------------------------------------------------------*30220027
302300* GET THE VENDOR NAME.                                           *30230027
302400*----------------------------------------------------------------*30240027
302500 4320-GET-VENDOR-NAME.                                            30250027
302600     PERFORM                                                      30260027
302700         WITH TEST AFTER                                          30270027
302800         VARYING PV-RETRY-COUNTER                                 30280027
302900         FROM 1 BY 1                                              30290027
303000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30300027
303100             OR (SQLCODE = +0)                                    30310027
303200             OR (SQLCODE = +100)                                  30320027
303300             OR (SQLCODE = -305))                                 30330027
303400                                                                  30340027
303500         EXEC SQL                                                 30350027
303600              SELECT B.ENT_NAME_DESC                              30360027
303700                INTO :ENTNME-ENT-NAME-DESC                        30370027
303800              FROM   TPURCHS A                                    30380027
303900                    ,TENTNME B                                    30390027
304000              WHERE A.PO_NBR         = :DK-PO-NBR                 30400027
304100                AND A.VER_STATUS_CDE = 'A'                        30410027
304200                AND B.TYPE_CDE       = '01'                       30420027
304300                AND A.ENT_ID         = B.ENT_ID                   30430027
304400         END-EXEC                                                 30440027
304500                                                                  30450027
304600         EVALUATE TRUE                                            30460027
304700             WHEN SQLCODE = +0                                    30470027
304800                  MOVE ENTNME-ENT-NAME-DESC                       30480027
304900                                  TO ASC-ENT-NAME-DESC            30490027
305000             WHEN SQLCODE = +100                                  30500027
305100             WHEN SQLCODE = -904                                  30510027
305200             WHEN SQLCODE = -913                                  30520027
305300                  CONTINUE                                        30530027
305400             WHEN OTHER                                           30540034
305500                  MOVE DK-PO-NBR              TO PV-DISP-PO       30550034
305600                  STRING  ' SUKCS553- 4320-  '   DELIMITED BY SIZE30560034
305700                          ' PO  -'               DELIMITED BY SIZE30570034
305800                          PV-DISP-PO             DELIMITED BY SIZE30580034
305900                                         INTO PV-CICS-MSG-AREA    30590034
306000                  PERFORM 9900-WRITE-CICS-LOG                     30600041
306100                                                                  30610034
306200                  MOVE '4320-GET-VENDOR-NAME'                     30620027
306300                                  TO DP013-PARAGRAPH              30630027
306400                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME'           30640027
306500                                  TO DP013-MESSAGE-TEXT (1)       30650027
306600                  MOVE SQLCA      TO DP013-SQLCA                  30660027
306700                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     30670027
306800                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     30680027
306900                  SET DP013-DB2-ABEND                             30690027
307000                      DP013-XCTL-DISPLAY-RESTART                  30700027
307100                                  TO TRUE                         30710027
307200                  PERFORM DP013-0000-PROCESS-ABEND                30720027
307300         END-EVALUATE                                             30730027
307400     END-PERFORM.                                                 30740027
307500                                                                  30750027
307600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    30760027
307700         SQLCODE NOT = +0                                         30770027
307800         MOVE '4320-GET-VENDOR-NAME'                              30780027
307900                                  TO DP013-PARAGRAPH              30790027
308000         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME'            30800027
308100                                  TO DP013-MESSAGE-TEXT (1)       30810027
308200         MOVE SQLCA               TO DP013-SQLCA                  30820027
308300         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     30830027
308400         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (2)     30840027
308500         SET DP013-DB2-ABEND                                      30850027
308600             DP013-XCTL-DISPLAY-RESTART                           30860027
308700                                  TO TRUE                         30870027
308800         PERFORM DP013-0000-PROCESS-ABEND                         30880027
308900     END-IF.                                                      30890027
309000*                                                                 30900027
309100*                                                                 30910027
309200*----------------------------------------------------------------*30920027
309300*    FETCH SHIPT CSR.                                            *30930027
309400*----------------------------------------------------------------*30940027
309500 4330-FETCH-SHIPT-CSR.                                            30950027
309600     EXEC SQL                                                     30960027
309700          FETCH SHIPT-CSR                                         30970027
309800           INTO :PV-UNION-TYPE-2                                  30980027
309900               ,:SHUNLO-SHIPT-UNT-ID                              30990027
310000               ,:SHPUNT-DEST-OPER-UNT-ID                          31000027
310100               ,:SHPUNT-SHIPT-UNT-SRC-ID                          31010027
310200               ,:SHUNLO-CRE-TMST                                  31020027
310300               ,:WS-SHUNLO-CRE-TMST-DATE                          31030027
310400               ,:WS-SHUNLO-CRE-TMST-TIME                          31040027
310500               ,:VHTRIP-OWNER-SCAC-ID                             31050027
310600               ,:VHTRIP-VEH-NBR :DN-VEH-NBR                       31060027
310700     END-EXEC                                                     31070027
310800                                                                  31080027
310900     EVALUATE TRUE                                                31090027
311000         WHEN SQLCODE = ZERO                                      31100027
311100              ADD +1 TO PV-DB2-COUNT-CARTONS                      31110039
311200              MOVE PV-DB2-COUNT-CARTONS TO ASC-TOT-CRTNS          31120040
311300              IF DN-VEH-NBR = -1                                  31130027
311400                 MOVE SPACES TO VHTRIP-VEH-NBR                    31140027
311500              END-IF                                              31150027
311600              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                31160027
311700              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            31170027
311800              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            31180027
311900              MOVE PC-SLASH           TO PV-SLASH-1               31190027
312000              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            31200027
312100              MOVE PC-SLASH           TO PV-SLASH-2               31210027
312200              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            31220027
312300              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           31230027
312400              MOVE PC-COLON           TO PV-COLON                 31240027
312500              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           31250027
312600                                                                  31260027
312700              MOVE PV-DATE-TIME-DISPLAY                           31270027
312800                               TO  WS-SHUNLO-CRE-TMST             31280027
312900                                                                  31290027
313000              MOVE ZEROS           TO SHPTPO-REC-SEQ-NBR          31300027
313100              MOVE SPACES          TO PV-UNION-TYPE               31310027
313200         WHEN SQLCODE = +100                                      31320027
313300              SET PS-EO-CARTON-CSR TO TRUE                        31330027
313400              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 31340027
313500         WHEN OTHER                                               31350034
313600              MOVE DK-PO-NBR              TO PV-DISP-PO           31360034
313700              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         31370034
313800              STRING  ' SUKCS553- 4330-  '   DELIMITED BY SIZE    31380034
313900                      ' PO  -'               DELIMITED BY SIZE    31390034
314000                      PV-DISP-PO             DELIMITED BY SIZE    31400034
314100                      ' TRIP-'               DELIMITED BY SIZE    31410034
314200                      PV-DISP-TRIP           DELIMITED BY SIZE    31420034
314300                                     INTO PV-CICS-MSG-AREA        31430034
314400              PERFORM 9900-WRITE-CICS-LOG                         31440041
314500                                                                  31450034
314600              MOVE '4330-FETCH-SHIPT-CSR'                         31460027
314700                                   TO DP013-PARAGRAPH             31470027
314800              MOVE 'FETCH SHIPT CSR'                              31480027
314900                                   TO DP013-MESSAGE-TEXT (1)      31490027
315000              MOVE SQLCA           TO DP013-SQLCA                 31500027
315100              SET DP013-DB2-ABEND  TO TRUE                        31510027
315200              PERFORM DP013-0000-PROCESS-ABEND                    31520027
315300     END-EVALUATE.                                                31530027
315400                                                                  31540027
315500     IF  SQLCODE EQUAL +100                                       31550027
315600         SET ASC-NO-ITEMS-LEFT-ON-DB                              31560027
315700                                   TO TRUE                        31570027
315800     END-IF.                                                      31580027
315900*                                                                 31590027
316000*----------------------------------------------------------------*31600027
316100*----------------------------------------------------------------*31610027
316200*    GET VEHICLE INFORMATION.                                    *31620027
316300*----------------------------------------------------------------*31630027
316400 4340-GET-VEHICLE.                                                31640027
316500     EXEC SQL                                                     31650027
316600          SELECT OWNER_SCAC_ID                                    31660027
316700              ,  VEH_NBR                                          31670027
316800            INTO :VHTRIP-OWNER-SCAC-ID                            31680027
316900              ,  :VHTRIP-VEH-NBR :DN-VEH-NBR                      31690027
317000            FROM TVHTRIP                                          31700027
317100           WHERE TRIP_ID    = :SHUNLO-TRIP-ID                     31710027
317200     END-EXEC.                                                    31720027
317300                                                                  31730027
317400     EVALUATE TRUE                                                31740027
317500         WHEN SQLCODE = ZERO                                      31750027
317600              IF DN-VEH-NBR = -1                                  31760027
317700                 MOVE SPACES TO VHTRIP-VEH-NBR                    31770027
317800              END-IF                                              31780027
317900         WHEN SQLCODE = +100                                      31790027
318000         WHEN SQLCODE = -904                                      31800027
318100         WHEN SQLCODE = -913                                      31810027
318200              CONTINUE                                            31820027
318300         WHEN OTHER                                               31830036
318400              MOVE DK-TRIP-ID             TO PV-DISP-TRIP         31840036
318500              STRING  ' SUKCS553- 4340-  '   DELIMITED BY SIZE    31850036
318600                      ' TRIP-'               DELIMITED BY SIZE    31860036
318700                      PV-DISP-TRIP           DELIMITED BY SIZE    31870036
318800                                     INTO PV-CICS-MSG-AREA        31880036
318900              PERFORM 9900-WRITE-CICS-LOG                         31890041
319000                                                                  31900036
319100              MOVE '4340-GET-VEHICLE'                             31910027
319200                                   TO DP013-PARAGRAPH             31920027
319300              MOVE 'GET-VEHICLE'                                  31930027
319400                                   TO DP013-MESSAGE-TEXT (1)      31940027
319500              MOVE SQLCA           TO DP013-SQLCA                 31950027
319600              SET DP013-DB2-ABEND  TO TRUE                        31960027
319700              PERFORM DP013-0000-PROCESS-ABEND                    31970027
319800     END-EVALUATE.                                                31980027
319900*                                                                 31990027
320000*----------------------------------------------------------------*32000027
320100*    GET UCC128 CROSS-REFERENCE STATUS                           *32010027
320200*----------------------------------------------------------------*32020027
320300  4350-GET-UCC128-STATUS.                                         32030027
320400                                                                  32040027
320500     SET   PS-NOT-EOF-SULBXF-CSR TO TRUE.                         32050027
320600     SET   PS-NO-SULBXF-FOUND                                     32060027
320700           PS-NO-ACTIVE-FND      TO TRUE.                         32070027
320800     MOVE  ZEROS                    TO  PV-XREF-ROWS.             32080031
320900                                                                  32090027
321000     PERFORM 4355-OPEN-ACTIVE-STAT-CSR.                           32100027
321100     PERFORM 4360-FETCH-ACTIVE-STAT-CSR.                          32110027
321200                                                                  32120027
321300     IF PS-NO-SULBXF-FOUND                                        32130027
321400         PERFORM 4370-CLOSE-ACTIVE-STAT-CSR                       32140027
321500         SET PS-NOT-EOF-SULBXF-CSR  TO  TRUE                      32150027
321600         PERFORM 4356-OPEN-INACTIVE-STAT-CSR                      32160027
321700         PERFORM 4361-FETCH-INACTIVE-STAT-CSR                     32170027
321800     END-IF                                                       32180027
321900                                                                  32190027
322000     IF PS-SULBXF-FOUND                                           32200027
322100        PERFORM 4365-PROCESS-STATUS                               32210027
322200                UNTIL PS-EOF-SULBXF-CSR                           32220027
322300     END-IF.                                                      32230027
322400                                                                  32240027
322500     IF PS-NO-ACTIVE-FND                                          32250027
322600        PERFORM 4371-CLOSE-INACTIVE-STAT-CSR                      32260027
322700     ELSE                                                         32270027
322800        PERFORM 4370-CLOSE-ACTIVE-STAT-CSR                        32280027
322900     END-IF.                                                      32290027
323000*                                                                 32300027
323100*                                                                 32310027
323200*----------------------------------------------------------------*32320027
323300*    GET CARTONS WITH INACTIVE STATUS ON SULBXF                  *32330027
323400*----------------------------------------------------------------*32340027
323500*                                                                 32350027
323600 4355-OPEN-ACTIVE-STAT-CSR.                                       32360027
323700                                                                  32370027
323800     PERFORM                                                      32380027
323900         WITH TEST AFTER                                          32390027
324000         VARYING PV-RETRY-COUNTER                                 32400027
324100         FROM 1 BY 1                                              32410027
324200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32420027
324300                   OR (SQLCODE = ZERO))                           32430027
324400                                                                  32440027
324500                  EXEC SQL                                        32450027
324600                       OPEN ACTIVE-STAT-CSR                       32460027
324700                  END-EXEC                                        32470027
324800                                                                  32480027
324900         EVALUATE TRUE                                            32490027
325000             WHEN SQLCODE = ZERO                                  32500027
325100             WHEN SQLCODE = -904                                  32510027
325200             WHEN SQLCODE = -913                                  32520027
325300             WHEN SQLCODE = -310                                  32530027
325400                  CONTINUE                                        32540027
325500             WHEN OTHER                                           32550036
325600                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 32560036
325700                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 32570036
325800                  STRING  ' SUKCS553- 4355-  '   DELIMITED BY SIZE32580036
325900                          ' PO  -'               DELIMITED BY SIZE32590036
326000                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE32600036
326100                          ' RCVR-'               DELIMITED BY SIZE32610036
326200                          PV-DISP-CRE-TMST       DELIMITED BY SIZE32620036
326300                                         INTO PV-CICS-MSG-AREA    32630036
326400                  PERFORM 9900-WRITE-CICS-LOG                     32640041
326500                                                                  32650036
326600                  MOVE '4355-OPEN-ACTIVE-STAT-CSR'                32660027
326700                                   TO DP013-PARAGRAPH             32670027
326800                  MOVE 'OPEN ACTIVE STATUS CSR - '                32680027
326900                                   TO DP013-MESSAGE-TEXT (1)      32690027
327000                  MOVE SQLCA       TO DP013-SQLCA                 32700027
327100                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    32710027
327200                  SET DP013-DB2-ABEND                             32720027
327300                      DP013-XCTL-DISPLAY-RESTART TO TRUE          32730027
327400                  PERFORM DP013-0000-PROCESS-ABEND                32740027
327500         END-EVALUATE                                             32750027
327600     END-PERFORM.                                                 32760027
327700                                                                  32770027
327800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32780027
327900         MOVE '4355-OPEN-ACTIVE STATUS-CSR' TO DP013-PARAGRAPH    32790027
328000         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       32800027
328100                                   TO DP013-MESSAGE-TEXT (1)      32810027
328200         MOVE SQLCA                TO DP013-SQLCA                 32820027
328300         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             32830027
328400         SET DP013-DB2-ABEND                                      32840027
328500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   32850027
328600         PERFORM DP013-0000-PROCESS-ABEND                         32860027
328700     END-IF.                                                      32870027
328800*                                                                 32880027
328900*                                                                 32890027
329000 4356-OPEN-INACTIVE-STAT-CSR.                                     32900027
329100                                                                  32910027
329200     PERFORM                                                      32920027
329300         WITH TEST AFTER                                          32930027
329400         VARYING PV-RETRY-COUNTER                                 32940027
329500         FROM 1 BY 1                                              32950027
329600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32960027
329700                   OR (SQLCODE = ZERO))                           32970027
329800                                                                  32980027
329900                  EXEC SQL                                        32990027
330000                       OPEN INACTIVE-STAT-CSR                     33000027
330100                  END-EXEC                                        33010027
330200                                                                  33020027
330300         EVALUATE TRUE                                            33030027
330400             WHEN SQLCODE = ZERO                                  33040027
330500             WHEN SQLCODE = -904                                  33050027
330600             WHEN SQLCODE = -913                                  33060027
330700             WHEN SQLCODE = -310                                  33070027
330800                  CONTINUE                                        33080027
330900             WHEN OTHER                                           33090036
331000                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 33100036
331100                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 33110036
331200                  STRING  ' SUKCS553- 4356-  '   DELIMITED BY SIZE33120036
331300                          ' PO  -'               DELIMITED BY SIZE33130036
331400                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE33140036
331500                          ' RCVR-'               DELIMITED BY SIZE33150036
331600                          PV-DISP-CRE-TMST       DELIMITED BY SIZE33160036
331700                                         INTO PV-CICS-MSG-AREA    33170036
331800                  PERFORM 9900-WRITE-CICS-LOG                     33180041
331900                                                                  33190036
332000                  MOVE '4356-OPEN-INACTIVE-STAT-CSR'              33200027
332100                                   TO DP013-PARAGRAPH             33210027
332200                  MOVE 'OPEN INACTIVE STATUS CSR - '              33220027
332300                                   TO DP013-MESSAGE-TEXT (1)      33230027
332400                  MOVE SQLCA       TO DP013-SQLCA                 33240027
332500                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    33250027
332600                  SET DP013-DB2-ABEND                             33260027
332700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          33270027
332800                  PERFORM DP013-0000-PROCESS-ABEND                33280027
332900         END-EVALUATE                                             33290027
333000     END-PERFORM.                                                 33300027
333100                                                                  33310027
333200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33320027
333300         MOVE '4356-OPEN-INACTIVE STATUS-CSR' TO DP013-PARAGRAPH  33330027
333400         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       33340027
333500                                   TO DP013-MESSAGE-TEXT (1)      33350027
333600         MOVE SQLCA                TO DP013-SQLCA                 33360027
333700         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             33370027
333800         SET DP013-DB2-ABEND                                      33380027
333900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   33390027
334000         PERFORM DP013-0000-PROCESS-ABEND                         33400027
334100     END-IF.                                                      33410027
334200*                                                                 33420027
334300*                                                                 33430027
334400 4360-FETCH-ACTIVE-STAT-CSR.                                      33440027
334500                                                                  33450027
334600     PERFORM                                                      33460027
334700         WITH TEST AFTER                                          33470027
334800         VARYING PV-RETRY-COUNTER                                 33480027
334900         FROM 1 BY 1                                              33490027
335000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33500027
335100                   OR (SQLCODE = ZERO)                            33510027
335200                   OR PS-EOF-SULBXF-CSR)                          33520027
335300                                                                  33530027
335400              EXEC SQL                                            33540027
335500                   FETCH ACTIVE-STAT-CSR                          33550027
335600                    INTO :SULBXF-STAT-CDE                         33560027
335700                        ,:SULBXF-SHIPT-UNT-ID                     33570027
335800                        ,:SULBXF-CART-LBL-TYP-CDE                 33580027
335900                        ,:SULBXF-CRE-TMST                         33590027
336000                        ,:SULBXF-DEST-OPER-UNT-ID                 33600027
336100              END-EXEC                                            33610027
336200                                                                  33620027
336300         EVALUATE TRUE                                            33630027
336400             WHEN SQLCODE = ZERO                                  33640027
336500                  SET PS-SULBXF-FOUND                             33650027
336600                      PS-ACTIVE-FND   TO TRUE                     33660027
336700             WHEN SQLCODE = +100                                  33670027
336800                  SET PS-EOF-SULBXF-CSR TO TRUE                   33680027
336900             WHEN OTHER                                           33690035
337000                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 33700035
337100                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 33710035
337200                  STRING  ' SUKCS553- 4360-  '   DELIMITED BY SIZE33720035
337300                          ' PO  -'               DELIMITED BY SIZE33730035
337400                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE33740035
337500                          ' RCVR-'               DELIMITED BY SIZE33750035
337600                          PV-DISP-CRE-TMST       DELIMITED BY SIZE33760035
337700                                         INTO PV-CICS-MSG-AREA    33770035
337800                  PERFORM 9900-WRITE-CICS-LOG                     33780041
337900                                                                  33790035
338000                  MOVE '4360-FETCH-ACTIVE-STAT-CSR'               33800027
338100                                       TO DP013-PARAGRAPH         33810027
338200                  MOVE 'FETCH ACTIVE STATUS CSR'                  33820027
338300                                       TO DP013-MESSAGE-TEXT (1)  33830027
338400                  MOVE SHUNLO-SHIPT-UNT-ID TO PV-DISP-SHIPT-ID    33840035
338500                  STRING ' SHIPT-UNIT-'       DELIMITED BY SIZE   33850027
338600                          PV-DISP-SHIPT-ID DELIMITED BY SIZE      33860035
338700                                     INTO DP013-MESSAGE-TEXT (2)  33870027
338800                  MOVE SQLCA           TO DP013-SQLCA             33880027
338900              SET DP013-DB2-ABEND  TO TRUE                        33890027
339000                  PERFORM DP013-0000-PROCESS-ABEND                33900027
339100         END-EVALUATE                                             33910027
339200                                                                  33920027
339300     END-PERFORM.                                                 33930027
339400                                                                  33940027
339500      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                       33950027
339600          MOVE '4360-FETCH-ACTIVE-STAT-CSR'                       33960027
339700                                     TO DP013-PARAGRAPH           33970027
339800          MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO FETCH CSR'     33980027
339900                                    TO DP013-MESSAGE-TEXT (1)     33990027
340000          MOVE SQLCA                TO DP013-SQLCA                34000027
340100          MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)            34010027
340200          SET DP013-DB2-ABEND                                     34020027
340300              DP013-XCTL-DISPLAY-RESTART TO TRUE                  34030027
340400          PERFORM DP013-0000-PROCESS-ABEND                        34040027
340500      END-IF.                                                     34050027
340600*                                                                 34060027
340700*                                                                 34070027
340800 4361-FETCH-INACTIVE-STAT-CSR.                                    34080027
340900                                                                  34090027
341000     PERFORM                                                      34100027
341100         WITH TEST AFTER                                          34110027
341200         VARYING PV-RETRY-COUNTER                                 34120027
341300         FROM 1 BY 1                                              34130027
341400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34140027
341500                   OR (SQLCODE = ZERO)                            34150027
341600                   OR PS-EOF-SULBXF-CSR)                          34160027
341700                                                                  34170027
341800              EXEC SQL                                            34180027
341900                   FETCH INACTIVE-STAT-CSR                        34190027
342000                    INTO :SULBXF-STAT-CDE                         34200027
342100                        ,:SULBXF-SHIPT-UNT-ID                     34210027
342200                        ,:SULBXF-CART-LBL-TYP-CDE                 34220027
342300                        ,:SULBXF-CRE-TMST                         34230027
342400                        ,:SULBXF-DEST-OPER-UNT-ID                 34240027
342500              END-EXEC                                            34250027
342600                                                                  34260027
342700         EVALUATE TRUE                                            34270027
342800             WHEN SQLCODE = ZERO                                  34280027
342900                  SET PS-SULBXF-FOUND TO TRUE                     34290027
343000             WHEN SQLCODE = +100                                  34300027
343100                  SET PS-NO-INACTIVE-FND                          34310027
343200                      PS-EOF-SULBXF-CSR        TO TRUE            34320027
343300             WHEN OTHER                                           34330036
343400                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 34340036
343500                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 34350036
343600                  STRING  ' SUKCS553- 4361-  '   DELIMITED BY SIZE34360036
343700                          ' PO  -'               DELIMITED BY SIZE34370036
343800                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE34380036
343900                          ' RCVR-'               DELIMITED BY SIZE34390036
344000                          PV-DISP-CRE-TMST       DELIMITED BY SIZE34400036
344100                                         INTO PV-CICS-MSG-AREA    34410036
344200                  PERFORM 9900-WRITE-CICS-LOG                     34420041
344300                                                                  34430036
344400                  MOVE '4361-FETCH-INACTIVE-STAT-CSR'             34440027
344500                                       TO DP013-PARAGRAPH         34450027
344600                  MOVE 'FETCH INACTIVE STATUS CSR'                34460027
344700                                       TO DP013-MESSAGE-TEXT (1)  34470027
344800                  MOVE SHUNLO-SHIPT-UNT-ID TO PV-DISP-SHIPT-ID    34480035
344900                  STRING ' SHIPT-UNIT-'       DELIMITED BY SIZE   34490027
345000                          PV-DISP-SHIPT-ID DELIMITED BY SIZE      34500035
345100                                     INTO DP013-MESSAGE-TEXT (2)  34510027
345200                  MOVE SQLCA           TO DP013-SQLCA             34520027
345300              SET DP013-DB2-ABEND  TO TRUE                        34530027
345400                  PERFORM DP013-0000-PROCESS-ABEND                34540027
345500         END-EVALUATE                                             34550027
345600                                                                  34560027
345700     END-PERFORM.                                                 34570027
345800                                                                  34580027
345900      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                       34590027
346000          MOVE '4361-FETCH-INACTIVE-STAT-CSR'                     34600027
346100                                     TO DP013-PARAGRAPH           34610027
346200          MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO FETCH CSR'     34620027
346300                                    TO DP013-MESSAGE-TEXT (1)     34630027
346400          MOVE SQLCA                TO DP013-SQLCA                34640027
346500          MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)            34650027
346600          SET DP013-DB2-ABEND                                     34660027
346700              DP013-XCTL-DISPLAY-RESTART TO TRUE                  34670027
346800          PERFORM DP013-0000-PROCESS-ABEND                        34680027
346900      END-IF.                                                     34690027
347000*                                                                 34700027
347100*                                                                 34710027
347200 4365-PROCESS-STATUS.                                             34720027
347300        ADD  1                    TO  PV-XREF-ROWS                34730027
347400                                                                  34740027
347500        IF  PV-XREF-ROWS  >  1                                    34750027
347600            IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 34760027
347700                ADD +1            TO ASC-ITEM-SUB                 34770027
347800            ELSE                                                  34780027
347900                ADD +1            TO ASC-BLK-SUB                  34790027
348000                MOVE +1           TO ASC-ITEM-SUB                 34800027
348100                                                                  34810027
348200                IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          34820027
348300                    MOVE +1       TO ASC-BLK-SUB                  34830027
348400                    SET ASC-BLOCK-MODIFIED (1)                    34840027
348500                                  TO TRUE                         34850027
348600                    PERFORM 5100-WRITE-TEMP-STORAGE               34860027
348700                    MOVE ASC-BLOCK-ENTRIES                        34870027
348800                              (PC-MAX-BLOCKS-IN-ARRAY)            34880027
348900                               TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)  34890027
349000                    ADD +1        TO ASC-BLK-SUB                  34900027
349100                    INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)    34910027
349200                    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)       34920027
349300                                  TO TRUE                         34930027
349400                END-IF                                            34940027
349500            END-IF                                                34950027
349600            ADD  1                TO ASC-NUMBER-OF-ITEMS-READ     34960027
349700        END-IF.                                                   34970027
349800            MOVE  ASC-NUMBER-OF-ITEMS-READ                        34980027
349900                                  TO ASC-LIST-ITEM-NUMBER         34990027
350000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35000027
350100**************************************************************    35010027
350200            MOVE SPACES           TO ASC-ACTION                   35020027
350300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35030027
350400            MOVE SHUNLO-SHIPT-UNT-ID                              35040027
350500                                  TO ASC-SERIAL-SHIP-CDE          35050027
350600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35060027
350700                                                                  35070027
350800            MOVE PV-UNION-TYPE    TO ASC-CSR-IND                  35080027
350900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35090027
351000            IF SULBXF-DEST-OPER-UNT-ID > 0                        35100027
351100               MOVE SULBXF-DEST-OPER-UNT-ID                       35110027
351200                                  TO ASC-STR-NBR                  35120027
351300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35130027
351400               MOVE SULBXF-CART-LBL-TYP-CDE                       35140027
351500                                  TO  ASC-LBL-TYP-CDE             35150027
351600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35160027
351700            ELSE                                                  35170027
351800               MOVE SHPUNT-DEST-OPER-UNT-ID                       35180027
351900                                  TO ASC-STR-NBR                  35190027
352000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35200027
352100            END-IF                                                35210027
352200            MOVE SHPUNT-SHIPT-UNT-SRC-ID                          35220027
352300                                  TO  ASC-CRE-SRC                 35230027
352400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35240027
352500            MOVE SULBXF-STAT-CDE                                  35250045
352600                                  TO  ASC-ACTV-IND                35260045
352700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35270045
352800                                                                  35280045
352900            MOVE SULBXF-LAST-STAT-CHG-TMST                        35290027
353000                                       TO  PV-TMST-R              35300027
353100            MOVE PV-TMST-CC            TO  PV-DISPLAY-CC          35310027
353200            MOVE PV-TMST-YY            TO  PV-DISPLAY-YY          35320027
353300            MOVE PC-SLASH              TO  PV-SLASH-1             35330027
353400            MOVE PV-TMST-MM            TO  PV-DISPLAY-MM          35340027
353500            MOVE PC-SLASH              TO  PV-SLASH-2             35350027
353600            MOVE PV-TMST-DD            TO  PV-DISPLAY-DD          35360027
353700            MOVE PV-TMST-HRS           TO  PV-DISPLAY-HRS         35370027
353800            MOVE PC-COLON              TO  PV-COLON               35380027
353900            MOVE PV-TMST-MIN           TO  PV-DISPLAY-MIN         35390027
354000            MOVE PV-DATE-TIME-DISPLAY  TO  WS-SHUNLO-CRE-TMST     35400027
354100            MOVE PV-DTE-TME            TO  ASC-DATE-TIME          35410027
354200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35420027
354300            IF   DN-VEH-NBR = -1                                  35430027
354400                 MOVE SPACES      TO ASC-VEH-NBR                  35440027
354500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35450027
354600            ELSE                                                  35460027
354700                 MOVE VHTRIP-VEH-NBR                              35470027
354800                                  TO ASC-VEH-NBR                  35480027
354900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35490027
355000            END-IF                                                35500027
355100                                                                  35510027
355200            MOVE VHTRIP-OWNER-SCAC-ID                             35520027
355300                                  TO ASC-SCAC-CDE                 35530027
355400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     35540027
355500                                                                  35550027
355600                                                                  35560027
355700*           EVALUATE TRUE                                         35570027
355800*             WHEN PV-UNION-TYPE = 'A'                            35580027
355900*                  MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R           35590027
356000*                  MOVE PV-TMST-CC         TO PV-DISPLAY-CC       35600027
356100*                  MOVE PV-TMST-YY         TO PV-DISPLAY-YY       35610027
356200*                  MOVE PC-SLASH           TO PV-SLASH-1          35620027
356300*                  MOVE PV-TMST-MM         TO PV-DISPLAY-MM       35630027
356400*                  MOVE PC-SLASH           TO PV-SLASH-2          35640027
356500*                  MOVE PV-TMST-DD         TO PV-DISPLAY-DD       35650027
356600*                  MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS      35660027
356700*                  MOVE PC-COLON           TO PV-COLON            35670027
356800*                  MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN      35680027
356900*                                                                 35690027
357000*                  MOVE PV-DATE-TIME-DISPLAY                      35700027
357100*                                   TO  WS-SHUNLO-CRE-TMST        35710027
357200*             WHEN PV-UNION-TYPE = 'B'                            35720027
357300*                  MOVE PV-ENROUTE-DISPLAY                        35730027
357400*                                   TO  WS-ENROUTE                35740027
357500*           END-EVALUATE                                          35750027
357600                                                                  35760027
357700            IF PS-USE-SHIPT-CSR                                   35770027
357800               MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE           35780027
357900               MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME           35790027
358000               MOVE PV-DTE-TME  TO  ASC-DATE-TIME                 35800027
358100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     35810027
358200               MOVE ASC-TRIP-ID                                   35820027
358300                             TO ASC-LN-TRIP-ID                    35830027
358400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     35840027
358500            ELSE                                                  35850027
358600               MOVE SHUNLO-TRIP-ID                                35860027
358700                             TO ASC-LN-TRIP-ID                    35870027
358800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35880027
358900            END-IF.                                               35890027
359000                                                                  35900027
359100        IF PS-NO-ACTIVE-FND                                       35910027
359200           PERFORM 4361-FETCH-INACTIVE-STAT-CSR                   35920027
359300        ELSE                                                      35930027
359400           PERFORM 4360-FETCH-ACTIVE-STAT-CSR                     35940027
359500        END-IF.                                                   35950027
359600*                                                                 35960027
359700 4370-CLOSE-ACTIVE-STAT-CSR.                                      35970027
359800                                                                  35980027
359900     PERFORM                                                      35990027
360000         WITH TEST AFTER                                          36000027
360100         VARYING PV-RETRY-COUNTER                                 36010027
360200         FROM 1 BY 1                                              36020027
360300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36030027
360400                   OR (SQLCODE = ZERO))                           36040027
360500                                                                  36050027
360600             EXEC SQL                                             36060027
360700                  CLOSE ACTIVE-STAT-CSR                           36070027
360800             END-EXEC                                             36080027
360900                                                                  36090027
361000         EVALUATE TRUE                                            36100027
361100             WHEN SQLCODE = ZERO                                  36110027
361200                  CONTINUE                                        36120027
361300             WHEN OTHER                                           36130036
361400                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 36140036
361500                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 36150036
361600                  STRING  ' SUKCS553- 4370-  '   DELIMITED BY SIZE36160036
361700                          ' PO  -'               DELIMITED BY SIZE36170036
361800                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE36180036
361900                          ' RCVR-'               DELIMITED BY SIZE36190036
362000                          PV-DISP-CRE-TMST       DELIMITED BY SIZE36200036
362100                                         INTO PV-CICS-MSG-AREA    36210036
362200                  PERFORM 9900-WRITE-CICS-LOG                     36220041
362300                                                                  36230036
362400                  MOVE '4370-CLOSE-ACTIVE-STAT-CSR'               36240027
362500                                   TO DP013-PARAGRAPH             36250027
362600                  MOVE 'CLOSE ACTIVE STATUS CSR'                  36260027
362700                                   TO DP013-MESSAGE-TEXT (1)      36270027
362800                  MOVE SQLCA           TO DP013-SQLCA             36280027
362900                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    36290027
363000                  SET DP013-DB2-ABEND                             36300027
363100                      DP013-XCTL-DISPLAY-RESTART                  36310027
363200                                   TO TRUE                        36320027
363300                  PERFORM DP013-0000-PROCESS-ABEND                36330027
363400         END-EVALUATE                                             36340027
363500     END-PERFORM.                                                 36350027
363600                                                                  36360027
363700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36370027
363800         MOVE '4370-CLOSE-ACTIVE-STAT-CSR' TO DP013-PARAGRAPH     36380027
363900         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO CLOSE CSR'      36390027
364000                                   TO DP013-MESSAGE-TEXT (1)      36400027
364100         MOVE SQLCA                TO DP013-SQLCA                 36410027
364200         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             36420027
364300         SET DP013-DB2-ABEND                                      36430027
364400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36440027
364500         PERFORM DP013-0000-PROCESS-ABEND                         36450027
364600     END-IF.                                                      36460027
364700                                                                  36470027
364800                                                                  36480027
364900 4371-CLOSE-INACTIVE-STAT-CSR.                                    36490027
365000                                                                  36500027
365100     PERFORM                                                      36510027
365200         WITH TEST AFTER                                          36520027
365300         VARYING PV-RETRY-COUNTER                                 36530027
365400         FROM 1 BY 1                                              36540027
365500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36550027
365600                   OR (SQLCODE = ZERO))                           36560027
365700                                                                  36570027
365800             EXEC SQL                                             36580027
365900                  CLOSE INACTIVE-STAT-CSR                         36590027
366000             END-EXEC                                             36600027
366100                                                                  36610027
366200         EVALUATE TRUE                                            36620027
366300             WHEN SQLCODE = ZERO                                  36630027
366400                  CONTINUE                                        36640027
366500             WHEN OTHER                                           36650036
366600                  MOVE SHUNLO-SHIPT-UNT-ID    TO PV-DISP-SHIPT-ID 36660036
366700                  MOVE SHUNLO-CRE-TMST        TO PV-DISP-CRE-TMST 36670036
366800                  STRING  ' SUKCS553- 4371-  '   DELIMITED BY SIZE36680036
366900                          ' PO  -'               DELIMITED BY SIZE36690036
367000                          PV-DISP-SHIPT-ID       DELIMITED BY SIZE36700036
367100                          ' RCVR-'               DELIMITED BY SIZE36710036
367200                          PV-DISP-CRE-TMST       DELIMITED BY SIZE36720036
367300                                         INTO PV-CICS-MSG-AREA    36730036
367400                  PERFORM 9900-WRITE-CICS-LOG                     36740041
367500                                                                  36750036
367600                  MOVE '4371-CLOSE-INACTIVE-STAT-CSR'             36760027
367700                                   TO DP013-PARAGRAPH             36770027
367800                  MOVE 'CLOSE INACTIVE STATUS CSR'                36780027
367900                                   TO DP013-MESSAGE-TEXT (1)      36790027
368000                  MOVE SQLCA           TO DP013-SQLCA             36800027
368100                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    36810027
368200                  SET DP013-DB2-ABEND                             36820027
368300                      DP013-XCTL-DISPLAY-RESTART                  36830027
368400                                   TO TRUE                        36840027
368500                  PERFORM DP013-0000-PROCESS-ABEND                36850027
368600         END-EVALUATE                                             36860027
368700     END-PERFORM.                                                 36870027
368800                                                                  36880027
368900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36890027
369000         MOVE '4371-CLOSE-INACTIVE-STAT-CSR' TO DP013-PARAGRAPH   36900027
369100         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO CLOSE CSR'      36910027
369200                                   TO DP013-MESSAGE-TEXT (1)      36920027
369300         MOVE SQLCA                TO DP013-SQLCA                 36930027
369400         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             36940027
369500         SET DP013-DB2-ABEND                                      36950027
369600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36960027
369700         PERFORM DP013-0000-PROCESS-ABEND                         36970027
369800     END-IF.                                                      36980027
369900                                                                  36990027
370000                                                                  37000027
370100*----------------------------------------------------------------*37010027
370200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *37020027
370300*----------------------------------------------------------------*37030027
370400 4400-MOVE-COMMAREA-TO-SCREEN.                                    37040027
370500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             37050027
370600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          37060027
370700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          37070027
370800             MOVE +1               TO ASC-BLK-SUB                 37080027
370900             PERFORM 5100-WRITE-TEMP-STORAGE                      37090027
371000             ADD +1                TO ASC-BLK-SUB                 37100027
371100             PERFORM 5100-WRITE-TEMP-STORAGE                      37110027
371200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             37120027
371300                 GIVING PV-BLOCK-NUMBER                           37130027
371400                 REMAINDER PV-REMAINDER                           37140027
371500             IF  PV-REMAINDER > ZERO                              37150027
371600                 ADD +1            TO PV-BLOCK-NUMBER             37160027
371700             END-IF                                               37170027
371800             MOVE +1               TO ASC-BLK-SUB                 37180027
371900             PERFORM 4410-READ-TEMP-STORAGE                       37190027
372000             ADD +1                TO ASC-BLK-SUB                 37200027
372100                                      PV-BLOCK-NUMBER             37210027
372200             PERFORM 4410-READ-TEMP-STORAGE                       37220027
372300     END-IF.                                                      37230027
372400                                                                  37240027
372500     MOVE +1                       TO ASC-BLK-SUB.                37250027
372600                                                                  37260027
372700     COMPUTE ASC-ITEM-SUB =                                       37270027
372800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              37280027
372900         + PC-ITEMS-PER-PANEL).                                   37290027
373000                                                                  37300027
373100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        37310027
373200         ADD +1                    TO ASC-BLK-SUB                 37320027
373300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            37330027
373400     END-IF.                                                      37340027
373500                                                                  37350027
373600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           37360027
373700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                37370027
373800                                                                  37380027
373900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        37390027
374000     PERFORM 4420-FORMAT-LIST-LINES                               37400027
374100         VARYING PV-SUB                                           37410027
374200         FROM PC-ITEMS-PER-PANEL BY -1                            37420027
374300         UNTIL PV-SUB < +1.                                       37430027
374400                                                                  37440027
374500     COMPUTE ASC-ITEMS-DISPLAYED =                                37450027
374600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          37460027
374700                                                                  37470027
374800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    37480027
374900                                      ASTRTITO.                   37490027
375000                                                                  37500027
375100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    37510027
375200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    37520027
375300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37530027
375400                                   TO ASELITO.                    37540027
375500                                                                  37550027
375600     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     37560027
375700     MOVE ASC-FCLTY-NME            TO ANAMEO.                     37570027
375800     MOVE ASC-TOT-CRTNS            TO ATLCTNO.                    37580040
375900     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  37590027
376000     MOVE ASC-RECEIVER             TO PV-RECEIVER.                37600027
376100     MOVE PV-PO-RECEIVER           TO APORCVRO.                   37610027
376200     MOVE ASC-TOT-CRTNS-ERR        TO ACTNERRO.                   37620040
376300     MOVE ASC-ENT-NAME-DESC        TO AVENDRO.                    37630027
376400                                                                  37640027
376500                                                                  37650027
376600     IF  DP020-MSG-NUMBER-X = SPACES                              37660027
376700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  37670027
376800*            --- MORE ITEMS TO DISPLAY ----                       37680027
376900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            37690027
377000             SET DP020-MSG-INFORMATIONAL TO TRUE                  37700027
377100         END-IF                                                   37710027
377200     END-IF.                                                      37720027
377300*                                                                 37730027
377400*                                                                 37740027
377500*----------------------------------------------------------------*37750027
377600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *37760027
377700*----------------------------------------------------------------*37770027
377800 4410-READ-TEMP-STORAGE.                                          37780027
377900     EXEC CICS                                                    37790027
378000         READQ TS                                                 37800027
378100             QUEUE (ASC-LIST-QUEUE-NAME)                          37810027
378200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37820027
378300             ITEM  (PV-BLOCK-NUMBER)                              37830027
378400             RESP  (PV-CICS-RESP)                                 37840027
378500     END-EXEC.                                                    37850027
378600                                                                  37860027
378700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       37870027
378800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     37880027
378900         CONTINUE                                                 37890027
379000     ELSE                                                         37900027
379100         SET DP013-CICS-ABEND      TO TRUE                        37910027
379200         SET DP013-NO-ROLLBACK     TO TRUE                        37920027
379300         MOVE '4410-READ-TEMP-STORAGE'                            37930027
379400                                   TO DP013-PARAGRAPH             37940027
379500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      37950027
379600                                   TO DP013-MESSAGE-TEXT(1)       37960027
379700         PERFORM DP013-0000-PROCESS-ABEND                         37970027
379800     END-IF.                                                      37980027
379900                                                                  37990027
380000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             38000027
380100                                                                  38010027
380200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         38020027
380300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               38030027
380400     END-IF.                                                      38040027
380500 EJECT                                                            38050027
380600*                                                                 38060027
380700*                                                                 38070027
380800*----------------------------------------------------------------*38080027
380900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *38090027
381000*----------------------------------------------------------------*38100027
381100 4420-FORMAT-LIST-LINES.                                          38110027
381200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      38120027
381300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                38130027
381400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           38140027
381500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           38150027
381600         MOVE SPACES             TO MR-SELECTI (PV-SUB)           38160027
381700                                    MR-ACTION (PV-SUB)            38170027
381800                                    MR-SHIP (PV-SUB)              38180027
381900                                    MR-ACTV (PV-SUB)              38190045
382000                                    MR-STR (PV-SUB)               38200027
382100                                    MR-SRC (PV-SUB)               38210027
382200                                    MR-DATE-TIME (PV-SUB)         38220027
382300                                    MR-TRIP (PV-SUB)              38230027
382400                                    MR-SCAC (PV-SUB)              38240027
382500                                    MR-TRLR (PV-SUB)              38250027
382600     ELSE                                                         38260027
382700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      38270027
382800                                                   > SPACES       38280027
382900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 38290027
383000                                 TO MR-SELECTI (PV-SUB)           38300027
383100         ELSE                                                     38310027
383200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      38320027
383300                                 TO MR-SELECTI (PV-SUB)           38330027
383400         END-IF                                                   38340027
383500                                                                  38350027
383600         IF  DP030-SET-CURSOR-TRAILER                             38360027
383700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)38370027
383800                 > SPACES)                                        38380027
383900               OR (PV-SUB = 1))                                   38390027
384000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               38400027
384100                MOVE -1            TO MR-SELECTL (PV-SUB)         38410027
384200             END-IF                                               38420027
384300         END-IF                                                   38430027
384400                                                                  38440027
384500******MOVE LIST ITEMS TO SCREEN                                   38450027
384600             IF ASC-PBS-ERR-YES (ASC-BLK-SUB ASC-ITEM-SUB)        38460027
384700                 MOVE DP015-RED TO MR-SRCC (PV-SUB)               38470027
384800                                   MR-DATE-TIMEC (PV-SUB)         38480027
384900             ELSE                                                 38490027
385000                 MOVE DP015-BLUE TO MR-SRCC (PV-SUB)              38500027
385100                                    MR-DATE-TIMEC (PV-SUB)        38510027
385200             END-IF                                               38520027
385300                                                                  38530027
385400             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           38540027
385500                                 TO MR-ACTION (PV-SUB)            38550027
385600             MOVE ASC-SERIAL-SHIP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)  38560027
385700                                 TO MR-SHIP (PV-SUB)              38570027
385800                                                                  38580027
385900             MOVE ASC-ACTV-IND (ASC-BLK-SUB ASC-ITEM-SUB)         38590045
386000                                 TO MR-ACTV (PV-SUB)              38600045
386100                                                                  38610045
386200             IF  ASC-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)           38620027
386300                 MOVE 'P2L'      TO MR-STR (PV-SUB)               38630027
386400             ELSE                                                 38640027
386500                 MOVE ASC-STR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      38650027
386600                                 TO MR-STR (PV-SUB)               38660027
386700             END-IF                                               38670027
386800                                                                  38680027
386900             MOVE ASC-CRE-SRC   (ASC-BLK-SUB ASC-ITEM-SUB)        38690027
387000                                 TO MR-SRC (PV-SUB)               38700027
387100             MOVE ASC-DATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)        38710027
387200                                 TO MR-DATE-TIME (PV-SUB)         38720027
387300             MOVE ASC-LN-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)       38730027
387400                                 TO MR-TRIP (PV-SUB)              38740027
387500             MOVE ASC-SCAC-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         38750027
387600                                 TO MR-SCAC (PV-SUB)              38760027
387700             MOVE ASC-VEH-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          38770027
387800                                 TO MR-TRLR (PV-SUB)              38780027
387900     END-IF.                                                      38790027
388000                                                                  38800027
388100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               38810027
388200                                                                  38820027
388300     IF  ASC-ITEM-SUB < + 1                                       38830027
388400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                38840027
388500         MOVE +1                   TO ASC-BLK-SUB                 38850027
388600     END-IF.                                                      38860027
388700*                                                                 38870027
388800*                                                                 38880027
388900*----------------------------------------------------------------*38890027
389000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *38900027
389100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *38910027
389200*  ISSUE A WARNING.                                              *38920027
389300*----------------------------------------------------------------*38930027
389400 4430-CHECK-FOR-BEGIN-AND-END.                                    38940027
389500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       38950027
389600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     38960027
389700*            -- NO END-OF-RANGE SPECFIED ---                      38970027
389800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            38980027
389900             SET DP020-MSG-WARNING TO TRUE                        38990027
390000             PERFORM 4431-POSITION-AT-WARNING                     39000027
390100         END-IF                                                   39010027
390200     ELSE                                                         39020027
390300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     39030027
390400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                39040027
390500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            39050027
390600             SET DP020-MSG-WARNING TO TRUE                        39060027
390700             PERFORM 4431-POSITION-AT-WARNING                     39070027
390800         END-IF                                                   39080027
390900     END-IF.                                                      39090027
391000*                                                                 39100027
391100*                                                                 39110027
391200*----------------------------------------------------------------*39120027
391300*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *39130027
391400*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *39140027
391500*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *39150027
391600*  POSITION THE CSR THERE.                                       *39160027
391700*----------------------------------------------------------------*39170027
391800 4431-POSITION-AT-WARNING.                                        39180027
391900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 39190027
392000                    - PV-TOP-ITEM + 1.                            39200027
392100                                                                  39210027
392200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      39220027
392300         CONTINUE                                                 39230027
392400     ELSE                                                         39240027
392500         SET DP030-SET-CURSOR-APPL-1                              39250027
392600                                   TO TRUE                        39260027
392700         MOVE -1                   TO MR-SELECTL (PV-SUB)         39270027
392800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         39280027
392900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         39290027
393000     END-IF.                                                      39300027
393100                                                                  39310027
393200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   39320027
393300                     - PV-TOP-ITEM + 1.                           39330027
393400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      39340027
393500         CONTINUE                                                 39350027
393600     ELSE                                                         39360027
393700         SET DP030-SET-CURSOR-APPL-1                              39370027
393800                                   TO TRUE                        39380027
393900         MOVE -1                   TO MR-SELECTL (PV-SUB)         39390027
394000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         39400027
394100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         39410027
394200     END-IF.                                                      39420027
394300*                                                                 39430027
394400*                                                                 39440027
394500*----------------------------------------------------------------*39450027
394600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *39460027
394700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *39470027
394800* FOR THE SELECTED ITEMS QUEUE.                                  *39480027
394900*                                                                *39490027
395000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *39500027
395100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *39510027
395200* THE ARRAY IS FULL.                                             *39520027
395300*----------------------------------------------------------------*39530027
395400 5000-PREPARE-SEL-QUEUE.                                          39540027
395500     MOVE +1                   TO  ASC-BLK-SUB.                   39550027
395600     PERFORM 5100-WRITE-TEMP-STORAGE.                             39560027
395700     ADD +1                    TO  ASC-BLK-SUB.                   39570027
395800     PERFORM 5100-WRITE-TEMP-STORAGE.                             39580027
395900                                                                  39590027
396000     MOVE ASC-SEL-QUEUE-NAME   TO  SU003-SEL-QUEUE-NAME.          39600027
396100     PERFORM 6010-DELETE-SEL-QUEUE.                               39610027
396200                                                                  39620027
396300     SET ASC-UPDATE-TSQ        TO  TRUE.                          39630027
396400                                                                  39640027
396500     SET SU004-IDX             TO  1.                             39650027
396600     MOVE ZERO                 TO SU003-NUMBER-OF-TS-ITEMS.       39660027
396700     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        39670027
396800                                                                  39680027
396900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           39690027
397000             VARYING PV-ITEM                                      39700027
397100             FROM 1 BY 1                                          39710027
397200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     39720027
397300                                                                  39730027
397400     IF  SU004-IDX > 1                                            39740027
397500         PERFORM 5205-WRITE-SEL-QUEUE                             39750027
397600         ADD +1                TO SU003-NUMBER-OF-TS-ITEMS        39760027
397700     END-IF.                                                      39770027
397800 EJECT                                                            39780027
397900*                                                                 39790027
398000*                                                                 39800027
398100*----------------------------------------------------------------*39810027
398200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *39820027
398300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *39830027
398400*----------------------------------------------------------------*39840027
398500 5100-WRITE-TEMP-STORAGE.                                         39850027
398600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     39860027
398700                                   TO PV-LIST-ITEM-NUMBER.        39870027
398800     COMPUTE PV-BLOCK-NUMBER =                                    39880027
398900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    39890027
399000                                                                  39900027
399100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             39910027
399200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             39920027
399300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      39930027
399400             PERFORM 5105-REWRITE-ASC-LISTQ                       39940027
399500         END-IF                                                   39950027
399600     ELSE                                                         39960027
399700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       39970027
399800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            39980027
399900         PERFORM 5110-WRITE-ASC-LISTQ                             39990027
400000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   40000027
400100     END-IF.                                                      40010027
400200                                                                  40020027
400300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             40030027
400400*                                                                 40040027
400500*                                                                 40050027
400600*----------------------------------------------------------------*40060027
400700*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *40070027
400800*  SPECIFIC COMMAREA.                                            *40080027
400900*----------------------------------------------------------------*40090027
401000 5105-REWRITE-ASC-LISTQ.                                          40100027
401100     EXEC CICS                                                    40110027
401200         WRITEQ TS                                                40120027
401300             QUEUE (ASC-LIST-QUEUE-NAME)                          40130027
401400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40140027
401500             ITEM  (PV-BLOCK-NUMBER)                              40150027
401600             REWRITE                                              40160027
401700             RESP  (PV-CICS-RESP)                                 40170027
401800     END-EXEC.                                                    40180027
401900                                                                  40190027
402000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           40200027
402100         CONTINUE                                                 40210027
402200     ELSE                                                         40220027
402300         SET DP013-CICS-ABEND      TO TRUE                        40230027
402400         SET DP013-NO-ROLLBACK     TO TRUE                        40240027
402500         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         40250027
402600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     40260027
402700                                   TO DP013-MESSAGE-TEXT(1)       40270027
402800         PERFORM DP013-0000-PROCESS-ABEND                         40280027
402900     END-IF.                                                      40290027
403000*                                                                 40300027
403100*                                                                 40310027
403200*----------------------------------------------------------------*40320027
403300*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *40330027
403400*  SPECIFIC COMMAREA.                                            *40340027
403500*----------------------------------------------------------------*40350027
403600 5110-WRITE-ASC-LISTQ.                                            40360027
403700     EXEC CICS                                                    40370027
403800         WRITEQ TS                                                40380027
403900             QUEUE (ASC-LIST-QUEUE-NAME)                          40390027
404000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               40400027
404100             ITEM  (PV-BLOCK-NUMBER)                              40410027
404200             RESP  (PV-CICS-RESP)                                 40420027
404300     END-EXEC.                                                    40430027
404400                                                                  40440027
404500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      40450027
404600         SET DP013-CICS-ABEND      TO TRUE                        40460027
404700         SET DP013-NO-ROLLBACK     TO TRUE                        40470027
404800         MOVE '5110-WRITE-ASC-LISTQ'                              40480027
404900                                   TO DP013-PARAGRAPH             40490027
405000         MOVE 'ATTEMPTING TO WRITE LIST TEMP STORAGE QUEUE'       40500027
405100                                   TO DP013-MESSAGE-TEXT(1)       40510027
405200         PERFORM DP013-0000-PROCESS-ABEND                         40520027
405300     END-IF.                                                      40530027
405400*                                                                 40540027
405500*                                                                 40550027
405600*----------------------------------------------------------------*40560027
405700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *40570027
405800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *40580027
405900* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *40590027
406000* TO THE DESTINATION APPLICATION.                                *40600027
406100*----------------------------------------------------------------*40610027
406200 5200-FILL-SEL-QUEUE-RECORD.                                      40620027
406300                                                                  40630027
406400     PERFORM 6112-READ-LIST-QUEUE.                                40640027
406500                                                                  40650027
406600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       40660027
406700         PERFORM                                                  40670027
406800         VARYING LQW-IDX                                          40680027
406900         FROM 1 BY 1                                              40690027
407000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            40700027
407100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          40710027
407200                                                                  40720027
407300             IF  LQW-SELECT (LQW-IDX)                             40730027
407400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              40740027
407500                                   TO SU004-ITEM (SU004-IDX)      40750027
407600                 MOVE SPACES       TO SU004-ACTION-SW (SU004-IDX) 40760027
407700                                                                  40770027
407800                 MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)               40780027
407900                                   TO SU004-SHIPT-UNT-ID          40790027
408000                                      (SU004-IDX)                 40800027
408100                                                                  40810027
408200                 MOVE LQW-LN-TRIP-ID (LQW-IDX)                    40820027
408300                                   TO SU004-TRIP-ID               40830027
408400                                      (SU004-IDX)                 40840027
408500                                                                  40850027
408600                 MOVE LQW-SCAC-CDE (LQW-IDX)                      40860027
408700                                   TO SU004-SCAC-CDE              40870027
408800                                      (SU004-IDX)                 40880027
408900                                                                  40890027
409000                 MOVE LQW-VEH-NBR (LQW-IDX)                       40900027
409100                                   TO SU004-VEH-NBR               40910027
409200                                      (SU004-IDX)                 40920027
409300                                                                  40930027
409400                 SET SU004-IDX UP BY 1                            40940027
409500                 IF  SU004-IDX > SU004-MAX-ITEMS                  40950027
409600                     PERFORM 5205-WRITE-SEL-QUEUE                 40960027
409700                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    40970027
409800                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         40980027
409900                     SET SU004-IDX TO  1                          40990027
410000                 END-IF                                           41000027
410100             END-IF                                               41010027
410200         END-PERFORM                                              41020027
410300     END-IF.                                                      41030027
410400*                                                                 41040027
410500*                                                                 41050027
410600*----------------------------------------------------------------*41060027
410700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *41070027
410800*----------------------------------------------------------------*41080027
410900 5205-WRITE-SEL-QUEUE.                                            41090027
411000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            41100027
411100                                   TO SU004-SELECTED-ITEMS.       41110027
411200                                                                  41120027
411300     EXEC CICS                                                    41130027
411400          WRITEQ TS                                               41140027
411500              QUEUE (ASC-SEL-QUEUE-NAME)                          41150027
411600              FROM  (SU004-DC-SELECT-RECORD)                      41160027
411700              ITEM  (PV-SEL-QUEUE-ITEM)                           41170027
411800              RESP  (PV-CICS-RESP)                                41180027
411900     END-EXEC.                                                    41190027
412000                                                                  41200027
412100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          41210027
412200         CONTINUE                                                 41220027
412300     ELSE                                                         41230027
412400         SET DP013-CICS-ABEND      TO TRUE                        41240027
412500         SET DP013-NO-ROLLBACK     TO TRUE                        41250027
412600         MOVE '5205-WRITE-SEL-QUEUE'                              41260027
412700                                   TO DP013-PARAGRAPH             41270027
412800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          41280027
412900                                   TO DP013-MESSAGE-TEXT(1)       41290027
413000         PERFORM DP013-0000-PROCESS-ABEND                         41300027
413100     END-IF.                                                      41310027
413200 EJECT                                                            41320027
413300*                                                                 41330027
413400*                                                                 41340027
413500******************************************************************41350027
413600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **41360027
413700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **41370027
413800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **41380027
413900** THE USER.                                                    **41390027
414000******************************************************************41400027
414100 6000-REFRESH-PANEL-FROM-TEMP.                                    41410027
414200     IF  ASC-UPDATE-TSQ                                           41420027
414300         SET ASC-NO-TSQ-UPDATE TO TRUE                            41430027
414400         MOVE ZERO                 TO PV-SAVE-ITEM                41440027
414500                                      PV-SEL-QUEUE-ITEM           41450027
414600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        41460027
414700                                   TO PV-HOLD-SELECTED-ITEMS      41470027
414800         MOVE +1                   TO PV-ITEMS-PROCESSED          41480027
414900         PERFORM 6100-UPDATE-TSQ                                  41490027
415000             UNTIL PV-ITEMS-PROCESSED >                           41500027
415100                                     PV-HOLD-SELECTED-ITEMS       41510027
415200*DMH     PERFORM 6010-DELETE-SEL-QUEUE                            41520027
415300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         41530027
415400                    ASC-BLOCK-ENTRIES (2)                         41540027
415500     END-IF.                                                      41550027
415600                                                                  41560027
415700*----------------------------------------------------------------*41570027
415800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *41580027
415900*----------------------------------------------------------------*41590027
416000 6010-DELETE-SEL-QUEUE.                                           41600027
416100     EXEC CICS                                                    41610027
416200         DELETEQ TS                                               41620027
416300             QUEUE (ASC-SEL-QUEUE-NAME)                           41630027
416400             RESP  (PV-CICS-RESP)                                 41640027
416500     END-EXEC.                                                    41650027
416600                                                                  41660027
416700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      41670027
416800         (PV-CICS-RESP = DFHRESP(QIDERR)))                        41680027
416900         CONTINUE                                                 41690027
417000     ELSE                                                         41700027
417100         SET DP013-CICS-ABEND      TO TRUE                        41710027
417200         SET DP013-NO-ROLLBACK     TO TRUE                        41720027
417300         MOVE '6010-DELETE-SEL-QUEUE'                             41730027
417400                                   TO DP013-PARAGRAPH             41740027
417500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         41750027
417600                                   TO DP013-MESSAGE-TEXT (1)      41760027
417700         PERFORM DP013-0000-PROCESS-ABEND                         41770027
417800     END-IF.                                                      41780027
417900*                                                                 41790027
418000*                                                                 41800027
418100*----------------------------------------------------------------*41810027
418200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *41820027
418300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *41830027
418400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *41840027
418500*    THE TEMP QUEUE.                                             *41850027
418600*----------------------------------------------------------------*41860027
418700 6100-UPDATE-TSQ.                                                 41870027
418800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             41880027
418900     PERFORM 6105-READ-SEL-QUEUE.                                 41890027
419000     PERFORM                                                      41900027
419100         VARYING SU004-IDX                                        41910027
419200         FROM 1 BY 1                                              41920027
419300         UNTIL ((PV-ITEMS-PROCESSED >                             41930027
419400                              PV-HOLD-SELECTED-ITEMS)             41940027
419500         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             41950027
419600         IF  SU004-ACTION-SW (SU004-IDX) > SPACES                 41960027
419700             PERFORM 6110-PROCESS-ITEMS                           41970027
419800         END-IF                                                   41980027
419900         ADD +1                TO PV-ITEMS-PROCESSED              41990027
420000     END-PERFORM.                                                 42000027
420100     PERFORM 6111-WRITE-LIST-QUEUE.                               42010027
420200*                                                                 42020027
420300*                                                                 42030027
420400*----------------------------------------------------------------*42040027
420500*    READ THE LIST QUEUE RECORD.                                 *42050027
420600*----------------------------------------------------------------*42060027
420700 6105-READ-SEL-QUEUE.                                             42070027
420800     EXEC CICS                                                    42080027
420900          READQ TS                                                42090027
421000              QUEUE (ASC-SEL-QUEUE-NAME)                          42100027
421100              INTO  (SU004-DC-SELECT-RECORD)                      42110027
421200              ITEM  (PV-SEL-QUEUE-ITEM)                           42120027
421300              RESP  (PV-CICS-RESP)                                42130027
421400     END-EXEC.                                                    42140027
421500                                                                  42150027
421600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          42160027
421700         CONTINUE                                                 42170027
421800     ELSE                                                         42180027
421900         SET DP013-CICS-ABEND      TO  TRUE                       42190027
422000         SET DP013-NO-ROLLBACK     TO  TRUE                       42200027
422100         MOVE '6105-READ-SEL-QUEUE'                               42210027
422200                                   TO  DP013-PARAGRAPH            42220027
422300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           42230027
422400                                   TO  DP013-MESSAGE-TEXT(1)      42240027
422500                                                                  42250027
422600         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              42260027
422700         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          42270027
422800         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  42280027
422900         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         42290027
423000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           42300027
423100                ' QUEUE TASK-'        DELIMITED BY SIZE           42310027
423200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           42320027
423300                ' QUEUE SEQ-'         DELIMITED BY SIZE           42330027
423400                 PV-SEL-SEQ           DELIMITED BY SIZE           42340027
423500                                 INTO  DP013-MESSAGE-TEXT(2)      42350027
423600         MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID         42360027
423700         MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER     42370027
423800         MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ             42380027
423900         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         42390027
424000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           42400027
424100                ' QUEUE TASK-'        DELIMITED BY SIZE           42410027
424200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           42420027
424300                ' QUEUE SEQ-'         DELIMITED BY SIZE           42430027
424400                 PV-SEL-SEQ           DELIMITED BY SIZE           42440027
424500                                 INTO  DP013-MESSAGE-TEXT(3)      42450027
424600         PERFORM DP013-0000-PROCESS-ABEND                         42460027
424700     END-IF.                                                      42470027
424800 EJECT                                                            42480027
424900*                                                                 42490027
425000*                                                                 42500027
425100*----------------------------------------------------------------*42510027
425200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*42520027
425300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*42530027
425400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *42540027
425500*----------------------------------------------------------------*42550027
425600 6110-PROCESS-ITEMS.                                              42560027
425700                                                                  42570027
425800     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          42580027
425900                     / PC-ITEMS-PER-PANEL).                       42590027
426000                                                                  42600027
426100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           42610027
426200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          42620027
426300             PERFORM 6111-WRITE-LIST-QUEUE                        42630027
426400         END-IF                                                   42640027
426500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    42650027
426600                                                                  42660027
426700         PERFORM 6112-READ-LIST-QUEUE                             42670027
426800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               42680027
426900             CONTINUE                                             42690027
427000         END-IF                                                   42700027
427100     END-IF.                                                      42710027
427200                                                                  42720027
427300     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     42730027
427400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              42740027
427500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         42750027
427600     MOVE LQW-SELECTED-SW (PV-SUB)                                42760027
427700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  42770027
427800     EVALUATE TRUE                                                42780027
427900         WHEN SU004-INQ (SU004-IDX)                               42790027
428000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             42800027
428100                                                                  42810027
428200         WHEN SU004-UPD (SU004-IDX)                               42820027
428300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             42830027
428400                                                                  42840027
428500         WHEN SU004-DEL (SU004-IDX)                               42850027
428600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             42860027
428700                                                                  42870027
428800         WHEN SU004-ERR (SU004-IDX)                               42880027
428900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             42890027
429000     END-EVALUATE.                                                42900027
429100                                                                  42910027
429200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                42920027
429300*                                                                 42930027
429400*                                                                 42940027
429500*----------------------------------------------------------------*42950027
429600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN S550.             *42960027
429700*----------------------------------------------------------------*42970027
429800 6111-WRITE-LIST-QUEUE.                                           42980027
429900     EXEC CICS                                                    42990027
430000         WRITEQ TS                                                43000027
430100             QUEUE (ASC-LIST-QUEUE-NAME)                          43010027
430200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     43020027
430300             ITEM  (PV-SAVE-ITEM)                                 43030027
430400             REWRITE                                              43040027
430500             RESP  (PV-CICS-RESP)                                 43050027
430600     END-EXEC.                                                    43060027
430700                                                                  43070027
430800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43080027
430900         CONTINUE                                                 43090027
431000     ELSE                                                         43100027
431100         SET DP013-CICS-ABEND  TO  TRUE                           43110027
431200         SET DP013-NO-ROLLBACK TO  TRUE                           43120027
431300         MOVE '6111-WRITE-LIST-QUEUE'                             43130027
431400                               TO  DP013-PARAGRAPH                43140027
431500         MOVE 'ATTEMPTING TO WRITE LIST QUEUE'                    43150027
431600                               TO  DP013-MESSAGE-TEXT(1)          43160027
431700         PERFORM DP013-0000-PROCESS-ABEND                         43170027
431800     END-IF.                                                      43180027
431900                                                                  43190027
432000 EJECT                                                            43200027
432100*                                                                 43210027
432200*                                                                 43220027
432300*----------------------------------------------------------------*43230027
432400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*43240027
432500*----------------------------------------------------------------*43250027
432600 6112-READ-LIST-QUEUE.                                            43260027
432700     EXEC CICS                                                    43270027
432800         READQ TS                                                 43280027
432900             QUEUE (ASC-LIST-QUEUE-NAME)                          43290027
433000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     43300027
433100             ITEM  (PV-ITEM)                                      43310027
433200             RESP  (PV-CICS-RESP)                                 43320027
433300     END-EXEC.                                                    43330027
433400                                                                  43340027
433500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43350027
433600         CONTINUE                                                 43360027
433700     ELSE                                                         43370027
433800         SET DP013-CICS-ABEND      TO TRUE                        43380027
433900         SET DP013-NO-ROLLBACK     TO TRUE                        43390027
434000         MOVE '6112-READ-LIST-QUEUE'                              43400027
434100                                   TO DP013-PARAGRAPH             43410027
434200         MOVE 'ATTEMPTING TO READ LIST QUEUE'                     43420027
434300                                   TO DP013-MESSAGE-TEXT(1)       43430027
434400         PERFORM DP013-0000-PROCESS-ABEND                         43440027
434500     END-IF.                                                      43450027
434600*                                                                 43460027
434700*                                                                 43470027
434800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43480027
434900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *43490027
435000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43500027
435100 9100-READ-SEL-QUEUE.                                             43510027
435200     EXEC CICS                                                    43520027
435300         READQ TS                                                 43530027
435400************ QUEUE (ASC-SEL-QUEUE-NAME)                           43540027
435500             QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                      43550027
435600             INTO  (SU004-DC-SELECT-RECORD)                       43560027
435700             ITEM  (ASC-SEL-ITEM)                                 43570027
435800             RESP  (PV-CICS-RESP)                                 43580027
435900     END-EXEC.                                                    43590027
436000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        43600027
436100         CONTINUE                                                 43610027
436200     ELSE                                                         43620027
436300         SET DP013-LOGIC-ABEND                                    43630027
436400             DP013-NO-ROLLBACK   TO   TRUE                        43640027
436500         MOVE '9100-READ-SEL-QUEUE'                               43650027
436600                                 TO   DP013-PARAGRAPH             43660027
436700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   43670027
436800                                 TO   DP013-MESSAGE-TEXT (1)      43680027
436900         PERFORM DP013-0000-PROCESS-ABEND                         43690027
437000     END-IF.                                                      43700027
437100*                                                                 43710027
437200*                                                                 43720027
437300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*43730027
437400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *43740027
437500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 43750027
437600 9200-REWRITE-SEL-QUEUE.                                          43760027
437700                                                                  43770027
437800     EXEC CICS                                                    43780027
437900          WRITEQ TS                                               43790027
438000************* QUEUE  (ASC-SEL-QUEUE-NAME)                         43800027
438100              QUEUE  (ASC-SEL-QUEUE-NAME-ORIG)                    43810027
438200              FROM   (SU004-DC-SELECT-RECORD)                     43820027
438300              ITEM   (ASC-SEL-ITEM)                               43830027
438400              RESP   (PV-CICS-RESP)                               43840027
438500              REWRITE                                             43850027
438600     END-EXEC.                                                    43860027
438700                                                                  43870027
438800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   43880027
438900         SET DP013-CICS-ABEND                                     43890027
439000             DP013-NO-ROLLBACK     TO TRUE                        43900027
439100         MOVE '9200-REWRITE-SEL-QUEUE'                            43910027
439200                                   TO DP013-PARAGRAPH             43920027
439300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   43930027
439400                                   TO DP013-MESSAGE-TEXT (1)      43940027
439500         PERFORM DP013-0000-PROCESS-ABEND                         43950027
439600     END-IF.                                                      43960027
439700*                                                                 43970027
439800*                                                                 43980027
439900 9900-WRITE-CICS-LOG.                                             43990041
440000                                                                  44000041
440100     MOVE LENGTH OF PV-CICS-MSG-AREA                              44010041
440200          TO PV-COMMAREA-LENGTH                                   44020041
440300                                                                  44030041
440400     EXEC CICS                                                    44040041
440500         WRITEQ TD                                                44050041
440600             QUEUE  ('CSSL')                                      44060041
440700             FROM   (PV-CICS-MSG-AREA)                            44070041
440800             LENGTH (PV-COMMAREA-LENGTH)                          44080041
440900             RESP   (PV-CICS-RESP)                                44090041
441000     END-EXEC.                                                    44100041
441100                                                                  44110041
441200     MOVE SPACES TO PV-CICS-MSG-AREA.                             44120041
441300*                                                                 44130041
441400*----------------------------------------------------------------*44140041
441500*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *44150041
441600*    AND THE ERROR SWITCHES.                                     *44160041
441700*----------------------------------------------------------------*44170041
441800 9900A-SOFT-ABORT.                                                44180041
441900     SET PS-ERROR         TO TRUE.                                44190041
442000     SET DP020-MSG-FATAL  TO TRUE.                                44200041
442100     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    44210041
442200     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       44220041
442300     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          44230041
442400     PERFORM 0001-CALL-CICS-ARCH-API.                             44240041
442500                                                                  44250041
442600******************************************************************44260041
442700 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  44270041
442800                                                                  44280041
442900     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           44290041
443000     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          44300041
443100     INITIALIZE DP013-SRC-TASK-NUMBER                             44310041
443200                DP013-STACK.                                      44320041
443300     SET DP013-LINK-RETURN            TO TRUE.                    44330041
443400                                                                  44340041
443500     EXEC CICS                                                    44350041
443600         LINK                                                     44360041
443700             PROGRAM   (DP013-NAME)                               44370041
443800             COMMAREA  (DP013-PARAMETERS)                         44380041
443900             LENGTH    (DP013-LENGTH)                             44390041
444000     END-EXEC.                                                    44400041
444100/                                                                 44410041
444200*----------------------------------------------------------------*44420027
444300*    ABEND PROCESSOR MODULE                                      *44430027
444400*----------------------------------------------------------------*44440027
444500     COPY DPPD013.                                                44450027
444600*                                                                 44460031
444700*----------------------------------------------------------------*44470027
