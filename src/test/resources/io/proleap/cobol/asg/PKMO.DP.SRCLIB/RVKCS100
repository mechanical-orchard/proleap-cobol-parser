000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RVKCS100.                                         00040000
000500 AUTHOR.        MIKE FURLICK.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  12-03-92.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    T100 - REQUEST RA LIST.                                    * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES THE REQUEST FOR RETURN AUTHORIZATION* 00130000
001400*    LIST.  THE USER CAN SELECT MULTIPLE ITEMS FOR INQUIRY,     * 00140000
001500*    UPDATE AND DELETE PROCESSING.                              * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001800*    04/11/03 - LAXMAN BOLINENI, IGSI   -  WR NO. 23022         * 00180000
001900*             - REPLACED ALL THE REFERENCES OF TSK TABLE WITH   * 00190000
002000*               XLT_SKU, XLT_VND_STYL TABLES.                   * 00200000
002100*                                                               * 00210000
002200*---------------------------------------------------------------* 00220000
002300*---------------------------------------------------------------* 00230000
002400* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00240000
002500* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00250000
002600* MAKING THE CALL DYNAMIC VS STATIC.                              00260000
002700*---------------------------------------------------------------* 00270000
002800                                                                  00280000
002900 ENVIRONMENT DIVISION.                                            00290000
003000                                                                  00300000
003100 DATA DIVISION.                                                   00310000
003200                                                                  00320000
003300 WORKING-STORAGE SECTION.                                         00330000
003400                                                                  00340000
003500 01  PC-PROGRAM-CONSTANTS.                                        00350000
003600     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00360000
003700     05  PC-MENU-TRAN-ID                PIC X(04)    VALUE 'Z007'.00370000
003800     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00380000
003900                                                     COMP SYNC.   00390000
004000     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00400000
004100     'RV100A  '.                                                  00410000
004200     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00420000
004300     'RVKM100 '.                                                  00430000
004400     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00440000
004500     'RVKCS100'.                                                  00450000
004600     05  PC-BEGINNING                   PIC X(01)    VALUE 'B'.   00460000
004700     05  PC-ENDING                      PIC X(01)    VALUE 'E'.   00470000
004800     05  PC-SELECTED                    PIC X(01)    VALUE 'S'.   00480000
004900     05  PC-ITEMS-PER-PANEL             PIC S9(04)   VALUE +14    00490000
005000                                                     COMP SYNC.   00500000
005100     05  PC-ITEMS-PER-BLOCK             PIC S9(04)   VALUE +18    00510000
005200                                                     COMP SYNC.   00520000
005300     05  PC-MAX-ITEMS-TO-BE-READ        PIC S9(04)   VALUE +100   00530000
005400                                                     COMP SYNC.   00540000
005500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)   VALUE +2     00550000
005600                                                     COMP SYNC.   00560000
005700     05  PC-MAX-WR-ITEMS                PIC S9(03)   VALUE +100   00570000
005800                                                     COMP-3.      00580000
005900     05  PC-MAX-ITEMS                   PIC S9(09)   VALUE        00590000
006000                                                     +1000000     00600000
006100                                                     COMP-3.      00610000
006200     05  PC-FIELD-LENGTH                PIC S9(04)   VALUE +5     00620000
006300                                                     COMP SYNC.   00630000
006400     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   00640000
006500                                                     COMP SYNC.   00650000
006600     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      00660000
006700         10  FILLER                     PIC X(01).                00670000
006800         10  PC-ERASE-EOF               PIC X(01).                00680000
006900     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00690000
007000                                                     COMP-3.      00700000
007100     05  PC-ZERO                        PIC 9        VALUE 0.     00710000
007200     05  PC-PERCENT                     PIC X(1)     VALUE '%'.   00720000
007300     05  PC-COMPANY                     PIC X(2)     VALUE '03'.  00730000
007400     05  PC-ZERO2                       PIC X(2)     VALUE '00'.  00740000
007500     05  PC-ZERO3                       PIC X(3)     VALUE '000'. 00750000
007600     05  PC-DPT                         PIC X(3)     VALUE 'DPT'. 00760000
007700     05  PC-BYR                         PIC X(3)     VALUE 'BYR'. 00770000
007800     05  PC-INQ                         PIC X(3)     VALUE 'INQ'. 00780000
007900     05  PC-UPD                         PIC X(3)     VALUE 'UPD'. 00790000
008000     05  PC-DEL                         PIC X(3)     VALUE 'DEL'. 00800000
008100     05  PC-ERR                         PIC X(3)     VALUE 'ERR'. 00810000
008200*                                                                 00820000
008300 01  PC-TSYMSG-NUMBERS.                                           00830000
008400     05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.  00840000
008500     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00850000
008600     05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.  00860000
008700     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00870000
008800     05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.  00880000
008900     05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.  00890000
009000     05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.  00900000
009100     05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.  00910000
009200     05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.  00920000
009300     05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.  00930000
009400     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00940000
009500     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00950000
009600     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00960000
009700     05  PC-TSYMSG-00146                PIC 9(5)    VALUE 00146.  00970000
009800     05  PC-TSYMSG-00207                PIC 9(5)    VALUE 00207.  00980000
009900     05  PC-TSYMSG-99901                PIC 9(5)    VALUE 99901.  00990000
010000*                                                                 01000000
010100 01  PM-PROGRAM-MESSAGES.                                         01010000
010200     05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE        01020000
010300     'ERROR TRYING TO REWRITE  TEMP STORAGE QUEUE - RESP '.       01030000
010400     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-9.                   01040000
010500         10  FILLER                     PIC X(51).                01050000
010600         10  PM-RESP-9                  PIC Z(03)9-.              01060000
010700         10  FILLER                     PIC X(22).                01070000
010800     05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE        01080000
010900     'ERROR TRYING TO WRITE TO TEMP STORAGE QUEUE - RESP '.       01090000
011000     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-10.                  01100000
011100         10  FILLER                     PIC X(51).                01110000
011200         10  PM-RESP-10                 PIC Z(03)9-.              01120000
011300         10  FILLER                     PIC X(22).                01130000
011400     05  PM-PROGRAM-MESSAGE-11          PIC X(78)    VALUE        01140000
011500     'LOGIC ERROR IN TRYING TO WRITE TO TEMP STORAGE QUEUE - BLOCK01150000
011600-    '     '.                                                     01160000
011700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-11.                  01170000
011800         10  FILLER                     PIC X(61).                01180000
011900         10  PM-BLOCK-NUMBER            PIC Z(03)9-.              01190000
012000         10  FILLER                     PIC X(12).                01200000
012100     05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        01210000
012200     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                01220000
012300     05  PM-PROGRAM-MESSAGE-23          PIC X(78)    VALUE        01230000
012400     'ERROR TRYING TO DELETE TEMP STORAGE QUEUE - RESP '.         01240000
012500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-23.                  01250000
012600         10  FILLER                     PIC X(49).                01260000
012700         10  PM-RESP-23                 PIC Z(03)9-.              01270000
012800         10  FILLER                     PIC X(24).                01280000
012900     05  PM-PROGRAM-MESSAGE-24          PIC X(78)    VALUE        01290000
013000     'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE - RESP '.      01300000
013100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-24.                  01310000
013200         10  FILLER                     PIC X(52).                01320000
013300         10  PM-RESP-24                 PIC Z(03)9-.              01330000
013400         10  FILLER                     PIC X(21).                01340000
013500     05  PM-PROGRAM-MESSAGE-28          PIC X(78)    VALUE        01350000
013600     'ERROR OCCURRED DURING TS QUEUE PROCESSING'.                 01360000
013700*                                                                 01370000
013800 01  PS-PROGRAM-SUBSCRIPTS.                                       01380000
013900     05  PS-SUB                         PIC S9(04)   VALUE +0     01390000
014000                                                     COMP SYNC.   01400000
014100     05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0     01410000
014200                                                     COMP-3.      01420000
014300                                                                  01430000
014400 01  PS-PROGRAM-SWITCHES.                                         01440000
014500     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01450000
014600         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01460000
014700         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01470000
014800         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01480000
014900         88  PS-SEND-DATA-ONLY                       VALUE '4'.   01490000
015000         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01500000
015100         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01510000
015200     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01520000
015300         88  PS-ERROR                                VALUE 'Y'.   01530000
015400         88  PS-NO-ERROR                             VALUE 'N'.   01540000
015500     05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.   01550000
015600         88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01560000
015700         88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.   01570000
015800     05  PS-SAME-ITEMS-DISPLAYED-SW     PIC X(01)    VALUE 'N'.   01580000
015900         88  PS-SAME-ITEMS-DISPLAYED                 VALUE 'Y'.   01590000
016000         88  PS-DIFFERENT-ITEMS-DISPLAYED            VALUE 'N'.   01600000
016100     05  PS-CURSOR-POSITIONED-SW        PIC X(01)    VALUE 'N'.   01610000
016200         88  PS-CURSOR-POSITIONED                    VALUE 'Y'.   01620000
016300         88  PS-CURSOR-NOT-POSITIONED                VALUE 'N'.   01630000
016400     05  PS-VALID-SELECTIONS-SW         PIC X(01)    VALUE 'Y'.   01640000
016500         88  PS-VALID-SELECTIONS                     VALUE 'Y'.   01650000
016600         88  PS-INVALID-SELECTIONS                   VALUE 'N'.   01660000
016700     05  PS-VALID-BEG-ITEM-SW           PIC X(01)    VALUE 'N'.   01670000
016800         88  PS-VALID-BEG-ITEM                       VALUE 'Y'.   01680000
016900         88  PS-INVALID-BEG-ITEM                     VALUE 'N'.   01690000
017000     05  PS-TOP-ITEM-IN-ARRAY-SW        PIC X(01)    VALUE 'N'.   01700000
017100         88  PS-TOP-ITEM-IN-ARRAY                    VALUE 'Y'.   01710000
017200         88  PS-TOP-ITEM-NOT-IN-ARRAY                VALUE 'N'.   01720000
017300     05  PS-BOTTOM-ITEM-IN-ARRAY-SW     PIC X(01)    VALUE 'N'.   01730000
017400         88  PS-BOTTOM-ITEM-IN-ARRAY                 VALUE 'Y'.   01740000
017500         88  PS-BOTTOM-ITEM-NOT-IN-ARRAY             VALUE 'N'.   01750000
017600     05  PS-TOP-ITEM-IN-TEMP-SW         PIC X(01)    VALUE 'N'.   01760000
017700         88  PS-TOP-ITEM-IN-TEMP                     VALUE 'Y'.   01770000
017800         88  PS-TOP-ITEM-NOT-IN-TEMP                 VALUE 'N'.   01780000
017900     05  PS-BOTTOM-ITEM-IN-TEMP-SW      PIC X(01)    VALUE 'N'.   01790000
018000         88  PS-BOTTOM-ITEM-IN-TEMP                  VALUE 'Y'.   01800000
018100         88  PS-BOTTOM-ITEM-NOT-IN-TEMP              VALUE 'N'.   01810000
018200     05  PS-LAST-BLOCK-IN-ARRAY-SW      PIC X(01)    VALUE 'N'.   01820000
018300         88  PS-LAST-BLOCK-IN-ARRAY                  VALUE 'Y'.   01830000
018400         88  PS-LAST-BLOCK-NOT-IN-ARRAY              VALUE 'N'.   01840000
018500     05  PS-SELECTION-FOUND-SW          PIC X(01)    VALUE 'N'.   01850000
018600         88  PS-SELECTION-FOUND                      VALUE 'Y'.   01860000
018700         88  PS-NO-SELECTION-FOUND                   VALUE 'N'.   01870000
018800     05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.   01880000
018900         88  PS-WARNING                              VALUE 'Y'.   01890000
019000         88  PS-NO-WARNING                           VALUE 'N'.   01900000
019100     05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.   01910000
019200         88  PS-INFORMATIONAL                        VALUE 'Y'.   01920000
019300         88  PS-NOT-INFORMATIONAL                    VALUE 'N'.   01930000
019400     05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.   01940000
019500         88  PS-CONTINUE                             VALUE 'Y'.   01950000
019600         88  PS-DONT-PROCESS                         VALUE 'N'.   01960000
019700     05  PS-PROCESS-ITEM-SW             PIC X(01)    VALUE 'N'.   01970000
019800         88  PS-END-OF-ITEMS                         VALUE 'Y'.   01980000
019900         88  PS-NOT-END                              VALUE 'N'.   01990000
020000     05  PS-HISTORY-SELECT-SW           PIC X(01)    VALUE 'N'.   02000000
020100         88  PS-HISTORY-SELECTED                     VALUE 'Y'.   02010000
020200         88  PS-DIDNT-SELECT-HISTORY                 VALUE 'N'.   02020000
020300     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   02030000
020400         88  PS-COMMAREA-VALID                       VALUE 'Y'.   02040000
020500         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   02050000
020600     05  PS-LIST-ITEMS-SW               PIC X(01)    VALUE 'N'.   02060000
020700         88  PS-LIST-ITEMS-FOUND                     VALUE 'Y'.   02070000
020800         88  PS-NO-LIST-ITEMS-FOUND                  VALUE 'N'.   02080000
020900     05  PS-USE-ITEM-SE                 PIC X(01)    VALUE 'N'.   02090000
021000         88  PS-USE-ITEM                             VALUE 'Y'.   02100000
021100         88  PS-DONT-USE-ITEM                        VALUE 'N'.   02110000
021200     05  PS-DONE-SW                     PIC X(01)    VALUE 'N'.   02120000
021300         88  PS-DONE                                 VALUE 'Y'.   02130000
021400         88  PS-NOT-DONE                             VALUE 'N'.   02140000
021500     EJECT                                                        02150000
021600 01  PV-PROGRAM-VARIABLES.                                        02160000
021700     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     02170000
021800                                                     COMP SYNC.   02180000
021900     05  PV-HIGHEST-ITEM-TO-BE-READ     PIC S9(09)   VALUE +0     02190000
022000                                                     COMP-3.      02200000
022100     05  PV-ENDING-ITEM-ON-PANEL        PIC S9(09)   VALUE +0     02210000
022200                                                     COMP-3.      02220000
022300     05  PV-ITEM-IN-USE                 PIC S9(09)   VALUE +0     02230000
022400                                                     COMP-3.      02240000
022500     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     02250000
022600                                                     COMP-3.      02260000
022700     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     02270000
022800                                                     COMP-3.      02280000
022900     05  PV-MAX-ITEMS-TO-BE-READ        PIC S9(09)   VALUE +0     02290000
023000                                                     COMP-3.      02300000
023100     05  PV-FIRST-ITEM-IN-ARRAY         PIC S9(09)   VALUE +0     02310000
023200                                                     COMP-3.      02320000
023300     05  PV-LAST-ITEM-IN-ARRAY          PIC S9(09)   VALUE +0     02330000
023400                                                     COMP-3.      02340000
023500     05  PV-LAST-ITEM-IN-TEMP           PIC S9(09)   VALUE +0     02350000
023600                                                     COMP-3.      02360000
023700     05  PV-BEGINNING-ITEM              PIC S9(09)   VALUE +0     02370000
023800                                                     COMP-3.      02380000
023900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)   VALUE +0     02390000
024000                                                     COMP-3.      02400000
024100     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     02410000
024200                                                     COMP SYNC.   02420000
024300     05  PV-RESP                        PIC S9(04)   VALUE +0     02430000
024400                                                     COMP SYNC.   02440000
024500     05  PV-ITEM                        PIC S9(04)   VALUE +0     02450000
024600                                                     COMP SYNC.   02460000
024700     05  PV-TSQ-B-ITEM                  PIC S9(04)   VALUE +0     02470000
024800                                                     COMP SYNC.   02480000
024900     05  PV-SAVE-ITEM                   PIC S9(04)   VALUE +0     02490000
025000                                                     COMP SYNC.   02500000
025100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     02510000
025200                                                     COMP SYNC.   02520000
025300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     02530000
025400                                                     COMP SYNC.   02540000
025500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)   VALUE +0     02550000
025600                                                     COMP SYNC.   02560000
025700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02570000
025800                                                     COMP SYNC.   02580000
025900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02590000
026000                                                     COMP SYNC.   02600000
026100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)   VALUE +0     02610000
026200                                                     COMP SYNC.   02620000
026300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)   VALUE +0     02630000
026400                                                     COMP SYNC.   02640000
026500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)   VALUE +0     02650000
026600                                                     COMP SYNC.   02660000
026700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)   VALUE +0     02670000
026800                                                     COMP SYNC.   02680000
026900     05  PV-ITEMS-READ                  PIC S9(04)   VALUE +0     02690000
027000                                                     COMP SYNC.   02700000
027100     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.02710000
027200     05  PV-SQL-SUB                     PIC S9(4)    COMP.        02720000
027300     05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.      02730000
027400     05  PV-BEGITMI.                                              02740000
027500         10  PV-BEGITMI-N               PIC 9(7).                 02750000
027600     05  PV-DISPLAY7                    PIC ZZZ,ZZ9.              02760000
027700     05  PV-BG-QUEUE-NAME.                                        02770000
027800         10  PV-BG-TERM-ID              PIC X(4).                 02780000
027900         10  PV-BG-TASK-NUMBER          PIC S9(5)    COMP-3.      02790000
028000         10  PV-BG-SEQUENCE             PIC  9(1).                02800000
028100     05  PV-HOLD-STATUS                 PIC S9(4)    COMP-3       02810000
028200                                                     VALUE ZERO.  02820000
028300     05  PV-VENDOR-NAME                 PIC X(25)    VALUE SPACE. 02830000
028400     05  PV-DEPT                        PIC 9(04)    VALUE ZEROS. 02840000
028500                                                                  02850000
028600 01  PV-DB2-COMPARE-DATE                PIC X(10)    VALUE        02860000
028700                                                     '1900-01-01'.02870000
028800 01  PV-DB2-WORK-DATE.                                            02880000
028900     05  PV-DB2-WD-CC                   PIC X(2).                 02890000
029000     05  PV-DB2-WD-YY                   PIC X(2).                 02900000
029100     05  FILLER                         PIC X        VALUE '-'.   02910000
029200     05  PV-DB2-WD-MM                   PIC XX.                   02920000
029300     05  FILLER                         PIC X        VALUE '-'.   02930000
029400     05  PV-DB2-WD-DD                   PIC XX.                   02940000
029500 01  PV-DISPLAY-DATE.                                             02950000
029600     05  PV-DD-MM                       PIC XX.                   02960000
029700     05  FILLER                         PIC X        VALUE '/'.   02970000
029800     05  PV-DD-DD                       PIC XX.                   02980000
029900     05  FILLER                         PIC X        VALUE '/'.   02990000
030000     05  PV-DD-YY                       PIC XX.                   03000000
030100     05  PV-BLOCK-LENGTH                PIC S9(04)   COMP SYNC.   03010000
030200                                                                  03020000
030300 01  PV-TEMP-WORK-AREA.                                           03030000
030400     05  PV-BLOCK-MODIFIED              PIC X.                    03040000
030500     05  PV-TW-ITEM-ENTRIES OCCURS 18 TIMES                       03050000
030600                            INDEXED BY PV-TW-IDX.                 03060000
030700         10  PV-TW-LIST-ITEM-NUMBER     PIC S9(9)    COMP-3.      03070000
030800         10  PV-TW-SELECTED-SW          PIC X.                    03080000
030900             88  PV-TW-SELECT                        VALUE 'S'.   03090000
031000             88  PV-TW-DESELECT                      VALUE ' '.   03100000
031100         10  PV-TW-ACTION               PIC X(3).                 03110000
031200         10  PV-TW-TYPE-CDE             PIC X(1).                 03120000
031300         10  PV-TW-STATUS-CDE           PIC X(1).                 03130000
031400         10  PV-TW-RA-NUMBER            PIC 9(12).                03140000
031500         10  PV-TW-VEND-NAME            PIC X(15).                03150000
031600         10  PV-TW-CREATE-DATE          PIC X(08).                03160000
031700         10  PV-TW-BUYER                PIC X(10).                03170000
031800         10  PV-TW-DUNS-NUMBER          PIC X(09).                03180000
031900                                                                  03190000
032000 EJECT                                                            03200000
032100*---------------------------------------------------------------* 03210000
032200*    STANDARD COMMAREA.                                         * 03220000
032300*---------------------------------------------------------------* 03230000
032400                                                                  03240000
032500     COPY DPWS020.                                                03250000
032600     05  RV100-FILLER  REDEFINES  DP020-VARIABLE-COMMAREA.        03260000
032700                                                                  03270000
032800*---------------------------------------------------------------* 03280000
032900*    INTER-APPLICATION COMMAREA.                                * 03290000
033000*---------------------------------------------------------------* 03300000
033100                                                                  03310000
033200         10  INTER-APPL-COMM-AREA       PIC X(200).               03320000
033300     COPY RVWS100.                                                03330000
033400*---------------------------------------------------------------* 03340000
033500*    SPECIFIC COMMMAREA FOR DPKCS036.                           * 03350000
033600*---------------------------------------------------------------* 03360000
033700         10  RV100-SPECIFIC-COMMAREA.                             03370000
033800             15  RV100-APPL-CURSOR-POSITION          PIC S9(04)   03380000
033900                                                     COMP.        03390000
034000                                                                  03400000
034100             15  RV100-BLOCK-ENTRIES OCCURS 2 TIMES.              03410000
034200                 20  RV100-BLOCK-MODIFIED-SW         PIC X(01).   03420000
034300                     88  RV100-BLOCK-NOT-MODIFIED    VALUE 'N'.   03430000
034400                     88  RV100-BLOCK-MODIFIED        VALUE 'Y'.   03440000
034500                                                                  03450000
034600                 20  RV100-ITEM-ARRAY.                            03460000
034700                     25  RV100-ITEM-ENTRIES OCCURS 18 TIMES.      03470000
034800                         30  RV100-LIST-ITEM-NUMBER               03480000
034900                                                     PIC S9(09)   03490000
035000                                                         COMP-3.  03500000
035100                         30  RV100-SELECTED-SW       PIC X(01).   03510000
035200                             88  RV100-NO-SELECT     VALUE ' '.   03520000
035300                             88  RV100-SELECT        VALUE 'S'.   03530000
035400                             88  RV100-BEGIN         VALUE 'B'.   03540000
035500                             88  RV100-END           VALUE 'E'.   03550000
035600                         30  RV100-ACTION            PIC X(3).    03560000
035700                         30  RV100-TYPE              PIC X(1).    03570000
035800                         30  RV100-STATUS            PIC X(1).    03580000
035900                         30  RV100-REQ-RA            PIC 9(12).   03590000
036000                         30  RV100-VEND-NAME         PIC X(15).   03600001
036100                         30  RV100-CREATE-DATE       PIC X(08).   03610000
036200                         30  RV100-BUYER             PIC X(10).   03620000
036300                         30  RV100-DUNS-NUMBER       PIC X(09).   03630000
036400                                                                  03640000
036500             15  RV100-BLK-SUB                       PIC S9(04)   03650000
036600                                                         COMP     03660000
036700                                                         SYNC.    03670000
036800             15  RV100-ITEM-SUB                      PIC S9(04)   03680000
036900                                                         COMP     03690000
037000                                                         SYNC.    03700000
037100             15  RV100-NUMBER-OF-ITEMS-READ          PIC S9(09)   03710000
037200                                                         COMP-3.  03720000
037300             15  RV100-NUMBER-OF-SELECTED-ITEMS      PIC S9(09)   03730000
037400                                                         COMP-3.  03740000
037500             15  RV100-ITEM-AT-TOP-OF-PANEL          PIC S9(09)   03750000
037600                                                         COMP-3.  03760000
037700             15  RV100-ITEM-AT-BOT-OF-PANEL          PIC S9(09)   03770000
037800                                                         COMP-3.  03780000
037900             15  RV100-HIGHEST-BLOCK-WRITTEN         PIC S9(04)   03790000
038000                                                         COMP     03800000
038100                                                         SYNC.    03810000
038200             15  RV100-START-OF-SELECTED-RANGE       PIC S9(09)   03820000
038300                                                         COMP-3.  03830000
038400             15  RV100-END-OF-SELECTED-RANGE         PIC S9(09)   03840000
038500                                                         COMP-3.  03850000
038600             15  RV100-ITEMS-LEFT-INDICATOR          PIC X.       03860000
038700                 88  RV100-ITEMS-LEFT-ON-DB            VALUE 'Y'. 03870000
038800                 88  RV100-NO-ITEMS-LEFT-ON-DB         VALUE 'N'. 03880000
038900             15  RV100-TEMP-QUEUE-UPDATE-SW          PIC X.       03890000
039000                 88  RV100-UPDATE-TSQ                  VALUE 'Y'. 03900000
039100                 88  RV100-NO-TSQ-UPDATE               VALUE 'N'. 03910000
039200             15  RV100-TEMP-QUEUE-NAME.                           03920000
039300                 20  RV100-TERM-ID                   PIC X(4).    03930000
039400                 20  RV100-TASK-NUMBER               PIC S9(7)    03940000
039500                                                         COMP-3.  03950000
039600             15  RV100-HOLD-TSQB-QUEUE-NAME          PIC X(8).    03960000
039700             15  RV100-INT-APPL-FORMAT-IND           PIC X.       03970000
039800                                                                  03980000
039900             15  RV100-DB2-CURRENT-DATE.                          03990000
040000                 20  RV100-DC-CC                     PIC XX.      04000000
040100                 20  RV100-DC-YY                     PIC XX.      04010000
040200                 20  FILLER                          PIC X.       04020000
040300                     88  RV100-DC-DASH1              VALUE '-'.   04030000
040400                 20  RV100-DC-MM                     PIC XX.      04040000
040500                 20  FILLER                          PIC X.       04050000
040600                     88  RV100-DC-DASH2              VALUE '-'.   04060000
040700                 20  RV100-DC-DD                     PIC XX.      04070000
040800             15  RV100-CURSOR-SW                     PIC X.       04080000
040900                 88  RV100-RA-NUMBER-CSR             VALUE 'R'.   04090000
041000                 88  RV100-STATUS-CSR                VALUE 'S'.   04100000
041100                 88  RV100-VENDOR-NAME-CSR           VALUE 'V'.   04110000
041200                 88  RV100-LOCATION-CSR              VALUE 'L'.   04120000
041300                                                                  04130000
041400             15  RV100-SAVE-APPL-COMMAREA            PIC X(200).  04140000
041500                                                                  04150000
041600     EJECT                                                        04160000
041700*---------------------------------------------------------------* 04170000
041800*    TSQ B QUEUE RECORD LAYOUT.                                 * 04180000
041900*---------------------------------------------------------------* 04190000
042000                                                                  04200000
042100     COPY RVWS101.                                                04210000
042200                                                                  04220000
042300     EJECT                                                        04230000
042400*---------------------------------------------------------------* 04240000
042500*    ABEND PROCESSING COPYBOOK.                                 * 04250000
042600*---------------------------------------------------------------* 04260000
042700                                                                  04270000
042800     COPY DPWS013.                                                04280000
042900                                                                  04290000
043000     EJECT                                                        04300000
043100*---------------------------------------------------------------* 04310000
043200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04320000
043300*---------------------------------------------------------------* 04330000
043400                                                                  04340000
043500     COPY DPWS015.                                                04350000
043600                                                                  04360000
043700*---------------------------------------------------------------* 04370000
043800*    CURRENT DATE AND TIME COPYBOOK.                            * 04380000
043900*---------------------------------------------------------------* 04390000
044000                                                                  04400000
044100     COPY DPWS017.                                                04410000
044200                                                                  04420000
044300*---------------------------------------------------------------* 04430000
044400*    TOGGLE FUNCTION KEY LINES COPYBOOK.                        * 04440000
044500*---------------------------------------------------------------* 04450000
044600                                                                  04460000
044700     COPY DPWS009.                                                04470000
044800                                                                  04480000
044900*---------------------------------------------------------------* 04490000
045000*    MESSAGE LAYOUT COPYBOOK                                    * 04500000
045100*---------------------------------------------------------------* 04510000
045200                                                                  04520000
045300     COPY DPWS006.                                                04530000
045400                                                                  04540000
045500*---------------------------------------------------------------* 04550000
045600*    FUNCTION KEYS COPYBOOK.                                    * 04560000
045700*---------------------------------------------------------------* 04570000
045800                                                                  04580000
045900     COPY DPWS016.                                                04590000
046000                                                                  04600000
046100*---------------------------------------------------------------* 04610000
046200*    DPKUT045 COPYBOOK.                                         * 04620000
046300*---------------------------------------------------------------* 04630000
046400                                                                  04640000
046500     COPY DPWS045.                                                04650000
046600                                                                  04660000
046700*---------------------------------------------------------------* 04670000
046800*    NUMERIC EDIT LAYOUT.                                       * 04680000
046900*---------------------------------------------------------------* 04690000
047000                                                                  04700000
047100     COPY DPWS010I.                                               04710000
047200                                                                  04720000
047300*---------------------------------------------------------------* 04730000
047400*    MESSAGE RECORD LAYOUT                                      * 04740000
047500*---------------------------------------------------------------* 04750000
047600                                                                  04760000
047700     COPY DPRD507I.                                               04770000
047800                                                                  04780000
047900*---------------------------------------------------------------* 04790000
048000*    STANDARD ATTENTION IDENTIFIER LIST                         * 04800000
048100*---------------------------------------------------------------* 04810000
048200                                                                  04820000
048300     COPY DFHAID.                                                 04830000
048400                                                                  04840000
048500*---------------------------------------------------------------* 04850000
048600*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST      * 04860000
048700*---------------------------------------------------------------* 04870000
048800                                                                  04880000
048900     COPY DFHBMSCA.                                               04890000
049000                                                                  04900000
049100*---------------------------------------------------------------* 04910000
049200*    MAP LAYOUT                                                 * 04920000
049300*---------------------------------------------------------------* 04930000
049400                                                                  04940000
049500     COPY RVKM100.                                                04950000
049600 01  MD-MAP-DATA-AREA  REDEFINES RV100AO PIC X(2000).             04960000
049700*                                                                 04970000
049800 01  RVKM100-OCCURS-LAYOUT  REDEFINES  MD-MAP-DATA-AREA.          04980000
049900     05  FILLER                PIC X(146).                        04990000
050000     05  RVKM100-SCROLL-AREA OCCURS 14 TIMES.                     05000000
050100         10  RVKM100-SELECTL   PIC S9(4) COMP.                    05010000
050200         10  RVKM100-SELECTA   PIC X.                             05020000
050300         10  RVKM100-SELECTC   PIC X.                             05030000
050400         10  RVKM100-SELECTH   PIC X.                             05040000
050500         10  RVKM100-SELECTI   PIC X.                             05050000
050600                                                                  05060000
050700         10  FILLER            PIC X(5).                          05070000
050800         10  RVKM100-ACTION    PIC X(3).                          05080000
050900                                                                  05090000
051000         10  FILLER            PIC X(5).                          05100000
051100         10  RVKM100-TYPE-CDE  PIC X(1).                          05110000
051200                                                                  05120000
051300         10  FILLER            PIC X(5).                          05130000
051400         10  RVKM100-STATUS-CDE                                   05140000
051500                               PIC X(1).                          05150000
051600                                                                  05160000
051700         10  FILLER            PIC X(5).                          05170000
051800         10  RVKM100-REQ-RA    PIC X(12).                         05180000
051900                                                                  05190000
052000         10  FILLER            PIC X(5).                          05200000
052100         10  RVKM100-VENDOR-NAME                                  05210000
052200                               PIC X(15).                         05220002
052300                                                                  05230000
052400         10  FILLER            PIC X(5).                          05240000
052500         10  RVKM100-CREATE-DATE                                  05250000
052600                               PIC X(8).                          05260000
052700                                                                  05270000
052800         10  FILLER            PIC X(5).                          05280000
052900         10  RVKM100-BUYER     PIC X(10).                         05290000
053000                                                                  05300000
053100         10  FILLER            PIC X(5).                          05310000
053200         10  RVKM100-DUNS-NUMBER                                  05320000
053300                               PIC X(9).                          05330000
053400 EJECT                                                            05340000
053500*---------------------------------------------------------------* 05350000
053600*    DB2 AREA FOR RTV DEFECT ORDER TABLE                        * 05360000
053700*---------------------------------------------------------------* 05370000
053800     EXEC SQL                                                     05380000
053900          INCLUDE TDFCTOR                                         05390000
054000     END-EXEC.                                                    05400000
054100*---------------------------------------------------------------* 05410000
054200*    DB2 AREA FOR RTV DEFECT ORDER MERCHANDISE ITEM TABLE       * 05420000
054300*---------------------------------------------------------------* 05430000
054400     EXEC SQL                                                     05440000
054500          INCLUDE TDFMEIT                                         05450000
054600     END-EXEC.                                                    05460000
054700*---------------------------------------------------------------* 05470000
054800*    DB2 AREA FOR THE MERCHANDISE AREA TABLE                    * 05480000
054900*---------------------------------------------------------------* 05490000
055000     EXEC SQL                                                     05500000
055100          INCLUDE TMDSEAR                                         05510000
055200     END-EXEC.                                                    05520000
055300*---------------------------------------------------------------* 05530000
055400*    DB2 AREA FOR THE RESPONSIBILITY AREA TABLE                 * 05540000
055500*---------------------------------------------------------------* 05550000
055600     EXEC SQL                                                     05560000
055700          INCLUDE TRSPBAR                                         05570000
055800     END-EXEC.                                                    05580000
055900*---------------------------------------------------------------* 05590000
056000*    DB2 AREA FOR THE SKU TABLE                                 * 05600000
056100*---------------------------------------------------------------* 05610000
056200     EXEC SQL                                                     05620000
056300          INCLUDE XLT00003                                        05630000
056400     END-EXEC.                                                    05640000
056500*---------------------------------------------------------------* 05650000
056600*    DB2 AREA FOR VENDOR STYLE TABLE                            * 05660000
056700*---------------------------------------------------------------* 05670000
056800     EXEC SQL                                                     05680000
056900          INCLUDE XLT00004                                        05690000
057000     END-EXEC.                                                    05700000
057100*---------------------------------------------------------------* 05710000
057200*    DB2 AREA FOR COMMUNICATIONS                                * 05720000
057300*---------------------------------------------------------------* 05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE SQLCA                                           05750000
057600     END-EXEC.                                                    05760000
057700                                                                  05770000
057800*---------------------------------------------------------------* 05780000
057900*    CURSOR WHEN THE RA NUMBER IS REQUESTED                     * 05790000
058000*---------------------------------------------------------------* 05800000
058100                                                                  05810000
058200     EXEC SQL                                                     05820000
058300          DECLARE RA-NUMBER-CSR CURSOR                            05830000
058400          FOR SELECT                                              05840000
058500                DFCT_ORD_ID                                       05850000
058600              , VENDOR_DUNS_NBR                                   05860000
058700              , ORD_DTE                                           05870000
058800              , VEND_NAME                                         05880000
058900              , DFCT_ORD_ID_CDE                                   05890000
059000              , DFCT_ORD_STAT_CDE                                 05900000
059100          FROM                                                    05910000
059200                TDFCTOR                                           05920000
059300          WHERE                                                   05930000
059400                DFCT_ORD_ID       = :RV100-RA-NUMBER              05940000
059500            AND OPER_UNT_ID       = :RV100-OPER-UNT-ID            05950000
059600          ORDER BY                                                05960000
059700                DFCT_ORD_ID_CDE                                   05970000
059800              , DFCT_ORD_STAT_CDE                                 05980000
059900              , ORD_DTE DESC                                      05990000
060000              , VEND_NAME                                         06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300*---------------------------------------------------------------* 06030000
060400*    CURSOR WHEN STATUS IS REQUESTED                            * 06040000
060500*---------------------------------------------------------------* 06050000
060600                                                                  06060000
060700     EXEC SQL                                                     06070000
060800          DECLARE STATUS-CSR CURSOR                               06080000
060900          FOR SELECT                                              06090000
061000                DFCT_ORD_ID                                       06100000
061100              , VENDOR_DUNS_NBR                                   06110000
061200              , ORD_DTE                                           06120000
061300              , VEND_NAME                                         06130000
061400              , DFCT_ORD_ID_CDE                                   06140000
061500              , DFCT_ORD_STAT_CDE                                 06150000
061600          FROM                                                    06160000
061700                TDFCTOR                                           06170000
061800          WHERE                                                   06180000
061900                DFCT_ORD_ID_CDE   = :RV100-TYPE-CDE               06190000
062000            AND DFCT_ORD_STAT_CDE = :RV100-STATUS-CDE             06200000
062100            AND OPER_UNT_ID       = :RV100-OPER-UNT-ID            06210000
062200          ORDER BY                                                06220000
062300                ORD_DTE DESC                                      06230000
062400              , DFCT_ORD_ID                                       06240000
062500              , VEND_NAME                                         06250000
062600     END-EXEC.                                                    06260000
062700                                                                  06270000
062800*---------------------------------------------------------------* 06280000
062900*    CURSOR WHEN VENDOR NAME IS THE SEARCH CRITERION            * 06290000
063000*---------------------------------------------------------------* 06300000
063100                                                                  06310000
063200     EXEC SQL                                                     06320000
063300          DECLARE VENDOR-NAME-CSR CURSOR                          06330000
063400          FOR SELECT                                              06340000
063500                DFCT_ORD_ID                                       06350000
063600              , VENDOR_DUNS_NBR                                   06360000
063700              , ORD_DTE                                           06370000
063800              , VEND_NAME                                         06380000
063900              , DFCT_ORD_ID_CDE                                   06390000
064000              , DFCT_ORD_STAT_CDE                                 06400000
064100          FROM                                                    06410000
064200                TDFCTOR                                           06420000
064300          WHERE                                                   06430000
064400                VEND_NAME LIKE :PV-VENDOR-NAME                    06440000
064500            AND OPER_UNT_ID     = :RV100-OPER-UNT-ID              06450000
064600          ORDER BY                                                06460000
064700                DFCT_ORD_ID_CDE                                   06470000
064800              , DFCT_ORD_STAT_CDE                                 06480000
064900              , ORD_DTE DESC                                      06490000
065000              , DFCT_ORD_ID                                       06500000
065100     END-EXEC.                                                    06510000
065200                                                                  06520000
065300*---------------------------------------------------------------* 06530000
065400*    CURSOR WHEN THE LOCATION IS THE SEARCH CRITERIA            * 06540000
065500*---------------------------------------------------------------* 06550000
065600                                                                  06560000
065700     EXEC SQL                                                     06570000
065800          DECLARE LOCATION-CSR  CURSOR                            06580000
065900          FOR SELECT                                              06590000
066000                DFCT_ORD_ID                                       06600000
066100              , VENDOR_DUNS_NBR                                   06610000
066200              , ORD_DTE                                           06620000
066300              , VEND_NAME                                         06630000
066400              , DFCT_ORD_ID_CDE                                   06640000
066500              , DFCT_ORD_STAT_CDE                                 06650000
066600          FROM                                                    06660000
066700                TDFCTOR                                           06670000
066800          WHERE                                                   06680000
066900                LOC_ID = :RV100-LOCATION                          06690000
067000            AND OPER_UNT_ID     = :RV100-OPER-UNT-ID              06700000
067100          ORDER BY                                                06710000
067200                DFCT_ORD_ID_CDE                                   06720000
067300              , DFCT_ORD_STAT_CDE                                 06730000
067400              , ORD_DTE DESC                                      06740000
067500              , DFCT_ORD_ID                                       06750000
067600     END-EXEC.                                                    06760000
067700                                                                  06770000
067800 EJECT                                                            06780000
067900 LINKAGE SECTION.                                                 06790000
068000                                                                  06800000
068100 01  DFHCOMMAREA.                                                 06810000
068200     05  FILLER                         OCCURS  1 TO 4072 TIMES   06820000
068300                                        DEPENDING ON EIBCALEN.    06830000
068400         10  FILLER                     PIC X.                    06840000
068500                                                                  06850000
068600 EJECT                                                            06860000
068700 PROCEDURE DIVISION.                                              06870000
068800                                                                  06880000
068900                                                                  06890000
069000 A100-MAIN-MODULE.                                                06900000
069100                                                                  06910000
069200*----------------------------------------------------------------*06920000
069300*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.          *06930000
069400*----------------------------------------------------------------*06940000
069500                                                                  06950000
069600     PERFORM DP015-0000-CHECK-COMMAREA.                           06960000
069700                                                                  06970000
069800     IF DP020-SRC-RETURN-W-TRAN-ID                                06980000
069900         PERFORM B100-CONTROL-PROCESSING                          06990000
070000     END-IF.                                                      07000000
070100                                                                  07010000
070200     PERFORM DP003-0000-RETURN-TO-CICS.                           07020000
070300                                                                  07030000
070400 EJECT                                                            07040000
070500*----------------------------------------------------------------*07050000
070600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07060000
070700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07070000
070800*                                                                *07080000
070900*    PERFORMED BY A100-MAIN-MODULE.                              *07090000
071000*----------------------------------------------------------------*07100000
071100                                                                  07110000
071200 B100-CONTROL-PROCESSING.                                         07120000
071300                                                                  07130000
071400     SET PS-CONTINUE           TO  TRUE.                          07140000
071500     EVALUATE TRUE                                                07150000
071600         WHEN DP020-NEXT-ACT-INITIAL                              07160000
071700              INITIALIZE RV100-SPECIFIC-COMMAREA                  07170000
071800              MOVE INTER-APPL-COMM-AREA                           07180000
071900                               TO  RV100-SAVE-APPL-COMMAREA       07190000
072000              MOVE DP020-INT-APPL-FORMAT-IND                      07200000
072100                               TO  RV100-INT-APPL-FORMAT-IND      07210000
072200              SET PS-CONTINUE  TO  TRUE                           07220000
072300              SET PS-SEND-MAP-N-DATA-FRSET                        07230000
072400                               TO  TRUE                           07240000
072500              SET DP020-NEXT-ACT-READ-MAP                         07250000
072600                               TO  TRUE                           07260000
072700              PERFORM D100-SETUP-INIT-PANEL                       07270000
072800              IF  PS-NO-LIST-ITEMS-FOUND                          07280000
072900                  MOVE DP016-PF3                                  07290000
073000                               TO  DP020-SRC-AID                  07300000
073100                  PERFORM DP015-1000-START-NAVIGATOR              07310000
073200              END-IF                                              07320000
073300                                                                  07330000
073400         WHEN DP020-NEXT-ACT-READ-MAP                             07340000
073500              PERFORM C300-PROCESS-PANEL                          07350000
073600                                                                  07360000
073700         WHEN DP020-NEXT-ACT-RETURN                               07370000
073800              SET PS-SEND-MAP-N-DATA-FRSET                        07380000
073900                               TO  TRUE                           07390000
074000              PERFORM C400-REFRESH-PANEL-FROM-TEMP                07400000
074100              PERFORM G100-DISPLAY-PANEL                          07410000
074200                                                                  07420000
074300         WHEN DP020-NEXT-ACT-ERROR                                07430000
074400              MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                07440000
074500              IF  DP020-NAV-MNEMONIC = SPACES                     07450000
074600                  MOVE SPACES  TO  ANAVCMDO                       07460000
074700                  MOVE DP015-UNDERLINE                            07470000
074800                               TO  ANAVCMDH                       07480000
074900                  MOVE DP015-GREEN                                07490000
075000                               TO  ANAVCMDC                       07500000
075100              ELSE                                                07510000
075200                  MOVE DP020-NAV-MNEMONIC                         07520000
075300                               TO  ANAVCMDO                       07530000
075400                  MOVE DP015-REVERSE                              07540000
075500                               TO  ANAVCMDH                       07550000
075600                  MOVE DP015-RED                                  07560000
075700                               TO  ANAVCMDC                       07570000
075800              END-IF                                              07580000
075900                                                                  07590000
076000              PERFORM C400-REFRESH-PANEL-FROM-TEMP                07600000
076100              MOVE -1          TO  ANAVCMDL                       07610000
076200              MOVE PV-MESSAGE  TO  DP020-MSG-MESSAGE              07620000
076300                                                                  07630000
076400              SET DP020-MSG-FATAL                                 07640000
076500                               TO  TRUE                           07650000
076600              SET PS-SEND-MAP-N-DATA-FRSET                        07660000
076700                               TO  TRUE                           07670000
076800              SET PS-CURSOR-POSITIONED                            07680000
076900                               TO  TRUE                           07690000
077000              PERFORM G100-DISPLAY-PANEL                          07700000
077100                                                                  07710000
077200         WHEN OTHER                                               07720000
077300              SET DP013-LOGIC-ABEND TO TRUE                       07730000
077400              SET DP013-NO-ROLLBACK TO TRUE                       07740000
077500              MOVE 'B100-CONTROL-PROCESSING'                      07750000
077600                               TO  DP013-PARAGRAPH                07760000
077700              MOVE PM-PROGRAM-MESSAGE-12                          07770000
077800                               TO  DP013-MESSAGE-TEXT(1)          07780000
077900              PERFORM DP013-0000-PROCESS-ABEND                    07790000
078000     END-EVALUATE.                                                07800000
078100                                                                  07810000
078200 EJECT                                                            07820000
078300*----------------------------------------------------------------*07830000
078400*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *07840000
078500*    ON WHAT FUNCTION KEY WAS SELECTED.                          *07850000
078600*                                                                *07860000
078700*    PERFORMED BY B100-CONTROL-PROCESSING.                       *07870000
078800*----------------------------------------------------------------*07880000
078900                                                                  07890000
079000 C300-PROCESS-PANEL.                                              07900000
079100                                                                  07910000
079200     PERFORM DP007-0000-GET-PANEL.                                07920000
079300     SET PS-SEND-DATA-ONLY-FRSET                                  07930000
079400                               TO TRUE.                           07940000
079500     EVALUATE TRUE                                                07950000
079600                                                                  07960000
079700         WHEN DP020-SRC-AID = DP016-CLEAR                         07970000
079800              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                07980000
079900              SET PS-SAME-ITEMS-DISPLAYED  TO TRUE                07990000
080000              PERFORM E100-EDIT-SELECTIONS                        08000000
080100              PERFORM G100-DISPLAY-PANEL                          08010000
080200                                                                  08020000
080300         WHEN DP020-SRC-AID = DP016-PF5                           08030000
080400              MOVE SPACES      TO  ANAVCMDO                       08040000
080500                                   ANAVKEYO                       08050000
080600              PERFORM Z050-DELETE-TEMP-STORAGE                    08060000
080700              PERFORM D100-SETUP-INIT-PANEL                       08070000
080800                                                                  08080000
080900         WHEN DP020-SRC-AID = DP016-PA2                           08090000
081000              PERFORM DP009-0000-LOAD-FK-LINES                    08100000
081100              PERFORM DP017-0000-GET-CURR-DATE-TIME               08110000
081200              SET PS-SEND-DATA-ONLY                               08120000
081300                               TO  TRUE                           08130000
081400              MOVE -1          TO  ANAVCMDL                       08140000
081500              PERFORM DP008-0000-WRITE-PANEL                      08150000
081600                                                                  08160000
081700         WHEN OTHER                                               08170000
081800              PERFORM D200-RECORD-SELECTIONS                      08180000
081900              IF  PS-VALID-SELECTIONS                             08190000
082000                  PERFORM D300-CHECK-FUNCTION-KEY                 08200000
082100              ELSE                                                08210000
082200                  SET PS-SAME-ITEMS-DISPLAYED TO TRUE             08220000
082300                  PERFORM G100-DISPLAY-PANEL                      08230000
082400             END-IF                                               08240000
082500     END-EVALUATE.                                                08250000
082600                                                                  08260000
082700 EJECT                                                            08270000
082800*----------------------------------------------------------------*08280000
082900*    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,*08290000
083000*    SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.      *08300000
083100*    EDIT THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL *08310000
083200*    TO THE USER.                                                *08320000
083300*                                                                *08330000
083400*    PERFORMED BY B100-CONTROL-PROCESSING.                       *08340000
083500*----------------------------------------------------------------*08350000
083600                                                                  08360000
083700 C400-REFRESH-PANEL-FROM-TEMP.                                    08370000
083800                                                                  08380000
083900     IF  RV100-NUMBER-PROCESSED-ITEMS NUMERIC                     08390000
084000         MOVE ZERO             TO  PV-SAVE-ITEM                   08400000
084100                                   PV-TSQ-B-ITEM                  08410000
084200         SET PS-NOT-END        TO TRUE                            08420000
084300         PERFORM C500-UPDATE-TSQ                                  08430000
084400             UNTIL PS-END-OF-ITEMS                                08440000
084500         PERFORM X900-DELETE-LIST-QUEUE                           08450000
084600         MOVE SPACES           TO  RV100-TSQB-QUEUE-NAME          08460000
084700     END-IF.                                                      08470000
084800                                                                  08480000
084900     PERFORM D400-REFRESH-BLOCK-ARRAY.                            08490000
085000     PERFORM E100-EDIT-SELECTIONS.                                08500000
085100                                                                  08510000
085200     SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE.                    08520000
085300     MOVE RV100-HOLD-TSQB-QUEUE-NAME                              08530000
085400                               TO  RV100-TSQB-QUEUE-NAME.         08540000
085500                                                                  08550000
085600 EJECT                                                            08560000
085700                                                                  08570000
085800*----------------------------------------------------------------*08580000
085900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *08590000
086000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *08600000
086100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *08610000
086200*    THE TEMP QUEUE.                                             *08620000
086300*                                                                *08630000
086400*    PERFORMED BY C400                                           *08640000
086500*----------------------------------------------------------------*08650000
086600                                                                  08660000
086700 C500-UPDATE-TSQ.                                                 08670000
086800                                                                  08680000
086900     ADD 1                     TO  PV-TSQ-B-ITEM.                 08690000
087000     PERFORM X600-READ-LIST-QUEUE.                                08700000
087100     IF  PV-RESP EQUAL DFHRESP(NORMAL)                            08710000
087200         SET RV101-IDX         TO  1                              08720000
087300         PERFORM C600-PROCESS-ITEMS                               08730000
087400             UNTIL RV101-RA-ARRAY (RV101-IDX) EQUAL SPACES        08740000
087500             OR RV101-IDX GREATER THAN RV101-RA-MAX-ITEMS         08750000
087600         PERFORM X550-WRITE-TS-QUEUE                              08760000
087700     ELSE                                                         08770000
087800         SET PS-END-OF-ITEMS   TO  TRUE.                          08780000
087900                                                                  08790000
088000 EJECT                                                            08800000
088100*----------------------------------------------------------------*08810000
088200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*08820000
088300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*08830000
088400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *08840000
088500*                                                                *08850000
088600*    PERFORMED BY C500                                           *08860000
088700*----------------------------------------------------------------*08870000
088800                                                                  08880000
088900 C600-PROCESS-ITEMS.                                              08890000
089000                                                                  08900000
089100     COMPUTE PV-ITEM = 1 + ((RV101-ITEM (RV101-IDX) - 1)          08910000
089200                     / PC-ITEMS-PER-BLOCK).                       08920000
089300                                                                  08930000
089400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           08940000
089500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          08950000
089600             PERFORM X550-WRITE-TS-QUEUE                          08960000
089700         END-IF                                                   08970000
089800         MOVE PV-ITEM          TO  PV-SAVE-ITEM                   08980000
089900                                                                  08990000
090000         PERFORM X300-READ-TS-QUEUE                               09000000
090100         IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                    09010000
090200             SET PS-END-OF-ITEMS TO TRUE                          09020000
090300         END-IF                                                   09030000
090400     END-IF.                                                      09040000
090500                                                                  09050000
090600     IF  PS-NOT-END                                               09060000
090700         COMPUTE PS-SUB = (RV101-ITEM (RV101-IDX)                 09070000
090800                        - PV-TW-LIST-ITEM-NUMBER (1)) + 1         09080000
090900         SET PV-TW-DESELECT (PS-SUB)                              09090000
091000                               TO  TRUE                           09100000
091100         EVALUATE TRUE                                            09110000
091200             WHEN RV101-INQ (RV101-IDX)                           09120000
091300                  MOVE PC-INQ  TO  PV-TW-ACTION (PS-SUB)          09130000
091400                                                                  09140000
091500             WHEN RV101-UPD (RV101-IDX)                           09150000
091600                  MOVE PC-UPD  TO  PV-TW-ACTION (PS-SUB)          09160000
091700                                                                  09170000
091800             WHEN RV101-DEL (RV101-IDX)                           09180000
091900                  MOVE PC-DEL  TO  PV-TW-ACTION (PS-SUB)          09190000
092000                                                                  09200000
092100             WHEN RV101-ERR (RV101-IDX)                           09210000
092200                  MOVE PC-ERR  TO  PV-TW-ACTION (PS-SUB)          09220000
092300         END-EVALUATE                                             09230000
092400                                                                  09240000
092500         SUBTRACT 1          FROM  RV100-NUMBER-PROCESSED-ITEMS   09250000
092600                                   RV100-NUMBER-OF-SELECTED-ITEMS 09260000
092700         IF  RV100-NUMBER-PROCESSED-ITEMS EQUAL ZERO              09270000
092800             SET PS-END-OF-ITEMS TO TRUE                          09280000
092900             SET RV101-IDX     TO  RV101-RA-MAX-ITEMS             09290000
093000         END-IF                                                   09300000
093100         SET RV101-IDX      UP BY  1                              09310000
093200     END-IF.                                                      09320000
093300                                                                  09330000
093400 EJECT                                                            09340000
093500*----------------------------------------------------------------*09350000
093600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *09360000
093700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *09370000
093800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *09380000
093900*    DISPLAY THE PANEL TO USER.                                  *09390000
094000*                                                                *09400000
094100*    PERFORMED BY B100-CONTROL-PROCESSING.                       *09410000
094200*    PERFORMED BY C300-PROCESS-PANEL.                            *09420000
094300*----------------------------------------------------------------*09430000
094400                                                                  09440000
094500 D100-SETUP-INIT-PANEL.                                           09450000
094600                                                                  09460000
094700     INITIALIZE                  RV100-BLOCK-ENTRIES (1).         09470000
094800     INITIALIZE                  RV100-BLOCK-ENTRIES (2).         09480000
094900     MOVE SPACES             TO  RV100-HOLD-TSQB-QUEUE-NAME.      09490000
095000     MOVE +1                 TO  RV100-BLK-SUB.                   09500000
095100     MOVE PC-ITEMS-PER-PANEL TO  PV-HIGHEST-ITEM-TO-BE-READ.      09510000
095200     SET RV100-ITEMS-LEFT-ON-DB                                   09520000
095300                             TO  TRUE.                            09530000
095400                                                                  09540000
095500     MOVE +0                 TO  RV100-ITEM-SUB                   09550000
095600                                 RV100-NUMBER-OF-ITEMS-READ       09560000
095700                                 RV100-NUMBER-OF-SELECTED-ITEMS   09570000
095800                                 RV100-HIGHEST-BLOCK-WRITTEN      09580000
095900                                 RV100-START-OF-SELECTED-RANGE    09590000
096000                                 RV100-END-OF-SELECTED-RANGE.     09600000
096100                                                                  09610000
096200     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       09620000
096300     MOVE DP017-EDITED-DATE-YYYYMMDD                              09630000
096400                               TO  RV100-DB2-CURRENT-DATE.        09640000
096500     SET RV100-DC-DASH1        TO  TRUE.                          09650000
096600     SET RV100-DC-DASH2        TO  TRUE.                          09660000
096700                                                                  09670000
096800     PERFORM D150-PREPARE-CURSOR.                                 09680000
096900                                                                  09690000
097000     PERFORM L100-OPEN-CURSOR.                                    09700000
097100                                                                  09710000
097200     PERFORM H100-READ-ITEMS-FROM-DB.                             09720000
097300     SET PS-DIFFERENT-ITEMS-DISPLAYED                             09730000
097400                             TO  TRUE.                            09740000
097500                                                                  09750000
097600     MOVE +1                 TO  RV100-ITEM-AT-TOP-OF-PANEL.      09760000
097700                                                                  09770000
097800     IF  PS-NO-LIST-ITEMS-FOUND                                   09780000
097900         CONTINUE                                                 09790000
098000     ELSE                                                         09800000
098100         PERFORM G100-DISPLAY-PANEL                               09810000
098200     END-IF.                                                      09820000
098300                                                                  09830000
098400 EJECT                                                            09840000
098500*----------------------------------------------------------------*09850000
098600*    SET UP THE HOST VARIABLES.                                  *09860000
098700*                                                                *09870000
098800*    PERFORMED BY D100                                           *09880000
098900*----------------------------------------------------------------*09890000
099000                                                                  09900000
099100 D150-PREPARE-CURSOR.                                             09910000
099200                                                                  09920000
099300     EVALUATE TRUE                                                09930000
099400                                                                  09940000
099500         WHEN RV100-RA-NUMBER GREATER THAN ZERO                   09950000
099600              SET RV100-RA-NUMBER-CSR                             09960000
099700                               TO  TRUE                           09970000
099800                                                                  09980000
099900         WHEN RV100-STATUS-CDE GREATER THAN SPACES                09990000
100000              SET RV100-STATUS-CSR                                10000000
100100                               TO  TRUE                           10010000
100200                                                                  10020000
100300         WHEN RV100-LOCATION  GREATER THAN SPACES                 10030000
100400              SET RV100-LOCATION-CSR                              10040000
100500                               TO  TRUE                           10050000
100600                                                                  10060000
100700         WHEN RV100-VENDOR-NAME GREATER THAN SPACES               10070000
100800              SET RV100-VENDOR-NAME-CSR                           10080000
100900                               TO  TRUE                           10090000
101000              MOVE RV100-VENDOR-NAME                              10100000
101100                               TO  PV-VENDOR-NAME                 10110000
101200              INSPECT PV-VENDOR-NAME                              10120000
101300                      REPLACING ALL '*' BY '%'                    10130000
101400                                ALL ' ' BY '%'                    10140000
101500     END-EVALUATE.                                                10150000
101600                                                                  10160000
101700 EJECT                                                            10170000
101800*----------------------------------------------------------------*10180000
101900*    IF THE USER HIT THE DESELECT KEY, OR A KEY WHICH INVOLVES   *10190000
102000*    LEAVING THIS TRANSACTION AND GOING TO ANOTHER, SET A FLAG   *10200000
102100*    INDICATING THAT ALL SELECTIONS ARE VALID.  IF ANY OTHER KEY *10210000
102200*    IS HIT, MOVE THE SELECTIONS MADE TO THE COMMAREA, AND EDIT  *10220000
102300*    THOSE SELECTIONS.                                           *10230000
102400*                                                                *10240000
102500*    IF THE USER ENTERED SOMETHING IN THE COMMAND LINE OR HIT    *10250000
102600*    AN INVALID FUNCTION KEY, DO NOT EDIT THE SELECTIONS.        *10260000
102700*                                                                *10270000
102800*    PERFORMED BY C300-PROCESS-PANEL.                            *10280000
102900*----------------------------------------------------------------*10290000
103000                                                                  10300000
103100 D200-RECORD-SELECTIONS.                                          10310000
103200                                                                  10320000
103300     SET RV100-NO-TSQ-UPDATE   TO  TRUE.                          10330000
103400                                                                  10340000
103500     IF (DP020-FK-DESELECT(DP020-SRC-AID))   OR                   10350000
103600        (DP020-FK-SELECT-ALL(DP020-SRC-AID)) OR                   10360000
103700        (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) OR                   10370000
103800        (DP020-FK-RETURN(DP020-SRC-AID))                          10380000
103900         SET PS-VALID-SELECTIONS TO TRUE                          10390000
104000     ELSE                                                         10400000
104100         PERFORM E200-MOVE-SELECTS-TO-COMMAREA                    10410000
104200         IF (DP020-SRC-AID EQUAL DP016-ENTER                      10420000
104300         AND DP020-NAV-MNEMONIC GREATER THAN SPACES)              10430000
104400             SET PS-VALID-SELECTIONS TO TRUE                      10440000
104500         ELSE                                                     10450000
104600             PERFORM E100-EDIT-SELECTIONS                         10460000
104700         END-IF                                                   10470000
104800     END-IF.                                                      10480000
104900                                                                  10490000
105000 EJECT                                                            10500000
105100*----------------------------------------------------------------*10510000
105200*    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION   *10520000
105300*    KEY HAD BEEN SELECTED BY THE USER.                          *10530000
105400*                                                                *10540000
105500*    PERFORMED BY C300-PROCESS-PANEL.                            *10550000
105600*----------------------------------------------------------------*10560000
105700                                                                  10570000
105800 D300-CHECK-FUNCTION-KEY.                                         10580000
105900                                                                  10590000
106000     EVALUATE TRUE                                                10600000
106100                                                                  10610000
106200         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  10620000
106300             IF  PS-CONTINUE                                      10630000
106400                 IF  RV100-NUMBER-OF-SELECTED-ITEMS > ZERO        10640000
106500                     PERFORM X100-PREPARE-LIST-QUEUE              10650000
106600                                                                  10660000
106700                     IF  PS-CONTINUE                              10670000
106800                         PERFORM E300-NAVIGATE                    10680000
106900                     ELSE                                         10690000
107000                         SET DP013-LOGIC-ABEND TO TRUE            10700000
107100                         SET DP013-NO-ROLLBACK TO TRUE            10710000
107200                         MOVE 'D300-CHECK-FUNCTION-KEY'           10720000
107300                               TO  DP013-PARAGRAPH                10730000
107400                         MOVE PM-PROGRAM-MESSAGE-28               10740000
107500                               TO  DP013-MESSAGE-TEXT(1)          10750000
107600                         PERFORM DP013-0000-PROCESS-ABEND         10760000
107700                     END-IF                                       10770000
107800                                                                  10780000
107900                 ELSE                                             10790000
108000                                                                  10800000
108100                     MOVE PC-TSYMSG-00057                         10810000
108200                               TO  DP020-MSG-NUMBER               10820000
108300                     SET DP020-MSG-WARNING                        10830000
108400                               TO TRUE                            10840000
108500                     PERFORM G100-DISPLAY-PANEL                   10850000
108600                 END-IF                                           10860000
108700             ELSE                                                 10870000
108800                 PERFORM G100-DISPLAY-PANEL                       10880000
108900             END-IF                                               10890000
109000                                                                  10900000
109100         WHEN DP020-FK-RETURN(DP020-SRC-AID)                      10910000
109200              PERFORM X900-DELETE-LIST-QUEUE                      10920000
109300              PERFORM E300-NAVIGATE                               10930000
109400                                                                  10940000
109500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10950000
109600              PERFORM E400-DISPLAY-TOP-OF-LIST                    10960000
109700                                                                  10970000
109800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10980000
109900              PERFORM E500-BROWSE-BACKWARD                        10990000
110000                                                                  11000000
110100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11010000
110200              PERFORM E600-BROWSE-FORWARD                         11020000
110300                                                                  11030000
110400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11040000
110500              PERFORM E700-DESELECT-ALL-ITEMS                     11050000
110600                                                                  11060000
110700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11070000
110800              PERFORM E900-SELECT-ALL-ITEMS                       11080000
110900                                                                  11090000
111000         WHEN DP020-SRC-AID = DP016-ENTER                         11100000
111100              IF  DP020-NAV-MNEMONIC GREATER THAN SPACES          11110000
111200                  PERFORM E300-NAVIGATE                           11120000
111300              ELSE                                                11130000
111400                  PERFORM E800-CHECK-FOR-JUMP-BROWSE              11140000
111500              END-IF                                              11150000
111600                                                                  11160000
111700         WHEN OTHER                                               11170000
111800              MOVE PC-TSYMSG-00045                                11180000
111900                               TO  DP020-MSG-NUMBER               11190000
112000              SET DP020-MSG-FATAL                                 11200000
112100                               TO  TRUE                           11210000
112200              PERFORM G100-DISPLAY-PANEL                          11220000
112300                                                                  11230000
112400     END-EVALUATE.                                                11240000
112500                                                                  11250000
112600 EJECT                                                            11260000
112700*----------------------------------------------------------------*11270000
112800*    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,*11280000
112900*    READ TEMPORARY STORAGE FILLING IN BOTH BLOCKS IN THE ARRAY  *11290000
113000*    WITH THE ITEMS THAT WERE AT THE TOP OF THE LIST WHEN WE     *11300000
113100*    HAD LEFT PREVIOUSLY.                                        *11310000
113200*                                                                *11320000
113300*    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                  *11330000
113400*----------------------------------------------------------------*11340000
113500                                                                  11350000
113600 D400-REFRESH-BLOCK-ARRAY.                                        11360000
113700                                                                  11370000
113800     COMPUTE PV-TEMP-BLOCK-NUMBER =                               11380000
113900         1 + ((RV100-LIST-ITEM-NUMBER(1 1) - 1) /                 11390000
114000               PC-ITEMS-PER-BLOCK).                               11400000
114100                                                                  11410000
114200     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                11420000
114300     MOVE +1                   TO RV100-BLK-SUB.                  11430000
114400                                                                  11440000
114500     PERFORM Z100-READ-TEMP-STORAGE.                              11450000
114600                                                                  11460000
114700     ADD +1 TO PV-BLOCK-NUMBER.                                   11470000
114800                                                                  11480000
114900     IF (PV-BLOCK-NUMBER < RV100-HIGHEST-BLOCK-WRITTEN) OR        11490000
115000        (PV-BLOCK-NUMBER = RV100-HIGHEST-BLOCK-WRITTEN)           11500000
115100         ADD +1 TO RV100-BLK-SUB                                  11510000
115200                                                                  11520000
115300         PERFORM Z100-READ-TEMP-STORAGE                           11530000
115400     END-IF.                                                      11540000
115500                                                                  11550000
115600 EJECT                                                            11560000
115700*----------------------------------------------------------------*11570000
115800*    EDIT EACH SELECTION ENTRY.  IF EACH ENTRY IS CONSIDERED     *11580000
115900*    VALID, CHECK IF A BEGINNING AND ENDING ENTRY WAS ENTERED,   *11590000
116000*    AND CHECK THE FOLLOWING.                                    *11600000
116100*                                                                *11610000
116200*    1) IF THERE IS A BEGINNING RANGE, THERE MUST BE AN ENDING.  *11620000
116300*    2) IF THERE IS A ENDING RANGE, THERE MUST BE AN BEGINNING.  *11630000
116400*    3) BEGINNING RANGE MUST PRECEDE ENDING RANGE.               *11640000
116500*                                                                *11650000
116600*    IF A VALID BEGINNING AND ENDING RANGE HAVE BEEN SELECTED,   *11660000
116700*    MARK ALL ITEMS IN THAT RANGE AS BEING SELECTED.             *11670000
116800*                                                                *11680000
116900*    PERFORMED BY B100-CONTROL-PROCESSING.                       *11690000
117000*    PERFORMED BY C300-PROCESS-PANEL.                            *11700000
117100*    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                  *11710000
117200*    PERFORMED BY D200-RECORD-SELECTIONS.                        *11720000
117300*----------------------------------------------------------------*11730000
117400                                                                  11740000
117500 E100-EDIT-SELECTIONS.                                            11750000
117600                                                                  11760000
117700     SET PS-VALID-SELECTIONS TO TRUE.                             11770000
117800                                                                  11780000
117900     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            11790000
118000         (RV100-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   11800000
118100     MOVE RV100-ITEM-AT-TOP-OF-PANEL                              11810000
118200                               TO  PV-ITEM-IN-USE.                11820000
118300     MOVE +1                   TO  PS-SUB.                        11830000
118400                                                                  11840000
118500     PERFORM F100-EDIT                                            11850000
118600         UNTIL (PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL)         11860000
118700            OR (PV-ITEM-IN-USE > RV100-NUMBER-OF-ITEMS-READ).     11870000
118800                                                                  11880000
118900     IF  PS-VALID-SELECTIONS                                      11890000
119000         IF  RV100-START-OF-SELECTED-RANGE GREATER ZERO           11900000
119100             IF  RV100-END-OF-SELECTED-RANGE GREATER              11910000
119200                 RV100-START-OF-SELECTED-RANGE                    11920000
119300                 PERFORM F200-MARK-RANGE-AS-SELECTED              11930000
119400             ELSE                                                 11940000
119500                                                                  11950000
119600                 IF  RV100-END-OF-SELECTED-RANGE = +0             11960000
119700                     SET PS-CURSOR-POSITIONED                     11970000
119800                               TO  TRUE                           11980000
119900                     SET PS-WARNING                               11990000
120000                               TO  TRUE                           12000000
120100                     MOVE PC-TSYMSG-00051                         12010000
120200                               TO  DP020-MSG-NUMBER               12020000
120300                     IF  NOT DP020-NEXT-ACT-ERROR                 12030000
120400                         SET DP020-MSG-WARNING TO TRUE            12040000
120500                     END-IF                                       12050000
120600                 ELSE                                             12060000
120700                                                                  12070000
120800                     SET PS-CURSOR-POSITIONED                     12080000
120900                               TO  TRUE                           12090000
121000                     SET PS-INVALID-SELECTIONS                    12100000
121100                               TO  TRUE                           12110000
121200                     SET DP020-MSG-FATAL                          12120000
121300                               TO  TRUE                           12130000
121400                     MOVE PC-TSYMSG-00052                         12140000
121500                               TO  DP020-MSG-NUMBER               12150000
121600                     IF  NOT DP020-NEXT-ACT-ERROR                 12160000
121700                         MOVE RV100-ITEM-AT-TOP-OF-PANEL          12170000
121800                               TO  PV-ITEM-IN-USE                 12180000
121900                         MOVE +1                                  12190000
122000                               TO  PS-SUB                         12200000
122100                                                                  12210000
122200                         PERFORM                                  12220000
122300                             UNTIL (PV-ITEM-IN-USE >              12230000
122400                                    PV-ENDING-ITEM-ON-PANEL)      12240000
122500                                OR (PV-ITEM-IN-USE >              12250000
122600                                    RV100-NUMBER-OF-ITEMS-READ)   12260000
122700                                                                  12270000
122800                             PERFORM K100-SET-SUBSCRIPTS          12280000
122900                             IF (RV100-BEGIN(RV100-BLK-SUB        12290000
123000                                             RV100-ITEM-SUB))     12300000
123100                             OR (RV100-END(RV100-BLK-SUB          12310000
123200                                           RV100-ITEM-SUB))       12320000
123300                                 MOVE -1                          12330000
123400                                    TO  RVKM100-SELECTL(PS-SUB)   12340000
123500                                 MOVE PV-ENDING-ITEM-ON-PANEL     12350000
123600                                    TO  PV-ITEM-IN-USE            12360000
123700                             END-IF                               12370000
123800                             ADD +1 TO  PS-SUB                    12380000
123900                             ADD +1 TO  PV-ITEM-IN-USE            12390000
124000                         END-PERFORM                              12400000
124100                                                                  12410000
124200                     END-IF                                       12420000
124300                 END-IF                                           12430000
124400             END-IF                                               12440000
124500         ELSE                                                     12450000
124600                                                                  12460000
124700             IF RV100-END-OF-SELECTED-RANGE > +0                  12470000
124800                 SET PS-CURSOR-POSITIONED TO TRUE                 12480000
124900                 SET PS-WARNING           TO TRUE                 12490000
125000                 MOVE PC-TSYMSG-00053                             12500000
125100                               TO  DP020-MSG-NUMBER               12510000
125200                 IF NOT DP020-NEXT-ACT-ERROR                      12520000
125300                     SET DP020-MSG-WARNING TO TRUE                12530000
125400                 END-IF                                           12540000
125500             END-IF                                               12550000
125600         END-IF                                                   12560000
125700     END-IF.                                                      12570000
125800                                                                  12580000
125900     IF  DP020-MSG-SEVERITY-IND GREATER THAN SPACES               12590000
126000         SET PS-DONT-PROCESS   TO  TRUE                           12600000
126100     END-IF.                                                      12610000
126200                                                                  12620000
126300 EJECT                                                            12630000
126400*----------------------------------------------------------------*12640000
126500*    MOVE THE SELECTIONS MADE FROM THE CURRENT PAGE INTO         *12650000
126600*    THE COMMAREA.                                               *12660000
126700*                                                                *12670000
126800*    PERFORMED BY D200-RECORD-SELECTIONS.                        *12680000
126900*----------------------------------------------------------------*12690000
127000                                                                  12700000
127100 E200-MOVE-SELECTS-TO-COMMAREA.                                   12710000
127200                                                                  12720000
127300     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            12730000
127400         (RV100-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   12740000
127500                                                                  12750000
127600     MOVE +1                         TO PS-SUB.                   12760000
127700     MOVE RV100-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.           12770000
127800                                                                  12780000
127900     PERFORM F300-CHECK-SELECTIONS                                12790000
128000         UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          12800000
128100                                                                  12810000
128200 EJECT                                                            12820000
128300*----------------------------------------------------------------*12830000
128400*    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER    *12840000
128500*    TRANSACTION, WRITE OUT THE LAST 2 BLOCKS FROM THE ARRAY TO  *12850000
128600*    TEMPORARY STORAGE, SET UP THE INTER APPLICATION COMMAREA,   *12860000
128700*    AND START THE NAVIGATOR.                                    *12870000
128800*                                                                *12880000
128900*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *12890000
129000*----------------------------------------------------------------*12900000
129100                                                                  12910000
129200 E300-NAVIGATE.                                                   12920000
129300                                                                  12930000
129400     MOVE +1 TO RV100-BLK-SUB.                                    12940000
129500     PERFORM Z150-WRITE-TEMP-STORAGE.                             12950000
129600                                                                  12960000
129700     ADD +1 TO RV100-BLK-SUB.                                     12970000
129800     PERFORM Z150-WRITE-TEMP-STORAGE.                             12980000
129900                                                                  12990000
130000     MOVE INTER-APPL-COMM-AREA TO  RV100-SAVE-APPL-COMMAREA.      13000000
130100                                                                  13010000
130200     PERFORM DP015-1000-START-NAVIGATOR.                          13020000
130300                                                                  13030000
130400 EJECT                                                            13040000
130500*----------------------------------------------------------------*13050000
130600*    IF THE USER HITS THE 1ST PAGE KEY, COMPUTE THE TOP ITEM     *13060000
130700*    NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM          *13070000
130800*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS *13080000
130900*    TO BE READ.                                                 *13090000
131000*                                                                *13100000
131100*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *13110000
131200*----------------------------------------------------------------*13120000
131300                                                                  13130000
131400 E400-DISPLAY-TOP-OF-LIST.                                        13140000
131500                                                                  13150000
131600     IF  RV100-NUMBER-OF-ITEMS-READ > +0                          13160000
131700         MOVE +1 TO PV-TOP-ITEM                                   13170000
131800         PERFORM F500-BROWSE                                      13180000
131900     ELSE                                                         13190000
132000         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13200000
132100         PERFORM G100-DISPLAY-PANEL                               13210000
132200     END-IF.                                                      13220000
132300                                                                  13230000
132400 EJECT                                                            13240000
132500*----------------------------------------------------------------*13250000
132600*    IF THE USER HITS THE PAGE BACKARD KEY, COMPUTE THE TOP      *13260000
132700*    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM     *13270000
132800*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS *13280000
132900*    TO BE READ.                                                 *13290000
133000*                                                                *13300000
133100*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *13310000
133200*----------------------------------------------------------------*13320000
133300                                                                  13330000
133400 E500-BROWSE-BACKWARD.                                            13340000
133500                                                                  13350000
133600     IF  RV100-NUMBER-OF-ITEMS-READ > +0                          13360000
133700         COMPUTE PV-TOP-ITEM =                                    13370000
133800             RV100-ITEM-AT-TOP-OF-PANEL - PC-ITEMS-PER-PANEL      13380000
133900         PERFORM F500-BROWSE                                      13390000
134000     ELSE                                                         13400000
134100         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13410000
134200         PERFORM G100-DISPLAY-PANEL                               13420000
134300     END-IF.                                                      13430000
134400                                                                  13440000
134500 EJECT                                                            13450000
134600*----------------------------------------------------------------*13460000
134700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13470000
134800*    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM     *13480000
134900*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS *13490000
135000*    TO BE READ.                                                 *13500000
135100*                                                                *13510000
135200*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *13520000
135300*----------------------------------------------------------------*13530000
135400                                                                  13540000
135500 E600-BROWSE-FORWARD.                                             13550000
135600                                                                  13560000
135700     IF  RV100-NUMBER-OF-ITEMS-READ > +0                          13570000
135800         COMPUTE PV-TOP-ITEM =                                    13580000
135900             RV100-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL      13590000
136000         PERFORM F500-BROWSE                                      13600000
136100     ELSE                                                         13610000
136200         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13620000
136300         PERFORM G100-DISPLAY-PANEL                               13630000
136400     END-IF.                                                      13640000
136500                                                                  13650000
136600 EJECT                                                            13660000
136700*----------------------------------------------------------------*13670000
136800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13680000
136900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13690000
137000*                                                                *13700000
137100*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *13710000
137200*----------------------------------------------------------------*13720000
137300                                                                  13730000
137400 E700-DESELECT-ALL-ITEMS.                                         13740000
137500                                                                  13750000
137600     IF  RV100-NUMBER-OF-ITEMS-READ > +0                          13760000
137700         MOVE +1               TO  RV100-BLK-SUB                  13770000
137800                                                                  13780000
137900         PERFORM F600-CLEAR-SELECTED-INDS                         13790000
138000             VARYING RV100-ITEM-SUB FROM 1 BY 1                   13800000
138100             UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK            13810000
138200                                                                  13820000
138300         ADD +1                TO  RV100-BLK-SUB                  13830000
138400                                                                  13840000
138500         PERFORM F600-CLEAR-SELECTED-INDS                         13850000
138600             VARYING RV100-ITEM-SUB FROM 1 BY 1                   13860000
138700             UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK            13870000
138800                                                                  13880000
138900         MOVE RV100-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER  13890000
139000                                                                  13900000
139100         COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                        13910000
139200             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK) 13920000
139300                                                                  13930000
139400         IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                 13940000
139500            (RV100-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13950000
139600             MOVE +1 TO RV100-BLK-SUB                             13960000
139700                                                                  13970000
139800             PERFORM Z150-WRITE-TEMP-STORAGE                      13980000
139900                                                                  13990000
140000             MOVE +1 TO PV-BLOCK-NUMBER                           14000000
140100                                                                  14010000
140200             COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     14020000
140300                 PV-FIRST-BLOCK-IN-ARRAY - 1                      14030000
140400                                                                  14040000
140500             PERFORM                                              14050000
140600                 UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY   14060000
140700                                                                  14070000
140800                 PERFORM Z100-READ-TEMP-STORAGE                   14080000
140900                                                                  14090000
141000                 PERFORM F600-CLEAR-SELECTED-INDS                 14100000
141100                     VARYING RV100-ITEM-SUB FROM 1 BY 1           14110000
141200                     UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK    14120000
141300                                                                  14130000
141400                 PERFORM Z150-WRITE-TEMP-STORAGE                  14140000
141500                                                                  14150000
141600                 ADD +1 TO PV-BLOCK-NUMBER                        14160000
141700                                                                  14170000
141800             END-PERFORM                                          14180000
141900                                                                  14190000
142000             COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     14200000
142100                 PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 14210000
142200                                                                  14220000
142300             PERFORM                                              14230000
142400                 UNTIL PV-NEXT-BLOCK-IN-ARRAY >                   14240000
142500                       RV100-HIGHEST-BLOCK-WRITTEN                14250000
142600                                                                  14260000
142700                 MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   14270000
142800                                                                  14280000
142900                 PERFORM Z100-READ-TEMP-STORAGE                   14290000
143000                                                                  14300000
143100                 PERFORM F600-CLEAR-SELECTED-INDS                 14310000
143200                     VARYING RV100-ITEM-SUB FROM 1 BY 1           14320000
143300                     UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK    14330000
143400                                                                  14340000
143500                 PERFORM Z150-WRITE-TEMP-STORAGE                  14350000
143600                                                                  14360000
143700                 ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 14370000
143800                                                                  14380000
143900             END-PERFORM                                          14390000
144000                                                                  14400000
144100             MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      14410000
144200                                                                  14420000
144300             PERFORM Z100-READ-TEMP-STORAGE                       14430000
144400         END-IF                                                   14440000
144500                                                                  14450000
144600     END-IF.                                                      14460000
144700                                                                  14470000
144800     MOVE +0 TO RV100-NUMBER-OF-SELECTED-ITEMS.                   14480000
144900     MOVE +0 TO RV100-START-OF-SELECTED-RANGE.                    14490000
145000     MOVE +0 TO RV100-END-OF-SELECTED-RANGE.                      14500000
145100                                                                  14510000
145200     SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                         14520000
145300                                                                  14530000
145400     PERFORM G100-DISPLAY-PANEL.                                  14540000
145500                                                                  14550000
145600 EJECT                                                            14560000
145700*----------------------------------------------------------------*14570000
145800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14580000
145900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14590000
146000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14600000
146100*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *14610000
146200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14620000
146300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14630000
146400*                                                                *14640000
146500*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *14650000
146600*----------------------------------------------------------------*14660000
146700                                                                  14670000
146800 E800-CHECK-FOR-JUMP-BROWSE.                                      14680000
146900                                                                  14690000
147000     SET PS-VALID-BEG-ITEM TO TRUE.                               14700000
147100                                                                  14710000
147200     IF (ASTRTITA                   = PC-ERASE-EOF) OR            14720000
147300        (RV100-NUMBER-OF-ITEMS-READ = +0)                         14730000
147400         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      14740000
147500         PERFORM G100-DISPLAY-PANEL                               14750000
147600     ELSE                                                         14760000
147700                                                                  14770000
147800         MOVE ASTRTITI         TO  DP010I-UNEDITED-FIELD          14780000
147900         MOVE PC-FIELD-LENGTH  TO  DP010I-MAXIMUM-DIGITS          14790000
148000         MOVE +0               TO  DP010I-MAXIMUM-DECIMALS        14800000
148100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14810000
148200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14820000
148300              USING DP010I-NUMERIC-EDIT-AREA                      14830000
148400                                                                  14840000
148500         IF  NOT DP010I-ERROR-DETECTED                            14850000
148600             MOVE DP010I-NUMERIC-FIELD                            14860000
148700                               TO  PV-BEGITMI-N                   14870000
148800             MOVE PV-BEGITMI-N TO  PV-BEGINNING-ITEM              14880000
148900                                                                  14890000
149000             IF (PV-BEGINNING-ITEM >  0)          AND             14900000
149100                (PV-BEGINNING-ITEM <  PC-MAX-ITEMS)               14910000
149200                 MOVE PV-BEGINNING-ITEM TO PV-TOP-ITEM            14920000
149300                                                                  14930000
149400                 COMPUTE PV-MAX-ITEMS-TO-BE-READ =                14940000
149500                     ((RV100-NUMBER-OF-ITEMS-READ +               14950000
149600                       PC-MAX-ITEMS-TO-BE-READ)   -               14960000
149700                       PC-ITEMS-PER-PANEL)        + 1             14970000
149800                                                                  14980000
149900                 IF PV-TOP-ITEM > PV-MAX-ITEMS-TO-BE-READ         14990000
150000                     MOVE PV-MAX-ITEMS-TO-BE-READ                 15000000
150100                               TO  PV-TOP-ITEM                    15010000
150200                     MOVE -1   TO  ASTRTITL                       15020000
150300                                                                  15030000
150400                     IF RV100-NO-ITEMS-LEFT-ON-DB                 15040000
150500                         MOVE PC-TSYMSG-00070                     15050000
150600                               TO  DP020-MSG-NUMBER               15060000
150700                     ELSE                                         15070000
150800                         MOVE PC-TSYMSG-00207                     15080000
150900                               TO  DP020-MSG-NUMBER               15090000
151000                     END-IF                                       15100000
151100                                                                  15110000
151200                     SET PS-CURSOR-POSITIONED                     15120000
151300                               TO  TRUE                           15130000
151400                     SET DP020-MSG-INFORMATIONAL                  15140000
151500                               TO  TRUE                           15150000
151600                 END-IF                                           15160000
151700                 PERFORM F500-BROWSE                              15170000
151800             ELSE                                                 15180000
151900                 MOVE PC-TSYMSG-00101                             15190000
152000                               TO  DP020-MSG-NUMBER               15200000
152100                 MOVE -1       TO  ASTRTITL                       15210000
152200                 MOVE DP015-REVERSE                               15220000
152300                               TO  ASTRTITH                       15230000
152400                 MOVE DP015-RED                                   15240000
152500                               TO  ASTRTITC                       15250000
152600                 MOVE DP015-UNP-NUM-BRT-MDT                       15260000
152700                               TO  ASTRTITA                       15270000
152800                 SET PS-CURSOR-POSITIONED                         15280000
152900                               TO  TRUE                           15290000
153000                 SET DP020-MSG-FATAL                              15300000
153100                               TO  TRUE                           15310000
153200                 SET PS-INVALID-BEG-ITEM                          15320000
153300                               TO  TRUE                           15330000
153400             END-IF                                               15340000
153500                                                                  15350000
153600         ELSE                                                     15360000
153700             MOVE PC-TSYMSG-00008                                 15370000
153800                               TO  DP020-MSG-NUMBER               15380000
153900             MOVE -1           TO  ASTRTITL                       15390000
154000             MOVE DP015-REVERSE                                   15400000
154100                               TO  ASTRTITH                       15410000
154200             MOVE DP015-RED    TO  ASTRTITC                       15420000
154300             MOVE DP015-UNP-NUM-BRT-MDT                           15430000
154400                               TO  ASTRTITA                       15440000
154500             SET PS-CURSOR-POSITIONED                             15450000
154600                               TO  TRUE                           15460000
154700             SET DP020-MSG-FATAL                                  15470000
154800                               TO  TRUE                           15480000
154900             SET PS-INVALID-BEG-ITEM                              15490000
155000                               TO  TRUE                           15500000
155100         END-IF                                                   15510000
155200     END-IF.                                                      15520000
155300                                                                  15530000
155400     IF  PS-INVALID-BEG-ITEM                                      15540000
155500         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      15550000
155600         PERFORM DP017-0000-GET-CURR-DATE-TIME                    15560000
155700         PERFORM I200-FORMAT-LIST-LINES                           15570000
155800         PERFORM I300-FORMAT-NR-SELECTED                          15580000
155900         PERFORM DP005-0000-FORMAT-MSG-LINES                      15590000
156000         PERFORM DP008-0000-WRITE-PANEL                           15600000
156100     END-IF.                                                      15610000
156200                                                                  15620000
156300 EJECT                                                            15630000
156400*----------------------------------------------------------------*15640000
156500*    IF THE USER HITS THE SELECT KEY, SET THE SELECTION SWITCH   *15650000
156600*    FOR ALL ITEMS.                                              *15660000
156700*                                                                *15670000
156800*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                       *15680000
156900*----------------------------------------------------------------*15690000
157000                                                                  15700000
157100 E900-SELECT-ALL-ITEMS.                                           15710000
157200                                                                  15720000
157300     IF  RV100-NUMBER-OF-ITEMS-READ > +0                          15730000
157400         MOVE +1 TO RV100-BLK-SUB                                 15740000
157500                                                                  15750000
157600         PERFORM F700-SET-SELECTED-INDS                           15760000
157700             VARYING RV100-ITEM-SUB FROM 1 BY 1                   15770000
157800             UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK            15780000
157900                                                                  15790000
158000         ADD +1 TO RV100-BLK-SUB                                  15800000
158100                                                                  15810000
158200         PERFORM F700-SET-SELECTED-INDS                           15820000
158300             VARYING RV100-ITEM-SUB FROM 1 BY 1                   15830000
158400             UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK            15840000
158500                                                                  15850000
158600         MOVE RV100-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER  15860000
158700                                                                  15870000
158800         COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                        15880000
158900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK) 15890000
159000                                                                  15900000
159100         IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                 15910000
159200            (RV100-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)15920000
159300             MOVE +1 TO RV100-BLK-SUB                             15930000
159400                                                                  15940000
159500             PERFORM Z150-WRITE-TEMP-STORAGE                      15950000
159600                                                                  15960000
159700             MOVE +1 TO PV-BLOCK-NUMBER                           15970000
159800                                                                  15980000
159900             COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     15990000
160000                 PV-FIRST-BLOCK-IN-ARRAY - 1                      16000000
160100                                                                  16010000
160200             PERFORM                                              16020000
160300                 UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY   16030000
160400                                                                  16040000
160500                 PERFORM Z100-READ-TEMP-STORAGE                   16050000
160600                                                                  16060000
160700                 PERFORM F700-SET-SELECTED-INDS                   16070000
160800                     VARYING RV100-ITEM-SUB FROM 1 BY 1           16080000
160900                     UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK    16090000
161000                                                                  16100000
161100                 PERFORM Z150-WRITE-TEMP-STORAGE                  16110000
161200                                                                  16120000
161300                 ADD +1 TO PV-BLOCK-NUMBER                        16130000
161400                                                                  16140000
161500             END-PERFORM                                          16150000
161600                                                                  16160000
161700             COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     16170000
161800                 PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 16180000
161900                                                                  16190000
162000             PERFORM                                              16200000
162100                 UNTIL PV-NEXT-BLOCK-IN-ARRAY >                   16210000
162200                       RV100-HIGHEST-BLOCK-WRITTEN                16220000
162300                                                                  16230000
162400                 MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   16240000
162500                                                                  16250000
162600                 PERFORM Z100-READ-TEMP-STORAGE                   16260000
162700                                                                  16270000
162800                 PERFORM F700-SET-SELECTED-INDS                   16280000
162900                     VARYING RV100-ITEM-SUB FROM 1 BY 1           16290000
163000                     UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK    16300000
163100                                                                  16310000
163200                 PERFORM Z150-WRITE-TEMP-STORAGE                  16320000
163300                                                                  16330000
163400                 ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 16340000
163500                                                                  16350000
163600             END-PERFORM                                          16360000
163700                                                                  16370000
163800             MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      16380000
163900                                                                  16390000
164000             PERFORM Z100-READ-TEMP-STORAGE                       16400000
164100         END-IF                                                   16410000
164200                                                                  16420000
164300     END-IF.                                                      16430000
164400                                                                  16440000
164500     MOVE RV100-NUMBER-OF-ITEMS-READ TO                           16450000
164600                       RV100-NUMBER-OF-SELECTED-ITEMS.            16460000
164700                                                                  16470000
164800     SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                         16480000
164900                                                                  16490000
165000     PERFORM G100-DISPLAY-PANEL.                                  16500000
165100                                                                  16510000
165200 EJECT                                                            16520000
165300*----------------------------------------------------------------*16530000
165400*    EDIT THE SELECTION ENTRIES.                                 *16540000
165500*                                                                *16550000
165600*    1) VALID ENTRIES ARE 'S' 'B' OR 'E'.                        *16560000
165700*    2) THERE CAN ONLY BE 1 BEGINNING AND 1 ENDING RANGE.        *16570000
165800*                                                                *16580000
165900*    PERFORMED BY E100-EDIT-SELECTIONS.                          *16590000
166000*----------------------------------------------------------------*16600000
166100                                                                  16610000
166200 F100-EDIT.                                                       16620000
166300                                                                  16630000
166400     PERFORM K100-SET-SUBSCRIPTS.                                 16640000
166500                                                                  16650000
166600     IF NOT (RV100-NO-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)) AND   16660000
166700        NOT (RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB))          16670000
166800                                                                  16680000
166900         IF  RV100-BEGIN(RV100-BLK-SUB RV100-ITEM-SUB)            16690000
167000             IF  RV100-START-OF-SELECTED-RANGE                    16700000
167100                 NOT EQUAL PV-ITEM-IN-USE                         16710000
167200                                                                  16720000
167300                 IF  RV100-START-OF-SELECTED-RANGE = +0           16730000
167400                     MOVE PV-ITEM-IN-USE                          16740000
167500                               TO  RV100-START-OF-SELECTED-RANGE  16750000
167600                 ELSE                                             16760000
167700                     IF PS-VALID-SELECTIONS                       16770000
167800                         MOVE PC-TSYMSG-00054                     16780000
167900                               TO  DP020-MSG-NUMBER               16790000
168000                         IF  NOT DP020-NEXT-ACT-ERROR             16800000
168100                             MOVE -1                              16810000
168200                               TO  RVKM100-SELECTL(PS-SUB)        16820000
168300                         END-IF                                   16830000
168400                     END-IF                                       16840000
168500                                                                  16850000
168600                     SET DP020-MSG-FATAL                          16860000
168700                               TO  TRUE                           16870000
168800                     SET PS-INVALID-SELECTIONS                    16880000
168900                               TO  TRUE                           16890000
169000                     SET PS-CURSOR-POSITIONED                     16900000
169100                               TO  TRUE                           16910000
169200                 END-IF                                           16920000
169300             END-IF                                               16930000
169400         ELSE                                                     16940000
169500                                                                  16950000
169600             IF  RV100-END(RV100-BLK-SUB RV100-ITEM-SUB)          16960000
169700                 IF  RV100-END-OF-SELECTED-RANGE                  16970000
169800                     NOT EQUAL PV-ITEM-IN-USE                     16980000
169900                                                                  16990000
170000                     IF RV100-END-OF-SELECTED-RANGE = +0          17000000
170100                         MOVE PV-ITEM-IN-USE                      17010000
170200                               TO  RV100-END-OF-SELECTED-RANGE    17020000
170300                     ELSE                                         17030000
170400                                                                  17040000
170500                         IF  PS-VALID-SELECTIONS                  17050000
170600                             MOVE PC-TSYMSG-00055                 17060000
170700                               TO  DP020-MSG-NUMBER               17070000
170800                                                                  17080000
170900                             IF  NOT DP020-NEXT-ACT-ERROR         17090000
171000                                 MOVE -1                          17100000
171100                                    TO  RVKM100-SELECTL(PS-SUB)   17110000
171200                             END-IF                               17120000
171300                         END-IF                                   17130000
171400                         SET PS-INVALID-SELECTIONS                17140000
171500                                    TO  TRUE                      17150000
171600                         SET PS-CURSOR-POSITIONED                 17160000
171700                                    TO  TRUE                      17170000
171800                         SET DP020-MSG-FATAL                      17180000
171900                                    TO  TRUE                      17190000
172000                     END-IF                                       17200000
172100                 END-IF                                           17210000
172200             ELSE                                                 17220000
172300                                                                  17230000
172400                 IF  PS-VALID-SELECTIONS                          17240000
172500                     MOVE PC-TSYMSG-00005                         17250000
172600                               TO  DP020-MSG-NUMBER               17260000
172700                     IF  NOT DP020-NEXT-ACT-ERROR                 17270000
172800                         MOVE -1                                  17280000
172900                               TO  RVKM100-SELECTL(PS-SUB)        17290000
173000                     END-IF                                       17300000
173100                 END-IF                                           17310000
173200                 SET PS-INVALID-SELECTIONS                        17320000
173300                               TO  TRUE                           17330000
173400                 SET PS-CURSOR-POSITIONED                         17340000
173500                               TO  TRUE                           17350000
173600                 SET DP020-MSG-FATAL                              17360000
173700                               TO  TRUE                           17370000
173800                 MOVE DP015-RED                                   17380000
173900                               TO  RVKM100-SELECTC(PS-SUB)        17390000
174000                 MOVE DP015-REVERSE                               17400000
174100                               TO  RVKM100-SELECTH(PS-SUB)        17410000
174200             END-IF                                               17420000
174300         END-IF                                                   17430000
174400     END-IF.                                                      17440000
174500                                                                  17450000
174600     ADD +1                    TO  PV-ITEM-IN-USE.                17460000
174700     ADD +1                    TO  PS-SUB.                        17470000
174800                                                                  17480000
174900 EJECT                                                            17490000
175000*----------------------------------------------------------------*17500000
175100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17510000
175200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17520000
175300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17530000
175400*                                                                *17540000
175500*    PERFORMED BY E100-EDIT-SELECTIONS.                          *17550000
175600*----------------------------------------------------------------*17560000
175700                                                                  17570000
175800 F200-MARK-RANGE-AS-SELECTED.                                     17580000
175900                                                                  17590000
176000     MOVE +1                   TO  RV100-BLK-SUB.                 17600000
176100     PERFORM G200-MARK-SELECTED-INDS                              17610000
176200         VARYING RV100-ITEM-SUB FROM 1 BY 1                       17620000
176300         UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK.               17630000
176400                                                                  17640000
176500     ADD +1 TO RV100-BLK-SUB.                                     17650000
176600     PERFORM G200-MARK-SELECTED-INDS                              17660000
176700         VARYING RV100-ITEM-SUB FROM 1 BY 1                       17670000
176800         UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK.               17680000
176900                                                                  17690000
177000     MOVE RV100-LIST-ITEM-NUMBER(1 1)                             17700000
177100                               TO  PV-LIST-ITEM-NUMBER.           17710000
177200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17720000
177300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17730000
177400               PC-ITEMS-PER-BLOCK).                               17740000
177500                                                                  17750000
177600     MOVE RV100-START-OF-SELECTED-RANGE                           17760000
177700                               TO  PV-START-OF-SELECTED-RANGE.    17770000
177800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17780000
177900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17790000
178000               PC-ITEMS-PER-BLOCK).                               17800000
178100                                                                  17810000
178200     MOVE RV100-END-OF-SELECTED-RANGE                             17820000
178300                               TO  PV-END-OF-SELECTED-RANGE.      17830000
178400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17840000
178500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17850000
178600               PC-ITEMS-PER-BLOCK).                               17860000
178700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17870000
178800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17880000
178900                                                                  17890000
179000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17900000
179100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17910000
179200         MOVE +1               TO  RV100-BLK-SUB                  17920000
179300         PERFORM Z150-WRITE-TEMP-STORAGE                          17930000
179400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17940000
179500             PV-FIRST-BLOCK-IN-ARRAY - 1                          17950000
179600                                                                  17960000
179700         PERFORM                                                  17970000
179800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17980000
179900                   PV-PREV-BLOCK-IN-ARRAY                         17990000
180000             MOVE PV-FIRST-BLOCK-IN-RANGE                         18000000
180100                               TO  PV-BLOCK-NUMBER                18010000
180200             PERFORM Z100-READ-TEMP-STORAGE                       18020000
180300             PERFORM G200-MARK-SELECTED-INDS                      18030000
180400                 VARYING RV100-ITEM-SUB FROM 1 BY 1               18040000
180500                 UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK        18050000
180600             PERFORM Z150-WRITE-TEMP-STORAGE                      18060000
180700             ADD +1            TO PV-FIRST-BLOCK-IN-RANGE         18070000
180800         END-PERFORM                                              18080000
180900                                                                  18090000
181000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18100000
181100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18110000
181200         PERFORM                                                  18120000
181300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18130000
181400                   PV-LAST-BLOCK-IN-RANGE                         18140000
181500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18150000
181600                               TO  PV-BLOCK-NUMBER                18160000
181700             PERFORM Z100-READ-TEMP-STORAGE                       18170000
181800             PERFORM G200-MARK-SELECTED-INDS                      18180000
181900                 VARYING RV100-ITEM-SUB FROM 1 BY 1               18190000
182000                 UNTIL RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK        18200000
182100             PERFORM Z150-WRITE-TEMP-STORAGE                      18210000
182200             ADD +1            TO  PV-NEXT-BLOCK-IN-ARRAY         18220000
182300         END-PERFORM                                              18230000
182400                                                                  18240000
182500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18250000
182600                               TO  PV-BLOCK-NUMBER                18260000
182700         PERFORM Z100-READ-TEMP-STORAGE                           18270000
182800     END-IF.                                                      18280000
182900                                                                  18290000
183000     MOVE +0                   TO  RV100-START-OF-SELECTED-RANGE  18300000
183100                                   RV100-END-OF-SELECTED-RANGE.   18310000
183200                                                                  18320000
183300 EJECT                                                            18330000
183400*----------------------------------------------------------------*18340000
183500*    CHECK EACH ENTRY TO DETERMINE IF THE SELECTION CRITERIA IN  *18350000
183600*    THE MAP DIFFERS FROM THAT IN THE ARRAY.  IF THEY DO DIFFER, *18360000
183700*    AND THE ARRAY ENTRY SHOWS THAT THE ITEM WAS PREVIOUSLY      *18370000
183800*    SELECTED, SUBTRACT 1 FROM THE SELECTED COUNTER.  IF THEY DO *18380000
183900*    DIFFER, AND THE ARRAY ENTRY SHOWS THAT THIS ITEM WAS MARKED *18390000
184000*    AS EITHER THE BEGINNING OR ENDING SELECTION POINT, ZERO OUT *18400000
184100*    THE STARTING RANGE AND/OR ENDING RANGE.  IF THE ENTRY ON    *18410000
184200*    THE MAP SHOWS THAT THIS ITEM WAS SELECTED, ADD 1 TO THE     *18420000
184300*    SELECTED COUNTER.                                           *18430000
184400*                                                                *18440000
184500*    PERFORMED BY E200-MOVE-SELECTS-TO-COMMAREA.                 *18450000
184600*----------------------------------------------------------------*18460000
184700                                                                  18470000
184800 F300-CHECK-SELECTIONS.                                           18480000
184900                                                                  18490000
185000     IF (PV-ITEM-IN-USE < RV100-NUMBER-OF-ITEMS-READ) OR          18500000
185100        (PV-ITEM-IN-USE = RV100-NUMBER-OF-ITEMS-READ)             18510000
185200         PERFORM K100-SET-SUBSCRIPTS                              18520000
185300                                                                  18530000
185400         IF  RV100-SELECTED-SW(RV100-BLK-SUB RV100-ITEM-SUB)      18540000
185500             NOT EQUAL RVKM100-SELECTI(PS-SUB)                    18550000
185600             SET RV100-BLOCK-MODIFIED(RV100-BLK-SUB)              18560000
185700                               TO  TRUE                           18570000
185800             IF  RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)       18580000
185900                 SUBTRACT +1 FROM RV100-NUMBER-OF-SELECTED-ITEMS  18590000
186000             ELSE                                                 18600000
186100                                                                  18610000
186200                 IF  RV100-BEGIN(RV100-BLK-SUB RV100-ITEM-SUB)    18620000
186300                     IF  RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB     18630000
186400                                               RV100-ITEM-SUB) =  18640000
186500                         RV100-START-OF-SELECTED-RANGE            18650000
186600                         MOVE +0                                  18660000
186700                               TO  RV100-START-OF-SELECTED-RANGE  18670000
186800                     END-IF                                       18680000
186900                 ELSE                                             18690000
187000                                                                  18700000
187100                     IF  RV100-END(RV100-BLK-SUB RV100-ITEM-SUB)  18710000
187200                         IF  RV100-LIST-ITEM-NUMBER               18720000
187300                                 (RV100-BLK-SUB RV100-ITEM-SUB)   18730000
187400                         =  RV100-END-OF-SELECTED-RANGE           18740000
187500                             MOVE +0                              18750000
187600                               TO RV100-END-OF-SELECTED-RANGE     18760000
187700                         END-IF                                   18770000
187800                     END-IF                                       18780000
187900                 END-IF                                           18790000
188000             END-IF                                               18800000
188100                                                                  18810000
188200             IF RVKM100-SELECTI(PS-SUB) = PC-SELECTED             18820000
188300                 ADD +1        TO RV100-NUMBER-OF-SELECTED-ITEMS  18830000
188400             END-IF                                               18840000
188500                                                                  18850000
188600             IF (RVKM100-SELECTA(PS-SUB) = PC-ERASE-EOF) OR       18860000
188700                (RVKM100-SELECTI(PS-SUB) = SPACES)                18870000
188800                 MOVE SPACES   TO                                 18880000
188900                      RV100-SELECTED-SW(RV100-BLK-SUB             18890000
189000                                        RV100-ITEM-SUB)           18900000
189100             ELSE                                                 18910000
189200                 MOVE RVKM100-SELECTI(PS-SUB) TO                  18920000
189300                      RV100-SELECTED-SW(RV100-BLK-SUB             18930000
189400                                        RV100-ITEM-SUB)           18940000
189500             END-IF                                               18950000
189600         END-IF                                                   18960000
189700     END-IF.                                                      18970000
189800                                                                  18980000
189900     ADD +1                    TO  PV-ITEM-IN-USE.                18990000
190000     ADD +1                    TO  PS-SUB.                        19000000
190100                                                                  19010000
190200 EJECT                                                            19020000
190300*----------------------------------------------------------------*19030000
190400*    CALCULATE THE NEW TOP AND BOTTOM ITEM NUMBERS BASED ON WHERE*19040000
190500*    THE USER SPECIFIED TO GO ON THE LIST AND DETERMINE WHERE    *19050000
190600*    THESE ITEMS CAN BE FOUND (I.E. ARRAY, TEMPORARY STORAGE).   *19060000
190700*                                                                *19070000
190800*    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                      *19080000
190900*    PERFORMED BY E500-BROWSE-BACKWARD.                          *19090000
191000*    PERFORMED BY E600-BROWSE-FORWARD.                           *19100000
191100*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                    *19110000
191200*----------------------------------------------------------------*19120000
191300                                                                  19130000
191400 F500-BROWSE.                                                     19140000
191500                                                                  19150000
191600     IF  PV-TOP-ITEM < +1                                         19160000
191700         MOVE +1               TO  PV-TOP-ITEM                    19170000
191800         IF  PS-CURSOR-NOT-POSITIONED                             19180000
191900             MOVE PC-TSYMSG-00069                                 19190000
192000                               TO  DP020-MSG-NUMBER               19200000
192100             SET DP020-MSG-INFORMATIONAL                          19210000
192200                               TO  TRUE                           19220000
192300             SET PS-INFORMATIONAL                                 19230000
192400                               TO  TRUE                           19240000
192500             SET PS-CURSOR-POSITIONED                             19250000
192600                               TO  TRUE                           19260000
192700         END-IF                                                   19270000
192800     END-IF.                                                      19280000
192900                                                                  19290000
193000     IF  RV100-NO-ITEMS-LEFT-ON-DB                                19300000
193100         IF  PV-TOP-ITEM > RV100-NUMBER-OF-ITEMS-READ             19310000
193200             IF  DP020-SRC-AID EQUAL DP016-ENTER                  19320000
193300                 MOVE RV100-NUMBER-OF-ITEMS-READ                  19330000
193400                               TO  PV-TOP-ITEM                    19340000
193500             ELSE                                                 19350000
193600                 MOVE RV100-ITEM-AT-TOP-OF-PANEL                  19360000
193700                               TO  PV-TOP-ITEM                    19370000
193800             END-IF                                               19380000
193900                                                                  19390000
194000             IF  PS-CURSOR-NOT-POSITIONED                         19400000
194100                 MOVE -1       TO  ANAVCMDL                       19410000
194200                 SET DP020-MSG-INFORMATIONAL                      19420000
194300                               TO  TRUE                           19430000
194400                 SET PS-CURSOR-POSITIONED                         19440000
194500                               TO  TRUE                           19450000
194600                 IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)            19460000
194700                     MOVE PC-TSYMSG-00070                         19470000
194800                               TO  DP020-MSG-NUMBER               19480000
194900                     SET PS-INFORMATIONAL                         19490000
195000                               TO  TRUE                           19500000
195100             END-IF                                               19510000
195200         END-IF                                                   19520000
195300     END-IF.                                                      19530000
195400                                                                  19540000
195500     COMPUTE PV-BOTTOM-ITEM =                                     19550000
195600         (PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1.                  19560000
195700                                                                  19570000
195800     IF  RV100-NO-ITEMS-LEFT-ON-DB                                19580000
195900         IF  PV-BOTTOM-ITEM > RV100-NUMBER-OF-ITEMS-READ          19590000
196000             MOVE RV100-NUMBER-OF-ITEMS-READ                      19600000
196100                               TO  PV-BOTTOM-ITEM                 19610000
196200             IF  PS-CURSOR-NOT-POSITIONED                         19620000
196300                 IF  PV-TOP-ITEM NOT = +1                         19630000
196400                     IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)        19640000
196500                         MOVE PC-TSYMSG-00070                     19650000
196600                               TO  DP020-MSG-NUMBER               19660000
196700                         SET PS-INFORMATIONAL                     19670000
196800                               TO  TRUE                           19680000
196900                         SET DP020-MSG-INFORMATIONAL              19690000
197000                               TO  TRUE                           19700000
197100                         SET PS-CURSOR-POSITIONED                 19710000
197200                               TO  TRUE                           19720000
197300                     END-IF                                       19730000
197400                 END-IF                                           19740000
197500             END-IF                                               19750000
197600         END-IF                                                   19760000
197700     END-IF.                                                      19770000
197800                                                                  19780000
197900     PERFORM G300-DETERMINE-WHAT-IS-WHERE.                        19790000
198000                                                                  19800000
198100     IF  PS-TOP-ITEM-IN-ARRAY                                     19810000
198200         IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                          19820000
198300             IF  PS-BOTTOM-ITEM-IN-TEMP                           19830000
198400                 PERFORM G500-SCROLL-FORWARD                      19840000
198500             ELSE                                                 19850000
198600                 IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   19860000
198700                     PERFORM G500-SCROLL-FORWARD                  19870000
198800                 END-IF                                           19880000
198900                 PERFORM G400-READ-ITEMS-INTO-ARRAY               19890000
199000             END-IF                                               19900000
199100         END-IF                                                   19910000
199200     ELSE                                                         19920000
199300                                                                  19930000
199400         IF  PS-BOTTOM-ITEM-IN-ARRAY                              19940000
199500             PERFORM G600-SCROLL-BACKWARD                         19950000
199600         ELSE                                                     19960000
199700             IF  PS-TOP-ITEM-IN-TEMP                              19970000
199800                 PERFORM G700-GET-TOP-ITEMS-BLOCK                 19980000
199900                 PERFORM G300-DETERMINE-WHAT-IS-WHERE             19990000
200000                 IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                  20000000
200100                     PERFORM G400-READ-ITEMS-INTO-ARRAY           20010000
200200                 END-IF                                           20020000
200300             ELSE                                                 20030000
200400                 IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   20040000
200500                     PERFORM G800-GET-LAST-BLOCK-IN-TEMP          20050000
200600                 END-IF                                           20060000
200700                 PERFORM G400-READ-ITEMS-INTO-ARRAY               20070000
200800             END-IF                                               20080000
200900         END-IF                                                   20090000
201000     END-IF.                                                      20100000
201100                                                                  20110000
201200     IF  PV-TOP-ITEM = RV100-ITEM-AT-TOP-OF-PANEL                 20120000
201300         SET PS-SAME-ITEMS-DISPLAYED                              20130000
201400                               TO  TRUE                           20140000
201500     ELSE                                                         20150000
201600         SET PS-DIFFERENT-ITEMS-DISPLAYED                         20160000
201700                               TO  TRUE                           20170000
201800         MOVE PV-TOP-ITEM      TO  RV100-ITEM-AT-TOP-OF-PANEL     20180000
201900     END-IF.                                                      20190000
202000                                                                  20200000
202100     PERFORM G100-DISPLAY-PANEL.                                  20210000
202200                                                                  20220000
202300 EJECT                                                            20230000
202400*----------------------------------------------------------------*20240000
202500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *20250000
202600*                                                                *20260000
202700*    PERFORMED BY E700-DESELECT-ALL-ITEMS.                       *20270000
202800*----------------------------------------------------------------*20280000
202900                                                                  20290000
203000 F600-CLEAR-SELECTED-INDS.                                        20300000
203100                                                                  20310000
203200     IF  RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB RV100-ITEM-SUB)     20320000
203300             NOT EQUAL ZERO                                       20330000
203400         IF  NOT RV100-NO-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)    20340000
203500             SET RV100-NO-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)    20350000
203600                               TO  TRUE                           20360000
203700             SET RV100-BLOCK-MODIFIED(RV100-BLK-SUB)              20370000
203800                               TO  TRUE                           20380000
203900         END-IF                                                   20390000
204000     END-IF.                                                      20400000
204100                                                                  20410000
204200 EJECT                                                            20420000
204300*----------------------------------------------------------------*20430000
204400*    MARK EACH ITEM AS BEING SELECTED.                           *20440000
204500*                                                                *20450000
204600*    PERFORMED BY E900-SELECT-ALL-ITEMS.                         *20460000
204700*----------------------------------------------------------------*20470000
204800                                                                  20480000
204900 F700-SET-SELECTED-INDS.                                          20490000
205000                                                                  20500000
205100     IF  RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB RV100-ITEM-SUB)     20510000
205200             NOT EQUAL ZERO                                       20520000
205300         IF  NOT RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)       20530000
205400             SET RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)       20540000
205500                               TO  TRUE                           20550000
205600             SET RV100-BLOCK-MODIFIED(RV100-BLK-SUB)              20560000
205700                               TO  TRUE                           20570000
205800         END-IF                                                   20580000
205900     END-IF.                                                      20590000
206000                                                                  20600000
206100 EJECT                                                            20610000
206200*----------------------------------------------------------------*20620000
206300*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *20630000
206400*                                                                *20640000
206500*    PERFORMED BY B100-CONTROL-PROCESSING.                       *20650000
206600*    PERFORMED BY C300-PROCESS-PANEL.                            *20660000
206700*    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                  *20670000
206800*    PERFORMED BY D100-SETUP-INIT-PANEL.                         *20680000
206900*    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                      *20690000
207000*    PERFORMED BY E500-BROWSE-BACKWARD.                          *20700000
207100*    PERFORMED BY E600-BROWSE-FORWARD.                           *20710000
207200*    PERFORMED BY E700-DESELECT-ALL-ITEMS.                       *20720000
207300*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                    *20730000
207400*    PERFORMED BY F500-BROWSE.                                   *20740000
207500*----------------------------------------------------------------*20750000
207600                                                                  20760000
207700 G100-DISPLAY-PANEL.                                              20770000
207800                                                                  20780000
207900     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       20790000
208000     MOVE DP017-EDITED-TIME-HMS                                   20800000
208100                               TO  ATIMEO.                        20810000
208200                                                                  20820000
208300     IF PS-SEND-MAP-N-DATA-FRSET                                  20830000
208400         PERFORM DP002-0000-FORMAT-TITLE-LINES                    20840000
208500         PERFORM DP009-0000-LOAD-FK-LINES                         20850000
208600     END-IF.                                                      20860000
208700                                                                  20870000
208800     PERFORM H200-FORMAT-PANEL-BODY.                              20880000
208900                                                                  20890000
209000     PERFORM DP005-0000-FORMAT-MSG-LINES.                         20900000
209100                                                                  20910000
209200     PERFORM DP008-0000-WRITE-PANEL.                              20920000
209300                                                                  20930000
209400 EJECT                                                            20940000
209500*----------------------------------------------------------------*20950000
209600*    MARK EACH ITEM THAT FALLS WITHIN THE BEGINNING AND ENDING   *20960000
209700*    RANGE AS BEING SELECTED.                                    *20970000
209800*                                                                *20980000
209900*    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                   *20990000
210000*----------------------------------------------------------------*21000000
210100                                                                  21010000
210200 G200-MARK-SELECTED-INDS.                                         21020000
210300                                                                  21030000
210400     IF (RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB                     21040000
210500                                RV100-ITEM-SUB) >                 21050000
210600         RV100-START-OF-SELECTED-RANGE)                           21060000
210700     OR (RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB                     21070000
210800                                RV100-ITEM-SUB) =                 21080000
210900         RV100-START-OF-SELECTED-RANGE)                           21090000
211000                                                                  21100000
211100         IF (RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB                 21110000
211200                                    RV100-ITEM-SUB) <             21120000
211300             RV100-END-OF-SELECTED-RANGE)                         21130000
211400         OR (RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB                 21140000
211500                                    RV100-ITEM-SUB) =             21150000
211600             RV100-END-OF-SELECTED-RANGE)                         21160000
211700                                                                  21170000
211800             IF NOT RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB)    21180000
211900                 SET RV100-SELECT(RV100-BLK-SUB                   21190000
212000                                  RV100-ITEM-SUB)                 21200000
212100                               TO  TRUE                           21210000
212200                 SET RV100-BLOCK-MODIFIED(RV100-BLK-SUB)          21220000
212300                               TO  TRUE                           21230000
212400                 ADD +1        TO RV100-NUMBER-OF-SELECTED-ITEMS  21240000
212500             END-IF                                               21250000
212600         END-IF                                                   21260000
212700     END-IF.                                                      21270000
212800                                                                  21280000
212900 EJECT                                                            21290000
213000*----------------------------------------------------------------*21300000
213100*    DETERMINE WHETHER THE TOP ITEM AND BOTTOM ITEM CAN BE FOUND *21310000
213200*    IN THE ARRAY, IN TEMPORARY STORAGE, OR NEITHER.             *21320000
213300*                                                                *21330000
213400*    PERFORMED BY F500-BROWSE.                                   *21340000
213500*----------------------------------------------------------------*21350000
213600                                                                  21360000
213700 G300-DETERMINE-WHAT-IS-WHERE.                                    21370000
213800                                                                  21380000
213900     MOVE RV100-LIST-ITEM-NUMBER(1 1)                             21390000
214000                               TO  PV-FIRST-ITEM-IN-ARRAY.        21400000
214100     COMPUTE PV-LAST-ITEM-IN-ARRAY =                              21410000
214200         (PV-FIRST-ITEM-IN-ARRAY +                                21420000
214300         (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-BLOCK)) - 1.      21430000
214400     IF  PV-LAST-ITEM-IN-ARRAY > RV100-NUMBER-OF-ITEMS-READ       21440000
214500         MOVE RV100-NUMBER-OF-ITEMS-READ                          21450000
214600                               TO  PV-LAST-ITEM-IN-ARRAY          21460000
214700     END-IF.                                                      21470000
214800                                                                  21480000
214900     COMPUTE PV-LAST-ITEM-IN-TEMP =                               21490000
215000         RV100-HIGHEST-BLOCK-WRITTEN * PC-ITEMS-PER-BLOCK.        21500000
215100     IF  PV-LAST-ITEM-IN-TEMP > RV100-NUMBER-OF-ITEMS-READ        21510000
215200         MOVE RV100-NUMBER-OF-ITEMS-READ                          21520000
215300                               TO  PV-LAST-ITEM-IN-TEMP           21530000
215400     END-IF.                                                      21540000
215500                                                                  21550000
215600     IF (PV-TOP-ITEM > PV-FIRST-ITEM-IN-ARRAY)                    21560000
215700     OR (PV-TOP-ITEM = PV-FIRST-ITEM-IN-ARRAY)                    21570000
215800         IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-ARRAY)                 21580000
215900         OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-ARRAY)                 21590000
216000             SET PS-TOP-ITEM-IN-ARRAY                             21600000
216100                               TO  TRUE                           21610000
216200         ELSE                                                     21620000
216300             SET PS-TOP-ITEM-NOT-IN-ARRAY                         21630000
216400                               TO  TRUE                           21640000
216500         END-IF                                                   21650000
216600     ELSE                                                         21660000
216700         SET PS-TOP-ITEM-NOT-IN-ARRAY                             21670000
216800                               TO  TRUE                           21680000
216900     END-IF.                                                      21690000
217000                                                                  21700000
217100     IF (PV-BOTTOM-ITEM > PV-FIRST-ITEM-IN-ARRAY)                 21710000
217200     OR (PV-BOTTOM-ITEM = PV-FIRST-ITEM-IN-ARRAY)                 21720000
217300         IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-ARRAY)              21730000
217400         OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-ARRAY)              21740000
217500             SET PS-BOTTOM-ITEM-IN-ARRAY                          21750000
217600                               TO  TRUE                           21760000
217700         ELSE                                                     21770000
217800             SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                      21780000
217900                               TO  TRUE                           21790000
218000         END-IF                                                   21800000
218100     ELSE                                                         21810000
218200         SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                          21820000
218300                               TO  TRUE                           21830000
218400     END-IF.                                                      21840000
218500                                                                  21850000
218600     IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-TEMP)                      21860000
218700     OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-TEMP)                      21870000
218800         SET PS-TOP-ITEM-IN-TEMP                                  21880000
218900                               TO  TRUE                           21890000
219000     ELSE                                                         21900000
219100         SET PS-TOP-ITEM-NOT-IN-TEMP                              21910000
219200                               TO  TRUE                           21920000
219300     END-IF.                                                      21930000
219400                                                                  21940000
219500     IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-TEMP)                   21950000
219600     OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-TEMP)                   21960000
219700         SET PS-BOTTOM-ITEM-IN-TEMP                               21970000
219800                               TO  TRUE                           21980000
219900     ELSE                                                         21990000
220000         SET PS-BOTTOM-ITEM-NOT-IN-TEMP                           22000000
220100                               TO  TRUE                           22010000
220200     END-IF.                                                      22020000
220300                                                                  22030000
220400     IF PV-LAST-ITEM-IN-TEMP > PV-LAST-ITEM-IN-ARRAY              22040000
220500         SET PS-LAST-BLOCK-NOT-IN-ARRAY                           22050000
220600                               TO  TRUE                           22060000
220700     ELSE                                                         22070000
220800         SET PS-LAST-BLOCK-IN-ARRAY                               22080000
220900                               TO  TRUE                           22090000
221000     END-IF.                                                      22100000
221100                                                                  22110000
221200 EJECT                                                            22120000
221300*----------------------------------------------------------------*22130000
221400*    DETERMINE THE SPOT IN THE ARRAY WHERE THE LAST ITEM FROM    *22140000
221500*    THE DATA BASE WAS ADDED SO WE KNOW WHERE TO ADD THE NEW     *22150000
221600*    ITEMS.  USE THE SAVED UPC KEY TO START THE BROWSE.  H600    *22160000
221700*    MUST BE PERFORMED TO POSITION TO THE FIRST UPC TO PROCESS.  *22170000
221800*                                                                *22180000
221900*    PERFORMED BY F500-BROWSE.                                   *22190000
222000*----------------------------------------------------------------*22200000
222100                                                                  22210000
222200 G400-READ-ITEMS-INTO-ARRAY.                                      22220000
222300                                                                  22230000
222400     COMPUTE PS-ITEM-SUB =                                        22240000
222500         (RV100-NUMBER-OF-ITEMS-READ -                            22250000
222600          RV100-LIST-ITEM-NUMBER(1 1)) + 1.                       22260000
222700                                                                  22270000
222800     MOVE PS-ITEM-SUB TO RV100-ITEM-SUB.                          22280000
222900                                                                  22290000
223000     IF  RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK                      22300000
223100         SUBTRACT PC-ITEMS-PER-BLOCK                              22310000
223200                             FROM  RV100-ITEM-SUB                 22320000
223300         MOVE PC-MAX-BLOCKS-IN-ARRAY                              22330000
223400                               TO  RV100-BLK-SUB                  22340000
223500     ELSE                                                         22350000
223600         MOVE +1               TO  RV100-BLK-SUB                  22360000
223700     END-IF.                                                      22370000
223800                                                                  22380000
223900     MOVE PV-BOTTOM-ITEM       TO  PV-HIGHEST-ITEM-TO-BE-READ.    22390000
224000                                                                  22400000
224100     PERFORM L100-OPEN-CURSOR.                                    22410000
224200     PERFORM H100-READ-ITEMS-FROM-DB.                             22420000
224300     IF  PV-ITEMS-READ EQUAL ZERO                                 22430000
224400         MOVE RV100-ITEM-AT-TOP-OF-PANEL                          22440000
224500                               TO  PV-TOP-ITEM                    22450000
224600     END-IF.                                                      22460000
224700                                                                  22470000
224800     IF  RV100-NO-ITEMS-LEFT-ON-DB                                22480000
224900         IF  PV-TOP-ITEM > RV100-NUMBER-OF-ITEMS-READ             22490000
225000             MOVE RV100-NUMBER-OF-ITEMS-READ                      22500000
225100                               TO  PV-TOP-ITEM                    22510000
225200         END-IF                                                   22520000
225300         IF  DP020-FK-NEXT-PAGE(DP020-SRC-AID)                    22530000
225400             MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER           22540000
225500             SET DP020-MSG-INFORMATIONAL                          22550000
225600                               TO  TRUE                           22560000
225700             SET PS-INFORMATIONAL                                 22570000
225800                               TO  TRUE                           22580000
225900         END-IF                                                   22590000
226000     END-IF.                                                      22600000
226100                                                                  22610000
226200 EJECT                                                            22620000
226300*----------------------------------------------------------------*22630000
226400*    IF THE TOP ITEM WE NEED IS IN THE ARRAY, BUT THE BOTTOM     *22640000
226500*    ITEM WE NEED IS IN TEMPORARY STORAGE OR HAS NOT BEEN READ   *22650000
226600*    YET, WRITE OUT THE 1ST BLOCK IN THE ARRAY TO TEMPORARY      *22660000
226700*    STORAGE.  MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK  *22670000
226800*    AND READ THE BLOCK NEEDED INTO THE 2ND BLOCK OF THE ARRAY.  *22680000
226900*    THE TOP ITEM WILL BE LOCATED IN THE 1ST BLOCK, AND THE      *22690000
227000*    BOTTOM ITEM WILL EITHER BE LOCATED IN THE 2ND BLOCK OR      *22700000
227100*    WILL BE PLACED IN THE 2ND BLOCK.                            *22710000
227200*                                                                *22720000
227300*    PERFORMED BY F500-BROWSE.                                   *22730000
227400*----------------------------------------------------------------*22740000
227500                                                                  22750000
227600 G500-SCROLL-FORWARD.                                             22760000
227700                                                                  22770000
227800     MOVE +1                   TO  RV100-BLK-SUB.                 22780000
227900     PERFORM Z150-WRITE-TEMP-STORAGE.                             22790000
228000                                                                  22800000
228100     MOVE RV100-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY) TO          22810000
228200          RV100-BLOCK-ENTRIES(RV100-BLK-SUB).                     22820000
228300                                                                  22830000
228400     COMPUTE PV-TEMP-BLOCK-NUMBER =                               22840000
228500         1 + ((PV-BOTTOM-ITEM - 1) / PC-ITEMS-PER-BLOCK).         22850000
228600                                                                  22860000
228700     MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.               22870000
228800     ADD +1                    TO  RV100-BLK-SUB.                 22880000
228900     PERFORM Z100-READ-TEMP-STORAGE.                              22890000
229000                                                                  22900000
229100 EJECT                                                            22910000
229200*----------------------------------------------------------------*22920000
229300*    IF TOP ITEM WE NEED IS NOT IN THE ARRAY, BUT THE BOTTOM     *22930000
229400*    ITEM IS, WRITE BOTH BLOCKS TO TEMPORARY STORAGE.  MOVE      *22940000
229500*    THE 1ST BLOCK IN THE ARRAY TO THE 2ND BLOCK OF THE ARRAY.   *22950000
229600*    READ THE BLOCK THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK*22960000
229700*    OF THE ARRAY.                                               *22970000
229800*                                                                *22980000
229900*    PERFORMED BY F500-BROWSE.                                   *22990000
230000*----------------------------------------------------------------*23000000
230100                                                                  23010000
230200 G600-SCROLL-BACKWARD.                                            23020000
230300                                                                  23030000
230400     MOVE +1                   TO  RV100-BLK-SUB.                 23040000
230500     PERFORM Z150-WRITE-TEMP-STORAGE.                             23050000
230600                                                                  23060000
230700     ADD +1 TO RV100-BLK-SUB.                                     23070000
230800     PERFORM Z150-WRITE-TEMP-STORAGE.                             23080000
230900                                                                  23090000
231000     MOVE +1                   TO  RV100-BLK-SUB.                 23100000
231100     MOVE RV100-BLOCK-ENTRIES(RV100-BLK-SUB) TO                   23110000
231200          RV100-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY).            23120000
231300                                                                  23130000
231400     COMPUTE PV-TEMP-BLOCK-NUMBER =                               23140000
231500         1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            23150000
231600                                                                  23160000
231700     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                23170000
231800     PERFORM Z100-READ-TEMP-STORAGE.                              23180000
231900                                                                  23190000
232000 EJECT                                                            23200000
232100*----------------------------------------------------------------*23210000
232200*    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE     *23220000
232300*    ARRAY, BUT THE TOP ITEM IS IN TEMPORARY STORAGE, WRITE BOTH *23230000
232400*    BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ THE BLOCK   *23240000
232500*    THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK OF THE ARRAY. *23250000
232600*    IF THERE IS ANOTHER BLOCK IN TEMPORARY STORAGE FOLLOWING    *23260000
232700*    THE ONE JUST READ, READ THAT ONE INTO THE 2ND BLOCK OF THE  *23270000
232800*    ARRAY, OTHERWISE INITIALIZE THE 2ND BLOCK OF THE ARRAY.     *23280000
232900*                                                                *23290000
233000*    PERFORMED BY F500-BROWSE.                                   *23300000
233100*----------------------------------------------------------------*23310000
233200                                                                  23320000
233300 G700-GET-TOP-ITEMS-BLOCK.                                        23330000
233400                                                                  23340000
233500     MOVE +1                   TO  RV100-BLK-SUB.                 23350000
233600     PERFORM Z150-WRITE-TEMP-STORAGE.                             23360000
233700                                                                  23370000
233800     ADD +1                    TO  RV100-BLK-SUB.                 23380000
233900     PERFORM Z150-WRITE-TEMP-STORAGE.                             23390000
234000                                                                  23400000
234100     COMPUTE PV-TEMP-BLOCK-NUMBER =                               23410000
234200         1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            23420000
234300                                                                  23430000
234400     MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.               23440000
234500     MOVE +1                   TO  RV100-BLK-SUB.                 23450000
234600                                                                  23460000
234700     PERFORM Z100-READ-TEMP-STORAGE.                              23470000
234800                                                                  23480000
234900     ADD +1                    TO  PV-BLOCK-NUMBER.               23490000
235000     ADD +1                    TO  RV100-BLK-SUB.                 23500000
235100                                                                  23510000
235200     IF (PV-BLOCK-NUMBER < RV100-HIGHEST-BLOCK-WRITTEN) OR        23520000
235300        (PV-BLOCK-NUMBER = RV100-HIGHEST-BLOCK-WRITTEN)           23530000
235400         PERFORM Z100-READ-TEMP-STORAGE                           23540000
235500     ELSE                                                         23550000
235600         PERFORM I100-INITIALIZE-BLOCK                            23560000
235700     END-IF.                                                      23570000
235800                                                                  23580000
235900 EJECT                                                            23590000
236000*----------------------------------------------------------------*23600000
236100*    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE     *23610000
236200*    ARRAY AND BOTH ITEMS ARE NOT IN TEMPORARY STORAGE (THE      *23620000
236300*    ITEMS HAVE NOT BEEN READ FROM THE DATA BASE YET), AND THE   *23630000
236400*    LAST ITEM READ FROM THE DATA BASE IS IN TEMPORARY STORAGE,  *23640000
236500*    WRITE BOTH BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ  *23650000
236600*    THE HIGHEST BLOCK IN TEMPORARY STORAGE INTO THE 1ST BLOCK   *23660000
236700*    OF THE ARRAY, AND INITIALIZE THE 2ND BLOCK IN THE ARRAY.    *23670000
236800*    THE 2ND BLOCK WILL BE USED FOR THE NEW ITEMS TO BE READ.    *23680000
236900*    THE 1ST BLOCK WILL NOW CONTAIN THE ITEMS THAT WERE LAST     *23690000
237000*    READ FROM THE DATA BASE.                                    *23700000
237100*                                                                *23710000
237200*    PERFORMED BY F500-BROWSE.                                   *23720000
237300*----------------------------------------------------------------*23730000
237400                                                                  23740000
237500 G800-GET-LAST-BLOCK-IN-TEMP.                                     23750000
237600                                                                  23760000
237700     MOVE +1                   TO  RV100-BLK-SUB.                 23770000
237800     PERFORM Z150-WRITE-TEMP-STORAGE.                             23780000
237900                                                                  23790000
238000     ADD +1                    TO  RV100-BLK-SUB.                 23800000
238100     PERFORM Z150-WRITE-TEMP-STORAGE.                             23810000
238200                                                                  23820000
238300     MOVE RV100-HIGHEST-BLOCK-WRITTEN                             23830000
238400                               TO  PV-BLOCK-NUMBER.               23840000
238500     MOVE +1                   TO  RV100-BLK-SUB.                 23850000
238600     PERFORM Z100-READ-TEMP-STORAGE.                              23860000
238700                                                                  23870000
238800     ADD +1                    TO  RV100-BLK-SUB.                 23880000
238900     PERFORM I100-INITIALIZE-BLOCK.                               23890000
239000                                                                  23900000
239100 EJECT                                                            23910000
239200*----------------------------------------------------------------*23920000
239300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *23930000
239400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *23940000
239500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23950000
239600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23960000
239700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23970000
239800*                                                                *23980000
239900*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23990000
240000*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *24000000
240100*    UPON INITIALIZATION.                                        *24010000
240200*                                                                *24020000
240300*    PERFORMED BY D100-SETUP-INIT-PANEL.                         *24030000
240400*    PERFORMED BY G400-READ-ITEMS-INTO-ARRAY.                    *24040000
240500*----------------------------------------------------------------*24050000
240600                                                                  24060000
240700 H100-READ-ITEMS-FROM-DB.                                         24070000
240800                                                                  24080000
240900     PERFORM                                                      24090000
241000         UNTIL (RV100-NO-ITEMS-LEFT-ON-DB)                        24100000
241100*         OR   (RV100-NUMBER-OF-ITEMS-READ =                      24110000
241200*               PV-HIGHEST-ITEM-TO-BE-READ)                       24120000
241300                                                                  24130000
241400         PERFORM L200-FETCH                                       24140000
241500                                                                  24150000
241600         IF  RV100-ITEMS-LEFT-ON-DB                               24160000
241700             IF  RV100-ITEM-SUB < PC-ITEMS-PER-BLOCK              24170000
241800                 ADD +1            TO  RV100-ITEM-SUB             24180000
241900             ELSE                                                 24190000
242000                 ADD +1            TO  RV100-BLK-SUB              24200000
242100                 MOVE +1           TO  RV100-ITEM-SUB             24210000
242200                                                                  24220000
242300                 IF  RV100-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY       24230000
242400                     MOVE +1       TO  RV100-BLK-SUB              24240000
242500                     SET RV100-BLOCK-MODIFIED (1)                 24250000
242600                               TO  TRUE                           24260000
242700                     PERFORM Z150-WRITE-TEMP-STORAGE              24270000
242800                     MOVE RV100-BLOCK-ENTRIES                     24280000
242900                               (PC-MAX-BLOCKS-IN-ARRAY)           24290000
243000                     TO   RV100-BLOCK-ENTRIES(RV100-BLK-SUB)      24300000
243100                     ADD +1        TO  RV100-BLK-SUB              24310000
243200                     PERFORM I100-INITIALIZE-BLOCK                24320000
243300                 END-IF                                           24330000
243400             END-IF                                               24340000
243500                                                                  24350000
243600             ADD 1             TO  RV100-NUMBER-OF-ITEMS-READ     24360000
243700                                   PV-ITEMS-READ                  24370000
243800             MOVE RV100-NUMBER-OF-ITEMS-READ                      24380000
243900                               TO  RV100-LIST-ITEM-NUMBER         24390000
244000                                       (RV100-BLK-SUB             24400000
244100                                        RV100-ITEM-SUB)           24410000
244200                                                                  24420000
244300             MOVE DFCTOR-DFCT-ORD-ID-CDE                          24430000
244400                               TO  RV100-TYPE                     24440000
244500                                       (RV100-BLK-SUB             24450000
244600                                        RV100-ITEM-SUB)           24460000
244700                                                                  24470000
244800             MOVE DFCTOR-DFCT-ORD-STAT-CDE                        24480000
244900                               TO  RV100-STATUS                   24490000
245000                                       (RV100-BLK-SUB             24500000
245100                                        RV100-ITEM-SUB)           24510000
245200                                                                  24520000
245300             MOVE DFCTOR-DFCT-ORD-ID                              24530000
245400                               TO  RV100-REQ-RA                   24540000
245500                                       (RV100-BLK-SUB             24550000
245600                                        RV100-ITEM-SUB)           24560000
245700                                                                  24570000
245800             MOVE DFCTOR-VEND-NAME                                24580000
245900                               TO  RV100-VEND-NAME                24590000
246000                                       (RV100-BLK-SUB             24600000
246100                                        RV100-ITEM-SUB)           24610000
246200                                                                  24620000
246300             MOVE DFCTOR-ORD-DTE                                  24630000
246400                               TO  PV-DB2-WORK-DATE               24640000
246500             MOVE PV-DB2-WD-YY TO  PV-DD-YY                       24650000
246600             MOVE PV-DB2-WD-MM TO  PV-DD-MM                       24660000
246700             MOVE PV-DB2-WD-DD TO  PV-DD-DD                       24670000
246800             MOVE PV-DISPLAY-DATE                                 24680000
246900                               TO  RV100-CREATE-DATE              24690000
247000                                       (RV100-BLK-SUB             24700000
247100                                        RV100-ITEM-SUB)           24710000
247200                                                                  24720000
247300             MOVE RSPBAR-WORKER-LAST-NAME                         24730000
247400                               TO  RV100-BUYER                    24740000
247500                                       (RV100-BLK-SUB             24750000
247600                                        RV100-ITEM-SUB)           24760000
247700                                                                  24770000
247800             MOVE DFCTOR-VENDOR-DUNS-NBR                          24780000
247900                               TO  RV100-DUNS-NUMBER              24790000
248000                                       (RV100-BLK-SUB             24800000
248100                                        RV100-ITEM-SUB)           24810000
248200         END-IF                                                   24820000
248300     END-PERFORM.                                                 24830000
248400                                                                  24840000
248500     PERFORM L300-CLOSE-CURSOR.                                   24850000
248600                                                                  24860000
248700     IF  RV100-NUMBER-OF-ITEMS-READ EQUAL ZERO                    24870000
248800         SET PS-NO-LIST-ITEMS-FOUND                               24880000
248900                               TO  TRUE                           24890000
249000         SET DP020-MSG-FATAL   TO  TRUE                           24900000
249100         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24910000
249200     ELSE                                                         24920000
249300         SET PS-LIST-ITEMS-FOUND                                  24930000
249400                               TO  TRUE                           24940000
249500     END-IF.                                                      24950000
249600                                                                  24960000
249700     MOVE +1                   TO  RV100-BLK-SUB.                 24970000
249800     PERFORM Z150-WRITE-TEMP-STORAGE.                             24980000
249900     ADD +1                    TO  RV100-BLK-SUB.                 24990000
250000     PERFORM Z150-WRITE-TEMP-STORAGE.                             25000000
250100                                                                  25010000
250200     MOVE 1                    TO  RV100-BLK-SUB                  25020000
250300                                   PV-BLOCK-NUMBER.               25030000
250400     PERFORM Z100-READ-TEMP-STORAGE.                              25040000
250500     IF  RV100-HIGHEST-BLOCK-WRITTEN GREATER THAN 1               25050000
250600         MOVE 2                TO  RV100-BLK-SUB                  25060000
250700                                   PV-BLOCK-NUMBER                25070000
250800         PERFORM Z100-READ-TEMP-STORAGE                           25080000
250900     END-IF.                                                      25090000
251000                                                                  25100000
251100 EJECT                                                            25110000
251200*----------------------------------------------------------------*25120000
251300*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *25130000
251400*                                                                *25140000
251500*    PERFORMED BY G100-DISPLAY-PANEL.                            *25150000
251600*----------------------------------------------------------------*25160000
251700                                                                  25170000
251800 H200-FORMAT-PANEL-BODY.                                          25180000
251900                                                                  25190000
252000     PERFORM I700-FORMAT-FROM-TO-LINE.                            25200000
252100     PERFORM I200-FORMAT-LIST-LINES.                              25210000
252200     PERFORM I300-FORMAT-NR-SELECTED.                             25220000
252300                                                                  25230000
252400     IF NOT DP020-NEXT-ACT-ERROR                                  25240000
252500         PERFORM I800-SET-CURSOR-POSITION                         25250000
252600     END-IF.                                                      25260000
252700                                                                  25270000
252800 EJECT                                                            25280000
252900*----------------------------------------------------------------*25290000
253000*    INITIALIZE A BLOCK IN THE ARRAY.                            *25300000
253100*                                                                *25310000
253200*    PERFORMED BY D100-SETUP-INIT-PANEL.                         *25320000
253300*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                      *25330000
253400*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                   *25340000
253500*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                       *25350000
253600*----------------------------------------------------------------*25360000
253700                                                                  25370000
253800 I100-INITIALIZE-BLOCK.                                           25380000
253900                                                                  25390000
254000     INITIALIZE  RV100-BLOCK-ENTRIES (RV100-BLK-SUB).             25400000
254100     SET RV100-BLOCK-NOT-MODIFIED(RV100-BLK-SUB) TO TRUE.         25410000
254200 EJECT                                                            25420000
254300*----------------------------------------------------------------*25430000
254400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25440000
254500*                                                                *25450000
254600*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                    *25460000
254700*    PERFORMED BY H200-FORMAT-PANEL-BODY.                        *25470000
254800*----------------------------------------------------------------*25480000
254900                                                                  25490000
255000 I200-FORMAT-LIST-LINES.                                          25500000
255100                                                                  25510000
255200     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            25520000
255300         (RV100-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   25530000
255400                                                                  25540000
255500     MOVE RV100-ITEM-AT-TOP-OF-PANEL                              25550000
255600                               TO  PV-ITEM-IN-USE.                25560000
255700     MOVE +1                   TO  PS-SUB.                        25570000
255800                                                                  25580000
255900     PERFORM J100-PROCESS-ITEMS                                   25590000
256000         UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          25600000
256100                                                                  25610000
256200*    IF  RV100-BLOCK-MODIFIED (RV100-BLK-SUB)                     25620000
256300*        PERFORM Z150-WRITE-TEMP-STORAGE                          25630000
256400*    END-IF.                                                      25640000
256500*                                                                 25650000
256600 EJECT                                                            25660000
256700*----------------------------------------------------------------*25670000
256800*    FORMAT THE FIELD WHICH WILL SHOW THE NUMBER OF ITEMS THAT   *25680000
256900*    WERE SELECTED BY THE USER.                                  *25690000
257000*                                                                *25700000
257100*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                    *25710000
257200*    PERFORMED BY H200-FORMAT-PANEL-BODY.                        *25720000
257300*----------------------------------------------------------------*25730000
257400                                                                  25740000
257500 I300-FORMAT-NR-SELECTED.                                         25750000
257600                                                                  25760000
257700     MOVE RV100-NUMBER-OF-SELECTED-ITEMS                          25770000
257800                               TO  ASELITO.                       25780000
257900                                                                  25790000
258000 EJECT                                                            25800000
258100*----------------------------------------------------------------*25810000
258200*    FORMAT THE LINE THAT WILL SHOW THE TOTAL NUMBER OF ITEMS WE *25820000
258300*    HAVE ON OUR LIST AND SHOW THE NUMBERS ASSOCIATED WITH THE   *25830000
258400*    FIRST AND LAST ITEMS ON CURRENT PAGE.  THIS WILL HELP THE   *25840000
258500*    USER DETERMINE HOW FAR THEY ARE INTO THE LIST.              *25850000
258600*                                                                *25860000
258700*    PERFORMED BY H200-FORMAT-PANEL-BODY.                        *25870000
258800*----------------------------------------------------------------*25880000
258900                                                                  25890000
259000 I700-FORMAT-FROM-TO-LINE.                                        25900000
259100                                                                  25910000
259200     MOVE RV100-ITEM-AT-TOP-OF-PANEL                              25920000
259300                               TO  ASTRTITO.                      25930000
259400                                                                  25940000
259500     MOVE DP015-GREEN          TO  ASTRTITC.                      25950000
259600     MOVE DP015-UNDERLINE      TO  ASTRTITH.                      25960000
259700     MOVE DP015-UNP-NUM-BRT-MDT                                   25970000
259800                               TO  ASTRTITA.                      25980000
259900                                                                  25990000
260000     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            26000000
260100         (RV100-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.   26010000
260200                                                                  26020000
260300     IF PV-ENDING-ITEM-ON-PANEL < RV100-NUMBER-OF-ITEMS-READ      26030000
260400         MOVE PV-ENDING-ITEM-ON-PANEL                             26040000
260500                               TO  AENDITO                        26050000
260600     ELSE                                                         26060000
260700         MOVE RV100-NUMBER-OF-ITEMS-READ                          26070000
260800                               TO  AENDITO                        26080000
260900     END-IF.                                                      26090000
261000                                                                  26100000
261100     MOVE RV100-NUMBER-OF-ITEMS-READ                              26110000
261200                               TO  ATOTITO.                       26120000
261300                                                                  26130000
261400 EJECT                                                            26140000
261500*----------------------------------------------------------------*26150000
261600*    IF NO ITEMS WERE READ FROM THE DATA BASE, POINT THE CURSOR  *26160000
261700*    TO THE COMMAND LINE, OTHERWISE POINT THE CURSOR TO ONE OF   *26170000
261800*    THE SELECTION ENTRIES.                                      *26180000
261900*                                                                *26190000
262000*    PERFORMED BY H200-FORMAT-PANEL-BODY.                        *26200000
262100*----------------------------------------------------------------*26210000
262200                                                                  26220000
262300 I800-SET-CURSOR-POSITION.                                        26230000
262400                                                                  26240000
262500     IF RV100-NUMBER-OF-ITEMS-READ = +0                           26250000
262600     AND DP020-MSG-NUMBER NOT NUMERIC                             26260000
262700         MOVE -1               TO  ANAVCMDL                       26270000
262800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               26280000
262900         SET DP020-MSG-WARNING TO  TRUE                           26290000
263000     ELSE                                                         26300000
263100                                                                  26310000
263200         IF (PS-CURSOR-NOT-POSITIONED) OR                         26320000
263300            (PS-WARNING)               OR                         26330000
263400            (PS-INFORMATIONAL)                                    26340000
263500             PERFORM J200-FIND-LAST-SELECTION                     26350000
263600         END-IF                                                   26360000
263700     END-IF.                                                      26370000
263800                                                                  26380000
263900 EJECT                                                            26390000
264000*----------------------------------------------------------------*26400000
264100*    PROCESS EACH ITEM IN THE ARRAY AND MOVE IT TO THE MAP.      *26410000
264200*    FILL THE MAP UNTIL WE HAVE REACHED THE MAXIMUM NUMBER OF    *26420000
264300*    MAP ENTRIES.                                                *26430000
264400*                                                                *26440000
264500*    PERFORMED BY I200-FORMAT-LIST-LINES.                        *26450000
264600*----------------------------------------------------------------*26460000
264700                                                                  26470000
264800 J100-PROCESS-ITEMS.                                              26480000
264900                                                                  26490000
265000     IF (PV-ITEM-IN-USE < RV100-NUMBER-OF-ITEMS-READ) OR          26500000
265100        (PV-ITEM-IN-USE = RV100-NUMBER-OF-ITEMS-READ)             26510000
265200         PERFORM K100-SET-SUBSCRIPTS                              26520000
265300         MOVE DP015-UNP-ALP-BRT-MDT                               26530000
265400                               TO  RVKM100-SELECTA(PS-SUB)        26540000
265500                                                                  26550000
265600         IF (RV100-SELECT(RV100-BLK-SUB RV100-ITEM-SUB))          26560000
265700         OR (RV100-NO-SELECT(RV100-BLK-SUB RV100-ITEM-SUB))       26570000
265800             MOVE DP015-UNDERLINE TO RVKM100-SELECTH(PS-SUB)      26580000
265900             MOVE DP015-GREEN     TO RVKM100-SELECTC(PS-SUB)      26590000
266000         ELSE                                                     26600000
266100                                                                  26610000
266200             IF (RV100-BEGIN(RV100-BLK-SUB RV100-ITEM-SUB))       26620000
266300             OR (RV100-END(RV100-BLK-SUB RV100-ITEM-SUB))         26630000
266400                 MOVE DP015-UNDERLINE   TO RVKM100-SELECTH(PS-SUB)26640000
266500                 MOVE DP015-GREEN       TO RVKM100-SELECTC(PS-SUB)26650000
266600                 IF (DP020-MSG-NUMBER  =    PC-TSYMSG-00051       26660000
266700                                         OR PC-TSYMSG-00053       26670000
266800                    )                                             26680000
266900*                    UNPAIRED RANGE CHARACTER, SET WARNING        26690000
267000*                    ATTRIBUTES FOR RANGE CHARACTER:              26700000
267100                     MOVE DP015-REVERSE TO RVKM100-SELECTH(PS-SUB)26710000
267200                     MOVE DP015-YELLOW  TO RVKM100-SELECTC(PS-SUB)26720000
267300                 END-IF                                           26730000
267400                                                                  26740000
267500                 IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00054      26750000
267600                     AND RV100-BEGIN( RV100-BLK-SUB               26760000
267700                                      RV100-ITEM-SUB   )          26770000
267800                    )                                             26780000
267900*                    TWO OR MORE START-OF-RANGE CHARACTERS, SET   26790000
268000*                    ATTRIBUTES FOR START-OF-RANGE CHARACTERS:    26800000
268100                     MOVE DP015-REVERSE TO RVKM100-SELECTH(PS-SUB)26810000
268200                     MOVE DP015-RED     TO RVKM100-SELECTC(PS-SUB)26820000
268300                 END-IF                                           26830000
268400                                                                  26840000
268500                 IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00055      26850000
268600                     AND RV100-END( RV100-BLK-SUB                 26860000
268700                                    RV100-ITEM-SUB   )            26870000
268800                    )                                             26880000
268900*                    TWO OR MORE END-OF-RANGE CHARACTERS, SET     26890000
269000*                    ATTRIBUTES FOR END-OF-RANGE CHARACTERS:      26900000
269100                     MOVE DP015-REVERSE TO RVKM100-SELECTH(PS-SUB)26910000
269200                     MOVE DP015-RED     TO RVKM100-SELECTC(PS-SUB)26920000
269300                 END-IF                                           26930000
269400                                                                  26940000
269500                 IF  DP020-MSG-NUMBER  =  PC-TSYMSG-00052         26950000
269600*                    END-OF-RANGE PRECEDES START OF RANGE, SET    26960000
269700*                    ATTRIBUTES OF RANGE CHARACTERS:              26970000
269800                     MOVE DP015-REVERSE TO RVKM100-SELECTH(PS-SUB)26980000
269900                     MOVE DP015-RED     TO RVKM100-SELECTC(PS-SUB)26990000
270000                 END-IF                                           27000000
270100             END-IF                                               27010000
270200                                                                  27020000
270300         END-IF                                                   27030000
270400                                                                  27040000
270500         MOVE RV100-SELECTED-SW(RV100-BLK-SUB RV100-ITEM-SUB)     27050000
270600                               TO  RVKM100-SELECTI(PS-SUB)        27060000
270700                                                                  27070000
270800         IF (PS-SEND-MAP-N-DATA-FRSET)                            27080000
270900         OR (PS-DIFFERENT-ITEMS-DISPLAYED)                        27090000
271000                                                                  27100000
271100            MOVE RV100-ACTION (RV100-BLK-SUB RV100-ITEM-SUB)      27110000
271200                               TO  RVKM100-ACTION       (PS-SUB)  27120000
271300            IF  RVKM100-ACTION (PS-SUB) EQUAL PC-ERR              27130000
271400                MOVE DP015-RED TO  RVKM100-SELECTC (PS-SUB)       27140000
271500                MOVE DP015-REVERSE                                27150000
271600                               TO  RVKM100-SELECTH (PS-SUB)       27160000
271700                MOVE -1        TO  RVKM100-SELECTL (PS-SUB)       27170000
271800                SET PS-CURSOR-POSITIONED                          27180000
271900                               TO  TRUE                           27190000
272000                MOVE SPACE     TO  RV100-ACTION                   27200000
272100                                  (RV100-BLK-SUB RV100-ITEM-SUB)  27210000
272200                SET RV100-BLOCK-MODIFIED (RV100-BLK-SUB)          27220000
272300                               TO  TRUE                           27230000
272400            END-IF                                                27240000
272500                                                                  27250000
272600            MOVE RV100-STATUS      (RV100-BLK-SUB RV100-ITEM-SUB) 27260000
272700                               TO  RVKM100-STATUS-CDE    (PS-SUB) 27270000
272800                                                                  27280000
272900            MOVE RV100-TYPE        (RV100-BLK-SUB RV100-ITEM-SUB) 27290000
273000                               TO  RVKM100-TYPE-CDE      (PS-SUB) 27300000
273100                                                                  27310000
273200            MOVE RV100-REQ-RA      (RV100-BLK-SUB RV100-ITEM-SUB) 27320000
273300                               TO  RVKM100-REQ-RA        (PS-SUB) 27330000
273400                                                                  27340000
273500            MOVE RV100-VEND-NAME   (RV100-BLK-SUB RV100-ITEM-SUB) 27350000
273600                               TO  RVKM100-VENDOR-NAME   (PS-SUB) 27360000
273700                                                                  27370000
273800            MOVE RV100-CREATE-DATE (RV100-BLK-SUB RV100-ITEM-SUB) 27380000
273900                               TO  RVKM100-CREATE-DATE   (PS-SUB) 27390000
274000                                                                  27400000
274100            MOVE RV100-BUYER       (RV100-BLK-SUB RV100-ITEM-SUB) 27410000
274200                               TO  RVKM100-BUYER         (PS-SUB) 27420000
274300                                                                  27430000
274400            MOVE RV100-DUNS-NUMBER (RV100-BLK-SUB RV100-ITEM-SUB) 27440000
274500                               TO  RVKM100-DUNS-NUMBER   (PS-SUB) 27450000
274600                                                                  27460000
274700         END-IF                                                   27470000
274800                                                                  27480000
274900     ELSE                                                         27490000
275000                                                                  27500000
275100         IF (PS-SEND-MAP-N-DATA-FRSET)     OR                     27510000
275200            (PS-DIFFERENT-ITEMS-DISPLAYED)                        27520000
275300             MOVE SPACES       TO  RVKM100-SELECTI       (PS-SUB) 27530000
275400                                   RVKM100-ACTION        (PS-SUB) 27540000
275500                                   RVKM100-TYPE-CDE      (PS-SUB) 27550000
275600                                   RVKM100-STATUS-CDE    (PS-SUB) 27560000
275700                                   RVKM100-REQ-RA        (PS-SUB) 27570000
275800                                   RVKM100-VENDOR-NAME   (PS-SUB) 27580000
275900                                   RVKM100-CREATE-DATE   (PS-SUB) 27590000
276000                                   RVKM100-BUYER         (PS-SUB) 27600000
276100                                   RVKM100-DUNS-NUMBER   (PS-SUB) 27610000
276200             MOVE DP015-ASK-DRK-OFF                               27620000
276300                               TO  RVKM100-SELECTA(PS-SUB)        27630000
276400         END-IF                                                   27640000
276500                                                                  27650000
276600     END-IF.                                                      27660000
276700                                                                  27670000
276800     ADD +1 TO PV-ITEM-IN-USE.                                    27680000
276900     ADD +1 TO PS-SUB.                                            27690000
277000                                                                  27700000
277100 EJECT                                                            27710000
277200*----------------------------------------------------------------*27720000
277300*    FIND THE LAST SELECTION ENTRY IN THE MAP THAT IS NOT        *27730000
277400*    SPACES OR LOW VALUES AND POINT THE CURSOR TO THIS ENTRY.    *27740000
277500*    IF ALL ENTRIES ARE SPACES OR LOW VALUES, POINT THE CURSOR   *27750000
277600*    TO THE 1ST SELECTION ENTRY IN THE MAP.                      *27760000
277700*                                                                *27770000
277800*    PERFORMED BY I800-SET-CURSOR-POSITION.                      *27780000
277900*----------------------------------------------------------------*27790000
278000                                                                  27800000
278100 J200-FIND-LAST-SELECTION.                                        27810000
278200                                                                  27820000
278300     MOVE PC-ITEMS-PER-PANEL TO PS-SUB.                           27830000
278400                                                                  27840000
278500     SET PS-NO-SELECTION-FOUND TO TRUE.                           27850000
278600                                                                  27860000
278700     PERFORM                                                      27870000
278800         UNTIL (PS-SUB = +1)                                      27880000
278900            OR (PS-SELECTION-FOUND)                               27890000
279000                                                                  27900000
279100         IF (RVKM100-SELECTI(PS-SUB) NOT EQUAL SPACES             27910000
279200         AND RVKM100-SELECTI(PS-SUB) NOT EQUAL LOW-VALUE)         27920000
279300             SET PS-SELECTION-FOUND                               27930000
279400                               TO  TRUE                           27940000
279500         ELSE                                                     27950000
279600             SUBTRACT +1     FROM  PS-SUB                         27960000
279700         END-IF                                                   27970000
279800     END-PERFORM.                                                 27980000
279900                                                                  27990000
280000     MOVE -1                 TO  RVKM100-SELECTL(PS-SUB).         28000000
280100                                                                  28010000
280200 EJECT                                                            28020000
280300*----------------------------------------------------------------*28030000
280400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *28040000
280500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*28050000
280600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *28060000
280700*                                                                *28070000
280800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *28080000
280900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *28090000
281000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *28100000
281100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *28110000
281200*                                                                *28120000
281300*    PERFORMED BY E100-EDIT-SELECTIONS.                          *28130000
281400*    PERFORMED BY F100-EDIT.                                     *28140000
281500*    PERFORMED BY F300-CHECK-SELECTIONS.                         *28150000
281600*    PERFORMED BY J100-PROCESS-ITEMS.                            *28160000
281700*----------------------------------------------------------------*28170000
281800                                                                  28180000
281900 K100-SET-SUBSCRIPTS.                                             28190000
282000                                                                  28200000
282100     COMPUTE PS-ITEM-SUB =                                        28210000
282200         (PV-ITEM-IN-USE - RV100-LIST-ITEM-NUMBER(1 1)) + 1.      28220000
282300                                                                  28230000
282400     MOVE PS-ITEM-SUB TO RV100-ITEM-SUB.                          28240000
282500                                                                  28250000
282600     IF RV100-ITEM-SUB > PC-ITEMS-PER-BLOCK                       28260000
282700         SUBTRACT PC-ITEMS-PER-BLOCK FROM RV100-ITEM-SUB          28270000
282800                                                                  28280000
282900         MOVE PC-MAX-BLOCKS-IN-ARRAY TO RV100-BLK-SUB             28290000
283000     ELSE                                                         28300000
283100         MOVE +1                     TO RV100-BLK-SUB             28310000
283200     END-IF.                                                      28320000
283300                                                                  28330000
283400 EJECT                                                            28340000
283500*----------------------------------------------------------------*28350000
283600*    OPEN THE TMESSAGE CURSOR.                                   *28360000
283700*                                                                *28370000
283800*    PERFORMED BY D100-SETUP-INITIAL-PANEL                       *28380000
283900*                 G400-READ-ITEMS-INTO-ARRAY.                    *28390000
284000*----------------------------------------------------------------*28400000
284100                                                                  28410000
284200 L100-OPEN-CURSOR.                                                28420000
284300                                                                  28430000
284400     PERFORM                                                      28440000
284500         WITH TEST AFTER                                          28450000
284600         VARYING PV-SQL-SUB                                       28460000
284700         FROM 1 BY 1                                              28470000
284800         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             28480000
284900            OR SQLCODE = 0                                        28490000
285000            OR SQLCODE = +100                                     28500000
285100                                                                  28510000
285200         EVALUATE TRUE                                            28520000
285300             WHEN RV100-RA-NUMBER-CSR                             28530000
285400                 EXEC SQL                                         28540000
285500                      OPEN RA-NUMBER-CSR                          28550000
285600                 END-EXEC                                         28560000
285700                                                                  28570000
285800             WHEN RV100-STATUS-CSR                                28580000
285900                 EXEC SQL                                         28590000
286000                      OPEN STATUS-CSR                             28600000
286100                 END-EXEC                                         28610000
286200                                                                  28620000
286300             WHEN RV100-LOCATION-CSR                              28630000
286400                 EXEC SQL                                         28640000
286500                      OPEN LOCATION-CSR                           28650000
286600                 END-EXEC                                         28660000
286700                                                                  28670000
286800             WHEN RV100-VENDOR-NAME-CSR                           28680000
286900                 EXEC SQL                                         28690000
287000                      OPEN VENDOR-NAME-CSR                        28700000
287100                 END-EXEC                                         28710000
287200         END-EVALUATE                                             28720000
287300                                                                  28730000
287400         EVALUATE TRUE                                            28740000
287500             WHEN SQLCODE = -913                                  28750000
287600             WHEN SQLCODE = -904                                  28760000
287700             WHEN SQLCODE = ZERO                                  28770000
287800             WHEN SQLCODE = +100                                  28780000
287900                  CONTINUE                                        28790000
288000             WHEN SQLWARN0 NOT EQUAL SPACE                        28800000
288100             WHEN SQLCODE NOT EQUAL ZERO                          28810000
288200                  MOVE 'L100-OPEN-CURSOR'                         28820000
288300                               TO  DP013-PARAGRAPH                28830000
288400                  MOVE 'OPEN RTV CURSOR'                          28840000
288500                               TO  DP013-MESSAGE-TEXT (1)         28850000
288600                  MOVE SQLCA   TO  DP013-SQLCA                    28860000
288700                  SET DP013-DB2-ABEND                             28870000
288800                               TO  TRUE                           28880000
288900                  PERFORM DP013-0000-PROCESS-ABEND                28890000
289000         END-EVALUATE                                             28900000
289100     END-PERFORM.                                                 28910000
289200                                                                  28920000
289300     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   28930000
289400         MOVE 'L100-OPEN-CURSOR'                                  28940000
289500                               TO  DP013-PARAGRAPH                28950000
289600         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              28960000
289700                               TO  DP013-MESSAGE-TEXT (1)         28970000
289800         MOVE SQLCA            TO  DP013-SQLCA                    28980000
289900         SET DP013-DB2-ABEND   TO  TRUE                           28990000
290000         PERFORM DP013-0000-PROCESS-ABEND                         29000000
290100     END-IF.                                                      29010000
290200                                                                  29020000
290300 EJECT                                                            29030000
290400*----------------------------------------------------------------*29040000
290500*    OBTAIN THE NEXT ROW FOR THE APPROPRIATE CURSOR.             *29050000
290600*                                                                *29060000
290700*    PERFORMED BY H100                                           *29070000
290800*----------------------------------------------------------------*29080000
290900                                                                  29090000
291000 L200-FETCH.                                                      29100000
291100                                                                  29110000
291200     EVALUATE TRUE                                                29120000
291300                                                                  29130000
291400         WHEN RV100-RA-NUMBER-CSR                                 29140000
291500              EXEC SQL                                            29150000
291600                   FETCH RA-NUMBER-CSR                            29160000
291700                   INTO                                           29170000
291800                         :DFCTOR-DFCT-ORD-ID                      29180000
291900                       , :DFCTOR-VENDOR-DUNS-NBR                  29190000
292000                       , :DFCTOR-ORD-DTE                          29200000
292100                       , :DFCTOR-VEND-NAME                        29210000
292200                       , :DFCTOR-DFCT-ORD-ID-CDE                  29220000
292300                       , :DFCTOR-DFCT-ORD-STAT-CDE                29230000
292400              END-EXEC                                            29240000
292500                                                                  29250000
292600         WHEN RV100-STATUS-CSR                                    29260000
292700              EXEC SQL                                            29270000
292800                   FETCH STATUS-CSR                               29280000
292900                   INTO                                           29290000
293000                         :DFCTOR-DFCT-ORD-ID                      29300000
293100                       , :DFCTOR-VENDOR-DUNS-NBR                  29310000
293200                       , :DFCTOR-ORD-DTE                          29320000
293300                       , :DFCTOR-VEND-NAME                        29330000
293400                       , :DFCTOR-DFCT-ORD-ID-CDE                  29340000
293500                       , :DFCTOR-DFCT-ORD-STAT-CDE                29350000
293600              END-EXEC                                            29360000
293700                                                                  29370000
293800         WHEN RV100-LOCATION-CSR                                  29380000
293900              EXEC SQL                                            29390000
294000                   FETCH LOCATION-CSR                             29400000
294100                   INTO                                           29410000
294200                         :DFCTOR-DFCT-ORD-ID                      29420000
294300                       , :DFCTOR-VENDOR-DUNS-NBR                  29430000
294400                       , :DFCTOR-ORD-DTE                          29440000
294500                       , :DFCTOR-VEND-NAME                        29450000
294600                       , :DFCTOR-DFCT-ORD-ID-CDE                  29460000
294700                       , :DFCTOR-DFCT-ORD-STAT-CDE                29470000
294800              END-EXEC                                            29480000
294900                                                                  29490000
295000         WHEN RV100-VENDOR-NAME-CSR                               29500000
295100              EXEC SQL                                            29510000
295200                   FETCH VENDOR-NAME-CSR                          29520000
295300                   INTO                                           29530000
295400                         :DFCTOR-DFCT-ORD-ID                      29540000
295500                       , :DFCTOR-VENDOR-DUNS-NBR                  29550000
295600                       , :DFCTOR-ORD-DTE                          29560000
295700                       , :DFCTOR-VEND-NAME                        29570000
295800                       , :DFCTOR-DFCT-ORD-ID-CDE                  29580000
295900                       , :DFCTOR-DFCT-ORD-STAT-CDE                29590000
296000              END-EXEC                                            29600000
296100                                                                  29610000
296200     END-EVALUATE.                                                29620000
296300                                                                  29630000
296400     EVALUATE TRUE                                                29640000
296500         WHEN SQLCODE = ZERO                                      29650000
296600         WHEN SQLCODE = +100                                      29660000
296700              CONTINUE                                            29670000
296800         WHEN SQLWARN0 NOT EQUAL SPACE                            29680000
296900         WHEN SQLCODE NOT EQUAL ZERO                              29690000
297000              MOVE 'L200-FETCH-CURSOR'                            29700000
297100                               TO  DP013-PARAGRAPH                29710000
297200              MOVE 'FETCH RTV CURSOR'                             29720000
297300                               TO  DP013-MESSAGE-TEXT (1)         29730000
297400              MOVE SQLCA       TO  DP013-SQLCA                    29740000
297500              SET DP013-DB2-ABEND                                 29750000
297600                               TO  TRUE                           29760000
297700              PERFORM DP013-0000-PROCESS-ABEND                    29770000
297800     END-EVALUATE.                                                29780000
297900                                                                  29790000
298000     IF  SQLCODE EQUAL +100                                       29800000
298100         SET RV100-NO-ITEMS-LEFT-ON-DB                            29810000
298200                               TO  TRUE                           29820000
298300     ELSE                                                         29830000
298400         PERFORM L400-GET-BUYER-NAME                              29840000
298500                                                                  29850000
298600     END-IF.                                                      29860000
298700                                                                  29870000
298800*----------------------------------------------------------------*29880000
298900*   CLOSE THE TMESSAGE CURSOR.                                   *29890000
299000*                                                                *29900000
299100*    PERFORMED BY D100-SETUP-INITIAL-PANEL                       *29910000
299200*                 G400-READ-ITEMS-INTO-ARRAY.                    *29920000
299300*----------------------------------------------------------------*29930000
299400                                                                  29940000
299500 L300-CLOSE-CURSOR.                                               29950000
299600                                                                  29960000
299700     PERFORM                                                      29970000
299800         WITH TEST AFTER                                          29980000
299900         VARYING PV-SQL-SUB                                       29990000
300000         FROM 1 BY 1                                              30000000
300100         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             30010000
300200            OR SQLCODE = 0                                        30020000
300300            OR SQLCODE = +100                                     30030000
300400                                                                  30040000
300500         EVALUATE TRUE                                            30050000
300600             WHEN RV100-RA-NUMBER-CSR                             30060000
300700                 EXEC SQL                                         30070000
300800                     CLOSE RA-NUMBER-CSR                          30080000
300900                 END-EXEC                                         30090000
301000                                                                  30100000
301100             WHEN RV100-STATUS-CSR                                30110000
301200                 EXEC SQL                                         30120000
301300                     CLOSE STATUS-CSR                             30130000
301400                 END-EXEC                                         30140000
301500                                                                  30150000
301600             WHEN RV100-LOCATION-CSR                              30160000
301700                 EXEC SQL                                         30170000
301800                     CLOSE LOCATION-CSR                           30180000
301900                 END-EXEC                                         30190000
302000                                                                  30200000
302100             WHEN RV100-VENDOR-NAME-CSR                           30210000
302200                 EXEC SQL                                         30220000
302300                     CLOSE VENDOR-NAME-CSR                        30230000
302400                 END-EXEC                                         30240000
302500         END-EVALUATE                                             30250000
302600                                                                  30260000
302700         EVALUATE TRUE                                            30270000
302800             WHEN SQLCODE = -913                                  30280000
302900             WHEN SQLCODE = -904                                  30290000
303000             WHEN SQLCODE = ZERO                                  30300000
303100             WHEN SQLCODE = +100                                  30310000
303200                  CONTINUE                                        30320000
303300             WHEN SQLWARN0 NOT EQUAL SPACE                        30330000
303400             WHEN SQLCODE NOT EQUAL ZERO                          30340000
303500                  MOVE 'L300-CLOSE-CURSOR'                        30350000
303600                               TO  DP013-PARAGRAPH                30360000
303700                  MOVE 'CLOSE RTV CURSOR'                         30370000
303800                               TO  DP013-MESSAGE-TEXT (1)         30380000
303900                  MOVE SQLCA   TO  DP013-SQLCA                    30390000
304000                  SET DP013-DB2-ABEND                             30400000
304100                               TO  TRUE                           30410000
304200                  PERFORM DP013-0000-PROCESS-ABEND                30420000
304300         END-EVALUATE                                             30430000
304400     END-PERFORM.                                                 30440000
304500                                                                  30450000
304600     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   30460000
304700         MOVE 'L300-CLOSE-CURSOR'                                 30470000
304800                               TO  DP013-PARAGRAPH                30480000
304900         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE CURSOR'             30490000
305000                               TO  DP013-MESSAGE-TEXT (1)         30500000
305100         MOVE SQLCA            TO  DP013-SQLCA                    30510000
305200         SET DP013-DB2-ABEND   TO  TRUE                           30520000
305300         PERFORM DP013-0000-PROCESS-ABEND                         30530000
305400     END-IF.                                                      30540000
305500                                                                  30550000
305600 EJECT                                                            30560000
305700*----------------------------------------------------------------*30570000
305800*    GET THE BUYER NAME.                                         *30580000
305900*                                                                *30590000
306000*    PERFORMED BY L200                                           *30600000
306100*----------------------------------------------------------------*30610000
306200                                                                  30620000
306300 L400-GET-BUYER-NAME.                                             30630000
306400                                                                  30640000
306500     PERFORM                                                      30650000
306600         WITH TEST AFTER                                          30660000
306700         VARYING PV-SQL-SUB                                       30670000
306800         FROM 1 BY 1                                              30680000
306900         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             30690000
307000            OR SQLCODE = 0                                        30700000
307100            OR SQLCODE = +100                                     30710000
307200            OR SQLCODE = -811                                     30720000
307300                                                                  30730000
307400            EXEC SQL                                              30740000
307500                                                                  30750000
307600                 SELECT DISTINCT                                  30760000
307700                       V.DEPT_NBR                                 30770000
307800                  INTO                                            30780000
307900                       :XLT00004-DEPT-NBR                         30790000
308000                  FROM                                            30800000
308100                       TDFMEIT I                                  30810000
308200                     , XLT_VND_STYL V                             30820000
308300                     , XLT_SKU S                                  30830000
308400                 WHERE                                            30840000
308500                       I.DFCT_ORD_ID     =  :DFCTOR-DFCT-ORD-ID   30850000
308600                   AND S.ITM_NBR         =  I.DFCT_ITEM_NBR       30860000
308700                   AND V.STYL_ID         =  S.STYL_ID             30870000
308800            END-EXEC                                              30880000
308900                                                                  30890000
309000         EVALUATE TRUE                                            30900000
309100             WHEN SQLCODE = ZERO                                  30910000
309200             WHEN SQLCODE = +100                                  30920000
309300             WHEN SQLCODE = -904                                  30930000
309400             WHEN SQLCODE = -913                                  30940000
309500                  CONTINUE                                        30950000
309600             WHEN SQLCODE = -811                                  30960000
309700                  MOVE 'MULTIPLE BUYERS   '                       30970000
309800                               TO RSPBAR-WORKER-LAST-NAME         30980000
309900             WHEN SQLWARN0 NOT EQUAL SPACE                        30990000
310000             WHEN SQLCODE NOT EQUAL ZERO                          31000000
310100                  MOVE 'L400-GET-BUYER-NAME'                      31010000
310200                               TO  DP013-PARAGRAPH                31020000
310300                  MOVE 'SELECT FOR DEPARTMENT NUMBER '            31030000
310400                               TO  DP013-MESSAGE-TEXT (1)         31040000
310500                  MOVE SQLCA   TO  DP013-SQLCA                    31050000
310600                  SET DP013-DB2-ABEND                             31060000
310700                               TO  TRUE                           31070000
310800                  PERFORM DP013-0000-PROCESS-ABEND                31080000
310900         END-EVALUATE                                             31090000
311000     END-PERFORM.                                                 31100000
311100                                                                  31110000
311200     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   31120000
311300         MOVE 'L400-GET-BUYER-NAME '                              31130000
311400                               TO  DP013-PARAGRAPH                31140000
311500         MOVE 'MAX RETRIES EXCEEDED FOR DEPT'                     31150000
311600                               TO  DP013-MESSAGE-TEXT (1)         31160000
311700         MOVE SQLCA            TO  DP013-SQLCA                    31170000
311800         SET DP013-DB2-ABEND   TO  TRUE                           31180000
311900         PERFORM DP013-0000-PROCESS-ABEND                         31190000
312000     END-IF.                                                      31200000
312100                                                                  31210000
312200     IF  SQLCODE EQUAL +100                                       31220000
312300         MOVE 'NOT FOUND'      TO  RSPBAR-WORKER-LAST-NAME        31230000
312400     END-IF.                                                      31240000
312500                                                                  31250000
312600                                                                  31260000
312700     IF  SQLCODE EQUAL +100 OR SQLCODE = -811                     31270000
312800         CONTINUE                                                 31280000
312900     ELSE                                                         31290000
313000         MOVE XLT00004-DEPT-NBR TO PV-DEPT                        31300000
313100         MOVE PV-DEPT(2:3)      TO MDSEAR-DEPT-NBR                31310000
313200         MOVE PC-COMPANY        TO MDSEAR-OPERCO-NBR              31320000
313300         MOVE PC-DPT            TO MDSEAR-MDSELV-CDE              31330000
313400         MOVE PC-BYR            TO RSPBAR-RSPLVL-CDE              31340000
313500                                                                  31350000
313600         PERFORM                                                  31360000
313700             WITH TEST AFTER                                      31370000
313800             VARYING PV-SQL-SUB                                   31380000
313900             FROM 1 BY 1                                          31390000
314000             UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES         31400000
314100                OR SQLCODE = 0                                    31410000
314200                OR SQLCODE = +100                                 31420000
314300                                                                  31430000
314400                EXEC SQL                                          31440000
314500                                                                  31450000
314600                     SELECT DISTINCT                              31460000
314700                           R.WORKER_LAST_NAME                     31470000
314800                      INTO                                        31480000
314900                           :RSPBAR-WORKER-LAST-NAME               31490000
315000                      FROM                                        31500000
315100                           TMDSEAR A                              31510000
315200                         , TRSPBAR R                              31520000
315300                     WHERE                                        31530000
315400                           A.DEPT_NBR     =  :MDSEAR-DEPT-NBR     31540000
315500                       AND A.OPERCO_NBR   =  :MDSEAR-OPERCO-NBR   31550000
315600                       AND A.MDSELV_CDE   =  :MDSEAR-MDSELV-CDE   31560000
315700                       AND A.MDSEAR_DKEY  =  R.MDSEAR_DKEY        31570000
315800                       AND R.RSPLVL_CDE   =  :RSPBAR-RSPLVL-CDE   31580000
315900                       AND R.WORKER_STRT_DTE <= CURRENT DATE      31590000
316000                       AND R.WORKER_END_DTE  >= CURRENT DATE      31600000
316100                END-EXEC                                          31610000
316200                                                                  31620000
316300             EVALUATE TRUE                                        31630000
316400                 WHEN SQLCODE = ZERO                              31640000
316500                 WHEN SQLCODE = +100                              31650000
316600                 WHEN SQLCODE = -904                              31660000
316700                 WHEN SQLCODE = -913                              31670000
316800                      CONTINUE                                    31680000
316900                 WHEN SQLWARN0 NOT EQUAL SPACE                    31690000
317000                 WHEN SQLCODE NOT EQUAL ZERO                      31700000
317100                      MOVE 'L400-GET-BUYER-NAME'                  31710000
317200                                   TO  DP013-PARAGRAPH            31720000
317300                      MOVE 'SELECT FOR BUYER NAME'                31730000
317400                                   TO  DP013-MESSAGE-TEXT (1)     31740000
317500                      MOVE SQLCA   TO  DP013-SQLCA                31750000
317600                      SET DP013-DB2-ABEND                         31760000
317700                                   TO  TRUE                       31770000
317800                      PERFORM DP013-0000-PROCESS-ABEND            31780000
317900             END-EVALUATE                                         31790000
318000         END-PERFORM                                              31800000
318100                                                                  31810000
318200         IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES               31820000
318300             MOVE 'L400-GET-BUYER-NAME'                           31830000
318400                                   TO  DP013-PARAGRAPH            31840000
318500             MOVE 'MAX RETRIES EXCEEDED FOR BUYER'                31850000
318600                                   TO  DP013-MESSAGE-TEXT (1)     31860000
318700             MOVE SQLCA            TO  DP013-SQLCA                31870000
318800             SET DP013-DB2-ABEND   TO  TRUE                       31880000
318900             PERFORM DP013-0000-PROCESS-ABEND                     31890000
319000         END-IF                                                   31900000
319100                                                                  31910000
319200         IF  SQLCODE EQUAL +100                                   31920000
319300             MOVE 'NOT FOUND'      TO  RSPBAR-WORKER-LAST-NAME    31930000
319400         END-IF                                                   31940000
319500     END-IF.                                                      31950000
319600                                                                  31960000
319700 EJECT                                                            31970000
319800*----------------------------------------------------------------*31980000
319900*    PREPARE THE TEMPORARY STORAGE QUEUE "B".  MOVE ALL SELECTED *31990000
320000*    ITEMS FROM TEMP STORAGE QUEUE "A" (SCROLL QUEUE) TO THE     *32000000
320100*    SELECTED ITEM LAYOUT FOR QUEUE "B".                         *32010000
320200*                                                                *32020000
320300*    FIRST, PREPARE QUEUE "B" NAME, THEN DELETE THE QUEUE, NEXT  *32030000
320400*    LOAD THE QUEUE "B" RECORD.  WRITE A QUEUE "B" RECORD WHEN   *32040000
320500*    THE MAXIMUM ENTRIES ARE FULL.                               *32050000
320600*                                                                *32060000
320700*    PERFORMED BY D300                                           *32070000
320800*----------------------------------------------------------------*32080000
320900                                                                  32090000
321000 X100-PREPARE-LIST-QUEUE.                                         32100000
321100                                                                  32110000
321200     MOVE +1                   TO  RV100-BLK-SUB.                 32120000
321300     PERFORM Z150-WRITE-TEMP-STORAGE.                             32130000
321400     ADD +1                    TO  RV100-BLK-SUB.                 32140000
321500     PERFORM Z150-WRITE-TEMP-STORAGE.                             32150000
321600                                                                  32160000
321700     MOVE RV100-TERM-ID        TO  PV-BG-TERM-ID.                 32170000
321800     MOVE RV100-TASK-NUMBER    TO  PV-BG-TASK-NUMBER.             32180000
321900     MOVE 1                    TO  PV-BG-SEQUENCE.                32190000
322000                                                                  32200000
322100     MOVE PV-BG-QUEUE-NAME     TO  RV100-HOLD-TSQB-QUEUE-NAME     32210000
322200                                   RV100-TSQB-QUEUE-NAME.         32220000
322300     MOVE LENGTH OF RV101-RA-REQUEST-RECORD                       32230000
322400                               TO  RV100-TSQB-QUEUE-LENGTH.       32240000
322500     PERFORM X900-DELETE-LIST-QUEUE.                              32250000
322600                                                                  32260000
322700     SET RV100-UPDATE-TSQ      TO  TRUE.                          32270000
322800                                                                  32280000
322900     SET RV101-IDX             TO  1.                             32290000
323000     INITIALIZE RV101-RA-REQUEST-RECORD.                          32300000
323100                                                                  32310000
323200     PERFORM X200-PROCESS-TS-QUEUE                                32320000
323300             VARYING PV-ITEM                                      32330000
323400             FROM 1 BY 1                                          32340000
323500             UNTIL PV-ITEM GREATER RV100-HIGHEST-BLOCK-WRITTEN.   32350000
323600                                                                  32360000
323700     PERFORM X500-WRITE-LIST-QUEUE.                               32370000
323800                                                                  32380000
323900 EJECT                                                            32390000
324000*----------------------------------------------------------------*32400000
324100*    READ A TS QUEUE RECORD, MOVE SELECTED RECORDS TO THE        *32410000
324200*    APPLICATIONS SYSTEM LIST QUEUE RECORD.                      *32420000
324300*                                                                *32430000
324400*    PERFORMED BY X100                                           *32440000
324500*----------------------------------------------------------------*32450000
324600                                                                  32460000
324700 X200-PROCESS-TS-QUEUE.                                           32470000
324800                                                                  32480000
324900     PERFORM X300-READ-TS-QUEUE.                                  32490000
325000                                                                  32500000
325100     IF  PV-RESP EQUAL DFHRESP(NORMAL)                            32510000
325200         PERFORM                                                  32520000
325300         VARYING PV-TW-IDX                                        32530000
325400         FROM 1 BY 1                                              32540000
325500         UNTIL PV-TW-IDX GREATER THAN PC-ITEMS-PER-BLOCK          32550000
325600           OR  PV-TW-LIST-ITEM-NUMBER (PV-TW-IDX) EQUAL ZERO      32560000
325700                                                                  32570000
325800             IF  PV-TW-SELECT (PV-TW-IDX)                         32580000
325900                 MOVE PV-TW-RA-NUMBER (PV-TW-IDX)                 32590000
326000                               TO  RV101-RA-NUMBER                32600000
326100                                        (RV101-IDX)               32610000
326200                                                                  32620000
326300                 MOVE PV-TW-LIST-ITEM-NUMBER (PV-TW-IDX)          32630000
326400                               TO  RV101-ITEM (RV101-IDX)         32640000
326500                                                                  32650000
326600                 SET RV101-IDX UP BY 1                            32660000
326700                 IF  RV101-IDX GREATER PC-MAX-WR-ITEMS            32670000
326800                     PERFORM X500-WRITE-LIST-QUEUE                32680000
326900                 END-IF                                           32690000
327000             END-IF                                               32700000
327100                                                                  32710000
327200         END-PERFORM                                              32720000
327300     END-IF.                                                      32730000
327400                                                                  32740000
327500 EJECT                                                            32750000
327600*----------------------------------------------------------------*32760000
327700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*32770000
327800*                                                                *32780000
327900*    PERFORMED BY C500, X200                                     *32790000
328000*----------------------------------------------------------------*32800000
328100                                                                  32810000
328200 X300-READ-TS-QUEUE.                                              32820000
328300                                                                  32830000
328400     MOVE LENGTH OF PV-TEMP-WORK-AREA      TO PV-BLOCK-LENGTH.    32840000
328500                                                                  32850000
328600     EXEC CICS                                                    32860000
328700         READQ TS                                                 32870000
328800         QUEUE(RV100-TEMP-QUEUE-NAME)                             32880000
328900         INTO(PV-TEMP-WORK-AREA)                                  32890000
329000         LENGTH(PV-BLOCK-LENGTH)                                  32900000
329100         ITEM(PV-ITEM)                                            32910000
329200         RESP(PV-RESP)                                            32920000
329300     END-EXEC.                                                    32930000
329400                                                                  32940000
329500 EJECT                                                            32950000
329600*----------------------------------------------------------------*32960000
329700*    WRITE THE STORE SELECTION RECORD (QUEUE "B").               *32970000
329800*                                                                *32980000
329900*    PERFORMED BY X100                                           *32990000
330000*----------------------------------------------------------------*33000000
330100                                                                  33010000
330200 X500-WRITE-LIST-QUEUE.                                           33020000
330300                                                                  33030000
330400     IF  RV101-IDX GREATER THAN 1                                 33040000
330500         MOVE PC-MAX-WR-ITEMS  TO  RV101-RA-MAX-ITEMS             33050000
330600         MOVE RV100-NUMBER-OF-SELECTED-ITEMS                      33060000
330700                               TO  RV101-RA-SELECTED-ITEMS        33070000
330800                                                                  33080000
330900         EXEC CICS                                                33090000
331000              WRITEQ TS                                           33100000
331100              QUEUE(RV100-TSQB-QUEUE-NAME)                        33110000
331200              FROM(RV101-RA-REQUEST-RECORD)                       33120000
331300              LENGTH(RV100-TSQB-QUEUE-LENGTH)                     33130000
331400              ITEM(PV-TSQ-B-ITEM)                                 33140000
331500              RESP(PV-RESP)                                       33150000
331600         END-EXEC                                                 33160000
331700                                                                  33170000
331800         IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                    33180000
331900             SET PS-DONT-PROCESS                                  33190000
332000                               TO  TRUE                           33200000
332100         END-IF                                                   33210000
332200                                                                  33220000
332300         INITIALIZE RV101-RA-REQUEST-RECORD                       33230000
332400         SET RV101-IDX         TO  1                              33240000
332500     END-IF.                                                      33250000
332600                                                                  33260000
332700 EJECT                                                            33270000
332800*----------------------------------------------------------------*33280000
332900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *33290000
333000*                                                                *33300000
333100*    PERFORMED BY C500, C600                                     *33310000
333200*----------------------------------------------------------------*33320000
333300                                                                  33330000
333400 X550-WRITE-TS-QUEUE.                                             33340000
333500                                                                  33350000
333600     MOVE LENGTH OF PV-TEMP-WORK-AREA      TO PV-BLOCK-LENGTH.    33360000
333700                                                                  33370000
333800     EXEC CICS                                                    33380000
333900         WRITEQ TS                                                33390000
334000         REWRITE                                                  33400000
334100         QUEUE(RV100-TEMP-QUEUE-NAME)                             33410000
334200         FROM(PV-TEMP-WORK-AREA)                                  33420000
334300         LENGTH(PV-BLOCK-LENGTH)                                  33430000
334400         ITEM(PV-SAVE-ITEM)                                       33440000
334500         RESP(PV-RESP)                                            33450000
334600     END-EXEC.                                                    33460000
334700                                                                  33470000
334800 EJECT                                                            33480000
334900*----------------------------------------------------------------*33490000
335000*    READ THE LIST QUEUE RECORD.                                 *33500000
335100*                                                                *33510000
335200*    PERFORMED BY C500                                           *33520000
335300*----------------------------------------------------------------*33530000
335400                                                                  33540000
335500 X600-READ-LIST-QUEUE.                                            33550000
335600                                                                  33560000
335700     EXEC CICS                                                    33570000
335800          READQ TS                                                33580000
335900          QUEUE(RV100-TSQB-QUEUE-NAME)                            33590000
336000          INTO(RV101-RA-REQUEST-RECORD)                           33600000
336100          LENGTH(RV100-TSQB-QUEUE-LENGTH)                         33610000
336200          ITEM(PV-TSQ-B-ITEM)                                     33620000
336300          RESP(PV-RESP)                                           33630000
336400     END-EXEC.                                                    33640000
336500                                                                  33650000
336600 EJECT                                                            33660000
336700*----------------------------------------------------------------*33670000
336800*    DELETE THE STORE SELECTION STORAGE QUEUE ("B").             *33680000
336900*                                                                *33690000
337000*    PERFORMED BY X100                                           *33700000
337100*----------------------------------------------------------------*33710000
337200                                                                  33720000
337300 X900-DELETE-LIST-QUEUE.                                          33730000
337400                                                                  33740000
337500     EXEC CICS                                                    33750000
337600         DELETEQ TS                                               33760000
337700         QUEUE(RV100-TSQB-QUEUE-NAME)                             33770000
337800         RESP(PV-RESP)                                            33780000
337900     END-EXEC.                                                    33790000
338000                                                                  33800000
338100 EJECT                                                            33810000
338200*----------------------------------------------------------------*33820000
338300*    DELETE THE TEMPORARY STORAGE QUEUE.                         *33830000
338400*                                                                *33840000
338500*    PERFORMED BY C300-PROCESS-PANEL.                            *33850000
338600*----------------------------------------------------------------*33860000
338700                                                                  33870000
338800 Z050-DELETE-TEMP-STORAGE.                                        33880000
338900                                                                  33890000
339000     EXEC CICS                                                    33900000
339100         DELETEQ TS                                               33910000
339200         QUEUE(RV100-TEMP-QUEUE-NAME)                             33920000
339300         RESP(PV-RESP)                                            33930000
339400     END-EXEC.                                                    33940000
339500                                                                  33950000
339600     IF (PV-RESP NOT = DFHRESP(NORMAL)) AND                       33960000
339700        (PV-RESP NOT = DFHRESP(QIDERR))                           33970000
339800         MOVE PV-RESP TO PM-RESP-23                               33980000
339900                                                                  33990000
340000         SET DP013-LOGIC-ABEND TO TRUE                            34000000
340100         SET DP013-NO-ROLLBACK TO TRUE                            34010000
340200                                                                  34020000
340300         MOVE 'Z050-DELETE-TEMP-STORAGE' TO DP013-PARAGRAPH       34030000
340400         MOVE PM-PROGRAM-MESSAGE-23      TO DP013-MESSAGE-TEXT(1) 34040000
340500                                                                  34050000
340600         PERFORM DP013-0000-PROCESS-ABEND                         34060000
340700     END-IF.                                                      34070000
340800                                                                  34080000
340900     MOVE +0 TO RV100-HIGHEST-BLOCK-WRITTEN.                      34090000
341000                                                                  34100000
341100 EJECT                                                            34110000
341200*----------------------------------------------------------------*34120000
341300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *34130000
341400*                                                                *34140000
341500*    PERFORMED BY D400-REFRESH-BLOCK-ARRAY.                      *34150000
341600*    PERFORMED BY E700-DESELECT-ALL-ITEMS.                       *34160000
341700*    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                   *34170000
341800*    PERFORMED BY G500-SCROLL-FORWARD.                           *34180000
341900*    PERFORMED BY G600-SCROLL-BACKWARD.                          *34190000
342000*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                      *34200000
342100*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                   *34210000
342200*----------------------------------------------------------------*34220000
342300                                                                  34230000
342400 Z100-READ-TEMP-STORAGE.                                          34240000
342500                                                                  34250000
342600     MOVE LENGTH OF RV100-BLOCK-ENTRIES(RV100-BLK-SUB)            34260000
342700                                           TO PV-BLOCK-LENGTH.    34270000
342800                                                                  34280000
342900     EXEC CICS                                                    34290000
343000         READQ TS                                                 34300000
343100         QUEUE(RV100-TEMP-QUEUE-NAME)                             34310000
343200         INTO(RV100-BLOCK-ENTRIES(RV100-BLK-SUB))                 34320000
343300         LENGTH(PV-BLOCK-LENGTH)                                  34330000
343400         ITEM(PV-BLOCK-NUMBER)                                    34340000
343500         RESP(PV-RESP)                                            34350000
343600     END-EXEC.                                                    34360000
343700                                                                  34370000
343800     IF PV-RESP NOT = DFHRESP(NORMAL)                             34380000
343900         MOVE PV-RESP          TO  PM-RESP-24                     34390000
344000         EXEC CICS                                                34400000
344100              DELETEQ TS                                          34410000
344200              QUEUE(RV100-TEMP-QUEUE-NAME)                        34420000
344300              RESP(PV-RESP)                                       34430000
344400         END-EXEC                                                 34440000
344500         SET DP013-LOGIC-ABEND TO  TRUE                           34450000
344600         SET DP013-NO-ROLLBACK TO  TRUE                           34460000
344700         MOVE 'Z100-READ-TEMP-STORAGE'                            34470000
344800                               TO  DP013-PARAGRAPH                34480000
344900         MOVE PM-PROGRAM-MESSAGE-24                               34490000
345000                               TO  DP013-MESSAGE-TEXT(1)          34500000
345100         PERFORM DP013-0000-PROCESS-ABEND                         34510000
345200     END-IF.                                                      34520000
345300                                                                  34530000
345400     SET RV100-BLOCK-NOT-MODIFIED(RV100-BLK-SUB) TO TRUE.         34540000
345500                                                                  34550000
345600 EJECT                                                            34560000
345700*----------------------------------------------------------------*34570000
345800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *34580000
345900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *34590000
346000*                                                                *34600000
346100*    PERFORMED BY E300-NAVIGATE.                                 *34610000
346200*    PERFORMED BY E700-DESELECT-ALL-ITEMS.                       *34620000
346300*    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                   *34630000
346400*    PERFORMED BY G500-SCROLL-FORWARD.                           *34640000
346500*    PERFORMED BY G600-SCROLL-BACKWARD.                          *34650000
346600*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                      *34660000
346700*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                   *34670000
346800*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                       *34680000
346900*----------------------------------------------------------------*34690000
347000                                                                  34700000
347100 Z150-WRITE-TEMP-STORAGE.                                         34710000
347200                                                                  34720000
347300     IF RV100-HIGHEST-BLOCK-WRITTEN = +0                          34730000
347400         MOVE EIBTASKN         TO  DP020-SRC-TASK-NUMBER          34740000
347500         MOVE EIBTASKN         TO  RV100-TASK-NUMBER              34750000
347600         MOVE EIBTRMID         TO  RV100-TERM-ID                  34760000
347700     END-IF.                                                      34770000
347800                                                                  34780000
347900     MOVE RV100-LIST-ITEM-NUMBER(RV100-BLK-SUB 1)                 34790000
348000                               TO  PV-LIST-ITEM-NUMBER.           34800000
348100     COMPUTE PV-BLOCK-NUMBER =                                    34810000
348200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK).    34820000
348300                                                                  34830000
348400     IF (PV-BLOCK-NUMBER < RV100-HIGHEST-BLOCK-WRITTEN)           34840000
348500     OR (PV-BLOCK-NUMBER = RV100-HIGHEST-BLOCK-WRITTEN)           34850000
348600         IF  RV100-BLOCK-MODIFIED(RV100-BLK-SUB)                  34860000
348700             MOVE LENGTH OF RV100-BLOCK-ENTRIES(RV100-BLK-SUB)    34870000
348800                                           TO PV-BLOCK-LENGTH     34880000
348900             EXEC CICS                                            34890000
349000                 WRITEQ TS                                        34900000
349100                 QUEUE(RV100-TEMP-QUEUE-NAME)                     34910000
349200                 FROM(RV100-BLOCK-ENTRIES(RV100-BLK-SUB))         34920000
349300                 LENGTH(PV-BLOCK-LENGTH)                          34930000
349400                 ITEM(PV-BLOCK-NUMBER)                            34940000
349500                 REWRITE                                          34950000
349600                 RESP(PV-RESP)                                    34960000
349700             END-EXEC                                             34970000
349800                                                                  34980000
349900             IF  PV-RESP NOT = DFHRESP(NORMAL)                    34990000
350000                 MOVE PV-RESP  TO  PM-RESP-9                      35000000
350100                 EXEC CICS                                        35010000
350200                     DELETEQ TS                                   35020000
350300                     QUEUE(RV100-TEMP-QUEUE-NAME)                 35030000
350400                     RESP(PV-RESP)                                35040000
350500                 END-EXEC                                         35050000
350600                                                                  35060000
350700                 SET DP013-LOGIC-ABEND                            35070000
350800                               TO  TRUE                           35080000
350900                 SET DP013-NO-ROLLBACK                            35090000
351000                               TO  TRUE                           35100000
351100                 MOVE 'Z150-WRITE-TEMP-STORAGE'                   35110000
351200                               TO  DP013-PARAGRAPH                35120000
351300                 MOVE PM-PROGRAM-MESSAGE-9                        35130000
351400                               TO  DP013-MESSAGE-TEXT(1)          35140000
351500                 PERFORM DP013-0000-PROCESS-ABEND                 35150000
351600             END-IF                                               35160000
351700         END-IF                                                   35170000
351800     ELSE                                                         35180000
351900                                                                  35190000
352000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35200000
352100             RV100-HIGHEST-BLOCK-WRITTEN + 1                      35210000
352200         IF  PV-BLOCK-NUMBER = PV-HIGHEST-BLOCK-WRITTEN           35220000
352300             MOVE LENGTH OF RV100-BLOCK-ENTRIES(RV100-BLK-SUB)    35230000
352400                                           TO PV-BLOCK-LENGTH     35240000
352500             EXEC CICS                                            35250000
352600                 WRITEQ TS                                        35260000
352700                 QUEUE(RV100-TEMP-QUEUE-NAME)                     35270000
352800                 FROM(RV100-BLOCK-ENTRIES(RV100-BLK-SUB))         35280000
352900                 LENGTH(PV-BLOCK-LENGTH)                          35290000
353000                 ITEM(PV-BLOCK-NUMBER)                            35300000
353100                 RESP(PV-RESP)                                    35310000
353200             END-EXEC                                             35320000
353300                                                                  35330000
353400             IF  PV-RESP NOT = DFHRESP(NORMAL)                    35340000
353500                 MOVE PV-RESP  TO  PM-RESP-10                     35350000
353600                 EXEC CICS                                        35360000
353700                     DELETEQ TS                                   35370000
353800                     QUEUE(RV100-TEMP-QUEUE-NAME)                 35380000
353900                     RESP(PV-RESP)                                35390000
354000                 END-EXEC                                         35400000
354100                                                                  35410000
354200                 SET DP013-LOGIC-ABEND                            35420000
354300                               TO  TRUE                           35430000
354400                 SET DP013-NO-ROLLBACK                            35440000
354500                               TO  TRUE                           35450000
354600                 MOVE 'Z150-WRITE-TEMP-STORAGE'                   35460000
354700                               TO  DP013-PARAGRAPH                35470000
354800                 MOVE PM-PROGRAM-MESSAGE-10                       35480000
354900                               TO  DP013-MESSAGE-TEXT(1)          35490000
355000                 PERFORM DP013-0000-PROCESS-ABEND                 35500000
355100             END-IF                                               35510000
355200             ADD +1            TO  RV100-HIGHEST-BLOCK-WRITTEN    35520000
355300         ELSE                                                     35530000
355400             SET DP013-LOGIC-ABEND                                35540000
355500                               TO  TRUE                           35550000
355600             SET DP013-NO-ROLLBACK                                35560000
355700                               TO  TRUE                           35570000
355800             MOVE 'Z150-WRITE-TEMP-STORAGE'                       35580000
355900                               TO  DP013-PARAGRAPH                35590000
356000             MOVE PV-BLOCK-NUMBER                                 35600000
356100                               TO  PM-BLOCK-NUMBER                35610000
356200             MOVE PM-PROGRAM-MESSAGE-11                           35620000
356300                               TO  DP013-MESSAGE-TEXT(1)          35630000
356400             PERFORM DP013-0000-PROCESS-ABEND                     35640000
356500         END-IF                                                   35650000
356600     END-IF.                                                      35660000
356700                                                                  35670000
356800     SET RV100-BLOCK-NOT-MODIFIED(RV100-BLK-SUB) TO TRUE.         35680000
356900                                                                  35690000
357000 EJECT                                                            35700000
357100*----------------------------------------------------------------*35710000
357200*    FILL IN SCREEN HEADER MODULE                                *35720000
357300*----------------------------------------------------------------*35730000
357400                                                                  35740000
357500     COPY DPPD022.                                                35750000
357600 EJECT                                                            35760000
357700*----------------------------------------------------------------*35770000
357800*    RETURN TO CICS MODULE                                       *35780000
357900*----------------------------------------------------------------*35790000
358000                                                                  35800000
358100     COPY DPPD003.                                                35810000
358200 EJECT                                                            35820000
358300*----------------------------------------------------------------*35830000
358400*    FORMAT MESSAGE LINES MODULE                                 *35840000
358500*----------------------------------------------------------------*35850000
358600                                                                  35860000
358700     COPY DPPD005.                                                35870000
358800 EJECT                                                            35880000
358900*----------------------------------------------------------------*35890000
359000*    GET PANEL MODULE                                            *35900000
359100*----------------------------------------------------------------*35910000
359200                                                                  35920000
359300     COPY DPPD007.                                                35930000
359400 EJECT                                                            35940000
359500*----------------------------------------------------------------*35950000
359600*    WRITE PANEL MODULE                                          *35960000
359700*----------------------------------------------------------------*35970000
359800                                                                  35980000
359900     COPY DPPD008.                                                35990000
360000 EJECT                                                            36000000
360100*----------------------------------------------------------------*36010000
360200*    TOGGLE THE FUNCTION KEY LINE MODULE                         *36020000
360300*----------------------------------------------------------------*36030000
360400                                                                  36040000
360500     COPY DPPD009.                                                36050000
360600 EJECT                                                            36060000
360700*----------------------------------------------------------------*36070000
360800*    ABEND PROCESSOR MODULE                                      *36080000
360900*----------------------------------------------------------------*36090000
361000                                                                  36100000
361100     COPY DPPD013.                                                36110000
361200 EJECT                                                            36120000
361300*----------------------------------------------------------------*36130000
361400*    CHECK COMMUNICATION AREA MODULE                             *36140000
361500*----------------------------------------------------------------*36150000
361600                                                                  36160000
361700     COPY DPPD015.                                                36170000
361800 EJECT                                                            36180000
361900*----------------------------------------------------------------*36190000
362000*    UPDATE TIME AND DATE MODULE                                 *36200000
362100*----------------------------------------------------------------*36210000
362200                                                                  36220000
362300     COPY DPPD017.                                                36230000
362400 EJECT                                                            36240000
