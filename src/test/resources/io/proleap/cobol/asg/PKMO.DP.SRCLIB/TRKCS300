000100*-----------------------*                                         00010090
000200 IDENTIFICATION DIVISION.                                         00020091
000300*-----------------------*                                         00030091
000400 PROGRAM-ID.    TRKCS300.                                         00040091
000500 AUTHOR.        MARGARET MORRISON.                                00050091
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060091
000700 DATE-WRITTEN.  JANUARY 1999.                                     00070091
000800 DATE-COMPILED.                                                   00080091
000900                                                                  00090091
001000*---------------------------------------------------------------* 00100091
001100*    Y300 - IMPORTS CONTAINER-PO HISTORY                        * 00110091
001200*                                                               * 00120091
001300*    THIS PROGRAM DISPLAYS THE HISTORY OF A SELECTED PURCHASE   * 00130091
001400*    ORDER.  THE COLUMN THAT WAS CHANGED, DATE & TIME OF CHANGE,* 00140091
001500*    AND THE BEFORE AND AFTER VALUES OF THE COLUMN ARE          * 00150091
001600*    DISPLAYED.                                                 * 00160091
001700*                                                               * 00170091
001800*---------------------------------------------------------------* 00180091
001801*---------------------------------------------------------------* 00181099
001802*  11/04/2003 TKMA643 - VISWA KARUTURI                          * 00182099
001803*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT AND  * 00183099
001804*     CONSLR_CHRG_AMT FROM TIMCNPO/TAUCNPO TABLES. ADDES LOGIC  * 00184099
001805*     FOR SPLT_XMIT_CDE AND DOC_RCVD_ORGN_TMST COLUMNS ON       * 00185099
001806*     TIMCNPO/TAUCNPO TABLES.                                   * 00186099
001807*---------------------------------------------------------------* 00187099
001300*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00189199
001300*     DATE:    10/30/2014                                       * 00189299
001300*                                                               * 00189399
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# * 00189499
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/30/2014    * 00189599
003250*---------------------------------------------------------------* 00189699
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00189899
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00189999
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00190099
263697*---------------------------------------------------------------* 00190199
CICS  * CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495         00190299
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00190399
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00190499
CICS  *-----------------------------------------------------------------00190599
001900                                                                  00191091
002000 ENVIRONMENT DIVISION.                                            00200091
002100                                                                  00210091
002200 DATA DIVISION.                                                   00220091
002300                                                                  00230091
002400 WORKING-STORAGE SECTION.                                         00240091
002500                                                                  00250091
002600 01  DK-DB2-KEYS.                                                 00260091
002700     15  DK-CONTNR-NBR                  PIC  X(12)  VALUE SPACES. 00270091
002800     15  DK-CONTNR-SEQ-NBR              PIC  S9(04) COMP          00280091
002900                                             VALUE ZERO.          00290091
003000     15  DK-PO-NBR                      PIC  S9(09) COMP          00300091
003100                                             VALUE ZERO.          00310091
003200                                                                  00320091
003300 01  PC-PROGRAM-CONSTANTS.                                        00330091
003400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340091
003500                                                    'TR300A  '.   00350091
003600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360091
003700                                                    'TRKM300 '.   00370091
003800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380091
003900                                                    'TRKCS300'.   00390091
004000     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00400091
004100     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00410091
004200     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00420091
004300     05  PC-CNTR-SUMM-FORMAT            PIC  X(01)  VALUE '1'.    00430091
004400     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00440091
004500     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00450091
004600                                                    COMP SYNC.    00460091
004700     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00470091
004800                                                    COMP SYNC.    00480091
004900     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00490091
005000                                                    +1000000      00500091
005100                                                    COMP-3.       00510091
005200     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00520091
005300                                                    COMP SYNC.    00530091
005400     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00540091
005500                                                     COMP-3.      00550091
005600     05  PC-INIT-DATE                   PIC X(10)    VALUE        00560091
005700                                                   '0001-01-01'.  00570091
005800     05  PC-INIT-TIME                   PIC X(05)    VALUE        00580091
005900                                                   '00.00'.       00590091
006000     05  PC-SLASH                       PIC X(01)    VALUE '/'.   00600091
006100     05  PC-COLON                       PIC X(01)    VALUE ':'.   00610091
006200                                                                  00620091
006300 01  PC-TSYMSG-NUMBERS.                                           00630091
006400     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00640091
006500     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00650091
006600     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00660091
006700     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00670091
006800     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00680091
006900     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00690091
007000     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00700091
007100     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  00710091
007200                                                                  00720091
007300 01  PS-PROGRAM-SUBSCRIPTS.                                       00730091
007400     05  PS-SUB                         PIC S9(04)   VALUE +0     00740091
007500                                                     COMP SYNC.   00750091
007600                                                                  00760091
007700 01  PS-PROGRAM-SWITCHES.                                         00770091
007800     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00780091
007900         88  PS-NO-ERROR                             VALUE 'Y'.   00790091
008000         88  PS-ERROR                                VALUE 'N'.   00800091
008100     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   00810091
008200         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00820091
008300         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00830091
008400     05  PS-END-OF-TIMCSCN-FETCHES-SW   PIC X(01)    VALUE 'N'.   00840092
008500         88  PS-END-OF-TIMCSCN-FETCHES               VALUE 'Y'.   00850092
008600         88  PS-END-OF-TIMCSCN-FETCHES-NO            VALUE 'N'.   00860092
008700     05  PS-END-OF-TAUCSCN-FETCHES-SW   PIC X(01)    VALUE 'N'.   00870092
008800         88  PS-END-OF-TAUCSCN-FETCHES               VALUE 'Y'.   00880092
008900         88  PS-END-OF-TAUCSCN-FETCHES-NO            VALUE 'N'.   00890092
009000                                                                  00900091
009100 01  PV-PROGRAM-VARIABLES.                                        00910091
009200     05  PV-RETRY-COUNTER               PIC S9(04)   VALUE +0     00920091
009300                                                     COMP SYNC.   00930091
009400     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     00940091
009500                                                     COMP SYNC.   00950091
009600     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     00960091
009700                                                     COMP-3.      00970091
009800     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     00980091
009900                                                     COMP-3.      00990091
010000     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     01000091
010100                                                     COMP-3.      01010091
010200     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     01020091
010300                                                     COMP SYNC.   01030091
010400     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     01040091
010500                                                     COMP SYNC.   01050091
010600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01060091
010700                                                     COMP SYNC.   01070091
010800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01080091
010900                                                     COMP SYNC.   01090091
011000     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01100091
011100                                                                  01110091
011200     05  PV-FORMAT-DATE.                                          01120091
011300         10  PV-FORMAT-MM               PIC XX.                   01130091
011400         10  PV-FORMAT-SLASH1           PIC X        VALUE '/'.   01140091
011500         10  PV-FORMAT-DD               PIC XX.                   01150091
011600         10  PV-FORMAT-SLASH2           PIC X        VALUE '/'.   01160091
011700         10  PV-FORMAT-YY               PIC XX.                   01170091
011800                                                                  01180091
011900     05  PV-FORMAT-TIME.                                          01190091
012000         10  PV-FORMAT-HOUR             PIC XX.                   01200091
012100         10  PV-FORMAT-COLON            PIC X        VALUE ':'.   01210091
012200         10  PV-FORMAT-MIN              PIC XX.                   01220091
012300                                                                  01230091
012400     05  PV-DELY-TMST.                                            01240091
012500         10  PV-DELY-TMST-DATE.                                   01250091
012600             15  PV-DELY-MM            PIC XX.                    01260091
012700             15  PV-DELY-SLASH1        PIC X        VALUE '/'.    01270091
012800             15  PV-DELY-DD            PIC XX.                    01280091
012900             15  PV-DELY-SLASH2        PIC X        VALUE '/'.    01290091
013000             15  PV-DELY-CCYY          PIC X(04).                 01300091
013100             15  FILLER                PIC X(03).                 01310091
013200         10  PV-DELY-TMST-TIME.                                   01320091
013300             15  PV-DELY-HOUR          PIC XX.                    01330091
013400             15  PV-DELY-COLON         PIC X        VALUE ':'.    01340091
013500             15  PV-DELY-MIN           PIC XX.                    01350091
013600             15  FILLER                PIC X(12)    VALUE SPACES. 01360091
013700                                                                  01370091
013701     05  PV-TMST.                                                 01370194
013702         10  PV-TMST-DATE.                                        01370294
013703             15  PV-TMST-MM            PIC XX.                    01370394
013704             15  PV-TMST-SLASH1        PIC X        VALUE '/'.    01370494
013705             15  PV-TMST-DD            PIC XX.                    01370594
013706             15  PV-TMST-SLASH2        PIC X        VALUE '/'.    01370694
013707             15  PV-TMST-CCYY          PIC X(04).                 01370794
013708             15  FILLER                PIC X(03).                 01370894
013709         10  PV-TMST-TIME.                                        01370994
013710             15  PV-TMST-HOUR          PIC XX.                    01371094
013711             15  PV-TMST-COLON         PIC X        VALUE ':'.    01371194
013712             15  PV-TMST-MIN           PIC XX.                    01371294
013720             15  FILLER                PIC X(12)    VALUE SPACES. 01372094
013730                                                                  01373094
013800     05  PV-HOLD-BEFORE-VALUE           PIC X(30)    VALUE SPACES.01380091
013900     05  PV-HOLD-BEFORE-VALUE-V         PIC Z(08)9.99 VALUE ZERO. 01390091
014000     05  PV-HOLD-BEFORE-VALUE-N         PIC Z(08)9    VALUE ZERO. 01400091
014100     05  PV-HOLD-AFTER-VALUE            PIC X(30)    VALUE SPACES.01410091
014200     05  PV-HOLD-AFTER-VALUE-V          PIC Z(08)9.99 VALUE ZERO. 01420091
014300     05  PV-HOLD-AFTER-VALUE-N          PIC Z(08)9    VALUE ZERO. 01430091
014400     05  PV-HOLD-FIELD-NAME             PIC X(20)    VALUE SPACES.01440091
014410     05  PV-HOLD-TMST-UNFORMAT          PIC X(26)    VALUE SPACES.01441094
014420     05  PV-EXTL-REF-NBR                PIC X(15)    VALUE SPACES.01442099
014500                                                                  01450091
014600     05  PV-PREVIOUS-VALUES.                                      01460091
014700         10  PV-PREV-CSTM-ENTR-ID       PIC X(12)    VALUE SPACES.01470099
014800         10  PV-PREV-MSTR-BOL-NBR       PIC X(30)    VALUE SPACES.01480091
014900         10  PV-PREV-HSE-BOL-NBR        PIC X(30)    VALUE SPACES.01490091
015000         10  PV-PREV-LTR-OF-CR-NBR      PIC X(15)    VALUE SPACES.01500091
015100         10  PV-PREV-PO-RCVD-DELY-TMST  PIC X(26)    VALUE SPACES.01510091
015200         10  PV-PREV-PO-C-O-PROD-CDE    PIC X(03)    VALUE SPACES.01520091
015300         10  PV-PREV-PO-CART-CNT        PIC S9(04)      VALUE +0  01530091
015400                                                        COMP.     01540091
015500         10  PV-PREV-PO-CBMT-QTY        PIC S9(07)V9(2) VALUE +0  01550091
015600                                                        COMP-3.   01560091
015700         10  PV-PREV-PO-WT-KGRM-QTY     PIC S9(09)      VALUE +0  01570091
015800                                                        COMP.     01580091
015900         10  PV-PREV-PO-UNT-QTY         PIC S9(09)      VALUE +0  01590091
016000                                                        COMP.     01600091
016500         10  PV-PREV-LAST-UPD-BY-USR-ID PIC X(08)   VALUE SPACES. 01650091
016600         10  PV-PREV-LAST-UPD-BY-USR-ID-2 PIC X(08) VALUE SPACES. 01660092
016700         10  PV-PREV-LAST-UPD-TMST      PIC X(26)   VALUE SPACES. 01670091
016800         10  PV-PREV-LAST-UPD-TMST-2    PIC X(26)   VALUE SPACES. 01680092
016900         10  PV-PREV-DO-TO-DCONSLR-TMST PIC X(26)   VALUE SPACES. 01690092
016910         10  PV-PREV-BKR-FRGT-RLSE-CDE  PIC X(01)   VALUE SPACES. 01691095
016920         10  PV-PREV-DO-RCVD-CDE        PIC X(01)   VALUE SPACES. 01692095
016930         10  PV-PREV-CONTNR-PU-CDE      PIC X(01)   VALUE SPACES. 01693095
016940         10  PV-PREV-ACTL-POE-DELY-CDE  PIC X(01)   VALUE SPACES. 01694095
016950         10  PV-PREV-DVN-CDE            PIC X(01)   VALUE SPACES. 01695095
016960         10  PV-PREV-DCONSLR-RET-CDE    PIC X(01)   VALUE SPACES. 01696095
016961         10  PV-PREV-SPLT-XMIT-CDE      PIC X(01)   VALUE SPACES. 01697099
016962         10  PV-PREV-DOC-RCVD-ORGN-TMST PIC X(26)   VALUE SPACES. 01698099
017000         10  PV-CURRENT-AUDIT-ENTR-ID   PIC X(12)   VALUE SPACES. 01700092
017100                                                                  01710091
017200*---------------------------------------------------------------* 01720091
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01730099
017400*---------------------------------------------------------------* 01740091
017500                                                                  01750091
017600     COPY DPWS030.                                                01760091
CICS       COPY DPWS930.                                                01761099
017700 EJECT                                                            01770091
017800*---------------------------------------------------------------* 01780091
017900*    NUMERIC EDIT LAYOUT.                                       * 01790091
018000*---------------------------------------------------------------* 01800091
018100                                                                  01810091
018200     COPY DPWS010I.                                               01820091
018300                                                                  01830091
018400 EJECT                                                            01840091
018500*---------------------------------------------------------------* 01850091
018600*    STANDARD COMMAREA.                                         * 01860091
018700*---------------------------------------------------------------* 01870091
018800                                                                  01880091
018900     COPY DPWS020.                                                01890091
019000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01900091
019100                                                                  01910091
019200*---------------------------------------------------------------* 01920091
019300* INTER-APPLICATION COMMAREA.                                   * 01930091
019400*   TRWS102 - IS THE INPUT LAYOUT WHEN COMING FROM THE CONTAINER* 01940091
019500*             SUMMARY SCREEN.                                   * 01950091
019600*---------------------------------------------------------------* 01960091
019700                                                                  01970091
019800         10  INTER-APPL-COMM-AREA       PIC X(200).               01980091
019900     COPY TRWS102.                                                01990091
020000                                                                  02000091
020100*---------------------------------------------------------------* 02010091
020200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02020091
020300*---------------------------------------------------------------* 02030091
020400         10  ASC-SPECIFIC-COMMAREA.                               02040091
020500             15  ASC-LIST-KEYS.                                   02050091
020600                 20  ASC-KEY-CONTNR-NBR              PIC  X(12).  02060091
020700                 20  ASC-KEY-CONTNR-SEQ-NBR          PIC S9(04)   02070091
020800                                                         COMP.    02080091
020900                 20  ASC-KEY-PO-NBR                  PIC S9(09)   02090091
021000                                                         COMP.    02100091
021100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02110091
021200                 20  ASC-ITEM-ARRAY.                              02120091
021300                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        02130091
021400                         30  ASC-LIST-ITEM-NUMBER                 02140091
021500                                                     PIC S9(09)   02150091
021600                                                     COMP-3.      02160091
021700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  02170091
021800                             88  ASC-VALID-SELECT    VALUE ' '    02180091
021900                                                           'S'    02190091
022000                                                           'B'    02200091
022100                                                           'E'.   02210091
022200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   02220091
022300                             88  ASC-TEMP-SELECT     VALUE 'S'.   02230091
022400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   02240091
022500                             88  ASC-TEMP-END        VALUE 'E'.   02250091
022600                         30  ASC-SELECTED-SW         PIC  X(01).  02260091
022700                             88  ASC-NO-SELECT       VALUE ' '.   02270091
022800                             88  ASC-SELECT          VALUE 'S'.   02280091
022900                             88  ASC-BEGIN           VALUE 'B'.   02290091
023000                             88  ASC-END             VALUE 'E'.   02300091
023100                         30  ASC-DATA                PIC  X(20).  02310091
023200                         30  ASC-USERID              PIC  X(08).  02320091
023300                         30  ASC-DATE                PIC  X(08).  02330091
023400                         30  ASC-TIME                PIC  X(05).  02340091
023500                         30  ASC-VALUE               PIC  X(30).  02350091
023600                                                                  02360091
023700             15  ASC-BLK-SUB                         PIC S9(04)   02370091
023800                                                         COMP     02380091
023900                                                         SYNC.    02390091
024000             15  ASC-ITEM-SUB                        PIC S9(04)   02400091
024100                                                         COMP     02410091
024200                                                         SYNC.    02420091
024300             15  ASC-SEL-SUB                         PIC S9(04)   02430091
024400                                                         COMP.    02440091
024500             15  ASC-SEL-ITEM                        PIC S9(04)   02450091
024600                                                         COMP.    02460091
024700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   02470091
024800                                                         COMP-3.  02480091
024900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   02490091
025000                                                         COMP-3.  02500091
025100             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   02510091
025200                                                         COMP-3.  02520091
025300             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   02530091
025400                                                         COMP-3.  02540091
025500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   02550091
025600                                                         COMP-3.  02560091
025700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   02570091
025800                                                         COMP-3.  02580091
025900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02590091
026000                                                         COMP     02600091
026100                                                         SYNC.    02610091
026200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   02620091
026300                                                         COMP-3.  02630091
026400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   02640091
026500                                                         COMP-3.  02650091
026600             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  02660091
026700                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 02670091
026800                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 02680091
026900             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  02690091
027000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02700091
027100             15  ASC-DTL-QUEUE-NAME.                              02710091
027200                 20  ASC-DTL-TERM-ID                 PIC  X(04).  02720091
027300                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   02730091
027400                                                         COMP-3.  02740091
027500                 20  ASC-DTL-SEQ                     PIC  9(01).  02750091
027600                                                                  02760091
027700             15  ASC-START-ITEM-REQUEST.                          02770091
027800                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  02780091
027900                                                                  02790091
028000     EJECT                                                        02800091
028100*---------------------------------------------------------------* 02810091
028200*    ABEND PROCESSING COPYBOOK.                                 * 02820091
028300*---------------------------------------------------------------* 02830091
028400                                                                  02840091
028500     COPY DPWS013.                                                02850091
028600                                                                  02860091
028700     EJECT                                                        02870091
028800*---------------------------------------------------------------* 02880091
028900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02890091
029000*---------------------------------------------------------------* 02900091
029100                                                                  02910091
029200     COPY DPWS015.                                                02920091
029300                                                                  02930091
029400*---------------------------------------------------------------* 02940091
029500*    FUNCTION KEYS COPYBOOK.                                    * 02950091
029600*---------------------------------------------------------------* 02960091
029700                                                                  02970091
029800     COPY DPWS016.                                                02980091
029900                                                                  02990091
030000*---------------------------------------------------------------* 03000091
030100*    MAP LAYOUT                                                 * 03010091
030200*---------------------------------------------------------------* 03020091
030300                                                                  03030091
030400     COPY TRKM300.                                                03040091
030500                                                                  03050091
030600 01  MR-OCCURS-LAYOUT          REDEFINES  TR300AO.                03060091
030710*PS 10/30/2014 CHANGE STARTS                                      03071099
030710     05  FILLER                PIC X(92).                         03072099
030710*PS 10/30/2014 CHANGE ENDS                                        03073099
030800     05  MR-SCROLL-AREA OCCURS 12 TIMES.                          03080091
030900         10  MR-DATAL          PIC S9(04) COMP.                   03090091
031000         10  MR-DATAA          PIC  X(01).                        03100091
031100         10  MR-DATAC          PIC  X(01).                        03110091
031200         10  MR-DATAH          PIC  X(01).                        03120091
031300         10  MR-DATA           PIC  X(20).                        03130091
031400                                                                  03140091
031500         10  MR-USERIDL        PIC S9(04) COMP.                   03150091
031600         10  MR-USERIDA        PIC  X(01).                        03160091
031700         10  MR-USERIDC        PIC  X(01).                        03170091
031800         10  MR-USERIDH        PIC  X(01).                        03180091
031900         10  MR-USERID         PIC  X(08).                        03190091
032000                                                                  03200091
032100         10  MR-DATEL          PIC S9(04) COMP.                   03210091
032200         10  MR-DATEA          PIC  X(01).                        03220091
032300         10  MR-DATEC          PIC  X(01).                        03230091
032400         10  MR-DATEH          PIC  X(01).                        03240091
032500         10  MR-DATE           PIC  X(08).                        03250091
032600                                                                  03260091
032700         10  MR-TIMEL          PIC S9(04) COMP.                   03270091
032800         10  MR-TIMEA          PIC  X(01).                        03280091
032900         10  MR-TIMEC          PIC  X(01).                        03290091
033000         10  MR-TIMEH          PIC  X(01).                        03300091
033100         10  MR-TIME           PIC  X(05).                        03310091
033200                                                                  03320091
033300         10  MR-VALUEL         PIC S9(04) COMP.                   03330091
033400         10  MR-VALUEA         PIC  X(01).                        03340091
033500         10  MR-VALUEC         PIC  X(01).                        03350091
033600         10  MR-VALUEH         PIC  X(01).                        03360091
033700         10  MR-VALUE          PIC  X(30).                        03370091
033800                                                                  03380091
033900 EJECT                                                            03390091
034000*---------------------------------------------------------------* 03400091
034100*    DB2 AREA FOR CONTAINER PURCHASE ORDER TABLE                * 03410091
034200*---------------------------------------------------------------* 03420091
034300     EXEC SQL                                                     03430091
034400          INCLUDE TIMCNPO                                         03440091
034500     END-EXEC.                                                    03450091
034510*---------------------------------------------------------------* 03451093
034520*    DB2 AREA FOR CONTAINER TRACKING TABLE                      * 03452093
034530*---------------------------------------------------------------* 03453093
034540     EXEC SQL                                                     03454093
034550          INCLUDE TIMCNTK                                         03455093
034560     END-EXEC.                                                    03456093
034600*---------------------------------------------------------------* 03460091
034700*    DB2 AREA FOR CONTAINER PURCHASE ORDER AUDIT TABLE          * 03470091
034800*---------------------------------------------------------------* 03480091
034900     EXEC SQL                                                     03490091
035000          INCLUDE TAUCNPO                                         03500091
035100     END-EXEC.                                                    03510091
035200*---------------------------------------------------------------* 03520092
035300*    DB2 AREA FOR CUSTOMS CONTAINER TABLE                       * 03530092
035400*---------------------------------------------------------------* 03540092
035500     EXEC SQL                                                     03550092
035600          INCLUDE TIMCSCN                                         03560092
035700     END-EXEC.                                                    03570092
035800*---------------------------------------------------------------* 03580092
035900*    DB2 AREA FOR CUSTOMS CONTAINER AUDIT TABLE                 * 03590092
036000*---------------------------------------------------------------* 03600092
036100     EXEC SQL                                                     03610092
036200          INCLUDE TAUCSCN                                         03620092
036300     END-EXEC.                                                    03630092
036400*---------------------------------------------------------------* 03640091
036500*    DB2 AREA FOR COMMUNICATIONS                                * 03650091
036600*---------------------------------------------------------------* 03660091
036700     EXEC SQL                                                     03670091
036800          INCLUDE SQLCA                                           03680091
036900     END-EXEC.                                                    03690091
037000                                                                  03700091
037100*---------------------------------------------------------------* 03710091
037200*    CURSOR TO OBTAIN PO HISTORY INFORMATION                    * 03720091
037300*---------------------------------------------------------------* 03730091
037400                                                                  03740091
037500     EXEC SQL                                                     03750091
037600          DECLARE PO-CSR CURSOR                                   03760091
037700          FOR SELECT                                              03770091
037800                A.CSTM_ENTR_ID                                    03780091
037900              , A.MSTR_BOL_NBR                                    03790091
038000              , A.HSE_BOL_NBR                                     03800091
038100              , A.LTR_OF_CR_NBR                                   03810091
038200              , A.PO_RCVD_DELY_TMST                               03820091
038300              , A.PO_C_O_PROD_CDE                                 03830091
038400              , A.PO_CART_CNT                                     03840091
038500              , A.PO_CBMT_QTY                                     03850091
038600              , A.PO_WT_KGRM_QTY                                  03860091
038700              , A.PO_UNT_QTY                                      03870091
039000              , A.LAST_UPD_BY_USR_ID                              03900091
039100              , A.LAST_UPD_TMST                                   03910091
039101              , A.BKR_FRGT_RLSE_CDE                               03910195
039102              , A.DO_RCVD_CDE                                     03910295
039103              , A.CONTNR_PU_CDE                                   03910395
039104              , A.ACTL_POE_DELY_CDE                               03910495
039105              , A.DVN_CDE                                         03910595
039110              , A.DCONSLR_RET_CDE                                 03911095
039120              , A.SPLT_XMIT_CDE                                   03912099
039130              , A.DOC_RCVD_ORGN_TMST                              03913099
039200          FROM                                                    03920091
039300                TAUCNPO  A                                        03930091
039400          WHERE                                                   03940091
039500                A.PO_NBR          = :DK-PO-NBR                    03950091
039600            AND A.CONTNR_ID       = :DK-CONTNR-NBR                03960091
039700            AND A.CONTNR_SEQ_NBR  = :DK-CONTNR-SEQ-NBR            03970091
039800          ORDER BY                                                03980091
039900                A.LAST_UPD_TMST DESC                              03990091
040000     END-EXEC.                                                    04000091
040100                                                                  04010091
040200*---------------------------------------------------------------* 04020092
040300*    CURSOR TO OBTAIN CONTAINER PO HISTORY INFORMATION FOR      * 04030092
040400*    DO_TO_DCONSLR_TMST  FROM TIMCSCN                           * 04040092
040500*---------------------------------------------------------------* 04050092
040600                                                                  04060092
040700     EXEC SQL                                                     04070092
040800         DECLARE TIMCSCN-CSR CURSOR                               04080092
040900         FOR SELECT  C.DO_TO_DCONSLR_TMST                         04090092
041000                   , C.CSTM_ENTR_ID                               04100092
041100                   , C.CONTNR_ID                                  04110092
041200                   , C.LAST_UPD_TMST                              04120092
041300                   , C.LAST_UPD_BY_USR_ID                         04130092
041400                FROM TIMCNTK A                                    04140092
041500                   , TIMCNPO B                                    04150092
041600                   , TIMCSCN C                                    04160092
041700               WHERE A.CONTNR_ID      = B.CONTNR_ID               04170092
041800                 AND B.CONTNR_ID      = C.CONTNR_ID               04180092
041900                 AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR          04190092
042000                 AND B.CSTM_ENTR_ID   = C.CSTM_ENTR_ID            04200092
042100                 AND A.CONTNR_ID      = :DK-CONTNR-NBR            04210092
042200                 AND A.CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NBR        04220092
042300                 AND B.PO_NBR         = :DK-PO-NBR                04230092
042400            ORDER BY A.LAST_UPD_TMST DESC                         04240092
042500     END-EXEC.                                                    04250092
042600                                                                  04260092
042700*---------------------------------------------------------------* 04270092
042800*    CURSOR TO OBTAIN CONTAINER PO HISTORY AUDIT INFORMATION    * 04280092
042900*    FOR DO_TO_DCONSLR_TMST  FROM TAUCSCN                       * 04290092
043000*---------------------------------------------------------------* 04300092
043100                                                                  04310092
043200     EXEC SQL                                                     04320092
043300         DECLARE TAUCSCN-CSR CURSOR                               04330092
043400         FOR SELECT C.DO_TO_DCONSLR_TMST                          04340092
043500                  , C.CSTM_ENTR_ID                                04350092
043600                  , C.LAST_UPD_TMST                               04360092
043700                  , C.LAST_UPD_BY_USR_ID                          04370092
043800                FROM TIMCNTK A                                    04380092
043900                  ,  TIMCNPO B                                    04390092
044000                  ,  TAUCSCN C                                    04400092
044100               WHERE A.CONTNR_ID      = B.CONTNR_ID               04410092
044200                 AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR          04420092
044300                 AND B.CSTM_ENTR_ID   = C.CSTM_ENTR_ID            04430092
044400                 AND C.CSTM_ENTR_ID   = :PV-CURRENT-AUDIT-ENTR-ID 04440092
044500                 AND B.CONTNR_ID      = C.CONTNR_ID               04450092
044600                 AND A.CONTNR_ID      = :DK-CONTNR-NBR            04460092
044700                 AND A.CONTNR_SEQ_NBR = :DK-CONTNR-SEQ-NBR        04470092
044800                 AND B.PO_NBR         = :DK-PO-NBR                04480092
044900          ORDER BY   A.LAST_UPD_TMST DESC                         04490092
045000     END-EXEC.                                                    04500092
045100 EJECT                                                            04510091
045200 LINKAGE SECTION.                                                 04520091
045300                                                                  04530091
045400 01  DFHCOMMAREA.                                                 04540091
045500     05  FILLER                         OCCURS  1 TO 4072 TIMES   04550091
045600                                        DEPENDING ON EIBCALEN.    04560091
045700         10  FILLER                     PIC X.                    04570091
045800                                                                  04580091
045900 EJECT                                                            04590091
046000 PROCEDURE DIVISION.                                              04600091
046100                                                                  04610091
046200 0000-MAIN-MODULE.                                                04620091
046300                                                                  04630091
046400     INITIALIZE DP030-CICS-API-FIELDS.                            04640091
046500     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04650091
046600     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04660091
046700     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04670091
046800     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04680091
046900     MOVE LENGTH OF TR300AI       TO DP030-MAP-LENGTH (1).        04690091
047000     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04700091
047100     PERFORM 0001-CALL-CICS-ARCH-API.                             04710091
047200                                                                  04720091
047300     PERFORM 1000-CONTROL-PROCESSING.                             04730091
047400                                                                  04740091
047500     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04750091
047600     PERFORM 0001-CALL-CICS-ARCH-API.                             04760091
047700                                                                  04770091
047800*----------------------------------------------------------------*04780091
047900*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *04790091
048000*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *04800091
048100*----------------------------------------------------------------*04810091
048200                                                                  04820091
048300 0001-CALL-CICS-ARCH-API.                                         04830091
048400                                                                  04840091
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04850099
048600                                    DFHCOMMAREA                   04860099
048700                                    DP030-CICS-API-FIELDS         04870099
048800                                    DP020-STANDARD-COMMAREA       04880099
048900                                    TR300AI.                      04890099
049000                                                                  04900091
049100     IF  DP030-RC-CALL-SUCCESSFUL                                 04910091
049200         CONTINUE                                                 04920091
049300     ELSE                                                         04930091
049400         SET DP013-NO-ROLLBACK TO TRUE                            04940091
049500         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   04950091
049600         SET DP013-CICS-ABEND TO TRUE                             04960091
049700         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        04970091
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04980099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04990099
050000         MOVE DP030-RETURN-CODE                                   05000091
050100                               TO DP013-MESSAGE-TEXT (3)          05010091
050200         PERFORM DP013-0000-PROCESS-ABEND                         05020091
050300     END-IF.                                                      05030091
050400                                                                  05040091
050500*----------------------------------------------------------------*05050091
050600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05060091
050700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05070091
050800*                                                                *05080091
050900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05090091
051000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05100091
051100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05110091
051200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05120091
051300*----------------------------------------------------------------*05130091
051400                                                                  05140091
051500 1000-CONTROL-PROCESSING.                                         05150091
051600                                                                  05160091
051700     EVALUATE TRUE                                                05170091
051800         WHEN DP020-NEXT-ACT-INITIAL                              05180091
051900             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            05190091
052000             MOVE DP020-SRC-TASK-NUMBER                           05200091
052100                                    TO ASC-DTL-TASK-NUMBER        05210091
052200             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                05220091
052300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05230091
052400***-----$TEMPLATE NOTE$-------------------------------------------05240091
052500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05250091
052600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05260091
052700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05270091
052800***---------------------------------------------------------------05280091
052900             IF  PS-COMMAREA-NOT-VALID                            05290091
053000***              MOVE PC-TSYMSG-99901                             05300091
053100***                            TO  DP020-MSG-NUMBER               05310091
053200***              SET DP020-MSG-FATAL                              05320091
053300***                            TO  TRUE                           05330091
053400                 SET DP020-NEXT-ACT-APPL-ERROR                    05340091
053500                               TO  TRUE                           05350091
053600             ELSE                                                 05360091
053700                 PERFORM 2050-DELETE-DETAIL-QUEUE                 05370091
053800                 PERFORM 4000-BUILD-INITIAL-PANEL                 05380091
053900             END-IF                                               05390091
054000                                                                  05400091
054100         WHEN DP020-NEXT-ACT-READ-MAP                             05410091
054200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05420091
054300                               TO PV-TOP-ITEM                     05430091
054400             PERFORM 2000-PROCESS-PANEL                           05440091
054500                                                                  05450091
054600         WHEN DP020-NEXT-ACT-RETURN                               05460091
054700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05470091
054800                               TO PV-TOP-ITEM                     05480091
054900             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        05490091
055000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05500091
055100                                                                  05510091
055200         WHEN OTHER                                               05520091
055300             SET DP013-LOGIC-ABEND TO TRUE                        05530091
055400             SET DP013-NO-ROLLBACK TO TRUE                        05540091
055500             MOVE '1000-CONTROL-PROCESSING'                       05550091
055600                               TO  DP013-PARAGRAPH                05560091
055700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05570091
055800                               TO  DP013-MESSAGE-TEXT(1)          05580091
055900             PERFORM DP013-0000-PROCESS-ABEND                     05590091
056000     END-EVALUATE.                                                05600091
056100                                                                  05610091
056200 EJECT                                                            05620091
056300*----------------------------------------------------------------*05630091
056400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05640091
056500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05650091
056600*----------------------------------------------------------------*05660091
056700                                                                  05670091
056800 1100-PROCESS-INTER-APPL-COMM.                                    05680091
056900                                                                  05690091
057000     SET PS-COMMAREA-VALID     TO TRUE.                           05700091
057100     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05710091
057200     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         05720091
057300                                                                  05730091
057400     EVALUATE DP020-INT-APPL-FORMAT-IND                           05740091
057500         WHEN PC-CNTR-SUMM-FORMAT                                 05750091
057600             MOVE TR102-CONTNR-NO     TO ASC-KEY-CONTNR-NBR       05760091
057700                                         DK-CONTNR-NBR            05770091
057800             MOVE TR102-CONTNR-SEQ-NO TO ASC-KEY-CONTNR-SEQ-NBR   05780091
057900                                         DK-CONTNR-SEQ-NBR        05790091
058000             MOVE TR102-PO-NBR        TO ASC-KEY-PO-NBR           05800091
058100                                         DK-PO-NBR                05810091
058200         WHEN OTHER                                               05820091
058300             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            05830091
058400             SET DP020-MSG-FATAL   TO TRUE                        05840091
058500             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                05850091
058600     END-EVALUATE.                                                05860091
058700                                                                  05870091
058800*----------------------------------------------------------------*05880091
058900*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *05890091
059000*    ON WHAT FUNCTION KEY WAS SELECTED.                          *05900091
059100*----------------------------------------------------------------*05910091
059200                                                                  05920091
059300 2000-PROCESS-PANEL.                                              05930091
059400                                                                  05940091
059500     EVALUATE TRUE                                                05950091
059600         WHEN DP020-SRC-AID = DP016-CLEAR                         05960091
059700             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05970091
059800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05980091
059900             PERFORM 3200-RESET-ATTRIBUTES                        05990091
060000                                                                  06000091
060100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06010091
060200             MOVE ASC-KEY-CONTNR-NBR     TO DK-CONTNR-NBR         06020091
060300             MOVE ASC-KEY-CONTNR-SEQ-NBR TO DK-CONTNR-SEQ-NBR     06030091
060400             MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR             06040091
060500             PERFORM 2050-DELETE-DETAIL-QUEUE                     06050091
060600             PERFORM 4000-BUILD-INITIAL-PANEL                     06060091
060700             PERFORM 3200-RESET-ATTRIBUTES                        06070091
060800                                                                  06080091
060900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06090091
061000             MOVE +1 TO PV-TOP-ITEM                               06100091
061100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06110091
061200             PERFORM 3200-RESET-ATTRIBUTES                        06120091
061300                                                                  06130091
061400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06140091
061500             PERFORM 2110-BROWSE-BACKWARD                         06150091
061600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06160091
061700             PERFORM 3200-RESET-ATTRIBUTES                        06170091
061800                                                                  06180091
061900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06190091
062000             PERFORM 2120-BROWSE-FORWARD                          06200091
062100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06210091
062200             PERFORM 3200-RESET-ATTRIBUTES                        06220091
062300                                                                  06230091
062400         WHEN DP020-SRC-AID = DP016-ENTER                         06240091
062500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06250091
062600             IF  PS-ERROR                                         06260091
062700                 CONTINUE                                         06270091
062800             ELSE                                                 06280091
062900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06290091
063000                 PERFORM 3200-RESET-ATTRIBUTES                    06300091
063100             END-IF                                               06310091
063200                                                                  06320091
063300         WHEN OTHER                                               06330091
063400             SET DP013-NO-ROLLBACK TO TRUE                        06340091
063500             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               06350091
063600             SET DP013-CICS-ABEND TO TRUE                         06360091
063700             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         06370091
063800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06380091
063900                                   TO DP013-MESSAGE-TEXT (1)      06390091
064000             PERFORM DP013-0000-PROCESS-ABEND                     06400091
064100                                                                  06410091
064200     END-EVALUATE.                                                06420091
064300 EJECT                                                            06430091
064400*----------------------------------------------------------------*06440091
064500*    DELETE THE TEMPORARY STORAGE QUEUE.                         *06450091
064600*----------------------------------------------------------------*06460091
064700                                                                  06470091
064800 2050-DELETE-DETAIL-QUEUE.                                        06480091
064900                                                                  06490091
065000     EXEC CICS                                                    06500091
065100         DELETEQ TS                                               06510091
065200             QUEUE (ASC-DTL-QUEUE-NAME)                           06520091
065300             RESP  (PV-CICS-RESP)                                 06530091
065400     END-EXEC.                                                    06540091
065500                                                                  06550091
065600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06560091
065700        (PV-CICS-RESP = DFHRESP(QIDERR))                          06570091
065800         CONTINUE                                                 06580091
065900     ELSE                                                         06590091
066000         SET DP013-CICS-ABEND TO TRUE                             06600091
066100         SET DP013-NO-ROLLBACK TO TRUE                            06610091
066200                                                                  06620091
066300         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       06630091
066400         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  06640091
066500                        TO DP013-MESSAGE-TEXT (1)                 06650091
066600         PERFORM DP013-0000-PROCESS-ABEND                         06660091
066700     END-IF.                                                      06670091
066800                                                                  06680091
066900     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        06690091
067000 EJECT                                                            06700091
067100*----------------------------------------------------------------*06710091
067200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06720091
067300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06730091
067400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06740091
067500*    MESSAGE.                                                    *06750091
067600*----------------------------------------------------------------*06760091
067700                                                                  06770091
067800 2110-BROWSE-BACKWARD.                                            06780091
067900                                                                  06790091
068000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06800091
068100         GIVING PV-TOP-ITEM.                                      06810091
068200                                                                  06820091
068300     IF  PV-TOP-ITEM < +1                                         06830091
068400         MOVE +1              TO PV-TOP-ITEM                      06840091
068500*        -- TOP OF LIST --                                        06850091
068600         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 06860091
068700         SET DP020-MSG-INFORMATIONAL TO TRUE                      06870091
068800     END-IF.                                                      06880091
068900                                                                  06890091
069000 EJECT                                                            06900091
069100                                                                  06910091
069200*----------------------------------------------------------------*06920091
069300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *06930091
069400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *06940091
069500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *06950091
069600*----------------------------------------------------------------*06960091
069700                                                                  06970091
069800 2120-BROWSE-FORWARD.                                             06980091
069900                                                                  06990091
070000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07000091
070100         GIVING PV-TOP-ITEM.                                      07010091
070200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07020091
070300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07030091
070400                                   TO PV-TOP-ITEM                 07040091
070500*        -- BOTTOM OF LIST --                                     07050091
070600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07060091
070700         SET DP020-MSG-INFORMATIONAL                              07070091
070800                                   TO TRUE                        07080091
070900     ELSE                                                         07090091
071000         COMPUTE PV-BOTTOM-ITEM =                                 07100091
071100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07110091
071200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07120091
071300*            -- BOTTOM OF LIST --                                 07130091
071400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07140091
071500             SET DP020-MSG-INFORMATIONAL                          07150091
071600                                   TO TRUE                        07160091
071700         END-IF                                                   07170091
071800     END-IF.                                                      07180091
071900 EJECT                                                            07190091
072000*----------------------------------------------------------------*07200091
072100*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07210091
072200*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07220091
072300*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07230091
072400*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07240091
072500*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07250091
072600*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07260091
072700*----------------------------------------------------------------*07270091
072800                                                                  07280091
072900 2130-CHECK-FOR-JUMP-BROWSE.                                      07290091
073000                                                                  07300091
073100     IF ASTRTITL > ZERO                                           07310091
073200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      07320091
073300     ELSE                                                         07330091
073400         IF ASTRTITF = DP015-ERASE-EOF                            07340091
073500             INITIALIZE ASC-START-ITEM-REQUEST                    07350091
073600         END-IF                                                   07360091
073700     END-IF.                                                      07370091
073800                                                                  07380091
073900     SET PS-NO-ERROR               TO TRUE.                       07390091
074000     IF (ASC-START-ITEM-REQUEST = SPACE)                          07400091
074100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07410091
074200                                   TO PV-TOP-ITEM                 07420091
074300     ELSE                                                         07430091
074400         MOVE ASC-START-ITEM-REQUEST                              07440091
074500                                   TO DP010I-UNEDITED-FIELD       07450091
074600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07460091
074700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07470091
074800         SET DP010I-NEGATIVE-NOT-ALLOWED                          07480091
074900                                   TO TRUE                        07490091
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07501099
263697              USING DP010I-NUMERIC-EDIT-AREA                      07502099
075100                                                                  07510091
075200         IF  NOT DP010I-ERROR-DETECTED                            07520091
075300             MOVE DP010I-NUMERIC-FIELD                            07530091
075400                                   TO  ASC-START-ITEM-REQUEST-N   07540091
075500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07550091
075600                 IF  ASC-START-ITEM-REQUEST-N >                   07560091
075700                                          ASC-NUMBER-OF-ITEMS-READ07570091
075800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07580091
075900                     COMPUTE PV-TOP-ITEM =                        07590091
076000                             ASC-NUMBER-OF-ITEMS-READ             07600091
076100                             - PC-ITEMS-PER-PANEL + 1             07610091
076200                     IF  PV-TOP-ITEM < +1                         07620091
076300                         MOVE +1   TO PV-TOP-ITEM                 07630091
076400                         MOVE PC-TSYMSG-00070                     07640091
076500                                   TO DP020-MSG-NUMBER            07650091
076600                         SET DP020-MSG-INFORMATIONAL              07660091
076700                                   TO TRUE                        07670091
076800                     END-IF                                       07680091
076900                 ELSE                                             07690091
077000                     MOVE ASC-START-ITEM-REQUEST-N                07700091
077100                                   TO PV-TOP-ITEM                 07710091
077200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07720091
077300                     COMPUTE PV-BOTTOM-ITEM =                     07730091
077400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07740091
077500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07750091
077600*                        -- BOTTOM OF LIST --                     07760091
077700                         MOVE PC-TSYMSG-00070                     07770091
077800                                   TO DP020-MSG-NUMBER            07780091
077900                         SET DP020-MSG-INFORMATIONAL              07790091
078000                                   TO TRUE                        07800091
078100                     END-IF                                       07810091
078200                 END-IF                                           07820091
078300             ELSE                                                 07830091
078400*                --- VALUE OUT OF RANGE ----                      07840091
078500                 MOVE PC-TSYMSG-00101                             07850091
078600                                   TO DP020-MSG-NUMBER            07860091
078700                 MOVE -1           TO ASTRTITL                    07870091
078800                 SET DP030-SET-CURSOR-APPL-1                      07880091
078900                                   TO TRUE                        07890091
079000                 MOVE DP015-REVERSE                               07900091
079100                                   TO ASTRTITH                    07910091
079200                 MOVE DP015-RED    TO ASTRTITC                    07920091
079300                 MOVE DP015-UNP-NUM-BRT-MDT                       07930091
079400                                   TO ASTRTITA                    07940091
079500                 SET DP020-MSG-FATAL                              07950091
079600                                   TO TRUE                        07960091
079700                 SET PS-ERROR      TO TRUE                        07970091
079800             END-IF                                               07980091
079900                                                                  07990091
080000         ELSE                                                     08000091
080100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08010091
080200             MOVE -1               TO ASTRTITL                    08020091
080300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08030091
080400             MOVE DP015-REVERSE    TO ASTRTITH                    08040091
080500             MOVE DP015-RED        TO ASTRTITC                    08050091
080600             MOVE DP015-UNP-NUM-BRT-MDT                           08060091
080700                                   TO ASTRTITA                    08070091
080800             SET DP020-MSG-FATAL   TO TRUE                        08080091
080900             SET PS-ERROR          TO TRUE                        08090091
081000         END-IF                                                   08100091
081100     END-IF.                                                      08110091
081200                                                                  08120091
081300*----------------------------------------------------------------*08130091
081400*    RESET THE MAP FIELD ATTRIBUTES.                             *08140091
081500*----------------------------------------------------------------*08150091
081600 3200-RESET-ATTRIBUTES.                                           08160091
081700                                                                  08170091
081800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   08180091
081900     MOVE DP015-GREEN              TO ASTRTITC.                   08190091
082000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   08200091
082100     MOVE -1                       TO ASTRTITL.                   08210091
082200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08220091
082300                                                                  08230091
082400*----------------------------------------------------------------*08240091
082500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08250091
082600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08260091
082700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08270091
082800*    DISPLAY THE PANEL TO USER.                                  *08280091
082900*----------------------------------------------------------------*08290091
083000                                                                  08300091
083100 4000-BUILD-INITIAL-PANEL.                                        08310091
083200                                                                  08320091
083300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            08330091
083400                                 ASC-BLOCK-ENTRIES (2).           08340091
083500     MOVE +1                 TO  ASC-BLK-SUB.                     08350091
083600     SET ASC-ITEMS-LEFT-ON-DB                                     08360091
083700                             TO  TRUE.                            08370091
083800                                                                  08380091
083900     MOVE +0                 TO  ASC-ITEM-SUB                     08390091
084000                                 ASC-NUMBER-OF-ITEMS-READ         08400091
084100                                 ASC-NUMBER-OF-SELECTED-ITEMS     08410091
084200                                 ASC-HIGHEST-BLOCK-WRITTEN        08420091
084300                                 ASC-START-OF-SELECTED-RANGE      08430091
084400                                 ASC-END-OF-SELECTED-RANGE        08440091
084500                                 ASC-ITEM-AT-TOP-OF-PANEL.        08450091
084600                                                                  08460091
084700     PERFORM 4030-SELECT-TIMCNPO.                                 08470091
084800                                                                  08480091
084900     PERFORM 4040-MOVE-TIMCNPO-TO-HOLD.                           08490091
085000                                                                  08500091
085100     PERFORM 4010-OPEN-CURSOR.                                    08510091
085200                                                                  08520091
085300     PERFORM 4300-READ-ITEMS-FROM-DB.                             08530091
085400                                                                  08540091
085500     PERFORM 4020-CLOSE-CURSOR.                                   08550091
085600                                                                  08560091
085700     MOVE +1                 TO  PV-TOP-ITEM.                     08570091
085800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          08580091
085900         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    08590091
086000         SET DP020-MSG-FATAL   TO  TRUE                           08600091
086100*--------NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED---   08610091
086200         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               08620091
086300     ELSE                                                         08630091
086400         MOVE -1             TO ASTRTITL                          08640091
086500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08650091
086600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     08660091
086700     END-IF.                                                      08670091
086800 EJECT                                                            08680091
086900*----------------------------------------------------------------*08690091
087000* OPEN THE PO CURSOR.                                            *08700091
087100*----------------------------------------------------------------*08710091
087200                                                                  08720091
087300 4010-OPEN-CURSOR.                                                08730091
087400                                                                  08740091
087500     EXEC SQL                                                     08750091
087600          OPEN PO-CSR                                             08760091
087700     END-EXEC.                                                    08770091
087800                                                                  08780091
087900     EVALUATE TRUE                                                08790091
088000         WHEN SQLCODE = ZERO                                      08800091
088100              CONTINUE                                            08810091
088200         WHEN SQLWARN0 NOT EQUAL SPACE                            08820091
088300         WHEN SQLCODE NOT EQUAL ZERO                              08830091
088400              MOVE '4010-OPEN-CURSOR'                             08840091
088500                           TO  DP013-PARAGRAPH                    08850091
088600              MOVE 'OPEN PO CURSOR'                               08860091
088700                           TO  DP013-MESSAGE-TEXT (1)             08870091
088800              MOVE SQLCA   TO  DP013-SQLCA                        08880091
088900              SET DP013-DB2-ABEND                                 08890091
089000                           TO  TRUE                               08900091
089100              PERFORM DP013-0000-PROCESS-ABEND                    08910091
089200     END-EVALUATE.                                                08920091
089300                                                                  08930091
089400 EJECT                                                            08940091
089500*----------------------------------------------------------------*08950091
089600* CLOSE THE PO CURSOR.                                           *08960091
089700*----------------------------------------------------------------*08970091
089800                                                                  08980091
089900 4020-CLOSE-CURSOR.                                               08990091
090000                                                                  09000091
090100     EXEC SQL                                                     09010091
090200         CLOSE PO-CSR                                             09020091
090300     END-EXEC.                                                    09030091
090400                                                                  09040091
090500     EVALUATE TRUE                                                09050091
090600         WHEN SQLCODE = ZERO                                      09060091
090700              CONTINUE                                            09070091
090800         WHEN SQLWARN0 NOT EQUAL SPACE                            09080091
090900         WHEN SQLCODE NOT EQUAL ZERO                              09090091
091000              MOVE '4020-CLOSE-CURSOR'                            09100091
091100                           TO  DP013-PARAGRAPH                    09110091
091200              MOVE 'CLOSE PO CURSOR'                              09120091
091300                           TO  DP013-MESSAGE-TEXT (1)             09130091
091400              MOVE SQLCA   TO  DP013-SQLCA                        09140091
091500              SET DP013-DB2-ABEND                                 09150091
091600                           TO  TRUE                               09160091
091700              PERFORM DP013-0000-PROCESS-ABEND                    09170091
091800     END-EVALUATE.                                                09180091
091900                                                                  09190091
092000 EJECT                                                            09200091
092100*----------------------------------------------------------------*09210091
092200* SELECT A ROW FROM THE CONTAINER PURCHASE ORDER TABLE (TIMCNPO).*09220091
092300*----------------------------------------------------------------*09230091
092400 4030-SELECT-TIMCNPO.                                             09240091
092500                                                                  09250091
092510     MOVE SPACES TO PV-EXTL-REF-NBR.                              09251099
092520                                                                  09252099
092600     PERFORM                                                      09260091
092700         WITH TEST AFTER                                          09270091
092800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09280091
092900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09290091
093000                 SQLCODE = ZERO                     OR            09300091
093100                 SQLCODE = +100                                   09310091
093200                                                                  09320091
093300         EXEC SQL                                                 09330091
093400             SELECT CSTM_ENTR_ID,                                 09340091
093500                    MSTR_BOL_NBR,                                 09350091
093600                    HSE_BOL_NBR,                                  09360091
093700                    LTR_OF_CR_NBR,                                09370091
093800                    PO_RCVD_DELY_TMST,                            09380091
093900                    PO_C_O_PROD_CDE,                              09390091
094000                    PO_CART_CNT,                                  09400091
094100                    PO_CBMT_QTY,                                  09410091
094200                    PO_WT_KGRM_QTY,                               09420091
094300                    PO_UNT_QTY,                                   09430091
094600                    LAST_UPD_BY_USR_ID,                           09460091
094700                    LAST_UPD_TMST,                                09470095
094710                    BKR_FRGT_RLSE_CDE,                            09471095
094720                    DO_RCVD_CDE,                                  09472095
094730                    CONTNR_PU_CDE,                                09473095
094740                    ACTL_POE_DELY_CDE,                            09474095
094750                    DVN_CDE,                                      09475095
094760                    DCONSLR_RET_CDE,                              09476099
094770                    EXTL_REF_NBR,                                 09477099
094780                    SPLT_XMIT_CDE,                                09478099
094790                    DOC_RCVD_ORGN_TMST                            09479099
094800              INTO :IMCNPO-CSTM-ENTR-ID,                          09480091
094900                   :IMCNPO-MSTR-BOL-NBR,                          09490091
095000                   :IMCNPO-HSE-BOL-NBR,                           09500091
095100                   :IMCNPO-LTR-OF-CR-NBR,                         09510091
095200                   :IMCNPO-PO-RCVD-DELY-TMST,                     09520091
095300                   :IMCNPO-PO-C-O-PROD-CDE,                       09530091
095400                   :IMCNPO-PO-CART-CNT,                           09540091
095500                   :IMCNPO-PO-CBMT-QTY,                           09550091
095600                   :IMCNPO-PO-WT-KGRM-QTY,                        09560091
095700                   :IMCNPO-PO-UNT-QTY,                            09570091
096000                   :IMCNPO-LAST-UPD-BY-USR-ID,                    09600091
096100                   :IMCNPO-LAST-UPD-TMST,                         09610095
096110                   :IMCNPO-BKR-FRGT-RLSE-CDE,                     09611095
096120                   :IMCNPO-DO-RCVD-CDE,                           09612095
096130                   :IMCNPO-CONTNR-PU-CDE,                         09613095
096140                   :IMCNPO-ACTL-POE-DELY-CDE,                     09614095
096150                   :IMCNPO-DVN-CDE,                               09615095
096160                   :IMCNPO-DCONSLR-RET-CDE,                       09616099
096170                   :PV-EXTL-REF-NBR,                              09617099
096180                   :IMCNPO-SPLT-XMIT-CDE,                         09618099
096190                   :IMCNPO-DOC-RCVD-ORGN-TMST                     09619099
096200                                                                  09620091
096300               FROM TIMCNPO                                       09630091
096400              WHERE CONTNR_ID        = :DK-CONTNR-NBR             09640091
096500                AND CONTNR_SEQ_NBR   = :DK-CONTNR-SEQ-NBR         09650091
096600                AND PO_NBR           = :DK-PO-NBR                 09660091
096700         END-EXEC                                                 09670091
096800                                                                  09680091
096900         EVALUATE TRUE                                            09690061
097000             WHEN SQLCODE = -904                                  09700061
097100             WHEN SQLCODE = -913                                  09710061
097200                 CONTINUE                                         09720061
097300             WHEN SQLCODE = ZERO                                  09730061
097400             WHEN SQLCODE = +100                                  09740061
097500                  CONTINUE                                        09750091
097600             WHEN SQLWARN0 NOT = SPACES                           09760061
097700             WHEN SQLCODE < ZERO                                  09770061
097800             WHEN SQLCODE > ZERO                                  09780061
097900                 MOVE '4030-SELECT-TIMCNPO'                       09790061
098000                                   TO DP013-PARAGRAPH             09800061
098100                 MOVE 'SQL ERROR SELECTING CONTNR PO'             09810061
098200                                   TO DP013-MESSAGE-TEXT (1)      09820061
098300                 MOVE SQLCA        TO DP013-SQLCA                 09830061
098400                 MOVE 'TIMCNPO '   TO DP013-DB2-TABLE-NAME (1)    09840061
098500                 SET DP013-DB2-ABEND                              09850061
098600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09860061
098700                 PERFORM DP013-0000-PROCESS-ABEND                 09870061
098800         END-EVALUATE                                             09880061
098900     END-PERFORM.                                                 09890061
099000*                                                                 09900061
099100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09910061
099200         MOVE '4030-SELECT-TIMCNPO'                               09920061
099300                                   TO DP013-PARAGRAPH             09930061
099400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT PO'  09940061
099500                                   TO DP013-MESSAGE-TEXT (1)      09950061
099600         MOVE SQLCA                TO DP013-SQLCA                 09960061
099700         MOVE 'TIMCNPO '           TO DP013-DB2-TABLE-NAME (1)    09970061
099800         SET DP013-DB2-ABEND                                      09980061
099900             DP013-XCTL-DISPLAY-RESTART                           09990061
100000                                   TO TRUE                        10000061
100100         PERFORM DP013-0000-PROCESS-ABEND                         10010061
100200     END-IF.                                                      10020061
100300                                                                  10030022
100400 EJECT                                                            10040061
100500*----------------------------------------------------------------*10050091
100600* MOVE SELECTED TIMCNPO VALUES TO HOLD FIELDS FOR COMPARISON.    *10060091
100700*----------------------------------------------------------------*10070091
100800 4040-MOVE-TIMCNPO-TO-HOLD.                                       10080091
100900                                                                  10090091
101000     MOVE IMCNPO-CSTM-ENTR-ID       TO PV-PREV-CSTM-ENTR-ID.      10100091
101100     MOVE IMCNPO-MSTR-BOL-NBR       TO PV-PREV-MSTR-BOL-NBR.      10110091
101200     MOVE IMCNPO-HSE-BOL-NBR        TO PV-PREV-HSE-BOL-NBR.       10120091
101300     MOVE IMCNPO-LTR-OF-CR-NBR      TO PV-PREV-LTR-OF-CR-NBR.     10130091
101400     MOVE IMCNPO-PO-RCVD-DELY-TMST  TO PV-PREV-PO-RCVD-DELY-TMST. 10140091
101500     MOVE IMCNPO-PO-C-O-PROD-CDE    TO PV-PREV-PO-C-O-PROD-CDE.   10150091
101600     MOVE IMCNPO-PO-CART-CNT        TO PV-PREV-PO-CART-CNT.       10160091
101700     MOVE IMCNPO-PO-CBMT-QTY        TO PV-PREV-PO-CBMT-QTY.       10170091
101800     MOVE IMCNPO-PO-WT-KGRM-QTY     TO PV-PREV-PO-WT-KGRM-QTY.    10180091
101900     MOVE IMCNPO-PO-UNT-QTY         TO PV-PREV-PO-UNT-QTY.        10190091
102200     MOVE IMCNPO-LAST-UPD-BY-USR-ID TO                            10220091
102300                                    PV-PREV-LAST-UPD-BY-USR-ID.   10230091
102400     MOVE IMCNPO-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     10240091
102410     MOVE IMCNPO-BKR-FRGT-RLSE-CDE  TO PV-PREV-BKR-FRGT-RLSE-CDE. 10241095
102420     MOVE IMCNPO-DO-RCVD-CDE        TO PV-PREV-DO-RCVD-CDE.       10242095
102430     MOVE IMCNPO-CONTNR-PU-CDE      TO PV-PREV-CONTNR-PU-CDE.     10243095
102440     MOVE IMCNPO-ACTL-POE-DELY-CDE  TO PV-PREV-ACTL-POE-DELY-CDE. 10244095
102450     MOVE IMCNPO-DVN-CDE            TO PV-PREV-DVN-CDE.           10245095
102460     MOVE IMCNPO-DCONSLR-RET-CDE    TO PV-PREV-DCONSLR-RET-CDE.   10246095
102470     MOVE IMCNPO-SPLT-XMIT-CDE      TO PV-PREV-SPLT-XMIT-CDE.     10247099
102480     MOVE IMCNPO-DOC-RCVD-ORGN-TMST TO PV-PREV-DOC-RCVD-ORGN-TMST.10248099
102500                                                                  10250091
102600*----------------------------------------------------------------*10260092
102700* MOVE SELECTED TIMCSCN VALUES TO HOLD FIELDS FOR COMPARISON.    *10270092
102800* THE PROCESSING FOR THE TIMCSCN/TAUCSCN REQUIRES CURSORS FOR    *10280092
102900* BOTH TABLES. THE PROCESSING FOR TIMCNPO/TAUCNPO IS DIFFERENT   *10290092
103000* BECAUSE ONLY A SELECT IS DONE ON TIMCNTK WITH A CURSOR FOR     *10300092
103100* TAUCNTK. EVEN THOUGH THIS PARAGRAPH ONLY HAS ONE MOVE IN IT,   *10310092
103200* I USE IT TO ATTEMPT TO PRESERVE THE INITIAL STRUCTURE OF THE   *10320092
103300* PROGRAM LOGIC.                                                 *10330092
103400*----------------------------------------------------------------*10340092
103500 4045-MOVE-TIMCSCN-TO-HOLD.                                       10350092
103600                                                                  10360092
103700     MOVE IMCSCN-DO-TO-DCONSLR-TMST TO                            10370092
103800                 PV-PREV-DO-TO-DCONSLR-TMST.                      10380092
103900     MOVE IMCSCN-LAST-UPD-TMST      TO                            10390092
104000                 PV-PREV-LAST-UPD-TMST-2.                         10400092
104100     MOVE IMCSCN-LAST-UPD-BY-USR-ID TO                            10410092
104200                 PV-PREV-LAST-UPD-BY-USR-ID-2.                    10420092
104300                                                                  10430092
104400 EJECT                                                            10440092
104500*----------------------------------------------------------------*10450091
104600*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *10460091
104700*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *10470091
104800*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *10480091
104900*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *10490091
105000*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *10500091
105100*                                                                *10510091
105200*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *10520091
105300*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *10530091
105400*    UPON INITIALIZATION.                                        *10540091
105500*----------------------------------------------------------------*10550091
105600                                                                  10560091
105700 4300-READ-ITEMS-FROM-DB.                                         10570091
105800                                                                  10580091
105900     SET PS-END-OF-TIMCSCN-FETCHES-NO  TO TRUE.                   10590092
106000                                                                  10600092
106100     PERFORM 4301-OPEN-TIMCSCN-CSR.                               10610092
106200     PERFORM 4302-FETCH-TIMCSCN-CSR                               10620092
106300       UNTIL PS-END-OF-TIMCSCN-FETCHES.                           10630092
106400     PERFORM 4306-CLOSE-TIMCSCN-CURSOR.                           10640092
106500                                                                  10650092
106600     PERFORM                                                      10660091
106700         VARYING PV-READ-COUNT                                    10670091
106800         FROM 1 BY 1                                              10680091
106900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    10690091
107000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         10700091
107100                                                                  10710091
107200         PERFORM 4310-FETCH                                       10720091
107300                                                                  10730091
107400         IF  ASC-ITEMS-LEFT-ON-DB                                 10740091
107500             PERFORM 4330-CHECK-FOR-CHANGES                       10750091
107600         END-IF                                                   10760091
107700     END-PERFORM.                                                 10770091
107800                                                                  10780091
107900     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           10790091
108000         MOVE +1                       TO  ASC-BLK-SUB            10800091
108100         PERFORM 5100-WRITE-TEMP-STORAGE                          10810091
108200         ADD +1                        TO  ASC-BLK-SUB            10820091
108300         PERFORM 5100-WRITE-TEMP-STORAGE                          10830091
108400                                                                  10840091
108500         MOVE 1                        TO  ASC-BLK-SUB            10850091
108600                                           PV-BLOCK-NUMBER        10860091
108700         PERFORM 4410-READ-TEMP-STORAGE                           10870091
108800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             10880091
108900              MOVE 2                    TO  ASC-BLK-SUB           10890091
109000                                            PV-BLOCK-NUMBER       10900091
109100              PERFORM 4410-READ-TEMP-STORAGE                      10910091
109200         END-IF                                                   10920091
109300     END-IF.                                                      10930091
109400 EJECT                                                            10940091
109500*----------------------------------------------------------------*10950092
109600* OPEN THE CUSTOMS CONTAINER CURSOR.                             *10960092
109700*----------------------------------------------------------------*10970092
109800 4301-OPEN-TIMCSCN-CSR.                                           10980092
109900                                                                  10990092
110000     EXEC SQL                                                     11000092
110100          OPEN TIMCSCN-CSR                                        11010092
110200     END-EXEC.                                                    11020092
110300                                                                  11030092
110400     EVALUATE TRUE                                                11040092
110500         WHEN SQLCODE = ZERO                                      11050092
110600              CONTINUE                                            11060092
110700         WHEN SQLWARN0 NOT EQUAL SPACE                            11070092
110800         WHEN SQLCODE NOT EQUAL ZERO                              11080092
110900              MOVE '4301-OPEN-TIMCSCN-CSR'                        11090092
111000                           TO  DP013-PARAGRAPH                    11100092
111100              MOVE 'OPEN TIMCSCN-CSR CURSOR'                      11110092
111200                           TO  DP013-MESSAGE-TEXT (1)             11120092
111300              MOVE SQLCA   TO  DP013-SQLCA                        11130092
111400              SET DP013-DB2-ABEND                                 11140092
111500                           TO  TRUE                               11150092
111600              PERFORM DP013-0000-PROCESS-ABEND                    11160092
111700     END-EVALUATE.                                                11170092
111800                                                                  11180092
111900 EJECT                                                            11190092
112000*----------------------------------------------------------------*11200092
112100*    FETCH THE TIMCSCN-CSR CURSOR.                               *11210092
112200*----------------------------------------------------------------*11220092
112300 4302-FETCH-TIMCSCN-CSR.                                          11230092
112400                                                                  11240092
112500     SET PS-END-OF-TAUCSCN-FETCHES-NO  TO TRUE.                   11250092
112600     INITIALIZE PV-CURRENT-AUDIT-ENTR-ID.                         11260092
112700                                                                  11270092
112800     PERFORM                                                      11280092
112900         WITH TEST AFTER                                          11290092
113000         VARYING PV-SQL-SUB                                       11300092
113100         FROM 1 BY 1                                              11310092
113200         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11320092
113300            OR SQLCODE = 0                                        11330092
113400            OR SQLCODE = +100                                     11340092
113500                                                                  11350092
113600         EXEC SQL                                                 11360092
113700              FETCH TIMCSCN-CSR                                   11370092
113800              INTO :IMCSCN-DO-TO-DCONSLR-TMST,                    11380092
113900                   :IMCSCN-CSTM-ENTR-ID,                          11390092
114000                   :IMCSCN-CONTNR-ID,                             11400092
114100                   :IMCSCN-LAST-UPD-TMST,                         11410092
114200                   :IMCSCN-LAST-UPD-BY-USR-ID                     11420092
114300         END-EXEC                                                 11430092
114400                                                                  11440092
114500         EVALUATE TRUE                                            11450092
114600             WHEN SQLCODE = ZERO                                  11460092
114700                  MOVE IMCSCN-CSTM-ENTR-ID TO                     11470092
114800                         PV-CURRENT-AUDIT-ENTR-ID                 11480092
114900                  PERFORM 4045-MOVE-TIMCSCN-TO-HOLD               11490092
115000                  PERFORM 4303-OPEN-TAUCSCN-CSR                   11500092
115100                  PERFORM 4304-FETCH-TAUCSCN-CSR                  11510092
115200                    UNTIL PS-END-OF-TAUCSCN-FETCHES               11520092
115300                  PERFORM 4305-CLOSE-TAUCSCN-CURSOR               11530092
115400             WHEN SQLCODE = +100                                  11540092
115500                  SET PS-END-OF-TIMCSCN-FETCHES TO TRUE           11550092
115600             WHEN SQLCODE = -904                                  11560092
115700             WHEN SQLCODE = -913                                  11570092
115800                  CONTINUE                                        11580092
115900             WHEN SQLWARN0 NOT EQUAL SPACE                        11590092
116000             WHEN SQLCODE NOT EQUAL ZERO                          11600092
116100                  MOVE '4302-FETCH-TIMCSCN-CSR'                   11610092
116200                               TO  DP013-PARAGRAPH                11620092
116300                  MOVE 'FETCH TIMCSCN-CSR CURSOR'                 11630092
116400                               TO  DP013-MESSAGE-TEXT (1)         11640092
116500                  MOVE SQLCA   TO  DP013-SQLCA                    11650092
116600                  SET DP013-DB2-ABEND                             11660092
116700                               TO  TRUE                           11670092
116800                  PERFORM DP013-0000-PROCESS-ABEND                11680092
116900         END-EVALUATE                                             11690092
117000     END-PERFORM.                                                 11700092
117100                                                                  11710092
117200     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   11720092
117300         MOVE '4302-FETCH-TIMCSCN-CSR'                            11730092
117400                               TO  DP013-PARAGRAPH                11740092
117500         MOVE 'MAX RETRIES EXCEEDED FOR FETCH TIMCSCN-CSR CURSOR' 11750092
117600                               TO  DP013-MESSAGE-TEXT (1)         11760092
117700         MOVE SQLCA            TO  DP013-SQLCA                    11770092
117800         SET DP013-DB2-ABEND   TO  TRUE                           11780092
117900         PERFORM DP013-0000-PROCESS-ABEND                         11790092
118000     END-IF.                                                      11800092
118100                                                                  11810092
118600 EJECT                                                            11860092
118700*----------------------------------------------------------------*11870092
118800* OPEN THE CUSTOMS CONTAINER AUDIT CURSOR.                       *11880092
118900*----------------------------------------------------------------*11890092
119000 4303-OPEN-TAUCSCN-CSR.                                           11900092
119100                                                                  11910092
119200     EXEC SQL                                                     11920092
119300          OPEN TAUCSCN-CSR                                        11930092
119400     END-EXEC.                                                    11940092
119500                                                                  11950092
119600     EVALUATE TRUE                                                11960092
119700         WHEN SQLCODE = ZERO                                      11970092
119800              CONTINUE                                            11980092
119900         WHEN SQLWARN0 NOT EQUAL SPACE                            11990092
120000         WHEN SQLCODE NOT EQUAL ZERO                              12000092
120100              MOVE '4303-OPEN-TAUCSCN-CSR'                        12010092
120200                           TO  DP013-PARAGRAPH                    12020092
120300              MOVE 'OPEN TAUCSCN-CSR CURSOR'                      12030092
120400                           TO  DP013-MESSAGE-TEXT (1)             12040092
120500              MOVE SQLCA   TO  DP013-SQLCA                        12050092
120600              SET DP013-DB2-ABEND                                 12060092
120700                           TO  TRUE                               12070092
120800              PERFORM DP013-0000-PROCESS-ABEND                    12080092
120900     END-EVALUATE.                                                12090092
121000                                                                  12100092
121100 EJECT                                                            12110092
121200*----------------------------------------------------------------*12120092
121300*    FETCH THE TAUCSCN-CSR CURSOR.                               *12130092
121400*----------------------------------------------------------------*12140092
121500 4304-FETCH-TAUCSCN-CSR.                                          12150092
121600                                                                  12160092
121700     PERFORM                                                      12170092
121800         WITH TEST AFTER                                          12180092
121900         VARYING PV-SQL-SUB                                       12190092
122000         FROM 1 BY 1                                              12200092
122100         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             12210092
122200            OR SQLCODE = 0                                        12220092
122300            OR SQLCODE = +100                                     12230092
122400                                                                  12240092
122500         EXEC SQL                                                 12250092
122600              FETCH TAUCSCN-CSR                                   12260092
122700              INTO :AUCSCN-DO-TO-DCONSLR-TMST,                    12270092
122800                   :AUCSCN-CSTM-ENTR-ID,                          12280092
122900                   :AUCSCN-LAST-UPD-TMST,                         12290092
123000                   :AUCSCN-LAST-UPD-BY-USR-ID                     12300092
123100         END-EXEC                                                 12310092
123200                                                                  12320092
123300         EVALUATE TRUE                                            12330092
123400             WHEN SQLCODE = ZERO                                  12340092
123500                  PERFORM 4329-CHECK-FOR-TAUCSCN-CHANGES          12350092
123600             WHEN SQLCODE = +100                                  12360092
123700                  SET PS-END-OF-TAUCSCN-FETCHES TO TRUE           12370092
123800             WHEN SQLCODE = -904                                  12380092
123900             WHEN SQLCODE = -913                                  12390092
124000                  CONTINUE                                        12400092
124100             WHEN SQLWARN0 NOT EQUAL SPACE                        12410092
124200             WHEN SQLCODE NOT EQUAL ZERO                          12420092
124300                  MOVE '4304-FETCH-TAUCSCN-CSR'                   12430092
124400                               TO  DP013-PARAGRAPH                12440092
124500                  MOVE 'FETCH TAUCSCN-CSR CURSOR'                 12450092
124600                               TO  DP013-MESSAGE-TEXT (1)         12460092
124700                  MOVE SQLCA   TO  DP013-SQLCA                    12470092
124800                  SET DP013-DB2-ABEND                             12480092
124900                               TO  TRUE                           12490092
125000                  PERFORM DP013-0000-PROCESS-ABEND                12500092
125100         END-EVALUATE                                             12510092
125200     END-PERFORM.                                                 12520092
125300                                                                  12530092
125400     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12540092
125500         MOVE '4304-FETCH-TAUCSCN-CSR'                            12550092
125600                               TO  DP013-PARAGRAPH                12560092
125700         MOVE 'MAX RETRIES EXCEEDED FOR FETCH TAUCSCN-CSR CURSOR' 12570092
125800                               TO  DP013-MESSAGE-TEXT (1)         12580092
125900         MOVE SQLCA            TO  DP013-SQLCA                    12590092
126000         SET DP013-DB2-ABEND   TO  TRUE                           12600092
126100         PERFORM DP013-0000-PROCESS-ABEND                         12610092
126200     END-IF.                                                      12620092
126300                                                                  12630092
126400 EJECT                                                            12640092
126500*----------------------------------------------------------------*12650092
126600* CLOSE THE CUSTOMS CONTAINER AUDIT CURSOR.                      *12660092
126700*----------------------------------------------------------------*12670092
126800 4305-CLOSE-TAUCSCN-CURSOR.                                       12680092
126900                                                                  12690092
127000     EXEC SQL                                                     12700092
127100         CLOSE TAUCSCN-CSR                                        12710092
127200     END-EXEC.                                                    12720092
127300                                                                  12730092
127400     EVALUATE TRUE                                                12740092
127500         WHEN SQLCODE = ZERO                                      12750092
127600              CONTINUE                                            12760092
127700         WHEN SQLWARN0 NOT EQUAL SPACE                            12770092
127800         WHEN SQLCODE NOT EQUAL ZERO                              12780092
127900              MOVE '4305-CLOSE-TAUCSCN-CURSOR'                    12790092
128000                           TO  DP013-PARAGRAPH                    12800092
128100              MOVE 'CLOSE TAUCSCN-CSR CURSOR'                     12810092
128200                           TO  DP013-MESSAGE-TEXT (1)             12820092
128300              MOVE SQLCA   TO  DP013-SQLCA                        12830092
128400              SET DP013-DB2-ABEND                                 12840092
128500                           TO  TRUE                               12850092
128600              PERFORM DP013-0000-PROCESS-ABEND                    12860092
128700     END-EVALUATE.                                                12870092
128800                                                                  12880092
128900 EJECT                                                            12890092
129000*----------------------------------------------------------------*12900092
129100* CLOSE THE CUSTOMS CONTAINER CURSOR.                            *12910092
129200*----------------------------------------------------------------*12920092
129300 4306-CLOSE-TIMCSCN-CURSOR.                                       12930092
129400                                                                  12940092
129500     EXEC SQL                                                     12950092
129600         CLOSE TIMCSCN-CSR                                        12960092
129700     END-EXEC.                                                    12970092
129800                                                                  12980092
129900     EVALUATE TRUE                                                12990092
130000         WHEN SQLCODE = ZERO                                      13000092
130100              CONTINUE                                            13010092
130200         WHEN SQLWARN0 NOT EQUAL SPACE                            13020092
130300         WHEN SQLCODE NOT EQUAL ZERO                              13030092
130400              MOVE '4306-CLOSE-TIMCSCN-CURSOR'                    13040092
130500                           TO  DP013-PARAGRAPH                    13050092
130600              MOVE 'CLOSE TIMCSCN-CSR CURSOR'                     13060092
130700                           TO  DP013-MESSAGE-TEXT (1)             13070092
130800              MOVE SQLCA   TO  DP013-SQLCA                        13080092
130900              SET DP013-DB2-ABEND                                 13090092
131000                           TO  TRUE                               13100092
131100              PERFORM DP013-0000-PROCESS-ABEND                    13110092
131200     END-EVALUATE.                                                13120092
131300                                                                  13130092
131400 EJECT                                                            13140092
131500*----------------------------------------------------------------*13150092
131600*    FETCH THE PO CURSOR.                                        *13160091
131700*----------------------------------------------------------------*13170091
131800                                                                  13180091
131900 4310-FETCH.                                                      13190091
132000                                                                  13200091
132100     PERFORM                                                      13210091
132200         WITH TEST AFTER                                          13220091
132300         VARYING PV-SQL-SUB                                       13230091
132400         FROM 1 BY 1                                              13240091
132500         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             13250091
132600            OR SQLCODE = 0                                        13260091
132700            OR SQLCODE = +100                                     13270091
132800                                                                  13280091
132900         EXEC SQL                                                 13290091
133000              FETCH PO-CSR                                        13300091
133100              INTO                                                13310091
133200                    :AUCNPO-CSTM-ENTR-ID                          13320091
133300                  , :AUCNPO-MSTR-BOL-NBR                          13330091
133400                  , :AUCNPO-HSE-BOL-NBR                           13340091
133500                  , :AUCNPO-LTR-OF-CR-NBR                         13350091
133600                  , :AUCNPO-PO-RCVD-DELY-TMST                     13360091
133700                  , :AUCNPO-PO-C-O-PROD-CDE                       13370091
133800                  , :AUCNPO-PO-CART-CNT                           13380091
133900                  , :AUCNPO-PO-CBMT-QTY                           13390091
134000                  , :AUCNPO-PO-WT-KGRM-QTY                        13400091
134100                  , :AUCNPO-PO-UNT-QTY                            13410091
134400                  , :AUCNPO-LAST-UPD-BY-USR-ID                    13440091
134500                  , :AUCNPO-LAST-UPD-TMST                         13450091
134501                  , :AUCNPO-BKR-FRGT-RLSE-CDE                     13450199
134502                  , :AUCNPO-DO-RCVD-CDE                           13450299
134503                  , :AUCNPO-CONTNR-PU-CDE                         13450399
134504                  , :AUCNPO-ACTL-POE-DELY-CDE                     13450499
134505                  , :AUCNPO-DVN-CDE                               13450599
134510                  , :AUCNPO-DCONSLR-RET-CDE                       13451095
134520                  , :AUCNPO-SPLT-XMIT-CDE                         13452099
134530                  , :AUCNPO-DOC-RCVD-ORGN-TMST                    13453099
134600         END-EXEC                                                 13460091
134700                                                                  13470091
134800         EVALUATE TRUE                                            13480091
134900             WHEN SQLCODE = ZERO                                  13490091
135000             WHEN SQLCODE = +100                                  13500091
135100             WHEN SQLCODE = -904                                  13510091
135200             WHEN SQLCODE = -913                                  13520091
135300                  CONTINUE                                        13530091
135400             WHEN SQLWARN0 NOT EQUAL SPACE                        13540091
135500             WHEN SQLCODE NOT EQUAL ZERO                          13550091
135600                  MOVE '4310-FETCH-CURSOR'                        13560091
135700                               TO  DP013-PARAGRAPH                13570091
135800                  MOVE 'FETCH PO CURSOR'                          13580091
135900                               TO  DP013-MESSAGE-TEXT (1)         13590091
136000                  MOVE SQLCA   TO  DP013-SQLCA                    13600091
136100                  SET DP013-DB2-ABEND                             13610091
136200                               TO  TRUE                           13620091
136300                  PERFORM DP013-0000-PROCESS-ABEND                13630091
136400         END-EVALUATE                                             13640091
136500     END-PERFORM.                                                 13650091
136600                                                                  13660091
136700     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   13670091
136800         MOVE '4310-FETCH-CURSOR'                                 13680091
136900                               TO  DP013-PARAGRAPH                13690091
137000         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             13700091
137100                               TO  DP013-MESSAGE-TEXT (1)         13710091
137200         MOVE SQLCA            TO  DP013-SQLCA                    13720091
137300         SET DP013-DB2-ABEND   TO  TRUE                           13730091
137400         PERFORM DP013-0000-PROCESS-ABEND                         13740091
137500     END-IF.                                                      13750091
137600                                                                  13760091
137700     IF  SQLCODE EQUAL +100                                       13770091
137800         SET ASC-NO-ITEMS-LEFT-ON-DB                              13780091
137900                               TO  TRUE                           13790091
138000     END-IF.                                                      13800091
138100                                                                  13810091
138200 EJECT                                                            13820091
138300*----------------------------------------------------------------*13830091
138400*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *13840091
138500*----------------------------------------------------------------*13850091
138600                                                                  13860091
138700 4320-GET-SUB.                                                    13870091
138800                                                                  13880091
138900     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        13890091
139000         ADD +1            TO  ASC-ITEM-SUB                       13900091
139100     ELSE                                                         13910091
139200         ADD +1            TO  ASC-BLK-SUB                        13920091
139300         MOVE +1           TO  ASC-ITEM-SUB                       13930091
139400                                                                  13940091
139500         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 13950091
139600             MOVE +1       TO  ASC-BLK-SUB                        13960091
139700             PERFORM 5100-WRITE-TEMP-STORAGE                      13970091
139800             MOVE ASC-BLOCK-ENTRIES                               13980091
139900                       (PC-MAX-BLOCKS-IN-ARRAY)                   13990091
140000             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  14000091
140100             ADD +1        TO  ASC-BLK-SUB                        14010091
140200             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           14020091
140300         END-IF                                                   14030091
140400     END-IF.                                                      14040091
140500                                                                  14050091
140600     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               14060091
140700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        14070091
140800                                      (ASC-BLK-SUB                14080091
140900                                       ASC-ITEM-SUB).             14090091
141000                                                                  14100091
141001*----------------------------------------------------------------*14100192
141002*    COMPARE THE PREVIOUS VALUES TO THE CURRENT TAUCSCN VALUES   *14100292
141003*    TO SEE WHAT CHANGES OCCURRED.                               *14100392
141004*----------------------------------------------------------------*14100492
141005 4329-CHECK-FOR-TAUCSCN-CHANGES.                                  14100592
141006                                                                  14100692
141007     IF AUCSCN-DO-TO-DCONSLR-TMST                                 14100792
141008                            NOT EQUAL PV-PREV-DO-TO-DCONSLR-TMST  14100892
141009         MOVE PV-PREV-DO-TO-DCONSLR-TMST TO PV-HOLD-TMST-UNFORMAT 14100992
141010         PERFORM 4350-FORMAT-TMST                                 14101092
141011         MOVE PV-TMST                    TO PV-HOLD-AFTER-VALUE   14101192
141012         MOVE AUCSCN-DO-TO-DCONSLR-TMST  TO PV-HOLD-TMST-UNFORMAT 14101292
141013         PERFORM 4350-FORMAT-TMST                                 14101392
141014         MOVE PV-TMST                    TO PV-HOLD-BEFORE-VALUE  14101492
141015         MOVE 'DO ISSUED DT        '     TO PV-HOLD-FIELD-NAME    14101592
141016         PERFORM 4339-PROCESS-TAUCSCN-CHANGES                     14101692
141017     END-IF.                                                      14101792
141018                                                                  14101892
141019     PERFORM 4344-MOVE-TAUCSCN-TO-HOLD.                           14101992
141020                                                                  14102092
141100*----------------------------------------------------------------*14110091
141200*    COMPARE THE PREVIOUS VALUES TO THE CURRENT TAUCNPO VALUES   *14120091
141300*    TO SEE WHAT CHANGES OCCURRED.                               *14130091
141400*----------------------------------------------------------------*14140091
141500 4330-CHECK-FOR-CHANGES.                                          14150091
141600                                                                  14160091
141700     IF AUCNPO-CSTM-ENTR-ID  NOT EQUAL PV-PREV-CSTM-ENTR-ID       14170091
141800         MOVE PV-PREV-CSTM-ENTR-ID      TO PV-HOLD-AFTER-VALUE    14180091
141900         MOVE AUCNPO-CSTM-ENTR-ID       TO PV-HOLD-BEFORE-VALUE   14190091
142000         MOVE 'CUSTOM ENTRY ID     '    TO PV-HOLD-FIELD-NAME     14200091
142100         PERFORM 4340-PROCESS-CHANGES                             14210091
142200     END-IF.                                                      14220091
142300                                                                  14230091
142400     IF AUCNPO-MSTR-BOL-NBR NOT EQUAL  PV-PREV-MSTR-BOL-NBR       14240091
142500         MOVE PV-PREV-MSTR-BOL-NBR      TO PV-HOLD-AFTER-VALUE    14250091
142600         MOVE AUCNPO-MSTR-BOL-NBR       TO PV-HOLD-BEFORE-VALUE   14260091
142700         MOVE 'MASTER BOL NUMBER   '    TO PV-HOLD-FIELD-NAME     14270091
142800         PERFORM 4340-PROCESS-CHANGES                             14280091
142900     END-IF.                                                      14290091
143000                                                                  14300091
143100     IF AUCNPO-HSE-BOL-NBR  NOT EQUAL  PV-PREV-HSE-BOL-NBR        14310091
143200         MOVE PV-PREV-HSE-BOL-NBR       TO PV-HOLD-AFTER-VALUE    14320091
143300         MOVE AUCNPO-HSE-BOL-NBR        TO PV-HOLD-BEFORE-VALUE   14330091
143400         MOVE 'HOUSE BOL NUMBER    '    TO PV-HOLD-FIELD-NAME     14340091
143500         PERFORM 4340-PROCESS-CHANGES                             14350091
143600     END-IF.                                                      14360091
143700                                                                  14370091
143800     IF AUCNPO-LTR-OF-CR-NBR NOT EQUAL PV-PREV-LTR-OF-CR-NBR      14380091
143900         MOVE PV-PREV-LTR-OF-CR-NBR     TO PV-HOLD-AFTER-VALUE    14390091
144000         MOVE AUCNPO-LTR-OF-CR-NBR      TO PV-HOLD-BEFORE-VALUE   14400091
144100         MOVE 'LETTER OF CREDIT NBR'    TO PV-HOLD-FIELD-NAME     14410091
144200         PERFORM 4340-PROCESS-CHANGES                             14420091
144300     END-IF.                                                      14430091
144400                                                                  14440091
144500     IF AUCNPO-PO-RCVD-DELY-TMST NOT EQUAL                        14450091
144600                                 PV-PREV-PO-RCVD-DELY-TMST        14460091
144700         PERFORM 4350-FORMAT-DELY-TMST-AFTER                      14470091
144800         MOVE PV-DELY-TMST              TO PV-HOLD-AFTER-VALUE    14480091
144900         PERFORM 4355-FORMAT-DELY-TMST-BEFORE                     14490091
145000         MOVE PV-DELY-TMST              TO PV-HOLD-BEFORE-VALUE   14500091
145100         MOVE 'DELY DT             '    TO PV-HOLD-FIELD-NAME     14510091
145200         PERFORM 4340-PROCESS-CHANGES                             14520091
145300     END-IF.                                                      14530091
145400                                                                  14540091
145500     IF AUCNPO-PO-C-O-PROD-CDE NOT EQUAL PV-PREV-PO-C-O-PROD-CDE  14550091
145600         MOVE PV-PREV-PO-C-O-PROD-CDE   TO PV-HOLD-AFTER-VALUE    14560091
145700         MOVE AUCNPO-PO-C-O-PROD-CDE    TO PV-HOLD-BEFORE-VALUE   14570091
145800         MOVE 'CTRY                '    TO PV-HOLD-FIELD-NAME     14580091
145900         PERFORM 4340-PROCESS-CHANGES                             14590091
146000     END-IF.                                                      14600091
146100                                                                  14610091
146200     IF AUCNPO-PO-CART-CNT NOT EQUAL PV-PREV-PO-CART-CNT          14620091
146300         MOVE PV-PREV-PO-CART-CNT       TO PV-HOLD-AFTER-VALUE-N  14630091
146400         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    14640091
146500         MOVE AUCNPO-PO-CART-CNT        TO PV-HOLD-BEFORE-VALUE-N 14650091
146600         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   14660091
146700         MOVE 'CTN                 '    TO PV-HOLD-FIELD-NAME     14670091
146800         PERFORM 4340-PROCESS-CHANGES                             14680091
146900     END-IF.                                                      14690091
147000                                                                  14700091
147100     IF AUCNPO-PO-CBMT-QTY NOT EQUAL PV-PREV-PO-CBMT-QTY          14710091
147200         MOVE PV-PREV-PO-CBMT-QTY       TO PV-HOLD-AFTER-VALUE-V  14720091
147300         MOVE PV-HOLD-AFTER-VALUE-V     TO PV-HOLD-AFTER-VALUE    14730091
147400         MOVE AUCNPO-PO-CBMT-QTY        TO PV-HOLD-BEFORE-VALUE-V 14740091
147500         MOVE PV-HOLD-BEFORE-VALUE-V    TO PV-HOLD-BEFORE-VALUE   14750091
147600         MOVE 'CBM                 '    TO PV-HOLD-FIELD-NAME     14760091
147700         PERFORM 4340-PROCESS-CHANGES                             14770091
147800     END-IF.                                                      14780091
147900                                                                  14790091
148000     IF AUCNPO-PO-WT-KGRM-QTY NOT EQUAL PV-PREV-PO-WT-KGRM-QTY    14800091
148100         MOVE PV-PREV-PO-WT-KGRM-QTY    TO PV-HOLD-AFTER-VALUE-N  14810091
148200         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    14820091
148300         MOVE AUCNPO-PO-WT-KGRM-QTY     TO PV-HOLD-BEFORE-VALUE-N 14830091
148400         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   14840091
148500         MOVE 'KGS                 '    TO PV-HOLD-FIELD-NAME     14850091
148600         PERFORM 4340-PROCESS-CHANGES                             14860091
148700     END-IF.                                                      14870091
148800                                                                  14880091
148900     IF AUCNPO-PO-UNT-QTY     NOT EQUAL PV-PREV-PO-UNT-QTY        14890091
149000         MOVE PV-PREV-PO-UNT-QTY        TO PV-HOLD-AFTER-VALUE-N  14900091
149100         MOVE PV-HOLD-AFTER-VALUE-N     TO PV-HOLD-AFTER-VALUE    14910091
149200         MOVE AUCNPO-PO-UNT-QTY         TO PV-HOLD-BEFORE-VALUE-N 14920091
149300         MOVE PV-HOLD-BEFORE-VALUE-N    TO PV-HOLD-BEFORE-VALUE   14930091
149400         MOVE 'UNITS               '    TO PV-HOLD-FIELD-NAME     14940091
149500         PERFORM 4340-PROCESS-CHANGES                             14950091
149600     END-IF.                                                      14960091
149700                                                                  14970091
151510     IF AUCNPO-BKR-FRGT-RLSE-CDE NOT EQUAL                        15151095
151511                                        PV-PREV-BKR-FRGT-RLSE-CDE 15151195
151520         MOVE PV-PREV-BKR-FRGT-RLSE-CDE TO PV-HOLD-AFTER-VALUE    15152096
151540         MOVE AUCNPO-BKR-FRGT-RLSE-CDE  TO PV-HOLD-BEFORE-VALUE   15154096
151560         MOVE 'BKR FRGT RLSE CDE   '    TO PV-HOLD-FIELD-NAME     15156095
151570         PERFORM 4340-PROCESS-CHANGES                             15157095
151580     END-IF.                                                      15158095
151590                                                                  15159095
151591     IF AUCNPO-DO-RCVD-CDE       NOT EQUAL PV-PREV-DO-RCVD-CDE    15159195
151593         MOVE PV-PREV-DO-RCVD-CDE       TO PV-HOLD-AFTER-VALUE    15159396
151595         MOVE AUCNPO-DO-RCVD-CDE        TO PV-HOLD-BEFORE-VALUE   15159596
151597         MOVE 'DO RCVD CDE         '    TO PV-HOLD-FIELD-NAME     15159795
151598         PERFORM 4340-PROCESS-CHANGES                             15159895
151599     END-IF.                                                      15159995
151600                                                                  15160095
151601     IF AUCNPO-CONTNR-PU-CDE     NOT EQUAL PV-PREV-CONTNR-PU-CDE  15160195
151602         MOVE PV-PREV-CONTNR-PU-CDE     TO PV-HOLD-AFTER-VALUE    15160296
151604         MOVE AUCNPO-CONTNR-PU-CDE      TO PV-HOLD-BEFORE-VALUE   15160496
151606         MOVE 'CONTNR PU CDE       '    TO PV-HOLD-FIELD-NAME     15160695
151607         PERFORM 4340-PROCESS-CHANGES                             15160795
151608     END-IF.                                                      15160895
151609                                                                  15160995
151610     IF AUCNPO-ACTL-POE-DELY-CDE NOT EQUAL                        15161095
151611                                        PV-PREV-ACTL-POE-DELY-CDE 15161195
151612         MOVE PV-PREV-ACTL-POE-DELY-CDE TO PV-HOLD-AFTER-VALUE    15161296
151614         MOVE AUCNPO-ACTL-POE-DELY-CDE  TO PV-HOLD-BEFORE-VALUE   15161496
151616         MOVE 'ATA CDE             '    TO PV-HOLD-FIELD-NAME     15161695
151617         PERFORM 4340-PROCESS-CHANGES                             15161795
151618     END-IF.                                                      15161895
151619                                                                  15161995
151620     IF AUCNPO-DVN-CDE           NOT EQUAL PV-PREV-DVN-CDE        15162095
151622         MOVE PV-PREV-DVN-CDE           TO PV-HOLD-AFTER-VALUE    15162296
151624         MOVE AUCNPO-DVN-CDE            TO PV-HOLD-BEFORE-VALUE   15162496
151626         MOVE 'DEVAN CDE           '    TO PV-HOLD-FIELD-NAME     15162695
151627         PERFORM 4340-PROCESS-CHANGES                             15162795
151628     END-IF.                                                      15162895
151629                                                                  15162995
151630     IF AUCNPO-DCONSLR-RET-CDE   NOT EQUAL PV-PREV-DCONSLR-RET-CDE15163095
151631         MOVE PV-PREV-DCONSLR-RET-CDE   TO PV-HOLD-AFTER-VALUE    15163196
151633         MOVE AUCNPO-DCONSLR-RET-CDE    TO PV-HOLD-BEFORE-VALUE   15163396
151635         MOVE 'DECONSLR RET CDE    '    TO PV-HOLD-FIELD-NAME     15163595
151636         PERFORM 4340-PROCESS-CHANGES                             15163695
151637     END-IF.                                                      15163795
151638                                                                  15163899
151639     IF AUCNPO-SPLT-XMIT-CDE   NOT EQUAL PV-PREV-SPLT-XMIT-CDE    15163999
151640         MOVE PV-PREV-SPLT-XMIT-CDE     TO PV-HOLD-AFTER-VALUE    15164099
151641         MOVE AUCNPO-SPLT-XMIT-CDE      TO PV-HOLD-BEFORE-VALUE   15164199
151642         MOVE 'SPLT XMIT CDE       '    TO PV-HOLD-FIELD-NAME     15164299
151643         PERFORM 4340-PROCESS-CHANGES                             15164399
151644     END-IF.                                                      15164499
151645                                                                  15164595
151646     IF AUCNPO-DOC-RCVD-ORGN-TMST NOT EQUAL                       15164699
151647                                 PV-PREV-DOC-RCVD-ORGN-TMST       15164799
151648         MOVE PV-PREV-DOC-RCVD-ORGN-TMST TO PV-HOLD-TMST-UNFORMAT 15164899
151649         PERFORM 4350-FORMAT-TMST                                 15164999
151650         MOVE PV-TMST                    TO PV-HOLD-AFTER-VALUE   15165099
151651         MOVE AUCNPO-DOC-RCVD-ORGN-TMST  TO PV-HOLD-TMST-UNFORMAT 15165199
151652         PERFORM 4350-FORMAT-TMST                                 15165299
151653         MOVE PV-TMST                    TO PV-HOLD-BEFORE-VALUE  15165399
151654         MOVE 'DOC RCVD ORGN DT    '     TO PV-HOLD-FIELD-NAME    15165899
151655         PERFORM 4340-PROCESS-CHANGES                             15165999
151656     END-IF.                                                      15166099
151657                                                                  15166199
151658     PERFORM 4345-MOVE-TAUCNPO-TO-HOLD.                           15167095
151700                                                                  15170091
151701*----------------------------------------------------------------*15170192
151702*    FORMAT DATE AND TIME FROM LAST UPDATED TIMESTAMP.           *15170292
151703*    THIS PARAGRAPH IS ONLY FOR THE TIMCSCN COMPARES.            *15170392
151704*----------------------------------------------------------------*15170492
151705 4334-FORMAT-LAST-UPD-TMST-2.                                     15170592
151706                                                                  15170692
151707     IF PV-PREV-LAST-UPD-TMST-2(1:10) EQUAL PC-INIT-DATE          15170792
151708        MOVE SPACES                        TO PV-FORMAT-DATE      15170892
151709     ELSE                                                         15170992
151710        MOVE PV-PREV-LAST-UPD-TMST-2(9:2)  TO PV-FORMAT-DD        15171092
151711        MOVE PV-PREV-LAST-UPD-TMST-2(6:2)  TO PV-FORMAT-MM        15171192
151712        MOVE PV-PREV-LAST-UPD-TMST-2(3:2)  TO PV-FORMAT-YY        15171292
151713        MOVE PC-SLASH                      TO PV-FORMAT-SLASH1    15171392
151714                                              PV-FORMAT-SLASH2    15171492
151715     END-IF.                                                      15171592
151716                                                                  15171692
151717     IF PV-PREV-LAST-UPD-TMST-2(12:5) EQUAL PC-INIT-TIME          15171792
151718        MOVE SPACES                        TO PV-FORMAT-TIME      15171892
151719     ELSE                                                         15171992
151720        MOVE PV-PREV-LAST-UPD-TMST-2(12:2) TO PV-FORMAT-HOUR      15172092
151721        MOVE PV-PREV-LAST-UPD-TMST-2(15:2) TO PV-FORMAT-MIN       15172192
151722        MOVE PC-COLON                      TO PV-FORMAT-COLON     15172292
151723     END-IF.                                                      15172392
151730                                                                  15173092
151800*----------------------------------------------------------------*15180091
151900*    FORMAT DATE AND TIME FROM LAST UPDATED TIMESTAMP.           *15190091
152000*----------------------------------------------------------------*15200091
152100 4335-FORMAT-LAST-UPD-TMST.                                       15210091
152200                                                                  15220091
152300     IF PV-PREV-LAST-UPD-TMST(1:10) EQUAL PC-INIT-DATE            15230091
152400         MOVE SPACES                      TO PV-FORMAT-DATE       15240091
152500     ELSE                                                         15250091
152600         MOVE PV-PREV-LAST-UPD-TMST(9:2)  TO PV-FORMAT-DD         15260091
152700         MOVE PV-PREV-LAST-UPD-TMST(6:2)  TO PV-FORMAT-MM         15270091
152800         MOVE PV-PREV-LAST-UPD-TMST(3:2)  TO PV-FORMAT-YY         15280091
152900         MOVE PC-SLASH                    TO PV-FORMAT-SLASH1     15290091
153000                                             PV-FORMAT-SLASH2     15300091
153100     END-IF.                                                      15310091
153200                                                                  15320091
153300     IF PV-PREV-LAST-UPD-TMST(12:5) EQUAL PC-INIT-TIME            15330091
153400         MOVE SPACES                      TO PV-FORMAT-TIME       15340091
153500     ELSE                                                         15350091
153600         MOVE PV-PREV-LAST-UPD-TMST(12:2) TO PV-FORMAT-HOUR       15360091
153700         MOVE PV-PREV-LAST-UPD-TMST(15:2) TO PV-FORMAT-MIN        15370091
153800         MOVE PC-COLON                    TO PV-FORMAT-COLON      15380091
153900     END-IF.                                                      15390091
154000                                                                  15400091
154001*----------------------------------------------------------------*15400192
154002*    PROCESS THE CHANGES THAT WERE FOUND FOR THE AUDIT ROW.      *15400292
154003*    THIS PARA IS THE SAME AS 4340- EXCEPT THAT THE              *15400392
154004*    PV-PREV-LAST-UPD-BY-USR-ID-2 FOR THE TIMCSCN COMPARES       *15400492
154005*    NEEDED TO BE DIFFERENTIATED FROM THE SAME FIELD USED FOR    *15400592
154006*    THE TIMCNTK COMPARES. NOTICE THE -2 AFTER THE FIELD.        *15400692
154007*    THIS PARA ALSO PERFORMS 4334- INSTEAD OF 4335- AGAIN,       *15400792
154008*    THIS IS TO DIFFERENTIATE THE LAST UPD TMST FIELD.           *15400892
154009*----------------------------------------------------------------*15400992
154010 4339-PROCESS-TAUCSCN-CHANGES.                                    15401092
154011                                                                  15401192
154012     PERFORM 4320-GET-SUB.                                        15401292
154013                                                                  15401392
154014     MOVE PV-HOLD-FIELD-NAME   TO ASC-DATA                        15401492
154015                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15401592
154016     MOVE PV-PREV-LAST-UPD-BY-USR-ID-2 TO                         15401692
154017                                  ASC-USERID                      15401792
154018                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15401892
154019     PERFORM 4334-FORMAT-LAST-UPD-TMST-2.                         15401992
154020     MOVE PV-FORMAT-DATE       TO ASC-DATE                        15402092
154021                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15402192
154022     MOVE PV-FORMAT-TIME       TO ASC-TIME                        15402292
154023                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15402392
154024                                                                  15402492
154025     IF PV-HOLD-AFTER-VALUE = SPACES                              15402592
154026         MOVE 'NO DATA'            TO ASC-VALUE                   15402692
154027                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15402792
154028     ELSE                                                         15402892
154029         MOVE PV-HOLD-AFTER-VALUE TO ASC-VALUE                    15402992
154030                                    (ASC-BLK-SUB ASC-ITEM-SUB)    15403092
154031     END-IF.                                                      15403192
154032                                                                  15403292
154033     PERFORM 4320-GET-SUB.                                        15403392
154034                                                                  15403492
154035     MOVE SPACES               TO ASC-DATA                        15403592
154036                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15403692
154037                                  ASC-USERID                      15403792
154038                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15403892
154039                                  ASC-DATE                        15403992
154040                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15404092
154041                                  ASC-TIME                        15404192
154042                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15404292
154043                                                                  15404392
154044     IF PV-HOLD-BEFORE-VALUE = SPACES                             15404492
154045         MOVE 'NO DATA'            TO ASC-VALUE                   15404592
154046                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15404692
154047     ELSE                                                         15404792
154048         MOVE PV-HOLD-BEFORE-VALUE  TO ASC-VALUE                  15404892
154049                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15404992
154050     END-IF.                                                      15405092
154060                                                                  15406092
154061*----------------------------------------------------------------*15406194
154062*    FORMAT TIMESTAMPS                                           *15406294
154063*----------------------------------------------------------------*15406394
154064 4350-FORMAT-TMST.                                                15406494
154065                                                                  15406594
154066     IF PV-HOLD-TMST-UNFORMAT(1:10) EQUAL PC-INIT-DATE            15406694
154067         MOVE SPACES                      TO PV-TMST-DATE         15406794
154068     ELSE                                                         15406894
154069         MOVE PV-HOLD-TMST-UNFORMAT(9:2)  TO PV-TMST-DD           15406994
154070         MOVE PV-HOLD-TMST-UNFORMAT(6:2)  TO PV-TMST-MM           15407094
154071         MOVE PV-HOLD-TMST-UNFORMAT(1:4)  TO PV-TMST-CCYY         15407194
154072         MOVE PC-SLASH                    TO PV-TMST-SLASH1       15407294
154073                                             PV-TMST-SLASH2       15407394
154074     END-IF.                                                      15407494
154075                                                                  15407594
154076     IF PV-HOLD-TMST-UNFORMAT(12:5) EQUAL PC-INIT-TIME            15407694
154077         MOVE SPACES                      TO PV-TMST-TIME         15407794
154078     ELSE                                                         15407894
154079         MOVE PV-HOLD-TMST-UNFORMAT(12:2) TO PV-TMST-HOUR         15407994
154080         MOVE PV-HOLD-TMST-UNFORMAT(15:2) TO PV-TMST-MIN          15408094
154081         MOVE PC-COLON                    TO PV-TMST-COLON        15408194
154082     END-IF.                                                      15408294
154090                                                                  15409094
154100*----------------------------------------------------------------*15410091
154200*    PROCESS THE CHANGES THAT WERE FOUND FOR THE AUDIT ROW.      *15420091
154300*----------------------------------------------------------------*15430091
154400 4340-PROCESS-CHANGES.                                            15440091
154500                                                                  15450091
154600     PERFORM 4320-GET-SUB.                                        15460091
154700                                                                  15470091
154800     MOVE PV-HOLD-FIELD-NAME   TO ASC-DATA                        15480091
154900                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15490091
155000     MOVE PV-PREV-LAST-UPD-BY-USR-ID TO                           15500091
155100                                  ASC-USERID                      15510091
155200                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15520091
155300     PERFORM 4335-FORMAT-LAST-UPD-TMST.                           15530091
155400     MOVE PV-FORMAT-DATE       TO ASC-DATE                        15540091
155500                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15550091
155600     MOVE PV-FORMAT-TIME       TO ASC-TIME                        15560091
155700                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15570091
155800                                                                  15580091
155900     IF PV-HOLD-AFTER-VALUE = SPACES                              15590091
156000         MOVE 'NO DATA'            TO ASC-VALUE                   15600091
156100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15610091
156200     ELSE                                                         15620091
156300         MOVE PV-HOLD-AFTER-VALUE TO ASC-VALUE                    15630091
156400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    15640091
156500     END-IF.                                                      15650091
156600                                                                  15660091
156700     PERFORM 4320-GET-SUB.                                        15670091
156800                                                                  15680091
156900     MOVE SPACES               TO ASC-DATA                        15690091
157000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15700091
157100                                  ASC-USERID                      15710091
157200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15720091
157300                                  ASC-DATE                        15730091
157400                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15740091
157500                                  ASC-TIME                        15750091
157600                                 (ASC-BLK-SUB ASC-ITEM-SUB).      15760091
157700                                                                  15770091
157800     IF PV-HOLD-BEFORE-VALUE = SPACES                             15780091
157900         MOVE 'NO DATA'            TO ASC-VALUE                   15790091
158000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15800091
158100     ELSE                                                         15810091
158200         MOVE PV-HOLD-BEFORE-VALUE  TO ASC-VALUE                  15820091
158300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15830091
158400     END-IF.                                                      15840091
158500                                                                  15850091
158501*----------------------------------------------------------------*15850192
158502* MOVE TAUCSCN VALUES TO HOLD FIELDS FOR COMPARISON.             *15850292
158503*----------------------------------------------------------------*15850392
158504 4344-MOVE-TAUCSCN-TO-HOLD.                                       15850492
158505                                                                  15850592
158506     MOVE AUCSCN-DO-TO-DCONSLR-TMST TO                            15850692
158507                       PV-PREV-DO-TO-DCONSLR-TMST.                15850792
158508     MOVE AUCSCN-LAST-UPD-TMST      TO                            15850892
158509                       PV-PREV-LAST-UPD-TMST-2.                   15850992
158510     MOVE AUCSCN-LAST-UPD-BY-USR-ID TO                            15851092
158511                       PV-PREV-LAST-UPD-BY-USR-ID-2.              15851192
158512                                                                  15851292
158520 EJECT                                                            15852092
158600*----------------------------------------------------------------*15860091
158700* MOVE TAUCNPO VALUES TO HOLD FIELDS FOR COMPARISON.             *15870091
158800*----------------------------------------------------------------*15880091
158900 4345-MOVE-TAUCNPO-TO-HOLD.                                       15890091
159000                                                                  15900091
159100     MOVE AUCNPO-CSTM-ENTR-ID       TO PV-PREV-CSTM-ENTR-ID.      15910091
159200     MOVE AUCNPO-MSTR-BOL-NBR       TO PV-PREV-MSTR-BOL-NBR.      15920091
159300     MOVE AUCNPO-HSE-BOL-NBR        TO PV-PREV-HSE-BOL-NBR.       15930091
159400     MOVE AUCNPO-LTR-OF-CR-NBR      TO PV-PREV-LTR-OF-CR-NBR.     15940091
159500     MOVE AUCNPO-PO-RCVD-DELY-TMST  TO PV-PREV-PO-RCVD-DELY-TMST. 15950091
159600     MOVE AUCNPO-PO-C-O-PROD-CDE    TO PV-PREV-PO-C-O-PROD-CDE.   15960091
159700     MOVE AUCNPO-PO-CART-CNT        TO PV-PREV-PO-CART-CNT.       15970091
159800     MOVE AUCNPO-PO-CBMT-QTY        TO PV-PREV-PO-CBMT-QTY.       15980091
159900     MOVE AUCNPO-PO-WT-KGRM-QTY     TO PV-PREV-PO-WT-KGRM-QTY.    15990091
160000     MOVE AUCNPO-PO-UNT-QTY         TO PV-PREV-PO-UNT-QTY.        16000091
160300     MOVE AUCNPO-LAST-UPD-BY-USR-ID TO                            16030091
160400                                    PV-PREV-LAST-UPD-BY-USR-ID.   16040091
160500     MOVE AUCNPO-LAST-UPD-TMST      TO PV-PREV-LAST-UPD-TMST.     16050091
160510     MOVE AUCNPO-BKR-FRGT-RLSE-CDE  TO PV-PREV-BKR-FRGT-RLSE-CDE. 16051095
160520     MOVE AUCNPO-DO-RCVD-CDE        TO PV-PREV-DO-RCVD-CDE.       16052095
160530     MOVE AUCNPO-CONTNR-PU-CDE      TO PV-PREV-CONTNR-PU-CDE.     16053095
160540     MOVE AUCNPO-ACTL-POE-DELY-CDE  TO PV-PREV-ACTL-POE-DELY-CDE. 16054095
160550     MOVE AUCNPO-DVN-CDE            TO PV-PREV-DVN-CDE.           16055095
160560     MOVE AUCNPO-DCONSLR-RET-CDE    TO PV-PREV-DCONSLR-RET-CDE.   16056095
160570     MOVE AUCNPO-SPLT-XMIT-CDE      TO PV-PREV-SPLT-XMIT-CDE.     16057099
160580     MOVE AUCNPO-DOC-RCVD-ORGN-TMST TO PV-PREV-DOC-RCVD-ORGN-TMST.16058099
160600                                                                  16060091
160700*----------------------------------------------------------------*16070091
160800*    FORMAT DATE AND TIME FROM RECEIVED DELIVERY TIMESTAMP.      *16080091
160900*----------------------------------------------------------------*16090091
161000 4350-FORMAT-DELY-TMST-AFTER.                                     16100091
161100                                                                  16110091
161200     IF PV-PREV-PO-RCVD-DELY-TMST(1:10) EQUAL PC-INIT-DATE        16120091
161300         MOVE SPACES                TO PV-DELY-TMST-DATE          16130091
161400     ELSE                                                         16140091
161500         MOVE PV-PREV-PO-RCVD-DELY-TMST(9:2)  TO PV-DELY-DD       16150091
161600         MOVE PV-PREV-PO-RCVD-DELY-TMST(6:2)  TO PV-DELY-MM       16160091
161700         MOVE PV-PREV-PO-RCVD-DELY-TMST(1:4)  TO PV-DELY-CCYY     16170091
161800         MOVE PC-SLASH                        TO PV-DELY-SLASH1   16180091
161900                                                 PV-DELY-SLASH2   16190091
162000     END-IF.                                                      16200091
162100                                                                  16210091
162200     IF PV-PREV-PO-RCVD-DELY-TMST(12:5) EQUAL PC-INIT-TIME        16220091
162300         MOVE SPACES                TO PV-DELY-TMST-TIME          16230091
162400     ELSE                                                         16240091
162500         MOVE PV-PREV-PO-RCVD-DELY-TMST(12:2) TO PV-DELY-HOUR     16250091
162600         MOVE PV-PREV-PO-RCVD-DELY-TMST(15:2) TO PV-DELY-MIN      16260091
162700         MOVE PC-COLON                        TO PV-DELY-COLON    16270091
162800     END-IF.                                                      16280091
162900                                                                  16290091
163000*----------------------------------------------------------------*16300091
163100*    FORMAT DATE AND TIME FROM RECEIVED DELIVERY TIMESTAMP.      *16310091
163200*----------------------------------------------------------------*16320091
163300 4355-FORMAT-DELY-TMST-BEFORE.                                    16330091
163400                                                                  16340091
163500     IF AUCNPO-PO-RCVD-DELY-TMST(1:10) EQUAL PC-INIT-DATE         16350091
163600         MOVE SPACES                TO PV-DELY-TMST-DATE          16360091
163700     ELSE                                                         16370091
163800         MOVE AUCNPO-PO-RCVD-DELY-TMST(9:2)  TO PV-DELY-DD        16380091
163900         MOVE AUCNPO-PO-RCVD-DELY-TMST(6:2)  TO PV-DELY-MM        16390091
164000         MOVE AUCNPO-PO-RCVD-DELY-TMST(1:4)  TO PV-DELY-CCYY      16400091
164100         MOVE PC-SLASH                       TO PV-DELY-SLASH1    16410091
164200                                                PV-DELY-SLASH2    16420091
164300     END-IF.                                                      16430091
164400                                                                  16440091
164500     IF AUCNPO-PO-RCVD-DELY-TMST(12:5) EQUAL PC-INIT-TIME         16450091
164600         MOVE SPACES                TO PV-DELY-TMST-TIME          16460091
164700     ELSE                                                         16470091
164800         MOVE AUCNPO-PO-RCVD-DELY-TMST(12:2) TO PV-DELY-HOUR      16480091
164900         MOVE AUCNPO-PO-RCVD-DELY-TMST(15:2) TO PV-DELY-MIN       16490091
165000         MOVE PC-COLON                       TO PV-DELY-COLON     16500091
165100     END-IF.                                                      16510091
165200                                                                  16520091
165300*----------------------------------------------------------------*16530091
165400*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *16540091
165500*----------------------------------------------------------------*16550091
165600 4400-MOVE-COMMAREA-TO-SCREEN.                                    16560091
165700                                                                  16570091
165800     MOVE ASC-KEY-CONTNR-NBR     TO ACNTNRO.                      16580091
165900     MOVE ASC-KEY-PO-NBR         TO APONBRO.                      16590091
165921     MOVE PV-EXTL-REF-NBR        TO AREFNBRO.                     16592199
166000                                                                  16600091
166100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             16610091
166200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          16620091
166300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          16630091
166400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             16640091
166500                 GIVING PV-BLOCK-NUMBER                           16650091
166600                 REMAINDER PV-REMAINDER                           16660091
166700             IF  PV-REMAINDER > ZERO                              16670091
166800                 ADD +1 TO PV-BLOCK-NUMBER                        16680091
166900             END-IF                                               16690091
167000             MOVE +1    TO ASC-BLK-SUB                            16700091
167100             PERFORM 4410-READ-TEMP-STORAGE                       16710091
167200             ADD +1     TO ASC-BLK-SUB                            16720091
167300                           PV-BLOCK-NUMBER                        16730091
167400             PERFORM 4410-READ-TEMP-STORAGE                       16740091
167500     END-IF.                                                      16750091
167600     MOVE +1                       TO ASC-BLK-SUB.                16760091
167700     COMPUTE ASC-ITEM-SUB =                                       16770091
167800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              16780091
167900         + PC-ITEMS-PER-PANEL).                                   16790091
168000                                                                  16800091
168100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16810091
168200         ADD +1   TO ASC-BLK-SUB                                  16820091
168300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16830091
168400     END-IF.                                                      16840091
168500                                                                  16850091
168600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           16860091
168700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                16870091
168800     PERFORM 4420-FORMAT-LIST-LINES                               16880091
168900         VARYING PS-SUB                                           16890091
169000         FROM PC-ITEMS-PER-PANEL BY -1                            16900091
169100         UNTIL PS-SUB < +1.                                       16910091
169200                                                                  16920091
169300     COMPUTE ASC-ITEMS-DISPLAYED =                                16930091
169400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          16940091
169500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    16950091
169600                                      ASTRTITO.                   16960091
169700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    16970091
169800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    16980091
169900                                                                  16990091
170000     IF  DP020-MSG-NUMBER-X = SPACE                               17000091
170100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  17010091
170200*            --- MORE ITEMS TO DISPLAY ----                       17020091
170300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            17030091
170400             SET DP020-MSG-INFORMATIONAL TO TRUE                  17040091
170500         END-IF                                                   17050091
170600     END-IF.                                                      17060091
170700                                                                  17070091
170800*----------------------------------------------------------------*17080091
170900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *17090091
171000*----------------------------------------------------------------*17100091
171100                                                                  17110091
171200 4410-READ-TEMP-STORAGE.                                          17120091
171300                                                                  17130091
171400     EXEC CICS                                                    17140091
171500         READQ TS                                                 17150091
171600             QUEUE (ASC-DTL-QUEUE-NAME)                           17160091
171700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               17170091
171800             ITEM  (PV-BLOCK-NUMBER)                              17180091
171900             RESP  (PV-CICS-RESP)                                 17190091
172000     END-EXEC.                                                    17200091
172100                                                                  17210091
172200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       17220091
172300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     17230091
172400         CONTINUE                                                 17240091
172500     ELSE                                                         17250091
172600         SET DP013-CICS-ABEND TO  TRUE                            17260091
172700         SET DP013-NO-ROLLBACK TO  TRUE                           17270091
172800         MOVE '4410-READ-TEMP-STORAGE'                            17280091
172900                               TO  DP013-PARAGRAPH                17290091
173000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      17300091
173100                               TO  DP013-MESSAGE-TEXT(1)          17310091
173200         PERFORM DP013-0000-PROCESS-ABEND                         17320091
173300     END-IF.                                                      17330091
173400                                                                  17340091
173500*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             17350091
173600                                                                  17360091
173700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         17370091
173800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               17380091
173900     END-IF.                                                      17390091
174000 EJECT                                                            17400091
174100*----------------------------------------------------------------*17410091
174200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *17420091
174300*----------------------------------------------------------------*17430091
174400                                                                  17440091
174500 4420-FORMAT-LIST-LINES.                                          17450091
174600                                                                  17460091
174700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      17470091
174800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                17480091
174900         MOVE SPACES            TO MR-DATA   (PS-SUB)             17490091
175000                                   MR-USERID (PS-SUB)             17500091
175100                                   MR-DATE   (PS-SUB)             17510091
175200                                   MR-TIME   (PS-SUB)             17520091
175300                                   MR-VALUE  (PS-SUB)             17530091
175400     ELSE                                                         17540091
175500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           17550091
175600             MOVE ASC-DATA      (ASC-BLK-SUB ASC-ITEM-SUB)        17560091
175700                                TO MR-DATA (PS-SUB)               17570091
175800             MOVE ASC-USERID    (ASC-BLK-SUB ASC-ITEM-SUB)        17580091
175900                                TO MR-USERID (PS-SUB)             17590091
176000             MOVE ASC-DATE      (ASC-BLK-SUB ASC-ITEM-SUB)        17600091
176100                                TO MR-DATE (PS-SUB)               17610091
176200             MOVE ASC-TIME      (ASC-BLK-SUB ASC-ITEM-SUB)        17620091
176300                                TO MR-TIME (PS-SUB)               17630091
176400             MOVE ASC-VALUE     (ASC-BLK-SUB ASC-ITEM-SUB)        17640091
176500                                TO MR-VALUE (PS-SUB)              17650091
176600         END-IF                                                   17660091
176700     END-IF.                                                      17670091
176800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17680091
176900     IF  ASC-ITEM-SUB < + 1                                       17690091
177000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17700091
177100         MOVE +1                 TO ASC-BLK-SUB                   17710091
177200     END-IF.                                                      17720091
177300                                                                  17730091
177400*----------------------------------------------------------------*17740091
177500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *17750091
177600*----------------------------------------------------------------*17760091
177700                                                                  17770091
177800 5100-WRITE-TEMP-STORAGE.                                         17780091
177900                                                                  17790091
178000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     17800091
178100                               TO  PV-LIST-ITEM-NUMBER.           17810091
178200     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           17820091
178300         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           17830091
178400                                                                  17840091
178500     EXEC CICS                                                    17850091
178600         WRITEQ TS                                                17860091
178700             QUEUE (ASC-DTL-QUEUE-NAME)                           17870091
178800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               17880091
178900             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     17890091
179000             RESP  (PV-CICS-RESP)                                 17900091
179100     END-EXEC.                                                    17910091
179200                                                                  17920091
179300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      17930091
179400         SET DP013-CICS-ABEND                                     17940091
179500                       TO  TRUE                                   17950091
179600         SET DP013-NO-ROLLBACK                                    17960091
179700                       TO  TRUE                                   17970091
179800         MOVE '5100-WRITE-TEMP-STORAGE'                           17980091
179900                       TO  DP013-PARAGRAPH                        17990091
180000         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       18000091
180100                       TO  DP013-MESSAGE-TEXT(1)                  18010091
180200         PERFORM DP013-0000-PROCESS-ABEND                         18020091
180300     END-IF.                                                      18030091
180400     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             18040091
180500                                                                  18050091
180600 EJECT                                                            18060091
180700*----------------------------------------------------------------*18070091
180800*    ABEND PROCESSOR MODULE                                      *18080091
180900*----------------------------------------------------------------*18090091
181000                                                                  18100091
181100     COPY DPPD013.                                                18110091
