000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      DPKUT004.                                       00040000
000500 AUTHOR.          MICHAEL N TYE, CAP GEMINI AMERICA.              00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    AUGUST 12, 1988.                                00070000
000800 DATE-COMPILED.                                                   00080000
000900*                                                                 00090001
001000*  THIS PROGRAM CREATES A FILE TO BE USED TO LOAD THE TP1PGM      00100001
001100*  TABLE.  A PROGRAM-TO-PROC CROSS-REFERENCE FILE THAT INCLUDES   00110001
001200*  PROGRAM TITLE INFORMATION FROM THE PROGRAM DOCUMENTATION PDS   00120001
001300*  IS MERGED WITH A PROGRAM LANGUAGE FILE TO CREATE A COMPOSITE   00130001
001400*  PROGRAM FILE.  AN EXTRACT FROM THE CICS LOADLIB THAT IDENTIFIES00140001
001500*  PROGRAMS AND MAPSETS IS USED TO FURTHER QUALIFY THE PROGRAM    00150001
001600*  TYPE/LANGUAGE TYPE.  JOB AND PROCSTEP TABLE ENTRIES ARE        00160014
001610*  CREATED FOR EACH CICS COBOL OR CICS ASSEMBLER PROGRAM.         00161014
001700*                                                                 00170001
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER. IBM-3090.                                       00200000
002100 OBJECT-COMPUTER. IBM-3090.                                       00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT PGM-PROC-DESC-FILE         ASSIGN TO INP01.           00250001
002600     SELECT PROGRAM-LANGUAGE-FILE      ASSIGN TO INP02.           00260001
002700     SELECT CICS-PROGRAM-FILE          ASSIGN TO INP03.           00270000
002800     SELECT PGM-TABLE-DATA-FILE        ASSIGN TO OUT01.           00280000
002810     SELECT JOB-TABLE-DATA-FILE        ASSIGN TO OUT02.           00281009
002820     SELECT PROCSTEP-TABLE-DATA-FILE   ASSIGN TO OUT03.           00282009
002900                                                                  00290000
003000***************                                                   00300000
003100 DATA DIVISION.                                                   00310000
003200***************                                                   00320000
003300 FILE SECTION.                                                    00330000
003400 FD  PGM-PROC-DESC-FILE                                           00340001
003500                         BLOCK CONTAINS 0 RECORDS                 00350009
003600                         RECORD CONTAINS 60 CHARACTERS            00360009
003700                         LABEL RECORDS ARE STANDARD               00370009
003800                         RECORDING MODE F                         00380009
003900                         DATA RECORD IS PGM-PROC-DESC-REC.        00390009
004000 01  PGM-PROC-DESC-REC          PIC X(60).                        00400009
004100                                                                  00410000
004200 FD  PROGRAM-LANGUAGE-FILE                                        00420001
004300                         BLOCK CONTAINS 0 RECORDS                 00430009
004400                         RECORD CONTAINS 14 CHARACTERS            00440009
004500                         LABEL RECORDS ARE STANDARD               00450009
004600                         RECORDING MODE F                         00460009
004700                         DATA RECORD IS PROGRAM-LANGUAGE-REC.     00470009
004800 01  PROGRAM-LANGUAGE-REC       PIC X(14).                        00480009
004900                                                                  00490000
005000 FD  CICS-PROGRAM-FILE                                            00500000
005100                         BLOCK CONTAINS 0 RECORDS                 00510009
005200                         RECORD CONTAINS 12 CHARACTERS            00520009
005300                         LABEL RECORDS ARE STANDARD               00530009
005400                         RECORDING MODE F                         00540009
005500                         DATA RECORD IS CICS-PROGRAM-RECORD.      00550009
005600 01  CICS-PROGRAM-RECORD        PIC X(12).                        00560009
005700                                                                  00570000
005800 FD  PGM-TABLE-DATA-FILE                                          00580000
005900                         BLOCK CONTAINS 0 RECORDS                 00590009
006000                         RECORD CONTAINS 63 CHARACTERS            00600009
006100                         LABEL RECORDS ARE STANDARD               00610009
006200                         RECORDING MODE F                         00620009
006300                         DATA RECORD IS PGM-TABLE-DATA-REC.       00630009
006400 01  PGM-TABLE-DATA-REC         PIC X(63).                        00640009
006401                                                                  00640109
006410 FD  JOB-TABLE-DATA-FILE                                          00641009
006420                         BLOCK CONTAINS 0 RECORDS                 00642009
006430                         RECORD CONTAINS 60 CHARACTERS            00643009
006440                         LABEL RECORDS ARE STANDARD               00644009
006450                         RECORDING MODE F                         00645009
006460                         DATA RECORD IS JOB-TABLE-DATA-REC.       00646009
006470 01  JOB-TABLE-DATA-REC         PIC X(60).                        00647009
006480                                                                  00648009
006490 FD  PROCSTEP-TABLE-DATA-FILE                                     00649009
006491                         BLOCK CONTAINS 0 RECORDS                 00649109
006492                         RECORD CONTAINS 24 CHARACTERS            00649209
006493                         LABEL RECORDS ARE STANDARD               00649309
006494                         RECORDING MODE F                         00649409
006495                         DATA RECORD IS PROCSTEP-TABLE-DATA-REC.  00649509
006496 01  PROCSTEP-TABLE-DATA-REC     PIC X(24).                       00649609
006500                                                                  00650000
006600 WORKING-STORAGE SECTION.                                         00660000
006700                                                                  00670000
006800**   PGM-PROC-DESC-FILE LAYOUT (INPUT)      **                    00680001
006900 01  PP-PGM-PROC-DESC-RECORD.                                     00690001
007000     05  PP-PGM-NAME-PANVALET.                                    00700001
007100         10  PP-PGM-NAME         PIC X(8)       VALUE SPACES.     00710003
007200         10  FILLER              PIC X(2)       VALUE SPACES.     00720003
007300     05  PP-PGM-DESC             PIC X(50)      VALUE SPACES.     00730001
007400                                                                  00740000
007500**   PROGRAM-LANGUAGE-FILE LAYOUT (INPUT) **                      00750001
007600 01  PL-PROGRAM-LANGUAGE-RECORD.                                  00760002
007700     05  PL-PGM-NAME             PIC X(8)       VALUE SPACES.     00770003
007710     05  FILLER                  PIC X(1)       VALUE SPACES.     00771003
007800     05  PL-PGM-LANGUAGE         PIC X(5)       VALUE SPACES.     00780003
007900         88  PL-COBOL-LANGUAGE                  VALUE 'COBOL'.    00790001
008000         88  PL-ASSEMBLER-LANGUAGE              VALUE 'ASSEM'.    00800001
008100         88  PL-DYL-280-LANGUAGE                VALUE 'DYL28'.    00810001
008200                                                                  00820000
008300**   CICS-PROGRAM-FILE LAYOUT (INPUT)  **                         00830000
008400 01  CP-CICS-PROGRAM-RECORD.                                      00840001
008500     05  CP-PGM-NAME             PIC X(8)       VALUE SPACES.     00850003
008600     05  CP-MAP-IND              PIC X(4)       VALUE SPACES.     00860003
008700         88  CP-BMS-MAPSET                      VALUE 'MAP '.     00870001
008800                                                                  00880000
008900**   PGM-TABLE-DATA-FILE LAYOUT (OUTPUT)  **                      00890000
009000 01  PT-PROGRAM-TABLE-RECORD.                                     00900001
009100     05  PT-PGM-NAME             PIC X(8)       VALUE SPACES.     00910003
009200     05  PT-PGM-DESC             PIC X(50)      VALUE SPACES.     00920001
009300     05  PT-PGM-LANG-DESC        PIC X(5)       VALUE SPACES.     00930003
009400         88  PT-PL-COBOL                        VALUE 'COBOL'.    00940001
009500         88  PT-PL-ASSEMBLER                    VALUE 'ASSEM'.    00950001
009600         88  PT-PL-DYL-280                      VALUE 'DYL28'.    00960001
009700         88  PT-PL-CICS-COBOL                   VALUE 'CICSC'.    00970001
009800         88  PT-PL-CICS-ASSEMBLER               VALUE 'CICSA'.    00980001
009900         88  PT-PL-BMS-MAPSET                   VALUE 'CICSM'.    00990001
009910         88  PT-PL-CICS                         VALUE 'CICSC',    00991004
009920                                                      'CICSA',    00992004
009930                                                      'CICSM'.    00993004
009940                                                                  00994010
009950**   JOB-TABLE-DATA-FILE LAYOUT (OUTPUT)  **                      00995010
009960 01  JT-JOB-TABLE-RECORD.                                         00996010
009970     05  JT-JOB-NAME             PIC X(8)       VALUE SPACES.     00997010
009980     05  JT-JOB-DESC             PIC X(50)      VALUE SPACES.     00998010
009990     05  JT-TYPE-CODE            PIC X(1)       VALUE SPACES.     00999010
009991         88  JT-TC-CICS                         VALUE 'C'.        00999110
009992     05  JT-FRQNCY-CODE          PIC X(1)       VALUE SPACES.     00999210
009993         88  JT-FC-REQUEST                      VALUE 'R'.        00999310
009994                                                                  00999410
009995**   PROCSTEP-TABLE-DATA-FILE LAYOUT (OUTPUT)  **                 00999510
010000     COPY DPRD008O.                                               01000010
010010                                                                  01001010
010100 01  PS-PROGRAM-SWITCHES.                                         01010001
010200     05  PS-EOF-PGM-PROC-DESC    PIC X(1)       VALUE 'N'.        01020001
010300         88  EOF-PGM-PROC-DESC                  VALUE 'Y'.        01030001
010400     05  PS-EOF-PROGRAM-LANGUAGE PIC X(1)       VALUE 'N'.        01040001
010500         88  EOF-PROGRAM-LANGUAGE               VALUE 'Y'.        01050001
010600     05  PS-EOF-CICS-PROGRAM     PIC X(1)       VALUE 'N'.        01060001
010700         88  EOF-CICS-PROGRAM                   VALUE 'Y'.        01070001
010710     05  PS-USED-IN-PROD-IND     PIC X(1)       VALUE 'N'.        01071004
010720         88  PS-USED-IN-PROD                    VALUE 'Y'.        01072004
010730         88  PS-NOT-USED-IN-PROD                VALUE 'N'.        01073004
010800                                                                  01080001
010900 01  PC-PROGRAM-CONSTANTS.                                        01090001
011000     05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKUT004'. 01100001
011001     05  PC-DEFAULT-PROCSTEP     PIC X(8)       VALUE 'S000    '. 01100110
011002                                                                  01100210
011003 01  PV-PROGRAM-VARIABLES.                                        01100310
011004     05  PV-SAVE-PT-RECORD       PIC X(63)      VALUE SPACES.     01100410
011100                                                                  01110000
011300********************                                              01130000
011400 PROCEDURE DIVISION.                                              01140000
011500********************                                              01150000
011600                                                                  01160000
011700     OPEN INPUT  PGM-PROC-DESC-FILE                               01170001
011800                 PROGRAM-LANGUAGE-FILE                            01180001
011900                 CICS-PROGRAM-FILE                                01190000
012000          OUTPUT PGM-TABLE-DATA-FILE                              01200009
012010                 JOB-TABLE-DATA-FILE                              01201009
012020                 PROCSTEP-TABLE-DATA-FILE.                        01202009
012100                                                                  01210000
012200     PERFORM X100-READ-PGM-LANG-FILE.                             01220001
012300     PERFORM X200-READ-PGM-PROC-DESC-FILE.                        01230001
012400     PERFORM X300-READ-CICS-PROGRAM-FILE.                         01240001
012500                                                                  01250000
012600     PERFORM A100-MERGE-PROGRAM-FILES                             01260001
012700         UNTIL ((EOF-PGM-PROC-DESC)                               01270001
012800                 AND (EOF-PROGRAM-LANGUAGE)).                     01280001
012900                                                                  01290000
013000     CLOSE       PGM-PROC-DESC-FILE                               01300001
013100                 PROGRAM-LANGUAGE-FILE                            01310001
013200                 CICS-PROGRAM-FILE                                01320000
013300                 PGM-TABLE-DATA-FILE                              01330009
013310                 JOB-TABLE-DATA-FILE                              01331009
013320                 PROCSTEP-TABLE-DATA-FILE.                        01332009
013400                                                                  01340000
013500     STOP RUN.                                                    01350000
013600                                                                  01360000
013700******************************************************************01370000
013800 A100-MERGE-PROGRAM-FILES.                                        01380001
013900                                                                  01390000
014000     EVALUATE TRUE                                                01400001
014100         WHEN PP-PGM-NAME < PL-PGM-NAME                           01410001
014110             SET PS-USED-IN-PROD     TO TRUE                      01411004
014200             MOVE PP-PGM-NAME        TO PT-PGM-NAME               01420004
014300             MOVE PP-PGM-DESC        TO PT-PGM-DESC               01430004
014400             INITIALIZE PT-PGM-LANG-DESC                          01440001
014500             PERFORM X200-READ-PGM-PROC-DESC-FILE                 01450001
014600         WHEN PP-PGM-NAME = PL-PGM-NAME                           01460001
014610             SET PS-USED-IN-PROD     TO TRUE                      01461004
014700             MOVE PP-PGM-NAME        TO PT-PGM-NAME               01470004
014800             MOVE PP-PGM-DESC        TO PT-PGM-DESC               01480004
014900             MOVE PL-PGM-LANGUAGE    TO PT-PGM-LANG-DESC          01490004
015000             PERFORM X100-READ-PGM-LANG-FILE                      01500001
015100             PERFORM X200-READ-PGM-PROC-DESC-FILE                 01510001
015200         WHEN OTHER                                               01520001
015210             SET PS-NOT-USED-IN-PROD TO TRUE                      01521004
015300             MOVE PL-PGM-NAME        TO PT-PGM-NAME               01530004
015400             INITIALIZE PT-PGM-DESC                               01540004
015500             MOVE PL-PGM-LANGUAGE    TO PT-PGM-LANG-DESC          01550004
015600             PERFORM X100-READ-PGM-LANG-FILE                      01560001
015700     END-EVALUATE.                                                01570001
015800                                                                  01580000
015900     PERFORM A200-CHECK-FOR-CICS-PGM                              01590000
016000         UNTIL ((EOF-CICS-PROGRAM)                                01600001
016100                 OR (CP-PGM-NAME > PT-PGM-NAME)).                 01610007
016200                                                                  01620000
016210     IF ((PS-USED-IN-PROD)                                        01621005
016220             OR (PT-PL-CICS))                                     01622004
016300         PERFORM X400-WRITE-PGM-TABLE-RECORD                      01630004
016500     END-IF.                                                      01650010
016600*A100-END.                                                        01660001
016700                                                                  01670001
016800******************************************************************01680000
016900 A200-CHECK-FOR-CICS-PGM.                                         01690000
017000     EVALUATE TRUE                                                01700001
017100         WHEN CP-PGM-NAME < PT-PGM-NAME                           01710002
017312             MOVE PT-PROGRAM-TABLE-RECORD TO PV-SAVE-PT-RECORD    01731208
017313             MOVE CP-PGM-NAME TO PT-PGM-NAME                      01731308
017314             INITIALIZE PT-PGM-DESC                               01731408
017315             IF CP-BMS-MAPSET                                     01731513
017316                 SET PT-PL-BMS-MAPSET TO TRUE                     01731613
017317             ELSE                                                 01731713
017318                 SET PT-PL-CICS-COBOL TO TRUE                     01731813
017319                 PERFORM A300-CREATE-CICS-JOB-PROC                01731913
017320             END-IF                                               01732013
017321             PERFORM X400-WRITE-PGM-TABLE-RECORD                  01732108
017322             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CICS LOADLIB '  01732213
017323                       'MEMBER '  CP-PGM-NAME  ' NOT FOUND'       01732313
017324                       ' IN PROGRAM REFERENCE FILES - RECORD '    01732413
017325                       'CREATED - LANGUAGE TYPE IS '              01732513
017326                       PT-PGM-LANG-DESC                           01732613
017330             MOVE PV-SAVE-PT-RECORD TO PT-PROGRAM-TABLE-RECORD    01733008
017400         WHEN CP-BMS-MAPSET                                       01740001
017500             SET PT-PL-BMS-MAPSET TO TRUE                         01750001
017600         WHEN PT-PL-COBOL                                         01760001
017700             SET PT-PL-CICS-COBOL TO TRUE                         01770001
017710             PERFORM A300-CREATE-CICS-JOB-PROC                    01771012
017800         WHEN PT-PL-ASSEMBLER                                     01780001
017900             SET PT-PL-CICS-ASSEMBLER TO TRUE                     01790001
017910             PERFORM A300-CREATE-CICS-JOB-PROC                    01791012
018000         WHEN OTHER                                               01800001
018010             IF PT-PGM-LANG-DESC = SPACES                         01801011
018020                 MOVE ALL '?' TO PT-PGM-LANG-DESC                 01802011
018030             END-IF                                               01803011
018100             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '  CP-PGM-NAME  01810002
018200                       ' IS NOT OF A CICS-COMPATIBLE LANGUAGE.  ' 01820002
018210                       CP-PGM-NAME  ' IS '  PT-PGM-LANG-DESC      01821002
018300     END-EVALUATE.                                                01830002
018400                                                                  01840000
018500     PERFORM X300-READ-CICS-PROGRAM-FILE.                         01850001
018600*A200-END.                                                        01860001
018610                                                                  01861012
018620******************************************************************01862012
018630 A300-CREATE-CICS-JOB-PROC.                                       01863012
018631                                                                  01863112
018640     MOVE PT-PGM-NAME         TO JT-JOB-NAME.                     01864012
018650     MOVE PT-PGM-DESC         TO JT-JOB-DESC.                     01865012
018660     SET JT-TC-CICS                                               01866012
018670         JT-FC-REQUEST        TO TRUE.                            01867012
018680     PERFORM X500-WRITE-JOB-TABLE-RECORD.                         01868012
018681                                                                  01868112
018690     MOVE PT-PGM-NAME         TO DP008O-PROC-NAME                 01869012
018691                                 DP008O-PROGRAM-NAME.             01869112
018692     MOVE PC-DEFAULT-PROCSTEP TO DP008O-PROCSTEP-NAME.            01869212
018693     PERFORM X600-WRITE-PROC-TABLE-RECORD.                        01869312
018694*A300-END.                                                        01869412
018700                                                                  01870000
018800******************************************************************01880000
018900 X100-READ-PGM-LANG-FILE.                                         01890002
019000                                                                  01900000
019100     READ PROGRAM-LANGUAGE-FILE INTO PL-PROGRAM-LANGUAGE-RECORD   01910001
019200         AT END                                                   01920000
019300             SET EOF-PROGRAM-LANGUAGE TO TRUE                     01930001
019400             MOVE HIGH-VALUES         TO PL-PGM-NAME.             01940001
019500*X100-END.                                                        01950001
019600                                                                  01960000
019700******************************************************************01970000
019800 X200-READ-PGM-PROC-DESC-FILE.                                    01980001
019900                                                                  01990000
020000     READ PGM-PROC-DESC-FILE    INTO PP-PGM-PROC-DESC-RECORD      02000001
020100         AT END                                                   02010000
020200             SET EOF-PGM-PROC-DESC    TO TRUE                     02020001
020300             MOVE HIGH-VALUES         TO PP-PGM-NAME.             02030001
020400*X200-END.                                                        02040001
020500                                                                  02050000
020600******************************************************************02060000
020700 X300-READ-CICS-PROGRAM-FILE.                                     02070001
020800                                                                  02080000
020900     READ CICS-PROGRAM-FILE     INTO CP-CICS-PROGRAM-RECORD       02090001
021000         AT END                                                   02100000
021100             SET EOF-CICS-PROGRAM     TO TRUE                     02110001
021200             MOVE HIGH-VALUES         TO CP-PGM-NAME.             02120001
021300*X300-END.                                                        02130001
021400                                                                  02140001
021500******************************************************************02150001
021600 X400-WRITE-PGM-TABLE-RECORD.                                     02160001
021700                                                                  02170001
021800     WRITE PGM-TABLE-DATA-REC       FROM PT-PROGRAM-TABLE-RECORD. 02180010
021900*X400-END.                                                        02190007
022000                                                                  02200010
022100******************************************************************02210010
022200 X500-WRITE-JOB-TABLE-RECORD.                                     02220010
022300                                                                  02230010
022400     WRITE JOB-TABLE-DATA-REC       FROM JT-JOB-TABLE-RECORD.     02240010
022500*X500-END.                                                        02250010
022600                                                                  02260010
022700******************************************************************02270010
022800 X600-WRITE-PROC-TABLE-RECORD.                                    02280010
022900                                                                  02290010
023000     WRITE PROCSTEP-TABLE-DATA-REC  FROM DP008O-RECORD.           02300010
023100*X400-END.                                                        02310010
