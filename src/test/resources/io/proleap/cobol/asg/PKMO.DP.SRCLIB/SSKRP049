000100***************************************************************** 00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300***************************************************************** 00030003
000400                                                                  00040003
000500 PROGRAM-ID.             SSKRP049.                                00050003
000600 AUTHOR.                 KOHLS.                                   00060003
000700 INSTALLATION.           KOHLS.                                   00070003
000800 DATE-WRITTEN            01-27-2003.                              00080003
000900 DATE-COMPILED.                                                   00090003
001000                                                                  00100003
001100***************************************************************** 00110003
001200*                                                                 00120003
001300*  THIS PROGRAM CREATES A REPORT SHOWING LID COUNTS AT DIFFERENT  00130003
001400*  POINTS IN THE DAY.  THIS NEW REPORT WILL BE DESIGNED TO        00140003
001500*  HIGHLIGHT WHERE LID'S HAVE BEEN TAKEN MULTIPLE TIMES.  THE     00150003
001600*  STORES WILL USE THESE REPORT TO FOLLOW UP ON POSSIBLE          00160003
001700*  INTERNAL FRAUD AND OTHER ISSUES CONNECTED WITH MULTIPLE        00170003
001800*  LID'S BEING TAKEN.  THE INPUT FILE CONTAINS LID RETRIEVED      00180003
001900*  IN PROGRAM SSKUT049 AND THEN SORTED TO BE DISPLAYED IN         00190003
002000*  REPORT FORMAT.                                                 00200003
002100*                                                                 00210003
002200***************************************************************** 00220003
002300*  CHANGES MADE:                                                  00230003
002400*      BY : JODY TAINTER                       WR: WR24073        00240003
002500* ADDED UNITS COLUMN TO REPORT                                    00250003
002600*                                                                 00260003
002700***************************************************************** 00280005
W30384*  CHANGES MADE:                                                  00290005
W30384*      BY : CAROLE MCCAMMON                    WR: WR30384        00300005
W30384* REPLACED HARDCODED FLE1- LAYOUT W/COPYBOOK SSRD007 & ALL XREFS. 00310005
W30384*                                                                 00320105
W30384***************************************************************** 00320205
002900*  CHANGES MADE:                                                  00321005
003000*      BY :                                    WR:                00322005
003100*                                                                 00323008
003200*                                                                 00324005
011168******************************************************************00330012
011168** CHNAGES MADE BY : COGNIZANT                011168:PKE          00331008
011168** INCLUDED EMPTY FILE CHECK PARAGRAPH FOR LID FILE               00332008
011168******************************************************************00333008
003400***************************************************************** 00340003
003500 ENVIRONMENT DIVISION.                                            00350003
003600***************************************************************** 00360003
003700                                                                  00370003
003800 CONFIGURATION SECTION.                                           00380003
003900                                                                  00390003
004000 SOURCE-COMPUTER.        IBM-3090.                                00400003
004100                                                                  00410003
004200 OBJECT-COMPUTER.        IBM-3090.                                00420003
004300                                                                  00430003
004400 INPUT-OUTPUT SECTION.                                            00440003
004500                                                                  00450003
004600 FILE-CONTROL.                                                    00460003
004700                                                                  00470003
004800     SELECT POS-DATE-CARD-FILE                                    00480003
004900         ASSIGN TO INP01.                                         00490003
005000                                                                  00500003
005100     SELECT LINE-ITEM-DISC-FILE                                   00510003
005200         ASSIGN TO INP02.                                         00520003
005300                                                                  00530003
005400     SELECT LINE-ITEM-DISC-REPORT                                 00540003
005500         ASSIGN TO RPT01.                                         00550003
005600                                                                  00560003
005700 EJECT                                                            00570003
005800******************************************************************00580003
005900 DATA DIVISION.                                                   00590003
006000******************************************************************00600003
006100                                                                  00610003
006200 FILE SECTION.                                                    00620003
006300                                                                  00630003
006400 FD  POS-DATE-CARD-FILE                                           00640003
006500     RECORDING MODE IS F                                          00650003
006600     BLOCK CONTAINS 0 RECORDS                                     00660003
006700     LABEL RECORDS ARE STANDARD.                                  00670003
006800                                                                  00680003
006900 01  POS-DATE-CARD-RECORD            PIC X(80).                   00690003
007000                                                                  00700003
007100 FD  LINE-ITEM-DISC-FILE                                          00710003
007200     RECORDING MODE IS F                                          00720003
007300     BLOCK CONTAINS 0 RECORDS                                     00730003
007400     LABEL RECORDS ARE OMITTED.                                   00740003
007500                                                                  00750003
007600 01  LINE-ITEM-DISC-FLE              PIC  X(200).                 00760003
007700                                                                  00770003
007800 FD  LINE-ITEM-DISC-REPORT                                        00780003
007900     RECORDING MODE IS F                                          00790003
008000     BLOCK CONTAINS 0  RECORDS.                                   00800003
008100                                                                  00810003
008200 01  LINE-ITEM-DISC-RECORD           PIC  X(200).                 00820003
008300 EJECT                                                            00830003
008400******************************************************************00840003
008500 WORKING-STORAGE SECTION.                                         00850003
008600******************************************************************00860003
008700 01  FILLER                            PIC X(50)  VALUE           00870003
008800     ' *** WORKING STORAGE STARTS HERE FOR SSKRP049 *** '.        00880003
008900                                                                  00890003
009000******************************************************************00900003
009100* RECORD LAYOUT FOR INPUT DATE CARD                               00910003
009200******************************************************************00920003
009300 01  CC-DATE-CARD.                                                00930003
009400     05  CC-DATE.                                                 00940003
009500        10  CC-YEAR                     PIC X(04).                00950003
009600        10  CC-DASH1                    PIC X(01).                00960003
009700        10  CC-MONTH                    PIC X(02).                00970003
009800        10  CC-DASH2                    PIC X(01).                00980003
009900        10  CC-DAY                      PIC X(02).                00990003
010000     05  FILLER                         PIC X(70) VALUE SPACES.   01000003
010100                                                                  01010003
010200******************************************************************01020003
010300* RECORD LAYOUT FOR INPUT LID FILE                                01030003
010400******************************************************************01040003
W30384     COPY SSRD007.                                                01050003
012400                                                                  01250003
012500 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01260003
012600                                                  COMP SYNC.      01270003
012700     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01280003
012800                                                                  01290003
012900 01  PS-PROGRAM-SWITCHES.                                         01300003
013000     05  PS-END-OF-REPORT-SW           PIC X(01)  VALUE 'N'.      01310003
013100         88  PS-END-OF-REPORT                     VALUE 'Y'.      01320003
013200     05  PS-END-OF-DATE-FILE-SW        PIC X(01)  VALUE 'N'.      01330003
013300         88  PS-END-OF-DATE-FILE                  VALUE 'Y'.      01340003
013400     05  PS-NEW-PAGE-SW                PIC X(01)  VALUE 'N'.      01350003
013500         88  PS-NEW-PAGE                          VALUE 'Y'.      01360003
013600         88  PS-NO-NEW-PAGE                       VALUE 'N'.      01370003
013700     05  PS-FIRST-TIME-SW              PIC X(01)  VALUE 'Y'.      01380003
013800         88  PS-FIRST-TIME                        VALUE 'Y'.      01390003
013900         88  PS-NOT-FIRST-TIME                    VALUE 'N'.      01400003
014000                                                                  01410003
014100 01  PC-CONSTANTS.                                                01420003
014200     05  PC-LINE-LIMIT               PIC S9(04)  VALUE +65.       01430003
014300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            01440003
014400                                                 'SSKRP049'.      01450003
014500     05  PC-REPORT-NBR-1             PIC  9(01)  VALUE 1.         01460003
014600     05  PC-LID-REASON-CODES.                                     01470003
014700        10  PC-701                   PIC  X(20)                   01480003
014800                               VALUE 'SIGNING ERROR       '.      01490003
014900        10  PC-702                   PIC  X(20)                   01500003
015000                               VALUE 'PLU ERROR           '.      01510003
015100        10  PC-703                   PIC  X(20)                   01520003
015200                               VALUE 'DAMAGED MERCHANDISE '.      01530003
015100        10  PC-705                   PIC  X(20)                   01540003
015200                               VALUE 'MISSED MARKDOWN     '.      01550003
015300        10  PC-706                   PIC  X(20)                   01560003
015400                               VALUE 'RAINCHECK           '.      01570003
015500        10  PC-707                   PIC  X(20)                   01580003
015600                               VALUE 'MEET COMPETITION    '.      01590003
015700        10  PC-709                   PIC  X(20)                   01600003
015800                               VALUE 'YES WE CAN          '.      01610003
015900     05  PC-TRAN-TYPE-CODES.                                      01620003
016000        10  PC-01                    PIC  X(3)  VALUE 'SAL'.      01630003
016100        10  PC-02                    PIC  X(3)  VALUE 'ACS'.      01640003
016200        10  PC-11                    PIC  X(3)  VALUE 'RET'.      01650003
016300        10  PC-12                    PIC  X(3)  VALUE 'ART'.      01660003
016400        10  PC-21                    PIC  X(3)  VALUE 'EVN'.      01670003
016500        10  PC-22                    PIC  X(3)  VALUE 'AMM'.      01680003
016600        10  PC-23                    PIC  X(3)  VALUE 'MIX'.      01690003
016700                                                                  01700003
016800 01  PV-LID-REASON-CODES.                                         01710003
016900     05  PV-701                      PIC X(03)     VALUE '701'.   01720003
017000     05  PV-702                      PIC X(03)     VALUE '702'.   01730003
017100     05  PV-703                      PIC X(03)     VALUE '703'.   01740003
017100     05  PV-705                      PIC X(03)     VALUE '705'.   01750003
017200     05  PV-706                      PIC X(03)     VALUE '706'.   01760003
017300     05  PV-707                      PIC X(03)     VALUE '707'.   01770003
017400     05  PV-709                      PIC X(03)     VALUE '709'.   01780003
017500                                                                  01790003
017600 01  PV-TRAN-TYPE-CODES.                                          01800003
017700     05  PV-01                      PIC X(03)     VALUE '01'.     01810003
017800     05  PV-02                      PIC X(03)     VALUE '02'.     01820003
017900     05  PV-11                      PIC X(03)     VALUE '11'.     01830003
018000     05  PV-12                      PIC X(03)     VALUE '12'.     01840003
018100     05  PV-21                      PIC X(03)     VALUE '21'.     01850003
018200     05  PV-22                      PIC X(03)     VALUE '22'.     01860003
018300     05  PV-23                      PIC X(03)     VALUE '23'.     01870003
018400                                                                  01880003
018500 01  PV-MISC-COUNT-FIELDS            COMP-3.                      01890003
018600     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZERO.    01900003
018700     05  PV-LINE-CNT                 PIC S9(03)    VALUE +65.     01910003
018800                                                                  01920003
018900 01  PV-SAVE-AREA.                                                01930003
019000     05  PV-SAVE-DISTRICT            PIC 9(04)    VALUE ZEROES.   01940003
019100     05  PV-SAVE-STORE               PIC 9(04)    VALUE ZEROES.   01950003
019200     05  PV-SAVE-SKU                 PIC X(08)    VALUE SPACES.   01960003
019300     05  PV-SAVE-UPC-NBR             PIC S9(15)V COMP-3           01970003
019400                                                  VALUE ZEROES.   01980003
019500     05  PV-SAVE-TERM                PIC 9(4)     VALUE ZEROES.   01990003
019600     05  PV-SAVE-TRAN-NBR            PIC 9(4)     VALUE ZEROES.   02000003
019700     05  PV-SAVE-ASSOCIATE           PIC X(20)    VALUE SPACES.   02010003
019800     05  PV-SAVE-TRN-TYPE-CODE       PIC X(2)     VALUE SPACES.   02020003
019900     05  PV-SAVE-DISCOUNT-PCT        PIC 9(3)     VALUE ZEROES.   02030003
020000     05  PV-SAVE-LID-REASON          PIC X(3)     VALUE SPACES.   02040003
020100     05  PV-SAVE-UPC-DESC            PIC X(30)    VALUE SPACES.   02050003
020200     05  PV-SAVE-TIME                PIC X(8)     VALUE SPACES.   02060003
020300     05  PV-SAVE-SCANNED-PRICE       PIC S9(7)V9(2)               02070003
020400                                           COMP-3 VALUE ZEROES.   02080003
020500     05  PV-SAVE-DISCOUNT-AMT        PIC S9(7)V9(2)               02090003
020600                                           COMP-3 VALUE ZEROES.   02100003
020700     05  PV-SAVE-DEPT-SUBC.                                       02110003
020800         10 PV-SAVE-DEPT            PIC X(3).                     02120003
020900         10 PV-SAVE-SUBC            PIC X(2).                     02130003
021000                                                                  02140003
021100 01  PV-MISC-FIELDS.                                              02150003
021200     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   02160003
021300     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02170003
021400                                                   COMP SYNC.     02180003
021500     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   02190003
021600     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   02200003
021700     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   02210003
021800     05  PV-LID-COUNT                PIC S9(7)     VALUE ZERO     02220003
021900                                                   COMP-3.        02230003
022000     05  PV-UNITS-COUNT              PIC S9(7)     VALUE ZERO     02240003
022100                                                   COMP-3.        02250003
022200 01  PV-DATE-AND-TIME-FIELDS.                                     02260003
022300     05  PV-CURR-DATE-CCYYMMDD.                                   02270003
022400         10  PV-CURR-DATE-CCYY       PIC  9(04).                  02280003
022500         10  PV-CURR-DATE-MM         PIC  9(02).                  02290003
022600         10  PV-CURR-DATE-DD         PIC  9(02).                  02300003
022700     05  PV-CURR-TIME.                                            02310003
022800         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    02320003
022900         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    02330003
023000         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    02340003
023100     05  PV-HEADER-DATE.                                          02350003
023200         10  PV-HEADER-MM            PIC XX.                      02360003
023300         10  PV-HEADER-SLASH-1       PIC X.                       02370003
023400         10  PV-HEADER-DD            PIC XX.                      02380003
023500         10  PV-HEADER-SLASH-2       PIC X.                       02390003
023600         10  PV-HEADER-CCYY          PIC X(04).                   02400003
023700                                                                  02410003
023800 EJECT                                                            02420003
023900******************************************************************02430003
024000*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  02440003
024100******************************************************************02450003
024200     COPY DPWS200.                                                02460003
024300                                                                  02470003
024400******************************************************************02480003
024500*  HEADING LINES FOR THE LID REPORT.                              02490003
024600******************************************************************02500003
024700                                                                  02510003
024800 01  HL2-HEADING-LINE-2.                                          02520003
024900     05  FILLER                  PIC X(74)   VALUE SPACE.         02530003
025000     05  FILLER                  PIC X(41)   VALUE                02540003
025100         'LID DISCOUNT TRANSACTION TOTAL COUNT FOR '.             02550003
025200     05  HL2-DATE                PIC X(10)   VALUE SPACES.        02560003
025300     05  FILLER                  PIC X(75)   VALUE SPACES.        02570003
025400                                                                  02580003
025500 01  HL3-HEADING-LINE-3.                                          02590003
025600     05  FILLER                  PIC X(74)   VALUE SPACE.         02600003
025700     05  FILLER                  PIC X(32)   VALUE                02610003
025800         'FOR RETAIL AMOUNTS GREATER THAN '.                      02620003
025900     05  HL3-MAXIMUM-RETAIL-AMOUNT PIC ZZZ.99 VALUE ZERO.         02630003
026000     05  FILLER                  PIC X(75)   VALUE SPACES.        02640003
026100                                                                  02650003
026200 01  HL4-HEADING-LINE-4.                                          02660003
026300     05  FILLER                  PIC X(10)   VALUE SPACE.         02670003
026400     05  FILLER                  PIC X(10)   VALUE                02680003
026500         'DISTRICT: '.                                            02690003
026600     05  HL4-DISTRICT            PIC X(04)   VALUE SPACES.        02700003
026700     05  FILLER                  PIC X(176)   VALUE SPACES.       02710003
026800                                                                  02720003
026900 01  HL5-HEADING-LINE-5.                                          02730003
027000     05  FILLER                  PIC X(10)   VALUE SPACE.         02740003
027100     05  FILLER                  PIC X(10)   VALUE                02750003
027200         'STORE:    '.                                            02760003
027300     05  HL5-STORE               PIC X(04)   VALUE SPACES.        02770003
027400     05  FILLER                  PIC X(178)   VALUE SPACES.       02780003
027500                                                                  02790003
027600                                                                  02800003
027700 01  HL6-HEADING-LINE-6.                                          02810003
027800     05  FILLER                  PIC X(5)    VALUE SPACE.         02820003
027900     05  FILLER                  PIC X(4)    VALUE 'DEPT'.        02830003
028000     05  FILLER                  PIC X(5)    VALUE SPACE.         02840003
028100     05  FILLER                  PIC X(4)    VALUE 'SUBC'.        02850003
028200     05  FILLER                  PIC X(5)    VALUE SPACE.         02860003
028300     05  FILLER                  PIC X(3)    VALUE 'UPC'.         02870003
028400     05  FILLER                  PIC X(15)   VALUE SPACE.         02880003
028500     05  FILLER                  PIC X(3)    VALUE 'UPC'.         02890003
028600     05  FILLER                  PIC X(30)   VALUE SPACE.         02900003
028700     05  FILLER                  PIC X(4)    VALUE 'TERM'.        02910003
028800     05  FILLER                  PIC X(3)    VALUE SPACES.        02920003
028900     05  FILLER                  PIC X(5)    VALUE 'TRANS'.       02930003
029000     05  FILLER                  PIC X(11)   VALUE SPACES.        02940003
029100     05  FILLER                  PIC X(9)    VALUE 'ASSOCIATE'.   02950003
029200     05  FILLER                  PIC X(16)   VALUE SPACES.        02960003
029300     05  FILLER                  PIC X(7)   VALUE SPACES.         02970003
029400     05  FILLER                  PIC X(4)    VALUE 'TRAN'.        02980003
029500     05  FILLER                  PIC X(8)    VALUE SPACES.        02990003
029600     05  FILLER                  PIC X(7)    VALUE 'SCANNED'.     03000003
029700     05  FILLER                  PIC X(6)    VALUE SPACE.         03010003
029800     05  FILLER                  PIC X       VALUE '%'.           03020003
029900     05  FILLER                  PIC X(10)   VALUE SPACES.        03030003
030000     05  FILLER                  PIC X       VALUE '$'.           03040003
030100     05  FILLER                  PIC X(8)    VALUE SPACES.        03050003
030200     05  FILLER                  PIC X(3)    VALUE 'LID'.         03060003
030300                                                                  03070003
030400 01  HL7-HEADING-LINE-7.                                          03080003
030500     05  FILLER                  PIC X(5)    VALUE SPACE.         03090003
030600     05  FILLER                  PIC X(6)    VALUE 'NUMBER'.      03100003
030700     05  FILLER                  PIC X(3)    VALUE SPACE.         03110003
030800     05  FILLER                  PIC X(6)    VALUE 'NUMBER'.      03120003
030900     05  FILLER                  PIC X(3)    VALUE SPACE.         03130003
031000     05  FILLER                  PIC X(6)    VALUE 'NUMBER'.      03140003
031100     05  FILLER                  PIC X(12)   VALUE SPACE.         03150003
031200     05  FILLER                  PIC X(11)   VALUE 'DESCRIPTION'. 03160003
031300     05  FILLER                  PIC X(21)   VALUE SPACES.        03170003
031400     05  FILLER                  PIC X(5)    VALUE '  #  '.       03180003
031500     05  FILLER                  PIC X(2)    VALUE SPACES.        03190003
031600     05  FILLER                  PIC X(5)    VALUE '  #  '.       03200003
031700     05  FILLER                  PIC X(4)    VALUE SPACES.        03210003
031800     05  FILLER                  PIC X(5)    VALUE 'TIME '.       03220003
031900     05  FILLER                  PIC X(3)    VALUE SPACES.        03230003
032000     05  FILLER                  PIC X(4)    VALUE 'NAME'.        03240003
032100     05  FILLER                  PIC X(19)   VALUE SPACES.        03250003
032200     05  FILLER                  PIC X(5)    VALUE 'UNITS'.       03260003
032300     05  FILLER                  PIC X(4)    VALUE SPACES.        03270003
032400     05  FILLER                  PIC X(4)    VALUE 'TYPE'.        03280003
032500     05  FILLER                  PIC X(10)   VALUE SPACES.        03290003
032600     05  FILLER                  PIC X(5)    VALUE 'PRICE'.       03300003
032700     05  FILLER                  PIC X(3)    VALUE SPACE.         03310003
032800     05  FILLER                  PIC X(8)    VALUE 'DISCOUNT'.    03320003
032900     05  FILLER                  PIC X(3)    VALUE SPACES.        03330003
033000     05  FILLER                  PIC X(8)    VALUE 'DISCOUNT'.    03340003
033100     05  FILLER                  PIC X(4)    VALUE SPACES.        03350003
033200     05  FILLER                  PIC X(6)    VALUE 'REASON'.      03360003
033300                                                                  03370003
033400******************************************************************03380003
033500*  DETAIL LINE FOR THE LINE ITEM DISCOUNT REPORT.                 03390003
033600******************************************************************03400003
033700                                                                  03410003
033800 01  D1-DETAIL-LINE-1.                                            03420003
033900     05  FILLER                  PIC X(5)    VALUE SPACES.        03430003
034000     05  DTL1-DEPT               PIC X(3).                        03440003
034100     05  FILLER                  PIC X(6)    VALUE SPACES.        03450003
034200     05  DTL1-SUBC               PIC X(2).                        03460003
034300     05  FILLER                  PIC X(7)    VALUE SPACES.        03470003
034400     05  DTL1-UPC-NBR            PIC 9(15).                       03480003
034500     05  FILLER                  PIC X(3)    VALUE SPACES.        03490003
034600     05  DTL1-UPC-DESCRIPTION    PIC X(30).                       03500003
034700     05  FILLER                  PIC X(3)    VALUE SPACES.        03510003
034800     05  DTL1-TERM               PIC 9(4).                        03520003
034900     05  FILLER                  PIC X(3)    VALUE SPACES.        03530003
035000     05  DTL1-TRANS              PIC 9(4).                        03540003
035100     05  FILLER                  PIC X(4)    VALUE SPACES.        03550003
035200     05  DTL1-TIME               PIC X(5).                        03560003
035300     05  FILLER                  PIC X(3)    VALUE SPACES.        03570003
035400     05  DTL1-OPER-ID            PIC X(20).                       03580003
035500     05  FILLER                  PIC X(3)    VALUE SPACES.        03590003
035600     05  DTL1-UNITS              PIC Z,ZZZ.                       03600003
035700     05  FILLER                  PIC X(4)    VALUE SPACES.        03610003
035800     05  DTL1-TRN-TYPE-CODE      PIC X(3) .                       03620003
035900     05  FILLER                  PIC X(3)    VALUE SPACES.        03630003
036000     05  DTL1-SCANNED-PRICE      PIC Z,ZZZ,ZZZ.99-.               03640003
036100     05  FILLER                  PIC X(4)    VALUE SPACES.        03650003
036200     05  DTL1-DISCOUNT-PCT       PIC ZZZ-.                        03660003
036300     05  FILLER                  PIC X(6)    VALUE SPACES.        03670003
036400     05  DTL1-DISCOUNT-AMT       PIC Z,ZZZ.ZZ-.                   03680003
036500     05  FILLER                  PIC X(3)    VALUE SPACES.        03690003
036600     05  DTL1-LID-REASON         PIC X(20).                       03700003
036700     05  FILLER                  PIC X(1)    VALUE SPACES.        03710003
036800*    05  DTL1-NET-AMT            PIC Z,ZZZ,ZZZ.99-.               03720003
036900 EJECT                                                            03730003
037000******************************************************************03740003
037100*  FOOTING LINES FOR THE LID REPORT.                              03750003
037200******************************************************************03760003
037300                                                                  03770003
037400 01  FT1-FOOTING-LINE-1.                                          03780003
037500     05  FILLER                  PIC X(10)   VALUE SPACES.        03790003
037600     05  FILLER                  PIC X(20)   VALUE                03800003
037700         ' TRANSACTION TYPE : '.                                  03810003
037800     05  FILLER                  PIC X(29)   VALUE SPACES.        03820003
037900     05  FILLER                  PIC X(13)   VALUE                03830003
038000         'LID REASONS :'.                                         03840003
038100     05  FILLER                  PIC X(128)  VALUE SPACES.        03850003
038200                                                                  03860003
038300 01  FT2-FOOTING-LINE-2.                                          03870003
038400     05  FILLER                  PIC X(11)   VALUE SPACES.        03880003
038500     05  FILLER                  PIC X(11)   VALUE                03890003
038600         ' SAL - SALE'.                                           03900003
038700     05  FILLER                  PIC X(37)   VALUE SPACES.        03910003
038800     05  FILLER                  PIC X(14)   VALUE                03920003
038900         ' SIGNING ERROR'.                                        03930003
039000     05  FILLER                  PIC X(127)  VALUE SPACES.        03940003
039100                                                                  03950003
039200 01  FT3-FOOTING-LINE-3.                                          03960003
039300     05  FILLER                  PIC X(11)   VALUE SPACES.        03970003
039400     05  FILLER                  PIC X(25)   VALUE                03980003
039500         ' ACS - EMPLOYEE CASH SALE'.                             03990003
039600     05  FILLER                  PIC X(23)   VALUE SPACES.        04000003
039700     05  FILLER                  PIC X(10)   VALUE                04010003
039800         ' PLU ERROR'.                                            04020003
039900     05  FILLER                  PIC X(131)  VALUE SPACES.        04030003
040000                                                                  04040003
040100 01  FT4-FOOTING-LINE-4.                                          04050003
040200     05  FILLER                  PIC X(59)   VALUE SPACES.        04060003
040600     05  FILLER                  PIC X(20)   VALUE                04070003
040700         ' DAMAGED MERCHANDISE'.                                  04080003
040800     05  FILLER                  PIC X(121)  VALUE SPACES.        04090003
040900                                                                  04100003
042800 01  FT5-FOOTING-LINE-5.                                          04110003
042900     05  FILLER                  PIC X(59)   VALUE SPACES.        04120003
043300     05  FILLER                  PIC X(16)   VALUE                04130003
043400         ' MISSED MARKDOWN'.                                      04140003
043500     05  FILLER                  PIC X(125)  VALUE SPACES.        04150003
                                                                        04160003
041000 01  FT6-FOOTING-LINE-6.                                          04170003
041100     05  FILLER                  PIC X(59)   VALUE SPACES.        04180003
041500     05  FILLER                  PIC X(10)   VALUE                04190003
041600         ' RAINCHECK'.                                            04200003
041700     05  FILLER                  PIC X(131)  VALUE SPACES.        04210003
041800                                                                  04220003
041900 01  FT7-FOOTING-LINE-7.                                          04230003
042000     05  FILLER                  PIC X(59)   VALUE SPACES.        04240003
042400     05  FILLER                  PIC X(17)   VALUE                04250003
042500         ' MEET COMPETITION'.                                     04260003
042600     05  FILLER                  PIC X(124)  VALUE SPACES.        04270003
042700                                                                  04280003
042800 01  FT8-FOOTING-LINE-8.                                          04290003
042900     05  FILLER                  PIC X(59)   VALUE SPACES.        04300003
043300     05  FILLER                  PIC X(11)   VALUE                04310003
043400         ' YES WE CAN'.                                           04320003
043500     05  FILLER                  PIC X(130)  VALUE SPACES.        04330003
043600                                                                  04340003
043600                                                                  04350003
044300******************************************************************04360003
044400 EJECT                                                            04370003
044500***************************************************************** 04380003
044600* PROCEDURE DIVISION.                                           * 04390003
044700***************************************************************** 04400003
044800 PROCEDURE DIVISION.                                              04410003
044900 EJECT                                                            04420003
045000******************************************************************04430003
045100* 0000-MAINLINE-PARAGRAPH                                         04440003
045200*      PRODUCE LINE ITEM DISCOUNT REPORT                          04450003
045300******************************************************************04460003
045400 0000-MAINLINE-PARAGRAPH.                                         04470003
045500                                                                  04480003
045600     PERFORM 1000-INITIALIZE-PROGRAM.                             04490003
045700                                                                  04500003
045800     PERFORM 2000-PROCESS-LID-REPORT                              04510003
045900       UNTIL PS-END-OF-REPORT.                                    04520003
046000                                                                  04530003
011168     IF PV-LID-COUNT > 0                                          04530108
011168        PERFORM 2200-SETTUP-REPORT-FIELDS                         04530216
011168        PERFORM 9100-FOOTER-ROUTINE                               04532013
011168     END-IF.                                                      04533008
011168                                                                  04534008
046100     CLOSE LINE-ITEM-DISC-FILE                                    04540003
046200           LINE-ITEM-DISC-REPORT.                                 04550003
046300                                                                  04560003
046400     DISPLAY 'LIDS PROCESSED COUNT: ' PV-LID-COUNT.               04570003
046500                                                                  04580003
046600     GOBACK.                                                      04590003
046700                                                                  04600003
046800 EJECT                                                            04610003
046900******************************************************************04620003
047000* 1000-INITIALIZE-PROGRAM                                         04630003
047100*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS    04640003
047200******************************************************************04650003
047300                                                                  04660003
047400 1000-INITIALIZE-PROGRAM.                                         04670003
047500                                                                  04680003
047600     OPEN INPUT  POS-DATE-CARD-FILE                               04690003
047700                 LINE-ITEM-DISC-FILE                              04700003
047800          OUTPUT LINE-ITEM-DISC-REPORT.                           04710003
047900                                                                  04720003
048000     MOVE +0 TO PV-LID-COUNT                                      04730003
048100                PV-UNITS-COUNT.                                   04740003
048200                                                                  04750003
048300     PERFORM 1100-PROCESS-DATE-CARD.                              04760003
011168     PERFORM 2100-READ-LID-FILE.                                  04761012
048400                                                                  04770003
011168     IF  PS-END-OF-REPORT                                         04771008
011168         DISPLAY '**EMPTY INPUT DATASET-NO RECORDS TO PROCESS**'  04772008
011168     ELSE                                                         04773008
011168         PERFORM 1200-FORMAT-HEADINGS                             04780008
011168     END-IF.                                                      04790008
011168                                                                  04791008
048700*    PERFORM 9000-HEADER-ROUTINE.                                 04800003
048800 EJECT                                                            04810003
048900******************************************************************04820003
049000* 1100-PROCESS-DATE-CARD                                          04830003
049100******************************************************************04840003
049200                                                                  04850003
049300 1100-PROCESS-DATE-CARD.                                          04860003
049400                                                                  04870003
049500     READ POS-DATE-CARD-FILE INTO CC-DATE-CARD                    04880003
049600         AT END                                                   04890003
049700             SET PS-END-OF-DATE-FILE TO TRUE.                     04900003
049800                                                                  04910003
049900     IF PS-END-OF-DATE-FILE                                       04920003
050000         MOVE '1100-PROCESS-DATE-CARD'  TO PV-PARAGRAPH-NAME      04930003
050100         MOVE 'DATE CARD MISSING      ' TO PV-OPERATION-MSG-1     04940003
050200         SET AC-CONTROL-CARD-ERROR TO TRUE                        04950003
050300         PERFORM 9999-ABEND                                       04960003
050400     END-IF.                                                      04970003
050500                                                                  04980003
050600     DISPLAY 'PROCESSING DATE ' CC-DATE.                          04990003
050700                                                                  05000003
050800     CLOSE POS-DATE-CARD-FILE.                                    05010003
050900                                                                  05020003
051000 EJECT                                                            05030003
051100******************************************************************05040003
051200* 1200-FORMAT-HEADINGS                                            05050003
051300*     GET CURRENT DATE AND TIME FROM SYSTEM.                      05060003
051400*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          05070003
051500*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              05080003
051600******************************************************************05090003
051700 1200-FORMAT-HEADINGS.                                            05100003
051800                                                                  05110003
051900     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   05120003
052000     ACCEPT PV-CURR-TIME FROM TIME.                               05130003
052100                                                                  05140003
052200     MOVE PV-CURR-DATE-MM             TO DP200-RUN-MONTH.         05150003
052300     MOVE PV-CURR-DATE-DD             TO DP200-RUN-DAY.           05160003
052400     MOVE PV-CURR-DATE-CCYY           TO DP200-RUN-YEAR.          05170003
052500                                                                  05180003
052600     MOVE PV-CURR-TIME-HH             TO DP200-RUN-HOUR.          05190003
052700     MOVE PV-CURR-TIME-MM             TO DP200-RUN-MINUTE.        05200003
052800     MOVE PC-CURRENT-PROGRAM-NAME     TO DP200-PROGRAM-NAME.      05210003
052900     MOVE PC-REPORT-NBR-1             TO DP200-REPORT-NUMBER.     05220003
053000                                                                  05230003
053100     MOVE CC-MONTH                    TO PV-HEADER-MM.            05240003
053200     MOVE '/'                         TO PV-HEADER-SLASH-1.       05250003
053300     MOVE CC-DAY                      TO PV-HEADER-DD.            05260003
053400     MOVE '/'                         TO PV-HEADER-SLASH-2.       05270003
053500     MOVE CC-YEAR                     TO PV-HEADER-CCYY.          05280003
053600     MOVE PV-HEADER-DATE              TO HL2-DATE.                05290003
053700                                                                  05300003
053800     MOVE +1 TO PV-LINE-CNT.                                      05310003
053900                                                                  05320003
054000     SET PS-FIRST-TIME TO TRUE.                                   05330003
054100                                                                  05340003
054200******************************************************************05350003
054300* 2000-PROCESS-LID-REPORT.                                        05360003
054400******************************************************************05370003
054500 2000-PROCESS-LID-REPORT.                                         05380003
054600                                                                  05390003
054900     IF PS-END-OF-REPORT-SW = 'N'                                 05420003
055000        PERFORM 2200-SETTUP-REPORT-FIELDS                         05430003
055400     END-IF.                                                      05432006
011168                                                                  05432108
011168        PERFORM 2100-READ-LID-FILE.                               05433015
055500                                                                  05480003
055600******************************************************************05490012
055700* 2100-READ-LID-FILE                                              05500003
055800******************************************************************05510003
055900                                                                  05520003
056000 2100-READ-LID-FILE.                                              05530003
056100                                                                  05540003
W30384     READ LINE-ITEM-DISC-FILE INTO SS007-LINE-DETAIL              05550004
056300         AT END                                                   05560003
056400             SET PS-END-OF-REPORT TO TRUE.                        05570003
056500 EJECT                                                            05580003
056600******************************************************************05590003
056700* 2200-SETTUP-REPORT-FIELDS                                       05600003
056800******************************************************************05610003
056900                                                                  05620003
057000 2200-SETTUP-REPORT-FIELDS.                                       05630003
057100                                                                  05640003
057200*                                                                 05650003
057300*  CHECK FOR LINE COUNT EXCEEDED TO WRITE TO NEW PAGE             05660003
057400*                                                                 05670003
057500      SET PS-NO-NEW-PAGE TO TRUE.                                 05680003
057600      IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT                   05690003
057700           PERFORM 9100-FOOTER-ROUTINE                            05700003
057800           PERFORM 9000-HEADER-ROUTINE                            05710003
057900           SET PS-NEW-PAGE TO TRUE                                05720003
058000      END-IF.                                                     05730003
058100                                                                  05740003
058200                                                                  05750003
058300*                                                                 05760003
058400*  CHECK FOR FIRST TIME RUN TO POPULATE SAVE VARIABLES.           05770003
058500*                                                                 05780003
058600      IF PS-FIRST-TIME-SW = 'Y'                                   05790003
W30384          MOVE SS007-DISTRICT TO PV-SAVE-DISTRICT                 05800004
W30384          MOVE SS007-STORE TO PV-SAVE-STORE                       05810004
W30384          MOVE SS007-SKU TO PV-SAVE-SKU                           05820004
W30384          MOVE SS007-UPC-NBR TO PV-SAVE-UPC-NBR                   05830004
W30384          MOVE SS007-DEPT TO PV-SAVE-DEPT                         05840004
W30384          MOVE SS007-SUBC TO PV-SAVE-SUBC                         05850004
W30384          MOVE SS007-TERM TO PV-SAVE-TERM                         05860004
W30384          MOVE SS007-TRAN-NBR TO PV-SAVE-TRAN-NBR                 05870004
W30384          MOVE SS007-ASSOCIATE TO PV-SAVE-ASSOCIATE               05880004
W30384          MOVE SS007-TRN-TYPE-CODE TO PV-SAVE-TRN-TYPE-CODE       05890004
W30384          MOVE SS007-DISCOUNT-PCT TO PV-SAVE-DISCOUNT-PCT         05900004
W30384          MOVE SS007-LID-REASON TO PV-SAVE-LID-REASON             05910004
W30384          MOVE SS007-UPC-DESC TO PV-SAVE-UPC-DESC                 05920004
W30384          MOVE SS007-TIME TO PV-SAVE-TIME                         05930004
W30384          MOVE SS007-SCANNED-PRICE TO PV-SAVE-SCANNED-PRICE       05940004
W30384          MOVE SS007-DISCOUNT-AMT TO PV-SAVE-DISCOUNT-AMT         05950004
W30384          MOVE SS007-DISTRICT TO HL4-DISTRICT                     05960004
W30384          MOVE SS007-STORE TO HL5-STORE                           05970004
060500          PERFORM 9000-HEADER-ROUTINE                             05980003
060600          SET PS-NEW-PAGE TO TRUE                                 05990003
060700      END-IF.                                                     06000003
060800*                                                                 06010003
060900*  CHECK FOR SAME LID IN SAME TRANSACTION TO POPULATE UNITS COL.  06020003
061000*                                                                 06030003
W30384      IF PV-SAVE-DISTRICT = SS007-DISTRICT AND                    06040004
W30384         PV-SAVE-STORE = SS007-STORE AND                          06050004
W30384         PV-SAVE-UPC-NBR = SS007-UPC-NBR AND                      06060004
W30384         PV-SAVE-DEPT = SS007-DEPT AND                            06070004
W30384         PV-SAVE-SUBC = SS007-SUBC AND                            06080004
W30384         PV-SAVE-TERM = SS007-TERM AND                            06090004
W30384         PV-SAVE-TRAN-NBR = SS007-TRAN-NBR AND                    06100004
W30384         PV-SAVE-ASSOCIATE = SS007-ASSOCIATE AND                  06110004
W30384         PV-SAVE-TRN-TYPE-CODE = SS007-TRN-TYPE-CODE AND          06120004
W30384         PV-SAVE-DISCOUNT-PCT = SS007-DISCOUNT-PCT AND            06130004
W30384         PV-SAVE-LID-REASON = SS007-LID-REASON AND                06140004
W30384         PV-SAVE-UPC-DESC = SS007-UPC-DESC AND                    06150004
W30384         PV-SAVE-TIME = SS007-TIME AND                            06160004
W30384         PV-SAVE-SCANNED-PRICE = SS007-SCANNED-PRICE AND          06170004
W30384         PV-SAVE-DISCOUNT-AMT = SS007-DISCOUNT-AMT AND            06180004
062600         PS-END-OF-REPORT-SW = 'N'                                06190003
062700          ADD +1 TO PV-UNITS-COUNT                                06200003
062800      ELSE                                                        06210003
062900*                                                                 06220003
063000*   WRITE DETAIL LINE ON REPORT                                   06230003
063100*                                                                 06240003
063200          MOVE PV-SAVE-UPC-NBR TO DTL1-UPC-NBR                    06250003
063300          MOVE PV-SAVE-DEPT TO DTL1-DEPT                          06260003
063400          MOVE PV-SAVE-SUBC TO DTL1-SUBC                          06270003
063500          MOVE PV-SAVE-UPC-DESC TO DTL1-UPC-DESCRIPTION           06280003
063600          MOVE PV-SAVE-TERM TO DTL1-TERM                          06290003
063700          MOVE PV-SAVE-TRAN-NBR TO DTL1-TRANS                     06300003
063800          MOVE PV-SAVE-TIME TO DTL1-TIME                          06310003
063900          MOVE PV-SAVE-ASSOCIATE TO DTL1-OPER-ID                  06320003
064000          MOVE PV-UNITS-COUNT TO DTL1-UNITS                       06330003
064100          PERFORM 2300-TRAN-TYPE-DESC                             06340003
064200          MOVE PV-SAVE-SCANNED-PRICE TO DTL1-SCANNED-PRICE        06350003
064300          MOVE PV-SAVE-DISCOUNT-PCT TO DTL1-DISCOUNT-PCT          06360003
064400          MOVE PV-SAVE-DISCOUNT-AMT TO DTL1-DISCOUNT-AMT          06370003
064500          PERFORM 2400-LID-REASON-DESC                            06380003
064600          MOVE D1-DETAIL-LINE-1         TO PV-PRINT-RECORD        06390003
064700          MOVE +1                       TO PV-LINE-SPACING        06400003
064800          PERFORM 9900-WRITE-REPORT-LINE                          06410003
064900*                                                                 06420003
065000*   WRITE BLANK LINE ON REPORT                                    06430003
065100*                                                                 06440003
W30384          IF PV-SAVE-UPC-NBR NOT = SS007-UPC-NBR AND              06450004
065300             PS-FIRST-TIME-SW = 'N'                               06460003
065400               MOVE SPACES TO PV-PRINT-RECORD                     06470003
065500               MOVE +1 TO PV-LINE-SPACING                         06480003
065600               PERFORM 9900-WRITE-REPORT-LINE                     06490003
065700          END-IF                                                  06500003
065800*                                                                 06510003
065900*  CHECK FOR NEW DISTRICT OR STORE TO WRITE TO NEW PAGE           06520003
066000*                                                                 06530003
W30384          IF SS007-DISTRICT NOT = PV-SAVE-DISTRICT OR             06540004
W30384             SS007-STORE NOT = PV-SAVE-STORE                      06550004
W30384               IF SS007-STORE NOT = PV-SAVE-STORE                 06560004
066400                  MOVE +0 TO PV-PAGE-CNT                          06570003
066500               END-IF                                             06580003
066600               IF PS-FIRST-TIME-SW = 'N'                          06590003
066700                  PERFORM 9100-FOOTER-ROUTINE                     06600003
066800               END-IF                                             06610003
W30384               MOVE SS007-DISTRICT TO HL4-DISTRICT                06620004
W30384               MOVE SS007-STORE TO HL5-STORE                      06630004
067100               PERFORM 9000-HEADER-ROUTINE                        06640003
067200               SET PS-NEW-PAGE TO TRUE                            06650003
067300          END-IF                                                  06660003
067400                                                                  06670003
W30384          MOVE SS007-DISTRICT TO PV-SAVE-DISTRICT                 06680004
W30384          MOVE SS007-STORE TO PV-SAVE-STORE                       06690004
W30384          MOVE SS007-SKU TO PV-SAVE-SKU                           06700004
W30384          MOVE SS007-UPC-NBR TO PV-SAVE-UPC-NBR                   06710004
W30384          MOVE SS007-DEPT TO PV-SAVE-DEPT                         06720004
W30384          MOVE SS007-SUBC TO PV-SAVE-SUBC                         06730004
W30384          MOVE SS007-TERM TO PV-SAVE-TERM                         06740004
W30384          MOVE SS007-TRAN-NBR TO PV-SAVE-TRAN-NBR                 06750004
W30384          MOVE SS007-ASSOCIATE TO PV-SAVE-ASSOCIATE               06760004
W30384          MOVE SS007-TRN-TYPE-CODE TO PV-SAVE-TRN-TYPE-CODE       06770004
W30384          MOVE SS007-DISCOUNT-PCT TO PV-SAVE-DISCOUNT-PCT         06780004
W30384          MOVE SS007-LID-REASON TO PV-SAVE-LID-REASON             06790004
W30384          MOVE SS007-UPC-DESC TO PV-SAVE-UPC-DESC                 06800004
W30384          MOVE SS007-TIME TO PV-SAVE-TIME                         06810004
W30384          MOVE SS007-SCANNED-PRICE TO PV-SAVE-SCANNED-PRICE       06820004
W30384          MOVE SS007-DISCOUNT-AMT TO PV-SAVE-DISCOUNT-AMT         06830004
069100                                                                  06840003
069200          ADD +1 TO PV-LID-COUNT                                  06850003
069300          MOVE +1 TO PV-UNITS-COUNT                               06860003
069400      END-IF.                                                     06870003
069500                                                                  06880003
069600      SET PS-NOT-FIRST-TIME TO TRUE.                              06890003
069700                                                                  06900003
069800 EJECT                                                            06910003
069900******************************************************************06920003
070000* 2300-TRAN-TYPE-DESC                                             06930003
070100******************************************************************06940003
070200                                                                  06950003
070300 2300-TRAN-TYPE-DESC.                                             06960003
070400                                                                  06970003
070500      EVALUATE PV-SAVE-TRN-TYPE-CODE                              06980003
070600       WHEN PV-01                                                 06990003
070700         MOVE PC-01 TO DTL1-TRN-TYPE-CODE                         07000003
070800       WHEN PV-02                                                 07010003
070900         MOVE PC-02 TO DTL1-TRN-TYPE-CODE                         07020003
071000       WHEN PV-11                                                 07030003
071100         MOVE PC-11 TO DTL1-TRN-TYPE-CODE                         07040003
071200       WHEN PV-12                                                 07050003
071300         MOVE PC-12 TO DTL1-TRN-TYPE-CODE                         07060003
071400       WHEN PV-21                                                 07070003
071500         MOVE PC-21 TO DTL1-TRN-TYPE-CODE                         07080003
071600       WHEN PV-22                                                 07090003
071700         MOVE PC-22 TO DTL1-TRN-TYPE-CODE                         07100003
071800       WHEN PV-23                                                 07110003
071900         MOVE PC-23 TO DTL1-TRN-TYPE-CODE                         07120003
072000      END-EVALUATE.                                               07130003
072100                                                                  07140003
072200 EJECT                                                            07150003
072300******************************************************************07160003
072400* 2400-LID-REASON-DESC                                            07170003
072500******************************************************************07180003
072600                                                                  07190003
072700 2400-LID-REASON-DESC.                                            07200003
072800                                                                  07210003
072900      EVALUATE PV-SAVE-LID-REASON                                 07220003
073000       WHEN PV-701                                                07230003
073100         MOVE PC-701 TO DTL1-LID-REASON                           07240003
073200       WHEN PV-702                                                07250003
073300         MOVE PC-702 TO DTL1-LID-REASON                           07260003
073400       WHEN PV-703                                                07270003
073500         MOVE PC-703 TO DTL1-LID-REASON                           07280003
073400       WHEN PV-705                                                07290003
073500         MOVE PC-705 TO DTL1-LID-REASON                           07300003
073600       WHEN PV-706                                                07310003
073700         MOVE PC-706 TO DTL1-LID-REASON                           07320003
073800       WHEN PV-707                                                07330003
073900         MOVE PC-707 TO DTL1-LID-REASON                           07340003
074000       WHEN PV-709                                                07350003
074100         MOVE PC-709 TO DTL1-LID-REASON                           07360003
074200      END-EVALUATE.                                               07370003
074300                                                                  07380003
074400 EJECT                                                            07390003
074500******************************************************************07400003
074600* 9000-HEADER-ROUTINE                                             07410003
074700*     PRINT THE HEADINGS FOR THE REPORT.                          07420003
074800******************************************************************07430003
074900                                                                  07440003
075000 9000-HEADER-ROUTINE.                                             07450003
075100                                                                  07460003
075200     ADD +1                      TO PV-PAGE-CNT.                  07470003
075300     MOVE PV-PAGE-CNT TO DP200-PAGE-NUMBER.                       07480003
075400     MOVE DP200-STANDRD-HEADER-200-COLS                           07490003
075500                                 TO PV-PRINT-RECORD.              07500003
075600     PERFORM 9800-WRITE-RPT-TOP-OF-PAGE.                          07510003
075700                                                                  07520003
075800     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              07530003
075900     MOVE +2                     TO PV-LINE-SPACING.              07540003
076000     PERFORM 9900-WRITE-REPORT-LINE.                              07550003
076100                                                                  07560003
076200*    MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              07570003
076300*    MOVE +2                     TO PV-LINE-SPACING.              07580003
076400*    PERFORM 9900-WRITE-REPORT-LINE.                              07590003
076500                                                                  07600003
076600     MOVE HL4-HEADING-LINE-4     TO PV-PRINT-RECORD.              07610003
076700     MOVE +1                     TO PV-LINE-SPACING.              07620003
076800     PERFORM 9900-WRITE-REPORT-LINE.                              07630003
076900                                                                  07640003
077000     MOVE HL5-HEADING-LINE-5     TO PV-PRINT-RECORD.              07650003
077100     MOVE +1                     TO PV-LINE-SPACING.              07660003
077200     PERFORM 9900-WRITE-REPORT-LINE.                              07670003
077300                                                                  07680003
077400     MOVE SPACES                 TO PV-PRINT-RECORD.              07690003
077500     MOVE +1                     TO PV-LINE-SPACING.              07700003
077600     PERFORM 9900-WRITE-REPORT-LINE.                              07710003
077700                                                                  07720003
077800     MOVE HL6-HEADING-LINE-6     TO PV-PRINT-RECORD.              07730003
077900     MOVE +1                     TO PV-LINE-SPACING.              07740003
078000     PERFORM 9900-WRITE-REPORT-LINE.                              07750003
078100                                                                  07760003
078200     MOVE HL7-HEADING-LINE-7     TO PV-PRINT-RECORD.              07770003
078300     MOVE +1                     TO PV-LINE-SPACING.              07780003
078400     PERFORM 9900-WRITE-REPORT-LINE.                              07790003
078500                                                                  07800003
078600     MOVE SPACES                 TO PV-PRINT-RECORD.              07810003
078700     MOVE +1                     TO PV-LINE-SPACING.              07820003
078800     PERFORM 9900-WRITE-REPORT-LINE.                              07830003
078900                                                                  07840003
079000 EJECT                                                            07850003
079100******************************************************************07860003
079200* 9100-FOOTER-ROUTINE                                             07870003
079300*     PRINT THE FOOTING FOR THE REPORT.                           07880003
079400******************************************************************07890003
079500                                                                  07900003
079600 9100-FOOTER-ROUTINE.                                             07910003
079700                                                                  07920003
079800     MOVE SPACES                 TO PV-PRINT-RECORD.              07930003
079900     MOVE +1                     TO PV-LINE-SPACING.              07940003
080000     PERFORM 9900-WRITE-REPORT-LINE.                              07950003
080100                                                                  07960003
080200     MOVE SPACES                 TO PV-PRINT-RECORD.              07970003
080300     MOVE +1                     TO PV-LINE-SPACING.              07980003
080400     PERFORM 9900-WRITE-REPORT-LINE.                              07990003
080500                                                                  08000003
080600     MOVE SPACES                 TO PV-PRINT-RECORD.              08010003
080700     MOVE +1                     TO PV-LINE-SPACING.              08020003
080800     PERFORM 9900-WRITE-REPORT-LINE.                              08030003
080900                                                                  08040003
081000     MOVE SPACES                 TO PV-PRINT-RECORD.              08050003
081100     MOVE +1                     TO PV-LINE-SPACING.              08060003
081200     PERFORM 9900-WRITE-REPORT-LINE.                              08070003
081300                                                                  08080003
081400     MOVE SPACES                 TO PV-PRINT-RECORD.              08090003
081500     MOVE +1                     TO PV-LINE-SPACING.              08100003
081600     PERFORM 9900-WRITE-REPORT-LINE.                              08110003
081700                                                                  08120003
081800     MOVE FT1-FOOTING-LINE-1     TO PV-PRINT-RECORD.              08130003
081900     MOVE +1                     TO PV-LINE-SPACING.              08140003
082000     PERFORM 9900-WRITE-REPORT-LINE.                              08150003
082100                                                                  08160003
082200     MOVE FT2-FOOTING-LINE-2     TO PV-PRINT-RECORD.              08170003
082300     MOVE +1                     TO PV-LINE-SPACING.              08180003
082400     PERFORM 9900-WRITE-REPORT-LINE.                              08190003
082500                                                                  08200003
082600     MOVE FT3-FOOTING-LINE-3     TO PV-PRINT-RECORD.              08210003
082700     MOVE +1                     TO PV-LINE-SPACING.              08220003
082800     PERFORM 9900-WRITE-REPORT-LINE.                              08230003
082900                                                                  08240003
083000     MOVE FT4-FOOTING-LINE-4     TO PV-PRINT-RECORD.              08250003
083100     MOVE +1                     TO PV-LINE-SPACING.              08260003
083200     PERFORM 9900-WRITE-REPORT-LINE.                              08270003
083300                                                                  08280003
083400     MOVE FT5-FOOTING-LINE-5     TO PV-PRINT-RECORD.              08290003
083500     MOVE +1                     TO PV-LINE-SPACING.              08300003
083600     PERFORM 9900-WRITE-REPORT-LINE.                              08310003
083700                                                                  08320003
083800     MOVE FT6-FOOTING-LINE-6     TO PV-PRINT-RECORD.              08330003
083900     MOVE +1                     TO PV-LINE-SPACING.              08340003
084000     PERFORM 9900-WRITE-REPORT-LINE.                              08350003
084100                                                                  08360003
084200     MOVE FT7-FOOTING-LINE-7     TO PV-PRINT-RECORD.              08370003
084300     MOVE +1                     TO PV-LINE-SPACING.              08380003
084400     PERFORM 9900-WRITE-REPORT-LINE.                              08390003
084500                                                                  08400003
084200     MOVE FT8-FOOTING-LINE-8     TO PV-PRINT-RECORD.              08410003
084300     MOVE +1                     TO PV-LINE-SPACING.              08420003
084400     PERFORM 9900-WRITE-REPORT-LINE.                              08430003
084500                                                                  08440003
085000                                                                  08450003
085100                                                                  08460003
085200                                                                  08470003
085300 EJECT                                                            08480003
085400******************************************************************08490003
085500* 9800-WRITE-RPT-TOP-OF-PAGE                                      08500003
085600*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   08510003
085700******************************************************************08520003
085800 9800-WRITE-RPT-TOP-OF-PAGE.                                      08530003
085900                                                                  08540003
086000     WRITE LINE-ITEM-DISC-RECORD                                  08550003
086100       FROM PV-PRINT-RECORD                                       08560003
086200         AFTER ADVANCING PAGE.                                    08570003
086300     MOVE +1 TO PV-LINE-CNT.                                      08580003
086400 EJECT                                                            08590003
086500******************************************************************08600003
086600* 9900-WRITE-REPORT-LINE                                          08610003
086700*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             08620003
086800******************************************************************08630003
086900 9900-WRITE-REPORT-LINE.                                          08640003
087000                                                                  08650003
087100     WRITE LINE-ITEM-DISC-RECORD                                  08660003
087200       FROM PV-PRINT-RECORD                                       08670003
087300         AFTER ADVANCING PV-LINE-SPACING.                         08680003
087400                                                                  08690003
087500     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          08700003
087600 EJECT                                                            08710003
087700******************************************************************08720003
087800* 9999-ABEND                                                      08730003
087900*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  08740003
088000******************************************************************08750003
088100 9999-ABEND.                                                      08760003
088200     DISPLAY '** ABEND           **'.                             08770003
088300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  08780003
088400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08790003
088500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       08800003
088600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       08810003
088700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         08820003
