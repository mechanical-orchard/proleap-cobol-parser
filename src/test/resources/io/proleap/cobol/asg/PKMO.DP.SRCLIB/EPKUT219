000100*------------------------------------------------------------     00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*------------------------------------------------------------     00030000
000400 PROGRAM-ID.    EPKUT219.                                         00040001
000500 AUTHOR.        MEDHA CHOUDHURY.                                  00050000
000510 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00051000
000600 DATE-WRITTEN.  JAN 21, 2009.                                     00060004
000700                                                                  00070000
000710*-------------------------------------------------------------*   00071000
000720*    SKU FORMATTER                                            *   00072000
000730*-------------------------------------------------------------*   00073000
001020*    THIS PROGRAM WILL FORMAT THE SKU PRICING INFORMATION     *   00102001
001030*    DATA FILE FOR THE SQL SERVER STORE DATABASE TABLE,       *   00103000
001040*    AND ADD DISTRIBUTION HEADER RECORDS, AS APPROPRIATE.     *   00104000
001041*    POS 2009 FALL - PRICING INFRASTRUCTURE PROJECT WR# 35484 *   00104100
001050*                                                             *   00105000
001060*------------------------------------------------------------ *   00106000
003800*  INPUT:                                                     *   00380000
003900*        SKU-PRICG-FILE                   EPRD220             *   00390001
004000*        CC-TODAYS-DATE                   EPCC140             *   00400016
004200*        CC-FILE-TYPE                     EPCC125             *   00420016
004300*        CC-TIME                          EPRD130             *   00430022
004400*                                                             *   00440000
004500*  OUTPUT:                                                    *   00450000
004600*        FORMATTED-SKU-PRICG-FL           EPRD217             *   00460001
004700*                                (FOR HEADER FORMAT)          *   00470000
004800*-------------------------------------------------------------*   00480000
004900* HISTORY LOG:                                                *   00490000
005000*                                                             *   00500000
005100*-------------------------------------------------------------*   00510000
005110* DATE: JAN 21 2009                                           *   00511015
005120* WR/IR#: WR #35484                                           *   00512015
005130* PROGRAMMER: MEDHA CHOUDHURY                                 *   00513015
005140* DESCRIPTION: INITIAL PROGRAM CREATION                       *   00514015
005150*-------------------------------------------------------------*   00515015
005200* DATE:                                                       *   00520000
005300* WR/IR#:                                                     *   00530000
005400* PROGRAMMER:                                                 *   00540000
005500* DESCRIPTION:                                                *   00550000
005600*                                                             *   00560000
005700*-------------------------------------------------------------*   00570000
005800 ENVIRONMENT DIVISION.                                            00580000
005900*-------------------------------------------------------------*   00590000
006000 CONFIGURATION SECTION.                                           00600000
006100 SOURCE-COMPUTER. IBM-3090.                                       00610000
006200 OBJECT-COMPUTER. IBM-3090.                                       00620000
006300                                                                  00630000
006400 INPUT-OUTPUT SECTION.                                            00640000
006500                                                                  00650000
006600 FILE-CONTROL.                                                    00660000
006700                                                                  00670000
006800*  INPUT:                                                     *   00680000
006900           SELECT SKU-PRICG-FILE                                  00690001
007000             ASSIGN TO INP01.                                     00700000
008300                                                                  00830000
008310           SELECT CC-TODAYS-DATE                                  00831016
008320             ASSIGN TO INP02.                                     00832016
008330                                                                  00833016
008370           SELECT CC-FILE-TYPE                                    00837016
008380             ASSIGN TO INP03.                                     00838017
008390                                                                  00839016
008391           SELECT CC-TIME                                         00839122
008392             ASSIGN TO INP04.                                     00839222
008393                                                                  00839322
008400*  OUTPUT:                                                    *   00840000
008500           SELECT FORMATTED-SKU-PRICG-FL                          00850001
008600             ASSIGN TO OUT01.                                     00860000
008700                                                                  00870000
008800*-------------------------------------------------------------*   00880000
008900 DATA DIVISION.                                                   00890000
009000*----------------------------------------------------------       00900000
009100 FILE SECTION.                                                    00910000
009200                                                                  00920000
009300 FD  SKU-PRICG-FILE                                               00930001
009400     RECORDING MODE IS F                                          00940000
009500     LABEL RECORDS ARE STANDARD                                   00950000
009600     RECORD CONTAINS 260 CHARACTERS                               00960002
009700     BLOCK CONTAINS 0 RECORDS                                     00970000
009800     DATA RECORD IS SKU-PRICG-RECORD.                             00980001
009900                                                                  00990000
010000 01  SKU-PRICG-RECORD             PIC X(260).                     01000002
010100                                                                  01010000
010200 FD  CC-TODAYS-DATE                                               01020016
010300     RECORDING MODE IS F                                          01030016
010400     BLOCK CONTAINS 0 RECORDS                                     01040016
010500     LABEL RECORDS ARE STANDARD.                                  01050016
010600                                                                  01060016
010700 01  CC-TODAYS-DATE-RECORD        PIC X(80).                      01070016
010800                                                                  01080016
011600 FD  CC-FILE-TYPE                                                 01160016
011700     RECORDING MODE IS F                                          01170016
011800     BLOCK CONTAINS 0 RECORDS                                     01180016
011900     LABEL RECORDS ARE STANDARD.                                  01190016
012000                                                                  01200016
012100 01  CC-FILE-TYPE-RECORD          PIC X(80).                      01210016
012200                                                                  01220016
012300 FD  CC-TIME                                                      01230022
012400     RECORDING MODE IS F                                          01240022
012500     BLOCK CONTAINS 0 RECORDS                                     01250022
012600     LABEL RECORDS ARE STANDARD.                                  01260022
012700                                                                  01270022
012800 01  CC-TIME-RECORD  PIC X(80).                                   01280022
012900                                                                  01290022
013800 FD  FORMATTED-SKU-PRICG-FL                                       01380001
013900     RECORDING MODE IS V                                          01390000
014000     RECORD IS VARYING IN SIZE                                    01400000
014100     FROM 1 TO 200 CHARACTERS                                     01410000
014200     DEPENDING ON PV-BYTE-COUNT                                   01420000
014300     LABEL RECORDS ARE STANDARD                                   01430000
014400     DATA RECORD IS FORMATTED-SKU-PRICG-REC.                      01440001
014500                                                                  01450000
014600 01  FORMATTED-SKU-PRICG-REC.                                     01460001
014700     05  FORM-SKU-PR-FLD                  PIC X(01)               01470001
014800         OCCURS 200 TIMES                                         01480000
014900              INDEXED BY                                          01490000
015000              FORM-SKU-PR-LEN.                                    01500001
015100                                                                  01510000
015200*----------------------------------------------------------       01520000
015300 WORKING-STORAGE SECTION.                                         01530000
015400                                                                  01540000
015500 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01550000
015600                                                  COMP SYNC.      01560000
015700     88  AC-INPUT-CONTROL-CARD-ERROR              VALUE +4003.    01570000
016100                                                                  01610000
016200*----------------------------------------------------------       01620000
016300* PC- PROGRAM CONSTANTS                                           01630000
016400*----------------------------------------------------------       01640000
016500 01  PC-PROGRAM-CONSTANTS.                                        01650000
016600     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT219'. 01660001
016900     05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.        01690000
017000     05  PC-NULL-VALUE                PIC X(01) VALUE '~'.        01700000
017100     05  PC-UNDER-SCORE               PIC X(01) VALUE '_'.        01710000
017200     05  PC-DASH                      PIC X(01) VALUE '-'.        01720000
017300     05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.        01730000
017400     05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.        01740000
017500     05  PC-TIME-START                PIC X(08) VALUE '00:00:01'. 01750000
017600     05  PC-TIME-END                  PIC X(08) VALUE '23:59:59'. 01760000
017700     05  PC-STORE-SPECIFIC-GRP        PIC X(05) VALUE '05000'.    01770000
017800     05  PC-FIVE-ZERO                 PIC X(05) VALUE '00000'.    01780000
017900     05  PC-HDR-IND                   PIC X(03) VALUE 'HDR'.      01790000
018100                                                                  01810000
018110*----------------------------------------------------------       01811022
018120* TIME                                                            01812022
018130*----------------------------------------------------------       01813022
018140 01  PC-TIME.                                                     01814022
018150     05  PC-TIME-HHMM                 PIC X(04).                  01815022
018160     05  PC-TIME-SS                   PIC X(02).                  01816022
018200*----------------------------------------------------------       01820000
018300* PV- PROGRAM VARIABLES                                           01830000
018400*----------------------------------------------------------       01840000
018500 01  PV-PROGRAM-STATUS.                                           01850000
018600     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     01860000
018700     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.     01870000
018800     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.     01880000
019100*                                                                 01910000
019200 01  PV-PROGRAM-VARIABLES.                                        01920000
019300     05  PV-TALLY                     PIC S9(03) COMP-3 VALUE +0. 01930000
019400     05  PV-BYTE-COUNT                PIC  9(04) VALUE ZERO.      01940000
019700     05  PV-SPACE                     PIC  X(01).                 01970000
019900                                                                  01990000
020000     05  PV-VARIABLE-OUTPUT-FIELD.                                02000000
020100         10  PV-BIT-VARIABLE          PIC X(01)                   02010000
020200                                          VALUE SPACES            02020000
020300                                          OCCURS 12 TIMES         02030000
020400                                          INDEXED BY              02040000
020500                                          PV-BIT-IDX              02050000
020700                                          PV-EOF-IDX.             02070000
020800                                                                  02080000
020900     05  PV-VARIABLE-CHAR-FIELD.                                  02090000
021000         10  PV-BIT-CHR-VARIABLE      PIC X(01)                   02100000
021100                                          VALUE SPACES            02110000
021200                                          OCCURS 30 TIMES         02120000
021300                                          INDEXED BY              02130000
021400                                          PV-CHR-BIT-IDX          02140000
021500                                          PV-CHR-EOF-IDX.         02150000
024200                                                                  02420000
024210     05  PV-HEADER-TMST.                                          02421022
024220         10  PV-HDR-BATCH-DT          PIC X(08).                  02422022
024230         10  PV-HDR-BATCH-TIME        PIC X(06).                  02423022
024240                                                                  02424022
025000**  CURRENT PRICING FILE DISTRIBUTION DATE                        02500018
025100     05  PV-FORMAT-HDR-DIST-DTE.                                  02510000
025200         10  PV-FORMAT-YYYY           PIC X(04).                  02520000
025300         10  PV-FORMAT-MM             PIC X(02).                  02530000
025400         10  PV-FORMAT-DD             PIC X(02).                  02540000
025500                                                                  02550000
025600**  FUTURE PRICING FILE DISTRIBUTION DATE                         02560018
026000     05  PV-FUTR-DIST-DTE.                                        02600018
026100         10  PV-FUTR-DIST-YYYY         PIC X(04).                 02610018
026200         10  PV-FUTR-DIST-MM           PIC X(02).                 02620018
026300         10  PV-FUTR-DIST-DD           PIC X(02).                 02630018
026400                                                                  02640000
026500     05  PV-PLU-EFFECTIVE-DTE.                                    02650000
026600         10  PV-EFFECT-YYYY           PIC X(04).                  02660000
026700         10  PV-EFFECT-DASH-1         PIC X(01) VALUE '-'.        02670000
026800         10  PV-EFFECT-MM             PIC X(02).                  02680000
026900         10  PV-EFFECT-DASH-2         PIC X(01) VALUE '-'.        02690000
027000         10  PV-EFFECT-DD             PIC X(02).                  02700000
027300                                                                  02730000
027310     05  PV-STR-GRP-TYP-CDE           PIC 9(05) VALUE ZERO.       02731000
027320     05  PV-STR-GRP-ID-GRP.                                       02732000
027321         10  PV-FIRST-BYTES           PIC 9(05) VALUE ZERO.       02732100
027330         10  PV-STR-GRP-ID            PIC 9(05) VALUE ZERO.       02733000
027340     05  PV-PRICG-EFFECT-DTE          PIC X(10) VALUE SPACES.     02734009
027341     05  PV-FILE-TYPE                 PIC X(03) VALUE SPACES.     02734109
027350                                                                  02735000
027351     05  PV-FILE-PROCESS-TYPE         PIC X(04) VALUE SPACES.     02735118
027352                                                                  02735218
027910 01  PV-TIME-CALC                     PIC 9(06).                  02791022
027920                                                                  02792022
027930 01  PV-TIME.                                                     02793022
027940     05  PV-TIME-HH                   PIC 9(02).                  02794022
027950     05  PV-TIME-MM                   PIC 9(02).                  02795022
027960     05  PV-TIME-SS                   PIC 9(02).                  02796022
027970                                                                  02797022
028000*----------------------------------------------------------       02800000
028100* PV- PROGRAM COUNT VARIABLES                                     02810000
028200*----------------------------------------------------------       02820000
028300 01  PV-PROGRAM-COUNTERS.                                         02830000
028400     05  PV-DATA-REC-WRITEN           PIC 9(09) VALUE 0.          02840000
028410     05  PV-HDR-REC-WRITEN            PIC 9(09) VALUE 0.          02841000
028500     05  PV-RECORDS-READ              PIC 9(09) VALUE 0.          02850000
028600     05  PV-PIPE-COUNT                PIC 9(04) VALUE 0.          02860000
029100                                                                  02910000
031300*----------------------------------------------------------------*03130000
031400* PS- PROGRAM SWITCHES                                           *03140000
031500*----------------------------------------------------------------*03150000
031600 01  PS-PROGRAM-SWITCHES.                                         03160000
031700     05  PS-END-OF-SKUPR-SW           PIC  X(01) VALUE 'N'.       03170002
031800         88  PS-END-OF-SKUPR-FILE                VALUE 'Y'.       03180002
031900         88  PS-NOT-END-SKUPR-FILE               VALUE 'N'.       03190002
033200     05  PS-END-OF-PROCES-SW          PIC  X(01) VALUE 'N'.       03320000
033300         88  PS-END-OF-PROCESSING                VALUE 'Y'.       03330000
033400         88  PS-NOT-END-OF-PROCESSING            VALUE 'N'.       03340000
033500     05  PS-READY-TRACE-SW            PIC  X(01) VALUE 'N'.       03350000
033600         88 PS-READY-TRACE                       VALUE 'Y'.       03360000
033700         88 PS-RESET-TRACE                       VALUE 'N'.       03370000
033710     05  PS-END-OF-TODAYS-DATE-SW     PIC X(01)  VALUE 'N'.       03371016
033720         88  PS-END-OF-TODAYS-DATE-FILE          VALUE 'Y'.       03372016
033730     05  PS-END-OF-TOMORR-DATE-SW     PIC X(01)  VALUE 'N'.       03373016
033740         88  PS-END-OF-TOMORR-DATE-FILE          VALUE 'Y'.       03374016
033750     05  PS-END-OF-FILE-TYPE-SW       PIC X(01)  VALUE 'N'.       03375016
033760         88  PS-END-OF-FILE-TYPE-FILE            VALUE 'Y'.       03376016
033770     05  PS-END-OF-TIME-SW            PIC X(01)  VALUE 'N'.       03377024
033780         88  PS-END-OF-TIME-FILE                 VALUE 'Y'.       03378024
033800                                                                  03380000
037400*----------------------------------------------------------       03740000
037500* COPYBOOK  EPRD217 USED TO WRITE THE HEADER RECORD               03750030
037600*----------------------------------------------------------       03760000
037700     COPY EPRD217.                                                03770000
037800                                                                  03780000
037900*----------------------------------------------------------       03790000
038000* COPYBOOK  EPRD220 USED TO READ IN INPUT FILE (XST_SKU_PRICG )   03800030
038100*----------------------------------------------------------       03810000
038200     COPY EPRD220.                                                03820001
038300                                                                  03830000
038400*----------------------------------------------------------       03840016
038500* FILE TYPE   - WILL HELP TELL FILE TYPE BEING PROCESSED          03850016
038600*----------------------------------------------------------       03860016
038700     COPY EPRD225.                                                03870029
038800                                                                  03880016
038810*----------------------------------------------------------       03881016
038820* TODAYS DATE - BASED ON DAY THE JOB WAS SCHEDULED TO RUN         03882016
038830*----------------------------------------------------------       03883016
038840     COPY EPWS140.                                                03884016
038850                                                                  03885016
038860*----------------------------------------------------------       03886022
038870* CC-TIME - COPYBOOK USED TO READ THE TIME CONTROL CARD           03887022
038880*----------------------------------------------------------       03888022
038890     COPY EPRD130.                                                03889022
038900                                                                  03890022
042200*----------------------------------------------------------       04220000
042300 PROCEDURE DIVISION.                                              04230000
042400*----------------------------------------------------------       04240000
042500 0000-MAINLINE.                                                   04250000
042600                                                                  04260000
042700     PERFORM 1000-INITIALIZATION.                                 04270000
042800                                                                  04280000
042900     PERFORM 2000-PROCESS-SKU-PRICG                               04290003
043000             UNTIL PS-END-OF-PROCESSING.                          04300000
043100                                                                  04310000
043200     PERFORM 9200-WRAPUP.                                         04320000
043300                                                                  04330000
043400     GOBACK.                                                      04340000
043500                                                                  04350000
043600*0000-EXIT.                                                       04360000
043800                                                                  04380000
043900*----------------------------------------------------------       04390000
044000* 1000-INITIALIZATION.                                            04400000
044100*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           04410000
044200*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      04420000
044300*     FILES.                                                      04430000
044400*----------------------------------------------------------       04440000
044500 1000-INITIALIZATION.                                             04450000
044600                                                                  04460000
044700     DISPLAY '****************************************'.          04470000
044800     DISPLAY '**          EPKUT219 STARTED          **'.          04480001
044900     DISPLAY '****************************************'.          04490000
045000                                                                  04500000
045100     INITIALIZE PV-PROGRAM-VARIABLES.                             04510000
045200                                                                  04520000
045700     SET PS-NOT-END-SKUPR-FILE      TO TRUE.                      04570008
046200                                                                  04620000
046300     PERFORM 1100-OPEN-FILES.                                     04630000
046400                                                                  04640000
046610     PERFORM 1300-READ-TODAYS-DATE.                               04661016
046620                                                                  04662016
046630     PERFORM 1400-READ-FILE-TYPE.                                 04663019
046640                                                                  04664019
046650     PERFORM 1500-READ-TIME-CC.                                   04665022
046660                                                                  04666022
046700     PERFORM 6000-READ-SKU-FILE.                                  04670000
046800                                                                  04680000
047800     IF PS-END-OF-SKUPR-FILE                                      04780002
047900        DISPLAY '***    SKU PRICING EXTRACT FILE IS EMPTY    ****'04790013
047910        SET PS-END-OF-PROCESSING TO TRUE                          04791000
048200     END-IF.                                                      04820000
048300                                                                  04830000
051000*1000-EXIT.                                                       05100000
051200                                                                  05120000
051300*----------------------------------------------------------       05130000
051400* 1100-OPEN-FILES.                                                05140000
051500*     THIS PARAGRAPH OPENS ALL THE FILES IN MODE REQUIRED         05150000
051600*----------------------------------------------------------       05160000
051700 1100-OPEN-FILES.                                                 05170000
051800                                                                  05180000
051900     OPEN INPUT SKU-PRICG-FILE                                    05190016
052000                CC-TODAYS-DATE                                    05200016
052010                CC-TIME                                           05201022
052100                CC-FILE-TYPE.                                     05210017
052500                                                                  05250000
052600     OPEN OUTPUT FORMATTED-SKU-PRICG-FL.                          05260001
052700                                                                  05270000
052800*1100-EXIT.                                                       05280000
053000                                                                  05300000
063120*----------------------------------------------------------       06312016
063130* 1300-READ-TODAYS-DATE.                                          06313016
063140*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE         06314016
063150*     USED TO UPDATE THE CRT-TIMESTAMP ON THE HEADER RECORD       06315016
063160*----------------------------------------------------------       06316016
063170 1300-READ-TODAYS-DATE.                                           06317016
063180                                                                  06318016
063190     READ CC-TODAYS-DATE INTO CC-EPCC140-CONTROL-CARD             06319016
063191         AT END                                                   06319116
063192             SET PS-END-OF-TODAYS-DATE-FILE TO TRUE.              06319216
063193                                                                  06319316
063194     DISPLAY '    '                                               06319416
063195     DISPLAY '   TODAYS DATE CONTROL CARD   '.                    06319516
063196     DISPLAY CC-EPCC140-CONTROL-CARD-DISPLY.                      06319616
063197     DISPLAY '  '.                                                06319716
063198                                                                  06319816
063199     IF PS-END-OF-TODAYS-DATE-FILE                                06319916
063200         MOVE '1300-READ-TODAYS-DATE'  TO PV-PARAGRAPH-NAME       06320016
063201         MOVE 'EMPTY TODAYS DATE CC '   TO PV-OPERATION-MSG-1     06320116
063202         SET AC-INPUT-CONTROL-CARD-ERROR TO TRUE                  06320216
063203         PERFORM 9910-ABEND                                       06320316
063204     END-IF.                                                      06320416
063205                                                                  06320516
063206*                                                                 06320616
063207*-- CONVERT FORMAT OF DATE FROM CCYY-MM-DD TO CCYYMMDD            06320716
063208*                                                                 06320816
063209     MOVE CC-EPCC140-TODAY-DATE  TO PV-PLU-EFFECTIVE-DTE.         06320916
063210                                                                  06321016
063211     MOVE PV-EFFECT-YYYY       TO PV-FORMAT-YYYY.                 06321116
063212     MOVE PV-EFFECT-MM         TO PV-FORMAT-MM.                   06321216
063213     MOVE PV-EFFECT-DD         TO PV-FORMAT-DD.                   06321316
063214                                                                  06321416
063215*1300-EXIT.                                                       06321516
063217                                                                  06321716
063218*----------------------------------------------------------       06321818
063219* 1400-READ-FILE-TYPE.                                            06321918
063220*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE         06322018
063221*     USED TO UPDATE THE CRT-TIMESTAMP ON THE HEADER RECORD       06322118
063222*----------------------------------------------------------       06322218
063223 1400-READ-FILE-TYPE.                                             06322318
063224                                                                  06322418
063225     READ CC-FILE-TYPE INTO CC-EPCC225-CONTROL-CARD               06322529
063226         AT END                                                   06322618
063227             SET PS-END-OF-FILE-TYPE-FILE TO TRUE.                06322718
063228                                                                  06322818
063229     DISPLAY '    '                                               06322918
063230     DISPLAY '   FILE TYPE BEING PROCESSED IS : '                 06323021
063231                               CC-EPCC225-CONTROL-CARD-DISPLY.    06323129
063232     DISPLAY '  '.                                                06323218
063233                                                                  06323318
063234     IF PS-END-OF-FILE-TYPE-FILE                                  06323418
063235         MOVE '1400-READ-FILE-TYPE  '  TO PV-PARAGRAPH-NAME       06323518
063236         MOVE 'EMPTY FILE TYPE   CC '   TO PV-OPERATION-MSG-1     06323618
063237         SET AC-INPUT-CONTROL-CARD-ERROR TO TRUE                  06323718
063238         PERFORM 9910-ABEND                                       06323818
063239     END-IF.                                                      06323918
063240                                                                  06324018
063241     MOVE CC-EPCC225-FILE-TYPE  TO PV-FILE-PROCESS-TYPE.          06324129
063242                                                                  06324218
063243*1400-EXIT.                                                       06324318
063245                                                                  06324518
063246******************************************************************06324622
063247* 1500-READ-TIME-CC                                               06324722
063248******************************************************************06324822
063249                                                                  06324922
063250 1500-READ-TIME-CC.                                               06325022
063251                                                                  06325122
063252     READ CC-TIME INTO EP130-CC-CONTROL-CARD                      06325222
063253         AT END                                                   06325322
063254             SET PS-END-OF-TIME-FILE TO TRUE.                     06325422
063255                                                                  06325522
063256     DISPLAY '----------------------------------------'.          06325622
063257     DISPLAY EP130-CC-CONTROL-CARD-DISPLY.                        06325722
063258     DISPLAY '----------------------------------------'.          06325822
063259                                                                  06325922
063260     IF PS-END-OF-TIME-FILE                                       06326022
063261         MOVE '1500-READ-TIME-CC    '  TO PV-PARAGRAPH-NAME       06326122
063262         MOVE 'EMPTY TIME CC        '   TO PV-OPERATION-MSG-1     06326222
063263         SET AC-INPUT-CONTROL-CARD-ERROR TO TRUE                  06326322
063264         PERFORM 9910-ABEND                                       06326422
063265     ELSE                                                         06326522
063266         MOVE EP130-CC-FIRST-HEADER-TIME TO PC-TIME               06326622
063267                                            PV-TIME-CALC          06326722
063268     END-IF.                                                      06326822
063269                                                                  06326922
063270                                                                  06327022
063271     CLOSE CC-TIME.                                               06327122
063272                                                                  06327222
063273*1500-EXIT.                                                       06327322
063275                                                                  06327522
063280*----------------------------------------------------------       06328000
063300* 2000-PROCESS-SKU-PRICG                                          06330003
063400* ----------------------------                                    06340000
063500* THE PARAGRAPH WILL PERFORM THE FOLLOWING                        06350000
063800*                                                                 06380000
063900* (1) CREATE HEADER RECORD IF THE PREVIOUS STORE INFORMATION IS   06390000
064000*     DIFFERENT FROM THE CURRENT.                                 06400000
064200*                                                                 06420000
064300* (2) FORMAT THE DATA RECORD                                      06430000
065800*                                                                 06580000
065900*----------------------------------------------------------       06590000
066000 2000-PROCESS-SKU-PRICG.                                          06600003
066100                                                                  06610000
066110**-- FORMAT HEADER RECORD                                         06611000
066600                                                                  06660000
066610     PERFORM 2050-DETERMINE-FILE-WRT-HDR.                         06661016
066620                                                                  06662016
066700**-- INITIALIZE VARIABLES FOR DETAIL RECORD                       06670000
066710                                                                  06671000
066711     SET FORM-SKU-PR-LEN TO +1.                                   06671101
066712     MOVE 0 TO PV-BYTE-COUNT.                                     06671200
066713     INITIALIZE FORMATTED-SKU-PRICG-REC.                          06671301
066714                                                                  06671400
066720**-- FORMAT DETAIL RECORD                                         06672000
067000                                                                  06700000
067010     PERFORM 2300-FORMAT-DETAIL-REC.                              06701000
070219                                                                  07021900
070220     PERFORM 6000-READ-SKU-FILE.                                  07022000
070221                                                                  07022100
070222     IF PS-END-OF-SKUPR-FILE                                      07022202
070223        SET PS-END-OF-PROCESSING TO TRUE                          07022300
070224     END-IF.                                                      07022400
070225                                                                  07022500
070230*2000-EXIT.                                                       07023000
094500                                                                  09450000
094501*-----------------------------------------------------------------09450116
094502* 2050-DETERMINE-FILE-WRT-HDR                                     09450216
094503*  THIS PARAGRAPH WILL DETERMINE THE FILE TYPE AND BASED ON THAT  09450316
094504*  DETERMINE IF THERE IS A NEED TO WRITE HEADER OR NOT            09450416
094505*----------------------------------------------------------------*09450516
094506 2050-DETERMINE-FILE-WRT-HDR.                                     09450616
094507                                                                  09450716
094508     IF EP220-STR-GRP-TYP-CDE NOT = PV-STR-GRP-TYP-CDE            09450816
094509      OR EP220-STR-GRP-ID NOT = PV-STR-GRP-ID-GRP                 09450916
094510      OR EP220-PRICG-EFFECT-DTE NOT = PV-PRICG-EFFECT-DTE         09451018
094511      OR EP220-FILE-ACT-TYP NOT = PV-FILE-TYPE                    09451118
094512        PERFORM 2100-FORMAT-AND-WRITE-HDR                         09451216
094513     END-IF.                                                      09451316
094514                                                                  09451416
094515*2050-EXIT.                                                       09451516
094530                                                                  09453016
094600*-----------------------------------------------------------------09460000
094700* 2100-FORMAT-AND-WRITE-HDR                                       09470000
094800*  THIS PARAGRAPH MOVES APPROPRIATE VALUES TO THE EPRD200 COPYBOOK09480000
094900*  LAYOUT (BEFORE WRITING OUT THE HEADER RECORD)                  09490000
095000*----------------------------------------------------------------*09500000
095100 2100-FORMAT-AND-WRITE-HDR.                                       09510000
095200                                                                  09520000
095210     MOVE EP220-STR-GRP-TYP-CDE  TO PV-STR-GRP-TYP-CDE.           09521002
095220     MOVE EP220-STR-GRP-ID       TO PV-STR-GRP-ID-GRP.            09522002
095221     MOVE EP220-PRICG-EFFECT-DTE TO PV-PRICG-EFFECT-DTE.          09522118
095222     MOVE EP220-FILE-ACT-TYP     TO PV-FILE-TYPE.                 09522218
095230                                                                  09523000
095240*** SET UP FILE DISTRIBUTION DATE FOR FUTURE FILE ONLY            09524018
095241     DISPLAY ' PV-FILE-PROCESS-TYPE ' PV-FILE-PROCESS-TYPE        09524120
095242                                                                  09524220
095243     IF PV-FILE-PROCESS-TYPE = 'FUTR'                             09524318
095244        MOVE EP220-PRICG-EFFECT-DTE TO PV-PLU-EFFECTIVE-DTE       09524418
095245        MOVE PV-EFFECT-YYYY       TO PV-FORMAT-YYYY               09524518
095246        MOVE PV-EFFECT-MM         TO PV-FORMAT-MM                 09524618
095247        MOVE PV-EFFECT-DD         TO PV-FORMAT-DD                 09524718
095248        DISPLAY 'DIST DTE' PV-FORMAT-HDR-DIST-DTE                 09524820
095249     END-IF.                                                      09524918
095250                                                                  09525000
095300     MOVE PC-HDR-IND             TO EP217-HDR-INDICATOR.          09530000
095400     MOVE EP220-STR-GRP-TYP-CDE  TO EP217-STR-GRP-TYP.            09540002
095410     MOVE EP220-STR-GRP-ID       TO EP217-STR-GRP-ID.             09541002
095700     MOVE PC-FIVE-ZERO           TO EP217-EXCO-STR-NBR.           09570000
095800     MOVE PV-FORMAT-HDR-DIST-DTE TO EP217-FILE-DIST-DATE.         09580000
095900     SET EP217-FILE-PRICING      TO TRUE.                         09590000
096000     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-1.           09600000
096010     SET EP217-XST-SKU-PRICG     TO TRUE.                         09601002
096100     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-2.           09610000
096200     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-3.           09620000
096300     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-4.           09630000
096400     MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-5.           09640000
096500     MOVE EP220-FILE-ACT-TYP     TO EP217-FILE-NAME-TYPE.         09650002
096501                                                                  09650100
096510     IF EP220-STR-GRP-TYP-CDE = PC-STORE-SPECIFIC-GRP             09651002
096520         MOVE PV-STR-GRP-ID          TO EP217-STORE-NBR           09652000
096530     ELSE                                                         09653000
096600         MOVE PC-FIVE-ZERO           TO EP217-STORE-NBR           09660000
096610     END-IF.                                                      09661000
096620                                                                  09662000
096630     MOVE PV-FORMAT-HDR-DIST-DTE TO PV-HDR-BATCH-DT.              09663022
096640     MOVE PV-TIME-CALC           TO PV-HDR-BATCH-TIME.            09664022
096650                                                                  09665022
096700     MOVE PV-HEADER-TMST         TO EP217-CRT-TIMESTAMP.          09670000
096800     MOVE EP220-APPLY-IND        TO EP217-FILE-TYPE-APPLY.        09680002
096900                                                                  09690000
097000     PERFORM 2200-WRITE-HDR-RECORD.                               09700000
097100                                                                  09710000
097200*2100-EXIT.                                                       09720000
097430                                                                  09743018
097500*-----------------------------------------------------------------09750000
097600* 2200-WRITE-HDR-RECORD                                           09760000
097700*  THIS PARAGRAPH WILL WRITE THE HEADER RECORD TO THE O/P FILE    09770000
097800*-----------------------------------------------------------------09780000
097900 2200-WRITE-HDR-RECORD.                                           09790000
098000                                                                  09800000
098110     PERFORM 5100-CALC-TIME.                                      09811022
098200                                                                  09820000
098300     MOVE 64                                                      09830000
098400       TO PV-BYTE-COUNT.                                          09840000
098500     WRITE FORMATTED-SKU-PRICG-REC                                09850001
098600       FROM EP217-HEADER-RECORD.                                  09860000
098700                                                                  09870000
098710     ADD 1 TO PV-HDR-REC-WRITEN.                                  09871000
098720                                                                  09872000
098800*2200-EXIT.                                                       09880000
098901                                                                  09890100
098902*-----------------------------------------------------------------09890200
098903* 2300-FORMAT-DETAIL-REC                                          09890300
098904*  THIS PARAGRAPH WILL FORMAT THE DETAIL RECORD                   09890406
098906*----------------------------------------------------------------*09890606
098907 2300-FORMAT-DETAIL-REC.                                          09890706
098908                                                                  09890806
098909     PERFORM 2600-MOVE-DELIMITER.                                 09890906
098910     PERFORM 2400-MOVE-TRIGGER-TYPE.                              09891006
098911                                                                  09891106
098912     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09891206
098913     INITIALIZE PV-TALLY.                                         09891306
098914                                                                  09891406
098915**----  MOVE SKU-PRICING-ID -----SINCE THIS WILL BE GENERATED AT  09891514
098916**----  THE STORE SEND NO DATA (TWO PIPES)                        09891606
099167                                                                  09916700
099182     PERFORM 2600-MOVE-DELIMITER.                                 09918200
099184                                                                  09918406
099185**----  MOVE EFFECTIVE BEG DATE--- NOT NULL ---------------**     09918506
099186                                                                  09918606
099187     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09918706
099188                                                                  09918806
099189     IF EP220-PRIC-EFF-TMST-YES                                   09918906
099191        MOVE EP220-PRIC-EFF-TMST    TO PV-VARIABLE-CHAR-FIELD     09919106
099192        SET PV-CHR-EOF-IDX TO +19                                 09919206
099198        PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX       09919806
099199           FROM 1  BY 1                                           09919906
099200           UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                  09920006
099202     END-IF.                                                      09920206
099203                                                                  09920306
099204     PERFORM 2600-MOVE-DELIMITER.                                 09920406
099205                                                                  09920506
099206**----  MOVE MDSE-HIER-CDE ------- NOT NULL ---------------**     09920606
099207                                                                  09920706
099208     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09920806
099209                                                                  09920906
099210     IF EP220-MDSE-HIER-CDE-YES                                   09921006
099211        EVALUATE TRUE                                             09921111
099212            WHEN EP220-MDSE-HIER-CDE = SPACES                     09921211
099213                PERFORM 3200-MOVE-SPACE                           09921311
099214            WHEN OTHER                                            09921411
099215               MOVE EP220-MDSE-HIER-CDE TO PV-VARIABLE-CHAR-FIELD 09921511
099216               SET PV-CHR-EOF-IDX TO +3                           09921611
099217               PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX09921711
099218                  FROM 1  BY 1                                    09921811
099219                  UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX           09921911
099220        END-EVALUATE                                              09922011
099221     END-IF.                                                      09922106
099222                                                                  09922206
099223     PERFORM 2600-MOVE-DELIMITER.                                 09922306
099224                                                                  09922406
099225**----  MOVE DEPT-NBR ---------------- NULL ---------------**     09922506
099226                                                                  09922606
099227     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09922706
099228     INITIALIZE PV-TALLY.                                         09922806
099229                                                                  09922906
099231     IF EP220-DEPT-NBR-YES                                        09923111
099232        EVALUATE TRUE                                             09923211
099233            WHEN EP220-DEPT-NBR-NUL = '~'                         09923311
099234              PERFORM 2900-MOVE-NULL-VALUE                        09923406
099235            WHEN EP220-DEPT-NBR = ZEROES                          09923511
099236              PERFORM 3100-MOVE-ZERO                              09923611
099237            WHEN OTHER                                            09923711
099238              INSPECT EP220-DEPT-NBR        TALLYING PV-TALLY     09923806
099239              FOR LEADING ZEROES                                  09923906
099240              SET PV-BIT-IDX TO PV-TALLY                          09924006
099241              SET PV-BIT-IDX UP BY +1                             09924106
099242                                                                  09924206
099243              MOVE EP220-DEPT-NBR     TO PV-VARIABLE-OUTPUT-FIELD 09924306
099244                                                                  09924406
099245              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09924506
099246                FROM PV-BIT-IDX  BY 1                             09924606
099247                 UNTIL PV-EOF-IDX > 4                             09924706
099248        END-EVALUATE                                              09924811
099251     END-IF.                                                      09925111
099252                                                                  09925206
099253     PERFORM 2600-MOVE-DELIMITER.                                 09925306
099254                                                                  09925406
099255**----  MOVE MAJ-CL-NBR--------------- NULL ---------------**     09925506
099256                                                                  09925606
099257     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09925706
099258     INITIALIZE PV-TALLY.                                         09925806
099259                                                                  09925906
099261     IF EP220-MAJ-CL-NBR-YES                                      09926111
099262       EVALUATE TRUE                                              09926211
099263           WHEN EP220-MAJ-CL-NBR-NUL = '~'                        09926311
099264              PERFORM 2900-MOVE-NULL-VALUE                        09926406
099265           WHEN EP220-MAJ-CL-NBR = ZEROES                         09926511
099266              PERFORM 3100-MOVE-ZERO                              09926611
099267           WHEN OTHER                                             09926711
099268              INSPECT EP220-MAJ-CL-NBR      TALLYING PV-TALLY     09926806
099269              FOR LEADING ZEROES                                  09926906
099270              SET PV-BIT-IDX TO PV-TALLY                          09927006
099271              SET PV-BIT-IDX UP BY +1                             09927106
099272                                                                  09927206
099273              MOVE EP220-MAJ-CL-NBR   TO PV-VARIABLE-OUTPUT-FIELD 09927306
099274                                                                  09927406
099275              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09927506
099276                FROM PV-BIT-IDX  BY 1                             09927606
099277                 UNTIL PV-EOF-IDX > 4                             09927706
099278       END-EVALUATE                                               09927811
099279     END-IF.                                                      09927911
099282                                                                  09928206
099283     PERFORM 2600-MOVE-DELIMITER.                                 09928306
099284                                                                  09928406
099285**----  MOVE SUB-CL-NBR--------------- NULL ---------------**     09928506
099286                                                                  09928606
099287     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09928706
099288     INITIALIZE PV-TALLY.                                         09928806
099289                                                                  09928906
099291     IF EP220-SUB-CL-NBR-YES                                      09929111
099292       EVALUATE TRUE                                              09929211
099293           WHEN EP220-SUB-CL-NBR-NUL = '~'                        09929311
099294              PERFORM 2900-MOVE-NULL-VALUE                        09929406
099295           WHEN EP220-SUB-CL-NBR = ZEROES                         09929511
099296              PERFORM 3100-MOVE-ZERO                              09929611
099297           WHEN OTHER                                             09929711
099298              INSPECT EP220-SUB-CL-NBR      TALLYING PV-TALLY     09929806
099299              FOR LEADING ZEROES                                  09929906
099300              SET PV-BIT-IDX TO PV-TALLY                          09930006
099301              SET PV-BIT-IDX UP BY +1                             09930106
099302                                                                  09930206
099303              MOVE EP220-SUB-CL-NBR   TO PV-VARIABLE-OUTPUT-FIELD 09930306
099304                                                                  09930406
099305              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09930506
099306                FROM PV-BIT-IDX  BY 1                             09930606
099307                 UNTIL PV-EOF-IDX > 4                             09930706
099308       END-EVALUATE                                               09930811
099309     END-IF.                                                      09930911
099312                                                                  09931206
099313     PERFORM 2600-MOVE-DELIMITER.                                 09931306
099314                                                                  09931406
099315**----  MOVE STYLE-ID ---------------- NULL ---------------**     09931506
099316                                                                  09931606
099317     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09931706
099318     INITIALIZE PV-TALLY.                                         09931806
099319                                                                  09931906
099321     IF EP220-STYL-ID-YES                                         09932111
099322       EVALUATE TRUE                                              09932211
099323           WHEN EP220-STYL-ID-NUL = '~'                           09932311
099324              PERFORM 2900-MOVE-NULL-VALUE                        09932406
099325           WHEN EP220-STYL-ID = ZEROES                            09932511
099326              PERFORM 3100-MOVE-ZERO                              09932611
099327           WHEN OTHER                                             09932711
099328              INSPECT EP220-STYL-ID      TALLYING PV-TALLY        09932806
099329              FOR LEADING ZEROES                                  09932906
099330              SET PV-BIT-IDX TO PV-TALLY                          09933006
099331              SET PV-BIT-IDX UP BY +1                             09933106
099332                                                                  09933206
099333              MOVE EP220-STYL-ID      TO PV-VARIABLE-OUTPUT-FIELD 09933306
099334                                                                  09933406
099335              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09933506
099336                FROM PV-BIT-IDX  BY 1                             09933606
099337                 UNTIL PV-EOF-IDX > 8                             09933706
099338       END-EVALUATE                                               09933811
099339     END-IF.                                                      09933911
099342                                                                  09934206
099343     PERFORM 2600-MOVE-DELIMITER.                                 09934306
099344                                                                  09934406
099345**----  MOVE EXCL-MDSE-IND ----------- NULL ---------------**     09934506
099346                                                                  09934606
099347     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09934706
099348                                                                  09934806
099349     EVALUATE TRUE                                                09934906
099350        WHEN EP220-EXCL-MDSE-IND-YES                              09935006
099351           IF EP220-EXCL-MDSE-IND = '~'                           09935106
099352              PERFORM 2900-MOVE-NULL-VALUE                        09935208
099353           ELSE                                                   09935306
099354             MOVE EP220-EXCL-MDSE-IND    TO PV-VARIABLE-CHAR-FIELD09935406
099355             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09935506
099356               FROM 1  BY 1                                       09935606
099357                 UNTIL PV-CHR-BIT-IDX > 1                         09935706
099358           END-IF                                                 09935806
099359        WHEN EP220-EXCL-MDSE-IND-NO                               09935914
099360           CONTINUE                                               09936006
099361     END-EVALUATE.                                                09936106
099362                                                                  09936206
099363     PERFORM 2600-MOVE-DELIMITER.                                 09936306
099364                                                                  09936406
099365**----  MOVE SKU-NBR ----------------- NULL ---------------**     09936506
099366                                                                  09936606
099367     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09936706
099368     INITIALIZE PV-TALLY.                                         09936806
099369                                                                  09936906
099371     IF EP220-SKU-NBR-YES                                         09937111
099372       EVALUATE TRUE                                              09937211
099373           WHEN EP220-SKU-NBR-NUL = '~'                           09937311
099374              PERFORM 2900-MOVE-NULL-VALUE                        09937406
099375           WHEN EP220-SKU-NBR = ZEROES                            09937511
099376              PERFORM 3100-MOVE-ZERO                              09937611
099377           WHEN OTHER                                             09937711
099378              INSPECT EP220-SKU-NBR      TALLYING PV-TALLY        09937806
099379              FOR LEADING ZEROES                                  09937906
099380              SET PV-BIT-IDX TO PV-TALLY                          09938006
099381              SET PV-BIT-IDX UP BY +1                             09938106
099382                                                                  09938206
099383              MOVE EP220-SKU-NBR      TO PV-VARIABLE-OUTPUT-FIELD 09938306
099384                                                                  09938406
099385              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09938506
099386                FROM PV-BIT-IDX  BY 1                             09938606
099387                 UNTIL PV-EOF-IDX > 8                             09938706
099388       END-EVALUATE                                               09938811
099389     END-IF.                                                      09938911
099392                                                                  09939206
099393     PERFORM 2600-MOVE-DELIMITER.                                 09939306
099394                                                                  09939406
099395**----  MOVE UNT-RTL-AMT --------- NOT NULL ---------------**     09939506
099396                                                                  09939606
099397     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09939706
099398     INITIALIZE PV-TALLY.                                         09939806
099399                                                                  09939906
099400     IF EP220-UNT-RTL-AMT-YES                                     09940006
099401        EVALUATE TRUE                                             09940106
099402           WHEN EP220-UNT-RTL-AMT = ZEROES                        09940206
099403              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09940306
099404              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09940406
099405                FROM 1 BY 1                                       09940510
099406                  UNTIL PV-EOF-IDX > 3                            09940606
099407           WHEN OTHER                                             09940706
099408              INSPECT EP220-UNT-RTL-AMT  TALLYING PV-TALLY        09940806
099409              FOR LEADING ZEROES                                  09940906
099410              SET PV-BIT-IDX TO PV-TALLY                          09941006
099411                                                                  09941106
099412              EVALUATE TRUE                                       09941206
099413                  WHEN PV-BIT-IDX < 9                             09941306
099414                    SET PV-BIT-IDX UP BY +1                       09941406
099415                  WHEN PV-BIT-IDX = 10                            09941506
099416                    SET PV-BIT-IDX DOWN BY +1                     09941606
099417              END-EVALUATE                                        09941706
099418                                                                  09941806
099419              MOVE EP220-UNT-RTL-AMT  TO PV-VARIABLE-OUTPUT-FIELD 09941906
099420                                                                  09942006
099421              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09942106
099422                FROM PV-BIT-IDX  BY 1                             09942206
099423                 UNTIL PV-EOF-IDX > 11                            09942306
099424        END-EVALUATE                                              09942406
099425     END-IF.                                                      09942506
099426                                                                  09942606
099427     PERFORM 2600-MOVE-DELIMITER.                                 09942706
099428                                                                  09942806
099429**----  MOVE LAST-NON-CL-UNT-RTL-AMT-- NULL ---------------**     09942906
099430                                                                  09943006
099431     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09943106
099432     INITIALIZE PV-TALLY.                                         09943206
099433                                                                  09943306
099434     IF EP220-LAST-NCLR-RTL-AMT-YES                               09943406
099435        EVALUATE TRUE                                             09943506
099436           WHEN EP220-LAST-NCLR-RTL-AMT-NUL = '~'                 09943606
099437             PERFORM 2900-MOVE-NULL-VALUE                         09943706
099438           WHEN EP220-LAST-NCLR-RTL-AMT = ZEROES                  09943806
099439              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09943906
099440              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09944006
099441                FROM 1 BY 1                                       09944112
099442                  UNTIL PV-EOF-IDX > 3                            09944206
099443           WHEN OTHER                                             09944306
099444              INSPECT EP220-LAST-NCLR-RTL-AMT  TALLYING PV-TALLY  09944406
099445              FOR LEADING ZEROES                                  09944506
099446              SET PV-BIT-IDX TO PV-TALLY                          09944606
099447                                                                  09944706
099448              EVALUATE TRUE                                       09944806
099449                  WHEN PV-BIT-IDX < 9                             09944906
099450                    SET PV-BIT-IDX UP BY +1                       09945006
099451                  WHEN PV-BIT-IDX = 10                            09945106
099452                    SET PV-BIT-IDX DOWN BY +1                     09945206
099453              END-EVALUATE                                        09945306
099454                                                                  09945406
099455              MOVE EP220-LAST-NCLR-RTL-AMT  TO                    09945506
099456                                          PV-VARIABLE-OUTPUT-FIELD09945606
099457                                                                  09945706
099458              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09945806
099459                FROM PV-BIT-IDX  BY 1                             09945906
099460                 UNTIL PV-EOF-IDX > 11                            09946006
099461        END-EVALUATE                                              09946106
099462     END-IF.                                                      09946206
099463                                                                  09946306
099464     PERFORM 2600-MOVE-DELIMITER.                                 09946406
099465                                                                  09946506
099466**----  MOVE NON-RCPT-RET-UNT-RTL-AMT-- NULL ---------------**    09946606
099467                                                                  09946706
099468     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09946806
099469     INITIALIZE PV-TALLY.                                         09946906
099470                                                                  09947006
099471     IF EP220-N-RCPT-RT-RTL-AMT-Y                                 09947106
099472        EVALUATE TRUE                                             09947206
099473           WHEN EP220-N-RCPT-RT-UNT-RTL-AMT-NL = '~'              09947306
099474             PERFORM 2900-MOVE-NULL-VALUE                         09947406
099475           WHEN EP220-N-RCPT-RT-UNT-RTL-AMT = ZEROES              09947506
099476              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09947606
099477              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09947706
099478                FROM 1 BY 1                                       09947812
099479                  UNTIL PV-EOF-IDX > 3                            09947906
099480           WHEN OTHER                                             09948006
099481             INSPECT EP220-N-RCPT-RT-UNT-RTL-AMT TALLYING PV-TALLY09948106
099482              FOR LEADING ZEROES                                  09948206
099483              SET PV-BIT-IDX TO PV-TALLY                          09948306
099484                                                                  09948406
099485              EVALUATE TRUE                                       09948506
099486                  WHEN PV-BIT-IDX < 9                             09948606
099487                    SET PV-BIT-IDX UP BY +1                       09948706
099488                  WHEN PV-BIT-IDX = 10                            09948806
099489                    SET PV-BIT-IDX DOWN BY +1                     09948906
099490              END-EVALUATE                                        09949006
099491                                                                  09949106
099492              MOVE EP220-N-RCPT-RT-UNT-RTL-AMT  TO                09949206
099493                                          PV-VARIABLE-OUTPUT-FIELD09949306
099494                                                                  09949406
099495              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09949506
099496                FROM PV-BIT-IDX  BY 1                             09949606
099497                 UNTIL PV-EOF-IDX > 11                            09949706
099498        END-EVALUATE                                              09949806
099499     END-IF.                                                      09949906
099500                                                                  09950006
099501     PERFORM 2600-MOVE-DELIMITER.                                 09950106
099502                                                                  09950206
099503**----  MOVE GP-RTL-AMT --------------- NULL ---------------**    09950306
099504                                                                  09950406
099505     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09950506
099506     INITIALIZE PV-TALLY.                                         09950606
099507                                                                  09950706
099508     IF EP220-GP-RTL-AMT-YES                                      09950806
099509        EVALUATE TRUE                                             09950906
099510           WHEN EP220-GP-RTL-AMT-NUL = '~'                        09951006
099511             PERFORM 2900-MOVE-NULL-VALUE                         09951106
099512           WHEN EP220-GP-RTL-AMT = ZEROES                         09951206
099513              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09951306
099514              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09951406
099515                FROM 1 BY 1                                       09951510
099516                  UNTIL PV-EOF-IDX > 3                            09951606
099517           WHEN OTHER                                             09951706
099518             INSPECT EP220-GP-RTL-AMT TALLYING PV-TALLY           09951806
099519              FOR LEADING ZEROES                                  09951906
099520              SET PV-BIT-IDX TO PV-TALLY                          09952006
099521                                                                  09952106
099522              EVALUATE TRUE                                       09952206
099523                  WHEN PV-BIT-IDX < 9                             09952306
099524                    SET PV-BIT-IDX UP BY +1                       09952406
099525                  WHEN PV-BIT-IDX = 10                            09952506
099526                    SET PV-BIT-IDX DOWN BY +1                     09952606
099527              END-EVALUATE                                        09952706
099528                                                                  09952806
099529              MOVE EP220-GP-RTL-AMT  TO                           09952906
099530                                          PV-VARIABLE-OUTPUT-FIELD09953006
099531                                                                  09953106
099532              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09953206
099533                FROM PV-BIT-IDX  BY 1                             09953306
099534                 UNTIL PV-EOF-IDX > 11                            09953406
099535        END-EVALUATE                                              09953506
099536     END-IF.                                                      09953606
099537                                                                  09953706
099538     PERFORM 2600-MOVE-DELIMITER.                                 09953806
099539                                                                  09953906
099540**----  MOVE LO-UNT-RTL-AMT ----------- NULL ---------------**    09954006
099541                                                                  09954106
099542     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09954206
099543     INITIALIZE PV-TALLY.                                         09954306
099544                                                                  09954406
099545     IF EP220-LO-UNT-RTL-AMT-YES                                  09954506
099546        EVALUATE TRUE                                             09954606
099547           WHEN EP220-LO-UNT-RTL-AMT-NUL = '~'                    09954706
099548             PERFORM 2900-MOVE-NULL-VALUE                         09954806
099549           WHEN EP220-LO-UNT-RTL-AMT = ZEROES                     09954906
099550              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09955006
099551              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09955106
099552                FROM 1 BY 1                                       09955210
099553                  UNTIL PV-EOF-IDX > 3                            09955306
099554           WHEN OTHER                                             09955406
099555             INSPECT EP220-LO-UNT-RTL-AMT TALLYING PV-TALLY       09955506
099556              FOR LEADING ZEROES                                  09955606
099557              SET PV-BIT-IDX TO PV-TALLY                          09955706
099558                                                                  09955806
099559              EVALUATE TRUE                                       09955906
099560                  WHEN PV-BIT-IDX < 9                             09956006
099561                    SET PV-BIT-IDX UP BY +1                       09956106
099562                  WHEN PV-BIT-IDX = 10                            09956206
099563                    SET PV-BIT-IDX DOWN BY +1                     09956306
099564              END-EVALUATE                                        09956406
099565                                                                  09956506
099566              MOVE EP220-LO-UNT-RTL-AMT  TO                       09956606
099567                                          PV-VARIABLE-OUTPUT-FIELD09956706
099568                                                                  09956806
099569              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09956906
099570                FROM PV-BIT-IDX  BY 1                             09957006
099571                 UNTIL PV-EOF-IDX > 11                            09957106
099572        END-EVALUATE                                              09957206
099573     END-IF.                                                      09957306
099574                                                                  09957406
099575     PERFORM 2600-MOVE-DELIMITER.                                 09957506
099576                                                                  09957606
099577**----  MOVE HGH-UNT-RTL-AMT ----------- NULL ---------------**   09957706
099578                                                                  09957806
099579     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09957906
099580     INITIALIZE PV-TALLY.                                         09958006
099581                                                                  09958106
099582     IF EP220-HGH-UNT-RTL-AMT-YES                                 09958206
099583        EVALUATE TRUE                                             09958306
099584           WHEN EP220-HGH-UNT-RTL-AMT-NUL = '~'                   09958406
099585             PERFORM 2900-MOVE-NULL-VALUE                         09958506
099586           WHEN EP220-HGH-UNT-RTL-AMT = ZEROES                    09958606
099587              MOVE '.00' TO PV-VARIABLE-OUTPUT-FIELD              09958706
099588              PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX     09958806
099589                FROM 1 BY 1                                       09958910
099590                  UNTIL PV-EOF-IDX > 3                            09959006
099591           WHEN OTHER                                             09959106
099592             INSPECT EP220-HGH-UNT-RTL-AMT TALLYING PV-TALLY      09959206
099593              FOR LEADING ZEROES                                  09959306
099594              SET PV-BIT-IDX TO PV-TALLY                          09959406
099595                                                                  09959506
099596              EVALUATE TRUE                                       09959606
099597                  WHEN PV-BIT-IDX < 9                             09959706
099598                    SET PV-BIT-IDX UP BY +1                       09959806
099599                  WHEN PV-BIT-IDX = 10                            09959906
099600                    SET PV-BIT-IDX DOWN BY +1                     09960006
099601              END-EVALUATE                                        09960106
099602                                                                  09960206
099603              MOVE EP220-HGH-UNT-RTL-AMT TO                       09960306
099604                                          PV-VARIABLE-OUTPUT-FIELD09960406
099605                                                                  09960506
099606              PERFORM 3000-AMT-FIELD-MOVER VARYING PV-EOF-IDX     09960606
099607                FROM PV-BIT-IDX  BY 1                             09960706
099608                 UNTIL PV-EOF-IDX > 11                            09960806
099609        END-EVALUATE                                              09960906
099610     END-IF.                                                      09961006
099611                                                                  09961106
099612     PERFORM 2600-MOVE-DELIMITER.                                 09961206
099613                                                                  09961306
099614**----  MOVE GP-RTL-QTY--------------- NULL ---------------**     09961406
099615                                                                  09961506
099616     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09961606
099617     INITIALIZE PV-TALLY.                                         09961706
099618                                                                  09961806
099619     EVALUATE TRUE                                                09961906
099620         WHEN EP220-GP-RTL-QTY-YES                                09962006
099621            EVALUATE TRUE                                         09962106
099622               WHEN EP220-GP-RTL-QTY-NUL = '~'                    09962206
099623                  PERFORM 2900-MOVE-NULL-VALUE                    09962306
099624               WHEN EP220-GP-RTL-QTY = ZEROES                     09962406
099625                  PERFORM 3100-MOVE-ZERO                          09962506
099626               WHEN OTHER                                         09962606
099627                 INSPECT EP220-GP-RTL-QTY      TALLYING PV-TALLY  09962706
099628                 FOR LEADING ZEROES                               09962806
099629                 SET PV-BIT-IDX TO PV-TALLY                       09962906
099630                 SET PV-BIT-IDX UP BY +1                          09963006
099631                                                                  09963106
099632                 MOVE EP220-GP-RTL-QTY TO PV-VARIABLE-OUTPUT-FIELD09963208
099633                                                                  09963306
099634                 PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX  09963406
099635                   FROM PV-BIT-IDX  BY 1                          09963506
099636                    UNTIL PV-EOF-IDX > 4                          09963626
099637            END-EVALUATE                                          09963706
099638         WHEN EP220-GP-RTL-QTY-NO                                 09963807
099639              CONTINUE                                            09963906
099640     END-EVALUATE.                                                09964006
099641                                                                  09964106
099642     PERFORM 2600-MOVE-DELIMITER.                                 09964206
099643                                                                  09964306
099644**----  MOVE GP-PRIC-ID--------------- NULL ---------------**     09964407
099645                                                                  09964507
099646     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         09964607
099647     INITIALIZE PV-TALLY.                                         09964707
099648                                                                  09964807
099649     EVALUATE TRUE                                                09964907
099650         WHEN EP220-GP-PRIC-ID-YES                                09965007
099651            EVALUATE TRUE                                         09965107
099652               WHEN EP220-GP-PRIC-ID-NUL = '~'                    09965207
099653                  PERFORM 2900-MOVE-NULL-VALUE                    09965307
099654               WHEN EP220-GP-PRIC-ID = ZEROES                     09965407
099655                  PERFORM 3100-MOVE-ZERO                          09965507
099656               WHEN OTHER                                         09965607
099657                 INSPECT EP220-GP-PRIC-ID      TALLYING PV-TALLY  09965707
099658                 FOR LEADING ZEROES                               09965807
099659                 SET PV-BIT-IDX TO PV-TALLY                       09965907
099660                 SET PV-BIT-IDX UP BY +1                          09966007
099661                                                                  09966107
099662                 MOVE EP220-GP-PRIC-ID TO PV-VARIABLE-OUTPUT-FIELD09966208
099663                                                                  09966307
099664                 PERFORM 2500-NUM-FIELD-MOVER VARYING PV-EOF-IDX  09966407
099665                   FROM PV-BIT-IDX  BY 1                          09966507
099666                    UNTIL PV-EOF-IDX > 10                         09966627
099667            END-EVALUATE                                          09966707
099668         WHEN EP220-GP-PRIC-ID-NO                                 09966807
099669              CONTINUE                                            09966907
099670     END-EVALUATE.                                                09967007
099671                                                                  09967107
099672     PERFORM 2600-MOVE-DELIMITER.                                 09967207
099673                                                                  09967307
099674**----  MOVE LOC-SKU-STAT-CDE------NOT NULL ---------------**     09967407
099675                                                                  09967507
099676     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09967607
099677                                                                  09967707
099678     IF EP220-LOC-SKU-STAT-CDE-YES                                09967807
099679        EVALUATE TRUE                                             09967907
099680           WHEN EP220-LOC-SKU-STAT-CDE = SPACES                   09968007
099681              PERFORM 3200-MOVE-SPACE                             09968107
099682           WHEN OTHER                                             09968207
099683             MOVE EP220-LOC-SKU-STAT-CDE TO PV-VARIABLE-CHAR-FIELD09968307
099684             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09968407
099685               FROM 1  BY 1                                       09968507
099686                 UNTIL PV-CHR-BIT-IDX > 2                         09968607
099687        END-EVALUATE                                              09968707
099688     END-IF.                                                      09968807
099689                                                                  09968907
099690     PERFORM 2600-MOVE-DELIMITER.                                 09969007
099691                                                                  09969107
099692**----  MOVE TKT-CLOR-CDE ------------ NULL ---------------**     09969207
099693                                                                  09969307
099694     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09969407
099695                                                                  09969507
099696     IF EP220-TKT-CLOR-CDE-YES                                    09969607
099697        EVALUATE TRUE                                             09969707
099698           WHEN EP220-TKT-CLOR-CDE = '~'                          09969807
099699              PERFORM 2900-MOVE-NULL-VALUE                        09969907
099700           WHEN EP220-TKT-CLOR-CDE = SPACES                       09970007
099701              PERFORM 3200-MOVE-SPACE                             09970107
099702           WHEN OTHER                                             09970207
099703             MOVE EP220-TKT-CLOR-CDE TO PV-VARIABLE-CHAR-FIELD    09970307
099704             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09970407
099705               FROM 1  BY 1                                       09970507
099706                 UNTIL PV-CHR-BIT-IDX > 1                         09970607
099707        END-EVALUATE                                              09970707
099708     END-IF.                                                      09970807
099709                                                                  09970907
099710     PERFORM 2600-MOVE-DELIMITER.                                 09971007
099711                                                                  09971107
099712**----  MOVE LAST-PRCHG-TMST ----- NOT NULL ---------------**     09971207
099713                                                                  09971307
099714     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09971407
099715                                                                  09971507
099716     IF EP220-LAST-PRCHG-TMST-YES                                 09971607
099717       EVALUATE TRUE                                              09971711
099718           WHEN EP220-LAST-PRCHG-TMST = SPACES                    09971811
099719             PERFORM 3200-MOVE-SPACE                              09971911
099720           WHEN OTHER                                             09972011
099721             MOVE EP220-LAST-PRCHG-TMST TO PV-VARIABLE-CHAR-FIELD 09972111
099722             SET PV-CHR-EOF-IDX TO +19                            09972211
099723             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09972311
099724                FROM 1  BY 1                                      09972411
099725                UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX             09972511
099726       END-EVALUATE                                               09972611
099727     END-IF.                                                      09972707
099728                                                                  09972807
099729     PERFORM 2600-MOVE-DELIMITER.                                 09972907
099730                                                                  09973007
099731**----  MOVE PRMPT-FOR-PRIC-IND ---- NOT NULL ---------------**   09973107
099732                                                                  09973207
099733     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09973307
099734                                                                  09973407
099735     IF EP220-PRMPT-FOR-PRIC-IND-YES                              09973507
099736        MOVE EP220-PRMPT-FOR-PRIC-IND TO PV-VARIABLE-CHAR-FIELD   09973607
099737        SET PV-CHR-EOF-IDX TO +1                                  09973707
099738        PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX       09973807
099739           FROM 1  BY 1                                           09973907
099740           UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                  09974007
099741     END-IF.                                                      09974107
099742                                                                  09974207
099743     PERFORM 2600-MOVE-DELIMITER.                                 09974307
099744                                                                  09974407
099745**----  MOVE PERM-PRCHG-DIRN-CDE ------- NULL ---------------**   09974507
099746                                                                  09974607
099747     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09974707
099748                                                                  09974807
099749     IF EP220-PERM-PRCHG-DIRN-CDE-YES                             09974907
099750        EVALUATE TRUE                                             09975007
099751           WHEN EP220-PERM-PRCHG-DIRN-CDE = '~'                   09975107
099752              PERFORM 2900-MOVE-NULL-VALUE                        09975207
099753           WHEN EP220-PERM-PRCHG-DIRN-CDE = SPACES                09975307
099754              PERFORM 3200-MOVE-SPACE                             09975407
099755           WHEN OTHER                                             09975507
099756             MOVE EP220-PERM-PRCHG-DIRN-CDE TO                    09975607
099757                                    PV-VARIABLE-CHAR-FIELD        09975707
099758             SET PV-CHR-EOF-IDX TO +1                             09975807
099759             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09975907
099760                FROM 1  BY 1                                      09976007
099761                UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX             09976107
099762        END-EVALUATE                                              09976207
099763     END-IF.                                                      09976307
099764                                                                  09976407
099765     PERFORM 2600-MOVE-DELIMITER.                                 09976507
099766                                                                  09976607
099767**----  MOVE MLT-PRPT-IND ---------- NOT NULL ---------------**   09976707
099768                                                                  09976807
099769     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09976907
099770                                                                  09977007
099771     IF EP220-MLT-PRPT-IND-YES                                    09977107
099772        MOVE EP220-MLT-PRPT-IND TO PV-VARIABLE-CHAR-FIELD         09977207
099773        SET PV-CHR-EOF-IDX TO +1                                  09977307
099774        PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX       09977407
099775           FROM 1  BY 1                                           09977507
099776           UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                  09977607
099777     END-IF.                                                      09977707
099778                                                                  09977807
099779     PERFORM 2600-MOVE-DELIMITER.                                 09977907
099780                                                                  09978007
099781**----  MOVE PRCHG-APLBL-TKT-CLOR-CDE--- NULL ---------------**   09978107
099782                                                                  09978207
099783     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           09978307
099784                                                                  09978407
099785     IF EP220-PRCHG-APL-TKT-CLR-CD-Y                              09978507
099786        EVALUATE TRUE                                             09978607
099787           WHEN EP220-PRCHG-APLBL-TKT-CLOR-CDE = '~'              09978707
099788              PERFORM 2900-MOVE-NULL-VALUE                        09978807
099789           WHEN EP220-PRCHG-APLBL-TKT-CLOR-CDE = SPACES           09978907
099790              PERFORM 3200-MOVE-SPACE                             09979007
099791           WHEN OTHER                                             09979107
099792             MOVE EP220-PRCHG-APLBL-TKT-CLOR-CDE TO               09979208
099793                                    PV-VARIABLE-CHAR-FIELD        09979307
099794             SET PV-CHR-EOF-IDX TO +2                             09979407
099795             PERFORM 2550-CHR-FIELD-MOVER VARYING PV-CHR-BIT-IDX  09979507
099796                FROM 1  BY 1                                      09979607
099797                UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX             09979707
099798        END-EVALUATE                                              09979807
099799     END-IF.                                                      09979907
099800                                                                  09980007
099801     PERFORM 2600-MOVE-DELIMITER.                                 09980107
099802                                                                  09980207
099803**-- WRITE THE FORMATTED DATA RECORD                              09980307
099804                                                                  09980407
099805     PERFORM 2700-WRITE-DATA-RECORD.                              09980507
099806                                                                  09980607
099807*2300-EXIT.                                                       09980707
099809                                                                  09980907
099810*-----------------------------------------------------------------09981007
099811* 2400-MOVE-TRIGGER-TYPE                                          09981107
099812*  THIS PARAGRAPH WILL MOVE TRIGGER TYPE TO OUTPUT FILE VARIABLE  09981207
099813*----------------------------------------------------------------*09981307
099814 2400-MOVE-TRIGGER-TYPE.                                          09981407
099815                                                                  09981507
099816     MOVE EP220-RECORD-ACTION                                     09981607
099817       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       09981707
099818     SET FORM-SKU-PR-LEN                                          09981807
099819       UP BY +1.                                                  09981907
099820     ADD 1                                                        09982007
099821       TO PV-BYTE-COUNT.                                          09982107
099822     PERFORM 2600-MOVE-DELIMITER.                                 09982207
099823                                                                  09982307
099824*2400-EXIT.                                                       09982407
099826                                                                  09982607
099827*----------------------------------------------------------       09982707
099828* 2500-NUM-FIELD-MOVER                                            09982807
099829*     THIS PARAGRAPH MOVES A BIT OF DATA TO THE OUTPUT FILE RECORD09982907
099830*----------------------------------------------------------       09983007
099831 2500-NUM-FIELD-MOVER.                                            09983107
099832                                                                  09983207
099833     MOVE PV-BIT-VARIABLE(PV-EOF-IDX)                             09983307
099834       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       09983407
099835     SET FORM-SKU-PR-LEN                                          09983507
099836       UP BY +1.                                                  09983607
099837     ADD 1                                                        09983707
099838       TO PV-BYTE-COUNT.                                          09983807
099839                                                                  09983907
099840*2500-EXIT.                                                       09984007
099842                                                                  09984207
099843*----------------------------------------------------------       09984307
099844* 2550-CHR-FIELD-MOVER                                            09984407
099845*     THIS PARAGRAPH MOVES A BIT OF DATA TO THE OUTPUT FILE RECORD09984507
099846*----------------------------------------------------------       09984607
099847 2550-CHR-FIELD-MOVER.                                            09984707
099848                                                                  09984807
099849     MOVE PV-BIT-CHR-VARIABLE(PV-CHR-BIT-IDX)                     09984907
099850       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       09985007
099851     SET FORM-SKU-PR-LEN                                          09985107
099852       UP BY +1.                                                  09985207
099853     ADD 1                                                        09985307
099854       TO PV-BYTE-COUNT.                                          09985407
099855                                                                  09985507
099856*2550-EXIT.                                                       09985607
099858                                                                  09985807
099859*-----------------------------------------------------------------09985907
099860* 2600-MOVE-DELIMITER.                                            09986007
099861*  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE       09986107
099862*----------------------------------------------------------------*09986207
099863 2600-MOVE-DELIMITER.                                             09986307
099864                                                                  09986407
099865     MOVE PC-CSV-DELIMITER                                        09986507
099866       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       09986607
099867     SET FORM-SKU-PR-LEN                                          09986707
099868       UP BY +1.                                                  09986807
099869     ADD 1                                                        09986907
099870       TO PV-BYTE-COUNT.                                          09987007
099871                                                                  09987107
099872*2600-EXIT.                                                       09987207
099874                                                                  09987407
099875*-----------------------------------------------------------------09987507
099876* 2700-WRITE-DATA-RECORD                                          09987607
099877*  THIS PARAGRAPH WILL WRITE THE DATA RECORD TO THE O/P FILE      09987707
099878*-----------------------------------------------------------------09987807
099879 2700-WRITE-DATA-RECORD.                                          09987907
099880                                                                  09988007
099881     WRITE FORMATTED-SKU-PRICG-REC.                               09988107
099882                                                                  09988207
099883     ADD 1 TO PV-DATA-REC-WRITEN.                                 09988307
099890                                                                  09989007
099900*2700-EXIT.                                                       09990000
100100                                                                  10010000
100200*-------------------------------------------------------------    10020000
100300* 2800-FIND-DATA-END.                                             10030000
100400*  THIS PARAGRAPH IS USED IN A LOOP TO DETERMINE THE LENGTH OF    10040000
100500*  THE STRING.                                                    10050000
100600*-------------------------------------------------------------    10060000
100700 2800-FIND-DATA-END.                                              10070000
100800                                                                  10080000
100900     MOVE ' '                                                     10090000
101000       TO PV-SPACE.                                               10100000
101100                                                                  10110000
101200*2800-EXIT.                                                       10120000
101400                                                                  10140000
101500*-----------------------------------------------------------------10150000
101600* 2900-MOVE-NULL-VALUE                                            10160000
101700*  THIS PARAGRAPH WILL MOVE '~' TO THE OUTPUT FILE VARIABLE       10170000
101800*----------------------------------------------------------------*10180000
101900 2900-MOVE-NULL-VALUE.                                            10190000
102000                                                                  10200000
102100     MOVE PC-NULL-VALUE                                           10210000
102200       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       10220001
102300     SET FORM-SKU-PR-LEN                                          10230001
102400       UP BY +1.                                                  10240000
102500     ADD 1                                                        10250000
102600       TO PV-BYTE-COUNT.                                          10260000
102700                                                                  10270000
103000*2900-EXIT.                                                       10300000
103200                                                                  10320000
103300*----------------------------------------------------------       10330006
103400* 3000-AMT-FIELD-MOVER                                            10340006
103500*     THIS PARAGRAPH IS USED TO MOVE A BIT VALUE FROM INPUT       10350006
103510*     TO THE OUTPUT RECORD, WHERE THE INPUT FIELD IS 9(09)V99     10351006
103520*     DECIMAL AMOUNT, DECIMAL POINT IS SPECIFICALLY MOVED         10352006
103530*     TO FORMAT THE AMOUNT FIELD CORRECTLY.                       10353006
103600*----------------------------------------------------------       10360006
103700 3000-AMT-FIELD-MOVER.                                            10370006
103800                                                                  10380006
103810     IF PV-EOF-IDX = 9                                            10381006
103900       MOVE PV-BIT-VARIABLE(PV-EOF-IDX)                           10390006
104000         TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN)                      10400006
104001                                                                  10400106
104002       SET FORM-SKU-PR-LEN                                        10400206
104003         UP BY +1                                                 10400306
104005       ADD 1                                                      10400506
104006         TO PV-BYTE-COUNT                                         10400606
104007                                                                  10400706
104008       MOVE '.'  TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN)              10400806
104009     ELSE                                                         10400906
104010       MOVE PV-BIT-VARIABLE(PV-EOF-IDX)                           10401006
104020         TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN)                      10402006
104030     END-IF.                                                      10403006
104040                                                                  10404006
104100     SET FORM-SKU-PR-LEN                                          10410006
104200       UP BY +1.                                                  10420006
104300     ADD 1                                                        10430006
104400       TO PV-BYTE-COUNT.                                          10440006
104500                                                                  10450006
104600*3000-EXIT.                                                       10460006
105000                                                                  10500006
105100*-----------------------------------------------------------------10510006
105200* 3100-MOVE-ZERO                                                  10520006
105300*  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE       10530006
105400*----------------------------------------------------------------*10540006
105500 3100-MOVE-ZERO.                                                  10550006
105600                                                                  10560006
105700     MOVE PC-ONE-ZERO                                             10570006
105800       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       10580007
105900     SET FORM-SKU-PR-LEN                                          10590007
106000       UP BY +1.                                                  10600006
106100     ADD 1                                                        10610006
106200       TO PV-BYTE-COUNT.                                          10620006
106300                                                                  10630006
106600*3100-EXIT.                                                       10660006
106800*-----------------------------------------------------------------10680007
106900* 3200-MOVE-SPACE                                                 10690007
107000*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       10700007
107100*----------------------------------------------------------------*10710007
107200 3200-MOVE-SPACE.                                                 10720007
107300                                                                  10730007
107400     MOVE PC-ONE-SPACE                                            10740007
107500       TO FORM-SKU-PR-FLD(FORM-SKU-PR-LEN).                       10750007
107600     SET FORM-SKU-PR-LEN                                          10760007
107700       UP BY +1.                                                  10770007
107800     ADD 1                                                        10780007
107900       TO PV-BYTE-COUNT.                                          10790007
108000                                                                  10800007
108400*3200-EXIT.                                                       10840007
108600                                                                  10860007
212610******************************************************************21261022
212620* 5100-CALC-TIME.                                                 21262022
212630*     ADD 1 SECOND TO TIME FOR EACH HEADER RECORD WRITTEN         21263022
212640******************************************************************21264022
212650 5100-CALC-TIME.                                                  21265022
212660                                                                  21266022
212670     MOVE PV-TIME-CALC TO PV-TIME.                                21267022
212680                                                                  21268022
212690     IF PV-TIME-SS = 59                                           21269022
212691        IF PV-TIME-MM = 59                                        21269122
212692           IF PV-TIME-HH = 24                                     21269222
212693              MOVE ZEROES TO PV-TIME-HH                           21269322
212694           ELSE                                                   21269422
212695              ADD +1 TO PV-TIME-HH                                21269522
212696           END-IF                                                 21269622
212697           MOVE ZEROES TO PV-TIME-MM                              21269722
212698        ELSE                                                      21269822
212699           ADD +1 TO PV-TIME-MM                                   21269922
212700        END-IF                                                    21270022
212701        MOVE ZEROES TO PV-TIME-SS                                 21270122
212702     ELSE                                                         21270222
212703        ADD +1 TO PV-TIME-SS                                      21270322
212704     END-IF.                                                      21270422
212705                                                                  21270522
212706     MOVE PV-TIME TO PV-TIME-CALC.                                21270622
212707                                                                  21270722
212709                                                                  21270922
212710*----------------------------------------------------------       21271000
212800* 6000-READ-SKU-FILE                                              21280000
212900*     THIS PARAGRAPH READS DATA FROM SKU-PRICG-FILE INTO          21290001
213000*     COPYBOOK EPRD219                                            21300000
213100*----------------------------------------------------------       21310000
213200 6000-READ-SKU-FILE.                                              21320000
213300                                                                  21330000
213400     READ SKU-PRICG-FILE                                          21340001
213500         INTO EP220-XST-SKU-PRICG-RECORD                          21350001
213600     AT END                                                       21360000
213700         SET PS-END-OF-SKUPR-FILE TO TRUE                         21370002
213800     END-READ.                                                    21380000
213910                                                                  21391000
213920     IF PS-NOT-END-SKUPR-FILE                                     21392002
213921        ADD +1 TO PV-RECORDS-READ                                 21392132
213930        MOVE 0 TO PV-PIPE-COUNT                                   21393000
213940        PERFORM 6100-CHECK-INP01-FOR-PIPES                        21394000
213950     END-IF.                                                      21395000
213960                                                                  21396000
214000*6000-EXIT.                                                       21400000
214200                                                                  21420000
214300*----------------------------------------------------------       21430000
214400* 6100-CHECK-INP01-FOR-PIPES                                      21440000
214500*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 21450000
214600*     REPLACES PIPES WITH SPACE.                                  21460000
214700*----------------------------------------------------------       21470000
214800 6100-CHECK-INP01-FOR-PIPES.                                      21480000
214900                                                                  21490000
215000     INSPECT EP220-XST-SKU-PRICG-RECORD                           21500006
215100          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     21510000
215200                                                                  21520000
215300     IF PV-PIPE-COUNT > 0                                         21530000
215400        INSPECT EP220-XST-SKU-PRICG-RECORD                        21540006
215500            REPLACING ALL '|'  BY  ' '                            21550000
215600        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'  21560000
215700                ' | WITH A SPACE '                                21570000
215800        DISPLAY EP220-XST-SKU-PRICG-RECORD                        21580006
215900     END-IF.                                                      21590000
216000                                                                  21600000
216100*6100-EXIT.                                                       21610000
253400******************************************************************25340000
253500*     CLOSES ALL FILES AND DISPLAYS ANY NEEDED INFORMATION.      *25350000
253600******************************************************************25360000
253700 9200-WRAPUP.                                                     25370000
253800     MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.25380000
253900                                                                  25390000
254000     PERFORM 9920-DISPLAY-TOTALS.                                 25400000
254100                                                                  25410000
254200     DISPLAY '****************************************'.          25420000
254300     DISPLAY '**          EPKUT219 END              **'.          25430001
254400     DISPLAY '****************************************'.          25440000
254500                                                                  25450000
254600     CLOSE SKU-PRICG-FILE                                         25460016
254700           CC-FILE-TYPE                                           25470016
254710           CC-TODAYS-DATE.                                        25471017
255100                                                                  25510000
255200     CLOSE FORMATTED-SKU-PRICG-FL.                                25520001
255300                                                                  25530000
255400*9200-EXIT.  EXIT.                                                25540000
257300                                                                  25730000
257400******************************************************************25740000
257500*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.              *   25750000
257600******************************************************************25760000
257700 9910-ABEND.                                                      25770000
257800                                                                  25780000
257900     PERFORM 9920-DISPLAY-TOTALS.                                 25790000
258000                                                                  25800000
258100     DISPLAY '** ABEND           **'.                             25810000
258200     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          25820000
258300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        25830000
258400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       25840000
258500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       25850000
258600                                                                  25860000
258700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         25870000
258800                                                                  25880000
258900*9910-EXIT.  EXIT.                                                25890000
259000******************************************************************25900000
259100*     DISPLAY END OF JOB TOTALS                                  *25910000
259200******************************************************************25920000
259300 9920-DISPLAY-TOTALS.                                             25930000
259400                                                                  25940000
259500     DISPLAY '****************************************'.          25950000
259600     DISPLAY '** STATISTICS FOR SKU PRICING FILE    **'.          25960013
259800     DISPLAY '****************************************'.          25980000
259900                                                                  25990000
260000     DISPLAY '**      EXTRACT RECORDS READ  ====> '               26000013
260100             PV-RECORDS-READ                                      26010000
260200             ' **'.                                               26020000
260210     DISPLAY '**      HEADER RECORDS WRITEN ====> '               26021013
260220             PV-HDR-REC-WRITEN                                    26022000
260230             ' **'.                                               26023000
260300     DISPLAY '**      DETAIL RECORDS WRITEN ====> '               26030013
260400             PV-DATA-REC-WRITEN                                   26040000
260500             ' **'.                                               26050000
261200     DISPLAY '****************************************'.          26120000
261300                                                                  26130000
261400*9920-EXIT.  EXIT.                                                26140000
261500                                                                  26150000
