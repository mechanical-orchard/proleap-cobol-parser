000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.     TMKUT023.                                        00020049
000300 AUTHOR.         AL PETERS.    .                                  00030049
000400 DATE-WRITTEN.   06/04/2008.                                      00040049
000500 DATE-COMPILED.                                                   00050002
000600***************************************************************** 00060002
001000*                                                               * 00100002
001100*  CREATE FILE OF ALL DAILY UNRESOLVED NODISTRO TROUBLE RECORDS * 00110049
001200*  AND FORMAT THEM INTO AN OUTPUT FILE THAT CAN BE FTP'D        * 00120049
001300*  TO THE SERVER.                                               * 00130039
001400*                                                               * 00140002
      * CHANGE LOG:                                                   * 00141076
      *  09/26/2022  JEAN KURK  RECOMPILE FOR COBOL UPGRADE           * 00142076
      *                                CHG0274597                     * 00143076
001500***************************************************************** 00150002
002100                                                                  00210002
002200 ENVIRONMENT DIVISION.                                            00220002
002300 CONFIGURATION SECTION.                                           00230002
002400 SOURCE-COMPUTER.    IBM-3090.                                    00240002
002500 OBJECT-COMPUTER.    IBM-3090.                                    00250002
002600                                                                  00260002
002700 INPUT-OUTPUT SECTION.                                            00270002
002800 FILE-CONTROL.                                                    00280002
002900     SELECT NODISTRO-FILE        ASSIGN TO OUT01.                 00290049
003000                                                                  00300002
003100 DATA DIVISION.                                                   00310002
003200 FILE SECTION.                                                    00320002
003300                                                                  00330002
003400 FD  NODISTRO-FILE                                                00340049
003500     RECORDING MODE IS F                                          00350002
003600     LABEL RECORDS ARE STANDARD                                   00360002
003700     DATA RECORD IS NODISTRO-REC.                                 00370049
003800                                                                  00380043
003900 01  NODISTRO-REC                PIC X(114).                      00390075
004000                                                                  00400043
004100 WORKING-STORAGE SECTION.                                         00410002
004110                                                                  00411051
004120*----------------------------------------------------------------*00412051
004130*  OUTPUT LAYOUT FOR DELIMITED FILE                              *00413062
004140*----------------------------------------------------------------*00414051
004150     COPY TMRD009.                                                00415051
004160                                                                  00416051
004200                                                                  00420002
006400 01  PV-PROGRAM-VARIABLES.                                        00640002
006500     05  FILLER                  PIC  X(31)  VALUE                00650033
006600         '** BEGINNING OF TMKUT023 W/S **'.                       00660049
006700     05  PV-PROGRAM-NAME         PIC  X(08)  VALUE 'TMKUT023'.    00670049
006800     05  PV-CURRENT-DATE.                                         00680002
006900         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00690002
007000         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00700002
007100         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00710002
007200     05  PV-CURRENT-TIME.                                         00720002
007300         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00730002
007400         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00740002
007500         10  FILLER              PIC  9(02)  VALUE ZEROS.         00750002
007600     05  PV-NOTIF-TMST           PIC  X(26)  VALUE SPACES.        00760052
007700     05  PV-NOTIF-TMST-R1 REDEFINES PV-NOTIF-TMST.                00770052
007800         10  PV-NOTIF-DATE       PIC  X(10).                      00780052
007900         10  PV-NOTIF-HHMMSS     PIC  X(16).                      00790052
008000     05  PV-ARRIVE-TMST          PIC  X(26)  VALUE SPACES.        00800052
008100     05  PV-ARRIVE-TMST-R1 REDEFINES PV-ARRIVE-TMST.              00810052
008200         10  PV-ARRIVE-DATE      PIC  X(10).                      00820052
008300         10  PV-ARRIVE-HHMMSS    PIC  X(16).                      00830052
008310                                                                  00831049
008400     05  PV-PURCHS-PO-NBR             PIC  S9(9) COMP.            00840049
008410     05  PV-PURCHS-DEPT-NBR           PIC  X(3).                  00841072
008500     05  PV-PURCHS-PO-TYP-CDE         PIC  X(2).                  00850049
008510     05  PV-PURCHS-TOT-UNT-QTY        PIC  S9(9) COMP.            00851049
008520     05  PV-PURCHS-TOT-RTL-AMT        PIC  S9(8)V9(2) COMP-3.     00852054
008530     05  PV-PURCHS-OTB-PER-NBR        PIC  X(6).                  00853049
008540     05  PV-PURCHS-SEASET-SHRT-NM     PIC  X(5).                  00854049
008550     05  PV-PURCHS-SEASET-YR          PIC  X(4).                  00855049
008560     05  PV-ENTNME-ENT-NAME-DESC      PIC  X(30).                 00856049
008570     05  PV-TRBNTF-NOTIF-TMST         PIC  X(26).                 00857049
008580     05  PV-RECEIV-REC-TMST           PIC  X(26).                 00858049
008600                                                                  00860022
008610     05  PV-COMMA                     PIC  X(01)  VALUE ','.      00861066
008620                                                                  00862066
008700 01  PC-COUNTERS.                                                 00870056
008800     05  PC-COUNT-NODIST-REC-READ    PIC 9(07)    VALUE ZEROS.    00880056
008810     05  PC-COUNT-REC-WRITTEN        PIC 9(07)    VALUE ZEROS.    00881056
008900                                                                  00890056
009100 01  PS-PROGRAM-SWITCHES.                                         00910022
009200     05  PS-END-OF-NODIST-SW     PIC X(01)        VALUE 'N'.      00920052
009300         88  MORE-NODIST-CSR                      VALUE 'N'.      00930052
009400         88  END-OF-NODIST-CSR                    VALUE 'Y'.      00940052
009500                                                                  00950022
009600*----------------------------------------------------------------*00960022
009700*  COMMUNICATIONS AREA2 FOR DB2                                  *00970022
009800*----------------------------------------------------------------*00980022
009900     COPY SQLCA2.                                                 00990022
010000                                                                  01000022
010100     EXEC SQL                                                     01010022
010200          INCLUDE SQLCA                                           01020022
010300     END-EXEC.                                                    01030022
010400                                                                  01040022
010500*----------------------------------------------------------------*01050022
010600*  PURCHASE ORDER TABLE                                          *01060049
010700*----------------------------------------------------------------*01070022
010800     EXEC SQL                                                     01080022
010900          INCLUDE TPURCHS                                         01090049
011000     END-EXEC.                                                    01100022
011100                                                                  01110022
011200*----------------------------------------------------------------*01120022
011300*  RECEIVERS TABLE                                               *01130030
011400*----------------------------------------------------------------*01140022
011500     EXEC SQL                                                     01150022
011600          INCLUDE TRECEIV                                         01160030
011700     END-EXEC.                                                    01170022
011800                                                                  01180022
011900*----------------------------------------------------------------*01190030
012000*  TROUBLE NOTIFY TABLE                                          *01200049
012100*----------------------------------------------------------------*01210030
012200     EXEC SQL                                                     01220030
012300          INCLUDE TTRBNTF                                         01230049
012400     END-EXEC.                                                    01240030
012500                                                                  01250030
012600*----------------------------------------------------------------*01260030
012700*  NAME TABLE                                                    *01270049
012800*----------------------------------------------------------------*01280030
012900     EXEC SQL                                                     01290030
013000          INCLUDE TENTNME                                         01300049
013100     END-EXEC.                                                    01310030
013200                                                                  01320030
014000*----------------------------------------------------------------*01400022
014100*   NODIST_CSR SELECTS ALL UNRESOLVED NODISTRO TROUBLE           *01410049
014300*----------------------------------------------------------------*01430022
014400     EXEC SQL                                                     01440042
014500       DECLARE NODIST_CSR CURSOR FOR                              01450049
014600         SELECT DISTINCT                                          01460049
014610                A.PO_NBR                                          01461049
014700              , MIN(DATE(B.NOTIF_TMST))                           01470049
014800              , MIN(DATE(D.REC_TMST))                             01480049
014900              , C.ENT_NAME_DESC                                   01490049
014910              , A.PO_TYP_CDE                                      01491049
014920              , A.DEPT_NBR                                        01492049
014930              , A.TOT_UNT_QTY                                     01493049
014940              , A.TOT_VAL_RTL_AMT                                 01494049
014950              , A.OTB_PER_NBR                                     01495049
014960              , A.SEASET_SHRT_NM                                  01496049
014970              , A.SEASET_YR                                       01497049
015000           FROM TPURCHS A                                         01500049
015100              , TTRBNTF B                                         01510049
015200              , TENTNME C                                         01520049
015300              , TRECEIV D                                         01530049
015400         WHERE A.VER_STATUS_CDE = 'A'                             01540049
015500           AND A.STATUS_CDE    IN ('AC', 'AP')                    01550049
015600           AND B.PO_NBR         = A.PO_NBR                        01560049
015700           AND B.TRBL_RSN_CDE  IN (221,222)                       01570049
015800           AND DATE(B.RESOLVED_TMST) = '9999-09-09'               01580049
015900           AND C.ENT_ID         = A.ENT_ID                        01590049
016000           AND C.TYPE_CDE       = '01'                            01600049
016100           AND D.VER_STATUS_CDE = 'A'                             01610049
016200           AND D.ORD_NBR        = A.PO_NBR                        01620049
016300           AND D.VER_STATUS_CDE = 'A'                             01630049
016400           AND D.REC_SEQ_NBR    = B.REC_SEQ_NBR                   01640049
016500         GROUP BY                                                 01650042
016600               A.PO_NBR                                           01660049
016700             , C.ENT_NAME_DESC                                    01670049
016710             , A.PO_TYP_CDE                                       01671049
016720             , A.DEPT_NBR                                         01672049
016730             , A.TOT_UNT_QTY                                      01673049
016740             , A.TOT_VAL_RTL_AMT                                  01674049
016750             , A.OTB_PER_NBR                                      01675049
016760             , A.SEASET_SHRT_NM                                   01676049
016770             , A.SEASET_YR                                        01677049
016780         ORDER BY 1,2                                             01678067
016800     END-EXEC.                                                    01680042
016900                                                                  01690042
017000*----------------------------------------------------------------*01700022
017100*  ABEND DATA AREAS                                              *01710022
017200*----------------------------------------------------------------*01720022
017300 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          01730022
017400                                             COMP SYNC.           01740022
017500     88  AC-BAD-DATA                         VALUE +4003.         01750022
017600     88  AC-DB2-ERROR                        VALUE +4013.         01760022
017700                                                                  01770022
017800 01  ABEND-AREAS.                                                 01780022
017900     05  AA-ABEND-TMK            PIC  X(40)  VALUE                01790061
018000             '*****       ABEND'.                                 01800022
018100     05  AA-PROGRAM-TMK          PIC  X(40)  VALUE                01810061
018200             '*****   PROGRAM: TMKUT023'.                         01820049
018300     05  AA-PARAGRAPH-TMK.                                        01830061
018400         10  FILLER              PIC  X(17)  VALUE                01840022
018500             '***** PARAGRAPH: '.                                 01850022
018600         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        01860022
018700     05  AA-MESSAGE-LINE.                                         01870022
018800         10  FILLER              PIC  X(06)  VALUE '*****'.       01880022
018900         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        01890022
019000     05  AA-DB2-ERROR-TMK        PIC  X(40)  VALUE                01900061
019100             '*****    DB2 ERROR'.                                01910022
019200     05  AA-DB2-OPERATION-TMK.                                    01920061
019300         10  FILLER              PIC  X(17)  VALUE                01930022
019400             '***** OPERATION: '.                                 01940022
019500         10  AA-DB2-OPERATION.                                    01950022
019600             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        01960022
019700             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        01970022
019800     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        01980022
019900     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        01990022
020000     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        02000022
020100     05  AA-DB2-TABLE-4          PIC  X(08)  VALUE SPACES.        02010032
020200                                                                  02020022
020300     COPY DPWS004.                                                02030022
020400 01  FILLER                      PIC  X(25)  VALUE                02040022
020500     '** END OF TMKUT023 W/S **'.                                 02050049
020600                                                                  02060022
020700 PROCEDURE DIVISION.                                              02070022
020800                                                                  02080042
020900 A100-MAIN.                                                       02090022
021000     PERFORM B100-INITIALIZATION.                                 02100022
021100                                                                  02110022
021200     PERFORM B200-PROCESS-NODISTRO-REC                            02120052
021300       UNTIL END-OF-NODIST-CSR.                                   02130055
021400                                                                  02140022
021500     PERFORM B300-END-PROGRAM.                                    02150022
021600                                                                  02160022
021700     GOBACK.                                                      02170022
021800                                                                  02180022
021900 B100-INITIALIZATION.                                             02190022
022000*----------------------------------------------------------------*02200022
022100*    OPEN OUTPUT FILE AND PERFORM INITIALIZATION.                *02210022
022200*----------------------------------------------------------------*02220022
022300     OPEN OUTPUT NODISTRO-FILE.                                   02230051
022400                                                                  02240022
022500     INITIALIZE DCLTRECEIV                                        02250031
022600                DCLTPURCHS                                        02260031
022700                DCLTTRBNTF                                        02270051
022800                DCLTENTNME                                        02280051
022900                NODISTRO-REC.                                     02290051
023000                                                                  02300022
023100     PERFORM Y100-OPEN-NODIST-CSR.                                02310051
023200                                                                  02320051
023300     PERFORM R100-FETCH-NODIST-REC.                               02330053
023400     IF END-OF-NODIST-CSR                                         02340052
023500         DISPLAY '***  TMKUT023   ***'                            02350051
023600         DISPLAY 'FIRST FETCH OF NODIST CURSOR      '             02360052
023700         DISPLAY 'NO NODIST RECORDS FOUND           '             02370052
023800         DISPLAY ' '                                              02380051
023900     END-IF.                                                      02390051
025000                                                                  02500022
025100 B200-PROCESS-NODISTRO-REC.                                       02510051
025200*----------------------------------------------------------------*02520022
025300*    CREATING OUTPUT FILE BY MOVING FIELDS FETCHED INTO THEIR    *02530022
025400*    CORRESPONDING COPYBOOK FIELDS.                              *02540022
025500*----------------------------------------------------------------*02550022
025600     INITIALIZE TM009-NODIS-TRBL-RECORD.                          02560051
025700                                                                  02570022
025800     MOVE PV-PURCHS-PO-NBR         TO TM009-PO-NBR.               02580052
026000     MOVE PV-TRBNTF-NOTIF-TMST     TO PV-NOTIF-TMST.              02600052
026010     MOVE PV-NOTIF-DATE            TO TM009-NOTIFY-TMST.          02601052
026100     MOVE PV-RECEIV-REC-TMST       TO PV-ARRIVE-TMST.             02610052
026200     MOVE PV-ARRIVE-DATE           TO TM009-ARRIVE-TMST.          02620052
026300     MOVE PV-ENTNME-ENT-NAME-DESC  TO TM009-NAME-DESC.            02630052
026400     MOVE PV-PURCHS-PO-TYP-CDE     TO TM009-PO-TYP-CDE.           02640052
026500     MOVE PV-PURCHS-DEPT-NBR       TO TM009-DEPT-NBR.             02650075
026600     MOVE PV-PURCHS-TOT-UNT-QTY    TO TM009-TOT-UNT-QTY.          02660052
026610     MOVE PV-PURCHS-TOT-RTL-AMT    TO TM009-TOT-RTL-AMT.          02661052
026620     MOVE PV-PURCHS-OTB-PER-NBR    TO TM009-OTB.                  02662052
026630     MOVE PV-PURCHS-SEASET-SHRT-NM TO TM009-SEASET-SHRT-NM.       02663052
026640     MOVE PV-PURCHS-SEASET-YR      TO TM009-SEASET-YR.            02664052
026641     MOVE PV-COMMA                 TO TM009-COMMA-01              02664166
026650                                      TM009-COMMA-02              02665066
026660                                      TM009-COMMA-03              02666066
026670                                      TM009-COMMA-04              02667066
026680                                      TM009-COMMA-05              02668066
026690                                      TM009-COMMA-06              02669066
026700                                      TM009-COMMA-07              02670066
026710                                      TM009-COMMA-08              02671066
026720                                      TM009-COMMA-09              02672066
026730                                      TM009-COMMA-10              02673066
026740                                      TM009-COMMA-11.             02674066
026750                                                                  02675066
026800     PERFORM W100-WRITE-NODIST-REC.                               02680058
026900                                                                  02690059
027000     PERFORM R100-FETCH-NODIST-REC.                               02700053
027100                                                                  02710022
027200 B300-END-PROGRAM.                                                02720022
027300*----------------------------------------------------------------*02730022
027400*    ENDING PROCESSING: DISPLAYS COUNTS, AND CLOSES FILES.       *02740022
027500*----------------------------------------------------------------*02750022
027600     CLOSE NODISTRO-FILE.                                         02760052
027700                                                                  02770022
027800     DISPLAY '       '                                            02780022
027900     DISPLAY '**********************************'                 02790022
028000     DISPLAY '******** TMKUT023 SUMMARY ********'.                02800052
028300     DISPLAY 'NODISTO RECS FETCHED   = '                          02830052
028400                                       PC-COUNT-NODIST-REC-READ.  02840053
028500     DISPLAY 'TOTAL RECORDS WRITTEN  = '                          02850026
028600                                       PC-COUNT-REC-WRITTEN.      02860053
028700     DISPLAY '**********************************'                 02870026
028800     DISPLAY '       '                                            02880026
028900                                                                  02890026
029000     PERFORM Y200-CLOSE-NODIST-CSR.                               02900052
029100                                                                  02910026
029200 R100-FETCH-NODIST-REC.                                           02920053
029300*----------------------------------------------------------------*02930026
029400*  RETRIEVES THE NODIST_CSR DATA                                 *02940052
029500*----------------------------------------------------------------*02950026
029600     EXEC SQL                                                     02960042
029700         FETCH   NODIST_CSR                                       02970052
029800          INTO  :PV-PURCHS-PO-NBR                                 02980052
029900               ,:PV-TRBNTF-NOTIF-TMST                             02990052
030000               ,:PV-RECEIV-REC-TMST                               03000052
030100               ,:PV-ENTNME-ENT-NAME-DESC                          03010052
030110               ,:PV-PURCHS-PO-TYP-CDE                             03011052
030120               ,:PV-PURCHS-DEPT-NBR                               03012052
030130               ,:PV-PURCHS-TOT-UNT-QTY                            03013052
030140               ,:PV-PURCHS-TOT-RTL-AMT                            03014052
030150               ,:PV-PURCHS-OTB-PER-NBR                            03015052
030160               ,:PV-PURCHS-SEASET-SHRT-NM                         03016052
030170               ,:PV-PURCHS-SEASET-YR                              03017052
030200     END-EXEC.                                                    03020042
030300                                                                  03030041
030400     EVALUATE TRUE                                                03040026
030500         WHEN SQLCODE = ZERO                                      03050026
030600             ADD 1 TO PC-COUNT-NODIST-REC-READ                    03060053
030700         WHEN SQLCODE = +100                                      03070026
030800             SET END-OF-NODIST-CSR TO TRUE                        03080052
030900                                                                  03090026
031000         WHEN SQLWARN0 NOT = SPACES                               03100026
031100         WHEN SQLCODE  NOT = ZERO                                 03110026
031200             MOVE 'R100-FETCH-NODIST-REC'                         03120053
031300                                        TO AA-PARAGRAPH-NAME      03130026
031400             MOVE 'UNSUCCESSFUL FETCH WITH NODIST_CSR'            03140052
031500                                        TO AA-DB2-OPERATION       03150026
031600             MOVE 'TRECEIV'             TO AA-DB2-TABLE-1         03160032
031700             MOVE 'TPURCHS'             TO AA-DB2-TABLE-2         03170032
031800             MOVE 'TTRBNTF'             TO AA-DB2-TABLE-3         03180052
031900             MOVE 'TENTNME'             TO AA-DB2-TABLE-4         03190052
032000             PERFORM Z998-DB2-ABEND                               03200026
032100     END-EVALUATE.                                                03210026
032200                                                                  03220026
035500                                                                  03550026
035600 W100-WRITE-NODIST-REC.                                           03560053
035700*----------------------------------------------------------------*03570026
035800*    WRITE THE NODISTRO RECORDS TO THE FILE                      *03580052
035900*----------------------------------------------------------------*03590026
036000                                                                  03600026
036100     WRITE NODISTRO-REC FROM TM009-NODIS-TRBL-RECORD.             03610058
036200**   WRITE NODISTRO-REC.                                          03620058
036300                                                                  03630026
036400     ADD 1 TO PC-COUNT-REC-WRITTEN.                               03640053
036500                                                                  03650026
036800 Y100-OPEN-NODIST-CSR.                                            03680051
036900*---------------------------------------------------------------- 03690026
037000*    OPEN NODIST_CSR CURSOR.                                      03700051
037100*---------------------------------------------------------------- 03710026
037200                                                                  03720026
037300     EXEC SQL                                                     03730026
037400         OPEN NODIST_CSR                                          03740051
037500     END-EXEC.                                                    03750026
037600                                                                  03760026
037700     EVALUATE TRUE                                                03770026
037800         WHEN SQLCODE = ZERO                                      03780026
037900             CONTINUE                                             03790026
038000         WHEN SQLWARN0 NOT = SPACES                               03800026
038100         WHEN SQLCODE  NOT = ZERO                                 03810026
038200             MOVE 'Y100-OPEN-NODIST-CSR'                          03820051
038300                                 TO AA-PARAGRAPH-NAME             03830026
038400             MOVE 'UNSUCCESSFUL OPEN ON NODIST_CSR'               03840051
038500                                 TO AA-DB2-OPERATION              03850026
038600             MOVE 'TRECEIV'      TO AA-DB2-TABLE-1                03860032
038700             MOVE 'TPURCHS'      TO AA-DB2-TABLE-2                03870032
038800             MOVE 'TTRBNTF'      TO AA-DB2-TABLE-3                03880051
038900             MOVE 'TENTNME'      TO AA-DB2-TABLE-4                03890051
039000             MOVE SPACES         TO AA-MESSAGE                    03900026
039100             PERFORM Z998-DB2-ABEND                               03910026
039200     END-EVALUATE.                                                03920026
039300                                                                  03930026
039400 Y200-CLOSE-NODIST-CSR.                                           03940051
039500*---------------------------------------------------------------- 03950026
039600*    CLOSE THE NODIST_CSR CURSOR.                               * 03960051
039700*---------------------------------------------------------------- 03970026
039800                                                                  03980026
039900     EXEC SQL                                                     03990026
040000         CLOSE NODIST_CSR                                         04000051
040100     END-EXEC.                                                    04010026
040200                                                                  04020026
040300     EVALUATE TRUE                                                04030026
040400         WHEN SQLCODE = ZERO                                      04040026
040500              CONTINUE                                            04050026
040600                                                                  04060026
040700         WHEN SQLWARN0 NOT = SPACES                               04070026
040800         WHEN SQLCODE  NOT = ZERO                                 04080026
040900             MOVE 'Y200-CLOSE-NODIST-CSR'                         04090051
041000                                 TO AA-PARAGRAPH-NAME             04100026
041100             MOVE 'UNSUCCESSFUL CLOSE ON NODIST_CSR'              04110051
041200                                 TO AA-DB2-OPERATION              04120026
041300             MOVE 'TRECEIV'      TO AA-DB2-TABLE-1                04130032
041400             MOVE 'TPURCHS'      TO AA-DB2-TABLE-2                04140032
041500             MOVE 'TTRBNTF'      TO AA-DB2-TABLE-3                04150051
041600             MOVE 'TENTNME'      TO AA-DB2-TABLE-4                04160051
041700             MOVE SPACES         TO AA-MESSAGE                    04170026
041800             PERFORM Z998-DB2-ABEND                               04180026
041900     END-EVALUATE.                                                04190026
042000                                                                  04200026
042100 Z998-DB2-ABEND.                                                  04210026
042200*----------------------------------------------------------------*04220026
042300*    ABEND ROUTINE FOR DB2 ERRORS                                *04230026
042400*----------------------------------------------------------------*04240026
042500     CLOSE NODISTRO-FILE.                                         04250052
042600                                                                  04260026
042700     DISPLAY AA-ABEND-TMK.                                        04270061
042800     DISPLAY AA-DB2-ERROR-TMK.                                    04280061
042900     DISPLAY AA-PROGRAM-TMK.                                      04290061
043000     DISPLAY AA-PARAGRAPH-TMK.                                    04300061
043100     DISPLAY AA-DB2-OPERATION-TMK.                                04310061
043200     DISPLAY AA-DB2-TABLE-1.                                      04320026
043300     DISPLAY AA-DB2-TABLE-2.                                      04330026
043400     DISPLAY AA-DB2-TABLE-3.                                      04340026
043500     DISPLAY AA-DB2-TABLE-4.                                      04350032
043600     SET AC-DB2-ERROR TO TRUE.                                    04360026
043700                                                                  04370026
043800     COPY DPPD004.                                                04380026
043900                                                                  04390026
044000     CALL 'ILBOABN0' USING ABEND-CODE.                            04400026
044100                                                                  04410026
