000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000210*-----------------------*                                         00021099
000220 PROGRAM-ID.    CNKCS227.                                         00022099
000230 AUTHOR.        DEANNA BRANTNER.                                  00023099
000240 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00024099
000250 DATE-WRITTEN.  FEBRUARY, 2001.                                   00025099
000260 DATE-COMPILED.                                                   00026099
000270                                                                  00027099
000280*---------------------------------------------------------------* 00028099
000290*    Y227 - TRAILER MANIFESTING - DC-DOOR LIST                  * 00029099
000300*---------------------------------------------------------------* 00030099
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00031099
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00032099
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00033099
263455*----------------------------------------------------------------*00034099
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00035099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00036099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00037099
CICS  *-----------------------------------------------------------------00038099
000400 ENVIRONMENT DIVISION.                                            00040099
000500 DATA DIVISION.                                                   00050099
000600                                                                  00060099
000700 WORKING-STORAGE SECTION.                                         00070099
000800                                                                  00080099
000900 01  DK-DB2-KEYS.                                                 00090099
001000     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00100099
001100     05  DK-TYPE-CODE              PIC X(02)       VALUE SPACES.  00110099
001200     05  DK-DOOR-ID                PIC X(04)      VALUE SPACES.   00120099
001300     05  DK-STOR-ASGNMNT           PIC X(05)      VALUE SPACES.   00130099
001400     05  DK-STORE-ASSIGN REDEFINES DK-STOR-ASGNMNT.               00140099
001500         10  DK-STORE-ASSIGN-N     PIC 9(04).                     00150099
001600         10  FILLER                PIC X(01).                     00160099
001800                                                                  00180001
001900 01  PC-PROGRAM-CONSTANTS.                                        00190001
002000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CNK227  '.  00200001
002100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CNKM227 '.  00210001
002200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CNKCS227'.  00220001
002300     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00230043
002400                                                     COMP.        00240043
002500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00250001
002600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00260001
002700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00270001
002800     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00280001
002900     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00290001
003000                                               COMP SYNC.         00300001
003100     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00310001
003200                                               COMP SYNC.         00320001
003300     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00330001
003400                                               COMP-3.            00340001
003500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00350001
003600                                               COMP SYNC.         00360001
003700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00370001
003800                                               COMP-3.            00380001
003900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00390001
003910     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00391060
004000     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00400001
004100     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00410001
004200     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00420001
004201     05  PC-DOOR                   PIC  X(04)  VALUE 'DOOR'.      00420199
004210     05  PC-STORE                  PIC  X(05)  VALUE 'STORE'.     00421099
004300     05  PC-01                     PIC  X(02)  VALUE '01'.        00430001
004301     05  PC-A                      PIC  X(01)  VALUE 'A'.         00430104
004302     05  PC-D                      PIC  X(01)  VALUE 'D'.         00430299
004303     05  PC-S                      PIC  X(01)  VALUE 'S'.         00430399
004304     05  PC-U                      PIC  X(01)  VALUE 'U'.         00430499
004305     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00430599
004310     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      00431001
004320                          VALUE  '9999-09-09-09.09.09.999999'.    00432001
004400                                                                  00440001
004500*----------------------------------------------------------------*00450001
004600*  SYSTEM MESSAGES                                               *00460001
004700*----------------------------------------------------------------*00470001
004800*   00005 = INVALID VALUE                                        *00480001
004900*   00008 = MUST BE NUMERIC                                      *00490001
005000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00500001
005100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00510001
005200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00520001
005300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00530001
005400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00540001
005500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00550001
005600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00560001
005700*   00069 - TOP OF LIST                                          *00570001
005800*   00070 - BOTTOM OF LIST                                       *00580001
006000*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00600001
006100*   00279 - MORE ITEMS TO DISPLAY                                *00610001
006200*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00620017
006300*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00630016
006600*----------------------------------------------------------------*00660001
006700     05  PC-TSYMSG-NUMBERS.                                       00670001
006800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00680001
006900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00690001
007000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00700001
007100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00710001
007200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00720001
007300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00730001
007400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00740001
007500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00750001
007600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00760001
007700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00770001
007800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00780001
008000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00800001
008100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00810001
008200         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  00820016
008300         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  00830016
008600*                                                                 00860001
008700 01  PS-PROGRAM-SWITCHES.                                         00870001
008800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00880001
008900         88  PS-NO-ERROR                            VALUE 'Y'.    00890001
009000         88  PS-ERROR                               VALUE 'N'.    00900001
009100     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    00910001
009200         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    00920001
009300         88  PS-BLOCK-ERROR                         VALUE 'N'.    00930001
009400     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   00940001
009500         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   00950001
009600         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   00960001
009700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    00970001
009800         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    00980001
009900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    00990001
010000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01000001
010100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01010001
010200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01020001
010300     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01030001
010400         88  PS-LIST-END                            VALUE 'Y'.    01040001
010500         88  PS-NO-LIST-END                         VALUE 'N'.    01050001
010600*                                                                 01060001
010700 01  PV-PROGRAM-VARIABLES.                                        01070001
010800     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01080001
010900                                        COMP SYNC.                01090001
011000     05  PV-SUB                         PIC S9(04)  VALUE +0      01100001
011100                                                    COMP SYNC.    01110001
011200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01120001
011300                                                    COMP SYNC.    01130001
011400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01140001
011500                                                    COMP-3.       01150001
011600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01160001
011700                                                    COMP-3.       01170001
011800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01180001
011900                                                    COMP-3.       01190001
012000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01200001
012100                                                    COMP-3.       01210001
012200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01220001
012300                                                    COMP-3.       01230001
012400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01240001
012500                                                    COMP-3.       01250001
012600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01260001
012700                                                    COMP-3.       01270001
012800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01280001
012900                                                    COMP SYNC.    01290001
013000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01300001
013100                                                    COMP SYNC.    01310001
013200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01320001
013300                                                    COMP SYNC.    01330001
013400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01340001
013500                                                    COMP SYNC.    01350001
013600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01360001
013700                                                    COMP SYNC.    01370001
013800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01380001
013900                                                    COMP SYNC.    01390001
014000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01400001
014100                                                    COMP SYNC.    01410001
014200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01420001
014300                                                    COMP SYNC.    01430001
014400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01440001
014500                                                    COMP SYNC.    01450001
014600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01460001
014700                                                    COMP SYNC.    01470001
014800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01480001
014900                                                    COMP SYNC.    01490001
015000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01500001
015100                                                    COMP SYNC.    01510001
015200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01520001
015300                                                    COMP SYNC.    01530001
015400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01540001
015500                                                    COMP SYNC.    01550001
015600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01560001
015700                                                    COMP SYNC.    01570001
015800     05  PV-SOFT-ABORT-MSG.                                       01580001
015900         10  FILLER            PIC X(12) VALUE ' CNKCS227 - '.    01590001
016000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01600001
016100         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01610001
016200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01620001
016300         10  PV-SOFT-PARAGRAPH PIC X(30).                         01630001
016400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01640001
016500                                                     COMP SYNC.   01650001
016600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01660001
016700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01670001
016800     05  PV-CICS-MSG-HOLD.                                        01680001
016900         10  FILLER                      PIC  X(01)  VALUE SPACE. 01690001
017000         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01700001
017100     05  PV-CICS-MSG-HOLD2.                                       01710001
017200         10  FILLER                      PIC  X(01)  VALUE SPACE. 01720001
017300         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 01730001
017400                                                                  01740001
017500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01750001
017600                                                     COMP SYNC.   01760001
017700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01770001
017800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01780001
017900     05  PV-CASE-NBR                     PIC  X(10).              01790099
018000     05  PV-UNION-TYPE                   PIC  X(01) VALUE SPACE.  01800099
018100                                                                  01810001
018200******************************************************************01820001
018300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01830001
018400**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **01840001
018500**  APPLICATION-SPECIFIC COMMAREA.                              **01850001
018600******************************************************************01860001
018700 01  LQW-LIST-QUEUE-WORK-AREA.                                    01870001
018800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01880001
018900     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           01890001
019000                                        INDEXED BY LQW-IDX.       01900001
019100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01910001
019200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01920001
019300         10  LQW-SELECTED-SW            PIC  X(01).               01930001
019400             88  LQW-SELECT                         VALUE 'S'.    01940001
019500             88  LQW-DESELECT                       VALUE ' '.    01950001
019600         10  LQW-ACTION                 PIC  X(03).               01960001
019700             88  LQW-ADD                            VALUE 'ADD'.  01970060
019800             88  LQW-INQ                            VALUE 'INQ'.  01980001
019900             88  LQW-UPD                            VALUE 'UPD'.  01990001
020000             88  LQW-ERR                            VALUE 'ERR'.  02000001
020200         10  LQW-DOOR-ID                PIC  X(04).               02020099
020300         10  LQW-TYPE-CODE              PIC  X(02).               02030001
020310         10  LQW-LOC-DESC               PIC  X(30).               02031001
020320         10  LQW-LANE-ASGNMNT           PIC  9(09).               02032001
020330         10  LQW-DIVERT-LOC             PIC  X(04).               02033099
020331         10  LQW-LABEL-NBR              PIC  9(04).               02033199
020340         10  LQW-STOR-ASGNMNT           PIC  X(05).               02034004
020400                                                                  02040001
020500*---------------------------------------------------------------* 02050001
020600* SELECTION QUEUE LAYOUT                                        * 02060001
020700*---------------------------------------------------------------* 02070001
020800     COPY CNWS013.                                                02080001
020900                                                                  02090001
021500*---------------------------------------------------------------* 02150001
021600*    MAP LAYOUT                                                 * 02160001
021700*---------------------------------------------------------------* 02170001
021800     COPY CNKM227.                                                02180001
021900*                                                                 02190001
022000 01  MR-OCCURS-LAYOUT                   REDEFINES  CNK227O.       02200001
022100     05  FILLER                         PIC X(91).                02210099
022200     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          02220001
022300         10  MR-SELECTL                 PIC S9(04) COMP.          02230001
022400         10  MR-SELECTA                 PIC  X(01).               02240001
022500         10  MR-SELECTC                 PIC  X(01).               02250001
022600         10  MR-SELECTH                 PIC  X(01).               02260001
022700         10  MR-SELECTI                 PIC  X(01).               02270001
022800                                                                  02280001
022900         10  MR-ACTIONL                 PIC S9(04) COMP.          02290001
023000         10  MR-ACTIONA                 PIC  X(01).               02300001
023100         10  MR-ACTIONC                 PIC  X(01).               02310001
023200         10  MR-ACTIONH                 PIC  X(01).               02320001
023300         10  MR-ACTION                  PIC  X(03).               02330001
023400                                                                  02340001
023500         10  MR-DOOR-IDL               PIC S9(04) COMP.           02350001
023600         10  MR-DOOR-IDA               PIC  X(01).                02360001
023700         10  MR-DOOR-IDC               PIC  X(01).                02370001
023800         10  MR-DOOR-IDH               PIC  X(01).                02380001
023900         10  MR-DOOR-ID                PIC  X(04).                02390099
024000                                                                  02400001
024100         10  MR-TYPE-CODEL             PIC S9(04) COMP.           02410001
024200         10  MR-TYPE-CODEA             PIC  X(01).                02420001
024300         10  MR-TYPE-CODEC             PIC  X(01).                02430001
024400         10  MR-TYPE-CODEH             PIC  X(01).                02440001
024500         10  MR-TYPE-CODE              PIC  X(02).                02450001
024600                                                                  02460001
024610         10  MR-LOC-DESCL              PIC S9(04) COMP.           02461001
024620         10  MR-LOC-DESCA              PIC  X(01).                02462001
024630         10  MR-LOC-DESCC              PIC  X(01).                02463001
024640         10  MR-LOC-DESCH              PIC  X(01).                02464001
024650         10  MR-LOC-DESC               PIC  X(30).                02465001
024660                                                                  02466001
024670         10  MR-LANE-ASGNMNTL          PIC S9(04) COMP.           02467001
024680         10  MR-LANE-ASGNMNTA          PIC  X(01).                02468001
024690         10  MR-LANE-ASGNMNTC          PIC  X(01).                02469001
024691         10  MR-LANE-ASGNMNTH          PIC  X(01).                02469101
024692         10  MR-LANE-ASGNMNT           PIC  Z(09).                02469206
024693                                                                  02469301
024694         10  MR-DIVERT-LOCL            PIC S9(04) COMP.           02469499
024695         10  MR-DIVERT-LOCA            PIC  X(01).                02469599
024696         10  MR-DIVERT-LOCC            PIC  X(01).                02469699
024697         10  MR-DIVERT-LOCH            PIC  X(01).                02469799
024698         10  MR-DIVERT-LOC             PIC  X(04).                02469899
024699                                                                  02469901
024700         10  MR-LABEL-NBRL             PIC S9(04) COMP.           02470099
024701         10  MR-LABEL-NBRA             PIC  X(01).                02470199
024702         10  MR-LABEL-NBRC             PIC  X(01).                02470299
024703         10  MR-LABEL-NBRH             PIC  X(01).                02470399
024704         10  MR-LABEL-NBR              PIC  Z(04).                02470499
024705                                                                  02470599
024706         10  MR-STOR-ASGNMNTL          PIC S9(04) COMP.           02470699
024707         10  MR-STOR-ASGNMNTA          PIC  X(01).                02470799
024708         10  MR-STOR-ASGNMNTC          PIC  X(01).                02470899
024709         10  MR-STOR-ASGNMNTH          PIC  X(01).                02470999
024710         10  MR-STOR-ASGNMNT           PIC  X(05).                02471099
024711                                                                  02471199
024720     05  FILLER                         PIC  X(12).               02472099
024800                                                                  02480001
024900*----------------------------------------------------------------*02490001
025000*  SENDING/RECEIVING AREA FOR THE                                 02500001
025100*  PRINTER VALIDATION ROUTING (DPKCS060)                          02510001
025200*----------------------------------------------------------------*02520001
025300     COPY DPWS072.                                                02530001
025400                                                                  02540001
025500*---------------------------------------------------------------* 02550001
025600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02560001
025700*---------------------------------------------------------------* 02570001
025800     COPY DPWS015.                                                02580001
025900                                                                  02590001
026000*---------------------------------------------------------------* 02600001
026100*    FUNCTION KEYS COPYBOOK.                                    * 02610001
026200*---------------------------------------------------------------* 02620001
026300     COPY DPWS016.                                                02630001
026400                                                                  02640001
026500*---------------------------------------------------------------* 02650001
026600*    NUMERIC EDIT LAYOUT.                                       * 02660001
026700*---------------------------------------------------------------* 02670001
026800     COPY DPWS010I.                                               02680001
026900                                                                  02690001
027000*---------------------------------------------------------------* 02700001
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02710099
027200*---------------------------------------------------------------* 02720001
027300     COPY DPWS030.                                                02730001
CICS       COPY DPWS930.                                                02731099
027400                                                                  02740001
027500*---------------------------------------------------------------* 02750001
027600*    STANDARD COMMAREA.                                         * 02760001
027700*---------------------------------------------------------------* 02770001
027800     COPY DPWS020.                                                02780001
027900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02790001
028000                                                                  02800001
028100*---------------------------------------------------------------* 02810001
028200* INTER-APPLICATION COMMAREA.                                   * 02820001
028300*   CNWS011 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02830001
028400*             SPEC SCREEN.                                      * 02840001
028500*   CNWS012 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02850001
028600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02860001
028700*---------------------------------------------------------------* 02870001
028800         10  INTER-APPL-COMM-AREA       PIC X(200).               02880001
028900     COPY CNWS011.                                                02890001
029000     COPY CNWS012.                                                02900001
029100                                                                  02910001
029200*---------------------------------------------------------------* 02920001
029300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02930001
029400*---------------------------------------------------------------* 02940001
029500         10  ASC-SPECIFIC-COMMAREA.                               02950001
029600             15  ASC-FUNCTION                 PIC  X(01).         02960004
029700             15  ASC-OPER-UNT-ID              PIC  9(04).         02970004
029710             15  ASC-ORD-SEQ                  PIC  X(05).         02971099
029800             15  ASC-FCLTY-NAME               PIC  X(25).         02980001
029900             15  ASC-COUNT                    PIC S9(09) COMP.    02990008
030900             15  ASC-BLK-SUB                  PIC S9(04) COMP     03090001
031000                                                         SYNC.    03100001
031100             15  ASC-ITEM-SUB                 PIC S9(04) COMP     03110001
031200                                                         SYNC.    03120001
031310             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  03131035
031400             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  03140001
031500             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  03150001
031600             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  03160001
031700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  03170001
031800             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     03180001
031900                                                         SYNC.    03190001
032000             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  03200001
032100             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  03210001
032200             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         03220001
032300                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     03230001
032400                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     03240001
032500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03250001
032600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     03260001
032700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     03270001
032800             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03280001
032900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03290001
033000                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03300001
033100             15  ASC-LIST-QUEUE-NAME.                             03310001
033200                 20  ASC-LIST-TERM-ID         PIC  X(04).         03320001
033300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03330001
033400                 20  ASC-LIST-SEQ             PIC  9(01).         03340001
033500                                                                  03350001
033600             15  ASC-START-ITEM-REQUEST.                          03360001
033700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03370001
033800                                                                  03380001
033900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03390001
034000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03400001
034100             15  ASC-CURSOR-SW                PIC  X(02).         03410001
034200                 88  ASC-NO-CURSOR                   VALUE 'Z '.  03420001
034300                 88  ASC-DOOR-CSR                    VALUE 'A '.  03430002
034400                 88  ASC-DOOR-TYPE-CSR               VALUE 'B '.  03440002
034410                 88  ASC-DOOR-ID-CSR                 VALUE 'C '.  03441002
034420                 88  ASC-DOOR-STR-CSR                VALUE 'D '.  03442099
034430                 88  ASC-DOOR-STR-TYPE-CSR           VALUE 'E '.  03443099
034440                 88  ASC-DOOR-STR-ID-CSR             VALUE 'F '.  03444099
034450             15  ASC-STORE-SW                 PIC  X(01).         03445099
034460                 88  ASC-LIST-BY-STORE               VALUE 'S'.   03446099
034470                 88  ASC-LIST-BY-DOOR                VALUE 'D'.   03447099
034500                                                                  03450002
034600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03460001
034700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03470001
034800             15  ASC-SEL-QUEUE-NAME.                              03480001
034900                 20  ASC-SEL-TERM-ID          PIC  X(04).         03490001
035000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03500001
035100                 20  ASC-SEL-SEQ              PIC  9(01).         03510001
035120                                                                  03512099
035200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  03520001
035300                                                                  03530001
035400*-----------------------------------------------------------------03540001
035500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03550001
035600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03560001
035700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03570001
035800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03580001
035900                                                                  03590001
036000                 20  ASC-ITEM-ARRAY.                              03600001
036100                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        03610001
036200                         30  ASC-LIST-ITEM-NUMBER                 03620001
036300                                                     PIC S9(09)   03630001
036400                                                     COMP-3.      03640001
036500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03650001
036600                             88  ASC-VALID-SELECT    VALUE ' '    03660001
036700                                                           'S'    03670001
036800                                                           'B'    03680001
036900                                                           'E'.   03690001
037000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03700001
037100                             88  ASC-TEMP-SELECT     VALUE 'S'.   03710001
037200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03720001
037300                             88  ASC-TEMP-END        VALUE 'E'.   03730001
037400                         30  ASC-SELECTED-SW         PIC  X(01).  03740001
037500                             88  ASC-NO-SELECT       VALUE ' '.   03750001
037600                             88  ASC-SELECT          VALUE 'S'.   03760001
037700                             88  ASC-BEGIN           VALUE 'B'.   03770001
037800                             88  ASC-END             VALUE 'E'.   03780001
037900                         30  ASC-ACTION              PIC  X(03).  03790001
037910                         30  ASC-DOOR-ID             PIC  X(04).  03791099
037920                         30  ASC-TYPE-CODE           PIC  X(02).  03792001
037930                         30  ASC-LOC-DESC            PIC  X(30).  03793001
037940                         30  ASC-LANE-ASGNMNT        PIC  9(09).  03794001
037950                         30  ASC-DIVERT-LOC          PIC  X(04).  03795099
037951                         30  ASC-LABEL-NBR           PIC  9(04).  03795199
037960                         30  ASC-STOR-ASGNMNT        PIC  X(05).  03796002
037970                         30  ASC-STOR-ASGNMNT-X REDEFINES         03797094
037980                                               ASC-STOR-ASGNMNT.  03798094
037990                             35  ASC-STORE-ASSIGN    PIC  Z(05).  03799094
038500                                                                  03850001
038600*---------------------------------------------------------------* 03860001
038700*    ABEND PROCESSING COPYBOOK.                                 * 03870001
038800*---------------------------------------------------------------* 03880001
038900     COPY DPWS013.                                                03890001
039000                                                                  03900001
039060*----------------------------------------------------------------*03906099
039070*    DB2 TABLE FOR CONTROL DOOR TYPE                              03907099
039080*----------------------------------------------------------------*03908099
039090     EXEC SQL                                                     03909099
039091          INCLUDE TCNDRTY                                         03909199
039092     END-EXEC.                                                    03909299
039093                                                                  03909399
039100*---------------------------------------------------------------* 03910001
039200*    TCNDCDR -  CONTROLS DISTRIBUTION CENTER DOORS              * 03920001
039300*---------------------------------------------------------------* 03930001
039400     EXEC SQL                                                     03940001
039500          INCLUDE TCNDCDR                                         03950001
039600     END-EXEC.                                                    03960001
039700                                                                  03970001
039710*---------------------------------------------------------------* 03971001
039720*    TCNDRST -  CONTROLS DOOR TO STORE ASSIGNMENTS              * 03972001
039730*---------------------------------------------------------------* 03973001
039740     EXEC SQL                                                     03974001
039750          INCLUDE TCNDRST                                         03975001
039760     END-EXEC.                                                    03976001
039770                                                                  03977001
039800*---------------------------------------------------------------* 03980001
039900*    DOOR CURSOR WITHOUT DOOR ID OR TYPE CODE                     03990001
040000*---------------------------------------------------------------* 04000001
040100     EXEC SQL                                                     04010001
040200        DECLARE DOOR-CSR CURSOR FOR                               04020001
040300          SELECT A.DOOR_ID                                        04030099
040400                ,A.DOOR_TYP_CDE                                   04040099
040410                ,A.DOOR_LOC_DESC                                  04041099
040411                ,A.DIVERT_NBR                                     04041199
040412                ,A.DIVERT_LOC_ID                                  04041299
040420                ,A.DOOR_LBL_SEQ_NBR                               04042099
040430              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04043099
040440                         THEN STRIP(A.DOOR_ID,L,'D')              04044099
040441                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04044199
040442                         THEN STRIP(A.DOOR_ID,T,'A')              04044299
040443                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04044399
040444                         THEN STRIP(A.DOOR_ID,T,'B')              04044499
040445                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04044599
040446                         THEN STRIP(A.DOOR_ID,T,'C')              04044699
040447                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04044799
040448                         THEN STRIP(A.DOOR_ID,T,'D')              04044899
040449                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04044999
040450                         THEN STRIP(A.DOOR_ID,T,'E')              04045099
040451                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04045199
040452                         THEN STRIP(A.DOOR_ID,T,'F')              04045299
040453                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04045399
040454                         THEN STRIP(A.DOOR_ID,T,'G')              04045499
040455                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04045599
040456                         THEN STRIP(A.DOOR_ID,T,'H')              04045699
040457                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04045799
040458                         THEN STRIP(A.DOOR_ID,T,'I')              04045899
040459                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04045999
040460                         THEN STRIP(A.DOOR_ID,T,'J')              04046099
040461                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04046199
040462                         THEN STRIP(A.DOOR_ID,T,'K')              04046299
040463                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04046399
040464                         THEN STRIP(A.DOOR_ID,T,'L')              04046499
040465                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04046599
040466                         THEN STRIP(A.DOOR_ID,T,'M')              04046699
040467                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04046799
040468                         THEN STRIP(A.DOOR_ID,T,'N')              04046899
040469                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04046999
040470                         THEN STRIP(A.DOOR_ID,T,'O')              04047099
040471                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04047199
040472                         THEN STRIP(A.DOOR_ID,T,'P')              04047299
040473                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04047399
040474                         THEN STRIP(A.DOOR_ID,T,'Q')              04047499
040475                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04047599
040476                         THEN STRIP(A.DOOR_ID,T,'R')              04047699
040477                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04047799
040478                         THEN STRIP(A.DOOR_ID,T,'S')              04047899
040479                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04047999
040480                         THEN STRIP(A.DOOR_ID,T,'T')              04048099
040481                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04048199
040482                         THEN STRIP(A.DOOR_ID,T,'U')              04048299
040483                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04048399
040484                         THEN STRIP(A.DOOR_ID,T,'V')              04048499
040485                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04048599
040486                         THEN STRIP(A.DOOR_ID,T,'W')              04048699
040487                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04048799
040488                         THEN STRIP(A.DOOR_ID,T,'X')              04048899
040489                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04048999
040490                         THEN STRIP(A.DOOR_ID,T,'Y')              04049099
040491                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04049199
040492                         THEN STRIP(A.DOOR_ID,T,'Z')              04049299
040493                    ELSE A.DOOR_ID                                04049399
040494                  END CASE                                        04049499
040500           FROM  TCNDCDR A                                        04050099
040510              ,  TCNDRTY B                                        04051099
040600          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04060099
040614            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04061499
040615            AND  B.DIVERT_TYP_CDE = :PC-D                         04061599
040620                                                                  04062099
040700        ORDER BY 7                                                04070099
040800                ,DOOR_ID                                          04080099
040810                ,DOOR_TYP_CDE                                     04081099
040900     END-EXEC.                                                    04090001
041000                                                                  04100001
041100*---------------------------------------------------------------* 04110001
041200*    DOOR TYPE CURSOR                                             04120001
041300*---------------------------------------------------------------* 04130001
041400     EXEC SQL                                                     04140001
041500        DECLARE DOOR-TYPE-CSR CURSOR FOR                          04150001
041600          SELECT A.DOOR_ID                                        04160099
041700                ,A.DOOR_TYP_CDE                                   04170099
041800                ,A.DOOR_LOC_DESC                                  04180099
041900                ,A.DIVERT_NBR                                     04190099
041910                ,A.DIVERT_LOC_ID                                  04191099
042000                ,A.DOOR_LBL_SEQ_NBR                               04200099
042010              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04201099
042011                         THEN STRIP(A.DOOR_ID,L,'D')              04201199
042012                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04201299
042013                         THEN STRIP(A.DOOR_ID,T,'A')              04201399
042014                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04201499
042015                         THEN STRIP(A.DOOR_ID,T,'B')              04201599
042016                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04201699
042017                         THEN STRIP(A.DOOR_ID,T,'C')              04201799
042018                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04201899
042019                         THEN STRIP(A.DOOR_ID,T,'D')              04201999
042020                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04202099
042021                         THEN STRIP(A.DOOR_ID,T,'E')              04202199
042022                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04202299
042023                         THEN STRIP(A.DOOR_ID,T,'F')              04202399
042024                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04202499
042025                         THEN STRIP(A.DOOR_ID,T,'G')              04202599
042026                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04202699
042027                         THEN STRIP(A.DOOR_ID,T,'H')              04202799
042028                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04202899
042029                         THEN STRIP(A.DOOR_ID,T,'I')              04202999
042030                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04203099
042031                         THEN STRIP(A.DOOR_ID,T,'J')              04203199
042032                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04203299
042033                         THEN STRIP(A.DOOR_ID,T,'K')              04203399
042034                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04203499
042035                         THEN STRIP(A.DOOR_ID,T,'L')              04203599
042036                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04203699
042037                         THEN STRIP(A.DOOR_ID,T,'M')              04203799
042038                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04203899
042039                         THEN STRIP(A.DOOR_ID,T,'N')              04203999
042040                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04204099
042041                         THEN STRIP(A.DOOR_ID,T,'O')              04204199
042042                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04204299
042043                         THEN STRIP(A.DOOR_ID,T,'P')              04204399
042044                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04204499
042045                         THEN STRIP(A.DOOR_ID,T,'Q')              04204599
042046                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04204699
042047                         THEN STRIP(A.DOOR_ID,T,'R')              04204799
042048                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04204899
042049                         THEN STRIP(A.DOOR_ID,T,'S')              04204999
042050                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04205099
042051                         THEN STRIP(A.DOOR_ID,T,'T')              04205199
042052                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04205299
042053                         THEN STRIP(A.DOOR_ID,T,'U')              04205399
042054                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04205499
042055                         THEN STRIP(A.DOOR_ID,T,'V')              04205599
042056                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04205699
042057                         THEN STRIP(A.DOOR_ID,T,'W')              04205799
042058                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04205899
042059                         THEN STRIP(A.DOOR_ID,T,'X')              04205999
042060                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04206099
042061                         THEN STRIP(A.DOOR_ID,T,'Y')              04206199
042062                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04206299
042063                         THEN STRIP(A.DOOR_ID,T,'Z')              04206399
042064                    ELSE A.DOOR_ID                                04206499
042070                  END CASE                                        04207099
042100           FROM  TCNDCDR A                                        04210099
042110              ,  TCNDRTY B                                        04211099
042200          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04220099
042201            AND  A.DOOR_TYP_CDE   = :DK-TYPE-CODE                 04220199
042204            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04220499
042205            AND  B.DIVERT_TYP_CDE = :PC-D                         04220599
042211                                                                  04221199
042212        ORDER BY 7                                                04221299
042220                ,DOOR_ID                                          04222099
042300     END-EXEC.                                                    04230001
042400                                                                  04240001
042410*---------------------------------------------------------------* 04241001
042420*    DOOR ID CURSOR                                               04242001
042430*---------------------------------------------------------------* 04243001
042440     EXEC SQL                                                     04244001
042450        DECLARE DOOR-ID-CSR CURSOR FOR                            04245001
042460          SELECT A.DOOR_ID                                        04246099
042470                ,A.DOOR_TYP_CDE                                   04247099
042480                ,A.DOOR_LOC_DESC                                  04248099
042490                ,A.DIVERT_NBR                                     04249099
042491                ,A.DIVERT_LOC_ID                                  04249199
042492                ,A.DOOR_LBL_SEQ_NBR                               04249299
042493              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04249399
042494                         THEN STRIP(A.DOOR_ID,L,'D')              04249499
042495                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04249599
042496                         THEN STRIP(A.DOOR_ID,T,'A')              04249699
042497                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04249799
042498                         THEN STRIP(A.DOOR_ID,T,'B')              04249899
042499                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04249999
042500                         THEN STRIP(A.DOOR_ID,T,'C')              04250099
042501                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04250199
042502                         THEN STRIP(A.DOOR_ID,T,'D')              04250299
042503                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04250399
042504                         THEN STRIP(A.DOOR_ID,T,'E')              04250499
042505                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04250599
042506                         THEN STRIP(A.DOOR_ID,T,'F')              04250699
042507                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04250799
042508                         THEN STRIP(A.DOOR_ID,T,'G')              04250899
042509                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04250999
042510                         THEN STRIP(A.DOOR_ID,T,'H')              04251099
042511                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04251199
042512                         THEN STRIP(A.DOOR_ID,T,'I')              04251299
042513                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04251399
042514                         THEN STRIP(A.DOOR_ID,T,'J')              04251499
042515                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04251599
042516                         THEN STRIP(A.DOOR_ID,T,'K')              04251699
042517                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04251799
042518                         THEN STRIP(A.DOOR_ID,T,'L')              04251899
042519                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04251999
042520                         THEN STRIP(A.DOOR_ID,T,'M')              04252099
042521                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04252199
042522                         THEN STRIP(A.DOOR_ID,T,'N')              04252299
042523                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04252399
042524                         THEN STRIP(A.DOOR_ID,T,'O')              04252499
042525                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04252599
042526                         THEN STRIP(A.DOOR_ID,T,'P')              04252699
042527                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04252799
042528                         THEN STRIP(A.DOOR_ID,T,'Q')              04252899
042529                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04252999
042530                         THEN STRIP(A.DOOR_ID,T,'R')              04253099
042531                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04253199
042532                         THEN STRIP(A.DOOR_ID,T,'S')              04253299
042533                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04253399
042534                         THEN STRIP(A.DOOR_ID,T,'T')              04253499
042535                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04253599
042536                         THEN STRIP(A.DOOR_ID,T,'U')              04253699
042537                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04253799
042538                         THEN STRIP(A.DOOR_ID,T,'V')              04253899
042539                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04253999
042540                         THEN STRIP(A.DOOR_ID,T,'W')              04254099
042541                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04254199
042542                         THEN STRIP(A.DOOR_ID,T,'X')              04254299
042543                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04254399
042544                         THEN STRIP(A.DOOR_ID,T,'Y')              04254499
042545                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04254599
042546                         THEN STRIP(A.DOOR_ID,T,'Z')              04254699
042547                    ELSE A.DOOR_ID                                04254799
042552                  END CASE                                        04255299
042553           FROM  TCNDCDR A                                        04255399
042554              ,  TCNDRTY B                                        04255499
042555          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04255599
042556            AND  A.DOOR_ID        = :DK-DOOR-ID                   04255699
042557            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04255799
042558            AND  B.DIVERT_TYP_CDE = :PC-D                         04255899
042559                                                                  04255999
042560        ORDER BY 7                                                04256099
042561                ,DOOR_ID                                          04256199
042562     END-EXEC.                                                    04256299
042563                                                                  04256399
042570*---------------------------------------------------------------* 04257001
042600*    DOOR/STORE CURSOR WITHOUT DOOR ID OR TYPE CODE             * 04260099
042700*---------------------------------------------------------------* 04270001
042701     EXEC SQL                                                     04270199
042702        DECLARE DOOR-STR-CSR CURSOR FOR                           04270299
042703          SELECT 'A'                                              04270399
042704                ,A.DOOR_ID                                        04270499
042705                ,A.DOOR_TYP_CDE                                   04270599
042706                ,A.DOOR_LOC_DESC                                  04270699
042707                ,A.DIVERT_NBR                                     04270799
042708                ,A.DIVERT_LOC_ID                                  04270899
042709                ,A.DOOR_LBL_SEQ_NBR                               04270999
042710                ,C.STR_NBR                                        04271099
042711              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04271199
042712                         THEN STRIP(A.DOOR_ID,L,'D')              04271299
042713                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04271399
042714                         THEN STRIP(A.DOOR_ID,T,'A')              04271499
042715                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04271599
042716                         THEN STRIP(A.DOOR_ID,T,'B')              04271699
042717                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04271799
042718                         THEN STRIP(A.DOOR_ID,T,'C')              04271899
042719                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04271999
042720                         THEN STRIP(A.DOOR_ID,T,'D')              04272099
042721                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04272199
042722                         THEN STRIP(A.DOOR_ID,T,'E')              04272299
042723                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04272399
042724                         THEN STRIP(A.DOOR_ID,T,'F')              04272499
042725                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04272599
042726                         THEN STRIP(A.DOOR_ID,T,'G')              04272699
042727                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04272799
042728                         THEN STRIP(A.DOOR_ID,T,'H')              04272899
042729                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04272999
042730                         THEN STRIP(A.DOOR_ID,T,'I')              04273099
042731                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04273199
042732                         THEN STRIP(A.DOOR_ID,T,'J')              04273299
042733                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04273399
042734                         THEN STRIP(A.DOOR_ID,T,'K')              04273499
042735                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04273599
042736                         THEN STRIP(A.DOOR_ID,T,'L')              04273699
042737                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04273799
042738                         THEN STRIP(A.DOOR_ID,T,'M')              04273899
042739                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04273999
042740                         THEN STRIP(A.DOOR_ID,T,'N')              04274099
042741                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04274199
042742                         THEN STRIP(A.DOOR_ID,T,'O')              04274299
042743                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04274399
042744                         THEN STRIP(A.DOOR_ID,T,'P')              04274499
042745                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04274599
042746                         THEN STRIP(A.DOOR_ID,T,'Q')              04274699
042747                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04274799
042748                         THEN STRIP(A.DOOR_ID,T,'R')              04274899
042749                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04274999
042750                         THEN STRIP(A.DOOR_ID,T,'S')              04275099
042751                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04275199
042752                         THEN STRIP(A.DOOR_ID,T,'T')              04275299
042753                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04275399
042754                         THEN STRIP(A.DOOR_ID,T,'U')              04275499
042755                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04275599
042756                         THEN STRIP(A.DOOR_ID,T,'V')              04275699
042757                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04275799
042758                         THEN STRIP(A.DOOR_ID,T,'W')              04275899
042759                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04275999
042760                         THEN STRIP(A.DOOR_ID,T,'X')              04276099
042761                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04276199
042762                         THEN STRIP(A.DOOR_ID,T,'Y')              04276299
042763                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04276399
042764                         THEN STRIP(A.DOOR_ID,T,'Z')              04276499
042765                    ELSE A.DOOR_ID                                04276599
042770                  END CASE                                        04277099
042771           FROM  TCNDCDR A                                        04277199
042772              ,  TCNDRTY B                                        04277299
042773              ,  TCNDRST C                                        04277399
042774          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04277499
042775            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04277599
042776            AND  B.DIVERT_TYP_CDE = :PC-D                         04277699
042777            AND  C.OPER_UNT_ID    = A.OPER_UNT_ID                 04277799
042778            AND  C.DOOR_ID        = A.DOOR_ID                     04277899
042779            AND  C.END_TMST       = :PC-DEFAULT-TIMESTAMP         04277999
042780                                                                  04278099
042781          UNION                                                   04278199
042782                                                                  04278299
042783          SELECT 'B'                                              04278399
042784                ,A.DOOR_ID                                        04278499
042785                ,A.DOOR_TYP_CDE                                   04278599
042786                ,A.DOOR_LOC_DESC                                  04278699
042787                ,A.DIVERT_NBR                                     04278799
042788                ,A.DIVERT_LOC_ID                                  04278899
042789                ,A.DOOR_LBL_SEQ_NBR                               04278999
042790                ,0                                                04279099
042791              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04279199
042792                         THEN STRIP(A.DOOR_ID,L,'D')              04279299
042793                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04279399
042794                         THEN STRIP(A.DOOR_ID,T,'A')              04279499
042795                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04279599
042796                         THEN STRIP(A.DOOR_ID,T,'B')              04279699
042797                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04279799
042798                         THEN STRIP(A.DOOR_ID,T,'C')              04279899
042799                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04279999
042800                         THEN STRIP(A.DOOR_ID,T,'D')              04280099
042801                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04280199
042802                         THEN STRIP(A.DOOR_ID,T,'E')              04280299
042803                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04280399
042804                         THEN STRIP(A.DOOR_ID,T,'F')              04280499
042805                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04280599
042806                         THEN STRIP(A.DOOR_ID,T,'G')              04280699
042807                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04280799
042808                         THEN STRIP(A.DOOR_ID,T,'H')              04280899
042809                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04280999
042810                         THEN STRIP(A.DOOR_ID,T,'I')              04281099
042811                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04281199
042812                         THEN STRIP(A.DOOR_ID,T,'J')              04281299
042813                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04281399
042814                         THEN STRIP(A.DOOR_ID,T,'K')              04281499
042815                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04281599
042816                         THEN STRIP(A.DOOR_ID,T,'L')              04281699
042817                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04281799
042818                         THEN STRIP(A.DOOR_ID,T,'M')              04281899
042819                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04281999
042820                         THEN STRIP(A.DOOR_ID,T,'N')              04282099
042821                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04282199
042822                         THEN STRIP(A.DOOR_ID,T,'O')              04282299
042823                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04282399
042824                         THEN STRIP(A.DOOR_ID,T,'P')              04282499
042825                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04282599
042826                         THEN STRIP(A.DOOR_ID,T,'Q')              04282699
042827                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04282799
042828                         THEN STRIP(A.DOOR_ID,T,'R')              04282899
042829                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04282999
042830                         THEN STRIP(A.DOOR_ID,T,'S')              04283099
042831                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04283199
042832                         THEN STRIP(A.DOOR_ID,T,'T')              04283299
042833                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04283399
042834                         THEN STRIP(A.DOOR_ID,T,'U')              04283499
042835                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04283599
042836                         THEN STRIP(A.DOOR_ID,T,'V')              04283699
042837                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04283799
042838                         THEN STRIP(A.DOOR_ID,T,'W')              04283899
042839                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04283999
042840                         THEN STRIP(A.DOOR_ID,T,'X')              04284099
042841                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04284199
042842                         THEN STRIP(A.DOOR_ID,T,'Y')              04284299
042843                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04284399
042844                         THEN STRIP(A.DOOR_ID,T,'Z')              04284499
042845                    ELSE A.DOOR_ID                                04284599
042850                  END CASE                                        04285099
042851           FROM  TCNDCDR A                                        04285199
042852              ,  TCNDRTY B                                        04285299
042853          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04285399
042854            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04285499
042855            AND  B.DIVERT_TYP_CDE = :PC-D                         04285599
042856            AND  NOT EXISTS                                       04285699
042857                 (SELECT *                                        04285799
042858                    FROM TCNDRST C                                04285899
042859                    WHERE OPER_UNT_ID = :DK-OPER-UNT-ID           04285999
042860                    AND A.DOOR_ID     = C.DOOR_ID                 04286099
042861                    AND C.END_TMST    = :PC-DEFAULT-TIMESTAMP)    04286199
042862                                                                  04286299
042863        ORDER BY  8                                               04286399
042864                 ,DOOR_ID                                         04286499
042865                 ,DOOR_TYP_CDE                                    04286599
042866     END-EXEC.                                                    04286699
042867                                                                  04286799
042868*---------------------------------------------------------------* 04286899
042869*    DOOR/STORE TYPE CURSOR                                     * 04286999
042870*---------------------------------------------------------------* 04287099
042871     EXEC SQL                                                     04287199
042872        DECLARE DOOR-STR-TYPE-CSR CURSOR FOR                      04287299
042873          SELECT 'A'                                              04287399
042874                ,A.DOOR_ID                                        04287499
042875                ,A.DOOR_TYP_CDE                                   04287599
042876                ,A.DOOR_LOC_DESC                                  04287699
042877                ,A.DIVERT_NBR                                     04287799
042878                ,A.DIVERT_LOC_ID                                  04287899
042879                ,A.DOOR_LBL_SEQ_NBR                               04287999
042880                ,C.STR_NBR                                        04288099
042881              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04288199
042882                         THEN STRIP(A.DOOR_ID,L,'D')              04288299
042883                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04288399
042884                         THEN STRIP(A.DOOR_ID,T,'A')              04288499
042885                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04288599
042886                         THEN STRIP(A.DOOR_ID,T,'B')              04288699
042887                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04288799
042888                         THEN STRIP(A.DOOR_ID,T,'C')              04288899
042889                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04288999
042890                         THEN STRIP(A.DOOR_ID,T,'D')              04289099
042891                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04289199
042892                         THEN STRIP(A.DOOR_ID,T,'E')              04289299
042893                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04289399
042894                         THEN STRIP(A.DOOR_ID,T,'F')              04289499
042895                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04289599
042896                         THEN STRIP(A.DOOR_ID,T,'G')              04289699
042897                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04289799
042898                         THEN STRIP(A.DOOR_ID,T,'H')              04289899
042899                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04289999
042900                         THEN STRIP(A.DOOR_ID,T,'I')              04290099
042901                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04290199
042902                         THEN STRIP(A.DOOR_ID,T,'J')              04290299
042903                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04290399
042904                         THEN STRIP(A.DOOR_ID,T,'K')              04290499
042905                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04290599
042906                         THEN STRIP(A.DOOR_ID,T,'L')              04290699
042907                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04290799
042908                         THEN STRIP(A.DOOR_ID,T,'M')              04290899
042909                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04290999
042910                         THEN STRIP(A.DOOR_ID,T,'N')              04291099
042911                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04291199
042912                         THEN STRIP(A.DOOR_ID,T,'O')              04291299
042913                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04291399
042914                         THEN STRIP(A.DOOR_ID,T,'P')              04291499
042915                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04291599
042916                         THEN STRIP(A.DOOR_ID,T,'Q')              04291699
042917                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04291799
042918                         THEN STRIP(A.DOOR_ID,T,'R')              04291899
042919                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04291999
042920                         THEN STRIP(A.DOOR_ID,T,'S')              04292099
042921                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04292199
042922                         THEN STRIP(A.DOOR_ID,T,'T')              04292299
042923                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04292399
042924                         THEN STRIP(A.DOOR_ID,T,'U')              04292499
042925                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04292599
042926                         THEN STRIP(A.DOOR_ID,T,'V')              04292699
042927                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04292799
042928                         THEN STRIP(A.DOOR_ID,T,'W')              04292899
042929                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04292999
042930                         THEN STRIP(A.DOOR_ID,T,'X')              04293099
042931                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04293199
042932                         THEN STRIP(A.DOOR_ID,T,'Y')              04293299
042933                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04293399
042934                         THEN STRIP(A.DOOR_ID,T,'Z')              04293499
042935                    ELSE A.DOOR_ID                                04293599
042940                  END CASE                                        04294099
042941           FROM  TCNDCDR A                                        04294199
042942              ,  TCNDRTY B                                        04294299
042943              ,  TCNDRST C                                        04294399
042944          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04294499
042945            AND  A.DOOR_TYP_CDE   = :DK-TYPE-CODE                 04294599
042946            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04294699
042947            AND  B.DIVERT_TYP_CDE = :PC-D                         04294799
042948            AND  C.DOOR_ID        = A.DOOR_ID                     04294899
042949            AND  C.OPER_UNT_ID    = A.OPER_UNT_ID                 04294999
042950            AND  C.END_TMST       = :PC-DEFAULT-TIMESTAMP         04295099
042951                                                                  04295199
042952          UNION                                                   04295299
042953                                                                  04295399
042954          SELECT 'B'                                              04295499
042955                ,A.DOOR_ID                                        04295599
042956                ,A.DOOR_TYP_CDE                                   04295699
042957                ,A.DOOR_LOC_DESC                                  04295799
042958                ,A.DIVERT_NBR                                     04295899
042959                ,A.DIVERT_LOC_ID                                  04295999
042960                ,A.DOOR_LBL_SEQ_NBR                               04296099
042961                ,0                                                04296199
042962              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04296299
042963                         THEN STRIP(A.DOOR_ID,L,'D')              04296399
042964                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04296499
042965                         THEN STRIP(A.DOOR_ID,T,'A')              04296599
042966                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04296699
042967                         THEN STRIP(A.DOOR_ID,T,'B')              04296799
042968                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04296899
042969                         THEN STRIP(A.DOOR_ID,T,'C')              04296999
042970                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04297099
042971                         THEN STRIP(A.DOOR_ID,T,'D')              04297199
042972                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04297299
042973                         THEN STRIP(A.DOOR_ID,T,'E')              04297399
042974                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04297499
042975                         THEN STRIP(A.DOOR_ID,T,'F')              04297599
042976                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04297699
042977                         THEN STRIP(A.DOOR_ID,T,'G')              04297799
042978                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04297899
042979                         THEN STRIP(A.DOOR_ID,T,'H')              04297999
042980                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04298099
042981                         THEN STRIP(A.DOOR_ID,T,'I')              04298199
042982                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04298299
042983                         THEN STRIP(A.DOOR_ID,T,'J')              04298399
042984                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04298499
042985                         THEN STRIP(A.DOOR_ID,T,'K')              04298599
042986                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04298699
042987                         THEN STRIP(A.DOOR_ID,T,'L')              04298799
042988                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04298899
042989                         THEN STRIP(A.DOOR_ID,T,'M')              04298999
042990                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04299099
042991                         THEN STRIP(A.DOOR_ID,T,'N')              04299199
042992                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04299299
042993                         THEN STRIP(A.DOOR_ID,T,'O')              04299399
042994                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04299499
042995                         THEN STRIP(A.DOOR_ID,T,'P')              04299599
042996                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04299699
042997                         THEN STRIP(A.DOOR_ID,T,'Q')              04299799
042998                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04299899
042999                         THEN STRIP(A.DOOR_ID,T,'R')              04299999
043000                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04300099
043001                         THEN STRIP(A.DOOR_ID,T,'S')              04300199
043002                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04300299
043003                         THEN STRIP(A.DOOR_ID,T,'T')              04300399
043004                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04300499
043005                         THEN STRIP(A.DOOR_ID,T,'U')              04300599
043006                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04300699
043007                         THEN STRIP(A.DOOR_ID,T,'V')              04300799
043008                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04300899
043009                         THEN STRIP(A.DOOR_ID,T,'W')              04300999
043010                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04301099
043011                         THEN STRIP(A.DOOR_ID,T,'X')              04301199
043012                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04301299
043013                         THEN STRIP(A.DOOR_ID,T,'Y')              04301399
043014                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04301499
043015                         THEN STRIP(A.DOOR_ID,T,'Z')              04301599
043016                    ELSE A.DOOR_ID                                04301699
043021                  END CASE                                        04302199
043022           FROM  TCNDCDR A                                        04302299
043023              ,  TCNDRTY B                                        04302399
043024          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04302499
043025            AND  A.DOOR_TYP_CDE   = :DK-TYPE-CODE                 04302599
043026            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04302699
043027            AND  B.DIVERT_TYP_CDE = :PC-D                         04302799
043028            AND  NOT EXISTS                                       04302899
043029                   (SELECT *                                      04302999
043030                      FROM TCNDRST C                              04303099
043031                      WHERE OPER_UNT_ID = :DK-OPER-UNT-ID         04303199
043032                      AND A.DOOR_ID     = C.DOOR_ID               04303299
043033                      AND C.END_TMST    = :PC-DEFAULT-TIMESTAMP)  04303399
043034        ORDER BY 8                                                04303499
043035                ,DOOR_ID                                          04303599
043036                                                                  04303699
043037     END-EXEC.                                                    04303799
043038                                                                  04303899
043039*---------------------------------------------------------------* 04303999
043040*    DOOR ID STORE CSR                                            04304099
043041*---------------------------------------------------------------* 04304199
043042     EXEC SQL                                                     04304299
043043        DECLARE DOOR-STR-ID-CSR CURSOR FOR                        04304399
043044          SELECT 'A'                                              04304499
043045                ,A.DOOR_ID                                        04304599
043046                ,A.DOOR_TYP_CDE                                   04304699
043047                ,A.DOOR_LOC_DESC                                  04304799
043048                ,A.DIVERT_NBR                                     04304899
043049                ,A.DIVERT_LOC_ID                                  04304999
043050                ,A.DOOR_LBL_SEQ_NBR                               04305099
043051                ,C.STR_NBR                                        04305199
043052              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04305299
043053                         THEN STRIP(A.DOOR_ID,L,'D')              04305399
043054                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04305499
043055                         THEN STRIP(A.DOOR_ID,T,'A')              04305599
043056                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04305699
043057                         THEN STRIP(A.DOOR_ID,T,'B')              04305799
043058                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04305899
043059                         THEN STRIP(A.DOOR_ID,T,'C')              04305999
043060                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04306099
043061                         THEN STRIP(A.DOOR_ID,T,'D')              04306199
043062                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04306299
043063                         THEN STRIP(A.DOOR_ID,T,'E')              04306399
043064                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04306499
043065                         THEN STRIP(A.DOOR_ID,T,'F')              04306599
043066                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04306699
043067                         THEN STRIP(A.DOOR_ID,T,'G')              04306799
043068                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04306899
043069                         THEN STRIP(A.DOOR_ID,T,'H')              04306999
043070                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04307099
043071                         THEN STRIP(A.DOOR_ID,T,'I')              04307199
043072                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04307299
043073                         THEN STRIP(A.DOOR_ID,T,'J')              04307399
043074                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04307499
043075                         THEN STRIP(A.DOOR_ID,T,'K')              04307599
043076                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04307699
043077                         THEN STRIP(A.DOOR_ID,T,'L')              04307799
043078                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04307899
043079                         THEN STRIP(A.DOOR_ID,T,'M')              04307999
043080                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04308099
043081                         THEN STRIP(A.DOOR_ID,T,'N')              04308199
043082                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04308299
043083                         THEN STRIP(A.DOOR_ID,T,'O')              04308399
043084                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04308499
043085                         THEN STRIP(A.DOOR_ID,T,'P')              04308599
043086                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04308699
043087                         THEN STRIP(A.DOOR_ID,T,'Q')              04308799
043088                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04308899
043089                         THEN STRIP(A.DOOR_ID,T,'R')              04308999
043090                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04309099
043091                         THEN STRIP(A.DOOR_ID,T,'S')              04309199
043092                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04309299
043093                         THEN STRIP(A.DOOR_ID,T,'T')              04309399
043094                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04309499
043095                         THEN STRIP(A.DOOR_ID,T,'U')              04309599
043096                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04309699
043097                         THEN STRIP(A.DOOR_ID,T,'V')              04309799
043098                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04309899
043099                         THEN STRIP(A.DOOR_ID,T,'W')              04309999
043100                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04310099
043101                         THEN STRIP(A.DOOR_ID,T,'X')              04310199
043102                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04310299
043103                         THEN STRIP(A.DOOR_ID,T,'Y')              04310399
043104                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04310499
043105                         THEN STRIP(A.DOOR_ID,T,'Z')              04310599
043106                    ELSE A.DOOR_ID                                04310699
043111                  END CASE                                        04311199
043112           FROM  TCNDCDR A                                        04311299
043113              ,  TCNDRTY B                                        04311399
043114              ,  TCNDRST C                                        04311499
043115          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04311599
043116            AND  A.DOOR_ID        = :DK-DOOR-ID                   04311699
043117            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04311799
043118            AND  B.DIVERT_TYP_CDE = :PC-D                         04311899
043119            AND  C.OPER_UNT_ID    = A.OPER_UNT_ID                 04311999
043120            AND  C.DOOR_ID        = A.DOOR_ID                     04312099
043121            AND  C.END_TMST       = :PC-DEFAULT-TIMESTAMP         04312199
043122                                                                  04312299
043123          UNION                                                   04312399
043124                                                                  04312499
043125          SELECT 'B'                                              04312599
043126                ,A.DOOR_ID                                        04312699
043127                ,A.DOOR_TYP_CDE                                   04312799
043128                ,A.DOOR_LOC_DESC                                  04312899
043129                ,A.DIVERT_NBR                                     04312999
043130                ,A.DIVERT_LOC_ID                                  04313099
043131                ,A.DOOR_LBL_SEQ_NBR                               04313199
043132                ,0                                                04313299
043133              ,CASE WHEN STRIP(A.DOOR_ID,L) BETWEEN 'A' AND 'ZZZZ'04313399
043134                         THEN STRIP(A.DOOR_ID,L,'D')              04313499
043135                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'A'              04313599
043136                         THEN STRIP(A.DOOR_ID,T,'A')              04313699
043137                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'B'              04313799
043138                         THEN STRIP(A.DOOR_ID,T,'B')              04313899
043139                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'C'              04313999
043140                         THEN STRIP(A.DOOR_ID,T,'C')              04314099
043141                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'D'              04314199
043142                         THEN STRIP(A.DOOR_ID,T,'D')              04314299
043143                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'E'              04314399
043144                         THEN STRIP(A.DOOR_ID,T,'E')              04314499
043145                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'F'              04314599
043146                         THEN STRIP(A.DOOR_ID,T,'F')              04314699
043147                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'G'              04314799
043148                         THEN STRIP(A.DOOR_ID,T,'G')              04314899
043149                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'H'              04314999
043150                         THEN STRIP(A.DOOR_ID,T,'H')              04315099
043151                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'I'              04315199
043152                         THEN STRIP(A.DOOR_ID,T,'I')              04315299
043153                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'J'              04315399
043154                         THEN STRIP(A.DOOR_ID,T,'J')              04315499
043155                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'K'              04315599
043156                         THEN STRIP(A.DOOR_ID,T,'K')              04315699
043157                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'L'              04315799
043158                         THEN STRIP(A.DOOR_ID,T,'L')              04315899
043159                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'M'              04315999
043160                         THEN STRIP(A.DOOR_ID,T,'M')              04316099
043161                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'N'              04316199
043162                         THEN STRIP(A.DOOR_ID,T,'N')              04316299
043163                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'O'              04316399
043164                         THEN STRIP(A.DOOR_ID,T,'O')              04316499
043165                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'P'              04316599
043166                         THEN STRIP(A.DOOR_ID,T,'P')              04316699
043167                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Q'              04316799
043168                         THEN STRIP(A.DOOR_ID,T,'Q')              04316899
043169                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'R'              04316999
043170                         THEN STRIP(A.DOOR_ID,T,'R')              04317099
043171                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'S'              04317199
043172                         THEN STRIP(A.DOOR_ID,T,'S')              04317299
043173                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'T'              04317399
043174                         THEN STRIP(A.DOOR_ID,T,'T')              04317499
043175                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'U'              04317599
043176                         THEN STRIP(A.DOOR_ID,T,'U')              04317699
043177                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'V'              04317799
043178                         THEN STRIP(A.DOOR_ID,T,'V')              04317899
043179                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'W'              04317999
043180                         THEN STRIP(A.DOOR_ID,T,'W')              04318099
043181                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'X'              04318199
043182                         THEN STRIP(A.DOOR_ID,T,'X')              04318299
043183                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Y'              04318399
043184                         THEN STRIP(A.DOOR_ID,T,'Y')              04318499
043185                    WHEN SUBSTR(A.DOOR_ID,4,1) = 'Z'              04318599
043186                         THEN STRIP(A.DOOR_ID,T,'Z')              04318699
043187                    ELSE A.DOOR_ID                                04318799
043192                  END CASE                                        04319299
043193           FROM  TCNDCDR A                                        04319399
043194              ,  TCNDRTY B                                        04319499
043195          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               04319599
043196            AND  A.DOOR_ID        = :DK-DOOR-ID                   04319699
043197            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04319799
043198            AND  B.DIVERT_TYP_CDE = :PC-D                         04319899
043199            AND  NOT EXISTS                                       04319999
043200                     (SELECT DOOR_ID                              04320099
043201                        FROM TCNDRST C                            04320199
043202                        WHERE OPER_UNT_ID = :DK-OPER-UNT-ID       04320299
043203                        AND C.DOOR_ID     = A.DOOR_ID             04320399
043204                        AND C.END_TMST    = :PC-DEFAULT-TIMESTAMP)04320499
043205       ORDER BY 8                                                 04320599
043206                ,DOOR_ID                                          04320699
043207                                                                  04320799
043208     END-EXEC.                                                    04320899
043209                                                                  04320999
043210*---------------------------------------------------------------* 04321099
043211*    DB2 AREA FOR COMMUNICATIONS                                * 04321199
043212*---------------------------------------------------------------* 04321299
043213     EXEC SQL                                                     04321399
043214          INCLUDE SQLCA                                           04321401
043215     END-EXEC.                                                    04321501
043216                                                                  04321601
043220***************************************************************** 04322001
043300 LINKAGE SECTION.                                                 04330001
043400                                                                  04340001
043500 01  DFHCOMMAREA.                                                 04350001
043600     05  FILLER                         OCCURS  1 TO 4072 TIMES   04360001
043700                                        DEPENDING ON EIBCALEN.    04370001
043800         10  FILLER                     PIC X.                    04380001
043900                                                                  04390001
044000                                                                  04400001
044100 PROCEDURE DIVISION.                                              04410001
044200******************************************************************04420001
044300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04430001
044400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04440001
044500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04450001
044600******************************************************************04460001
044700 0000-MAIN-MODULE.                                                04470001
044800     INITIALIZE DP030-CICS-API-FIELDS.                            04480001
044900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04490001
045000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04500001
045100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04510001
045200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04520001
045300     MOVE LENGTH OF CNK227I        TO DP030-MAP-LENGTH (1).       04530001
045400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04540001
045500     PERFORM 0001-CALL-CICS-ARCH-API.                             04550001
045600*                                                                 04560001
045700     PERFORM 1000-CONTROL-PROCESSING                              04570001
045800*                                                                 04580001
045900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04590001
046000     PERFORM 0001-CALL-CICS-ARCH-API.                             04600001
046100                                                                  04610001
046200******************************************************************04620001
046300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **04630001
046400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **04640001
046500******************************************************************04650001
046600 0001-CALL-CICS-ARCH-API.                                         04660001
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04670099
046800                                    DFHCOMMAREA                   04680099
046900                                    DP030-CICS-API-FIELDS         04690099
047000                                    DP020-STANDARD-COMMAREA       04700099
047100                                    CNK227I.                      04710099
047200*                                                                 04720001
047300     IF  DP030-RC-CALL-SUCCESSFUL                                 04730001
047400         CONTINUE                                                 04740001
047500     ELSE                                                         04750001
047600         SET DP013-NO-ROLLBACK                                    04760001
047700             DP013-XCTL-DISPLAY-RESTART                           04770001
047800             DP013-CICS-ABEND      TO TRUE                        04780001
047900         MOVE '0001-CALL-CICS-ARCH-API'                           04790001
048000                                   TO DP013-PARAGRAPH             04800001
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04801099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04802099
048300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04830001
048400         PERFORM DP013-0000-PROCESS-ABEND                         04840001
048500     END-IF.                                                      04850001
048600                                                                  04860001
048700*----------------------------------------------------------------*04870001
048800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04880001
048900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04890001
049000*                                                                *04900001
049100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04910001
049200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04920001
049300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04930001
049400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04940001
049500*----------------------------------------------------------------*04950001
049600 1000-CONTROL-PROCESSING.                                         04960001
049700     EVALUATE TRUE                                                04970001
049800         WHEN DP020-NEXT-ACT-INITIAL                              04980001
049900             INITIALIZE ASC-SPECIFIC-COMMAREA                     04990001
050000             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 05000001
050100                                 ASC-SEL-TERM-ID                  05010001
050200             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   05020001
050300                                           ASC-SEL-TASK-NUMBER    05030001
050400             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               05040001
050500             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                05050001
050600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05060001
050630             MOVE ASC-DOOR-ID   (1 1)  TO  DK-DOOR-ID             05063066
050640             MOVE ASC-TYPE-CODE (1 1)  TO  DK-TYPE-CODE           05064066
050700             PERFORM 4000-BUILD-INITIAL-PANEL                     05070001
050800                                                                  05080001
050900         WHEN DP020-NEXT-ACT-READ-MAP                             05090001
051000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         05100001
051100             PERFORM 2000-PROCESS-PANEL                           05110001
051200                                                                  05120001
051300         WHEN DP020-NEXT-ACT-RETURN                               05130023
051301             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         05130159
051302             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               05130259
051304             MOVE SPACES               TO  DK-DOOR-ID             05130499
051305             MOVE SPACES               TO  DK-TYPE-CODE           05130577
051306             IF CN011-FUNCTION = PC-A                             05130674
051307                 EVALUATE TRUE                                    05130777
051308                     WHEN ASC-DOOR-TYPE-CSR                       05130877
051309                         MOVE CN011-DOOR-TYPE-CDE TO DK-TYPE-CODE 05130978
051310                         MOVE SPACES              TO DK-DOOR-ID   05131099
051311                     WHEN ASC-DOOR-ID-CSR                         05131177
051312                         MOVE SPACES              TO DK-TYPE-CODE 05131277
051313                         MOVE CN011-DOOR-ID       TO DK-DOOR-ID   05131377
051314                     WHEN ASC-DOOR-CSR                            05131477
051315                         MOVE SPACES              TO DK-TYPE-CODE 05131577
051316                         MOVE SPACES              TO DK-DOOR-ID   05131699
051317                 END-EVALUATE                                     05131777
051320                 PERFORM 2050-DELETE-LIST-QUEUE                   05132077
051321                 PERFORM 4000-BUILD-INITIAL-PANEL                 05132177
051323                 PERFORM 3200-RESET-ATTRIBUTES                    05132385
051324             ELSE                                                 05132499
051326                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             05132677
051328                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05132899
051340             END-IF                                               05134077
052000                                                                  05200059
052800         WHEN OTHER                                               05280001
052900             SET DP013-LOGIC-ABEND TO TRUE                        05290001
053000             SET DP013-NO-ROLLBACK TO TRUE                        05300001
053100             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    05310001
053200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05320001
053300                                   TO DP013-MESSAGE-TEXT(1)       05330001
053400             PERFORM DP013-0000-PROCESS-ABEND                     05340001
053500     END-EVALUATE.                                                05350001
053600                                                                  05360001
053700*----------------------------------------------------------------*05370001
053800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05380001
053900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05390001
054000*----------------------------------------------------------------*05400001
054100 1100-PROCESS-INTER-APPL-COMM.                                    05410001
054200                                                                  05420001
054300     SET PS-COMMAREA-VALID         TO TRUE.                       05430001
054400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     05440001
054500                                                                  05450001
054600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          05460001
054610         SET ASC-LIST-BY-DOOR          TO TRUE                    05461099
054620         MOVE PC-DOOR                  TO ASC-ORD-SEQ             05462099
054700         MOVE CN011-FUNCTION           TO ASC-FUNCTION            05470068
054800         MOVE CN011-OPER-UNT-ID        TO ASC-OPER-UNT-ID         05480068
054900         MOVE CN011-FCLTY-NME          TO ASC-FCLTY-NAME          05490001
055000         MOVE CN011-DOOR-ID            TO ASC-DOOR-ID (1 1)       05500004
055100         MOVE CN011-DOOR-TYPE-CDE      TO ASC-TYPE-CODE (1 1)     05510004
055500     ELSE                                                         05550001
055510         MOVE CN012-FUNCTION           TO ASC-FUNCTION            05551068
055600         MOVE CN012-OPER-UNT-ID        TO ASC-OPER-UNT-ID         05560001
056100     END-IF.                                                      05610001
056200                                                                  05620001
056300*----------------------------------------------------------------*05630001
056400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05640001
056500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05650001
056600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05660001
056700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05670001
056800* FUNCTION KEYS CAN GET THIS FAR.                                *05680001
056900*----------------------------------------------------------------*05690001
057000 2000-PROCESS-PANEL.                                              05700001
057100     EVALUATE TRUE                                                05710001
057200         WHEN DP020-SRC-AID = DP016-CLEAR                         05720001
057300             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05730001
057400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05740001
057500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05750001
057600                                                                  05760001
057700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    05770001
057900             PERFORM 2050-DELETE-LIST-QUEUE                       05790045
057901             SET CN011-FUNCTION-NONE  TO TRUE                     05790190
057902             EVALUATE TRUE                                        05790290
057904                WHEN ASC-DOOR-TYPE-CSR  OR ASC-DOOR-STR-TYPE-CSR  05790499
057905                     MOVE ASC-TYPE-CODE (1 1) TO DK-TYPE-CODE     05790557
057906                     MOVE SPACES              TO DK-DOOR-ID       05790699
057907                WHEN ASC-DOOR-ID-CSR    OR ASC-DOOR-STR-ID-CSR    05790799
057908                     MOVE SPACES              TO DK-TYPE-CODE     05790857
057909                     MOVE ASC-DOOR-ID (1 1)   TO DK-DOOR-ID       05790957
057910                WHEN ASC-DOOR-CSR       OR ASC-DOOR-STR-CSR       05791099
057911                     MOVE SPACES              TO DK-TYPE-CODE     05791157
057913                                                 DK-DOOR-ID       05791399
057914             END-EVALUATE                                         05791457
057920             PERFORM 4000-BUILD-INITIAL-PANEL                     05792045
058000                                                                  05800001
058100         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   05810001
058200             PERFORM 2140-DESELECT-ALL-ITEMS                      05820001
058300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05830001
058400                                                                  05840001
058500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  05850001
058600             PERFORM 2150-SELECT-ALL-ITEMS                        05860001
058700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05870001
058900         WHEN OTHER                                               05890001
059000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05900001
059100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05910001
059200             IF  PS-NO-ERROR                                      05920001
059300                 SET DP030-CONTINUE-GO TO TRUE                    05930001
059400                 PERFORM 2100-CHECK-FUNCTION-KEY                  05940001
059500             ELSE                                                 05950001
059600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05960001
059700                 SET DP030-OVERRIDE-GO TO TRUE                    05970001
059800             END-IF                                               05980001
059900     END-EVALUATE.                                                05990001
060000                                                                  06000001
060100*----------------------------------------------------------------*06010001
060200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *06020001
060300*----------------------------------------------------------------*06030001
060400 2050-DELETE-LIST-QUEUE.                                          06040001
060500                                                                  06050001
060600     EXEC CICS                                                    06060001
060700         DELETEQ TS                                               06070001
060800             QUEUE (ASC-LIST-QUEUE-NAME)                          06080001
060900             RESP  (PV-CICS-RESP)                                 06090001
061000     END-EXEC.                                                    06100001
061100                                                                  06110001
061200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06120001
061300        (PV-CICS-RESP = DFHRESP(QIDERR))                          06130001
061400         CONTINUE                                                 06140001
061500     ELSE                                                         06150001
061600         SET DP013-CICS-ABEND      TO TRUE                        06160001
061700         SET DP013-NO-ROLLBACK     TO TRUE                        06170001
061800                                                                  06180001
061900         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         06190001
062000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    06200001
062100                                   TO DP013-MESSAGE-TEXT (1)      06210001
062200         PERFORM DP013-0000-PROCESS-ABEND                         06220001
062300     END-IF.                                                      06230001
062400                                                                  06240001
062500     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       06250001
062600                                                                  06260001
062700*----------------------------------------------------------------*06270001
062800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*06280001
062900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *06290001
063000* CICS ARCHITECTURE API.                                         *06300001
063100*----------------------------------------------------------------*06310001
063200 2100-CHECK-FUNCTION-KEY.                                         06320001
063300                                                                  06330001
063400     EVALUATE TRUE                                                06340001
063500                                                                  06350001
063600* F13 - ADD DOOR   (LOCAL-FUNC-01)                                06360001
063700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06370001
063710             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            06371099
063711             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  06371118
063720                 MOVE PC-A   TO ASC-FUNCTION                      06372087
063730                 PERFORM 2110-PREPARE-INTER-APPL-COMM             06373017
063731                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06373148
063732             ELSE                                                 06373248
063733                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06373348
063740                 SET DP030-OVERRIDE-GO TO TRUE                    06374017
063750                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        06375017
063760                 SET PS-ERROR                                     06376017
063770                     DP020-MSG-FATAL   TO TRUE                    06377017
063780             END-IF                                               06378017
065800                                                                  06580001
065810* F15 - UPDATE DOOR   (LOCAL-FUNC-02)                             06581001
065820         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06582001
065821             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            06582199
065822             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  06582218
065831                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              06583198
065840                     SET ASC-USE-SELECTION-QUEUE TO TRUE          06584098
065850                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            06585016
065851                                TO CN012-NUMBER-OF-SELECTED-ITEMS 06585111
065852                     MOVE ASC-NUMBER-OF-TS-ITEMS                  06585216
065853                                      TO CN012-NUMBER-OF-TS-ITEMS 06585316
065854                     MOVE ASC-SEL-QUEUE-NAME                      06585416
065855                                         TO  CN012-SEL-QUEUE-NAME 06585516
065856                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    06585699
065857                     MOVE DK-OPER-UNT-ID                          06585742
065859                                        TO CN012-CURR-OPER-UNT-ID 06585916
065860                     MOVE ASC-OPER-UNT-ID  TO CN012-OPER-UNT-ID   06586042
065861                     MOVE 1                TO CN012-CURR-FCLTY-ID 06586116
065862                                              CN012-FCLTY-ID      06586216
065864                     SET CN012-UPD-DOOR  TO TRUE                  06586460
065865                     PERFORM 5000-PREPARE-SEL-QUEUE               06586516
065866                 ELSE                                             06586616
065867                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06586716
065868                     SET DP030-OVERRIDE-GO TO TRUE                06586816
065869                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    06586916
065870                     SET DP020-MSG-FATAL   TO TRUE                06587016
065871                 END-IF                                           06587116
065872             ELSE                                                 06587216
065873                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06587348
065874                 SET DP030-OVERRIDE-GO TO TRUE                    06587416
065875                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        06587516
065876                 SET PS-ERROR                                     06587616
065877                     DP020-MSG-FATAL   TO TRUE                    06587716
065878             END-IF                                               06587816
065879                                                                  06587916
065880* F17 - DOOR TYPE LIST (LOCAL-FUNC-03)                            06588016
065881         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06588101
065882               MOVE SPACE TO ASC-FUNCTION                         06588276
065890               PERFORM 2110-PREPARE-INTER-APPL-COMM               06589001
065893                                                                  06589301
065894* F18 - DOOR TO STORE LIST (LOCAL-FUNC-06)                        06589499
065895         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06589599
065898              SET ASC-USE-SELECTION-QUEUE TO TRUE                 06589899
065899              MOVE ASC-NUMBER-OF-SELECTED-ITEMS                   06589999
065900                                TO CN012-NUMBER-OF-SELECTED-ITEMS 06590099
065901              MOVE ASC-NUMBER-OF-TS-ITEMS                         06590199
065902                                TO CN012-NUMBER-OF-TS-ITEMS       06590299
065903              MOVE ASC-SEL-QUEUE-NAME TO CN012-SEL-QUEUE-NAME     06590399
065904              MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID           06590499
065905              MOVE DK-OPER-UNT-ID     TO CN012-CURR-OPER-UNT-ID   06590599
065906              MOVE ASC-OPER-UNT-ID    TO CN012-OPER-UNT-ID        06590699
065907              MOVE 1                  TO CN012-CURR-FCLTY-ID      06590799
065908                                         CN012-FCLTY-ID           06590899
065909              SET CN012-LIST-STORES   TO TRUE                     06590999
065910              IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO             06591099
065911                  PERFORM 5000-PREPARE-SEL-QUEUE                  06591199
065912              END-IF                                              06591299
065913* F19 - LIST ORDER (LOCAL-FUNC-07)                                06591399
065914         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              06591499
065916             PERFORM 2050-DELETE-LIST-QUEUE                       06591699
065917                                                                  06591799
065918             IF ASC-LIST-BY-DOOR                                  06591899
065919                SET ASC-LIST-BY-STORE TO TRUE                     06591999
065920                MOVE PC-STORE         TO ASC-ORD-SEQ              06592099
065921             ELSE                                                 06592199
065922                SET ASC-LIST-BY-DOOR  TO TRUE                     06592299
065923                MOVE PC-DOOR          TO ASC-ORD-SEQ              06592399
065924             END-IF                                               06592499
065925                                                                  06592599
065926             SET CN011-FUNCTION-NONE  TO TRUE                     06592699
065927             EVALUATE TRUE                                        06592799
065928                WHEN ASC-DOOR-TYPE-CSR OR ASC-DOOR-STR-TYPE-CSR   06592899
065929                     MOVE ASC-TYPE-CODE (1 1) TO DK-TYPE-CODE     06592999
065930                     MOVE SPACES              TO DK-DOOR-ID       06593099
065931                WHEN ASC-DOOR-ID-CSR OR ASC-DOOR-STR-ID-CSR       06593199
065932                     MOVE SPACES              TO DK-TYPE-CODE     06593299
065933                     MOVE ASC-DOOR-ID (1 1)   TO DK-DOOR-ID       06593399
065934                WHEN ASC-DOOR-CSR OR ASC-DOOR-STR-CSR             06593499
065935                     MOVE SPACES              TO DK-TYPE-CODE     06593599
065936                                                 DK-DOOR-ID       06593699
065937             END-EVALUATE                                         06593799
065938             PERFORM 4000-BUILD-INITIAL-PANEL                     06593899
065939                                                                  06593999
065940* F23 - ASSIGNMENT LIST (LOCAL-FUNC-05)                           06594099
065941         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              06594199
065942             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               06594241
065943                 SET ASC-USE-SELECTION-QUEUE TO TRUE              06594311
065944                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                06594411
065945                                TO CN012-NUMBER-OF-SELECTED-ITEMS 06594511
065946                 MOVE ASC-NUMBER-OF-TS-ITEMS                      06594611
065947                                   TO CN012-NUMBER-OF-TS-ITEMS    06594711
065948                 MOVE ASC-SEL-QUEUE-NAME TO  CN012-SEL-QUEUE-NAME 06594811
065949                 MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID        06594999
065950                 MOVE DK-OPER-UNT-ID    TO CN012-CURR-OPER-UNT-ID 06595042
065951                 MOVE ASC-OPER-UNT-ID   TO CN012-OPER-UNT-ID      06595142
065952                 MOVE 1                 TO CN012-CURR-FCLTY-ID    06595242
065953                                           CN012-FCLTY-ID         06595342
065954                 SET CN012-LIST-STORES  TO TRUE                   06595460
065955                 PERFORM 5000-PREPARE-SEL-QUEUE                   06595515
065956             ELSE                                                 06595611
065957                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06595711
065958                 SET DP030-OVERRIDE-GO TO TRUE                    06595811
065959                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        06595911
065960                 SET DP020-MSG-FATAL   TO TRUE                    06596011
065961             END-IF                                               06596111
065962                                                                  06596201
065963* F24 - STORE ASSIGNMENT (LOCAL-FUNC-04)                          06596301
065964         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              06596401
065965             IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                  06596530
065966                 SET ASC-USE-SELECTION-QUEUE TO TRUE              06596611
065967                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                06596711
065968                                TO CN012-NUMBER-OF-SELECTED-ITEMS 06596811
065969                 MOVE ASC-NUMBER-OF-TS-ITEMS                      06596911
065970                                   TO CN012-NUMBER-OF-TS-ITEMS    06597011
065971                 MOVE ASC-SEL-QUEUE-NAME TO  CN012-SEL-QUEUE-NAME 06597111
065972                 MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID        06597299
065973                 MOVE DK-OPER-UNT-ID    TO CN012-CURR-OPER-UNT-ID 06597326
065974                 MOVE ASC-OPER-UNT-ID   TO CN012-OPER-UNT-ID      06597426
065975                 MOVE 1                 TO CN012-CURR-FCLTY-ID    06597526
065976                                           CN012-FCLTY-ID         06597626
065977                 MOVE ASC-FCLTY-NAME    TO CN012-FCLTY-NME        06597728
065978                 SET CN012-ASSIGN-STORES  TO TRUE                 06597860
065979                 PERFORM 5000-PREPARE-SEL-QUEUE                   06597926
065980                 IF CN013-TYPE-CODE (1) NOT = 'SH' AND 'DS' AND   06598099
065981                                              'ST'                06598199
065982                      SET PS-ERROR                                06598299
065983                          DP020-MSG-FATAL         TO TRUE         06598399
065984                      MOVE PC-TSYMSG-02575 TO DP020-MSG-NUMBER    06598499
065985                      SET DP030-OVERRIDE-GO TO TRUE               06598599
065986                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        06598699
065987                 END-IF                                           06598799
065988             ELSE                                                 06598899
065989                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06598999
065990                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        06599099
065991                 SET DP020-MSG-FATAL                              06599199
065992                     DP030-OVERRIDE-GO TO TRUE                    06599299
065993           END-IF                                                 06599399
065994                                                                  06599499
065995* F6 - FIRST PAGE                                                 06599599
066000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06600001
066100             MOVE +1               TO PV-TOP-ITEM                 06610001
066200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06620001
066300                                                                  06630001
066400* F7 - PREVIOUS PAGE                                              06640001
066500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06650001
066600             PERFORM 2110-BROWSE-BACKWARD                         06660001
066700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06670001
066800                                                                  06680001
066900* F8 - NEXT PAGE                                                  06690001
067000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06700001
067100             PERFORM 2120-BROWSE-FORWARD                          06710001
067200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06720001
067300                                                                  06730001
067400* ENTER KEY                                                       06740001
067500         WHEN DP020-SRC-AID = DP016-ENTER                         06750001
067600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06760001
067700             IF  PS-ERROR                                         06770001
067800                 CONTINUE                                         06780001
067900             ELSE                                                 06790001
068000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06800001
068100             END-IF                                               06810001
068200                                                                  06820001
068300         WHEN OTHER                                               06830001
068400             SET DP013-NO-ROLLBACK                                06840001
068500                 DP013-XCTL-DISPLAY-RESTART                       06850001
068600                 DP013-CICS-ABEND  TO TRUE                        06860001
068700             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    06870001
068800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06880001
068900                                   TO DP013-MESSAGE-TEXT (1)      06890001
069000             PERFORM DP013-0000-PROCESS-ABEND                     06900001
069100     END-EVALUATE.                                                06910001
069200                                                                  06920001
069210******************************************************************06921001
069220** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06922001
069230** INTER-APPLICATION COMMAREA.                                  **06923001
069240******************************************************************06924001
069250 2110-PREPARE-INTER-APPL-COMM.                                    06925001
069260                                                                  06926001
069270     INITIALIZE CN011-INTER-APPL-COMMAREA.                        06927001
069280                                                                  06928001
069290     MOVE ASC-FUNCTION             TO CN011-FUNCTION.             06929001
069291     MOVE DP020-LOCATION-NBR       TO DK-OPER-UNT-ID.             06929199
069292     MOVE DK-OPER-UNT-ID           TO CN011-CURR-OPER-UNT-ID.     06929242
069293     MOVE 1                        TO CN011-CURR-FCLTY-ID         06929317
069294                                      CN011-FCLTY-ID.             06929417
069295     MOVE ASC-OPER-UNT-ID          TO CN011-OPER-UNT-ID.          06929517
069296     MOVE ASC-FCLTY-NAME           TO CN011-FCLTY-NME.            06929604
069303                                                                  06930301
069310*----------------------------------------------------------------*06931001
069400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06940001
069500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06950001
069600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06960001
069700*    MESSAGE.                                                    *06970001
069800*----------------------------------------------------------------*06980001
069900 2110-BROWSE-BACKWARD.                                            06990001
070000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07000001
070100         GIVING PV-TOP-ITEM.                                      07010001
070200*                                                                 07020001
070300     IF  ((PV-TOP-ITEM < +1)                                      07030001
070400       OR (PV-TOP-ITEM = +1))                                     07040001
070500         MOVE +1                   TO PV-TOP-ITEM                 07050001
070600*        -- TOP OF LIST --                                        07060001
070700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07070001
070800         SET DP020-MSG-INFORMATIONAL TO TRUE                      07080001
070900     END-IF.                                                      07090001
071000                                                                  07100001
071100*----------------------------------------------------------------*07110001
071200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07120001
071300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07130001
071400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07140001
071500*----------------------------------------------------------------*07150001
071600 2120-BROWSE-FORWARD.                                             07160001
071700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07170001
071800         GIVING PV-TOP-ITEM.                                      07180001
071900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07190001
072000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07200001
072100*        -- BOTTOM OF LIST --                                     07210001
072200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07220001
072300         SET DP020-MSG-INFORMATIONAL TO TRUE                      07230001
072400     ELSE                                                         07240001
072500         COMPUTE PV-BOTTOM-ITEM =                                 07250001
072600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07260001
072700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07270001
072800*            -- BOTTOM OF LIST --                                 07280001
072900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07290001
073000             SET DP020-MSG-INFORMATIONAL TO TRUE                  07300001
073100         END-IF                                                   07310001
073200     END-IF.                                                      07320001
073300                                                                  07330001
073400*----------------------------------------------------------------*07340001
073500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07350001
073600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07360001
073700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07370001
073800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *07380001
073900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07390001
074000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07400001
074100*----------------------------------------------------------------*07410001
074200 2130-CHECK-FOR-JUMP-BROWSE.                                      07420001
074300     SET PS-NO-ERROR               TO TRUE.                       07430001
074400     IF (ASC-START-ITEM-REQUEST = SPACE)                          07440001
074500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07450001
074600     ELSE                                                         07460001
074700         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     07470001
074800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07480001
074900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07490001
075000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07500001
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07511099
263455              USING DP010I-NUMERIC-EDIT-AREA                      07512099
075200                                                                  07520001
075300         IF  NOT DP010I-ERROR-DETECTED                            07530001
075400             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N07540001
075500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07550001
075600                 IF  ASC-START-ITEM-REQUEST-N >                   07560001
075700                                          ASC-NUMBER-OF-ITEMS-READ07570001
075800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07580001
075900                     COMPUTE PV-TOP-ITEM =                        07590001
076000                             ASC-NUMBER-OF-ITEMS-READ             07600001
076100                             - PC-ITEMS-PER-PANEL + 1             07610001
076200                     IF  PV-TOP-ITEM < +1                         07620001
076300                         MOVE +1   TO PV-TOP-ITEM                 07630001
076400                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07640001
076500                         SET DP020-MSG-INFORMATIONAL TO TRUE      07650001
076600                     END-IF                                       07660001
076700                 ELSE                                             07670001
076800                     MOVE ASC-START-ITEM-REQUEST-N                07680001
076900                                   TO PV-TOP-ITEM                 07690001
077000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07700001
077100                     COMPUTE PV-BOTTOM-ITEM =                     07710001
077200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07720001
077300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07730001
077400*                        -- BOTTOM OF LIST --                     07740001
077500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07750001
077600                         SET DP020-MSG-INFORMATIONAL TO TRUE      07760001
077700                     END-IF                                       07770001
077800                 END-IF                                           07780001
077900             ELSE                                                 07790001
078000*                --- VALUE OUT OF RANGE ----                      07800001
078100                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         07810001
078200                 MOVE -1              TO ASTRTITL                 07820001
078300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07830001
078400                 MOVE DP015-REVERSE   TO ASTRTITH                 07840001
078500                 MOVE DP015-RED       TO ASTRTITC                 07850001
078600                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           07860001
078700                 SET DP020-MSG-FATAL  TO TRUE                     07870001
078800                 SET PS-ERROR         TO TRUE                     07880001
078900             END-IF                                               07890001
079000         ELSE                                                     07900001
079100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07910001
079200             MOVE -1               TO ASTRTITL                    07920001
079300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07930001
079400             MOVE DP015-REVERSE    TO ASTRTITH                    07940001
079500             MOVE DP015-RED        TO ASTRTITC                    07950001
079600             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               07960001
079700             SET DP020-MSG-FATAL   TO TRUE                        07970001
079800             SET PS-ERROR          TO TRUE                        07980001
079900         END-IF                                                   07990001
080000     END-IF.                                                      08000001
080100                                                                  08010001
080200*----------------------------------------------------------------*08020001
080300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *08030001
080400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *08040001
080500*----------------------------------------------------------------*08050001
080600 2140-DESELECT-ALL-ITEMS.                                         08060001
080700     MOVE +1                       TO ASC-BLK-SUB.                08070001
080800                                                                  08080001
080900     PERFORM 2141-CLEAR-SELECTED-INDS                             08090001
081000         VARYING ASC-ITEM-SUB                                     08100001
081100         FROM 1 BY 1                                              08110001
081200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08120001
081300                                                                  08130001
081400     ADD +1                        TO ASC-BLK-SUB.                08140001
081500                                                                  08150001
081600     PERFORM 2141-CLEAR-SELECTED-INDS                             08160001
081700         VARYING ASC-ITEM-SUB                                     08170001
081800         FROM 1 BY 1                                              08180001
081900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08190001
082000                                                                  08200001
082100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               08210001
082200                                   TO PV-LIST-ITEM-NUMBER.        08220001
082300                                                                  08230001
082400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            08240001
082500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    08250001
082600                                                                  08260001
082700     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            08270001
082800         MOVE +1                   TO ASC-BLK-SUB                 08280001
082900                                                                  08290001
083000         PERFORM 5100-WRITE-TEMP-STORAGE                          08300001
083100         MOVE +2                   TO ASC-BLK-SUB                 08310001
083200         PERFORM 5100-WRITE-TEMP-STORAGE                          08320001
083300         MOVE +1                   TO ASC-BLK-SUB                 08330001
083400         MOVE +1                   TO PV-BLOCK-NUMBER             08340001
083500     END-IF.                                                      08350001
083600                                                                  08360001
083700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     08370001
083800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      08380001
083900         MOVE +1                   TO ASC-BLK-SUB                 08390001
084000                                                                  08400001
084100         PERFORM 5100-WRITE-TEMP-STORAGE                          08410001
084200         MOVE +2  TO ASC-BLK-SUB                                  08420001
084300         PERFORM 5100-WRITE-TEMP-STORAGE                          08430001
084400         MOVE +1  TO ASC-BLK-SUB                                  08440001
084500         MOVE +1  TO PV-BLOCK-NUMBER                              08450001
084600                                                                  08460001
084700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         08470001
084800             PV-FIRST-BLOCK-IN-ARRAY - 1                          08480001
084900                                                                  08490001
085000         PERFORM                                                  08500001
085100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       08510001
085200                                                                  08520001
085300             PERFORM 4410-READ-TEMP-STORAGE                       08530001
085400                                                                  08540001
085500             PERFORM 2141-CLEAR-SELECTED-INDS                     08550001
085600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 08560001
085700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08570001
085800                                                                  08580001
085900             PERFORM 5100-WRITE-TEMP-STORAGE                      08590001
086000                                                                  08600001
086100             ADD +1                TO PV-BLOCK-NUMBER             08610001
086200                                                                  08620001
086300         END-PERFORM                                              08630001
086400                                                                  08640001
086500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         08650001
086600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     08660001
086700                                                                  08670001
086800         PERFORM                                                  08680001
086900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       08690001
087000                   ASC-HIGHEST-BLOCK-WRITTEN                      08700001
087100                                                                  08710001
087200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          08720001
087300                                   TO PV-BLOCK-NUMBER             08730001
087400                                                                  08740001
087500             PERFORM 4410-READ-TEMP-STORAGE                       08750001
087600                                                                  08760001
087700             PERFORM 2141-CLEAR-SELECTED-INDS                     08770001
087800                 VARYING ASC-ITEM-SUB                             08780001
087900                 FROM 1 BY 1                                      08790001
088000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08800001
088100                                                                  08810001
088200             PERFORM 5100-WRITE-TEMP-STORAGE                      08820001
088300                                                                  08830001
088400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      08840001
088500                                                                  08850001
088600         END-PERFORM                                              08860001
088700                                                                  08870001
088800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             08880001
088900                                   TO PV-BLOCK-NUMBER             08890001
089000                                                                  08900001
089100         PERFORM 4410-READ-TEMP-STORAGE                           08910001
089200     END-IF.                                                      08920001
089300                                                                  08930001
089400                                                                  08940001
089500     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 08950001
089600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.08960001
089700     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  08970001
089800                                                                  08980001
089900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08990001
090000                                                                  09000001
090100*----------------------------------------------------------------*09010001
090200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *09020001
090300*----------------------------------------------------------------*09030001
090400 2141-CLEAR-SELECTED-INDS.                                        09040001
090500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           09050001
090600             NOT EQUAL ZERO                                       09060001
090700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          09070001
090800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          09080001
090900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    09090001
091000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          09100001
091100         END-IF                                                   09110001
091200     END-IF.                                                      09120001
091300                                                                  09130001
091400*----------------------------------------------------------------*09140001
091500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *09150001
091600*  FOR ALL ITEMS.                                                *09160001
091700*----------------------------------------------------------------*09170001
091800 2150-SELECT-ALL-ITEMS.                                           09180001
091900     MOVE +1                       TO ASC-BLK-SUB.                09190001
092000                                                                  09200001
092100     PERFORM 2151-SET-SELECTED-INDS                               09210001
092200         VARYING ASC-ITEM-SUB                                     09220001
092300         FROM 1 BY 1                                              09230001
092400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09240001
092500                                                                  09250001
092600     ADD +1                        TO ASC-BLK-SUB.                09260001
092700                                                                  09270001
092800     PERFORM 2151-SET-SELECTED-INDS                               09280001
092900         VARYING ASC-ITEM-SUB                                     09290001
093000         FROM 1 BY 1                                              09300001
093100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09310001
093200                                                                  09320001
093300     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      09330001
093400                                                                  09340001
093500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09350001
093600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    09360001
093700                                                                  09370001
093800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            09380001
093900         MOVE +1                   TO ASC-BLK-SUB                 09390001
094000                                                                  09400001
094100         PERFORM 5100-WRITE-TEMP-STORAGE                          09410001
094200         MOVE +2                   TO ASC-BLK-SUB                 09420001
094300         PERFORM 5100-WRITE-TEMP-STORAGE                          09430001
094400         MOVE +1                   TO ASC-BLK-SUB                 09440001
094500         MOVE +1                   TO PV-BLOCK-NUMBER             09450001
094600     END-IF.                                                      09460001
094700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09470001
094800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    09480001
094900         MOVE +1                   TO ASC-BLK-SUB                 09490001
095000                                                                  09500001
095100         PERFORM 5100-WRITE-TEMP-STORAGE                          09510001
095200                                                                  09520001
095300         MOVE +1                   TO PV-BLOCK-NUMBER             09530001
095400                                                                  09540001
095500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09550001
095600             PV-FIRST-BLOCK-IN-ARRAY - 1                          09560001
095700                                                                  09570001
095800         PERFORM                                                  09580001
095900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09590001
096000                                                                  09600001
096100             PERFORM 4410-READ-TEMP-STORAGE                       09610001
096200                                                                  09620001
096300             PERFORM 2151-SET-SELECTED-INDS                       09630001
096400                 VARYING ASC-ITEM-SUB                             09640001
096500                 FROM 1 BY 1                                      09650001
096600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09660001
096700                                                                  09670001
096800             PERFORM 5100-WRITE-TEMP-STORAGE                      09680001
096900                                                                  09690001
097000             ADD +1                TO PV-BLOCK-NUMBER             09700001
097100                                                                  09710001
097200         END-PERFORM                                              09720001
097300                                                                  09730001
097400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09740001
097500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09750001
097600                                                                  09760001
097700         PERFORM                                                  09770001
097800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09780001
097900                   ASC-HIGHEST-BLOCK-WRITTEN                      09790001
098000                                                                  09800001
098100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09810001
098200                                   TO PV-BLOCK-NUMBER             09820001
098300                                                                  09830001
098400             PERFORM 4410-READ-TEMP-STORAGE                       09840001
098500                                                                  09850001
098600             PERFORM 2151-SET-SELECTED-INDS                       09860001
098700                 VARYING ASC-ITEM-SUB                             09870001
098800                 FROM 1 BY 1                                      09880001
098900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09890001
099000                                                                  09900001
099100             PERFORM 5100-WRITE-TEMP-STORAGE                      09910001
099200                                                                  09920001
099300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09930001
099400                                                                  09940001
099500         END-PERFORM                                              09950001
099600                                                                  09960001
099700         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         09970001
099800                                                                  09980001
099900         PERFORM 4410-READ-TEMP-STORAGE                           09990001
100000     END-IF.                                                      10000001
100100                                                                  10010001
100200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             10020001
100300                       ASC-NUMBER-OF-SELECTED-ITEMS.              10030001
100400                                                                  10040001
100500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10050001
100600                                                                  10060001
100700*----------------------------------------------------------------*10070001
100800*    MARK EACH ITEM AS BEING SELECTED.                           *10080001
100900*----------------------------------------------------------------*10090001
101000 2151-SET-SELECTED-INDS.                                          10100001
101100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10110001
101200             NOT EQUAL ZERO                                       10120001
101300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10130001
101400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10140001
101500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        10150001
101600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10160001
101700                               TO  TRUE                           10170001
101800         END-IF                                                   10180001
101900     END-IF.                                                      10190001
102000                                                                  10200001
102100******************************************************************10210001
102200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **10220001
102300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **10230001
102400******************************************************************10240001
102500 2200-MOVE-SCREEN-TO-COMMAREA.                                    10250001
102600                                                                  10260001
102700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             10270001
102800     MOVE +1                       TO PV-SUB.                     10280001
102900*                                                                 10290001
103000     PERFORM 3100-SET-SUBSCRIPTS.                                 10300001
103100                                                                  10310001
103200     IF  ASTRTITL > ZERO                                          10320001
103300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          10330001
103400     ELSE                                                         10340001
103500         IF  ASTRTITF = DP015-ERASE-EOF                           10350001
103600             INITIALIZE ASC-START-ITEM-REQUEST                    10360001
103700         END-IF                                                   10370001
103800     END-IF.                                                      10380001
103900                                                                  10390001
105000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          10500099
105100         VARYING PV-SUB FROM 1 BY 1                               10510001
105200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      10520001
105300                                                                  10530001
105400******************************************************************10540001
105500** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**10550080
105600******************************************************************10560001
105700 2210-MOVE-LINES-TO-COMMAREA.                                     10570001
105800     IF  MR-SELECTL (PV-SUB) > ZERO                               10580001
105900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             10590099
106000         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        10600099
106100                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10610099
106200     ELSE                                                         10620099
106300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                10630099
106400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     10640099
106500                 MOVE SPACE  TO ASC-TEMP-SELECTED-SW              10650099
106600                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10660099
106710         END-IF                                                   10671099
106800     END-IF.                                                      10680099
106900                                                                  10690001
107000     ADD +1                        TO ASC-ITEM-SUB.               10700001
107100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        10710001
107200         ADD +1                    TO ASC-BLK-SUB                 10720001
107300         MOVE +1                   TO ASC-ITEM-SUB                10730001
107400     END-IF.                                                      10740001
107500                                                                  10750001
107600******************************************************************10760001
107700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **10770001
107800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **10780001
107900******************************************************************10790001
108000 3000-EDIT-DATA-IN-COMMAREA.                                      10800001
108100     PERFORM 3200-RESET-ATTRIBUTES.                               10810085
108200     SET PS-NO-ERROR               TO TRUE.                       10820085
108300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     10830001
108500                                                                  10850001
108600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              10860001
108700* EDITTING IS DONE FROM THE BOTTOM UP.                            10870001
108800**                                                                10880001
108900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       10890001
109000         ASC-ITEMS-DISPLAYED - 1.                                 10900001
109100     PERFORM 3100-SET-SUBSCRIPTS.                                 10910001
109200                                                                  10920001
109300      IF  PS-NO-ERROR                                             10930001
109400          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       10940001
109500      END-IF.                                                     10950001
109600                                                                  10960001
109700     IF  PS-NO-ERROR                                              10970001
109800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        10980001
109900     END-IF.                                                      10990001
110000                                                                  11000001
110100     IF  ((PS-NO-ERROR)                                           11010001
110200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   11020001
110300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    11030001
110400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  11040001
110500     END-IF.                                                      11050001
110600                                                                  11060001
110700*----------------------------------------------------------------*11070001
110800* 3005-EDIT-COMMAREA-BLOCKS                                      *11080001
110900*----------------------------------------------------------------*11090001
111000 3005-EDIT-COMMAREA-BLOCKS.                                       11100001
111100     MOVE +1                       TO PV-BLOCK-NUMBER.            11110001
111200     MOVE +1                       TO ASC-BLK-SUB.                11120001
111300     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               11130001
111400                                                                  11140001
111500     COMPUTE PV-BLOCK-NUMBER  =                                   11150001
111600             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            11160001
111700             PC-ITEMS-PER-PANEL.                                  11170001
111800                                                                  11180001
111900     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          11190001
112000                                                                  11200001
112100     PERFORM                                                      11210001
112200        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         11220001
112300           OR PS-ERROR                                            11230001
112400           OR PS-BLOCK-ERROR                                      11240001
112500                                                                  11250001
112600              COMPUTE PV-ITEMS-HOLD  =                            11260001
112700                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       11270001
112800                      PC-ITEMS-PER-PANEL - 1                      11280001
112900                                                                  11290001
113000               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     11300001
113100                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             11310001
113200                       FROM  PV-ITEMS-HOLD                        11320001
113300                     GIVING  PV-ITEMS-DIFF                        11330001
113400                   SUBTRACT  PV-ITEMS-DIFF                        11340001
113500                       FROM  PC-ITEMS-PER-PANEL                   11350001
113600                     GIVING  PV-ITEMS-HOLD                        11360001
113700                       MOVE  PV-ITEMS-HOLD TO PV-SUB              11370001
113800                                              ASC-ITEM-SUB        11380001
113900                                              ASC-ITEMS-DISPLAYED 11390001
114100               ELSE                                               11410001
114200                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            11420001
114300                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      11430001
114400               END-IF                                             11440001
114500                                                                  11450001
114600               PERFORM 3300-EDIT-SELECTIONS                       11460001
114700                       VARYING PV-SUB                             11470001
114800                          FROM PV-SUB BY -1                       11480001
114900                          UNTIL PV-SUB < +1                       11490099
115000                                                                  11500001
115100               MOVE +1               TO ASC-BLK-SUB               11510001
115200                                                                  11520001
115300               PERFORM 5105-REWRITE-ASC-LISTQ                     11530001
115400                                                                  11540001
115500               MOVE +1                TO ASC-BLK-SUB              11550001
115600                                                                  11560001
115700               IF  PS-BLOCK-ERROR                                 11570001
115800                   SET  PS-ERROR     TO TRUE                      11580001
115900                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      11590001
116000                                     TO PV-TOP-ITEM               11600001
116100               ELSE                                               11610001
116200                   ADD  +1           TO PV-BLOCK-NUMBER           11620001
116300                   IF  PV-BLOCK-NUMBER >                          11630099
116400                       ASC-HIGHEST-BLOCK-WRITTEN                  11640099
116500                       MOVE +2       TO ASC-BLK-SUB               11650001
116600                       PERFORM 4410-READ-TEMP-STORAGE             11660001
116700                       MOVE +1       TO ASC-BLK-SUB               11670001
116800                   ELSE                                           11680001
116900                       PERFORM 4410-READ-TEMP-STORAGE             11690001
117000                       ADD  +1        TO PV-BLOCK-NUMBER          11700001
117100                       MOVE +2        TO ASC-BLK-SUB              11710001
117200                       PERFORM 4410-READ-TEMP-STORAGE             11720001
117300                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          11730001
117400                       MOVE +1        TO ASC-BLK-SUB              11740001
117500               END-IF                                             11750001
117600           END-IF                                                 11760001
117700     END-PERFORM.                                                 11770001
117800                                                                  11780001
117900     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           11790099
117910          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     11791099
118000         PS-ERROR                   OR                            11800001
118100         PS-BLOCK-ERROR                                           11810001
118200             CONTINUE                                             11820001
118300     ELSE                                                         11830001
118400         MOVE +1                 TO PV-BLOCK-NUMBER               11840001
118500         MOVE +1                 TO ASC-BLK-SUB                   11850001
118600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  11860001
118700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           11870001
118800         PERFORM 4410-READ-TEMP-STORAGE                           11880001
118900                                                                  11890001
119000         PERFORM                                                  11900001
119100            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             11910001
119200               OR PS-ERROR                                        11920001
119300               OR PS-BLOCK-ERROR                                  11930001
119400                                                                  11940001
119500                  COMPUTE PV-ITEMS-HOLD  =                        11950001
119600                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   11960001
119700                          PC-ITEMS-PER-PANEL - 1                  11970001
119800                                                                  11980001
119900                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    11990001
120000                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          12000001
120100                          FROM  PV-ITEMS-HOLD                     12010001
120200                        GIVING  PV-ITEMS-DIFF                     12020001
120300                      SUBTRACT  PV-ITEMS-DIFF                     12030001
120400                          FROM  PC-ITEMS-PER-PANEL                12040001
120500                        GIVING  PV-ITEMS-HOLD                     12050001
120600                          MOVE  PV-ITEMS-HOLD TO PV-SUB           12060001
120700                                                 ASC-ITEM-SUB     12070001
120800                                              ASC-ITEMS-DISPLAYED 12080001
120900                  ELSE                                            12090001
121000                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         12100001
121100                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   12110001
121200                  END-IF                                          12120001
121300                                                                  12130001
121400                  PERFORM 3300-EDIT-SELECTIONS                    12140001
121500                          VARYING PV-SUB                          12150001
121600                             FROM PV-SUB BY -1                    12160001
121700                            UNTIL PV-SUB < +1                     12170001
121800                                                                  12180001
122000                  MOVE +1               TO ASC-BLK-SUB            12200001
122100                                                                  12210001
122200                  PERFORM 5105-REWRITE-ASC-LISTQ                  12220001
122300                                                                  12230001
122400                  MOVE +1                TO ASC-BLK-SUB           12240001
122500                                                                  12250001
122600                  IF  PS-BLOCK-ERROR                              12260001
122700                      SET  PS-ERROR     TO TRUE                   12270001
122800                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   12280001
122900                                        TO PV-TOP-ITEM            12290001
123000                  ELSE                                            12300001
123100                      ADD  +1            TO PV-BLOCK-NUMBER       12310001
123200                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     12320001
123300                          MOVE +2        TO ASC-BLK-SUB           12330001
123400                          PERFORM 4410-READ-TEMP-STORAGE          12340001
123500                          MOVE +1        TO ASC-BLK-SUB           12350001
123600                      ELSE                                        12360001
123700                          PERFORM 4410-READ-TEMP-STORAGE          12370001
123800                          ADD  +1        TO PV-BLOCK-NUMBER       12380001
123900                          MOVE +2        TO ASC-BLK-SUB           12390001
124000                          PERFORM 4410-READ-TEMP-STORAGE          12400001
124100                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       12410001
124200                          MOVE +1        TO ASC-BLK-SUB           12420001
124300                      END-IF                                      12430001
124400                  END-IF                                          12440001
124500     END-PERFORM.                                                 12450001
124510     MOVE +0 TO PV-ITEMS-HOLD.                                    12451099
124600                                                                  12460001
132250*----------------------------------------------------------------*13225001
132300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13230001
132400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13240001
132500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13250001
132600*                                                                *13260001
132700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13270001
132800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13280001
132900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13290001
133000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13300001
133100*----------------------------------------------------------------*13310001
133200 3100-SET-SUBSCRIPTS.                                             13320001
133300     COMPUTE ASC-ITEM-SUB =                                       13330001
133400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        13340001
133500                                                                  13350001
133600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13360001
133700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13370001
133800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               13380001
133900     ELSE                                                         13390001
134000         MOVE +1                     TO ASC-BLK-SUB               13400001
134100     END-IF.                                                      13410001
134200                                                                  13420001
134300******************************************************************13430001
134400** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **13440001
134500******************************************************************13450001
134600 3200-RESET-ATTRIBUTES.                                           13460001
134700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   13470001
134900     MOVE DP015-GREEN              TO ASTRTITC.                   13490001
135100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   13510001
135300                                                                  13530001
135400     PERFORM                                                      13540001
135500         VARYING PV-SUB                                           13550001
135600         FROM 1 BY 1                                              13560001
135620         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        13562099
135800         MOVE DP015-UNP-ALP-NOR-OFF                               13580001
135900                                   TO MR-SELECTA (PV-SUB)         13590001
136000         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         13600001
136100         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         13610001
136600     END-PERFORM.                                                 13660001
136700                                                                  13670001
136800******************************************************************13680001
136900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **13690001
137000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **13700001
137100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **13710001
137200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **13720001
137300******************************************************************13730001
137400 3300-EDIT-SELECTIONS.                                            13740001
137500     EVALUATE TRUE                                                13750001
137600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13760001
137700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         13770001
137800                 CONTINUE                                         13780001
137900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         13790001
138000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        13800001
138100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   13810001
138200                 MOVE ASC-TEMP-SELECTED-SW                        13820001
138300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13830001
138400                                TO ASC-SELECTED-SW                13840001
138500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13850001
138600             END-IF                                               13860001
138700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13870001
138800                 = SPACE                                          13880001
138900             EVALUATE TRUE                                        13890001
139000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       13900001
139100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS13910001
139200                     MOVE SPACE TO ASC-SELECTED-SW                13920001
139300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13930001
139400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        13940001
139500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    13950001
139600                     MOVE SPACE TO ASC-SELECTED-SW                13960001
139700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13970001
139800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          13980001
139900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      13990001
140000                     MOVE SPACE TO ASC-SELECTED-SW                14000001
140100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14010001
140200             END-EVALUATE                                         14020001
140300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14030001
140400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14040001
140500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14050001
140600             END-IF                                               14060001
140700             PERFORM 3310-EDIT-RANGE                              14070001
140800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14080001
140900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14090001
141000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14100001
141100             END-IF                                               14110001
141200             PERFORM 3310-EDIT-RANGE                              14120001
141300         WHEN OTHER                                               14130001
141400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14140001
141500             SET DP020-MSG-FATAL    TO TRUE                       14150001
141600             MOVE -1                TO ASTRTITL                   14160001
141700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14170001
141800*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14180001
141900*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14190001
142000             SET PS-ERROR TO TRUE                                 14200001
142100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14210001
142200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14220001
142300                 MOVE SPACE         TO ASC-SELECTED-SW            14230001
142400                                        (ASC-BLK-SUB ASC-ITEM-SUB)14240001
142500             END-IF                                               14250001
142600     END-EVALUATE.                                                14260001
142700                                                                  14270001
142800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14280001
142900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14290001
143000     IF  ASC-ITEM-SUB < 1                                         14300001
143100         SUBTRACT +1 FROM ASC-BLK-SUB                             14310001
143200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                14320001
143300     END-IF.                                                      14330001
143400                                                                  14340001
143500******************************************************************14350001
143600** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **14360001
143700** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **14370001
143800** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**14380001
143900** THE ENDING.                                                  **14390001
144000******************************************************************14400001
144100 3310-EDIT-RANGE.                                                 14410001
144200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                14420001
144300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   14430001
144400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)14440001
144500                                   TO ASC-SELECTED-SW             14450001
144600                                        (ASC-BLK-SUB ASC-ITEM-SUB)14460001
144700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 14470001
144800         ELSE                                                     14480001
144900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     14490001
145000                 CONTINUE                                         14500001
145100             ELSE                                                 14510001
145200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        14520001
145300                 MOVE PC-TSYMSG-00054                             14530001
145400                                   TO DP020-MSG-NUMBER            14540001
145500                 SET DP020-MSG-FATAL                              14550001
145600                                   TO TRUE                        14560001
145800                 MOVE -1           TO ASTRTITL                    14580001
145900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14590001
146000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         14600047
146100                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      14610047
146200                 SET PS-ERROR      TO TRUE                        14620001
146300             END-IF                                               14630001
146400         END-IF                                                   14640001
146500     ELSE                                                         14650001
146600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     14660001
146700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 14670001
146800                                   TO ASC-SELECTED-SW             14680001
146900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   14690001
147000             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   14700001
147100         ELSE                                                     14710001
147200             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       14720001
147300                 CONTINUE                                         14730001
147400             ELSE                                                 14740001
147500*                -- ONLY ONE END-OF-RANGE ALLOWED --              14750001
147600                 MOVE PC-TSYMSG-00055                             14760001
147700                                   TO DP020-MSG-NUMBER            14770001
147800                 SET DP020-MSG-FATAL                              14780001
147900                                   TO TRUE                        14790001
148100                 MOVE -1           TO ASTRTITL                    14810001
148200                 SET DP030-SET-CURSOR-APPL-1                      14820001
148300                                   TO TRUE                        14830001
148400                 SET PS-ERROR      TO TRUE                        14840001
148500             END-IF                                               14850001
148600         END-IF                                                   14860001
148700     END-IF.                                                      14870001
148800*                                                                 14880001
148900******************************************************************14890001
149000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **14900001
149100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **14910001
149200******************************************************************14920001
149300 3400-CHECK-RANGE-SEQUENCE.                                       14930001
149400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       14940001
149500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      14950001
149600       AND  ASC-START-OF-SELECTED-RANGE >                         14960001
149700                                         ASC-END-OF-SELECTED-RANGE14970001
149800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                14980001
149900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 14990001
150000         SET DP020-MSG-FATAL TO TRUE                              15000001
150100         SET PS-ERROR TO TRUE                                     15010001
150200         PERFORM 3410-POSITION-AT-ERROR                           15020001
150300     END-IF.                                                      15030001
150400                                                                  15040001
150500******************************************************************15050001
150600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15060001
150700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15070001
150800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15080001
150900******************************************************************15090001
151000 3410-POSITION-AT-ERROR.                                          15100001
151100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       15110001
151200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15120001
151300                    - PV-TOP-ITEM + 1.                            15130001
151400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15140001
151500         CONTINUE                                                 15150001
151600     ELSE                                                         15160001
151700         MOVE -1                   TO MR-SELECTL (PV-SUB)         15170001
151800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15180001
151900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15190001
152000     END-IF.                                                      15200001
152100                                                                  15210001
152200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15220001
152300                    - PV-TOP-ITEM + 1.                            15230001
152400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15240001
152500         CONTINUE                                                 15250001
152600     ELSE                                                         15260001
152700         MOVE -1                   TO MR-SELECTL (PV-SUB)         15270001
152800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15280001
152900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15290001
153000     END-IF.                                                      15300001
153100                                                                  15310001
153200*----------------------------------------------------------------*15320001
153300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *15330001
153400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *15340001
153500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *15350001
153600*----------------------------------------------------------------*15360001
153700 3500-MARK-RANGE-AS-SELECTED.                                     15370001
153800     MOVE +1                       TO  ASC-BLK-SUB.               15380001
153900     PERFORM 3510-MARK-SELECTED-INDS                              15390001
154000         VARYING ASC-ITEM-SUB                                     15400001
154100         FROM 1 BY 1                                              15410001
154200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15420001
154300                                                                  15430001
154400     ADD +1                        TO ASC-BLK-SUB.                15440001
154500     PERFORM 3510-MARK-SELECTED-INDS                              15450001
154600         VARYING ASC-ITEM-SUB                                     15460001
154700         FROM 1 BY 1                                              15470001
154800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15480001
154900                                                                  15490001
155000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15500001
155100                                   TO  PV-LIST-ITEM-NUMBER.       15510001
155200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15520001
155300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         15530001
155400               PC-ITEMS-PER-PANEL).                               15540001
155500                                                                  15550001
155600     MOVE ASC-START-OF-SELECTED-RANGE                             15560001
155700                                   TO PV-START-OF-SELECTED-RANGE. 15570001
155800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            15580001
155900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  15590001
156000               PC-ITEMS-PER-PANEL).                               15600001
156100                                                                  15610001
156200     MOVE ASC-END-OF-SELECTED-RANGE                               15620001
156300                                   TO  PV-END-OF-SELECTED-RANGE.  15630001
156400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             15640001
156500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    15650001
156600               PC-ITEMS-PER-PANEL).                               15660001
156700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             15670001
156800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             15680001
156900                                                                  15690001
157000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    15700001
157100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        15710001
157200         MOVE +1                   TO ASC-BLK-SUB                 15720001
157300         PERFORM 5100-WRITE-TEMP-STORAGE                          15730001
157400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15740001
157500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15750001
157600                                                                  15760001
157700         PERFORM                                                  15770001
157800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      15780001
157900                   PV-PREV-BLOCK-IN-ARRAY                         15790001
158000             MOVE PV-FIRST-BLOCK-IN-RANGE                         15800001
158100                                   TO PV-BLOCK-NUMBER             15810001
158200             PERFORM 4410-READ-TEMP-STORAGE                       15820001
158300             PERFORM 3510-MARK-SELECTED-INDS                      15830001
158400                 VARYING ASC-ITEM-SUB                             15840001
158500                 FROM 1 BY 1                                      15850001
158600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15860001
158700             PERFORM 5100-WRITE-TEMP-STORAGE                      15870001
158800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     15880001
158900         END-PERFORM                                              15890001
159000                                                                  15900001
159100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15910001
159200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15920001
159300         PERFORM                                                  15930001
159400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15940001
159500                   PV-LAST-BLOCK-IN-RANGE                         15950001
159600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15960001
159700                                   TO PV-BLOCK-NUMBER             15970001
159800             PERFORM 4410-READ-TEMP-STORAGE                       15980001
159900             PERFORM 3510-MARK-SELECTED-INDS                      15990001
160000                 VARYING ASC-ITEM-SUB                             16000001
160100                 FROM 1 BY 1                                      16010001
160200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16020001
160300             PERFORM 5100-WRITE-TEMP-STORAGE                      16030001
160400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16040001
160500         END-PERFORM                                              16050001
160600                                                                  16060001
160700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16070001
160800                                   TO PV-BLOCK-NUMBER             16080001
160900         PERFORM 4410-READ-TEMP-STORAGE                           16090001
161000     END-IF.                                                      16100001
161100                                                                  16110001
161200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16120001
161300                                      ASC-END-OF-SELECTED-RANGE.  16130001
161400                                                                  16140001
161500*----------------------------------------------------------------*16150001
161600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16160001
161700*----------------------------------------------------------------*16170001
161800 3510-MARK-SELECTED-INDS.                                         16180001
161900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16190001
162000                                ASC-ITEM-SUB) >                   16200001
162100         ASC-START-OF-SELECTED-RANGE)                             16210001
162200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16220001
162300                                ASC-ITEM-SUB) =                   16230001
162400         ASC-START-OF-SELECTED-RANGE)                             16240001
162500                                                                  16250001
162600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16260001
162700                                    ASC-ITEM-SUB) <               16270001
162800             ASC-END-OF-SELECTED-RANGE)                           16280001
162900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     16290001
163000                                    ASC-ITEM-SUB) =               16300001
163100             ASC-END-OF-SELECTED-RANGE)                           16310001
163200                                                                  16320001
163300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16330001
163400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   16340001
163500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   16350001
163600                               TO TRUE                            16360001
163700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              16370001
163800                               TO TRUE                            16380001
163900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    16390001
164000             END-IF                                               16400001
164100         END-IF                                                   16410001
164200     END-IF.                                                      16420001
164300                                                                  16430001
164400*----------------------------------------------------------------*16440001
164500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16450001
164600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16460001
164700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16470001
164800*    DISPLAY THE PANEL TO USER.                                  *16480001
164900*----------------------------------------------------------------*16490001
165000 4000-BUILD-INITIAL-PANEL.                                        16500001
165100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16510049
165200                                 ASC-BLOCK-ENTRIES (2).           16520049
165300     MOVE +1                   TO ASC-BLK-SUB.                    16530001
165400     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           16540001
165500                                                                  16550001
165600     MOVE +0                 TO ASC-ITEM-SUB                      16560001
165700                                ASC-NUMBER-OF-ITEMS-READ          16570001
165800                                ASC-NUMBER-OF-SELECTED-ITEMS      16580001
165900                                ASC-HIGHEST-BLOCK-WRITTEN         16590001
166000                                ASC-START-OF-SELECTED-RANGE       16600001
166100                                ASC-END-OF-SELECTED-RANGE         16610001
166200                                ASC-ITEM-AT-TOP-OF-PANEL.         16620001
166300                                                                  16630001
166310                                                                  16631099
166311     IF ASC-LIST-BY-DOOR                                          16631199
166400        PERFORM 4100-PREPARE-CURSOR                               16640099
166500        PERFORM 4010-OPEN-CURSOR                                  16650099
166600        PERFORM 4300-READ-ITEMS-FROM-DB                           16660099
166700        PERFORM 4020-CLOSE-CURSOR                                 16670099
166800     ELSE                                                         16680099
166810        PERFORM 4200-PREPARE-STORE-CURSOR                         16681099
166820        PERFORM 4015-OPEN-STORE-CURSOR                            16682099
166830        PERFORM 4300-READ-ITEMS-FROM-DB                           16683099
166840        PERFORM 4025-CLOSE-STORE-CURSOR                           16684099
166850     END-IF                                                       16685099
166860                                                                  16686099
166900     MOVE +1                   TO  PV-TOP-ITEM.                   16690001
167000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          16700001
167100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    16710073
167200         SET DP020-MSG-FATAL   TO  TRUE                           16720001
167300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               16730001
167400     ELSE                                                         16740001
167500         MOVE -1               TO MR-SELECTL (1)                  16750032
167600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16760032
167700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     16770043
167800     END-IF.                                                      16780001
167900                                                                  16790001
168000*----------------------------------------------------------------*16800001
168100* OPEN THE CURSOR.                                               *16810001
168200*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *16820001
168300*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *16830001
168400*   ASSOCIATE.                                                   *16840001
168500*----------------------------------------------------------------*16850001
168600 4010-OPEN-CURSOR.                                                16860001
168700     PERFORM                                                      16870001
168800         WITH TEST AFTER                                          16880001
168900         VARYING PV-RETRY-COUNTER                                 16890001
169000         FROM 1 BY 1                                              16900001
169100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16910001
169200                   OR (SQLCODE = ZERO))                           16920001
169300                                                                  16930001
169400         EVALUATE TRUE                                            16940001
169500             WHEN ASC-DOOR-CSR                                    16950001
169600                  MOVE 'CURSOR:  DOOR-CSR'                        16960001
169700                                        TO DP013-MESSAGE-TEXT (2) 16970001
169800                  EXEC SQL                                        16980001
169900                      OPEN DOOR-CSR                               16990001
170000                  END-EXEC                                        17000001
170100                                                                  17010001
170200             WHEN ASC-DOOR-TYPE-CSR                               17020001
170300                 MOVE 'CURSOR:  DOOR-TYPE-CSR'                    17030001
170400                                        TO DP013-MESSAGE-TEXT (2) 17040001
170500                   EXEC SQL                                       17050001
170600                      OPEN DOOR-TYPE-CSR                          17060001
170700                   END-EXEC                                       17070001
170800                                                                  17080001
170810             WHEN ASC-DOOR-ID-CSR                                 17081001
170820                 MOVE 'CURSOR:  DOOR-ID-CSR'                      17082001
170830                                        TO DP013-MESSAGE-TEXT (2) 17083001
170840                   EXEC SQL                                       17084001
170850                      OPEN DOOR-ID-CSR                            17085001
170860                   END-EXEC                                       17086001
170870                                                                  17087001
170900         END-EVALUATE                                             17090001
171000                                                                  17100001
171100         EVALUATE TRUE                                            17110001
171200             WHEN SQLCODE = ZERO                                  17120001
171300             WHEN SQLCODE = -904                                  17130001
171400             WHEN SQLCODE = -913                                  17140001
171500                 CONTINUE                                         17150001
171600             WHEN SQLWARN0 NOT = SPACES                           17160001
171700             WHEN SQLCODE < ZERO                                  17170001
171800             WHEN SQLCODE > ZERO                                  17180001
171900                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       17190001
172000                 MOVE 'UNABLE TO OPEN A CURSOR -'                 17200001
172100                                   TO DP013-MESSAGE-TEXT (1)      17210001
172200                 MOVE SQLCA        TO DP013-SQLCA                 17220001
172300                 MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)    17230001
172400                 SET DP013-DB2-ABEND                              17240001
172500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17250001
172600                 PERFORM DP013-0000-PROCESS-ABEND                 17260001
172700         END-EVALUATE                                             17270001
172800     END-PERFORM.                                                 17280001
172900                                                                  17290001
173000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17300001
173100         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             17310001
173200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   17320001
173300                                   TO DP013-MESSAGE-TEXT (1)      17330001
173400         MOVE SQLCA                TO DP013-SQLCA                 17340001
173500         MOVE 'TCNDCDR '           TO DP013-DB2-TABLE-NAME (1)    17350001
173600         SET DP013-DB2-ABEND                                      17360001
173700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   17370001
173800         PERFORM DP013-0000-PROCESS-ABEND                         17380001
173900     END-IF.                                                      17390001
174000                                                                  17400001
174100*----------------------------------------------------------------*17410001
174200* OPEN THE CURSOR (STORE CURSORS)                                *17420099
174300*----------------------------------------------------------------*17430001
174400 4015-OPEN-STORE-CURSOR.                                          17440099
174401     PERFORM                                                      17440199
174402         WITH TEST AFTER                                          17440299
174403         VARYING PV-RETRY-COUNTER                                 17440399
174404         FROM 1 BY 1                                              17440499
174405         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17440599
174406                   OR (SQLCODE = ZERO))                           17440699
174407                                                                  17440799
174408         EVALUATE TRUE                                            17440899
174409             WHEN ASC-DOOR-STR-CSR                                17440999
174410                  MOVE 'CURSOR:  DOOR-STR-CSR'                    17441099
174411                                        TO DP013-MESSAGE-TEXT (2) 17441199
174412                  EXEC SQL                                        17441299
174413                      OPEN DOOR-STR-CSR                           17441399
174414                  END-EXEC                                        17441499
174415                                                                  17441599
174416             WHEN ASC-DOOR-STR-TYPE-CSR                           17441699
174417                 MOVE 'CURSOR:  DOOR-STR-TYPE-CSR'                17441799
174418                                        TO DP013-MESSAGE-TEXT (2) 17441899
174419                   EXEC SQL                                       17441999
174420                      OPEN DOOR-STR-TYPE-CSR                      17442099
174421                   END-EXEC                                       17442199
174422                                                                  17442299
174423             WHEN ASC-DOOR-STR-ID-CSR                             17442399
174424                 MOVE 'CURSOR:  DOOR-STR-ID-CSR'                  17442499
174425                                        TO DP013-MESSAGE-TEXT (2) 17442599
174426                   EXEC SQL                                       17442699
174427                      OPEN DOOR-STR-ID-CSR                        17442799
174428                   END-EXEC                                       17442899
174429                                                                  17442999
174430         END-EVALUATE                                             17443099
174431                                                                  17443199
174432         EVALUATE TRUE                                            17443299
174433             WHEN SQLCODE = ZERO                                  17443399
174434             WHEN SQLCODE = -904                                  17443499
174435             WHEN SQLCODE = -913                                  17443599
174436                 CONTINUE                                         17443699
174437             WHEN SQLWARN0 NOT = SPACES                           17443799
174438             WHEN SQLCODE < ZERO                                  17443899
174439             WHEN SQLCODE > ZERO                                  17443999
174440                 MOVE '4015-OPEN-STORE-CURSOR' TO DP013-PARAGRAPH 17444099
174441                 MOVE 'UNABLE TO OPEN A CURSOR -'                 17444199
174442                                   TO DP013-MESSAGE-TEXT (1)      17444299
174443                 MOVE SQLCA        TO DP013-SQLCA                 17444399
174444                 MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)    17444499
174445                 SET DP013-DB2-ABEND                              17444599
174446                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17444699
174447                 PERFORM DP013-0000-PROCESS-ABEND                 17444799
174448         END-EVALUATE                                             17444899
174449     END-PERFORM.                                                 17444999
174450                                                                  17445099
174451     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17445199
174452         MOVE '4015-OPEN-STORE-CURSOR'   TO DP013-PARAGRAPH       17445299
174453         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   17445399
174454                                   TO DP013-MESSAGE-TEXT (1)      17445499
174455         MOVE SQLCA                TO DP013-SQLCA                 17445599
174456         MOVE 'TCNDCDR '           TO DP013-DB2-TABLE-NAME (1)    17445699
174457         SET DP013-DB2-ABEND                                      17445799
174458             DP013-XCTL-DISPLAY-RESTART TO TRUE                   17445899
174459         PERFORM DP013-0000-PROCESS-ABEND                         17445999
174460     END-IF.                                                      17446099
174461                                                                  17446199
174462                                                                  17446299
177210*----------------------------------------------------------------*17721099
177220* CLOSE THE CURSOR                                               *17722099
177230*----------------------------------------------------------------*17723099
177240 4020-CLOSE-CURSOR.                                               17724099
177250     EVALUATE TRUE                                                17725099
177260         WHEN ASC-DOOR-CSR                                        17726099
177270              EXEC SQL                                            17727099
177280                   CLOSE DOOR-CSR                                 17728099
177290              END-EXEC                                            17729099
177291                                                                  17729199
177292         WHEN ASC-DOOR-TYPE-CSR                                   17729299
177293              EXEC SQL                                            17729399
177294                   CLOSE DOOR-TYPE-CSR                            17729499
177295              END-EXEC                                            17729599
177296                                                                  17729699
177297         WHEN ASC-DOOR-ID-CSR                                     17729799
177298              EXEC SQL                                            17729899
177299                   CLOSE DOOR-ID-CSR                              17729999
177300              END-EXEC                                            17730099
177301     END-EVALUATE.                                                17730199
177302                                                                  17730299
177303     EVALUATE TRUE                                                17730399
177304         WHEN SQLCODE = ZERO                                      17730499
177305             CONTINUE                                             17730599
177306         WHEN SQLWARN0 NOT = SPACES                               17730699
177307         WHEN SQLCODE < ZERO                                      17730799
177308         WHEN SQLCODE > ZERO                                      17730899
177309             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          17730999
177310             MOVE 'UNABLE TO CLOSE CURSOR '                       17731099
177311                               TO DP013-MESSAGE-TEXT (1)          17731199
177312             MOVE SQLCA        TO DP013-SQLCA                     17731299
177313             MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)        17731399
177314             SET DP013-DB2-ABEND                                  17731499
177315                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17731599
177316             PERFORM DP013-0000-PROCESS-ABEND                     17731699
177317     END-EVALUATE.                                                17731799
177318                                                                  17731899
177319*----------------------------------------------------------------*17731999
177320* CLOSE THE STORE CURSOR                                         *17732099
177321*----------------------------------------------------------------*17732199
177322 4025-CLOSE-STORE-CURSOR.                                         17732299
177323     EVALUATE TRUE                                                17732399
177324         WHEN ASC-DOOR-STR-CSR                                    17732499
177325              EXEC SQL                                            17732599
177326                   CLOSE DOOR-STR-CSR                             17732699
177327              END-EXEC                                            17732799
177328                                                                  17732899
177329         WHEN ASC-DOOR-STR-TYPE-CSR                               17732999
177330              EXEC SQL                                            17733099
177331                   CLOSE DOOR-STR-TYPE-CSR                        17733199
177332              END-EXEC                                            17733299
177333                                                                  17733399
177334         WHEN ASC-DOOR-STR-ID-CSR                                 17733499
177335              EXEC SQL                                            17733599
177336                   CLOSE DOOR-STR-ID-CSR                          17733699
177337              END-EXEC                                            17733799
177338     END-EVALUATE.                                                17733899
177339                                                                  17733999
177340     EVALUATE TRUE                                                17734099
177341         WHEN SQLCODE = ZERO                                      17734199
177342             CONTINUE                                             17734299
177343         WHEN SQLWARN0 NOT = SPACES                               17734399
177344         WHEN SQLCODE < ZERO                                      17734499
177345         WHEN SQLCODE > ZERO                                      17734599
177346             MOVE '4025-CLOSE-STORE-CURSOR' TO DP013-PARAGRAPH    17734699
177347             MOVE 'UNABLE TO CLOSE CURSOR '                       17734799
177348                               TO DP013-MESSAGE-TEXT (1)          17734899
177349             MOVE SQLCA        TO DP013-SQLCA                     17734999
177350             MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)        17735099
177351             SET DP013-DB2-ABEND                                  17735199
177352                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17735299
177353             PERFORM DP013-0000-PROCESS-ABEND                     17735399
177354     END-EVALUATE.                                                17735499
177355                                                                  17735599
177360*----------------------------------------------------------------*17736099
177400*    SET UP THE HOST VARIABLES.                                  *17740001
177500*----------------------------------------------------------------*17750001
177600 4100-PREPARE-CURSOR.                                             17760001
177700                                                                  17770001
177800     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                17780004
178000                                                                  17800001
178100*    IF  DK-DOOR-ID      > ZEROES                                 17810099
178110     IF  DK-DOOR-ID      > SPACES                                 17811099
178200         SET ASC-DOOR-ID-CSR TO TRUE                              17820001
178300     ELSE                                                         17830001
178310         IF  DK-TYPE-CODE    > SPACES                             17831001
178311             SET ASC-DOOR-TYPE-CSR TO TRUE                        17831101
178320         ELSE                                                     17832001
178400             SET ASC-DOOR-CSR TO TRUE                             17840001
178500         END-IF                                                   17850001
178510     END-IF.                                                      17851001
178600                                                                  17860001
178610*----------------------------------------------------------------*17861099
178620*    SET UP THE HOST VARIABLES STORE CURSOR                      *17862099
178630*----------------------------------------------------------------*17863099
178640 4200-PREPARE-STORE-CURSOR.                                       17864099
178650                                                                  17865099
178660     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                17866099
178670                                                                  17867099
178690     IF  DK-DOOR-ID      > SPACES                                 17869099
178691         SET ASC-DOOR-STR-ID-CSR TO TRUE                          17869199
178692     ELSE                                                         17869299
178693         IF  DK-TYPE-CODE    > SPACES                             17869399
178694             SET ASC-DOOR-STR-TYPE-CSR TO TRUE                    17869499
178695         ELSE                                                     17869599
178696             SET ASC-DOOR-STR-CSR TO TRUE                         17869699
178697         END-IF                                                   17869799
178698     END-IF.                                                      17869899
178699                                                                  17869999
178700*----------------------------------------------------------------*17870001
178800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *17880001
178900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *17890001
179000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *17900001
179100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *17910001
179200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *17920001
179300*                                                                *17930001
179400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *17940001
179500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *17950001
179600*    UPON INITIALIZATION.                                        *17960001
179700*----------------------------------------------------------------*17970001
179800 4300-READ-ITEMS-FROM-DB.                                         17980001
179900     PERFORM                                                      17990001
180000         VARYING PV-READ-COUNT                                    18000001
180100         FROM 1 BY 1                                              18010001
180200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    18020001
180300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         18030001
180400                                                                  18040099
180410        IF ASC-LIST-BY-STORE                                      18041099
180420           PERFORM 4315-FETCH-STR                                 18042099
180430        ELSE                                                      18043099
180500            PERFORM 4310-FETCH                                    18050099
180510        END-IF                                                    18051099
180600                                                                  18060001
180700         IF  ASC-ITEMS-LEFT-ON-DB                                 18070001
180800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                18080001
180900                 ADD +1            TO ASC-ITEM-SUB                18090001
181000             ELSE                                                 18100001
181100                 ADD +1            TO ASC-BLK-SUB                 18110001
181200                 MOVE +1           TO ASC-ITEM-SUB                18120001
181300                                                                  18130001
181400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         18140001
181500                     MOVE +1       TO ASC-BLK-SUB                 18150001
181600                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           18160001
181700                     PERFORM 5100-WRITE-TEMP-STORAGE              18170001
181800                     MOVE ASC-BLOCK-ENTRIES                       18180001
181900                               (PC-MAX-BLOCKS-IN-ARRAY)           18190001
182000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 18200001
182100                     ADD +1        TO ASC-BLK-SUB                 18210001
182200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   18220001
182300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      18230001
182400                                   TO TRUE                        18240001
182500                 END-IF                                           18250001
182600             END-IF                                               18260001
182700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18270001
182800             MOVE ASC-NUMBER-OF-ITEMS-READ                        18280001
182900                                   TO ASC-LIST-ITEM-NUMBER        18290086
183000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18300086
183100             EVALUATE TRUE                                        18310089
183200                 WHEN CN011-FUNCTION-NONE                         18320089
183300                     MOVE SPACES TO ASC-ACTION                    18330089
183310                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18331089
183311                 WHEN CN011-ADD-DOOR                              18331189
183312                   IF CN011-DOOR-ID = CNDCDR-DOOR-ID              18331291
183313                     MOVE PC-ADD TO ASC-ACTION                    18331391
183314                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18331491
183315                   END-IF                                         18331591
183316                 WHEN CN011-UPD-DOOR                              18331691
183317                     MOVE PC-UPD TO ASC-ACTION                    18331791
183318                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18331891
183319                 WHEN CN012-ASSIGN-STORES                         18331991
183320                     MOVE PC-UPD TO ASC-ACTION                    18332091
183321                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18332191
183322                 WHEN CN012-LIST-STORES                           18332291
183323                     MOVE PC-INQ TO ASC-ACTION                    18332391
183324                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18332491
183325                 WHEN CN012-UPD-DOOR                              18332591
183326                     MOVE PC-UPD TO ASC-ACTION                    18332691
183327                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18332791
183328             END-EVALUATE                                         18332891
183330             MOVE CNDCDR-DOOR-ID   TO  ASC-DOOR-ID                18333084
183400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18340001
183500             MOVE CNDCDR-DOOR-TYP-CDE TO  ASC-TYPE-CODE           18350001
183600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18360001
183610             MOVE CNDCDR-DOOR-LOC-DESC TO  ASC-LOC-DESC           18361001
183620                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18362001
183630             MOVE CNDCDR-DIVERT-NBR   TO  ASC-LANE-ASGNMNT        18363001
183640                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18364001
183641             MOVE CNDCDR-DIVERT-LOC-ID TO  ASC-DIVERT-LOC         18364199
183642                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18364299
183650             MOVE CNDCDR-DOOR-LBL-SEQ-NBR TO  ASC-LABEL-NBR       18365001
183660                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18366001
183663                                                                  18366395
183664                                                                  18366499
183665            IF ASC-LIST-BY-DOOR                                   18366599
183670               IF DK-STOR-ASGNMNT = PC-MULTI                      18367099
183671                  MOVE DK-STOR-ASGNMNT TO  ASC-STOR-ASGNMNT       18367199
183680                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18368099
183690               ELSE                                               18369099
183692                  MOVE DK-STORE-ASSIGN-N TO  ASC-STORE-ASSIGN     18369299
183694                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18369499
183695               END-IF                                             18369599
183696            ELSE                                                  18369699
183697               MOVE CNDRST-STR-NBR     TO ASC-STORE-ASSIGN        18369799
183698                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18369899
183699            END-IF                                                18369999
183700                                                                  18370099
183710         END-IF                                                   18371001
183800     END-PERFORM.                                                 18380001
183900                                                                  18390001
184000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18400001
184100         MOVE +1               TO ASC-BLK-SUB                     18410001
184200         PERFORM 5100-WRITE-TEMP-STORAGE                          18420001
184300         ADD +1                TO ASC-BLK-SUB                     18430001
184400         PERFORM 5100-WRITE-TEMP-STORAGE                          18440001
184500                                                                  18450001
184600         MOVE 1                TO ASC-BLK-SUB                     18460001
184700                                  PV-BLOCK-NUMBER                 18470001
184800         PERFORM 4410-READ-TEMP-STORAGE                           18480001
184900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18490001
185000             MOVE 2            TO ASC-BLK-SUB                     18500001
185100                                  PV-BLOCK-NUMBER                 18510001
185200             PERFORM 4410-READ-TEMP-STORAGE                       18520001
185300         END-IF                                                   18530001
185400     END-IF.                                                      18540001
185500                                                                  18550001
185600*----------------------------------------------------------------*18560001
185700*    FETCH THE CURSOR                                             18570001
185800*----------------------------------------------------------------*18580001
185900 4310-FETCH.                                                      18590002
186000       EVALUATE TRUE                                              18600002
186100           WHEN ASC-DOOR-CSR                                      18610002
186200               EXEC SQL                                           18620002
186300                    FETCH DOOR-CSR                                18630002
186400                    INTO  :CNDCDR-DOOR-ID                         18640002
186500                        , :CNDCDR-DOOR-TYP-CDE                    18650002
186510                        , :CNDCDR-DOOR-LOC-DESC                   18651002
186520                        , :CNDCDR-DIVERT-NBR                      18652003
186521                        , :CNDCDR-DIVERT-LOC-ID                   18652199
186530                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18653002
186540                        , :PV-CASE-NBR                            18654099
186600               END-EXEC                                           18660002
186700                                                                  18670002
186800           WHEN ASC-DOOR-TYPE-CSR                                 18680002
186900               EXEC SQL                                           18690002
187000                    FETCH DOOR-TYPE-CSR                           18700002
187010                    INTO  :CNDCDR-DOOR-ID                         18701002
187020                        , :CNDCDR-DOOR-TYP-CDE                    18702002
187030                        , :CNDCDR-DOOR-LOC-DESC                   18703002
187040                        , :CNDCDR-DIVERT-NBR                      18704003
187041                        , :CNDCDR-DIVERT-LOC-ID                   18704199
187050                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18705002
187060                        , :PV-CASE-NBR                            18706099
187300               END-EXEC                                           18730002
187400                                                                  18740002
187410           WHEN ASC-DOOR-ID-CSR                                   18741002
187420               EXEC SQL                                           18742002
187430                    FETCH DOOR-ID-CSR                             18743002
187440                    INTO  :CNDCDR-DOOR-ID                         18744002
187450                        , :CNDCDR-DOOR-TYP-CDE                    18745002
187460                        , :CNDCDR-DOOR-LOC-DESC                   18746002
187470                        , :CNDCDR-DIVERT-NBR                      18747003
187471                        , :CNDCDR-DIVERT-LOC-ID                   18747199
187480                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18748002
187481                        , :PV-CASE-NBR                            18748199
187490               END-EXEC                                           18749002
187491     END-EVALUATE.                                                18749110
187492                                                                  18749202
187500     EVALUATE TRUE                                                18750002
187600         WHEN SQLCODE = ZERO                                      18760002
187610              PERFORM 4320-COUNT-STORE-ASGNMNT                    18761008
187700         WHEN SQLCODE = +100                                      18770002
187800              CONTINUE                                            18780002
187900         WHEN SQLWARN0 NOT = SPACE                                18790002
188000         WHEN SQLCODE NOT = ZERO                                  18800002
188100              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         18810002
188200              MOVE 'COULD NOT FETCH CURSOR'                       18820002
188300                               TO DP013-MESSAGE-TEXT (1)          18830002
188400              MOVE SQLCA       TO DP013-SQLCA                     18840002
188500              SET DP013-DB2-ABEND TO TRUE                         18850002
188600              PERFORM DP013-0000-PROCESS-ABEND                    18860002
188700     END-EVALUATE.                                                18870002
188800                                                                  18880002
188900     IF  SQLCODE EQUAL +100                                       18890002
189000         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      18900002
189100     END-IF.                                                      18910002
189200                                                                  18920002
189201*----------------------------------------------------------------*18920199
189202*    FETCH THE STORE CURSOR                                       18920299
189203*----------------------------------------------------------------*18920399
189204 4315-FETCH-STR.                                                  18920499
189205       EVALUATE TRUE                                              18920599
189206           WHEN ASC-DOOR-STR-CSR                                  18920699
189207               EXEC SQL                                           18920799
189208                    FETCH DOOR-STR-CSR                            18920899
189209                    INTO  :PV-UNION-TYPE                          18920999
189210                        , :CNDCDR-DOOR-ID                         18921099
189211                        , :CNDCDR-DOOR-TYP-CDE                    18921199
189212                        , :CNDCDR-DOOR-LOC-DESC                   18921299
189213                        , :CNDCDR-DIVERT-NBR                      18921399
189214                        , :CNDCDR-DIVERT-LOC-ID                   18921499
189215                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18921599
189216                        , :CNDRST-STR-NBR                         18921699
189217                        , :PV-CASE-NBR                            18921799
189218               END-EXEC                                           18921899
189219                                                                  18921999
189220           WHEN ASC-DOOR-STR-TYPE-CSR                             18922099
189221               EXEC SQL                                           18922199
189222                    FETCH DOOR-STR-TYPE-CSR                       18922299
189223                    INTO  :PV-UNION-TYPE                          18922399
189224                        , :CNDCDR-DOOR-ID                         18922499
189225                        , :CNDCDR-DOOR-TYP-CDE                    18922599
189226                        , :CNDCDR-DOOR-LOC-DESC                   18922699
189227                        , :CNDCDR-DIVERT-NBR                      18922799
189228                        , :CNDCDR-DIVERT-LOC-ID                   18922899
189229                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18922999
189230                        , :CNDRST-STR-NBR                         18923099
189231                        , :PV-CASE-NBR                            18923199
189232               END-EXEC                                           18923299
189233                                                                  18923399
189234           WHEN ASC-DOOR-STR-ID-CSR                               18923499
189235               EXEC SQL                                           18923599
189236                    FETCH DOOR-STR-ID-CSR                         18923699
189237                    INTO  :PV-UNION-TYPE                          18923799
189238                        , :CNDCDR-DOOR-ID                         18923899
189239                        , :CNDCDR-DOOR-TYP-CDE                    18923999
189240                        , :CNDCDR-DOOR-LOC-DESC                   18924099
189241                        , :CNDCDR-DIVERT-NBR                      18924199
189242                        , :CNDCDR-DIVERT-LOC-ID                   18924299
189243                        , :CNDCDR-DOOR-LBL-SEQ-NBR                18924399
189244                        , :CNDRST-STR-NBR                         18924499
189245                        , :PV-CASE-NBR                            18924599
189246               END-EXEC                                           18924699
189247     END-EVALUATE.                                                18924799
189248                                                                  18924899
189249     EVALUATE TRUE                                                18924999
189250         WHEN SQLCODE = ZERO                                      18925099
189251*             PERFORM 4320-COUNT-STORE-ASGNMNT                    18925199
189252         WHEN SQLCODE = +100                                      18925299
189253              CONTINUE                                            18925399
189254         WHEN SQLWARN0 NOT = SPACE                                18925499
189255         WHEN SQLCODE NOT = ZERO                                  18925599
189256              MOVE '4315-FETCH-STR-CURSOR' TO DP013-PARAGRAPH     18925699
189257              MOVE 'COULD NOT FETCH CURSOR'                       18925799
189258                               TO DP013-MESSAGE-TEXT (1)          18925899
189259              MOVE SQLCA       TO DP013-SQLCA                     18925999
189260              SET DP013-DB2-ABEND TO TRUE                         18926099
189261              PERFORM DP013-0000-PROCESS-ABEND                    18926199
189262     END-EVALUATE.                                                18926299
189263                                                                  18926399
189264     IF  SQLCODE EQUAL +100                                       18926499
189265         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      18926599
189266     END-IF.                                                      18926699
189267                                                                  18926799
189268*----------------------------------------------------------------*18926899
189269* COUNT THE NUMBER OF STORES ASSIGNED CURRENTLY TO THE DOOR.      18926999
189270*----------------------------------------------------------------*18927099
189271 4320-COUNT-STORE-ASGNMNT.                                        18927199
189272     INITIALIZE ASC-COUNT.                                        18927299
189273     MOVE ASC-OPER-UNT-ID     TO   DK-OPER-UNT-ID.                18927399
189274     MOVE CNDCDR-DOOR-ID      TO   DK-DOOR-ID.                    18927499
189275                                                                  18927599
189276     EXEC SQL                                                     18927699
189277         SELECT COUNT(*)                                          18927799
189278          INTO :ASC-COUNT                                         18927899
189279         FROM  TCNDRST                                            18927999
189280        WHERE OPER_UNT_ID  = :DK-OPER-UNT-ID                      18928099
189281          AND DOOR_ID      = :DK-DOOR-ID                          18928199
189282          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                18928299
189283     END-EXEC                                                     18928399
189284                                                                  18928499
189285     EVALUATE TRUE                                                18928599
189286         WHEN SQLCODE = ZERO                                      18928699
189287                                                                  18928799
189288           IF ASC-COUNT > 1                                       18928899
189289               MOVE PC-MULTI TO DK-STOR-ASGNMNT                   18928999
189290           ELSE                                                   18929099
189291               IF ASC-COUNT = 1                                   18929199
189293                     PERFORM 4330-GET-STORE-ASGNMNT               18929399
189296               ELSE                                               18929699
189297                   MOVE SPACES  TO DK-STOR-ASGNMNT                18929799
189298               END-IF                                             18929899
189299           END-IF                                                 18929999
189300         WHEN SQLCODE = +100                                      18930099
189301                 MOVE SPACES  TO DK-STOR-ASGNMNT                  18930199
189302         WHEN SQLWARN0 NOT = SPACES                               18930299
189303         WHEN SQLCODE < +0                                        18930399
189304         WHEN SQLCODE > +0                                        18930499
189305             MOVE '4320-COUNT-STORE-ASGNMNT' TO DP013-PARAGRAPH   18930599
189306             MOVE 'TROUBLE COUNTING STORES'                       18930699
189307                                      TO DP013-MESSAGE-TEXT (1)   18930799
189308             MOVE SQLCA        TO DP013-SQLCA                     18930899
189309             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        18930999
189310             SET DP013-DB2-ABEND                                  18931099
189311                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18931199
189312             PERFORM DP013-0000-PROCESS-ABEND                     18931299
189313         END-EVALUATE.                                            18931399
189314                                                                  18931499
189315*----------------------------------------------------------------*18931599
189316* RETRIEVE THE STORE NUMBER CURRENTLY ASSIGNED TO THE DOOR.       18931699
189317*----------------------------------------------------------------*18931799
189318 4330-GET-STORE-ASGNMNT.                                          18931899
189319     MOVE ASC-OPER-UNT-ID     TO   DK-OPER-UNT-ID.                18931999
189320     MOVE CNDCDR-DOOR-ID      TO   DK-DOOR-ID.                    18932099
189321                                                                  18932199
189322     EXEC SQL                                                     18932299
189323         SELECT STR_NBR                                           18932399
189324          INTO :CNDRST-STR-NBR                                    18932499
189325         FROM  TCNDRST                                            18932599
189326        WHERE OPER_UNT_ID  = :DK-OPER-UNT-ID                      18932699
189327          AND DOOR_ID      = :DK-DOOR-ID                          18932799
189328          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                18932899
189329     END-EXEC                                                     18932999
189330                                                                  18933099
189331     EVALUATE TRUE                                                18933199
189332         WHEN SQLCODE = ZERO                                      18933299
189333             MOVE CNDRST-STR-NBR  TO DK-STOR-ASGNMNT              18933399
189334         WHEN SQLCODE = +100                                      18933499
189335             MOVE SPACES          TO DK-STOR-ASGNMNT              18933599
189336         WHEN SQLWARN0 NOT = SPACES                               18933699
189337         WHEN SQLCODE < +0                                        18933799
189338         WHEN SQLCODE > +0                                        18933899
189339             MOVE '4330-GET-STORE-ASGNMNT' TO DP013-PARAGRAPH     18933999
189340             MOVE 'TROUBLE RETRIEVING STORE NBR'                  18934099
189341                                      TO DP013-MESSAGE-TEXT (1)   18934199
189342             MOVE SQLCA        TO DP013-SQLCA                     18934299
189343             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        18934399
189344             SET DP013-DB2-ABEND                                  18934499
189345                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18934599
189346             PERFORM DP013-0000-PROCESS-ABEND                     18934699
189347         END-EVALUATE.                                            18934799
189348                                                                  18934899
189350*----------------------------------------------------------------*18935099
189400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *18940001
189500*----------------------------------------------------------------*18950001
189600 4400-MOVE-COMMAREA-TO-SCREEN.                                    18960001
189700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             18970001
189800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          18980001
189900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          18990001
190000             MOVE +1    TO ASC-BLK-SUB                            19000001
190100             PERFORM 5100-WRITE-TEMP-STORAGE                      19010001
190200             ADD +1     TO ASC-BLK-SUB                            19020001
190300             PERFORM 5100-WRITE-TEMP-STORAGE                      19030001
190400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             19040001
190500                 GIVING PV-BLOCK-NUMBER                           19050001
190600                 REMAINDER PV-REMAINDER                           19060001
190700             IF  PV-REMAINDER > ZERO                              19070001
190800                 ADD +1 TO PV-BLOCK-NUMBER                        19080001
190900             END-IF                                               19090001
191000             MOVE +1    TO ASC-BLK-SUB                            19100001
191100             PERFORM 4410-READ-TEMP-STORAGE                       19110001
191200             ADD +1     TO ASC-BLK-SUB                            19120001
191300                           PV-BLOCK-NUMBER                        19130001
191400             PERFORM 4410-READ-TEMP-STORAGE                       19140001
191500     END-IF.                                                      19150001
191600     MOVE +1            TO ASC-BLK-SUB.                           19160001
191700     COMPUTE ASC-ITEM-SUB =                                       19170001
191800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              19180001
191900         + PC-ITEMS-PER-PANEL).                                   19190001
192000*                                                                 19200001
192100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19210001
192200         ADD +1         TO ASC-BLK-SUB                            19220001
192300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19230001
192400     END-IF.                                                      19240001
192500*                                                                 19250001
192600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           19260001
192700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                19270001
192800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        19280001
192900     PERFORM 4420-FORMAT-LIST-LINES                               19290001
193000         VARYING PV-SUB                                           19300001
193100         FROM PC-ITEMS-PER-PANEL BY -1                            19310001
193200         UNTIL PV-SUB < +1.                                       19320001
193300*                                                                 19330001
193400     COMPUTE ASC-ITEMS-DISPLAYED =                                19340001
193500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          19350001
193600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    19360001
193700                                      ASTRTITO.                   19370001
193800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    19380001
193900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    19390001
194000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            19400001
194100                                   TO ASELITO.                    19410001
194200     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   19420002
194300     MOVE ASC-FCLTY-NAME           TO AOPRNMEO.                   19430004
194400     MOVE ASC-ORD-SEQ              TO AORDSEQO.                   19440099
194500                                                                  19450001
194600     IF  DP020-MSG-NUMBER-X = SPACE                               19460001
194700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  19470001
194800*            --- MORE ITEMS TO DISPLAY ----                       19480001
194900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            19490001
195000             SET DP020-MSG-INFORMATIONAL TO TRUE                  19500001
195100         END-IF                                                   19510001
195200     END-IF.                                                      19520001
195300                                                                  19530001
195400*----------------------------------------------------------------*19540001
195500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *19550001
195600*----------------------------------------------------------------*19560001
195700 4410-READ-TEMP-STORAGE.                                          19570001
195800     EXEC CICS                                                    19580001
195900         READQ TS                                                 19590001
196000             QUEUE (ASC-LIST-QUEUE-NAME)                          19600001
196100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19610001
196200             ITEM  (PV-BLOCK-NUMBER)                              19620001
196300             RESP  (PV-CICS-RESP)                                 19630001
196400     END-EXEC.                                                    19640001
196500                                                                  19650001
196600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       19660001
196700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     19670001
196800         CONTINUE                                                 19680001
196900     ELSE                                                         19690001
197000         SET DP013-CICS-ABEND     TO TRUE                         19700001
197100         SET DP013-NO-ROLLBACK    TO TRUE                         19710001
197200         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         19720001
197300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      19730001
197400                                  TO DP013-MESSAGE-TEXT(1)        19740001
197500         PERFORM DP013-0000-PROCESS-ABEND                         19750001
197600     END-IF.                                                      19760001
197700                                                                  19770001
197800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             19780001
197900*                                                                 19790001
198000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         19800001
198100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               19810001
198200     END-IF.                                                      19820001
198300                                                                  19830001
198400*----------------------------------------------------------------*19840001
198500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *19850001
198600*----------------------------------------------------------------*19860001
198700 4420-FORMAT-LIST-LINES.                                          19870001
198800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      19880001
198900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                19890001
199000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           19900001
199100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           19910001
199200         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      19920049
199300                                    MR-ACTION       (PV-SUB)      19930049
199400                                    MR-TYPE-CODE    (PV-SUB)      19940049
199510                                    MR-LOC-DESC     (PV-SUB)      19951002
199520                                    MR-STOR-ASGNMNT (PV-SUB)      19952004
199521                                    MR-DOOR-ID      (PV-SUB)      19952199
199522                                    MR-DIVERT-LOC   (PV-SUB)      19952299
199523         MOVE ZEROES             TO MR-LANE-ASGNMNT (PV-SUB)      19952399
199530                                    MR-LABEL-NBR    (PV-SUB)      19953002
199600     ELSE                                                         19960001
199700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      19970001
199800                                                   > SPACE        19980001
199900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19990001
200000                                          TO MR-SELECTI (PV-SUB)  20000030
200100         ELSE                                                     20010001
200200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      20020001
200300                                           TO MR-SELECTI (PV-SUB) 20030002
200400         END-IF                                                   20040001
200500                                                                  20050001
200600         IF  DP030-SET-CURSOR-TRAILER                             20060001
200700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)20070001
200800                 > SPACE)                                         20080001
200900               OR (PV-SUB = 1))                                   20090001
201000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20100001
201100                MOVE -1          TO MR-SELECTL (PV-SUB)           20110001
201200             END-IF                                               20120001
201300         END-IF                                                   20130001
201450*>>>>>>>>                                                         20145099
201500         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               20150002
201600                                            TO MR-ACTION (PV-SUB) 20160030
201700         MOVE ASC-DOOR-ID  (ASC-BLK-SUB ASC-ITEM-SUB)             20170002
201800                                          TO MR-DOOR-ID  (PV-SUB) 20180002
201900         MOVE ASC-TYPE-CODE (ASC-BLK-SUB ASC-ITEM-SUB)            20190002
202000                                        TO MR-TYPE-CODE (PV-SUB)  20200002
202010         MOVE ASC-LOC-DESC (ASC-BLK-SUB ASC-ITEM-SUB)             20201002
202020                                          TO MR-LOC-DESC (PV-SUB) 20202002
202030         MOVE ASC-LANE-ASGNMNT (ASC-BLK-SUB ASC-ITEM-SUB)         20203002
202040                                      TO MR-LANE-ASGNMNT (PV-SUB) 20204002
202050         MOVE ASC-DIVERT-LOC (ASC-BLK-SUB ASC-ITEM-SUB)           20205099
202060                                        TO MR-DIVERT-LOC (PV-SUB) 20206099
202061         MOVE ASC-LABEL-NBR (ASC-BLK-SUB ASC-ITEM-SUB)            20206199
202062                                        TO MR-LABEL-NBR (PV-SUB)  20206299
202070         MOVE ASC-STOR-ASGNMNT (ASC-BLK-SUB ASC-ITEM-SUB)         20207002
202080                                      TO MR-STOR-ASGNMNT (PV-SUB) 20208002
202100     END-IF.                                                      20210002
202200     SUBTRACT +1 FROM ASC-ITEM-SUB                                20220002
202300     IF  ASC-ITEM-SUB < + 1                                       20230002
202400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20240002
202500         MOVE +1                 TO ASC-BLK-SUB                   20250002
202600     END-IF.                                                      20260002
202700                                                                  20270002
202800******************************************************************20280001
202900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **20290001
203000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **20300001
203100** ISSUE A WARNING.                                             **20310001
203200******************************************************************20320001
203300 4430-CHECK-FOR-BEGIN-AND-END.                                    20330001
203400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20340001
203500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20350001
203600*            -- NO END-OF-RANGE SPECFIED ---                      20360001
203700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            20370001
203800             SET DP020-MSG-WARNING TO TRUE                        20380001
203900             PERFORM 4431-POSITION-AT-WARNING                     20390001
204000         END-IF                                                   20400001
204100     ELSE                                                         20410001
204200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     20420001
204300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                20430001
204400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            20440001
204500             SET DP020-MSG-WARNING TO TRUE                        20450001
204600             PERFORM 4431-POSITION-AT-WARNING                     20460001
204700         END-IF                                                   20470001
204800     END-IF.                                                      20480001
204900                                                                  20490001
205000******************************************************************20500001
205100** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **20510001
205200** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **20520001
205300** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **20530001
205400** POSITION THE CURSOR THERE.                                   **20540001
205500******************************************************************20550001
205600 4431-POSITION-AT-WARNING.                                        20560001
205700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20570001
205800                    - PV-TOP-ITEM + 1.                            20580001
205900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20590001
206000         CONTINUE                                                 20600001
206100     ELSE                                                         20610001
206200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      20620002
206400         MOVE -1                     TO MR-SELECTL (PV-SUB)       20640002
206500         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       20650002
206600         MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       20660002
206700     END-IF.                                                      20670001
206800                                                                  20680001
206900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20690001
207000                    - PV-TOP-ITEM + 1.                            20700001
207100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20710001
207200         CONTINUE                                                 20720001
207300     ELSE                                                         20730001
207400         SET DP030-SET-CURSOR-APPL-1                              20740001
207500                                   TO TRUE                        20750001
207600         MOVE -1                   TO MR-SELECTL (PV-SUB)         20760001
207700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20770001
207800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         20780001
207900     END-IF.                                                      20790001
208000                                                                  20800001
220000*----------------------------------------------------------------*22000001
220100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *22010001
220200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *22020001
220300* FOR THE SELECTED ITEMS QUEUE.                                  *22030001
220400*                                                                *22040001
220500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *22050001
220600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *22060001
220700* THE ARRAY IS FULL.                                             *22070001
220800*----------------------------------------------------------------*22080001
220900 5000-PREPARE-SEL-QUEUE.                                          22090001
221000     MOVE +1                   TO  ASC-BLK-SUB.                   22100001
221100     PERFORM 5100-WRITE-TEMP-STORAGE.                             22110001
221200     ADD +1                    TO  ASC-BLK-SUB.                   22120001
221300     PERFORM 5100-WRITE-TEMP-STORAGE.                             22130001
221400                                                                  22140001
221500     MOVE ASC-SEL-QUEUE-NAME   TO  CN012-SEL-QUEUE-NAME.          22150002
221600     PERFORM 6010-DELETE-SEL-QUEUE.                               22160001
221700                                                                  22170001
221800     SET ASC-UPDATE-TSQ        TO  TRUE.                          22180001
221900                                                                  22190001
222000     SET CN013-IDX             TO  1.                             22200002
222100     MOVE ZERO                 TO CN012-NUMBER-OF-TS-ITEMS.       22210002
222200     INITIALIZE CN013-SELECTED-ITEM-ARRAY.                        22220002
222300                                                                  22230001
222400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           22240001
222500             VARYING PV-ITEM                                      22250001
222600             FROM 1 BY 1                                          22260001
222700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     22270001
222800                                                                  22280001
222900     IF  CN013-IDX > 1                                            22290002
223000         PERFORM 5205-WRITE-SEL-QUEUE                             22300001
223100         ADD +1                TO CN012-NUMBER-OF-TS-ITEMS        22310002
223200     END-IF.                                                      22320001
223300                                                                  22330001
223400*----------------------------------------------------------------*22340001
223500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *22350001
223600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *22360001
223700*----------------------------------------------------------------*22370001
223800 5100-WRITE-TEMP-STORAGE.                                         22380001
223900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     22390001
224000                                   TO PV-LIST-ITEM-NUMBER.        22400001
224100     COMPUTE PV-BLOCK-NUMBER =                                    22410001
224200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    22420001
224300                                                                  22430001
224400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             22440001
224500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             22450001
224600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      22460001
224700             PERFORM 5105-REWRITE-ASC-LISTQ                       22470001
224800         END-IF                                                   22480001
224900     ELSE                                                         22490001
225000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       22500001
225100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            22510001
225200         PERFORM 5110-WRITE-ASC-LISTQ                             22520001
225300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   22530001
225400     END-IF.                                                      22540001
225500                                                                  22550001
225600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             22560001
225700                                                                  22570001
225800******************************************************************22580001
225900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **22590001
226000** SPECIFIC COMMAREA.                                           **22600001
226100******************************************************************22610001
226200 5105-REWRITE-ASC-LISTQ.                                          22620001
226300     EXEC CICS                                                    22630001
226400         WRITEQ TS                                                22640001
226500             QUEUE (ASC-LIST-QUEUE-NAME)                          22650001
226600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22660001
226700             ITEM  (PV-BLOCK-NUMBER)                              22670001
226800             REWRITE                                              22680001
226900             RESP  (PV-CICS-RESP)                                 22690001
227000     END-EXEC.                                                    22700001
227100                                                                  22710001
227200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           22720001
227300         CONTINUE                                                 22730001
227400     ELSE                                                         22740001
227500         SET DP013-CICS-ABEND            TO TRUE                  22750001
227600         SET DP013-NO-ROLLBACK           TO TRUE                  22760001
227700         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       22770001
227800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     22780001
227900                                         TO DP013-MESSAGE-TEXT(1) 22790001
228000         PERFORM DP013-0000-PROCESS-ABEND                         22800001
228100     END-IF.                                                      22810001
228200                                                                  22820001
228300******************************************************************22830001
228400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **22840001
228500** SPECIFIC COMMAREA.                                           **22850001
228600******************************************************************22860001
228700 5110-WRITE-ASC-LISTQ.                                            22870001
228800     EXEC CICS                                                    22880001
228900         WRITEQ TS                                                22890001
229000             QUEUE (ASC-LIST-QUEUE-NAME)                          22900001
229100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               22910001
229200             ITEM  (PV-BLOCK-NUMBER)                              22920001
229300             RESP  (PV-CICS-RESP)                                 22930001
229400     END-EXEC.                                                    22940001
229500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      22950001
229600         SET DP013-CICS-ABEND      TO TRUE                        22960001
229700         SET DP013-NO-ROLLBACK     TO TRUE                        22970001
229800         MOVE '5110-WRITE-ASC-LISTQ'                              22980001
229900                                   TO DP013-PARAGRAPH             22990001
230000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           23000001
230100                                   TO DP013-MESSAGE-TEXT(1)       23010001
230200         PERFORM DP013-0000-PROCESS-ABEND                         23020001
230300     END-IF.                                                      23030001
230400                                                                  23040001
230500*----------------------------------------------------------------*23050001
230600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *23060001
230700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *23070001
230800*----------------------------------------------------------------*23080001
230900 5200-FILL-SEL-QUEUE-RECORD.                                      23090016
231000     PERFORM 6112-READ-LIST-QUEUE.                                23100016
231100                                                                  23110016
231200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       23120016
231300         PERFORM VARYING LQW-IDX                                  23130016
231400         FROM 1 BY 1                                              23140016
231500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            23150016
231600           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               23160016
231700                                                                  23170016
231800           IF LQW-SELECT (LQW-IDX)                                23180016
231900                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            23190016
232000                                            CN013-ITEM (CN013-IDX)23200016
232300                 MOVE LQW-ACTION (LQW-IDX)                        23230056
232301                                   TO CN013-ACTION-SW (CN013-IDX) 23230156
232310                 MOVE LQW-DOOR-ID (LQW-IDX)                       23231053
232320                                     TO CN013-DOOR-ID (CN013-IDX) 23232053
232400                 MOVE LQW-TYPE-CODE (LQW-IDX)                     23240027
232500                                   TO CN013-TYPE-CODE (CN013-IDX) 23250002
232510                 MOVE LQW-LOC-DESC (LQW-IDX)                      23251027
232520                                    TO CN013-LOC-DESC (CN013-IDX) 23252002
232530                 MOVE LQW-LANE-ASGNMNT (LQW-IDX)                  23253027
232540                                TO CN013-LANE-ASGNMT (CN013-IDX)  23254002
232550                 MOVE LQW-DIVERT-LOC (LQW-IDX)                    23255099
232560                               TO CN013-DIVERT-LOC-ID (CN013-IDX) 23256099
232561                 MOVE LQW-LABEL-NBR (LQW-IDX)                     23256199
232562                                 TO CN013-LBL-SEQ-NBR (CN013-IDX) 23256299
232570                 MOVE LQW-STOR-ASGNMNT (LQW-IDX)                  23257027
232580                                TO CN013-STORE-ASGNMT (CN013-IDX) 23258002
232600                                                                  23260002
232700                 SET CN013-IDX UP BY 1                            23270002
232800                 IF  CN013-IDX > CN013-MAX-ITEMS                  23280002
232900                     PERFORM 5205-WRITE-SEL-QUEUE                 23290002
233000                     ADD +1        TO CN012-NUMBER-OF-TS-ITEMS    23300002
233100                     INITIALIZE CN013-SELECTED-ITEM-ARRAY         23310002
233200                     SET CN013-IDX TO  1                          23320002
233300                 END-IF                                           23330002
233400           END-IF                                                 23340002
233500         END-PERFORM                                              23350002
233600     END-IF.                                                      23360002
233700                                                                  23370002
233800*----------------------------------------------------------------*23380001
233900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *23390001
234000*----------------------------------------------------------------*23400001
234100 5205-WRITE-SEL-QUEUE.                                            23410001
234200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO CN013-SELECTED-ITEMS.   23420002
234300                                                                  23430001
234400     EXEC CICS                                                    23440001
234500          WRITEQ TS                                               23450001
234600              QUEUE (ASC-SEL-QUEUE-NAME)                          23460001
234700              FROM  (CN013-SELECT-RECORD)                         23470002
234800              ITEM  (PV-SEL-QUEUE-ITEM)                           23480001
234900              RESP  (PV-CICS-RESP)                                23490001
235000     END-EXEC.                                                    23500001
235100                                                                  23510001
235200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23520001
235300         CONTINUE                                                 23530001
235400     ELSE                                                         23540001
235500         SET DP013-CICS-ABEND      TO TRUE                        23550001
235600         SET DP013-NO-ROLLBACK     TO TRUE                        23560001
235700         MOVE '5205-WRITE-SEL-QUEUE'                              23570001
235800                                   TO DP013-PARAGRAPH             23580001
235900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          23590001
236000                                   TO DP013-MESSAGE-TEXT(1)       23600001
236100         PERFORM DP013-0000-PROCESS-ABEND                         23610001
236200     END-IF.                                                      23620001
236300                                                                  23630001
236400******************************************************************23640001
236500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **23650001
236600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **23660001
236700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **23670001
236800** THE USER.                                                    **23680001
236900******************************************************************23690001
237000 6000-REFRESH-PANEL-FROM-TEMP.                                    23700001
237110     IF  ASC-UPDATE-TSQ                                           23711076
237200         SET ASC-NO-TSQ-UPDATE TO TRUE                            23720001
237300         MOVE ZERO                 TO PV-SAVE-ITEM                23730001
237400                                      PV-SEL-QUEUE-ITEM           23740001
237500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        23750001
237600                                   TO PV-HOLD-SELECTED-ITEMS      23760001
237700         MOVE +1                   TO PV-ITEMS-PROCESSED          23770001
237800         PERFORM 6100-UPDATE-TSQ                                  23780001
237900             UNTIL PV-ITEMS-PROCESSED >                           23790001
238000                                     PV-HOLD-SELECTED-ITEMS       23800001
238200         INITIALIZE ASC-BLOCK-ENTRIES (1)                         23820099
238300                    ASC-BLOCK-ENTRIES (2)                         23830099
238400     END-IF.                                                      23840001
238500                                                                  23850001
238600*----------------------------------------------------------------*23860001
238700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *23870001
238800*----------------------------------------------------------------*23880001
238900 6010-DELETE-SEL-QUEUE.                                           23890001
239000                                                                  23900001
239100     EXEC CICS                                                    23910001
239200         DELETEQ TS                                               23920001
239300             QUEUE (ASC-SEL-QUEUE-NAME)                           23930001
239400             RESP  (PV-CICS-RESP)                                 23940001
239500     END-EXEC.                                                    23950001
239600*                                                                 23960001
239700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      23970001
239800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         23980001
239900         CONTINUE                                                 23990001
240000     ELSE                                                         24000001
240100         SET DP013-CICS-ABEND TO TRUE                             24010001
240200         SET DP013-NO-ROLLBACK TO TRUE                            24020001
240300         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          24030001
240400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         24040001
240500                                        TO DP013-MESSAGE-TEXT (1) 24050001
240600         PERFORM DP013-0000-PROCESS-ABEND                         24060001
240700     END-IF.                                                      24070001
240800                                                                  24080001
240900*----------------------------------------------------------------*24090001
241000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *24100001
241100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *24110001
241200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *24120001
241300*    THE TEMP QUEUE.                                             *24130001
241400*----------------------------------------------------------------*24140001
241500 6100-UPDATE-TSQ.                                                 24150001
241510                                                                  24151099
241600     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              24160001
241700     PERFORM 6105-READ-SEL-QUEUE.                                 24170001
241800     PERFORM                                                      24180001
241900         VARYING CN013-IDX FROM 1 BY 1                            24190002
242000         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     24200001
242100         OR (CN013-IDX GREATER THAN CN013-MAX-ITEMS))             24210002
242200         IF  CN013-ACTION-SW (CN013-IDX) > SPACE                  24220002
242300             PERFORM 6110-PROCESS-ITEMS                           24230001
242400         END-IF                                                   24240001
242500         ADD +1                TO PV-ITEMS-PROCESSED              24250001
242600     END-PERFORM.                                                 24260001
242700     PERFORM 6111-WRITE-LIST-QUEUE.                               24270001
242800                                                                  24280001
242900*----------------------------------------------------------------*24290001
243000*    READ THE LIST QUEUE RECORD.                                 *24300001
243100*----------------------------------------------------------------*24310001
243200 6105-READ-SEL-QUEUE.                                             24320001
243300                                                                  24330001
243400     EXEC CICS                                                    24340001
243500          READQ TS                                                24350001
243600              QUEUE (ASC-SEL-QUEUE-NAME)                          24360001
243700              INTO  (CN013-SELECT-RECORD)                         24370002
243800              ITEM  (PV-SEL-QUEUE-ITEM)                           24380001
243900              RESP  (PV-CICS-RESP)                                24390001
244000     END-EXEC.                                                    24400001
244100*                                                                 24410001
244200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24420001
244300         CONTINUE                                                 24430001
244400     ELSE                                                         24440001
244500         SET DP013-CICS-ABEND      TO  TRUE                       24450001
244600         SET DP013-NO-ROLLBACK     TO  TRUE                       24460001
244700         MOVE '6105-READ-SEL-QUEUE'                               24470001
244800                                   TO  DP013-PARAGRAPH            24480001
244900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           24490001
245000                                   TO  DP013-MESSAGE-TEXT(1)      24500001
245100         PERFORM DP013-0000-PROCESS-ABEND                         24510001
245200     END-IF.                                                      24520001
245300                                                                  24530001
245400*----------------------------------------------------------------*24540001
245500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*24550001
245600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*24560001
245700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *24570001
245800*----------------------------------------------------------------*24580001
245900 6110-PROCESS-ITEMS.                                              24590001
246000                                                                  24600001
246100     COMPUTE PV-ITEM = 1 + ((CN013-ITEM (CN013-IDX) - 1)          24610002
246200                     / PC-ITEMS-PER-PANEL).                       24620001
246300                                                                  24630001
246400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           24640001
246500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          24650001
246600             PERFORM 6111-WRITE-LIST-QUEUE                        24660001
246700         END-IF                                                   24670001
246800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    24680001
246900                                                                  24690001
247000         PERFORM 6112-READ-LIST-QUEUE                             24700001
247100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               24710001
247200             CONTINUE                                             24720001
247300         END-IF                                                   24730001
247400     END-IF.                                                      24740001
247500                                                                  24750001
247600     COMPUTE PV-SUB = (CN013-ITEM (CN013-IDX)                     24760002
247700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              24770001
247800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         24780001
247900     MOVE LQW-SELECTED-SW (PV-SUB)                                24790001
248000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  24800001
248100     EVALUATE TRUE                                                24810001
248200         WHEN CN013-INQ (CN013-IDX)                               24820002
248300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             24830001
248400                                                                  24840076
248500         WHEN CN013-UPD (CN013-IDX)                               24850002
248600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             24860001
248620              MOVE CN013-TYPE-CODE(CN013-IDX)                     24862099
248630                               TO LQW-TYPE-CODE (PV-SUB)          24863099
248691              MOVE CN013-LOC-DESC (CN013-IDX)                     24869199
248692                               TO LQW-LOC-DESC (PV-SUB)           24869299
248695              MOVE CN013-LANE-ASGNMT(CN013-IDX)                   24869599
248696                               TO LQW-LANE-ASGNMNT(PV-SUB)        24869699
248697              MOVE CN013-DIVERT-LOC-ID(CN013-IDX)                 24869799
248698                               TO LQW-DIVERT-LOC (PV-SUB)         24869899
248699              MOVE CN013-LBL-SEQ-NBR(CN013-IDX)                   24869999
248700                               TO LQW-LABEL-NBR (PV-SUB)          24870099
248703              MOVE CN013-STORE-ASGNMT(CN013-IDX)                  24870399
248704                               TO LQW-STOR-ASGNMNT(PV-SUB)        24870499
248710                                                                  24871001
248800         WHEN CN013-DEL (CN013-IDX)                               24880002
248900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             24890001
249000                                                                  24900001
249100         WHEN CN013-ERR (CN013-IDX)                               24910002
249200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             24920001
249300                                                                  24930001
249400         WHEN OTHER                                               24940055
249500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             24950055
249510                                                                  24951055
249600     END-EVALUATE.                                                24960001
249700                                                                  24970001
249800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                24980001
249900                                                                  24990001
250000*----------------------------------------------------------------*25000001
250100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *25010001
250200*----------------------------------------------------------------*25020001
250300 6111-WRITE-LIST-QUEUE.                                           25030001
250310                                                                  25031099
250400     EXEC CICS                                                    25040001
250500         WRITEQ TS                                                25050001
250600             QUEUE (ASC-LIST-QUEUE-NAME)                          25060001
250700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     25070001
250800             ITEM  (PV-SAVE-ITEM)                                 25080001
250900             REWRITE                                              25090001
251000             RESP  (PV-CICS-RESP)                                 25100001
251100     END-EXEC.                                                    25110001
251200*                                                                 25120001
251300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25130001
251400         CONTINUE                                                 25140001
251500     ELSE                                                         25150001
251600         SET DP013-CICS-ABEND  TO  TRUE                           25160001
251700         SET DP013-NO-ROLLBACK TO  TRUE                           25170001
251800         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         25180001
251900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  25190001
252000                               TO  DP013-MESSAGE-TEXT(1)          25200001
252100         PERFORM DP013-0000-PROCESS-ABEND                         25210001
252200     END-IF.                                                      25220001
252300                                                                  25230001
252400*----------------------------------------------------------------*25240001
252500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*25250001
252600*----------------------------------------------------------------*25260001
252700 6112-READ-LIST-QUEUE.                                            25270001
252800     EXEC CICS                                                    25280001
252900         READQ TS                                                 25290001
253000             QUEUE (ASC-LIST-QUEUE-NAME)                          25300001
253100             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     25310001
253200             ITEM  (PV-ITEM)                                      25320001
253300             RESP  (PV-CICS-RESP)                                 25330001
253400     END-EXEC.                                                    25340001
253500*                                                                 25350001
253600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25360001
253700         CONTINUE                                                 25370001
253800     ELSE                                                         25380001
253900         SET DP013-CICS-ABEND        TO TRUE                      25390001
254000         SET DP013-NO-ROLLBACK       TO TRUE                      25400001
254100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           25410001
254200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    25420001
254300                                     TO DP013-MESSAGE-TEXT(1)     25430001
254400         PERFORM DP013-0000-PROCESS-ABEND                         25440001
254500     END-IF.                                                      25450001
254600                                                                  25460001
256000*----------------------------------------------------------------*25600001
256100*    ABEND PROCESSOR MODULE                                      *25610001
256200*----------------------------------------------------------------*25620001
256300     COPY DPPD013.                                                25630001
