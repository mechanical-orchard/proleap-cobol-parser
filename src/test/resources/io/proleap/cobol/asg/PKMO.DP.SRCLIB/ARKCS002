000100******************************************************************00010099
000110 IDENTIFICATION DIVISION.                                         00011099
000111******************************************************************00011199
000112                                                                  00011299
000113 PROGRAM-ID.                ARKCS002.                             00011399
000114 AUTHOR.                    RICK TULLOCH.                         00011499
000115 INSTALLATION.              KOHLS DEPARTMENT STORES.              00011599
000116 DATE-WRITTEN.              10-20-86.                             00011699
000117 DATE-COMPILED.                                                   00011799
000118                                                                  00011899
000119******************************************************************00011999
000120*  CICS PROGRAM - ARKCS002 - A002                                *00012099
000130*                                                                *00013099
000140*       ACCOUNTS RECEIVABLE SYSTEM - EMPLOYEE ACCOUNT            *00014099
000150*                                    MAINTENANCE (ADD/UPDATE/    *00015099
000160*                                    DELETE)                     *00016099
000170*                                                                *00017099
000180*  THIS PROGRAM ALLOWS FOR EMPLOYEE ACCOUNT MAINTENANCE AND      *00018099
000190*  ALSO FOR THE MAINTENANCE OF NON-EMPLOYEES WHO RECEIVE THE     *00019099
000200*  EMPLOYEE DISCOUNT. IT CAN BE ENTERED THROUGH THE EMPLOYEE     *00020099
000300*  DISCOUNT MAIN MENU OR THE EMPLOYEE ACCOUNT LIST.              *00030099
000400*                                                                *00040099
000500*  SEE ***NOTE*** BELOW - PROGRAM NO LONGER UPDATES              *00050099
000600*                                                                *00060099
000700*                     MAIN SCREEN FUNCTIONS                      *00070099
000800*                     ---- ------ ---------                      *00080099
000900* READ BY SSN (PF1)                                              *00090099
001000*  -AFTER THE SSN IS ENTERED, A SELECT BY SSN IS PERFORMED ON    *00100099
001100*   THE PEOPLESOFT EMPLOYEE VIEW.  IF THE SELECT IS SUCCESSFUL   *00110099
001200*   THEN THE EMPLOYEE ACCOUNT DISCOUNT TABLE IS QUERIED TO FIND  *00120099
001300*   THE EMPLOYEE'S ACCOUNT.  IF THE EMPLOYEE DOESN'T HAVE AN     *00130099
001400*   ACCOUNT, THEN THE ACCOUNT INFORMATION IS LEFT BLANK ON THE   *00140099
001500*   SCREEN.  IF THE PEOPLESOFT EMPLOYEE VIEW SELECT WAS          *00150099
001600*   UNSUCCESSFUL, THEN A SELECT IS PERFORMED ON THE NON-EMPLOYEE *00160099
001700*   DISCOUNT TABLE.  IF THE RECORD IS STILL NOT FOUND, THE SSN   *00170099
001800*   FIELD WILL BE HIGHLIGHTED AND AN ERROR MESSAGE WILL BE       *00180099
001900*   DISPLAYED.                                                   *00190099
002000*                                                                *00200099
002100* READ BY ACCT (PF2)                                             *00210099
002200*  -AFTER THE ACCOUNT NUMBER IS ENTERED, A SELECT BY ACCOUNT IS  *00220099
002300*   PERFORMED ON THE EMPLOYEE DISCOUNT ACCOUNT TABLE.  IF THE    *00230099
002400*   RECORD IS FOUND, THEN THE EMPLOYEE'S PERSONAL INFORMATION    *00240099
002500*   IS OBTAINED BY SELECTING ITS RECORD FROM THE PEOPLESOFT VIEW.*00250099
002600*   IF THIS IS UNSUCCESSFUL, THEN THE NON-EMPLOYEE TABLE IS      *00260099
002700*   QUERIED. IF THE ACCOUNT NUMBER IS NOT FOUND ON THE NON-      *00270099
002800*   EMPLOYEE TABLE, THEN THE ACCOUNT NUMBER FIELD IS HILIGHTED   *00280099
002900*   AND AN ERROR MESSAGE IS DISPLAYED.                           *00290099
003000*                                                                *00300099
003100* ADD (PF4)                                                      *00310099
003200*  -FOR EMPLOYEE ADDS, AN EMPLOYEE RECORD IS FIRST READ FROM THE *00320099
003300*   VIEW, AN ACCOUNT NUMBER AND ACCOUNT STATUS ARE ENTERED AND   *00330099
003400*   A RECORD GETS ADDED TO THE EMPLOYEE DISCOUNT ACCOUNT TABLE   *00340099
003500*   AND THE EMPLOYEE DISCOUNT MASTER FILE. FOR NON-EMPLOYEE ADDS,*00350099
003600*   ALL REQUIRED INFORMATION IS ENTERED ONTO THE SCREEN AND A    *00360099
003700*   RECORD IS ADDED TO THE NON-EMPLOYEE DISCOUNT TABLE AND THE   *00370099
003800*   EMPLOYEE DISCOUNT MASTER FILE.                               *00380099
003900*                                                                *00390099
004000* UPDATE (PF6)                                                   *00400099
004100*  -WHEN AN EMPLOYEE RECORD IS BEING CHANGED, ONLY TWO FIELDS    *00410099
004200*   CAN BE UPDATED - THE ACCOUNT NUMBER AND THE ACCOUNT NOTES.   *00420099
004300*   EACH NON-EMPLOYEE RECORD FIELD CAN BE UPDATED. AFTER A       *00430099
004400*   SUCCESSFUL READ, THE FIELDS ARE EDITED, THE UPDATE IS        *00440099
004500*   CONFIRMED AND THE EMPLOYEE DISCOUNT ACCOUNT TABLE OR THE     *00450099
004600*   NON-EMPLOYEE DISCOUNT TABLE ARE UPDATED.                     *00460099
004700*                                                                *00470099
004800* DELETE (PF8)                                                   *00480099
004900*  -AFTER A SUCCSFUL READ, A RECORD IS DELETED FROM EITHER THE   *00490099
005000*   EMPLOYEE DISCOUNT ACCOUNT TABLE OR THE NON-EMPLOYEE DISCOUNT *00500099
005100*   TABLE, AND THE EMPLOYEE DISCOUNT MASTER FILE.                *00510099
005200*                                                                *00520099
005300* SEARCH BY NAME (PF10)                                          *00530099
005400*  -TWO TYPES OF NAME SEARCHES ARE ALLOWED.                      *00540099
005500*   *A WILD CARD SEARCH USING EITHER PART OF A LAST NAME OR ALL  *00550099
005600*    OF THE LAST NAME. I.E. SMITH BRINGS UP ALL SMITHS           *00560099
005700*   *THE FIRST NAME OR PART OF THE FIRST NAME CAN BE ENTERED     *00570099
005800*    FOLLOWED BY A SPACE AND THE FULL LAST NAME. THIS WILL FIND  *00580099
005900*    AN EXACT MATCH ON THE LAST NAME AND WILDCARD MATCH ON THE   *00590099
006000*    FIRST NAME. I.E. J SMITH BRINGS UP JOHN SMITH, JAMES SMITH. *00600099
006100*                                                                *00610099
006200* SEARCH BY STORE (PF11)                                         *00620099
006300*  -A VALID KOHL'S STORE NUMBER IS ENTERED AND THE SEARCH WILL   *00630099
006400*   BRING UP ALL EMPLOYEES WHO WORK AT THAT STORE.               *00640099
006500*                                                                *00650099
006600* SEARCH BY SSN (PF12)                                           *00660099
006700*  -THE FULL SOCIAL SECURITY NUMBER OR PART OF THE SSN IS ENTERED*00670099
006800*   IN THE SSN FIELD. IF THE FULL SSN IS ENTERED, THE SEARCH WILL*00680099
006900*   BRING UP THE EMPLOYEE WITH THAT SSN. IF PART OF THE SSN IS   *00690099
007000*   ENTERED THEN A WILD CARD SEARCH WILL BE PERFORMED ON THE SSN.*00700099
007100*   I.E. 123 RETURNS 123456789, 123987654, 123789456.            *00710099
007200*                                                                *00720099
007300*                     SEARCH SCREEN FUNCTIONS                    *00730099
007400*                     ------ ------ ---------                    *00740099
007500* SCROLL UP (PF7)                                                *00750099
007600*  -ALLOWS THE USER TO SCROLL UP TO VIEW THE PREVIOUS RESULTS.   *00760099
007700*                                                                *00770099
007800* SCROLL DOWN (PF8)                                              *00780099
007900*  -ALLOWS THE USER TO SCROLL DOWN TO VIEW THE NEXT RESULTS.     *00790099
008000*                                                                *00800099
008100* SELECT ROW (PF9)                                               *00810099
008200*  -PLACING AN 'S' IN THE FIELD TO THE LEFT OF ANY ROW AND       *00820099
008300*   PRESSING PF9 CAUSES THE PROGRAM TO SWITCH TO MAIN SCREEN     *00830099
008400*   MODE AND READ THE SELECTED RECORD.                           *00840099
008500*                                                                *00850099
008600* SEARCH BY NAME (PF10)                                          *00860099
008700*  -WORKS THE SAME AS MAIN SCREEN EXCEPT DATA IS ENTERED IN THE  *00870099
008800*   SEARCH SCREEN'S SEARCH STRING FIELD.                         *00880099
008900*                                                                *00890099
009000* SEARCH BY STORE (PF11)                                         *00900099
009100*  -WORKS THE SAME AS MAIN SCREEN EXCEPT DATA IS ENTERED IN THE  *00910099
009200*   SEARCH SCREEN'S SEARCH STRING FIELD.                         *00920099
009300*                                                                *00930099
009400* SEARCH BY SSN (PF12)                                           *00940099
009500*  -WORKS THE SAME AS MAIN SCREEN EXCEPT DATA IS ENTERED IN THE  *00950099
009600*   SEARCH SCREEN'S SEARCH STRING FIELD.                         *00960099
009700*                                                                *00970099
009800*                        OTHER NOTES                             *00980099
009900*                        ----- -----                             *00990099
010000* PF3 KEY                                                        *01000099
010100*  -THE PF3 KEY SERVES THREE FUNCTIONS:                          *01010099
010200*   *WHEN AN ACTION IS BEING CONFIRMED, INSTEAD OF PRESSING THE  *01020099
010300*    FUNCTION KEY TO CONFIRM THE ACTION, THE PF3 KEY CAN BE      *01030099
010400*    PRESSED TO CANCEL THE ACTION.                               *01040099
010500*   *WHEN THE PROGRAM IS IN SEARCH SCREEN MODE, THE PF3 KEY WILL *01050099
010600*    RETURN THE PROGRAM TO MAIN SCREEN MODE.                     *01060099
010700*   *WHEN THE PROGRAM IS IN MAIN SCREEN MODE, THE PF3 KEY WILL   *01070099
010800*    RETURN CONTROL TO THE CALLING PROGRAM (EITHER THE MAIN MENU *01080099
010900*    SCREEN OR THE ACCOUNT LIST SCREEN).                         *01090099
011000*                                                                *01100099
011100* NAME SEARCH IS CASE SENSITIVE                                  *01110099
011200*  -BECAUSE THE NAMES ON THE PEOPLESOFT VIEW ARE MIXED CASE,     *01120099
011300*   THE NAME SEARCH IS CASE SENSITIVE. BECAUSE CICS CHANGES      *01130099
011400*   ALL CHARACTERS ENTERED TO UPPER CASE, A COBOL FUNCTION IS    *01140099
011500*   USED TO FORMAT THE NAME SO THAT THE FIRST INITIALS ARE MADE  *01150099
011600*   UPPER CASE AND THE REST OF THE NAME IS MADE LOWER CASE. THIS *01160099
011700*   ALLOWS THE SEARCH CRITERIA TO MATCH THE DATA IN THE TABLE,   *01170099
011800*   AND A SUCCESSFUL SEARCH TO BE PERFORMED.                     *01180099
011900*                                                                *01190099
012000* NON-EMPLOYEE NAME FORMAT                                       *01200099
012100*  -THE NAME ON THE NON-EMPLOYEE TABLE IS STORED IN THIS         *01210099
012200*   FORMAT: LAST,FIRST MI. IT'S FORMATTED AND STORED             *01220099
012300*   THIS WAY SO THAT IT'S IN THE SAME FORMAT AS THE NAME ON      *01230099
012400*   THE EMPLOYEE VIEW. BECAUSE THERE IS SOMETIMES MORE THAN      *01240099
012500*   ONE PART TO A FIRST OR LAST NAME, THREE DIFFERENT NAME FIELDS*01250099
012600*   HAVE BEEN PLACED ON THE BOTTOM OF THE SCREEN IN ORDER TO     *01260099
012700*   ALLOW THE USER TO VERIFY THAT THE NAME IS ENTERED IN THE WAY *01270099
012800*   THAT THEY INTENDED.                                          *01280099
012900*   I.E. MARY ANN SMITH - IT'S HARD TO TELL IF ANN IS THE        *01290099
013000*   MIDDLE NAME OR IF IT'S PART OF THE FIRST NAME.               *01300099
013100*   THE USER IS GIVEN THE CHANCE TO MAKE CORRECTIONS TO THE      *01310099
013200*   NAME IF THEY SEE THAT IT'S NOT HOW THEY WANT IT.             *01320099
013300*                                                                *01330099
013400* SYSTEM ERROR HANDLING                                          *01340099
013500*  -IF ANY SYSTEM ERRORS ARE DETECTED, THAT THE PROGRAM CAN      *01350099
013600*   NOT RESOLVE, THE EMPLOYEE DISCOUNT SYSTEM WILL BE TERMINATED,*01360099
013700*   THE CURRENT ACTION WILL BE ABORTED, AN ERROR MESSAGE WILL BE *01370099
013800*   DISPLAYED ON THE SCREEN, AND PROGRAM CONTROL WILL BE RETURNED*01380099
013900*   TO CICS.                                                     *01390099
014000*                                                                *01400099
014100* PROGRAM ACCESS                                                 *01410099
014200*  -DIRECT ENTRY INTO THIS TRANSACTION IS PROHIBITED.            *01420099
014300*   ATTEMPTING TO DO THIS RESULTS IN AN XCTL TO THE EMPLOYEE     *01430099
014400*   DISCOUNT MAIN MENU PROGRAM.                                  *01440099
014500******************************************************************01450099
014600* INC000002127970 - HR_V014_EMP_DISC IS OBSOLETE, USE XS TABLES   01460099
014700******************************************************************01470099
015100* 01/08/2013  COGNIZANT   CRQ000000039326                         01510099
015200*  - MODIFIED SQL IN THE PARA 7000- TO CONSIDER THE MAXIMUM BEG   01520099
015300*    DATE AMONG THE ROWS WHICH ARE NOT HAVING LAST ACTION CODE = D01530099
015400*    THIS FIX WILL AVOID DISPLAYING THE RECORD NOT FOUND EVEN IF  01540099
015500*    THE EMPLOYEE IS ACTIVE.                                      01550099
015600******************************************************************01560099
015700* 08/28/2015  COGNIZANT   CHG0125054                              01570099
015800* - CHANGES TO DISPLAY THE ACCOUNT NUMBER AND SSN AS CLEAR TEXT   01580099
015900*   FOR USERS WHO HAVE ACCESS TO BOTH ACCOUNT NUMBER AND SSN.     01590099
016000* - CHANGES TO DISPLAY THE ACCOUNT NUMBER AS CLEAR TEXT BUT SSN   01600099
016100*   AS MASKED FOR USERS WHO HAVE ACCESS TO ACCOUNT NUMBER ALONE.  01610099
016200* - CHANGES TO DISPLAY THE SSN AS CLEAR TEXT BUT ACCOUNT NUMBER   01620099
016300*   AS MASKED FOR USERS WHO HAVE ACCESS TO SSN ALONE.             01630099
016400* - FOR ALL THE ABOVE CASES EMPLOYEE NAME WILL BE DISPLAYED AS    01640099
016500*   CLEAR TEXT.                                                   01650099
016600******************************************************************01660099
016700* 11/07/2016  CHERI PARMLEY  CHG0168613                           01670099
016800* - THIS PROGRAM WAS CHANGED TO REMOVE THE XST_ASSOC AND THE      01680099
016900*   XST_ASSOC_EMPT TABLES. THE VALUES THAT WERE NEEDED FOR THIS   01690099
017000* - PROGRAM ARE NOW ALL ON THE ART_EMP_DISC TABLE.                01700099
017100* -                                                               01710099
017200* - TABLE ART_NON_EMP_DISC WAS ALSO REMOVED, IT WAS DETERMINED    01720099
017300* - ALL THE ENTRIES ARE ON THE ART_EMP_DISC.                      01730099
017400* -                                                               01740099
017500* - ***NOTE***                                                    01750099
017600* - NOTE: THE PROGRAM COMMENTS INDICATE THIS IS A MAINTENANCE     01760099
017700* -       PROGRAM. THIS IS INCORRECT. PROGRAM ORIGINALLY UPDATED  01770099
017800* -       BUT NO LONGER DOES. KEYS HAVE BEEN REMOVED FROM SCREEN  01780099
017900* -       AND THE UPDATE/INSERT LOGIC IS COMMENTED OUT.           01790099
017901******************************************************************01790199
017902* DATE  09/01/2021                                                01790299
017903*            - CHANGE CALL OF DPKUT100 TO                       * 01790399
017904*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 01790499
017905*              MAKING THE CALL DYNAMIC VS STATIC                * 01790599
017906*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        01790699
017907******************************************************************01790799
018100                                                                  01810099
018200******************************************************************01820099
018300 ENVIRONMENT DIVISION.                                            01830099
018400******************************************************************01840099
018500                                                                  01850099
018600******************************************************************01860099
018700 DATA DIVISION.                                                   01870099
018800******************************************************************01880099
018900 WORKING-STORAGE SECTION.                                         01890099
019000*                                                                 01900099
019100*  EMPLOYEE DISCOUNT - MAINTENANCE LOG FILE RECORD LAYOUT         01910099
019200*                                                                 01920099
019300     COPY ARRD506O.                                               01930099
019400                                                                  01940099
019500*                                                                 01950099
019600*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01960099
019700*                                                                 01970099
019800     COPY DPWS010I.                                               01980099
019900                                                                  01990099
020000*---------------------------------------------------------------* 02000099
020100*    ABEND PROCESSING COPYBOOK.                                 * 02010099
020200*---------------------------------------------------------------* 02020099
020300                                                                  02030099
020400     COPY DPWS013.                                                02040099
020500                                                                  02050099
020600******************************************************************02060099
020700*  VARIABLES TO CONVERT FROM BASE64 TO BINARY & VICE VERSA        02070099
020800******************************************************************02080099
020900     COPY DPWS022.                                                02090099
021000                                                                  02100099
021100******************************************************************02110099
021200*  VARIABLES TO CONVERT FROM ASCII TO EBCDIC & VICE VERSA         02120099
021300******************************************************************02130099
021400     COPY DPWS053.                                                02140099
021500                                                                  02150099
021600*---------------------------------------------------------------* 02160099
021700* LAYOUT FOR THE PARAMETERS NEEDED TO INVOKE PROTEGRITY MODULE  * 02170099
021800*---------------------------------------------------------------* 02180099
021900     COPY PTYCCSIP.                                               02190099
022000                                                                  02200099
022100*---------------------------------------------------------------* 02210099
022200* LAYOUT FOR THE WORKING VARIABLES TO INVOKE PROTEGRITY MODULE  * 02220099
022300*---------------------------------------------------------------* 02230099
022400     COPY DPWS031.                                                02240099
022500                                                                  02250099
022600*---------------------------------------------------------------* 02260099
022700* LAYOUT FOR THE WORKING VARIABLES USED IN THE DPPD013 MODULE   * 02270099
022800*---------------------------------------------------------------* 02280099
022900                                                                  02290099
023000     COPY DPWS020.                                                02300099
023100*                                                                 02310099
023200*  STANDARD ATTENTION IDENTIFIER LIST                             02320099
023300*                                                                 02330099
023400     COPY DFHAID.                                                 02340099
023500                                                                  02350099
023600*                                                                 02360099
023700*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          02370099
023800*                                                                 02380099
023900     COPY DPWS015.                                                02390099
024000                                                                  02400099
024100*                                                                 02410099
024200*  DSECT FOR THE ARKM002 MAPSET                                   02420099
024300*                                                                 02430099
024400     COPY ARKM002.                                                02440099
024500                                                                  02450099
024600 01 AR002BI-R REDEFINES AR002BI.                                  02460099
024700    02 FILLER             PIC X(109).                             02470099
024800    02 BSELECTION OCCURS 14 TIMES.                                02480099
024900       03 BSELL     COMP PIC S9(4).                               02490099
025000       03 BSELF          PIC X.                                   02500099
025100       03 FILLER REDEFINES BSELF.                                 02510099
025200          04 BSELA       PIC X.                                   02520099
025300       03 FILLER         PIC X(1).                                02530099
025400       03 BSELI          PIC X(1).                                02540099
025500       03 BNAMEL    COMP PIC S9(4).                               02550099
025600       03 BNAMEF         PIC X.                                   02560099
025700       03 FILLER REDEFINES BNAMEF.                                02570099
025800          04 BNAMEA      PIC X.                                   02580099
025900       03 FILLER         PIC X(1).                                02590099
026000       03 BNAMEI         PIC X(40).                               02600099
026100       03 BSSNL     COMP PIC S9(4).                               02610099
026200       03 BSSNF          PIC X.                                   02620099
026300       03 FILLER REDEFINES BSSNF.                                 02630099
026400          04 BSSNA       PIC X.                                   02640099
026500       03 FILLER         PIC X(1).                                02650099
026600       03 BSSNI          PIC X(9).                                02660099
026700       03 BSTRL     COMP PIC S9(4).                               02670099
026800       03 BSTRF          PIC X.                                   02680099
026900       03 FILLER REDEFINES BSTRF.                                 02690099
027000          04 BSTRA       PIC X.                                   02700099
027100       03 FILLER         PIC X(1).                                02710099
027200       03 BSTRI          PIC X(4).                                02720099
027300                                                                  02730099
027400 01 AR002BO-R REDEFINES AR002BO.                                  02740099
027500    02 FILLER           PIC X(109).                               02750099
027600    02 BSELECTION OCCURS 14 TIMES.                                02760099
027700       03  FILLER          PIC X(3).                              02770099
027800       03 BSELH            PIC X.                                 02780099
027900       03 BSELO            PIC X(1).                              02790099
028000       03 FILLER           PIC X(3).                              02800099
028100       03 BNAMEH           PIC X.                                 02810099
028200       03 BNAMEO           PIC X(40).                             02820099
028300       03 FILLER           PIC X(3).                              02830099
028400       03 BSSNH            PIC X.                                 02840099
028500       03 BSSNO            PIC X(9).                              02850099
028600       03 FILLER           PIC X(3).                              02860099
028700       03 BSTRH            PIC X.                                 02870099
028800       03 BSTRO            PIC X(4).                              02880099
028900                                                                  02890099
029000*----------------------------------------------------------------*02900099
029100*     INCLUDE DATE ROUTINE COPY MEMBER                           *02910099
029200*----------------------------------------------------------------*02920099
029300     COPY DPWS500.                                                02930099
029400                                                                  02940099
029500*----------------------------------------------------------------*02950099
029600*    SECURITY SUBROUTINE.                                        *02960099
029700*----------------------------------------------------------------*02970099
029800     COPY DPWS008.                                                02980099
029900                                                                  02990099
030000 01 PS-PROGRAM-SWITCHES.                                          03000099
030100    05 PS-EDIT-ERROR-IND            PIC X(1)  VALUE 'N'.          03010099
030200       88 PS-NO-EDIT-ERROR                    VALUE 'N'.          03020099
030300       88 PS-EDIT-ERROR                       VALUE 'Y'.          03030099
030400    05 PS-DATE-EDIT-ERROR-IND       PIC X(1)  VALUE 'N'.          03040099
030500       88 PS-NO-DATE-EDIT-ERROR               VALUE 'N'.          03050099
030600       88 PS-DATE-EDIT-ERROR                  VALUE 'Y'.          03060099
030700    05 PS-CHECK-DIGIT-COMPUTE-IND   PIC X(1)  VALUE '1'.          03070099
030800       88 PS-MULTIPLY-DIGIT-BY-1              VALUE '1'.          03080099
030900       88 PS-MULTIPLY-DIGIT-BY-2              VALUE '2'.          03090099
031000    05 PS-CMNT-CHAR-SW              PIC X(1)  VALUE SPACES.       03100099
031100       88 PS-CMNT-CHAR-FOUND                  VALUE 'Y'.          03110099
031200    05 PS-RECORD-CHANGE-SW          PIC X(1)  VALUE SPACES.       03120099
031300       88 PS-RECORD-CHANGED                   VALUE 'Y'.          03130099
031400    05 PS-READQ-EOF-SW              PIC X(1)  VALUE SPACES.       03140099
031500       88 PS-READQ-EOF                        VALUE 'Y'.          03150099
031600    05 PS-SELECTION-SW              PIC X(1)  VALUE SPACES.       03160099
031700       88 PS-SELECTION-MADE                   VALUE 'Y'.          03170099
031800    05 PS-NO-MORE-ROWS-SW           PIC X(1)  VALUE SPACES.       03180099
031900       88 PS-NO-MORE-ROWS                     VALUE 'N'.          03190099
032000    05 PS-USE-CONFIRM-FIELD-SW      PIC X(1)  VALUE SPACES.       03200099
032100       88 PS-USE-CONFIRM-FIELD                VALUE 'Y'.          03210099
032200    05 PS-SQL-ACTION-TEXT           PIC X(11) VALUE SPACES.       03220099
032300       88 PS-SELECT-TEXT                      VALUE 'SELECT'.     03230099
032400       88 PS-SELECT-EMP-SSN-TEXT              VALUE 'SELECT SSN'. 03240099
032500       88 PS-SELECT-EMP-ACCT-TEXT             VALUE 'SELECT ACCT'.03250099
032600       88 PS-INSERT-TEXT                      VALUE 'INSERT'.     03260099
032700       88 PS-UPDATE-TEXT                      VALUE 'UPDATE'.     03270099
032800       88 PS-DELETE-TEXT                      VALUE 'DELETE'.     03280099
032900       88 PS-CURSOROPEN-TEXT                  VALUE 'OPEN CURSOR'.03290099
033000       88 PS-CURSORCLOSE-TEXT                 VALUE 'CLOSE CURSR'.03300099
033100       88 PS-FETCH-TEXT                       VALUE 'FETCH'.      03310099
033200    05 PS-ACTION                    PIC X(1)  VALUE SPACES.       03320099
033300       88 PS-ADD                              VALUE 'A'.          03330099
033400       88 PS-UPDATE                           VALUE 'C'.          03340099
033500       88 PS-DELETE                           VALUE 'D'.          03350099
033600    05 PS-ALL-CAPS-SUFFIXES         PIC X(6)  VALUE SPACES.       03360099
033700       88 PS-ALL-CAPS                         VALUE 'I'  , 'II'  ,03370099
033800                                                    'III', 'IV'  ,03380099
033900                                                    'V'  , 'MD'  ,03390099
034000                                                    'PHD', 'ATTY',03400099
034100                                                    'ESQ', 'DC'  ,03410099
034200                                                    'DO' , 'OD'  ,03420099
034300                                                    'DDS', 'J.D.',03430099
034400                                                    'M.D.S.'.     03440099
034500    05 PS-ACCOUNT-PRFX-SW           PIC X(8)  VALUE SPACES.       03450099
034600       88 PS-VALID-ACCT-PRFX                  VALUE '01', '02',   03460099
034700                                                    '03', '04',   03470099
034800                                                    '05', '06',   03480099
034900                                                    '07', '08',   03490099
035000                                                    '09'.         03500099
035100    05 PS-NO-MORE-RECS-SW           PIC X(1)  VALUE SPACES.       03510099
035200       88 PS-MORE-RECS                        VALUE SPACES.       03520099
035300       88 PS-NO-MORE-RECS                     VALUE 'Y'.          03530099
035400                                                                  03540099
035500 01 PC-PROGRAM-CONSTANTS.                                         03550099
035600    05 PC-SEARCH-QUEUE-LENGTH       PIC S9(4)  VALUE +118   COMP. 03560099
035700    05 PC-READNEXT-QUEUE-LENGTH     PIC S9(4)  VALUE +226   COMP. 03570099
035800    05 PC-LEAVE-SYSTEM-LENGTH       PIC S9(4)  VALUE +240   COMP  03580099
035900                                                            SYNC. 03590099
036000    05 PC-COMMON-AREA-LENGTH        PIC S9(4)  VALUE +330   COMP  03600099
036100                                                            SYNC. 03610099
036200    05 PC-TRANSFER-UP-LENGTH        PIC S9(4)  VALUE +29    COMP  03620099
036300                                                            SYNC. 03630099
036400    05 PC-MAXIMUM-ACCOUNT-DIGITS    PIC S9(4)  VALUE +9     COMP  03640099
036500                                                            SYNC. 03650099
036600    05 PC-SUCCESSFUL-SQLCODE        PIC S9(9)  VALUE ZEROS  COMP  03660099
036700                                                            SYNC. 03670099
036800    05 PC-ROW-NOT-FOUND-SQLCODE     PIC S9(9)  VALUE +100   COMP  03680099
036900                                                            SYNC. 03690099
037000    05 PC-DUPLICATE-ROW-SQLCODE     PIC S9(9)  VALUE -803   COMP  03700099
037100                                                            SYNC. 03710099
037110    05 PC-MORE-ROWS-SQLCODE         PIC S9(9)  VALUE -811   COMP  03711099
037120                                                            SYNC. 03712099
037130    05 PC-EOF-KEYED-COMP            PIC S9(4)  VALUE +128   COMP  03713099
037140                                                            SYNC. 03714099
037150    05 FILLER REDEFINES                                           03715099
037160       PC-EOF-KEYED-COMP.                                         03716099
037170       10  FILLER                   PIC X(1).                     03717099
037180       10  PC-EOF-KEYED             PIC X(1).                     03718099
037190    05 PC-CURRENT-TRANSID           PIC X(4)   VALUE 'A002'.      03719099
037200    05 PC-CURRENT-PROGRAM-NAME      PIC X(8)   VALUE 'ARKCS002'.  03720099
037300    05 PC-LIST-PROGRAM-NAME         PIC X(8)   VALUE 'ARKCS001'.  03730099
037400    05 PC-MAIN-MENU-PROGRAM-NAME    PIC X(8)   VALUE 'ARKCS000'.  03740099
037500    05 PC-FUNCTION-NAME             PIC X(8)   VALUE 'ARDISCST'.  03750099
037600    05 PC-CURRENT-PROGRAM-TRANSID   PIC X(4)   VALUE 'A002'.      03760099
037700    05 PC-KOHLS-OPERATING-CO        PIC X(2)   VALUE '03'.        03770099
037800    05 PC-SQL-SEARCH-WILD-CARD      PIC X(50)  VALUE ALL '%'.     03780099
037900    05 PC-MAXIMUM-DIGIT-AMOUNT      PIC 9(1)   VALUE 9.           03790099
038000    05 PC-MOD-10                    PIC 9(2)   VALUE 10.          03800099
038100    05 PC-KOHLS-EARLIEST-HIRE-YEAR  PIC X(4)   VALUE '1965'.      03810099
038200                                                                  03820099
038300 01 PV-PROGRAM-VARIABLES.                                         03830099
038600    05 PV-CURRENT-YEAR              PIC S9(9)  VALUE ZEROES COMP  03860099
038700                                                            SYNC. 03870099
038800    05 PV-RBA                       PIC S9(9)  VALUE ZEROES COMP  03880099
038900                                                            SYNC. 03890099
039000    05 PV-CICS-RESPONSE             PIC S9(9)  VALUE ZEROES COMP  03900099
039100                                                            SYNC. 03910099
039200    05 PV-SEARCH-PTR                PIC S9(4)  VALUE ZEROES COMP. 03920099
039300    05 PV-EMPTY-FIELD-CNT           PIC S9(4)  VALUE ZEROES COMP. 03930099
039400    05 PV-CMNT-TXT-PTR              PIC S9(4)  VALUE ZEROES COMP. 03940099
039500    05 PV-COMMA-CTR                 PIC S9(4)  VALUE ZEROES COMP. 03950099
039600    05 PV-MAX-ACCT-CTR              PIC S9(4)  VALUE ZEROES COMP. 03960099
039700    05 PV-SEL-VALUE                 PIC S9(4)  VALUE ZEROES COMP. 03970099
039800    05 PV-DISPLAY-KEY               PIC X(10)  VALUE SPACES.      03980099
039900    05 PV-TRANSFER-PROGRAM-NAME     PIC X(8)   VALUE SPACES.      03990099
040000    05 PV-LEAVE-SYSTEM-MESSAGE      PIC X(240) VALUE SPACES.      04000099
040100    05 PV-SQL-TABLE-NAME            PIC X(16)  VALUE SPACES.      04010099
040200    05 PV-USER-ID                   PIC X(8)   VALUE SPACES.      04020099
040300    05 PV-PREV-SCRN-MDY.                                          04030099
040400       10 PV-PREV-SCRN-MM           PIC 9(2)   VALUE ZEROS.       04040099
040500       10 PV-PREV-SCRN-DD           PIC 9(2)   VALUE ZEROS.       04050099
040600       10 PV-PREV-SCRN-YY           PIC 9(2)   VALUE ZEROS.       04060099
040700    05 PV-CURRENT-DATE-YMD          PIC X(6)   VALUE SPACES.      04070099
040800    05 PV-CURRENT-DATE-MDY          PIC X(6)   VALUE SPACES.      04080099
040900    05 PV-CURRENT-DATE-MDCY.                                      04090099
041000       10 PV-CURRENT-MM             PIC X(2)   VALUE SPACES.      04100099
041100       10 PV-CURRENT-DD             PIC X(2)   VALUE SPACES.      04110099
041200       10 PV-CURRENT-CC             PIC X(2)   VALUE SPACES.      04120099
041300       10 PV-CURRENT-YY             PIC X(2)   VALUE SPACES.      04130099
041400    05 PV-FORMAT-DATE.                                            04140099
041500       10 PV-FORMAT-MM              PIC X(2)   VALUE SPACES.      04150099
041600       10 PV-FORMAT-DD              PIC X(2)   VALUE SPACES.      04160099
041700       10 PV-FORMAT-CC              PIC X(2)   VALUE SPACES.      04170099
041800       10 PV-FORMAT-YY              PIC X(2)   VALUE SPACES.      04180099
041900    05 PV-DATE-VSAM-FORMAT.                                       04190099
042000       10 PV-VSAM-MM                PIC X(2)   VALUE SPACES.      04200099
042100       10 PV-VSAM-DD                PIC X(2)   VALUE SPACES.      04210099
042200       10 PV-VSAM-YY                PIC X(2)   VALUE SPACES.      04220099
042300    05 PV-DATE-ISO-FORMAT-1.                                      04230099
042400       10 PV-DATE-ISO-CCYY-1        PIC X(4)   VALUE SPACES.      04240099
042500       10 PV-DATE-ISO-MM-1          PIC X(2)   VALUE SPACES.      04250099
042600       10 PV-DATE-ISO-DD-1          PIC X(2)   VALUE SPACES.      04260099
042700    05 PV-DATE-ISO-FORMAT-2.                                      04270099
042800       10 PV-DATE-ISO-CCYY-2        PIC X(4)   VALUE SPACES.      04280099
042900       10 PV-DATE-ISO-MM-2          PIC X(2)   VALUE SPACES.      04290099
043000       10 PV-DATE-ISO-DD-2          PIC X(2)   VALUE SPACES.      04300099
043100    05 PV-CURRENT-TIME              PIC X(6)   VALUE SPACES.      04310099
043200    05 PV-SQL-DATE-GROUP.                                         04320099
043300       10 PV-SQL-CCYY.                                            04330099
043400          15 PV-SQL-CC              PIC X(2)   VALUE SPACES.      04340099
043500          15  PV-SQL-YY             PIC X(2)   VALUE SPACES.      04350099
043600       10 FILLER                    PIC X(1)   VALUE '-'.         04360099
043700       10 PV-SQL-MM                 PIC X(2)   VALUE SPACES.      04370099
043800       10 FILLER                    PIC X(1)   VALUE '-'.         04380099
043900       10 PV-SQL-DD                 PIC X(2)   VALUE SPACES.      04390099
044000    05 PV-CMNT-TXT-FIELD            PIC X(80)  VALUE SPACES.      04400099
044100    05 PV-CMNT-TXT-CHAR REDEFINES                                 04410099
044200       PV-CMNT-TXT-FIELD            PIC X(1)   OCCURS 80 TIMES.   04420099
044300    05 PV-EMP-SRCH-TABLE                       OCCURS 14 TIMES.   04430099
044400       10 PV-SSN-NBR-ROW            PIC X(20)  VALUE SPACES.      04440099
044500       10 PV-EMP-NM-ROW             PIC X(88)  VALUE SPACES.      04450099
044600       10 PV-STR-NBR-ROW            PIC X(10)  VALUE SPACES.      04460099
044700    05 PV-EMP-SEARCH-GROUP.                                       04470099
044800       10 PV-SSN-NBR                PIC X(20)  VALUE SPACES.      04480099
044900       10 PV-EMP-NM                 PIC X(88)  VALUE SPACES.      04490099
045000       10 PV-STR-NBR                PIC X(10)  VALUE SPACES.      04500099
045100    05 PV-NAME-WORK-FLD-1           PIC X(40)  VALUE SPACES.      04510099
045200    05 PV-NAME-WORK-FLD-2           PIC X(40)  VALUE SPACES.      04520099
045300    05 PV-NAME-WORK-FLD-3           PIC X(40)  VALUE SPACES.      04530099
045400    05 PV-NAME-WORK-FLD-1-GROUP.                                  04540099
045500       10 PV-NAME-WORK-FLD-1-UPPER  PIC X(1)   VALUE SPACES.      04550099
045600       10 PV-NAME-WORK-FLD-1-LOWER  PIC X(39)  VALUE SPACES.      04560099
045700    05 PV-NAME-WORK-FLD-2-GROUP.                                  04570099
045800       10 PV-NAME-WORK-FLD-2-UPPER  PIC X(1)   VALUE SPACES.      04580099
045900       10 PV-NAME-WORK-FLD-2-LOWER  PIC X(39)  VALUE SPACES.      04590099
046000    05 PV-NAME-WORK-FLD-3-GROUP.                                  04600099
046100       10 PV-NAME-WORK-FLD-3-UPPER  PIC X(1)   VALUE SPACES.      04610099
046200       10 PV-NAME-WORK-FLD-3-LOWER  PIC X(39)  VALUE SPACES.      04620099
046300    05 PV-DATE-WORK-FLD-2           PIC 9(2)   VALUE ZEROES.      04630099
046400    05 PV-DATE-WORK-FLD-4           PIC 9(4)   VALUE ZEROES.      04640099
046500    05 PV-TEMP-READNEXT-REC.                                      04650099
046600       10 PV-TEMP-EMP-ID            PIC X(11)  VALUE SPACES.      04660099
046700       10 PV-TEMP-SSN-NBR           PIC X(9)   VALUE SPACES.      04670099
046800       10 PV-TEMP-ACCT-NBR          PIC X(10)  VALUE SPACES.      04680099
046900       10 PV-TEMP-EMP-NAME          PIC X(88)  VALUE SPACES.      04690099
047000       10 PV-TEMP-STR-NBR           PIC X(4)   VALUE SPACES.      04700099
047100       10 PV-TEMP-EMP-STAT          PIC X(1)   VALUE SPACES.      04710099
047200       10 PV-TEMP-EMP-CODE          PIC X(1)   VALUE SPACES.      04720099
047300       10 PV-TEMP-DISC-STAT         PIC X(1)   VALUE SPACES.      04730099
047400       10 PV-TEMP-DISC-DTE          PIC X(10)  VALUE SPACES.      04740099
047500       10 PV-TEMP-TERM-DTE          PIC X(10)  VALUE SPACES.      04750099
047600       10 PV-TEMP-ACCT-NOTES-GRP.                                 04760099
047700          15 PV-TEMP-ACCT-NOTES-1   PIC X(40)  VALUE SPACES.      04770099
047800          15 PV-TEMP-ACCT-NOTES-2   PIC X(40)  VALUE SPACES.      04780099
047900       10 PV-TEMP-REHIR-TEXT-FLAG   PIC X(1)   VALUE SPACES.      04790099
048000          88 PV-TEMP-REHIR-ON                  VALUE 'Y'.         04800099
048100          88 PV-TEMP-REHIR-OFF                 VALUE 'N'.         04810099
048200    05 PV-TOKEN-SS-NBR              PIC X(20).                    04820099
048300    05 PV-SSN-NUMBER                PIC X(20)  VALUE SPACES.      04830099
048400    05 PV-ACCOUNT-NBR-12.                                         04840099
048500       10 PV-ACCOUNT-NBR-10         PIC X(10)  VALUE SPACES.      04850099
048600       10 FILLER                    PIC X(02)  VALUE '00'.        04860099
048700    05 PV-ACCT-NBR-TOKEN            PIC S9(10)V COMP-3.           04870099
048800    05 PV-INPUT-LEN                 PIC 9(09)  VALUE ZEROES.      04880099
048900    05 PV-EMP-NM-ENC                PIC X(88)  VALUE SPACES.      04890099
049000    05 PV-INPUT-TEXT                PIC X(88)  VALUE SPACES.      04900099
049100    05 PV-OUTPUT-TEXT               PIC X(66)  VALUE SPACES.      04910099
049200    05  PV-STR-DIGITS               PIC X(10).                    04920099
049300    05  PV-STR-DIGITS-R REDEFINES PV-STR-DIGITS.                  04930099
049400        10  FILLER                  PIC X(06).                    04940099
049500        10  PV-STR-CHAR4            PIC X(04).                    04950099
049600                                                                  04960099
049700 01 EU-EMP-UPDATE-MNTNC-DATA.                                     04970099
049800    05 EU-SSN-NBR                   PIC X(09).                    04980099
049810    05 EU-EMP-DISC-STAT             PIC X(01).                    04981099
049820    05 EU-DISC-DTE                  PIC X(10).                    04982099
049830    05 EU-CRS-EMP-CDE               PIC X(01).                    04983099
049840    05 EU-EMP-NAME                  PIC X(88).                    04984099
049850    05 EU-EMP-TYP-CDE               PIC X(01).                    04985099
049860    05 EU-EMP-STAT-CDE              PIC X(01).                    04986099
049870    05 EU-ACCT-NBR                  PIC X(10).                    04987099
049880    05 EU-STORE-NBR                 PIC X(04).                    04988099
049890    05 EU-TERM-DTE                  PIC X(10).                    04989099
049900    05 EU-COMMENT-TXT               PIC X(80).                    04990099
050000    05 EU-NOTES-1                PIC X(40).                       05000099
050100    05 EU-NOTES-2                PIC X(40).                       05010099
050200                                                                  05020099
050300 01 CC-COMPUTE-CHECK-DIGIT-AREA.                                  05030099
050400    05 CC-ACCOUNT-NUMBER.                                         05040099
050500       10 CC-ACCOUNT-PRFX           PIC X(2)   VALUE SPACES.      05050099
050600       10 FILLER                    PIC X(8)   VALUE SPACES.      05060099
050700    05 FILLER REDEFINES                                           05070099
050800       CC-ACCOUNT-NUMBER.                                         05080099
050900       10  CC-ACCOUNT-DIGIT         PIC 9(1)   OCCURS 9 TIMES     05090099
051000                                               INDEXED BY         05100099
051100                                               CC-DIGIT-INDEX.    05110099
051200       10  CC-ACCOUNT-CHECK-DIGIT   PIC 9(1).                     05120099
051300    05 CC-ACCOUNT-DIGIT-MOD-10      PIC 9(2)   VALUE ZEROES.      05130099
051400    05 CC-MOD-10-DIGIT-SUM          PIC 9(1)   VALUE ZEROES.      05140099
051500    05 CC-COMPUTED-CHECK-DIGIT      PIC 9(1)   VALUE ZEROES.      05150099
051600                                                                  05160099
051700 01 IC-ISO-CURRENT-DATE-AREA.                                     05170099
051800    05 IC-ISO-CURRENT-DATE-X.                                     05180099
051900       10 FILLER                    PIC X(2)   VALUE SPACES.      05190099
052000       10 IC-FORMATTED-DATE-YMD     PIC X(8)   VALUE SPACES.      05200099
052100    05 FILLER REDEFINES                                           05210099
052200       IC-ISO-CURRENT-DATE-X.                                     05220099
052300       10  IC-CURRENT-YEAR          PIC 9(4).                     05230099
052400       10  FILLER                   PIC X(6).                     05240099
052500    05 IC-ISO-CURRENT-DATE REDEFINES                              05250099
052600       IC-ISO-CURRENT-DATE-X        PIC X(10).                    05260099
052700                                                                  05270099
052800 01 DE-DB2-ERROR-MESSAGE.                                         05280099
052900    05 FILLER                       PIC X(40)  VALUE              05290099
053000       'A DB2 ERROR HAS OCCURRED - CONTACT DP - '.                05300099
053100    05 FILLER                       PIC X(45)  VALUE              05310099
053200       'PROGRAM ARKCS002'.                                        05320099
053300    05 FILLER                       PIC X(11)  VALUE              05330099
053400       'SQLCODE = ('.                                             05340099
053500    05 DE-SQLCODE                   PIC Z(8)9- VALUE ZEROES.      05350099
053600    05 FILLER                       PIC X(21)  VALUE              05360099
053700       ')  ROWS PROCESSED = ('.                                   05370099
053800    05 DE-ROWS-PROCESSED            PIC Z(8)9- VALUE ZEROES.      05380099
053900    05 FILLER                       PIC X(28)  VALUE ')'.         05390099
054000    05 FILLER                       PIC X(14)  VALUE              05400099
054100       'ATTEMPTING TO '.                                          05410099
054200    05 DE-ATTEMPTED-ACTION          PIC X(61)  VALUE SPACES.      05420099
054300                                                                  05430099
054400 01 DW-DB2-WARNING-MESSAGE.                                       05440099
054500    05 FILLER                       PIC X(42)  VALUE              05450099
054600         'A DB2 WARNING HAS OCCURRED - CONTACT DP - '.            05460099
054700    05 FILLER                       PIC X(43)  VALUE              05470099
054800         'PROGRAM ARKCS002'.                                      05480099
054900    05 FILLER                       PIC X(11)  VALUE              05490099
055000         'SQLCODE = ('.                                           05500099
055100    05 DW-SQLCODE                   PIC Z(8)9- VALUE ZEROES.      05510099
055200    05 FILLER                       PIC X(21)  VALUE              05520099
055300         ')  ROWS PROCESSED = ('.                                 05530099
055400    05 DW-ROWS-PROCESSED            PIC Z(8)9- VALUE ZEROES.      05540099
055500    05 FILLER                       PIC X(14)  VALUE              05550099
055600         ')  SQLWARN = ('.                                        05560099
055700    05 DW-SQLWARN                   PIC X(8)   VALUE SPACES.      05570099
055800    05 FILLER                       PIC X(6)   VALUE ')'.         05580099
055900    05 FILLER                       PIC X(14)  VALUE              05590099
056000         'ATTEMPTING TO '.                                        05600099
056100    05 DW-ATTEMPTED-ACTION          PIC X(61)  VALUE SPACES.      05610099
056200                                                                  05620099
056300 01 SE-SYSTEM-ERROR-MESSAGE.                                      05630099
056400    05 FILLER                       PIC X(43)  VALUE              05640099
056500       'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.             05650099
056600    05 FILLER                       PIC X(33)  VALUE              05660099
056700       'PROGRAM ARKCS002       EIBRESP = '.                       05670099
056800    05 SE-CICS-RESPONSE             PIC 9(4)   VALUE ZEROES.      05680099
056900    05 FILLER                       PIC X(5)   VALUE SPACES.      05690099
057000    05 FILLER                       PIC X(14)  VALUE              05700099
057100       'ATTEMPTING TO '.                                          05710099
057200    05 SE-ATTEMPTED-ACTION          PIC X(61)  VALUE SPACES.      05720099
057300                                                                  05730099
057400 01 VE-VSAM-ERROR-MESSAGE.                                        05740099
057500    05 FILLER                       PIC X(41)  VALUE              05750099
057600       'A VSAM ERROR HAS OCCURRED - CONTACT DP - '.               05760099
057700    05 FILLER                       PIC X(31)  VALUE              05770099
057800       'PROGRAM ARKCS002      DDNAME = '.                         05780099
057900    05 VE-FILE-DDNAME               PIC X(8)   VALUE SPACES.      05790099
058000    05 FILLER                       PIC X(5)   VALUE SPACES.      05800099
058100    05 FILLER                       PIC X(14)  VALUE              05810099
058200       'ATTEMPTING TO '.                                          05820099
058300    05 VE-ATTEMPTED-ACTION          PIC X(46)  VALUE SPACES.      05830099
058400    05 FILLER                       PIC X(11)  VALUE              05840099
058500       ' EIBRESP = '.                                             05850099
058600    05 VE-CICS-RESPONSE             PIC 9(4)   VALUE ZERO.        05860099
058700                                                                  05870099
058800 01 ST-SYSTEM-TIME-AREA.                                          05880099
058900    05 ST-ABSTIME                   PIC S9(18) VALUE ZERO COMP    05890099
059000                                                          SYNC.   05900099
059100    05 ST-TIME-EDIT.                                              05910099
059200       10 ST-TIME-HHMM              PIC X(5)   VALUE SPACES.      05920099
059300       10 FILLER                    PIC X(3)   VALUE SPACES.      05930099
059400                                                                  05940099
059500 01 DE-DATE-EDIT-AREA.                                            05950099
059600    05 DE-EDIT-DATE.                                              05960099
059700       10 DE-EDIT-MONTH             PIC 9(2)   VALUE ZERO.        05970099
059800       10 DE-EDIT-DAY               PIC 9(2)   VALUE ZERO.        05980099
059900       10 DE-EDIT-YEAR              PIC 9(2)   VALUE ZERO.        05990099
060000                                                                  06000099
060100 01 CA-COMMON-AREA.                                               06010099
060200    05 CA-COMMON-DATA.                                            06020099
060300       10 CA-TRANSACTION-STATUS     PIC X(1)   VALUE SPACES.      06030099
060400          88 CA-INITIALIZE-SCREEN              VALUE 'S'.         06040099
060500          88 CA-PROCESS-SCREEN                 VALUE 'R'.         06050099
060600       10 CA-LAST-PROGRAM-NAME                                    06060099
060700                                    PIC X(8)   VALUE SPACES.      06070099
060800       10 CA-LAST-ACTION-STATUS     PIC X(1)   VALUE SPACES.      06080099
060900          88 CA-RESET-LAST-ACTION-STATUS       VALUE ' '.         06090099
061000          88 CA-LAST-ACTION-SUCCESSFUL         VALUE 'S'.         06100099
061100          88 CA-LAST-ACTION-ABORTED            VALUE 'A'.         06110099
061200       10 CA-SELECTION-X            PIC X(2).                     06120099
061300          88 CA-VALID-SELECTION                VALUE '01', '02'.  06130099
061400       10 CA-SELECTION REDEFINES                                  06140099
061500          CA-SELECTION-X            PIC 9(2).                     06150099
061600       10 CA-ACTION                 PIC X(1)   VALUE SPACES.      06160099
061700       10 CA-ACCOUNT-NUMBER-X       PIC X(10)  VALUE SPACES.      06170099
061800       10 CA-ACCOUNT-NUMBER REDEFINES                             06180099
061900          CA-ACCOUNT-NUMBER-X       PIC 9(10).                    06190099
062000       10 CA-DEPARTMENT-X           PIC X(3)   VALUE SPACES.      06200099
062100       10 CA-DEPARTMENT REDEFINES                                 06210099
062200          CA-DEPARTMENT-X           PIC 9(3).                     06220099
062300       10 CA-ACCT-ACCESS      PIC X(1)     VALUE SPACES.          06230099
062400          88 CA-ACCT-ACCESS-YES            VALUE 'Y'.             06240099
062500          88 CA-ACCT-ACCESS-NO             VALUE 'N'.             06250099
062600       10 CA-SSN-ACCESS       PIC X(1)     VALUE SPACES.          06260099
062700          88 CA-SSN-ACCESS-YES             VALUE 'Y'.             06270099
062800          88 CA-SSN-ACCESS-NO              VALUE 'N'.             06280099
062900       10 CA-TOKEN-ACCT-IND   PIC X(1)     VALUE SPACES.          06290099
063000          88 CA-TOKEN-ACCT-YES             VALUE 'Y'.             06300099
063100          88 CA-TOKEN-ACCT-NO              VALUE 'N'.             06310099
063200    05 CA-PROGRAM-DATA.                                           06320099
063300       10 CA-SOCIAL-SECURITY-NUMBER-X.                            06330099
063400          15 CA-SOC-SEC-NUMBER-1-3  PIC X(3)   VALUE SPACES.      06340099
063500          15 CA-SOC-SEC-NUMBER-4-5  PIC X(2)   VALUE SPACES.      06350099
063600          15 CA-SOC-SEC-NUMBER-6-9  PIC X(4)   VALUE SPACES.      06360099
063700       10 CA-SOCIAL-SECURITY-NUMBER REDEFINES                     06370099
063800          CA-SOCIAL-SECURITY-NUMBER-X PIC 9(9).                   06380099
063900       10 CA-EMPLOYEE-ID              PIC X(11).                  06390099
064000       10 CA-EMPLOYEE-STATUS          PIC X(1) VALUE SPACES.      06400099
064100          88  CA-VALID-EMPLOYEE-STATUS         VALUE 'A', 'T'.    06410099
064200          88  CA-ACTIVE-EMPLOYEE-STATUS        VALUE 'A'.         06420099
064300          88  CA-TERMED-EMPLOYEE-STATUS        VALUE 'T'.         06430099
064400       10 CA-CRS-EMPLOYEE-CODE      PIC X(1)   VALUE SPACES.      06440099
064500          88  CA-VALID-EMPLOYEE-CODE           VALUE '5', '6',    06450099
064600                                                     '7', '8'.    06460099
064700       10 CA-DISCOUNT-STATUS        PIC X(1)   VALUE SPACES.      06470099
064800          88  CA-VALID-DISCOUNT-STATUS         VALUE 'L', 'R',    06480099
064900                                                     'N'.         06490099
065000          88  CA-LIFETIME-DISCOUNT             VALUE 'L'.         06500099
065100          88  CA-REGULAR-DISCOUNT              VALUE 'R'.         06510099
065200          88  CA-NO-DISCOUNT                   VALUE 'N'.         06520099
065300       10 CA-EMPLOYEE-NAME          PIC X(50)  VALUE SPACES.      06530099
065400       10 CA-CONFIRM-FRST-NAME      PIC X(19)  VALUE SPACES.      06540099
065500       10 CA-CONFIRM-MI-NAME        PIC X(1)   VALUE SPACES.      06550099
065600       10 CA-CONFIRM-LAST-NAME      PIC X(30)  VALUE SPACES.      06560099
065700       10 CA-STORE-NUMBER-X         PIC X(4)   VALUE SPACES.      06570099
065800       10 CA-STORE-NUMBER REDEFINES                               06580099
065900          CA-STORE-NUMBER-X         PIC 9(4).                     06590099
066000      10 CA-ACCOUNT-NOTES-1         PIC X(40)  VALUE SPACES.      06600099
066100      10 CA-ACCOUNT-NOTES-2         PIC X(40)  VALUE SPACES.      06610099
066200      10 CA-DATE-DISCOUNT-EFFECT-GRP.                             06620099
066300         15 CA-DATE-DISC-EFF-MM     PIC X(2)   VALUE SPACES.      06630099
066400         15 CA-DATE-DISC-EFF-DD     PIC X(2)   VALUE SPACES.      06640099
066500         15 CA-DATE-DISC-EFF-CCYY.                                06650099
066600            20 CA-DATE-DISC-EFF-CC  PIC X(2)   VALUE SPACES.      06660099
066700            20 CA-DATE-DISC-EFF-YY  PIC X(2)   VALUE SPACES.      06670099
066800      10 CA-DATE-TERMINATION-EFFECT-GRP.                          06680099
066900         15 CA-DATE-TERM-EFF-MM     PIC X(2)   VALUE SPACES.      06690099
067000         15 CA-DATE-TERM-EFF-DD     PIC X(2)   VALUE SPACES.      06700099
067100         15 CA-DATE-TERM-EFF-CCYY.                                06710099
067200            20 CA-DATE-TERM-EFF-CC  PIC X(2)   VALUE SPACES.      06720099
067300            20 CA-DATE-TERM-EFF-YY  PIC X(2)   VALUE SPACES.      06730099
067400      10 CA-CONFIRM-FLAG-ADD        PIC X(1)   VALUE 'N'.         06740099
067500         88 CA-UNCONFIRMED-ADD                 VALUE 'N'.         06750099
067600         88 CA-CONFIRMED-ADD                   VALUE 'Y'.         06760099
067700      10 CA-CONFIRM-FLAG-UPD        PIC X(1)   VALUE 'N'.         06770099
067800         88 CA-UNCONFIRMED-UPD                 VALUE 'N'.         06780099
067900         88 CA-CONFIRMED-UPD                   VALUE 'Y'.         06790099
068000      10 CA-CONFIRM-FLAG-DEL        PIC X(1)   VALUE 'N'.         06800099
068100         88 CA-UNCONFIRMED-DEL                 VALUE 'N'.         06810099
068200         88 CA-CONFIRMED-DEL                   VALUE 'Y'.         06820099
068300      10 CA-EMPLOYEE-FLAG           PIC X(1)   VALUE SPACES.      06830099
068400         88 CA-EMPLOYEE                        VALUE 'Y'.         06840099
068500         88 CA-NON-EMPLOYEE                    VALUE 'N'.         06850099
068600      10 CA-SCREEN-FLAG             PIC X(1)   VALUE 'M'.         06860099
068700         88 CA-MAIN-SCREEN                     VALUE 'M'.         06870099
068800         88 CA-SEARCH-SCREEN                   VALUE 'S'.         06880099
068900      10 CA-SCROLL-UP-FLAG          PIC X(1)   VALUE 'D'.         06890099
069000         88 CA-ENABLE-UP                       VALUE 'E'.         06900099
069100         88 CA-DISABLE-UP                      VALUE 'D'.         06910099
069200      10 CA-SCROLL-DOWN-FLAG        PIC X(1)   VALUE 'D'.         06920099
069300         88 CA-ENABLE-DOWN                     VALUE 'E'.         06930099
069400         88 CA-DISABLE-DOWN                    VALUE 'D'.         06940099
069500      10 CA-UNPROTECT-NAME-SW       PIC X(1)   VALUE SPACES.      06950099
069600         88 CA-PROTECT-NAME                    VALUE SPACES.      06960099
069700         88 CA-UNPROTECT-NAME                  VALUE 'Y'.         06970099
069800      10 CA-FETCH-COUNTER           PIC S9(4)  VALUE ZEROES COMP. 06980099
069900      10 CA-READNEXT-COUNTER        PIC S9(4)  VALUE ZEROES COMP. 06990099
070000      10 CA-SEARCH-TEXT             PIC X(50)  VALUE SPACES.      07000099
070100      10 CA-SEARCH-SELECTION        PIC X(1)   VALUE SPACES       07010099
070200                                               OCCURS 14 TIMES.   07020099
070300      10 CA-PROTECT-DISC-FLAG       PIC X(1)   VALUE SPACES.      07030099
070400         88 CA-PROTECT-DISC-FLD                VALUE 'Y'.         07040099
070500      10 CA-NAME-EDIT-FLAG          PIC X(1)   VALUE SPACES.      07050099
070600         88 CA-NAME-EDITED                     VALUE 'Y'.         07060099
070700                                                                  07070099
070800 01 PM-PROGRAM-MESSAGE-DATA.                                      07080099
070900*1                                                                07090099
071000    05 FILLER                       PIC X(70)  VALUE              07100099
071100       '                                                     '.   07110099
071200*2                                                                07120099
071300    05 FILLER                       PIC X(70)  VALUE              07130099
071400       'UNKNOWN PF KEY ENTERED                               '.   07140099
071500*3                                                                07150099
071600    05 FILLER                       PIC X(70)  VALUE              07160099
071700       'EMPLOYEE STATUS MUST BE A(CTIVE) OR T(ERMINATED)     '.   07170099
071800*4                                                                07180099
071900    05 FILLER                       PIC X(53)  VALUE              07190099
072000       'EMPLOYEE NAME MUST BE ENTERED IN THIS FORMAT: FIRST M'.   07200099
072100    05 FILLER                       PIC X(17)  VALUE              07210099
072200       'I LAST           '.                                       07220099
072300*5                                                                07230099
072400    05 FILLER                       PIC X(70)  VALUE              07240099
072500       'CRS EMPLOYEE CODE MUST BE A 5, 6, 7, OR 8            '.   07250099
072600*6                                                                07260099
072700    05 FILLER                       PIC X(70)  VALUE              07270099
072800       'SOCIAL SECURITY NUMBER IS REQUIRED                   '.   07280099
072900*7                                                                07290099
073000    05 FILLER                       PIC X(70)  VALUE              07300099
073100       'SOCIAL SECURITY NUMBER MUST BE NUMERIC               '.   07310099
073200*8                                                                07320099
073300    05 FILLER                       PIC X(70)  VALUE              07330099
073400       'STORE NUMBER MUST BE NUMERIC                         '.   07340099
073500*9                                                                07350099
073600    05 FILLER                       PIC X(70)  VALUE              07360099
073700       'STORE NUMBER IS NOT A VALID KOHLS STORE NUMBER       '.   07370099
073800*10                                                               07380099
073900    05 FILLER                       PIC X(70)  VALUE              07390099
074000       'DATE DISCOUNT EFFECTIVE MUST BE NUMERIC              '.   07400099
074100*11                                                               07410099
074200    05 FILLER                       PIC X(70)  VALUE              07420099
074300       'DATE DISCOUNT EFFECTIVE MUST BE A VALID DATE         '.   07430099
074400*12                                                               07440099
074500    05 FILLER                       PIC X(53)  VALUE              07450099
074600       'DATE TERMINATION FROM DISCOUNT EFFECTIVE MUST BE NUME'.   07460099
074700    05 FILLER                       PIC X(17)  VALUE              07470099
074800       'RIC             '.                                        07480099
074900*13                                                               07490099
075000    05 FILLER                       PIC X(53)  VALUE              07500099
075100       'DATE TERMINATION FROM DISCOUNT EFFECTIVE MUST BE A VA'.   07510099
075200    05 FILLER                       PIC X(17)  VALUE              07520099
075300       'LID DATE         '.                                       07530099
075400*14                                                               07540099
075500    05 FILLER                       PIC X(53)  VALUE              07550099
075600       'DATE TERM FROM DISC EFFECTIVE NOT VALID FOR AN ACTIVE'.   07560099
075700    05 FILLER                       PIC X(17)  VALUE              07570099
075800       ' DISCOUNT STATUS '.                                       07580099
075900*15                                                               07590099
076000    05 FILLER                       PIC X(53)  VALUE              07600099
076100       'DATE TERM FROM DISC EFFECTIVE REQUIRED FOR A TERMED D'.   07610099
076200    05 FILLER                       PIC X(17)  VALUE              07620099
076300       'ISCOUNT STATUS   '.                                       07630099
076400*16                                                               07640099
076500    05 FILLER                       PIC X(70)  VALUE              07650099
076600       'MUST READ BEFORE UPDATE OR DELETE                    '.   07660099
076700*17                                                               07670099
076800    05 FILLER                       PIC X(70)  VALUE              07680099
076900       'ACCOUNT NUMBER MUST BE NUMERIC                       '.   07690099
077000*18                                                               07700099
077100    05 FILLER                       PIC X(70)  VALUE              07710099
077200       'RECORD ALREADY EXISTS                                '.   07720099
077300*19                                                               07730099
077400    05 FILLER                       PIC X(70)  VALUE              07740099
077500       'RECORD READ OK                                       '.   07750099
077600*20                                                               07760099
077700    05 FILLER                       PIC X(70)  VALUE              07770099
077800       'RECORD NOT FOUND                                     '.   07780099
077900*21                                                               07790099
078000    05 FILLER                       PIC X(70)  VALUE              07800099
078100       'RECORD UPDATED OK                                    '.   07810099
078200*22                                                               07820099
078300    05 FILLER                       PIC X(70)  VALUE              07830099
078400       'RECORD DELETED OK                                    '.   07840099
078500*23                                                               07850099
078600    05 FILLER                       PIC X(70)  VALUE              07860099
078700       'RECORD ADDED OK                                      '.   07870099
078800*24                                                               07880099
078900    05 FILLER                       PIC X(70)  VALUE              07890099
079000       'ACCOUNT NUMBER DOES NOT HAVE A VALID CHECK DIGIT     '.   07900099
079100*25                                                               07910099
079200    05 FILLER                       PIC X(70)  VALUE              07920099
079300       'ACCOUNT NUMBER IS REQUIRED                           '.   07930099
079400*26                                                               07940099
079500    05 FILLER                       PIC X(70)  VALUE              07950099
079600       'PRESS PF4 AGAIN TO CONFIRM ADD OR PF3 TO CANCEL      '.   07960099
079700*27                                                               07970099
079800    05 FILLER                       PIC X(70)  VALUE              07980099
079900       'ACCOUNT NUMBER MUST BE GREATER THAN ZERO             '.   07990099
080000*28                                                               08000099
080100    05 FILLER                       PIC X(70)  VALUE              08010099
080200       'STORE NUMBER IS REQUIRED                             '.   08020099
080300*29                                                               08030099
080400    05 FILLER                       PIC X(70)  VALUE              08040099
080500       'PRESS PF6 AGAIN TO CONFIRM UPDATE OR PF3 TO CANCEL   '.   08050099
080600*30                                                               08060099
080700    05 FILLER                       PIC X(70)  VALUE              08070099
080710       'PRESS PF8 AGAIN TO CONFIRM DELETE OR PF3 TO CANCEL   '.   08071099
080720*31                                                               08072099
080730    05 FILLER                       PIC X(70)  VALUE              08073099
080740        'ACTION CANCELLED                                     '.  08074099
080750*32                                                               08075099
080760    05 FILLER                       PIC X(70)  VALUE              08076099
080770       'SOCIAL SECURITY NUMBER MUST BE GREATER THAN ZERO     '.   08077099
080780*33                                                               08078099
080790    05 FILLER                       PIC X(70)  VALUE              08079099
080800       'ACCOUNT NUMBER ALREADY EXISTS FOR AN EMPLOYEE        '.   08080099
080810*34                                                               08081099
080820    05 FILLER                       PIC X(70)  VALUE              08082099
080830       'SSN ALREADY EXISTS - MUST READ BEFORE ADD            '.   08083099
080840*35                                                               08084099
080850    05 FILLER                       PIC X(70)  VALUE              08085099
080860       'ACCOUNT NUMBER ALREADY EXISTS FOR A NON-EMPLOYEE     '.   08086099
080870*36                                                               08087099
080880    05 FILLER                       PIC X(53)  VALUE              08088099
080890       'RECORD NOT FOUND ON PS VIEW OR NON-EMP DISC TABLE. CO'.   08089099
080900    05 FILLER                       PIC X(17)  VALUE              08090099
080910       'NTACT APPLICTIONS'.                                       08091099
080920*37                                                               08092099
080930    05 FILLER                       PIC X(70)  VALUE              08093099
080940       'NO MORE SEARCH RESULTS TO DISPLAY                    '.   08094099
080950*38                                                               08095099
080960    05 FILLER                       PIC X(70)  VALUE              08096099
080970       'PF KEY IS CURRENTLY INACTIVE                         '.   08097099
080980*39                                                               08098099
080990    05 FILLER                       PIC X(70)  VALUE              08099099
081000       'ONLY ONE SELECTION IS ALLOWED                        '.   08100099
081010*40                                                               08101099
081020    05 FILLER                       PIC X(70)  VALUE              08102099
081030       'ENTER A SELECTION OR PRESS PF3 TO CANCEL SEARCH      '.   08103099
081040*41                                                               08104099
081050    05 FILLER                       PIC X(70)  VALUE              08105099
081060       'SEARCH PRODUCED NO RESULTS.                          '.   08106099
081070*42                                                               08107099
081080    05 FILLER                       PIC X(70)  VALUE              08108099
081090       'MUST ADD BEFORE UPDATE OR DELETE                     '.   08109099
081100*43                                                               08110099
081110    05 FILLER                       PIC X(70)  VALUE              08111099
081120       'YOU MUST ENTER AT LEAST ONE CHARACTER                '.   08112099
081130*44                                                               08113099
081140    05 FILLER                       PIC X(70)  VALUE              08114099
081150       'EMPLOYEE FIRST NAME IS REQUIRED                      '.   08115099
081160*45                                                               08116099
081170    05 FILLER                       PIC X(70)  VALUE              08117099
081180       'EMPLOYEE LAST NAME IS REQUIRED                       '.   08118099
081190*46                                                               08119099
081200    05 FILLER                       PIC X(70)  VALUE              08120099
081210       'YOU MUST ENTER A VALID KOHLS STORE NUMBER            '.   08121099
081220*47                                                               08122099
081230    05 FILLER                       PIC X(16)  VALUE              08123099
081240       'SEARCH RETURNED '.                                        08124099
081250    05 PM-ROWS-RETURNED             PIC Z,ZZ9 VALUE ZEROES.       08125099
081260    05 FILLER                       PIC X(49)  VALUE              08126099
081270       ' ROWS                                            '.       08127099
081280*48                                                               08128099
081290    05 FILLER                       PIC X(70)  VALUE              08129099
081300       'INVALID SELECTION CHARACTER ENTERED                  '.   08130099
081310*49                                                               08131099
081320    05 FILLER                       PIC X(53)  VALUE              08132099
081330       'DISCOUNT STATUS MUST BE (L)IFETIME, (R)EGULAR OR (N)O'.   08133099
081340    05 FILLER                       PIC X(17)  VALUE              08134099
081350       'DISCOUNT         '.                                       08135099
081360*50                                                               08136099
081370    05 FILLER                       PIC X(70)  VALUE              08137099
081380       'ACCOUNT NUMBER MUST HAVE A VALID TWO-DIGIT PREFIX    '.   08138099
081390*51                                                               08139099
081400    05 FILLER                       PIC X(53)  VALUE              08140099
081410       'PEOPLESOFT RECORD NOT FOUND FOR EMPLOYEE ACCOUNT. CON'.   08141099
081420    05 FILLER                       PIC X(17)  VALUE              08142099
081430       'TACT APPLICATIONS'.                                       08143099
081440*52                                                               08144099
081450    05 FILLER                       PIC X(53)  VALUE              08145099
081460       'DISCOUNT STATUS CANNOT BE CHANGED TO (N)O DISCOUNT FO'.   08146099
081470    05 FILLER                       PIC X(17)  VALUE              08147099
081480       'R NON-EMPLOYEE   '.                                       08148099
081490*53                                                               08149099
081500    05 FILLER                       PIC X(70)  VALUE              08150099
081510       'ONLY TWO ACCOUNTS ARE ALLOWED ON DISCOUNT PER PERSON '.   08151099
081520*54                                                               08152099
081530    05 FILLER                       PIC X(70)  VALUE              08153099
081540       'DATE DISCOUNT EFFECTIVE YEAR MUST BE GREATER THAN 1964'.  08154099
081550*55                                                               08155099
081560    05 FILLER                       PIC X(70)  VALUE              08156099
081570       'TERMINATION DATE MUST BE GREATER THAN DISCOUNT DATE  '.   08157099
081580 01 PM-PROGRAM-MESSAGE-TABLE REDEFINES PM-PROGRAM-MESSAGE-DATA.   08158099
081590    05 PM-PROGRAM-MESSAGE           PIC X(70)  OCCURS 55 TIMES    08159099
081600                                               INDEXED BY         08160099
081610                                               PM-MESSAGE-INDEX.  08161099
081620                                                                  08162099
081630 01 AD-ADD-DELETE-MESSAGE-LOG-AREA.                               08163099
081640    05 AD-MESSAGE-01.                                             08164099
081650       10 FILLER                    PIC X(2)   VALUE '01'.        08165099
081660       10 FILLER                    PIC X(17)  VALUE              08166099
081670          'DISCOUNT STATUS=('.                                    08167099
081680       10 AD-EMPLOYEE-DISC-STATUS   PIC X(1)   VALUE SPACES.      08168099
081690       10 FILLER                    PIC X(23)  VALUE              08169099
081700          ')   CRS EMPLOYEE CODE=('.                              08170099
081710       10 AD-CRS-EMPLOYEE-CODE      PIC X(1)   VALUE SPACES.      08171099
081720       10 FILLER                    PIC X(19)  VALUE              08172099
081730          ')   EMPLOYEE NAME=('.                                  08173099
081740       10 AD-EMPLOYEE-NAME          PIC X(30)  VALUE SPACES.      08174099
081750       10 FILLER                    PIC X(1)   VALUE              08175099
081760          ')'.                                                    08176099
081770    05 AD-MESSAGE-02.                                             08177099
081780       10 FILLER                    PIC X(2)   VALUE '02'.        08178099
081790       10 FILLER                    PIC X(18)  VALUE              08179099
081800          'SOC. SEC. NUMBER=('.                                   08180099
081810       10 AD-SOC-SEC-NUMBER-1-3     PIC X(3)   VALUE SPACES.      08181099
081820       10 FILLER                    PIC X(1)   VALUE '-'.         08182099
081830       10 AD-SOC-SEC-NUMBER-4-5     PIC X(2)   VALUE SPACES.      08183099
081840       10 FILLER                    PIC X(1)   VALUE '-'.         08184099
081850       10 AD-SOC-SEC-NUMBER-6-9     PIC X(4)   VALUE SPACES.      08185099
081860       10 FILLER                    PIC X(18)  VALUE              08186099
081870          ')   STORE NUMBER=('.                                   08187099
081880       10 AD-STORE-NUMBER           PIC 9(4)   VALUE ZEROES.      08188099
081890       10 FILLER                    PIC X(1)   VALUE              08189099
081900          ')'.                                                    08190099
081910    05 AD-MESSAGE-03.                                             08191099
081920       10 FILLER                    PIC X(2)   VALUE '03'.        08192099
081930       10 FILLER                    PIC X(18)  VALUE              08193099
081940          ')   DISCOUNT EFF=('.                                   08194099
081950       10 AD-DATE-DISCOUNT-EFFECTIVE.                             08195099
081960          15 AD-DATE-DISC-EFF-MM    PIC X(2)   VALUE SPACES.      08196099
081970          15 FILLER                 PIC X(1)   VALUE "/".         08197099
081980          15 AD-DATE-DISC-EFF-DD    PIC X(2)   VALUE SPACES.      08198099
081990          15 FILLER                 PIC X(1)   VALUE "/".         08199099
082000          15 AD-DATE-DISC-EFF-YY    PIC X(2)   VALUE SPACES.      08200099
082010       10 FILLER                    PIC X(14)  VALUE              08201099
082020             ')   TERM EFF=('.                                    08202099
082030       10 AD-DATE-TERMINATION-EFFECT.                             08203099
082040          15 AD-DATE-TERM-EFF-MM    PIC X(2)   VALUE SPACES.      08204099
082050          15 FILLER                 PIC X(1)   VALUE "/".         08205099
082060          15 AD-DATE-TERM-EFF-DD    PIC X(2)   VALUE SPACES.      08206099
082070          15 FILLER                 PIC X(1)   VALUE "/".         08207099
082080          15 AD-DATE-TERM-EFF-YY    PIC X(2)   VALUE SPACES.      08208099
082090       10 FILLER                    PIC X(1)   VALUE              08209099
082100          ')'.                                                    08210099
082110    05 AD-MESSAGE-04.                                             08211099
082120       10 FILLER                    PIC X(2)   VALUE '04'.        08212099
082130       10 FILLER                    PIC X(15)  VALUE              08213099
082140          'ACCOUNT NOTES=('.                                      08214099
082150       10 AD-ACCOUNT-NOTES-1        PIC X(40)  VALUE SPACES.      08215099
082160       10 FILLER                    PIC X(1)   VALUE SPACES.      08216099
082170       10 AD-ACCOUNT-NOTES-2        PIC X(40)  VALUE SPACES.      08217099
082180       10 FILLER                    PIC X(1)   VALUE              08218099
082190          ')'.                                                    08219099
082200                                                                  08220099
082210 01 CM-CHANGE-MESSAGE-LOG-AREA.                                   08221099
082220    05 CM-MESSAGE-01.                                             08222099
082230       10 FILLER                    PIC X(2)   VALUE '01'.        08223099
082240       10 FILLER                    PIC X(23)  VALUE              08224099
082250          'EMPLOYEE STATUS:  OLD=('.                              08225099
082260       10 CM-OLD-EMPLOYEE-STATUS                                  08226099
082270                                    PIC X(1)   VALUE SPACES.      08227099
082280       10 FILLER                    PIC X(9)   VALUE              08228099
082290          ')   NEW=('.                                            08229099
082300       10 CM-NEW-EMPLOYEE-STATUS                                  08230099
082310                                    PIC X(1)   VALUE SPACES.      08231099
082320       10 FILLER                    PIC X(1)   VALUE              08232099
082330          ')'.                                                    08233099
082340    05 CM-MESSAGE-02.                                             08234099
082350       10 FILLER                    PIC X(2)   VALUE '02'.        08235099
082360       10 FILLER                    PIC X(25)  VALUE              08236099
082370          'CRS EMPLOYEE CODE:  OLD=('.                            08237099
082380       10 CM-OLD-CRS-EMPLOYEE-CODE  PIC X(1)   VALUE SPACES.      08238099
082390       10 FILLER                    PIC X(9)   VALUE              08239099
082400          ')   NEW=('.                                            08240099
082410       10 CM-NEW-CRS-EMPLOYEE-CODE                                08241099
082420                                    PIC X(1)   VALUE SPACES.      08242099
082430       10 FILLER                    PIC X(1)   VALUE              08243099
082440          ')'.                                                    08244099
082450                                                                  08245099
082460    05 CM-MESSAGE-03.                                             08246099
082470       10 FILLER                    PIC X(2)   VALUE '03'.        08247099
082480       10 FILLER                    PIC X(21)  VALUE              08248099
082490          'EMPLOYEE NAME:  OLD=('.                                08249099
082500       10 CM-OLD-EMPLOYEE-NAME                                    08250099
082510                                    PIC X(30)  VALUE SPACES.      08251099
082520       10 FILLER                    PIC X(9)   VALUE              08252099
082530          ')   NEW=('.                                            08253099
082540       10 CM-NEW-EMPLOYEE-NAME      PIC X(30)  VALUE SPACES.      08254099
082550       10 FILLER                    PIC X(1)   VALUE              08255099
082560          ')'.                                                    08256099
082570    05 CM-MESSAGE-04.                                             08257099
082580       10 FILLER                    PIC X(2)   VALUE '04'.        08258099
082590       10 FILLER                    PIC X(22)  VALUE              08259099
082600          'ACCOUNT NUMBER:  OLD=('.                               08260099
082610       10 CM-OLD-ACCOUNT-NUMBER     PIC X(10)  VALUE SPACES.      08261099
082620       10 FILLER                    PIC X(9)   VALUE              08262099
082630          ')   NEW=('.                                            08263099
082640       10 CM-NEW-ACCOUNT-NUMBER     PIC X(10)  VALUE SPACES.      08264099
082650       10 FILLER                    PIC X(1)   VALUE              08265099
082660          ')'.                                                    08266099
082670    05 CM-MESSAGE-05.                                             08267099
082680       10 FILLER                    PIC X(2)   VALUE '05'.        08268099
082690       10 FILLER                    PIC X(20)  VALUE              08269099
082700          'STORE NUMBER:  OLD=('.                                 08270099
082710       10 CM-OLD-STORE-NUMBER       PIC 9(4)   VALUE ZEROES.      08271099
082720       10 FILLER                    PIC X(9)   VALUE              08272099
082730          ')   NEW=('.                                            08273099
082740       10 CM-NEW-STORE-NUMBER       PIC 9(4)   VALUE ZEROES.      08274099
082750       10 FILLER                    PIC X(1)   VALUE              08275099
082760          ')'.                                                    08276099
082770    05 CM-MESSAGE-10.                                             08277099
082780       10 FILLER                    PIC X(2)   VALUE '10'.        08278099
082790       10 FILLER                    PIC X(31)  VALUE              08279099
082800          'DATE DISCOUNT EFFECTIVE:  OLD=('.                      08280099
082810       10 CM-OLD-DISCOUNT-EFFECTIVE.                              08281099
082820          15 CM-OLD-DISC-EFF-MM     PIC X(2)   VALUE SPACES.      08282099
082830          15 FILLER                 PIC X(1)   VALUE "/".         08283099
082840          15 CM-OLD-DISC-EFF-DD     PIC X(2)   VALUE SPACES.      08284099
082850          15 FILLER                 PIC X(1)   VALUE "/".         08285099
082860          15 CM-OLD-DISC-EFF-YY     PIC X(2)   VALUE SPACES.      08286099
082870       10 FILLER                    PIC X(9)   VALUE              08287099
082880          ')   NEW=('.                                            08288099
082890       10 CM-NEW-DISCOUNT-EFFECTIVE.                              08289099
082900          15 CM-NEW-DISC-EFF-MM     PIC X(2)   VALUE SPACES.      08290099
082910          15 FILLER                 PIC X(1)   VALUE "/".         08291099
082920          15 CM-NEW-DISC-EFF-DD     PIC X(2)   VALUE SPACES.      08292099
082930          15 FILLER                 PIC X(1)   VALUE "/".         08293099
082940          15 CM-NEW-DISC-EFF-YY     PIC X(2)   VALUE SPACES.      08294099
082950       10 FILLER                    PIC X(1)   VALUE              08295099
082960          ')'.                                                    08296099
082970    05 CM-MESSAGE-11.                                             08297099
082980       10 FILLER                    PIC X(2)   VALUE '11'.        08298099
082990       10 FILLER                    PIC X(34)  VALUE              08299099
083000          'DATE TERMINATION EFFECTIVE:  OLD=('.                   08300099
083010       10 CM-OLD-TERMINATION-EFFECT.                              08301099
083020          15 CM-OLD-TERM-EFF-MM     PIC X(2)   VALUE SPACES.      08302099
083030          15 FILLER                 PIC X(1)   VALUE "/".         08303099
083040          15 CM-OLD-TERM-EFF-DD     PIC X(2)   VALUE SPACES.      08304099
083050          15 FILLER                 PIC X(1)   VALUE "/".         08305099
083060          15 CM-OLD-TERM-EFF-YY     PIC X(2)   VALUE SPACES.      08306099
083070       10 FILLER                    PIC X(9)   VALUE              08307099
083080          ')   NEW=('.                                            08308099
083090       10 CM-NEW-TERMINATION-EFFECT.                              08309099
083100          15 CM-NEW-TERM-EFF-MM     PIC X(2)   VALUE SPACES.      08310099
083110          15 FILLER                 PIC X(1)   VALUE "/".         08311099
083120          15 CM-NEW-TERM-EFF-DD     PIC X(2)   VALUE SPACES.      08312099
083130          15 FILLER                 PIC X(1)   VALUE "/".         08313099
083140          15 CM-NEW-TERM-EFF-YY     PIC X(2)   VALUE SPACES.      08314099
083150       10 FILLER                    PIC X(1)   VALUE              08315099
083160            ')'.                                                  08316099
083170    05 CM-MESSAGE-12.                                             08317099
083180       10 FILLER                    PIC X(2)   VALUE '12'.        08318099
083190       10 FILLER                    PIC X(18)  VALUE              08319099
083200          'ACCT NOTES:  OLD=('.                                   08320099
083210       10 CM-OLD-ACCOUNT-NOTES-1    PIC X(40)  VALUE SPACES.      08321099
083220       10 FILLER                    PIC X(1)   VALUE SPACES.      08322099
083230       10 CM-OLD-ACCOUNT-NOTES-2    PIC X(40)  VALUE SPACES.      08323099
083240       10 FILLER                    PIC X(1)   VALUE              08324099
083250          ')'.                                                    08325099
083260    05 CM-MESSAGE-13.                                             08326099
083270       10 FILLER                    PIC X(2)   VALUE '13'.        08327099
083280       10 FILLER                    PIC X(18)  VALUE              08328099
083290          '             NEW=('.                                   08329099
083300       10 CM-NEW-ACCOUNT-NOTES-1    PIC X(40)  VALUE SPACES.      08330099
083310       10 FILLER                    PIC X(1)   VALUE SPACES.      08331099
083320       10 CM-NEW-ACCOUNT-NOTES-2    PIC X(40)  VALUE SPACES.      08332099
083330       10 FILLER                    PIC X(1)   VALUE              08333099
083340          ')'.                                                    08334099
083350                                                                  08335099
083360 01 FD-FILE-DDNAME-AREA.                                          08336099
083370    05 FD-MAINTENANCE-LOG-FILE     PIC X(8)    VALUE 'AREDSLOG'.  08337099
083380                                                                  08338099
083390*  SQL AND COBOL DECLARATIONS FOR THE STORE TABLE (XST_LOC)       08339099
083400                                                                  08340099
083410     EXEC SQL                                                     08341099
083420         INCLUDE XST00001                                         08342099
083430     END-EXEC.                                                    08343099
083440                                                                  08344099
083520*  SQL AND COBOL DECLARATIONS FOR THE EMPLOYEE ACCOUNT TABLE      08352099
083530                                                                  08353099
083540     EXEC SQL                                                     08354099
083550         INCLUDE ART00001                                         08355099
083560     END-EXEC.                                                    08356099
083570                                                                  08357099
083580                                                                  08358099
083590*  SQL AND COBOL DECLARATIONS FOR THE EMPLOYEE GLOBAL TEMP TABLE  08359099
083600                                                                  08360099
083610     EXEC SQL                                                     08361099
083620         INCLUDE ART00002                                         08362099
083630     END-EXEC.                                                    08363099
083640                                                                  08364099
083650                                                                  08365099
083660 01 INDICATOR-VARIABLES.                                          08366099
083670    05 IND-ART00001-TERM-DTE        PIC S9(4)  VALUE ZEROES COMP. 08367099
083680    05 IND-ART00001-DISC-DTE        PIC S9(4)  VALUE ZEROES COMP. 08368099
083710    05 IND-ART00001-CMNT-TXT        PIC S9(4)  VALUE ZEROES COMP. 08371099
083720    05 IND-EU-TERM-DTE              PIC S9(04) VALUE ZEROES COMP. 08372099
083730    05 IND-EU-CMNT-TXT              PIC S9(04) VALUE ZEROES COMP. 08373099
083740                                                                  08374099
083750 01 HOST-VARIABLES.                                               08375099
083760    05 PV-EMP-NM-ROW-STRING         PIC X(88)  VALUE SPACES.      08376099
083770    05 PV-EMP-SSN-ROW-STRING        PIC X(10)  VALUE SPACES.      08377099
083780    05 PV-EMP-STAT-CDE-1            PIC X(1)   VALUE SPACES.      08378099
083790    05 PV-EMP-STAT-CDE-2            PIC X(1)   VALUE SPACES.      08379099
083800    05 PV-EMP-STAT-CDE-3            PIC X(1)   VALUE SPACES.      08380099
083810    05 PV-EMP-STAT-CDE-4            PIC X(1)   VALUE SPACES.      08381099
083820    05 PV-EMP-STAT-CDE-5            PIC X(1)   VALUE SPACES.      08382099
083830    05 PV-EMP-STAT-CDE-6            PIC X(1)   VALUE SPACES.      08383099
083840    05 PV-STORE-NUMBER-9            PIC S9(4)  VALUE ZEROES COMP. 08384099
083850    05 PV-STORE-NBR.                                              08385099
083860       10 FILLER                    PIC 9(06)  VALUE ZEROS.       08386099
083870       10 PV-STORE-NBR-4            PIC 9(04)  VALUE ZEROS.       08387099
083880                                                                  08388099
083890*-----------------------------------------------------------      08389099
083900* CURSORS USED IN READS                                           08390099
083910*-----------------------------------------------------------      08391099
083920*EMP_ID CURSOR DECLARE                                            08392099
083930     EXEC SQL                                                     08393099
083940         DECLARE EMP_ID CURSOR FOR                                08394099
083950            SELECT                                                08395099
083960                ACCT_NBR                                          08396099
083970               ,DISC_STAT_CDE                                     08397099
083980               ,CMNT_TXT                                          08398099
083990               ,EMP_NM                                            08399099
084000               ,SSN_NBR                                           08400099
084010               ,LOC_NBR                                           08401099
084020               ,EMP_STAT_CDE                                      08402099
084030               ,EMP_TYP_CDE                                       08403099
084040               ,DISC_DTE                                          08404099
084050               ,TERM_DTE                                          08405099
084060            FROM ART_EMP_DISC                                     08406099
084070            WHERE EMP_ID   = :ART00001-EMP-ID                     08407099
084080     END-EXEC.                                                    08408099
084090                                                                  08409099
084260                                                                  08426099
084270*EMP_ACCT CURSOR DECLARE                                          08427099
084280     EXEC SQL                                                     08428099
084290         DECLARE EMP_ACCT CURSOR FOR                              08429099
084300            SELECT                                                08430099
084310                EMP_ID                                            08431099
084320               ,DISC_STAT_CDE                                     08432099
084330               ,CMNT_TXT                                          08433099
084340               ,EMP_NM                                            08434099
084350               ,SSN_NBR                                           08435099
084360               ,LOC_NBR                                           08436099
084370               ,EMP_STAT_CDE                                      08437099
084380               ,EMP_TYP_CDE                                       08438099
084390               ,DISC_DTE                                          08439099
084400               ,TERM_DTE                                          08440099
084410            FROM ART_EMP_DISC                                     08441099
084420            WHERE ACCT_NBR = :PV-ACCT-NBR-TOKEN                   08442099
084430     END-EXEC.                                                    08443099
084440                                                                  08444099
084620*-----------------------------------------------------------      08462099
084630* CURSORS USED IN SEARCHES                                        08463099
084640*-----------------------------------------------------------      08464099
084650*HR_VIEW_NM CURSOR DECLARE                                        08465099
084660     EXEC SQL                                                     08466099
084670         DECLARE HR_VIEW_NM CURSOR FOR                            08467099
084680            SELECT                                                08468099
084690                A.SSN_NBR                                         08469099
084700               ,A.EMP_NM                                          08470099
084710               ,A.LOC_NBR                                         08471099
084720            FROM ART_EMP_DISC A                                   08472099
084730            WHERE  A.EMP_NM LIKE :PV-EMP-NM-ROW-STRING            08473099
084740              AND (A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-1             08474099
084750               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-2             08475099
084760               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-3             08476099
084770               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-4             08477099
084780               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-5             08478099
084790               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-6)            08479099
084800     END-EXEC.                                                    08480099
084810                                                                  08481099
084820*HR_VIEW_STR CURSOR DECLARE                                       08482099
084830     EXEC SQL                                                     08483099
084840         DECLARE HR_VIEW_STR CURSOR FOR                           08484099
084850            SELECT                                                08485099
084860                A.SSN_NBR                                         08486099
084870               ,A.EMP_NM                                          08487099
084880            FROM ART_EMP_DISC A                                   08488099
084890            WHERE  A.LOC_NBR = :ART00001-LOC-NBR                  08489099
084900              AND (A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-1             08490099
085000               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-2             08500099
085010               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-3             08501099
085020               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-4             08502099
085030               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-5             08503099
085040               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-6)            08504099
085050            ORDER BY A.EMP_NM                                     08505099
085060     END-EXEC.                                                    08506099
085070                                                                  08507099
085080*HR_VIEW_SSN CURSOR DECLARE                                       08508099
085090     EXEC SQL                                                     08509099
085100         DECLARE HR_VIEW_SSN CURSOR FOR                           08510099
085110            SELECT                                                08511099
085120                A.SSN_NBR                                         08512099
085130               ,A.EMP_NM                                          08513099
085140               ,A.LOC_NBR                                         08514099
085141            FROM ART_EMP_DISC A                                   08514199
085142            WHERE SSN_NBR = :PV-TOKEN-SS-NBR                      08514299
085143              AND (A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-1             08514399
085144               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-2             08514499
085145               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-3             08514599
085146               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-4             08514699
085147               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-5             08514799
085148               OR  A.EMP_STAT_CDE= :PV-EMP-STAT-CDE-6)            08514899
085149            ORDER BY A.SSN_NBR                                    08514999
085150     END-EXEC.                                                    08515099
085160                                                                  08516099
085170*+++++++++++++++++++++++++++                                      08517099
085180* THIS CURSOR IS NOT USED  +                                      08518099
085190*+++++++++++++++++++++++++++                                      08519099
085200*UNION_NM CURSOR DECLARE                                          08520099
085300*    EXEC SQL                                                     08530099
085400*        DECLARE UNION_NM CURSOR FOR                              08540099
085500*           SELECT                                                08550099
085600*               SSN_NBR                                           08560099
085700*              ,EMP_NM                                            08570099
085710*              ,STR_NBR                                           08571099
085720*           FROM ART_GLBL_TMP_TBL                                 08572099
085730*           WHERE EMP_NM LIKE :PV-EMP-NM-ROW-STRING               08573099
085740*        ORDER BY 2                                               08574099
085750*    END-EXEC.                                                    08575099
085760                                                                  08576099
085770*UNION_STR CURSOR DECLARE                                         08577099
085780     EXEC SQL                                                     08578099
085790         DECLARE UNION_STR CURSOR FOR                             08579099
085800            SELECT                                                08580099
085900                SSN_NBR                                           08590099
085910               ,EMP_NM                                            08591099
085920            FROM ART_GLBL_TMP_TBL                                 08592099
085930            WHERE STR_NBR = :PV-STR-NBR                           08593099
085940         ORDER BY 2                                               08594099
085950     END-EXEC.                                                    08595099
085960                                                                  08596099
085970*UNION_SSN CURSOR DECLARE                                         08597099
085980     EXEC SQL                                                     08598099
085990         DECLARE UNION_SSN CURSOR FOR                             08599099
086000            SELECT                                                08600099
086100                A.SSN_NBR                                         08610099
086110               ,A.EMP_NM                                          08611099
086120               ,A.STR_NBR                                         08612099
086130            FROM ART_GLBL_TMP_TBL A                               08613099
086150            WHERE A.SSN_NBR = :PV-TOKEN-SS-NBR                    08615099
086180         ORDER BY 1                                               08618099
086190     END-EXEC.                                                    08619099
086200                                                                  08620099
086210*                                                                 08621099
086220*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                08622099
086230*                                                                 08623099
086240                                                                  08624099
086250     EXEC SQL                                                     08625099
086260         INCLUDE SQLCA                                            08626099
086270     END-EXEC.                                                    08627099
086280                                                                  08628099
086290******************************************************************08629099
086300 LINKAGE SECTION.                                                 08630099
086310******************************************************************08631099
086320                                                                  08632099
086330 01 DFHCOMMAREA.                                                  08633099
086340    05 LS-COMMON-DATA.                                            08634099
086350       10 LS-TRANSACTION-STATUS     PIC X(1).                     08635099
086360          88 LS-INITIALIZE-SCREEN             VALUE 'S'.          08636099
086370          88 LS-PROCESS-SCREEN                VALUE 'R'.          08637099
086380       10 LS-LAST-PROGRAM-NAME      PIC X(8).                     08638099
086390       10 LS-LAST-ACTION-STATUS     PIC X(1).                     08639099
086400       10 LS-SELECTION-X            PIC X(2).                     08640099
086410       10 LS-SELECTION REDEFINES                                  08641099
086420          LS-SELECTION-X            PIC 9(2).                     08642099
086430       10 LS-ACTION                 PIC X(1).                     08643099
086440           88 LS-ADD-ACTION                    VALUE 'A'.         08644099
086450           88 LS-CHANGE-ACTION                 VALUE 'C'.         08645099
086460           88 LS-DELETE-ACTION                 VALUE 'D'.         08646099
086470       10 LS-ACCOUNT-NUMBER-X       PIC X(10).                    08647099
086480       10 LS-ACCOUNT-NUMBER REDEFINES                             08648099
086490          LS-ACCOUNT-NUMBER-X       PIC 9(10).                    08649099
086500       10 LS-DEPARTMENT-X           PIC X(3).                     08650099
086510       10 LS-DEPARTMENT REDEFINES                                 08651099
086520          LS-DEPARTMENT-X           PIC 9(3).                     08652099
086530       10 LS-ACCT-ACCESS      PIC X(1).                           08653099
086540          88 LS-ACCT-ACCESS-YES            VALUE 'Y'.             08654099
086550          88 LS-ACCT-ACCESS-NO             VALUE 'N'.             08655099
086560       10 LS-SSN-ACCESS       PIC X(1).                           08656099
086570          88 LS-SSN-ACCESS-YES             VALUE 'Y'.             08657099
086580          88 LS-SSN-ACCESS-NO              VALUE 'N'.             08658099
086590       10 LS-TOKEN-ACCT-IND   PIC X(1).                           08659099
086600          88 LS-TOKEN-ACCT-YES             VALUE 'Y'.             08660099
086610          88 LS-TOKEN-ACCT-NO              VALUE 'N'.             08661099
086620    05 LS-PROGRAM-DATA.                                           08662099
086630       10 LS-SOCIAL-SECURITY-NUMBER-X PIC X(9).                   08663099
086640       10 LS-EMPLOYEE-ID            PIC X(11).                    08664099
086650       10 LS-EMPLOYEE-STATUS        PIC X(1).                     08665099
086660       10 LS-CRS-EMPLOYEE-CODE      PIC X(1).                     08666099
086670       10 LS-DISCOUNT-STATUS        PIC X(1).                     08667099
086680       10 LS-EMPLOYEE-NAME          PIC X(50).                    08668099
086690       10 LS-CONFIRM-FRST-NAME      PIC X(19).                    08669099
086700       10 LS-CONFIRM-MI-NAME        PIC X(1).                     08670099
086710       10 LS-CONFIRM-LAST-NAME      PIC X(30).                    08671099
086720       10 LS-STORE-NUMBER-X         PIC X(4).                     08672099
086730       10 LS-STORE-NUMBER REDEFINES                               08673099
086740          LS-STORE-NUMBER-X         PIC 9(4).                     08674099
086750       10 LS-ACCOUNT-NOTES-1        PIC X(40).                    08675099
086760       10 LS-ACCOUNT-NOTES-2        PIC X(40).                    08676099
086770       10 LS-DATE-DISCOUNT-EFFECTIVE                              08677099
086780                                    PIC X(8).                     08678099
086790       10 LS-DATE-TERMINATION-EFFECT                              08679099
086800                                    PIC X(8).                     08680099
086810       10 LS-CONFIRM-ADD            PIC X(1).                     08681099
086820       10 LS-CONFIRM-UPD            PIC X(1).                     08682099
086830       10 LS-CONFIRM-DEL            PIC X(1).                     08683099
086840       10 LS-EMPLOYEE-FLAG          PIC X(1).                     08684099
086850       10 LS-SCREEN-FLAG            PIC X(1).                     08685099
086860       10 LS-SCROLL-UP-FLAG         PIC X(1).                     08686099
086870       10 LS-SCROLL-DOWN-FLAG       PIC X(1).                     08687099
086880       10 LS-UNPROTECT-NAME-SW      PIC X(1).                     08688099
086890       10 LS-FETCH-PTR              PIC S9(4) COMP.               08689099
086900       10 LS-READNEXT-COUNTER       PIC S9(4) COMP.               08690099
086910       10 LS-SEARCH-TEXT            PIC X(50).                    08691099
086920       10 LS-SEARCH-SELECTION       PIC X(1)  OCCURS 14 TIMES.    08692099
086930       10 LS-PROTECT-DISC-FLAG      PIC X.                        08693099
086940       10 LS-EDIT-NAME-FLAG         PIC X.                        08694099
086950                                                                  08695099
086960******************************************************************08696099
086970 PROCEDURE DIVISION.                                              08697099
086980******************************************************************08698099
086990*----------------------*                                          08699099
087000 0000-MAINLINE SECTION.                                           08700099
087010*----------------------*                                          08701099
087020     IF EIBCALEN = 0                                              08702099
087030        PERFORM 9000-RETURN-TO-MAIN-MENU                          08703099
087040     ELSE                                                         08704099
087050        MOVE LOW-VALUES TO AR002AI                                08705099
087060                           AR002BI                                08706099
087070        IF LS-INITIALIZE-SCREEN                                   08707099
087080           PERFORM 0050-INITIALIZE-PROGRAM                        08708099
087090        ELSE                                                      08709099
087100           PERFORM 0075-PROCESS-DISCOUNT-RECORD                   08710099
087110        END-IF                                                    08711099
087120     END-IF.                                                      08712099
087130                                                                  08713099
087140     PERFORM 6400-RETURN.                                         08714099
087150                                                                  08715099
087160     GOBACK.                                                      08716099
087170*----------*                                                      08717099
087180 0000-EXIT.                                                       08718099
087190*----------*                                                      08719099
087200     EXIT.                                                        08720099
087210                                                                  08721099
087220*--------------------------------*                                08722099
087230 0050-INITIALIZE-PROGRAM SECTION.                                 08723099
087240*--------------------------------*                                08724099
087250     MOVE LS-COMMON-DATA TO CA-COMMON-DATA.                       08725099
087260     PERFORM 5000-INITIALIZE-SCREEN.                              08726099
087270     PERFORM 5600-GET-USER-ACCESS.                                08727099
087271***GB TEST ONLY                                                   08727199
087272***GB THIS IS USED TO TEST IN CICST1 - IT WILL NOT OVERLAY        08727299
087273***   THE FIRST 5 SSN WITH XXXXX WHEN THIS IS UNCOMMENTED         08727399
087274*     SET CA-ACCT-ACCESS-YES TO TRUE                              08727499
087275*     SET CA-SSN-ACCESS-YES  TO TRUE                              08727599
087276*     SET CA-TOKEN-ACCT-YES  TO TRUE                              08727699
087277***GB TEST ONLY                                                   08727799
087280                                                                  08728099
087290     IF CA-LAST-PROGRAM-NAME = (PC-LIST-PROGRAM-NAME       OR     08729099
087300                                PC-MAIN-MENU-PROGRAM-NAME) AND    08730099
087310                                CA-ACCOUNT-NUMBER-X NOT = SPACES  08731099
087320        MOVE PC-CURRENT-PROGRAM-TRANSID TO EIBTRNID               08732099
087330        IF CA-ACCT-ACCESS-YES                                     08733099
087340           MOVE CA-ACCOUNT-NUMBER-X     TO AACCTO                 08734099
087350        ELSE                                                      08735099
087360           MOVE CA-ACCOUNT-NUMBER-X     TO AACCTO                 08736099
087370           MOVE 'XXXXXXXX'              TO AACCTO(1:8)            08737099
087380        END-IF                                                    08738099
087390        PERFORM 1100-READ-DISCOUNT-BY-ACCT                        08739099
087400     END-IF.                                                      08740099
087410                                                                  08741099
087420     SET CA-MAIN-SCREEN TO TRUE.                                  08742099
087430     PERFORM 6000-SEND-MAP.                                       08743099
087440*----------*                                                      08744099
087450 0050-EXIT.                                                       08745099
087460*----------*                                                      08746099
087470     EXIT.                                                        08747099
087480                                                                  08748099
087490*-------------------------------------*                           08749099
087500 0075-PROCESS-DISCOUNT-RECORD SECTION.                            08750099
087510*-------------------------------------*                           08751099
087520     MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          08752099
087530                                                                  08753099
087540     IF CA-MAIN-SCREEN                                            08754099
087550        PERFORM 6300-RECEIVE-MAP                                  08755099
087560     ELSE                                                         08756099
087570        PERFORM 6350-RECEIVE-SEARCH-MAP                           08757099
087580     END-IF.                                                      08758099
087590                                                                  08759099
087600     PERFORM 6500-UPDATE-SCREEN-HEADER.                           08760099
087610     PERFORM 5300-INITIALIZE-HILIGHTS.                            08761099
087620                                                                  08762099
087630     IF CA-MAIN-SCREEN                                            08763099
087640        PERFORM 0100-PROCESS-MAIN-SCREEN                          08764099
087650     ELSE                                                         08765099
087660        PERFORM 0200-PROCESS-SEARCH-SCREEN                        08766099
087670     END-IF.                                                      08767099
087680*----------*                                                      08768099
087690 0075-EXIT.                                                       08769099
087700*----------*                                                      08770099
087710     EXIT.                                                        08771099
087720                                                                  08772099
087730*---------------------------------*                               08773099
087740 0100-PROCESS-MAIN-SCREEN SECTION.                                08774099
087750*---------------------------------*                               08775099
087760     EVALUATE TRUE                                                08776099
087770        WHEN EIBAID = DFHPF1                                      08777099
087780            PERFORM 1000-READ-DISCOUNT-BY-SSN                     08778099
087790        WHEN EIBAID = DFHPF2                                      08779099
087800            SET CA-TOKEN-ACCT-NO TO TRUE                          08780099
087810            PERFORM 1100-READ-DISCOUNT-BY-ACCT                    08781099
087820        WHEN EIBAID = DFHPF3                                      08782099
087830            IF CA-CONFIRMED-ADD OR                                08783099
087840               CA-CONFIRMED-UPD OR                                08784099
087850               CA-CONFIRMED-DEL                                   08785099
087860               SET CA-UNCONFIRMED-ADD TO TRUE                     08786099
087870               SET CA-UNCONFIRMED-UPD TO TRUE                     08787099
087880               SET CA-UNCONFIRMED-DEL TO TRUE                     08788099
087890               SET PM-MESSAGE-INDEX TO 31                         08789099
087900               PERFORM 5400-UNPROTECT-ATTRIBUTES                  08790099
087910               SET CA-PROTECT-NAME TO TRUE                        08791099
087920               INITIALIZE AFRSTNMO                                08792099
087930                          AMDLNMO                                 08793099
087940                          ALSTNMO                                 08794099
087950            ELSE                                                  08795099
087960               SET CA-LAST-ACTION-ABORTED TO TRUE                 08796099
087970               PERFORM 9100-RETURN-TO-CALLING-PROGRAM             08797099
087980            END-IF                                                08798099
087990*       WHEN EIBAID = DFHPF4                                      08799099
088000*           PERFORM 1300-ADD-DISCOUNT-RECORD                      08800099
088010        WHEN EIBAID = DFHPF5                                      08801099
088020            PERFORM 1200-READ-NEXT-DISCOUNT-RECORD                08802099
088030*       WHEN EIBAID = DFHPF6                                      08803099
088040*           PERFORM 1400-UPDATE-DISCOUNT-RECORD                   08804099
088050*       WHEN EIBAID = DFHPF8                                      08805099
088060*           PERFORM 1500-DELETE-DISCOUNT-RECORD                   08806099
088070*       WHEN EIBAID = DFHPF10                                     08807099
088080*           PERFORM 1600-SEARCH-BY-NAME                           08808099
088090*           IF PS-NO-EDIT-ERROR                                   08809099
088100*              MOVE -1 TO BSRCHL                                  08810099
088110*           END-IF                                                08811099
088120*           PERFORM 6100-SEND-SEARCH-MAP                          08812099
088130*           GO TO 0100-EXIT                                       08813099
088140        WHEN EIBAID = DFHPF11                                     08814099
088150            PERFORM 1650-SEARCH-BY-STORE                          08815099
088160            IF PS-NO-EDIT-ERROR                                   08816099
088170               MOVE -1 TO BSRCHL                                  08817099
088180            END-IF                                                08818099
088190            PERFORM 6100-SEND-SEARCH-MAP                          08819099
088200            GO TO 0100-EXIT                                       08820099
088210        WHEN EIBAID = DFHPF12                                     08821099
088220            PERFORM 1675-SEARCH-BY-SSN                            08822099
088230            IF PS-NO-EDIT-ERROR                                   08823099
088240               MOVE -1 TO BSRCHL                                  08824099
088250            END-IF                                                08825099
088260            PERFORM 6100-SEND-SEARCH-MAP                          08826099
088270            GO TO 0100-EXIT                                       08827099
088280        WHEN EIBAID = DFHCLEAR                                    08828099
088290            PERFORM 2400-MOVE-COMMAREA-TO-MAP                     08829099
088300            SET PM-MESSAGE-INDEX TO 1                             08830099
088310            PERFORM 6000-SEND-MAP                                 08831099
088320        WHEN OTHER                                                08832099
088330            PERFORM 3000-RECEIVE-COMMON-FIELDS                    08833099
088340            PERFORM 3100-RECEIVE-NONEMP-FIELDS                    08834099
088350            MOVE CA-EMPLOYEE-NAME TO CA-SEARCH-TEXT               08835099
088360            IF CA-EMPLOYEE                                        08836099
088370               PERFORM 2500-MOVE-EMP-NO-UPD-FIELDS                08837099
088380            END-IF                                                08838099
088390            PERFORM 1605-BUILD-SEARCH-STRING                      08839099
088400            MOVE CA-SEARCH-TEXT TO AENAMEO                        08840099
088410            SET PM-MESSAGE-INDEX TO 2                             08841099
088420     END-EVALUATE.                                                08842099
088430                                                                  08843099
088440     IF PS-NO-EDIT-ERROR                                          08844099
088450        MOVE -1 TO ASSNL                                          08845099
088460     END-IF.                                                      08846099
088470                                                                  08847099
088480     SET CA-MAIN-SCREEN TO TRUE.                                  08848099
088490     PERFORM 6200-SEND-MAP-DATAONLY.                              08849099
088500*----------*                                                      08850099
088510 0100-EXIT.                                                       08851099
088520*----------*                                                      08852099
088530     EXIT.                                                        08853099
088540                                                                  08854099
088550*-----------------------------------*                             08855099
088560 0200-PROCESS-SEARCH-SCREEN SECTION.                              08856099
088570*-----------------------------------*                             08857099
088580     EVALUATE TRUE                                                08858099
088590        WHEN EIBAID = DFHPF3                                      08859099
088600            PERFORM 6650-DELETE-SEARCH-QUEUE                      08860099
088610            INITIALIZE CA-PROGRAM-DATA                            08861099
088620            SET CA-MAIN-SCREEN TO TRUE                            08862099
088630            PERFORM 5000-INITIALIZE-SCREEN                        08863099
088640            MOVE -1 TO ASSNL                                      08864099
088650            PERFORM 6000-SEND-MAP                                 08865099
088660            GO TO 0200-EXIT                                       08866099
088670        WHEN EIBAID = DFHPF7                                      08867099
088680            IF CA-ENABLE-UP                                       08868099
088690               PERFORM 1700-SCROLL-UP-SCREEN                      08869099
088700            ELSE                                                  08870099
088710               PERFORM 3150-RECEIVE-SEARCH-FIELD                  08871099
088720               PERFORM 1605-BUILD-SEARCH-STRING                   08872099
088730               SET PM-MESSAGE-INDEX TO 38                         08873099
088740               PERFORM 1750-DISPLAY-SAME-SCREEN                   08874099
088750            END-IF                                                08875099
088760            MOVE -1 TO BSRCHL                                     08876099
088770        WHEN EIBAID = DFHPF8                                      08877099
088780            IF CA-ENABLE-DOWN                                     08878099
088790               PERFORM 1725-SCROLL-DOWN-SCREEN                    08879099
088800            ELSE                                                  08880099
088810               PERFORM 3150-RECEIVE-SEARCH-FIELD                  08881099
088820               PERFORM 1605-BUILD-SEARCH-STRING                   08882099
088830               SET PM-MESSAGE-INDEX TO 37                         08883099
088840               PERFORM 1750-DISPLAY-SAME-SCREEN                   08884099
088850            END-IF                                                08885099
088860            MOVE -1 TO BSRCHL                                     08886099
088870        WHEN EIBAID = DFHPF9                                      08887099
088880            PERFORM 3175-RECEIVE-SELECT-FIELDS                    08888099
088890               VARYING PV-SEARCH-PTR FROM 1 BY 1                  08889099
088900                  UNTIL PV-SEARCH-PTR > 14                        08890099
088910            PERFORM 3185-EDIT-SELECT-FIELDS                       08891099
088920               VARYING PV-SEARCH-PTR FROM 1 BY 1                  08892099
088930                  UNTIL PV-SEARCH-PTR > 14                        08893099
088940            IF PS-NO-EDIT-ERROR                                   08894099
088950               PERFORM 1800-PROCESS-SELECTION                     08895099
088960               IF PS-NO-EDIT-ERROR                                08896099
088970                  PERFORM 1000-READ-DISCOUNT-BY-SSN               08897099
088980                  MOVE -1 TO ASSNL                                08898099
088990                  PERFORM 6000-SEND-MAP                           08899099
089000                  GO TO 0200-EXIT                                 08900099
089010               END-IF                                             08901099
089020            END-IF                                                08902099
089030*       WHEN EIBAID = DFHPF10                                     08903099
089040*           PERFORM 3150-RECEIVE-SEARCH-FIELD                     08904099
089050*           PERFORM 1600-SEARCH-BY-NAME                           08905099
089060*           IF PS-NO-EDIT-ERROR                                   08906099
089070*              MOVE -1 TO BSRCHL                                  08907099
089080*           END-IF                                                08908099
089090        WHEN EIBAID = DFHPF11                                     08909099
089100            PERFORM 3150-RECEIVE-SEARCH-FIELD                     08910099
089110            PERFORM 1650-SEARCH-BY-STORE                          08911099
089120            IF PS-NO-EDIT-ERROR                                   08912099
089130               MOVE -1 TO BSRCHL                                  08913099
089140            END-IF                                                08914099
089150        WHEN EIBAID = DFHPF12                                     08915099
089160            PERFORM 3150-RECEIVE-SEARCH-FIELD                     08916099
089170            PERFORM 1675-SEARCH-BY-SSN                            08917099
089180            IF PS-NO-EDIT-ERROR                                   08918099
089190               MOVE -1 TO BSRCHL                                  08919099
089200            END-IF                                                08920099
089210        WHEN EIBAID = DFHCLEAR                                    08921099
089220            SET PM-MESSAGE-INDEX TO 1                             08922099
089230            INITIALIZE CA-PROGRAM-DATA                            08923099
089240            PERFORM 6100-SEND-SEARCH-MAP                          08924099
089250        WHEN OTHER                                                08925099
089260            PERFORM 3150-RECEIVE-SEARCH-FIELD                     08926099
089270            PERFORM 3175-RECEIVE-SELECT-FIELDS                    08927099
089280               VARYING PV-SEARCH-PTR FROM 1 BY 1                  08928099
089290                  UNTIL PV-SEARCH-PTR > 14                        08929099
089300            PERFORM 1605-BUILD-SEARCH-STRING                      08930099
089310            SET PM-MESSAGE-INDEX TO 2                             08931099
089320     END-EVALUATE.                                                08932099
089330                                                                  08933099
089340     IF PS-NO-EDIT-ERROR                                          08934099
089350        MOVE -1 TO BSRCHL                                         08935099
089360     END-IF.                                                      08936099
089370                                                                  08937099
089380     PERFORM 6150-SEND-SEARCH-MAP-DATAONLY.                       08938099
089390*----------*                                                      08939099
089400 0200-EXIT.                                                       08940099
089410*----------*                                                      08941099
089420     EXIT.                                                        08942099
089430                                                                  08943099
089440*----------------------------------*                              08944099
089450 1000-READ-DISCOUNT-BY-SSN SECTION.                               08945099
089460*----------------------------------*                              08946099
089470     IF CA-ACCT-ACCESS-NO                                         08947099
089480        SET CA-TOKEN-ACCT-YES TO TRUE                             08948099
089490     END-IF.                                                      08949099
089500     MOVE CA-SOCIAL-SECURITY-NUMBER-X TO                          08950099
089510          LS-SOCIAL-SECURITY-NUMBER-X.                            08951099
089520     MOVE CA-PROTECT-DISC-FLAG TO LS-PROTECT-DISC-FLAG.           08952099
089530     INITIALIZE CA-PROGRAM-DATA.                                  08953099
089540     MOVE LS-SOCIAL-SECURITY-NUMBER-X TO                          08954099
089550          CA-SOCIAL-SECURITY-NUMBER-X.                            08955099
089560     MOVE LS-PROTECT-DISC-FLAG TO CA-PROTECT-DISC-FLAG.           08956099
089570                                                                  08957099
089580     PERFORM 5100-INITIALIZE-OUTPUT.                              08958099
089590     SET CA-MAIN-SCREEN TO TRUE.                                  08959099
089600     INITIALIZE AACCTO                                            08960099
089610                CA-ACCOUNT-NUMBER-X.                              08961099
089620                                                                  08962099
089630     SET CA-UNCONFIRMED-ADD TO TRUE.                              08963099
089640     SET CA-UNCONFIRMED-UPD TO TRUE.                              08964099
089650     SET CA-UNCONFIRMED-DEL TO TRUE.                              08965099
089660                                                                  08966099
089670     PERFORM 4100-EDIT-SSN.                                       08967099
089680                                                                  08968099
089690     IF PS-EDIT-ERROR                                             08969099
089700        GO TO 1000-EXIT                                           08970099
089710     END-IF.                                                      08971099
089720                                                                  08972099
089730     PERFORM 5400-UNPROTECT-ATTRIBUTES.                           08973099
089740                                                                  08974099
089750     PERFORM 6750-DELETE-READNEXT-QUEUE.                          08975099
089760     MOVE CA-SOCIAL-SECURITY-NUMBER-X TO ART00001-SSN-NBR.        08976099
089770     PERFORM 7000-SELECT-ART-ROW-SSN.                             08977099
089780                                                                  08978099
089790*-->IF RECORD NOT FOUND ON ART_EMP_DISC, SEND MESSAGE TO SCREEN   08979099
089800     IF PS-EDIT-ERROR                                             08980099
089810        SET PS-NO-EDIT-ERROR TO TRUE                              08981099
089820        SET CA-NON-EMPLOYEE TO TRUE                               08982099
089830        MOVE DP015-ASK-DRK-OFF TO AREHIRA                         08983099
089920                                                                  08992099
089960        SET CA-LAST-ACTION-ABORTED TO TRUE                        08996099
089970        MOVE DP015-REVERSE TO ASSNH                               08997099
089980        SET PM-MESSAGE-INDEX TO 20                                08998099
089990        MOVE -1 TO ASSNL                                          08999099
090000        GO TO 1000-EXIT                                           09000099
090060     ELSE                                                         09006099
090070*--> TABLES WAS SUCCESSFUL. MOVE DATA TO SCREEN.                  09007099
090090        SET CA-EMPLOYEE TO TRUE                                   09009099
090100        MOVE ART00001-EMP-ID   TO CA-EMPLOYEE-ID                  09010099
090101**GB                                                              09010199
090110        MOVE PV-TOKEN-SS-NBR    TO ART00001-SSN-NBR               09011099
090111**GB                                                              09011199
090120        PERFORM 2000-MOVE-ART-TO-SCRN                             09012099
090130*-->GET ALL DISCOUNT RECORDS THAT MATCH SSN.                      09013099
090140        PERFORM 7100-OPEN-EMP-ID-CURSOR                           09014099
090150        INITIALIZE PS-NO-MORE-RECS-SW                             09015099
090160*-->MOVE FIRST RECORD TO SCREEN, ALL RECORDS AFTER THAT           09016099
090170*-->GET PUT INTO TEMPORARY STORAGE QUEUE FOR A READ NEXT.         09017099
090180        PERFORM 1025-GET-ALL-EMP-ACCT-RECS                        09018099
090190           UNTIL PS-NO-MORE-RECS                                  09019099
090200                                                                  09020099
090210*-->IF THERE ARE NO DISCOUNT RECORDS, IT IS NOT AN ERROR.         09021099
090220        IF CA-READNEXT-COUNTER = ZEROES                           09022099
090230           SET PS-NO-EDIT-ERROR TO TRUE                           09023099
090240        ELSE                                                      09024099
090250           SUBTRACT 1 FROM CA-READNEXT-COUNTER END-SUBTRACT       09025099
090260        END-IF                                                    09026099
090270        PERFORM 7180-CLOSE-EMP-ID-CURSOR                          09027099
090280     END-IF.                                                      09028099
090290                                                                  09029099
090300     MOVE -1 TO ASSNL.                                            09030099
090310     SET PM-MESSAGE-INDEX TO 19.                                  09031099
090320*----------*                                                      09032099
090330 1000-EXIT.                                                       09033099
090340*----------*                                                      09034099
090350     EXIT.                                                        09035099
090360                                                                  09036099
090370*-----------------------------------*                             09037099
090380 1025-GET-ALL-EMP-ACCT-RECS SECTION.                              09038099
090390*-----------------------------------*                             09039099
090400     PERFORM 7140-FETCH-EMP-ID-CURSOR.                            09040099
090410                                                                  09041099
090420     IF PS-NO-EDIT-ERROR                                          09042099
090430        ADD 1 TO CA-READNEXT-COUNTER END-ADD                      09043099
090440        IF CA-READNEXT-COUNTER = 1                                09044099
090450           PERFORM 2100-MOVE-EMP-DISC-TO-SCRN                     09045099
090460        ELSE                                                      09046099
090470           IF CA-ACCT-ACCESS-YES                                  09047099
090480              MOVE ART00001-ACCT-NBR       TO PV-ACCOUNT-NBR-10   09048099
090490              PERFORM 6940-DETOKEN-ACCT                           09049099
090500              MOVE PV-ACCOUNT-NBR-10       TO AACCT2O             09050099
090510           ELSE                                                   09051099
090520              MOVE ART00001-ACCT-NBR       TO AACCT2O             09052099
090530              MOVE 'XXXXXXXX'              TO AACCT2O(1:8)        09053099
090540           END-IF                                                 09054099
090550           SET PS-NO-EDIT-ERROR TO TRUE                           09055099
090560           SET PS-NO-MORE-RECS TO TRUE                            09056099
090570        END-IF                                                    09057099
090580     ELSE                                                         09058099
090590        SET PS-NO-EDIT-ERROR TO TRUE                              09059099
090600        SET PS-NO-MORE-RECS TO TRUE                               09060099
090610     END-IF.                                                      09061099
090620*----------*                                                      09062099
090630 1025-EXIT.                                                       09063099
090640*----------*                                                      09064099
090650     EXIT.                                                        09065099
090660                                                                  09066099
090950                                                                  09095099
090960*-----------------------------------*                             09096099
090970 1100-READ-DISCOUNT-BY-ACCT SECTION.                              09097099
090980*-----------------------------------*                             09098099
090990     MOVE CA-PROTECT-DISC-FLAG TO LS-PROTECT-DISC-FLAG.           09099099
091000     INITIALIZE CA-PROGRAM-DATA.                                  09100099
091010     MOVE LS-PROTECT-DISC-FLAG TO CA-PROTECT-DISC-FLAG.           09101099
091020     PERFORM 5100-INITIALIZE-OUTPUT.                              09102099
091030     INITIALIZE ASSNO                                             09103099
091040                CA-SOCIAL-SECURITY-NUMBER-X.                      09104099
091050                                                                  09105099
091060     SET CA-UNCONFIRMED-ADD TO TRUE.                              09106099
091070     SET CA-UNCONFIRMED-UPD TO TRUE.                              09107099
091080     SET CA-UNCONFIRMED-DEL TO TRUE.                              09108099
091090                                                                  09109099
091100     PERFORM 4200-EDIT-ACCT-NBR.                                  09110099
091110                                                                  09111099
091120     IF PS-EDIT-ERROR                                             09112099
091130        GO TO 1100-EXIT                                           09113099
091140     END-IF.                                                      09114099
091150                                                                  09115099
091160     PERFORM 5400-UNPROTECT-ATTRIBUTES.                           09116099
091170     PERFORM 6750-DELETE-READNEXT-QUEUE.                          09117099
091180                                                                  09118099
091190*-->SELECT ALL DISCOUNT RECORDS THAT MATCH ACCOUNT.               09119099
091200     MOVE CA-ACCOUNT-NUMBER TO ART00001-ACCT-NBR.                 09120099
091210     IF CA-TOKEN-ACCT-YES                                         09121099
091220        MOVE ART00001-ACCT-NBR TO PV-ACCT-NBR-TOKEN               09122099
091230     ELSE                                                         09123099
091240        MOVE ART00001-ACCT-NBR TO PV-ACCOUNT-NBR-10               09124099
091250        PERFORM 7135-TOKEN-ACCTNBR                                09125099
091260     END-IF.                                                      09126099
091270     PERFORM 7120-OPEN-EMP-ACCT-CURSOR.                           09127099
091280                                                                  09128099
091290     INITIALIZE PS-NO-MORE-RECS-SW.                               09129099
091300*-->MOVE FIRST RECORD TO SCREEN, ALL RECORDS AFTER THAT           09130099
091310*-->GET PUT INTO TEMPORARY STORAGE QUEUE FOR A READ NEXT.         09131099
091320     PERFORM 1125-GET-ALL-EMP-SSN-FOR-ACCT                        09132099
091330        UNTIL PS-NO-MORE-RECS.                                    09133099
091340                                                                  09134099
091350*-->IF FOR SOME REASON A RECORD WASN'T FOUND,                     09135099
091360*-->DISPLAY MESSAGE AND EXIT.                                     09136099
091370     IF PS-EDIT-ERROR                                             09137099
091380        GO TO 1100-EXIT                                           09138099
091390     END-IF.                                                      09139099
091400                                                                  09140099
091510     MOVE DP015-ASK-DRK-OFF TO AREHIRA.                           09151099
091540     IF CA-READNEXT-COUNTER = ZEROES                              09154099
091550        SET PS-EDIT-ERROR TO TRUE                                 09155099
091600     ELSE                                                         09160099
091620        SUBTRACT 1 FROM CA-READNEXT-COUNTER END-SUBTRACT          09162099
091640     END-IF.                                                      09164099
091680                                                                  09168099
091690     PERFORM 7200-CLOSE-EMP-ACCT-CURSOR.                          09169099
091700                                                                  09170099
091710     IF PS-NO-EDIT-ERROR                                          09171099
091720        MOVE -1 TO ASSNL                                          09172099
091730        SET PM-MESSAGE-INDEX TO 19                                09173099
091740     END-IF.                                                      09174099
091750*----------*                                                      09175099
091760 1100-EXIT.                                                       09176099
091770*----------*                                                      09177099
091780     EXIT.                                                        09178099
091790                                                                  09179099
091800*--------------------------------------*                          09180099
091810 1125-GET-ALL-EMP-SSN-FOR-ACCT SECTION.                           09181099
091820*--------------------------------------*                          09182099
091830     PERFORM 7160-FETCH-EMP-ACCT-CURSOR.                          09183099
091840     IF PS-NO-EDIT-ERROR                                          09184099
091850        SET CA-EMPLOYEE TO TRUE                                   09185099
091940        ADD 1 TO CA-READNEXT-COUNTER END-ADD                      09194099
091980*CLP ADDED                                                        09198099
091990        IF IND-ART00001-DISC-DTE = 0                              09199099
092000            MOVE DP015-ASK-NOR-OFF  TO AREHIRA                    09200099
092010            SET PV-TEMP-REHIR-ON TO TRUE                          09201099
092020        ELSE                                                      09202099
092030            MOVE DP015-ASK-DRK-OFF TO AREHIRA                     09203099
092040            SET PV-TEMP-REHIR-OFF TO TRUE                         09204099
092050        END-IF                                                    09205099
092060        IF CA-READNEXT-COUNTER = 1                                09206099
092070           IF PV-TEMP-REHIR-ON                                    09207099
092080              MOVE DP015-ASK-NOR-OFF TO AREHIRA                   09208099
092090           ELSE                                                   09209099
092100              MOVE DP015-ASK-DRK-OFF TO AREHIRA                   09210099
092110           END-IF                                                 09211099
092120           MOVE DP015-ASK-DRK-OFF TO APF5A                        09212099
092130           IF CA-ACCT-ACCESS-YES                                  09213099
092140              MOVE PV-ACCT-NBR-TOKEN TO ART00001-ACCT-NBR         09214099
092150           END-IF                                                 09215099
092160           PERFORM 2000-MOVE-ART-TO-SCRN                          09216099
092170           PERFORM 2100-MOVE-EMP-DISC-TO-SCRN                     09217099
092180           SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                  09218099
092190        ELSE                                                      09219099
092200           IF CA-READNEXT-COUNTER > 1                             09220099
092210              INITIALIZE PV-TEMP-READNEXT-REC                     09221099
092220              MOVE ART00001-ACCT-NBR      TO PV-TEMP-ACCT-NBR     09222099
092230              MOVE ART00001-DISC-STAT-CDE TO PV-TEMP-DISC-STAT    09223099
092240              MOVE ART00001-EMP-ID        TO PV-TEMP-EMP-ID       09224099
092250              MOVE ART00001-SSN-NBR       TO PV-TEMP-SSN-NBR      09225099
092260              MOVE ART00001-EMP-NM        TO PV-TEMP-EMP-NAME     09226099
092270              MOVE ART00001-LOC-NBR       TO PV-TEMP-STR-NBR      09227099
092280              MOVE ART00001-EMP-STAT-CDE  TO PV-TEMP-EMP-STAT     09228099
092290              MOVE ART00001-EMP-TYP-CDE   TO PV-TEMP-EMP-CODE     09229099
092300              MOVE ART00001-DISC-DTE      TO PV-TEMP-DISC-DTE     09230099
092310              IF IND-ART00001-TERM-DTE = -1                       09231099
092320                 MOVE SPACES TO PV-TEMP-TERM-DTE                  09232099
092330              ELSE                                                09233099
092340                 MOVE ART00001-TERM-DTE TO PV-TEMP-TERM-DTE       09234099
092350              END-IF                                              09235099
092360              MOVE SPACES TO PV-TEMP-ACCT-NOTES-GRP               09236099
092370              IF IND-ART00001-CMNT-TXT = 0                        09237099
092380                 MOVE ART00001-CMNT-TXT-TEXT TO                   09238099
092390                      PV-TEMP-ACCT-NOTES-GRP                      09239099
092400              END-IF                                              09240099
092410              MOVE DP015-ASK-BRT-OFF TO APF5A                     09241099
092420              PERFORM 6700-WRITE-READNEXT-QUEUE                   09242099
092430           END-IF                                                 09243099
092440        END-IF                                                    09244099
092450     ELSE                                                         09245099
092460        SET PS-NO-EDIT-ERROR TO TRUE                              09246099
092470        SET PS-NO-MORE-RECS TO TRUE                               09247099
092480     END-IF.                                                      09248099
092490*----------*                                                      09249099
092500 1125-EXIT.                                                       09250099
092510*----------*                                                      09251099
092520     EXIT.                                                        09252099
092530                                                                  09253099
093000                                                                  09300099
093010*---------------------------------------*                         09301099
093020 1200-READ-NEXT-DISCOUNT-RECORD SECTION.                          09302099
093030*---------------------------------------*                         09303099
093040     ADD 1 TO CA-FETCH-COUNTER END-ADD.                           09304099
093050     IF CA-FETCH-COUNTER <= CA-READNEXT-COUNTER                   09305099
093060        IF CA-FETCH-COUNTER = CA-READNEXT-COUNTER                 09306099
093070           MOVE DP015-ASK-DRK-OFF TO APF5A                        09307099
093080        END-IF                                                    09308099
093090                                                                  09309099
093100*-->READ A RECORD FROM THE TEMPORARY STORAGE QUEUE                09310099
093110*-->AND MOVE IT TO THE SCREEN.                                    09311099
093120        PERFORM 6725-READ-READNEXT-QUEUE                          09312099
093130                                                                  09313099
093140        MOVE PV-TEMP-ACCT-NBR          TO AACCTO                  09314099
093150                                          CA-ACCOUNT-NUMBER-X     09315099
093160        MOVE PV-TEMP-DISC-STAT         TO ADSTATO                 09316099
093170                                          CA-DISCOUNT-STATUS      09317099
093180        MOVE PV-TEMP-ACCT-NOTES-1      TO ANOTES1O                09318099
093190                                          CA-ACCOUNT-NOTES-1      09319099
093200        MOVE PV-TEMP-ACCT-NOTES-2      TO ANOTES2O                09320099
093210                                          CA-ACCOUNT-NOTES-2      09321099
093220        MOVE PV-TEMP-EMP-ID            TO CA-EMPLOYEE-ID          09322099
093230        MOVE PV-TEMP-SSN-NBR           TO ASSNO                   09323099
093240                                       CA-SOCIAL-SECURITY-NUMBER-X09324099
093250        MOVE PV-TEMP-EMP-NAME          TO AENAMEO                 09325099
093260                                          CA-EMPLOYEE-NAME        09326099
093270        MOVE PV-TEMP-STR-NBR           TO ASTOREO                 09327099
093280                                          CA-STORE-NUMBER-X       09328099
093290        MOVE PV-TEMP-EMP-STAT          TO AESTATO                 09329099
093300                                          CA-EMPLOYEE-STATUS      09330099
093310        MOVE PV-TEMP-EMP-CODE          TO AECODEO                 09331099
093320                                          CA-CRS-EMPLOYEE-CODE    09332099
093330        MOVE PV-TEMP-DISC-DTE          TO PV-SQL-DATE-GROUP       09333099
093340        MOVE PV-SQL-CCYY               TO CA-DATE-DISC-EFF-CCYY   09334099
093350                                          ADTDEFYO                09335099
093360        MOVE PV-SQL-DD                 TO CA-DATE-DISC-EFF-DD     09336099
093370                                          ADTDEFDO                09337099
093380        MOVE PV-SQL-MM                 TO CA-DATE-DISC-EFF-MM     09338099
093390                                          ADTDEFMO                09339099
093400                                                                  09340099
093410        MOVE PV-TEMP-TERM-DTE          TO PV-SQL-DATE-GROUP       09341099
093420        MOVE PV-SQL-CCYY               TO CA-DATE-TERM-EFF-CCYY   09342099
093430                                          ADTTEFYO                09343099
093440        MOVE PV-SQL-DD                 TO CA-DATE-TERM-EFF-DD     09344099
093450                                          ADTTEFDO                09345099
093460        MOVE PV-SQL-MM                 TO CA-DATE-TERM-EFF-MM     09346099
093470                                          ADTTEFMO                09347099
093480        SET PM-MESSAGE-INDEX TO 19                                09348099
093490     ELSE                                                         09349099
093500        SET PM-MESSAGE-INDEX TO 38                                09350099
093510     END-IF.                                                      09351099
093520                                                                  09352099
093530     IF PV-TEMP-REHIR-ON                                          09353099
093540        MOVE DP015-ASK-NOR-OFF TO AREHIRA                         09354099
093550     ELSE                                                         09355099
093560        MOVE DP015-ASK-DRK-OFF TO AREHIRA                         09356099
093570     END-IF.                                                      09357099
093580     MOVE -1 TO ASSNL.                                            09358099
093590*----------*                                                      09359099
093600 1200-EXIT.                                                       09360099
093610*----------*                                                      09361099
093620     EXIT.                                                        09362099
093630                                                                  09363099
093640*---------------------------------*                               09364099
093650 1300-ADD-DISCOUNT-RECORD SECTION.                                09365099
093660*---------------------------------*                               09366099
093670*    IF CA-CONFIRMED-ADD                                          09367099
093680*       PERFORM 4650-CHECK-FOR-NAME-CORRECTION                    09368099
093690                                                                  09369099
093700*       IF PS-EDIT-ERROR                                          09370099
093710*          GO TO 1300-EXIT                                        09371099
093720*       END-IF                                                    09372099
093730                                                                  09373099
093740*       PERFORM 5400-UNPROTECT-ATTRIBUTES                         09374099
093750                                                                  09375099
093760*       SET CA-UNCONFIRMED-ADD TO TRUE                            09376099
093770                                                                  09377099
093780*       SET CA-PROTECT-NAME TO TRUE                               09378099
093790*       INITIALIZE AFRSTNMO                                       09379099
093800*                  AMDLNMO                                        09380099
093810*                  ALSTNMO                                        09381099
093820                                                                  09382099
093830*       IF CA-EMPLOYEE                                            09383099
093840*          MOVE CA-ACCOUNT-NUMBER-X TO ART00000-ACCT-NBR          09384099
093850*          PERFORM 7130-OPEN-NEMP-ACCT-CURSOR                     09385099
093860*          PERFORM 7170-FETCH-NEMP-ACCT-CURSOR                    09386099
093870*          PERFORM 7210-CLOSE-NEMP-ACCT-CURSOR                    09387099
093880                                                                  09388099
093890*          IF PS-NO-EDIT-ERROR                                    09389099
093900*             SET PS-EDIT-ERROR TO TRUE                           09390099
093910*             MOVE -1 TO AACCTL                                   09391099
093920*             MOVE DP015-REVERSE TO AACCTH                        09392099
093930*             SET PM-MESSAGE-INDEX TO 35                          09393099
093940*          ELSE                                                   09394099
093950*             PERFORM 3200-MOVE-EMPLOYEE-DISC-DATA                09395099
093960****          PERFORM 7425-INSERT-EMP-DISC-ROW                    09396099
093970****          IF PS-NO-EDIT-ERROR                                 09397099
093980****             PERFORM 3500-LOG-EMPLOYEE-ADD                    09398099
093990****          END-IF                                              09399099
094000*          END-IF                                                 09400099
094010*       ELSE                                                      09401099
094020*          MOVE CA-ACCOUNT-NUMBER-X TO ART00001-ACCT-NBR          09402099
094030*          PERFORM 7120-OPEN-EMP-ACCT-CURSOR                      09403099
094040*          PERFORM 7160-FETCH-EMP-ACCT-CURSOR                     09404099
094050*          PERFORM 7200-CLOSE-EMP-ACCT-CURSOR                     09405099
094060*                                                                 09406099
094070*          IF PS-NO-EDIT-ERROR                                    09407099
094080*             SET PS-EDIT-ERROR TO TRUE                           09408099
094090*             MOVE -1 TO AACCTL                                   09409099
094100*             MOVE DP015-REVERSE TO AACCTH                        09410099
094110*             SET PM-MESSAGE-INDEX TO 33                          09411099
094120*          ELSE                                                   09412099
094130*             SET CA-NON-EMPLOYEE TO TRUE                         09413099
094140*             IF CA-PROTECT-DISC-FLD                              09414099
094150*                MOVE 'R' TO ADSTATO                              09415099
094160*                            CA-DISCOUNT-STATUS                   09416099
094170*             END-IF                                              09417099
094180*             PERFORM 3250-MOVE-NONEMP-DISC-DATA                  09418099
094190****          PERFORM 7400-INSERT-NON-EMP-DISC-ROW                09419099
094200                                                                  09420099
094210*             IF PS-NO-EDIT-ERROR                                 09421099
094220*                MOVE DP015-PRO-NOR-OFF TO ANONEMA                09422099
094230****             PERFORM 3500-LOG-EMPLOYEE-ADD                    09423099
094240*             END-IF                                              09424099
094250*          END-IF                                                 09425099
094260*       END-IF                                                    09426099
094270*       GO TO 1300-EXIT                                           09427099
094280*    END-IF.                                                      09428099
094290                                                                  09429099
094300*    IF CA-CONFIRMED-UPD                                          09430099
094310*       SET PM-MESSAGE-INDEX TO 29                                09431099
094320*       GO TO 1300-EXIT                                           09432099
094330*    END-IF.                                                      09433099
094340                                                                  09434099
094350*    IF CA-CONFIRMED-DEL                                          09435099
094360*       SET PM-MESSAGE-INDEX TO 30                                09436099
094370*       GO TO 1300-EXIT                                           09437099
094380*    END-IF.                                                      09438099
094390                                                                  09439099
094400*    PERFORM 4350-CHECK-FOR-SSN-CHANGE.                           09440099
094410                                                                  09441099
094420*    PERFORM 3000-RECEIVE-COMMON-FIELDS.                          09442099
094430                                                                  09443099
094440*    IF CA-EMPLOYEE                                               09444099
094450*       PERFORM 2500-MOVE-EMP-NO-UPD-FIELDS                       09445099
094460*    ELSE                                                         09446099
094470*       PERFORM 3100-RECEIVE-NONEMP-FIELDS                        09447099
094480*    END-IF.                                                      09448099
094490                                                                  09449099
094500*    PERFORM 4100-EDIT-SSN.                                       09450099
094510*    PERFORM 4200-EDIT-ACCT-NBR.                                  09451099
094520                                                                  09452099
094530*    IF CA-EMPLOYEE                                               09453099
094540*       PERFORM 4025-EDIT-DISC-STATUS                             09454099
094550*    ELSE                                                         09455099
094560*       PERFORM 4000-EDIT-NONEMP-FIELDS                           09456099
094570*    END-IF.                                                      09457099
094580                                                                  09458099
094590*    IF PS-NO-EDIT-ERROR                                          09459099
094600*       PERFORM 4400-CHECK-DIGIT-ACCOUNT                          09460099
094610*       PERFORM 4500-VALIDATE-ACCOUNT-NUMBER                      09461099
094620*    END-IF.                                                      09462099
094630                                                                  09463099
094640*    IF PS-NO-EDIT-ERROR                                          09464099
094650*       MOVE CA-SOCIAL-SECURITY-NUMBER-X TO ART00000-SSN-NBR      09465099
094660*       PERFORM 7110-OPEN-NEMP-SSN-CURSOR                         09466099
094670*       PERFORM 7150-FETCH-NEMP-SSN-CURSOR                        09467099
094680*       PERFORM 7190-CLOSE-NEMP-SSN-CURSOR                        09468099
094690                                                                  09469099
094700*-->CHECK TO SEE IF NON-EMPLOYEE ALREADY EXISTS.                  09470099
094710*-->IF SO, IT NEEDS TO BE READ, IF NOT READ YET.                  09471099
094720*       IF PS-NO-EDIT-ERROR AND NOT                               09472099
094730*          CA-NON-EMPLOYEE                                        09473099
094740*          MOVE -1 TO ASSNL                                       09474099
094750*          SET PM-MESSAGE-INDEX TO 34                             09475099
094760*          GO TO 1300-EXIT                                        09476099
094770*       END-IF                                                    09477099
094780                                                                  09478099
094790*       MOVE CA-SOCIAL-SECURITY-NUMBER-X TO XST00072-SS-NBR       09479099
094800*       PERFORM 7000-SELECT-PS-VIEW-ROW-SSN                       09480099
094810                                                                  09481099
094820*-->CHECK TO SEE IF EMPLOYEE ALREADY EXISTS.                      09482099
094830*-->IF SO, IT NEEDS TO BE READ, IF NOT READ YET.                  09483099
094840*       IF PS-NO-EDIT-ERROR                                       09484099
094850*-->SELECT THE RE-HIRE DATE                                       09485099
094860*          PERFORM 7010-SELECT-RE-HIRE-DTE                        09486099
094870                                                                  09487099
094880*          IF NOT CA-EMPLOYEE                                     09488099
094890*             MOVE -1 TO ASSNL                                    09489099
094900*             SET PM-MESSAGE-INDEX TO 34                          09490099
094910*             SET PS-EDIT-ERROR TO TRUE                           09491099
094920*          ELSE                                                   09492099
094930*-->MAKE SURE EMPLOYEE DOESN'T GET MORE THAN TWO                  09493099
094940*-->ACCOUNTS ON DISCOUNT                                          09494099
094950*             MOVE XST00072-ASSOC-ID TO ART00001-EMP-ID           09495099
094960*             PERFORM 7100-OPEN-EMP-ID-CURSOR                     09496099
094970*             INITIALIZE PV-MAX-ACCT-CTR                          09497099
094980*             PERFORM 7140-FETCH-EMP-ID-CURSOR                    09498099
094990*                UNTIL PS-EDIT-ERROR OR                           09499099
095000*                      PV-MAX-ACCT-CTR > 1                        09500099
095010*             PERFORM 7180-CLOSE-EMP-ID-CURSOR                    09501099
095020*             IF PV-MAX-ACCT-CTR > 1                              09502099
095030*                SET PS-EDIT-ERROR TO TRUE                        09503099
095040*                SET PM-MESSAGE-INDEX TO 53                       09504099
095050*                MOVE -1 TO AACCTL                                09505099
095060*                MOVE DP015-REVERSE TO AACCTH                     09506099
095070*             ELSE                                                09507099
095080*                SET PS-NO-EDIT-ERROR TO TRUE                     09508099
095090*             END-IF                                              09509099
095100*          END-IF                                                 09510099
095110*       ELSE                                                      09511099
095120*          SET CA-NON-EMPLOYEE TO TRUE                            09512099
095130*          SET PS-NO-EDIT-ERROR TO TRUE                           09513099
095140*       END-IF                                                    09514099
095150*    END-IF.                                                      09515099
095160                                                                  09516099
095170*    IF PS-NO-EDIT-ERROR                                          09517099
095180*       PERFORM 5500-PROTECT-ATTRIBUTES                           09518099
095190*       SET PM-MESSAGE-INDEX TO 26                                09519099
095200*       SET CA-CONFIRMED-ADD TO TRUE                              09520099
095210*       SET CA-UNCONFIRMED-UPD TO TRUE                            09521099
095220*       SET CA-UNCONFIRMED-DEL TO TRUE                            09522099
095230*    END-IF.                                                      09523099
095240*----------*                                                      09524099
095250*1300-EXIT.                                                       09525099
095260*----------*                                                      09526099
095270*    EXIT.                                                        09527099
095280                                                                  09528099
095290*------------------------------------*                            09529099
095300*1400-UPDATE-DISCOUNT-RECORD SECTION.                             09530099
095310*------------------------------------*                            09531099
095320*    IF CA-CONFIRMED-UPD                                          09532099
095330*       IF CA-NON-EMPLOYEE                                        09533099
095340*          PERFORM 4650-CHECK-FOR-NAME-CORRECTION                 09534099
095350*       END-IF                                                    09535099
095360                                                                  09536099
095370*       IF PS-NO-EDIT-ERROR                                       09537099
095380*          SET CA-UNCONFIRMED-UPD TO TRUE                         09538099
095390*          PERFORM 5400-UNPROTECT-ATTRIBUTES                      09539099
095400                                                                  09540099
095410*          IF CA-EMPLOYEE                                         09541099
095420*             PERFORM 3200-MOVE-EMPLOYEE-DISC-DATA                09542099
095430*             PERFORM 7010-SELECT-EMP-CHNG-DATA                   09543099
095440****          IF PS-NO-EDIT-ERROR                                 09544099
095450****             PERFORM 7525-UPDATE-EMP-DISC-ROW                 09545099
095460****             IF PS-NO-EDIT-ERROR                              09546099
095470****                PERFORM 3610-LOG-EMP-UPDATE                   09547099
095480****             ELSE                                             09548099
095490****                GO TO 1400-EXIT                               09549099
095500****             END-IF                                           09550099
095510****          END-IF                                              09551099
095520*          ELSE                                                   09552099
095530*             PERFORM 3250-MOVE-NONEMP-DISC-DATA                  09553099
095540*             PERFORM 7015-SELECT-NON-EMP-CHNG-DATA               09554099
095550****          IF PS-NO-EDIT-ERROR                                 09555099
095560****             PERFORM 7500-UPDATE-NON-EMP-DISC-ROW             09556099
095570****             IF PS-NO-EDIT-ERROR                              09557099
095580****                PERFORM 3600-LOG-NON-EMP-UPDATE               09558099
095590****             ELSE                                             09559099
095600****                GO TO 1400-EXIT                               09560099
095610****             END-IF                                           09561099
095620****          END-IF                                              09562099
095630*          END-IF                                                 09563099
095640                                                                  09564099
095650*          SET CA-PROTECT-NAME    TO TRUE                         09565099
095660*          INITIALIZE AFRSTNMO                                    09566099
095670*                     AMDLNMO                                     09567099
095680*                     ALSTNMO                                     09568099
095690*       ELSE                                                      09569099
095700*          PERFORM 5500-PROTECT-ATTRIBUTES                        09570099
095710*       END-IF                                                    09571099
095720*       SET PM-MESSAGE-INDEX TO 21                                09572099
095730*       MOVE -1 TO ASSNL                                          09573099
095740*       GO TO 1400-EXIT                                           09574099
095750*    END-IF.                                                      09575099
095760                                                                  09576099
095770*    IF CA-CONFIRMED-ADD                                          09577099
095780*       SET PM-MESSAGE-INDEX TO 26                                09578099
095790*       GO TO 1400-EXIT                                           09579099
095800*    END-IF.                                                      09580099
095810                                                                  09581099
095820*    IF CA-CONFIRMED-DEL                                          09582099
095830*       SET PM-MESSAGE-INDEX TO 30                                09583099
095840*       GO TO 1400-EXIT                                           09584099
095850*    END-IF.                                                      09585099
095860                                                                  09586099
095870*    PERFORM 4300-VERIFY-READ.                                    09587099
095880                                                                  09588099
095890*    PERFORM 3000-RECEIVE-COMMON-FIELDS.                          09589099
095900                                                                  09590099
095910*    IF CA-NON-EMPLOYEE                                           09591099
095920*       PERFORM 3100-RECEIVE-NONEMP-FIELDS                        09592099
095930*    ELSE                                                         09593099
095940*       PERFORM 2500-MOVE-EMP-NO-UPD-FIELDS                       09594099
095950*    END-IF.                                                      09595099
095960                                                                  09596099
095970*    IF PS-EDIT-ERROR                                             09597099
095980*       MOVE -1 TO ASSNL                                          09598099
095990*       GO TO 1400-EXIT                                           09599099
096000*    END-IF.                                                      09600099
096010                                                                  09601099
096020*    PERFORM 4100-EDIT-SSN.                                       09602099
096030                                                                  09603099
096040*    PERFORM 4200-EDIT-ACCT-NBR.                                  09604099
096050                                                                  09605099
096060*    IF CA-NON-EMPLOYEE                                           09606099
096070*       PERFORM 4000-EDIT-NONEMP-FIELDS                           09607099
096080*    ELSE                                                         09608099
096090*       PERFORM 4025-EDIT-DISC-STATUS                             09609099
096100*    END-IF.                                                      09610099
096110                                                                  09611099
096120*    IF PS-NO-EDIT-ERROR                                          09612099
096130*       PERFORM 4400-CHECK-DIGIT-ACCOUNT                          09613099
096140*       PERFORM 4500-VALIDATE-ACCOUNT-NUMBER                      09614099
096150*    END-IF.                                                      09615099
096160                                                                  09616099
096170*    IF PS-EDIT-ERROR                                             09617099
096180*       GO TO 1400-EXIT                                           09618099
096190*    END-IF.                                                      09619099
096200                                                                  09620099
096210*    PERFORM 5500-PROTECT-ATTRIBUTES.                             09621099
096220*    SET PM-MESSAGE-INDEX TO 29.                                  09622099
096230*    SET CA-CONFIRMED-UPD TO TRUE.                                09623099
096240*    SET CA-UNCONFIRMED-DEL TO TRUE.                              09624099
096250*    SET CA-UNCONFIRMED-ADD TO TRUE.                              09625099
096260*----------*                                                      09626099
096270*1400-EXIT.                                                       09627099
096280*----------*                                                      09628099
096290*    EXIT.                                                        09629099
096300                                                                  09630099
096310*------------------------------------*                            09631099
096320*1500-DELETE-DISCOUNT-RECORD SECTION.                             09632099
096330*------------------------------------*                            09633099
096340*    IF CA-CONFIRMED-DEL                                          09634099
096350*       PERFORM 5400-UNPROTECT-ATTRIBUTES                         09635099
096360*       SET CA-UNCONFIRMED-DEL TO TRUE                            09636099
096370*                                                                 09637099
096380*       IF CA-EMPLOYEE                                            09638099
096390*          MOVE CA-EMPLOYEE-ID    TO ART00001-EMP-ID              09639099
096400*          MOVE CA-ACCOUNT-NUMBER TO ART00001-ACCT-NBR            09640099
096410****       PERFORM 7650-DELETE-EMP-DISC-ROW                       09641099
096420*       ELSE                                                      09642099
096430*          MOVE CA-SOCIAL-SECURITY-NUMBER-X TO ART00000-SSN-NBR   09643099
096440*          MOVE CA-ACCOUNT-NUMBER           TO ART00000-ACCT-NBR  09644099
096450****       PERFORM 7600-DELETE-NON-EMP-DISC-ROW                   09645099
096460*       END-IF                                                    09646099
096470*                                                                 09647099
096480*       IF CA-EMPLOYEE                                            09648099
096490*          PERFORM 7120-OPEN-EMP-ACCT-CURSOR                      09649099
096500*          PERFORM 7160-FETCH-EMP-ACCT-CURSOR                     09650099
096510*          PERFORM 7200-CLOSE-EMP-ACCT-CURSOR                     09651099
096520*       ELSE                                                      09652099
096530*          PERFORM 7130-OPEN-NEMP-ACCT-CURSOR                     09653099
096540*          PERFORM 7170-FETCH-NEMP-ACCT-CURSOR                    09654099
096550*          PERFORM 7210-CLOSE-NEMP-ACCT-CURSOR                    09655099
096560*       END-IF                                                    09656099
096570*                                                                 09657099
096580*       IF PS-EDIT-ERROR                                          09658099
096590*BH                                                               09659099
096600*          PERFORM 5000-INITIALIZE-SCREEN                         09660099
096610*          SET PS-NO-EDIT-ERROR TO TRUE                           09661099
096620****       PERFORM 3700-LOG-EMPLOYEE-DELETE                       09662099
096630*       END-IF                                                    09663099
096640                                                                  09664099
096650*       IF PS-NO-EDIT-ERROR                                       09665099
096660*          SET PM-MESSAGE-INDEX TO 22                             09666099
096670*       END-IF                                                    09667099
096680                                                                  09668099
096690*       GO TO 1500-EXIT                                           09669099
096700*    END-IF.                                                      09670099
096710                                                                  09671099
096720*    IF CA-CONFIRMED-UPD                                          09672099
096730*       SET PM-MESSAGE-INDEX TO 29                                09673099
096740*       GO TO 1500-EXIT                                           09674099
096750*    END-IF.                                                      09675099
096760                                                                  09676099
096770*    IF CA-CONFIRMED-ADD                                          09677099
096780*       SET PM-MESSAGE-INDEX TO 26                                09678099
096790*       GO TO 1500-EXIT                                           09679099
096800*    END-IF.                                                      09680099
096810                                                                  09681099
096820*    PERFORM 4300-VERIFY-READ.                                    09682099
096830                                                                  09683099
096840*    IF PS-EDIT-ERROR                                             09684099
096850*       MOVE -1 TO ASSNL                                          09685099
096860*       GO TO 1500-EXIT                                           09686099
096870*    END-IF.                                                      09687099
096880                                                                  09688099
096890*    PERFORM 5500-PROTECT-ATTRIBUTES.                             09689099
096900*    SET PM-MESSAGE-INDEX TO 30.                                  09690099
096910*    SET CA-CONFIRMED-DEL TO TRUE.                                09691099
096920*    SET CA-UNCONFIRMED-UPD TO TRUE.                              09692099
096930*    SET CA-UNCONFIRMED-ADD TO TRUE.                              09693099
096940*----------*                                                      09694099
096950*1500-EXIT.                                                       09695099
096960*----------*                                                      09696099
096970*    EXIT.                                                        09697099
096980                                                                  09698099
096990*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    09699099
097000*      THE SEARCH BY NAME SECTION IS COMMENTED OUT                09700099
097010*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    09701099
097020*----------------------------*                                    09702099
097030*1600-SEARCH-BY-NAME SECTION.                                     09703099
097040*----------------------------*                                    09704099
097050*    MOVE DP015-ASK-BRT-OFF TO BSTRNMA.                           09705099
097060*    PERFORM 5200-INITIALIZE-SEARCH-SCREEN                        09706099
097070*       VARYING PV-SEARCH-PTR FROM 1 BY 1                         09707099
097080*          UNTIL PV-SEARCH-PTR > 14.                              09708099
097090                                                                  09709099
097100*    IF CA-MAIN-SCREEN                                            09710099
097110*       SET CA-SEARCH-SCREEN TO TRUE                              09711099
097120*       IF AENAMEL > 0                                            09712099
097130*          MOVE AENAMEI TO CA-SEARCH-TEXT                         09713099
097140*       ELSE                                                      09714099
097150*          IF AENAMEA = PC-EOF-KEYED                              09715099
097160*             MOVE SPACES TO CA-SEARCH-TEXT                       09716099
097170*          ELSE                                                   09717099
097180*             IF CA-SEARCH-TEXT = SPACES                          09718099
097190*                MOVE CA-EMPLOYEE-NAME TO CA-SEARCH-TEXT          09719099
097200*             END-IF                                              09720099
097210*             MOVE CA-SEARCH-TEXT TO BSRCHO                       09721099
097220*          END-IF                                                 09722099
097230*       END-IF                                                    09723099
097240*                                                                 09724099
097250*       IF AESTATL > 0                                            09725099
097260*          MOVE AESTATI TO CA-EMPLOYEE-STATUS                     09726099
097270*                          BESTATO                                09727099
097280*       ELSE                                                      09728099
097290*          IF AESTATA = PC-EOF-KEYED                              09729099
097300*             MOVE SPACES TO CA-EMPLOYEE-STATUS                   09730099
097310*          ELSE                                                   09731099
097320*             MOVE CA-EMPLOYEE-STATUS TO BESTATO                  09732099
097330*          END-IF                                                 09733099
097340*       END-IF                                                    09734099
097350*    END-IF.                                                      09735099
097360                                                                  09736099
097370*    IF CA-SEARCH-TEXT = SPACES                                   09737099
097380*       MOVE DP015-REVERSE TO BSRCHH                              09738099
097390*       SET PM-MESSAGE-INDEX TO 43                                09739099
097400*       GO TO 1600-EXIT                                           09740099
097410*    END-IF.                                                      09741099
097420                                                                  09742099
097430*    PERFORM 1605-BUILD-SEARCH-STRING.                            09743099
097440                                                                  09744099
097450*    IF CA-EMPLOYEE-STATUS NOT = 'A' AND                          09745099
097460*       CA-EMPLOYEE-STATUS NOT = ' ' AND                          09746099
097470*       CA-EMPLOYEE-STATUS NOT = 'T'                              09747099
097480*       SET PS-EDIT-ERROR TO TRUE                                 09748099
097490*       MOVE -1 TO BESTATL                                        09749099
097500*       MOVE DP015-REVERSE TO BESTATH                             09750099
097510*       SET PM-MESSAGE-INDEX TO 3                                 09751099
097520*       GO TO 1600-EXIT                                           09752099
097530*    END-IF.                                                      09753099
097540                                                                  09754099
097550*    MOVE CA-SEARCH-TEXT TO XST00072-ASSOC-ENTIR-NM.              09755099
097560                                                                  09756099
097570*    INITIALIZE PV-EMP-NM-ROW-STRING.                             09757099
097580*    STRING                                                       09758099
097590*       XST00072-ASSOC-ENTIR-NM DELIMITED BY '  '                 09759099
097600*       PC-SQL-SEARCH-WILD-CARD DELIMITED BY SIZE                 09760099
097610*    INTO PV-EMP-NM-ROW-STRING                                    09761099
097620*    END-STRING.                                                  09762099
097630                                                                  09763099
097640*    IF CA-TERMED-EMPLOYEE-STATUS                                 09764099
097650*       MOVE 'T' TO PV-EMP-STAT-CDE-1                             09765099
097660*       MOVE 'S' TO PV-EMP-STAT-CDE-2                             09766099
097670*       MOVE 'D' TO PV-EMP-STAT-CDE-3                             09767099
097680*       MOVE 'U' TO PV-EMP-STAT-CDE-4                             09768099
097690*       MOVE 'V' TO PV-EMP-STAT-CDE-5                             09769099
097700*       MOVE 'X' TO PV-EMP-STAT-CDE-6                             09770099
097710*    ELSE                                                         09771099
097720*       MOVE 'A' TO PV-EMP-STAT-CDE-1                             09772099
097730*       MOVE 'L' TO PV-EMP-STAT-CDE-2                             09773099
097740*       MOVE 'P' TO PV-EMP-STAT-CDE-3                             09774099
097750*       MOVE 'Q' TO PV-EMP-STAT-CDE-4                             09775099
097760*       MOVE 'R' TO PV-EMP-STAT-CDE-5                             09776099
097770*       MOVE ' ' TO PV-EMP-STAT-CDE-6                             09777099
097780*    END-IF.                                                      09778099
097790                                                                  09779099
097800*    PERFORM 6650-DELETE-SEARCH-QUEUE.                            09780099
097810                                                                  09781099
097820*-->PERFORM A NAME SEARCH ON THE EMPLOYEE VIEW.                   09782099
097830*    PERFORM 7220-OPEN-SEARCH-VIEW-NM-CSR.                        09783099
097840                                                                  09784099
097850*-->FETCH THE RESULTS FROM THE SEARCH AND INSERT THEM             09785099
097860*-->INTO THE GLOBAL TEMPORARY TABLE (GTT).                        09786099
097870*    INITIALIZE PS-NO-MORE-ROWS-SW.                               09787099
097880*    PERFORM 7280-FETCH-SEARCH-VIEW-NM-CSR                        09788099
097890*       VARYING PV-SEARCH-PTR FROM 1 BY 1                         09789099
097900*          UNTIL PS-NO-MORE-ROWS.                                 09790099
097910*    IF ART00001-LOC-NBR = 900                                    09791099
097920*       MOVE 0880 TO PV-STORE-NBR-4                               09792099
097930*    ELSE                                                         09793099
097940*       MOVE ART00001-LOC-NBR TO PV-STORE-NBR-4                   09794099
097950*    END-IF                                                       09795099
097960*    MOVE PV-STORE-NBR        TO PV-STR-NBR                       09796099
097970*    PERFORM 8450-INSERT-GLOBAL-TEMP-ROW                          09797099
097980                                                                  09798099
097990*-->AFTER THE RESULTS ARE LOADED INTO THE GTT, CLOSE THE CURSOR.  09799099
098000**** PERFORM 7340-CLOSE-SEARCH-VIEW-NM-CSR.                       09800099
098010                                                                  09801099
098020*-->OPEN THE UNION CURSOR TO SEARCH THE NON-EMP DISCOUNT TABLE AND09802099
098030*-->TO COMBINE THE RESULTS WITH CONTENTS OF THE GTT.              09803099
098040*    PERFORM 7230-OPEN-SEARCH-UNION-NM-CSR.                       09804099
098050                                                                  09805099
098060*-->FETCH THE ROWS OF THE UNION_NM CURSOR INTO A TEMPORARY        09806099
098070*-->STORAGE QUEUE.                                                09807099
098080*    INITIALIZE PS-NO-MORE-ROWS-SW.                               09808099
098090*    PERFORM 7290-FETCH-SEARCH-UNION-NM-CSR                       09809099
098100*       VARYING PV-SEARCH-PTR FROM 1 BY 1                         09810099
098110*          UNTIL PS-NO-MORE-ROWS.                                 09811099
098120                                                                  09812099
098130*    SUBTRACT 2 FROM PV-SEARCH-PTR END-SUBTRACT.                  09813099
098140*    MOVE PV-SEARCH-PTR TO PM-ROWS-RETURNED.                      09814099
098150*    SET PM-MESSAGE-INDEX TO 47.                                  09815099
098160                                                                  09816099
098170*-->AFTER THE CONTENTS OF THE CURSOR ARE SAVED, CLOSE THE CURSOR. 09817099
098180*    PERFORM 7350-CLOSE-SEARCH-UNION-NM-CSR.                      09818099
098190                                                                  09819099
098200*    INITIALIZE CA-FETCH-COUNTER.                                 09820099
098210                                                                  09821099
098220*    PERFORM 6625-READ-SEARCH-QUEUE                               09822099
098230*       VARYING PV-SEARCH-PTR FROM 1 BY 1                         09823099
098240*          UNTIL PV-SEARCH-PTR > 14 OR                            09824099
098250*                PS-READQ-EOF.                                    09825099
098260                                                                  09826099
098270*    IF PS-READQ-EOF                                              09827099
098280*       SET CA-DISABLE-UP   TO TRUE                               09828099
098290*       SET CA-DISABLE-DOWN TO TRUE                               09829099
098300*       MOVE DP015-ASK-DRK-OFF TO BPF7A                           09830099
098310*       MOVE DP015-ASK-DRK-OFF TO BPF8A                           09831099
098320*    ELSE                                                         09832099
098330*       SET CA-DISABLE-UP   TO TRUE                               09833099
098340*       SET CA-ENABLE-DOWN  TO TRUE                               09834099
098350*       MOVE DP015-ASK-BRT-OFF TO BPF8A                           09835099
098360*    END-IF.                                                      09836099
098370                                                                  09837099
098380*    PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         09838099
098390*       VARYING PV-SEARCH-PTR FROM 1 BY 1                         09839099
098400*          UNTIL PV-SEARCH-PTR > 14.                              09840099
098410*----------*                                                      09841099
098420*1600-EXIT.                                                       09842099
098430*----------*                                                      09843099
098440*    EXIT.                                                        09844099
098450                                                                  09845099
098460*---------------------------------*                               09846099
098470 1605-BUILD-SEARCH-STRING SECTION.                                09847099
098480*---------------------------------*                               09848099
098490     IF AENAMEL > ZERO OR                                         09849099
098500        BSRCHL > ZERO                                             09850099
098510        UNSTRING CA-SEARCH-TEXT                                   09851099
098520           DELIMITED BY SPACE                                     09852099
098530           INTO PV-NAME-WORK-FLD-1                                09853099
098540                PV-NAME-WORK-FLD-3                                09854099
098550        END-UNSTRING                                              09855099
098560     ELSE                                                         09856099
098570        GO TO 1605-EXIT                                           09857099
098580     END-IF.                                                      09858099
098590                                                                  09859099
098600     MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-1(1:1))            09860099
098610                           TO PV-NAME-WORK-FLD-1-UPPER.           09861099
098620     MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-1(2:39))           09862099
098630                           TO PV-NAME-WORK-FLD-1-LOWER.           09863099
098640                                                                  09864099
098650     IF PV-NAME-WORK-FLD-3 = SPACES                               09865099
098660        MOVE PV-NAME-WORK-FLD-1-GROUP TO CA-SEARCH-TEXT           09866099
098670                                         BSRCHO                   09867099
098680     ELSE                                                         09868099
098690        MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-3(1:1))         09869099
098700                              TO PV-NAME-WORK-FLD-3-UPPER         09870099
098710        MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-3(2:39))        09871099
098720                              TO PV-NAME-WORK-FLD-3-LOWER         09872099
098730                                                                  09873099
098740        INITIALIZE CA-SEARCH-TEXT                                 09874099
098750        STRING                                                    09875099
098760           PV-NAME-WORK-FLD-3-GROUP DELIMITED BY '  '             09876099
098770           ','                      DELIMITED BY SIZE             09877099
098780           PV-NAME-WORK-FLD-1-GROUP DELIMITED BY SPACE            09878099
098790        INTO CA-SEARCH-TEXT                                       09879099
098800        END-STRING                                                09880099
098810        MOVE CA-SEARCH-TEXT TO BSRCHO                             09881099
098820     END-IF.                                                      09882099
098830*----------*                                                      09883099
098840 1605-EXIT.                                                       09884099
098850*----------*                                                      09885099
098860     EXIT.                                                        09886099
098870                                                                  09887099
098880*-----------------------------*                                   09888099
098890 1650-SEARCH-BY-STORE SECTION.                                    09889099
098900*-----------------------------*                                   09890099
098910     MOVE DP015-ASK-DRK-OFF TO BSTRNMA.                           09891099
098920     PERFORM 5200-INITIALIZE-SEARCH-SCREEN                        09892099
098930        VARYING PV-SEARCH-PTR FROM 1 BY 1                         09893099
098940           UNTIL PV-SEARCH-PTR > 14.                              09894099
098950                                                                  09895099
098960     IF CA-MAIN-SCREEN                                            09896099
098970        SET CA-SEARCH-SCREEN TO TRUE                              09897099
098980        IF ASTOREL > 0                                            09898099
098990           MOVE ASTOREI TO CA-SEARCH-TEXT                         09899099
099000        ELSE                                                      09900099
099010           IF ASTOREA = PC-EOF-KEYED                              09901099
099020              MOVE SPACES TO CA-SEARCH-TEXT                       09902099
099030           ELSE                                                   09903099
099040              MOVE CA-STORE-NUMBER-X TO CA-SEARCH-TEXT            09904099
099050           END-IF                                                 09905099
099060        END-IF                                                    09906099
099070                                                                  09907099
099080        IF AESTATL > 0                                            09908099
099090           MOVE AESTATI TO CA-EMPLOYEE-STATUS                     09909099
099100                           BESTATO                                09910099
099110        ELSE                                                      09911099
099120           IF AESTATA = PC-EOF-KEYED                              09912099
099130              MOVE SPACES TO CA-EMPLOYEE-STATUS                   09913099
099140           ELSE                                                   09914099
099150              MOVE CA-EMPLOYEE-STATUS TO BESTATO                  09915099
099160           END-IF                                                 09916099
099170        END-IF                                                    09917099
099180     END-IF.                                                      09918099
099190                                                                  09919099
099200     IF CA-SEARCH-TEXT = SPACES                                   09920099
099210        MOVE DP015-REVERSE TO BSRCHH                              09921099
099220        SET PM-MESSAGE-INDEX TO 46                                09922099
099230        GO TO 1650-EXIT                                           09923099
099240     END-IF.                                                      09924099
099250                                                                  09925099
099260     MOVE CA-SEARCH-TEXT TO CA-STORE-NUMBER-X                     09926099
099270                            BSRCHO.                               09927099
099280                                                                  09928099
099290     IF CA-EMPLOYEE-STATUS NOT = 'A' AND                          09929099
099300        CA-EMPLOYEE-STATUS NOT = ' ' AND                          09930099
099310        CA-EMPLOYEE-STATUS NOT = 'T'                              09931099
099320        SET PS-EDIT-ERROR TO TRUE                                 09932099
099330        MOVE -1 TO BESTATL                                        09933099
099340        MOVE DP015-REVERSE TO BESTATH                             09934099
099350        SET PM-MESSAGE-INDEX TO 3                                 09935099
099360        GO TO 1650-EXIT                                           09936099
099370     END-IF.                                                      09937099
099380                                                                  09938099
099390     IF CA-STORE-NUMBER-X = '0880' OR '880'                       09939099
099400        MOVE "0900"            TO ART00001-LOC-NBR                09940099
099410******  MOVE CA-STORE-NUMBER-X TO ART00000-STR-NBR                09941099
099420     ELSE                                                         09942099
099430        PERFORM 4050-EDIT-STORE-NUMBER                            09943099
099440        IF PS-NO-EDIT-ERROR                                       09944099
099450           MOVE XST00001-LOC-NBR TO BSRCHO                        09945099
099460                                    ART00001-LOC-NBR              09946099
099470                                    ART00002-STR-NBR              09947099
099480        END-IF                                                    09948099
099490     END-IF.                                                      09949099
099500                                                                  09950099
099510     IF PS-EDIT-ERROR                                             09951099
099520        PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                      09952099
099530           VARYING PV-SEARCH-PTR FROM 1 BY 1                      09953099
099540              UNTIL PV-SEARCH-PTR > 14                            09954099
099550        GO TO 1650-EXIT                                           09955099
099560     END-IF.                                                      09956099
099570                                                                  09957099
099580     IF CA-TERMED-EMPLOYEE-STATUS                                 09958099
099590        MOVE 'T' TO PV-EMP-STAT-CDE-1                             09959099
099600        MOVE 'S' TO PV-EMP-STAT-CDE-2                             09960099
099610        MOVE 'D' TO PV-EMP-STAT-CDE-3                             09961099
099620        MOVE 'U' TO PV-EMP-STAT-CDE-4                             09962099
099630        MOVE 'V' TO PV-EMP-STAT-CDE-5                             09963099
099640        MOVE 'X' TO PV-EMP-STAT-CDE-6                             09964099
099650     ELSE                                                         09965099
099660        MOVE 'A' TO PV-EMP-STAT-CDE-1                             09966099
099670        MOVE 'L' TO PV-EMP-STAT-CDE-2                             09967099
099680        MOVE 'P' TO PV-EMP-STAT-CDE-3                             09968099
099690        MOVE 'Q' TO PV-EMP-STAT-CDE-4                             09969099
099700        MOVE 'R' TO PV-EMP-STAT-CDE-5                             09970099
099710        MOVE ' ' TO PV-EMP-STAT-CDE-6                             09971099
099720     END-IF.                                                      09972099
099730                                                                  09973099
099740     PERFORM 6650-DELETE-SEARCH-QUEUE.                            09974099
099750                                                                  09975099
099760*-->PERFORM A STORE SEARCH ON THE ART_EMP_DISC TABLE              09976099
099770     PERFORM 7240-OPEN-SEARCH-VIEW-STR-CSR.                       09977099
099780                                                                  09978099
099790                                                                  09979099
099800*-->FETCH THE RESULTS FROM THE SEARCH AND INSERT THEM             09980099
099810*-->INTO THE GLOBAL TEMPORARY TABLE (GTT).                        09981099
099820     INITIALIZE PS-NO-MORE-ROWS-SW.                               09982099
099850     INITIALIZE ART00001-SSN-NBR                                  09985099
099860                ART00001-EMP-NM                                   09986099
099870                PV-STR-NBR                                        09987099
099880     PERFORM 7300-FETCH-SEARCH-VIEW-STR-CSR                       09988099
099890        VARYING PV-SEARCH-PTR FROM 1 BY 1                         09989099
099900           UNTIL PS-NO-MORE-ROWS.                                 09990099
099920                                                                  09992099
099930*-->AFTER THE RESULTS ARE LOADED INTO THE GTT, CLOSE THE CURSOR.  09993099
099940     PERFORM 7360-CLOSE-SEARCH-VIEW-STR-CSR.                      09994099
099950*                                                                 09995099
099960*-->OPEN THE CURSOR JUST TO WRITE OUT WHATS ALREADY IN THERE      09996099
099961*-->FROM THE GTT TABLE                                            09996199
099962     PERFORM 7250-OPEN-SEARCH-UNION-STR-CSR.                      09996299
099963                                                                  09996399
099964*-->FETCH THE ROWS OF THE UNION_SSN CURSOR INTO A TEMPORARY       09996499
099965*-->STORAGE QUEUE.                                                09996599
099966     INITIALIZE PS-NO-MORE-ROWS-SW.                               09996699
099967     PERFORM 7310-FETCH-SERCH-UNION-STR-CSR                       09996799
099968        VARYING PV-SEARCH-PTR FROM 1 BY 1                         09996899
099969           UNTIL PS-NO-MORE-ROWS.                                 09996999
099970                                                                  09997099
099980     SUBTRACT 2 FROM PV-SEARCH-PTR END-SUBTRACT.                  09998099
099990     MOVE PV-SEARCH-PTR TO PM-ROWS-RETURNED.                      09999099
100000     SET PM-MESSAGE-INDEX TO 47.                                  10000099
100010*-->AFTER THE CONTENTS OF THE CURSOR ARE SAVED, CLOSE THE CURSOR. 10001099
100020     PERFORM 7370-CLOSE-SERCH-UNION-STR-CSR.                      10002099
100030                                                                  10003099
100040     INITIALIZE CA-FETCH-COUNTER.                                 10004099
100050                                                                  10005099
100060     PERFORM 6625-READ-SEARCH-QUEUE                               10006099
100070        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10007099
100080           UNTIL PV-SEARCH-PTR > 14 OR                            10008099
100090                 PS-READQ-EOF.                                    10009099
100100                                                                  10010099
100110     IF PS-READQ-EOF                                              10011099
100120        SET CA-DISABLE-UP   TO TRUE                               10012099
100130        SET CA-DISABLE-DOWN TO TRUE                               10013099
100140        MOVE DP015-ASK-DRK-OFF TO BPF7A                           10014099
100150        MOVE DP015-ASK-DRK-OFF TO BPF8A                           10015099
100160     ELSE                                                         10016099
100170        SET CA-DISABLE-UP   TO TRUE                               10017099
100180        SET CA-ENABLE-DOWN  TO TRUE                               10018099
100190        MOVE DP015-ASK-BRT-OFF TO BPF8A                           10019099
100200     END-IF.                                                      10020099
100210                                                                  10021099
100220     PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         10022099
100230        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10023099
100240           UNTIL PV-SEARCH-PTR > 14.                              10024099
100250*----------*                                                      10025099
100260 1650-EXIT.                                                       10026099
100270*----------*                                                      10027099
100280     EXIT.                                                        10028099
100290                                                                  10029099
100300*---------------------------*                                     10030099
100310 1675-SEARCH-BY-SSN SECTION.                                      10031099
100320*---------------------------*                                     10032099
100330     MOVE DP015-ASK-BRT-OFF TO BSTRNMA.                           10033099
100340     PERFORM 5200-INITIALIZE-SEARCH-SCREEN                        10034099
100350        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10035099
100360           UNTIL PV-SEARCH-PTR > 14.                              10036099
100370                                                                  10037099
100380     IF CA-MAIN-SCREEN                                            10038099
100390        SET CA-SEARCH-SCREEN TO TRUE                              10039099
100400        IF ASSNL > 0                                              10040099
100410           MOVE ASSNI TO CA-SEARCH-TEXT                           10041099
100420        ELSE                                                      10042099
100430           IF ASSNA = PC-EOF-KEYED                                10043099
100440              INITIALIZE CA-SEARCH-TEXT                           10044099
100450           ELSE                                                   10045099
100460              MOVE CA-SOCIAL-SECURITY-NUMBER-X TO CA-SEARCH-TEXT  10046099
100470           END-IF                                                 10047099
100480        END-IF                                                    10048099
100490                                                                  10049099
100500        IF AESTATL > 0                                            10050099
100510           MOVE AESTATI TO CA-EMPLOYEE-STATUS                     10051099
100520                           BESTATO                                10052099
100530        ELSE                                                      10053099
100540           IF AESTATA = PC-EOF-KEYED                              10054099
100550              MOVE SPACES TO CA-EMPLOYEE-STATUS                   10055099
100560           ELSE                                                   10056099
100570              MOVE CA-EMPLOYEE-STATUS TO BESTATO                  10057099
100580           END-IF                                                 10058099
100590        END-IF                                                    10059099
100600     END-IF.                                                      10060099
100610                                                                  10061099
100620     IF CA-SEARCH-TEXT = SPACES                                   10062099
100630        MOVE DP015-REVERSE TO BSRCHH                              10063099
100640        SET PM-MESSAGE-INDEX TO 43                                10064099
100650        GO TO 1675-EXIT                                           10065099
100660     END-IF.                                                      10066099
100670                                                                  10067099
100680     MOVE CA-SEARCH-TEXT TO CA-SOCIAL-SECURITY-NUMBER-X           10068099
100690                            BSRCHO.                               10069099
100700     IF CA-SSN-ACCESS-NO                                          10070099
100710        MOVE 'XXXXX'        TO BSRCHO(1:5)                        10071099
100720     END-IF.                                                      10072099
100730                                                                  10073099
100740     IF CA-EMPLOYEE-STATUS NOT = 'A' AND                          10074099
100750        CA-EMPLOYEE-STATUS NOT = ' ' AND                          10075099
100760        CA-EMPLOYEE-STATUS NOT = 'T'                              10076099
100770        SET PS-EDIT-ERROR TO TRUE                                 10077099
100780        MOVE -1 TO BESTATL                                        10078099
100790        MOVE DP015-REVERSE TO BESTATH                             10079099
100800        SET PM-MESSAGE-INDEX TO 3                                 10080099
100810        GO TO 1675-EXIT                                           10081099
100820     END-IF.                                                      10082099
100830                                                                  10083099
100840     MOVE CA-SOCIAL-SECURITY-NUMBER-X TO DP010I-UNEDITED-FIELD.   10084099
100850     MOVE 9 TO DP010I-MAXIMUM-DIGITS.                             10085099
100860     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           10086099
100870     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     10087099
100881     CALL DP010I-NUMERIC-EDIT-ROUTINE                             10088199
100882                         USING DP010I-NUMERIC-EDIT-AREA           10088299
100890                                                                  10089099
100900     IF DP010I-ERROR-DETECTED                                     10090099
100910        MOVE DP015-REVERSE TO BSRCHH                              10091099
100920        SET PS-EDIT-ERROR TO TRUE                                 10092099
100930        MOVE -1 TO BSRCHL                                         10093099
100940        SET PM-MESSAGE-INDEX TO 7                                 10094099
100950        GO TO 1675-EXIT                                           10095099
100960     END-IF.                                                      10096099
100970                                                                  10097099
100980     MOVE CA-SOCIAL-SECURITY-NUMBER-X TO ART00001-SSN-NBR.        10098099
100990                                                                  10099099
101000     IF CA-TERMED-EMPLOYEE-STATUS                                 10100099
101010        MOVE 'T' TO PV-EMP-STAT-CDE-1                             10101099
101020        MOVE 'S' TO PV-EMP-STAT-CDE-2                             10102099
101030        MOVE 'D' TO PV-EMP-STAT-CDE-3                             10103099
101040        MOVE 'U' TO PV-EMP-STAT-CDE-4                             10104099
101050        MOVE 'V' TO PV-EMP-STAT-CDE-5                             10105099
101060        MOVE 'X' TO PV-EMP-STAT-CDE-6                             10106099
101070     ELSE                                                         10107099
101080        MOVE 'A' TO PV-EMP-STAT-CDE-1                             10108099
101090        MOVE 'L' TO PV-EMP-STAT-CDE-2                             10109099
101100        MOVE 'P' TO PV-EMP-STAT-CDE-3                             10110099
101110        MOVE 'Q' TO PV-EMP-STAT-CDE-4                             10111099
101120        MOVE 'R' TO PV-EMP-STAT-CDE-5                             10112099
101130        MOVE ' ' TO PV-EMP-STAT-CDE-6                             10113099
101140     END-IF.                                                      10114099
101150                                                                  10115099
101160     PERFORM 6650-DELETE-SEARCH-QUEUE.                            10116099
101170                                                                  10117099
101180     PERFORM 7020-TOKENIZE-SSN.                                   10118099
101190                                                                  10119099
101200*-->PERFORM AN SSN SEARCH ON THE EMPLOYEE VIEW.                   10120099
101210     PERFORM 7260-OPEN-SEARCH-VIEW-SSN-CSR.                       10121099
101220                                                                  10122099
101230*-->FETCH THE RESULTS FROM THE SEARCH AND INSERT THEM             10123099
101240*-->INTO THE GLOBAL TEMPORARY TABLE (GTT).                        10124099
101250     INITIALIZE PS-NO-MORE-ROWS-SW.                               10125099
101270     INITIALIZE ART00001-SSN-NBR                                  10127099
101280                ART00001-EMP-NM                                   10128099
101290                PV-STR-NBR.                                       10129099
101300     PERFORM 7320-FETCH-SEARCH-VIEW-SSN-CSR                       10130099
101310        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10131099
101320           UNTIL PS-NO-MORE-ROWS.                                 10132099
101330                                                                  10133099
101340*-->AFTER THE RESULTS ARE LOADED INTO THE GTT, CLOSE THE CURSOR.  10134099
101350*    PERFORM 7380-CLOSE-SEARCH-VIEW-SSN-CSR.                      10135099
101360                                                                  10136099
101370*-->OPEN THE CURSOR JUST TO WRITE OUT WHATS ALREADY IN THERE      10137099
101380*-->FROM THE GTT TABLE                                            10138099
101390     PERFORM 7270-OPEN-SEARCH-UNION-SSN-CSR.                      10139099
101400                                                                  10140099
101410*-->FETCH THE ROWS OF THE UNION_SSN CURSOR INTO A TEMPORARY       10141099
101420*-->STORAGE QUEUE.                                                10142099
101430     INITIALIZE PS-NO-MORE-ROWS-SW.                               10143099
101440     PERFORM 7330-FETCH-SERCH-UNION-SSN-CSR                       10144099
101450        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10145099
101460           UNTIL PS-NO-MORE-ROWS.                                 10146099
101470                                                                  10147099
101480     SUBTRACT 2 FROM PV-SEARCH-PTR END-SUBTRACT.                  10148099
101490     MOVE PV-SEARCH-PTR TO PM-ROWS-RETURNED.                      10149099
101500     SET PM-MESSAGE-INDEX TO 47.                                  10150099
101600                                                                  10160099
101610*-->AFTER THE CONTENTS OF THE CURSOR ARE SAVED, CLOSE THE CURSOR. 10161099
101620     PERFORM 7390-CLOSE-SERCH-UNION-SSN-CSR.                      10162099
101630                                                                  10163099
101640     INITIALIZE CA-FETCH-COUNTER.                                 10164099
101650                                                                  10165099
101660     PERFORM 6625-READ-SEARCH-QUEUE                               10166099
101670        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10167099
101680           UNTIL PV-SEARCH-PTR > 14 OR                            10168099
101690                 PS-READQ-EOF.                                    10169099
101700                                                                  10170099
101710     IF PS-READQ-EOF                                              10171099
101720        SET CA-DISABLE-UP   TO TRUE                               10172099
101730        SET CA-DISABLE-DOWN TO TRUE                               10173099
101740        MOVE DP015-ASK-DRK-OFF TO BPF7A                           10174099
101750        MOVE DP015-ASK-DRK-OFF TO BPF8A                           10175099
101760     ELSE                                                         10176099
101770        SET CA-DISABLE-UP   TO TRUE                               10177099
101780        SET CA-ENABLE-DOWN  TO TRUE                               10178099
101790        MOVE DP015-ASK-BRT-OFF TO BPF8A                           10179099
101800     END-IF.                                                      10180099
101810                                                                  10181099
101820     PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         10182099
101830        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10183099
101840           UNTIL PV-SEARCH-PTR > 14.                              10184099
101850*----------*                                                      10185099
101860 1675-EXIT.                                                       10186099
101870*----------*                                                      10187099
101880     EXIT.                                                        10188099
101890                                                                  10189099
101900*------------------------------*                                  10190099
101910 1700-SCROLL-UP-SCREEN SECTION.                                   10191099
101920*------------------------------*                                  10192099
101930     SUBTRACT 28 FROM CA-FETCH-COUNTER END-SUBTRACT.              10193099
101940                                                                  10194099
101950     PERFORM 6625-READ-SEARCH-QUEUE                               10195099
101960        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10196099
101970           UNTIL PV-SEARCH-PTR > 14 OR                            10197099
101980                 PS-READQ-EOF.                                    10198099
101990                                                                  10199099
102000     IF CA-FETCH-COUNTER = 14                                     10200099
102010        SET CA-DISABLE-UP TO TRUE                                 10201099
102020        MOVE DP015-ASK-DRK-OFF TO BPF7A                           10202099
102030     END-IF.                                                      10203099
102040                                                                  10204099
102050     SET CA-ENABLE-DOWN TO TRUE.                                  10205099
102060     MOVE DP015-ASK-BRT-OFF TO BPF8A.                             10206099
102070                                                                  10207099
102080     PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         10208099
102090        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10209099
102100           UNTIL PV-SEARCH-PTR > 14.                              10210099
102110*----------*                                                      10211099
102120 1700-EXIT.                                                       10212099
102130*----------*                                                      10213099
102140     EXIT.                                                        10214099
102150                                                                  10215099
102160*--------------------------------*                                10216099
102170 1725-SCROLL-DOWN-SCREEN SECTION.                                 10217099
102180*--------------------------------*                                10218099
102190     PERFORM 6625-READ-SEARCH-QUEUE                               10219099
102200        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10220099
102210           UNTIL PV-SEARCH-PTR > 14 OR                            10221099
102220                 PS-READQ-EOF.                                    10222099
102230                                                                  10223099
102240     SET CA-ENABLE-UP TO TRUE.                                    10224099
102250     MOVE DP015-ASK-BRT-OFF TO BPF7A.                             10225099
102260                                                                  10226099
102270     IF PS-READQ-EOF                                              10227099
102280        SUBTRACT PV-SEARCH-PTR FROM 14                            10228099
102290            GIVING PV-EMPTY-FIELD-CNT END-SUBTRACT                10229099
102300        ADD PV-EMPTY-FIELD-CNT TO CA-FETCH-COUNTER END-ADD        10230099
102310        ADD 1 TO CA-FETCH-COUNTER END-ADD                         10231099
102320        SET CA-DISABLE-DOWN TO TRUE                               10232099
102330        MOVE DP015-ASK-DRK-OFF TO BPF8A                           10233099
102340     ELSE                                                         10234099
102350        SET CA-ENABLE-DOWN TO TRUE                                10235099
102360        MOVE DP015-ASK-BRT-OFF TO BPF8A                           10236099
102370     END-IF.                                                      10237099
102380                                                                  10238099
102390     PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         10239099
102400        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10240099
102410           UNTIL PV-SEARCH-PTR > 14.                              10241099
102420*----------*                                                      10242099
102430 1725-EXIT.                                                       10243099
102440*----------*                                                      10244099
102450     EXIT.                                                        10245099
102460                                                                  10246099
102470*---------------------------------*                               10247099
102480 1750-DISPLAY-SAME-SCREEN SECTION.                                10248099
102490*---------------------------------*                               10249099
102500     IF CA-FETCH-COUNTER < 14                                     10250099
102510        MOVE 0 TO CA-FETCH-COUNTER                                10251099
102520     ELSE                                                         10252099
102530        SUBTRACT 14 FROM CA-FETCH-COUNTER END-SUBTRACT            10253099
102540     END-IF.                                                      10254099
102550                                                                  10255099
102560     PERFORM 6625-READ-SEARCH-QUEUE                               10256099
102570        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10257099
102580           UNTIL PV-SEARCH-PTR > 14 OR                            10258099
102590                 PS-READQ-EOF.                                    10259099
102600                                                                  10260099
102610     IF PS-READQ-EOF                                              10261099
102620        SUBTRACT PV-SEARCH-PTR FROM 14                            10262099
102630            GIVING PV-EMPTY-FIELD-CNT END-SUBTRACT                10263099
102640        ADD PV-EMPTY-FIELD-CNT TO CA-FETCH-COUNTER END-ADD        10264099
102650        ADD 1 TO CA-FETCH-COUNTER END-ADD                         10265099
102660     END-IF.                                                      10266099
102670                                                                  10267099
102680     PERFORM 2600-MOVE-SRCH-SCREEN-FIELDS                         10268099
102690        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10269099
102700           UNTIL PV-SEARCH-PTR > 14.                              10270099
102710*----------*                                                      10271099
102720 1750-EXIT.                                                       10272099
102730*----------*                                                      10273099
102740     EXIT.                                                        10274099
102750                                                                  10275099
102760*-------------------------------*                                 10276099
102770 1800-PROCESS-SELECTION SECTION.                                  10277099
102780*-------------------------------*                                 10278099
102790     PERFORM                                                      10279099
102800        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10280099
102810           UNTIL PV-SEARCH-PTR > 14                               10281099
102820        MOVE DP015-UNDERLINE TO BSELH (PV-SEARCH-PTR)             10282099
102830     END-PERFORM.                                                 10283099
102840     SET PS-NO-EDIT-ERROR TO TRUE.                                10284099
102850                                                                  10285099
102860     INITIALIZE PS-SELECTION-SW.                                  10286099
102870     PERFORM 4800-GET-SELECTION                                   10287099
102880        VARYING PV-SEARCH-PTR FROM 1 BY 1                         10288099
102890           UNTIL PV-SEARCH-PTR > 14.                              10289099
102900                                                                  10290099
102910     IF PS-SELECTION-MADE                                         10291099
102920        IF PS-NO-EDIT-ERROR                                       10292099
102930           MOVE 1 TO PV-SEARCH-PTR                                10293099
102940           PERFORM 6625-READ-SEARCH-QUEUE                         10294099
102950           SET CA-MAIN-SCREEN TO TRUE                             10295099
102960           PERFORM 5000-INITIALIZE-SCREEN                         10296099
102970           MOVE PV-SSN-NBR-ROW (1) TO ASSNI                       10297099
102980           MOVE 1                  TO ASSNL                       10298099
102990        END-IF                                                    10299099
103000     ELSE                                                         10300099
103010        MOVE -1 TO BSRCHL                                         10301099
103020        SET PS-EDIT-ERROR TO TRUE                                 10302099
103030        SET PM-MESSAGE-INDEX TO 40                                10303099
103040     END-IF.                                                      10304099
103050*----------*                                                      10305099
103060 1800-EXIT.                                                       10306099
103070*----------*                                                      10307099
103080     EXIT.                                                        10308099
103090                                                                  10309099
103100*----------------------------------*                              10310099
103110 2000-MOVE-ART-TO-SCRN SECTION.                                   10311099
103120*----------------------------------*                              10312099
103130     MOVE ART00001-EMP-ID    TO CA-EMPLOYEE-ID.                   10313099
103140     MOVE ART00001-SSN-NBR   TO PV-SSN-NUMBER.                    10314099
103150     IF CA-SSN-ACCESS-YES                                         10315099
103160        PERFORM 6900-DETOKEN-SSN                                  10316099
103170        MOVE PV-SSN-NUMBER   TO ASSNO                             10317099
103180                                CA-SOCIAL-SECURITY-NUMBER-X       10318099
103190     ELSE                                                         10319099
103200        MOVE 'XXXXX'         TO PV-SSN-NUMBER(1:5)                10320099
103210        MOVE PV-SSN-NUMBER   TO ASSNO                             10321099
103220                                CA-SOCIAL-SECURITY-NUMBER-X       10322099
103230     END-IF.                                                      10323099
103240     IF ART00001-EMP-NM         = SPACES                          10324099
103250        MOVE ART00001-EMP-NM         TO AENAMEO                   10325099
103260                                        CA-EMPLOYEE-NAME          10326099
103270     ELSE                                                         10327099
103280         MOVE ART00001-EMP-NM         TO PV-EMP-NM-ENC            10328099
103290         PERFORM 6910-BASE64-BINARY                               10329099
103300         PERFORM 6920-DECRYPT-EMPNM                               10330099
103320         PERFORM 6930-ASCII-EBCDIC                                10332099
103330         MOVE DP053-OUTPUT-FIELD      TO AENAMEO                  10333099
103340                                         CA-EMPLOYEE-NAME         10334099
103350     END-IF                                                       10335099
103360     MOVE ART00001-LOC-NBR   TO ASTOREO                           10336099
103370                                CA-STORE-NUMBER-X.                10337099
103380     MOVE ART00001-EMP-STAT-CDE  TO AESTATO                       10338099
103390                                CA-EMPLOYEE-STATUS.               10339099
103400     MOVE ART00001-EMP-TYP-CDE  TO AECODEO                        10340099
103410                                CA-CRS-EMPLOYEE-CODE.             10341099
103420*PREFILL DISCOUNT STATUS FIELD                                    10342099
103430     MOVE 'R'                  TO ADSTATO                         10343099
103440                                  CA-DISCOUNT-STATUS.             10344099
103450                                                                  10345099
103460     IF IND-ART00001-DISC-DTE = -1                                10346099
103470        MOVE SPACES TO PV-SQL-DATE-GROUP                          10347099
103480     ELSE                                                         10348099
103490        MOVE ART00001-DISC-DTE TO PV-SQL-DATE-GROUP               10349099
103500     END-IF.                                                      10350099
103510                                                                  10351099
103520     MOVE PV-SQL-DD          TO ADTDEFDO                          10352099
103530                                CA-DATE-DISC-EFF-DD.              10353099
103540     MOVE PV-SQL-MM          TO ADTDEFMO                          10354099
103550                                CA-DATE-DISC-EFF-MM.              10355099
103560     MOVE PV-SQL-CCYY        TO ADTDEFYO                          10356099
103570                                CA-DATE-DISC-EFF-CCYY.            10357099
103571                                                                  10357199
103572     IF IND-ART00001-TERM-DTE      = -1                           10357299
103573        MOVE SPACES TO PV-SQL-DATE-GROUP                          10357399
103574     ELSE                                                         10357499
103575        MOVE ART00001-TERM-DTE      TO PV-SQL-DATE-GROUP          10357599
103576     END-IF.                                                      10357699
103577                                                                  10357799
103578     MOVE PV-SQL-DD          TO ADTTEFDO                          10357899
103579                                CA-DATE-TERM-EFF-DD.              10357999
103580     MOVE PV-SQL-MM          TO ADTTEFMO                          10358099
103590                                CA-DATE-TERM-EFF-MM.              10359099
103600     MOVE PV-SQL-CCYY        TO ADTTEFYO                          10360099
103610                                CA-DATE-TERM-EFF-CCYY.            10361099
103620*----------*                                                      10362099
103630 2000-EXIT.                                                       10363099
103640*----------*                                                      10364099
103650     EXIT.                                                        10365099
103660                                                                  10366099
103670*-----------------------------------*                             10367099
103680 2100-MOVE-EMP-DISC-TO-SCRN SECTION.                              10368099
103690*-----------------------------------*                             10369099
103700     IF ART00001-ACCT-NBR = ZEROES                                10370099
103710        MOVE SPACES TO AACCTO                                     10371099
103720                       CA-ACCOUNT-NUMBER-X                        10372099
103730     ELSE                                                         10373099
103740        IF CA-ACCT-ACCESS-YES                                     10374099
103750           MOVE ART00001-ACCT-NBR TO PV-ACCOUNT-NBR-10            10375099
103760           PERFORM 6940-DETOKEN-ACCT                              10376099
103770           MOVE PV-ACCOUNT-NBR-10 TO AACCTO                       10377099
103780           MOVE PV-ACCOUNT-NBR-10 TO CA-ACCOUNT-NUMBER-X          10378099
103790        ELSE                                                      10379099
103800           MOVE ART00001-ACCT-NBR TO AACCTO                       10380099
103810           MOVE 'XXXXXXXX'        TO AACCTO(1:8)                  10381099
103820           MOVE ART00001-ACCT-NBR TO CA-ACCOUNT-NUMBER-X          10382099
103830        END-IF                                                    10383099
103840     END-IF.                                                      10384099
103850                                                                  10385099
103860     MOVE ART00001-DISC-STAT-CDE TO ADSTATO                       10386099
103870                                    CA-DISCOUNT-STATUS.           10387099
103880                                                                  10388099
103890     MOVE SPACES TO ANOTES1O                                      10389099
103900                    ANOTES2O                                      10390099
103910                    CA-ACCOUNT-NOTES-1                            10391099
103920                    CA-ACCOUNT-NOTES-2.                           10392099
103930                                                                  10393099
103940     IF IND-ART00001-CMNT-TXT = 0                                 10394099
103950        IF ART00001-CMNT-TXT-LEN > 40                             10395099
103960           MOVE ART00001-CMNT-TXT-TEXT(1:40) TO ANOTES1O          10396099
103970                                               CA-ACCOUNT-NOTES-1 10397099
103980           SUBTRACT 40 FROM ART00001-CMNT-TXT-LEN END-SUBTRACT    10398099
103990           MOVE                                                   10399099
104000             ART00001-CMNT-TXT-TEXT(41:ART00001-CMNT-TXT-LEN) TO  10400099
104010                                                ANOTES2O          10401099
104020                                                CA-ACCOUNT-NOTES-210402099
104030        ELSE                                                      10403099
104040           MOVE                                                   10404099
104050             ART00001-CMNT-TXT-TEXT(1:ART00001-CMNT-TXT-LEN) TO   10405099
104060                                                ANOTES1O          10406099
104070                                                CA-ACCOUNT-NOTES-110407099
104080        END-IF                                                    10408099
104090     END-IF.                                                      10409099
104100*----------*                                                      10410099
104110 2100-EXIT.                                                       10411099
104120*----------*                                                      10412099
104130     EXIT.                                                        10413099
104140                                                                  10414099
105060                                                                  10506099
105070******************************************************************10507099
105080*  IN THE CASE THAT THE CLEAR KEY IS PRESSED, RE-SEND THE MAP    *10508099
105090*  AND DATA FROM THE LAST PASS THROUGH THE PROGRAM.              *10509099
105100******************************************************************10510099
105110*----------------------------------*                              10511099
105120 2400-MOVE-COMMAREA-TO-MAP SECTION.                               10512099
105130*----------------------------------*                              10513099
105140     IF CA-ACCT-ACCESS-YES                                        10514099
105150        MOVE CA-ACCOUNT-NUMBER-X          TO PV-ACCOUNT-NBR-10    10515099
105160        PERFORM 6940-DETOKEN-ACCT                                 10516099
105170        MOVE PV-ACCOUNT-NBR-10            TO AACCTO               10517099
105180     ELSE                                                         10518099
105190        MOVE CA-ACCOUNT-NUMBER-X          TO AACCTO               10519099
105200        MOVE 'XXXXXXXX'                   TO AACCTO(1:8)          10520099
105210     END-IF.                                                      10521099
105220     MOVE CA-EMPLOYEE-STATUS              TO AESTATO.             10522099
105230     MOVE CA-CRS-EMPLOYEE-CODE            TO AECODEO.             10523099
105240     MOVE CA-DISCOUNT-STATUS              TO ADSTATO.             10524099
105250     IF CA-EMPLOYEE-NAME = SPACES                                 10525099
105260        MOVE CA-EMPLOYEE-NAME             TO AENAMEO              10526099
105270     ELSE                                                         10527099
105280        MOVE CA-EMPLOYEE-NAME             TO PV-EMP-NM-ENC        10528099
105290        PERFORM 6910-BASE64-BINARY                                10529099
105300        PERFORM 6920-DECRYPT-EMPNM                                10530099
105320        PERFORM 6930-ASCII-EBCDIC                                 10532099
105330        MOVE DP053-OUTPUT-FIELD           TO AENAMEO              10533099
105340     END-IF.                                                      10534099
105350     MOVE CA-SOCIAL-SECURITY-NUMBER-X     TO PV-SSN-NUMBER        10535099
105360     IF CA-SSN-ACCESS-YES                                         10536099
105370        PERFORM 6900-DETOKEN-SSN                                  10537099
105380        MOVE PV-SSN-NUMBER                TO ASSNO                10538099
105390     ELSE                                                         10539099
105400        MOVE 'XXXXX'                      TO PV-SSN-NUMBER(1:5)   10540099
105410        MOVE PV-SSN-NUMBER                TO ASSNO                10541099
105420     END-IF.                                                      10542099
105430     MOVE CA-STORE-NUMBER                 TO ASTOREO.             10543099
105440     MOVE CA-DATE-DISC-EFF-MM             TO ADTDEFMO.            10544099
105450     MOVE CA-DATE-DISC-EFF-DD             TO ADTDEFDO.            10545099
105460     MOVE CA-DATE-DISC-EFF-CCYY           TO ADTDEFYO.            10546099
105470     MOVE CA-DATE-TERM-EFF-MM             TO ADTTEFMO.            10547099
105480     MOVE CA-DATE-TERM-EFF-DD             TO ADTTEFDO.            10548099
105490     MOVE CA-DATE-TERM-EFF-CCYY           TO ADTTEFYO.            10549099
105500     MOVE CA-ACCOUNT-NOTES-1              TO ANOTES1O.            10550099
105510     MOVE CA-ACCOUNT-NOTES-2              TO ANOTES2O.            10551099
105520*----------*                                                      10552099
105530 2400-EXIT.                                                       10553099
105540*----------*                                                      10554099
105550     EXIT.                                                        10555099
105560                                                                  10556099
105570*------------------------------------*                            10557099
105580 2500-MOVE-EMP-NO-UPD-FIELDS SECTION.                             10558099
105590*------------------------------------*                            10559099
105600     MOVE CA-EMPLOYEE-STATUS      TO AESTATO.                     10560099
105610     MOVE CA-EMPLOYEE-NAME        TO AENAMEO.                     10561099
105620     MOVE CA-CRS-EMPLOYEE-CODE    TO AECODEO.                     10562099
105630     MOVE CA-STORE-NUMBER         TO ASTOREO.                     10563099
105640     MOVE CA-DATE-DISC-EFF-MM     TO ADTDEFMO.                    10564099
105650     MOVE CA-DATE-DISC-EFF-DD     TO ADTDEFDO.                    10565099
105660     MOVE CA-DATE-DISC-EFF-CCYY   TO ADTDEFYO.                    10566099
105670     MOVE CA-DATE-TERM-EFF-MM     TO ADTTEFMO.                    10567099
105680     MOVE CA-DATE-TERM-EFF-DD     TO ADTTEFDO.                    10568099
105690     MOVE CA-DATE-TERM-EFF-CCYY   TO ADTTEFYO.                    10569099
105700*----------*                                                      10570099
105710 2500-EXIT.                                                       10571099
105720*----------*                                                      10572099
105730     EXIT.                                                        10573099
105740                                                                  10574099
105750*-------------------------------------*                           10575099
105760 2600-MOVE-SRCH-SCREEN-FIELDS SECTION.                            10576099
105770*-------------------------------------*                           10577099
105780     MOVE PV-SSN-NBR-ROW (PV-SEARCH-PTR) TO PV-SSN-NUMBER.        10578099
105790     IF PV-SSN-NUMBER = SPACES                                    10579099
105800        MOVE PV-SSN-NUMBER               TO BSSNO (PV-SEARCH-PTR) 10580099
105810     ELSE                                                         10581099
105820        IF CA-SSN-ACCESS-YES                                      10582099
105830           PERFORM 6900-DETOKEN-SSN                               10583099
105840           MOVE PV-SSN-NUMBER            TO BSSNO (PV-SEARCH-PTR) 10584099
105850        ELSE                                                      10585099
105860           MOVE 'XXXXX'                  TO PV-SSN-NUMBER(1:5)    10586099
105870           MOVE PV-SSN-NUMBER            TO BSSNO (PV-SEARCH-PTR) 10587099
105880        END-IF                                                    10588099
105890     END-IF.                                                      10589099
105900     MOVE SPACES                         TO PV-EMP-NM-ENC.        10590099
105910     MOVE PV-EMP-NM-ROW (PV-SEARCH-PTR)  TO PV-EMP-NM-ENC.        10591099
105920     IF PV-EMP-NM-ENC = SPACES                                    10592099
105930        MOVE PV-EMP-NM-ENC              TO BNAMEO (PV-SEARCH-PTR) 10593099
105940                                                                  10594099
105950     ELSE                                                         10595099
105960        PERFORM 6910-BASE64-BINARY                                10596099
105970        PERFORM 6920-DECRYPT-EMPNM                                10597099
105990        PERFORM 6930-ASCII-EBCDIC                                 10599099
106000        MOVE DP053-OUTPUT-FIELD         TO BNAMEO (PV-SEARCH-PTR) 10600099
106010     END-IF.                                                      10601099
106050     MOVE PV-STR-NBR-ROW (PV-SEARCH-PTR) TO BSTRO (PV-SEARCH-PTR).10605099
106060*----------*                                                      10606099
106070 2600-EXIT.                                                       10607099
106080*----------*                                                      10608099
106090     EXIT.                                                        10609099
106100                                                                  10610099
106110*----------------------------------------------------------       10611099
106120* 3000 THRU 3700 - COMMAREA MOVES                                 10612099
106130*----------------------------------------------------------       10613099
106140*-----------------------------------*                             10614099
106150 3000-RECEIVE-COMMON-FIELDS SECTION.                              10615099
106160*-----------------------------------*                             10616099
106170     IF ASSNL > ZERO                                              10617099
106180        MOVE ASSNI TO CA-SOCIAL-SECURITY-NUMBER-X                 10618099
106190     ELSE                                                         10619099
106200        IF ASSNA = PC-EOF-KEYED                                   10620099
106210           INITIALIZE CA-SOCIAL-SECURITY-NUMBER-X                 10621099
106220        END-IF                                                    10622099
106230     END-IF.                                                      10623099
106240                                                                  10624099
106250     IF AACCTL > ZERO                                             10625099
106260        MOVE AACCTI TO CA-ACCOUNT-NUMBER-X                        10626099
106270     ELSE                                                         10627099
106280        IF AACCTA = PC-EOF-KEYED                                  10628099
106290           INITIALIZE CA-ACCOUNT-NUMBER-X                         10629099
106300        END-IF                                                    10630099
106310     END-IF.                                                      10631099
106320                                                                  10632099
106330     IF ADSTATL > ZERO                                            10633099
106340        MOVE ADSTATI TO CA-DISCOUNT-STATUS                        10634099
106350     ELSE                                                         10635099
106360        IF ADSTATA = PC-EOF-KEYED                                 10636099
106370            INITIALIZE CA-DISCOUNT-STATUS                         10637099
106380        END-IF                                                    10638099
106390     END-IF.                                                      10639099
106400                                                                  10640099
106410     IF ANOTES1L > ZERO                                           10641099
106420        MOVE ANOTES1I TO CA-ACCOUNT-NOTES-1                       10642099
106430     ELSE                                                         10643099
106440        IF ANOTES1A = PC-EOF-KEYED                                10644099
106450           MOVE SPACES TO CA-ACCOUNT-NOTES-1                      10645099
106460        END-IF                                                    10646099
106470     END-IF.                                                      10647099
106480                                                                  10648099
106490     IF ANOTES2L > ZERO                                           10649099
106500        MOVE ANOTES2I TO CA-ACCOUNT-NOTES-2                       10650099
106510     ELSE                                                         10651099
106520        IF ANOTES2A = PC-EOF-KEYED                                10652099
106530           MOVE SPACES TO CA-ACCOUNT-NOTES-2                      10653099
106540        END-IF                                                    10654099
106550     END-IF.                                                      10655099
106560*----------*                                                      10656099
106570 3000-EXIT.                                                       10657099
106580*----------*                                                      10658099
106590     EXIT.                                                        10659099
106600                                                                  10660099
106610*-----------------------------------*                             10661099
106620 3100-RECEIVE-NONEMP-FIELDS SECTION.                              10662099
106630*-----------------------------------*                             10663099
106640     IF AESTATL > ZERO                                            10664099
106650         MOVE AESTATI TO CA-EMPLOYEE-STATUS                       10665099
106660     ELSE                                                         10666099
106670         IF AESTATA = PC-EOF-KEYED                                10667099
106680             INITIALIZE CA-EMPLOYEE-STATUS                        10668099
106690         END-IF                                                   10669099
106700     END-IF.                                                      10670099
106710                                                                  10671099
106720     IF AENAMEL > ZERO                                            10672099
106730         MOVE AENAMEI TO CA-EMPLOYEE-NAME                         10673099
106740     ELSE                                                         10674099
106750         IF AENAMEA = PC-EOF-KEYED                                10675099
106760             INITIALIZE CA-EMPLOYEE-NAME                          10676099
106770         END-IF                                                   10677099
106780     END-IF.                                                      10678099
106790                                                                  10679099
106800     IF AECODEL > ZERO                                            10680099
106900         MOVE AECODEI TO CA-CRS-EMPLOYEE-CODE                     10690099
107000     ELSE                                                         10700099
107100         IF AECODEA = PC-EOF-KEYED                                10710099
107200             INITIALIZE CA-CRS-EMPLOYEE-CODE                      10720099
107300         END-IF                                                   10730099
107400     END-IF.                                                      10740099
107500                                                                  10750099
107600     IF ASTOREL > ZERO                                            10760099
107700         MOVE ASTOREI TO CA-STORE-NUMBER-X                        10770099
107800     ELSE                                                         10780099
107900         IF ASTOREA = PC-EOF-KEYED                                10790099
108000             INITIALIZE CA-STORE-NUMBER-X                         10800099
108100         END-IF                                                   10810099
108200     END-IF.                                                      10820099
108300                                                                  10830099
108400     IF ADTDEFML > ZERO                                           10840099
108500        MOVE ADTDEFMI TO CA-DATE-DISC-EFF-MM                      10850099
108600     ELSE                                                         10860099
108700         IF ADTDEFMA = PC-EOF-KEYED                               10870099
108800            INITIALIZE CA-DATE-DISC-EFF-MM                        10880099
108900         END-IF                                                   10890099
109000     END-IF.                                                      10900099
109100                                                                  10910099
109200     IF ADTDEFDL > ZERO                                           10920099
109300        MOVE ADTDEFDI TO CA-DATE-DISC-EFF-DD                      10930099
109400     ELSE                                                         10940099
109500         IF ADTDEFDA = PC-EOF-KEYED                               10950099
109600            INITIALIZE CA-DATE-DISC-EFF-DD                        10960099
109700         END-IF                                                   10970099
109800     END-IF.                                                      10980099
109900                                                                  10990099
110000     IF ADTDEFYL > ZERO                                           11000099
110100        MOVE ADTDEFYI TO CA-DATE-DISC-EFF-CCYY                    11010099
110200     ELSE                                                         11020099
110300         IF ADTDEFYA = PC-EOF-KEYED                               11030099
110400            INITIALIZE CA-DATE-DISC-EFF-CCYY                      11040099
110500         END-IF                                                   11050099
110600     END-IF.                                                      11060099
110700                                                                  11070099
110800     IF ADTTEFML > ZERO                                           11080099
110900        MOVE ADTTEFMI TO CA-DATE-TERM-EFF-MM                      11090099
111000     ELSE                                                         11100099
111100         IF ADTTEFMA = PC-EOF-KEYED                               11110099
111200            INITIALIZE CA-DATE-TERM-EFF-MM                        11120099
111300         END-IF                                                   11130099
111400     END-IF.                                                      11140099
111500                                                                  11150099
111600     IF ADTTEFDL > ZERO                                           11160099
111700        MOVE ADTTEFDI TO CA-DATE-TERM-EFF-DD                      11170099
111800     ELSE                                                         11180099
111900         IF ADTTEFDA = PC-EOF-KEYED                               11190099
112000            INITIALIZE CA-DATE-TERM-EFF-DD                        11200099
112100         END-IF                                                   11210099
112200     END-IF.                                                      11220099
112300                                                                  11230099
112400     IF ADTTEFYL > ZERO                                           11240099
112500        MOVE ADTTEFYI TO CA-DATE-TERM-EFF-CCYY                    11250099
112600     ELSE                                                         11260099
112700         IF ADTTEFYA = PC-EOF-KEYED                               11270099
112800            INITIALIZE CA-DATE-TERM-EFF-CCYY                      11280099
112900         END-IF                                                   11290099
113000     END-IF.                                                      11300099
113100*----------*                                                      11310099
113200 3100-EXIT.                                                       11320099
113300*----------*                                                      11330099
113400     EXIT.                                                        11340099
113500                                                                  11350099
113600*----------------------------------*                              11360099
113700 3150-RECEIVE-SEARCH-FIELD SECTION.                               11370099
113800*----------------------------------*                              11380099
113900     IF BSRCHL > ZERO                                             11390099
114000        MOVE BSRCHI TO CA-SEARCH-TEXT                             11400099
114100     ELSE                                                         11410099
114200        IF BSRCHA = PC-EOF-KEYED                                  11420099
114300           INITIALIZE CA-SEARCH-TEXT                              11430099
114400        END-IF                                                    11440099
114500     END-IF.                                                      11450099
114600                                                                  11460099
114700     IF BESTATL > ZERO                                            11470099
114800        MOVE BESTATI TO CA-EMPLOYEE-STATUS                        11480099
114900     ELSE                                                         11490099
115000        IF BESTATA = PC-EOF-KEYED                                 11500099
115100           INITIALIZE CA-EMPLOYEE-STATUS                          11510099
115200        END-IF                                                    11520099
115300     END-IF.                                                      11530099
115400*----------*                                                      11540099
115500 3150-EXIT.                                                       11550099
115600*----------*                                                      11560099
115700     EXIT.                                                        11570099
115800                                                                  11580099
115900*-----------------------------------*                             11590099
116000 3175-RECEIVE-SELECT-FIELDS SECTION.                              11600099
116100*-----------------------------------*                             11610099
116200     IF BSELL (PV-SEARCH-PTR) > ZERO                              11620099
116300        MOVE BSELI (PV-SEARCH-PTR) TO CA-SEARCH-SELECTION         11630099
116400                                               (PV-SEARCH-PTR)    11640099
116500     ELSE                                                         11650099
116600        IF BSELA (PV-SEARCH-PTR) = PC-EOF-KEYED                   11660099
116700           INITIALIZE CA-SEARCH-SELECTION (PV-SEARCH-PTR)         11670099
116800        END-IF                                                    11680099
116900     END-IF.                                                      11690099
117000*----------*                                                      11700099
117100 3175-EXIT.                                                       11710099
117200*----------*                                                      11720099
117300     EXIT.                                                        11730099
117400                                                                  11740099
117500*--------------------------------*                                11750099
117600 3185-EDIT-SELECT-FIELDS SECTION.                                 11760099
117700*--------------------------------*                                11770099
117800     IF CA-SEARCH-SELECTION (PV-SEARCH-PTR) NOT = SPACES AND      11780099
117900        CA-SEARCH-SELECTION (PV-SEARCH-PTR) NOT = 'S'             11790099
118000        MOVE DP015-REVERSE TO BSELH (PV-SEARCH-PTR)               11800099
118100        MOVE -1 TO BSELL (PV-SEARCH-PTR)                          11810099
118200        SET PM-MESSAGE-INDEX TO 48                                11820099
118300        SET PS-EDIT-ERROR TO TRUE                                 11830099
118400     END-IF.                                                      11840099
118500*----------*                                                      11850099
118600 3185-EXIT.                                                       11860099
118700*----------*                                                      11870099
118800     EXIT.                                                        11880099
118900                                                                  11890099
119000*-------------------------------------*                           11900099
119100 3200-MOVE-EMPLOYEE-DISC-DATA SECTION.                            11910099
119200*-------------------------------------*                           11920099
119300     MOVE CA-EMPLOYEE-ID            TO ART00001-EMP-ID.           11930099
119400     MOVE CA-ACCOUNT-NUMBER-X       TO ART00001-ACCT-NBR.         11940099
119500                                                                  11950099
119600     IF CA-LIFETIME-DISCOUNT OR                                   11960099
119700        CA-REGULAR-DISCOUNT                                       11970099
119800        SET CA-ACTIVE-EMPLOYEE-STATUS TO TRUE                     11980099
119900        MOVE SPACES TO CA-DATE-TERMINATION-EFFECT-GRP             11990099
120000     ELSE                                                         12000099
120100        SET CA-TERMED-EMPLOYEE-STATUS TO TRUE                     12010099
120200        MOVE PV-CURRENT-DATE-MDCY TO                              12020099
120300             CA-DATE-TERMINATION-EFFECT-GRP                       12030099
120400     END-IF.                                                      12040099
120500                                                                  12050099
120600     MOVE CA-DISCOUNT-STATUS        TO ART00001-DISC-STAT-CDE.    12060099
120700                                                                  12070099
120800     MOVE PV-CURRENT-MM             TO PV-SQL-MM.                 12080099
120900     MOVE PV-CURRENT-DD             TO PV-SQL-DD.                 12090099
121000     MOVE PV-CURRENT-CC             TO PV-SQL-CC.                 12100099
121100     MOVE PV-CURRENT-YY             TO PV-SQL-YY.                 12110099
121200     MOVE PV-SQL-DATE-GROUP         TO ART00001-LAST-UPD-DTE.     12120099
121300                                                                  12130099
121400     IF CA-ACCOUNT-NOTES-1 = SPACES AND                           12140099
121500        CA-ACCOUNT-NOTES-2 = SPACES                               12150099
121600        MOVE -1 TO IND-ART00001-CMNT-TXT                          12160099
121700     ELSE                                                         12170099
121800        PERFORM 3275-MOVE-ACCOUNT-NOTES                           12180099
121900        MOVE 0                 TO IND-ART00001-CMNT-TXT           12190099
122000        MOVE PV-CMNT-TXT-PTR   TO ART00001-CMNT-TXT-LEN           12200099
122100        MOVE PV-CMNT-TXT-FIELD TO ART00001-CMNT-TXT-TEXT          12210099
122200     END-IF.                                                      12220099
122300*----------*                                                      12230099
122400 3200-EXIT.                                                       12240099
122500*----------*                                                      12250099
122600     EXIT.                                                        12260099
122700                                                                  12270099
127600                                                                  12760099
127700*--------------------------------*                                12770099
127800 3275-MOVE-ACCOUNT-NOTES SECTION.                                 12780099
127900*--------------------------------*                                12790099
128000     INITIALIZE PV-CMNT-TXT-FIELD                                 12800099
128100                PS-CMNT-CHAR-SW.                                  12810099
128200                                                                  12820099
128300     STRING                                                       12830099
128400        CA-ACCOUNT-NOTES-1 DELIMITED BY SIZE                      12840099
128500        CA-ACCOUNT-NOTES-2 DELIMITED BY SIZE                      12850099
128600     INTO PV-CMNT-TXT-FIELD                                       12860099
128700     END-STRING.                                                  12870099
128800                                                                  12880099
128900     PERFORM                                                      12890099
129000        VARYING PV-CMNT-TXT-PTR FROM 80 BY -1                     12900099
129100           UNTIL PS-CMNT-CHAR-FOUND                               12910099
129200        IF PV-CMNT-TXT-CHAR (PV-CMNT-TXT-PTR) NOT = SPACES        12920099
129300           SET PS-CMNT-CHAR-FOUND TO TRUE                         12930099
129400        END-IF                                                    12940099
129500     END-PERFORM.                                                 12950099
129600                                                                  12960099
129700     ADD 1 TO PV-CMNT-TXT-PTR.                                    12970099
129800*----------*                                                      12980099
129900 3275-EXIT.                                                       12990099
130000*----------*                                                      13000099
130100     EXIT.                                                        13010099
130200                                                                  13020099
130300*------------------------------*                                  13030099
130400*3500-LOG-EMPLOYEE-ADD SECTION.                                   13040099
130500*------------------------------*                                  13050099
130600*    SET PS-ADD TO TRUE.                                          13060099
130700*                                                                 13070099
130800*    MOVE CA-EMPLOYEE-STATUS         TO AD-EMPLOYEE-DISC-STATUS.  13080099
130900*    MOVE CA-CRS-EMPLOYEE-CODE       TO AD-CRS-EMPLOYEE-CODE.     13090099
131000*    MOVE CA-EMPLOYEE-NAME           TO AD-EMPLOYEE-NAME.         13100099
131100*    MOVE CA-SOC-SEC-NUMBER-1-3      TO AD-SOC-SEC-NUMBER-1-3.    13110099
131200*    MOVE CA-SOC-SEC-NUMBER-4-5      TO AD-SOC-SEC-NUMBER-4-5.    13120099
131300*    MOVE CA-SOC-SEC-NUMBER-6-9      TO AD-SOC-SEC-NUMBER-6-9.    13130099
131400*    MOVE CA-STORE-NUMBER            TO AD-STORE-NUMBER.          13140099
131500*    MOVE CA-DATE-DISC-EFF-MM        TO AD-DATE-DISC-EFF-MM.      13150099
131600*    MOVE CA-DATE-DISC-EFF-DD        TO AD-DATE-DISC-EFF-DD.      13160099
131700*    MOVE CA-DATE-DISC-EFF-YY        TO AD-DATE-DISC-EFF-YY.      13170099
131800*                                                                 13180099
131900*    IF CA-DATE-TERMINATION-EFFECT-GRP = SPACES                   13190099
132000*       MOVE ZEROES TO CA-DATE-TERMINATION-EFFECT-GRP             13200099
132100*    END-IF.                                                      13210099
132200*                                                                 13220099
132300*    MOVE CA-DATE-TERM-EFF-MM        TO AD-DATE-TERM-EFF-MM.      13230099
132400*    MOVE CA-DATE-TERM-EFF-DD        TO AD-DATE-TERM-EFF-DD.      13240099
132500*    MOVE CA-DATE-TERM-EFF-YY        TO AD-DATE-TERM-EFF-YY.      13250099
132600*                                                                 13260099
132700*    IF CA-DATE-TERMINATION-EFFECT-GRP = ZEROES                   13270099
132800*       MOVE SPACES TO CA-DATE-TERMINATION-EFFECT-GRP             13280099
132900*    END-IF.                                                      13290099
133000*                                                                 13300099
133100*    MOVE CA-ACCOUNT-NOTES-1         TO AD-ACCOUNT-NOTES-1.       13310099
133200*    MOVE CA-ACCOUNT-NOTES-2         TO AD-ACCOUNT-NOTES-2.       13320099
133300*                                                                 13330099
133400*    MOVE AD-MESSAGE-01 TO AR506O-OUTPUT-MESSAGE-AREA.            13340099
133500*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          13350099
133600*                                                                 13360099
133700*    MOVE AD-MESSAGE-02 TO AR506O-OUTPUT-MESSAGE-AREA.            13370099
133800*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          13380099
133900*                                                                 13390099
134000*    MOVE AD-MESSAGE-03 TO AR506O-OUTPUT-MESSAGE-AREA.            13400099
134100*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          13410099
134200*                                                                 13420099
134300*    MOVE AD-MESSAGE-04 TO AR506O-OUTPUT-MESSAGE-AREA.            13430099
134400*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          13440099
134500*----------*                                                      13450099
134600*3500-EXIT.                                                       13460099
134700*----------*                                                      13470099
134800*    EXIT.                                                        13480099
134900*                                                                 13490099
135000*-------------------------------*                                 13500099
135100*3600-LOG-NON-EMP-UPDATE SECTION.                                 13510099
135200*-------------------------------*                                 13520099
135300*    SET PS-UPDATE TO TRUE.                                       13530099
135400*                                                                 13540099
135500*    IF CA-EMPLOYEE-STATUS NOT = EU-EMP-STAT-CDE                  13550099
135600*        MOVE EU-EMP-STAT-CDE    TO CM-OLD-EMPLOYEE-STATUS        13560099
135700*        MOVE CA-EMPLOYEE-STATUS TO CM-NEW-EMPLOYEE-STATUS        13570099
135800*        MOVE CM-MESSAGE-01      TO AR506O-OUTPUT-MESSAGE-AREA    13580099
135900*        PERFORM 8500-WRITE-MAINTENANCE-LOG                       13590099
136000*    END-IF.                                                      13600099
136100*                                                                 13610099
136200*    IF CA-CRS-EMPLOYEE-CODE NOT = EU-EMP-TYP-CDE                 13620099
136300*        MOVE EU-EMP-TYP-CDE       TO CM-OLD-CRS-EMPLOYEE-CODE    13630099
136400*        MOVE CA-CRS-EMPLOYEE-CODE TO CM-NEW-CRS-EMPLOYEE-CODE    13640099
136500*        MOVE CM-MESSAGE-02        TO AR506O-OUTPUT-MESSAGE-AREA  13650099
136600*        PERFORM 8500-WRITE-MAINTENANCE-LOG                       13660099
136700*    END-IF.                                                      13670099
136800*                                                                 13680099
136900*    IF CA-EMPLOYEE-NAME NOT = EU-EMP-NAME                        13690099
137000*        MOVE EU-EMP-NAME      TO CM-OLD-EMPLOYEE-NAME            13700099
137100*        MOVE CA-EMPLOYEE-NAME TO CM-NEW-EMPLOYEE-NAME            13710099
137200*        MOVE CM-MESSAGE-03    TO AR506O-OUTPUT-MESSAGE-AREA      13720099
137300*        PERFORM 8500-WRITE-MAINTENANCE-LOG                       13730099
137400*    END-IF.                                                      13740099
137500*                                                                 13750099
137600*    IF CA-STORE-NUMBER NOT = EU-STORE-NBR                        13760099
137700*        MOVE EU-STORE-NBR    TO CM-OLD-STORE-NUMBER              13770099
137800*        MOVE CA-STORE-NUMBER TO CM-NEW-STORE-NUMBER              13780099
137900*        MOVE CM-MESSAGE-05   TO AR506O-OUTPUT-MESSAGE-AREA       13790099
138000*        PERFORM 8500-WRITE-MAINTENANCE-LOG                       13800099
138100*    END-IF.                                                      13810099
138200*                                                                 13820099
138300*    MOVE CA-DATE-DISC-EFF-MM TO PV-VSAM-MM.                      13830099
138400*    MOVE CA-DATE-DISC-EFF-DD TO PV-VSAM-DD.                      13840099
138500*    MOVE CA-DATE-DISC-EFF-YY TO PV-VSAM-YY.                      13850099
138600*    MOVE EU-DISC-DTE(6:2)    TO PV-PREV-SCRN-MM.                 13860099
138700*    MOVE EU-DISC-DTE(9:2)    TO PV-PREV-SCRN-DD.                 13870099
138800*    MOVE EU-DISC-DTE(3:2)    TO PV-PREV-SCRN-YY.                 13880099
138900*    IF PV-DATE-VSAM-FORMAT NOT = PV-PREV-SCRN-MDY                13890099
139000*       MOVE PV-PREV-SCRN-MM     TO CM-OLD-DISC-EFF-MM            13900099
139100*       MOVE PV-PREV-SCRN-DD     TO CM-OLD-DISC-EFF-DD            13910099
139200*       MOVE PV-PREV-SCRN-YY     TO CM-OLD-DISC-EFF-YY            13920099
139300*       MOVE CA-DATE-DISC-EFF-MM TO CM-NEW-DISC-EFF-MM            13930099
139400*       MOVE CA-DATE-DISC-EFF-DD TO CM-NEW-DISC-EFF-DD            13940099
139500*       MOVE CA-DATE-DISC-EFF-YY TO CM-NEW-DISC-EFF-YY            13950099
139600*       MOVE CM-MESSAGE-10 TO AR506O-OUTPUT-MESSAGE-AREA          13960099
139700*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        13970099
139800*    END-IF.                                                      13980099
139900*                                                                 13990099
140000*    IF IND-EU-TERM-DTE = -1                                      14000099
140100*       MOVE '00000000' TO CA-DATE-TERMINATION-EFFECT-GRP         14010099
140200*    END-IF.                                                      14020099
140300*                                                                 14030099
140400*    MOVE CA-DATE-TERM-EFF-MM TO PV-VSAM-MM.                      14040099
140500*    MOVE CA-DATE-TERM-EFF-DD TO PV-VSAM-DD.                      14050099
140600*    MOVE CA-DATE-TERM-EFF-YY TO PV-VSAM-YY.                      14060099
140700*    MOVE EU-TERM-DTE(6:2)    TO PV-PREV-SCRN-MM.                 14070099
140800*    MOVE EU-TERM-DTE(9:2)    TO PV-PREV-SCRN-DD.                 14080099
140900*    MOVE EU-TERM-DTE(3:2)    TO PV-PREV-SCRN-YY.                 14090099
141000*    IF PV-DATE-VSAM-FORMAT NOT = PV-PREV-SCRN-MDY                14100099
141100*       MOVE PV-PREV-SCRN-MM     TO CM-OLD-TERM-EFF-MM            14110099
141200*       MOVE PV-PREV-SCRN-DD     TO CM-OLD-TERM-EFF-DD            14120099
141300*       MOVE PV-PREV-SCRN-YY     TO CM-OLD-TERM-EFF-YY            14130099
141400*       MOVE CA-DATE-TERM-EFF-MM TO CM-NEW-TERM-EFF-MM            14140099
141500*       MOVE CA-DATE-TERM-EFF-DD TO CM-NEW-TERM-EFF-DD            14150099
141600*       MOVE CA-DATE-TERM-EFF-YY TO CM-NEW-TERM-EFF-YY            14160099
141700*       MOVE CM-MESSAGE-11 TO AR506O-OUTPUT-MESSAGE-AREA          14170099
141800*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        14180099
141900*    END-IF.                                                      14190099
142000*                                                                 14200099
142100*    IF CA-DATE-TERMINATION-EFFECT-GRP = '00000000'               14210099
142200*       MOVE SPACES TO CA-DATE-TERMINATION-EFFECT-GRP             14220099
142300*    END-IF.                                                      14230099
142400*                                                                 14240099
142500*    IF CA-ACCOUNT-NOTES-1 NOT = EU-NOTES-1                       14250099
142600*    OR CA-ACCOUNT-NOTES-2 NOT = EU-NOTES-2                       14260099
142700*       MOVE EU-NOTES-1             TO CM-OLD-ACCOUNT-NOTES-1     14270099
142800*       MOVE EU-NOTES-2             TO CM-OLD-ACCOUNT-NOTES-2     14280099
142900*       MOVE CA-ACCOUNT-NOTES-1     TO CM-NEW-ACCOUNT-NOTES-1     14290099
143000*       MOVE CA-ACCOUNT-NOTES-2     TO CM-NEW-ACCOUNT-NOTES-2     14300099
143100*       MOVE CM-MESSAGE-12          TO AR506O-OUTPUT-MESSAGE-AREA 14310099
143200*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        14320099
143300*       MOVE CM-MESSAGE-13          TO AR506O-OUTPUT-MESSAGE-AREA 14330099
143400*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        14340099
143500*    END-IF.                                                      14350099
143600*----------*                                                      14360099
143700*3600-EXIT.                                                       14370099
143800*----------*                                                      14380099
143900*    EXIT.                                                        14390099
144000*                                                                 14400099
144100*---------------------------*                                     14410099
144200*3610-LOG-EMP-UPDATE SECTION.                                     14420099
144300*---------------------------*                                     14430099
144400*    SET PS-UPDATE TO TRUE.                                       14440099
144500*                                                                 14450099
144600*    IF CA-ACCOUNT-NOTES-1 NOT = EU-NOTES-1                       14460099
144700*    OR CA-ACCOUNT-NOTES-2 NOT = EU-NOTES-2                       14470099
144800*       MOVE EU-NOTES-1             TO CM-OLD-ACCOUNT-NOTES-1     14480099
144900*       MOVE EU-NOTES-2             TO CM-OLD-ACCOUNT-NOTES-2     14490099
145000*       MOVE CA-ACCOUNT-NOTES-1     TO CM-NEW-ACCOUNT-NOTES-1     14500099
145100*       MOVE CA-ACCOUNT-NOTES-2     TO CM-NEW-ACCOUNT-NOTES-2     14510099
145200*       MOVE CM-MESSAGE-12          TO AR506O-OUTPUT-MESSAGE-AREA 14520099
145300*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        14530099
145400*       MOVE CM-MESSAGE-13          TO AR506O-OUTPUT-MESSAGE-AREA 14540099
145500*       PERFORM 8500-WRITE-MAINTENANCE-LOG                        14550099
145600*    END-IF.                                                      14560099
145700*----------*                                                      14570099
145800*3610-EXIT.                                                       14580099
145900*----------*                                                      14590099
146000*    EXIT.                                                        14600099
146100*                                                                 14610099
146200*---------------------------------*                               14620099
146300*3700-LOG-EMPLOYEE-DELETE SECTION.                                14630099
146400*---------------------------------*                               14640099
146500*    SET PS-DELETE TO TRUE.                                       14650099
146600*                                                                 14660099
146700*    MOVE CA-EMPLOYEE-STATUS         TO AD-EMPLOYEE-DISC-STATUS.  14670099
146800*    MOVE CA-CRS-EMPLOYEE-CODE       TO AD-CRS-EMPLOYEE-CODE.     14680099
146900*    MOVE CA-EMPLOYEE-NAME           TO AD-EMPLOYEE-NAME.         14690099
147000*    MOVE CA-SOC-SEC-NUMBER-1-3      TO AD-SOC-SEC-NUMBER-1-3.    14700099
147100*    MOVE CA-SOC-SEC-NUMBER-4-5      TO AD-SOC-SEC-NUMBER-4-5.    14710099
147200*    MOVE CA-SOC-SEC-NUMBER-6-9      TO AD-SOC-SEC-NUMBER-6-9.    14720099
147300*    MOVE CA-STORE-NUMBER            TO AD-STORE-NUMBER.          14730099
147400*    MOVE CA-DATE-DISC-EFF-MM        TO AD-DATE-DISC-EFF-MM.      14740099
147500*    MOVE CA-DATE-DISC-EFF-DD        TO AD-DATE-DISC-EFF-DD.      14750099
147600*    MOVE CA-DATE-DISC-EFF-YY        TO AD-DATE-DISC-EFF-YY.      14760099
147700*                                                                 14770099
147800*    IF CA-DATE-TERMINATION-EFFECT-GRP = SPACES                   14780099
147900*       MOVE ZEROES TO CA-DATE-TERMINATION-EFFECT-GRP             14790099
148000*    END-IF.                                                      14800099
148100*                                                                 14810099
148200*    MOVE CA-DATE-TERM-EFF-MM        TO AD-DATE-TERM-EFF-MM.      14820099
148300*    MOVE CA-DATE-TERM-EFF-DD        TO AD-DATE-TERM-EFF-DD.      14830099
148400*    MOVE CA-DATE-TERM-EFF-YY        TO AD-DATE-TERM-EFF-YY.      14840099
148500*                                                                 14850099
148600*    IF CA-DATE-TERMINATION-EFFECT-GRP = ZEROES                   14860099
148700*       MOVE SPACES TO CA-DATE-TERMINATION-EFFECT-GRP             14870099
148800*    END-IF.                                                      14880099
148900*                                                                 14890099
149000*    MOVE CA-ACCOUNT-NOTES-1         TO AD-ACCOUNT-NOTES-1.       14900099
149100*    MOVE CA-ACCOUNT-NOTES-2         TO AD-ACCOUNT-NOTES-2.       14910099
149200*                                                                 14920099
149300*    MOVE AD-MESSAGE-01 TO AR506O-OUTPUT-MESSAGE-AREA.            14930099
149400*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          14940099
149500*                                                                 14950099
149600*    MOVE AD-MESSAGE-02 TO AR506O-OUTPUT-MESSAGE-AREA.            14960099
149700*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          14970099
149800*                                                                 14980099
149900*    MOVE AD-MESSAGE-03 TO AR506O-OUTPUT-MESSAGE-AREA.            14990099
150000*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          15000099
150100*                                                                 15010099
150200*    MOVE AD-MESSAGE-04 TO AR506O-OUTPUT-MESSAGE-AREA.            15020099
150300*    PERFORM 8500-WRITE-MAINTENANCE-LOG.                          15030099
150400*----------*                                                      15040099
150500*3700-EXIT.                                                       15050099
150600*----------*                                                      15060099
150700*    EXIT.                                                        15070099
150800*                                                                 15080099
150900*----------------------------------------------------------       15090099
151000* 4000 THRU 4700 - EDITING                                        15100099
151100*----------------------------------------------------------       15110099
151200*--------------------------------*                                15120099
151300 4000-EDIT-NONEMP-FIELDS SECTION.                                 15130099
151400*--------------------------------*                                15140099
151500     IF CA-EMPLOYEE-NAME = SPACES                                 15150099
151600        MOVE DP015-REVERSE TO AENAMEH                             15160099
151700        IF PS-NO-EDIT-ERROR                                       15170099
151800           SET PS-EDIT-ERROR TO TRUE                              15180099
151900           SET PM-MESSAGE-INDEX TO 4                              15190099
152000           MOVE -1 TO AENAMEL                                     15200099
152100        END-IF                                                    15210099
152200     ELSE                                                         15220099
152300        INITIALIZE PV-COMMA-CTR                                   15230099
152400        INSPECT CA-EMPLOYEE-NAME                                  15240099
152500           TALLYING PV-COMMA-CTR FOR ALL ','                      15250099
152600        IF PV-COMMA-CTR > 0                                       15260099
152700           IF AENAMEL > 0 OR CA-NAME-EDITED                       15270099
152800              MOVE DP015-REVERSE TO AENAMEH                       15280099
152900              SET CA-NAME-EDITED TO TRUE                          15290099
153000              IF PS-NO-EDIT-ERROR                                 15300099
153100                 SET PS-EDIT-ERROR TO TRUE                        15310099
153200                 SET PM-MESSAGE-INDEX TO 4                        15320099
153300                 MOVE -1 TO AENAMEL                               15330099
153400              END-IF                                              15340099
153500           END-IF                                                 15350099
153600        ELSE                                                      15360099
153700           SET CA-UNPROTECT-NAME TO TRUE                          15370099
153800           PERFORM 4075-FORMAT-NON-EMPLOYEE-NAME                  15380099
153900        END-IF                                                    15390099
154000     END-IF.                                                      15400099
154100                                                                  15410099
154200     IF CA-STORE-NUMBER-X = SPACES OR                             15420099
154300        CA-STORE-NUMBER = ZEROES                                  15430099
154400        MOVE DP015-REVERSE TO ASTOREH                             15440099
154500        IF PS-NO-EDIT-ERROR                                       15450099
154600           SET PS-EDIT-ERROR TO TRUE                              15460099
154700           MOVE -1 TO ASTOREL                                     15470099
154800           SET PM-MESSAGE-INDEX TO 28                             15480099
154900        END-IF                                                    15490099
155000     END-IF.                                                      15500099
155100                                                                  15510099
155200     IF PS-NO-EDIT-ERROR                                          15520099
155300        MOVE CA-STORE-NUMBER-X TO DP010I-UNEDITED-FIELD           15530099
155400        MOVE 4 TO DP010I-MAXIMUM-DIGITS                           15540099
155500        MOVE 0 TO DP010I-MAXIMUM-DECIMALS                         15550099
155600        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   15560099
155710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          15571099
155720                         USING DP010I-NUMERIC-EDIT-AREA           15572099
155800                                                                  15580099
155900        IF DP010I-ERROR-DETECTED                                  15590099
156000           MOVE DP015-REVERSE TO ASTOREH                          15600099
156100           IF PS-NO-EDIT-ERROR                                    15610099
156200              SET PS-EDIT-ERROR TO TRUE                           15620099
156300              MOVE -1 TO ASTOREL                                  15630099
156400              SET PM-MESSAGE-INDEX TO 8                           15640099
156500           END-IF                                                 15650099
156600        ELSE                                                      15660099
156700           MOVE DP010I-NUMERIC-FIELD TO CA-STORE-NUMBER           15670099
156800           MOVE CA-STORE-NUMBER TO ASTOREO                        15680099
156900           IF CA-STORE-NUMBER-X NOT = ZEROS                       15690099
157000              MOVE CA-STORE-NUMBER TO XST00001-LOC-NBR            15700099
157100              PERFORM 7075-SELECT-STORE-TABLE-ROW                 15710099
157200              IF PS-EDIT-ERROR                                    15720099
157300                 MOVE DP015-REVERSE TO ASTOREH                    15730099
157400                 MOVE -1 TO ASTOREL                               15740099
157500                 SET PM-MESSAGE-INDEX TO 9                        15750099
157600              END-IF                                              15760099
157700           END-IF                                                 15770099
157800        END-IF                                                    15780099
157900     END-IF.                                                      15790099
158000                                                                  15800099
158100     IF NOT CA-VALID-EMPLOYEE-STATUS                              15810099
158200        MOVE DP015-REVERSE TO AESTATH                             15820099
158300        IF PS-NO-EDIT-ERROR                                       15830099
158400           SET PS-EDIT-ERROR TO TRUE                              15840099
158500           SET PM-MESSAGE-INDEX TO 3                              15850099
158600           MOVE -1 TO AESTATL                                     15860099
158700        END-IF                                                    15870099
158800      END-IF.                                                     15880099
158900                                                                  15890099
159000     IF NOT CA-VALID-EMPLOYEE-CODE                                15900099
159100         MOVE DP015-REVERSE TO AECODEH                            15910099
159200         IF PS-NO-EDIT-ERROR                                      15920099
159300             SET PS-EDIT-ERROR TO TRUE                            15930099
159400             SET PM-MESSAGE-INDEX TO 5                            15940099
159500             MOVE -1 TO AECODEL                                   15950099
159600         END-IF                                                   15960099
159700     END-IF.                                                      15970099
159800                                                                  15980099
159900     PERFORM 4025-EDIT-DISC-STATUS.                               15990099
160000                                                                  16000099
160100     IF CA-DATE-DISCOUNT-EFFECT-GRP = SPACES                      16010099
160200        MOVE DP015-REVERSE TO ADTDEFMH                            16020099
160300                              ADTDEFDH                            16030099
160400                              ADTDEFYH                            16040099
160500        IF PS-NO-EDIT-ERROR                                       16050099
160600           SET PS-EDIT-ERROR TO TRUE                              16060099
160700           SET PM-MESSAGE-INDEX TO 10                             16070099
160800           MOVE -1 TO ADTDEFML                                    16080099
160900        END-IF                                                    16090099
161000     ELSE                                                         16100099
161100        PERFORM 4550-EDIT-DISCOUNT-DATE                           16110099
161200     END-IF.                                                      16120099
161300                                                                  16130099
161400     IF PS-NO-EDIT-ERROR                                          16140099
161500        MOVE CA-DATE-DISCOUNT-EFFECT-GRP TO DE-EDIT-DATE          16150099
161600        PERFORM 4600-VALIDATE-DATE                                16160099
161700        IF PS-DATE-EDIT-ERROR                                     16170099
161800           MOVE DP015-REVERSE TO ADTDEFMH                         16180099
161900           MOVE DP015-REVERSE TO ADTDEFDH                         16190099
162000           MOVE DP015-REVERSE TO ADTDEFYH                         16200099
162100           IF PS-NO-EDIT-ERROR                                    16210099
162200              SET PS-EDIT-ERROR TO TRUE                           16220099
162300              SET PM-MESSAGE-INDEX TO 11                          16230099
162400              MOVE -1 TO ADTDEFML                                 16240099
162500           END-IF                                                 16250099
162600        END-IF                                                    16260099
162700     END-IF.                                                      16270099
162800                                                                  16280099
162900     IF CA-DATE-TERMINATION-EFFECT-GRP NOT = SPACES               16290099
163000        PERFORM 4575-EDIT-TERM-DATE                               16300099
163100     END-IF.                                                      16310099
163200                                                                  16320099
163300     IF PS-NO-EDIT-ERROR                                          16330099
163400        IF CA-DATE-TERMINATION-EFFECT-GRP NOT = SPACES            16340099
163500           MOVE CA-DATE-TERMINATION-EFFECT-GRP TO DE-EDIT-DATE    16350099
163600           PERFORM 4600-VALIDATE-DATE                             16360099
163700           IF PS-DATE-EDIT-ERROR                                  16370099
163800              MOVE DP015-REVERSE TO ADTTEFMH                      16380099
163900              MOVE DP015-REVERSE TO ADTTEFDH                      16390099
164000              MOVE DP015-REVERSE TO ADTTEFYH                      16400099
164100              IF PS-NO-EDIT-ERROR                                 16410099
164200                 SET PS-EDIT-ERROR TO TRUE                        16420099
164300                 SET PM-MESSAGE-INDEX TO 13                       16430099
164400                 MOVE -1 TO ADTTEFML                              16440099
164500              END-IF                                              16450099
164600           END-IF                                                 16460099
164700        END-IF                                                    16470099
164800     END-IF.                                                      16480099
164900                                                                  16490099
165000     IF PS-NO-EDIT-ERROR                                          16500099
165100        IF CA-ACTIVE-EMPLOYEE-STATUS                              16510099
165200           IF CA-DATE-TERMINATION-EFFECT-GRP NOT = SPACES         16520099
165300              MOVE DP015-REVERSE TO ADTTEFMH                      16530099
165400              MOVE DP015-REVERSE TO ADTTEFDH                      16540099
165500              MOVE DP015-REVERSE TO ADTTEFYH                      16550099
165600              SET PS-EDIT-ERROR TO TRUE                           16560099
165700              SET PM-MESSAGE-INDEX TO 14                          16570099
165800              MOVE -1 TO ADTTEFML                                 16580099
165900           END-IF                                                 16590099
166000        ELSE                                                      16600099
166100           IF CA-TERMED-EMPLOYEE-STATUS                           16610099
166200              IF CA-DATE-TERMINATION-EFFECT-GRP = SPACES          16620099
166300                 MOVE DP015-REVERSE TO ADTTEFMH                   16630099
166400                 MOVE DP015-REVERSE TO ADTTEFDH                   16640099
166500                 MOVE DP015-REVERSE TO ADTTEFYH                   16650099
166600                 SET PS-EDIT-ERROR TO TRUE                        16660099
166700                 SET PM-MESSAGE-INDEX TO 15                       16670099
166800                 MOVE -1 TO ADTTEFML                              16680099
166900              END-IF                                              16690099
167000           END-IF                                                 16700099
167100        END-IF                                                    16710099
167200     END-IF.                                                      16720099
167300*----------*                                                      16730099
167400 4000-EXIT.                                                       16740099
167500*----------*                                                      16750099
167600     EXIT.                                                        16760099
167700                                                                  16770099
167800*------------------------------*                                  16780099
167900 4025-EDIT-DISC-STATUS SECTION.                                   16790099
168000*------------------------------*                                  16800099
168100     IF NOT CA-PROTECT-DISC-FLD                                   16810099
168200        IF NOT CA-VALID-DISCOUNT-STATUS                           16820099
168300           MOVE DP015-REVERSE TO ADSTATH                          16830099
168400           IF PS-NO-EDIT-ERROR                                    16840099
168500              SET PS-EDIT-ERROR TO TRUE                           16850099
168600              SET PM-MESSAGE-INDEX TO 49                          16860099
168700              MOVE -1 TO ADSTATL                                  16870099
168800           END-IF                                                 16880099
168900        ELSE                                                      16890099
169000           IF CA-NON-EMPLOYEE                                     16900099
169100              IF CA-NO-DISCOUNT                                   16910099
169200                 MOVE DP015-REVERSE TO ADSTATH                    16920099
169300                 IF PS-NO-EDIT-ERROR                              16930099
169400                    SET PS-EDIT-ERROR TO TRUE                     16940099
169500                    SET PM-MESSAGE-INDEX TO 52                    16950099
169600                    MOVE -1 TO ADSTATL                            16960099
169700                 END-IF                                           16970099
169800              END-IF                                              16980099
169900           END-IF                                                 16990099
170000        END-IF                                                    17000099
170100     END-IF.                                                      17010099
170200*----------*                                                      17020099
170300 4025-EXIT.                                                       17030099
170400*----------*                                                      17040099
170500     EXIT.                                                        17050099
170600                                                                  17060099
170700*-------------------------------*                                 17070099
170800 4050-EDIT-STORE-NUMBER SECTION.                                  17080099
170900*-------------------------------*                                 17090099
171000     MOVE DP015-UNDERLINE TO BSRCHH.                              17100099
171100                                                                  17110099
171200     IF CA-STORE-NUMBER-X = SPACES OR                             17120099
171300        CA-STORE-NUMBER = ZEROES                                  17130099
171400        MOVE DP015-REVERSE TO BSRCHH                              17140099
171500        SET PS-EDIT-ERROR TO TRUE                                 17150099
171600        MOVE -1 TO BSRCHL                                         17160099
171700        SET PM-MESSAGE-INDEX TO 28                                17170099
171800     END-IF.                                                      17180099
171900                                                                  17190099
172000     IF PS-NO-EDIT-ERROR                                          17200099
172100        MOVE CA-STORE-NUMBER-X TO DP010I-UNEDITED-FIELD           17210099
172200        MOVE 4 TO DP010I-MAXIMUM-DIGITS                           17220099
172300        MOVE 0 TO DP010I-MAXIMUM-DECIMALS                         17230099
172400        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   17240099
172510        CALL DP010I-NUMERIC-EDIT-ROUTINE                          17251099
172520                         USING DP010I-NUMERIC-EDIT-AREA           17252099
172600                                                                  17260099
172700        IF DP010I-ERROR-DETECTED                                  17270099
172800           MOVE DP015-REVERSE TO BSRCHH                           17280099
172900           IF PS-NO-EDIT-ERROR                                    17290099
173000              SET PS-EDIT-ERROR TO TRUE                           17300099
173100              MOVE -1 TO BSRCHL                                   17310099
173200              SET PM-MESSAGE-INDEX TO 8                           17320099
173300           END-IF                                                 17330099
173400        ELSE                                                      17340099
173500           MOVE DP010I-NUMERIC-FIELD TO CA-STORE-NUMBER           17350099
173600           MOVE CA-STORE-NUMBER TO ASTOREO                        17360099
173700           IF CA-STORE-NUMBER NOT = ZEROES                        17370099
173800              MOVE CA-STORE-NUMBER TO XST00001-LOC-NBR            17380099
173900              PERFORM 7075-SELECT-STORE-TABLE-ROW                 17390099
174000              IF PS-EDIT-ERROR                                    17400099
174100                 MOVE DP015-REVERSE TO BSRCHH                     17410099
174200                 MOVE -1 TO BSRCHL                                17420099
174300                 SET PM-MESSAGE-INDEX TO 9                        17430099
174400              END-IF                                              17440099
174500           END-IF                                                 17450099
174600        END-IF                                                    17460099
174700     END-IF.                                                      17470099
174800*----------*                                                      17480099
174900 4050-EXIT.                                                       17490099
175000*----------*                                                      17500099
175100     EXIT.                                                        17510099
175200                                                                  17520099
175300*--------------------------------------*                          17530099
175400 4075-FORMAT-NON-EMPLOYEE-NAME SECTION.                           17540099
175500*--------------------------------------*                          17550099
175600     INITIALIZE AFRSTNMO                                          17560099
175700                CA-CONFIRM-LAST-NAME                              17570099
175800                ALSTNMO                                           17580099
175900                CA-CONFIRM-FRST-NAME                              17590099
176000                AMDLNMO                                           17600099
176100                CA-CONFIRM-MI-NAME.                               17610099
176200                                                                  17620099
176300     UNSTRING CA-EMPLOYEE-NAME                                    17630099
176400        DELIMITED BY SPACE                                        17640099
176500        INTO PV-NAME-WORK-FLD-1                                   17650099
176600             PV-NAME-WORK-FLD-2                                   17660099
176700             PV-NAME-WORK-FLD-3                                   17670099
176800     END-UNSTRING.                                                17680099
176900                                                                  17690099
177000     IF PV-NAME-WORK-FLD-2 = SPACES AND                           17700099
177100        PV-NAME-WORK-FLD-3 = SPACES                               17710099
177200        MOVE DP015-REVERSE TO AENAMEH                             17720099
177300        IF PS-NO-EDIT-ERROR                                       17730099
177400           SET PS-EDIT-ERROR TO TRUE                              17740099
177500           SET PM-MESSAGE-INDEX TO 4                              17750099
177600           MOVE -1 TO AENAMEL                                     17760099
177700        END-IF                                                    17770099
177800        GO TO 4075-EXIT                                           17780099
177900     END-IF.                                                      17790099
178000                                                                  17800099
178100     MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-1(1:1))            17810099
178200                           TO PV-NAME-WORK-FLD-1-UPPER.           17820099
178300     MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-1(2:39))           17830099
178400                           TO PV-NAME-WORK-FLD-1-LOWER.           17840099
178500     MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-2(1:1))            17850099
178600                           TO PV-NAME-WORK-FLD-2-UPPER.           17860099
178700     MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-2(2:39))           17870099
178800                           TO PV-NAME-WORK-FLD-2-LOWER.           17880099
178900     MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-3(1:1))            17890099
179000                           TO PV-NAME-WORK-FLD-3-UPPER.           17900099
179100     MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-3(2:39))           17910099
179200                           TO PV-NAME-WORK-FLD-3-LOWER.           17920099
179300                                                                  17930099
179400                                                                  17940099
179500     INITIALIZE CA-EMPLOYEE-NAME.                                 17950099
179600     IF PV-NAME-WORK-FLD-3-GROUP = SPACES                         17960099
179700        STRING                                                    17970099
179800           PV-NAME-WORK-FLD-2-GROUP    DELIMITED BY SPACE         17980099
179900           ','                         DELIMITED BY SIZE          17990099
180000           PV-NAME-WORK-FLD-1-GROUP    DELIMITED BY SPACE         18000099
180100        INTO CA-EMPLOYEE-NAME                                     18010099
180200        END-STRING                                                18020099
180300        MOVE PV-NAME-WORK-FLD-2-GROUP TO CA-CONFIRM-LAST-NAME     18030099
180400                                         ALSTNMO                  18040099
180500        MOVE PV-NAME-WORK-FLD-1-GROUP TO CA-CONFIRM-FRST-NAME     18050099
180600                                         AFRSTNMO                 18060099
180700     ELSE                                                         18070099
180800        STRING                                                    18080099
180900           PV-NAME-WORK-FLD-3-GROUP      DELIMITED BY SPACE       18090099
181000           ','                           DELIMITED BY SIZE        18100099
181100           PV-NAME-WORK-FLD-1-GROUP      DELIMITED BY SPACE       18110099
181200           ' '                           DELIMITED BY SIZE        18120099
181300           PV-NAME-WORK-FLD-2-GROUP(1:1) DELIMITED BY SPACE       18130099
181400        INTO CA-EMPLOYEE-NAME                                     18140099
181500        END-STRING                                                18150099
181600        MOVE PV-NAME-WORK-FLD-3-GROUP    TO CA-CONFIRM-LAST-NAME  18160099
181700                                            ALSTNMO               18170099
181800        MOVE PV-NAME-WORK-FLD-1-GROUP    TO CA-CONFIRM-FRST-NAME  18180099
181900                                            AFRSTNMO              18190099
182000        MOVE PV-NAME-WORK-FLD-2-GROUP    TO CA-CONFIRM-MI-NAME    18200099
182100                                            AMDLNMO               18210099
182200     END-IF.                                                      18220099
182300                                                                  18230099
182400     MOVE CA-EMPLOYEE-NAME TO AENAMEO.                            18240099
182500*----------*                                                      18250099
182600 4075-EXIT.                                                       18260099
182700*----------*                                                      18270099
182800     EXIT.                                                        18280099
182900                                                                  18290099
183000*----------------------*                                          18300099
183100 4100-EDIT-SSN SECTION.                                           18310099
183200*----------------------*                                          18320099
183300     IF ASSNL > ZERO                                              18330099
183400        MOVE ASSNI TO CA-SOCIAL-SECURITY-NUMBER-X                 18340099
183500     ELSE                                                         18350099
183600        IF ASSNA = PC-EOF-KEYED                                   18360099
183700           INITIALIZE CA-SOCIAL-SECURITY-NUMBER-X                 18370099
183800        END-IF                                                    18380099
183900     END-IF.                                                      18390099
184000                                                                  18400099
184100     MOVE CA-SOCIAL-SECURITY-NUMBER-X TO DP010I-UNEDITED-FIELD.   18410099
184200     MOVE 9 TO DP010I-MAXIMUM-DIGITS.                             18420099
184300     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           18430099
184400     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     18440099
184510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             18451099
184520                         USING DP010I-NUMERIC-EDIT-AREA           18452099
184600                                                                  18460099
184700     IF DP010I-ERROR-DETECTED                                     18470099
184800         MOVE DP015-REVERSE TO ASSNH                              18480099
184900         IF PS-NO-EDIT-ERROR                                      18490099
185000             SET CA-LAST-ACTION-ABORTED TO TRUE                   18500099
185100             SET PS-EDIT-ERROR TO TRUE                            18510099
185200             SET PM-MESSAGE-INDEX TO 7                            18520099
185300             MOVE -1 TO ASSNL                                     18530099
185400         END-IF                                                   18540099
185500     ELSE                                                         18550099
185600         IF CA-SOCIAL-SECURITY-NUMBER-X NOT = SPACES              18560099
185700            MOVE DP010I-NUMERIC-FIELD TO CA-SOCIAL-SECURITY-NUMBER18570099
185800            MOVE CA-SOCIAL-SECURITY-NUMBER TO PV-SSN-NUMBER       18580099
185900            IF CA-SSN-ACCESS-YES                                  18590099
186000               MOVE PV-SSN-NUMBER          TO ASSNO               18600099
186100            ELSE                                                  18610099
186200               MOVE 'XXXXX'                TO PV-SSN-NUMBER(1:5)  18620099
186300               MOVE PV-SSN-NUMBER          TO ASSNO               18630099
186400            END-IF                                                18640099
186500     END-IF.                                                      18650099
186600                                                                  18660099
186700     EVALUATE TRUE                                                18670099
186800         WHEN CA-SOCIAL-SECURITY-NUMBER-X = SPACES                18680099
186900             MOVE DP015-REVERSE TO ASSNH                          18690099
187000             IF PS-NO-EDIT-ERROR                                  18700099
187100                 SET PS-EDIT-ERROR TO TRUE                        18710099
187200                 SET PM-MESSAGE-INDEX TO 6                        18720099
187300                 MOVE -1 TO ASSNL                                 18730099
187400             END-IF                                               18740099
187500*        WHEN CA-SOCIAL-SECURITY-NUMBER = ZERO                    18750099
187600*            IF EIBAID = DFHPF4                                   18760099
187700*               MOVE DP015-REVERSE TO ASSNH                       18770099
187800*               IF PS-NO-EDIT-ERROR                               18780099
187900*                   SET PS-EDIT-ERROR TO TRUE                     18790099
188000*                   SET PM-MESSAGE-INDEX TO 32                    18800099
188100*                   MOVE -1 TO ASSNL                              18810099
188200*               END-IF                                            18820099
188300*            END-IF                                               18830099
188400     END-EVALUATE.                                                18840099
188500*----------*                                                      18850099
188600 4100-EXIT.                                                       18860099
188700*----------*                                                      18870099
188800     EXIT.                                                        18880099
188900                                                                  18890099
189000*---------------------------*                                     18900099
189100 4200-EDIT-ACCT-NBR SECTION.                                      18910099
189200*---------------------------*                                     18920099
189300     IF AACCTL > ZERO                                             18930099
189400        MOVE AACCTI TO CA-ACCOUNT-NUMBER-X                        18940099
189500     ELSE                                                         18950099
189600        IF AACCTA = PC-EOF-KEYED                                  18960099
189700           INITIALIZE CA-ACCOUNT-NUMBER-X                         18970099
189800        END-IF                                                    18980099
189900     END-IF.                                                      18990099
190000                                                                  19000099
190100     MOVE CA-ACCOUNT-NUMBER-X TO DP010I-UNEDITED-FIELD.           19010099
190200     MOVE 10 TO DP010I-MAXIMUM-DIGITS.                            19020099
190300     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           19030099
190400     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     19040099
190510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19051099
190520                         USING DP010I-NUMERIC-EDIT-AREA           19052099
190600                                                                  19060099
190700     IF DP010I-ERROR-DETECTED                                     19070099
190800         MOVE DP015-REVERSE TO AACCTH                             19080099
190900         IF PS-NO-EDIT-ERROR                                      19090099
191000             SET PS-EDIT-ERROR TO TRUE                            19100099
191100             SET PM-MESSAGE-INDEX TO 17                           19110099
191200             MOVE -1 TO AACCTL                                    19120099
191300         END-IF                                                   19130099
191400     ELSE                                                         19140099
191500        IF CA-ACCOUNT-NUMBER-X NOT = SPACES                       19150099
191600           MOVE DP010I-NUMERIC-FIELD TO CA-ACCOUNT-NUMBER         19160099
191700           IF CA-ACCT-ACCESS-YES                                  19170099
191800              MOVE CA-ACCOUNT-NUMBER-X  TO AACCTO                 19180099
191900           ELSE                                                   19190099
192000              MOVE CA-ACCOUNT-NUMBER-X  TO AACCTO                 19200099
192100              MOVE 'XXXXXXXX'           TO AACCTO(1:8)            19210099
192200           END-IF                                                 19220099
192300        END-IF                                                    19230099
192400     END-IF.                                                      19240099
192500                                                                  19250099
192600     EVALUATE TRUE                                                19260099
192700         WHEN CA-ACCOUNT-NUMBER-X = SPACES                        19270099
192800             MOVE DP015-REVERSE TO AACCTH                         19280099
192900             IF PS-NO-EDIT-ERROR                                  19290099
193000                 SET PS-EDIT-ERROR TO TRUE                        19300099
193100                 SET PM-MESSAGE-INDEX TO 25                       19310099
193200                 MOVE -1 TO AACCTL                                19320099
193300             END-IF                                               19330099
193400         WHEN CA-ACCOUNT-NUMBER = ZERO                            19340099
193500             MOVE DP015-REVERSE TO AACCTH                         19350099
193600             IF PS-NO-EDIT-ERROR                                  19360099
193700                 SET PS-EDIT-ERROR TO TRUE                        19370099
193800                 SET PM-MESSAGE-INDEX TO 27                       19380099
193900                 MOVE -1 TO AACCTL                                19390099
194000             END-IF                                               19400099
194100     END-EVALUATE.                                                19410099
194200*----------*                                                      19420099
194300 4200-EXIT.                                                       19430099
194400*----------*                                                      19440099
194500     EXIT.                                                        19450099
194600                                                                  19460099
194700*-------------------------*                                       19470099
194800 4300-VERIFY-READ SECTION.                                        19480099
194900*-------------------------*                                       19490099
195000     IF CA-EMPLOYEE AND                                           19500099
195100        CA-ACCOUNT-NUMBER-X = SPACES                              19510099
195200        SET PS-EDIT-ERROR TO TRUE                                 19520099
195300        SET CA-LAST-ACTION-ABORTED TO TRUE                        19530099
195400        SET PM-MESSAGE-INDEX TO 42                                19540099
195500        GO TO 4300-EXIT                                           19550099
195600     END-IF.                                                      19560099
195700                                                                  19570099
195800     IF NOT CA-LAST-ACTION-SUCCESSFUL                             19580099
195900        SET PS-EDIT-ERROR TO TRUE                                 19590099
196000        SET PM-MESSAGE-INDEX TO 16                                19600099
196100        GO TO 4300-EXIT                                           19610099
196200     END-IF.                                                      19620099
196300                                                                  19630099
196400     IF (ASSNL NOT = ZERO AND ASSNI NOT =                         19640099
196500        CA-SOCIAL-SECURITY-NUMBER-X) OR                           19650099
196600        ASSNA = PC-EOF-KEYED                                      19660099
196700        SET CA-LAST-ACTION-ABORTED TO TRUE                        19670099
196800        MOVE ASSNI TO CA-SOCIAL-SECURITY-NUMBER-X                 19680099
196900        SET PS-EDIT-ERROR TO TRUE                                 19690099
197000        SET PM-MESSAGE-INDEX TO 16                                19700099
197100        GO TO 4300-EXIT                                           19710099
197200     END-IF.                                                      19720099
197300                                                                  19730099
197400     IF (AACCTL NOT = ZERO AND AACCTI NOT =                       19740099
197500        CA-ACCOUNT-NUMBER-X) OR                                   19750099
197600        AACCTA = PC-EOF-KEYED                                     19760099
197700        SET CA-LAST-ACTION-ABORTED TO TRUE                        19770099
197800        MOVE AACCTI TO CA-ACCOUNT-NUMBER-X                        19780099
197900        SET PS-EDIT-ERROR TO TRUE                                 19790099
198000        SET PM-MESSAGE-INDEX TO 16                                19800099
198100     END-IF.                                                      19810099
198200*----------*                                                      19820099
198300 4300-EXIT.                                                       19830099
198400*----------*                                                      19840099
198500     EXIT.                                                        19850099
198600                                                                  19860099
198700*----------------------------------*                              19870099
198800 4350-CHECK-FOR-SSN-CHANGE SECTION.                               19880099
198900*----------------------------------*                              19890099
199000     IF (ASSNL NOT = ZERO AND ASSNI NOT =                         19900099
199100        CA-SOCIAL-SECURITY-NUMBER-X) OR                           19910099
199200        ASSNA = PC-EOF-KEYED                                      19920099
199300        MOVE ASSNI  TO CA-SOCIAL-SECURITY-NUMBER-X                19930099
199400        MOVE SPACES TO CA-EMPLOYEE-FLAG                           19940099
199500     END-IF.                                                      19950099
199600*----------*                                                      19960099
199700 4350-EXIT.                                                       19970099
199800*----------*                                                      19980099
199900     EXIT.                                                        19990099
200000                                                                  20000099
200100*---------------------------------*                               20010099
200200 4400-CHECK-DIGIT-ACCOUNT SECTION.                                20020099
200300*---------------------------------*                               20030099
200400     MOVE CA-ACCOUNT-NUMBER-X TO CC-ACCOUNT-NUMBER.               20040099
200500     MOVE CC-ACCOUNT-PRFX     TO PS-ACCOUNT-PRFX-SW.              20050099
200600                                                                  20060099
200700     IF NOT PS-VALID-ACCT-PRFX                                    20070099
200800        SET PS-EDIT-ERROR TO TRUE                                 20080099
200900        SET PM-MESSAGE-INDEX TO 50                                20090099
201000        MOVE DP015-REVERSE TO AACCTH                              20100099
201100        MOVE -1 TO AACCTL                                         20110099
201200        GO TO 4400-EXIT                                           20120099
201300     END-IF.                                                      20130099
201400                                                                  20140099
201500     SET PS-MULTIPLY-DIGIT-BY-2 TO TRUE.                          20150099
201600     INITIALIZE CC-MOD-10-DIGIT-SUM.                              20160099
201700                                                                  20170099
201800     PERFORM                                                      20180099
201900        VARYING CC-DIGIT-INDEX FROM 1 BY 1                        20190099
202000            UNTIL CC-DIGIT-INDEX > PC-MAXIMUM-ACCOUNT-DIGITS      20200099
202100         IF PS-MULTIPLY-DIGIT-BY-2                                20210099
202200             COMPUTE CC-ACCOUNT-DIGIT-MOD-10 =                    20220099
202300                       (CC-ACCOUNT-DIGIT (CC-DIGIT-INDEX) * 2)    20230099
202400             IF CC-ACCOUNT-DIGIT-MOD-10 > PC-MAXIMUM-DIGIT-AMOUNT 20240099
202500                 SUBTRACT PC-MAXIMUM-DIGIT-AMOUNT FROM            20250099
202600                           CC-ACCOUNT-DIGIT-MOD-10                20260099
202700             END-IF                                               20270099
202800             ADD CC-ACCOUNT-DIGIT-MOD-10 TO CC-MOD-10-DIGIT-SUM   20280099
202900             SET PS-MULTIPLY-DIGIT-BY-1 TO TRUE                   20290099
203000         ELSE                                                     20300099
203100             ADD CC-ACCOUNT-DIGIT (CC-DIGIT-INDEX) TO             20310099
203200                       CC-MOD-10-DIGIT-SUM                        20320099
203300             SET PS-MULTIPLY-DIGIT-BY-2 TO TRUE                   20330099
203400         END-IF                                                   20340099
203500     END-PERFORM.                                                 20350099
203600                                                                  20360099
203700     COMPUTE CC-COMPUTED-CHECK-DIGIT =                            20370099
203800               (PC-MOD-10 - CC-MOD-10-DIGIT-SUM).                 20380099
203900*----------*                                                      20390099
204000 4400-EXIT.                                                       20400099
204100*----------*                                                      20410099
204200     EXIT.                                                        20420099
204300                                                                  20430099
204400*-------------------------------------*                           20440099
204500 4500-VALIDATE-ACCOUNT-NUMBER SECTION.                            20450099
204600*-------------------------------------*                           20460099
204700     EVALUATE TRUE                                                20470099
204800         WHEN CC-ACCOUNT-CHECK-DIGIT NOT =                        20480099
204900             CC-COMPUTED-CHECK-DIGIT                              20490099
205000             MOVE DP015-REVERSE TO AACCTH                         20500099
205100             IF PS-NO-EDIT-ERROR                                  20510099
205200                SET PS-EDIT-ERROR TO TRUE                         20520099
205300                SET PM-MESSAGE-INDEX TO 24                        20530099
205400                MOVE -1 TO AACCTL                                 20540099
205500             END-IF                                               20550099
205600     END-EVALUATE.                                                20560099
205700*----------*                                                      20570099
205800 4500-EXIT.                                                       20580099
205900*----------*                                                      20590099
206000     EXIT.                                                        20600099
206100                                                                  20610099
206200*--------------------------------*                                20620099
206300 4550-EDIT-DISCOUNT-DATE SECTION.                                 20630099
206400*--------------------------------*                                20640099
206500     MOVE CA-DATE-DISC-EFF-MM TO DP010I-UNEDITED-FIELD.           20650099
206600     MOVE 2 TO DP010I-MAXIMUM-DIGITS.                             20660099
206700     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           20670099
206800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     20680099
206910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             20691099
206920                         USING DP010I-NUMERIC-EDIT-AREA           20692099
207000                                                                  20700099
207100     IF DP010I-ERROR-DETECTED                                     20710099
207200         MOVE DP015-REVERSE TO ADTDEFMH                           20720099
207300         IF PS-NO-EDIT-ERROR                                      20730099
207400             SET PS-EDIT-ERROR TO TRUE                            20740099
207500             SET PM-MESSAGE-INDEX TO 10                           20750099
207600             MOVE -1 TO ADTDEFML                                  20760099
207700         END-IF                                                   20770099
207800     ELSE                                                         20780099
207900        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-2           20790099
208000        MOVE PV-DATE-WORK-FLD-2 TO ADTDEFMO                       20800099
208100                                   CA-DATE-DISC-EFF-MM            20810099
208200     END-IF.                                                      20820099
208300                                                                  20830099
208400     MOVE CA-DATE-DISC-EFF-DD TO DP010I-UNEDITED-FIELD.           20840099
208500     MOVE 2 TO DP010I-MAXIMUM-DIGITS.                             20850099
208600     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           20860099
208700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     20870099
208810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             20881099
208820                         USING DP010I-NUMERIC-EDIT-AREA           20882099
208900                                                                  20890099
209000     IF DP010I-ERROR-DETECTED                                     20900099
209100         MOVE DP015-REVERSE TO ADTDEFDH                           20910099
209200         IF PS-NO-EDIT-ERROR                                      20920099
209300             SET PS-EDIT-ERROR TO TRUE                            20930099
209400             SET PM-MESSAGE-INDEX TO 10                           20940099
209500             MOVE -1 TO ADTDEFDL                                  20950099
209600         END-IF                                                   20960099
209700     ELSE                                                         20970099
209800        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-2           20980099
209900        MOVE PV-DATE-WORK-FLD-2 TO ADTDEFDO                       20990099
210000                                   CA-DATE-DISC-EFF-DD            21000099
210100     END-IF.                                                      21010099
210200                                                                  21020099
210300     MOVE CA-DATE-DISC-EFF-CCYY TO DP010I-UNEDITED-FIELD.         21030099
210400     MOVE 4 TO DP010I-MAXIMUM-DIGITS.                             21040099
210500     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           21050099
210600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     21060099
210710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21071099
210720                         USING DP010I-NUMERIC-EDIT-AREA           21072099
210800                                                                  21080099
210900     IF DP010I-ERROR-DETECTED                                     21090099
211000        MOVE DP015-REVERSE TO ADTDEFYH                            21100099
211100        IF PS-NO-EDIT-ERROR                                       21110099
211200           SET PS-EDIT-ERROR TO TRUE                              21120099
211300           SET PM-MESSAGE-INDEX TO 10                             21130099
211400           MOVE -1 TO ADTDEFYL                                    21140099
211500        END-IF                                                    21150099
211600     ELSE                                                         21160099
211700        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-4           21170099
211800        MOVE PV-DATE-WORK-FLD-4 TO ADTDEFYO                       21180099
211900                                   CA-DATE-DISC-EFF-CCYY          21190099
212000     END-IF.                                                      21200099
212100                                                                  21210099
212200     IF CA-DATE-DISC-EFF-CCYY < PC-KOHLS-EARLIEST-HIRE-YEAR       21220099
212300        MOVE DP015-REVERSE TO ADTDEFYH                            21230099
212400        IF PS-NO-EDIT-ERROR                                       21240099
212500           SET PS-EDIT-ERROR TO TRUE                              21250099
212600           MOVE -1 TO ADTDEFYL                                    21260099
212700           SET PM-MESSAGE-INDEX TO 54                             21270099
212800        END-IF                                                    21280099
212900     END-IF.                                                      21290099
213000*----------*                                                      21300099
213100 4550-EXIT.                                                       21310099
213200*----------*                                                      21320099
213300     EXIT.                                                        21330099
213400                                                                  21340099
213500*----------------------------*                                    21350099
213600 4575-EDIT-TERM-DATE SECTION.                                     21360099
213700*----------------------------*                                    21370099
213800     MOVE CA-DATE-TERM-EFF-MM TO DP010I-UNEDITED-FIELD.           21380099
213900     MOVE 2 TO DP010I-MAXIMUM-DIGITS.                             21390099
214000     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           21400099
214100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     21410099
214210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21421099
214220                         USING DP010I-NUMERIC-EDIT-AREA           21422099
214300                                                                  21430099
214400     IF DP010I-ERROR-DETECTED                                     21440099
214500         MOVE DP015-REVERSE TO ADTTEFMH                           21450099
214600         IF PS-NO-EDIT-ERROR                                      21460099
214700             SET PS-EDIT-ERROR TO TRUE                            21470099
214800             SET PM-MESSAGE-INDEX TO 12                           21480099
214900             MOVE -1 TO ADTTEFML                                  21490099
215000         END-IF                                                   21500099
215100     ELSE                                                         21510099
215200        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-2           21520099
215300        MOVE PV-DATE-WORK-FLD-2 TO ADTTEFMO                       21530099
215400                                   CA-DATE-TERM-EFF-MM            21540099
215500     END-IF.                                                      21550099
215600                                                                  21560099
215700     MOVE CA-DATE-TERM-EFF-DD TO DP010I-UNEDITED-FIELD.           21570099
215800     MOVE 2 TO DP010I-MAXIMUM-DIGITS.                             21580099
215900     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           21590099
216000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     21600099
216110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21611099
216120                         USING DP010I-NUMERIC-EDIT-AREA           21612099
216200                                                                  21620099
216300     IF DP010I-ERROR-DETECTED                                     21630099
216400         MOVE DP015-REVERSE TO ADTTEFDH                           21640099
216500         IF PS-NO-EDIT-ERROR                                      21650099
216600             SET PS-EDIT-ERROR TO TRUE                            21660099
216700             SET PM-MESSAGE-INDEX TO 12                           21670099
216800             MOVE -1 TO ADTTEFDL                                  21680099
216900         END-IF                                                   21690099
217000     ELSE                                                         21700099
217100        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-2           21710099
217200        MOVE PV-DATE-WORK-FLD-2 TO ADTTEFDO                       21720099
217300                                   CA-DATE-TERM-EFF-DD            21730099
217400     END-IF.                                                      21740099
217500                                                                  21750099
217600     MOVE CA-DATE-TERM-EFF-CCYY TO DP010I-UNEDITED-FIELD.         21760099
217700     MOVE 4 TO DP010I-MAXIMUM-DIGITS.                             21770099
217800     MOVE 0 TO DP010I-MAXIMUM-DECIMALS.                           21780099
217900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     21790099
218010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21801099
218020                         USING DP010I-NUMERIC-EDIT-AREA           21802099
218100                                                                  21810099
218200     IF DP010I-ERROR-DETECTED                                     21820099
218300         MOVE DP015-REVERSE TO ADTTEFYH                           21830099
218400         IF PS-NO-EDIT-ERROR                                      21840099
218500             SET PS-EDIT-ERROR TO TRUE                            21850099
218600             SET PM-MESSAGE-INDEX TO 12                           21860099
218700             MOVE -1 TO ADTTEFYL                                  21870099
218800         END-IF                                                   21880099
218900     ELSE                                                         21890099
219000        MOVE DP010I-NUMERIC-FIELD TO PV-DATE-WORK-FLD-4           21900099
219100        MOVE PV-DATE-WORK-FLD-4 TO ADTTEFYO                       21910099
219200                                   CA-DATE-TERM-EFF-CCYY          21920099
219300     END-IF.                                                      21930099
219400                                                                  21940099
219500     MOVE CA-DATE-DISC-EFF-CCYY TO PV-DATE-ISO-CCYY-1             21950099
219600     MOVE CA-DATE-DISC-EFF-MM   TO PV-DATE-ISO-MM-1               21960099
219700     MOVE CA-DATE-DISC-EFF-DD   TO PV-DATE-ISO-DD-1               21970099
219800                                                                  21980099
219900     MOVE CA-DATE-TERM-EFF-CCYY TO PV-DATE-ISO-CCYY-2             21990099
220000     MOVE CA-DATE-TERM-EFF-MM   TO PV-DATE-ISO-MM-2               22000099
220100     MOVE CA-DATE-TERM-EFF-DD   TO PV-DATE-ISO-DD-2               22010099
220200                                                                  22020099
220300     IF PV-DATE-ISO-FORMAT-2 <                                    22030099
220400        PV-DATE-ISO-FORMAT-1                                      22040099
220500        IF PS-NO-EDIT-ERROR                                       22050099
220600           SET PS-EDIT-ERROR TO TRUE                              22060099
220700           SET PM-MESSAGE-INDEX TO 55                             22070099
220800           MOVE DP015-REVERSE TO ADTTEFDH                         22080099
220900                                 ADTTEFMH                         22090099
221000                                 ADTTEFYH                         22100099
221100           MOVE -1 TO ADTTEFML                                    22110099
221200        END-IF                                                    22120099
221300     END-IF.                                                      22130099
221400*----------*                                                      22140099
221500 4575-EXIT.                                                       22150099
221600*----------*                                                      22160099
221700     EXIT.                                                        22170099
221800******************************************************************22180099
221900*  EDIT THE DATE ENTERED.  VERIFY THAT THE DATE IS A LEGITIMATE  *22190099
222000*  CALENDAR DATE.  SET A SWITCH TO INDICATE WHETHER AN ERROR     *22200099
222100*  WAS DETECTED.                                                 *22210099
222200******************************************************************22220099
222300*---------------------------*                                     22230099
222400 4600-VALIDATE-DATE SECTION.                                      22240099
222500*---------------------------*                                     22250099
222600                                                                  22260099
222700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              22270099
222800     SET PS-NO-DATE-EDIT-ERROR          TO TRUE.                  22280099
222900     SET DPG51-ACTUAL-CALENDAR-ONLY     TO TRUE.                  22290099
223000     SET DPG51-DO-NOT-INCR-DECR-DATE    TO TRUE.                  22300099
223100     MOVE DE-EDIT-DATE                  TO DPG52-LK-DATE-INPUT.   22310099
223200     SET DPG52-LK-DTE-GREG              TO TRUE.                  22320099
223300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          22330099
223400                                             DPG53 DPG54          22340099
223500                                             DPG55 DPG56.         22350099
223600     EVALUATE TRUE                                                22360099
223700         WHEN DPG54-SEVERE-ERROR                                  22370099
223800         WHEN DPG54-DATE-INVALID                                  22380099
223900             SET PS-DATE-EDIT-ERROR TO TRUE                       22390099
224000         WHEN OTHER                                               22400099
224100             CONTINUE                                             22410099
224200     END-EVALUATE.                                                22420099
224300*----------*                                                      22430099
224400 4600-EXIT.                                                       22440099
224500*----------*                                                      22450099
224600     EXIT.                                                        22460099
224700                                                                  22470099
224800*---------------------------------------*                         22480099
224900 4650-CHECK-FOR-NAME-CORRECTION SECTION.                          22490099
225000*---------------------------------------*                         22500099
225100     INITIALIZE PS-USE-CONFIRM-FIELD-SW.                          22510099
225200     PERFORM 4700-RECV-CONFIRM-NAME-FIELDS.                       22520099
225300                                                                  22530099
225400     IF PS-USE-CONFIRM-FIELD                                      22540099
225500        PERFORM 4750-EDIT-CONFIRM-NAME-FIELDS                     22550099
225600                                                                  22560099
225700        IF PS-NO-EDIT-ERROR                                       22570099
225800           INITIALIZE CA-EMPLOYEE-NAME                            22580099
225900           STRING                                                 22590099
226000              CA-CONFIRM-LAST-NAME DELIMITED BY '  '              22600099
226100              ','                  DELIMITED BY SIZE              22610099
226200              CA-CONFIRM-FRST-NAME DELIMITED BY '  '              22620099
226300              ' '                  DELIMITED BY SIZE              22630099
226400              CA-CONFIRM-MI-NAME   DELIMITED BY SIZE              22640099
226500           INTO CA-EMPLOYEE-NAME                                  22650099
226600           END-STRING                                             22660099
226700           IF CA-EMPLOYEE-NAME = SPACES                           22670099
226800              MOVE CA-EMPLOYEE-NAME TO AENAMEO                    22680099
226900           ELSE                                                   22690099
227000              MOVE CA-EMPLOYEE-NAME TO PV-EMP-NM-ENC              22700099
227100              PERFORM 6910-BASE64-BINARY                          22710099
227200              PERFORM 6920-DECRYPT-EMPNM                          22720099
227400              PERFORM 6930-ASCII-EBCDIC                           22740099
227500              MOVE DP053-OUTPUT-FIELD TO AENAMEO                  22750099
227600           END-IF                                                 22760099
227700        END-IF                                                    22770099
227800     END-IF.                                                      22780099
227900*----------*                                                      22790099
227910 4650-EXIT.                                                       22791099
227920*----------*                                                      22792099
227930     EXIT.                                                        22793099
227940                                                                  22794099
227950*--------------------------------------*                          22795099
227960 4700-RECV-CONFIRM-NAME-FIELDS SECTION.                           22796099
227970*--------------------------------------*                          22797099
227980     IF AFRSTNML > 0                                              22798099
227990        MOVE AFRSTNMI TO CA-CONFIRM-FRST-NAME                     22799099
228000        SET PS-USE-CONFIRM-FIELD TO TRUE                          22800099
228100     ELSE                                                         22810099
228200        IF AFRSTNMA = PC-EOF-KEYED                                22820099
228300           INITIALIZE CA-CONFIRM-FRST-NAME                        22830099
228400           SET PS-USE-CONFIRM-FIELD TO TRUE                       22840099
228500        END-IF                                                    22850099
228600     END-IF.                                                      22860099
228700                                                                  22870099
228800     IF ALSTNML > 0                                               22880099
228900        MOVE ALSTNMI TO CA-CONFIRM-LAST-NAME                      22890099
229000        SET PS-USE-CONFIRM-FIELD TO TRUE                          22900099
229100     ELSE                                                         22910099
229200        IF ALSTNMA = PC-EOF-KEYED                                 22920099
229300           INITIALIZE CA-CONFIRM-LAST-NAME                        22930099
229400           SET PS-USE-CONFIRM-FIELD TO TRUE                       22940099
229500        END-IF                                                    22950099
229600     END-IF.                                                      22960099
229700                                                                  22970099
229800     IF AMDLNML > 0                                               22980099
229900        MOVE AMDLNMI TO CA-CONFIRM-MI-NAME                        22990099
230000        SET PS-USE-CONFIRM-FIELD TO TRUE                          23000099
230100     ELSE                                                         23010099
230200        IF AMDLNMA = PC-EOF-KEYED                                 23020099
230300           INITIALIZE CA-CONFIRM-MI-NAME                          23030099
230400           SET PS-USE-CONFIRM-FIELD TO TRUE                       23040099
230500        END-IF                                                    23050099
230600     END-IF.                                                      23060099
230700*----------*                                                      23070099
230800 4700-EXIT.                                                       23080099
230900*----------*                                                      23090099
231000     EXIT.                                                        23100099
231100                                                                  23110099
231200*--------------------------------------*                          23120099
231300 4750-EDIT-CONFIRM-NAME-FIELDS SECTION.                           23130099
231400*--------------------------------------*                          23140099
231500     IF CA-CONFIRM-FRST-NAME = SPACES                             23150099
231600        SET PS-EDIT-ERROR TO TRUE                                 23160099
231700        SET PM-MESSAGE-INDEX TO 45                                23170099
231800        MOVE DP015-REVERSE TO AFRSTNMH                            23180099
231900        MOVE -1 TO AFRSTNML                                       23190099
232000     ELSE                                                         23200099
232100        MOVE CA-CONFIRM-FRST-NAME TO PV-NAME-WORK-FLD-1           23210099
232200        PERFORM 4775-FORMAT-NAME-FIELD                            23220099
232300        MOVE PV-NAME-WORK-FLD-1 TO CA-CONFIRM-FRST-NAME           23230099
232400     END-IF.                                                      23240099
232500                                                                  23250099
232600     IF CA-CONFIRM-LAST-NAME = SPACES                             23260099
232700        MOVE DP015-REVERSE TO ALSTNMH                             23270099
232800        IF PS-NO-EDIT-ERROR                                       23280099
232900           SET PS-EDIT-ERROR TO TRUE                              23290099
233000           SET PM-MESSAGE-INDEX TO 45                             23300099
233100           MOVE -1 TO ALSTNML                                     23310099
233200        END-IF                                                    23320099
233300     ELSE                                                         23330099
233400        MOVE CA-CONFIRM-LAST-NAME TO PV-NAME-WORK-FLD-1           23340099
233500        PERFORM 4775-FORMAT-NAME-FIELD                            23350099
233600        MOVE PV-NAME-WORK-FLD-1 TO CA-CONFIRM-LAST-NAME           23360099
233700     END-IF.                                                      23370099
233800                                                                  23380099
233900     IF CA-CONFIRM-MI-NAME NOT = SPACES                           23390099
234000        MOVE CA-CONFIRM-MI-NAME TO PV-NAME-WORK-FLD-1             23400099
234100        PERFORM 4775-FORMAT-NAME-FIELD                            23410099
234200        MOVE PV-NAME-WORK-FLD-1 TO CA-CONFIRM-MI-NAME             23420099
234300     END-IF.                                                      23430099
234400*----------*                                                      23440099
234500 4750-EXIT.                                                       23450099
234600*----------*                                                      23460099
234700     EXIT.                                                        23470099
234800                                                                  23480099
234900*-------------------------------*                                 23490099
235000 4775-FORMAT-NAME-FIELD SECTION.                                  23500099
235100*-------------------------------*                                 23510099
235200     INITIALIZE PV-NAME-WORK-FLD-2                                23520099
235300                PV-NAME-WORK-FLD-3.                               23530099
235400                                                                  23540099
235500     UNSTRING PV-NAME-WORK-FLD-1                                  23550099
235600        DELIMITED BY SPACE                                        23560099
235700        INTO PV-NAME-WORK-FLD-2                                   23570099
235800             PV-NAME-WORK-FLD-3                                   23580099
235900     END-UNSTRING.                                                23590099
236000                                                                  23600099
236100     INITIALIZE PV-NAME-WORK-FLD-2-GROUP                          23610099
236200                PV-NAME-WORK-FLD-3-GROUP.                         23620099
236300                                                                  23630099
236400     MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-2(1:1))            23640099
236500                           TO PV-NAME-WORK-FLD-2-UPPER.           23650099
236600     MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-2(2:29))           23660099
236700                           TO PV-NAME-WORK-FLD-2-LOWER.           23670099
236800                                                                  23680099
236900     IF PV-NAME-WORK-FLD-3 NOT = SPACES                           23690099
237000        MOVE PV-NAME-WORK-FLD-3 TO PS-ALL-CAPS-SUFFIXES           23700099
237100        IF PS-ALL-CAPS                                            23710099
237200           MOVE PV-NAME-WORK-FLD-3 TO PV-NAME-WORK-FLD-3-GROUP    23720099
237300        ELSE                                                      23730099
237400           MOVE FUNCTION UPPER-CASE(PV-NAME-WORK-FLD-3(1:1))      23740099
237500                                 TO PV-NAME-WORK-FLD-3-UPPER      23750099
237600           MOVE FUNCTION LOWER-CASE(PV-NAME-WORK-FLD-3(2:18))     23760099
237700                                 TO PV-NAME-WORK-FLD-3-LOWER      23770099
237800        END-IF                                                    23780099
237900     END-IF.                                                      23790099
238000                                                                  23800099
238100     INITIALIZE PV-NAME-WORK-FLD-1.                               23810099
238200     STRING                                                       23820099
238300        PV-NAME-WORK-FLD-2-GROUP   DELIMITED BY SPACE             23830099
238400        ' '                        DELIMITED BY SIZE              23840099
238500        PV-NAME-WORK-FLD-3-GROUP   DELIMITED BY SPACE             23850099
238600     INTO PV-NAME-WORK-FLD-1                                      23860099
238700     END-STRING.                                                  23870099
238800*----------*                                                      23880099
238900 4775-EXIT.                                                       23890099
239000*----------*                                                      23900099
239100     EXIT.                                                        23910099
239200                                                                  23920099
239300*---------------------------*                                     23930099
239400 4800-GET-SELECTION SECTION.                                      23940099
239500*---------------------------*                                     23950099
239600     SUBTRACT PV-SEARCH-PTR FROM 15                               23960099
239700        GIVING PV-SEL-VALUE END-SUBTRACT.                         23970099
239800                                                                  23980099
239900     IF CA-SEARCH-SELECTION (PV-SEARCH-PTR) = 'S'                 23990099
240000        IF PS-SELECTION-MADE                                      24000099
240100           SET PS-EDIT-ERROR TO TRUE                              24010099
240200           MOVE DP015-REVERSE TO BSELH (PV-SEARCH-PTR)            24020099
240300           MOVE -1 TO BSELL (PV-SEARCH-PTR)                       24030099
240400           SET PM-MESSAGE-INDEX TO 39                             24040099
240500        ELSE                                                      24050099
240600           SET PS-SELECTION-MADE TO TRUE                          24060099
240700           IF CA-FETCH-COUNTER > 14                               24070099
240800             SUBTRACT PV-SEL-VALUE FROM CA-FETCH-COUNTER          24080099
240900                                                    END-SUBTRACT  24090099
241000           ELSE                                                   24100099
241100              MOVE PV-SEARCH-PTR TO CA-FETCH-COUNTER              24110099
241200              SUBTRACT 1 FROM CA-FETCH-COUNTER END-SUBTRACT       24120099
241300           END-IF                                                 24130099
241400        END-IF                                                    24140099
241500     END-IF.                                                      24150099
241600*----------*                                                      24160099
241700 4800-EXIT.                                                       24170099
241800*----------*                                                      24180099
241900     EXIT.                                                        24190099
242000                                                                  24200099
242100*-------------------------------*                                 24210099
242200 5000-INITIALIZE-SCREEN SECTION.                                  24220099
242300*-------------------------------*                                 24230099
242400     PERFORM 6500-UPDATE-SCREEN-HEADER.                           24240099
242500     PERFORM 5300-INITIALIZE-HILIGHTS.                            24250099
242600                                                                  24260099
242700     INITIALIZE AACCTI                                            24270099
242800                AACCT2I                                           24280099
242900                AESTATI                                           24290099
243000                AENAMEI                                           24300099
243100                AECODEI                                           24310099
243200                ADSTATI                                           24320099
243300                ASSNI                                             24330099
243400                ASTOREI                                           24340099
243500                ADTDEFDI                                          24350099
243600                ADTDEFMI                                          24360099
243700                ADTDEFYI                                          24370099
243800                ADTTEFDI                                          24380099
243900                ADTTEFMI                                          24390099
244000                ADTTEFYI                                          24400099
244100                ANOTES1I                                          24410099
244200                ANOTES2I                                          24420099
244300                AFRSTNMI                                          24430099
244400                AMDLNMI                                           24440099
244500                ALSTNMI.                                          24450099
244600                                                                  24460099
244700     MOVE -1 TO ASSNL.                                            24470099
244800     SET CA-PROCESS-SCREEN TO TRUE.                               24480099
244900     SET PM-MESSAGE-INDEX TO 1.                                   24490099
245000*----------*                                                      24500099
245100 5000-EXIT.                                                       24510099
245200*----------*                                                      24520099
245300     EXIT.                                                        24530099
245400                                                                  24540099
245500*-------------------------------*                                 24550099
245600 5100-INITIALIZE-OUTPUT SECTION.                                  24560099
245700*-------------------------------*                                 24570099
245800     INITIALIZE AESTATO                                           24580099
245900                AACCT2O                                           24590099
246000                AENAMEO                                           24600099
246100                AECODEO                                           24610099
246200                ADSTATO                                           24620099
246300                ASTOREO                                           24630099
246400                ADTDEFDO                                          24640099
246500                ADTDEFMO                                          24650099
246600                ADTDEFYO                                          24660099
246700                ADTTEFDO                                          24670099
246800                ADTTEFMO                                          24680099
246900                ADTTEFYO                                          24690099
247000                ANOTES1O                                          24700099
247100                ANOTES2O                                          24710099
247200                AFRSTNMO                                          24720099
247300                AMDLNMO                                           24730099
247400                ALSTNMO.                                          24740099
247500                                                                  24750099
247600     MOVE DP015-PRO-DRK-OFF TO ANONEMA.                           24760099
247700*----------*                                                      24770099
247800 5100-EXIT.                                                       24780099
247900*----------*                                                      24790099
248000     EXIT.                                                        24800099
248100                                                                  24810099
248200*--------------------------------------*                          24820099
248300 5200-INITIALIZE-SEARCH-SCREEN SECTION.                           24830099
248400*--------------------------------------*                          24840099
248500     PERFORM 6500-UPDATE-SCREEN-HEADER.                           24850099
248600                                                                  24860099
248700     INITIALIZE BSELI  (PV-SEARCH-PTR)                            24870099
248800                BNAMEI (PV-SEARCH-PTR)                            24880099
248900                BSSNI  (PV-SEARCH-PTR)                            24890099
249000                BSTRI  (PV-SEARCH-PTR).                           24900099
249100*----------*                                                      24910099
249200 5200-EXIT.                                                       24920099
249300*----------*                                                      24930099
249400     EXIT.                                                        24940099
249500                                                                  24950099
249600*---------------------------------*                               24960099
249700 5300-INITIALIZE-HILIGHTS SECTION.                                24970099
249800*---------------------------------*                               24980099
249900     MOVE DP015-UNDERLINE TO AACCTH                               24990099
250000                             AACCT2H                              25000099
250100                             AESTATH                              25010099
250200                             AENAMEH                              25020099
250300                             AECODEH                              25030099
250400                             ADSTATH                              25040099
250500                             ASSNH                                25050099
250600                             ASTOREH                              25060099
250700                             ADTDEFDH                             25070099
250800                             ADTDEFMH                             25080099
250900                             ADTDEFYH                             25090099
251000                             ADTTEFDH                             25100099
251100                             ADTTEFMH                             25110099
251200                             ADTTEFYH                             25120099
251300                             ANOTES1H                             25130099
251400                             ANOTES2H                             25140099
251500                             AFRSTNMH                             25150099
251600                             AMDLNMH                              25160099
251700                             ALSTNMH                              25170099
251800                             BSRCHH.                              25180099
251900*----------*                                                      25190099
252000 5300-EXIT.                                                       25200099
252100*----------*                                                      25210099
252200     EXIT.                                                        25220099
252300                                                                  25230099
252400*----------------------------------*                              25240099
252500 5400-UNPROTECT-ATTRIBUTES SECTION.                               25250099
252600*----------------------------------*                              25260099
252700     MOVE DP015-UNP-ALP-NOR-OFF TO AACCTA                         25270099
252800                                   AESTATA                        25280099
252900                                   AENAMEA                        25290099
253000                                   AECODEA                        25300099
253100                                   ASSNA                          25310099
253200                                   ASTOREA                        25320099
253300                                   ADTDEFDA                       25330099
253400                                   ADTDEFMA                       25340099
253500                                   ADTDEFYA                       25350099
253600                                   ADTTEFDA                       25360099
253700                                   ADTTEFMA                       25370099
253800                                   ADTTEFYA                       25380099
253900                                   ANOTES1A                       25390099
254000                                   ANOTES2A.                      25400099
254100     IF CA-PROTECT-DISC-FLD                                       25410099
254200        MOVE DP015-PRO-NOR-OFF     TO ADSTATA                     25420099
254300     ELSE                                                         25430099
254400        MOVE DP015-UNP-ALP-NOR-OFF TO ADSTATA                     25440099
254500     END-IF.                                                      25450099
254600                                                                  25460099
254700     MOVE DP015-PRO-NOR-OFF     TO AFRSTNMA                       25470099
254800                                   AMDLNMA                        25480099
254900                                   ALSTNMA.                       25490099
255000*----------*                                                      25500099
255100 5400-EXIT.                                                       25510099
255200*----------*                                                      25520099
255300     EXIT.                                                        25530099
255400                                                                  25540099
255500*--------------------------------*                                25550099
255600 5500-PROTECT-ATTRIBUTES SECTION.                                 25560099
255700*--------------------------------*                                25570099
255800     MOVE DP015-PRO-NOR-OFF TO AACCTA                             25580099
255900                               AESTATA                            25590099
256000                               AENAMEA                            25600099
256100                               AECODEA                            25610099
256200                               ADSTATA                            25620099
256300                               ASSNA                              25630099
256400                               ASTOREA                            25640099
256500                               ADTDEFDA                           25650099
256600                               ADTDEFMA                           25660099
256700                               ADTDEFYA                           25670099
256800                               ADTTEFDA                           25680099
256900                               ADTTEFMA                           25690099
257000                               ADTTEFYA                           25700099
257100                               ANOTES1A                           25710099
257200                               ANOTES2A.                          25720099
257300                                                                  25730099
257400     IF CA-UNPROTECT-NAME                                         25740099
257500        MOVE DP015-UNP-ALP-NOR-OFF TO AFRSTNMA                    25750099
257600                                      AMDLNMA                     25760099
257700                                      ALSTNMA                     25770099
257800     END-IF.                                                      25780099
257900*----------*                                                      25790099
258000 5500-EXIT.                                                       25800099
258100*----------*                                                      25810099
258200     EXIT.                                                        25820099
258300                                                                  25830099
258400*-----------------------------*                                   25840099
258500 5600-GET-USER-ACCESS SECTION.                                    25850099
258600*-----------------------------*                                   25860099
258700     INITIALIZE DP008-SECURITY-COMMAREA.                          25870099
258800     SET DP008-RSRC-TYPE-FUNC     TO TRUE.                        25880099
258900     MOVE PC-FUNCTION-NAME        TO DP008-RESOURCE-NAME.         25890099
259000     SET DP008-ACCESS-TYPE-USE    TO TRUE.                        25900099
259100                                                                  25910099
259200     EXEC CICS LINK                                               25920099
259300               PROGRAM  (DP008-SECURITY-SUBROUTINE)               25930099
259400               COMMAREA (DP008-SECURITY-COMMAREA)                 25940099
259500               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          25950099
259600     END-EXEC.                                                    25960099
259700                                                                  25970099
259800     IF DP008-CALL-SUCCESSFUL                                     25980099
259900        IF  DP008-ACCESS-ALLOWED                                  25990099
260000           MOVE DP015-UNP-ALP-NOR-OFF TO ADSTATA                  26000099
260100        ELSE                                                      26010099
260200           SET CA-PROTECT-DISC-FLD    TO TRUE                     26020099
260300           MOVE DP015-PRO-NOR-OFF     TO ADSTATA                  26030099
260400        END-IF                                                    26040099
260500                                                                  26050099
260600     ELSE                                                         26060099
260700        MOVE 'ARKCS002 - SECURITY REQUEST FAILED' TO              26070099
260800             PV-LEAVE-SYSTEM-MESSAGE                              26080099
260900        PERFORM 9900-LEAVE-SYSTEM                                 26090099
261000     END-IF.                                                      26100099
261100*----------*                                                      26110099
261200 5600-EXIT.                                                       26120099
261300*----------*                                                      26130099
261400     EXIT.                                                        26140099
261500                                                                  26150099
261600*----------------------------------------------------------       26160099
261700* 6000 THRU 6500 - CICS PROCESSING                                26170099
261800*----------------------------------------------------------       26180099
261900*----------------------*                                          26190099
262000 6000-SEND-MAP SECTION.                                           26200099
262100*----------------------*                                          26210099
262200     MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO AMSGO.         26220099
262300     EXEC CICS                                                    26230099
262400         SEND                                                     26240099
262500             MAP      ('AR002A')                                  26250099
262600             MAPSET   ('ARKM002')                                 26260099
262700             ERASE                                                26270099
262800             CURSOR                                               26280099
262900             FORMFEED                                             26290099
263000             RESP     (PV-CICS-RESPONSE)                          26300099
263100     END-EXEC.                                                    26310099
263200                                                                  26320099
263300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    26330099
263400         MOVE 'SEND THE DATA AFTER CLEARING' TO                   26340099
263500                   SE-ATTEMPTED-ACTION                            26350099
263600         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                26360099
263700         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  26370099
263800         PERFORM 9900-LEAVE-SYSTEM                                26380099
263900     END-IF.                                                      26390099
264000*----------*                                                      26400099
264100 6000-EXIT.                                                       26410099
264200*----------*                                                      26420099
264300     EXIT.                                                        26430099
264400                                                                  26440099
264500*-----------------------------*                                   26450099
264600 6100-SEND-SEARCH-MAP SECTION.                                    26460099
264700*-----------------------------*                                   26470099
264800     MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO BMSGO.         26480099
264900     EXEC CICS                                                    26490099
265000         SEND                                                     26500099
265100             MAP      ('AR002B')                                  26510099
265200             MAPSET   ('ARKM002')                                 26520099
265300             ERASE                                                26530099
265400             CURSOR                                               26540099
265500             FORMFEED                                             26550099
265600             RESP     (PV-CICS-RESPONSE)                          26560099
265700     END-EXEC.                                                    26570099
265800                                                                  26580099
265900     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    26590099
266000         MOVE 'SEND THE DATA AFTER CLEARING' TO                   26600099
266100                   SE-ATTEMPTED-ACTION                            26610099
266200         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                26620099
266300         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  26630099
266400         PERFORM 9900-LEAVE-SYSTEM                                26640099
266500     END-IF.                                                      26650099
266600*----------*                                                      26660099
266700 6100-EXIT.                                                       26670099
266800*----------*                                                      26680099
266900     EXIT.                                                        26690099
267000                                                                  26700099
267100*--------------------------------------*                          26710099
267200 6150-SEND-SEARCH-MAP-DATAONLY SECTION.                           26720099
267300*--------------------------------------*                          26730099
267400     MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO BMSGO.         26740099
267500                                                                  26750099
267600     EXEC CICS                                                    26760099
267700         SEND                                                     26770099
267800             MAP      ('AR002B')                                  26780099
267900             MAPSET   ('ARKM002')                                 26790099
268000             DATAONLY                                             26800099
268100             CURSOR                                               26810099
268200             FORMFEED                                             26820099
268300             RESP     (PV-CICS-RESPONSE)                          26830099
268400     END-EXEC.                                                    26840099
268500                                                                  26850099
268600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    26860099
268700         MOVE 'SEND THE DATA AFTER EDITING' TO                    26870099
268800                   SE-ATTEMPTED-ACTION                            26880099
268900         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                26890099
269000         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  26900099
269100         PERFORM 9900-LEAVE-SYSTEM                                26910099
269200     END-IF.                                                      26920099
269300*----------*                                                      26930099
269400 6150-EXIT.                                                       26940099
269500*----------*                                                      26950099
269600     EXIT.                                                        26960099
269700                                                                  26970099
269800*-------------------------------*                                 26980099
269900 6200-SEND-MAP-DATAONLY SECTION.                                  26990099
270000*-------------------------------*                                 27000099
270100     MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO AMSGO.         27010099
270200                                                                  27020099
270300     EXEC CICS                                                    27030099
270400         SEND                                                     27040099
270500             MAP      ('AR002A')                                  27050099
270600             MAPSET   ('ARKM002')                                 27060099
270700             DATAONLY                                             27070099
270800             CURSOR                                               27080099
270900             FORMFEED                                             27090099
271000             RESP     (PV-CICS-RESPONSE)                          27100099
271100     END-EXEC.                                                    27110099
271200                                                                  27120099
271300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    27130099
271400         MOVE 'SEND THE DATA AFTER EDITING' TO                    27140099
271500                   SE-ATTEMPTED-ACTION                            27150099
271600         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                27160099
271700         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  27170099
271800         PERFORM 9900-LEAVE-SYSTEM                                27180099
271900     END-IF.                                                      27190099
272000*----------*                                                      27200099
272100 6200-EXIT.                                                       27210099
272200*----------*                                                      27220099
272300     EXIT.                                                        27230099
272400                                                                  27240099
272500*-------------------------*                                       27250099
272600 6300-RECEIVE-MAP SECTION.                                        27260099
272700*-------------------------*                                       27270099
272800     EXEC CICS                                                    27280099
272900         RECEIVE                                                  27290099
273000             MAP    ('AR002A')                                    27300099
273100             MAPSET ('ARKM002')                                   27310099
273200             ASIS                                                 27320099
273300             RESP   (PV-CICS-RESPONSE)                            27330099
273400     END-EXEC.                                                    27340099
273500                                                                  27350099
273600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL) AND                27360099
273700                         NOT = DFHRESP(MAPFAIL)                   27370099
273800        MOVE 'RECEIVE THE MAP' TO SE-ATTEMPTED-ACTION             27380099
273900        MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                 27390099
274000        MOVE SE-SYSTEM-ERROR-MESSAGE TO                           27400099
274100             PV-LEAVE-SYSTEM-MESSAGE                              27410099
274200        PERFORM 9900-LEAVE-SYSTEM                                 27420099
274300     END-IF.                                                      27430099
274400*----------*                                                      27440099
274500 6300-EXIT.                                                       27450099
274600*----------*                                                      27460099
274700     EXIT.                                                        27470099
274800                                                                  27480099
274900*--------------------------------*                                27490099
275000 6350-RECEIVE-SEARCH-MAP SECTION.                                 27500099
275100*--------------------------------*                                27510099
275200     EXEC CICS                                                    27520099
275300         RECEIVE                                                  27530099
275400             MAP    ('AR002B')                                    27540099
275500             MAPSET ('ARKM002')                                   27550099
275600             ASIS                                                 27560099
275700             RESP   (PV-CICS-RESPONSE)                            27570099
275800     END-EXEC.                                                    27580099
275900                                                                  27590099
276000     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL) AND                27600099
276100                         NOT = DFHRESP(MAPFAIL)                   27610099
276200        MOVE 'RECEIVE THE SEARCH MAP' TO SE-ATTEMPTED-ACTION      27620099
276300        MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                 27630099
276400        MOVE SE-SYSTEM-ERROR-MESSAGE TO                           27640099
276500             PV-LEAVE-SYSTEM-MESSAGE                              27650099
276600        PERFORM 9900-LEAVE-SYSTEM                                 27660099
276700     END-IF.                                                      27670099
276800*----------*                                                      27680099
276900 6350-EXIT.                                                       27690099
277000*----------*                                                      27700099
277100     EXIT.                                                        27710099
277200                                                                  27720099
277300*--------------------*                                            27730099
277400 6400-RETURN SECTION.                                             27740099
277500*--------------------*                                            27750099
277600     EXEC CICS                                                    27760099
277700         RETURN                                                   27770099
277800             TRANSID  ('A002')                                    27780099
277900             COMMAREA (CA-COMMON-AREA)                            27790099
278000             LENGTH   (PC-COMMON-AREA-LENGTH)                     27800099
278100             RESP     (PV-CICS-RESPONSE)                          27810099
278200     END-EXEC.                                                    27820099
278300                                                                  27830099
278400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    27840099
278500         MOVE 'RETURN AFTER THE EDITED MAP SEND' TO               27850099
278600                   SE-ATTEMPTED-ACTION                            27860099
278700         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                27870099
278800         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  27880099
278900         PERFORM 9900-LEAVE-SYSTEM                                27890099
279000     END-IF.                                                      27900099
279100*----------*                                                      27910099
279200 6400-EXIT.                                                       27920099
279300*----------*                                                      27930099
279400     EXIT.                                                        27940099
279500                                                                  27950099
279600******************************************************************27960099
279700*  FILL IN THE SCREEN HEADER WITH THE DATE, TIME, AND TERMINAL   *27970099
279800*  NUMBER.                                                       *27980099
279900******************************************************************27990099
280000*----------------------------------*                              28000099
280100 6500-UPDATE-SCREEN-HEADER SECTION.                               28010099
280200*----------------------------------*                              28020099
280300     EXEC CICS                                                    28030099
280400         ASKTIME                                                  28040099
280500             ABSTIME (ST-ABSTIME)                                 28050099
280600     END-EXEC.                                                    28060099
280700                                                                  28070099
280800      EXEC CICS                                                   28080099
280900          FORMATTIME                                              28090099
281000          ABSTIME (ST-ABSTIME)                                    28100099
281100          MMDDYY  (ADATEO)                                        28110099
281200          DATESEP                                                 28120099
281300          TIME    (ST-TIME-EDIT)                                  28130099
281400          TIMESEP                                                 28140099
281500      END-EXEC.                                                   28150099
281600                                                                  28160099
281700     EXEC CICS                                                    28170099
281800         FORMATTIME                                               28180099
281900         ABSTIME (ST-ABSTIME)                                     28190099
282000         MMDDYY  (BDATEO)                                         28200099
282100         DATESEP                                                  28210099
282200         TIME    (ST-TIME-EDIT)                                   28220099
282300         TIMESEP                                                  28230099
282400     END-EXEC.                                                    28240099
282500                                                                  28250099
282600     EXEC CICS                                                    28260099
282700         FORMATTIME                                               28270099
282800         ABSTIME  (ST-ABSTIME)                                    28280099
282900         YYMMDD   (PV-CURRENT-DATE-YMD)                           28290099
283000         MMDDYYYY (PV-CURRENT-DATE-MDCY)                          28300099
283100         MMDDYY   (PV-CURRENT-DATE-MDY)                           28310099
283200         TIME     (PV-CURRENT-TIME)                               28320099
283300     END-EXEC.                                                    28330099
283400                                                                  28340099
283500     EXEC CICS                                                    28350099
283600         FORMATTIME                                               28360099
283700             ABSTIME (ST-ABSTIME)                                 28370099
283800             YYMMDD  (IC-FORMATTED-DATE-YMD)                      28380099
283900             DATESEP ('-')                                        28390099
284000     END-EXEC.                                                    28400099
284100                                                                  28410099
284200     EXEC CICS                                                    28420099
284300         FORMATTIME                                               28430099
284400             ABSTIME (ST-ABSTIME)                                 28440099
284500             YEAR    (PV-CURRENT-YEAR)                            28450099
284600     END-EXEC.                                                    28460099
284700                                                                  28470099
284800     MOVE PV-CURRENT-YEAR TO IC-CURRENT-YEAR.                     28480099
284900                                                                  28490099
285000     EXEC CICS                                                    28500099
285100         ASSIGN                                                   28510099
285200             USERID  (PV-USER-ID)                                 28520099
285300     END-EXEC.                                                    28530099
285400                                                                  28540099
285500     MOVE ST-TIME-HHMM TO ATIMEO.                                 28550099
285600     MOVE ST-TIME-HHMM TO BTIMEO.                                 28560099
285700                                                                  28570099
285800     MOVE EIBTRMID TO ATERMO                                      28580099
285900                      BTERMO.                                     28590099
286000*----------*                                                      28600099
286100 6500-EXIT.                                                       28610099
286200*----------*                                                      28620099
286300     EXIT.                                                        28630099
286400                                                                  28640099
286500*--------------------------------*                                28650099
286600 6600-WRITE-SEARCH-QUEUE SECTION.                                 28660099
286700*--------------------------------*                                28670099
286800     EXEC CICS                                                    28680099
286900        WRITEQ TS QUEUE('SEARCH')                                 28690099
287000        FROM(PV-EMP-SEARCH-GROUP)                                 28700099
287100        LENGTH(PC-SEARCH-QUEUE-LENGTH)                            28710099
287200        AUXILIARY                                                 28720099
287300     END-EXEC.                                                    28730099
287400*----------*                                                      28740099
287500 6600-EXIT.                                                       28750099
287600*----------*                                                      28760099
287700     EXIT.                                                        28770099
287800                                                                  28780099
287900*-------------------------------*                                 28790099
288000 6625-READ-SEARCH-QUEUE SECTION.                                  28800099
288100*-------------------------------*                                 28810099
288200     ADD 1 TO CA-FETCH-COUNTER END-ADD.                           28820099
288300                                                                  28830099
288400     EXEC CICS                                                    28840099
288500        READQ TS QUEUE('SEARCH')                                  28850099
288600        INTO(PV-EMP-SRCH-TABLE (PV-SEARCH-PTR))                   28860099
288700        LENGTH(PC-SEARCH-QUEUE-LENGTH)                            28870099
288800        ITEM(CA-FETCH-COUNTER)                                    28880099
288900        RESP(PV-CICS-RESPONSE)                                    28890099
289000     END-EXEC.                                                    28900099
289100                                                                  28910099
289200     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        28920099
289300        CONTINUE                                                  28930099
289400     ELSE                                                         28940099
289500        IF PV-CICS-RESPONSE = DFHRESP(ITEMERR)                    28950099
289600           SET PS-READQ-EOF TO TRUE                               28960099
289700        ELSE                                                      28970099
289800           IF PV-CICS-RESPONSE = DFHRESP(QIDERR)                  28980099
289900              SET PS-READQ-EOF TO TRUE                            28990099
290000              SET PM-MESSAGE-INDEX TO 41                          29000099
290100           ELSE                                                   29010099
290200              MOVE 'READQ TS'              TO SE-ATTEMPTED-ACTION 29020099
290300              MOVE PV-CICS-RESPONSE        TO SE-CICS-RESPONSE    29030099
290400              MOVE SE-SYSTEM-ERROR-MESSAGE TO                     29040099
290500                   PV-LEAVE-SYSTEM-MESSAGE                        29050099
290600              PERFORM 9900-LEAVE-SYSTEM                           29060099
290700           END-IF                                                 29070099
290800        END-IF                                                    29080099
290900     END-IF.                                                      29090099
291000*----------*                                                      29100099
291100 6625-EXIT.                                                       29110099
291200*----------*                                                      29120099
291300     EXIT.                                                        29130099
291400                                                                  29140099
291500*---------------------------------*                               29150099
291600 6650-DELETE-SEARCH-QUEUE SECTION.                                29160099
291700*---------------------------------*                               29170099
291800     EXEC CICS                                                    29180099
291900        DELETEQ TS QUEUE('SEARCH')                                29190099
292000        RESP     (PV-CICS-RESPONSE)                               29200099
292100     END-EXEC.                                                    29210099
292200                                                                  29220099
292300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL) AND                29230099
292400        PV-CICS-RESPONSE NOT = DFHRESP(QIDERR)                    29240099
292500         MOVE 'FATAL DELETEQ ERROR' TO                            29250099
292600                   SE-ATTEMPTED-ACTION                            29260099
292700         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                29270099
292800         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  29280099
292900         PERFORM 9900-LEAVE-SYSTEM                                29290099
293000     END-IF.                                                      29300099
293100*----------*                                                      29310099
293200 6650-EXIT.                                                       29320099
293300*----------*                                                      29330099
293400     EXIT.                                                        29340099
293500                                                                  29350099
293600*----------------------------------*                              29360099
293700 6700-WRITE-READNEXT-QUEUE SECTION.                               29370099
293800*----------------------------------*                              29380099
293900     EXEC CICS                                                    29390099
294000        WRITEQ TS QUEUE('READNEXT')                               29400099
294100        FROM(PV-TEMP-READNEXT-REC)                                29410099
294200        LENGTH(PC-READNEXT-QUEUE-LENGTH)                          29420099
294300        AUXILIARY                                                 29430099
294400     END-EXEC.                                                    29440099
294500*----------*                                                      29450099
294600 6700-EXIT.                                                       29460099
294700*----------*                                                      29470099
294800     EXIT.                                                        29480099
294900                                                                  29490099
295000*---------------------------------*                               29500099
295100 6725-READ-READNEXT-QUEUE SECTION.                                29510099
295200*---------------------------------*                               29520099
295300     EXEC CICS                                                    29530099
295400        READQ TS QUEUE('READNEXT')                                29540099
295500        INTO(PV-TEMP-READNEXT-REC)                                29550099
295600        LENGTH(PC-READNEXT-QUEUE-LENGTH)                          29560099
295700        ITEM(CA-FETCH-COUNTER)                                    29570099
295800        RESP(PV-CICS-RESPONSE)                                    29580099
295900     END-EXEC.                                                    29590099
296000                                                                  29600099
296100     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        29610099
296200        CONTINUE                                                  29620099
296300     ELSE                                                         29630099
296400        MOVE 'READQ TS'              TO SE-ATTEMPTED-ACTION       29640099
296500        MOVE PV-CICS-RESPONSE        TO SE-CICS-RESPONSE          29650099
296600        MOVE SE-SYSTEM-ERROR-MESSAGE TO                           29660099
296700             PV-LEAVE-SYSTEM-MESSAGE                              29670099
296800        PERFORM 9900-LEAVE-SYSTEM                                 29680099
296900     END-IF.                                                      29690099
297000*----------*                                                      29700099
297100 6725-EXIT.                                                       29710099
297200*----------*                                                      29720099
297300     EXIT.                                                        29730099
297400                                                                  29740099
297500*-----------------------------------*                             29750099
297600 6750-DELETE-READNEXT-QUEUE SECTION.                              29760099
297700*-----------------------------------*                             29770099
297800     EXEC CICS                                                    29780099
297900        DELETEQ TS QUEUE('READNEXT')                              29790099
298000        RESP     (PV-CICS-RESPONSE)                               29800099
298100     END-EXEC.                                                    29810099
298200                                                                  29820099
298300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL) AND                29830099
298400        PV-CICS-RESPONSE NOT = DFHRESP(QIDERR)                    29840099
298500         MOVE 'FATAL DELETEQ ERROR' TO                            29850099
298600                   SE-ATTEMPTED-ACTION                            29860099
298700         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                29870099
298800         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  29880099
298900         PERFORM 9900-LEAVE-SYSTEM                                29890099
299000     END-IF.                                                      29900099
299100*----------*                                                      29910099
299200 6750-EXIT.                                                       29920099
299300*----------*                                                      29930099
299400     EXIT.                                                        29940099
299500                                                                  29950099
299600******************************************************************29960099
299700* CALLS THE PROTEGRITY MODULE TO DETOKENIZE THE SSN FIELD.       *29970099
299800******************************************************************29980099
299900 6900-DETOKEN-SSN SECTION.                                        29990099
300000                                                                  30000099
300100     INITIALIZE CSI-PARAMETERS                                    30010099
300200                DP031-PROTEG-PGM-PARAMETERS                       30020099
300300                PV-INPUT-LEN.                                     30030099
300400                                                                  30040099
300500     INSPECT FUNCTION REVERSE(PV-SSN-NUMBER)                      30050099
300600           TALLYING PV-INPUT-LEN FOR LEADING SPACES.              30060099
300700     COMPUTE PV-INPUT-LEN = LENGTH OF PV-SSN-NUMBER - PV-INPUT-LEN30070099
300800     IF PV-INPUT-LEN NOT = 9                                      30080099
300900        CONTINUE                                                  30090099
301000     ELSE                                                         30100099
301100        MOVE 'SSN-NUMBER'            TO DP031-FIELD               30110099
301200        SET CSI-DECRYPT-FUNCTION     TO TRUE                      30120099
301300        SET DP031-SSN                TO TRUE                      30130099
301400        MOVE PV-SSN-NUMBER           TO DP031-CIPHER-TEXT         30140099
301500        MOVE PV-INPUT-LEN            TO DP031-INPUT-LEN           30150099
301600        PERFORM DP032-0000-PROTG-TOKEN-DETOKEN                    30160099
301700        MOVE DP031-CLEAR-TEXT        TO PV-SSN-NUMBER             30170099
301800     END-IF.                                                      30180099
301900                                                                  30190099
302000*---------*                                                       30200099
302100 6900-EXIT.                                                       30210099
302200*---------*                                                       30220099
302300     EXIT.                                                        30230099
302400                                                                  30240099
302500******************************************************************30250099
302600* CONVERTS THE DATA FROM BASE64 TO BINARY FORMAT.                *30260099
302700******************************************************************30270099
302800 6910-BASE64-BINARY SECTION.                                      30280099
302900                                                                  30290099
303000     INITIALIZE PV-INPUT-TEXT                                     30300099
303100                PV-OUTPUT-TEXT                                    30310099
303200                PV-INPUT-LEN.                                     30320099
303300                                                                  30330099
303400     INSPECT PV-EMP-NM-ENC TALLYING PV-INPUT-LEN                  30340099
303500             FOR CHARACTERS BEFORE INITIAL SPACE.                 30350099
303600     MOVE PV-EMP-NM-ENC       TO PV-INPUT-TEXT.                   30360099
303700     MOVE PV-INPUT-LEN        TO DP022-INLEN.                     30370099
303800     MOVE 66                  TO DP022-OUTLEN-IN.                 30380099
303900     CALL  DP022-MGCXR2B  USING DP022-PARMS,                      30390099
304000                                PV-INPUT-TEXT,                    30400099
304100                                PV-OUTPUT-TEXT.                   30410099
304200     IF RETURN-CODE NOT EQUAL 0                                   30420099
304300        MOVE RETURN-CODE      TO  DP031-RETURN-CODE               30430099
304400        STRING 'ERROR IN BASE64 TO BINARY' DELIMITED BY SIZE      30440099
304500               ' - RC = '                  DELIMITED BY SIZE      30450099
304600               DP031-RETURN-CODE           DELIMITED BY SIZE      30460099
304700                                 INTO DP013-MESSAGE-TEXT (1)      30470099
304800        STRING 'EMP-NAME = '               DELIMITED BY SIZE      30480099
304900               PV-EMP-NM-ENC               DELIMITED BY SIZE      30490099
305000                                 INTO DP013-MESSAGE-TEXT (2)      30500099
305100        SET DP013-LOGIC-ABEND TO TRUE                             30510099
305200        SET DP013-NO-ROLLBACK TO TRUE                             30520099
305300        MOVE "6910-BASE64-BINARY"                                 30530099
305400                              TO DP013-PARAGRAPH                  30540099
305500        PERFORM DP013-0000-PROCESS-ABEND                          30550099
305600     END-IF.                                                      30560099
305700                                                                  30570099
305800*---------*                                                       30580099
305900 6910-EXIT.                                                       30590099
306000*---------*                                                       30600099
306100     EXIT.                                                        30610099
306200                                                                  30620099
306300******************************************************************30630099
306400* CALLS THE PROTEGRITY MODULE TO DECRYPT THE EMPLOYEE NAME.       30640099
306500* RETURNED EMPLOYEE NAME VALUE WILL BE IN ASCII FORMAT.           30650099
306600******************************************************************30660099
306700 6920-DECRYPT-EMPNM SECTION.                                      30670099
306800                                                                  30680099
306900     INITIALIZE CSI-PARAMETERS                                    30690099
307000                DP031-PROTEG-PGM-PARAMETERS.                      30700099
307100     SET CSI-DECRYPT-FUNCTION     TO TRUE.                        30710099
307200     SET DP031-CUST-INFO          TO TRUE.                        30720099
307300     MOVE 'EMP-NAME'              TO DP031-FIELD.                 30730099
307400     MOVE DP022-OUTLEN-OUT        TO CSI-CIPHER-TEXT-LENGTH.      30740099
307500     MOVE 50                      TO CSI-CLEAR-TEXT-LENGTH.       30750099
307600     MOVE PV-OUTPUT-TEXT          TO DP031-CIPHER-TEXT.           30760099
307700     PERFORM DP032-1000-PROTG-ENCRYP-DECRYP.                      30770099
307800                                                                  30780099
307900*---------*                                                       30790099
308000 6920-EXIT.                                                       30800099
308100*---------*                                                       30810099
308200     EXIT.                                                        30820099
308300                                                                  30830099
308400******************************************************************30840099
308500* CONVERTS THE DATA FROM ASCII TO EBCDIC FORMAT                   30850099
308600******************************************************************30860099
308700 6930-ASCII-EBCDIC SECTION.                                       30870099
308800                                                                  30880099
308900     INITIALIZE DP053-EBCDIC-ASCII-PARMS.                         30890099
309000                                                                  30900099
309100     SET  DP053-CT-ASCII-TO-EBCDIC TO TRUE.                       30910099
309200     MOVE DP031-CLEAR-TEXT      TO DP053-INPUT-FIELD.             30920099
309300     MOVE CSI-CLEAR-TEXT-LENGTH TO DP053-FIELD-LENGTH.            30930099
309400                                                                  30940099
309500     CALL DP053-EBCDIC-ASCII-ROUTINE USING DP053-CONVERSION-TYPE  30950099
309600                                           DP053-FIELD-LENGTH     30960099
309700                                           DP053-INPUT-FIELD      30970099
309800                                           DP053-OUTPUT-FIELD     30980099
309900                                           DP053-RETURN-CODE.     30990099
310000     IF NOT DP053-RC-SUCCESSFUL                                   31000099
310100        MOVE DP053-RETURN-CODE TO DP031-RETURN-CODE               31010099
310200        STRING 'ERROR IN ASCII TO EBCDIC'  DELIMITED BY SIZE      31020099
310300               ' - RC = '                  DELIMITED BY SIZE      31030099
310400               DP031-RETURN-CODE           DELIMITED BY SIZE      31040099
310500                                 INTO DP013-MESSAGE-TEXT (1)      31050099
310600        STRING 'EMP-NAME = '               DELIMITED BY SIZE      31060099
310700               PV-EMP-NM-ENC               DELIMITED BY SIZE      31070099
310800                                 INTO DP013-MESSAGE-TEXT (2)      31080099
310900        SET DP013-LOGIC-ABEND TO TRUE                             31090099
311000        SET DP013-NO-ROLLBACK TO TRUE                             31100099
311100        MOVE "6930-ASCII-EBCDIC"                                  31110099
311200                              TO DP013-PARAGRAPH                  31120099
311300        PERFORM DP013-0000-PROCESS-ABEND                          31130099
311400     END-IF.                                                      31140099
311500                                                                  31150099
311600*---------*                                                       31160099
311700 6930-EXIT.                                                       31170099
311800*---------*                                                       31180099
311900     EXIT.                                                        31190099
312000                                                                  31200099
312100******************************************************************31210099
312200* CALLS THE PROTEGRITY MODULE TO DETOKENIZE THE ACCOUNT NUMBER.  *31220099
312300******************************************************************31230099
312400 6940-DETOKEN-ACCT SECTION.                                       31240099
312500                                                                  31250099
312600     INITIALIZE CSI-PARAMETERS                                    31260099
312700                DP031-PROTEG-PGM-PARAMETERS.                      31270099
312800                                                                  31280099
312900     MOVE 'ACCOUNT-NBR'           TO DP031-FIELD.                 31290099
313000     SET CSI-DECRYPT-FUNCTION     TO TRUE.                        31300099
313100     SET DP031-ACCTNBR            TO TRUE.                        31310099
313200     MOVE PV-ACCOUNT-NBR-12       TO DP031-CIPHER-TEXT.           31320099
313300     MOVE 12                      TO DP031-INPUT-LEN.             31330099
313400     PERFORM DP032-0000-PROTG-TOKEN-DETOKEN.                      31340099
313500     MOVE DP031-CLEAR-TEXT(1:10)  TO PV-ACCOUNT-NBR-10.           31350099
313600                                                                  31360099
313700*---------*                                                       31370099
313800 6940-EXIT.                                                       31380099
313900*---------*                                                       31390099
314000     EXIT.                                                        31400099
314100                                                                  31410099
314200***********************************************************       31420099
314300*              7000 THRU 7999 - DB2 PROCESSING                    31430099
314400***********************************************************       31440099
314500*----------------------------------------------------------       31450099
314600* 7000 THRU 7075 - DB2 SELECTS                                    31460099
314700*----------------------------------------------------------       31470099
314800*------------------------------------*                            31480099
314900 7000-SELECT-ART-ROW-SSN SECTION.                                 31490099
315000*------------------------------------*                            31500099
315100     INITIALIZE ART00001-DISC-DTE                                 31510099
315200                ART00001-TERM-DTE.                                31520099
315300                                                                  31530099
315400     IF EIBAID = DFHPF9                                           31540099
315500        MOVE ART00001-SSN-NBR TO PV-TOKEN-SS-NBR                  31550099
315600     ELSE                                                         31560099
315700        PERFORM 7020-TOKENIZE-SSN                                 31570099
315800     END-IF.                                                      31580099
315900                                                                  31590099
316000     EXEC SQL                                                     31600099
316100            SELECT                                                31610099
316200                ACCT_NBR                                          31620099
316300               ,EMP_ID                                            31630099
316400               ,DISC_STAT_CDE                                     31640099
316500               ,CMNT_TXT                                          31650099
316600               ,EMP_NM                                            31660099
316700               ,LOC_NBR                                           31670099
316800               ,EMP_STAT_CDE                                      31680099
316900               ,EMP_TYP_CDE                                       31690099
317000               ,DISC_DTE                                          31700099
317100               ,TERM_DTE                                          31710099
317200         INTO :ART00001-ACCT-NBR                                  31720099
317300             ,:ART00001-EMP-ID                                    31730099
317400             ,:ART00001-DISC-STAT-CDE                             31740099
317500             ,:ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT            31750099
317600             ,:ART00001-EMP-NM                                    31760099
317700             ,:ART00001-LOC-NBR                                   31770099
317800             ,:ART00001-EMP-STAT-CDE                              31780099
317900             ,:ART00001-EMP-TYP-CDE                               31790099
318000             ,:ART00001-DISC-DTE:IND-ART00001-DISC-DTE            31800099
318100             ,:ART00001-TERM-DTE:IND-ART00001-TERM-DTE            31810099
318200            FROM ART_EMP_DISC                                     31820099
318300            WHERE SSN_NBR  = :PV-TOKEN-SS-NBR                     31830099
318400     END-EXEC.                                                    31840099
318500                                                                  31850099
318600     EVALUATE TRUE                                                31860099
318700         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     31870099
318900         WHEN SQLCODE = PC-MORE-ROWS-SQLCODE                      31890099
319000            SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                 31900099
319100            SET PS-NO-EDIT-ERROR TO TRUE                          31910099
319200            IF ART00001-LOC-NBR = 900                             31920099
319300               MOVE '0880' TO ART00001-LOC-NBR                    31930099
319310            END-IF                                                31931099
319320                                                                  31932099
319330            IF ART00001-EMP-STAT-CDE = 'D' OR 'R' OR 'T' OR 'U'   31933099
319340                                    OR 'V' OR 'S'                 31934099
319350               MOVE 'T' TO ART00001-EMP-STAT-CDE                  31935099
319360            ELSE                                                  31936099
319370               MOVE 'A' TO ART00001-EMP-STAT-CDE                  31937099
319380            END-IF                                                31938099
319390         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  31939099
319391            SET PS-EDIT-ERROR          TO TRUE                    31939199
319392         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     31939299
319393             MOVE 'ART_EMP_DISC    ' TO PV-SQL-TABLE-NAME         31939399
319394             SET PS-SELECT-TEXT TO TRUE                           31939499
319395             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              31939599
319396             PERFORM 7998-STRING-SQL-FATAL-ERROR                  31939699
319397         WHEN OTHER                                               31939799
319398             MOVE 'ART_EMP_DISC       ' TO PV-SQL-TABLE-NAME      31939899
319399             SET PS-SELECT-TEXT TO TRUE                           31939999
319400             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              31940099
319500             PERFORM 7999-STRING-SQL-FATAL-WARNING                31950099
319600     END-EVALUATE.                                                31960099
319700*----------*                                                      31970099
319800 7000-EXIT.                                                       31980099
319900*----------*                                                      31990099
320000     EXIT.                                                        32000099
320100                                                                  32010099
320200*-------------------------------*                                 32020099
320300*7010-SELECT-RE-HIRE-DTE SECTION.                                 32030099
320400*-------------------------------*                                 32040099
320500                                                                  32050099
320600*    EXEC SQL                                                     32060099
320700*        SELECT B.HIR_DTE                                         32070099
320800*        INTO :XST00076-HIR-DTE:IND-XST00076-HIR-DTE              32080099
320900*        FROM XST_ASSOC A, XST_ASSOC_EMPT B                       32090099
321000*        WHERE A.SS_NBR = :XST00072-SS-NBR                        32100099
321100*          AND  A.ASSOC_ID = B.ASSOC_ID                           32110099
321200*          AND  B.ASSOC_EMPT_NBR = 0                              32120099
321300*          AND  B.BEG_DTE        = (SELECT MAX(X.BEG_DTE)         32130099
321400*                               FROM XST_ASSOC_EMPT X             32140099
321500*                               WHERE X.ASSOC_ID = B.ASSOC_ID     32150099
321600*                                AND X.BEG_DTE <= CURRENT DATE    32160099
321700*                                AND X.ACTN_CDE = 'REH')          32170099
321800*          AND B.ASSOC_EMPT_SEQ_NBR                               32180099
321900*                            =                                    32190099
322000*                           (SELECT MAX(X.ASSOC_EMPT_SEQ_NBR)     32200099
322100*                            FROM XST_ASSOC_EMPT X                32210099
322200*                            WHERE X.ASSOC_ID = B.ASSOC_ID        32220099
322300*                              AND X.BEG_DTE = B.BEG_DTE          32230099
322400*                              AND X.ACTN_CDE = 'REH')            32240099
322500** THIS FIELD HOLDS A 'D' FOR LOGICAL DELETES.                    32250099
322600*          AND B.LAST_ACTN_CDE <> 'D'                             32260099
322700*          AND B.ACTN_CDE = 'REH'                                 32270099
322800*    END-EXEC.                                                    32280099
322900                                                                  32290099
323000*    EVALUATE TRUE                                                32300099
323100*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     32310099
323200*           IF IND-XST00076-HIR-DTE = 0                           32320099
323300*              MOVE DP015-ASK-NOR-OFF  TO AREHIRA                 32330099
323400*              SET PV-TEMP-REHIR-ON TO TRUE                       32340099
323500*           ELSE                                                  32350099
323600*              MOVE DP015-ASK-DRK-OFF TO AREHIRA                  32360099
323700*              SET PV-TEMP-REHIR-OFF TO TRUE                      32370099
323800*           END-IF                                                32380099
323900*        WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  32390099
324000*           CONTINUE                                              32400099
324100*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     32410099
324200*            MOVE 'XST_ASSOC'         TO PV-SQL-TABLE-NAME        32420099
324300*            SET PS-SELECT-TEXT       TO TRUE                     32430099
324400*            MOVE XST00072-SS-NBR     TO PV-DISPLAY-KEY           32440099
324500*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  32450099
324600*        WHEN OTHER                                               32460099
324700*            MOVE 'XST_ASSOC'         TO PV-SQL-TABLE-NAME        32470099
324800*            SET PS-SELECT-TEXT       TO TRUE                     32480099
324900*            MOVE XST00072-SS-NBR     TO PV-DISPLAY-KEY           32490099
325000*            PERFORM 7999-STRING-SQL-FATAL-WARNING                32500099
325100*    END-EVALUATE.                                                32510099
325200*----------*                                                      32520099
325300*7000-EXIT.                                                       32530099
325400*----------*                                                      32540099
325500*    EXIT.                                                        32550099
325600                                                                  32560099
325700*-------------------------------*                                 32570099
325800 7020-TOKENIZE-SSN SECTION.                                       32580099
325900*-------------------------------*                                 32590099
326000                                                                  32600099
326100     INITIALIZE CSI-PARAMETERS                                    32610099
326200                DP031-PROTEG-PGM-PARAMETERS                       32620099
326300                PV-INPUT-LEN.                                     32630099
326400                                                                  32640099
326500     INSPECT FUNCTION REVERSE(ART00001-SSN-NBR)                   32650099
326600           TALLYING PV-INPUT-LEN FOR LEADING SPACES.              32660099
326700     COMPUTE PV-INPUT-LEN = LENGTH OF ART00001-SSN-NBR            32670099
326800                                           - PV-INPUT-LEN.        32680099
326900     IF PV-INPUT-LEN NOT = 9                                      32690099
327000        MOVE ART00001-SSN-NBR        TO PV-TOKEN-SS-NBR           32700099
327100     ELSE                                                         32710099
327200        MOVE 'SSN-NUMBER'            TO DP031-FIELD               32720099
327300        SET CSI-ENCRYPT-FUNCTION     TO TRUE                      32730099
327400        SET DP031-SSN                TO TRUE                      32740099
327500        MOVE ART00001-SSN-NBR        TO DP031-CLEAR-TEXT          32750099
327600        MOVE PV-INPUT-LEN            TO DP031-INPUT-LEN           32760099
327700        PERFORM DP032-0000-PROTG-TOKEN-DETOKEN                    32770099
327800        MOVE DP031-CIPHER-TEXT       TO PV-TOKEN-SS-NBR           32780099
327900     END-IF.                                                      32790099
328000                                                                  32800099
328100*----------*                                                      32810099
328200 7020-EXIT.                                                       32820099
328300*----------*                                                      32830099
328400     EXIT.                                                        32840099
328500                                                                  32850099
328600*------------------------------------*                            32860099
328700*7025-SELECT-PS-VIEW-ROW-EMP SECTION.                             32870099
328800*------------------------------------*                            32880099
328900*    INITIALIZE XST00076-HIR-DTE                                  32890099
329000*               XST00076-LAST-EMPT-DTE.                           32900099
329100*    EXEC SQL                                                     32910099
329200*        SELECT A.ASSOC_ID                                        32920099
329300*              ,A.ASSOC_ENTIR_NM                                  32930099
329400*              ,A.SS_NBR                                          32940099
329500*              ,B.LOC_NBR                                         32950099
329600*              ,B.EMPT_STAT_CDE                                   32960099
329700*              ,B.EMPT_TYP_CDE                                    32970099
329800*              ,B.HIR_DTE                                         32980099
329900*              ,B.LAST_EMPT_DTE                                   32990099
330000*        INTO :XST00072-ASSOC-ID                                  33000099
330100*            ,:XST00072-ASSOC-ENTIR-NM                            33010099
330200*            ,:XST00072-SS-NBR                                    33020099
330300*            ,:XST00076-LOC-NBR                                   33030099
330400*            ,:XST00076-EMPT-STAT-CDE                             33040099
330500*            ,:XST00076-EMPT-TYP-CDE                              33050099
330600*            ,:XST00076-HIR-DTE:IND-XST00076-HIR-DTE              33060099
330700*            ,:XST00076-LAST-EMPT-DTE:IND-XST00076-LAST-EMPT-DTE  33070099
330800*        FROM XST_ASSOC A, XST_ASSOC_EMPT B                       33080099
330900*        WHERE A.ASSOC_ID = :XST00072-ASSOC-ID                    33090099
331000*          AND  A.ASSOC_ID = B.ASSOC_ID                           33100099
331100*          AND  B.ASSOC_EMPT_NBR = 0                              33110099
331200*          AND  B.BEG_DTE        = (SELECT MAX(X.BEG_DTE)         33120099
331300*                               FROM XST_ASSOC_EMPT X             33130099
331400*                               WHERE X.ASSOC_ID = B.ASSOC_ID     33140099
331500*                                AND X.BEG_DTE <= CURRENT DATE)   33150099
331600*          AND B.ASSOC_EMPT_SEQ_NBR                               33160099
331700*                            =                                    33170099
331800*                           (SELECT MAX(X.ASSOC_EMPT_SEQ_NBR)     33180099
331900*                            FROM XST_ASSOC_EMPT X                33190099
332000*                            WHERE X.ASSOC_ID = B.ASSOC_ID        33200099
332100*                              AND X.BEG_DTE = B.BEG_DTE)         33210099
332200** THIS FIELD HOLDS A 'D' FOR LOGICAL DELETES.                    33220099
332300*          AND B.LAST_ACTN_CDE <> 'D'                             33230099
332400*    END-EXEC.                                                    33240099
332500                                                                  33250099
332600*    EVALUATE TRUE                                                33260099
332700*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     33270099
332800*           SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                 33280099
332900*           SET PS-NO-EDIT-ERROR TO TRUE                          33290099
333000                                                                  33300099
333100*           IF XST00076-LOC-NBR = 900                             33310099
333200*              MOVE 880 TO XST00076-LOC-NBR                       33320099
333300*           END-IF                                                33330099
333400                                                                  33340099
333500*           IF XST00076-EMPT-TYP-CDE = 'H' OR 'E' OR 'N'          33350099
333600*              MOVE '5' TO XST00076-EMPT-TYP-CDE                  33360099
333700*           ELSE                                                  33370099
333800*              MOVE '6' TO XST00076-EMPT-TYP-CDE                  33380099
333900*           END-IF                                                33390099
334000                                                                  33400099
334100*           IF XST00076-EMPT-STAT-CDE = 'D' OR 'R' OR 'T' OR 'U'  33410099
334200*                                   OR 'V' OR 'S'                 33420099
334300*              MOVE 'T' TO XST00076-EMPT-STAT-CDE                 33430099
334400*           ELSE                                                  33440099
334500*              MOVE 'A' TO XST00076-EMPT-STAT-CDE                 33450099
334600*           END-IF                                                33460099
334700                                                                  33470099
334800*        WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  33480099
334900*           SET PS-EDIT-ERROR          TO TRUE                    33490099
335000*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     33500099
335100*            MOVE 'HR_V014_EMP_DISC' TO PV-SQL-TABLE-NAME         33510099
335200*            SET PS-SELECT-TEXT TO TRUE                           33520099
335300*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               33530099
335400*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  33540099
335500*        WHEN OTHER                                               33550099
335600*            MOVE 'HR_V014_EMP_DISC' TO PV-SQL-TABLE-NAME         33560099
335700*            SET PS-SELECT-TEXT TO TRUE                           33570099
335800*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               33580099
335900*            PERFORM 7999-STRING-SQL-FATAL-WARNING                33590099
336000*    END-EVALUATE.                                                33600099
336100*----------*                                                      33610099
336200*7025-EXIT.                                                       33620099
336300*----------*                                                      33630099
336400*    EXIT.                                                        33640099
336500                                                                  33650099
336600*---------------------------------*                               33660099
336700 7010-SELECT-EMP-CHNG-DATA SECTION.                               33670099
336800*---------------------------------*                               33680099
336900     EXEC SQL                                                     33690099
337000        SELECT CMNT_TXT                                           33700099
337100          INTO :EU-COMMENT-TXT:IND-EU-CMNT-TXT                    33710099
337200          FROM ART_EMP_DISC                                       33720099
337300         WHERE EMP_ID   = :ART00001-EMP-ID                        33730099
337400           AND ACCT_NBR = :ART00001-ACCT-NBR                      33740099
337500     END-EXEC.                                                    33750099
337600                                                                  33760099
337700     EVALUATE TRUE                                                33770099
337800        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                      33780099
337900             SET PS-NO-EDIT-ERROR   TO TRUE                       33790099
338000             IF IND-EU-CMNT-TXT = -1                              33800099
338100                MOVE SPACES         TO EU-COMMENT-TXT             33810099
338200             END-IF                                               33820099
338300             MOVE EU-COMMENT-TXT(1:40)  TO EU-NOTES-1             33830099
338400             MOVE EU-COMMENT-TXT(41:40) TO EU-NOTES-2             33840099
338500        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                      33850099
338600             SET PS-SELECT-TEXT     TO TRUE                       33860099
338700             MOVE 'ART-EMP-DISC'    TO PV-SQL-TABLE-NAME          33870099
338800             MOVE ART00001-ACCT-NBR TO PV-DISPLAY-KEY             33880099
338900             PERFORM 7998-STRING-SQL-FATAL-ERROR                  33890099
339000        WHEN OTHER                                                33900099
339100             SET PS-SELECT-TEXT     TO TRUE                       33910099
339200             MOVE 'ART-EMP-DISC'    TO PV-SQL-TABLE-NAME          33920099
339300             MOVE ART00001-ACCT-NBR TO PV-DISPLAY-KEY             33930099
339400             PERFORM 7999-STRING-SQL-FATAL-WARNING                33940099
339500     END-EVALUATE.                                                33950099
339600                                                                  33960099
344200                                                                  34420099
344300******************************************************************34430099
344400*  SELECT THE STORE ROW FROM THE DB2 STORE TABLE FOR THE CURRENT *34440099
344500*  STORE NUMBER.  OPERATING COMPANY AND START/STOP DATE CRITERIA *34450099
344600*  ARE INCLUDED INTO THE SELECT, TO ONLY RETURN THE STORE ROW    *34460099
344700*  IF THE STORE IS IN THE KOHL'S OPERATING COMPANY, AND IS       *34470099
344800*  ACTIVE.                                                       *34480099
344900******************************************************************34490099
345000*------------------------------------*                            34500099
345100 7075-SELECT-STORE-TABLE-ROW SECTION.                             34510099
345200*------------------------------------*                            34520099
345300     EXEC SQL                                                     34530099
345400         SELECT OPN_DTE                                           34540099
345500             INTO :XST00001-OPN-DTE                               34550099
345600             FROM XST_LOC                                         34560099
345700             WHERE (LOC_NBR = :XST00001-LOC-NBR)                  34570099
345800               AND (CHAR(CLO_DTE,ISO) >=                          34580099
345900                                   :IC-ISO-CURRENT-DATE)          34590099
346000     END-EXEC.                                                    34600099
346100                                                                  34610099
346200     EVALUATE TRUE                                                34620099
346300         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     34630099
346400             SET PS-NO-EDIT-ERROR TO TRUE                         34640099
346500             SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                34650099
346600         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  34660099
346700             SET PS-EDIT-ERROR TO TRUE                            34670099
346800         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     34680099
346900             SET PS-SELECT-TEXT TO TRUE                           34690099
347000             MOVE 'XST_LOC' TO PV-SQL-TABLE-NAME                  34700099
347100             MOVE CA-STORE-NUMBER-X TO PV-DISPLAY-KEY             34710099
347200             PERFORM 7998-STRING-SQL-FATAL-ERROR                  34720099
347300         WHEN OTHER                                               34730099
347400             SET PS-SELECT-TEXT TO TRUE                           34740099
347500             MOVE 'XST_LOC' TO PV-SQL-TABLE-NAME                  34750099
347600             MOVE CA-STORE-NUMBER-X TO PV-DISPLAY-KEY             34760099
347700             PERFORM 7999-STRING-SQL-FATAL-WARNING                34770099
347800     END-EVALUATE.                                                34780099
347900*----------*                                                      34790099
348000 7075-EXIT.                                                       34800099
348100*----------*                                                      34810099
348200     EXIT.                                                        34820099
348300                                                                  34830099
348400*----------------------------------------------------------       34840099
348500* 7100 THRU 7210 - DB2 OPENS, FETCHES, AND CLOSES FOR EMPLOYEE    34850099
348600* READ BY SSN, NON-EMPLOYEE READ BY SSN, EMPLOYEE READ BY         34860099
348700* ACCOUNT, AND NON-EMPLOYEE READ BY ACCOUNT.                      34870099
348800*----------------------------------------------------------       34880099
348900*--------------------------------*                                34890099
349000 7100-OPEN-EMP-ID-CURSOR SECTION.                                 34900099
349100*--------------------------------*                                34910099
349200     EXEC SQL                                                     34920099
349300         OPEN EMP_ID                                              34930099
349400     END-EXEC.                                                    34940099
349500                                                                  34950099
349600     EVALUATE TRUE                                                34960099
349700         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     34970099
349800             CONTINUE                                             34980099
349900         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     34990099
350000             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   35000099
350100             SET PS-CURSOROPEN-TEXT TO TRUE                       35010099
350200             PERFORM 7998-STRING-SQL-FATAL-ERROR                  35020099
350300         WHEN OTHER                                               35030099
350400             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   35040099
350500             SET PS-CURSOROPEN-TEXT TO TRUE                       35050099
350600             PERFORM 7999-STRING-SQL-FATAL-WARNING                35060099
350700     END-EVALUATE.                                                35070099
350800*----------*                                                      35080099
350900 7100-EXIT.                                                       35090099
351000*----------*                                                      35100099
351100     EXIT.                                                        35110099
351200                                                                  35120099
353700*----------------------------------*                              35370099
353800 7120-OPEN-EMP-ACCT-CURSOR SECTION.                               35380099
353900*----------------------------------*                              35390099
354000     EXEC SQL                                                     35400099
354100         OPEN EMP_ACCT                                            35410099
354200     END-EXEC.                                                    35420099
354300                                                                  35430099
354400     EVALUATE TRUE                                                35440099
354500         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     35450099
354600             CONTINUE                                             35460099
354700         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     35470099
354800             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 35480099
354900             SET PS-CURSOROPEN-TEXT TO TRUE                       35490099
355000             PERFORM 7998-STRING-SQL-FATAL-ERROR                  35500099
355100         WHEN OTHER                                               35510099
355200             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 35520099
355300             SET PS-CURSOROPEN-TEXT TO TRUE                       35530099
355400             PERFORM 7999-STRING-SQL-FATAL-WARNING                35540099
355500     END-EVALUATE.                                                35550099
355600*----------*                                                      35560099
355700 7120-EXIT.                                                       35570099
355800*----------*                                                      35580099
355900     EXIT.                                                        35590099
356000                                                                  35600099
358400                                                                  35840099
358500******************************************************************35850099
358600* CALLS THE PROTEGRITY MODULE TO TOKENIZE THE ACCOUNT NUMBER.    *35860099
358700******************************************************************35870099
358800 7135-TOKEN-ACCTNBR SECTION.                                      35880099
358900                                                                  35890099
359000     INITIALIZE CSI-PARAMETERS                                    35900099
359100                DP031-PROTEG-PGM-PARAMETERS.                      35910099
359200                                                                  35920099
359300     MOVE 'ACCOUNT-NBR'           TO DP031-FIELD.                 35930099
359400     SET CSI-ENCRYPT-FUNCTION     TO TRUE.                        35940099
359500     SET DP031-ACCTNBR            TO TRUE.                        35950099
359600     MOVE PV-ACCOUNT-NBR-12       TO DP031-CLEAR-TEXT.            35960099
359700     MOVE 12                      TO DP031-INPUT-LEN.             35970099
359800     PERFORM DP032-0000-PROTG-TOKEN-DETOKEN.                      35980099
359900     MOVE DP031-CIPHER-TEXT(1:10) TO PV-ACCT-NBR-TOKEN.           35990099
360000                                                                  36000099
360100*---------*                                                       36010099
360200 7135-EXIT.                                                       36020099
360300*---------*                                                       36030099
360400     EXIT.                                                        36040099
360500                                                                  36050099
360600*---------------------------------*                               36060099
360700 7140-FETCH-EMP-ID-CURSOR SECTION.                                36070099
360800*---------------------------------*                               36080099
360900     INITIALIZE ART00001-CMNT-TXT.                                36090099
361000     EXEC SQL                                                     36100099
361100        FETCH EMP_ID                                              36110099
361200           INTO :ART00001-ACCT-NBR                                36120099
361300               ,:ART00001-DISC-STAT-CDE                           36130099
361400               ,:ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT          36140099
361500               ,:ART00001-EMP-NM                                  36150099
361600               ,:ART00001-SSN-NBR                                 36160099
361700               ,:ART00001-LOC-NBR                                 36170099
361800               ,:ART00001-EMP-STAT-CDE                            36180099
361900               ,:ART00001-EMP-TYP-CDE                             36190099
362000               ,:ART00001-DISC-DTE:IND-ART00001-DISC-DTE          36200099
362100               ,:ART00001-TERM-DTE:IND-ART00001-TERM-DTE          36210099
362200     END-EXEC.                                                    36220099
362300                                                                  36230099
362400     EVALUATE TRUE                                                36240099
362500         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     36250099
362600            SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                 36260099
362700            SET PS-NO-EDIT-ERROR TO TRUE                          36270099
362800            ADD 1 TO PV-MAX-ACCT-CTR END-ADD                      36280099
362900         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  36290099
363000             SET PS-EDIT-ERROR TO TRUE                            36300099
363100         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     36310099
363200             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   36320099
363300             SET PS-FETCH-TEXT TO TRUE                            36330099
363400             MOVE ART00001-EMP-ID  TO PV-DISPLAY-KEY              36340099
363500             PERFORM 7998-STRING-SQL-FATAL-ERROR                  36350099
363600         WHEN OTHER                                               36360099
363700             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   36370099
363800             SET PS-FETCH-TEXT TO TRUE                            36380099
363900             MOVE ART00001-EMP-ID  TO PV-DISPLAY-KEY              36390099
364000             PERFORM 7999-STRING-SQL-FATAL-WARNING                36400099
364100     END-EVALUATE.                                                36410099
364200*----------*                                                      36420099
364300 7140-EXIT.                                                       36430099
364400*----------*                                                      36440099
364500     EXIT.                                                        36450099
364600                                                                  36460099
368800                                                                  36880099
368900*-----------------------------------*                             36890099
369000 7160-FETCH-EMP-ACCT-CURSOR SECTION.                              36900099
369100*-----------------------------------*                             36910099
369200     INITIALIZE ART00001-CMNT-TXT.                                36920099
369300     EXEC SQL                                                     36930099
369400        FETCH EMP_ACCT                                            36940099
369500          INTO :ART00001-EMP-ID                                   36950099
369600              ,:ART00001-DISC-STAT-CDE                            36960099
369700              ,:ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT           36970099
369800              ,:ART00001-EMP-NM                                   36980099
369900              ,:ART00001-SSN-NBR                                  36990099
370000              ,:ART00001-LOC-NBR                                  37000099
370100              ,:ART00001-EMP-STAT-CDE                             37010099
370200              ,:ART00001-EMP-TYP-CDE                              37020099
370300              ,:ART00001-DISC-DTE:IND-ART00001-DISC-DTE           37030099
370400              ,:ART00001-TERM-DTE:IND-ART00001-TERM-DTE           37040099
370500     END-EXEC.                                                    37050099
370600                                                                  37060099
370700     EVALUATE TRUE                                                37070099
370800         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     37080099
370900            SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                 37090099
371000            SET PS-NO-EDIT-ERROR TO TRUE                          37100099
371100            SET CA-TOKEN-ACCT-NO TO TRUE                          37110099
371200            IF ART00001-LOC-NBR = 900                             37120099
371300               MOVE 880 TO ART00001-LOC-NBR                       37130099
371400            END-IF                                                37140099
371500                                                                  37150099
371600            IF ART00001-EMP-STAT-CDE = 'D' OR 'R' OR 'T' OR 'U'   37160099
371700                                    OR 'V' OR 'S'                 37170099
371800               MOVE 'T' TO ART00001-EMP-STAT-CDE                  37180099
371900            ELSE                                                  37190099
372000               MOVE 'A' TO ART00001-EMP-STAT-CDE                  37200099
372100            END-IF                                                37210099
372200                                                                  37220099
372300         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  37230099
372400             SET PS-EDIT-ERROR TO TRUE                            37240099
372500         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     37250099
372600             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 37260099
372700             SET PS-FETCH-TEXT TO TRUE                            37270099
372800**WONT HAVE ANYTHING TO DISPLAY                                   37280099
372900****         MOVE ART00001-EMP-ID TO PV-DISPLAY-KEY               37290099
373000             PERFORM 7998-STRING-SQL-FATAL-ERROR                  37300099
373100         WHEN OTHER                                               37310099
373200             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 37320099
373300             SET PS-FETCH-TEXT TO TRUE                            37330099
373400*****        MOVE ART00001-EMP-ID TO PV-DISPLAY-KEY               37340099
373500             PERFORM 7999-STRING-SQL-FATAL-WARNING                37350099
373600     END-EVALUATE.                                                37360099
373700*----------*                                                      37370099
373800 7160-EXIT.                                                       37380099
373900*----------*                                                      37390099
374000     EXIT.                                                        37400099
374100                                                                  37410099
378400*---------------------------------*                               37840099
378500 7180-CLOSE-EMP-ID-CURSOR SECTION.                                37850099
378600*---------------------------------*                               37860099
378700     EXEC SQL                                                     37870099
378800         CLOSE EMP_ID                                             37880099
378900     END-EXEC.                                                    37890099
379000                                                                  37900099
379100     EVALUATE TRUE                                                37910099
379200         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     37920099
379300             CONTINUE                                             37930099
379400         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     37940099
379500             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   37950099
379600             SET PS-CURSORCLOSE-TEXT TO TRUE                      37960099
379700             PERFORM 7998-STRING-SQL-FATAL-ERROR                  37970099
379800         WHEN OTHER                                               37980099
379900             MOVE 'EMP_ID' TO PV-SQL-TABLE-NAME                   37990099
380000             SET PS-CURSORCLOSE-TEXT TO TRUE                      38000099
380100             PERFORM 7999-STRING-SQL-FATAL-WARNING                38010099
380200     END-EVALUATE.                                                38020099
380300*----------*                                                      38030099
380400 7180-EXIT.                                                       38040099
380500*----------*                                                      38050099
380600     EXIT.                                                        38060099
380700                                                                  38070099
383100                                                                  38310099
383200*-----------------------------------*                             38320099
383300 7200-CLOSE-EMP-ACCT-CURSOR SECTION.                              38330099
383400*-----------------------------------*                             38340099
383500     EXEC SQL                                                     38350099
383600         CLOSE EMP_ACCT                                           38360099
383700     END-EXEC.                                                    38370099
383800                                                                  38380099
383900     EVALUATE TRUE                                                38390099
384000         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     38400099
384100             CONTINUE                                             38410099
384200         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     38420099
384300             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 38430099
384400             SET PS-CURSORCLOSE-TEXT TO TRUE                      38440099
384500             PERFORM 7998-STRING-SQL-FATAL-ERROR                  38450099
384600         WHEN OTHER                                               38460099
384700             MOVE 'EMP_ACCT' TO PV-SQL-TABLE-NAME                 38470099
384800             SET PS-CURSORCLOSE-TEXT TO TRUE                      38480099
384900             PERFORM 7999-STRING-SQL-FATAL-WARNING                38490099
385000     END-EVALUATE.                                                38500099
385100*----------*                                                      38510099
385200 7200-EXIT.                                                       38520099
385300*----------*                                                      38530099
385400     EXIT.                                                        38540099
385500                                                                  38550099
385600*------------------------------------*                            38560099
385700*7210-CLOSE-NEMP-ACCT-CURSOR SECTION.                             38570099
385800*------------------------------------*                            38580099
385900*    EXEC SQL                                                     38590099
386000*        CLOSE NEMP_ACCT                                          38600099
386100*    END-EXEC.                                                    38610099
386200                                                                  38620099
386300*    EVALUATE TRUE                                                38630099
386400*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     38640099
386500*            CONTINUE                                             38650099
386600*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     38660099
386700*            MOVE 'NEMP_ACCT' TO PV-SQL-TABLE-NAME                38670099
386800*            SET PS-CURSORCLOSE-TEXT TO TRUE                      38680099
386900*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  38690099
387000*        WHEN OTHER                                               38700099
387100*            MOVE 'NEMP_ACCT' TO PV-SQL-TABLE-NAME                38710099
387200*            SET PS-CURSORCLOSE-TEXT TO TRUE                      38720099
387300*            PERFORM 7999-STRING-SQL-FATAL-WARNING                38730099
387400*    END-EVALUATE.                                                38740099
387500*----------*                                                      38750099
387600*7210-EXIT.                                                       38760099
387700*----------*                                                      38770099
387800*    EXIT.                                                        38780099
387900                                                                  38790099
388000*----------------------------------------------------------       38800099
388100* 7220 THRU 7390 - DB2 OPENS, FETCHES, AND CLOSES FOR NAME,       38810099
388200* STORE, AND SSN SEARCHES.                                        38820099
388300*----------------------------------------------------------       38830099
388400*-------------------------------------*                           38840099
388500*7220-OPEN-SEARCH-VIEW-NM-CSR SECTION.                            38850099
388600*-------------------------------------*                           38860099
388700*    EXEC SQL                                                     38870099
388800*        OPEN HR_VIEW_NM                                          38880099
388900*    END-EXEC.                                                    38890099
389000                                                                  38900099
389100*    EVALUATE TRUE                                                38910099
389200*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     38920099
389300*            CONTINUE                                             38930099
389400*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     38940099
389500*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               38950099
389600*            SET PS-CURSOROPEN-TEXT TO TRUE                       38960099
389700*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  38970099
389800*        WHEN OTHER                                               38980099
389900*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               38990099
390000*            SET PS-CURSOROPEN-TEXT TO TRUE                       39000099
390100*            PERFORM 7999-STRING-SQL-FATAL-WARNING                39010099
390200*    END-EVALUATE.                                                39020099
390300*----------*                                                      39030099
390400 7220-EXIT.                                                       39040099
390500*----------*                                                      39050099
390600     EXIT.                                                        39060099
390700                                                                  39070099
390800*--------------------------------------*                          39080099
390900*7230-OPEN-SEARCH-UNION-NM-CSR SECTION.                           39090099
391000*--------------------------------------*                          39100099
391100*    EXEC SQL                                                     39110099
391200*        OPEN UNION_NM                                            39120099
391300*    END-EXEC.                                                    39130099
391400                                                                  39140099
391500*    EVALUATE TRUE                                                39150099
391600*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     39160099
391700*            CONTINUE                                             39170099
391800*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     39180099
391900*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 39190099
392000*            SET PS-CURSOROPEN-TEXT TO TRUE                       39200099
392100*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  39210099
392200*        WHEN OTHER                                               39220099
392300*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 39230099
392400*            SET PS-CURSOROPEN-TEXT TO TRUE                       39240099
392500*            PERFORM 7999-STRING-SQL-FATAL-WARNING                39250099
392600*    END-EVALUATE.                                                39260099
392700*----------*                                                      39270099
392800*7230-EXIT.                                                       39280099
392900*----------*                                                      39290099
393000*    EXIT.                                                        39300099
393100                                                                  39310099
393200*--------------------------------------*                          39320099
393300 7240-OPEN-SEARCH-VIEW-STR-CSR SECTION.                           39330099
393400*--------------------------------------*                          39340099
393500     EXEC SQL                                                     39350099
393600         OPEN HR_VIEW_STR                                         39360099
393700     END-EXEC.                                                    39370099
393800                                                                  39380099
393900     EVALUATE TRUE                                                39390099
394000         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     39400099
394100             CONTINUE                                             39410099
394200         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     39420099
394300             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              39430099
394400             SET PS-CURSOROPEN-TEXT TO TRUE                       39440099
394500             PERFORM 7998-STRING-SQL-FATAL-ERROR                  39450099
394600         WHEN OTHER                                               39460099
394700             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              39470099
394800             SET PS-CURSOROPEN-TEXT TO TRUE                       39480099
394900             PERFORM 7999-STRING-SQL-FATAL-WARNING                39490099
395000     END-EVALUATE.                                                39500099
395100*----------*                                                      39510099
395200 7240-EXIT.                                                       39520099
395300*----------*                                                      39530099
395400     EXIT.                                                        39540099
395500                                                                  39550099
395600*---------------------------------------*                         39560099
395700 7250-OPEN-SEARCH-UNION-STR-CSR SECTION.                          39570099
395800*---------------------------------------*                         39580099
395900     EXEC SQL                                                     39590099
396000         OPEN UNION_STR                                           39600099
396100     END-EXEC.                                                    39610099
396200                                                                  39620099
396300     EVALUATE TRUE                                                39630099
396400         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     39640099
396500             CONTINUE                                             39650099
396600         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     39660099
396700             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                39670099
396800             SET PS-CURSOROPEN-TEXT TO TRUE                       39680099
396900             PERFORM 7998-STRING-SQL-FATAL-ERROR                  39690099
397000         WHEN OTHER                                               39700099
397100             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                39710099
397200             SET PS-CURSOROPEN-TEXT TO TRUE                       39720099
397300             PERFORM 7999-STRING-SQL-FATAL-WARNING                39730099
397400     END-EVALUATE.                                                39740099
397500*----------*                                                      39750099
397600 7250-EXIT.                                                       39760099
397700*----------*                                                      39770099
397800     EXIT.                                                        39780099
397900                                                                  39790099
398000*--------------------------------------*                          39800099
398100 7260-OPEN-SEARCH-VIEW-SSN-CSR SECTION.                           39810099
398200*--------------------------------------*                          39820099
398300     EXEC SQL                                                     39830099
398400         OPEN HR_VIEW_SSN                                         39840099
398500     END-EXEC.                                                    39850099
398600                                                                  39860099
398700     EVALUATE TRUE                                                39870099
398800         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     39880099
398900             CONTINUE                                             39890099
399000         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     39900099
399100             MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              39910099
399200             SET PS-CURSOROPEN-TEXT TO TRUE                       39920099
399300             PERFORM 7998-STRING-SQL-FATAL-ERROR                  39930099
399400         WHEN OTHER                                               39940099
399500             MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              39950099
399600             SET PS-CURSOROPEN-TEXT TO TRUE                       39960099
399700             PERFORM 7999-STRING-SQL-FATAL-WARNING                39970099
399800     END-EVALUATE.                                                39980099
399900*----------*                                                      39990099
400000 7260-EXIT.                                                       40000099
400100*----------*                                                      40010099
400200     EXIT.                                                        40020099
400300                                                                  40030099
400400*---------------------------------------*                         40040099
400500 7270-OPEN-SEARCH-UNION-SSN-CSR SECTION.                          40050099
400600*---------------------------------------*                         40060099
400700     EXEC SQL                                                     40070099
400800         OPEN UNION_SSN                                           40080099
400900     END-EXEC.                                                    40090099
401000                                                                  40100099
401100     EVALUATE TRUE                                                40110099
401200         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     40120099
401300             CONTINUE                                             40130099
401400         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     40140099
401500             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                40150099
401600             SET PS-CURSOROPEN-TEXT TO TRUE                       40160099
401700             PERFORM 7998-STRING-SQL-FATAL-ERROR                  40170099
401800         WHEN OTHER                                               40180099
401900             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                40190099
402000             SET PS-CURSOROPEN-TEXT TO TRUE                       40200099
402100             PERFORM 7999-STRING-SQL-FATAL-WARNING                40210099
402200     END-EVALUATE.                                                40220099
402300*----------*                                                      40230099
402400 7270-EXIT.                                                       40240099
402500*----------*                                                      40250099
402600     EXIT.                                                        40260099
402700                                                                  40270099
402800*--------------------------------------*                          40280099
402900*7280-FETCH-SEARCH-VIEW-NM-CSR SECTION.                           40290099
403000*--------------------------------------*                          40300099
403100*    EXEC SQL                                                     40310099
403200*        FETCH HR_VIEW_NM                                         40320099
403300*          INTO :XST00072-SS-NBR                                  40330099
403400*              ,:XST00072-ASSOC-ENTIR-NM                          40340099
403500*              ,:XST00076-LOC-NBR                                 40350099
403600*    END-EXEC.                                                    40360099
403700                                                                  40370099
403800*    EVALUATE TRUE                                                40380099
403900*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     40390099
404000*            IF XST00076-LOC-NBR = 900                            40400099
404100*               MOVE 0880 TO PV-STORE-NBR-4                       40410099
404200*            ELSE                                                 40420099
404300*               MOVE XST00076-LOC-NBR TO PV-STORE-NBR-4           40430099
404400*            END-IF                                               40440099
404500*            MOVE PV-STORE-NBR        TO PV-STR-NBR               40450099
404600*            PERFORM 7450-INSERT-GLOBAL-TEMP-ROW                  40460099
404700*        WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  40470099
404800*            SET PS-NO-MORE-ROWS  TO TRUE                         40480099
404900*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     40490099
405000*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               40500099
405100*            SET PS-FETCH-TEXT TO TRUE                            40510099
405200*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               40520099
405300*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  40530099
405400*        WHEN OTHER                                               40540099
405500*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               40550099
405600*            SET PS-FETCH-TEXT TO TRUE                            40560099
405700*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               40570099
405800*            PERFORM 7999-STRING-SQL-FATAL-WARNING                40580099
405900*    END-EVALUATE.                                                40590099
406000*----------*                                                      40600099
406100*7280-EXIT.                                                       40610099
406200*----------*                                                      40620099
406300*    EXIT.                                                        40630099
406400                                                                  40640099
406500*---------------------------------------*                         40650099
406600*7290-FETCH-SEARCH-UNION-NM-CSR SECTION.                          40660099
406700*---------------------------------------*                         40670099
406800*    EXEC SQL                                                     40680099
406900*        FETCH UNION_NM                                           40690099
407000*          INTO :ART00000-SSN-NBR                                 40700099
407100*              ,:ART00000-EMP-NM                                  40710099
407200*              ,:ART00000-STR-NBR                                 40720099
407300*    END-EXEC.                                                    40730099
407400                                                                  40740099
407500*    EVALUATE TRUE                                                40750099
407600*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     40760099
407700*            MOVE ART00000-SSN-NBR TO PV-SSN-NBR                  40770099
407800*            MOVE ART00000-EMP-NM TO PV-EMP-NM                    40780099
407900*            MOVE ART00000-STR-NBR TO PV-STR-NBR                  40790099
408000*            PERFORM 6600-WRITE-SEARCH-QUEUE                      40800099
408100*        WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  40810099
408200*            SET PS-NO-MORE-ROWS  TO TRUE                         40820099
408300*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     40830099
408400*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 40840099
408500*            SET PS-FETCH-TEXT TO TRUE                            40850099
408600*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              40860099
408700*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  40870099
408800*        WHEN OTHER                                               40880099
408900*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 40890099
409000*            SET PS-FETCH-TEXT TO TRUE                            40900099
409100*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              40910099
409200*            PERFORM 7999-STRING-SQL-FATAL-WARNING                40920099
409300*    END-EVALUATE.                                                40930099
409400*----------*                                                      40940099
409500*7290-EXIT.                                                       40950099
409600*----------*                                                      40960099
409700*    EXIT.                                                        40970099
409800                                                                  40980099
409900*---------------------------------------*                         40990099
410000 7300-FETCH-SEARCH-VIEW-STR-CSR SECTION.                          41000099
410100*---------------------------------------*                         41010099
410200     EXEC SQL                                                     41020099
410300         FETCH HR_VIEW_STR                                        41030099
410400           INTO :ART00001-SSN-NBR                                 41040099
410500               ,:ART00001-EMP-NM                                  41050099
410600     END-EXEC.                                                    41060099
410700                                                                  41070099
410800     EVALUATE TRUE                                                41080099
410900         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     41090099
411000             IF ART00001-LOC-NBR = 900                            41100099
411100                MOVE 0880 TO PV-STORE-NBR-4                       41110099
411200             ELSE                                                 41120099
411300                MOVE ART00001-LOC-NBR TO PV-STORE-NBR-4           41130099
411400             END-IF                                               41140099
411500             MOVE PV-STORE-NBR        TO PV-STR-NBR               41150099
411600             PERFORM 7450-INSERT-GLOBAL-TEMP-ROW                  41160099
411800         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  41180099
411900             SET PS-NO-MORE-ROWS  TO TRUE                         41190099
412000         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     41200099
412100             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              41210099
412200             SET PS-FETCH-TEXT TO TRUE                            41220099
412300             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41230099
412400             PERFORM 7998-STRING-SQL-FATAL-ERROR                  41240099
412500         WHEN OTHER                                               41250099
412600             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              41260099
412700             SET PS-FETCH-TEXT TO TRUE                            41270099
412800             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41280099
412900             PERFORM 7999-STRING-SQL-FATAL-WARNING                41290099
413000     END-EVALUATE.                                                41300099
413100*----------*                                                      41310099
413200 7300-EXIT.                                                       41320099
413300*----------*                                                      41330099
413400     EXIT.                                                        41340099
413500                                                                  41350099
413600*---------------------------------------*                         41360099
413700 7310-FETCH-SERCH-UNION-STR-CSR SECTION.                          41370099
413800*---------------------------------------*                         41380099
413900     EXEC SQL                                                     41390099
414000         FETCH UNION_STR                                          41400099
414100           INTO :ART00001-SSN-NBR                                 41410099
414200               ,:ART00001-EMP-NM                                  41420099
414300     END-EXEC.                                                    41430099
414400                                                                  41440099
414500     EVALUATE TRUE                                                41450099
414600         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     41460099
414700             MOVE ART00001-SSN-NBR TO PV-SSN-NBR                  41470099
414800             MOVE ART00001-EMP-NM TO PV-EMP-NM                    41480099
414900             MOVE SPACES       TO PV-STR-NBR                      41490099
415000             PERFORM 6600-WRITE-SEARCH-QUEUE                      41500099
415100         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  41510099
415200             SET PS-NO-MORE-ROWS  TO TRUE                         41520099
415300         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     41530099
415400             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                41540099
415500             SET PS-FETCH-TEXT TO TRUE                            41550099
415600             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41560099
415700             PERFORM 7998-STRING-SQL-FATAL-ERROR                  41570099
415800         WHEN OTHER                                               41580099
415900             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                41590099
416000             SET PS-FETCH-TEXT TO TRUE                            41600099
416100             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41610099
416200             PERFORM 7999-STRING-SQL-FATAL-WARNING                41620099
416300     END-EVALUATE.                                                41630099
416400*----------*                                                      41640099
416500 7310-EXIT.                                                       41650099
416600*----------*                                                      41660099
416700     EXIT.                                                        41670099
416800                                                                  41680099
416900*---------------------------------------*                         41690099
417000 7320-FETCH-SEARCH-VIEW-SSN-CSR SECTION.                          41700099
417100*---------------------------------------*                         41710099
417200     EXEC SQL                                                     41720099
417300         FETCH HR_VIEW_SSN                                        41730099
417400           INTO :ART00001-SSN-NBR                                 41740099
417500               ,:ART00001-EMP-NM                                  41750099
417600               ,:ART00001-LOC-NBR                                 41760099
417700     END-EXEC.                                                    41770099
417800                                                                  41780099
417900     EVALUATE TRUE                                                41790099
418000         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     41800099
418100             MOVE ART00001-LOC-NBR TO PV-STORE-NBR-4              41810099
418200             IF PV-STORE-NBR-4 = 900                              41820099
418300                MOVE 880 TO PV-STORE-NBR-4                        41830099
418400             END-IF                                               41840099
418500             MOVE PV-STORE-NBR        TO PV-STR-NBR               41850099
418600             PERFORM 7450-INSERT-GLOBAL-TEMP-ROW                  41860099
418700         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  41870099
418800             SET PS-NO-MORE-ROWS  TO TRUE                         41880099
418900         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     41890099
419000             MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              41900099
419100             SET PS-FETCH-TEXT TO TRUE                            41910099
419200             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41920099
419300             PERFORM 7998-STRING-SQL-FATAL-ERROR                  41930099
419400         WHEN OTHER                                               41940099
419500             MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              41950099
419600             SET PS-FETCH-TEXT TO TRUE                            41960099
419700             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              41970099
419800             PERFORM 7999-STRING-SQL-FATAL-WARNING                41980099
419900     END-EVALUATE.                                                41990099
420000*----------*                                                      42000099
420100 7320-EXIT.                                                       42010099
420200*----------*                                                      42020099
420300     EXIT.                                                        42030099
420400                                                                  42040099
420500*---------------------------------------*                         42050099
420600 7330-FETCH-SERCH-UNION-SSN-CSR SECTION.                          42060099
420700*---------------------------------------*                         42070099
420800     EXEC SQL                                                     42080099
420900         FETCH UNION_SSN                                          42090099
421000           INTO :ART00001-SSN-NBR                                 42100099
421100               ,:ART00001-EMP-NM                                  42110099
421200               ,:ART00001-LOC-NBR                                 42120099
421300     END-EXEC.                                                    42130099
421400                                                                  42140099
421500     EVALUATE TRUE                                                42150099
421600         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     42160099
421700             MOVE ART00001-SSN-NBR TO PV-SSN-NBR                  42170099
421800             MOVE ART00001-EMP-NM  TO PV-EMP-NM                   42180099
421900             MOVE ART00001-LOC-NBR TO PV-STR-NBR                  42190099
422000             PERFORM 6600-WRITE-SEARCH-QUEUE                      42200099
422100         WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                  42210099
422200             SET PS-NO-MORE-ROWS  TO TRUE                         42220099
422300         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     42230099
422400             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                42240099
422500             SET PS-FETCH-TEXT TO TRUE                            42250099
422600             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              42260099
422700             PERFORM 7998-STRING-SQL-FATAL-ERROR                  42270099
422800         WHEN OTHER                                               42280099
422900             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                42290099
423000             SET PS-FETCH-TEXT TO TRUE                            42300099
423100             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              42310099
423200             PERFORM 7999-STRING-SQL-FATAL-WARNING                42320099
423300     END-EVALUATE.                                                42330099
423400*----------*                                                      42340099
423500 7330-EXIT.                                                       42350099
423600*----------*                                                      42360099
423700     EXIT.                                                        42370099
423800                                                                  42380099
423900*--------------------------------------*                          42390099
424000*7340-CLOSE-SEARCH-VIEW-NM-CSR SECTION.                           42400099
424100*--------------------------------------*                          42410099
424200*    EXEC SQL                                                     42420099
424300*        CLOSE HR_VIEW_NM                                         42430099
424400*    END-EXEC.                                                    42440099
424500                                                                  42450099
424600*    EVALUATE TRUE                                                42460099
424700*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     42470099
424800*            CONTINUE                                             42480099
424900*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     42490099
425000*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               42500099
425100*            SET PS-CURSORCLOSE-TEXT TO TRUE                      42510099
425200*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  42520099
425300*        WHEN OTHER                                               42530099
425400*            MOVE 'HR_VIEW_NM' TO PV-SQL-TABLE-NAME               42540099
425500*            SET PS-CURSORCLOSE-TEXT TO TRUE                      42550099
425600*            PERFORM 7999-STRING-SQL-FATAL-WARNING                42560099
425700*    END-EVALUATE.                                                42570099
425800*----------*                                                      42580099
425900*7340-EXIT.                                                       42590099
426000*----------*                                                      42600099
426100     EXIT.                                                        42610099
426200                                                                  42620099
426300*---------------------------------------*                         42630099
426400*7350-CLOSE-SEARCH-UNION-NM-CSR SECTION.                          42640099
426500*---------------------------------------*                         42650099
426600*    EXEC SQL                                                     42660099
426700*        CLOSE UNION_NM                                           42670099
426800*    END-EXEC.                                                    42680099
426900                                                                  42690099
427000*    EVALUATE TRUE                                                42700099
427100*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     42710099
427200*            CONTINUE                                             42720099
427300*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     42730099
427400*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 42740099
427500*            SET PS-CURSORCLOSE-TEXT TO TRUE                      42750099
427600*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  42760099
427700*        WHEN OTHER                                               42770099
427800*            MOVE 'UNION_NM' TO PV-SQL-TABLE-NAME                 42780099
427900*            SET PS-CURSORCLOSE-TEXT TO TRUE                      42790099
428000*            PERFORM 7999-STRING-SQL-FATAL-WARNING                42800099
428100*    END-EVALUATE.                                                42810099
428200*----------*                                                      42820099
428300*7350-EXIT.                                                       42830099
428400*----------*                                                      42840099
428500*    EXIT.                                                        42850099
428600                                                                  42860099
428700*---------------------------------------*                         42870099
428800 7360-CLOSE-SEARCH-VIEW-STR-CSR SECTION.                          42880099
428900*---------------------------------------*                         42890099
429000     EXEC SQL                                                     42900099
429100         CLOSE HR_VIEW_STR                                        42910099
429200     END-EXEC.                                                    42920099
429300                                                                  42930099
429400     EVALUATE TRUE                                                42940099
429500         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     42950099
429600             CONTINUE                                             42960099
429700         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     42970099
429800             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              42980099
429900             SET PS-CURSORCLOSE-TEXT TO TRUE                      42990099
430000             PERFORM 7998-STRING-SQL-FATAL-ERROR                  43000099
430100         WHEN OTHER                                               43010099
430200             MOVE 'HR_VIEW_STR' TO PV-SQL-TABLE-NAME              43020099
430300             SET PS-CURSORCLOSE-TEXT TO TRUE                      43030099
430400             PERFORM 7999-STRING-SQL-FATAL-WARNING                43040099
430500     END-EVALUATE.                                                43050099
430600*----------*                                                      43060099
430700 7360-EXIT.                                                       43070099
430800*----------*                                                      43080099
430900     EXIT.                                                        43090099
431000                                                                  43100099
431100*---------------------------------------*                         43110099
431200 7370-CLOSE-SERCH-UNION-STR-CSR SECTION.                          43120099
431300*---------------------------------------*                         43130099
431400     EXEC SQL                                                     43140099
431500         CLOSE UNION_STR                                          43150099
431600     END-EXEC.                                                    43160099
431700                                                                  43170099
431800     EVALUATE TRUE                                                43180099
431900         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     43190099
432000             CONTINUE                                             43200099
432100         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     43210099
432200             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                43220099
432300             SET PS-CURSORCLOSE-TEXT TO TRUE                      43230099
432400             PERFORM 7998-STRING-SQL-FATAL-ERROR                  43240099
432500         WHEN OTHER                                               43250099
432600             MOVE 'UNION_STR' TO PV-SQL-TABLE-NAME                43260099
432700             SET PS-CURSORCLOSE-TEXT TO TRUE                      43270099
432800             PERFORM 7999-STRING-SQL-FATAL-WARNING                43280099
432900     END-EVALUATE.                                                43290099
433000*----------*                                                      43300099
433100 7370-EXIT.                                                       43310099
433200*----------*                                                      43320099
433300     EXIT.                                                        43330099
433400                                                                  43340099
433500*---------------------------------------*                         43350099
433600*7380-CLOSE-SEARCH-VIEW-SSN-CSR SECTION.                          43360099
433700*---------------------------------------*                         43370099
433800*    EXEC SQL                                                     43380099
433900*        CLOSE HR_VIEW_SSN                                        43390099
434000*    END-EXEC.                                                    43400099
434100                                                                  43410099
434200*    EVALUATE TRUE                                                43420099
434300*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     43430099
434400*            CONTINUE                                             43440099
434500*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     43450099
434600*            MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              43460099
434700*            SET PS-CURSORCLOSE-TEXT TO TRUE                      43470099
434800*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  43480099
434900*        WHEN OTHER                                               43490099
435000*            MOVE 'HR_VIEW_SSN' TO PV-SQL-TABLE-NAME              43500099
435100*            SET PS-CURSORCLOSE-TEXT TO TRUE                      43510099
435200*            PERFORM 7999-STRING-SQL-FATAL-WARNING                43520099
435300*    END-EVALUATE.                                                43530099
435400*----------*                                                      43540099
435500*7380-EXIT.                                                       43550099
435600*----------*                                                      43560099
435700*    EXIT.                                                        43570099
435800                                                                  43580099
435900*---------------------------------------*                         43590099
436000 7390-CLOSE-SERCH-UNION-SSN-CSR SECTION.                          43600099
436100*---------------------------------------*                         43610099
436200     EXEC SQL                                                     43620099
436300         CLOSE UNION_SSN                                          43630099
436400     END-EXEC.                                                    43640099
436500                                                                  43650099
436600     EVALUATE TRUE                                                43660099
436700         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     43670099
436800             CONTINUE                                             43680099
436900         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     43690099
437000             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                43700099
437100             SET PS-CURSORCLOSE-TEXT TO TRUE                      43710099
437200             PERFORM 7998-STRING-SQL-FATAL-ERROR                  43720099
437300         WHEN OTHER                                               43730099
437400             MOVE 'UNION_SSN' TO PV-SQL-TABLE-NAME                43740099
437500             SET PS-CURSORCLOSE-TEXT TO TRUE                      43750099
437600             PERFORM 7999-STRING-SQL-FATAL-WARNING                43760099
437700     END-EVALUATE.                                                43770099
437800*----------*                                                      43780099
437900 7390-EXIT.                                                       43790099
438000*----------*                                                      43800099
438100     EXIT.                                                        43810099
438200                                                                  43820099
438300*----------------------------------------------------------       43830099
438400* 7400 THRU 7450 - DB2 INSERTS                                    43840099
438500*----------------------------------------------------------       43850099
438600*-------------------------------------*                           43860099
438700*7400-INSERT-NON-EMP-DISC-ROW SECTION.                            43870099
438800*-------------------------------------*                           43880099
438900*    EXEC SQL                                                     43890099
439000*        INSERT INTO ART_NON_EMP_DISC                             43900099
439100*                   (SSN_NBR                                      43910099
439200*                   ,ACCT_NBR                                     43920099
439300*                   ,DISC_STAT_CDE                                43930099
439400*                   ,EMP_NM                                       43940099
439500*                   ,STR_NBR                                      43950099
439600*                   ,EMP_STAT_CDE                                 43960099
439700*                   ,EMP_TYP_CDE                                  43970099
439800*                   ,DISC_DTE                                     43980099
439900*                   ,TERM_DTE                                     43990099
440000*                   ,LAST_UPD_DTE                                 44000099
440100*                   ,CMNT_TXT)                                    44010099
440200*            VALUES (:ART00000-SSN-NBR                            44020099
440300*                   ,:ART00000-ACCT-NBR                           44030099
440400*                   ,:ART00000-DISC-STAT-CDE                      44040099
440500*                   ,:ART00000-EMP-NM                             44050099
440600*                   ,:ART00000-STR-NBR                            44060099
440700*                   ,:ART00000-EMP-STAT-CDE                       44070099
440800*                   ,:ART00000-EMP-TYP-CDE                        44080099
440900*                   ,:ART00000-DISC-DTE                           44090099
441000*                   ,:ART00000-TERM-DTE:IND-ART00000-TERM-DTE     44100099
441100*                   ,:ART00000-LAST-UPD-DTE                       44110099
441200*                   ,:ART00000-CMNT-TXT:IND-ART00000-CMNT-TXT)    44120099
441300*    END-EXEC.                                                    44130099
441400*                                                                 44140099
441500*    EVALUATE TRUE                                                44150099
441600*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     44160099
441700*           SET PS-NO-EDIT-ERROR TO TRUE                          44170099
441800*           SET CA-LAST-ACTION-SUCCESSFUL TO TRUE                 44180099
441900*        WHEN SQLCODE = PC-DUPLICATE-ROW-SQLCODE                  44190099
442000*           MOVE DP015-REVERSE TO ASSNH                           44200099
442100*           MOVE DP015-REVERSE TO AACCTH                          44210099
442200*           MOVE -1 TO ASSNL                                      44220099
442300*           SET PM-MESSAGE-INDEX TO 18                            44230099
442400*           SET PS-EDIT-ERROR TO TRUE                             44240099
442500*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     44250099
442600*            SET PS-INSERT-TEXT TO TRUE                           44260099
442700*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         44270099
442800*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              44280099
442900*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  44290099
443000*        WHEN OTHER                                               44300099
443100*            SET PS-INSERT-TEXT TO TRUE                           44310099
443200*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         44320099
443300*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              44330099
443400*            PERFORM 7999-STRING-SQL-FATAL-WARNING                44340099
443500*    END-EVALUATE.                                                44350099
443600*----------*                                                      44360099
443700*7400-EXIT.                                                       44370099
443800*----------*                                                      44380099
443900*    EXIT.                                                        44390099
444000*                                                                 44400099
444100*---------------------------------*                               44410099
444200*7425-INSERT-EMP-DISC-ROW SECTION.                                44420099
444300*---------------------------------*                               44430099
444400*    EXEC SQL                                                     44440099
444500*        INSERT INTO ART_EMP_DISC                                 44450099
444600*                   (ACCT_NBR                                     44460099
444700*                   ,EMP_ID                                       44470099
444800*                   ,DISC_STAT_CDE                                44480099
444900*                   ,LAST_UPD_DTE                                 44490099
445000*                   ,CMNT_TXT)                                    44500099
445100*            VALUES (:ART00001-ACCT-NBR                           44510099
445200*                   ,:ART00001-EMP-ID                             44520099
445300*                   ,:ART00001-DISC-STAT-CDE                      44530099
445400*                   ,:ART00001-LAST-UPD-DTE                       44540099
445500*                   ,:ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT)    44550099
445600*    END-EXEC.                                                    44560099
445700*                                                                 44570099
445800*    EVALUATE TRUE                                                44580099
445900*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     44590099
446000*             SET PS-NO-EDIT-ERROR TO TRUE                        44600099
446100*        WHEN SQLCODE = PC-DUPLICATE-ROW-SQLCODE                  44610099
446200*           MOVE DP015-REVERSE TO ASSNH                           44620099
446300*           MOVE DP015-REVERSE TO AACCTH                          44630099
446400*           MOVE -1 TO ASSNL                                      44640099
446500*           SET PM-MESSAGE-INDEX TO 18                            44650099
446600*           SET PS-EDIT-ERROR TO TRUE                             44660099
446700*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     44670099
446800*            SET PS-INSERT-TEXT TO TRUE                           44680099
446900*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             44690099
447000*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               44700099
447100*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  44710099
447200*        WHEN OTHER                                               44720099
447300*            SET PS-INSERT-TEXT TO TRUE                           44730099
447400*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             44740099
447500*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               44750099
447600*            PERFORM 7999-STRING-SQL-FATAL-WARNING                44760099
447700*    END-EVALUATE.                                                44770099
447800*----------*                                                      44780099
447900*7425-EXIT.                                                       44790099
448000*----------*                                                      44800099
448100*    EXIT.                                                        44810099
448200*                                                                 44820099
448300*------------------------------------*                            44830099
448400 7450-INSERT-GLOBAL-TEMP-ROW SECTION.                             44840099
448500*------------------------------------*                            44850099
448600     EXEC SQL                                                     44860099
448700         INSERT INTO ART_GLBL_TMP_TBL                             44870099
448800                    (SSN_NBR                                      44880099
448900                    ,EMP_NM                                       44890099
449000                    ,STR_NBR)                                     44900099
449100             VALUES (:ART00001-SSN-NBR                            44910099
449200                    ,:ART00001-EMP-NM                             44920099
449300                    ,:PV-STR-NBR)                                 44930099
449400     END-EXEC.                                                    44940099
449500                                                                  44950099
449600     EVALUATE TRUE                                                44960099
449700         WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     44970099
449800             SET PS-NO-EDIT-ERROR TO TRUE                         44980099
449900         WHEN SQLCODE = PC-DUPLICATE-ROW-SQLCODE                  44990099
450000             SET PS-EDIT-ERROR TO TRUE                            45000099
450100         WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     45010099
450200             SET PS-INSERT-TEXT TO TRUE                           45020099
450300             MOVE 'ART_GLBL_TMP_TBL' TO PV-SQL-TABLE-NAME         45030099
450400             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              45040099
450500             PERFORM 7998-STRING-SQL-FATAL-ERROR                  45050099
450600         WHEN OTHER                                               45060099
450700             SET PS-INSERT-TEXT TO TRUE                           45070099
450800             MOVE 'ART_GLBL_TMP_TBL' TO PV-SQL-TABLE-NAME         45080099
450900             MOVE ART00001-SSN-NBR TO PV-DISPLAY-KEY              45090099
451000             PERFORM 7999-STRING-SQL-FATAL-WARNING                45100099
451100     END-EVALUATE.                                                45110099
451200*----------*                                                      45120099
451300 7450-EXIT.                                                       45130099
451400*----------*                                                      45140099
451500     EXIT.                                                        45150099
451600                                                                  45160099
451700*----------------------------------------------------------       45170099
451800* 7500 THRU 7525 - DB2 UPDATES                                    45180099
451900*----------------------------------------------------------       45190099
452000*-------------------------------------*                           45200099
452100*7500-UPDATE-NON-EMP-DISC-ROW SECTION.                            45210099
452200*-------------------------------------*                           45220099
452300*    EXEC SQL                                                     45230099
452400*        UPDATE ART_NON_EMP_DISC                                  45240099
452500*        SET DISC_STAT_CDE = :ART00000-DISC-STAT-CDE              45250099
452600*           ,EMP_NM        = :ART00000-EMP-NM                     45260099
452700*           ,STR_NBR       = :ART00000-STR-NBR                    45270099
452800*           ,EMP_STAT_CDE  = :ART00000-EMP-STAT-CDE               45280099
452900*           ,EMP_TYP_CDE   = :ART00000-EMP-TYP-CDE                45290099
453000*           ,DISC_DTE      = :ART00000-DISC-DTE                   45300099
453100*           ,TERM_DTE      =                                      45310099
453200*                        :ART00000-TERM-DTE:IND-ART00000-TERM-DTE 45320099
453300*           ,LAST_UPD_DTE  = :ART00000-LAST-UPD-DTE               45330099
453400*           ,CMNT_TXT      =                                      45340099
453500*                        :ART00000-CMNT-TXT:IND-ART00000-CMNT-TXT 45350099
453600*        WHERE SSN_NBR  = :ART00000-SSN-NBR AND                   45360099
453700*              ACCT_NBR = :ART00000-ACCT-NBR                      45370099
453800*    END-EXEC.                                                    45380099
453900*                                                                 45390099
454000*    EVALUATE TRUE                                                45400099
454100*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     45410099
454200*             SET PS-NO-EDIT-ERROR TO TRUE                        45420099
454300*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     45430099
454400*            SET PS-UPDATE-TEXT TO TRUE                           45440099
454500*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         45450099
454600*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              45460099
454700*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  45470099
454800*        WHEN OTHER                                               45480099
454900*            SET PS-UPDATE-TEXT TO TRUE                           45490099
455000*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         45500099
455100*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              45510099
455200*            PERFORM 7999-STRING-SQL-FATAL-WARNING                45520099
455300*    END-EVALUATE.                                                45530099
455400*----------*                                                      45540099
455500*7500-EXIT.                                                       45550099
455600*----------*                                                      45560099
455700*    EXIT.                                                        45570099
455800*                                                                 45580099
455900*---------------------------------*                               45590099
456000*7525-UPDATE-EMP-DISC-ROW SECTION.                                45600099
456100*---------------------------------*                               45610099
456200*    EXEC SQL                                                     45620099
456300*        UPDATE ART_EMP_DISC                                      45630099
456400*        SET DISC_STAT_CDE = :ART00001-DISC-STAT-CDE              45640099
456500*           ,LAST_UPD_DTE  = :ART00001-LAST-UPD-DTE               45650099
456600*           ,CMNT_TXT      =                                      45660099
456700*                        :ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT 45670099
456800*        WHERE EMP_ID      = :ART00001-EMP-ID AND                 45680099
456900*        ACCT_NBR          = :ART00001-ACCT-NBR                   45690099
457000*    END-EXEC.                                                    45700099
457100*                                                                 45710099
457200*    EVALUATE TRUE                                                45720099
457300*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     45730099
457400*             SET PS-NO-EDIT-ERROR TO TRUE                        45740099
457500*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     45750099
457600*            SET PS-UPDATE-TEXT TO TRUE                           45760099
457700*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             45770099
457800*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               45780099
457900*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  45790099
458000*        WHEN OTHER                                               45800099
458100*            SET PS-UPDATE-TEXT TO TRUE                           45810099
458200*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             45820099
458300*            MOVE XST00072-SS-NBR TO PV-DISPLAY-KEY               45830099
458400*            PERFORM 7999-STRING-SQL-FATAL-WARNING                45840099
458500*    END-EVALUATE.                                                45850099
458600*----------*                                                      45860099
458700*7525-EXIT.                                                       45870099
458800*----------*                                                      45880099
458900*    EXIT.                                                        45890099
459000*                                                                 45900099
459100*----------------------------------------------------------       45910099
459200* 7600 THRU 7650 - DB2 DELETE                                     45920099
459300*----------------------------------------------------------       45930099
459400*-------------------------------------*                           45940099
459500*7600-DELETE-NON-EMP-DISC-ROW SECTION.                            45950099
459600*-------------------------------------*                           45960099
459700*    EXEC SQL                                                     45970099
459800*        DELETE FROM ART_NON_EMP_DISC                             45980099
459900*        WHERE SSN_NBR  = :ART00000-SSN-NBR AND                   45990099
460000*              ACCT_NBR = :ART00000-ACCT-NBR                      46000099
460100*    END-EXEC.                                                    46010099
460200*                                                                 46020099
460300*    EVALUATE TRUE                                                46030099
460400*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     46040099
460500*             SET PS-NO-EDIT-ERROR TO TRUE                        46050099
460600*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     46060099
460700*            SET PS-DELETE-TEXT TO TRUE                           46070099
460800*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         46080099
460900*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              46090099
461000*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  46100099
461100*        WHEN OTHER                                               46110099
461200*            SET PS-DELETE-TEXT TO TRUE                           46120099
461300*            MOVE 'ART_NON_EMP_DISC' TO PV-SQL-TABLE-NAME         46130099
461400*            MOVE ART00000-SSN-NBR TO PV-DISPLAY-KEY              46140099
461500*            PERFORM 7999-STRING-SQL-FATAL-WARNING                46150099
461600*    END-EVALUATE.                                                46160099
461700*----------*                                                      46170099
461800*7600-EXIT.                                                       46180099
461900*----------*                                                      46190099
462000*    EXIT.                                                        46200099
462100*                                                                 46210099
462200*---------------------------------*                               46220099
462300*7650-DELETE-EMP-DISC-ROW SECTION.                                46230099
462400*---------------------------------*                               46240099
462500*    EXEC SQL                                                     46250099
462600*        DELETE FROM ART_EMP_DISC                                 46260099
462700*        WHERE EMP_ID   = :ART00001-EMP-ID AND                    46270099
462800*              ACCT_NBR = :ART00001-ACCT-NBR                      46280099
462900*    END-EXEC.                                                    46290099
463000*                                                                 46300099
463100*    EVALUATE TRUE                                                46310099
463200*        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                     46320099
463300*             SET PS-NO-EDIT-ERROR TO TRUE                        46330099
463400*        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                     46340099
463500*            SET PS-DELETE-TEXT TO TRUE                           46350099
463600*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             46360099
463700*            MOVE ART00001-EMP-ID TO PV-DISPLAY-KEY               46370099
463800*            PERFORM 7998-STRING-SQL-FATAL-ERROR                  46380099
463900*        WHEN OTHER                                               46390099
464000*            SET PS-DELETE-TEXT TO TRUE                           46400099
464100*            MOVE 'ART_EMP_DISC' TO PV-SQL-TABLE-NAME             46410099
464200*            MOVE ART00001-EMP-ID TO PV-DISPLAY-KEY               46420099
464300*            PERFORM 7999-STRING-SQL-FATAL-WARNING                46430099
464400*    END-EVALUATE.                                                46440099
464500*----------*                                                      46450099
464600*7650-EXIT.                                                       46460099
464700*----------*                                                      46470099
464800*    EXIT.                                                        46480099
464900*                                                                 46490099
465000*----------------------------------------------------------       46500099
465100* 7998 THRU 7999 - DB2 FATAL ERROR/WARNING PROCESSING             46510099
465200*----------------------------------------------------------       46520099
465300*------------------------------------*                            46530099
465400 7998-STRING-SQL-FATAL-ERROR SECTION.                             46540099
465500*------------------------------------*                            46550099
465600     STRING                                                       46560099
465700        PS-SQL-ACTION-TEXT          DELIMITED BY SIZE             46570099
465800        ' '                         DELIMITED BY SIZE             46580099
465900        PV-DISPLAY-KEY              DELIMITED BY SIZE             46590099
466000        ' FROM TABLE '              DELIMITED BY SIZE             46600099
466100        PV-SQL-TABLE-NAME           DELIMITED BY SIZE             46610099
466200     INTO DE-ATTEMPTED-ACTION                                     46620099
466300     END-STRING.                                                  46630099
466400     MOVE SQLCODE              TO DE-SQLCODE.                     46640099
466500     MOVE SQLERRD(3)           TO DE-ROWS-PROCESSED.              46650099
466600     MOVE DE-DB2-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE.        46660099
466700     PERFORM 9900-LEAVE-SYSTEM.                                   46670099
466800*----------*                                                      46680099
466900 7998-EXIT.                                                       46690099
467000*----------*                                                      46700099
467100     EXIT.                                                        46710099
467200                                                                  46720099
467300*--------------------------------------*                          46730099
467400 7999-STRING-SQL-FATAL-WARNING SECTION.                           46740099
467500*--------------------------------------*                          46750099
467600     STRING                                                       46760099
467700        PS-SQL-ACTION-TEXT          DELIMITED BY SIZE             46770099
467800        ' '                         DELIMITED BY SIZE             46780099
467900        PV-DISPLAY-KEY              DELIMITED BY SIZE             46790099
468000        ' FROM TABLE '              DELIMITED BY SIZE             46800099
468100        PV-SQL-TABLE-NAME           DELIMITED BY SIZE             46810099
468200     INTO DW-ATTEMPTED-ACTION                                     46820099
468300     END-STRING.                                                  46830099
468400     MOVE SQLCODE                TO DW-SQLCODE.                   46840099
468500     MOVE SQLERRD(3)             TO DW-ROWS-PROCESSED.            46850099
468600     MOVE SQLWARN                TO DW-SQLWARN.                   46860099
468700     MOVE DW-DB2-WARNING-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE.      46870099
468800     PERFORM 9900-LEAVE-SYSTEM.                                   46880099
468900*----------*                                                      46890099
469000 7999-EXIT.                                                       46900099
469100*----------*                                                      46910099
469200     EXIT.                                                        46920099
469300                                                                  46930099
469400*-----------------------------------*                             46940099
469500*8500-WRITE-MAINTENANCE-LOG SECTION.                              46950099
469600*-----------------------------------*                             46960099
469700*    MOVE PV-CURRENT-DATE-YMD     TO AR506O-TRANSACTION-DATE.     46970099
469800*    MOVE PV-CURRENT-TIME         TO AR506O-TRANSACTION-TIME.     46980099
469900*    MOVE PC-CURRENT-PROGRAM-NAME TO AR506O-PROGRAM-NAME.         46990099
470000*    MOVE PC-CURRENT-TRANSID      TO AR506O-TRANSACTION-ID.       47000099
470100*                                                                 47010099
470200*    SET AR506O-EMPLOYEE-ACCOUNT-FILE TO TRUE.                    47020099
470300*    INITIALIZE AR506O-FILE-KEY-VALUE.                            47030099
470400*    MOVE CA-ACCOUNT-NUMBER-X     TO AR506O-ACCOUNT-NUMBER-01.    47040099
470500*    MOVE PV-USER-ID              TO AR506O-USER-ID.              47050099
470600*    MOVE EIBTRMID                TO AR506O-TERMINAL-ID.          47060099
470700*    MOVE PS-ACTION               TO AR506O-FUNCTION-CODE.        47070099
470800*                                                                 47080099
470900*    EXEC CICS                                                    47090099
471000*        WRITE                                                    47100099
471100*            DATASET (FD-MAINTENANCE-LOG-FILE)                    47110099
471200*            FROM    (AR506O-MAINTENANCE-LOG-RECORD)              47120099
471300*            RIDFLD  (PV-RBA)                                     47130099
471400*            RBA                                                  47140099
471500*            RESP    (PV-CICS-RESPONSE)                           47150099
471600*    END-EXEC.                                                    47160099
471700*                                                                 47170099
471800*    IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    47180099
471900*        MOVE 'WRITE A MAINTENANCE LOG RECORD' TO                 47190099
472000*                  VE-ATTEMPTED-ACTION                            47200099
472100*        MOVE FD-MAINTENANCE-LOG-FILE TO VE-FILE-DDNAME           47210099
472200*        MOVE PV-CICS-RESPONSE TO VE-CICS-RESPONSE                47220099
472300*        MOVE VE-VSAM-ERROR-MESSAGE TO                            47230099
472400*                  PV-LEAVE-SYSTEM-MESSAGE                        47240099
472500*        PERFORM 9900-LEAVE-SYSTEM                                47250099
472600*    END-IF.                                                      47260099
472700*----------*                                                      47270099
472800*8500-EXIT.                                                       47280099
472900*----------*                                                      47290099
473000*    EXIT.                                                        47300099
473100*                                                                 47310099
473200******************************************************************47320099
473300*  RETURN TO THE MAIN MENU IF THE SYSTEM IS ENTERED AT THIS      *47330099
473400*  TRANSACTION ID.                                               *47340099
473500******************************************************************47350099
473600*---------------------------------*                               47360099
473700 9000-RETURN-TO-MAIN-MENU SECTION.                                47370099
473800*---------------------------------*                               47380099
473900     SET CA-INITIALIZE-SCREEN TO TRUE.                            47390099
474000     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        47400099
474100                                                                  47410099
474200     EXEC CICS                                                    47420099
474300         XCTL                                                     47430099
474400             PROGRAM (PC-MAIN-MENU-PROGRAM-NAME)                  47440099
474500             RESP    (PV-CICS-RESPONSE)                           47450099
474600     END-EXEC.                                                    47460099
474700                                                                  47470099
474800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    47480099
474900         STRING 'XCTL TO MAIN MENU '       DELIMITED BY SIZE      47490099
475000                PC-MAIN-MENU-PROGRAM-NAME  DELIMITED BY SIZE      47500099
475100             INTO SE-ATTEMPTED-ACTION                             47510099
475200         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                47520099
475300         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  47530099
475400         PERFORM 9900-LEAVE-SYSTEM                                47540099
475500     END-IF.                                                      47550099
475600*----------*                                                      47560099
475700 9000-EXIT.                                                       47570099
475800*----------*                                                      47580099
475900     EXIT.                                                        47590099
476000                                                                  47600099
476100******************************************************************47610099
476200*  RETURN TO THE PROGRAM THAT CALLED THIS PROGRAM, UPON EITHER   *47620099
476300*  ABORTING OR SUCCESSFULLY COMPLETING THE REQUESTED FUNCTION.   *47630099
476400******************************************************************47640099
476500*---------------------------------------*                         47650099
476600 9100-RETURN-TO-CALLING-PROGRAM SECTION.                          47660099
476700*---------------------------------------*                         47670099
476800     SET CA-INITIALIZE-SCREEN TO TRUE.                            47680099
476900     MOVE CA-LAST-PROGRAM-NAME TO PV-TRANSFER-PROGRAM-NAME.       47690099
477000     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        47700099
477100                                                                  47710099
477200     EXEC CICS                                                    47720099
477300         XCTL                                                     47730099
477400             PROGRAM  (PV-TRANSFER-PROGRAM-NAME)                  47740099
477500             COMMAREA (CA-COMMON-AREA)                            47750099
477600             LENGTH   (PC-TRANSFER-UP-LENGTH)                     47760099
477700             RESP     (PV-CICS-RESPONSE)                          47770099
477800     END-EXEC.                                                    47780099
477900                                                                  47790099
478000     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    47800099
478100         STRING 'XCTL TO '                DELIMITED BY SIZE       47810099
478200                PV-TRANSFER-PROGRAM-NAME  DELIMITED BY SIZE       47820099
478300             INTO SE-ATTEMPTED-ACTION                             47830099
478400         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                47840099
478500         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  47850099
478600         PERFORM 9900-LEAVE-SYSTEM                                47860099
478700     END-IF.                                                      47870099
478800*----------*                                                      47880099
478900 9100-EXIT.                                                       47890099
479000*----------*                                                      47900099
479100     EXIT.                                                        47910099
479200                                                                  47920099
479300******************************************************************47930099
479400*  EXIT THE ACCOUNTS RECEIVABLE EMPLOYEE DISCOUNT SYSTEM,        *47940099
479500*  ROLLING BACK ALL FILE CHANGES MADE DURING THIS PASS THROUGH   *47950099
479600*  THE TRANSACTION, AND DISPLAYING A REASON FOR THE PROGRAM      *47960099
479700*  ABEND.                                                        *47970099
479800******************************************************************47980099
479900*--------------------------*                                      47990099
480000 9900-LEAVE-SYSTEM SECTION.                                       48000099
480100*--------------------------*                                      48010099
480200     EXEC CICS                                                    48020099
480300         SYNCPOINT                                                48030099
480400             ROLLBACK                                             48040099
480500     END-EXEC.                                                    48050099
480600                                                                  48060099
480700     EXEC CICS                                                    48070099
480800         SEND                                                     48080099
480900             FROM   (PV-LEAVE-SYSTEM-MESSAGE)                     48090099
481000             LENGTH (PC-LEAVE-SYSTEM-LENGTH)                      48100099
481100             ERASE                                                48110099
481200     END-EXEC.                                                    48120099
481300                                                                  48130099
481400     EXEC CICS                                                    48140099
481500         RETURN                                                   48150099
481600     END-EXEC.                                                    48160099
481700*----------*                                                      48170099
481800 9900-EXIT.                                                       48180099
481900*----------*                                                      48190099
482000     EXIT.                                                        48200099
482100*----------------------------------------------------------------*48210099
482200*    ABEND PROCESSOR MODULE                                      *48220099
482300*----------------------------------------------------------------*48230099
482400                                                                  48240099
482500     COPY DPPD013.                                                48250099
482600*----------------------------------------------------------------*48260099
482700* COPY MEMBER DPPD032 CONTAINS STATEMENTS NEEDED TO INVOKE       *48270099
482800* PROTEGRITY MODULE FOR TOKENIZATION                             *48280099
482900*----------------------------------------------------------------*48290099
483000                                                                  48300099
483100     COPY DPPD032.                                                48310099
483200*----------------------------------------------------------------*48320099
