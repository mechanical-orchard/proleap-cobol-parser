000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000500 PROGRAM-ID.             SUKRP038.                                00040000
000600 AUTHOR.                 XXXXXXXXXXXXXXX.                         00050000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000800 DATE-WRITTEN            JANUARY 2005.                            00070000
000900 DATE-COMPILED.                                                   00080000
001100***************************************************************** 00090000
001200*  THIS PROGRAM WILL CREATE THE DAILY TRAILER SUSPENSE REPORT - * 00100000
001300*  SHIPPED BUT NOT OPENED AT STORE REPORT.                      * 00110000
001500***************************************************************** 00120000
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00130000
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00140000
001900***************************************************************** 00150000
002000***************************************************************** 00160000
002100 ENVIRONMENT DIVISION.                                            00170000
002200***************************************************************** 00180000
002400 CONFIGURATION SECTION.                                           00190000
002600 SOURCE-COMPUTER.        IBM-3090.                                00200000
002700 OBJECT-COMPUTER.        IBM-3090.                                00210000
002800                                                                  00220000
002900 INPUT-OUTPUT SECTION.                                            00230000
003100 FILE-CONTROL.                                                    00240000
003200*                                                                 00250000
003600     SELECT INPUT-FILE                                            00260000
003700         ASSIGN TO INP01.                                         00270000
003200*                                                                 00280000
004500     SELECT REPORT-FILE                                           00290000
004600         ASSIGN TO RPT01.                                         00300000
004700*                                                                 00310000
004800***************************************************************** 00320000
004900 DATA DIVISION.                                                   00330000
005000***************************************************************** 00340000
005200 FILE SECTION.                                                    00350000
002700*                                                                 00360000
002800 FD  INPUT-FILE                                                   00370000
002900     RECORDING MODE IS F                                          00380000
003000     LABEL RECORDS ARE STANDARD                                   00390000
003200     BLOCK CONTAINS 0 RECORDS                                     00400000
003100     RECORD CONTAINS 106 CHARACTERS.                              00410000
003400 01  INPUT-RECORD                    PIC  X(106).                 00420000
005400*                                                                 00430000
007300 FD  REPORT-FILE                                                  00440000
007400     RECORDING MODE IS F                                          00450000
007500     BLOCK CONTAINS 0  RECORDS.                                   00460000
007600 01  REPORT-RECORD                   PIC  X(132).                 00470000
007700*                                                                 00480000
008900***************************************************************** 00490000
009000 WORKING-STORAGE SECTION.                                         00500000
009100*                                                                 00510000
012000 01  PROGRAM-SWITCHES.                                            00520000
012100     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530000
012200         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540000
012300         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550000
015800*                                                                 00560000
015900 01  PV-PROGRAM-CONSTANTS.                                        00570000
           05  PV-TIMESTAMP                PIC X(26).                   00580000
                                                                        00590000
095400     05  PC-SUKRP038                 PIC X(08) VALUE  'SUKRP038'. 00600000
094700     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00610000
015800*                                                                 00620000
015900 01  PV-PROGRAM-VARIABLES.                                        00630000
           05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00640000
026400     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00650000
026500                                                   COMP-3.        00660000
026000     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00670000
026100                                                   COMP-3.        00680000
017000     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00690000
017100                                                   COMP-3.        00700000
026400     05  PV-OPER-UNT-ID              PIC S9(04) VALUE ZERO        00710000
017100                                                   COMP.          00720000
026400     05  PV-STR-NBR                  PIC S9(04) VALUE ZERO        00730000
017100                                                   COMP.          00740000
036300     05  PV-TODAYS-DATE.                                          00750000
036400         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        00760000
036500         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        00770000
036600         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        00780000
036700     05  PV-TODAYS-TIME.                                          00790000
036800         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        00800000
036900         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        00810000
037000         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        00820000
037100         10  FILLER                  PIC 9(02) VALUE ZERO.        00830000
036300     05  PV-COMPARE-DATE.                                         00840000
036400         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        00850000
036400         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        00860000
036420         10  FILLER                  PIC X(01) VALUE '-'.         00870000
036500         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        00880000
015200         10  FILLER                  PIC X(01) VALUE '-'.         00890000
036600         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        00900000
036300     05  PV-PLAN-INV-DTE.                                         00910000
036400         10  PV-PLAN-INV-DTE-CCYY    PIC 9(04) VALUE ZERO.        00920000
036420         10  FILLER                  PIC X(01) VALUE '-'.         00930000
036500         10  PV-PLAN-INV-DTE-MM      PIC 9(02) VALUE ZERO.        00940000
036420         10  FILLER                  PIC X(01) VALUE '-'.         00950000
036500         10  PV-PLAN-INV-DTE-DD      PIC 9(02) VALUE ZERO.        00960000
042900*                                                                 00970000
015000 01  PV-DATE-TIME.                                                00980000
015500     05  PV-DATE-TIME-CCYY            PIC X(04) VALUE SPACE.      00990000
015600     05  FILLER                       PIC X(01) VALUE SPACE.      01000000
015100     05  PV-DATE-TIME-MM              PIC X(02) VALUE SPACE.      01010000
015200     05  FILLER                       PIC X(01) VALUE SPACE.      01020000
015300     05  PV-DATE-TIME-DD              PIC X(02) VALUE SPACE.      01030000
015400     05  FILLER                       PIC X(01) VALUE SPACE.      01040000
015500     05  PV-DATE-TIME-HH              PIC X(02) VALUE SPACE.      01050000
015600     05  FILLER                       PIC X(01) VALUE SPACE.      01060000
015100     05  PV-DATE-TIME-MN              PIC X(02) VALUE SPACE.      01070000
015200     05  FILLER                       PIC X(01) VALUE SPACE.      01080000
015300     05  PV-DATE-TIME-SS              PIC X(02) VALUE SPACE.      01090000
015400     05  FILLER                       PIC X(07) VALUE SPACE.      01100000
042900*                                                                 01110000
015000 01  PV-DISPLAY-DATE.                                             01120000
015100     05  PV-DISPLAY-MM                PIC X(02) VALUE SPACE.      01130000
015200     05  FILLER                       PIC X(01) VALUE '/'.        01140000
015300     05  PV-DISPLAY-DD                PIC X(02) VALUE SPACE.      01150000
015400     05  FILLER                       PIC X(01) VALUE '/'.        01160000
015500     05  PV-DISPLAY-CCYY              PIC X(04) VALUE SPACE.      01170000
042900*                                                                 01180000
015000 01  PV-DISPLAY-TIME.                                             01190000
015100     05  PV-DISPLAY-HH                PIC X(02) VALUE SPACE.      01200000
015200     05  FILLER                       PIC X(01) VALUE ':'.        01210000
015300     05  PV-DISPLAY-MN                PIC X(02) VALUE SPACE.      01220000
042900*                                                                 01230000
015900 01  DK-DB2-KEY-FIELDS.                                           01240000
095400     05  DK-OPER-UNT-ID              PIC S9(04) COMP VALUE ZEROES.01250000
042900*                                                                 01260000
015900 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01270000
                                                       COMP SYNC.       01280000
042900*                                                                 01290000
043000******************************************************************01300000
043100* COPY BOOK FOR TRAILER SUSPENSE - SHIPPED BUT NOT OPENED AT STORE01310000
043200******************************************************************01320000
043400     COPY SURD055.                                                01330000
043600*                                                                 01340000
044900******************************************************************01350000
045000*  DB2 FORMATTED MESSAGE AREA                                     01360000
045100******************************************************************01370000
045200     COPY DPWS004.                                                01380000
045300*                                                                 01390000
045400******************************************************************01400000
045500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01410000
045600******************************************************************01420000
045700     COPY DPWS132O.                                               01430000
045900*                                                                 01440000
046000 01  HEADING-LINES.                                               01450000
046100     05  HEADING-LINE-1.                                          01460000
046500         10  FILLER                  PIC  X(54)    VALUE SPACES.  01470000
046300         10  FILLER                  PIC  X(23)    VALUE          01480000
046400             'TRAILER SUSPENSE REPORT'.                           01490000
046500         10  FILLER                  PIC  X(55)    VALUE SPACES.  01500000
046600*                                                                 01510000
046100     05  HEADING-LINE-2.                                          01520000
046500         10  FILLER                  PIC  X(50)    VALUE SPACES.  01530000
046300         10  FILLER                  PIC  X(37)    VALUE          01540000
046400             'INVENTORY STORES WITH TRAILERS'.                    01550000
046500         10  FILLER                  PIC  X(48)    VALUE SPACES.  01560000
049100*                                                                 01570000
046100     05  HEADING-LINE-3.                                          01580000
046500         10  FILLER                  PIC  X(48)    VALUE SPACES.  01590000
046300         10  FILLER                  PIC  X(37)    VALUE          01600000
046400             'SHIPPED OR OPENED BUT NOT UNLOADED'.                01610000
046500         10  FILLER                  PIC  X(48)    VALUE SPACES.  01620000
049100*                                                                 01630000
052000     05  HEADING-LINE-4.                                          01640000
047400         10  FILLER                  PIC  X(71)    VALUE SPACES.  01650000
047500         10  FILLER                  PIC  X(07)    VALUE          01660000
047600             'TRAILER'.                                           01670000
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  01680000
047500         10  FILLER                  PIC  X(07)    VALUE          01690000
047600             'TRAILER'.                                           01700000
047400         10  FILLER                  PIC  X(08)    VALUE SPACES.  01710000
047500         10  FILLER                  PIC  X(14)    VALUE          01720000
047600             'TRAILER STATUS'.                                    01730000
049000         10  FILLER                  PIC  X(06)    VALUE SPACES.  01740000
047500         10  FILLER                  PIC  X(07)    VALUE          01750000
047600             'PLANNED'.                                           01760000
049000         10  FILLER                  PIC  X(09)    VALUE SPACES.  01770000
051900*                                                                 01780000
052000     05  HEADING-LINE-5.                                          01790000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  01800000
047400         10  FILLER                  PIC  X(05)    VALUE          01810000
047600             'STORE'.                                             01820000
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  01830000
047500         10  FILLER                  PIC  X(02)    VALUE          01840000
047600             'DC'.                                                01850000
047400         10  FILLER                  PIC  X(13)    VALUE SPACES.  01860000
047500         10  FILLER                  PIC  X(10)    VALUE          01870000
047600             'STORE NAME'.                                        01880000
047400         10  FILLER                  PIC  X(12)    VALUE SPACES.  01890000
047500         10  FILLER                  PIC  X(04)    VALUE          01900000
047600             'SCAC'.                                              01910000
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  01920000
047500         10  FILLER                  PIC  X(10)    VALUE          01930000
047600             'TRAILER ID'.                                        01940000
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  01950000
047500         10  FILLER                  PIC  X(06)    VALUE          01960000
047600             'SERIAL'.                                            01970000
047400         10  FILLER                  PIC  X(06)    VALUE SPACES.  01980000
047500         10  FILLER                  PIC  X(08)    VALUE          01990000
047600             '# STATUS'.                                          02000000
047400         10  FILLER                  PIC  X(09)    VALUE SPACES.  02010000
047500         10  FILLER                  PIC  X(09)    VALUE          02020000
047600             'DATE/TIME'.                                         02030000
047400         10  FILLER                  PIC  X(09)    VALUE SPACES.  02040000
047500         10  FILLER                  PIC  X(08)    VALUE          02050000
047600             'INV DATE'.                                          02060000
049000         10  FILLER                  PIC  X(08)    VALUE SPACES.  02070000
051900*                                                                 02080000
052000     05  HEADING-LINE-6.                                          02090000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02100000
047400         10  FILLER                  PIC  X(05)    VALUE          02110000
047600             '-----'.                                             02120000
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02130000
047500         10  FILLER                  PIC  X(04)    VALUE          02140000
047600             '----'.                                              02150000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02160000
047500         10  FILLER                  PIC  X(30)    VALUE          02170000
047600             '------------------------------'.                    02180000
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02190000
047500         10  FILLER                  PIC  X(04)    VALUE          02200000
047600             '----'.                                              02210000
047400         10  FILLER                  PIC  X(05)    VALUE SPACES.  02220000
047500         10  FILLER                  PIC  X(10)    VALUE          02230000
047600             '----------'.                                        02240000
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02250000
047500         10  FILLER                  PIC  X(09)    VALUE          02260000
047600             '---------'.                                         02270000
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02280000
047500         10  FILLER                  PIC  X(10)    VALUE          02290000
047600             '----------'.                                        02300000
047400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02310000
047500         10  FILLER                  PIC  X(17)    VALUE          02320000
047600             '-----------------'.                                 02330000
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02340000
047500         10  FILLER                  PIC  X(10)    VALUE          02350000
047600             '----------'.                                        02360000
049000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02370000
053700*                                                                 02380000
069600 01  DETAIL-LINES.                                                02390000
069700     05  DETAIL-LINE1.                                            02400000
070500         10  FILLER                 PIC  X(02)     VALUE SPACES.  02410000
069800         10  DL1-STR-NBR            PIC  Z(04)     VALUE SPACES.  02420000
071800         10  FILLER                 PIC  X(04)     VALUE SPACES.  02430000
071700         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02440000
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02450000
071700         10  DL1-STORE-NM           PIC  X(30)     VALUE SPACES.  02460000
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02470000
071700         10  DL1-SCAC               PIC  X(04)     VALUE SPACES.  02480000
071800         10  FILLER                 PIC  X(06)     VALUE SPACES.  02490000
071700         10  DL1-TRLR-ID            PIC  X(12)     VALUE SPACES.  02500000
071800         10  FILLER                 PIC  X(01)     VALUE SPACES.  02510000
071700         10  DL1-TRLR-SRL-NBR       PIC  X(09)     VALUE SPACES.  02520000
071800         10  FILLER                 PIC  X(03)     VALUE SPACES.  02530000
071700         10  DL1-TRLR-STATUS        PIC  X(10)     VALUE SPACES.  02540000
071800         10  FILLER                 PIC  X(04)     VALUE SPACES.  02550000
071700         10  DL1-DATE               PIC  X(10)     VALUE SPACES.  02560000
071800         10  FILLER                 PIC  X(02)     VALUE SPACES.  02570000
071700         10  DL1-TIME               PIC  X(05)     VALUE SPACES.  02580000
071800         10  FILLER                 PIC  X(03)     VALUE SPACES.  02590000
071700         10  DL1-PLAN-INV-DT        PIC  X(10)     VALUE SPACES.  02600000
066200*                                                                 02610000
066400 01  MISCELLANEOUS-LINES.                                         02620000
066500     05  BLANK-LINE.                                              02630000
066600         10  FILLER                  PIC  X(132)   VALUE SPACES.  02640000
066500     05  NO-DATA-LINE.                                            02650000
066600         10  FILLER                  PIC  X(42)    VALUE SPACES.  02660000
066700         10  FILLER                  PIC  X(47)    VALUE          02670000
066800             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   02680000
066900         10  FILLER                  PIC  X(43)    VALUE SPACES.  02690000
067000     05  END-OF-REPORT-LINE.                                      02700000
067100         10  FILLER                  PIC  X(54)    VALUE SPACES.  02710000
067200         10  FILLER                  PIC  X(44)    VALUE          02720000
067300             '  ** END OF REPORT **                       '.      02730000
067100         10  FILLER                  PIC  X(44)    VALUE SPACES.  02740000
080200*                                                                 02750000
068600******************************************************************02760000
080100*  COPY BOOK FOR THE TABLE TSUOBSC                                02770000
068600******************************************************************02780000
080300     EXEC SQL                                                     02790000
080400          INCLUDE TSUOBSC                                         02800000
080500     END-EXEC.                                                    02810000
080200*                                                                 02820000
084400***************************************************************** 02830000
087310*  DB2 COMMUNICATION AREA                                         02840000
084400***************************************************************** 02850000
087500     EXEC SQL                                                     02860000
087600         INCLUDE SQLCA                                            02870000
087700     END-EXEC.                                                    02880000
087800                                                                  02890000
084400***************************************************************** 02900000
087900*  DB2 COMMUNICATION AREA2                                        02910000
084400***************************************************************** 02920000
088100     COPY SQLCA2.                                                 02930000
088200                                                                  02940000
088400                                                                  02950000
084400***************************************************************** 02960000
088500 PROCEDURE DIVISION.                                              02970000
088600*                                                                 02980000
088700 0000-MAINLINE-PROCESSING.                                        02990000
088800******************************************************************03000000
088900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03010000
089000******************************************************************03020000
003600     DISPLAY '****** STARTING SUKRP038 ******'.                   03030000
089800*                                                                 03040000
003800*OPEN FILES.                                                      03050000
003600     OPEN INPUT INPUT-FILE                                        03060000
004500          OUTPUT REPORT-FILE.                                     03070000
                                                                        03080000
           EXEC SQL SET :PV-TIMESTAMP = CURRENT TIMESTAMP               03090000
           END-EXEC.                                                    03100000
089800*                                                                 03110000
003800*PREPARE REPORT.                                                  03120000
089700     PERFORM 1000-INITIALIZATION.                                 03130000
089800*                                                                 03140000
089800*READ FIRST RECORD.                                               03150000
090000     SET PS-NOT-END-OF-INPUT TO TRUE.                             03160000
                                                                        03170000
090100     READ INPUT-FILE                                              03180000
             INTO SU055-EXTRACT-RECORD                                  03190000
               AT END                                                   03200000
090000           SET PS-END-OF-INPUT TO TRUE.                           03210000
090200*                                                                 03220000
089800*PROCESS INPUT FILE.                                              03230000
090000     IF PS-END-OF-INPUT                                           03240000
           ADD +1                  TO PV-PAGE-COUNT                     03250000
           MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER                03260000
091000     WRITE REPORT-RECORD                                          03270000
091100       FROM DP132O-STANDRD-HEADER-132-COLS                        03280000
091200         AFTER ADVANCING PAGE                                     03290000
091000     WRITE REPORT-RECORD                                          03300000
091100       FROM HEADING-LINE-1                                        03310000
091200         AFTER ADVANCING 2 LINES                                  03320000
091000     WRITE REPORT-RECORD                                          03330000
091100       FROM HEADING-LINE-2                                        03340000
091200         AFTER ADVANCING 1 LINE                                   03350000
091000     WRITE REPORT-RECORD                                          03360000
091100       FROM HEADING-LINE-3                                        03370000
091200         AFTER ADVANCING 1 LINE                                   03380000
091000     WRITE REPORT-RECORD                                          03390000
091100       FROM NO-DATA-LINE                                          03400000
091200         AFTER ADVANCING 2 LINES                                  03410000
           ELSE                                                         03420000
091000         PERFORM 1500-PAGE-BREAK                                  03430000
090300         PERFORM 2000-PROCESS-INPUT UNTIL PS-END-OF-INPUT         03440000
           END-IF.                                                      03450000
090500*                                                                 03460000
090500*FINISH REPORT.                                                   03470000
091000     WRITE REPORT-RECORD                                          03480000
091100       FROM END-OF-REPORT-LINE                                    03490000
091200         AFTER ADVANCING 2 LINES.                                 03500000
091300*                                                                 03510000
091300*CLOSE FILES.                                                     03520000
003600     CLOSE INPUT-FILE                                             03530000
004500           REPORT-FILE.                                           03540000
092500*                                                                 03550000
092600     GOBACK.                                                      03560000
092800*                                                                 03570000
092800******************************************************************03580000
092900 1000-INITIALIZATION.                                             03590000
093000******************************************************************03600000
093100**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03610000
093200******************************************************************03620000
094100     ACCEPT PV-TODAYS-DATE                                        03630000
094200       FROM DATE.                                                 03640000
094300*                                                                 03650000
094400     ACCEPT PV-TODAYS-TIME                                        03660000
094500       FROM TIME.                                                 03670000
094600*                                                                 03680000
094800     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  03690000
                                      PV-COMPARE-DATE-MM.               03700000
094900     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    03710000
                                      PV-COMPARE-DATE-DD.               03720000
095000     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   03730000
                                      PV-COMPARE-DATE-YY.               03740000
095000     IF PV-COMPARE-DATE-YY  >  80                                 03750000
0950           MOVE  19            TO PV-COMPARE-DATE-CC                03760000
095000     ELSE                                                         03770000
0950           MOVE  20            TO PV-COMPARE-DATE-CC                03780000
095000     END-IF.                                                      03790000
095100*                                                                 03800000
095200     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  03810000
095300     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                03820000
095100*                                                                 03830000
095400     MOVE PC-SUKRP038        TO DP132O-PROGRAM-NAME.              03840000
094700     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             03850000
095500*                                                                 03860000
           MOVE +0                 TO PV-PAGE-COUNT.                    03870000
      *                                                                 03880000
095500*                                                                 03890000
112300******************************************************************03900000
112400**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03910000
112500**  PAGES (AS NEEDED).                                            03920000
112700******************************************************************03930000
112200 1500-PAGE-BREAK.                                                 03940000
      *                                                                 03950000
           ADD +1                  TO PV-PAGE-COUNT.                    03960000
           MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               03970000
      *                                                                 03980000
091000     WRITE REPORT-RECORD                                          03990000
091100       FROM DP132O-STANDRD-HEADER-132-COLS                        04000000
091200         AFTER ADVANCING PAGE.                                    04010000
095500*                                                                 04020000
091000     WRITE REPORT-RECORD                                          04030000
091100       FROM HEADING-LINE-1                                        04040000
091200         AFTER ADVANCING 2 LINES.                                 04050000
095500*                                                                 04060000
091000     WRITE REPORT-RECORD                                          04070000
091100       FROM HEADING-LINE-2                                        04080000
091200         AFTER ADVANCING 1 LINE.                                  04090000
095500*                                                                 04100000
091000     WRITE REPORT-RECORD                                          04110000
091100       FROM HEADING-LINE-3                                        04120000
091200         AFTER ADVANCING 1 LINE.                                  04130000
095500*                                                                 04140000
091000     WRITE REPORT-RECORD                                          04150000
091100       FROM HEADING-LINE-4                                        04160000
091200         AFTER ADVANCING 2 LINE.                                  04170000
095500*                                                                 04180000
091000     WRITE REPORT-RECORD                                          04190000
091100       FROM HEADING-LINE-5                                        04200000
091200         AFTER ADVANCING 1 LINE.                                  04210000
095500*                                                                 04220000
091000     WRITE REPORT-RECORD                                          04230000
091100       FROM HEADING-LINE-6                                        04240000
091200         AFTER ADVANCING 1 LINE.                                  04250000
095500*                                                                 04260000
           MOVE +7                 TO PV-LINE-COUNT.                    04270000
095500*                                                                 04280000
095500*                                                                 04290000
121500******************************************************************04300000
121600**  READ INPUT-FILE, WHEN DC CHANGES, TO A PAGE BREAK             04310000
121800******************************************************************04320000
090300 2000-PROCESS-INPUT.                                              04330000
           IF SU055-PLND-INV-DTE  NOT = PV-PLAN-INV-DTE                 04340000
               MOVE SU055-PLND-INV-DTE TO PV-PLAN-INV-DTE               04350000
091000         WRITE REPORT-RECORD                                      04360000
091100          FROM BLANK-LINE                                         04370000
091200         AFTER ADVANCING 1 LINE                                   04380000
               ADD +1                  TO PV-LINE-COUNT                 04390000
               PERFORM 2100-PRINT-DETAIL-LINE                           04400000
           ELSE                                                         04410000
               PERFORM 2100-PRINT-DETAIL-LINE.                          04420000
                                                                        04430000
122300     PERFORM 3000-READ-EXTRACT-FILE.                              04440000
                                                                        04450000
097900*                                                                 04460000
121800******************************************************************04470000
113000 2100-PRINT-DETAIL-LINE.                                          04480000
097900*                                                                 04490000
071700     MOVE SU055-LOC-NBR            TO DL1-STR-NBR.                04500000
071700     MOVE SU055-ORGN-OPER-UNT-ID   TO DL1-OPER-UNT.               04510000
071700     MOVE SU055-LOC-NM             TO DL1-STORE-NM.               04520000
071700     MOVE SU055-SHIP-SCAC-CDE      TO DL1-SCAC.                   04530000
071700     MOVE SU055-TRLR-ID            TO DL1-TRLR-ID.                04540000
071700     MOVE SU055-TRLR-SRL-NBR       TO DL1-TRLR-SRL-NBR.           04550000
071700*    MOVE SU055-TRIP-STAT-CDE      TO DL1-TRLR-STATUS.            04560000
071700     MOVE SU055-OTBND-STAT-TMST    TO PV-DATE-TIME.               04570000
071700     MOVE PV-DATE-TIME-CCYY        TO PV-DISPLAY-CCYY.            04580000
071700     MOVE PV-DATE-TIME-MM          TO PV-DISPLAY-MM.              04590000
071700     MOVE PV-DATE-TIME-DD          TO PV-DISPLAY-DD.              04600000
071700     MOVE PV-DATE-TIME-HH          TO PV-DISPLAY-HH.              04610000
071700     MOVE PV-DATE-TIME-MN          TO PV-DISPLAY-MN.              04620000
071700     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   04630000
071700     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   04640000
           MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   04650000
           MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   04660000
071700     MOVE SU055-PLND-INV-DTE       TO DL1-PLAN-INV-DT.            04670000
071700                                                                  04680000
071700     PERFORM 2200-GET-TRLR-STATUS.                                04690000
097900*                                                                 04700000
           ADD +1 TO PV-LINE-COUNT.                                     04710000
           IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         04720000
               PERFORM 1500-PAGE-BREAK                                  04730000
           END-IF.                                                      04740000
097900*                                                                 04750000
091000     WRITE REPORT-RECORD                                          04760000
091100       FROM DETAIL-LINE1                                          04770000
091200         AFTER ADVANCING 1 LINE.                                  04780000
095500*                                                                 04790000
121800******************************************************************04800000
199933 2200-GET-TRLR-STATUS.                                            04810000
199934                                                                  04820000
199935     EXEC SQL                                                     04830000
199936          SELECT STAT_SHRT_DESC                                   04840000
199937            INTO :SUOBSC-STAT-SHRT-DESC                           04850000
199938            FROM TSUOBSC                                          04860000
199939           WHERE TRIP_STAT_CDE  =  :SU055-TRIP-STAT-CDE           04870000
199940     END-EXEC.                                                    04880000
199941                                                                  04890000
199942     EVALUATE TRUE                                                04900000
199943         WHEN SQLCODE EQUAL 0                                     04910000
199944              MOVE  SUOBSC-STAT-SHRT-DESC TO  DL1-TRLR-STATUS     04920000
199945                                                                  04930000
199946         WHEN OTHER                                               04940000
199944              MOVE  'UNKNOWN'             TO  DL1-TRLR-STATUS     04950000
199955     END-EVALUATE.                                                04960000
259500*                                                                 04970000
243800******************************************************************04980000
243900*  READ A RECORD FROM THE TRAILER SUSPENSE UNLOAD FILE.          *04990000
244000******************************************************************05000000
122300 3000-READ-EXTRACT-FILE.                                          05010000
244200     READ INPUT-FILE                                              05020000
244300       INTO SU055-EXTRACT-RECORD                                  05030000
244400         AT END                                                   05040000
244500           SET PS-END-OF-INPUT TO TRUE.                           05050000
095500*                                                                 05060000
277000******************************************************************05070000
277100*     SQL WARNING OR ERROR PROCESSING                            *05080000
277200******************************************************************05090000
277500 Z999-SQL-ERROR.                                                  05100000
277800     MOVE SQLCODE    TO SQLCODE2.                                 05110000
277900     MOVE SQLERRD(3) TO SQLERRD3.                                 05120000
278000     DISPLAY '** ABEND **       ** = SQLERROR'.                   05130000
278100     DISPLAY '** PROGRAM        ** = SUKRP038'.                   05140000
278200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  05150000
278300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  05160000
278400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   05170000
278500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  05180000
278600*                                                                 05190000
278700******************************************************************05200000
278800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    05210000
278900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         05220000
279000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     05230000
279100* FORMAT.                                                         05240000
279200******************************************************************05250000
279300     COPY DPPD004.                                                05260000
279400*                                                                 05270000
279500     MOVE +4003 TO  ABEND-CODE.                                   05280000
279600     CALL 'ILBOABN0' USING ABEND-CODE.                            05290000
279200******************************************************************05300000
