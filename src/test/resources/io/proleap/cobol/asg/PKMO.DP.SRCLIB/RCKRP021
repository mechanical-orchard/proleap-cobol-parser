000100 IDENTIFICATION DIVISION.                                         00010001
000200                                                                  00020001
000300 PROGRAM-ID.             RCKRP021.                                00030002
000400 AUTHOR.                 DENISE HAHN.                             00040001
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050001
000600 DATE-WRITTEN            APRIL, 1998.                             00060003
000700                                                                  00070001
000800******************************************************************00080001
000900*                                                                 00090001
001000*  THIS PROGRAM CREATES THE MONTHLY RECEIPT FLOW ANALYSIS SUMMARY 00100003
001100*  REPORT                                                         00110003
001110*                                                                 00111003
001200*  THE INPUT FILE SHOULD BE SORTED IN THE FOLLOWING SEQUENCE:     00120001
001300*      -DIVISION, BUYER, DEPT                                     00130003
001400******************************************************************00140001
001500                                                                  00150001
001600                                                                  00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900                                                                  00190001
002000 FILE-CONTROL.                                                    00200001
002100                                                                  00210001
002200     SELECT INPUT-FILE        ASSIGN TO INP01.                    00220003
002300                                                                  00230001
002400     SELECT REPORT-FILE       ASSIGN TO RPT01.                    00240001
002500                                                                  00250001
002600                                                                  00260001
002700 DATA DIVISION.                                                   00270001
002800                                                                  00280001
002900 FILE SECTION.                                                    00290001
003000 FD  INPUT-FILE                                                   00300001
003100     RECORDING MODE IS F                                          00310001
003200     LABEL RECORDS ARE STANDARD                                   00320001
003300     BLOCK CONTAINS 0 RECORDS.                                    00330001
003400 01  INPUT-RECORD                     PIC X(250).                 00340001
003500                                                                  00350001
003600                                                                  00360001
003700 FD  REPORT-FILE                                                  00370001
003800     RECORDING MODE IS F                                          00380001
003900     BLOCK CONTAINS 0 RECORDS                                     00390001
004000     LABEL RECORDS ARE OMITTED.                                   00400001
004100 01  REPORT-RECORD                    PIC  X(132).                00410001
004200                                                                  00420001
004300                                                                  00430001
004400                                                                  00440001
004500 WORKING-STORAGE SECTION.                                         00450001
004600 01  PS-SWITCHES.                                                 00460001
004700     05  PS-INPUT-EOF-SW               PIC  X(03)    VALUE 'N'.   00470001
004800         88  PS-INPUT-EOF                            VALUE 'Y'.   00480001
004900         88  PS-INPUT-NOT-EOF                        VALUE 'N'.   00490001
005000     05  PS-NEW-PAGE-SW                PIC  X(03)    VALUE 'N'.   00500001
005100         88  PS-NEW-PAGE                             VALUE 'Y'.   00510001
005200         88  PS-NOT-NEW-PAGE                         VALUE 'N'.   00520001
005300     05  PS-NO-DETAIL-SW               PIC  X(03)    VALUE 'N'.   00530001
005310         88  PS-NO-DETAIL                            VALUE 'Y'.   00531001
005320                                                                  00532001
005330 01  CD-CPU-DATE.                                                 00533001
005340     03  CD-YEAR                       PIC  9(02)    VALUE ZERO.  00534001
005350     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00535001
005360     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00536001
005370                                                                  00537001
005380 01  CT-CPU-TIME.                                                 00538001
005390     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  00539001
005400     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  00540001
005500     03  FILLER                        PIC  9(04)    VALUE ZERO.  00550001
005600                                                                  00560001
005700 01  PV-ABEND-FIELDS.                                             00570001
005800     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      00580001
005900                                                                  00590001
006491                                                                  00649101
006492 01  PC-PROGRAM-CONSTANTS.                                        00649201
006497     05  PC-DESCRIPTION-1             PIC  X(24)    VALUE         00649703
006498             'BUYER TOTAL             '.                          00649801
006499     05  PC-DESCRIPTION-2             PIC  X(24)    VALUE         00649903
006500             'DIVISION TOTAL          '.                          00650001
006600     05  PC-DESCRIPTION-3             PIC  X(24)    VALUE         00660003
006610             'COMPANY TOTAL           '.                          00661001
006620     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         00662001
006630                                          'RCKRP021'.             00663002
006631                                                                  00663106
006660     05  PC-1                         PIC 9(01)     VALUE 1.      00666004
006670     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     00667004
006680                                                    COMP SYNC.    00668004
006690                                                                  00669001
006700 01  PV-PROGRAM-VARIABLES.                                        00670001
006800     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      00680001
006900                                                    COMP SYNC.    00690001
007000     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO.   00700001
007100*    05  PV-CURRENT-DB2-DATE          PIC  X(10)    VALUE SPACES. 00710003
007200                                                                  00720001
021700  01  PV-HOLD-FIELDS.                                             02170001
021900     05  PV-HOLD-DEPT-NBR            PIC  X(03)     VALUE SPACES. 02190001
022000     05  PV-HOLD-DEPT-NAME           PIC  X(32)     VALUE SPACES. 02200001
022100     05  PV-HOLD-BUYER-NBR           PIC  X(03)     VALUE SPACES. 02210001
022200     05  PV-HOLD-BUYER-NAME          PIC  X(32)     VALUE SPACES. 02220001
022300     05  PV-HOLD-DIVISION-NBR        PIC  X(02)     VALUE SPACES. 02230001
022400     05  PV-HOLD-DIVISION-NAME       PIC  X(32)     VALUE SPACES. 02240001
022410     05  PV-HOLD-MONTH-YEAR          PIC  X(16)     VALUE SPACES. 02241003
022600                                                                  02260001
022700                                                                  02270001
022800 01  HL1-HEADING-LINE-1.                                          02280001
022900     05  FILLER                      PIC  X(42)    VALUE SPACES.  02290003
023000     05  FILLER                      PIC  X(34)    VALUE          02300003
023100     'RECEIPT FLOW ANALYSIS SUMMARY FOR '.                        02310003
023200     05  HL1-MONTH-YEAR              PIC  X(16)    VALUE SPACES.  02320001
023300     05  FILLER                      PIC  X(40)    VALUE SPACES.  02330003
023400                                                                  02340001
023500 01  HL2-HEADING-LINE-2.                                          02350001
023600     05  FILLER                      PIC  X(06)    VALUE SPACES.  02360003
023700     05  FILLER                      PIC  X(11)    VALUE          02370001
023800         'DIVISION:  '.                                           02380001
023900     05  HL2-DIVISION-NMBR           PIC  X(02)    VALUE SPACES.  02390015
023910     05  FILLER                      PIC  X(02)    VALUE SPACES.  02391015
023920     05  HL2-DIVISION                PIC  X(32)    VALUE SPACES.  02392015
024000     05  FILLER                      PIC  X(79)    VALUE SPACES.  02400015
024100                                                                  02410001
024200 01  HL3-HEADING-LINE-3.                                          02420001
024300     05  FILLER                      PIC  X(09)    VALUE SPACES.  02430003
024400     05  FILLER                      PIC  X(08)    VALUE          02440001
024500         'BUYER:  '.                                              02450001
024600     05  HL3-BUYER-NMBR              PIC  X(03)    VALUE SPACES.  02460015
024610     05  FILLER                      PIC  X(01)    VALUE SPACES.  02461016
024620     05  HL3-BUYER                   PIC  X(32)    VALUE SPACES.  02462015
024700     05  FILLER                      PIC  X(79)    VALUE SPACES.  02470015
024800                                                                  02480001
024900 01  HL4-HEADING-LINE-4.                                          02490001
025000     05  FILLER                      PIC  X(17)    VALUE SPACES.  02500011
025100     05  FILLER                      PIC  X(10)    VALUE          02510004
025200         'DEPARTMENT'.                                            02520003
025300     05  FILLER                      PIC  X(27)    VALUE SPACES.  02530014
025400     05  FILLER                      PIC  X(14)    VALUE          02540003
025500         'AVG. RECEIVERS'.                                        02550003
025600     05  FILLER                      PIC  X(16)    VALUE SPACES.  02560010
025700     05  FILLER                      PIC  X(30)    VALUE          02570001
025800         'UNITS RECEIVED BY ARRIVAL WEEK'.                        02580001
025900     05  FILLER                      PIC  X(31)    VALUE SPACES.  02590014
026000                                                                  02600001
026100 01  HL5-HEADING-LINE-5.                                          02610001
026200     05  FILLER                      PIC  X(58)    VALUE SPACES.  02620014
026300     05  FILLER                      PIC  X(06)    VALUE          02630003
026400         'PER PO'.                                                02640003
026800     05  FILLER                      PIC  X(09)    VALUE SPACES.  02680010
026900     05  FILLER                      PIC  X(06)    VALUE          02690001
027000         'WEEK 1'.                                                02700001
027100     05  FILLER                      PIC  X(06)    VALUE SPACES.  02710006
027200     05  FILLER                      PIC  X(06)    VALUE          02720001
027300         'WEEK 2'.                                                02730001
027400     05  FILLER                      PIC  X(06)    VALUE SPACES.  02740006
027500     05  FILLER                      PIC  X(06)    VALUE          02750001
027600         'WEEK 3'.                                                02760001
027700     05  FILLER                      PIC  X(06)    VALUE SPACES.  02770006
027800     05  FILLER                      PIC  X(06)    VALUE          02780001
027900         'WEEK 4'.                                                02790001
028000     05  FILLER                      PIC  X(06)    VALUE SPACES.  02800006
028100     05  FILLER                      PIC  X(06)    VALUE          02810001
028200         'WEEK 5'.                                                02820001
028300     05  FILLER                      PIC  X(05)    VALUE SPACES.  02830014
028400                                                                  02840001
028500                                                                  02850001
029500 01  DL1-DETAIL-LINE-1.                                           02950003
029600     05  FILLER                     PIC  X(17)     VALUE SPACES.  02960014
029610     05  DL1-DEPT-NO                PIC  999       VALUE ZERO.    02961003
029620     05  FILLER                     PIC  X(01)     VALUE SPACES.  02962003
029700     05  DL1-DEPT-NAME              PIC  X(32)     VALUE SPACES.  02970003
029900     05  DL1-AVG-RECEIVERS          PIC  ZZZ,ZZZ.9 VALUE ZERO.    02990003
030000     05  FILLER                     PIC  X(06)     VALUE SPACES.  03000013
030100     05  DL1-WEEK-1-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03010013
030200     05  FILLER                     PIC  X(01)     VALUE SPACES.  03020013
030300     05  DL1-WEEK-2-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03030013
030400     05  FILLER                     PIC  X(01)     VALUE SPACES.  03040013
030500     05  DL1-WEEK-3-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03050013
030600     05  FILLER                     PIC  X(01)     VALUE SPACES.  03060013
030700     05  DL1-WEEK-4-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03070013
030800     05  FILLER                     PIC  X(01)     VALUE SPACES.  03080013
030900     05  DL1-WEEK-5-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03090013
031000     05  FILLER                     PIC  X(05)     VALUE SPACES.  03100014
031100                                                                  03110001
031200 01  DL2-DETAIL-LINE-2.                                           03120003
031300     05  FILLER                     PIC  X(73)     VALUE SPACES.  03130014
031400     05  DL2-WEEK-1-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03140003
031500     05  FILLER                     PIC  X(01)     VALUE '%'.     03150001
031600     05  FILLER                     PIC  X(06)     VALUE SPACES.  03160006
031700     05  DL2-WEEK-2-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03170003
031800     05  FILLER                     PIC  X(01)     VALUE '%'.     03180001
031900     05  FILLER                     PIC  X(06)     VALUE SPACES.  03190006
032000     05  DL2-WEEK-3-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03200003
032100     05  FILLER                     PIC  X(01)     VALUE '%'.     03210001
032200     05  FILLER                     PIC  X(06)     VALUE SPACES.  03220006
032300     05  DL2-WEEK-4-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03230003
032400     05  FILLER                     PIC  X(01)     VALUE '%'.     03240001
032500     05  FILLER                     PIC  X(06)     VALUE SPACES.  03250006
032600     05  DL2-WEEK-5-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03260003
032700     05  FILLER                     PIC  X(01)     VALUE '%'.     03270001
032800     05  FILLER                     PIC  X(10)     VALUE SPACES.  03280014
032900                                                                  03290001
033000 01  TL1-TOTAL-LINE-1.                                            03300001
033100     05  FILLER                     PIC  X(06)     VALUE SPACES.  03310003
033200     05  TL1-TOT-DESCRIPTION        PIC  X(24)     VALUE SPACES.  03320001
033210     05  FILLER                     PIC  X(23)     VALUE SPACES.  03321014
033220     05  TL1-AVG-RECEIVERS          PIC  ZZZ,ZZZ.9 VALUE ZERO.    03322003
033300     05  FILLER                     PIC  X(06)     VALUE SPACES.  03330013
033400     05  TL1-TOT-WEEK-1-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03340013
033500     05  FILLER                     PIC  X(01)     VALUE SPACES.  03350013
033600     05  TL1-TOT-WEEK-2-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03360013
033700     05  FILLER                     PIC  X(01)     VALUE SPACES.  03370013
033800     05  TL1-TOT-WEEK-3-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03380013
033900     05  FILLER                     PIC  X(01)     VALUE SPACES.  03390013
034000     05  TL1-TOT-WEEK-4-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03400013
034100     05  FILLER                     PIC  X(01)     VALUE SPACES.  03410013
034200     05  TL1-TOT-WEEK-5-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03420013
034300     05  FILLER                     PIC  X(05)     VALUE SPACES.  03430014
034400                                                                  03440001
034500 01  TL2-TOTAL-LINE-2.                                            03450001
034600     05  FILLER                     PIC  X(73)     VALUE SPACES.  03460014
034700     05  TL2-TOT-WEEK-1-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03470001
034800     05  FILLER                     PIC  X(01)     VALUE '%'.     03480001
034900     05  FILLER                     PIC  X(06)     VALUE SPACES.  03490006
035000     05  TL2-TOT-WEEK-2-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03500001
035100     05  FILLER                     PIC  X(01)     VALUE '%'.     03510001
035200     05  FILLER                     PIC  X(06)     VALUE SPACES.  03520006
035300     05  TL2-TOT-WEEK-3-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03530001
035400     05  FILLER                     PIC  X(01)     VALUE '%'.     03540001
035500     05  FILLER                     PIC  X(06)     VALUE SPACES.  03550006
035600     05  TL2-TOT-WEEK-4-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03560001
035700     05  FILLER                     PIC  X(01)     VALUE '%'.     03570001
035800     05  FILLER                     PIC  X(06)     VALUE SPACES.  03580006
035900     05  TL2-TOT-WEEK-5-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03590001
036000     05  FILLER                     PIC  X(01)     VALUE '%'.     03600001
036100     05  FILLER                     PIC  X(05)     VALUE SPACES.  03610014
036200                                                                  03620001
037100 01  PR-PRINT-FINAL.                                              03710001
037200     05  FILLER                      PIC X(53)  VALUE SPACES.     03720001
037300     05  FILLER                      PIC X(21)  VALUE             03730001
037400         '*** END OF REPORT ***'.                                 03740001
037500                                                                  03750001
037600                                                                  03760001
037700 01  PR-PRINT-NO-DETAIL.                                          03770001
037800     05  FILLER                      PIC X(53)  VALUE SPACES.     03780001
037900     05  FILLER                      PIC X(29)  VALUE             03790001
038000         '*** NO DETAILS TO REPORT ***'.                          03800001
038100                                                                  03810006
040100*---------------------------------------------------------------* 04010001
040200*  COPYBOOK USED FOR INPUT FILE                                 * 04020001
040300*---------------------------------------------------------------* 04030001
040400     COPY RCRD036.                                                04040003
040500                                                                  04050001
040600*---------------------------------------------------------------* 04060001
040700*  COPYBOOK USED FOR OUTPUT REPORT (132 POS)                    * 04070001
040800*---------------------------------------------------------------* 04080001
040900     COPY DPWS132O.                                               04090001
041000                                                                  04100001
041100***************************************************************** 04110001
041200 PROCEDURE DIVISION.                                              04120001
041300*---------------------------------------------------------------* 04130001
041400*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04140001
041500*---------------------------------------------------------------* 04150001
041600                                                                  04160001
041700     PERFORM 1000-INITIALIZE.                                     04170001
041800                                                                  04180001
041900     IF  PS-INPUT-EOF                                             04190001
042000         PERFORM 6800-NO-REPORT-DETAIL                            04200001
042100         SET PS-NO-DETAIL  TO  TRUE                               04210001
042200     ELSE                                                         04220001
042300         PERFORM 2000-MAIN-PROCESS                                04230001
042400           UNTIL  PS-INPUT-EOF.                                   04240001
042500                                                                  04250001
042600     IF  PS-NO-DETAIL                                             04260001
042700         NEXT SENTENCE                                            04270001
042800     ELSE                                                         04280001
043400         PERFORM 6600-PRINT-END-OF-REPORT.                        04340001
043500                                                                  04350001
043600     PERFORM 9000-END-PROCESS.                                    04360001
043700                                                                  04370001
043800     GOBACK.                                                      04380001
043900                                                                  04390001
043901                                                                  04390103
043910*---------------------------------------------------------------* 04391003
043920*  PROGRAM INITIALIZATION                                       * 04392003
043930*    -- OPEN INPUT AND OUTPUT FILES.                            * 04393003
043940*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 04394003
043950*       THE REPORT HEADINGS.                                    * 04395003
043960*---------------------------------------------------------------* 04396003
044000 1000-INITIALIZE.                                                 04400001
044700     OPEN  INPUT INPUT-FILE                                       04470001
044800           OUTPUT REPORT-FILE.                                    04480001
044900                                                                  04490001
045000     ACCEPT CD-CPU-DATE FROM DATE.                                04500001
045100     ACCEPT CT-CPU-TIME FROM TIME.                                04510001
045200                                                                  04520001
045300     PERFORM 7000-READ-INPUT-FILE.                                04530001
045400                                                                  04540001
045600     MOVE RC036-DEPT-NBR         TO  PV-HOLD-DEPT-NBR.            04560003
045610     MOVE RC036-DEPT-NAME        TO  PV-HOLD-DEPT-NAME.           04561003
045700     MOVE RC036-BYR-NMBR         TO  PV-HOLD-BUYER-NBR.           04570003
045800     MOVE RC036-BYR-NAME         TO  PV-HOLD-BUYER-NAME.          04580003
045900     MOVE RC036-DMM-NMBR         TO  PV-HOLD-DIVISION-NBR.        04590003
046000     MOVE RC036-DMM-NAME         TO  PV-HOLD-DIVISION-NAME.       04600003
046010     MOVE RC036-RPT-MONTH-YEAR   TO  PV-HOLD-MONTH-YEAR.          04601003
046100                                                                  04610001
046800     PERFORM 1100-INITIALIZE-HEADINGS.                            04680003
046900     PERFORM 6000-PRINT-RPT-HEADING.                              04690001
047000                                                                  04700001
047100                                                                  04710001
047200*---------------------------------------------------------------* 04720003
047210*  INITIALIZE REPORT HEADINGS                                   * 04721003
047300*---------------------------------------------------------------* 04730003
050900 1100-INITIALIZE-HEADINGS.                                        05090003
051300     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              05130001
051400     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             05140001
051500     MOVE CD-DAY                 TO DP132O-RUN-DAY.               05150001
051600     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              05160001
051700     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            05170001
051800     MOVE 'RCKRP021'             TO DP132O-PROGRAM-NAME.          05180002
051900     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05190001
052200                                                                  05220001
052300     MOVE PV-HOLD-MONTH-YEAR     TO HL1-MONTH-YEAR.               05230005
052400     MOVE PV-HOLD-DIVISION-NBR   TO HL2-DIVISION-NMBR.            05240016
052410     MOVE PV-HOLD-DIVISION-NAME  TO HL2-DIVISION.                 05241015
052500     MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR.               05250016
052510     MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER.                    05251015
052600                                                                  05260001
052610                                                                  05261003
058300 2000-MAIN-PROCESS.                                               05830001
058400                                                                  05840001
058500      ADD  1  TO  PV-RECORD-COUNT.                                05850001
058600                                                                  05860001
058601      IF  RC036-BYR-NMBR  NOT = PV-HOLD-BUYER-NBR   AND           05860112
058602          RC036-DMM-NMBR  NOT = PV-HOLD-DIVISION-NBR              05860212
058603          MOVE RC036-BYR-NMBR         TO PV-HOLD-BUYER-NBR        05860311
058604          MOVE RC036-BYR-NAME         TO PV-HOLD-BUYER-NAME       05860411
058605          MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR           05860516
058606          MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER                05860615
058607          MOVE RC036-DMM-NMBR         TO PV-HOLD-DIVISION-NBR     05860715
058608          MOVE RC036-DMM-NAME         TO PV-HOLD-DIVISION-NAME    05860815
058609          MOVE PV-HOLD-DIVISION-NBR   TO HL2-DIVISION-NMBR        05860916
058610          MOVE PV-HOLD-DIVISION-NAME  TO HL2-DIVISION             05861015
058611          PERFORM 6000-PRINT-RPT-HEADING                          05861115
058612      ELSE                                                        05861215
058613      IF  RC036-BYR-NMBR  NOT = PV-HOLD-BUYER-NBR                 05861315
058614          MOVE RC036-BYR-NMBR         TO PV-HOLD-BUYER-NBR        05861415
058615          MOVE RC036-BYR-NAME         TO PV-HOLD-BUYER-NAME       05861515
058616          MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR           05861616
058617          MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER                05861715
058618          PERFORM 6000-PRINT-RPT-HEADING                          05861815
058619      ELSE                                                        05861915
058620      IF  RC036-DMM-NMBR  NOT = PV-HOLD-DIVISION-NBR              05862015
058621          MOVE RC036-DMM-NMBR         TO PV-HOLD-DIVISION-NBR     05862115
058622          MOVE RC036-DMM-NAME         TO PV-HOLD-DIVISION-NAME    05862215
058623          MOVE PV-HOLD-DIVISION-NBR   TO HL2-DIVISION-NMBR        05862316
058624          MOVE PV-HOLD-DIVISION-NAME  TO HL2-DIVISION             05862415
058625          PERFORM 6000-PRINT-RPT-HEADING.                         05862515
058626                                                                  05862615
058627*---------------------------------------------------------------* 05862715
058628*  IF COMPANY TOTAL RECORD - PRINT COMPANY TOTALS               * 05862815
058629*---------------------------------------------------------------* 05862915
058630     IF  RC036-TOTALS-COMP                                        05863015
058631         PERFORM 4600-COMPANY-TOTALS.                             05863115
058640                                                                  05864015
058700*---------------------------------------------------------------* 05870001
058800*  IF NEW DIVISION NUMBER - PRINT BUYER AND DIVISION TOTALS     * 05880003
059000*---------------------------------------------------------------* 05900001
059100     IF  RC036-TOTALS-DMM                                         05910003
059700         PERFORM 4400-DIVISION-TOTALS.                            05970011
061200                                                                  06120001
061300*---------------------------------------------------------------* 06130001
061400*  IF NEW BUYER NUMBER - PRINT BUYER TOTALS                     * 06140003
061600*---------------------------------------------------------------* 06160001
061700     IF  RC036-TOTALS-BYR                                         06170003
062200         PERFORM 4200-BUYER-TOTALS.                               06220011
063400                                                                  06340001
065100                                                                  06510001
065200*---------------------------------------------------------------* 06520001
065300*  PRINT DEPARTMENT SUMMARY LINE                                * 06530003
065400*---------------------------------------------------------------* 06540001
065500     IF  RC036-TOTALS-DEPT                                        06550003
065800         PERFORM 4000-DEPARTMENT-TOTALS.                          06580003
068300                                                                  06830001
068400     PERFORM 7000-READ-INPUT-FILE.                                06840001
068500                                                                  06850001
068600                                                                  06860001
083410*---------------------------------------------------------------* 08341003
083420*  PRINT DEPARTMENT TOTALS                                      * 08342003
083430*---------------------------------------------------------------* 08343003
083500 4000-DEPARTMENT-TOTALS.                                          08350003
083895                                                                  08389503
087770         MOVE  RC036-DEPT-NBR        TO DL1-DEPT-NO.              08777003
087780         MOVE  RC036-DEPT-NAME       TO DL1-DEPT-NAME             08778003
087781         MOVE  RC036-AVG-RECEIVERS   TO DL1-AVG-RECEIVERS.        08778103
087791         MOVE  RC036-WK1-UNITS       TO DL1-WEEK-1-UNITS.         08779103
087800         MOVE  RC036-WK2-UNITS       TO DL1-WEEK-2-UNITS.         08780003
087900         MOVE  RC036-WK3-UNITS       TO DL1-WEEK-3-UNITS.         08790003
088000         MOVE  RC036-WK4-UNITS       TO DL1-WEEK-4-UNITS.         08800003
088100         MOVE  RC036-WK5-UNITS       TO DL1-WEEK-5-UNITS.         08810003
088200                                                                  08820001
088300         MOVE  RC036-WK1-PERCENT     TO DL2-WEEK-1-PERCENT.       08830003
088310         MOVE  RC036-WK2-PERCENT     TO DL2-WEEK-2-PERCENT.       08831003
088320         MOVE  RC036-WK3-PERCENT     TO DL2-WEEK-3-PERCENT.       08832003
088330         MOVE  RC036-WK4-PERCENT     TO DL2-WEEK-4-PERCENT.       08833003
088340         MOVE  RC036-WK5-PERCENT     TO DL2-WEEK-5-PERCENT.       08834003
088800                                                                  08880001
089200         PERFORM 6100-PRINT-DETAIL.                               08920003
089300                                                                  08930001
090200                                                                  09020001
090300                                                                  09030001
090400 4200-BUYER-TOTALS.                                               09040003
090500*---------------------------------------------------------------* 09050001
090600*  PRINT BUYER TOTALS                                           * 09060003
090700*---------------------------------------------------------------* 09070001
091033                                                                  09103301
091034         MOVE  PC-DESCRIPTION-1      TO TL1-TOT-DESCRIPTION.      09103403
091035         MOVE  RC036-AVG-RECEIVERS   TO TL1-AVG-RECEIVERS.        09103503
091036                                                                  09103601
091037         MOVE  RC036-WK1-UNITS       TO TL1-TOT-WEEK-1-UNITS.     09103705
091038         MOVE  RC036-WK2-UNITS       TO TL1-TOT-WEEK-2-UNITS.     09103805
091039         MOVE  RC036-WK3-UNITS       TO TL1-TOT-WEEK-3-UNITS.     09103905
091040         MOVE  RC036-WK4-UNITS       TO TL1-TOT-WEEK-4-UNITS.     09104005
091041         MOVE  RC036-WK5-UNITS       TO TL1-TOT-WEEK-5-UNITS.     09104105
091050                                                                  09105001
091051         MOVE  RC036-WK1-PERCENT     TO TL2-TOT-WEEK-1-PERCENT.   09105103
091052         MOVE  RC036-WK2-PERCENT     TO TL2-TOT-WEEK-2-PERCENT.   09105203
091053         MOVE  RC036-WK3-PERCENT     TO TL2-TOT-WEEK-3-PERCENT.   09105303
091054         MOVE  RC036-WK4-PERCENT     TO TL2-TOT-WEEK-4-PERCENT.   09105403
091055         MOVE  RC036-WK5-PERCENT     TO TL2-TOT-WEEK-5-PERCENT.   09105503
091060                                                                  09106003
091063         PERFORM 6200-PRINT-TOTALS.                               09106303
091064                                                                  09106403
091080                                                                  09108001
091090 4400-DIVISION-TOTALS.                                            09109003
091100*---------------------------------------------------------------* 09110001
091200*  PRINT DIVISION TOTALS                                        * 09120003
091300*---------------------------------------------------------------* 09130001
092137                                                                  09213701
092138         MOVE  PC-DESCRIPTION-2      TO TL1-TOT-DESCRIPTION.      09213803
092139         MOVE  RC036-AVG-RECEIVERS   TO TL1-AVG-RECEIVERS.        09213903
092140                                                                  09214003
092141         MOVE  RC036-WK1-UNITS       TO TL1-TOT-WEEK-1-UNITS.     09214105
092142         MOVE  RC036-WK2-UNITS       TO TL1-TOT-WEEK-2-UNITS.     09214205
092143         MOVE  RC036-WK3-UNITS       TO TL1-TOT-WEEK-3-UNITS.     09214305
092144         MOVE  RC036-WK4-UNITS       TO TL1-TOT-WEEK-4-UNITS.     09214405
092145         MOVE  RC036-WK5-UNITS       TO TL1-TOT-WEEK-5-UNITS.     09214505
092146                                                                  09214603
092147         MOVE  RC036-WK1-PERCENT     TO TL2-TOT-WEEK-1-PERCENT.   09214703
092148         MOVE  RC036-WK2-PERCENT     TO TL2-TOT-WEEK-2-PERCENT.   09214803
092149         MOVE  RC036-WK3-PERCENT     TO TL2-TOT-WEEK-3-PERCENT.   09214903
092150         MOVE  RC036-WK4-PERCENT     TO TL2-TOT-WEEK-4-PERCENT.   09215003
092151         MOVE  RC036-WK5-PERCENT     TO TL2-TOT-WEEK-5-PERCENT.   09215103
092152                                                                  09215203
092153         PERFORM 6200-PRINT-TOTALS.                               09215303
092154                                                                  09215403
092155                                                                  09215503
092185 4600-COMPANY-TOTALS.                                             09218503
092186*---------------------------------------------------------------* 09218601
092187*  CALCULATE/PRINT COMPANY TOTALS                               * 09218701
092188*---------------------------------------------------------------* 09218801
092189                                                                  09218901
092190         MOVE  PC-DESCRIPTION-3      TO TL1-TOT-DESCRIPTION.      09219003
092191         MOVE  RC036-AVG-RECEIVERS   TO TL1-AVG-RECEIVERS.        09219103
092192                                                                  09219203
092193         MOVE  RC036-WK1-UNITS       TO TL1-TOT-WEEK-1-UNITS.     09219305
092194         MOVE  RC036-WK2-UNITS       TO TL1-TOT-WEEK-2-UNITS.     09219405
092195         MOVE  RC036-WK3-UNITS       TO TL1-TOT-WEEK-3-UNITS.     09219505
092196         MOVE  RC036-WK4-UNITS       TO TL1-TOT-WEEK-4-UNITS.     09219605
092197         MOVE  RC036-WK5-UNITS       TO TL1-TOT-WEEK-5-UNITS.     09219705
092198                                                                  09219803
092199         MOVE  RC036-WK1-PERCENT     TO TL2-TOT-WEEK-1-PERCENT.   09219903
092200         MOVE  RC036-WK2-PERCENT     TO TL2-TOT-WEEK-2-PERCENT.   09220003
092201         MOVE  RC036-WK3-PERCENT     TO TL2-TOT-WEEK-3-PERCENT.   09220103
092202         MOVE  RC036-WK4-PERCENT     TO TL2-TOT-WEEK-4-PERCENT.   09220203
092203         MOVE  RC036-WK5-PERCENT     TO TL2-TOT-WEEK-5-PERCENT.   09220303
092204                                                                  09220403
092205         PERFORM 6200-PRINT-TOTALS.                               09220503
092206                                                                  09220603
092207                                                                  09220703
092208*---------------------------------------------------------------* 09220803
092209*  HEADING ROUTINE.                                             * 09220903
092210*---------------------------------------------------------------* 09221003
093370 6000-PRINT-RPT-HEADING.                                          09337001
093380                                                                  09338003
093500     ADD 1                       TO PV-PAGE-COUNT.                09350001
093600     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           09360001
093700                                                                  09370001
093800     MOVE 9                      TO PV-LINE-COUNT.                09380001
093900                                                                  09390001
094000     WRITE REPORT-RECORD                                          09400001
094100       FROM DP132O-STANDRD-HEADER-132-COLS                        09410001
094200         AFTER ADVANCING PAGE.                                    09420001
094300                                                                  09430001
094400     WRITE REPORT-RECORD                                          09440001
094500       FROM HL1-HEADING-LINE-1                                    09450001
094600         AFTER ADVANCING 2 LINES.                                 09460001
094700                                                                  09470001
094800     WRITE REPORT-RECORD                                          09480001
094900       FROM HL2-HEADING-LINE-2                                    09490001
095000         AFTER ADVANCING 2 LINES.                                 09500001
095100                                                                  09510001
095200     WRITE REPORT-RECORD                                          09520001
095300       FROM HL3-HEADING-LINE-3                                    09530001
095400         AFTER ADVANCING 1 LINES.                                 09540001
095500                                                                  09550001
095800     WRITE REPORT-RECORD                                          09580001
095900       FROM HL4-HEADING-LINE-4                                    09590001
096000         AFTER ADVANCING 2 LINES.                                 09600001
096100                                                                  09610001
096200     WRITE REPORT-RECORD                                          09620001
096300       FROM HL5-HEADING-LINE-5                                    09630001
096400         AFTER ADVANCING 1 LINES.                                 09640001
096500                                                                  09650001
096510     MOVE  SPACES TO  REPORT-RECORD.                              09651011
096511     WRITE REPORT-RECORD                                          09651111
096530         AFTER ADVANCING 1 LINES.                                 09653011
096540                                                                  09654011
096600                                                                  09660001
096610*---------------------------------------------------------------* 09661003
096620*  PRINT DEPARTMENT TOTALS                                      * 09662003
096630*---------------------------------------------------------------* 09663003
096640 6100-PRINT-DETAIL.                                               09664003
096650                                                                  09665003
096660     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            09666003
096670         PERFORM 6000-PRINT-RPT-HEADING                           09667003
096680     END-IF.                                                      09668003
096690                                                                  09669003
096691     WRITE REPORT-RECORD                                          09669103
096692       FROM DL1-DETAIL-LINE-1                                     09669203
096693         AFTER ADVANCING 1 LINES.                                 09669303
096694     ADD 1                       TO PV-LINE-COUNT.                09669403
096695                                                                  09669503
096696     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            09669603
096697         PERFORM 6000-PRINT-RPT-HEADING                           09669703
096698     END-IF.                                                      09669803
096699                                                                  09669903
096700     WRITE REPORT-RECORD                                          09670003
096701       FROM DL2-DETAIL-LINE-2                                     09670103
096702         AFTER ADVANCING 1 LINES.                                 09670203
096703     ADD 1                       TO PV-LINE-COUNT.                09670303
096704                                                                  09670403
096705     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            09670503
096706         PERFORM 6000-PRINT-RPT-HEADING                           09670603
096707     ELSE                                                         09670703
096714         MOVE  SPACES            TO REPORT-RECORD                 09671403
096715         WRITE REPORT-RECORD                                      09671503
096716             AFTER ADVANCING 1 LINES.                             09671603
096717         ADD 1                   TO PV-LINE-COUNT.                09671703
096718                                                                  09671803
096723                                                                  09672303
096730*---------------------------------------------------------------* 09673003
096800*  PRINT BUYER/DIVISION/COMPANY TOTALS                          * 09680003
096900*---------------------------------------------------------------* 09690003
101800 6200-PRINT-TOTALS.                                               10180003
102200                                                                  10220001
102300     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10230001
102400         PERFORM 6000-PRINT-RPT-HEADING                           10240001
102410     END-IF.                                                      10241001
102420                                                                  10242001
102430     WRITE REPORT-RECORD                                          10243001
102440       FROM TL1-TOTAL-LINE-1                                      10244001
102450         AFTER ADVANCING 2 LINES.                                 10245001
102460     ADD 2                       TO PV-LINE-COUNT.                10246001
102470                                                                  10247001
102480     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10248001
102490         PERFORM 6000-PRINT-RPT-HEADING                           10249001
102491     END-IF.                                                      10249101
102492                                                                  10249201
102493     WRITE REPORT-RECORD                                          10249301
102494       FROM TL2-TOTAL-LINE-2                                      10249401
102495         AFTER ADVANCING 1 LINES.                                 10249501
102496     ADD 1                       TO PV-LINE-COUNT.                10249601
102497                                                                  10249701
102498     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10249801
102499         PERFORM 6000-PRINT-RPT-HEADING                           10249901
102500     END-IF.                                                      10250001
102501                                                                  10250101
102508     MOVE SPACES  TO  REPORT-RECORD.                              10250804
102509     WRITE REPORT-RECORD                                          10250904
102510         AFTER ADVANCING 1 LINES.                                 10251004
102511     ADD 1                       TO PV-LINE-COUNT.                10251104
102512                                                                  10251204
102513     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10251304
102514         PERFORM 6000-PRINT-RPT-HEADING                           10251404
102515     END-IF.                                                      10251504
102516                                                                  10251604
102517                                                                  10251704
102518 6600-PRINT-END-OF-REPORT.                                        10251804
102519*---------------------------------------------------------------* 10251904
102520*  PRINT END OF REPORT BANNER                                   * 10252004
102521*---------------------------------------------------------------* 10252104
102530                                                                  10253001
102540     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10254001
102550         PERFORM 6000-PRINT-RPT-HEADING                           10255001
102560     END-IF.                                                      10256001
102570                                                                  10257001
102580     WRITE REPORT-RECORD                                          10258001
102590       FROM PR-PRINT-FINAL                                        10259001
102600         AFTER ADVANCING 2 LINES.                                 10260001
102700     ADD 2                       TO PV-LINE-COUNT.                10270001
102800                                                                  10280001
102900                                                                  10290001
103000 6800-NO-REPORT-DETAIL.                                           10300001
103100*---------------------------------------------------------------* 10310001
103200*  PRINT "NO DETAIL REPORT' BANNER                              * 10320001
103300*---------------------------------------------------------------* 10330001
103400                                                                  10340001
103500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10350001
103600         PERFORM 6000-PRINT-RPT-HEADING                           10360001
103700     END-IF.                                                      10370001
103800                                                                  10380001
103900     WRITE REPORT-RECORD                                          10390001
104000       FROM PR-PRINT-NO-DETAIL                                    10400001
104100         AFTER ADVANCING 2 LINES.                                 10410001
104200     ADD 2                       TO PV-LINE-COUNT.                10420001
104300                                                                  10430001
104400                                                                  10440001
104500 7000-READ-INPUT-FILE.                                            10450001
104600*---------------------------------------------------------------* 10460001
104700*  READ INPUT FILE                                              * 10470001
104800*---------------------------------------------------------------* 10480001
104900                                                                  10490001
105000      READ INPUT-FILE INTO RC036-RCVR-EXTRACT-RECORD              10500003
105100          AT END                                                  10510001
105200             SET PS-INPUT-EOF TO TRUE.                            10520001
105300                                                                  10530001
105400                                                                  10540001
105500 9000-END-PROCESS.                                                10550001
105600*---------------------------------------------------------------* 10560001
105700*  CLOSE FILES.                                                   10570001
105800*---------------------------------------------------------------* 10580001
105900                                                                  10590001
106000                                                                  10600001
106100     CLOSE INPUT-FILE                                             10610001
106200           REPORT-FILE.                                           10620001
106300                                                                  10630001
106400*                                                                 10640001
106500*9900-DB2-ABEND.                                                  10650003
106600*---------------------------------------------------------------* 10660001
106700*  DB2-ABEND-PROCESSING                                           10670001
106800*---------------------------------------------------------------* 10680001
106900*                                                                 10690003
107000*    DISPLAY '*** DB2 ERROR '.                                    10700003
107100*    DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       10710003
107200*    DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10720003
107300*    DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10730003
107400*    DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10740003
107500*    DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           10750003
107600*    DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           10760003
107700*    DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           10770003
107800*    DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             10780003
107900*                                                                 10790003
108000*COPY DPPD004                                                     10800003
108100*                                                                 10810003
108200*    MOVE +4013                  TO PV-ABEND-CODE.                10820003
108300*    CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10830003
108400*                                                                 10840003
108500****************************************************************  10850001
