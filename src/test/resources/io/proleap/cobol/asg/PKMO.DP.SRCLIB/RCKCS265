000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS265.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04/17/95.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    Y265 - ADD TO RECEIVER                                     * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF ALL OF THE INPROCESS      * 00130000
001400*    RECEIVERS FOR THE PURCHASE ORDER SELECTED FROM THE         * 00140000
001500*    SHIPMENT PURCHASE ORDER LIST SCREEN.                       * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001701* CHANGE HISTORY                                                * 00170188
001702*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00170287
001703*     DATE:    10/16/2014                                       * 00170387
001704*                                                               * 00170487
001705*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# * 00170587
001706*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/16/2014    * 00170687
001710*---------------------------------------------------------------* 00171087
001730* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00173088
001740* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00174088
001750* MAKING THE CALL DYNAMIC VS STATIC.                              00175088
001760*---------------------------------------------------------------* 00176088
001800 EJECT                                                            00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002600     15  DK-PROTRBL-PO                  PIC S9(09)  VALUE ZERO    00260098
002601                                                    COMP.         00260198
002610     15  DK-PROTRBL-RCVR                PIC S9(09)  VALUE ZERO    00261098
002611                                                    COMP.         00261198
002620     15  DK-PROTRBL-OPER                PIC S9(04)  VALUE ZERO    00262098
002621                                                    COMP.         00262198
002622                                                                  00262298
002630     15  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00263098
002700                                                    COMP.         00270000
002800     15  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00280000
002900                                                    COMP.         00290000
003000     15  DK-ORIGIN-SCAC-ID              PIC  X(04)  VALUE SPACE.  00300000
003100     15  DK-DELIVERY-SCAC-ID            PIC  X(04)  VALUE SPACE.  00310000
003200     15  DK-VEH-NBR                     PIC  X(10)  VALUE SPACE.  00320000
003300     15  DK-PO-NBR                      PIC S9(09)  VALUE +0      00330000
003400                                                    COMP.         00340000
003500     15  DK-SHIPT-ID                    PIC S9(09)  VALUE +0      00350000
003600                                                    COMP.         00360000
003700     15  DK-PRO-NBR                     PIC  X(22).               00370000
003800     15  DK-BOL-NBR                     PIC  X(30).               00380000
003900     15  DK-UPDATE-REC-SEQ-NBR          PIC S9(04)  VALUE +0      00390000
004000                                                    COMP SYNC.    00400000
004100     15  DK-REC-SEQ-NBR                 PIC S9(04)  VALUE +0      00410000
004200                                                    COMP SYNC.    00420000
004300     15  DK-CASEPACK-SEQ-NBR            PIC S9(04)  VALUE +0      00430000
004400                                                    COMP SYNC.    00440000
004500     15  DK-CASEPACK-SEQ-NBR-2          PIC S9(04)  VALUE +0      00450000
004600                                                    COMP SYNC.    00460000
004700                                                                  00470000
004800 01  DN-NULL-INDICATORS.                                          00480000
004900     15  DN-VEH-TRIP-NULL               PIC S9(04)  VALUE +0      00490000
005000                                                    COMP SYNC.    00500000
005100                                                                  00510000
005200 01  PC-PROGRAM-CONSTANTS.                                        00520000
005300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00530000
005400                                                    'RC265A  '.   00540000
005500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00550000
005600                                                    'RCKM265 '.   00560000
005700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00570000
005800                                                    'RCKCS265'.   00580000
005900     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00590000
006000                                                    'RCKCS290'.   00600000
006100     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE +300    00610000
006200                                                    COMP SYNC.    00620000
006210     05  PC-TMKCS521                    PIC  X(08)  VALUE         00621097
006220                                                    'TMKCS521'.   00622096
006230     05  PC-TROUBLE-RTN-LENGTH          PIC S9(04)  VALUE +600    00623096
006240                                                    COMP SYNC.    00624096
006300     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00630000
006400     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00640000
006500     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00650000
006600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00660000
006700                                                    COMP SYNC.    00670000
006800     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00680000
006900                                                    COMP SYNC.    00690000
007000     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00700000
007100                                                    +1000000      00710000
007200                                                    COMP-3.       00720000
007300     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00730000
007400                                                    COMP SYNC.    00740000
007500     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00750000
007600                                                    COMP-3.       00760000
007700     05  PC-1                           PIC S9(04)  VALUE 1       00770000
007800                                                    COMP.         00780000
007900     05  PC-ZERO                        PIC S9(04)  VALUE 0       00790000
008000                                                    COMP.         00800000
008100     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00810000
008200     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00820000
008300     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00830000
008400     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00840000
008500     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00850000
008600     05  PC-A                           PIC  X(01)  VALUE 'A'.    00860000
008700     05  PC-B                           PIC  X(01)  VALUE 'B'.    00870000
008800     05  PC-D                           PIC  X(01)  VALUE 'D'.    00880000
008900     05  PC-U                           PIC  X(01)  VALUE 'U'.    00890000
009000     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00900000
009100     05  PC-N                           PIC  X(01)  VALUE 'N'.    00910000
009200     05  PC-IP                          PIC  X(02)  VALUE 'IP'.   00920000
009300     05  PC-CM                          PIC  X(02)  VALUE 'CM'.   00930000
009400     05  PC-00                          PIC  X(02)  VALUE '00'.   00940000
009500     05  PC-I                           PIC  X(01)  VALUE 'I'.    00950000
009600     05  PC-DE                          PIC  X(02)  VALUE 'DE'.   00960000
009700     05  PC-IN                          PIC  X(02)  VALUE 'IN'.   00970000
009800                                                                  00980000
009900     05  PC-INTER-APPL-CODES.                                     00990000
010000         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '1'.          01000000
010100         10  PC-INTER-APPL-MOVE   PIC  X(01)  VALUE '2'.          01010000
010110* JAK 06/2007 - ADD PROGRAM CONSTANT                              01011086
010120     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.01012082
010200                                                                  01020000
010300*----------------------------------------------------------------*01030000
010400*  SYSTEM MESSAGES                                               *01040000
010500*----------------------------------------------------------------*01050000
010600*   00004 - PRESS F2 TO CONFIRM REQUEST                          *01060000
010700*   00005 - INVALID VALUE                                        *01070000
010800*   00008 - MUST BE NUMERIC                                      *01080000
010900*   00047 - ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION *01090000
011000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01100000
011100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01110000
011200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01120000
011300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01130000
011400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01140000
011500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01150000
011600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01160000
011700*   00059 - UPDATE(S) SUCCESSFUL                                 *01170000
011800*   00069 - TOP OF LIST                                          *01180000
011900*   00070 - BOTTOM OF LIST                                       *01190000
012000*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01200000
012100*   00116 - CANNOT DELETE - RECORD DOES NOT EXIST                *01210000
012200*   00148 - DATA DOES NOT EXIST                                  *01220000
012300*   00279 - MORE ITEMS TO DISPLAY                                *01230000
012400*   01040 - THE RECEIVER SEQUENCE NUMBER OF THE SELECTED ITEM    *01240000
012500*   01081 - MORE THAN 15 PURCHASE ORDERS HAVE BEEN SELECTED      *01250000
012600*   01082 - ALL OF THE ITEMS SELECTED DO NOT HAVE THE SAME PO    *01260000
012700*   01083 - THE SHIPMENT HAS NO TRAILER LINKED TO IT             *01270000
012800*   01087 - SELECTED ITEMS CANNOT BE DIRECT STORE RECEIVERS      *01280000
012900*   01091 - ALL SELECTED RECEIVERS MUST HAVE THE SAME OPERATING  *01290000
013000*   01092 - ALL SELECTED RECEIVERS MUST HAVE A STATUS OF IP      *01300000
013100*   01799 - RCVR SELECTED HAS LINE(S) THAT HAVE BEEN PROCESSED   *01310000
013110*   03575 - UPD SUCCESSFUL AND WMS WILL BE UPDATED ACCORDINGLY *  01311086
013200*   99901 - INVALID COMMAND WAS ENTERED                          *01320000
013300*----------------------------------------------------------------*01330000
013400     05  PC-TSYMSG-NUMBERS.                                       01340000
013500         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01350000
013600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01360000
013700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01370000
013800         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01380000
013900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01390000
014000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01400000
014100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01410000
014200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01420000
014300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01430000
014400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01440000
014500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01450000
014600         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01460000
014700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01470000
014800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01480000
014900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01490000
015000         10  PC-TSYMSG-00116            PIC  9(05)  VALUE 00116.  01500000
015100         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01510000
015200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01520000
015300         10  PC-TSYMSG-01040            PIC  9(05)  VALUE 01040.  01530000
015400         10  PC-TSYMSG-01081            PIC  9(05)  VALUE 01081.  01540000
015500         10  PC-TSYMSG-01082            PIC  9(05)  VALUE 01082.  01550000
015600         10  PC-TSYMSG-01083            PIC  9(05)  VALUE 01083.  01560000
015700         10  PC-TSYMSG-01087            PIC  9(05)  VALUE 01087.  01570000
015800         10  PC-TSYMSG-01091            PIC  9(05)  VALUE 01091.  01580000
015900         10  PC-TSYMSG-01092            PIC  9(05)  VALUE 01092.  01590000
016000         10  PC-TSYMSG-01799            PIC  9(05)  VALUE 01799.  01600000
016100         10  PC-TSYMSG-02972            PIC  9(05)  VALUE 02972.  01610077
016101* JAK 06/2007 - ADD WMS SPECIFIC MESSAGE                          01610186
016110         10  PC-TSYMSG-03575            PIC  9(05)  VALUE 03575.  01611086
016200         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01620000
016300                                                                  01630000
016400 01  PS-PROGRAM-SWITCHES.                                         01640000
016500     05  PS-CHECKED-IN-FOUND-SW       PIC X(01)  VALUE 'N'.       01650077
016600         88  PS-CHECKED-IN-FOUND                 VALUE 'Y'.       01660077
016700         88  PS-NO-CHECKED-IN-FOUND              VALUE 'N'.       01670077
016800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01680000
016900         88  PS-NO-ERROR                            VALUE 'Y'.    01690000
017000         88  PS-ERROR                               VALUE 'N'.    01700000
017100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01710000
017200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01720000
017300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01730000
017400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01740000
017500         88  PS-DONE                                VALUE 'Y'.    01750000
017600         88  PS-NOT-DONE                            VALUE 'N'.    01760000
017700     05  PS-END-OF-QUEUE-SW             PIC  X(01)  VALUE 'N'.    01770000
017800         88  PS-END-OF-QUEUE                        VALUE 'Y'.    01780000
017900         88  PS-NOT-END-OF-QUEUE                    VALUE 'N'.    01790000
018000     05  PS-SAME-PO-SW                  PIC  X(01)  VALUE 'Y'.    01800000
018100         88  PS-SAME-PO                             VALUE 'Y'.    01810000
018200         88  PS-NOT-SAME-PO                         VALUE 'N'.    01820000
018300     05  PS-SAME-OPER-SW                PIC  X(01)  VALUE 'Y'.    01830000
018400         88  PS-SAME-OPER                           VALUE 'Y'.    01840000
018500         88  PS-NOT-SAME-OPER                       VALUE 'N'.    01850000
018600     05  PS-VEHICLE-FOUND-SW            PIC  X(01)  VALUE 'Y'.    01860000
018700         88  PS-VEHICLE-FOUND                       VALUE 'Y'.    01870000
018800         88  PS-NO-VEHICLE                          VALUE 'N'.    01880000
018900     05  PS-TWKORIN-SW                PIC X(01)  VALUE 'N'.       01890000
019000         88  PS-END-OF-TWKORIN                   VALUE 'Y'.       01900000
019100         88  PS-NOT-END-OF-TWKORIN               VALUE 'N'.       01910000
019200     05  PS-TWRKORD-SW                PIC X(01)  VALUE 'N'.       01920000
019300         88  PS-END-OF-TWRKORD                   VALUE 'Y'.       01930000
019400         88  PS-NOT-END-OF-TWRKORD               VALUE 'N'.       01940000
019500     05  PS-TPKITEM-SW                PIC X(01)  VALUE 'N'.       01950000
019600         88  PS-END-OF-TPKITEM                   VALUE 'Y'.       01960000
019700         88  PS-NOT-END-OF-TPKITEM               VALUE 'N'.       01970000
019800     05  PS-TUNPKSL-SW                PIC X(01)  VALUE 'N'.       01980000
019900         88  PS-END-OF-TUNPKSL                   VALUE 'Y'.       01990000
020000         88  PS-NOT-END-OF-TUNPKSL               VALUE 'N'.       02000000
020100     05  PS-TPKSLIP-SW                PIC X(01)  VALUE 'N'.       02010000
020200         88  PS-END-OF-TPKSLIP                   VALUE 'Y'.       02020000
020300         88  PS-NOT-END-OF-TPKSLIP               VALUE 'N'.       02030000
020400     05  PS-TRECITM-SW                PIC X(01)  VALUE 'N'.       02040000
020500         88  PS-END-OF-TRECITM                   VALUE 'Y'.       02050000
020600         88  PS-NOT-END-OF-TRECITM               VALUE 'N'.       02060000
020700     05  PS-DIRECT-STR-SW             PIC X(01)  VALUE 'N'.       02070000
020800         88  PS-DIRECT-STR                       VALUE 'Y'.       02080000
020900         88  PS-NOT-DIRECT-STR                   VALUE 'N'.       02090000
021000     05  PS-IP-RECEIVER-SW            PIC X(01)  VALUE 'N'.       02100000
021100         88  PS-IP-RECEIVER                      VALUE 'Y'.       02110000
021200         88  PS-NOT-IP-RECEIVER                  VALUE 'N'.       02120000
021300     05  PS-SHPTPO-SW                 PIC X(01)  VALUE 'N'.       02130000
021400         88  PS-END-OF-SHPTPO                    VALUE 'Y'.       02140000
021500         88  PS-NOT-END-OF-SHPTPO                VALUE 'N'.       02150000
021510* JAK 06/2007 - ADD SWITCH FOR WMW                                02151086
021520     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        02152082
021530         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        02153082
021540         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        02154082
021541                                                                  02154191
021550     05  PS-CREATE-DC-EFC-LVL-SW      PIC X(04) VALUE SPACES.     02155091
021560         88  PS-CREATE-DC-ONLY                  VALUE 'DC  '.     02156091
021570         88  PS-CREATE-EFC-ONLY                 VALUE 'EFC '.     02157091
021580         88  PS-CREATE-BOTH                     VALUE 'BOTH'.     02158091
021590     05  PS-DC-EFC-LOC-SW             PIC X(01) VALUE 'N'.        02159091
021591         88  PS-DC-LOCATION                     VALUE 'N'.        02159191
021592         88  PS-EFC-LOCATION                    VALUE 'Y'.        02159291
021593     05  PS-PRO-LEVEL-TRBL-CHECK-SW   PIC X(01) VALUE 'N'.        02159394
021594         88  PS-PRO-LEVEL-TRBL-CHECK            VALUE 'Y'.        02159494
021595         88  PS-PRO-LEVEL-TRBL-CHECK-NO         VALUE 'N'.        02159594
021596     05  PS-PROTR1-SW                 PIC X(01) VALUE 'N'.        02159694
021597         88  PS-PROTR1                          VALUE 'Y'.        02159794
021598         88  PS-PROTR1-NO                       VALUE 'N'.        02159894
021599     05  PS-AUTRB3-SW                 PIC X(01) VALUE 'N'.        02159994
021600         88  PS-AUTRB3                          VALUE 'Y'.        02160094
021601         88  PS-AUTRB3-NO                       VALUE 'N'.        02160194
021602                                                                  02160294
021610                                                                  02161000
021700 01  PV-PROGRAM-VARIABLES.                                        02170000
021800     05  PV-CARTON-COUNT                PIC S9(09)  VALUE +0      02180079
021900                                                    COMP-3.       02190079
022000     05  PV-SUB                         PIC S9(04)  VALUE +0      02200000
022100                                                    COMP SYNC.    02210000
022200     05  PV-ASC-IDX                     PIC S9(04)  VALUE +0      02220000
022300                                                    COMP SYNC.    02230000
022400     05  PV-IDX                         PIC S9(04)  VALUE +0      02240000
022500                                                    COMP SYNC.    02250000
022600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02280000
022900                                                    COMP-3.       02290000
023000     05  PV-CASEPACK-COUNT              PIC S9(09)  VALUE +0      02300000
023100                                                    COMP-3.       02310000
023200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02320000
023300                                                    COMP-3.       02330000
023400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02340000
023500                                                    COMP-3.       02350000
023600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02360000
023700                                                    COMP-3.       02370000
023800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02380000
023900                                                    COMP-3.       02390000
024000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02400000
024100                                                    COMP-3.       02410000
024200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02420000
024300                                                    COMP-3.       02430000
024400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02440000
024500                                                    COMP SYNC.    02450000
024600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02460000
024700                                                    COMP SYNC.    02470000
024800     05  PV-ITEM                        PIC S9(04)  VALUE +0      02480000
024900                                                    COMP SYNC.    02490000
025000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02500000
025100                                                    COMP SYNC.    02510000
025200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02520000
025300                                                    COMP SYNC.    02530000
025400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02540000
025500                                                    COMP SYNC.    02550000
025600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02560000
025700                                                    COMP SYNC.    02570000
025800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02580000
025900                                                    COMP SYNC.    02590000
026000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02600000
026100                                                    COMP SYNC.    02610000
026200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02620000
026300                                                    COMP SYNC.    02630000
026400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02640000
026500                                                    COMP SYNC.    02650000
026600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02660000
026700                                                    COMP SYNC.    02670000
026800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02680000
026900                                                    COMP SYNC.    02690000
027000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02700000
027100                                                    COMP SYNC.    02710000
027200     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02720000
027300                                                    COMP SYNC.    02730000
027400     05  PV-PO-CSR-IND                  PIC  X(01)  VALUE SPACES. 02740000
027500     05  PV-TRN-CDE                     PIC  X(01)  VALUE SPACES. 02750000
027600     05  PV-DB2-COUNT                   PIC S9(04)  VALUE +0      02760000
027700                                                    COMP SYNC.    02770000
027800     05  PV-ACTIVE-RECITMS              PIC S9(09)  VALUE +0      02780065
027900                                                    COMP.         02790065
028000     05  PV-RECEIVER-CARTON-CNT         PIC S9(04)  VALUE +0      02800000
028100                                                    COMP SYNC.    02810000
028200     05  PV-PREV-RCVR-NBR               PIC  9(03)  VALUE ZERO.   02820000
028300     05  PV-CURRENT-TMST                PIC  X(26).               02830000
028400                                                                  02840000
028500     05  PV-DB2-DATE.                                             02850000
028600         10  PV-DB2-DATE-CC             PIC  X(02).               02860000
028700         10  PV-DB2-DATE-YY             PIC  X(02).               02870000
028800         10  FILLER                     PIC  X(01).               02880000
028900         10  PV-DB2-DATE-MM             PIC  X(02).               02890000
029000         10  FILLER                     PIC  X(01).               02900000
029100         10  PV-DB2-DATE-DD             PIC  X(02).               02910000
029200         10  FILLER                     PIC  X(01).               02920000
029300         10  PV-DB2-TIME-HH             PIC  X(02).               02930000
029400         10  FILLER                     PIC  X(01).               02940000
029500         10  PV-DB2-TIME-MM             PIC  X(02).               02950000
029600         10  FILLER                     PIC  X(01).               02960000
029700         10  PV-DB2-TIME-SS             PIC  X(02).               02970000
029800         10  FILLER                     PIC  X(01).               02980000
029900         10  PV-DB2-TIME-MS             PIC  X(06).               02990000
030000     05  PV-DATE.                                                 03000000
030100         10  PV-DATE-MM                 PIC  X(02).               03010000
030200         10  FILLER                     PIC  X(01)  VALUE '/'.    03020000
030300         10  PV-DATE-DD                 PIC  X(02).               03030000
030400         10  FILLER                     PIC  X(01)  VALUE '/'.    03040000
030500         10  PV-DATE-YY                 PIC  X(02).               03050000
030600                                                                  03060000
030700     05  PV-ABEND-MSG-KEYS.                                       03070000
030800         10  PV-MSG-PO                PIC  9(07).                 03080000
030900         10  FILLER                   PIC  X(01).                 03090000
031000         10  PV-MSG-RCVR              PIC  9(03).                 03100000
031100     05  PV-MESSAGE.                                              03110000
031200         10  PV-MESSAGE1                PIC X(10).                03120000
031300         10  PV-FILLER                  PIC X(01).                03130000
031400         10  PV-MESSAGE2                PIC X(10).                03140000
031500         10  PV-FILLER                  PIC X(01).                03150000
031600         10  PV-MESSAGE3                PIC X(10).                03160000
031700     05  PV-NEW-PKSL-NBR.                                         03170000
031800         10  FILLER                     PIC X(01)  VALUE 'R'.     03180000
031900         10  PV-RCVR-SEQ-NBR            PIC 9(02).                03190000
032000         10  PV-PKSL-NBR                PIC X(07).                03200000
032100                                                                  03210071
032200     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        03220071
032300     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        03230071
032400     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        03240071
032410* JAK 06/2007 - ADD PROGRAM VARIABLE                              03241086
032420     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03242082
032430                                                     COMP SYNC.   03243082
032440                                                                  03244091
032450     05  PV-AUTRBL03-NBR              PIC  S9(10)V9(5) COMP-3.    03245091
032460     05  PV-CNTLFLOW-TRBRSN           PIC  S9(10)V9(5) COMP-3.    03246091
032470     05  PV-HAS-PRO-TRBL-CNT          PIC  S9(09)  COMP.          03247091
032471     05  PV-DISP-OPER                 PIC   Z(04).                03247193
032472     05  PV-DISP-OPER-B               PIC   Z(04).                03247296
032473     05  PV-DISP-PO                   PIC   9(09).                03247396
032474     05  PV-DISP-RCVR                 PIC   9(04).                03247496
032475     05  PV-DISP-AUTRBL03-NBR         PIC   Z(04)  VALUE ZEROES.  03247596
032476     05  PV-DISP-SQL                  PIC   -999   VALUE ZEROES.  03247696
032477     05  PV-DISP-TRBRSN               PIC    999   VALUE ZEROES.  03247796
032478     05  PV-DISP-TRBL                 PIC    999   VALUE ZEROES.  03247899
032479     05  PV-CICS-MSG-AREA             PIC   X(75).                03247999
032480                                                                  03248091
032500                                                                  03250000
032600******************************************************************03260000
032700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03270000
032800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03280000
032900**  APPLICATION-SPECIFIC COMMAREA.                              **03290000
033000******************************************************************03300000
033100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03310000
033200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03320000
033300     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           03330000
033400                                        INDEXED BY LQW-IDX.       03340000
033500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03350000
033600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03360000
033700         10  LQW-SELECTED-SW            PIC  X(01).               03370000
033800             88  LQW-SELECT                         VALUE 'S'.    03380000
033900             88  LQW-DESELECT                       VALUE ' '.    03390000
034000         10  LQW-ACTION                 PIC  X(03).               03400000
034100         10  LQW-SHIPT-ID               PIC S9(09)  COMP.         03410000
034200         10  LQW-RECEIVER               PIC  9(03).               03420000
034300         10  LQW-ARR-DTE                PIC  X(10).               03430000
034400         10  LQW-CART-CNT               PIC  9(06).               03440000
034500         10  LQW-SCAC                   PIC  X(04).               03450000
034600         10  LQW-TRAILER                PIC  X(10).               03460000
034700         10  LQW-FREIGHT-BILL           PIC  X(16).               03470000
034800         10  LQW-BILL-OF-LADING         PIC  X(16).               03480000
034900         10  LQW-RCVR-TRANSCRB-SW       PIC X(01).                03490000
035000             88 LQW-RCVR-TRNS               VALUE 'Y'.            03500000
035100             88 LQW-RCVR-NOT-TRNS           VALUE 'N'.            03510000
035200                                                                  03520000
035300     EJECT                                                        03530000
035400**--------------------------------------------------------------**03540000
035500** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **03550000
035600** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **03560000
035700**--------------------------------------------------------------**03570000
035800     COPY RCWS013.                                                03580074
035900     EJECT                                                        03590000
036000     COPY RCWS031.                                                03600074
036100     EJECT                                                        03610000
036200***************************************************************** 03620081
036300*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 03630081
036400*             FUNCTIONS           *                               03640092
036500***************************************************************** 03650081
036600     COPY RCWS071.                                                03660081
036700                                                                  03670081
036710* JAK 06/2007 - ADD COPYBOOK FOR SHIPPING CONTROL MODULE          03671086
036720***************************************************************** 03672092
036730*  RECORD LAYOUT 'SHIPPING CONTROL MODULE' - WSKCS305           * 03673092
036740***************************************************************** 03674092
036750     COPY WSWS001.                                                03675082
036760                                                                  03676082
036770******************************************************************03677095
036780*   COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE LINE SUBROUTINE*03678095
036790******************************************************************03679095
036791     COPY TMWS500.                                                03679195
036792                                                                  03679295
036800*---------------------------------------------------------------* 03680000
036900*    MAP LAYOUT                                                 * 03690000
037000*---------------------------------------------------------------* 03700000
037100                                                                  03710000
037200     COPY RCKM265.                                                03720000
037300                                                                  03730000
037400 01  MR-OCCURS-LAYOUT                   REDEFINES  RC265AO.       03740000
037500*PS 10/16/2014 CHANGE STARTS                                      03750087
037510     05  FILLER                         PIC X(90).                03751087
037520*PS 10/16/2014 CHANGE ENDS                                        03752087
037600     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          03760000
037700         10  MR-SELECTL                 PIC S9(04) COMP.          03770000
037800         10  MR-SELECTA                 PIC  X(01).               03780000
037900         10  MR-SELECTC                 PIC  X(01).               03790000
038000         10  MR-SELECTH                 PIC  X(01).               03800000
038100         10  MR-SELECTI                 PIC  X(01).               03810000
038200                                                                  03820000
038300         10  MR-ACTIONL                 PIC S9(04) COMP.          03830000
038400         10  MR-ACTIONA                 PIC  X(01).               03840000
038500         10  MR-ACTIONC                 PIC  X(01).               03850000
038600         10  MR-ACTIONH                 PIC  X(01).               03860000
038700         10  MR-ACTION                  PIC  X(03).               03870000
038800                                                                  03880000
038900         10  MR-RECEIVERL               PIC S9(04) COMP.          03890000
039000         10  MR-RECEIVERA               PIC  X(01).               03900000
039100         10  MR-RECEIVERC               PIC  X(01).               03910000
039200         10  MR-RECEIVERH               PIC  X(01).               03920000
039300         10  MR-RECEIVER-X.                                       03930000
039400             15  MR-RECEIVER            PIC  Z(03).               03940000
039500                                                                  03950000
039600         10  MR-ARR-DTEL                PIC S9(04) COMP.          03960000
039700         10  MR-ARR-DTEA                PIC  X(01).               03970000
039800         10  MR-ARR-DTEC                PIC  X(01).               03980000
039900         10  MR-ARR-DTEH                PIC  X(01).               03990000
040000         10  MR-ARR-DTE                 PIC  X(08).               04000000
040100                                                                  04010000
040200         10  MR-CART-CNTL               PIC S9(04) COMP.          04020000
040300         10  MR-CART-CNTA               PIC  X(01).               04030000
040400         10  MR-CART-CNTC               PIC  X(01).               04040000
040500         10  MR-CART-CNTH               PIC  X(01).               04050000
040600         10  MR-CART-CNT-X.                                       04060000
040700             15  MR-CART-CNT            PIC ZZZZZ9.               04070000
040800                                                                  04080000
040900         10  MR-SCACL                   PIC S9(04) COMP.          04090000
041000         10  MR-SCACA                   PIC  X(01).               04100000
041100         10  MR-SCACC                   PIC  X(01).               04110000
041200         10  MR-SCACH                   PIC  X(01).               04120000
041300         10  MR-SCAC                    PIC  X(04).               04130000
041400                                                                  04140000
041500         10  MR-TRAILERL                PIC S9(04) COMP.          04150000
041600         10  MR-TRAILERA                PIC  X(01).               04160000
041700         10  MR-TRAILERC                PIC  X(01).               04170000
041800         10  MR-TRAILERH                PIC  X(01).               04180000
041900         10  MR-TRAILER                 PIC  X(10).               04190000
042000                                                                  04200000
042100         10  MR-FREIGHT-BILLL           PIC S9(04) COMP.          04210000
042200         10  MR-FREIGHT-BILLA           PIC  X(01).               04220000
042300         10  MR-FREIGHT-BILLC           PIC  X(01).               04230000
042400         10  MR-FREIGHT-BILLH           PIC  X(01).               04240000
042500         10  MR-FREIGHT-BILL            PIC  X(16).               04250000
042600                                                                  04260000
042700         10  MR-BILL-OF-LADINGL         PIC S9(04) COMP.          04270000
042800         10  MR-BILL-OF-LADINGA         PIC  X(01).               04280000
042900         10  MR-BILL-OF-LADINGC         PIC  X(01).               04290000
043000         10  MR-BILL-OF-LADINGH         PIC  X(01).               04300000
043100         10  MR-BILL-OF-LADING          PIC  X(16).               04310000
043200                                                                  04320000
043300     EJECT                                                        04330000
043400*---------------------------------------------------------------* 04340000
043500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04350000
043600*---------------------------------------------------------------* 04360000
043700                                                                  04370000
043800     COPY DPWS015.                                                04380074
043900                                                                  04390000
044000*---------------------------------------------------------------* 04400000
044100*    FUNCTION KEYS COPYBOOK.                                    * 04410000
044200*---------------------------------------------------------------* 04420000
044300                                                                  04430000
044400     COPY DPWS016.                                                04440074
044500                                                                  04450000
044600*---------------------------------------------------------------* 04460000
044700*    NUMERIC EDIT LAYOUT.                                       * 04470000
044800*---------------------------------------------------------------* 04480000
044900                                                                  04490000
045000     COPY DPWS010I.                                               04500074
045100 EJECT                                                            04510000
045200******************************************************************04520089
045300** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04530089
045310** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04531089
045400******************************************************************04540089
045500                                                                  04550000
045600     COPY DPWS030.                                                04560074
045610     COPY DPWS930.                                                04561089
045700 EJECT                                                            04570000
045800*---------------------------------------------------------------* 04580000
045900*    STANDARD COMMAREA.                                         * 04590000
046000*---------------------------------------------------------------* 04600000
046100                                                                  04610000
046200     COPY DPWS020.                                                04620074
046300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04630000
046400                                                                  04640000
046500*---------------------------------------------------------------* 04650000
046600* INTER-APPLICATION COMMAREA.                                   * 04660000
046700*   RCWS012 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04670000
046800*             SPEC SCREEN.                                      * 04680000
046900*   RCWS015 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04690000
047000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04700000
047100*---------------------------------------------------------------* 04710000
047200                                                                  04720000
047300         10  INTER-APPL-COMM-AREA       PIC X(200).               04730000
047400     COPY RCWS012.                                                04740074
047500     COPY RCWS015.                                                04750074
047600*---------------------------------------------------------------* 04760000
047700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04770000
047800*---------------------------------------------------------------* 04780000
047900         10  ASC-SPECIFIC-COMMAREA.                               04790000
048000             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            04800000
048100             15  ASC-LIST-KEYS.                                   04810000
048200                 20  ASC-KEY-OPER-UNT-ID             PIC  X(04).  04820000
048300                 20  ASC-KEY-OPER-UNT-ID-N REDEFINES              04830000
048400                     ASC-KEY-OPER-UNT-ID             PIC  9(04).  04840000
048500                 20  ASC-KEY-FCLTY-ID                PIC  X(04).  04850000
048600                 20  ASC-KEY-FCLTY-ID-N REDEFINES                 04860000
048700                     ASC-KEY-FCLTY-ID                PIC  9(04).  04870000
048800                 20  ASC-KEY-ORIGIN-SCAC-ID          PIC  X(04).  04880000
048900                 20  ASC-KEY-DELIVERY-SCAC-ID        PIC  X(04).  04890000
049000                 20  ASC-KEY-VEH-NBR                 PIC  X(10).  04900000
049100                 20  ASC-KEY-PO-NBR                  PIC S9(09)   04910000
049200                                                         COMP.    04920000
049300                 20  ASC-KEY-VEND-NAME               PIC  X(30).  04930000
049400                 20  ASC-KEY-PRO-NBR                 PIC  X(22).  04940000
049500                 20  ASC-KEY-BOL-NBR                 PIC  X(30).  04950000
049600                 20  ASC-KEY-REC-SEQ-NBR             PIC S9(09)   04960000
049700                                                         COMP.    04970000
049800                 20  ASC-KEY-SHIPT-ID                PIC S9(09)   04980000
049900                                                         COMP.    04990000
050000                 20  ASC-UPDATE-SUCCESSFUL-SW  PIC X(01).         05000000
050100                     88  ASC-UPDATE-SUCCESSFUL      VALUE 'Y'.    05010000
050200                 20  ASC-ADD-MOVE-IND          PIC X(01).         05020000
050300                     88  ASC-ADD-TO-RCVR            VALUE 'A'.    05030000
050400                     88  ASC-MOVE-TO-RCVR           VALUE 'M'.    05040000
050500                 20  ASC-PO-TABLE.                                05050000
050600                     25  ASC-PO-ITM OCCURS 15 TIMES.              05060000
050700                         30  ASC-PO                  PIC S9(09)   05070000
050800                                                     COMP.        05080000
050900                         30  ASC-SHIPMT-ID           PIC S9(09)   05090000
051000                                                     COMP.        05100000
051100                         30  ASC-OPER-UNT            PIC S9(04)   05110000
051200                                                     COMP.        05120000
051300                         30  ASC-FCLTY-ID            PIC S9(04)   05130000
051400                                                     COMP.        05140000
051500                 20  ASC-RCVR-SEQ-TBL.                            05150000
051600                     25  ASC-RCVR-SEQ-NO-1  PIC S9(09) COMP.      05160000
051700                     25  ASC-RCVR-TRNS-1    PIC X(01).            05170000
051800                     25  ASC-RCVR-SEQ-NO-2  PIC S9(09) COMP.      05180000
051900                     25  ASC-RCVR-TRNS-2    PIC X(01).            05190000
052000                     25  ASC-RCVR-SEQ-NO-3  PIC S9(09) COMP.      05200000
052100                     25  ASC-RCVR-TRNS-3    PIC X(01).            05210000
052200                     25  ASC-RCVR-SEQ-NO-4  PIC S9(09) COMP.      05220000
052300                     25  ASC-RCVR-TRNS-4    PIC X(01).            05230000
052400                     25  ASC-RCVR-SEQ-NO-5  PIC S9(09) COMP.      05240000
052500                     25  ASC-RCVR-TRNS-5    PIC X(01).            05250000
052600                     25  ASC-RCVR-SEQ-NO-6  PIC S9(09) COMP.      05260000
052700                     25  ASC-RCVR-TRNS-6    PIC X(01).            05270000
052800                     25  ASC-RCVR-SEQ-NO-7  PIC S9(09) COMP.      05280000
052900                     25  ASC-RCVR-TRNS-7    PIC X(01).            05290000
053000                     25  ASC-RCVR-SEQ-NO-8  PIC S9(09) COMP.      05300000
053100                     25  ASC-RCVR-TRNS-8    PIC X(01).            05310000
053200                     25  ASC-RCVR-SEQ-NO-9  PIC S9(09) COMP.      05320000
053300                     25  ASC-RCVR-TRNS-9    PIC X(01).            05330000
053400                     25  ASC-RCVR-SEQ-NO-10 PIC S9(09) COMP.      05340000
053500                     25  ASC-RCVR-TRNS-10   PIC X(01).            05350000
053600                     25  ASC-RCVR-SEQ-NO-11 PIC S9(09) COMP.      05360000
053700                     25  ASC-RCVR-TRNS-11   PIC X(01).            05370000
053800                     25  ASC-RCVR-SEQ-NO-12 PIC S9(09) COMP.      05380000
053900                     25  ASC-RCVR-TRNS-12   PIC X(01).            05390000
054000                     25  ASC-RCVR-SEQ-NO-13 PIC S9(09) COMP.      05400000
054100                     25  ASC-RCVR-TRNS-13   PIC X(01).            05410000
054200                     25  ASC-RCVR-SEQ-NO-14 PIC S9(09) COMP.      05420000
054300                     25  ASC-RCVR-TRNS-14   PIC X(01).            05430000
054400                     25  ASC-RCVR-SEQ-NO-15 PIC S9(09) COMP.      05440000
054500                     25  ASC-RCVR-TRNS-15   PIC X(01).            05450000
054600                 20  FILLER REDEFINES ASC-RCVR-SEQ-TBL.           05460000
054700                     25  ASC-RCVR-SEQ-TBL-15 OCCURS 15 TIMES.     05470000
054800                         30  ASC-RCVR-SEQ-NO        PIC S9(09)    05480000
054900                                                    COMP.         05490000
055000                         30  ASC-RCVR-TRANSCRIBE-SW PIC X(01).    05500000
055100                             88 ASC-RCVR-TRNSCRB     VALUE 'Y'.   05510000
055200                             88 ASC-RCVR-NOT-TRNSCRB VALUE 'N'.   05520000
055300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05530000
055400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05540000
055500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05550000
055600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05560000
055700                                                                  05570000
055800                 20  ASC-ITEM-ARRAY.                              05580000
055900                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        05590000
056000                         30  ASC-LIST-ITEM-NUMBER                 05600000
056100                                                     PIC S9(09)   05610000
056200                                                     COMP-3.      05620000
056300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05630000
056400                             88  ASC-VALID-SELECT    VALUE ' '    05640000
056500                                                           'S'    05650000
056600                                                           'B'    05660000
056700                                                           'E'.   05670000
056800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05680000
056900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05690000
057000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05700000
057100                             88  ASC-TEMP-END        VALUE 'E'.   05710000
057200                         30  ASC-SELECTED-SW         PIC  X(01).  05720000
057300                             88  ASC-NO-SELECT       VALUE ' '.   05730000
057400                             88  ASC-SELECT          VALUE 'S'.   05740000
057500                             88  ASC-BEGIN           VALUE 'B'.   05750000
057600                             88  ASC-END             VALUE 'E'.   05760000
057700                         30  ASC-ACTION              PIC  X(03).  05770000
057800                         30  ASC-SHIPT-ID            PIC S9(09)   05780000
057900                                                          COMP.   05790000
058000                         30  ASC-RECEIVER            PIC  9(03).  05800000
058100                         30  ASC-ARR-DTE             PIC  X(10).  05810000
058200                         30  ASC-CART-CNT            PIC  9(06).  05820000
058300                         30  ASC-SCAC                PIC  X(04).  05830000
058400                         30  ASC-TRAILER             PIC  X(10).  05840000
058500                         30  ASC-FREIGHT-BILL        PIC  X(16).  05850000
058600                         30  ASC-BILL-OF-LADING      PIC  X(16).  05860000
058700                         30  ASC-RCVR-TRANSCRB-SW    PIC X(01).   05870000
058800                             88 ASC-RCVR-TRNS        VALUE 'Y'.   05880000
058900                             88 ASC-RCVR-NOT-TRNS    VALUE 'N'.   05890000
059000                                                                  05900000
059100             15  ASC-BLK-SUB                         PIC S9(04)   05910000
059200                                                          COMP    05920000
059300                                                          SYNC.   05930000
059400             15  ASC-ITEM-SUB                        PIC S9(04)   05940000
059500                                                          COMP    05950000
059600                                                          SYNC.   05960000
059700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05970000
059800                                                          COMP-3. 05980000
059900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05990000
060000                                                          COMP-3. 06000000
060100             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06010000
060200                                                          COMP-3. 06020000
060300             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06030000
060400                                                          COMP-3. 06040000
060500             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06050000
060600                                                          COMP-3. 06060000
060700             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06070000
060800                                                          COMP    06080000
060900                                                          SYNC.   06090000
061000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06100000
061100                                                          COMP-3. 06110000
061200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06120000
061300                                                          COMP-3. 06130000
061400             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06140000
061500                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06150000
061600                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06160000
061700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06170000
061800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06180000
061900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06190000
062000             15  ASC-LIST-QUEUE-NAME.                             06200000
062100                 20  ASC-LIST-TERM-ID                PIC  X(04).  06210000
062200                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06220000
062300                                                          COMP-3. 06230000
062400                 20  ASC-LIST-SEQ                    PIC  9(01).  06240000
062500             15  ASC-SEL-QUEUE-NAME-IN               PIC  X(8).   06250000
062600             15  ASC-SEL-QUEUE-NAME.                              06260000
062700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06270000
062800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06280000
062900                                                          COMP-3. 06290000
063000                 20  ASC-SEL-SEQ                     PIC  9(01).  06300000
063100                                                                  06310000
063200             15  ASC-START-ITEM-REQUEST.                          06320000
063300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06330000
063400             15  ASC-USE-SELECTION-QUEUE-IND                      06340000
063500                                           PIC  X(01).            06350000
063600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06360000
063700*            15  ASC-SEL-QUEUE-NAME        PIC  X(08).            06370000
063800             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    06380000
063900             15  ASC-SEL-SUB               PIC S9(04)  COMP.      06390000
064000             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      06400000
064100     EJECT                                                        06410000
064200*---------------------------------------------------------------* 06420000
064300*    ABEND PROCESSING COPYBOOK.                                 * 06430000
064400*---------------------------------------------------------------* 06440000
064500                                                                  06450000
064600     COPY DPWS013.                                                06460074
064700                                                                  06470000
064800 EJECT                                                            06480000
064900     EXEC SQL                                                     06490078
065000          INCLUDE TINPKSU                                         06500078
065100     END-EXEC.                                                    06510078
065200                                                                  06520078
065300     EXEC SQL                                                     06530078
065400          INCLUDE TSHUNLO                                         06540078
065500     END-EXEC.                                                    06550078
065600                                                                  06560078
065700     EXEC SQL                                                     06570078
065800          INCLUDE TSULBXF                                         06580078
065900     END-EXEC.                                                    06590078
066000                                                                  06600078
066100     EXEC SQL                                                     06610078
066200          INCLUDE TSHUUPC                                         06620078
066300     END-EXEC.                                                    06630078
066400                                                                  06640078
066500                                                                  06650078
066600*---------------------------------------------------------------* 06660000
066700*    DB2 AREA FOR PURCHASE TABLE                                * 06670000
066800*---------------------------------------------------------------* 06680000
066900     EXEC SQL                                                     06690000
067000          INCLUDE TPURCHS                                         06700000
067100     END-EXEC.                                                    06710000
067200*---------------------------------------------------------------* 06720000
067300*    DB2 AREA FOR RECEIVER TABLE                                * 06730000
067400*---------------------------------------------------------------* 06740000
067500     EXEC SQL                                                     06750000
067600          INCLUDE TRECEIV                                         06760000
067700     END-EXEC.                                                    06770000
067800*---------------------------------------------------------------* 06780000
067900*    DB2 AREA FOR RECEIVER DISTRIBUTION TABLE                   * 06790000
068000*---------------------------------------------------------------* 06800000
068100     EXEC SQL                                                     06810000
068200          INCLUDE TRECDIS                                         06820000
068300     END-EXEC.                                                    06830000
068400*---------------------------------------------------------------* 06840000
068500*    DB2 AREA FOR RECEIVER ITEM TABLE                           * 06850000
068600*---------------------------------------------------------------* 06860000
068700     EXEC SQL                                                     06870000
068800          INCLUDE TRECITM                                         06880000
068900     END-EXEC.                                                    06890000
069000*---------------------------------------------------------------* 06900000
069100*    DB2 AREA FOR DISTRIBUTION HEADER TABLE                     * 06910000
069200*---------------------------------------------------------------* 06920000
069300     EXEC SQL                                                     06930000
069400          INCLUDE TDISTHD                                         06940000
069500     END-EXEC.                                                    06950000
069600*---------------------------------------------------------------* 06960000
069700*    DB2 AREA FOR SHIPMENT TABLE                                * 06970000
069800*---------------------------------------------------------------* 06980000
069900     EXEC SQL                                                     06990000
070000          INCLUDE TSHIPMT                                         07000000
070100     END-EXEC.                                                    07010000
070200*---------------------------------------------------------------* 07020000
070300*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 07030000
070400*---------------------------------------------------------------* 07040000
070500     EXEC SQL                                                     07050000
070600          INCLUDE TSHIPST                                         07060000
070700     END-EXEC.                                                    07070000
070800*---------------------------------------------------------------* 07080000
070900*    DB2 AREA FOR SHIPMENT PO TABLE                             * 07090000
071000*---------------------------------------------------------------* 07100000
071100     EXEC SQL                                                     07110000
071200          INCLUDE TSHPTPO                                         07120000
071300     END-EXEC.                                                    07130000
071400*---------------------------------------------------------------* 07140000
071500*    DB2 AREA FOR SHIPMENT AUDIT TABLE                          * 07150000
071600*---------------------------------------------------------------* 07160000
071700     EXEC SQL                                                     07170000
071800          INCLUDE TAUSHPO                                         07180000
071900     END-EXEC.                                                    07190000
072000*---------------------------------------------------------------* 07200000
072100*    DB2 AREA FOR STATUS TYPE TABLE                             * 07210000
072200*---------------------------------------------------------------* 07220000
072300     EXEC SQL                                                     07230000
072400          INCLUDE TSHSTYP                                         07240000
072500     END-EXEC.                                                    07250000
072600*---------------------------------------------------------------* 07260000
072700*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 07270000
072800*---------------------------------------------------------------* 07280000
072900     EXEC SQL                                                     07290000
073000          INCLUDE TVHTRIP                                         07300000
073100     END-EXEC.                                                    07310000
073200*---------------------------------------------------------------* 07320000
073300*    DB2 AREA FOR TRIP STATUS TABLE                             * 07330000
073400*---------------------------------------------------------------* 07340000
073500     EXEC SQL                                                     07350000
073600          INCLUDE TTRIPST                                         07360000
073700     END-EXEC.                                                    07370000
073800*---------------------------------------------------------------* 07380000
073900*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 07390000
074000*---------------------------------------------------------------* 07400000
074100     EXEC SQL                                                     07410000
074200          INCLUDE TPKSLIP                                         07420000
074300     END-EXEC.                                                    07430000
074400*---------------------------------------------------------------* 07440000
074500*    DB2 AREA FOR THE PACKING SLIP ITEM TABLE                   * 07450000
074600*---------------------------------------------------------------* 07460000
074700     EXEC SQL                                                     07470000
074800          INCLUDE TPKITEM                                         07480000
074900     END-EXEC.                                                    07490000
075000*---------------------------------------------------------------* 07500000
075100*    DB2 AREA FOR THE UNMATCHED PACK SLIP ITEM TABLE            * 07510000
075200*---------------------------------------------------------------* 07520000
075300     EXEC SQL                                                     07530000
075400          INCLUDE TUNPKSL                                         07540000
075500     END-EXEC.                                                    07550000
075600*----------------------------------------------------------------*07560000
075700*    DB2 AREA FOR OPERATION SET TABLE                            *07570000
075800*----------------------------------------------------------------*07580000
075900     EXEC SQL                                                     07590000
076000          INCLUDE TOPRSET                                         07600000
076100     END-EXEC.                                                    07610000
076200*----------------------------------------------------------------*07620000
076300*    DB2 AREA FOR WORK ORDER TABLE                               *07630000
076400*----------------------------------------------------------------*07640000
076500     EXEC SQL                                                     07650000
076600          INCLUDE TWRKORD                                         07660000
076700     END-EXEC.                                                    07670000
076800*----------------------------------------------------------------*07680000
076900*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *07690000
077000*----------------------------------------------------------------*07700000
077100     EXEC SQL                                                     07710000
077200          INCLUDE TWKORIN                                         07720000
077300     END-EXEC.                                                    07730000
077400*----------------------------------------------------------------*07740000
077500*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                07750000
077600*----------------------------------------------------------------*07760000
077700     EXEC SQL                                                     07770000
077800          INCLUDE TTRBNTF                                         07780000
077900     END-EXEC.                                                    07790000
078000/                                                                 07800000
078100*----------------------------------------------------------------*07810000
078200*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      07820000
078300*----------------------------------------------------------------*07830000
078400     EXEC SQL                                                     07840000
078500          INCLUDE TTRBRSN                                         07850000
078600     END-EXEC.                                                    07860000
078601                                                                  07860182
078610* JAK 06/2007 - ADD TABLE FOR WMS CODE                            07861086
078621*----------------------------------------------------------------*07862182
078630*    DB2 DCLGEN FOR PARM TABLE                                    07863082
078631*----------------------------------------------------------------*07863182
078650     EXEC SQL                                                     07865082
078660          INCLUDE TKRPRPM                                         07866082
078670     END-EXEC.                                                    07867082
078680                                                                  07868082
078700*----------------------------------------------------------------*07870075
078800*    DB2 DCLGEN FOR THE RC - VERIFIED ODD UNIT QUANTITIES TABLE   07880075
078900*    RCT_VRFD_ODD_UNT                                             07890075
079000*----------------------------------------------------------------*07900075
079100     EXEC SQL                                                     07910075
079200          INCLUDE RCT00009                                        07920075
079300     END-EXEC.                                                    07930075
079301                                                                  07930190
079310******************************************************************07931090
079320*    DB2 DCLGEN FOR THE WST_INTGRTN_TYP TABLE                     07932090
079330******************************************************************07933090
079340     EXEC SQL                                                     07934090
079350          INCLUDE WST00008                                        07935090
079360     END-EXEC.                                                    07936090
079370/                                                                 07937090
079380******************************************************************07938090
079390*    DB2 DCLGEN FOR THE WST_ATTR_DEFN TABLE                       07939090
079391******************************************************************07939190
079392     EXEC SQL                                                     07939290
079393          INCLUDE WST00009                                        07939390
079394     END-EXEC.                                                    07939490
079395/                                                                 07939590
079396******************************************************************07939690
079397*    DB2 DCLGEN FOR THE WST_ATTR_ELEM TABLE                       07939790
079398******************************************************************07939890
079399     EXEC SQL                                                     07939990
079400          INCLUDE WST00010                                        07940090
079401     END-EXEC.                                                    07940190
079402/                                                                 07940290
079403******************************************************************07940390
079404*    DB2 DCLGEN FOR THE RCT_PO_RCVR_TRKG TABLE                    07940490
079405******************************************************************07940590
079406     EXEC SQL                                                     07940690
079407          INCLUDE RCT00017                                        07940790
079408     END-EXEC.                                                    07940890
079409/                                                                 07940990
079410******************************************************************07941090
079411*    DB2 DCLGEN FOR THE XLT_LOC TABLE                             07941190
079412******************************************************************07941290
079413     EXEC SQL                                                     07941390
079414          INCLUDE XLT00010                                        07941490
079415     END-EXEC.                                                    07941590
079416/                                                                 07941690
079420*---------------------------------------------------------------* 07942000
079500*    DB2 AREA FOR COMMUNICATIONS                                * 07950000
079600*---------------------------------------------------------------* 07960000
079700     EXEC SQL                                                     07970000
079800          INCLUDE SQLCA                                           07980000
079900     END-EXEC.                                                    07990000
080000                                                                  08000000
080100                                                                  08010000
080200*---------------------------------------------------------------* 08020000
080300*    SHIPMENT CURSOR WHICH WILL LIST ALL SHIPMENTS ON A TRAILER,* 08030000
080400*    THEN LIST ALL FORECAST SHIPMENTS FOR THE CARRIER           * 08040000
080500*---------------------------------------------------------------* 08050000
080600                                                                  08060000
080700     EXEC SQL                                                     08070000
080800          DECLARE PO-CSR CURSOR FOR                               08080000
080900              SELECT DISTINCT                                     08090000
081000                A.SHIPT_ID                                        08100000
081100              , A.PRO_NBR                                         08110000
081200              , A.BOL_NBR                                         08120000
081300              , E.REC_SEQ_NBR                                     08130000
081400              , D.ACTL_CART_CNT                                   08140000
081500              , D.EXPTED_CART_CNT                                 08150000
081600              , D.VEND_NAME                                       08160000
081700              , D.PRIM_SHIPT_IND                                  08170000
081800              , B.OWNER_SCAC_ID                                   08180000
081900              , B.VEH_NBR                                         08190000
082000              , E.REC_TMST                                        08200000
082100          FROM                                                    08210000
082200                TSHIPMT A                                         08220000
082300              , TVHTRIP B                                         08230000
082400              , TTRIPST C                                         08240000
082500              , TSHPTPO D                                         08250000
082600              , TRECEIV E                                         08260000
082700          WHERE E.ORD_NBR           = :DK-PO-NBR                  08270000
082800            AND E.VER_STATUS_CDE    = :PC-A                       08280000
082900            AND E.STATUS_CDE        = :PC-IP                      08290000
083000            AND E.ORD_NBR           = D.PO_NBR                    08300000
083100            AND E.REC_SEQ_NBR       = D.REC_SEQ_NBR               08310000
083200            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             08320000
083300            AND C.FCLTY_ID          = :DK-FCLTY-ID                08330000
083400            AND B.TRIP_ID           = C.TRIP_ID                   08340000
083500            AND B.TRIP_ID           = A.TRIP_ID                   08350000
083600            AND A.SHIPT_ID          = D.SHIPT_ID                  08360000
083700            AND B.VEH_NBR           IS NOT NULL                   08370000
083800          ORDER BY E.REC_SEQ_NBR, D.PRIM_SHIPT_IND DESC,          08380000
083900                    A.PRO_NBR, A.BOL_NBR                          08390000
084000     END-EXEC.                                                    08400000
084100                                                                  08410000
084200                                                                  08420000
084300     EXEC SQL                                                     08430000
084400          DECLARE PO-MOVE-CSR CURSOR FOR                          08440000
084500              SELECT DISTINCT                                     08450000
084600                A.SHIPT_ID                                        08460000
084700              , A.PRO_NBR                                         08470000
084800              , A.BOL_NBR                                         08480000
084900              , E.REC_SEQ_NBR                                     08490000
085000              , D.ACTL_CART_CNT                                   08500000
085100              , D.EXPTED_CART_CNT                                 08510000
085200              , D.VEND_NAME                                       08520000
085300              , D.PRIM_SHIPT_IND                                  08530000
085400              , B.OWNER_SCAC_ID                                   08540000
085500              , B.VEH_NBR                                         08550000
085600              , E.REC_TMST                                        08560000
085700          FROM                                                    08570000
085800                TSHIPMT A                                         08580000
085900              , TVHTRIP B                                         08590000
086000              , TTRIPST C                                         08600000
086100              , TSHPTPO D                                         08610000
086200              , TRECEIV E                                         08620000
086300          WHERE E.ORD_NBR           = :DK-PO-NBR                  08630000
086400            AND E.VER_STATUS_CDE    = :PC-A                       08640000
086500            AND E.STATUS_CDE        = :PC-IP                      08650000
086600            AND E.ORD_NBR           = D.PO_NBR                    08660000
086700            AND E.REC_SEQ_NBR       = D.REC_SEQ_NBR               08670000
086800            AND E.REC_SEQ_NBR  NOT IN (:ASC-RCVR-SEQ-NO-1,        08680000
086900                                       :ASC-RCVR-SEQ-NO-2,        08690000
087000                                       :ASC-RCVR-SEQ-NO-3,        08700000
087100                                       :ASC-RCVR-SEQ-NO-4,        08710000
087200                                       :ASC-RCVR-SEQ-NO-5,        08720000
087300                                       :ASC-RCVR-SEQ-NO-6,        08730000
087400                                       :ASC-RCVR-SEQ-NO-7,        08740000
087500                                       :ASC-RCVR-SEQ-NO-8,        08750000
087600                                       :ASC-RCVR-SEQ-NO-9,        08760000
087700                                       :ASC-RCVR-SEQ-NO-10,       08770000
087800                                       :ASC-RCVR-SEQ-NO-11,       08780000
087900                                       :ASC-RCVR-SEQ-NO-12,       08790000
088000                                       :ASC-RCVR-SEQ-NO-13,       08800000
088100                                       :ASC-RCVR-SEQ-NO-14,       08810000
088200                                       :ASC-RCVR-SEQ-NO-15)       08820000
088300            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             08830000
088400            AND C.FCLTY_ID          = :DK-FCLTY-ID                08840000
088500            AND B.TRIP_ID           = C.TRIP_ID                   08850000
088600            AND B.TRIP_ID           = A.TRIP_ID                   08860000
088700            AND A.SHIPT_ID          = D.SHIPT_ID                  08870000
088800            AND B.VEH_NBR           IS NOT NULL                   08880000
088900          ORDER BY E.REC_SEQ_NBR, D.PRIM_SHIPT_IND DESC,          08890000
089000                    A.PRO_NBR, A.BOL_NBR                          08900000
089100     END-EXEC.                                                    08910000
089200                                                                  08920000
089300/                                                                 08930000
089400*---------------------------------------------------------------* 08940000
089500*  CURSOR TO SELECT ALL WORK ORDERS FOR THE RECEIVER            * 08950000
089600*---------------------------------------------------------------* 08960000
089700                                                                  08970000
089800     EXEC SQL                                                     08980000
089900          DECLARE TWRKORD-CSR CURSOR FOR                          08990000
090000              SELECT ORD_NBR                                      09000000
090100                   , RCVR_SEQ_NBR                                 09010000
090200                   , ORD_LNE_NBR                                  09020000
090300                   , WORK_ORD_SEQ_NBR                             09030000
090400                   , OPER_UNT_ID                                  09040000
090500                   , FCLTY_ID                                     09050000
090600                   , CRE_TMST                                     09060000
090700                   , VER_STATUS_CDE                               09070000
090800                   , CRE_UID_ID                                   09080000
090900                   , EXPTED_CART_CNT                              09090000
091000                   , ACTL_CART_CNT                                09100000
091100                   , EXPTED_ITM_CNT                               09110000
091200                   , ACTL_ITM_CNT                                 09120000
091300                   , STAT_CDE                                     09130000
091400                   , WORK_ORD_DISTR_IND                           09140000
091500                   , OPER_SET_ID                                  09150000
091600                FROM TWRKORD                                      09160000
091700               WHERE ORD_NBR        = :DK-PO-NBR                  09170000
091800                 AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR             09180000
091900                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             09190000
092000                 AND FCLTY_ID       = :DK-FCLTY-ID                09200000
092100                 AND VER_STATUS_CDE = :PC-A                       09210000
092200     END-EXEC.                                                    09220000
092300                                                                  09230000
092400/                                                                 09240000
092500*---------------------------------------------------------------* 09250000
092600*  CURSOR TO SELECT ALL PACK SLIP ITEMS FOR THE RECEIVER        * 09260000
092700*---------------------------------------------------------------* 09270000
092800                                                                  09280000
092900     EXEC SQL                                                     09290000
093000          DECLARE TPKITEM-CSR CURSOR FOR                          09300000
093100              SELECT PO_NBR                                       09310000
093200                   , SEQ_NBR                                      09320000
093300                   , PKSL_LNE_NBR                                 09330000
093400                   , CRE_TMST                                     09340000
093500                   , VER_STAT_CDE                                 09350000
093600                   , PKSL_ITM_QTY                                 09360000
093700                   , CRE_UID                                      09370000
093800                   , PURITM_VER_NBR                               09380000
093900                FROM TPKITEM                                      09390000
094000               WHERE PO_NBR       = :DK-PO-NBR                    09400000
094100                 AND SEQ_NBR      = :PKSLIP-SEQ-NBR               09410000
094200                 AND VER_STAT_CDE = :PC-A                         09420000
094300     END-EXEC.                                                    09430000
094400                                                                  09440000
094500/                                                                 09450000
094600*---------------------------------------------------------------* 09460000
094700*  CURSOR TO SELECT PACK SLIPS FOR THE RECEIVER                 * 09470000
094800*---------------------------------------------------------------* 09480000
094900                                                                  09490000
095000     EXEC SQL                                                     09500000
095100          DECLARE TPKSLIP-CSR CURSOR FOR                          09510000
095200              SELECT DISTINCT                                     09520000
095300                     PO_NBR                                       09530000
095400                   , SEQ_NBR                                      09540000
095500                   , CRE_TMST                                     09550000
095600                   , VER_STAT_CDE                                 09560000
095700                   , OPER_UNT_ID                                  09570000
095800                   , FCLTY_ID                                     09580000
095900                   , PKSL_NBR                                     09590000
096000                   , STR_DEST_NBR                                 09600000
096100                   , REC_SEQ_NBR                                  09610000
096200                   , SHIPT_ID                                     09620000
096300                   , BOL_NBR                                      09630000
096400                   , PRO_NBR                                      09640000
096500                   , PKSL_STAT_CDE                                09650000
096600                   , CRE_UID                                      09660000
096700                   , PO_VER_NBR                                   09670000
096800                   , CRE_SRC_CDE                                  09680000
096900                   , EXPTED_PKG_QTY                               09690000
097000                   , OWNER_SCAC_ID                                09700000
097100                   , ASN_NBR                                      09710000
097200                   , VEND_SHIP_DTE                                09720000
097300                   , CONTNR_ID                                    09730000
097400                   , ORIG_PKSL_SEQ_NBR                            09740074
097500                FROM TPKSLIP                                      09750000
097600               WHERE PO_NBR       = :DK-PO-NBR                    09760000
097700                 AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR               09770000
097800                 AND OPER_UNT_ID  = :DK-OPER-UNT-ID               09780000
097900                 AND FCLTY_ID     = :DK-FCLTY-ID                  09790000
098000                 AND VER_STAT_CDE = :PC-A                         09800000
098100               ORDER BY CRE_UID                                   09810000
098200     END-EXEC.                                                    09820000
098300                                                                  09830000
098400/                                                                 09840000
098500*---------------------------------------------------------------* 09850000
098600*  CURSOR TO SELECT ALL RECEIPT ITEMS FOR THE RECEIVER          * 09860000
098700*---------------------------------------------------------------* 09870000
098800                                                                  09880000
098900     EXEC SQL                                                     09890000
099000          DECLARE TRECITM-CSR CURSOR FOR                          09900000
099100              SELECT ORD_NBR                                      09910000
099200                   , ORD_LNE_NBR                                  09920000
099300                   , REC_SEQ_NBR                                  09930000
099400                   , OPER_UNT_ID                                  09940000
099500                   , FCLTY_ID                                     09950000
099600                   , CRE_TMST                                     09960000
099700                   , CRE_UID                                      09970000
099800                   , PO_VER_NBR                                   09980000
099900                   , ITM_NBR                                      09990000
100000                   , PRE_TKT_IND                                  10000000
100100                   , TKT_FMT_ID                                   10010000
100200                   , RTV_IND                                      10020000
100300                   , STATUS_CDE                                   10030000
100400                   , VER_STATUS_CDE                               10040000
100500                   , PKSL_ITM_QTY                                 10050000
100600                   , DTL_CK_ITM_QTY                               10060000
100700                   , INNR_PACK_QTY                                10070000
100800                   , CASE_PACK_QTY                                10080000
100900                   , RTV_QTY                                      10090000
101000                   , EXPTED_CART_CNT                              10100000
101100                   , ACTL_CART_CNT                                10110000
101200                   , MKING_APRON_TMST                             10120000
101300                   , UNT_COST_AMT                                 10130000
101400                   , COLOR_DESC                                   10140000
101500                   , SIZE_DESC                                    10150000
101600                   , VEND_STYL_NAME                               10160000
101700                   , VEND_DESC                                    10170000
101800                   , VERFYD_TMST                                  10180000
101900                   , PKSL_NBR                                     10190000
102000                   , REC_INV_LNE_NBR                              10200000
102100                   , DMG_ITM_QTY                                  10210000
102200                   , UPD_TMST                                     10220000
102300                   , UPD_UID                                      10230000
102400                   , UPD_PGM_ID                                   10240000
102500                   , RCPT_DISTR_UPD_CDE                           10250000
102600                   , VRFD_USR_ID                                  10260000
102700                   , PREPK_ID                                     10270081
102800                FROM TRECITM                                      10280000
102900               WHERE ORD_NBR        = :DK-PO-NBR                  10290000
103000                 AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR             10300000
103100                 AND OPER_UNT_ID    = :DK-OPER-UNT-ID             10310000
103200                 AND FCLTY_ID       = :DK-FCLTY-ID                10320000
103300                 AND VER_STATUS_CDE = :PC-A                       10330000
103400     END-EXEC.                                                    10340000
103500                                                                  10350000
103600/                                                                 10360000
103700*---------------------------------------------------------------* 10370000
103800*  CURSOR TO SELECT ALL WORKORDER INSTRUCTIONS FOR THE RECEIVER * 10380000
103900*---------------------------------------------------------------* 10390000
104000                                                                  10400000
104100     EXEC SQL                                                     10410000
104200          DECLARE TWKORIN-CSR CURSOR FOR                          10420000
104300              SELECT ORD_NBR                                      10430000
104400                   , RCVR_SEQ_NBR                                 10440000
104500                   , ORD_LNE_NBR                                  10450000
104600                   , WORK_ORD_SEQ_NBR                             10460000
104700                   , OPER_UNT_ID                                  10470000
104800                   , FCLTY_ID                                     10480000
104900                   , WO_INSTR_SEQ_NBR                             10490000
105000                   , CRE_TMST                                     10500000
105100                   , VER_STATUS_CDE                               10510000
105200                   , CRE_UID_ID                                   10520000
105300                   , OPER_ID                                      10530000
105400                   , FCLTY_AREA_ID                                10540000
105500                   , PRC_FCLTY_AREA_ID                            10550000
105600                   , EXPTED_CART_CNT                              10560000
105700                   , ACTL_CART_CNT                                10570000
105800                   , ALLOC_IND                                    10580000
105900                   , REPACK_IND                                   10590000
106000                   , STRT_TMST                                    10600000
106100                   , STOP_TMST                                    10610000
106200                   , SCREEN_SEQ_NBR                               10620000
106300                   , LNE_LOC_CDE                                  10630000
106400                   , REC_SEL_IND                                  10640000
106500                FROM TWKORIN                                      10650000
106600               WHERE ORD_NBR          = :DK-PO-NBR                10660000
106700                 AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR           10670000
106800                 AND OPER_UNT_ID      = :DK-OPER-UNT-ID           10680000
106900                 AND FCLTY_ID         = :DK-FCLTY-ID              10690000
107000                 AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR       10700000
107100                 AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR  10710000
107200                 AND VER_STATUS_CDE   = :PC-A                     10720000
107300     END-EXEC.                                                    10730000
107400                                                                  10740000
107500/                                                                 10750000
107600*---------------------------------------------------------------* 10760000
107700*  CURSOR TO SELECT UNMATCHED PACK SLIP ITEMS FOR THE RECEIVER  * 10770000
107800*---------------------------------------------------------------* 10780000
107900                                                                  10790000
108000     EXEC SQL                                                     10800000
108100          DECLARE TUNPKSL-CSR CURSOR FOR                          10810000
108200              SELECT PO_NBR                                       10820000
108300                   , SEQ_NBR                                      10830000
108400                   , PKSL_LNE_NBR                                 10840000
108500                   , CRE_TMST                                     10850000
108600                   , VER_STAT_CDE                                 10860000
108700                   , PKSL_ITM_QTY                                 10870000
108800                   , UNT_COST_AMT                                 10880000
108900                   , COLOR_DESC                                   10890000
109000                   , SIZE_DESC                                    10900000
109100                   , VEND_STYL_NAME                               10910000
109200                   , VEND_DESC                                    10920000
109300                   , CRE_UID                                      10930000
109400                FROM TUNPKSL                                      10940000
109500               WHERE PO_NBR       = :DK-PO-NBR                    10950000
109600                 AND SEQ_NBR      = :PKSLIP-SEQ-NBR               10960000
109700                 AND VER_STAT_CDE = :PC-A                         10970000
109800     END-EXEC.                                                    10980000
109900                                                                  10990000
110000     EXEC SQL                                                     11000000
110100         DECLARE SHPTPO-CSR CURSOR FOR                            11010000
110200         SELECT SHIPT_ID,                                         11020000
110300                EXPTED_CART_CNT,                                  11030000
110400                CARR_CART_CT,                                     11040000
110500                VEND_CART_CT                                      11050000
110600           FROM TSHPTPO                                           11060000
110700          WHERE  PO_NBR           = :DK-PO-NBR                    11070000
110800            AND  REC_SEQ_NBR      = :DK-REC-SEQ-NBR               11080000
110900     END-EXEC.                                                    11090000
111000                                                                  11100000
111100 EJECT                                                            11110000
111200 LINKAGE SECTION.                                                 11120000
111300                                                                  11130000
111400 01  DFHCOMMAREA.                                                 11140000
111500     05  FILLER                         OCCURS  1 TO 4072 TIMES   11150000
111600                                        DEPENDING ON EIBCALEN.    11160000
111700         10  FILLER                     PIC X.                    11170000
111800                                                                  11180000
111900 EJECT                                                            11190000
112000 PROCEDURE DIVISION.                                              11200000
112100******************************************************************11210000
112200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **11220000
112300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **11230000
112400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **11240000
112500******************************************************************11250000
112600 0000-MAIN-MODULE.                                                11260000
112700     INITIALIZE DP030-CICS-API-FIELDS.                            11270000
112800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11280000
112900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11290000
113000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11300000
113100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11310000
113200     MOVE LENGTH OF RC265AI        TO DP030-MAP-LENGTH (1).       11320000
113300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11330000
113400     PERFORM 0001-CALL-CICS-ARCH-API.                             11340000
113500                                                                  11350000
113600     PERFORM 1000-CONTROL-PROCESSING                              11360000
113700                                                                  11370000
113800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11380000
113900     PERFORM 0001-CALL-CICS-ARCH-API.                             11390000
114000                                                                  11400000
114100******************************************************************11410000
114200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **11420000
114300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **11430000
114400******************************************************************11440000
114500 0001-CALL-CICS-ARCH-API.                                         11450000
114610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11461089
114700                                    DFHCOMMAREA                   11470089
114800                                    DP030-CICS-API-FIELDS         11480089
114900                                    DP020-STANDARD-COMMAREA       11490089
115000                                    RC265AI.                      11500089
115100                                                                  11510000
115200     IF  DP030-RC-CALL-SUCCESSFUL                                 11520000
115300         CONTINUE                                                 11530000
115400     ELSE                                                         11540000
115500         SET DP013-NO-ROLLBACK                                    11550000
115600             DP013-XCTL-DISPLAY-RESTART                           11560000
115700             DP013-CICS-ABEND      TO TRUE                        11570000
115800         MOVE '0001-CALL-CICS-ARCH-API'                           11580000
115900                                   TO DP013-PARAGRAPH             11590000
115920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O11592089
115930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11593089
116200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11620000
116300         PERFORM DP013-0000-PROCESS-ABEND                         11630000
116400     END-IF.                                                      11640000
116500*----------------------------------------------------------------*11650000
116600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11660000
116700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11670000
116800*                                                                *11680000
116900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11690000
117000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11700000
117100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11710000
117200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11720000
117300*----------------------------------------------------------------*11730000
117400                                                                  11740000
117500 1000-CONTROL-PROCESSING.                                         11750000
117600                                                                  11760000
117700     EVALUATE TRUE                                                11770000
117800         WHEN DP020-NEXT-ACT-INITIAL                              11780000
117900             INITIALIZE ASC-SPECIFIC-COMMAREA                     11790000
118000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            11800000
118100                                      ASC-SEL-TERM-ID             11810000
118200             MOVE DP020-SRC-TASK-NUMBER                           11820000
118300                                   TO ASC-LIST-TASK-NUMBER        11830000
118400                                      ASC-SEL-TASK-NUMBER         11840000
118500             MOVE PC-LIST-QUEUE-SEQ                               11850000
118600                                   TO ASC-LIST-SEQ                11860000
118700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 11870000
118800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11880000
118900***-----$TEMPLATE NOTE$-------------------------------------------11890000
119000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,11900000
119100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  11910000
119200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.11920000
119300***---------------------------------------------------------------11930000
119400             IF  PS-COMMAREA-NOT-VALID                            11940000
119500***              MOVE PC-TSYMSG-99901                             11950000
119600***                                TO DP020-MSG-NUMBER            11960000
119700***              SET DP020-MSG-FATAL                              11970000
119800***                                TO TRUE                        11980000
119900                 SET DP020-NEXT-ACT-APPL-ERROR                    11990000
120000                                   TO TRUE                        12000000
120100             ELSE                                                 12010000
120200                 PERFORM 4000-BUILD-INITIAL-PANEL                 12020000
120300             END-IF                                               12030000
120400                                                                  12040000
120500         WHEN DP020-NEXT-ACT-READ-MAP                             12050000
120600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12060000
120700                                   TO PV-TOP-ITEM                 12070000
120800             PERFORM 2000-PROCESS-PANEL                           12080000
120900                                                                  12090000
121000         WHEN DP020-NEXT-ACT-RETURN                               12100000
121100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12110000
121200                                   TO PV-TOP-ITEM                 12120000
121300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12130000
121400             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 12140000
121500             PERFORM 3200-RESET-ATTRIBUTES                        12150000
121600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12160000
121700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12170000
121800                                                                  12180000
121900         WHEN OTHER                                               12190000
122000             SET DP013-LOGIC-ABEND TO TRUE                        12200000
122100             SET DP013-NO-ROLLBACK TO TRUE                        12210000
122200             MOVE '1000-CONTROL-PROCESSING'                       12220000
122300                                   TO DP013-PARAGRAPH             12230000
122400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12240000
122500                                   TO DP013-MESSAGE-TEXT(1)       12250000
122600             PERFORM DP013-0000-PROCESS-ABEND                     12260000
122700     END-EVALUATE.                                                12270000
122800                                                                  12280000
122900 EJECT                                                            12290000
123000*----------------------------------------------------------------*12300000
123100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12310000
123200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12320000
123300*----------------------------------------------------------------*12330000
123400                                                                  12340000
123500 1100-PROCESS-INTER-APPL-COMM.                                    12350000
123600                                                                  12360000
123700     MOVE DP020-INT-APPL-FORMAT-IND                               12370000
123800                                   TO ASC-INT-APPL-FORMAT-IND.    12380000
123900     MOVE PC-1 TO PV-IDX.                                         12390000
124000     EVALUATE DP020-INT-APPL-FORMAT-IND                           12400000
124100         WHEN PC-INTER-APPL-LIST                                  12410000
124200             SET ASC-USE-SELECTION-QUEUE                          12420000
124300                 ASC-ADD-TO-RCVR TO TRUE                          12430000
124400             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  12440000
124500                                   TO ASC-NUMBER-OF-SELECTED-ITEMS12450000
124600             MOVE RC015-NUMBER-OF-TS-ITEMS                        12460000
124700                                   TO ASC-NUMBER-OF-TS-ITEMS      12470000
124800             MOVE RC015-SEL-QUEUE-NAME                            12480000
124900                                   TO ASC-SEL-QUEUE-NAME-IN       12490000
125000             PERFORM 1120-PREPARE-LIST-ENTRY                      12500000
125100             SET PS-NOT-END-OF-QUEUE                              12510000
125200                 PS-COMMAREA-VALID TO TRUE                        12520000
125300             PERFORM VARYING PV-ASC-IDX FROM 1 BY 1               12530000
125400                     UNTIL PS-END-OF-QUEUE                        12540000
125500                        OR PV-ASC-IDX > 15                        12550000
125600                 MOVE ASC-KEY-PO-NBR TO ASC-PO (PV-ASC-IDX)       12560000
125700                 MOVE ASC-KEY-SHIPT-ID                            12570000
125800                                     TO ASC-SHIPMT-ID (PV-ASC-IDX)12580000
125900                 IF ASC-KEY-REC-SEQ-NBR > 0                       12590000
126000                      SET ASC-NO-TSQ-UPDATE                       12600000
126100                                 TO TRUE                          12610000
126200                      SET DP020-NEXT-ACT-APPL-ERROR               12620000
126300                          DP020-MSG-FATAL                         12630000
126400                          PS-ERROR                                12640000
126500                          PS-COMMAREA-NOT-VALID                   12650000
126600                                 TO TRUE                          12660000
126700                      MOVE PC-TSYMSG-01040                        12670000
126800                                 TO DP020-MSG-NUMBER              12680000
126900                 END-IF                                           12690000
127000                 IF DP020-NEXT-ACT-APPL-ERROR                     12700000
127100                     SET PS-END-OF-QUEUE TO TRUE                  12710000
127200                 ELSE                                             12720000
127300                     PERFORM 2160-GET-NEXT-MESSAGE                12730000
127400                 END-IF                                           12740000
127500             END-PERFORM                                          12750000
127600             IF PS-COMMAREA-VALID                                 12760000
127700                 IF PV-ASC-IDX > 15                               12770000
127800                     SET DP020-NEXT-ACT-APPL-ERROR                12780000
127900                         DP020-MSG-FATAL                          12790000
128000                         PS-ERROR                                 12800000
128100                        PS-COMMAREA-NOT-VALID                     12810000
128200                                TO TRUE                           12820000
128300                     MOVE PC-TSYMSG-01081                         12830000
128400                                TO DP020-MSG-NUMBER               12840000
128500                 END-IF                                           12850000
128600             END-IF                                               12860000
128700             IF PS-COMMAREA-VALID                                 12870000
128800                 SET PS-SAME-PO                                   12880000
128900                     PS-VEHICLE-FOUND TO TRUE                     12890000
129000                 PERFORM VARYING PV-ASC-IDX FROM 1 BY 1           12900000
129100                     UNTIL ASC-PO (PV-ASC-IDX + 1) = 0            12910000
129200                        OR PS-NOT-SAME-PO                         12920000
129300                     IF ASC-PO (PV-ASC-IDX) NOT =                 12930000
129400                                       ASC-PO (PV-ASC-IDX + 1)    12940000
129500                         SET PS-NOT-SAME-PO TO TRUE               12950000
129600                     END-IF                                       12960000
129700                 END-PERFORM                                      12970000
129800                 PERFORM VARYING PV-ASC-IDX FROM 1 BY 1           12980000
129900                     UNTIL ASC-PO (PV-ASC-IDX) = 0                12990000
130000                        OR PS-NO-VEHICLE                          13000000
130100                     MOVE ASC-SHIPMT-ID (PV-ASC-IDX) TO           13010000
130200                                       SHIPMT-SHIPT-ID            13020000
130300                     SET PS-NO-VEHICLE TO TRUE                    13030000
130400                     PERFORM 1200-SELECT-VEH                      13040000
130500                     IF PS-NO-VEHICLE                             13050000
130600                         SET DP020-NEXT-ACT-APPL-ERROR            13060000
130700                             DP020-MSG-FATAL                      13070000
130800                             PS-ERROR                             13080000
130900                             PS-COMMAREA-NOT-VALID                13090000
131000                                    TO TRUE                       13100000
131100                         MOVE PC-TSYMSG-01083                     13110000
131200                                    TO DP020-MSG-NUMBER           13120000
131300                     END-IF                                       13130000
131400                 END-PERFORM                                      13140000
131500                 IF PS-NOT-SAME-PO                                13150000
131600                     SET DP020-NEXT-ACT-APPL-ERROR                13160000
131700                         DP020-MSG-FATAL                          13170000
131800                         PS-ERROR                                 13180000
131900                         PS-COMMAREA-NOT-VALID                    13190000
132000                                TO TRUE                           13200000
132100                     MOVE PC-TSYMSG-01082                         13210000
132200                                TO DP020-MSG-NUMBER               13220000
132300                                                                  13230000
132400                 END-IF                                           13240000
132500             END-IF                                               13250000
132600                                                                  13260000
132700         WHEN PC-INTER-APPL-MOVE                                  13270000
132800             SET ASC-USE-SELECTION-QUEUE                          13280000
132900                 ASC-MOVE-TO-RCVR TO TRUE                         13290000
133000             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  13300000
133100                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13310000
133200             MOVE RC015-NUMBER-OF-TS-ITEMS                        13320000
133300                                   TO ASC-NUMBER-OF-TS-ITEMS      13330000
133400             MOVE RC015-SEL-QUEUE-NAME                            13340000
133500                                   TO ASC-SEL-QUEUE-NAME-IN       13350000
133600             PERFORM 1120-PREPARE-LIST-ENTRY                      13360000
133700             SET PS-NOT-END-OF-QUEUE                              13370000
133800                 PS-COMMAREA-VALID TO TRUE                        13380000
133900             PERFORM VARYING PV-ASC-IDX FROM 1 BY 1               13390000
134000                     UNTIL PS-END-OF-QUEUE                        13400000
134100                        OR PV-ASC-IDX > 15                        13410000
134200                 MOVE ASC-KEY-PO-NBR TO ASC-PO (PV-ASC-IDX)       13420000
134300                 MOVE ASC-KEY-SHIPT-ID                            13430000
134400                                     TO ASC-SHIPMT-ID (PV-ASC-IDX)13440000
134500                 MOVE ASC-KEY-OPER-UNT-ID-N                       13450000
134600                                     TO ASC-OPER-UNT (PV-ASC-IDX) 13460000
134700                 MOVE ASC-KEY-FCLTY-ID-N                          13470000
134800                                     TO ASC-FCLTY-ID (PV-ASC-IDX) 13480000
134900                 PERFORM 2160-GET-NEXT-MESSAGE                    13490000
135000             END-PERFORM                                          13500000
135100             IF PS-COMMAREA-VALID                                 13510000
135200                 IF PV-ASC-IDX > 15                               13520000
135300                     SET DP020-NEXT-ACT-APPL-ERROR                13530000
135400                         DP020-MSG-FATAL                          13540000
135500                         PS-ERROR                                 13550000
135600                        PS-COMMAREA-NOT-VALID                     13560000
135700                                TO TRUE                           13570000
135800                     MOVE PC-TSYMSG-01081                         13580000
135900                                TO DP020-MSG-NUMBER               13590000
136000                 END-IF                                           13600000
136100             END-IF                                               13610000
136200             IF PS-COMMAREA-VALID                                 13620000
136300                 SET PS-SAME-OPER                                 13630000
136400                     PS-IP-RECEIVER                               13640000
136500                     PS-VEHICLE-FOUND                             13650000
136600                     PS-NOT-DIRECT-STR TO TRUE                    13660000
136700                 PERFORM VARYING PV-ASC-IDX FROM 1 BY 1           13670000
136800                     UNTIL ASC-PO (PV-ASC-IDX + 1) = 0            13680000
136900                        OR PS-NOT-SAME-OPER                       13690000
137000                     IF ASC-OPER-UNT (PV-ASC-IDX) NOT =           13700000
137100                                  ASC-OPER-UNT (PV-ASC-IDX + 1)   13710000
137200                         SET PS-NOT-SAME-OPER TO TRUE             13720000
137300                     END-IF                                       13730000
137400                     IF ASC-FCLTY-ID (PV-ASC-IDX) NOT =           13740000
137500                                  ASC-FCLTY-ID (PV-ASC-IDX + 1)   13750000
137600                         SET PS-NOT-SAME-OPER TO TRUE             13760000
137700                     END-IF                                       13770000
137800                 END-PERFORM                                      13780000
137900                 IF PS-SAME-OPER                                  13790000
138000                     PERFORM VARYING PV-ASC-IDX FROM 1 BY 1       13800000
138100                         UNTIL ASC-PO (PV-ASC-IDX) = 0            13810000
138200                            OR PS-NO-VEHICLE                      13820000
138300                            OR PS-NOT-IP-RECEIVER                 13830000
138400                            OR PS-DIRECT-STR                      13840000
138500                         MOVE ASC-SHIPMT-ID (PV-ASC-IDX) TO       13850000
138600                                           SHIPMT-SHIPT-ID        13860000
138700                         SET PS-NO-VEHICLE TO TRUE                13870000
138800                         PERFORM 1200-SELECT-VEH                  13880000
138900                         IF PS-NO-VEHICLE                         13890000
139000                             SET DP020-NEXT-ACT-APPL-ERROR        13900000
139100                                 DP020-MSG-FATAL                  13910000
139200                                 PS-ERROR                         13920000
139300                                 PS-COMMAREA-NOT-VALID            13930000
139400                                        TO TRUE                   13940000
139500                             MOVE PC-TSYMSG-01083                 13950000
139600                                        TO DP020-MSG-NUMBER       13960000
139700                         END-IF                                   13970000
139800                         MOVE ASC-PO (PV-ASC-IDX) TO PURCHS-PO-NBR13980000
139900                         PERFORM 1300-SELECT-PURCHS               13990000
140000                         IF PS-DIRECT-STR                         14000000
140100                             SET DP020-NEXT-ACT-APPL-ERROR        14010000
140200                                 DP020-MSG-FATAL                  14020000
140300                                 PS-ERROR                         14030000
140400                                 PS-COMMAREA-NOT-VALID            14040000
140500                                        TO TRUE                   14050000
140600                             MOVE PC-TSYMSG-01087                 14060000
140700                                        TO DP020-MSG-NUMBER       14070000
140800                         END-IF                                   14080000
140900                         MOVE ASC-PO (PV-ASC-IDX)                 14090000
141000                                        TO DK-PO-NBR              14100000
141100                         MOVE ASC-OPER-UNT (PV-ASC-IDX)           14110000
141200                                        TO DK-OPER-UNT-ID         14120000
141300                         MOVE ASC-FCLTY-ID (PV-ASC-IDX)           14130000
141400                                        TO DK-FCLTY-ID            14140000
141500                         MOVE ASC-RCVR-SEQ-NO (PV-ASC-IDX)        14150000
141600                                        TO DK-UPDATE-REC-SEQ-NBR  14160000
141700                                           DK-CASEPACK-SEQ-NBR    14170000
141800                         PERFORM 5500-SELECT-RECEIVER             14180000
141900                         IF SQLCODE = +0 AND                      14190000
142000                            RECEIV-STATUS-CDE = 'IP' OR           14200000
142100                            RECEIV-STATUS-CDE = 'CM'              14210000
142200                             CONTINUE                             14220000
142300                         ELSE                                     14230000
142400                             SET PS-NOT-IP-RECEIVER               14240000
142500                                 DP020-NEXT-ACT-APPL-ERROR        14250000
142600                                 DP020-MSG-FATAL                  14260000
142700                                 PS-ERROR                         14270000
142800                                 PS-COMMAREA-NOT-VALID            14280000
142900                                        TO TRUE                   14290000
143000                             MOVE PC-TSYMSG-01092                 14300000
143100                                        TO DP020-MSG-NUMBER       14310000
143200                         END-IF                                   14320000
143300                         PERFORM 5930-CHECK-TRANSCRIBED           14330000
143400                         MOVE ZEROES  TO  PV-CASEPACK-COUNT       14340000
143500                         IF  ASC-RCVR-TRNSCRB (PV-ASC-IDX)        14350000
143600                             PERFORM 5940-CHECK-CASEPACK-2        14360000
143700                         END-IF                                   14370000
143800                         IF PV-CASEPACK-COUNT > +0                14380000
143900                            SET  DP020-NEXT-ACT-APPL-ERROR        14390000
144000                                 DP020-MSG-FATAL                  14400000
144100                                 PS-ERROR                         14410000
144200                                 PS-COMMAREA-NOT-VALID            14420000
144300                                        TO TRUE                   14430000
144400                             MOVE PC-TSYMSG-01799                 14440000
144500                                        TO DP020-MSG-NUMBER       14450000
144600                         ELSE                                     14460077
144700                           IF RECEIV-PACK-BY-ST-IND = 'Y'         14470077
144800                             SET PS-NO-CHECKED-IN-FOUND TO TRUE   14480077
144900                             PERFORM 5960-ARE-CARTONS-CHECKED-IN  14490077
145000                             IF PS-CHECKED-IN-FOUND               14500077
145100                               SET  DP020-NEXT-ACT-APPL-ERROR     14510077
145200                                    DP020-MSG-FATAL               14520077
145300                                    PS-ERROR                      14530077
145400                                    PS-COMMAREA-NOT-VALID         14540077
145500                                           TO TRUE                14550077
145600                               MOVE PC-TSYMSG-02972               14560077
145700                                           TO DP020-MSG-NUMBER    14570077
145800                             END-IF                               14580077
145900                           END-IF                                 14590077
146000                         END-IF                                   14600077
146100                     END-PERFORM                                  14610000
146200                 ELSE                                             14620000
146300                     SET DP020-NEXT-ACT-APPL-ERROR                14630000
146400                         DP020-MSG-FATAL                          14640000
146500                         PS-ERROR                                 14650000
146600                         PS-COMMAREA-NOT-VALID                    14660000
146700                                TO TRUE                           14670000
146800                     MOVE PC-TSYMSG-01091                         14680000
146900                                TO DP020-MSG-NUMBER               14690000
147000                                                                  14700000
147100                 END-IF                                           14710000
147200             END-IF                                               14720000
147300                                                                  14730000
147400         WHEN OTHER                                               14740000
147500             MOVE PC-TSYMSG-00148                                 14750000
147600                               TO DP020-MSG-NUMBER                14760000
147700             SET DP020-MSG-FATAL                                  14770000
147800                 DP020-NEXT-ACT-APPL-ERROR                        14780000
147900                 PS-COMMAREA-NOT-VALID                            14790000
148000                               TO TRUE                            14800000
148100     END-EVALUATE.                                                14810000
148200                                                                  14820000
148300     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    14830000
148400                                                                  14840000
148500*----------------------------------------------------------------*14850000
148600* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *14860000
148700* STORAGE QUEUE PASSED FROM THE LIST.                            *14870000
148800*----------------------------------------------------------------*14880000
148900 1120-PREPARE-LIST-ENTRY.                                         14890000
149000     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                14900000
149100     MOVE ZERO                     TO ASC-SEL-ITEM.               14910000
149200     PERFORM 2160-GET-NEXT-MESSAGE.                               14920000
149300 EJECT                                                            14930000
149400                                                                  14940000
149500 1200-SELECT-VEH.                                                 14950000
149600                                                                  14960000
149700     EXEC SQL                                                     14970000
149800         SELECT  B.VEH_NBR                                        14980000
149900           INTO  :VHTRIP-VEH-NBR :DN-VEH-TRIP-NULL                14990000
150000           FROM   TSHIPMT A                                       15000000
150100                , TVHTRIP B                                       15010000
150200          WHERE  A.SHIPT_ID = :SHIPMT-SHIPT-ID                    15020000
150300            AND  A.TRIP_ID  = B.TRIP_ID                           15030000
150400     END-EXEC.                                                    15040000
150500                                                                  15050000
150600     EVALUATE TRUE                                                15060000
150700         WHEN SQLCODE = +0                                        15070000
150800         WHEN SQLCODE = +100                                      15080000
150900             CONTINUE                                             15090000
151000                                                                  15100000
151100         WHEN SQLWARN0 NOT = SPACES                               15110000
151200         WHEN SQLCODE < +0                                        15120000
151300         WHEN SQLCODE > +0                                        15130000
151400             MOVE '1200-SELECT-VEH'                               15140000
151500                               TO DP013-PARAGRAPH                 15150000
151600             MOVE 'SELECT A TSHIPMT ROW   '                       15160000
151700                               TO DP013-MESSAGE-TEXT(1)           15170000
151800             MOVE SQLCA        TO DP013-SQLCA                     15180000
151900             MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)        15190000
152000             MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (2)        15200000
152100             SET DP013-DB2-ABEND                                  15210000
152200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15220000
152300             PERFORM DP013-0000-PROCESS-ABEND                     15230000
152400     END-EVALUATE.                                                15240000
152500                                                                  15250000
152600     IF SQLCODE = +0                                              15260000
152700         IF DN-VEH-TRIP-NULL = -1                                 15270000
152800             CONTINUE                                             15280000
152900         ELSE                                                     15290000
153000             SET PS-VEHICLE-FOUND TO TRUE                         15300000
153100         END-IF                                                   15310000
153200     END-IF.                                                      15320000
153300                                                                  15330000
153400 1300-SELECT-PURCHS.                                              15340000
153500                                                                  15350000
153600     EXEC SQL                                                     15360000
153700        SELECT  DIR_STR_IND                                       15370000
153800          INTO :PURCHS-DIR-STR-IND                                15380000
153900          FROM  TPURCHS                                           15390000
154000      WHERE PO_NBR         = :PURCHS-PO-NBR                       15400000
154100        AND VER_STATUS_CDE = 'A'                                  15410000
154200     END-EXEC.                                                    15420000
154300                                                                  15430000
154400     EVALUATE TRUE                                                15440000
154500         WHEN SQLCODE = +0                                        15450000
154600         WHEN SQLCODE = +100                                      15460000
154700             CONTINUE                                             15470000
154800                                                                  15480000
154900         WHEN SQLWARN0 NOT = SPACE                                15490000
155000         WHEN SQLCODE < +0                                        15500000
155100         WHEN SQLCODE > +0                                        15510000
155200             MOVE '1300-SELECT-PURCHS'                            15520000
155300                             TO DP013-PARAGRAPH                   15530000
155400             MOVE 'SELECT DIR-STR-IND'                            15540000
155500                             TO DP013-MESSAGE-TEXT (1)            15550000
155600             MOVE SQLCA      TO DP013-SQLCA                       15560000
155700             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)          15570000
155800             SET DP013-DB2-ABEND                                  15580000
155900                             TO TRUE                              15590000
156000             SET DP013-XCTL-DISPLAY-RESTART                       15600000
156100                             TO TRUE                              15610000
156200             PERFORM DP013-0000-PROCESS-ABEND                     15620000
156300     END-EVALUATE.                                                15630000
156400                                                                  15640000
156500     IF SQLCODE = +0                                              15650000
156600         IF PURCHS-DIR-STR-IND = 'Y'                              15660000
156700             SET PS-DIRECT-STR TO TRUE                            15670000
156800         END-IF                                                   15680000
156900     END-IF.                                                      15690000
157000                                                                  15700000
157100*----------------------------------------------------------------*15710000
157200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *15720000
157300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *15730000
157400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *15740000
157500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *15750000
157600* FUNCTION KEYS CAN GET THIS FAR.                                *15760000
157700*----------------------------------------------------------------*15770000
157800                                                                  15780000
157900 2000-PROCESS-PANEL.                                              15790000
158000                                                                  15800000
158100     EVALUATE TRUE                                                15810000
158200         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    15820000
158300             IF  ASC-UPDATE-SUCCESSFUL                            15830000
158400                 MOVE PC-TSYMSG-00116                             15840000
158500                                   TO DP020-MSG-NUMBER            15850000
158600                 SET DP020-MSG-FATAL                              15860000
158700                     PS-ERROR      TO TRUE                        15870000
158800             ELSE                                                 15880000
158900                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             15890000
159000                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               15900000
159100                 IF PS-NO-ERROR                                   15910000
159200                     SET DP030-CONTINUE-GO                        15920000
159300                         ASC-UPDATE-SUCCESSFUL                    15930000
159400                                   TO TRUE                        15940000
159500                     INITIALIZE RC015-INTER-APPL-COMMAREA         15950000
159600                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            15960000
159700                                 TO RC015-NUMBER-OF-SELECTED-ITEMS15970000
159800                     PERFORM 5000-PREPARE-SEL-QUEUE               15980000
159900* JAK 06/2007 - ADD WMS SPECIFIC MESSAGE                          15990085
159910***                  MOVE PC-TSYMSG-00059                         15991085
160000***                              TO DP020-MSG-NUMBER              16000085
160010                     IF PS-ASNS-TO-WMS-NO                         16001085
160011                         MOVE PC-TSYMSG-00059                     16001185
160020                                     TO DP020-MSG-NUMBER          16002085
160030                     ELSE                                         16003085
160040                         MOVE PC-TSYMSG-03575                     16004085
160050                                     TO DP020-MSG-NUMBER          16005085
160060                     END-IF                                       16006085
160070*                                                                 16007090
160089                     PERFORM 6300-CHECK-MIXEDSKU-PKSLIP           16008990
160090*                                                                 16009090
160100                     PERFORM 3200-RESET-ATTRIBUTES                16010000
160200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16020000
160300                     MOVE -1 TO       ASTRTITL                    16030000
160400                 ELSE                                             16040000
160500                     SET DP030-OVERRIDE-GO                        16050000
160600                                     TO TRUE                      16060000
160700                 END-IF                                           16070000
160800             END-IF                                               16080000
160900                                                                  16090000
161000         WHEN DP020-SRC-AID = DP016-CLEAR                         16100000
161100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    16110000
161200             PERFORM 3200-RESET-ATTRIBUTES                        16120000
161300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16130000
161400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16140000
161500                                                                  16150000
161600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    16160000
161700             MOVE ASC-KEY-OPER-UNT-ID-N                           16170000
161800                                    TO DK-OPER-UNT-ID             16180000
161900             MOVE ASC-KEY-FCLTY-ID-N                              16190000
162000                                    TO DK-FCLTY-ID                16200000
162100             MOVE ASC-KEY-ORIGIN-SCAC-ID                          16210000
162200                                   TO DK-ORIGIN-SCAC-ID           16220000
162300             MOVE ASC-KEY-DELIVERY-SCAC-ID                        16230000
162400                                    TO DK-DELIVERY-SCAC-ID        16240000
162500             MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR                 16250000
162600             MOVE ASC-KEY-PO-NBR    TO DK-PO-NBR                  16260000
162700             MOVE ASC-KEY-PRO-NBR   TO DK-PRO-NBR                 16270000
162800             MOVE ASC-KEY-BOL-NBR   TO DK-BOL-NBR                 16280000
162900             MOVE ASC-KEY-SHIPT-ID  TO DK-SHIPT-ID                16290000
163000             PERFORM 2050-DELETE-LIST-QUEUE                       16300000
163100             PERFORM 4000-BUILD-INITIAL-PANEL                     16310000
163200                                                                  16320000
163300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             16330000
163400             IF  ASC-USE-SELECTION-QUEUE                          16340000
163500                 PERFORM 2160-GET-NEXT-MESSAGE                    16350000
163600                 PERFORM 3200-RESET-ATTRIBUTES                    16360000
163700                 PERFORM 4000-BUILD-INITIAL-PANEL                 16370000
163800             ELSE                                                 16380000
163900*                --- BOTTOM OF LIST ---                           16390000
164000                 MOVE PC-TSYMSG-00070                             16400000
164100                                   TO DP020-MSG-NUMBER            16410000
164200                 SET DP020-MSG-INFORMATIONAL                      16420000
164300                                   TO TRUE                        16430000
164400             END-IF                                               16440000
164500                                                                  16450000
164600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             16460000
164700             IF  ASC-USE-SELECTION-QUEUE                          16470000
164800                 PERFORM 2170-GET-PREV-MESSAGE                    16480000
164900                 PERFORM 3200-RESET-ATTRIBUTES                    16490000
165000                 PERFORM 4000-BUILD-INITIAL-PANEL                 16500000
165100             ELSE                                                 16510000
165200*                --- TOP OF LIST ---                              16520000
165300                 MOVE PC-TSYMSG-00069                             16530000
165400                                   TO DP020-MSG-NUMBER            16540000
165500                 SET DP020-MSG-INFORMATIONAL                      16550000
165600                                   TO TRUE                        16560000
165700             END-IF                                               16570000
165800                                                                  16580000
165900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    16590000
166000             PERFORM 2140-DESELECT-ALL-ITEMS                      16600000
166100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16610000
166200                                                                  16620000
166300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  16630000
166400             PERFORM 2150-SELECT-ALL-ITEMS                        16640000
166500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16650000
166600                                                                  16660000
166700         WHEN OTHER                                               16670000
166800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 16680000
166900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16690000
167000             IF  PS-NO-ERROR                                      16700000
167100                 SET DP030-CONTINUE-GO                            16710000
167200                                 TO TRUE                          16720000
167300                 PERFORM 2100-CHECK-FUNCTION-KEY                  16730000
167400             ELSE                                                 16740000
167500                 SET DP030-OVERRIDE-GO                            16750000
167600                                 TO TRUE                          16760000
167700             END-IF                                               16770000
167800     END-EVALUATE.                                                16780000
167900 EJECT                                                            16790000
168000*----------------------------------------------------------------*16800000
168100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *16810000
168200*----------------------------------------------------------------*16820000
168300 2050-DELETE-LIST-QUEUE.                                          16830000
168400                                                                  16840000
168500     EXEC CICS                                                    16850000
168600         DELETEQ TS                                               16860000
168700             QUEUE (ASC-LIST-QUEUE-NAME)                          16870000
168800             RESP  (PV-CICS-RESP)                                 16880000
168900     END-EXEC.                                                    16890000
169000                                                                  16900000
169100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       16910000
169200        (PV-CICS-RESP = DFHRESP(QIDERR))                          16920000
169300         CONTINUE                                                 16930000
169400     ELSE                                                         16940000
169500         SET DP013-CICS-ABEND      TO TRUE                        16950000
169600         SET DP013-NO-ROLLBACK     TO TRUE                        16960000
169700                                                                  16970000
169800         MOVE '2050-DELETE-LIST-QUEUE'                            16980000
169900                                   TO DP013-PARAGRAPH             16990000
170000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    17000000
170100                                   TO DP013-MESSAGE-TEXT (1)      17010000
170200         PERFORM DP013-0000-PROCESS-ABEND                         17020000
170300     END-IF.                                                      17030000
170400                                                                  17040000
170500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  17050000
170600 EJECT                                                            17060000
170700*----------------------------------------------------------------*17070000
170800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*17080000
170900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *17090000
171000* CICS ARCHITECTURE API.                                         *17100000
171100*----------------------------------------------------------------*17110000
171200 2100-CHECK-FUNCTION-KEY.                                         17120000
171300     EVALUATE TRUE                                                17130000
171400         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  17140000
171500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              17150000
171600                 INITIALIZE RC015-INTER-APPL-COMMAREA             17160000
171700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                17170000
171800                                TO RC015-NUMBER-OF-SELECTED-ITEMS 17180000
171900                 PERFORM 5000-PREPARE-SEL-QUEUE                   17190000
172000             ELSE                                                 17200000
172100                 SET DP030-OVERRIDE-GO                            17210000
172200                                   TO TRUE                        17220000
172300                 MOVE PC-TSYMSG-00057                             17230000
172400                                   TO DP020-MSG-NUMBER            17240000
172500                 SET DP020-MSG-WARNING                            17250000
172600                                   TO TRUE                        17260000
172700             END-IF                                               17270000
172800                                                                  17280000
172900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              17290000
173000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              17300000
173100              IF ASC-NUMBER-OF-SELECTED-ITEMS = 1                 17310000
173200                  MOVE PC-TSYMSG-00004        TO DP020-MSG-NUMBER 17320000
173300                  SET DP020-MSG-INFORMATIONAL TO TRUE             17330000
173400                                                                  17340000
173500              ELSE                                                17350000
173600                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          17360000
173700                      SET ASC-NO-TSQ-UPDATE                       17370000
173800                                 TO TRUE                          17380000
173900                      SET DP030-OVERRIDE-GO                       17390000
174000                          DP020-MSG-WARNING                       17400000
174100                                 TO TRUE                          17410000
174200                      MOVE PC-TSYMSG-00057                        17420000
174300                                 TO DP020-MSG-NUMBER              17430000
174400                  ELSE                                            17440000
174500                      SET ASC-NO-TSQ-UPDATE                       17450000
174600                                 TO TRUE                          17460000
174700                      SET DP030-OVERRIDE-GO                       17470000
174800                          DP020-MSG-WARNING                       17480000
174900                                 TO TRUE                          17490000
175000                      MOVE PC-TSYMSG-00047                        17500000
175100                                 TO DP020-MSG-NUMBER              17510000
175200                  END-IF                                          17520000
175300              END-IF                                              17530000
175400                                                                  17540000
175500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  17550000
175600             MOVE +1               TO PV-TOP-ITEM                 17560000
175700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17570000
175800                                                                  17580000
175900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   17590000
176000             PERFORM 2110-BROWSE-BACKWARD                         17600000
176100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17610000
176200                                                                  17620000
176300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   17630000
176400             PERFORM 2120-BROWSE-FORWARD                          17640000
176500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17650000
176600                                                                  17660000
176700         WHEN DP020-SRC-AID = DP016-ENTER                         17670000
176800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   17680000
176900             IF  PS-ERROR                                         17690000
177000                 CONTINUE                                         17700000
177100             ELSE                                                 17710000
177200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17720000
177300             END-IF                                               17730000
177400                                                                  17740000
177500         WHEN OTHER                                               17750000
177600             SET DP013-NO-ROLLBACK                                17760000
177700                 DP013-XCTL-DISPLAY-RESTART                       17770000
177800                 DP013-CICS-ABEND  TO TRUE                        17780000
177900             MOVE '2100-CHECK-FUNCTION-KEY'                       17790000
178000                                   TO DP013-PARAGRAPH             17800000
178100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      17810000
178200                                   TO DP013-MESSAGE-TEXT (1)      17820000
178300             PERFORM DP013-0000-PROCESS-ABEND                     17830000
178400     END-EVALUATE.                                                17840000
178500                                                                  17850000
178600*----------------------------------------------------------------*17860000
178700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *17870000
178800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *17880000
178900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *17890000
179000*    MESSAGE.                                                    *17900000
179100*----------------------------------------------------------------*17910000
179200                                                                  17920000
179300 2110-BROWSE-BACKWARD.                                            17930000
179400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    17940000
179500         GIVING PV-TOP-ITEM.                                      17950000
179600                                                                  17960000
179700     IF  ((PV-TOP-ITEM < +1)                                      17970000
179800       OR (PV-TOP-ITEM = +1))                                     17980000
179900         MOVE +1                   TO PV-TOP-ITEM                 17990000
180000*        -- TOP OF LIST --                                        18000000
180100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18010000
180200         SET DP020-MSG-INFORMATIONAL TO TRUE                      18020000
180300     END-IF.                                                      18030000
180400                                                                  18040000
180500 EJECT                                                            18050000
180600*----------------------------------------------------------------*18060000
180700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *18070000
180800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *18080000
180900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *18090000
181000*----------------------------------------------------------------*18100000
181100                                                                  18110000
181200 2120-BROWSE-FORWARD.                                             18120000
181300                                                                  18130000
181400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              18140000
181500         GIVING PV-TOP-ITEM.                                      18150000
181600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   18160000
181700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            18170000
181800                                   TO PV-TOP-ITEM                 18180000
181900*        -- BOTTOM OF LIST --                                     18190000
182000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            18200000
182100         SET DP020-MSG-INFORMATIONAL                              18210000
182200                                   TO TRUE                        18220000
182300     ELSE                                                         18230000
182400         COMPUTE PV-BOTTOM-ITEM =                                 18240000
182500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 18250000
182600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            18260000
182700*            -- BOTTOM OF LIST --                                 18270000
182800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            18280000
182900             SET DP020-MSG-INFORMATIONAL                          18290000
183000                                   TO TRUE                        18300000
183100         END-IF                                                   18310000
183200     END-IF.                                                      18320000
183300 EJECT                                                            18330000
183400*----------------------------------------------------------------*18340000
183500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *18350000
183600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *18360000
183700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *18370000
183800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *18380000
183900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *18390000
184000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *18400000
184100*----------------------------------------------------------------*18410000
184200                                                                  18420000
184300 2130-CHECK-FOR-JUMP-BROWSE.                                      18430000
184400     SET PS-NO-ERROR               TO TRUE.                       18440000
184500     IF (ASC-START-ITEM-REQUEST = SPACE)                          18450000
184600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            18460000
184700                                   TO PV-TOP-ITEM                 18470000
184800     ELSE                                                         18480000
184900         MOVE ASC-START-ITEM-REQUEST                              18490000
185000                                   TO DP010I-UNEDITED-FIELD       18500000
185100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       18510000
185200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     18520000
185300         SET DP010I-NEGATIVE-NOT-ALLOWED                          18530000
185400                                   TO TRUE                        18540000
185510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18551088
185520              USING DP010I-NUMERIC-EDIT-AREA                      18552088
185600                                                                  18560000
185700         IF  NOT DP010I-ERROR-DETECTED                            18570000
185800             MOVE DP010I-NUMERIC-FIELD                            18580000
185900                                   TO  ASC-START-ITEM-REQUEST-N   18590000
186000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  18600000
186100                 IF  ASC-START-ITEM-REQUEST-N >                   18610000
186200                                          ASC-NUMBER-OF-ITEMS-READ18620000
186300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         18630000
186400                     COMPUTE PV-TOP-ITEM =                        18640000
186500                             ASC-NUMBER-OF-ITEMS-READ             18650000
186600                             - PC-ITEMS-PER-PANEL + 1             18660000
186700                     IF  PV-TOP-ITEM < +1                         18670000
186800                         MOVE +1   TO PV-TOP-ITEM                 18680000
186900                         MOVE PC-TSYMSG-00070                     18690000
187000                                   TO DP020-MSG-NUMBER            18700000
187100                         SET DP020-MSG-INFORMATIONAL              18710000
187200                                   TO TRUE                        18720000
187300                     END-IF                                       18730000
187400                 ELSE                                             18740000
187500                     MOVE ASC-START-ITEM-REQUEST-N                18750000
187600                                   TO PV-TOP-ITEM                 18760000
187700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      18770000
187800                     COMPUTE PV-BOTTOM-ITEM =                     18780000
187900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     18790000
188000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ18800000
188100*                        -- BOTTOM OF LIST --                     18810000
188200                         MOVE PC-TSYMSG-00070                     18820000
188300                                   TO DP020-MSG-NUMBER            18830000
188400                         SET DP020-MSG-INFORMATIONAL              18840000
188500                                   TO TRUE                        18850000
188600                     END-IF                                       18860000
188700                 END-IF                                           18870000
188800             ELSE                                                 18880000
188900*                --- VALUE OUT OF RANGE ----                      18890000
189000                 MOVE PC-TSYMSG-00101                             18900000
189100                                   TO DP020-MSG-NUMBER            18910000
189200                 MOVE -1           TO ASTRTITL                    18920000
189300                 SET DP030-SET-CURSOR-APPL-1                      18930000
189400                                   TO TRUE                        18940000
189500                 MOVE DP015-REVERSE                               18950000
189600                                   TO ASTRTITH                    18960000
189700                 MOVE DP015-RED    TO ASTRTITC                    18970000
189800                 MOVE DP015-UNP-NUM-BRT-MDT                       18980000
189900                                   TO ASTRTITA                    18990000
190000                 SET DP020-MSG-FATAL                              19000000
190100                                   TO TRUE                        19010000
190200                 SET PS-ERROR      TO TRUE                        19020000
190300             END-IF                                               19030000
190400                                                                  19040000
190500         ELSE                                                     19050000
190600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19060000
190700             MOVE -1               TO ASTRTITL                    19070000
190800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19080000
190900             MOVE DP015-REVERSE    TO ASTRTITH                    19090000
191000             MOVE DP015-RED        TO ASTRTITC                    19100000
191100             MOVE DP015-UNP-NUM-BRT-MDT                           19110000
191200                                   TO ASTRTITA                    19120000
191300             SET DP020-MSG-FATAL   TO TRUE                        19130000
191400             SET PS-ERROR          TO TRUE                        19140000
191500         END-IF                                                   19150000
191600     END-IF.                                                      19160000
191700 EJECT                                                            19170000
191800*----------------------------------------------------------------*19180000
191900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *19190000
192000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *19200000
192100*----------------------------------------------------------------*19210000
192200 2140-DESELECT-ALL-ITEMS.                                         19220000
192300     MOVE +1                       TO ASC-BLK-SUB.                19230000
192400                                                                  19240000
192500     PERFORM 2141-CLEAR-SELECTED-INDS                             19250000
192600         VARYING ASC-ITEM-SUB                                     19260000
192700         FROM 1 BY 1                                              19270000
192800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19280000
192900                                                                  19290000
193000     ADD +1                        TO ASC-BLK-SUB.                19300000
193100                                                                  19310000
193200     PERFORM 2141-CLEAR-SELECTED-INDS                             19320000
193300         VARYING ASC-ITEM-SUB                                     19330000
193400         FROM 1 BY 1                                              19340000
193500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19350000
193600                                                                  19360000
193700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19370000
193800                                   TO PV-LIST-ITEM-NUMBER.        19380000
193900                                                                  19390000
194000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19400000
194100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19410000
194200                                                                  19420000
194300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19430000
194400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      19440000
194500         MOVE +1                   TO ASC-BLK-SUB                 19450000
194600                                                                  19460000
194700         PERFORM 5100-WRITE-TEMP-STORAGE                          19470000
194800                                                                  19480000
194900         MOVE +1                   TO PV-BLOCK-NUMBER             19490000
195000                                                                  19500000
195100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19510000
195200             PV-FIRST-BLOCK-IN-ARRAY - 1                          19520000
195300                                                                  19530000
195400         PERFORM                                                  19540000
195500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19550000
195600                                                                  19560000
195700             PERFORM 4410-READ-TEMP-STORAGE                       19570000
195800                                                                  19580000
195900             PERFORM 2141-CLEAR-SELECTED-INDS                     19590000
196000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 19600000
196100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19610000
196200                                                                  19620000
196300             PERFORM 5100-WRITE-TEMP-STORAGE                      19630000
196400                                                                  19640000
196500             ADD +1                TO PV-BLOCK-NUMBER             19650000
196600                                                                  19660000
196700         END-PERFORM                                              19670000
196800                                                                  19680000
196900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19690000
197000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19700000
197100                                                                  19710000
197200         PERFORM                                                  19720000
197300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19730000
197400                   ASC-HIGHEST-BLOCK-WRITTEN                      19740000
197500                                                                  19750000
197600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19760000
197700                                   TO PV-BLOCK-NUMBER             19770000
197800                                                                  19780000
197900             PERFORM 4410-READ-TEMP-STORAGE                       19790000
198000                                                                  19800000
198100             PERFORM 2141-CLEAR-SELECTED-INDS                     19810000
198200                 VARYING ASC-ITEM-SUB                             19820000
198300                 FROM 1 BY 1                                      19830000
198400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19840000
198500                                                                  19850000
198600             PERFORM 5100-WRITE-TEMP-STORAGE                      19860000
198700                                                                  19870000
198800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19880000
198900                                                                  19890000
199000         END-PERFORM                                              19900000
199100                                                                  19910000
199200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19920000
199300                                   TO PV-BLOCK-NUMBER             19930000
199400                                                                  19940000
199500         PERFORM 4410-READ-TEMP-STORAGE                           19950000
199600     END-IF.                                                      19960000
199700                                                                  19970000
199800                                                                  19980000
199900     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 19990000
200000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.20000000
200100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  20010000
200200                                                                  20020000
200300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20030000
200400                                                                  20040000
200500 EJECT                                                            20050000
200600*----------------------------------------------------------------*20060000
200700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *20070000
200800*----------------------------------------------------------------*20080000
200900                                                                  20090000
201000 2141-CLEAR-SELECTED-INDS.                                        20100000
201100                                                                  20110000
201200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20120000
201300             NOT EQUAL ZERO                                       20130000
201400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20140000
201500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20150000
201600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    20160000
201700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20170000
201800                                   TO TRUE                        20180000
201900         END-IF                                                   20190000
202000     END-IF.                                                      20200000
202100                                                                  20210000
202200 EJECT                                                            20220000
202300*----------------------------------------------------------------*20230000
202400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *20240000
202500*  FOR ALL ITEMS.                                                *20250000
202600*----------------------------------------------------------------*20260000
202700                                                                  20270000
202800 2150-SELECT-ALL-ITEMS.                                           20280000
202900                                                                  20290000
203000     MOVE +1                       TO ASC-BLK-SUB.                20300000
203100                                                                  20310000
203200     PERFORM 2151-SET-SELECTED-INDS                               20320000
203300         VARYING ASC-ITEM-SUB                                     20330000
203400         FROM 1 BY 1                                              20340000
203500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20350000
203600                                                                  20360000
203700     ADD +1                        TO ASC-BLK-SUB.                20370000
203800                                                                  20380000
203900     PERFORM 2151-SET-SELECTED-INDS                               20390000
204000         VARYING ASC-ITEM-SUB                                     20400000
204100         FROM 1 BY 1                                              20410000
204200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20420000
204300                                                                  20430000
204400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20440000
204500                                   TO PV-LIST-ITEM-NUMBER.        20450000
204600                                                                  20460000
204700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20470000
204800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20480000
204900                                                                  20490000
205000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20500000
205100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    20510000
205200         MOVE +1                   TO ASC-BLK-SUB                 20520000
205300                                                                  20530000
205400         PERFORM 5100-WRITE-TEMP-STORAGE                          20540000
205500                                                                  20550000
205600         MOVE +1                   TO PV-BLOCK-NUMBER             20560000
205700                                                                  20570000
205800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20580000
205900             PV-FIRST-BLOCK-IN-ARRAY - 1                          20590000
206000                                                                  20600000
206100         PERFORM                                                  20610000
206200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20620000
206300                                                                  20630000
206400             PERFORM 4410-READ-TEMP-STORAGE                       20640000
206500                                                                  20650000
206600             PERFORM 2151-SET-SELECTED-INDS                       20660000
206700                 VARYING ASC-ITEM-SUB                             20670000
206800                 FROM 1 BY 1                                      20680000
206900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20690000
207000                                                                  20700000
207100             PERFORM 5100-WRITE-TEMP-STORAGE                      20710000
207200                                                                  20720000
207300             ADD +1                TO PV-BLOCK-NUMBER             20730000
207400                                                                  20740000
207500         END-PERFORM                                              20750000
207600                                                                  20760000
207700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20770000
207800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20780000
207900                                                                  20790000
208000         PERFORM                                                  20800000
208100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20810000
208200                   ASC-HIGHEST-BLOCK-WRITTEN                      20820000
208300                                                                  20830000
208400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20840000
208500                                   TO PV-BLOCK-NUMBER             20850000
208600                                                                  20860000
208700             PERFORM 4410-READ-TEMP-STORAGE                       20870000
208800                                                                  20880000
208900             PERFORM 2151-SET-SELECTED-INDS                       20890000
209000                 VARYING ASC-ITEM-SUB                             20900000
209100                 FROM 1 BY 1                                      20910000
209200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20920000
209300                                                                  20930000
209400             PERFORM 5100-WRITE-TEMP-STORAGE                      20940000
209500                                                                  20950000
209600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20960000
209700                                                                  20970000
209800         END-PERFORM                                              20980000
209900                                                                  20990000
210000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21000000
210100                                   TO PV-BLOCK-NUMBER             21010000
210200                                                                  21020000
210300         PERFORM 4410-READ-TEMP-STORAGE                           21030000
210400     END-IF.                                                      21040000
210500                                                                  21050000
210600                                                                  21060000
210700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             21070000
210800                       ASC-NUMBER-OF-SELECTED-ITEMS.              21080000
210900                                                                  21090000
211000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21100000
211100                                                                  21110000
211200 EJECT                                                            21120000
211300*----------------------------------------------------------------*21130000
211400*    MARK EACH ITEM AS BEING SELECTED.                           *21140000
211500*----------------------------------------------------------------*21150000
211600                                                                  21160000
211700 2151-SET-SELECTED-INDS.                                          21170000
211800                                                                  21180000
211900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           21190000
212000             NOT EQUAL ZERO                                       21200000
212100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21210000
212200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21220000
212300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        21230000
212400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  21240000
212500                               TO  TRUE                           21250000
212600         END-IF                                                   21260000
212700     END-IF.                                                      21270000
212800                                                                  21280000
212900 2160-GET-NEXT-MESSAGE.                                           21290000
213000     ADD +1                        TO ASC-SEL-SUB.                21300000
213100     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            21310000
213200         ADD +1                    TO ASC-SEL-ITEM                21320000
213300         MOVE +1                   TO ASC-SEL-SUB                 21330000
213400     END-IF.                                                      21340000
213500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                21350000
213600         PERFORM 9100-READ-SEL-QUEUE                              21360000
213700         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      21370000
213800             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 21380000
213900                                   TO ASC-KEY-OPER-UNT-ID-N       21390000
214000             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    21400000
214100                                   TO ASC-KEY-FCLTY-ID-N          21410000
214200             MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)               21420000
214300                                   TO ASC-KEY-ORIGIN-SCAC-ID      21430000
214400             MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)               21440000
214500                                   TO ASC-KEY-DELIVERY-SCAC-ID    21450000
214600             MOVE RC013-VEH-NBR (ASC-SEL-SUB)                     21460000
214700                                   TO ASC-KEY-VEH-NBR             21470000
214800             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      21480000
214900                                   TO ASC-KEY-PO-NBR              21490000
215000             MOVE RC013-PRO-NBR (ASC-SEL-SUB)                     21500000
215100                                   TO ASC-KEY-PRO-NBR             21510000
215200             MOVE RC013-BOL-NBR (ASC-SEL-SUB)                     21520000
215300                                   TO ASC-KEY-BOL-NBR             21530000
215400             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 21540000
215500                                   TO ASC-KEY-REC-SEQ-NBR         21550000
215600                                      ASC-RCVR-SEQ-NO (PV-IDX)    21560000
215700             MOVE RC013-SHIPT-ID    (ASC-SEL-SUB)                 21570000
215800                                   TO ASC-KEY-SHIPT-ID            21580000
215900             SET RC013-INQ (ASC-SEL-SUB)                          21590000
216000                                   TO TRUE                        21600000
216100             ADD PC-1 TO PV-IDX                                   21610000
216200             PERFORM 9200-REWRITE-LIST-QUEUE                      21620000
216300         ELSE                                                     21630000
216400             SUBTRACT +1 FROM ASC-SEL-SUB                         21640000
216500*            --- BOTTOM OF LIST ---                               21650000
216600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21660000
216700             SET DP020-MSG-INFORMATIONAL                          21670000
216800                 PS-END-OF-QUEUE                                  21680000
216900                                   TO TRUE                        21690000
217000         END-IF                                                   21700000
217100     ELSE                                                         21710000
217200         SUBTRACT +1 FROM ASC-SEL-ITEM                            21720000
217300         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 21730000
217400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21740000
217500         SET DP020-MSG-INFORMATIONAL                              21750000
217600             PS-END-OF-QUEUE                                      21760000
217700                                   TO TRUE                        21770000
217800     END-IF.                                                      21780000
217900******************************************************************21790000
218000** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **21800000
218100** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **21810000
218200******************************************************************21820000
218300 2170-GET-PREV-MESSAGE.                                           21830000
218400     SUBTRACT +1 FROM ASC-SEL-SUB.                                21840000
218500     IF  ASC-SEL-SUB < +1                                         21850000
218600         SUBTRACT +1 FROM ASC-SEL-ITEM                            21860000
218700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 21870000
218800     END-IF.                                                      21880000
218900                                                                  21890000
219000     IF  ASC-SEL-ITEM > ZERO                                      21900000
219100         PERFORM 9100-READ-SEL-QUEUE                              21910000
219200         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     21920000
219300                                   TO ASC-KEY-OPER-UNT-ID-N       21930000
219400         MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                        21940000
219500                                   TO ASC-KEY-FCLTY-ID-N          21950000
219600         MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)                   21960000
219700                                   TO ASC-KEY-ORIGIN-SCAC-ID      21970000
219800         MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)                   21980000
219900                                   TO ASC-KEY-DELIVERY-SCAC-ID    21990000
220000         MOVE RC013-VEH-NBR (ASC-SEL-SUB)                         22000000
220100                                   TO ASC-KEY-VEH-NBR             22010000
220200     ELSE                                                         22020000
220300         MOVE +1                   TO ASC-SEL-ITEM                22030000
220400                                      ASC-SEL-SUB                 22040000
220500*        --- TOP OF LIST ---                                      22050000
220600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            22060000
220700         SET DP020-MSG-INFORMATIONAL                              22070000
220800                                   TO TRUE                        22080000
220900     END-IF.                                                      22090000
221000 EJECT                                                            22100000
221100******************************************************************22110000
221200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **22120000
221300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **22130000
221400******************************************************************22140000
221500 2200-MOVE-SCREEN-TO-COMMAREA.                                    22150000
221600                                                                  22160000
221700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             22170000
221800     MOVE +1                       TO PV-SUB.                     22180000
221900                                                                  22190000
222000     PERFORM 3100-SET-SUBSCRIPTS.                                 22200000
222100     IF  ASTRTITL > ZERO                                          22210000
222200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          22220000
222300     ELSE                                                         22230000
222400         IF  ASTRTITF = DP015-ERASE-EOF                           22240000
222500             INITIALIZE ASC-START-ITEM-REQUEST                    22250000
222600         END-IF                                                   22260000
222700     END-IF.                                                      22270000
222800     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          22280000
222900         VARYING PV-SUB                                           22290000
223000         FROM 1 BY 1                                              22300000
223100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      22310000
223200******************************************************************22320000
223300** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**22330000
223400******************************************************************22340000
223500 2210-MOVE-LINES-TO-COMMAREA.                                     22350000
223600     IF  MR-SELECTL (PV-SUB) > ZERO                               22360000
223700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             22370000
223800         MOVE MR-SELECTI (PV-SUB)                                 22380000
223900                                   TO ASC-TEMP-SELECTED-SW        22390000
224000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      22400000
224100     ELSE                                                         22410000
224200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                22420000
224300                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     22430000
224400                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        22440000
224500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      22450000
224600         END-IF                                                   22460000
224700     END-IF.                                                      22470000
224800     ADD +1                        TO ASC-ITEM-SUB.               22480000
224900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22490000
225000         ADD +1                    TO ASC-BLK-SUB                 22500000
225100         MOVE +1                   TO ASC-ITEM-SUB                22510000
225200     END-IF.                                                      22520000
225300******************************************************************22530000
225400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **22540000
225500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **22550000
225600******************************************************************22560000
225700 3000-EDIT-DATA-IN-COMMAREA.                                      22570000
225800     SET PS-NO-ERROR               TO TRUE.                       22580000
225900     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     22590000
226000**                                                                22600000
226100* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              22610000
226200* EDITTING IS DONE FROM THE BOTTOM UP.                            22620000
226300**                                                                22630000
226400     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22640000
226500         ASC-ITEMS-DISPLAYED - 1.                                 22650000
226600     PERFORM 3100-SET-SUBSCRIPTS.                                 22660000
226700     PERFORM 3300-EDIT-SELECTIONS                                 22670000
226800         VARYING PV-SUB                                           22680000
226900         FROM PV-SUB BY -1                                        22690000
227000         UNTIL PV-SUB < +1                                        22700000
227100                                                                  22710000
227200     IF  PS-NO-ERROR                                              22720000
227300         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22730000
227400     END-IF.                                                      22740000
227500                                                                  22750000
227600     IF  ((PS-NO-ERROR)                                           22760000
227700       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   22770000
227800       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    22780000
227900             PERFORM 3500-MARK-RANGE-AS-SELECTED                  22790000
228000     END-IF.                                                      22800000
228100 EJECT                                                            22810000
228200*----------------------------------------------------------------*22820000
228300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *22830000
228400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*22840000
228500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *22850000
228600*                                                                *22860000
228700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *22870000
228800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *22880000
228900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *22890000
229000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *22900000
229100*----------------------------------------------------------------*22910000
229200                                                                  22920000
229300 3100-SET-SUBSCRIPTS.                                             22930000
229400                                                                  22940000
229500     COMPUTE ASC-ITEM-SUB =                                       22950000
229600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        22960000
229700                                                                  22970000
229800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         22980000
229900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22990000
230000                                                                  23000000
230100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               23010000
230200     ELSE                                                         23020000
230300         MOVE +1                     TO ASC-BLK-SUB               23030000
230400     END-IF.                                                      23040000
230500******************************************************************23050000
230600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **23060000
230700******************************************************************23070000
230800                                                                  23080000
230900 3200-RESET-ATTRIBUTES.                                           23090000
231000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   23100000
231100     MOVE DP015-GREEN              TO ASTRTITC.                   23110000
231200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   23120000
231300                                                                  23130000
231400     PERFORM                                                      23140000
231500         VARYING PV-SUB                                           23150000
231600         FROM 1 BY 1                                              23160000
231700         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        23170000
231800         IF  ASC-UPDATE-SUCCESSFUL                                23180000
231900             MOVE DP015-PRO-NOR-OFF                               23190000
232000                                   TO MR-SELECTA (PV-SUB)         23200000
232100         ELSE                                                     23210000
232200             MOVE DP015-UNP-ALP-NOR-OFF                           23220000
232300                                   TO MR-SELECTA (PV-SUB)         23230000
232400         END-IF                                                   23240000
232500         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         23250000
232600         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         23260000
232700     END-PERFORM.                                                 23270000
232800******************************************************************23280000
232900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **23290000
233000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **23300000
233100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **23310000
233200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **23320000
233300******************************************************************23330000
233400 3300-EDIT-SELECTIONS.                                            23340000
233500     EVALUATE TRUE                                                23350000
233600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23360000
233700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         23370000
233800                 CONTINUE                                         23380000
233900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         23390000
234000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        23400000
234100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   23410000
234200                 MOVE ASC-TEMP-SELECTED-SW                        23420000
234300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23430000
234400                                TO ASC-SELECTED-SW                23440000
234500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23450000
234600             END-IF                                               23460000
234700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     23470000
234800                 = SPACE                                          23480000
234900             EVALUATE TRUE                                        23490000
235000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       23500000
235100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS23510000
235200                     MOVE SPACE TO ASC-SELECTED-SW                23520000
235300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23530000
235400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        23540000
235500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    23550000
235600                     MOVE SPACE TO ASC-SELECTED-SW                23560000
235700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23570000
235800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          23580000
235900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      23590000
236000                     MOVE SPACE TO ASC-SELECTED-SW                23600000
236100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23610000
236200             END-EVALUATE                                         23620000
236300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           23630000
236400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23640000
236500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23650000
236600             END-IF                                               23660000
236700             PERFORM 3310-EDIT-RANGE                              23670000
236800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             23680000
236900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23690000
237000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23700000
237100             END-IF                                               23710000
237200             PERFORM 3310-EDIT-RANGE                              23720000
237300         WHEN OTHER                                               23730000
237400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           23740000
237500             SET DP020-MSG-FATAL    TO TRUE                       23750000
237600             MOVE -1                TO MR-SELECTL (PV-SUB)        23760000
237700             SET DP030-SET-CURSOR-APPL-1                          23770000
237800                                    TO TRUE                       23780000
237900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        23790000
238000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        23800000
238100             SET PS-ERROR TO TRUE                                 23810000
238200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23820000
238300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23830000
238400                 MOVE SPACE         TO ASC-SELECTED-SW            23840000
238500                                        (ASC-BLK-SUB ASC-ITEM-SUB)23850000
238600             END-IF                                               23860000
238700     END-EVALUATE.                                                23870000
238800                                                                  23880000
238900     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    23890000
239000         MOVE ASC-KEY-PO-NBR TO DK-PO-NBR                         23900000
239100         MOVE ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)             23910000
239200           TO DK-CASEPACK-SEQ-NBR                                 23920000
239300         MOVE ZEROES TO PV-CASEPACK-COUNT                         23930000
239400         IF  ASC-RCVR-TRNSCRB (PV-ASC-IDX)                        23940000
239500             PERFORM 5950-CHECK-CASEPACK                          23950000
239600         END-IF                                                   23960000
239700         IF  PV-CASEPACK-COUNT > +0                               23970000
239800             SET  DP020-MSG-FATAL                                 23980000
239900                  PS-ERROR   TO TRUE                              23990000
240000             MOVE PC-TSYMSG-01799  TO DP020-MSG-NUMBER            24000000
240100         END-IF                                                   24010000
240200     END-IF.                                                      24020000
240300                                                                  24030000
240400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 24040000
240500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               24050000
240600     IF  ASC-ITEM-SUB < 1                                         24060000
240700         SUBTRACT +1 FROM ASC-BLK-SUB                             24070000
240800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                24080000
240900     END-IF.                                                      24090000
241000******************************************************************24100000
241100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **24110000
241200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **24120000
241300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**24130000
241400** THE ENDING.                                                  **24140000
241500******************************************************************24150000
241600 3310-EDIT-RANGE.                                                 24160000
241700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                24170000
241800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   24180000
241900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)24190000
242000                                   TO ASC-SELECTED-SW             24200000
242100                                        (ASC-BLK-SUB ASC-ITEM-SUB)24210000
242200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 24220000
242300         ELSE                                                     24230000
242400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     24240000
242500                 CONTINUE                                         24250000
242600             ELSE                                                 24260000
242700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        24270000
242800                 MOVE PC-TSYMSG-00054                             24280000
242900                                   TO DP020-MSG-NUMBER            24290000
243000                 SET DP020-MSG-FATAL                              24300000
243100                                   TO TRUE                        24310000
243200                 MOVE -1           TO MR-SELECTL (PV-SUB)         24320000
243300                 SET DP030-SET-CURSOR-APPL-1                      24330000
243400                                   TO TRUE                        24340000
243500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         24350000
243600                 MOVE DP015-UNDERLINE                             24360000
243700                                   TO MR-SELECTH (PV-SUB)         24370000
243800                 SET PS-ERROR      TO TRUE                        24380000
243900             END-IF                                               24390000
244000         END-IF                                                   24400000
244100     ELSE                                                         24410000
244200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24420000
244300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24430000
244400                                   TO ASC-SELECTED-SW             24440000
244500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24450000
244600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   24460000
244700         ELSE                                                     24470000
244800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       24480000
244900                 CONTINUE                                         24490000
245000             ELSE                                                 24500000
245100*                -- ONLY ONE END-OF-RANGE ALLOWED --              24510000
245200                 MOVE PC-TSYMSG-00055                             24520000
245300                                   TO DP020-MSG-NUMBER            24530000
245400                 SET DP020-MSG-FATAL                              24540000
245500                                   TO TRUE                        24550000
245600                 MOVE -1           TO MR-SELECTL (PV-SUB)         24560000
245700                 SET DP030-SET-CURSOR-APPL-1                      24570000
245800                                   TO TRUE                        24580000
245900                 SET PS-ERROR      TO TRUE                        24590000
246000             END-IF                                               24600000
246100         END-IF                                                   24610000
246200     END-IF.                                                      24620000
246300                                                                  24630000
246400******************************************************************24640000
246500** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **24650000
246600** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **24660000
246700******************************************************************24670000
246800 3400-CHECK-RANGE-SEQUENCE.                                       24680000
246900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24690000
247000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      24700000
247100       AND  ASC-START-OF-SELECTED-RANGE >                         24710000
247200                                         ASC-END-OF-SELECTED-RANGE24720000
247300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                24730000
247400         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 24740000
247500         SET DP020-MSG-FATAL TO TRUE                              24750000
247600         SET PS-ERROR TO TRUE                                     24760000
247700         PERFORM 3410-POSITION-AT-ERROR                           24770000
247800     END-IF.                                                      24780000
247900******************************************************************24790000
248000** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **24800000
248100** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **24810000
248200** SHOULD BE POSITIONED ON A RANGE ERROR.                       **24820000
248300******************************************************************24830000
248400 3410-POSITION-AT-ERROR.                                          24840000
248500     SET DP030-SET-CURSOR-APPL-1                                  24850000
248600                                   TO TRUE.                       24860000
248700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24870000
248800                    - PV-TOP-ITEM + 1.                            24880000
248900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24890000
249000         CONTINUE                                                 24900000
249100     ELSE                                                         24910000
249200         MOVE -1                   TO MR-SELECTL (PV-SUB)         24920000
249300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24930000
249400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24940000
249500     END-IF.                                                      24950000
249600                                                                  24960000
249700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24970000
249800                    - PV-TOP-ITEM + 1.                            24980000
249900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24990000
250000         CONTINUE                                                 25000000
250100     ELSE                                                         25010000
250200         MOVE -1                   TO MR-SELECTL (PV-SUB)         25020000
250300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25030000
250400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25040000
250500     END-IF.                                                      25050000
250600 EJECT                                                            25060000
250700*----------------------------------------------------------------*25070000
250800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *25080000
250900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *25090000
251000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *25100000
251100*----------------------------------------------------------------*25110000
251200                                                                  25120000
251300 3500-MARK-RANGE-AS-SELECTED.                                     25130000
251400     MOVE +1                       TO  ASC-BLK-SUB.               25140000
251500     PERFORM 3510-MARK-SELECTED-INDS                              25150000
251600         VARYING ASC-ITEM-SUB                                     25160000
251700         FROM 1 BY 1                                              25170000
251800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25180000
251900                                                                  25190000
252000     ADD +1                        TO ASC-BLK-SUB.                25200000
252100     PERFORM 3510-MARK-SELECTED-INDS                              25210000
252200         VARYING ASC-ITEM-SUB                                     25220000
252300         FROM 1 BY 1                                              25230000
252400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 25240000
252500                                                                  25250000
252600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               25260000
252700                                   TO  PV-LIST-ITEM-NUMBER.       25270000
252800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            25280000
252900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         25290000
253000               PC-ITEMS-PER-PANEL).                               25300000
253100                                                                  25310000
253200     MOVE ASC-START-OF-SELECTED-RANGE                             25320000
253300                                   TO PV-START-OF-SELECTED-RANGE. 25330000
253400     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            25340000
253500         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  25350000
253600               PC-ITEMS-PER-PANEL).                               25360000
253700                                                                  25370000
253800     MOVE ASC-END-OF-SELECTED-RANGE                               25380000
253900                                   TO  PV-END-OF-SELECTED-RANGE.  25390000
254000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             25400000
254100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    25410000
254200               PC-ITEMS-PER-PANEL).                               25420000
254300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             25430000
254400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             25440000
254500                                                                  25450000
254600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    25460000
254700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        25470000
254800         MOVE +1                   TO ASC-BLK-SUB                 25480000
254900         PERFORM 5100-WRITE-TEMP-STORAGE                          25490000
255000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         25500000
255100             PV-FIRST-BLOCK-IN-ARRAY - 1                          25510000
255200                                                                  25520000
255300         PERFORM                                                  25530000
255400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      25540000
255500                   PV-PREV-BLOCK-IN-ARRAY                         25550000
255600             MOVE PV-FIRST-BLOCK-IN-RANGE                         25560000
255700                                   TO PV-BLOCK-NUMBER             25570000
255800             PERFORM 4410-READ-TEMP-STORAGE                       25580000
255900             PERFORM 3510-MARK-SELECTED-INDS                      25590000
256000                 VARYING ASC-ITEM-SUB                             25600000
256100                 FROM 1 BY 1                                      25610000
256200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25620000
256300             PERFORM 5100-WRITE-TEMP-STORAGE                      25630000
256400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     25640000
256500         END-PERFORM                                              25650000
256600                                                                  25660000
256700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         25670000
256800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     25680000
256900         PERFORM                                                  25690000
257000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       25700000
257100                   PV-LAST-BLOCK-IN-RANGE                         25710000
257200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          25720000
257300                                   TO PV-BLOCK-NUMBER             25730000
257400             PERFORM 4410-READ-TEMP-STORAGE                       25740000
257500             PERFORM 3510-MARK-SELECTED-INDS                      25750000
257600                 VARYING ASC-ITEM-SUB                             25760000
257700                 FROM 1 BY 1                                      25770000
257800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25780000
257900             PERFORM 5100-WRITE-TEMP-STORAGE                      25790000
258000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25800000
258100         END-PERFORM                                              25810000
258200                                                                  25820000
258300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25830000
258400                                   TO PV-BLOCK-NUMBER             25840000
258500         PERFORM 4410-READ-TEMP-STORAGE                           25850000
258600     END-IF.                                                      25860000
258700                                                                  25870000
258800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 25880000
258900                                      ASC-END-OF-SELECTED-RANGE.  25890000
259000                                                                  25900000
259100 EJECT                                                            25910000
259200*----------------------------------------------------------------*25920000
259300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *25930000
259400*----------------------------------------------------------------*25940000
259500                                                                  25950000
259600 3510-MARK-SELECTED-INDS.                                         25960000
259700                                                                  25970000
259800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25980000
259900                                ASC-ITEM-SUB) >                   25990000
260000         ASC-START-OF-SELECTED-RANGE)                             26000000
260100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         26010000
260200                                ASC-ITEM-SUB) =                   26020000
260300         ASC-START-OF-SELECTED-RANGE)                             26030000
260400                                                                  26040000
260500         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     26050000
260600                                    ASC-ITEM-SUB) <               26060000
260700             ASC-END-OF-SELECTED-RANGE)                           26070000
260800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     26080000
260900                                    ASC-ITEM-SUB) =               26090000
261000             ASC-END-OF-SELECTED-RANGE)                           26100000
261100                                                                  26110000
261200             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          26120000
261300                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   26130000
261400                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   26140000
261500                               TO TRUE                            26150000
261600                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              26160000
261700                               TO TRUE                            26170000
261800                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    26180000
261900             END-IF                                               26190000
262000         END-IF                                                   26200000
262100     END-IF.                                                      26210000
262200                                                                  26220000
262300 EJECT                                                            26230000
262400*----------------------------------------------------------------*26240000
262500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *26250000
262600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *26260000
262700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *26270000
262800*    DISPLAY THE PANEL TO USER.                                  *26280000
262900*----------------------------------------------------------------*26290000
263000                                                                  26300000
263100 4000-BUILD-INITIAL-PANEL.                                        26310000
263200                                                                  26320000
263300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            26330000
263400                                 ASC-BLOCK-ENTRIES (2).           26340000
263500     MOVE +1                 TO ASC-BLK-SUB.                      26350000
263600     SET ASC-ITEMS-LEFT-ON-DB                                     26360000
263700                             TO TRUE.                             26370000
263800                                                                  26380000
263900     MOVE +0                 TO ASC-ITEM-SUB                      26390000
264000                                ASC-NUMBER-OF-ITEMS-READ          26400000
264100                                ASC-NUMBER-OF-SELECTED-ITEMS      26410000
264200                                ASC-HIGHEST-BLOCK-WRITTEN         26420000
264300                                ASC-START-OF-SELECTED-RANGE       26430000
264400                                ASC-END-OF-SELECTED-RANGE         26440000
264500                                ASC-ITEM-AT-TOP-OF-PANEL.         26450000
264600     PERFORM 4100-PREPARE-CURSOR                                  26460000
264700                                                                  26470000
264800     PERFORM 4010-OPEN-CURSOR.                                    26480000
264900                                                                  26490000
265000     PERFORM 4300-READ-ITEMS-FROM-DB.                             26500000
265100                                                                  26510000
265200     PERFORM 4020-CLOSE-CURSOR.                                   26520000
265300                                                                  26530000
265400     MOVE +1                   TO  PV-TOP-ITEM.                   26540000
265500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          26550000
265600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    26560000
265700         SET DP020-MSG-FATAL   TO  TRUE                           26570000
265800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               26580000
265900     ELSE                                                         26590000
266000         MOVE -1               TO MR-SELECTL (1)                  26600000
266100         SET DP030-SET-CURSOR-APPL-1                              26610000
266200                               TO TRUE                            26620000
266300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     26630000
266400     END-IF.                                                      26640000
266500 EJECT                                                            26650000
266600*----------------------------------------------------------------*26660000
266700* OPEN THE TMESSAGE CURSOR.                                      *26670000
266800*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *26680000
266900*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *26690000
267000*   USER.                                                        *26700000
267100*----------------------------------------------------------------*26710000
267200                                                                  26720000
267300 4010-OPEN-CURSOR.                                                26730000
267400                                                                  26740000
267500     IF ASC-ADD-TO-RCVR                                           26750000
267600         EXEC SQL                                                 26760000
267700              OPEN PO-CSR                                         26770000
267800         END-EXEC                                                 26780000
267900     ELSE                                                         26790000
268000         EXEC SQL                                                 26800000
268100              OPEN PO-MOVE-CSR                                    26810000
268200         END-EXEC                                                 26820000
268300     END-IF.                                                      26830000
268400                                                                  26840000
268500     EVALUATE TRUE                                                26850000
268600         WHEN SQLCODE = ZERO                                      26860000
268700             CONTINUE                                             26870000
268800         WHEN SQLWARN0 NOT = SPACES                               26880000
268900         WHEN SQLCODE < ZERO                                      26890000
269000         WHEN SQLCODE > ZERO                                      26900000
269100             MOVE '4010-OPEN-CURSOR'                              26910000
269200                               TO DP013-PARAGRAPH                 26920000
269300             MOVE 'OPEN SYSTEM MESSAGE CURSOR - '                 26930000
269400                               TO DP013-MESSAGE-TEXT (1)          26940000
269500             MOVE SQLCA        TO DP013-SQLCA                     26950000
269600             MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)        26960000
269700             SET DP013-DB2-ABEND                                  26970000
269800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26980000
269900             PERFORM DP013-0000-PROCESS-ABEND                     26990000
270000     END-EVALUATE.                                                27000000
270100                                                                  27010000
270200 EJECT                                                            27020000
270300*----------------------------------------------------------------*27030000
270400* CLOSE THE TMESSAGE CURSOR.                                     *27040000
270500*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *27050000
270600*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *27060000
270700*   USER.                                                        *27070000
270800*----------------------------------------------------------------*27080000
270900                                                                  27090000
271000 4020-CLOSE-CURSOR.                                               27100000
271100     IF ASC-ADD-TO-RCVR                                           27110000
271200         EXEC SQL                                                 27120000
271300             CLOSE PO-CSR                                         27130000
271400         END-EXEC                                                 27140000
271500     ELSE                                                         27150000
271600         EXEC SQL                                                 27160000
271700             CLOSE PO-MOVE-CSR                                    27170000
271800         END-EXEC                                                 27180000
271900     END-IF.                                                      27190000
272000                                                                  27200000
272100                                                                  27210000
272200     EVALUATE TRUE                                                27220000
272300         WHEN SQLCODE = ZERO                                      27230000
272400             CONTINUE                                             27240000
272500         WHEN SQLWARN0 NOT = SPACES                               27250000
272600         WHEN SQLCODE < ZERO                                      27260000
272700         WHEN SQLCODE > ZERO                                      27270000
272800             MOVE '4020-CLOSE-CURSOR'                             27280000
272900                               TO DP013-PARAGRAPH                 27290000
273000             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  27300000
273100                               TO DP013-MESSAGE-TEXT (1)          27310000
273200             MOVE SQLCA        TO DP013-SQLCA                     27320000
273300             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        27330000
273400             SET DP013-DB2-ABEND                                  27340000
273500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27350000
273600             PERFORM DP013-0000-PROCESS-ABEND                     27360000
273700     END-EVALUATE.                                                27370000
273800                                                                  27380000
273900 EJECT                                                            27390000
274000*----------------------------------------------------------------*27400000
274100*    SET UP THE HOST VARIABLES.                                  *27410000
274200*----------------------------------------------------------------*27420000
274300                                                                  27430000
274400 4100-PREPARE-CURSOR.                                             27440000
274500                                                                  27450000
274600     MOVE ASC-KEY-OPER-UNT-ID-N TO DK-OPER-UNT-ID.                27460000
274700     MOVE ASC-KEY-FCLTY-ID-N    TO DK-FCLTY-ID.                   27470000
274800     MOVE ASC-KEY-ORIGIN-SCAC-ID TO DK-ORIGIN-SCAC-ID.            27480000
274900     MOVE ASC-KEY-DELIVERY-SCAC-ID TO DK-DELIVERY-SCAC-ID.        27490000
275000     MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR.                    27500000
275100     MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR.                     27510000
275200     MOVE ASC-KEY-SHIPT-ID      TO DK-SHIPT-ID.                   27520000
275300                                                                  27530000
275400                                                                  27540000
275500 EJECT                                                            27550000
275600*----------------------------------------------------------------*27560000
275700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27570000
275800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27580000
275900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27590000
276000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27600000
276100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27610000
276200*                                                                *27620000
276300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27630000
276400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27640000
276500*    UPON INITIALIZATION.                                        *27650000
276600*----------------------------------------------------------------*27660000
276700                                                                  27670000
276800 4300-READ-ITEMS-FROM-DB.                                         27680000
276900                                                                  27690000
277000     PERFORM                                                      27700000
277100         VARYING PV-READ-COUNT                                    27710000
277200         FROM 1 BY 1                                              27720000
277300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    27730000
277400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         27740000
277500                                                                  27750000
277600         PERFORM 4310-FETCH                                       27760000
277700                                                                  27770000
277800         IF  ASC-ITEMS-LEFT-ON-DB                                 27780000
277900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                27790000
278000                 ADD +1            TO ASC-ITEM-SUB                27800000
278100             ELSE                                                 27810000
278200                 ADD +1            TO ASC-BLK-SUB                 27820000
278300                 MOVE +1           TO ASC-ITEM-SUB                27830000
278400                                                                  27840000
278500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         27850000
278600                     MOVE +1       TO ASC-BLK-SUB                 27860000
278700                     SET ASC-BLOCK-MODIFIED (1)                   27870000
278800                                   TO TRUE                        27880000
278900                     PERFORM 5100-WRITE-TEMP-STORAGE              27890000
279000                     MOVE ASC-BLOCK-ENTRIES                       27900000
279100                               (PC-MAX-BLOCKS-IN-ARRAY)           27910000
279200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 27920000
279300                     ADD +1        TO ASC-BLK-SUB                 27930000
279400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27940000
279500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      27950000
279600                                   TO TRUE                        27960000
279700                 END-IF                                           27970000
279800             END-IF                                               27980000
279900             MOVE RECEIV-REC-SEQ-NBR TO DK-CASEPACK-SEQ-NBR-2     27990000
280000             PERFORM 4320-CHECK-TRANSCRIBED                       28000000
280100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    28010000
280200             MOVE ASC-NUMBER-OF-ITEMS-READ                        28020000
280300                                   TO ASC-LIST-ITEM-NUMBER        28030000
280400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28040000
280500             MOVE RECEIV-REC-SEQ-NBR                              28050000
280600                                   TO ASC-RECEIVER                28060000
280700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28070000
280800             MOVE SHIPMT-PRO-NBR                                  28080000
280900                                   TO ASC-FREIGHT-BILL            28090000
281000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28100000
281100             MOVE SHIPMT-BOL-NBR                                  28110000
281200                                   TO ASC-BILL-OF-LADING          28120000
281300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28130000
281400             IF SHPTPO-ACTL-CART-CNT > 0                          28140000
281500                 MOVE SHPTPO-ACTL-CART-CNT                        28150000
281600                                   TO ASC-CART-CNT                28160000
281700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28170000
281800             ELSE                                                 28180000
281900                 MOVE SHPTPO-EXPTED-CART-CNT                      28190000
282000                                   TO ASC-CART-CNT                28200000
282100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28210000
282200             END-IF                                               28220000
282300             MOVE SHPTPO-VEND-NAME                                28230000
282400                                   TO ASC-KEY-VEND-NAME           28240000
282500             MOVE VHTRIP-OWNER-SCAC-ID                            28250000
282600                                   TO ASC-SCAC                    28260000
282700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28270000
282800             IF DN-VEH-TRIP-NULL = -1                             28280000
282900                 MOVE SPACES       TO ASC-TRAILER                 28290000
283000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28300000
283100             ELSE                                                 28310000
283200                 MOVE VHTRIP-VEH-NBR                              28320000
283300                                   TO ASC-TRAILER                 28330000
283400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28340000
283500             END-IF                                               28350000
283600             MOVE RECEIV-REC-TMST  TO PV-DB2-DATE                 28360000
283700             IF RECEIV-REC-TMST = '9999-09-09-09.09.09.999999'    28370000
283800                 MOVE 'ENROUTE'        TO ASC-ARR-DTE             28380000
283900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28390000
284000             ELSE                                                 28400000
284100                 MOVE PV-DB2-DATE-YY   TO PV-DATE-YY              28410000
284200                 MOVE PV-DB2-DATE-MM   TO PV-DATE-MM              28420000
284300                 MOVE PV-DB2-DATE-DD   TO PV-DATE-DD              28430000
284400                 MOVE PV-DATE          TO ASC-ARR-DTE             28440000
284500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28450000
284600             END-IF                                               28460000
284700             MOVE SHIPMT-SHIPT-ID  TO ASC-SHIPT-ID                28470000
284800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28480000
284900                                      DK-SHIPT-ID                 28490000
285000         END-IF                                                   28500000
285100     END-PERFORM.                                                 28510000
285200                                                                  28520000
285300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          28530000
285400         MOVE +1               TO ASC-BLK-SUB                     28540000
285500         PERFORM 5100-WRITE-TEMP-STORAGE                          28550000
285600         ADD +1                TO ASC-BLK-SUB                     28560000
285700         PERFORM 5100-WRITE-TEMP-STORAGE                          28570000
285800                                                                  28580000
285900         MOVE 1                TO ASC-BLK-SUB                     28590000
286000                                  PV-BLOCK-NUMBER                 28600000
286100         PERFORM 4410-READ-TEMP-STORAGE                           28610000
286200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             28620000
286300             MOVE 2            TO ASC-BLK-SUB                     28630000
286400                                  PV-BLOCK-NUMBER                 28640000
286500             PERFORM 4410-READ-TEMP-STORAGE                       28650000
286600         END-IF                                                   28660000
286700     END-IF.                                                      28670000
286800 EJECT                                                            28680000
286900*----------------------------------------------------------------*28690000
287000*    FETCH THE MESSAGE CURSOR.                                   *28700000
287100*----------------------------------------------------------------*28710000
287200                                                                  28720000
287300 4310-FETCH.                                                      28730000
287400                                                                  28740000
287500     IF ASC-ADD-TO-RCVR                                           28750000
287600         EXEC SQL                                                 28760000
287700              FETCH PO-CSR                                        28770000
287800              INTO  :SHIPMT-SHIPT-ID                              28780000
287900                  , :SHIPMT-PRO-NBR                               28790000
288000                  , :SHIPMT-BOL-NBR                               28800000
288100                  , :RECEIV-REC-SEQ-NBR                           28810000
288200                  , :SHPTPO-ACTL-CART-CNT                         28820000
288300                  , :SHPTPO-EXPTED-CART-CNT                       28830000
288400                  , :SHPTPO-VEND-NAME                             28840000
288500                  , :SHPTPO-PRIM-SHIPT-IND                        28850000
288600                  , :VHTRIP-OWNER-SCAC-ID                         28860000
288700                  , :VHTRIP-VEH-NBR :DN-VEH-TRIP-NULL             28870000
288800                  , :RECEIV-REC-TMST                              28880000
288900         END-EXEC                                                 28890000
289000     ELSE                                                         28900000
289100         EXEC SQL                                                 28910000
289200              FETCH PO-MOVE-CSR                                   28920000
289300              INTO  :SHIPMT-SHIPT-ID                              28930000
289400                  , :SHIPMT-PRO-NBR                               28940000
289500                  , :SHIPMT-BOL-NBR                               28950000
289600                  , :RECEIV-REC-SEQ-NBR                           28960000
289700                  , :SHPTPO-ACTL-CART-CNT                         28970000
289800                  , :SHPTPO-EXPTED-CART-CNT                       28980000
289900                  , :SHPTPO-VEND-NAME                             28990000
290000                  , :SHPTPO-PRIM-SHIPT-IND                        29000000
290100                  , :VHTRIP-OWNER-SCAC-ID                         29010000
290200                  , :VHTRIP-VEH-NBR :DN-VEH-TRIP-NULL             29020000
290300                  , :RECEIV-REC-TMST                              29030000
290400         END-EXEC                                                 29040000
290500     END-IF.                                                      29050000
290600                                                                  29060000
290700     EVALUATE TRUE                                                29070000
290800         WHEN SQLCODE = ZERO                                      29080000
290900         WHEN SQLCODE = +100                                      29090000
291000              CONTINUE                                            29100000
291100         WHEN SQLWARN0 NOT = SPACE                                29110000
291200         WHEN SQLCODE NOT = ZERO                                  29120000
291300              MOVE '4310-FETCH-CURSOR'                            29130000
291400                               TO DP013-PARAGRAPH                 29140000
291500              MOVE 'FETCH MESSAGE CURSOR'                         29150000
291600                               TO DP013-MESSAGE-TEXT (1)          29160000
291700              MOVE SQLCA       TO DP013-SQLCA                     29170000
291800              SET DP013-DB2-ABEND                                 29180000
291900                               TO TRUE                            29190000
292000              PERFORM DP013-0000-PROCESS-ABEND                    29200000
292100     END-EVALUATE.                                                29210000
292200                                                                  29220000
292300     IF  SQLCODE EQUAL +100                                       29230000
292400         SET ASC-NO-ITEMS-LEFT-ON-DB                              29240000
292500                                   TO TRUE                        29250000
292600     END-IF.                                                      29260000
292700                                                                  29270000
292800                                                                  29280000
292900 4320-CHECK-TRANSCRIBED.                                          29290000
293000                                                                  29300000
293100     EXEC SQL                                                     29310000
293200        SELECT VER_STATUS_CDE                                     29320000
293300          INTO :RECITM-VER-STATUS-CDE                             29330000
293400          FROM  TRECITM                                           29340000
293500         WHERE ORD_NBR         = :DK-PO-NBR                       29350000
293600           AND REC_SEQ_NBR     = :DK-CASEPACK-SEQ-NBR-2           29360000
293700           AND VER_STATUS_CDE  = :PC-A                            29370000
293800     END-EXEC.                                                    29380000
293900                                                                  29390000
294000     EVALUATE TRUE                                                29400000
294100         WHEN SQLCODE = +0                                        29410000
294200         WHEN SQLCODE = -811                                      29420063
294300             SET ASC-RCVR-TRNS                                    29430000
294400                 (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE               29440000
294500                                                                  29450000
294600         WHEN SQLCODE = +100                                      29460000
294700             SET ASC-RCVR-NOT-TRNS                                29470000
294800                 (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE             29480000
294900                                                                  29490000
295000         WHEN SQLWARN0 NOT = SPACE                                29500000
295100         WHEN SQLCODE < +0                                        29510000
295200         WHEN SQLCODE > +0                                        29520000
295300             MOVE '4320-CHECK-TRANSCRIBED'                        29530000
295400                               TO DP013-PARAGRAPH                 29540000
295500             MOVE 'COUNT CASEPACK SPLITS'                         29550000
295600                               TO DP013-MESSAGE-TEXT (1)          29560000
295700             MOVE SQLCA        TO DP013-SQLCA                     29570000
295800             MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)        29580000
295900             MOVE 'TDISTHD'    TO DP013-DB2-TABLE-NAME (2)        29590000
296000             SET DP013-DB2-ABEND                                  29600000
296100                               TO TRUE                            29610000
296200             SET DP013-XCTL-DISPLAY-RESTART                       29620000
296300                               TO TRUE                            29630000
296400             PERFORM DP013-0000-PROCESS-ABEND                     29640000
296500     END-EVALUATE.                                                29650000
296600                                                                  29660000
296700                                                                  29670000
296800 EJECT                                                            29680000
296900*----------------------------------------------------------------*29690000
297000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *29700000
297100*----------------------------------------------------------------*29710000
297200                                                                  29720000
297300 4400-MOVE-COMMAREA-TO-SCREEN.                                    29730000
297400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             29740000
297500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          29750000
297600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          29760000
297700             MOVE +1    TO ASC-BLK-SUB                            29770000
297800             PERFORM 5100-WRITE-TEMP-STORAGE                      29780000
297900             ADD +1     TO ASC-BLK-SUB                            29790000
298000             PERFORM 5100-WRITE-TEMP-STORAGE                      29800000
298100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             29810000
298200                 GIVING PV-BLOCK-NUMBER                           29820000
298300                 REMAINDER PV-REMAINDER                           29830000
298400             IF  PV-REMAINDER > ZERO                              29840000
298500                 ADD +1 TO PV-BLOCK-NUMBER                        29850000
298600             END-IF                                               29860000
298700             MOVE +1    TO ASC-BLK-SUB                            29870000
298800             PERFORM 4410-READ-TEMP-STORAGE                       29880000
298900             ADD +1     TO ASC-BLK-SUB                            29890000
299000                           PV-BLOCK-NUMBER                        29900000
299100             PERFORM 4410-READ-TEMP-STORAGE                       29910000
299200     END-IF.                                                      29920000
299300     MOVE +1            TO ASC-BLK-SUB.                           29930000
299400     COMPUTE ASC-ITEM-SUB =                                       29940000
299500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              29950000
299600         + PC-ITEMS-PER-PANEL).                                   29960000
299700                                                                  29970000
299800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        29980000
299900         ADD +1         TO ASC-BLK-SUB                            29990000
300000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30000000
300100     END-IF.                                                      30010000
300200                                                                  30020000
300300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30030000
300400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30040000
300500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30050000
300600     PERFORM 4420-FORMAT-LIST-LINES                               30060000
300700         VARYING PV-SUB                                           30070000
300800         FROM PC-ITEMS-PER-PANEL BY -1                            30080000
300900         UNTIL PV-SUB < +1.                                       30090000
301000                                                                  30100000
301100     COMPUTE ASC-ITEMS-DISPLAYED =                                30110000
301200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30120000
301300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    30130000
301400                                      ASTRTITO.                   30140000
301500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30150000
301600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30160000
301700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30170000
301800                                   TO ASELITO.                    30180000
301900     MOVE ASC-KEY-PO-NBR           TO APOO.                       30190000
302000     MOVE ASC-KEY-VEND-NAME        TO AVENDO.                     30200000
302100                                                                  30210000
302200     IF  DP020-MSG-NUMBER-X = SPACE                               30220000
302300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  30230000
302400*            --- MORE ITEMS TO DISPLAY ----                       30240000
302500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            30250000
302600             SET DP020-MSG-INFORMATIONAL TO TRUE                  30260000
302700         END-IF                                                   30270000
302800     END-IF.                                                      30280000
302900*----------------------------------------------------------------*30290000
303000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *30300000
303100*----------------------------------------------------------------*30310000
303200                                                                  30320000
303300 4410-READ-TEMP-STORAGE.                                          30330000
303400                                                                  30340000
303500     EXEC CICS                                                    30350000
303600         READQ TS                                                 30360000
303700             QUEUE (ASC-LIST-QUEUE-NAME)                          30370000
303800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30380000
303900             ITEM  (PV-BLOCK-NUMBER)                              30390000
304000             RESP  (PV-CICS-RESP)                                 30400000
304100     END-EXEC.                                                    30410000
304200                                                                  30420000
304300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       30430000
304400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     30440000
304500         CONTINUE                                                 30450000
304600     ELSE                                                         30460000
304700         SET DP013-CICS-ABEND     TO TRUE                         30470000
304800         SET DP013-NO-ROLLBACK    TO TRUE                         30480000
304900         MOVE '4410-READ-TEMP-STORAGE'                            30490000
305000                                  TO DP013-PARAGRAPH              30500000
305100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      30510000
305200                                  TO DP013-MESSAGE-TEXT(1)        30520000
305300         PERFORM DP013-0000-PROCESS-ABEND                         30530000
305400     END-IF.                                                      30540000
305500                                                                  30550000
305600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             30560000
305700                                                                  30570000
305800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         30580000
305900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               30590000
306000     END-IF.                                                      30600000
306100 EJECT                                                            30610000
306200*----------------------------------------------------------------*30620000
306300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *30630000
306400*----------------------------------------------------------------*30640000
306500                                                                  30650000
306600 4420-FORMAT-LIST-LINES.                                          30660000
306700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      30670000
306800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                30680000
306900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           30690000
307000         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           30700000
307100         MOVE SPACE              TO MR-SELECTI (PV-SUB)           30710000
307200                                    MR-ACTION (PV-SUB)            30720000
307300                                    MR-RECEIVER-X (PV-SUB)        30730000
307400                                    MR-ARR-DTE (PV-SUB)           30740000
307500                                    MR-CART-CNT-X (PV-SUB)        30750000
307600                                    MR-SCAC (PV-SUB)              30760000
307700                                    MR-TRAILER (PV-SUB)           30770000
307800                                    MR-FREIGHT-BILL (PV-SUB)      30780000
307900                                    MR-BILL-OF-LADING (PV-SUB)    30790000
308000     ELSE                                                         30800000
308100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30810000
308200                                                   > SPACE        30820000
308300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 30830000
308400                                 TO MR-SELECTI (PV-SUB)           30840000
308500         ELSE                                                     30850000
308600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30860000
308700                                 TO MR-SELECTI (PV-SUB)           30870000
308800         END-IF                                                   30880000
308900                                                                  30890000
309000         IF  DP030-SET-CURSOR-TRAILER                             30900000
309100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)30910000
309200                 > SPACE)                                         30920000
309300               OR (PV-SUB = 1))                                   30930000
309400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               30940000
309500                MOVE -1          TO MR-SELECTL (PV-SUB)           30950000
309600             END-IF                                               30960000
309700         END-IF                                                   30970000
309800                                                                  30980000
309900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           30990000
310000             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           31000000
310100                                 TO MR-ACTION (PV-SUB)            31010000
310200             IF ASC-ITEM-SUB > 1                                  31020000
310300                 IF ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB) =     31030000
310400                    ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB - 1)   31040000
310500                     MOVE ZERO       TO MR-RECEIVER (PV-SUB)      31050000
310600                 ELSE                                             31060000
310700                     MOVE ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB) 31070000
310800                                     TO MR-RECEIVER (PV-SUB)      31080000
310900                 END-IF                                           31090000
311000             ELSE                                                 31100000
311100                 MOVE ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)     31110000
311200                                 TO MR-RECEIVER (PV-SUB)          31120000
311300             END-IF                                               31130000
311400             MOVE ASC-ARR-DTE (ASC-BLK-SUB ASC-ITEM-SUB)          31140000
311500                                 TO MR-ARR-DTE (PV-SUB)           31150000
311600             MOVE ASC-CART-CNT (ASC-BLK-SUB ASC-ITEM-SUB)         31160000
311700                                 TO MR-CART-CNT (PV-SUB)          31170000
311800             MOVE ASC-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)             31180000
311900                                 TO MR-SCAC (PV-SUB)              31190000
312000             MOVE ASC-TRAILER (ASC-BLK-SUB ASC-ITEM-SUB)          31200000
312100                                 TO MR-TRAILER (PV-SUB)           31210000
312200             MOVE ASC-FREIGHT-BILL (ASC-BLK-SUB ASC-ITEM-SUB)     31220000
312300                                 TO MR-FREIGHT-BILL (PV-SUB)      31230000
312400             MOVE ASC-BILL-OF-LADING (ASC-BLK-SUB ASC-ITEM-SUB)   31240000
312500                                 TO MR-BILL-OF-LADING (PV-SUB)    31250000
312600         END-IF                                                   31260000
312700     END-IF.                                                      31270000
312800     SUBTRACT +1 FROM ASC-ITEM-SUB                                31280000
312900     IF  ASC-ITEM-SUB < + 1                                       31290000
313000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  31300000
313100         MOVE +1                 TO ASC-BLK-SUB                   31310000
313200     END-IF.                                                      31320000
313300******************************************************************31330000
313400** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **31340000
313500** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **31350000
313600** ISSUE A WARNING.                                             **31360000
313700******************************************************************31370000
313800 4430-CHECK-FOR-BEGIN-AND-END.                                    31380000
313900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       31390000
314000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     31400000
314100*            -- NO END-OF-RANGE SPECFIED ---                      31410000
314200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            31420000
314300             SET DP020-MSG-WARNING TO TRUE                        31430000
314400             PERFORM 4431-POSITION-AT-WARNING                     31440000
314500         END-IF                                                   31450000
314600     ELSE                                                         31460000
314700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     31470000
314800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                31480000
314900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            31490000
315000             SET DP020-MSG-WARNING TO TRUE                        31500000
315100             PERFORM 4431-POSITION-AT-WARNING                     31510000
315200         END-IF                                                   31520000
315300     END-IF.                                                      31530000
315400******************************************************************31540000
315500** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **31550000
315600** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **31560000
315700** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **31570000
315800** POSITION THE CURSOR THERE.                                   **31580000
315900******************************************************************31590000
316000 4431-POSITION-AT-WARNING.                                        31600000
316100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 31610000
316200                    - PV-TOP-ITEM + 1.                            31620000
316300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31630000
316400         CONTINUE                                                 31640000
316500     ELSE                                                         31650000
316600         SET DP030-SET-CURSOR-APPL-1                              31660000
316700                                   TO TRUE                        31670000
316800         MOVE -1                   TO MR-SELECTL (PV-SUB)         31680000
316900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31690000
317000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31700000
317100     END-IF.                                                      31710000
317200                                                                  31720000
317300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   31730000
317400                    - PV-TOP-ITEM + 1.                            31740000
317500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31750000
317600         CONTINUE                                                 31760000
317700     ELSE                                                         31770000
317800         SET DP030-SET-CURSOR-APPL-1                              31780000
317900                                   TO TRUE                        31790000
318000         MOVE -1                   TO MR-SELECTL (PV-SUB)         31800000
318100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31810000
318200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31820000
318300     END-IF.                                                      31830000
318400 EJECT                                                            31840000
318500*----------------------------------------------------------------*31850000
318600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *31860000
318700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *31870000
318800* FOR THE SELECTED ITEMS QUEUE.                                  *31880000
318900*                                                                *31890000
319000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *31900000
319100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *31910000
319200* THE ARRAY IS FULL.                                             *31920000
319300*----------------------------------------------------------------*31930000
319400                                                                  31940000
319500 5000-PREPARE-SEL-QUEUE.                                          31950000
319600                                                                  31960000
319700     MOVE +1                   TO  ASC-BLK-SUB.                   31970000
319800     PERFORM 5100-WRITE-TEMP-STORAGE.                             31980000
319900     ADD +1                    TO  ASC-BLK-SUB.                   31990000
320000     PERFORM 5100-WRITE-TEMP-STORAGE.                             32000000
320100                                                                  32010000
320200     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          32020000
320300     PERFORM 6010-DELETE-SEL-QUEUE.                               32030000
320400                                                                  32040000
320500     SET ASC-UPDATE-TSQ        TO  TRUE.                          32050000
320600                                                                  32060000
320700     SET RC013-IDX             TO  1.                             32070000
320800     MOVE ZERO                 TO RC015-NUMBER-OF-TS-ITEMS.       32080000
320900     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        32090000
321000                                                                  32100000
321100     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           32110000
321200             VARYING PV-ITEM                                      32120000
321300             FROM 1 BY 1                                          32130000
321400             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     32140000
321500                                                                  32150000
321600     IF  RC013-IDX > 1                                            32160000
321700         PERFORM 5205-WRITE-SEL-QUEUE                             32170000
321800         ADD +1                TO RC015-NUMBER-OF-TS-ITEMS        32180000
321900     END-IF.                                                      32190000
322000 EJECT                                                            32200000
322100*----------------------------------------------------------------*32210000
322200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *32220000
322300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *32230000
322400*----------------------------------------------------------------*32240000
322500                                                                  32250000
322600 5100-WRITE-TEMP-STORAGE.                                         32260000
322700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     32270000
322800                                   TO PV-LIST-ITEM-NUMBER.        32280000
322900     COMPUTE PV-BLOCK-NUMBER =                                    32290000
323000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    32300000
323100                                                                  32310000
323200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             32320000
323300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             32330000
323400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      32340000
323500             PERFORM 5105-REWRITE-ASC-LISTQ                       32350000
323600         END-IF                                                   32360000
323700     ELSE                                                         32370000
323800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       32380000
323900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            32390000
324000         PERFORM 5110-WRITE-ASC-LISTQ                             32400000
324100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   32410000
324200     END-IF.                                                      32420000
324300                                                                  32430000
324400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32440000
324500******************************************************************32450000
324600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **32460000
324700** SPECIFIC COMMAREA.                                           **32470000
324800******************************************************************32480000
324900 5105-REWRITE-ASC-LISTQ.                                          32490000
325000     EXEC CICS                                                    32500000
325100         WRITEQ TS                                                32510000
325200             QUEUE (ASC-LIST-QUEUE-NAME)                          32520000
325300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32530000
325400             ITEM  (PV-BLOCK-NUMBER)                              32540000
325500             REWRITE                                              32550000
325600             RESP  (PV-CICS-RESP)                                 32560000
325700     END-EXEC.                                                    32570000
325800                                                                  32580000
325900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           32590000
326000         CONTINUE                                                 32600000
326100     ELSE                                                         32610000
326200         SET DP013-CICS-ABEND            TO TRUE                  32620000
326300         SET DP013-NO-ROLLBACK           TO TRUE                  32630000
326400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       32640000
326500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     32650000
326600                                         TO DP013-MESSAGE-TEXT(1) 32660000
326700         PERFORM DP013-0000-PROCESS-ABEND                         32670000
326800     END-IF.                                                      32680000
326900                                                                  32690000
327000******************************************************************32700000
327100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **32710000
327200** SPECIFIC COMMAREA.                                           **32720000
327300******************************************************************32730000
327400 5110-WRITE-ASC-LISTQ.                                            32740000
327500     EXEC CICS                                                    32750000
327600         WRITEQ TS                                                32760000
327700             QUEUE (ASC-LIST-QUEUE-NAME)                          32770000
327800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32780000
327900             ITEM  (PV-BLOCK-NUMBER)                              32790000
328000             RESP  (PV-CICS-RESP)                                 32800000
328100     END-EXEC.                                                    32810000
328200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      32820000
328300         SET DP013-CICS-ABEND      TO TRUE                        32830000
328400         SET DP013-NO-ROLLBACK     TO TRUE                        32840000
328500         MOVE '5110-WRITE-ASC-LISTQ'                              32850000
328600                                   TO DP013-PARAGRAPH             32860000
328700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           32870000
328800                                   TO DP013-MESSAGE-TEXT(1)       32880000
328900         PERFORM DP013-0000-PROCESS-ABEND                         32890000
329000     END-IF.                                                      32900000
329100 EJECT                                                            32910000
329200*----------------------------------------------------------------*32920000
329300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *32930000
329400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *32940000
329500*----------------------------------------------------------------*32950000
329600                                                                  32960000
329700 5200-FILL-SEL-QUEUE-RECORD.                                      32970000
329800                                                                  32980000
329900     PERFORM 6112-READ-LIST-QUEUE.                                32990000
330000                                                                  33000000
330100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       33010000
330200         PERFORM                                                  33020000
330300         VARYING LQW-IDX                                          33030000
330400         FROM 1 BY 1                                              33040000
330500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            33050000
330600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          33060000
330700                                                                  33070000
330800             IF  LQW-SELECT (LQW-IDX)                             33080000
330900                 IF DP020-FK-CONFIRM (DP020-SRC-AID)              33090000
331000                     MOVE LQW-RECEIVER       (LQW-IDX)            33100000
331100                                   TO DK-UPDATE-REC-SEQ-NBR       33110000
331200                     MOVE ASC-KEY-OPER-UNT-ID-N                   33120000
331300                                    TO DK-OPER-UNT-ID             33130000
331400                     MOVE ASC-KEY-FCLTY-ID-N                      33140000
331500                                    TO DK-FCLTY-ID                33150000
331600                     MOVE ASC-KEY-PO-NBR                          33160000
331700                                    TO DK-PO-NBR                  33170000
331800                     MOVE ZERO TO PV-RECEIVER-CARTON-CNT          33180000
331900                     PERFORM VARYING PV-ASC-IDX FROM 1 BY 1       33190000
332000                        UNTIL ASC-PO (PV-ASC-IDX) = 0             33200000
332100                         MOVE ASC-PO (PV-ASC-IDX) TO DK-PO-NBR    33210000
332200                         MOVE ASC-RCVR-SEQ-NO (PV-ASC-IDX)        33220000
332300                                               TO DK-REC-SEQ-NBR  33230000
332400                        SET PS-NOT-END-OF-SHPTPO TO TRUE          33240000
332500                         PERFORM 5700-OPEN-SHPTPO-CSR             33250000
332600                         PERFORM 5800-FETCH-SHPTPO-CSR            33260000
332700                         PERFORM VARYING PV-SUB FROM 1 BY 1       33270000
332800                             UNTIL PS-END-OF-SHPTPO               33280000
332900                             IF SHPTPO-EXPTED-CART-CNT > 0        33290000
333000                                 CONTINUE                         33300000
333100                             ELSE                                 33310000
333200                                 IF SHPTPO-CARR-CART-CT > 0       33320000
333300                                     MOVE SHPTPO-CARR-CART-CT     33330000
333400                                       TO SHPTPO-EXPTED-CART-CNT  33340000
333500                                 ELSE                             33350000
333600                                     IF SHPTPO-VEND-CART-CT > 0   33360000
333700                                         MOVE SHPTPO-VEND-CART-CT 33370000
333800                                         TO SHPTPO-EXPTED-CART-CNT33380000
333900                                     END-IF                       33390000
334000                                 END-IF                           33400000
334100                             END-IF                               33410000
334200                             MOVE SHPTPO-SHIPT-ID                 33420000
334300                                              TO DK-SHIPT-ID      33430000
334400                             PERFORM 5300-LINK-RECEIVER           33440000
334500                             PERFORM 5800-FETCH-SHPTPO-CSR        33450000
334600                         END-PERFORM                              33460000
334700                         PERFORM 5900-CLOSE-SHPTPO-CSR            33470000
334800                         IF ASC-MOVE-TO-RCVR                      33480000
334900                             PERFORM 7000-DELETE-RECEIVER         33490000
335000                         END-IF                                   33500000
335100                     END-PERFORM                                  33510000
335200                     MOVE ASC-SHIPMT-ID (PV-ASC-IDX)              33520000
335300                                              TO DK-SHIPT-ID      33530000
335400                     MOVE 'V'      TO RC031-TABLE-TO-AUDIT        33540000
335500                     MOVE 'B'      TO RC031-AUD-TYP-CDE           33550000
335600                     MOVE 'U'      TO RC031-AUD-FUNC-CDE          33560000
335700                     MOVE ASC-KEY-PO-NBR                          33570000
335800                                   TO RC031-PO-NBR                33580000
335900                     MOVE LQW-RECEIVER       (LQW-IDX)            33590000
336000                                   TO RC031-REC-SEQ-NBR           33600000
336100                     MOVE ASC-KEY-OPER-UNT-ID-N                   33610000
336200                                   TO RC031-OPER-UNT-ID           33620000
336300                     MOVE ASC-KEY-FCLTY-ID-N                      33630000
336400                                   TO RC031-FCLTY-ID              33640000
336500                     EXEC CICS                                    33650000
336600                         LINK PROGRAM  (PC-AUDIT-RTN)             33660000
336700                              COMMAREA (RC031-FIELDS)             33670000
336800                              LENGTH   (PC-AUDIT-RTN-LENGTH)      33680000
336900                     END-EXEC                                     33690000
337000                     EVALUATE TRUE                                33700000
337100                         WHEN RC031-CALL-SUCCESSFUL               33710000
337200                             CONTINUE                             33720000
337300                                                                  33730000
337400                         WHEN OTHER                               33740000
337500                            MOVE '5200-FILL-SEL-QUEUE-RECORD'     33750000
337600                                            TO DP013-PARAGRAPH    33760000
337700                            MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN' 33770000
337800                                        TO DP013-MESSAGE-TEXT (1) 33780000
337900                            MOVE RC031-RETURN-DESC                33790000
338000                                        TO DP013-MESSAGE-TEXT (2) 33800000
338100                            MOVE RC031-SQLCA      TO DP013-SQLCA  33810000
338200                            SET DP013-DB2-ABEND                   33820000
338300                                DP013-XCTL-DISPLAY-RESTART        33830000
338400                                                  TO TRUE         33840000
338500                            PERFORM DP013-0000-PROCESS-ABEND      33850000
338600                     END-EVALUATE                                 33860000
338700                     PERFORM 5500-SELECT-RECEIVER                 33870000
338800                     IF RECEIV-ACTL-CART-CNT > 0                  33880000
338900                         ADD PV-RECEIVER-CARTON-CNT TO            33890000
339000                             RECEIV-ACTL-CART-CNT                 33900000
339100                     ELSE                                         33910000
339200                         ADD PV-RECEIVER-CARTON-CNT TO            33920000
339300                             RECEIV-EXPTED-CART-CNT               33930000
339400                     END-IF                                       33940000
339500                     PERFORM 5600-UPDATE-RECEIVER                 33950000
339600                     MOVE ASC-KEY-OPER-UNT-ID-N                   33960000
339700                                            TO DK-OPER-UNT-ID     33970000
339800                     MOVE ASC-KEY-FCLTY-ID-N                      33980000
339900                                            TO DK-FCLTY-ID        33990000
340000                     MOVE ASC-KEY-ORIGIN-SCAC-ID                  34000000
340100                                           TO DK-ORIGIN-SCAC-ID   34010000
340200                     MOVE ASC-KEY-DELIVERY-SCAC-ID                34020000
340300                                            TO DK-DELIVERY-SCAC-ID34030000
340400                     MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR         34040000
340500                     MOVE ASC-KEY-PO-NBR    TO DK-PO-NBR          34050000
340600                     MOVE ASC-KEY-PRO-NBR   TO DK-PRO-NBR         34060000
340700                     MOVE ASC-KEY-BOL-NBR   TO DK-BOL-NBR         34070000
340800                     MOVE ASC-KEY-SHIPT-ID  TO DK-SHIPT-ID        34080000
340900                     PERFORM 2050-DELETE-LIST-QUEUE               34090000
341000                     PERFORM 4000-BUILD-INITIAL-PANEL             34100000
341100                                                                  34110000
341200                 ELSE                                             34120000
341300                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          34130000
341400                                   TO RC013-ITEM (RC013-IDX)      34140000
341500                     MOVE LQW-SHIPT-ID       (LQW-IDX)            34150000
341600                                   TO RC013-SHIPT-ID              34160000
341700                                        (RC013-IDX)               34170000
341800                     MOVE ASC-KEY-PO-NBR                          34180000
341900                                   TO RC013-PO-NBR                34190000
342000                                        (RC013-IDX)               34200000
342100                     MOVE LQW-RECEIVER       (LQW-IDX)            34210000
342200                                   TO RC013-REC-SEQ-NBR           34220000
342300                                        (RC013-IDX)               34230000
342400                     MOVE ASC-KEY-OPER-UNT-ID-N                   34240000
342500                                   TO RC013-OPER-UNT-ID           34250000
342600                                        (RC013-IDX)               34260000
342700                     MOVE ASC-KEY-FCLTY-ID-N                      34270000
342800                                   TO RC013-FCLTY-ID              34280000
342900                                        (RC013-IDX)               34290000
343000                     MOVE SPACE    TO RC013-ACTION-SW (RC013-IDX) 34300000
343100                 END-IF                                           34310000
343200                 SET RC013-IDX UP BY 1                            34320000
343300                 IF  RC013-IDX > RC013-MAX-ITEMS                  34330000
343400                     PERFORM 5205-WRITE-SEL-QUEUE                 34340000
343500                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    34350000
343600                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         34360000
343700                     SET RC013-IDX TO  1                          34370000
343800                 END-IF                                           34380000
343900             END-IF                                               34390000
344000         END-PERFORM                                              34400000
344100     END-IF.                                                      34410000
344200                                                                  34420000
344300*----------------------------------------------------------------*34430000
344400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *34440000
344500*----------------------------------------------------------------*34450000
344600                                                                  34460000
344700 5205-WRITE-SEL-QUEUE.                                            34470000
344800                                                                  34480000
344900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34490000
345000                                   TO RC013-SELECTED-ITEMS.       34500000
345100                                                                  34510000
345200     EXEC CICS                                                    34520000
345300          WRITEQ TS                                               34530000
345400              QUEUE (ASC-SEL-QUEUE-NAME)                          34540000
345500              FROM  (RC013-DC-SELECT-RECORD)                      34550000
345600              ITEM  (PV-SEL-QUEUE-ITEM)                           34560000
345700              RESP  (PV-CICS-RESP)                                34570000
345800     END-EXEC.                                                    34580000
345900                                                                  34590000
346000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34600000
346100         CONTINUE                                                 34610000
346200     ELSE                                                         34620000
346300         SET DP013-CICS-ABEND      TO TRUE                        34630000
346400         SET DP013-NO-ROLLBACK     TO TRUE                        34640000
346500         MOVE '5205-WRITE-SEL-QUEUE'                              34650000
346600                                   TO DP013-PARAGRAPH             34660000
346700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          34670000
346800                                   TO DP013-MESSAGE-TEXT(1)       34680000
346900         PERFORM DP013-0000-PROCESS-ABEND                         34690000
347000     END-IF.                                                      34700000
347100*----------------------------------------------------------------*34710000
347200* UPDATE THE ROW ON TSHTPO                                       *34720000
347300*----------------------------------------------------------------*34730000
347400 5300-LINK-RECEIVER.                                              34740000
347500                                                                  34750000
347600     EXEC SQL                                                     34760000
347700         UPDATE TSHPTPO                                           34770000
347800            SET REC_SEQ_NBR      = :DK-UPDATE-REC-SEQ-NBR         34780000
347900              , EXPTED_CART_CNT  = :SHPTPO-EXPTED-CART-CNT        34790000
348000              , LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME       34800000
348100              , LAST_UPD_DTE     =  CURRENT DATE                  34810000
348200              , LAST_UPD_TIME    =  CURRENT TIME                  34820000
348300              , LAST_UPD_USER_ID = :DP020-USERID                  34830000
348400              , PRIM_SHIPT_IND   = :PC-N                          34840000
348500         WHERE  PO_NBR           = :DK-PO-NBR                     34850000
348600         AND    SHIPT_ID         = :DK-SHIPT-ID                   34860000
348700     END-EXEC.                                                    34870000
348800                                                                  34880000
348900     EVALUATE TRUE                                                34890000
349000         WHEN SQLCODE = +0                                        34900000
349001                                                                  34900199
349003             MOVE ASC-KEY-PO-NBR   TO RCT00017-PO-NBR             34900399
349004             MOVE DK-UPDATE-REC-SEQ-NBR                           34900499
349005                                   TO RCT00017-RCVR-SEQ-NBR       34900599
349006             MOVE ASC-KEY-OPER-UNT-ID-N                           34900699
349007                                   TO RCT00017-LOC-NBR            34900799
349008             IF  ASC-MOVE-TO-RCVR                                 34900899
349009                 MOVE '0R'         TO  RCT00017-DC-FUNC-CDE       34900999
349010             ELSE                                                 34901099
349011                 MOVE '0Q'         TO  RCT00017-DC-FUNC-CDE       34901199
349012             END-IF                                               34901299
349013                                                                  34901399
349014             MOVE ZEROES           TO  RCT00017-DEST-LOC-NBR      34901499
349020             MOVE DP020-USERID     TO  RCT00017-CRE-BY-USR-ID     34902099
349030             MOVE 'RCKCS265'       TO  RCT00017-CRE-BY-PGM-NM     34903099
349040             MOVE 0                TO  RCT00017-PO-LNE-NBR        34904099
349050                                       RCT00017-PREPK-ID          34905099
349060                                       RCT00017-QTY-TRKD-NBR      34906099
349070                                       RCT00017-PKSL-SEQ-NBR      34907099
349080              PERFORM 6200-INSERT-PO-TRACK                        34908099
349100                                                                  34910099
349200                                                                  34920000
349300         WHEN OTHER                                               34930000
349400              MOVE '5300-LINK-RECEIVER'                           34940000
349500                              TO DP013-PARAGRAPH                  34950000
349600              MOVE 'UNSUCCESSFUL UPDATE OF TSHPTPO  '             34960000
349700                              TO DP013-MESSAGE-TEXT (1)           34970000
349800              MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)           34980000
349900              MOVE DK-SHIPT-ID                                    34990000
350000                              TO DP013-MESSAGE-TEXT (3)           35000000
350100              MOVE SQLCA      TO DP013-SQLCA                      35010000
350200              MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)         35020000
350300              SET DP013-DB2-ABEND                                 35030000
350400                  DP013-XCTL-DISPLAY-RESTART                      35040000
350500                              TO TRUE                             35050000
350600              PERFORM DP013-0000-PROCESS-ABEND                    35060000
350700     END-EVALUATE.                                                35070000
350800                                                                  35080000
350900     IF SQLCODE = ZERO                                            35090000
351000         MOVE PC-U                   TO PV-TRN-CDE                35100000
351100         PERFORM 5400-AUDIT-TSHPTPO                               35110000
351200     END-IF.                                                      35120000
351300                                                                  35130000
351400     IF SHPTPO-ACTL-CART-CNT > 0                                  35140000
351500         ADD SHPTPO-ACTL-CART-CNT TO PV-RECEIVER-CARTON-CNT       35150000
351600     ELSE                                                         35160000
351700         IF SHPTPO-EXPTED-CART-CNT > 0                            35170000
351800             ADD SHPTPO-EXPTED-CART-CNT TO PV-RECEIVER-CARTON-CNT 35180000
351900         ELSE                                                     35190000
352000             IF SHPTPO-CARR-CART-CT > 0                           35200000
352100                 ADD SHPTPO-CARR-CART-CT TO PV-RECEIVER-CARTON-CNT35210000
352200             ELSE                                                 35220000
352300                 IF SHPTPO-VEND-CART-CT > 0                       35230000
352400                     ADD SHPTPO-VEND-CART-CT                      35240000
352500                                         TO PV-RECEIVER-CARTON-CNT35250000
352600                 END-IF                                           35260000
352700             END-IF                                               35270000
352800         END-IF                                                   35280000
352900     END-IF.                                                      35290000
353000                                                                  35300000
353100***************************************************************** 35310000
353200*     INSERT A COPY OF THE SHPTPO ROW TO THE AUDIT TRAIL TABLE  * 35320000
353300*     AFTER INSERTING THE SHPTPO TABLE.                        *  35330000
353400***************************************************************** 35340000
353500                                                                  35350000
353600 5400-AUDIT-TSHPTPO.                                              35360000
353700                                                                  35370000
353800     EXEC SQL                                                     35380062
353900         SELECT SHIPT_ID,                                         35390000
354000                PO_NBR,                                           35400000
354100                REC_SEQ_NBR,                                      35410000
354200                EXPTED_CART_CNT,                                  35420000
354300                ACTL_CART_CNT,                                    35430000
354400                DMG_CART_CNT,                                     35440000
354500                PKSL_IND,                                         35450000
354600                VEND_NAME,                                        35460000
354700                FRGT_CHG_AMT,                                     35470000
354800                LAST_UPD_PGM_ID,                                  35480000
354900                CRE_USER_ID,                                      35490000
355000                CARR_CART_CT,                                     35500000
355100                CARR_LAST_UPD_DTE,                                35510000
355200                CARR_LAST_UPD_TIME,                               35520000
355300                VEND_CART_CT,                                     35530000
355400                VEND_LAST_UPD_DTE,                                35540000
355500                VEND_LAST_UPD_TIME,                               35550000
355600                CRE_TMST,                                         35560000
355700                LAST_UPD_DTE,                                     35570000
355800                LAST_UPD_TIME,                                    35580000
355900                LAST_UPD_USER_ID,                                 35590000
356000                PRIM_SHIPT_IND                                    35600000
356100             ,  SPLT_XMIT_IND                                     35610000
356200             ,  SPLT_XMIT_DTE                                     35620000
356300             ,  SPLT_XMIT_TM                                      35630000
356400           INTO :SHPTPO-SHIPT-ID,                                 35640000
356500                :SHPTPO-PO-NBR,                                   35650000
356600                :SHPTPO-REC-SEQ-NBR,                              35660000
356700                :SHPTPO-EXPTED-CART-CNT,                          35670000
356800                :SHPTPO-ACTL-CART-CNT,                            35680000
356900                :SHPTPO-DMG-CART-CNT,                             35690000
357000                :SHPTPO-PKSL-IND,                                 35700000
357100                :SHPTPO-VEND-NAME,                                35710000
357200                :SHPTPO-FRGT-CHG-AMT,                             35720000
357300                :SHPTPO-LAST-UPD-PGM-ID,                          35730000
357400                :SHPTPO-CRE-USER-ID,                              35740000
357500                :SHPTPO-CARR-CART-CT,                             35750000
357600                :SHPTPO-CARR-LAST-UPD-DTE,                        35760000
357700                :SHPTPO-CARR-LAST-UPD-TIME,                       35770000
357800                :SHPTPO-VEND-CART-CT,                             35780000
357900                :SHPTPO-VEND-LAST-UPD-DTE,                        35790000
358000                :SHPTPO-VEND-LAST-UPD-TIME,                       35800000
358100                :SHPTPO-CRE-TMST,                                 35810000
358200                :SHPTPO-LAST-UPD-DTE,                             35820000
358300                :SHPTPO-LAST-UPD-TIME,                            35830000
358400                :SHPTPO-LAST-UPD-USER-ID,                         35840000
358500                :SHPTPO-PRIM-SHIPT-IND                            35850000
358600             ,  :SHPTPO-SPLT-XMIT-IND                             35860000
358700             ,  :SHPTPO-SPLT-XMIT-DTE                             35870000
358800             ,  :SHPTPO-SPLT-XMIT-TM                              35880000
358900           FROM TSHPTPO                                           35890000
359000          WHERE  PO_NBR           = :DK-PO-NBR                    35900000
359100            AND  SHIPT_ID         = :DK-SHIPT-ID                  35910000
359200     END-EXEC.                                                    35920000
359300                                                                  35930000
359400     EVALUATE TRUE                                                35940000
359500         WHEN SQLCODE = ZERO                                      35950000
359600         WHEN SQLCODE = +100                                      35960000
359700             CONTINUE                                             35970000
359800                                                                  35980000
359900         WHEN SQLWARN0 NOT = SPACE                                35990000
360000         WHEN SQLCODE  NOT = +0                                   36000000
360100              MOVE '5400-AUDIT-SHPTPO'                            36010000
360200                               TO DP013-PARAGRAPH                 36020000
360300              MOVE 'SELECT SHPPTPO DATA'                          36030000
360400                               TO DP013-MESSAGE-TEXT (1)          36040000
360500              MOVE DK-PO-NBR   TO DP013-MESSAGE-TEXT (2)          36050000
360600              MOVE DK-SHIPT-ID TO DP013-MESSAGE-TEXT (3)          36060000
360700              MOVE SQLCA       TO DP013-SQLCA                     36070000
360800              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)        36080000
360900              SET DP013-DB2-ABEND                                 36090000
361000                               TO TRUE                            36100000
361100              PERFORM DP013-0000-PROCESS-ABEND                    36110000
361200     END-EVALUATE.                                                36120000
361300                                                                  36130000
361400     MOVE PV-TRN-CDE               TO AUSHPO-TRN-CDE.             36140000
361500                                                                  36150000
361600     EXEC SQL                                                     36160000
361700         INSERT INTO TAUSHPO                                      36170000
361800               (SHIPT_ID,                                         36180000
361900                PO_NBR,                                           36190000
362000                REC_SEQ_NBR,                                      36200000
362100                EXPTED_CART_CNT,                                  36210000
362200                ACTL_CART_CNT,                                    36220000
362300                DMG_CART_CNT,                                     36230000
362400                PKSL_IND,                                         36240000
362500                VEND_NAME,                                        36250000
362600                FRGT_CHG_AMT,                                     36260000
362700                LAST_UPD_PGM_ID,                                  36270000
362800                CRE_USER_ID,                                      36280000
362900                CARR_CART_CT,                                     36290000
363000                CARR_LAST_UPD_DTE,                                36300000
363100                CARR_LAST_UPD_TIME,                               36310000
363200                VEND_CART_CT,                                     36320000
363300                VEND_LAST_UPD_DTE,                                36330000
363400                VEND_LAST_UPD_TIME,                               36340000
363500                CRE_TMST,                                         36350000
363600                LAST_UPD_DTE,                                     36360000
363700                LAST_UPD_TIME,                                    36370000
363800                LAST_UPD_USER_ID,                                 36380000
363900                PRIM_SHIPT_IND                                    36390000
364000             ,  SPLT_XMIT_IND                                     36400000
364100             ,  SPLT_XMIT_DTE                                     36410000
364200             ,  SPLT_XMIT_TM                                      36420000
364300             ,  TRN_CDE )                                         36430000
364400         VALUES                                                   36440000
364500              (:SHPTPO-SHIPT-ID,                                  36450000
364600               :SHPTPO-PO-NBR,                                    36460000
364700               :SHPTPO-REC-SEQ-NBR,                               36470000
364800               :SHPTPO-EXPTED-CART-CNT,                           36480000
364900               :SHPTPO-ACTL-CART-CNT,                             36490000
365000               :SHPTPO-DMG-CART-CNT,                              36500000
365100               :SHPTPO-PKSL-IND,                                  36510000
365200               :SHPTPO-VEND-NAME,                                 36520000
365300               :SHPTPO-FRGT-CHG-AMT,                              36530000
365400               :SHPTPO-LAST-UPD-PGM-ID,                           36540000
365500               :SHPTPO-CRE-USER-ID,                               36550000
365600               :SHPTPO-CARR-CART-CT,                              36560000
365700               :SHPTPO-CARR-LAST-UPD-DTE,                         36570000
365800               :SHPTPO-CARR-LAST-UPD-TIME,                        36580000
365900               :SHPTPO-VEND-CART-CT,                              36590000
366000               :SHPTPO-VEND-LAST-UPD-DTE,                         36600000
366100               :SHPTPO-VEND-LAST-UPD-TIME,                        36610000
366200               :SHPTPO-CRE-TMST,                                  36620000
366300               :SHPTPO-LAST-UPD-DTE,                              36630000
366400               :SHPTPO-LAST-UPD-TIME,                             36640000
366500               :SHPTPO-LAST-UPD-USER-ID,                          36650000
366600               :SHPTPO-PRIM-SHIPT-IND                             36660000
366700            ,  :SHPTPO-SPLT-XMIT-IND                              36670000
366800            ,  :SHPTPO-SPLT-XMIT-DTE                              36680000
366900            ,  :SHPTPO-SPLT-XMIT-TM                               36690000
367000            ,  :AUSHPO-TRN-CDE )                                  36700000
367100     END-EXEC.                                                    36710000
367200                                                                  36720000
367300     EVALUATE TRUE                                                36730000
367400         WHEN SQLCODE = ZERO                                      36740000
367500             CONTINUE                                             36750000
367600                                                                  36760000
367700         WHEN SQLWARN0 NOT = SPACE                                36770000
367800         WHEN SQLCODE  NOT = +0                                   36780000
367900              MOVE '5400-AUDIT-SHPTPO'                            36790000
368000                               TO DP013-PARAGRAPH                 36800000
368100              MOVE 'INSERT TAUSHPO DATA'                          36810000
368200                               TO DP013-MESSAGE-TEXT (1)          36820000
368300              MOVE SQLCA       TO DP013-SQLCA                     36830000
368400              MOVE 'TAUSHPO'   TO DP013-DB2-TABLE-NAME (1)        36840000
368500              SET DP013-DB2-ABEND                                 36850000
368600                               TO TRUE                            36860000
368700              PERFORM DP013-0000-PROCESS-ABEND                    36870000
368800     END-EVALUATE.                                                36880000
368900                                                                  36890000
369000 EJECT                                                            36900000
369100 5500-SELECT-RECEIVER.                                            36910000
369200                                                                  36920000
369300     EXEC SQL                                                     36930000
369400        SELECT A.ORD_NBR                                          36940000
369500              ,A.REC_SEQ_NBR                                      36950000
369600              ,A.CRE_TMST                                         36960000
369700              ,A.CRE_UID                                          36970000
369800              ,A.PO_VER_NBR                                       36980000
369900              ,A.OPER_UNT_ID                                      36990000
370000              ,A.FCLTY_ID                                         37000000
370100              ,A.STATUS_CDE                                       37010000
370200              ,A.SYST_CRE_CDE                                     37020000
370300              ,A.REC_TYP_CDE                                      37030000
370400              ,A.VER_STATUS_CDE                                   37040000
370500              ,A.PACK_BY_ST_IND                                   37050000
370600              ,A.REC_TMST                                         37060000
370700              ,A.EXPTED_CART_CNT                                  37070000
370800              ,A.ACTL_CART_CNT                                    37080000
370900              ,A.EXPTED_ITM_QTY                                   37090000
371000              ,A.ACTL_ITM_QTY                                     37100000
371100              ,A.RCVR_NBR                                         37110000
371200              ,A.ML_POST_TMST                                     37120000
371300              ,A.FS_POST_TMST                                     37130000
371400              ,A.PRE_TKT_IND                                      37140000
371500              ,A.AD_INFO_DESC                                     37150000
371600              ,A.IN_TRBL_TMST                                     37160000
371700              ,A.IN_TRBL_MIN_CNT                                  37170000
371800              ,A.IN_TRBL_HOUR_CNT                                 37180000
371900              ,A.VERFYD_TMST                                      37190000
372000              ,A.RCVG_CLERK_INIT_ID                               37200000
372100              ,A.REFER_BACK_SEQ_NBR                               37210000
372200              ,A.AP_PRC_CDE                                       37220000
372300              ,A.AP_PRC_DTE                                       37230000
372400              ,A.MIS_DIRECT_IND                                   37240000
372500              ,A.IMPRT_IND                                        37250000
372600              ,A.CRE_OPER_UNT_ID                                  37260000
372700              ,A.CRE_FCLTY_ID                                     37270000
372800              ,A.CURR_OPER_UNT_ID                                 37280000
372900              ,A.CURR_FCLTY_ID                                    37290000
373000              ,A.UPD_TMST                                         37300000
373100              ,A.UPD_UID                                          37310000
373200              ,A.UPD_PGM_ID                                       37320000
373300              ,A.APRON_LOC_DESC                                   37330000
373400              ,A.MKNG_APRN_PRT_TMST                               37340000
373500              ,A.GOH_IND                                          37350000
373600              ,A.VRFD_USR_ID                                      37360000
373700          INTO :RECEIV-ORD-NBR                                    37370000
373800              ,:RECEIV-REC-SEQ-NBR                                37380000
373900              ,:RECEIV-CRE-TMST                                   37390000
374000              ,:RECEIV-CRE-UID                                    37400000
374100              ,:RECEIV-PO-VER-NBR                                 37410000
374200              ,:RECEIV-OPER-UNT-ID                                37420000
374300              ,:RECEIV-FCLTY-ID                                   37430000
374400              ,:RECEIV-STATUS-CDE                                 37440000
374500              ,:RECEIV-SYST-CRE-CDE                               37450000
374600              ,:RECEIV-REC-TYP-CDE                                37460000
374700              ,:RECEIV-VER-STATUS-CDE                             37470000
374800              ,:RECEIV-PACK-BY-ST-IND                             37480000
374900              ,:RECEIV-REC-TMST                                   37490000
375000              ,:RECEIV-EXPTED-CART-CNT                            37500000
375100              ,:RECEIV-ACTL-CART-CNT                              37510000
375200              ,:RECEIV-EXPTED-ITM-QTY                             37520000
375300              ,:RECEIV-ACTL-ITM-QTY                               37530000
375400              ,:RECEIV-RCVR-NBR                                   37540000
375500              ,:RECEIV-ML-POST-TMST                               37550000
375600              ,:RECEIV-FS-POST-TMST                               37560000
375700              ,:RECEIV-PRE-TKT-IND                                37570000
375800              ,:RECEIV-AD-INFO-DESC                               37580000
375900              ,:RECEIV-IN-TRBL-TMST                               37590000
376000              ,:RECEIV-IN-TRBL-MIN-CNT                            37600000
376100              ,:RECEIV-IN-TRBL-HOUR-CNT                           37610000
376200              ,:RECEIV-VERFYD-TMST                                37620000
376300              ,:RECEIV-RCVG-CLERK-INIT-ID                         37630000
376400              ,:RECEIV-REFER-BACK-SEQ-NBR                         37640000
376500              ,:RECEIV-AP-PRC-CDE                                 37650000
376600              ,:RECEIV-AP-PRC-DTE                                 37660000
376700              ,:RECEIV-MIS-DIRECT-IND                             37670000
376800              ,:RECEIV-IMPRT-IND                                  37680000
376900              ,:RECEIV-CRE-OPER-UNT-ID                            37690000
377000              ,:RECEIV-CRE-FCLTY-ID                               37700000
377100              ,:RECEIV-CURR-OPER-UNT-ID                           37710000
377200              ,:RECEIV-CURR-FCLTY-ID                              37720000
377300              ,:RECEIV-UPD-TMST                                   37730000
377400              ,:RECEIV-UPD-UID                                    37740000
377500              ,:RECEIV-UPD-PGM-ID                                 37750000
377600              ,:RECEIV-APRON-LOC-DESC                             37760000
377700              ,:RECEIV-MKNG-APRN-PRT-TMST                         37770000
377800              ,:RECEIV-GOH-IND                                    37780000
377900              ,:RECEIV-VRFD-USR-ID                                37790000
378000          FROM  TRECEIV A                                         37800000
378100         WHERE A.OPER_UNT_ID = :DK-OPER-UNT-ID                    37810000
378200           AND A.FCLTY_ID    = :DK-FCLTY-ID                       37820000
378300           AND A.ORD_NBR     = :DK-PO-NBR                         37830000
378400           AND A.REC_SEQ_NBR = :DK-UPDATE-REC-SEQ-NBR             37840000
378500           AND A.VER_STATUS_CDE = 'A'                             37850000
378600     END-EXEC.                                                    37860000
378700                                                                  37870000
378800     EVALUATE TRUE                                                37880000
378900         WHEN SQLCODE = +0                                        37890000
379000             CONTINUE                                             37900000
379100                                                                  37910000
379200         WHEN SQLCODE = +100                                      37920000
379300             CONTINUE                                             37930000
379400                                                                  37940000
379500         WHEN SQLWARN0 NOT = SPACE                                37950000
379600         WHEN SQLCODE < +0                                        37960000
379700         WHEN SQLCODE > +0                                        37970000
379800             MOVE '5500-SELECT-TRECEIV'                           37980000
379900                               TO DP013-PARAGRAPH                 37990000
380000             MOVE 'SELECT ON TRECEIV'                             38000000
380100                               TO DP013-MESSAGE-TEXT (1)          38010000
380200             MOVE SQLCA        TO DP013-SQLCA                     38020000
380300             MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)        38030000
380400             MOVE 'TSTATCD'    TO DP013-DB2-TABLE-NAME (2)        38040000
380500             SET DP013-DB2-ABEND                                  38050000
380600                               TO TRUE                            38060000
380700             SET DP013-XCTL-DISPLAY-RESTART                       38070000
380800                               TO TRUE                            38080000
380900             PERFORM DP013-0000-PROCESS-ABEND                     38090000
381000     END-EVALUATE.                                                38100000
381100                                                                  38110000
381200/                                                                 38120000
381300/                                                                 38130000
381400                                                                  38140000
381500 5600-UPDATE-RECEIVER.                                            38150000
381600                                                                  38160000
381700     EXEC SQL                                                     38170000
381800       UPDATE TRECEIV                                             38180000
381900           SET   EXPTED_CART_CNT   =  :RECEIV-EXPTED-CART-CNT     38190000
382000                ,ACTL_CART_CNT     =  :RECEIV-ACTL-CART-CNT       38200000
382100                ,UPD_TMST          =  CURRENT TIMESTAMP           38210000
382200                ,UPD_UID           =  :DP020-USERID               38220000
382300                ,UPD_PGM_ID        =  :PC-CURRENT-PROGRAM-NAME    38230000
382400           WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                 38240000
382500             AND FCLTY_ID       = :DK-FCLTY-ID                    38250000
382600             AND ORD_NBR        = :DK-PO-NBR                      38260000
382700             AND REC_SEQ_NBR    = :DK-UPDATE-REC-SEQ-NBR          38270000
382800             AND VER_STATUS_CDE = 'A'                             38280000
382900     END-EXEC.                                                    38290000
383000                                                                  38300000
383100     EVALUATE TRUE                                                38310000
383200         WHEN SQLCODE = +0                                        38320000
383300             CONTINUE                                             38330000
383400                                                                  38340000
383500         WHEN SQLWARN0 NOT = SPACES                               38350000
383600         WHEN SQLCODE < +0                                        38360000
383700         WHEN SQLCODE > +0                                        38370000
383800             MOVE '5600-UPDATE-TRECEIV'                           38380000
383900                               TO DP013-PARAGRAPH                 38390000
384000             MOVE 'ERROR UPDATING TRECEIV'                        38400000
384100                               TO DP013-MESSAGE-TEXT(1)           38410000
384200             MOVE SQLCA        TO DP013-SQLCA                     38420000
384300             MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)        38430000
384400             SET DP013-DB2-ABEND                                  38440000
384500                 DP013-XCTL-DISPLAY-RESTART                       38450000
384600                               TO TRUE                            38460000
384700             PERFORM DP013-0000-PROCESS-ABEND                     38470000
384800     END-EVALUATE.                                                38480000
384900                                                                  38490000
385000 5700-OPEN-SHPTPO-CSR.                                            38500000
385100     EXEC SQL                                                     38510000
385200          OPEN SHPTPO-CSR                                         38520000
385300     END-EXEC.                                                    38530000
385400                                                                  38540000
385500     EVALUATE TRUE                                                38550000
385600         WHEN SQLCODE = ZERO                                      38560000
385700             CONTINUE                                             38570000
385800         WHEN SQLWARN0 NOT = SPACES                               38580000
385900         WHEN SQLCODE < ZERO                                      38590000
386000         WHEN SQLCODE > ZERO                                      38600000
386100             MOVE '5700-OPEN-SHPTPO-CURSOR'                       38610000
386200                               TO DP013-PARAGRAPH                 38620000
386300             MOVE 'OPEN SHPTPO CURSOR - '                         38630000
386400                               TO DP013-MESSAGE-TEXT (1)          38640000
386500             MOVE SQLCA        TO DP013-SQLCA                     38650000
386600             MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (1)        38660000
386700             SET DP013-DB2-ABEND                                  38670000
386800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38680000
386900             PERFORM DP013-0000-PROCESS-ABEND                     38690000
387000     END-EVALUATE.                                                38700000
387100                                                                  38710000
387200 5800-FETCH-SHPTPO-CSR.                                           38720000
387300                                                                  38730000
387400     EXEC SQL                                                     38740000
387500         FETCH  SHPTPO-CSR                                        38750000
387600           INTO :SHPTPO-SHIPT-ID,                                 38760000
387700                :SHPTPO-EXPTED-CART-CNT,                          38770000
387800                :SHPTPO-CARR-CART-CT,                             38780000
387900                :SHPTPO-VEND-CART-CT                              38790000
388000     END-EXEC.                                                    38800000
388100                                                                  38810000
388200     EVALUATE TRUE                                                38820000
388300         WHEN SQLCODE = ZERO                                      38830000
388400             CONTINUE                                             38840000
388500         WHEN SQLCODE = +100                                      38850000
388600             SET PS-END-OF-SHPTPO TO TRUE                         38860000
388700             CONTINUE                                             38870000
388800                                                                  38880000
388900         WHEN SQLWARN0 NOT = SPACE                                38890000
389000         WHEN SQLCODE  NOT = +0                                   38900000
389100              MOVE '5800-FETCH-SHPTPO-CSR'                        38910000
389200                               TO DP013-PARAGRAPH                 38920000
389300              MOVE 'SELECT SHPPTPO DATA'                          38930000
389400                               TO DP013-MESSAGE-TEXT (1)          38940000
389500              MOVE DK-PO-NBR   TO DP013-MESSAGE-TEXT (2)          38950000
389600              MOVE DK-SHIPT-ID TO DP013-MESSAGE-TEXT (3)          38960000
389700              MOVE SQLCA       TO DP013-SQLCA                     38970000
389800              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)        38980000
389900              SET DP013-DB2-ABEND                                 38990000
390000                               TO TRUE                            39000000
390100              PERFORM DP013-0000-PROCESS-ABEND                    39010000
390200     END-EVALUATE.                                                39020000
390300                                                                  39030000
390400 5900-CLOSE-SHPTPO-CSR.                                           39040000
390500     EXEC SQL                                                     39050000
390600         CLOSE SHPTPO-CSR                                         39060000
390700     END-EXEC                                                     39070000
390800                                                                  39080000
390900                                                                  39090000
391000     EVALUATE TRUE                                                39100000
391100         WHEN SQLCODE = ZERO                                      39110000
391200             CONTINUE                                             39120000
391300         WHEN SQLWARN0 NOT = SPACES                               39130000
391400         WHEN SQLCODE < ZERO                                      39140000
391500         WHEN SQLCODE > ZERO                                      39150000
391600             MOVE '5900-CLOSE-SHPTPO-CURSOR'                      39160000
391700                               TO DP013-PARAGRAPH                 39170000
391800             MOVE 'CLOSE SHPTPO CURSOR '                          39180000
391900                               TO DP013-MESSAGE-TEXT (1)          39190000
392000             MOVE SQLCA        TO DP013-SQLCA                     39200000
392100             MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (1)        39210000
392200             SET DP013-DB2-ABEND                                  39220000
392300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39230000
392400             PERFORM DP013-0000-PROCESS-ABEND                     39240000
392500     END-EVALUATE.                                                39250000
392600                                                                  39260000
392700                                                                  39270000
392800 5930-CHECK-TRANSCRIBED.                                          39280000
392900                                                                  39290000
393000     EXEC SQL                                                     39300000
393100        SELECT COUNT(*)                                           39310000
393200          INTO :PV-ACTIVE-RECITMS                                 39320000
393300          FROM  TRECITM                                           39330000
393400         WHERE ORD_NBR         = :DK-PO-NBR                       39340000
393500           AND REC_SEQ_NBR     = :DK-CASEPACK-SEQ-NBR             39350000
393600           AND VER_STATUS_CDE  = :PC-A                            39360000
393700     END-EXEC.                                                    39370000
393800                                                                  39380000
393900     EVALUATE TRUE                                                39390000
394000         WHEN SQLCODE = +0                                        39400000
394100             SET ASC-RCVR-TRNSCRB (PV-ASC-IDX)     TO  TRUE       39410000
394200                                                                  39420000
394300         WHEN SQLCODE = +100                                      39430000
394400             SET ASC-RCVR-NOT-TRNSCRB (PV-ASC-IDX) TO  TRUE       39440000
394500                                                                  39450000
394600         WHEN SQLWARN0 NOT = SPACE                                39460000
394700         WHEN SQLCODE < +0                                        39470000
394800         WHEN SQLCODE > +0                                        39480000
394900             MOVE '5930-CHECK-TRANSCRIBED'                        39490000
395000                               TO DP013-PARAGRAPH                 39500000
395100             MOVE 'COUNT ACTIVE RECITM  '                         39510000
395200                               TO DP013-MESSAGE-TEXT (1)          39520000
395300             MOVE SQLCA        TO DP013-SQLCA                     39530000
395400             MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)        39540000
395500             SET DP013-DB2-ABEND                                  39550000
395600                               TO TRUE                            39560000
395700             SET DP013-XCTL-DISPLAY-RESTART                       39570000
395800                               TO TRUE                            39580000
395900             PERFORM DP013-0000-PROCESS-ABEND                     39590000
396000     END-EVALUATE.                                                39600000
396100                                                                  39610000
396200                                                                  39620000
396300                                                                  39630000
396400 5940-CHECK-CASEPACK-2.                                           39640000
396500                                                                  39650000
396600     EXEC SQL                                                     39660000
396700        SELECT COUNT (*)                                          39670000
396800          INTO :PV-CASEPACK-COUNT                                 39680000
396900          FROM  TDISTHD                                           39690000
397000         WHERE ORD_NBR           = :DK-PO-NBR                     39700000
397100           AND RCVR_SEQ_NBR      = :DK-CASEPACK-SEQ-NBR           39710000
397200           AND TOT_CART_CNT    > 0                                39720000
397300     END-EXEC.                                                    39730000
397400                                                                  39740000
397500     EVALUATE TRUE                                                39750000
397600         WHEN SQLCODE = +0                                        39760000
397700             CONTINUE                                             39770000
397800                                                                  39780000
397900         WHEN SQLCODE = +100                                      39790000
398000             CONTINUE                                             39800000
398100                                                                  39810000
398200         WHEN SQLWARN0 NOT = SPACE                                39820000
398300         WHEN SQLCODE < +0                                        39830000
398400         WHEN SQLCODE > +0                                        39840000
398500             MOVE '5940-CHECK-CASEPACK-2'                         39850000
398600                               TO DP013-PARAGRAPH                 39860000
398700             MOVE 'COUNT CASEPACK SPLITS'                         39870000
398800                               TO DP013-MESSAGE-TEXT (1)          39880000
398900             MOVE SQLCA        TO DP013-SQLCA                     39890000
399000             MOVE 'TDISTHD'    TO DP013-DB2-TABLE-NAME (1)        39900000
399100             SET DP013-DB2-ABEND                                  39910000
399200                               TO TRUE                            39920000
399300             SET DP013-XCTL-DISPLAY-RESTART                       39930000
399400                               TO TRUE                            39940000
399500             PERFORM DP013-0000-PROCESS-ABEND                     39950000
399600     END-EVALUATE.                                                39960000
399700                                                                  39970000
399800                                                                  39980000
399900 5950-CHECK-CASEPACK.                                             39990000
400000                                                                  40000000
400100     EXEC SQL                                                     40010000
400200        SELECT COUNT (*)                                          40020000
400300          INTO :PV-CASEPACK-COUNT                                 40030000
400400          FROM  TRECITM A,                                        40040000
400500                TDISTHD B                                         40050000
400600         WHERE A.ORD_NBR         = :DK-PO-NBR                     40060000
400700           AND A.REC_SEQ_NBR     = :DK-CASEPACK-SEQ-NBR           40070000
400800           AND A.VER_STATUS_CDE  = :PC-A                          40080000
400900           AND A.ORD_NBR         = B.ORD_NBR                      40090000
401000           AND A.ORD_LNE_NBR     = B.ORD_LNE_NBR                  40100000
401100           AND A.REC_SEQ_NBR     = B.RCVR_SEQ_NBR                 40110000
401200           AND B.TOT_CART_CNT    > 0                              40120000
401300     END-EXEC.                                                    40130000
401400                                                                  40140000
401500     EVALUATE TRUE                                                40150000
401600         WHEN SQLCODE = +0                                        40160000
401700             CONTINUE                                             40170000
401800                                                                  40180000
401900         WHEN SQLCODE = +100                                      40190000
402000             CONTINUE                                             40200000
402100                                                                  40210000
402200         WHEN SQLWARN0 NOT = SPACE                                40220000
402300         WHEN SQLCODE < +0                                        40230000
402400         WHEN SQLCODE > +0                                        40240000
402500             MOVE '5950-CHECK-CASEPACK'                           40250000
402600                               TO DP013-PARAGRAPH                 40260000
402700             MOVE 'COUNT CASEPACK SPLITS'                         40270000
402800                               TO DP013-MESSAGE-TEXT (1)          40280000
402900             MOVE SQLCA        TO DP013-SQLCA                     40290000
403000             MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)        40300000
403100             MOVE 'TDISTHD'    TO DP013-DB2-TABLE-NAME (2)        40310000
403200             SET DP013-DB2-ABEND                                  40320000
403300                               TO TRUE                            40330000
403400             SET DP013-XCTL-DISPLAY-RESTART                       40340000
403500                               TO TRUE                            40350000
403600             PERFORM DP013-0000-PROCESS-ABEND                     40360000
403700     END-EVALUATE.                                                40370000
403800                                                                  40380000
403900/                                                                 40390000
404000******************************************************************40400077
404100* CHECK TSHUNLO FOR ACTIVE CARTONS CHECKED-IN                     40410077
404200******************************************************************40420077
404300 5960-ARE-CARTONS-CHECKED-IN.                                     40430077
404400                                                                  40440077
404500     MOVE 0        TO PV-CARTON-COUNT.                            40450077
404600                                                                  40460077
404700     EXEC SQL                                                     40470077
404800          SELECT COUNT (*)                                        40480077
404900            INTO :PV-CARTON-COUNT                                 40490077
405000            FROM TINPKSU A                                        40500077
405100                ,TSHUNLO B                                        40510077
405200                ,TSULBXF C                                        40520077
405300                ,TPKSLIP D                                        40530077
405400                ,TSHUUPC E                                        40540077
405500            WHERE A.PO_NBR        = :DK-PO-NBR                    40550077
405600              AND A.SEQ_NBR       = D.SEQ_NBR                     40560077
405700              AND A.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                40570077
405800              AND A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                40580077
405900              AND B.ACTV_CDE      = 'A'                           40590077
406000              AND B.SCN_LOC_ID    = 'RECV'                        40600077
406100              AND D.PO_NBR        = A.PO_NBR                      40610077
406200              AND D.REC_SEQ_NBR   = :DK-UPDATE-REC-SEQ-NBR        40620079
406300              AND D.VER_STAT_CDE  = 'A'                           40630077
406400              AND D.PKSL_STAT_CDE = 'AC'                          40640077
406500              AND A.SHIPT_UNT_ID  = E.SHIPT_UNT_ID                40650077
406600              AND A.PO_NBR        = E.TRN_NBR                     40660077
406700     END-EXEC                                                     40670077
406800                                                                  40680077
406900     EVALUATE TRUE                                                40690077
407000         WHEN SQLCODE = ZERO                                      40700077
407100              IF PV-CARTON-COUNT > 0                              40710077
407200                  SET PS-CHECKED-IN-FOUND TO TRUE                 40720077
407300              END-IF                                              40730077
407400         WHEN SQLCODE = +100                                      40740077
407500              CONTINUE                                            40750077
407600         WHEN SQLWARN0 NOT = SPACES                               40760077
407700         WHEN SQLCODE  NOT = ZERO                                 40770077
407800              MOVE '5960-ARE-CARTONS-CHECKED-IN'                  40780077
407900                                 TO DP013-PARAGRAPH               40790077
408000              MOVE 'UNSUCCESSFUL CHECK ACTIVE CARTONS '           40800077
408100                                 TO DP013-MESSAGE-TEXT (1)        40810077
408200              MOVE DK-PO-NBR     TO PV-PO-NBR-PIC9                40820080
408300              MOVE DK-UPDATE-REC-SEQ-NBR                          40830080
408400                                 TO PV-REC-SEQ-NBR-PIC9           40840080
408500              STRING ' RCKCS255 - PO: '                           40850077
408600                     PV-PO-NBR-PIC9                               40860080
408700                     ' SEQ NBR: '                                 40870077
408800                     PV-REC-SEQ-NBR-PIC9                          40880080
408900                                      DELIMITED BY SIZE           40890077
409000                               INTO DP013-MESSAGE-TEXT (2)        40900077
409100              MOVE SQLCA TO DP013-SQLCA                           40910077
409200              MOVE 'TINPSKU '    TO DP013-DB2-TABLE-NAME (1)      40920077
409300              MOVE 'TSHUNLO '    TO DP013-DB2-TABLE-NAME (2)      40930077
409400              MOVE 'TSULBXF '    TO DP013-DB2-TABLE-NAME (3)      40940077
409500              SET DP013-DB2-ABEND                                 40950077
409600                  DP013-XCTL-DISPLAY-RESTART                      40960077
409700                                 TO TRUE                          40970077
409800                                                                  40980077
409900              PERFORM DP013-0000-PROCESS-ABEND                    40990077
410000     END-EVALUATE.                                                41000077
410100                                                                  41010077
410200/                                                                 41020000
410300 EJECT                                                            41030000
410400******************************************************************41040000
410500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **41050000
410600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **41060000
410700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **41070000
410800** THE USER.                                                    **41080000
410900******************************************************************41090000
411000 6000-REFRESH-PANEL-FROM-TEMP.                                    41100000
411100     IF  ASC-UPDATE-TSQ                                           41110000
411200         SET ASC-NO-TSQ-UPDATE TO TRUE                            41120000
411300         MOVE ZERO                 TO PV-SAVE-ITEM                41130000
411400                                      PV-SEL-QUEUE-ITEM           41140000
411500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        41150000
411600                                   TO PV-HOLD-SELECTED-ITEMS      41160000
411700         MOVE +1                   TO PV-ITEMS-PROCESSED          41170000
411800         PERFORM 6100-UPDATE-TSQ                                  41180000
411900             UNTIL PV-ITEMS-PROCESSED >                           41190000
412000                                     PV-HOLD-SELECTED-ITEMS       41200000
412100         PERFORM 6010-DELETE-SEL-QUEUE                            41210000
412200         INITIALIZE ASC-BLOCK-ENTRIES (1)                         41220000
412300                    ASC-BLOCK-ENTRIES (2)                         41230000
412400     END-IF.                                                      41240000
412500                                                                  41250000
412600*----------------------------------------------------------------*41260000
412700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *41270000
412800*----------------------------------------------------------------*41280000
412900 6010-DELETE-SEL-QUEUE.                                           41290000
413000                                                                  41300000
413100     EXEC CICS                                                    41310000
413200         DELETEQ TS                                               41320000
413300             QUEUE (ASC-SEL-QUEUE-NAME)                           41330000
413400             RESP  (PV-CICS-RESP)                                 41340000
413500     END-EXEC.                                                    41350000
413600                                                                  41360000
413700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      41370000
413800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         41380000
413900         CONTINUE                                                 41390000
414000     ELSE                                                         41400000
414100         SET DP013-CICS-ABEND TO TRUE                             41410000
414200         SET DP013-NO-ROLLBACK TO TRUE                            41420000
414300         MOVE '6010-DELETE-SEL-QUEUE'                             41430000
414400                        TO DP013-PARAGRAPH                        41440000
414500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         41450000
414600                        TO DP013-MESSAGE-TEXT (1)                 41460000
414700         PERFORM DP013-0000-PROCESS-ABEND                         41470000
414800     END-IF.                                                      41480000
414900                                                                  41490000
415000*----------------------------------------------------------------*41500000
415100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *41510000
415200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *41520000
415300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *41530000
415400*    THE TEMP QUEUE.                                             *41540000
415500*----------------------------------------------------------------*41550000
415600                                                                  41560000
415700 6100-UPDATE-TSQ.                                                 41570000
415800                                                                  41580000
415900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             41590000
416000     PERFORM 6105-READ-SEL-QUEUE.                                 41600000
416100     PERFORM                                                      41610000
416200         VARYING RC013-IDX                                        41620000
416300         FROM 1 BY 1                                              41630000
416400         UNTIL ((PV-ITEMS-PROCESSED >                             41640000
416500                              PV-HOLD-SELECTED-ITEMS)             41650000
416600         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             41660000
416700         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  41670000
416800             PERFORM 6110-PROCESS-ITEMS                           41680000
416900         END-IF                                                   41690000
417000         ADD +1                TO PV-ITEMS-PROCESSED              41700000
417100     END-PERFORM.                                                 41710000
417200     PERFORM 6111-WRITE-LIST-QUEUE.                               41720000
417300*----------------------------------------------------------------*41730000
417400*    READ THE LIST QUEUE RECORD.                                 *41740000
417500*----------------------------------------------------------------*41750000
417600                                                                  41760000
417700 6105-READ-SEL-QUEUE.                                             41770000
417800                                                                  41780000
417900     EXEC CICS                                                    41790000
418000          READQ TS                                                41800000
418100              QUEUE (ASC-SEL-QUEUE-NAME)                          41810000
418200              INTO  (RC013-DC-SELECT-RECORD)                      41820000
418300              ITEM  (PV-SEL-QUEUE-ITEM)                           41830000
418400              RESP  (PV-CICS-RESP)                                41840000
418500     END-EXEC.                                                    41850000
418600                                                                  41860000
418700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          41870000
418800         CONTINUE                                                 41880000
418900     ELSE                                                         41890000
419000         SET DP013-CICS-ABEND      TO  TRUE                       41900000
419100         SET DP013-NO-ROLLBACK     TO  TRUE                       41910000
419200         MOVE '6105-READ-SEL-QUEUE'                               41920000
419300                                   TO  DP013-PARAGRAPH            41930000
419400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           41940000
419500                                   TO  DP013-MESSAGE-TEXT(1)      41950000
419600         PERFORM DP013-0000-PROCESS-ABEND                         41960000
419700     END-IF.                                                      41970000
419800 EJECT                                                            41980000
419900*----------------------------------------------------------------*41990000
420000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*42000000
420100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*42010000
420200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *42020000
420300*----------------------------------------------------------------*42030000
420400                                                                  42040000
420500 6110-PROCESS-ITEMS.                                              42050000
420600                                                                  42060000
420700     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          42070000
420800                     / PC-ITEMS-PER-PANEL).                       42080000
420900                                                                  42090000
421000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           42100000
421100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          42110000
421200             PERFORM 6111-WRITE-LIST-QUEUE                        42120000
421300         END-IF                                                   42130000
421400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    42140000
421500                                                                  42150000
421600         PERFORM 6112-READ-LIST-QUEUE                             42160000
421700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               42170000
421800             CONTINUE                                             42180000
421900         END-IF                                                   42190000
422000     END-IF.                                                      42200000
422100                                                                  42210000
422200     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     42220000
422300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              42230000
422400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         42240000
422500     MOVE LQW-SELECTED-SW (PV-SUB)                                42250000
422600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  42260000
422700     EVALUATE TRUE                                                42270000
422800         WHEN RC013-INQ (RC013-IDX)                               42280000
422900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             42290000
423000                                                                  42300000
423100         WHEN RC013-UPD (RC013-IDX)                               42310000
423200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             42320000
423300                                                                  42330000
423400         WHEN RC013-DEL (RC013-IDX)                               42340000
423500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             42350000
423600                                                                  42360000
423700         WHEN RC013-ERR (RC013-IDX)                               42370000
423800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             42380000
423900     END-EVALUATE.                                                42390000
424000                                                                  42400000
424100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                42410000
424200                                                                  42420000
424300*----------------------------------------------------------------*42430000
424400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *42440000
424500*----------------------------------------------------------------*42450000
424600                                                                  42460000
424700 6111-WRITE-LIST-QUEUE.                                           42470000
424800                                                                  42480000
424900     EXEC CICS                                                    42490000
425000         WRITEQ TS                                                42500000
425100             QUEUE (ASC-LIST-QUEUE-NAME)                          42510000
425200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     42520000
425300             ITEM  (PV-SAVE-ITEM)                                 42530000
425400             REWRITE                                              42540000
425500             RESP  (PV-CICS-RESP)                                 42550000
425600     END-EXEC.                                                    42560000
425700                                                                  42570000
425800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          42580000
425900         CONTINUE                                                 42590000
426000     ELSE                                                         42600000
426100         SET DP013-CICS-ABEND  TO  TRUE                           42610000
426200         SET DP013-NO-ROLLBACK TO  TRUE                           42620000
426300         MOVE '6111-WRITE-LIST-QUEUE'                             42630000
426400                               TO  DP013-PARAGRAPH                42640000
426500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  42650000
426600                               TO  DP013-MESSAGE-TEXT(1)          42660000
426700         PERFORM DP013-0000-PROCESS-ABEND                         42670000
426800     END-IF.                                                      42680000
426900                                                                  42690000
427000 EJECT                                                            42700000
427100*----------------------------------------------------------------*42710000
427200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*42720000
427300*----------------------------------------------------------------*42730000
427400                                                                  42740000
427500 6112-READ-LIST-QUEUE.                                            42750000
427600                                                                  42760000
427700     EXEC CICS                                                    42770000
427800         READQ TS                                                 42780000
427900             QUEUE (ASC-LIST-QUEUE-NAME)                          42790000
428000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     42800000
428100             ITEM  (PV-ITEM)                                      42810000
428200             RESP  (PV-CICS-RESP)                                 42820000
428300     END-EXEC.                                                    42830000
428400                                                                  42840000
428500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          42850000
428600         CONTINUE                                                 42860000
428700     ELSE                                                         42870000
428800         SET DP013-CICS-ABEND        TO TRUE                      42880000
428900         SET DP013-NO-ROLLBACK       TO TRUE                      42890000
429000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           42900000
429100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    42910000
429200                                     TO DP013-MESSAGE-TEXT(1)     42920000
429300         PERFORM DP013-0000-PROCESS-ABEND                         42930000
429400     END-IF.                                                      42940000
429500                                                                  42950000
429510                                                                  42951090
429520 6200-INSERT-PO-TRACK.                                            42952090
429530                                                                  42953090
429535     MOVE ZEROES                   TO  RCT00017-DEST-LOC-NBR.     42953590
429536     MOVE DP020-USERID             TO  RCT00017-CRE-BY-USR-ID.    42953690
429538     MOVE 'RCKCS265'               TO  RCT00017-CRE-BY-PGM-NM.    42953890
429539     MOVE 0                        TO  RCT00017-PO-LNE-NBR        42953990
429540                                       RCT00017-PREPK-ID          42954090
429541                                       RCT00017-QTY-TRKD-NBR      42954190
429542                                       RCT00017-PKSL-SEQ-NBR.     42954290
429543                                                                  42954390
429551     EXEC SQL                                                     42955190
429552          INSERT INTO RCT_PO_RCVR_TRKG                            42955290
429553                 ( PO_NBR                                         42955390
429554                  ,RCVR_SEQ_NBR                                   42955490
429555                  ,CRE_BY_USR_ID                                  42955590
429556                  ,CRE_TMST                                       42955690
429557                  ,DC_FUNC_CDE                                    42955790
429558                  ,LOC_NBR                                        42955890
429559                  ,PO_LNE_NBR                                     42955990
429560                  ,PREPK_ID                                       42956090
429561                  ,CRE_BY_PGM_NM                                  42956190
429562                  ,QTY_TRKD_NBR                                   42956290
429563                  ,LAST_UPD_TMST                                  42956390
429564                  ,PKSL_SEQ_NBR                                   42956490
429565                  ,DEST_LOC_NBR                                   42956590
429566                  )                                               42956690
429567         VALUES ( :RCT00017-PO-NBR                                42956790
429568                 ,:RCT00017-RCVR-SEQ-NBR                          42956890
429569                 ,:RCT00017-CRE-BY-USR-ID                         42956990
429570                 , CURRENT TIMESTAMP                              42957090
429571                 ,:RCT00017-DC-FUNC-CDE                           42957190
429572                 ,:RCT00017-LOC-NBR                               42957290
429573                 ,:RCT00017-PO-LNE-NBR                            42957390
429574                 ,:RCT00017-PREPK-ID                              42957490
429575                 ,:RCT00017-CRE-BY-PGM-NM                         42957590
429576                 ,:RCT00017-QTY-TRKD-NBR                          42957690
429577                 , CURRENT TIMESTAMP                              42957790
429578                 ,:RCT00017-PKSL-SEQ-NBR                          42957890
429579                 ,:RCT00017-DEST-LOC-NBR                          42957990
429580                 )                                                42958090
429581     END-EXEC.                                                    42958190
429582                                                                  42958290
429583     EVALUATE TRUE                                                42958390
429584         WHEN SQLCODE = +0                                        42958490
429587             CONTINUE                                             42958790
429588                                                                  42958890
429589         WHEN SQLWARN0 NOT = SPACE                                42958990
429590         WHEN SQLCODE < +0                                        42959090
429591         WHEN SQLCODE > +0                                        42959190
429592                                                                  42959290
429593             MOVE RCT00017-LOC-NBR      TO PV-DISP-OPER           42959390
429594             MOVE RCT00017-PO-NBR       TO PV-DISP-PO             42959490
429595             MOVE RCT00017-RCVR-SEQ-NBR TO PV-DISP-RCVR           42959590
429596                                                                  42959690
429597             MOVE '6200-INSERT-PO-TRACK'                          42959790
429598                             TO DP013-PARAGRAPH                   42959890
429599             MOVE 'INSERT PO TRACKING TABLE'                      42959990
429600                             TO DP013-MESSAGE-TEXT (1)            42960090
429601             STRING PV-DISP-OPER '-'                              42960190
429602                    PV-DISP-PO   '-'                              42960290
429603                    PV-DISP-RCVR                                  42960390
429604                    '  FUNC:' RCT00017-DC-FUNC-CDE                42960490
429605                                  DELIMITED BY SIZE               42960590
429606                             INTO DP013-MESSAGE-TEXT (2)          42960690
429607             MOVE SQLCA      TO DP013-SQLCA                       42960790
429608             MOVE 'RCT00017'  TO DP013-DB2-TABLE-NAME (1)         42960890
429609                 SET DP013-DB2-ABEND                              42960990
429610                     DP013-XCTL-DISPLAY-RESTART                   42961090
429611                                 TO TRUE                          42961190
429612             PERFORM DP013-0000-PROCESS-ABEND                     42961290
429613     END-EVALUATE.                                                42961390
429614                                                                  42961490
429615                                                                  42961590
429616*----------------------------------------------------------------*42961690
429617*  CHECK IF TROUBLE NEEDS TO TO BE CREATED FOR RECEIVERS CREATED *42961790
429618*  WHERE A PACKSLIP ON THE RECEIVER HAS PRO NUMBER "MIXEDSKU"    *42961890
429619*  JOAN & DC'S REFER TO THIS A RED B SINCE THE BULK RECEIVERS    *42961990
429620*  ARE HIGHLIGHTED IN RED IF THEY HAVE "MIXEDSKU" PRO NBR        *42962090
429621*                                                                *42962190
429622*  - CHECK PARM IF THIS PROCESS IS BEING EXECUTED                *42962290
429623*    Y/N PARM ON TKRPRPM - PROTR1 - AT DC LEVEL                  *42962390
429624*    (PRO NUMBER TROUBLE CHECK)                                  *42962490
429625*    6310-CHECK-PROTR1                                           *42962590
429626*                                                                *42962690
429627*  - CHECK PARM IF THIS DC IS CHECKING AT PRO LEVEL              *42962790
429628*    Y/N PARM ON TKRPRPM - AUTRB3                                *42962890
429629*    THIS WILL MATCH SIMILAR LOGIC FROM RCKCS234                 *42962990
429630*    6320-CHECK-AUTRB3                                           *42963090
429631*                                                                *42963190
429632*  - CHECK IF ANY OF THE PACKSLIPS THAT ARE ATTACHED TO THE      *42963290
429633*    RECEIVER HAVE A MATCHING PRO NUMBER THAT IS SHOWN IN        *42963390
429634*    PARM AUTRBL03 - NOTE ONLY THE FIRST 8 CHARACTERS OF THE     *42963490
429635*    PRO NUMBER WILL BE CHECKED                                  *42963590
429636*    6330-CHECK-AUTRBL03                                         *42963690
429637*                                                                *42963790
429638*  - CHECK THE CONTROL FLOW PARM = CNTLFLOW TO SEE WHAT TROUBLE  *42963890
429639*    CODE SHOULD BE CREATED                                      *42963990
429640*    6340-CHECK-CNTLFLOW                                         *42964090
429641*                                                                *42964190
429642*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *42964290
429643*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *42964390
429644*    6350-CHECK-PRO-TRBL                                         *42964490
429645*                                                                *42964590
429646*  - CREATE NEW RECEIVER LEVEL TROUBLE                           *42964690
429647*    6360-CREATE-PRO-TRBL                                        *42964790
429648*----------------------------------------------------------------*42964890
429649 6300-CHECK-MIXEDSKU-PKSLIP.                                      42964990
429653* DMH - TEST ONLY - BEGIN                                         42965390
429654*     INITIALIZE PV-CICS-MSG-AREA                                 42965499
429655*     STRING ' RCKCS265-'                                         42965599
429656*            '6300-CHECK-MIXEDSKU-PKSLIP'                         42965699
429657*                                  DELIMITED BY SIZE              42965799
429658*                             INTO PV-CICS-MSG-AREA               42965899
429659*     PERFORM 9903-WRITE-CICS-LOG                                 42965999
429660* DMH - TEST ONLY - END                                           42966090
429661                                                                  42966199
429662     MOVE ASC-KEY-PO-NBR          TO DK-PROTRBL-PO                42966298
429663     MOVE ASC-KEY-REC-SEQ-NBR     TO DK-PROTRBL-RCVR              42966398
429664     MOVE ASC-KEY-OPER-UNT-ID-N   TO DK-PROTRBL-OPER              42966498
429665                                                                  42966590
429666     SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE.                       42966690
429667                                                                  42966790
429668     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42966890
429669         PERFORM 6310-CHECK-PROTR1                                42966990
429670     END-IF.                                                      42967090
429671                                                                  42967190
429672     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42967290
429673         PERFORM 6320-CHECK-AUTRB3                                42967390
429674     END-IF.                                                      42967490
429675                                                                  42967590
429676     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42967690
429677         PERFORM 6330-CHECK-AUTRBL03                              42967790
429678     END-IF.                                                      42967890
429679                                                                  42967990
429680     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42968090
429681         PERFORM 6340-CHECK-CNTLFLOW                              42968190
429682     END-IF.                                                      42968290
429683                                                                  42968390
429684     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42968490
429685         PERFORM 6350-CHECK-DC-EFC                                42968590
429686     END-IF.                                                      42968690
429687                                                                  42968790
429688     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42968890
429689         PERFORM 6360-CHECK-PRO-TRBL                              42968990
429690     END-IF.                                                      42969090
429691                                                                  42969190
429692     IF  PS-PRO-LEVEL-TRBL-CHECK                                  42969290
429693         PERFORM 6370-CREATE-PRO-TRBL                             42969390
429694     END-IF.                                                      42969490
429695                                                                  42969590
429696                                                                  42969690
429697*----------------------------------------------------------------*42969790
429698*  - CHECK PARM IF THIS PROCESS IS BEING EXECUTED                *42969890
429699*    Y/N PARM ON TKRPRPM - PROTR1 - AT DC LEVEL                  *42969990
429700*    (PRO NUMBER TROUBLE CHECK)                                  *42970090
429701*----------------------------------------------------------------*42970190
429704 6310-CHECK-PROTR1.                                               42970490
429705                                                                  42970599
429706* DMH - TEST ONLY - BEGIN                                         42970690
429707*     INITIALIZE PV-CICS-MSG-AREA                                 42970799
429708*     STRING ' RCKCS265-'                                         42970899
429709*            '6310-CHECK-PROTR1'                                  42970999
429710*                                  DELIMITED BY SIZE              42971099
429711*                             INTO PV-CICS-MSG-AREA               42971199
429712*     PERFORM 9903-WRITE-CICS-LOG                                 42971299
429713* DMH - TEST ONLY - END                                           42971390
429714                                                                  42971490
429715     MOVE 'N'  TO PS-PROTR1-SW.                                   42971590
429716                                                                  42971690
429717     EXEC SQL                                                     42971790
429718          SELECT   FUNC_TXT                                       42971890
429719            INTO  :KRPRPM-FUNC-TXT                                42971990
429720            FROM                                                  42972090
429721                  TKRPRPM A                                       42972190
429722            WHERE                                                 42972290
429723                  LOC_ID            = :DK-PROTRBL-OPER            42972398
429724              AND SYS_PRC_FUNC_CDE  = 'PROTR1'                    42972490
429725              AND FUNC_PRC_STAT_CDE = 'AC'                        42972590
429726              AND INTFC_SYS_CDE     = 'KHL'                       42972690
429727              AND FUNC_TXT          = 'Y'                         42972790
429728              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           42972890
429729              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           42972990
429730             WITH UR                                              42973090
429731     END-EXEC.                                                    42973190
429732                                                                  42973290
429733     EVALUATE TRUE                                                42973390
429734         WHEN SQLCODE = ZERO                                      42973490
429735              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               42973590
429736                                                                  42973690
429737         WHEN SQLCODE = +100                                      42973790
429738              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42973890
429739                                                                  42973990
429740         WHEN SQLWARN0 NOT = SPACES                               42974090
429741         WHEN SQLCODE  NOT = ZERO                                 42974190
429742              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42974290
429743              MOVE 'PARM PROTR1 ' TO DP013-MESSAGE-TEXT (1)       42974390
429744              MOVE 'RCKCS265'          TO DP013-PROGRAM           42974490
429745              MOVE '6310-CHECK-PROTR1' TO DP013-PARAGRAPH         42974590
429746              MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)     42974690
429747              SET DP013-DB2-ABEND                                 42974790
429748                                 TO TRUE                          42974890
429749              SET DP013-XCTL-DISPLAY-RESTART                      42974990
429750                                 TO TRUE                          42975090
429751              PERFORM DP013-0000-PROCESS-ABEND                    42975190
429752     END-EVALUATE.                                                42975290
429753                                                                  42975390
429754                                                                  42975490
429755*----------------------------------------------------------------*42975590
429756*  - CHECK PARM IF THIS DC IS CHECKING AT PRO LEVEL              *42975690
429757*    Y/N PARM ON TKRPRPM - AUTRB3                                *42975790
429758*    THIS WILL MATCH SIMILAR LOGIC FROM RCKCS234                 *42975890
429759*----------------------------------------------------------------*42975990
429760 6320-CHECK-AUTRB3.                                               42976090
429761                                                                  42976199
429762* DMH - TEST ONLY - BEGIN                                         42976290
429763*     INITIALIZE PV-CICS-MSG-AREA                                 42976399
429764*     STRING ' RCKCS265-'                                         42976499
429765*            '6320-CHECK-AUTRB3'                                  42976599
429766*                                  DELIMITED BY SIZE              42976699
429767*                             INTO PV-CICS-MSG-AREA               42976799
429768*     PERFORM 9903-WRITE-CICS-LOG                                 42976899
429769* DMH - TEST ONLY - END                                           42976990
429770                                                                  42977090
429771     MOVE 'N'  TO PS-AUTRB3-SW.                                   42977190
429772                                                                  42977290
429773     EXEC SQL                                                     42977390
429774          SELECT   FUNC_TXT                                       42977490
429775            INTO  :KRPRPM-FUNC-TXT                                42977590
429776            FROM                                                  42977690
429777                  TKRPRPM A                                       42977790
429778            WHERE                                                 42977890
429779                  LOC_ID            = :DK-PROTRBL-OPER            42977998
429780              AND SYS_PRC_FUNC_CDE  = 'AUTRB3'                    42978090
429781              AND FUNC_PRC_STAT_CDE = 'AC'                        42978190
429782              AND INTFC_SYS_CDE     = 'KHL'                       42978290
429783              AND FUNC_TXT          = 'Y'                         42978390
429784              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           42978490
429785              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           42978590
429786             WITH UR                                              42978690
429787     END-EXEC.                                                    42978790
429788                                                                  42978890
429789     EVALUATE TRUE                                                42978990
429790         WHEN SQLCODE = ZERO                                      42979090
429791              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               42979190
429792                                                                  42979290
429793         WHEN SQLCODE = +100                                      42979390
429794              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42979490
429795                                                                  42979590
429796         WHEN SQLWARN0 NOT = SPACES                               42979690
429797         WHEN SQLCODE  NOT = ZERO                                 42979790
429798              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42979890
429799              MOVE 'PARM AUTRB3 ' TO DP013-MESSAGE-TEXT (1)       42979990
429800              MOVE 'RCKCS265'          TO DP013-PROGRAM           42980090
429801              MOVE '6320-CHECK-AUTRB3' TO DP013-PARAGRAPH         42980190
429802              MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)     42980290
429803              SET DP013-DB2-ABEND                                 42980390
429804                                 TO TRUE                          42980490
429805              SET DP013-XCTL-DISPLAY-RESTART                      42980590
429806                                 TO TRUE                          42980690
429807              PERFORM DP013-0000-PROCESS-ABEND                    42980790
429808     END-EVALUATE.                                                42980890
429809                                                                  42980990
429810                                                                  42981090
429811*----------------------------------------------------------------*42981190
429812*  - CHECK IF ANY OF THE PACKSLIPS THAT ARE ATTACHED TO THE      *42981290
429813*    RECEIVER HAVE A MATCHING PRO NUMBER THAT IS SHOWN IN        *42981390
429814*    PARM AUTRBL03 - NOTE ONLY THE FIRST 8 CHARACTERS OF THE     *42981490
429815*    PRO NUMBER WILL BE CHECKED                                  *42981590
429816*----------------------------------------------------------------*42981690
429817 6330-CHECK-AUTRBL03.                                             42981790
429818                                                                  42981899
429819* DMH - TEST ONLY - BEGIN                                         42981990
429820*     INITIALIZE PV-CICS-MSG-AREA                                 42982099
429821*     STRING ' RCKCS265-'                                         42982199
429822*            '6330-CHECK-AUTRBL03'                                42982299
429823*                                  DELIMITED BY SIZE              42982399
429824*                             INTO PV-CICS-MSG-AREA               42982499
429825*     PERFORM 9903-WRITE-CICS-LOG                                 42982599
429826* DMH - TEST ONLY - END                                           42982690
429827                                                                  42982790
429828     MOVE ZEROES  TO  PV-AUTRBL03-NBR.                            42982890
429829                                                                  42982990
429830     EXEC SQL                                                     42983090
429831          SELECT  D.ATTR_ELEM_NBR                                 42983190
429832            INTO :PV-AUTRBL03-NBR                                 42983290
429833            FROM                                                  42983390
429834                  WST_INTGRTN_TYP A                               42983490
429835                , WST_ATTR_DEFN B                                 42983590
429836                , WST_ATTR_ELEM C                                 42983690
429837                , WST_ATTR_ELEM D                                 42983790
429838                , WST_ATTR_ELEM E                                 42983890
429839                , WST_ATTR_ELEM F                                 42983990
429840                , WST_ATTR_ELEM G                                 42984090
429841                , TPKSLIP H                                       42984190
429842            WHERE                                                 42984290
429843                  A.INTGRTN_TYP_CDE   = 'AUTRBL03'                42984390
429844              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         42984490
429845              AND B.ATTR_DEFN_SEQ_NBR = 1                         42984590
429846              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         42984690
429847              AND C.ATTR_DEFN_SEQ_NBR = 1                         42984790
429848              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         42984890
429849              AND D.ATTR_DEFN_SEQ_NBR = 2                         42984990
429850              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         42985090
429851              AND E.ATTR_DEFN_SEQ_NBR = 3                         42985190
429852              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         42985290
429853              AND F.ATTR_DEFN_SEQ_NBR = 4                         42985390
429854              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         42985490
429855              AND G.ATTR_DEFN_SEQ_NBR = 5                         42985590
429856              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       42985690
429857              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       42985790
429858              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       42985890
429859              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       42985990
429860              AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         42986090
429861              AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         42986190
429862              AND H.PO_NBR            = :DK-PROTRBL-PO            42986298
429863              AND H.REC_SEQ_NBR       = :DK-PROTRBL-RCVR          42986398
429864              AND H.VER_STAT_CDE      = 'A'                       42986490
429865              AND H.PKSL_STAT_CDE     = 'AC'                      42986590
429866              AND SUBSTR(CHAR(H.PRO_NBR),1,G.ATTR_ELEM_NBR)       42986690
429867                  = C.ATTR_ELEM_TXT                               42986790
429868             WITH UR                                              42986890
429869     END-EXEC.                                                    42986990
429870                                                                  42987090
429871     EVALUATE TRUE                                                42987190
429872         WHEN SQLCODE = ZERO                                      42987290
429873              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               42987390
429874                                                                  42987490
429875         WHEN SQLCODE = +100                                      42987590
429876              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42987690
429877                                                                  42987790
429878         WHEN SQLWARN0 NOT = SPACES                               42987890
429879         WHEN SQLCODE  NOT = ZERO                                 42987990
429880              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42988090
429881              MOVE 'PARM AUTRBL03 ' TO DP013-MESSAGE-TEXT (1)     42988190
429882              MOVE 'RCKCS265'          TO DP013-PROGRAM           42988290
429883              MOVE '6330-CHECK-AUTRBL03' TO DP013-PARAGRAPH       42988390
429884              MOVE 'WST PARM    ' TO DP013-DB2-TABLE-NAME (1)     42988490
429885              SET DP013-DB2-ABEND                                 42988590
429886                                 TO TRUE                          42988690
429887              SET DP013-XCTL-DISPLAY-RESTART                      42988790
429888                                 TO TRUE                          42988890
429889              PERFORM DP013-0000-PROCESS-ABEND                    42988990
429890     END-EVALUATE.                                                42989090
429891                                                                  42989199
429892* DMH - TEST ONLY - BEGIN                                         42989290
429893*     INITIALIZE PV-CICS-MSG-AREA                                 42989399
429894*     MOVE PV-AUTRBL03-NBR  TO  PV-DISP-AUTRBL03-NBR              42989499
429895*     MOVE SQLCODE          TO  PV-DISP-SQL                       42989599
429896*     STRING ' RCKCS265-'                                         42989699
429897*            '6330-CHECK-AUTRBL03  '                              42989799
429898*            'SQL:' PV-DISP-SQL  '  '                             42989899
429899*            'ATTRBL03-NBR:' PV-DISP-AUTRBL03-NBR                 42989999
429900*                                  DELIMITED BY SIZE              42990099
429901*                             INTO PV-CICS-MSG-AREA               42990199
429902*     PERFORM 9903-WRITE-CICS-LOG.                                42990299
429903* DMH - TEST ONLY - END                                           42990390
429904                                                                  42990490
429905                                                                  42990590
429906*----------------------------------------------------------------*42990690
429907*  - CHECK THE CONTROL FLOW PARM = CNTLFLOW TO SEE WHAT TROUBLE  *42990790
429908*    CODE SHOULD BE CREATED                                      *42990890
429909*----------------------------------------------------------------*42990990
429910 6340-CHECK-CNTLFLOW.                                             42991090
429911                                                                  42991199
429912* DMH - TEST ONLY - BEGIN                                         42991290
429913*     INITIALIZE PV-CICS-MSG-AREA                                 42991399
429914*     STRING ' RCKCS265-'                                         42991499
429915*            '6340-CHECK-CNTLFLOW'                                42991599
429916*                                  DELIMITED BY SIZE              42991699
429917*                             INTO PV-CICS-MSG-AREA               42991799
429918*     PERFORM 9903-WRITE-CICS-LOG                                 42991899
429919* DMH - TEST ONLY - END                                           42991990
429920                                                                  42992090
429921     MOVE ZEROES TO PV-CNTLFLOW-TRBRSN.                           42992190
429922     MOVE SPACES TO PS-CREATE-DC-EFC-LVL-SW.                      42992290
429923                                                                  42992390
429924     EXEC SQL                                                     42992490
429925          SELECT D.ATTR_ELEM_NBR                                  42992590
429926               , E.ATTR_ELEM_TXT                                  42992690
429927            INTO :PV-CNTLFLOW-TRBRSN                              42992790
429928               , :PS-CREATE-DC-EFC-LVL-SW                         42992890
429929            FROM                                                  42992990
429930                 WST_INTGRTN_TYP A                                42993090
429931               , WST_ATTR_DEFN B                                  42993190
429932               , WST_ATTR_ELEM C                                  42993290
429933               , WST_ATTR_ELEM D                                  42993390
429934               , WST_ATTR_ELEM E                                  42993490
429935            WHERE                                                 42993590
429936                  A.INTGRTN_TYP_CDE   =  'CNTLFLOW'               42993690
429937              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         42993790
429938              AND B.ATTR_DEFN_SEQ_NBR = 1                         42993890
429939              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         42993990
429940              AND C.ATTR_DEFN_SEQ_NBR = 1                         42994090
429941              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         42994190
429942              AND D.ATTR_DEFN_SEQ_NBR = 2                         42994290
429943              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         42994390
429944              AND E.ATTR_DEFN_SEQ_NBR = 3                         42994490
429945              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       42994590
429946              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       42994690
429947              AND C.ATTR_ELEM_NBR     = :PV-AUTRBL03-NBR          42994790
429948             WITH UR                                              42994890
429949     END-EXEC.                                                    42994990
429950                                                                  42995090
429951     EVALUATE TRUE                                                42995190
429952         WHEN SQLCODE = ZERO                                      42995290
429953              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               42995390
429954                                                                  42995490
429955         WHEN SQLCODE = +100                                      42995590
429956              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42995690
429957                                                                  42995790
429958         WHEN SQLWARN0 NOT = SPACES                               42995890
429959         WHEN SQLCODE  NOT = ZERO                                 42995990
429960              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            42996090
429961              MOVE 'PARM CNTLFLOW' TO DP013-MESSAGE-TEXT (1)      42996190
429962              MOVE 'RCKCS265'          TO DP013-PROGRAM           42996290
429963              MOVE '6340-CHECK-CNTLFLOW' TO DP013-PARAGRAPH       42996390
429964              MOVE 'WST PARM    ' TO DP013-DB2-TABLE-NAME (1)     42996490
429965              SET DP013-DB2-ABEND                                 42996590
429966                                 TO TRUE                          42996690
429967              SET DP013-XCTL-DISPLAY-RESTART                      42996790
429968                                 TO TRUE                          42996890
429969              PERFORM DP013-0000-PROCESS-ABEND                    42996990
429970     END-EVALUATE.                                                42997090
429971                                                                  42997190
429972                                                                  42997299
429973* DMH - TEST ONLY - BEGIN                                         42997390
429974*     INITIALIZE PV-CICS-MSG-AREA                                 42997499
429975*     MOVE PV-CNTLFLOW-TRBRSN      TO PV-DISP-TRBRSN              42997599
429976*     MOVE SQLCODE          TO  PV-DISP-SQL                       42997699
429977*     STRING ' RCKCS265-'                                         42997799
429978*            '6340-CHECK-CNTLFLOW  '                              42997899
429979*            'SQL:' PV-DISP-SQL  '  '                             42997999
429980*            'TRBL:' PV-DISP-TRBRSN '  '                          42998099
429981*            'LEVEL:' PS-CREATE-DC-EFC-LVL-SW                     42998199
429982*                                  DELIMITED BY SIZE              42998299
429983*                             INTO PV-CICS-MSG-AREA               42998399
429984*     PERFORM 9903-WRITE-CICS-LOG.                                42998499
429985* DMH - TEST ONLY - END                                           42998590
429986                                                                  42998690
429987                                                                  42998790
429988*----------------------------------------------------------------*42998890
429989*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *42998990
429990*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *42999090
429991*----------------------------------------------------------------*42999190
429992 6350-CHECK-DC-EFC.                                               42999290
429993                                                                  42999399
429994* DMH - TEST ONLY - BEGIN                                         42999490
429995*     INITIALIZE PV-CICS-MSG-AREA                                 42999599
429996*     STRING ' RCKCS265-'                                         42999699
429997*            '6350-CHECK-DC-EFC'                                  42999799
429998*                                  DELIMITED BY SIZE              42999899
429999*                             INTO PV-CICS-MSG-AREA               42999999
430000*     PERFORM 9903-WRITE-CICS-LOG                                 43000099
430001* DMH - TEST ONLY - END                                           43000190
430002                                                                  43000290
430003     MOVE SPACES TO PS-DC-EFC-LOC-SW.                             43000390
430004                                                                  43000490
430005     EXEC SQL                                                     43000590
430006          SELECT   E_BUS_IND                                      43000690
430007            INTO  :PS-DC-EFC-LOC-SW                               43000790
430008            FROM                                                  43000890
430009                  XLT_LOC                                         43000990
430010            WHERE                                                 43001090
430011                  LOC_NBR           = :DK-PROTRBL-OPER            43001198
430012              AND LOC_TYP_CDE       = 'DC'                        43001290
430013              AND OPN_DTE          <=  CURRENT DATE               43001390
430014              AND CLO_DTE          >=  CURRENT DATE               43001490
430015             WITH UR                                              43001590
430016     END-EXEC.                                                    43001690
430017                                                                  43001790
430018     EVALUATE TRUE                                                43001890
430019         WHEN SQLCODE = ZERO                                      43001990
430020              IF  PS-CREATE-BOTH                                  43002090
430021                  SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE             43002190
430022              ELSE                                                43002290
430023                  IF  PS-CREATE-DC-ONLY  AND                      43002390
430024                      PS-DC-LOCATION                              43002490
430025                      SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE         43002590
430026                  ELSE                                            43002690
430027                      IF  PS-CREATE-EFC-ONLY  AND                 43002790
430028                          PS-EFC-LOCATION                         43002890
430029                          SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE     43002990
430030                      ELSE                                        43003090
430031                          SET PS-PRO-LEVEL-TRBL-CHECK-NO TO TRUE  43003190
430032                      END-IF                                      43003290
430033                  END-IF                                          43003390
430034              END-IF                                              43003490
430035                                                                  43003590
430036         WHEN SQLCODE = +100                                      43003690
430037              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            43003790
430038                                                                  43003890
430039         WHEN SQLWARN0 NOT = SPACES                               43003990
430040         WHEN SQLCODE  NOT = ZERO                                 43004090
430041              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            43004190
430042              MOVE 'CHECK DC-EFC' TO DP013-MESSAGE-TEXT (1)       43004290
430043              MOVE 'RCKCS265'          TO DP013-PROGRAM           43004390
430044              MOVE '6350-CHECK-DC-EFC' TO DP013-PARAGRAPH         43004490
430045              MOVE 'XLT_LOC     ' TO DP013-DB2-TABLE-NAME (1)     43004590
430046              SET DP013-DB2-ABEND                                 43004690
430047                                 TO TRUE                          43004790
430048              SET DP013-XCTL-DISPLAY-RESTART                      43004890
430049                                 TO TRUE                          43004990
430050              PERFORM DP013-0000-PROCESS-ABEND                    43005090
430051     END-EVALUATE.                                                43005190
430052                                                                  43005299
430053* DMH - TEST ONLY - BEGIN                                         43005390
430054*     INITIALIZE PV-CICS-MSG-AREA                                 43005499
430055*     STRING ' RCKCS265-'                                         43005599
430056*            '6350-CHECK-DC-EFC  '                                43005699
430057*            'PS-DC-EFC-LOC-SW:' PS-DC-EFC-LOC-SW                 43005799
430058*                                  DELIMITED BY SIZE              43005899
430059*                             INTO PV-CICS-MSG-AREA               43005999
430060*     PERFORM 9903-WRITE-CICS-LOG.                                43006099
430061* DMH - TEST ONLY - END                                           43006190
430062                                                                  43006290
430063                                                                  43006390
430064*----------------------------------------------------------------*43006490
430065*  - CHECK IF RECEIVER ALREADY HAS TROUBLE FOR MIXEDSKU - 434    *43006590
430066*    IF RECEIVER ALREADY HAS THIS TROUBLE DO NOT CREATE AGAIN    *43006690
430067*----------------------------------------------------------------*43006790
430068 6360-CHECK-PRO-TRBL.                                             43006890
430069                                                                  43006999
430070* DMH - TEST ONLY - BEGIN                                         43007090
430071*     INITIALIZE PV-CICS-MSG-AREA                                 43007199
430072*     STRING ' RCKCS265-'                                         43007299
430073*            '6360-CHECK-PRO-TRBL'                                43007399
430074*                                  DELIMITED BY SIZE              43007499
430075*                             INTO PV-CICS-MSG-AREA               43007599
430076*     PERFORM 9903-WRITE-CICS-LOG                                 43007699
430077* DMH - TEST ONLY - END                                           43007790
430078                                                                  43007890
430079     MOVE ZEROES TO PV-HAS-PRO-TRBL-CNT.                          43007990
430080                                                                  43008090
430081     EXEC SQL                                                     43008190
430082          SELECT  COUNT(*)                                        43008290
430083            INTO  :PV-HAS-PRO-TRBL-CNT                            43008390
430084            FROM                                                  43008490
430085                  TTRBNTF                                         43008590
430086            WHERE                                                 43008699
430087                  OPER_UNT_ID       = :DK-PROTRBL-OPER            43008798
430088              AND PO_NBR            = :DK-PROTRBL-PO              43008898
430089              AND REC_SEQ_NBR       = :DK-PROTRBL-RCVR            43008998
430090              AND TRBL_RSN_CDE      = :PV-CNTLFLOW-TRBRSN         43009090
430091***           AND RESOLVED_TMST    >=  CURRENT TMST               43009190
430092***           AND ACKNOWLG_TMST    >=  CURRENT TMST               43009290
430093            FETCH FIRST 1 ROW ONLY                                43009390
430094             WITH UR                                              43009490
430095     END-EXEC.                                                    43009590
430096                                                                  43009690
430097     EVALUATE TRUE                                                43009790
430098         WHEN SQLCODE = ZERO                                      43009890
430099              IF  PV-HAS-PRO-TRBL-CNT > 0                         43009990
430100                  SET PS-PRO-LEVEL-TRBL-CHECK-NO TO TRUE          43010090
430101              ELSE                                                43010190
430102                  IF  PV-HAS-PRO-TRBL-CNT = 0                     43010290
430103                     SET PS-PRO-LEVEL-TRBL-CHECK TO TRUE          43010390
430104                  END-IF                                          43010490
430105              END-IF                                              43010590
430106                                                                  43010690
430107         WHEN SQLCODE = +100                                      43010790
430108         WHEN SQLCODE = -305                                      43010890
430109              SET PS-PRO-LEVEL-TRBL-CHECK  TO  TRUE               43010990
430110                                                                  43011090
430111         WHEN SQLWARN0 NOT = SPACES                               43011190
430112         WHEN SQLCODE  NOT = ZERO                                 43011290
430113              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            43011390
430114              MOVE 'CHECK PRO TRBL' TO DP013-MESSAGE-TEXT (1)     43011490
430115              MOVE 'RCKCS265'            TO DP013-PROGRAM         43011590
430116              MOVE '6360-CHECK-PRO-TRBL' TO DP013-PARAGRAPH       43011690
430117              MOVE 'TTRBNTF     ' TO DP013-DB2-TABLE-NAME (1)     43011790
430118              SET DP013-DB2-ABEND                                 43011890
430119                                 TO TRUE                          43011990
430120              SET DP013-XCTL-DISPLAY-RESTART                      43012090
430121                                 TO TRUE                          43012190
430122              PERFORM DP013-0000-PROCESS-ABEND                    43012290
430123     END-EVALUATE.                                                43012390
430124                                                                  43012490
430125                                                                  43012590
430126*----------------------------------------------------------------*43012690
430127*  - CREATE NEW RECEIVER LEVEL TROUBLE                           *43012790
430128*----------------------------------------------------------------*43012890
430129 6370-CREATE-PRO-TRBL.                                            43012990
430130                                                                  43013099
430140* DMH - TEST ONLY - BEGIN                                         43014090
430150*     INITIALIZE PV-CICS-MSG-AREA                                 43015099
430160*     STRING ' RCKCS265-'                                         43016099
430170*            '6370-CREATE-PRO-TRBL'                               43017099
430180*                                  DELIMITED BY SIZE              43018099
430190*                             INTO PV-CICS-MSG-AREA               43019099
430200*     PERFORM 9903-WRITE-CICS-LOG                                 43020099
430201* DMH - TEST ONLY - END                                           43020190
430202                                                                  43020290
430203     MOVE DK-PROTRBL-OPER         TO TM500-OPER-UNT-ID.           43020398
430204     MOVE DK-PROTRBL-PO           TO TM500-PO-NBR.                43020498
430205     MOVE DK-PROTRBL-RCVR         TO TM500-REC-SEQ-NBR.           43020598
430206     MOVE PV-CNTLFLOW-TRBRSN      TO TM500-TRBL-RSN-CDE.          43020690
430207     MOVE ZEROES                  TO TM500-PO-LNE-NBR.            43020790
430208     MOVE 'MIXED SKU CARTONS ON RECEIVER'                         43020890
430209                                  TO TM500-FREEFORM-TEXT.         43020990
430210     SET  TM500-PO-LEVEL                                          43021090
430211          TM500-ADD-DETAILS       TO TRUE.                        43021190
430212                                                                  43021290
430213     EXEC CICS                                                    43021390
430214         LINK PROGRAM  (PC-TMKCS521)                              43021490
430215              COMMAREA (TM500-FIELDS)                             43021590
430216              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    43021690
430217     END-EXEC.                                                    43021790
430218                                                                  43021890
430219     EVALUATE TRUE                                                43021990
430220         WHEN TM500-CALL-SUCCESSFUL                               43022090
430221         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        43022190
430222              CONTINUE                                            43022290
430223                                                                  43022390
430224         WHEN OTHER                                               43022490
430225              MOVE TM500-OPER-UNT-ID  TO PV-DISP-OPER-B           43022590
430226              MOVE TM500-PO-NBR       TO PV-DISP-PO               43022690
430227              MOVE TM500-REC-SEQ-NBR  TO PV-DISP-RCVR             43022790
430228              MOVE TM500-TRBL-RSN-CDE TO PV-DISP-TRBL             43022890
430229              SET PS-PRO-LEVEL-TRBL-CHECK-NO  TO  TRUE            43022990
430230              MOVE 'CREATE MIXED SKU TRBL'                        43023090
430231                                         TO DP013-MESSAGE-TEXT (1)43023190
430232              MOVE SPACES                TO DP013-MESSAGE-TEXT (2)43023290
430233              STRING PV-DISP-OPER-B '-'                           43023390
430234                     PV-DISP-PO '-'                               43023490
430235                     PV-DISP-RCVR '   '                           43023590
430236                     PV-DISP-TRBL           DELIMITED BY SIZE     43023690
430237                                       INTO DP013-MESSAGE-TEXT (2)43023790
430238              MOVE 'RCKCS265'            TO DP013-PROGRAM         43023890
430239              MOVE '6370-CREATE-PRO-TRBL'                         43023990
430240                                         TO DP013-PARAGRAPH       43024090
430241              MOVE 'TTRBNTF     ' TO DP013-DB2-TABLE-NAME (1)     43024190
430242              SET DP013-DB2-ABEND                                 43024290
430243                                 TO TRUE                          43024390
430244              SET DP013-XCTL-DISPLAY-RESTART                      43024490
430245                                 TO TRUE                          43024590
430246              PERFORM DP013-0000-PROCESS-ABEND                    43024690
430247     END-EVALUATE.                                                43024790
430250                                                                  43025090
430251                                                                  43025190
430252*----------------------------------------------------------------*43025290
430253*                                                                *43025390
430254*----------------------------------------------------------------*43025490
430255 7000-DELETE-RECEIVER.                                            43025590
430256     MOVE ASC-RCVR-SEQ-NO (PV-ASC-IDX)                            43025600
430257                                   TO DK-REC-SEQ-NBR              43025700
430258                                                                  43025800
430259     PERFORM 7100-DELETE-WORK-ORDERS.                             43025900
430260     PERFORM 7200-DELETE-PACK-SLIPS.                              43026000
430261     PERFORM 7300-DELETE-RECEIPTS.                                43026100
430262                                                                  43026290
430263     MOVE ZEROES                   TO  RCT00017-DEST-LOC-NBR.     43026399
430264     MOVE DP020-USERID             TO  RCT00017-CRE-BY-USR-ID.    43026499
430265     MOVE 'RCKCS265'               TO  RCT00017-CRE-BY-PGM-NM.    43026599
430266     MOVE 0                        TO  RCT00017-PO-LNE-NBR        43026699
430267                                       RCT00017-PREPK-ID          43026799
430268                                       RCT00017-QTY-TRKD-NBR      43026899
430269                                       RCT00017-PKSL-SEQ-NBR.     43026999
430270     MOVE DK-PO-NBR                TO  RCT00017-PO-NBR.           43027090
430271     MOVE DK-REC-SEQ-NBR           TO  RCT00017-RCVR-SEQ-NBR.     43027190
430272     MOVE DK-OPER-UNT-ID           TO  RCT00017-LOC-NBR.          43027290
430273     MOVE '0B' TO  RCT00017-DC-FUNC-CDE                           43027399
430280     PERFORM 6200-INSERT-PO-TRACK.                                43028090
430300                                                                  43030000
430400/                                                                 43040000
430500*----------------------------------------------------------------*43050000
430600*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *43060000
430700*    WORK ORDER TABLES, TWRKORD AND TWKORIN.                     *43070000
430800*----------------------------------------------------------------*43080000
430900 7100-DELETE-WORK-ORDERS.                                         43090000
431000                                                                  43100000
431100     PERFORM 7105-OPEN-TWRKORD-CSR.                               43110000
431200     PERFORM 7110-SELECT-TWRKORD.                                 43120000
431300                                                                  43130000
431400     PERFORM                                                      43140000
431500         UNTIL PS-END-OF-TWRKORD                                  43150000
431600             PERFORM 7120-SET-WRKORD-INACTIVE                     43160000
431700             PERFORM 7130-INSERT-TWRKORD                          43170000
431800             PERFORM 7150-OPEN-TWKORIN-CSR                        43180000
431900             PERFORM 7160-SELECT-TWKORIN                          43190000
432000                                                                  43200000
432100             PERFORM                                              43210000
432200                 UNTIL PS-END-OF-TWKORIN                          43220000
432300                     PERFORM 7170-SET-TWKORIN-INACTIVE            43230000
432400                     PERFORM 7180-INSERT-TWKORIN                  43240000
432500                     PERFORM 7160-SELECT-TWKORIN                  43250000
432600             END-PERFORM                                          43260000
432700                                                                  43270000
432800             PERFORM 7140-CLOSE-TWKORIN-CSR                       43280000
432900             PERFORM 7110-SELECT-TWRKORD                          43290000
433000     END-PERFORM.                                                 43300000
433100                                                                  43310000
433200     PERFORM 7140-CLOSE-TWRKORD-CSR.                              43320000
433300                                                                  43330000
433400/                                                                 43340000
433500*----------------------------------------------------------------*43350000
433600* OPEN THE WORK ORDER CURSOR                                     *43360000
433700*----------------------------------------------------------------*43370000
433800                                                                  43380000
433900 7105-OPEN-TWRKORD-CSR.                                           43390000
434000                                                                  43400000
434100     EXEC SQL                                                     43410000
434200         OPEN TWRKORD-CSR                                         43420000
434300     END-EXEC.                                                    43430000
434400                                                                  43440000
434500     EVALUATE TRUE                                                43450000
434600         WHEN SQLCODE = +0                                        43460000
434700              SET PS-NOT-END-OF-TWRKORD                           43470000
434800                               TO TRUE                            43480000
434900         WHEN SQLWARN0 NOT = SPACE                                43490000
435000         WHEN SQLCODE  NOT = +0                                   43500000
435100              MOVE '7105-OPEN-TWRKORD-CSR'                        43510000
435200                               TO DP013-PARAGRAPH                 43520000
435300              MOVE 'OPEN TWRKORD-CSR CURSOR'                      43530000
435400                               TO DP013-MESSAGE-TEXT (1)          43540000
435500              MOVE PV-ABEND-MSG-KEYS                              43550000
435600                               TO DP013-MESSAGE-TEXT (2)          43560000
435700              MOVE SQLCA       TO DP013-SQLCA                     43570000
435800              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        43580000
435900              SET DP013-DB2-ABEND                                 43590000
436000                               TO TRUE                            43600000
436100              PERFORM DP013-0000-PROCESS-ABEND                    43610000
436200     END-EVALUATE.                                                43620000
436300                                                                  43630000
436400/                                                                 43640000
436500*----------------------------------------------------------------*43650000
436600*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE WORK ORDER TABLE  *43660000
436700*  (TWRKORD) FOR A SPECIFIED ROW.                                *43670000
436800*----------------------------------------------------------------*43680000
436900 7110-SELECT-TWRKORD.                                             43690000
437000                                                                  43700000
437100     EXEC SQL                                                     43710000
437200       FETCH  TWRKORD-CSR                                         43720000
437300        INTO  :WRKORD-ORD-NBR                                     43730000
437400             ,:WRKORD-RCVR-SEQ-NBR                                43740000
437500             ,:WRKORD-ORD-LNE-NBR                                 43750000
437600             ,:WRKORD-WORK-ORD-SEQ-NBR                            43760000
437700             ,:WRKORD-OPER-UNT-ID                                 43770000
437800             ,:WRKORD-FCLTY-ID                                    43780000
437900             ,:WRKORD-CRE-TMST                                    43790000
438000             ,:WRKORD-VER-STATUS-CDE                              43800000
438100             ,:WRKORD-CRE-UID-ID                                  43810000
438200             ,:WRKORD-EXPTED-CART-CNT                             43820000
438300             ,:WRKORD-ACTL-CART-CNT                               43830000
438400             ,:WRKORD-EXPTED-ITM-CNT                              43840000
438500             ,:WRKORD-ACTL-ITM-CNT                                43850000
438600             ,:WRKORD-STAT-CDE                                    43860000
438700             ,:WRKORD-WORK-ORD-DISTR-IND                          43870000
438800             ,:WRKORD-OPER-SET-ID                                 43880000
438900     END-EXEC.                                                    43890000
439000                                                                  43900000
439100     EVALUATE TRUE                                                43910000
439200         WHEN SQLCODE = +0                                        43920000
439300             CONTINUE                                             43930000
439400                                                                  43940000
439500         WHEN SQLCODE = +100                                      43950000
439600             SET PS-END-OF-TWRKORD                                43960000
439700                               TO TRUE                            43970000
439800                                                                  43980000
439900         WHEN SQLWARN0 NOT = SPACES                               43990000
440000         WHEN SQLCODE < +0                                        44000000
440100         WHEN SQLCODE > +0                                        44010000
440200             MOVE '7110-SELECT-TWRKORD'                           44020000
440300                               TO DP013-PARAGRAPH                 44030000
440400             MOVE 'ERROR READING TWRKORD'                         44040000
440500                               TO DP013-MESSAGE-TEXT(1)           44050000
440600             MOVE PV-ABEND-MSG-KEYS                               44060000
440700                               TO DP013-MESSAGE-TEXT (2)          44070000
440800             MOVE SQLCA        TO DP013-SQLCA                     44080000
440900             MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)        44090000
441000             SET DP013-DB2-ABEND                                  44100000
441100                 DP013-XCTL-DISPLAY-RESTART                       44110000
441200                               TO TRUE                            44120000
441300             PERFORM DP013-0000-PROCESS-ABEND                     44130000
441400     END-EVALUATE.                                                44140000
441500                                                                  44150000
441600/                                                                 44160000
441700*----------------------------------------------------------------*44170000
441800*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *44180000
441900*  IS BEING DONE FOR AUDITING PURPOSES.                          *44190000
442000*----------------------------------------------------------------*44200000
442100 7120-SET-WRKORD-INACTIVE.                                        44210000
442200                                                                  44220000
442300     EXEC SQL                                                     44230000
442400       UPDATE TWRKORD                                             44240000
442500          SET VER_STATUS_CDE   = :PC-I                            44250000
442600        WHERE ORD_NBR          = :DK-PO-NBR                       44260000
442700          AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR                  44270000
442800          AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR              44280000
442900          AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR         44290000
443000          AND OPER_UNT_ID      = :DK-OPER-UNT-ID                  44300000
443100          AND FCLTY_ID         = :DK-FCLTY-ID                     44310000
443200          AND VER_STATUS_CDE   = :PC-A                            44320000
443300     END-EXEC.                                                    44330000
443400                                                                  44340000
443500     EVALUATE TRUE                                                44350000
443600         WHEN SQLCODE = +0                                        44360000
443700             CONTINUE                                             44370000
443800                                                                  44380000
443900         WHEN SQLWARN0 NOT = SPACES                               44390000
444000         WHEN SQLCODE < +0                                        44400000
444100         WHEN SQLCODE > +0                                        44410000
444200             MOVE '7120-SET-WRKORD-INACTIVE'                      44420000
444300                               TO DP013-PARAGRAPH                 44430000
444400             MOVE 'ERROR UPDATING TWRKORD '                       44440000
444500                               TO DP013-MESSAGE-TEXT(1)           44450000
444600             MOVE PV-ABEND-MSG-KEYS                               44460000
444700                               TO DP013-MESSAGE-TEXT (2)          44470000
444800             MOVE SQLCA        TO DP013-SQLCA                     44480000
444900             MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)        44490000
445000             SET DP013-DB2-ABEND                                  44500000
445100                 DP013-XCTL-DISPLAY-RESTART                       44510000
445200                               TO TRUE                            44520000
445300             PERFORM DP013-0000-PROCESS-ABEND                     44530000
445400     END-EVALUATE.                                                44540000
445500                                                                  44550000
445600/                                                                 44560000
445700*----------------------------------------------------------------*44570000
445800*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE WORK ORDER      *44580000
445900*  TABLE (TWRKORD).  IT WILL BE AN 'I'NACTIVE VER-STATUS WITH    *44590000
446000*  A STATUS-CDE OF 'DE'LETE                                      *44600000
446100*----------------------------------------------------------------*44610000
446200 7130-INSERT-TWRKORD.                                             44620000
446300                                                                  44630000
446400     EXEC SQL                                                     44640000
446500        INSERT INTO TWRKORD                                       44650000
446600              (ORD_NBR                                            44660000
446700              ,RCVR_SEQ_NBR                                       44670000
446800              ,ORD_LNE_NBR                                        44680000
446900              ,WORK_ORD_SEQ_NBR                                   44690000
447000              ,OPER_UNT_ID                                        44700000
447100              ,FCLTY_ID                                           44710000
447200              ,CRE_TMST                                           44720000
447300              ,VER_STATUS_CDE                                     44730000
447400              ,CRE_UID_ID                                         44740000
447500              ,EXPTED_CART_CNT                                    44750000
447600              ,ACTL_CART_CNT                                      44760000
447700              ,EXPTED_ITM_CNT                                     44770000
447800              ,ACTL_ITM_CNT                                       44780000
447900              ,STAT_CDE                                           44790000
448000              ,WORK_ORD_DISTR_IND                                 44800000
448100              ,OPER_SET_ID)                                       44810000
448200       VALUES (:WRKORD-ORD-NBR                                    44820000
448300              ,:WRKORD-RCVR-SEQ-NBR                               44830000
448400              ,:WRKORD-ORD-LNE-NBR                                44840000
448500              ,:WRKORD-WORK-ORD-SEQ-NBR                           44850000
448600              ,:WRKORD-OPER-UNT-ID                                44860000
448700              ,:WRKORD-FCLTY-ID                                   44870000
448800              , CURRENT TIMESTAMP                                 44880000
448900              ,:PC-I                                              44890000
449000              ,:DP020-USERID                                      44900000
449100              ,:WRKORD-EXPTED-CART-CNT                            44910000
449200              ,:WRKORD-ACTL-CART-CNT                              44920000
449300              ,:WRKORD-EXPTED-ITM-CNT                             44930000
449400              ,:WRKORD-ACTL-ITM-CNT                               44940000
449500              ,:PC-DE                                             44950000
449600              ,:WRKORD-WORK-ORD-DISTR-IND                         44960000
449700              ,:WRKORD-OPER-SET-ID)                               44970000
449800     END-EXEC.                                                    44980000
449900                                                                  44990000
450000     EVALUATE TRUE                                                45000000
450100         WHEN SQLCODE = +0                                        45010000
450200             CONTINUE                                             45020000
450300                                                                  45030000
450400         WHEN SQLWARN0 NOT = SPACES                               45040000
450500         WHEN SQLCODE < +0                                        45050000
450600         WHEN SQLCODE > +0                                        45060000
450700             MOVE '7130-INSERT-TWRKORD'                           45070000
450800                               TO DP013-PARAGRAPH                 45080000
450900             MOVE 'ERROR INSERTING A ROW INTO TWRKORD '           45090000
451000                               TO DP013-MESSAGE-TEXT(1)           45100000
451100             MOVE PV-ABEND-MSG-KEYS                               45110000
451200                               TO DP013-MESSAGE-TEXT (2)          45120000
451300             MOVE SQLCA        TO DP013-SQLCA                     45130000
451400             MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)        45140000
451500             SET DP013-DB2-ABEND                                  45150000
451600                 DP013-XCTL-DISPLAY-RESTART                       45160000
451700                               TO TRUE                            45170000
451800             PERFORM DP013-0000-PROCESS-ABEND                     45180000
451900     END-EVALUATE.                                                45190000
452000                                                                  45200000
452100/                                                                 45210000
452200*----------------------------------------------------------------*45220000
452300* CLOSE THE WORK ORDER CURSOR                                    *45230000
452400*----------------------------------------------------------------*45240000
452500                                                                  45250000
452600 7140-CLOSE-TWRKORD-CSR.                                          45260000
452700                                                                  45270000
452800     EXEC SQL                                                     45280000
452900         CLOSE TWRKORD-CSR                                        45290000
453000     END-EXEC.                                                    45300000
453100                                                                  45310000
453200     EVALUATE TRUE                                                45320000
453300         WHEN SQLCODE = +0                                        45330000
453400              CONTINUE                                            45340000
453500                                                                  45350000
453600         WHEN SQLWARN0 NOT = SPACE                                45360000
453700         WHEN SQLCODE  NOT = +0                                   45370000
453800              MOVE '7140-CLOSE-TWRKORD-CSR'                       45380000
453900                                   TO DP013-PARAGRAPH             45390000
454000              MOVE 'CLOSE TWRKORD-CSR CURSOR'                     45400000
454100                                   TO DP013-MESSAGE-TEXT (1)      45410000
454200              MOVE PV-ABEND-MSG-KEYS                              45420000
454300                                   TO DP013-MESSAGE-TEXT (2)      45430000
454400              MOVE SQLCA           TO DP013-SQLCA                 45440000
454500              MOVE 'TWRKORD'       TO DP013-DB2-TABLE-NAME (1)    45450000
454600              SET DP013-DB2-ABEND  TO TRUE                        45460000
454700              PERFORM DP013-0000-PROCESS-ABEND                    45470000
454800     END-EVALUATE.                                                45480000
454900                                                                  45490000
455000/                                                                 45500000
455100*----------------------------------------------------------------*45510000
455200* OPEN THE WORK ORDER INSTRUCTION CURSOR                         *45520000
455300*----------------------------------------------------------------*45530000
455400                                                                  45540000
455500 7150-OPEN-TWKORIN-CSR.                                           45550000
455600                                                                  45560000
455700     EXEC SQL                                                     45570000
455800         OPEN TWKORIN-CSR                                         45580000
455900     END-EXEC.                                                    45590000
456000                                                                  45600000
456100     EVALUATE TRUE                                                45610000
456200         WHEN SQLCODE = +0                                        45620000
456300              SET PS-NOT-END-OF-TWKORIN                           45630000
456400                               TO TRUE                            45640000
456500                                                                  45650000
456600         WHEN SQLWARN0 NOT = SPACE                                45660000
456700         WHEN SQLCODE  NOT = +0                                   45670000
456800              MOVE '7150-OPEN-TWKORIN-CSR'                        45680000
456900                               TO DP013-PARAGRAPH                 45690000
457000              MOVE 'OPEN TWKORIN-CSR CURSOR'                      45700000
457100                               TO DP013-MESSAGE-TEXT (1)          45710000
457200              MOVE PV-ABEND-MSG-KEYS                              45720000
457300                               TO DP013-MESSAGE-TEXT (2)          45730000
457400              MOVE SQLCA       TO DP013-SQLCA                     45740000
457500              MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)        45750000
457600              SET DP013-DB2-ABEND                                 45760000
457700                               TO TRUE                            45770000
457800              PERFORM DP013-0000-PROCESS-ABEND                    45780000
457900     END-EVALUATE.                                                45790000
458000                                                                  45800000
458100/                                                                 45810000
458200*----------------------------------------------------------------*45820000
458300*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE WORK ORDER        *45830000
458400*  INSTRUCTION TABLE (TWKORIN) FOR A SPECIFIED ROW.              *45840000
458500*----------------------------------------------------------------*45850000
458600                                                                  45860000
458700 7160-SELECT-TWKORIN.                                             45870000
458800                                                                  45880000
458900     EXEC SQL                                                     45890000
459000        FETCH TWKORIN-CSR                                         45900000
459100         INTO :WKORIN-ORD-NBR                                     45910000
459200            , :WKORIN-RCVR-SEQ-NBR                                45920000
459300            , :WKORIN-ORD-LNE-NBR                                 45930000
459400            , :WKORIN-WORK-ORD-SEQ-NBR                            45940000
459500            , :WKORIN-OPER-UNT-ID                                 45950000
459600            , :WKORIN-FCLTY-ID                                    45960000
459700            , :WKORIN-WO-INSTR-SEQ-NBR                            45970000
459800            , :WKORIN-CRE-TMST                                    45980000
459900            , :WKORIN-VER-STATUS-CDE                              45990000
460000            , :WKORIN-CRE-UID-ID                                  46000000
460100            , :WKORIN-OPER-ID                                     46010000
460200            , :WKORIN-FCLTY-AREA-ID                               46020000
460300            , :WKORIN-PRC-FCLTY-AREA-ID                           46030000
460400            , :WKORIN-EXPTED-CART-CNT                             46040000
460500            , :WKORIN-ACTL-CART-CNT                               46050000
460600            , :WKORIN-ALLOC-IND                                   46060000
460700            , :WKORIN-REPACK-IND                                  46070000
460800            , :WKORIN-STRT-TMST                                   46080000
460900            , :WKORIN-STOP-TMST                                   46090000
461000            , :WKORIN-SCREEN-SEQ-NBR                              46100000
461100            , :WKORIN-LNE-LOC-CDE                                 46110000
461200            , :WKORIN-REC-SEL-IND                                 46120000
461300     END-EXEC.                                                    46130000
461400                                                                  46140000
461500     EVALUATE TRUE                                                46150000
461600         WHEN SQLCODE = +0                                        46160000
461700             CONTINUE                                             46170000
461800                                                                  46180000
461900         WHEN SQLCODE = +100                                      46190000
462000             SET PS-END-OF-TWKORIN                                46200000
462100                               TO TRUE                            46210000
462200                                                                  46220000
462300         WHEN SQLWARN0 NOT = SPACES                               46230000
462400         WHEN SQLCODE < +0                                        46240000
462500         WHEN SQLCODE > +0                                        46250000
462600             MOVE '7160-SELECT-TWKORIN'                           46260000
462700                               TO DP013-PARAGRAPH                 46270000
462800             MOVE 'ERROR READING TWKORIN'                         46280000
462900                               TO DP013-MESSAGE-TEXT(1)           46290000
463000             MOVE PV-ABEND-MSG-KEYS                               46300000
463100                               TO DP013-MESSAGE-TEXT (2)          46310000
463200             MOVE SQLCA        TO DP013-SQLCA                     46320000
463300             MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)        46330000
463400             SET DP013-DB2-ABEND                                  46340000
463500                 DP013-XCTL-DISPLAY-RESTART                       46350000
463600                               TO TRUE                            46360000
463700             PERFORM DP013-0000-PROCESS-ABEND                     46370000
463800     END-EVALUATE.                                                46380000
463900                                                                  46390000
464000/                                                                 46400000
464100*----------------------------------------------------------------*46410000
464200*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *46420000
464300*  IS BEING DONE FOR AUDITING PURPOSES.                          *46430000
464400*----------------------------------------------------------------*46440000
464500 7170-SET-TWKORIN-INACTIVE.                                       46450000
464600                                                                  46460000
464700     EXEC SQL                                                     46470000
464800       UPDATE TWKORIN                                             46480000
464900          SET VER_STATUS_CDE   = :PC-I                            46490000
465000        WHERE ORD_NBR          = :DK-PO-NBR                       46500000
465100          AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR                  46510000
465200          AND ORD_LNE_NBR      = :WRKORD-ORD-LNE-NBR              46520000
465300          AND WORK_ORD_SEQ_NBR = :WRKORD-WORK-ORD-SEQ-NBR         46530000
465400          AND OPER_UNT_ID      = :DK-OPER-UNT-ID                  46540000
465500          AND FCLTY_ID         = :DK-FCLTY-ID                     46550000
465600          AND WO_INSTR_SEQ_NBR = :WKORIN-WO-INSTR-SEQ-NBR         46560000
465700          AND VER_STATUS_CDE   = :PC-A                            46570000
465800     END-EXEC.                                                    46580000
465900                                                                  46590000
466000     EVALUATE TRUE                                                46600000
466100         WHEN SQLCODE = +0                                        46610000
466200             CONTINUE                                             46620000
466300                                                                  46630000
466400         WHEN SQLWARN0 NOT = SPACES                               46640000
466500         WHEN SQLCODE < +0                                        46650000
466600         WHEN SQLCODE > +0                                        46660000
466700             MOVE '7170-SET-TWKORIN-INACTIVE'                     46670000
466800                               TO DP013-PARAGRAPH                 46680000
466900             MOVE 'ERROR UPDATING TWKORIN '                       46690000
467000                               TO DP013-MESSAGE-TEXT(1)           46700000
467100             MOVE PV-ABEND-MSG-KEYS                               46710000
467200                               TO DP013-MESSAGE-TEXT (2)          46720000
467300             MOVE SQLCA        TO DP013-SQLCA                     46730000
467400             MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)        46740000
467500             SET DP013-DB2-ABEND                                  46750000
467600                 DP013-XCTL-DISPLAY-RESTART                       46760000
467700                               TO TRUE                            46770000
467800             PERFORM DP013-0000-PROCESS-ABEND                     46780000
467900     END-EVALUATE.                                                46790000
468000                                                                  46800000
468100/                                                                 46810000
468200*----------------------------------------------------------------*46820000
468300*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE WORK ORDER      *46830000
468400*  INSTRUCTION TABLE (TWKORIN).  IT WILL BE AN 'I'NACTIVE        *46840000
468500*  VER-STATUS WITH A STATUS-CDE OF 'DE'LETE                      *46850000
468600*----------------------------------------------------------------*46860000
468700 7180-INSERT-TWKORIN.                                             46870000
468800                                                                  46880000
468900     EXEC SQL                                                     46890000
469000         INSERT INTO TWKORIN                                      46900000
469100               (ORD_NBR                                           46910000
469200               ,RCVR_SEQ_NBR                                      46920000
469300               ,ORD_LNE_NBR                                       46930000
469400               ,WORK_ORD_SEQ_NBR                                  46940000
469500               ,WO_INSTR_SEQ_NBR                                  46950000
469600               ,CRE_TMST                                          46960000
469700               ,VER_STATUS_CDE                                    46970000
469800               ,CRE_UID_ID                                        46980000
469900               ,OPER_ID                                           46990000
470000               ,OPER_UNT_ID                                       47000000
470100               ,FCLTY_ID                                          47010000
470200               ,FCLTY_AREA_ID                                     47020000
470300               ,PRC_FCLTY_AREA_ID                                 47030000
470400               ,EXPTED_CART_CNT                                   47040000
470500               ,ACTL_CART_CNT                                     47050000
470600               ,ALLOC_IND                                         47060000
470700               ,REPACK_IND                                        47070000
470800               ,STRT_TMST                                         47080000
470900               ,STOP_TMST                                         47090000
471000               ,SCREEN_SEQ_NBR                                    47100000
471100               ,LNE_LOC_CDE                                       47110000
471200               ,REC_SEL_IND)                                      47120000
471300        VALUES                                                    47130000
471400              (:WKORIN-ORD-NBR                                    47140000
471500              ,:WKORIN-RCVR-SEQ-NBR                               47150000
471600              ,:WKORIN-ORD-LNE-NBR                                47160000
471700              ,:WKORIN-WORK-ORD-SEQ-NBR                           47170000
471800              ,:WKORIN-WO-INSTR-SEQ-NBR                           47180000
471900              , CURRENT TIMESTAMP                                 47190000
472000              ,:PC-I                                              47200000
472100              ,:DP020-USERID                                      47210000
472200              ,:WKORIN-OPER-ID                                    47220000
472300              ,:WKORIN-OPER-UNT-ID                                47230000
472400              ,:WKORIN-FCLTY-ID                                   47240000
472500              ,:WKORIN-FCLTY-AREA-ID                              47250000
472600              ,:WKORIN-PRC-FCLTY-AREA-ID                          47260000
472700              ,:WKORIN-EXPTED-CART-CNT                            47270000
472800              ,:WKORIN-ACTL-CART-CNT                              47280000
472900              ,:WKORIN-ALLOC-IND                                  47290000
473000              ,:WKORIN-REPACK-IND                                 47300000
473100              ,:WKORIN-STRT-TMST                                  47310000
473200              ,:WKORIN-STOP-TMST                                  47320000
473300              ,:WKORIN-SCREEN-SEQ-NBR                             47330000
473400              ,:WKORIN-LNE-LOC-CDE                                47340000
473500              ,:WKORIN-REC-SEL-IND)                               47350000
473600     END-EXEC.                                                    47360000
473700                                                                  47370000
473800     EVALUATE TRUE                                                47380000
473900         WHEN SQLCODE = +0                                        47390000
474000             CONTINUE                                             47400000
474100                                                                  47410000
474200         WHEN SQLWARN0 NOT = SPACES                               47420000
474300         WHEN SQLCODE < +0                                        47430000
474400         WHEN SQLCODE > +0                                        47440000
474500             MOVE '7180-INSERT-TWKORIN'                           47450000
474600                               TO DP013-PARAGRAPH                 47460000
474700             MOVE 'ERROR INSERTING A ROW INTO TWKORIN '           47470000
474800                               TO DP013-MESSAGE-TEXT(1)           47480000
474900             MOVE PV-ABEND-MSG-KEYS                               47490000
475000                               TO DP013-MESSAGE-TEXT (2)          47500000
475100             MOVE SQLCA        TO DP013-SQLCA                     47510000
475200             MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)        47520000
475300             SET DP013-DB2-ABEND                                  47530000
475400                 DP013-XCTL-DISPLAY-RESTART                       47540000
475500                               TO TRUE                            47550000
475600             PERFORM DP013-0000-PROCESS-ABEND                     47560000
475700     END-EVALUATE.                                                47570000
475800                                                                  47580000
475900/                                                                 47590000
476000*----------------------------------------------------------------*47600000
476100* CLOSE THE WORK ORDER INSTRUCTION CURSOR                        *47610000
476200*----------------------------------------------------------------*47620000
476300                                                                  47630000
476400 7140-CLOSE-TWKORIN-CSR.                                          47640000
476500                                                                  47650000
476600     EXEC SQL                                                     47660000
476700         CLOSE TWKORIN-CSR                                        47670000
476800     END-EXEC.                                                    47680000
476900                                                                  47690000
477000     EVALUATE TRUE                                                47700000
477100         WHEN SQLCODE = +0                                        47710000
477200              CONTINUE                                            47720000
477300                                                                  47730000
477400         WHEN SQLWARN0 NOT = SPACE                                47740000
477500         WHEN SQLCODE  NOT = +0                                   47750000
477600              MOVE '7140-CLOSE-TWKORIN-CSR'                       47760000
477700                                   TO DP013-PARAGRAPH             47770000
477800              MOVE 'CLOSE TWKORIN-CSR CURSOR'                     47780000
477900                                   TO DP013-MESSAGE-TEXT (1)      47790000
478000              MOVE PV-ABEND-MSG-KEYS                              47800000
478100                                   TO DP013-MESSAGE-TEXT (2)      47810000
478200              MOVE SQLCA           TO DP013-SQLCA                 47820000
478300              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    47830000
478400              SET DP013-DB2-ABEND  TO TRUE                        47840000
478500              PERFORM DP013-0000-PROCESS-ABEND                    47850000
478600     END-EVALUATE.                                                47860000
478700                                                                  47870000
478800/                                                                 47880000
478900*----------------------------------------------------------------*47890000
479000*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *47900000
479100*    PACK SLIP TABLES, TPKSLIP, AND TPKITEM.                     *47910000
479200*----------------------------------------------------------------*47920000
479300 7200-DELETE-PACK-SLIPS.                                          47930000
479400                                                                  47940000
479500     PERFORM 7230-OPEN-TPKSLIP-CSR.                               47950000
479600     PERFORM 7232-SELECT-TPKSLIP.                                 47960000
479700                                                                  47970000
479800     PERFORM                                                      47980000
479900         UNTIL PS-END-OF-TPKSLIP                                  47990000
480000             PERFORM 7234-SET-TPKSLIP-INACTIVE                    48000000
480100             MOVE PKSLIP-PKSL-NBR TO PV-PKSL-NBR                  48010000
480200             MOVE DK-REC-SEQ-NBR  TO PV-RCVR-SEQ-NBR              48020000
480300             MOVE PV-NEW-PKSL-NBR TO PKSLIP-PKSL-NBR              48030000
480400             PERFORM 7370-SELECT-TRECEIV                          48040000
480500             IF RECEIV-PACK-BY-ST-IND = PC-Y                      48050000
480600                 MOVE ZERO TO PV-DB2-COUNT                        48060000
480700                 PERFORM 7250-SELECT-TPKSLIP                      48070000
480800                 IF PV-DB2-COUNT > ZERO                           48080000
480900                     MOVE PC-ZERO     TO PKSLIP-REC-SEQ-NBR       48090000
481000                 ELSE                                             48100000
481100                      MOVE DK-UPDATE-REC-SEQ-NBR                  48110000
481200                                      TO PKSLIP-REC-SEQ-NBR       48120000
481300                 END-IF                                           48130000
481400             ELSE                                                 48140000
481500                  MOVE DK-UPDATE-REC-SEQ-NBR                      48150000
481600                                  TO PKSLIP-REC-SEQ-NBR           48160000
481700             END-IF                                               48170000
481800             PERFORM 7236-INSERT-TPKSLIP                          48180000
481900             PERFORM 7232-SELECT-TPKSLIP                          48190000
482000                                                                  48200000
482100     END-PERFORM.                                                 48210000
482200                                                                  48220000
482300     PERFORM 7238-CLOSE-TPKSLIP-CSR.                              48230000
482400                                                                  48240000
482500/                                                                 48250000
482600*----------------------------------------------------------------*48260000
482700* OPEN THE PACK SLIP CURSOR                                      *48270000
482800*----------------------------------------------------------------*48280000
482900                                                                  48290000
483000 7230-OPEN-TPKSLIP-CSR.                                           48300000
483100                                                                  48310000
483200     EXEC SQL                                                     48320000
483300         OPEN TPKSLIP-CSR                                         48330000
483400     END-EXEC.                                                    48340000
483500                                                                  48350000
483600     EVALUATE TRUE                                                48360000
483700         WHEN SQLCODE = +0                                        48370000
483800              SET PS-NOT-END-OF-TPKSLIP                           48380000
483900                               TO TRUE                            48390000
484000                                                                  48400000
484100         WHEN SQLWARN0 NOT = SPACE                                48410000
484200         WHEN SQLCODE  NOT = +0                                   48420000
484300              MOVE '7230-OPEN-TPKSLIP-CSR'                        48430000
484400                               TO DP013-PARAGRAPH                 48440000
484500              MOVE 'OPEN TPKSLIP-CSR CURSOR'                      48450000
484600                               TO DP013-MESSAGE-TEXT (1)          48460000
484700              MOVE PV-ABEND-MSG-KEYS                              48470000
484800                               TO DP013-MESSAGE-TEXT (2)          48480000
484900              MOVE SQLCA       TO DP013-SQLCA                     48490000
485000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        48500000
485100              SET DP013-DB2-ABEND                                 48510000
485200                               TO TRUE                            48520000
485300              PERFORM DP013-0000-PROCESS-ABEND                    48530000
485400     END-EVALUATE.                                                48540000
485500/                                                                 48550000
485600*----------------------------------------------------------------*48560000
485700*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE PACK SLIP TABLE   *48570000
485800*  (TPKSLIP) FOR A SPECIFIED ROW.                                *48580000
485900*----------------------------------------------------------------*48590000
486000 7232-SELECT-TPKSLIP.                                             48600000
486100                                                                  48610000
486200     EXEC SQL                                                     48620000
486300       FETCH TPKSLIP-CSR                                          48630000
486400        INTO :PKSLIP-PO-NBR                                       48640000
486500           , :PKSLIP-SEQ-NBR                                      48650000
486600           , :PKSLIP-CRE-TMST                                     48660000
486700           , :PKSLIP-VER-STAT-CDE                                 48670000
486800           , :PKSLIP-OPER-UNT-ID                                  48680000
486900           , :PKSLIP-FCLTY-ID                                     48690000
487000           , :PKSLIP-PKSL-NBR                                     48700000
487100           , :PKSLIP-STR-DEST-NBR                                 48710000
487200           , :PKSLIP-REC-SEQ-NBR                                  48720000
487300           , :PKSLIP-SHIPT-ID                                     48730000
487400           , :PKSLIP-BOL-NBR                                      48740000
487500           , :PKSLIP-PRO-NBR                                      48750000
487600           , :PKSLIP-PKSL-STAT-CDE                                48760000
487700           , :PKSLIP-CRE-UID                                      48770000
487800           , :PKSLIP-PO-VER-NBR                                   48780000
487900           , :PKSLIP-CRE-SRC-CDE                                  48790000
488000           , :PKSLIP-EXPTED-PKG-QTY                               48800000
488100           , :PKSLIP-OWNER-SCAC-ID                                48810000
488200           , :PKSLIP-ASN-NBR                                      48820000
488300           , :PKSLIP-VEND-SHIP-DTE                                48830000
488400           , :PKSLIP-CONTNR-ID                                    48840000
488500           , :PKSLIP-ORIG-PKSL-SEQ-NBR                            48850074
488600     END-EXEC.                                                    48860000
488700                                                                  48870000
488800     EVALUATE TRUE                                                48880000
488900         WHEN SQLCODE = +0                                        48890000
489000              CONTINUE                                            48900000
489100                                                                  48910000
489200         WHEN SQLCODE = +100                                      48920000
489300              SET PS-END-OF-TPKSLIP                               48930000
489400                               TO TRUE                            48940000
489500                                                                  48950000
489600         WHEN SQLWARN0 NOT = SPACES                               48960000
489700         WHEN SQLCODE < +0                                        48970000
489800         WHEN SQLCODE > +0                                        48980000
489900              MOVE '7232-SELECT-TPKSLIP'                          48990000
490000                               TO DP013-PARAGRAPH                 49000000
490100              MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'         49010000
490200                               TO DP013-MESSAGE-TEXT (1)          49020000
490300              MOVE PV-ABEND-MSG-KEYS                              49030000
490400                               TO DP013-MESSAGE-TEXT (2)          49040000
490500              MOVE SQLCA       TO DP013-SQLCA                     49050000
490600              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        49060000
490700              SET DP013-DB2-ABEND                                 49070000
490800                  DP013-XCTL-DISPLAY-RESTART                      49080000
490900                               TO TRUE                            49090000
491000              PERFORM DP013-0000-PROCESS-ABEND                    49100000
491100     END-EVALUATE.                                                49110000
491200/                                                                 49120000
491300*----------------------------------------------------------------*49130000
491400*  THIS PARAGRAPH WILL STATUS THE CURRENT ROW INACTIVE.  THIS    *49140000
491500*  IS BEING DONE FOR AUDITING PURPOSES.                          *49150000
491600*----------------------------------------------------------------*49160000
491700                                                                  49170000
491800 7234-SET-TPKSLIP-INACTIVE.                                       49180000
491900                                                                  49190000
492000     EXEC SQL                                                     49200000
492100          UPDATE TPKSLIP                                          49210000
492200             SET VER_STAT_CDE   = :PC-I                           49220000
492300           WHERE PO_NBR         = :DK-PO-NBR                      49230000
492400             AND SEQ_NBR        = :PKSLIP-SEQ-NBR                 49240000
492500             AND VER_STAT_CDE   = :PC-A                           49250000
492600     END-EXEC.                                                    49260000
492700                                                                  49270000
492800     EVALUATE TRUE                                                49280000
492900         WHEN SQLCODE = +0                                        49290000
493000              CONTINUE                                            49300000
493100                                                                  49310000
493200         WHEN SQLWARN0 NOT = SPACES                               49320000
493300         WHEN SQLCODE < +0                                        49330000
493400         WHEN SQLCODE > +0                                        49340000
493500              MOVE '7234-SET-TPKSLIP-INACTIVE'                    49350000
493600                               TO DP013-PARAGRAPH                 49360000
493700              MOVE 'UNSUCCESSFUL UPDATE OF TPKSLIP'               49370000
493800                               TO DP013-MESSAGE-TEXT (1)          49380000
493900              MOVE PV-ABEND-MSG-KEYS                              49390000
494000                               TO DP013-MESSAGE-TEXT (2)          49400000
494100              MOVE SQLCA       TO DP013-SQLCA                     49410000
494200              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        49420000
494300              SET DP013-DB2-ABEND                                 49430000
494400                  DP013-XCTL-DISPLAY-RESTART                      49440000
494500                               TO TRUE                            49450000
494600              PERFORM DP013-0000-PROCESS-ABEND                    49460000
494700     END-EVALUATE.                                                49470000
494800/                                                                 49480000
494900*----------------------------------------------------------------*49490000
495000*  THIS PARAGRAPH WILL INSERT A NEW ROW INTO THE PACK SLIP       *49500000
495100*  TABLE (TPKSLIP).  IT WILL BE AN 'I'NACTIVE VER-STATUS WITH    *49510000
495200*  A STATUS-CDE OF 'DE'LETE                                      *49520000
495300*----------------------------------------------------------------*49530000
495400                                                                  49540000
495500 7236-INSERT-TPKSLIP.                                             49550000
495600                                                                  49560000
495700     EXEC SQL                                                     49570000
495800          INSERT INTO TPKSLIP                                     49580000
495900                 (PO_NBR,                                         49590000
496000                  SEQ_NBR,                                        49600000
496100                  CRE_TMST,                                       49610000
496200                  VER_STAT_CDE,                                   49620000
496300                  OPER_UNT_ID,                                    49630000
496400                  FCLTY_ID,                                       49640000
496500                  PKSL_NBR,                                       49650000
496600                  STR_DEST_NBR,                                   49660000
496700                  REC_SEQ_NBR,                                    49670000
496800                  SHIPT_ID,                                       49680000
496900                  BOL_NBR,                                        49690000
497000                  PRO_NBR,                                        49700000
497100                  PKSL_STAT_CDE,                                  49710000
497200                  CRE_UID,                                        49720000
497300                  PO_VER_NBR,                                     49730000
497400                  CRE_SRC_CDE,                                    49740000
497500                  EXPTED_PKG_QTY,                                 49750000
497600                  OWNER_SCAC_ID,                                  49760000
497700                  ASN_NBR,                                        49770000
497800                  VEND_SHIP_DTE,                                  49780000
497900                  CONTNR_ID,                                      49790074
498000                  ORIG_PKSL_SEQ_NBR)                              49800074
498100          VALUES (:PKSLIP-PO-NBR,                                 49810000
498200                  :PKSLIP-SEQ-NBR,                                49820000
498300                   CURRENT TIMESTAMP,                             49830000
498400                  :PC-A,                                          49840000
498500                  :PKSLIP-OPER-UNT-ID,                            49850000
498600                  :PKSLIP-FCLTY-ID,                               49860000
498700                  :PKSLIP-PKSL-NBR,                               49870000
498800                  :PKSLIP-STR-DEST-NBR,                           49880000
498900                  :PKSLIP-REC-SEQ-NBR,                            49890000
499000                  :PKSLIP-SHIPT-ID,                               49900000
499100                  :PKSLIP-BOL-NBR,                                49910000
499200                  :PKSLIP-PRO-NBR,                                49920000
499300                  :PC-IN,                                         49930000
499400                  :DP020-USERID,                                  49940000
499500                  :PKSLIP-PO-VER-NBR,                             49950000
499600                  :PKSLIP-CRE-SRC-CDE,                            49960000
499700                  :PKSLIP-EXPTED-PKG-QTY,                         49970000
499800                  :PKSLIP-OWNER-SCAC-ID,                          49980000
499900                  :PKSLIP-ASN-NBR,                                49990000
500000                  :PKSLIP-VEND-SHIP-DTE,                          50000000
500100                  :PKSLIP-CONTNR-ID,                              50010074
500200                  :PKSLIP-ORIG-PKSL-SEQ-NBR)                      50020074
500300     END-EXEC.                                                    50030000
500400                                                                  50040000
500500     EVALUATE TRUE                                                50050000
500600         WHEN SQLCODE = +0                                        50060000
500700              CONTINUE                                            50070000
500800                                                                  50080000
500900         WHEN SQLWARN0 NOT = SPACES                               50090000
501000         WHEN SQLCODE < +0                                        50100000
501100         WHEN SQLCODE > +0                                        50110000
501200              MOVE '7236-INSERT-TPKSLIP'                          50120000
501300                               TO DP013-PARAGRAPH                 50130000
501400              MOVE 'UNSUCCESSFUL INSERT FOR TPKSLIP'              50140000
501500                               TO DP013-MESSAGE-TEXT (1)          50150000
501600              MOVE PV-ABEND-MSG-KEYS                              50160000
501700                               TO DP013-MESSAGE-TEXT (2)          50170000
501800              MOVE SQLCA       TO DP013-SQLCA                     50180000
501900              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        50190000
502000              SET DP013-DB2-ABEND                                 50200000
502100                  DP013-XCTL-DISPLAY-RESTART                      50210000
502200                               TO TRUE                            50220000
502300              PERFORM DP013-0000-PROCESS-ABEND                    50230000
502400     END-EVALUATE.                                                50240000
502500/                                                                 50250000
502600*----------------------------------------------------------------*50260000
502700* CLOSE THE PACK SLIP CURSOR                                     *50270000
502800*----------------------------------------------------------------*50280000
502900                                                                  50290000
503000 7238-CLOSE-TPKSLIP-CSR.                                          50300000
503100                                                                  50310000
503200     EXEC SQL                                                     50320000
503300         CLOSE TPKSLIP-CSR                                        50330000
503400     END-EXEC.                                                    50340000
503500                                                                  50350000
503600     EVALUATE TRUE                                                50360000
503700         WHEN SQLCODE = +0                                        50370000
503800              CONTINUE                                            50380000
503900                                                                  50390000
504000         WHEN SQLWARN0 NOT = SPACE                                50400000
504100         WHEN SQLCODE  NOT = +0                                   50410000
504200              MOVE '7238-CLOSE-TPKSLIP-CSR'                       50420000
504300                                   TO DP013-PARAGRAPH             50430000
504400              MOVE 'CLOSE TPKSLIP-CSR CURSOR'                     50440000
504500                                   TO DP013-MESSAGE-TEXT (1)      50450000
504600              MOVE PV-ABEND-MSG-KEYS                              50460000
504700                                   TO DP013-MESSAGE-TEXT (2)      50470000
504800              MOVE SQLCA           TO DP013-SQLCA                 50480000
504900              MOVE 'TPKSLIP'       TO DP013-DB2-TABLE-NAME (1)    50490000
505000              SET DP013-DB2-ABEND  TO TRUE                        50500000
505100              PERFORM DP013-0000-PROCESS-ABEND                    50510000
505200     END-EVALUATE.                                                50520000
505300                                                                  50530000
505400 7250-SELECT-TPKSLIP.                                             50540000
505500                                                                  50550000
505600     EXEC SQL                                                     50560000
505700        SELECT  COUNT(*)                                          50570000
505800          INTO :PV-DB2-COUNT                                      50580000
505900          FROM  TPKSLIP                                           50590000
506000         WHERE  PO_NBR       = :PKSLIP-PO-NBR                     50600000
506100           AND  VER_STAT_CDE = :PC-A                              50610000
506200           AND  OPER_UNT_ID  = :PKSLIP-OPER-UNT-ID                50620000
506300           AND  FCLTY_ID     = :PKSLIP-FCLTY-ID                   50630000
506400           AND  STR_DEST_NBR = :PKSLIP-STR-DEST-NBR               50640000
506500           AND  REC_SEQ_NBR  = :DK-UPDATE-REC-SEQ-NBR             50650000
506600     END-EXEC.                                                    50660000
506700                                                                  50670000
506800     EVALUATE TRUE                                                50680000
506900         WHEN SQLCODE = +0                                        50690000
507000         WHEN SQLCODE = +100                                      50700000
507100              CONTINUE                                            50710000
507200                                                                  50720000
507300         WHEN SQLWARN0 NOT = SPACES                               50730000
507400         WHEN SQLCODE < +0                                        50740000
507500         WHEN SQLCODE > +0                                        50750000
507600              MOVE '7232-SELECT-TPKSLIP'                          50760000
507700                               TO DP013-PARAGRAPH                 50770000
507800              MOVE 'UNSUCCESSFUL SELECT PACK SLIP HEADER'         50780000
507900                               TO DP013-MESSAGE-TEXT (1)          50790000
508000              MOVE PV-ABEND-MSG-KEYS                              50800000
508100                               TO DP013-MESSAGE-TEXT (2)          50810000
508200              MOVE SQLCA       TO DP013-SQLCA                     50820000
508300              MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)        50830000
508400              SET DP013-DB2-ABEND                                 50840000
508500                  DP013-XCTL-DISPLAY-RESTART                      50850000
508600                               TO TRUE                            50860000
508700              PERFORM DP013-0000-PROCESS-ABEND                    50870000
508800     END-EVALUATE.                                                50880000
508900                                                                  50890000
509000/                                                                 50900000
509100*----------------------------------------------------------------*50910000
509200*    THIS PARAGRAPH CONTROLS THE DELETION PROCESSING FOR THE     *50920000
509300*    RECEIVER TABLES, TRECEIV, TRECDIS AND TRECITM.              *50930000
509400*----------------------------------------------------------------*50940000
509500 7300-DELETE-RECEIPTS.                                            50950000
509600                                                                  50960000
509700     PERFORM 7310-DELETE-TRECDIS.                                 50970000
509800     PERFORM 7315-DELETE-ODD-UNIT.                                50980070
509900                                                                  50990070
509910*JAK 06/2007 - ADD CODE FOR WMOS INTERFACE                        50991086
509930     PERFORM 7410-SELECT-TRECEIV.                                 50993082
509940     PERFORM 7400-CHECK-ASNDWN.                                   50994082
509950     IF PS-ASNS-TO-WMS-YES                                        50995082
509960        AND PS-NO-ERROR                                           50996082
509990         PERFORM 7430-GET-TRIP-ID                                 50999082
509991         IF PS-NO-ERROR                                           50999182
509992             PERFORM 7440-CALL-WMS-MODULE                         50999282
509994         END-IF                                                   50999482
509995     END-IF.                                                      50999582
509996*JAK 06/2007 - END                                                50999686
509997                                                                  50999782
510000     PERFORM 7320-OPEN-TRECITM-CSR.                               51000000
510100     PERFORM 7330-SELECT-TRECITM.                                 51010000
510200                                                                  51020000
510300     PERFORM                                                      51030000
510400         UNTIL PS-END-OF-TRECITM                                  51040000
510500             MOVE 'I'      TO RC031-TABLE-TO-AUDIT                51050000
510600             MOVE 'B'      TO RC031-AUD-TYP-CDE                   51060000
510700             MOVE 'D'      TO RC031-AUD-FUNC-CDE                  51070000
510800             MOVE RECITM-ORD-NBR                                  51080000
510900                           TO RC031-PO-NBR                        51090000
511000             MOVE RECITM-ORD-LNE-NBR                              51100000
511100                           TO RC031-PO-LNE-NBR                    51110000
511200             MOVE RECITM-REC-SEQ-NBR                              51120000
511300                           TO RC031-REC-SEQ-NBR                   51130000
511400             MOVE RECITM-OPER-UNT-ID                              51140000
511500                           TO RC031-OPER-UNT-ID                   51150000
511600             MOVE RECITM-FCLTY-ID                                 51160000
511700                           TO RC031-FCLTY-ID                      51170000
511800             MOVE PC-CURRENT-PROGRAM-NAME                         51180000
511900                           TO RC031-UPD-PGM-ID                    51190000
512000             EXEC CICS                                            51200000
512100                 LINK PROGRAM  (PC-AUDIT-RTN)                     51210000
512200                      COMMAREA (RC031-FIELDS)                     51220000
512300                      LENGTH   (PC-AUDIT-RTN-LENGTH)              51230000
512400             END-EXEC                                             51240000
512500             EVALUATE TRUE                                        51250000
512600                 WHEN RC031-CALL-SUCCESSFUL                       51260000
512700                     CONTINUE                                     51270000
512800                                                                  51280000
512900                 WHEN OTHER                                       51290000
513000                      MOVE '7300-DELETE-RECEIPTS'                 51300000
513100                                            TO DP013-PARAGRAPH    51310000
513200                      MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'       51320000
513300                                        TO DP013-MESSAGE-TEXT (1) 51330000
513400                      MOVE RC031-RETURN-DESC                      51340000
513500                                        TO DP013-MESSAGE-TEXT (2) 51350000
513600                      MOVE RC031-SQLCA      TO DP013-SQLCA        51360000
513700                      SET DP013-DB2-ABEND                         51370000
513800                          DP013-XCTL-DISPLAY-RESTART              51380000
513900                                            TO TRUE               51390000
514000                      PERFORM DP013-0000-PROCESS-ABEND            51400000
514100             END-EVALUATE                                         51410000
514200             PERFORM 7345-SELECT-CURRENT-TMST                     51420000
514300             MOVE 'I'      TO RC031-TABLE-TO-AUDIT                51430000
514400             MOVE 'A'      TO RC031-AUD-TYP-CDE                   51440000
514500             MOVE 'D'      TO RC031-AUD-FUNC-CDE                  51450000
514600             MOVE PC-CURRENT-PROGRAM-NAME                         51460000
514700                                TO RC031-UPD-PGM-ID               51470000
514800             MOVE DP020-USERID  TO RC031-UPD-UID                  51480000
514900             MOVE PV-CURRENT-TMST                                 51490000
515000                                TO RC031-UPD-TMST                 51500000
515100             MOVE PC-DE         TO RC031-STATUS-CDE               51510000
515200             EXEC CICS                                            51520000
515300                 LINK PROGRAM  (PC-AUDIT-RTN)                     51530000
515400                      COMMAREA (RC031-FIELDS)                     51540000
515500                      LENGTH   (PC-AUDIT-RTN-LENGTH)              51550000
515600             END-EXEC                                             51560000
515700             EVALUATE TRUE                                        51570000
515800                 WHEN RC031-CALL-SUCCESSFUL                       51580000
515900                     CONTINUE                                     51590000
516000                                                                  51600000
516100                 WHEN OTHER                                       51610000
516200                      MOVE '7300-DELETE-RECEIPTS'                 51620000
516300                                            TO DP013-PARAGRAPH    51630000
516400                      MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'       51640000
516500                                        TO DP013-MESSAGE-TEXT (1) 51650000
516600                      MOVE RC031-RETURN-DESC                      51660000
516700                                        TO DP013-MESSAGE-TEXT (2) 51670000
516800                      MOVE RC031-SQLCA      TO DP013-SQLCA        51680000
516900                      SET DP013-DB2-ABEND                         51690000
517000                          DP013-XCTL-DISPLAY-RESTART              51700000
517100                                            TO TRUE               51710000
517200                      PERFORM DP013-0000-PROCESS-ABEND            51720000
517300             END-EVALUATE                                         51730000
517400             INITIALIZE RC071-FIELDS                              51740081
517500             MOVE '0A'              TO RC071-DC-FUNCTION-CODE     51750081
517600             PERFORM 9950-CALL-PO-RCVR-TRKING-MOD                 51760081
517700             PERFORM 7330-SELECT-TRECITM                          51770000
517800     END-PERFORM.                                                 51780000
517900                                                                  51790000
518000     PERFORM 7360-CLOSE-TRECITM-CSR.                              51800000
518100     PERFORM 7350-DELETE-TRECITM.                                 51810000
518200     MOVE 'V'      TO RC031-TABLE-TO-AUDIT.                       51820000
518300     MOVE 'B'      TO RC031-AUD-TYP-CDE.                          51830000
518400     MOVE 'U'      TO RC031-AUD-FUNC-CDE.                         51840000
518500     MOVE DK-PO-NBR                                               51850000
518600                   TO RC031-PO-NBR.                               51860000
518700     MOVE DK-REC-SEQ-NBR                                          51870000
518800                   TO RC031-REC-SEQ-NBR.                          51880000
518900     MOVE DK-OPER-UNT-ID                                          51890000
519000                   TO RC031-OPER-UNT-ID.                          51900000
519100     MOVE DK-FCLTY-ID                                             51910000
519200                   TO RC031-FCLTY-ID.                             51920000
519300     EXEC CICS                                                    51930000
519400         LINK PROGRAM  (PC-AUDIT-RTN)                             51940000
519500              COMMAREA (RC031-FIELDS)                             51950000
519600              LENGTH   (PC-AUDIT-RTN-LENGTH)                      51960000
519700     END-EXEC.                                                    51970000
519800     EVALUATE TRUE                                                51980000
519900         WHEN RC031-CALL-SUCCESSFUL                               51990000
520000             CONTINUE                                             52000000
520100                                                                  52010000
520200         WHEN OTHER                                               52020000
520300            MOVE '7300-DELETE-RECEIPTS'                           52030000
520400                            TO DP013-PARAGRAPH                    52040000
520500            MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                 52050000
520600                        TO DP013-MESSAGE-TEXT (1)                 52060000
520700            MOVE RC031-RETURN-DESC                                52070000
520800                        TO DP013-MESSAGE-TEXT (2)                 52080000
520900            MOVE RC031-SQLCA      TO DP013-SQLCA                  52090000
521000            SET DP013-DB2-ABEND                                   52100000
521100                DP013-XCTL-DISPLAY-RESTART                        52110000
521200                                  TO TRUE                         52120000
521300            PERFORM DP013-0000-PROCESS-ABEND                      52130000
521400     END-EVALUATE.                                                52140000
521500                                                                  52150000
521600                                                                  52160000
521700     PERFORM 7380-UPDATE-TRECEIV.                                 52170000
521800     INITIALIZE RC071-FIELDS.                                     52180081
521900     MOVE '0B'                      TO RC071-DC-FUNCTION-CODE.    52190081
522000     PERFORM 9950-CALL-PO-RCVR-TRKING-MOD.                        52200081
522100     PERFORM 7395-DELETE-TROUBLE.                                 52210000
522200/                                                                 52220000
522300*----------------------------------------------------------------*52230000
522400*    DUE TO THE SIZE OF THIS TABLE, A PHYSICAL DELETE OF THE     *52240000
522500*    ROW IS DONE RATHER THAN MAKING THE ROW 'I'NACTIVE.          *52250000
522600*----------------------------------------------------------------*52260000
522700                                                                  52270000
522800 7310-DELETE-TRECDIS.                                             52280000
522900                                                                  52290000
523000     EXEC SQL                                                     52300000
523100          DELETE                                                  52310000
523200            FROM TRECDIS                                          52320000
523300           WHERE ORD_NBR      = :DK-PO-NBR                        52330000
523400             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   52340000
523500             AND OPER_UNT_ID  = :DK-OPER-UNT-ID                   52350000
523600             AND FCLTY_ID     = :DK-FCLTY-ID                      52360000
523700     END-EXEC.                                                    52370000
523800                                                                  52380000
523900     EVALUATE TRUE                                                52390000
524000         WHEN SQLCODE = +0                                        52400000
524100         WHEN SQLCODE = +100                                      52410000
524200              CONTINUE                                            52420000
524300                                                                  52430000
524400         WHEN SQLWARN0 NOT = SPACES                               52440000
524500         WHEN SQLCODE < +0                                        52450000
524600         WHEN SQLCODE > +0                                        52460000
524700              MOVE '7310-DELETE-TRECDIS'                          52470000
524800                               TO DP013-PARAGRAPH                 52480000
524900              MOVE 'UNSUCCESSFUL DELETE ON TRECDIS'               52490000
525000                               TO DP013-MESSAGE-TEXT (1)          52500000
525100              MOVE SQLCA       TO DP013-SQLCA                     52510000
525200              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        52520000
525300              SET DP013-DB2-ABEND                                 52530000
525400                  DP013-XCTL-DISPLAY-RESTART                      52540000
525500                               TO TRUE                            52550000
525600              PERFORM DP013-0000-PROCESS-ABEND                    52560000
525700     END-EVALUATE.                                                52570000
525800                                                                  52580070
525900 7315-DELETE-ODD-UNIT.                                            52590070
526000                                                                  52600070
526100     EXEC SQL                                                     52610070
526200          DELETE                                                  52620070
526300            FROM RCT_VRFD_ODD_UNT                                 52630070
526400            WHERE PO_NBR         = :DK-PO-NBR                     52640070
526500              AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                52650070
526600     END-EXEC.                                                    52660070
526700                                                                  52670070
526800     EVALUATE TRUE                                                52680070
526900         WHEN SQLCODE = ZERO                                      52690070
527000         WHEN SQLCODE = +100                                      52700070
527100              CONTINUE                                            52710070
527200                                                                  52720070
527300         WHEN SQLWARN0 NOT = SPACES                               52730070
527400         WHEN SQLCODE  NOT = ZERO                                 52740070
527500              MOVE '7315-DELETE-ODD-UNIT'                         52750070
527600                             TO DP013-PARAGRAPH                   52760070
527700              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      52770070
527800                             TO DP013-MESSAGE-TEXT (1)            52780070
527900              MOVE DK-PO-NBR      TO PV-PO-NBR-PIC9               52790071
528000              MOVE DK-REC-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9          52800071
528100              MOVE WRKORD-ORD-LNE-NBR  TO PV-PO-LNE-NBR-PIC9      52810071
528200              STRING 'PO '                                        52820071
528300                     PV-PO-NBR-PIC9                               52830071
528400                     ' SEQ '                                      52840071
528500                     PV-REC-SEQ-NBR-PIC9                          52850071
528600                     ' LINE '                                     52860071
528700                     PV-PO-LNE-NBR-PIC9                           52870071
528800                     DELIMITED BY SIZE                            52880071
528900                     INTO DP013-MESSAGE-TEXT (2)                  52890071
529000              MOVE SQLCA     TO DP013-SQLCA                       52900070
529100              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         52910070
529200              SET DP013-DB2-ABEND                                 52920070
529300                  DP013-XCTL-DISPLAY-RESTART                      52930070
529400                             TO TRUE                              52940070
529500              PERFORM DP013-0000-PROCESS-ABEND                    52950070
529600     END-EVALUATE.                                                52960070
529700                                                                  52970070
529800                                                                  52980000
529900/                                                                 52990000
530000*----------------------------------------------------------------*53000000
530100* OPEN THE RECEIPT ITEM CURSOR                                   *53010000
530200*----------------------------------------------------------------*53020000
530300                                                                  53030000
530400 7320-OPEN-TRECITM-CSR.                                           53040000
530500                                                                  53050000
530600     EXEC SQL                                                     53060000
530700         OPEN TRECITM-CSR                                         53070000
530800     END-EXEC.                                                    53080000
530900                                                                  53090000
531000     EVALUATE TRUE                                                53100000
531100         WHEN SQLCODE = +0                                        53110000
531200              SET PS-NOT-END-OF-TRECITM                           53120000
531300                               TO TRUE                            53130000
531400                                                                  53140000
531500         WHEN SQLWARN0 NOT = SPACE                                53150000
531600         WHEN SQLCODE  NOT = +0                                   53160000
531700              MOVE '7320-OPEN-TRECITM-CSR'                        53170000
531800                               TO DP013-PARAGRAPH                 53180000
531900              MOVE 'OPEN TRECITM-CSR CURSOR'                      53190000
532000                               TO DP013-MESSAGE-TEXT (1)          53200000
532100              MOVE PV-ABEND-MSG-KEYS                              53210000
532200                               TO DP013-MESSAGE-TEXT (2)          53220000
532300              MOVE SQLCA       TO DP013-SQLCA                     53230000
532400              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        53240000
532500              SET DP013-DB2-ABEND                                 53250000
532600                               TO TRUE                            53260000
532700              PERFORM DP013-0000-PROCESS-ABEND                    53270000
532800     END-EVALUATE.                                                53280000
532900/                                                                 53290000
533000*----------------------------------------------------------------*53300000
533100*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE RECEIPT ITEM      *53310000
533200*  TABLE (TRECITM) FOR A SPECIFIED ROW.                          *53320000
533300*----------------------------------------------------------------*53330000
533400 7330-SELECT-TRECITM.                                             53340000
533500                                                                  53350000
533600     EXEC SQL                                                     53360000
533700       FETCH TRECITM-CSR                                          53370000
533800        INTO :RECITM-ORD-NBR                                      53380000
533900           , :RECITM-ORD-LNE-NBR                                  53390000
534000           , :RECITM-REC-SEQ-NBR                                  53400000
534100           , :RECITM-OPER-UNT-ID                                  53410000
534200           , :RECITM-FCLTY-ID                                     53420000
534300           , :RECITM-CRE-TMST                                     53430000
534400           , :RECITM-CRE-UID                                      53440000
534500           , :RECITM-PO-VER-NBR                                   53450000
534600           , :RECITM-ITM-NBR                                      53460000
534700           , :RECITM-PRE-TKT-IND                                  53470000
534800           , :RECITM-TKT-FMT-ID                                   53480000
534900           , :RECITM-RTV-IND                                      53490000
535000           , :RECITM-STATUS-CDE                                   53500000
535100           , :RECITM-VER-STATUS-CDE                               53510000
535200           , :RECITM-PKSL-ITM-QTY                                 53520000
535300           , :RECITM-DTL-CK-ITM-QTY                               53530000
535400           , :RECITM-INNR-PACK-QTY                                53540000
535500           , :RECITM-CASE-PACK-QTY                                53550000
535600           , :RECITM-RTV-QTY                                      53560000
535700           , :RECITM-EXPTED-CART-CNT                              53570000
535800           , :RECITM-ACTL-CART-CNT                                53580000
535900           , :RECITM-MKING-APRON-TMST                             53590000
536000           , :RECITM-UNT-COST-AMT                                 53600000
536100           , :RECITM-COLOR-DESC                                   53610000
536200           , :RECITM-SIZE-DESC                                    53620000
536300           , :RECITM-VEND-STYL-NAME                               53630000
536400           , :RECITM-VEND-DESC                                    53640000
536500           , :RECITM-VERFYD-TMST                                  53650000
536600           , :RECITM-PKSL-NBR                                     53660000
536700           , :RECITM-REC-INV-LNE-NBR                              53670000
536800           , :RECITM-DMG-ITM-QTY                                  53680000
536900           , :RECITM-UPD-TMST                                     53690000
537000           , :RECITM-UPD-UID                                      53700000
537100           , :RECITM-UPD-PGM-ID                                   53710000
537200           , :RECITM-RCPT-DISTR-UPD-CDE                           53720000
537300           , :RECITM-VRFD-USR-ID                                  53730000
537400           , :RECITM-PREPK-ID                                     53740081
537500     END-EXEC.                                                    53750000
537600                                                                  53760000
537700     EVALUATE TRUE                                                53770000
537800         WHEN SQLCODE = ZERO                                      53780000
537900              CONTINUE                                            53790000
538000                                                                  53800000
538100         WHEN SQLCODE = +100                                      53810000
538200              SET PS-END-OF-TRECITM                               53820000
538300                               TO TRUE                            53830000
538400         WHEN SQLWARN0 NOT = SPACES                               53840000
538500         WHEN SQLCODE  NOT = ZERO                                 53850000
538600              MOVE '7330-SELECT-TRECITM'                          53860000
538700                               TO DP013-PARAGRAPH                 53870000
538800              MOVE 'UNSUCCESSFUL SELECT OF TRECITM'               53880000
538900                               TO DP013-MESSAGE-TEXT (1)          53890000
539000              MOVE PV-ABEND-MSG-KEYS                              53900000
539100                               TO DP013-MESSAGE-TEXT (2)          53910000
539200              MOVE SQLCA       TO DP013-SQLCA                     53920000
539300              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        53930000
539400              SET DP013-DB2-ABEND                                 53940000
539500                  DP013-XCTL-DISPLAY-RESTART                      53950000
539600                               TO TRUE                            53960000
539700              PERFORM DP013-0000-PROCESS-ABEND                    53970000
539800     END-EVALUATE.                                                53980000
539900                                                                  53990000
540000/                                                                 54000000
540100                                                                  54010000
540200 7345-SELECT-CURRENT-TMST.                                        54020000
540300     EXEC SQL                                                     54030000
540400          SELECT CURRENT TIMESTAMP                                54040065
540500            INTO :PV-CURRENT-TMST                                 54050000
540600            FROM SYSIBM.SYSDUMMY1                                 54060065
540700     END-EXEC.                                                    54070000
540800                                                                  54080000
540900     EVALUATE TRUE                                                54090000
541000         WHEN SQLCODE = +0                                        54100000
541100              CONTINUE                                            54110000
541200                                                                  54120000
541300         WHEN SQLWARN0 NOT = SPACES                               54130000
541400         WHEN SQLCODE < +0                                        54140000
541500         WHEN SQLCODE > +0                                        54150000
541600              MOVE '7345-SELECT-CURRENT-TMST'                     54160000
541700                               TO DP013-PARAGRAPH                 54170000
541800              MOVE 'UNSUCCESSFUL SELECT ON TMST  '                54180000
541900                               TO DP013-MESSAGE-TEXT (1)          54190000
542000              MOVE PV-ABEND-MSG-KEYS                              54200000
542100                               TO DP013-MESSAGE-TEXT (2)          54210000
542200              MOVE SQLCA       TO DP013-SQLCA                     54220000
542300              SET DP013-DB2-ABEND                                 54230000
542400                  DP013-XCTL-DISPLAY-RESTART                      54240000
542500                               TO TRUE                            54250000
542600              PERFORM DP013-0000-PROCESS-ABEND                    54260000
542700     END-EVALUATE.                                                54270000
542800                                                                  54280000
542900                                                                  54290000
543000 7350-DELETE-TRECITM.                                             54300000
543100                                                                  54310000
543200     EXEC SQL                                                     54320000
543300          DELETE                                                  54330000
543400            FROM TRECITM                                          54340000
543500           WHERE ORD_NBR        = :DK-PO-NBR                      54350000
543600             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 54360000
543700             AND OPER_UNT_ID    = :DK-OPER-UNT-ID                 54370000
543800             AND FCLTY_ID       = :DK-FCLTY-ID                    54380000
543900             AND VER_STATUS_CDE = :PC-A                           54390000
544000     END-EXEC.                                                    54400000
544100                                                                  54410000
544200     EVALUATE TRUE                                                54420000
544300         WHEN SQLCODE = +0                                        54430000
544400         WHEN SQLCODE = +100                                      54440000
544500              CONTINUE                                            54450000
544600                                                                  54460000
544700         WHEN SQLWARN0 NOT = SPACES                               54470000
544800         WHEN SQLCODE < +0                                        54480000
544900         WHEN SQLCODE > +0                                        54490000
545000              MOVE '7350-DELETE-TRECITM'                          54500000
545100                               TO DP013-PARAGRAPH                 54510000
545200              MOVE 'UNSUCCESSFUL DELETE ON TRECITM'               54520000
545300                               TO DP013-MESSAGE-TEXT (1)          54530000
545400              MOVE SQLCA       TO DP013-SQLCA                     54540000
545500              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        54550000
545600              SET DP013-DB2-ABEND                                 54560000
545700                  DP013-XCTL-DISPLAY-RESTART                      54570000
545800                               TO TRUE                            54580000
545900              PERFORM DP013-0000-PROCESS-ABEND                    54590000
546000     END-EVALUATE.                                                54600000
546100                                                                  54610000
546200/                                                                 54620000
546300/                                                                 54630000
546400*----------------------------------------------------------------*54640000
546500* CLOSE THE RECEIPT ITEM CURSOR                                  *54650000
546600*----------------------------------------------------------------*54660000
546700                                                                  54670000
546800 7360-CLOSE-TRECITM-CSR.                                          54680000
546900                                                                  54690000
547000     EXEC SQL                                                     54700000
547100         CLOSE TRECITM-CSR                                        54710000
547200     END-EXEC.                                                    54720000
547300                                                                  54730000
547400     EVALUATE TRUE                                                54740000
547500         WHEN SQLCODE = +0                                        54750000
547600              CONTINUE                                            54760000
547700                                                                  54770000
547800         WHEN SQLWARN0 NOT = SPACE                                54780000
547900         WHEN SQLCODE  NOT = +0                                   54790000
548000              MOVE '7360-CLOSE-TRECITM-CSR'                       54800000
548100                                   TO DP013-PARAGRAPH             54810000
548200              MOVE 'CLOSE TRECITM-CSR CURSOR'                     54820000
548300                                   TO DP013-MESSAGE-TEXT (1)      54830000
548400              MOVE PV-ABEND-MSG-KEYS                              54840000
548500                                   TO DP013-MESSAGE-TEXT (2)      54850000
548600              MOVE SQLCA           TO DP013-SQLCA                 54860000
548700              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (1)    54870000
548800              SET DP013-DB2-ABEND  TO TRUE                        54880000
548900              PERFORM DP013-0000-PROCESS-ABEND                    54890000
549000     END-EVALUATE.                                                54900000
549100                                                                  54910000
549200/                                                                 54920000
549300*----------------------------------------------------------------*54930000
549400*  THIS PARAGRAPH WILL READ ALL COLUMNS IN THE RECEIVER TABLE    *54940000
549500*  (TRECEIV) FOR A SPECIFIED ROW.                                *54950000
549600*----------------------------------------------------------------*54960000
549700 7370-SELECT-TRECEIV.                                             54970000
549800                                                                  54980000
549900     EXEC SQL                                                     54990000
550000          SELECT ORD_NBR                                          55000000
550100                ,REC_SEQ_NBR                                      55010000
550200                ,CRE_TMST                                         55020000
550300                ,CRE_UID                                          55030000
550400                ,PO_VER_NBR                                       55040000
550500                ,OPER_UNT_ID                                      55050000
550600                ,FCLTY_ID                                         55060000
550700                ,STATUS_CDE                                       55070000
550800                ,SYST_CRE_CDE                                     55080000
550900                ,REC_TYP_CDE                                      55090000
551000                ,VER_STATUS_CDE                                   55100000
551100                ,PACK_BY_ST_IND                                   55110000
551200                ,REC_TMST                                         55120000
551300                ,EXPTED_CART_CNT                                  55130000
551400                ,ACTL_CART_CNT                                    55140000
551500                ,EXPTED_ITM_QTY                                   55150000
551600                ,ACTL_ITM_QTY                                     55160000
551700                ,RCVR_NBR                                         55170000
551800                ,ML_POST_TMST                                     55180000
551900                ,FS_POST_TMST                                     55190000
552000                ,PRE_TKT_IND                                      55200000
552100                ,AD_INFO_DESC                                     55210000
552200                ,IN_TRBL_TMST                                     55220000
552300                ,IN_TRBL_MIN_CNT                                  55230000
552400                ,IN_TRBL_HOUR_CNT                                 55240000
552500                ,VERFYD_TMST                                      55250000
552600                ,RCVG_CLERK_INIT_ID                               55260000
552700                ,REFER_BACK_SEQ_NBR                               55270000
552800                ,AP_PRC_CDE                                       55280000
552900                ,AP_PRC_DTE                                       55290000
553000                ,MIS_DIRECT_IND                                   55300000
553100                ,IMPRT_IND                                        55310000
553200                ,CRE_OPER_UNT_ID                                  55320000
553300                ,CRE_FCLTY_ID                                     55330000
553400                ,CURR_OPER_UNT_ID                                 55340000
553500                ,CURR_FCLTY_ID                                    55350000
553600                ,UPD_TMST                                         55360000
553700                ,UPD_UID                                          55370000
553800                ,UPD_PGM_ID                                       55380000
553900                ,APRON_LOC_DESC                                   55390000
554000                ,MKNG_APRN_PRT_TMST                               55400000
554100                ,GOH_IND                                          55410000
554200                ,VRFD_USR_ID                                      55420000
554300            INTO :RECEIV-ORD-NBR                                  55430000
554400                ,:RECEIV-REC-SEQ-NBR                              55440000
554500                ,:RECEIV-CRE-TMST                                 55450000
554600                ,:RECEIV-CRE-UID                                  55460000
554700                ,:RECEIV-PO-VER-NBR                               55470000
554800                ,:RECEIV-OPER-UNT-ID                              55480000
554900                ,:RECEIV-FCLTY-ID                                 55490000
555000                ,:RECEIV-STATUS-CDE                               55500000
555100                ,:RECEIV-SYST-CRE-CDE                             55510000
555200                ,:RECEIV-REC-TYP-CDE                              55520000
555300                ,:RECEIV-VER-STATUS-CDE                           55530000
555400                ,:RECEIV-PACK-BY-ST-IND                           55540000
555500                ,:RECEIV-REC-TMST                                 55550000
555600                ,:RECEIV-EXPTED-CART-CNT                          55560000
555700                ,:RECEIV-ACTL-CART-CNT                            55570000
555800                ,:RECEIV-EXPTED-ITM-QTY                           55580000
555900                ,:RECEIV-ACTL-ITM-QTY                             55590000
556000                ,:RECEIV-RCVR-NBR                                 55600000
556100                ,:RECEIV-ML-POST-TMST                             55610000
556200                ,:RECEIV-FS-POST-TMST                             55620000
556300                ,:RECEIV-PRE-TKT-IND                              55630000
556400                ,:RECEIV-AD-INFO-DESC                             55640000
556500                ,:RECEIV-IN-TRBL-TMST                             55650000
556600                ,:RECEIV-IN-TRBL-MIN-CNT                          55660000
556700                ,:RECEIV-IN-TRBL-HOUR-CNT                         55670000
556800                ,:RECEIV-VERFYD-TMST                              55680000
556900                ,:RECEIV-RCVG-CLERK-INIT-ID                       55690000
557000                ,:RECEIV-REFER-BACK-SEQ-NBR                       55700000
557100                ,:RECEIV-AP-PRC-CDE                               55710000
557200                ,:RECEIV-AP-PRC-DTE                               55720000
557300                ,:RECEIV-MIS-DIRECT-IND                           55730000
557400                ,:RECEIV-IMPRT-IND                                55740000
557500                ,:RECEIV-CRE-OPER-UNT-ID                          55750000
557600                ,:RECEIV-CRE-FCLTY-ID                             55760000
557700                ,:RECEIV-CURR-OPER-UNT-ID                         55770000
557800                ,:RECEIV-CURR-FCLTY-ID                            55780000
557900                ,:RECEIV-UPD-TMST                                 55790000
558000                ,:RECEIV-UPD-UID                                  55800000
558100                ,:RECEIV-UPD-PGM-ID                               55810000
558200                ,:RECEIV-APRON-LOC-DESC                           55820000
558300                ,:RECEIV-MKNG-APRN-PRT-TMST                       55830000
558400                ,:RECEIV-GOH-IND                                  55840000
558500                ,:RECEIV-VRFD-USR-ID                              55850000
558600            FROM TRECEIV                                          55860000
558700           WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                    55870000
558800             AND FCLTY_ID    = :DK-FCLTY-ID                       55880000
558900             AND ORD_NBR     = :DK-PO-NBR                         55890000
559000             AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                    55900000
559100             AND VER_STATUS_CDE = 'A'                             55910000
559200     END-EXEC.                                                    55920000
559300                                                                  55930000
559400     EVALUATE TRUE                                                55940000
559500         WHEN SQLCODE = +0                                        55950000
559600         WHEN SQLCODE = +100                                      55960000
559700              CONTINUE                                            55970000
559800                                                                  55980000
559900         WHEN SQLWARN0 NOT = SPACES                               55990000
560000         WHEN SQLCODE < +0                                        56000000
560100         WHEN SQLCODE > +0                                        56010000
560200              MOVE '7370-SELECT-TRECEIV'                          56020000
560300                               TO DP013-PARAGRAPH                 56030000
560400              MOVE 'UNSUCCESSFUL SELECT ON TRECEIV  '             56040000
560500                               TO DP013-MESSAGE-TEXT (1)          56050000
560600              MOVE PV-ABEND-MSG-KEYS                              56060000
560700                               TO DP013-MESSAGE-TEXT (2)          56070000
560800              MOVE SQLCA       TO DP013-SQLCA                     56080000
560900              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        56090000
561000              SET DP013-DB2-ABEND                                 56100000
561100                  DP013-XCTL-DISPLAY-RESTART                      56110000
561200                               TO TRUE                            56120000
561300              PERFORM DP013-0000-PROCESS-ABEND                    56130000
561400     END-EVALUATE.                                                56140000
561500                                                                  56150000
561600 7380-UPDATE-TRECEIV.                                             56160000
561700                                                                  56170000
561800     EXEC SQL                                                     56180000
561900          UPDATE TRECEIV                                          56190000
562000              SET STATUS_CDE      = :PC-DE                        56200000
562100                 ,VER_STATUS_CDE  = :PC-I                         56210000
562200                 ,UPD_TMST        = CURRENT TIMESTAMP             56220000
562300                 ,UPD_UID         = :DP020-USERID                 56230000
562400                 ,UPD_PGM_ID      = :PC-CURRENT-PROGRAM-NAME      56240000
562500           WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                 56250000
562600             AND FCLTY_ID       = :DK-FCLTY-ID                    56260000
562700             AND ORD_NBR        = :DK-PO-NBR                      56270000
562800             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 56280000
562900             AND VER_STATUS_CDE = 'A'                             56290000
563000     END-EXEC.                                                    56300000
563100                                                                  56310000
563200     EVALUATE TRUE                                                56320000
563300         WHEN SQLCODE = +0                                        56330000
563400              CONTINUE                                            56340000
563500                                                                  56350000
563600         WHEN SQLWARN0 NOT = SPACES                               56360000
563700         WHEN SQLCODE < +0                                        56370000
563800         WHEN SQLCODE > +0                                        56380000
563900              MOVE '7380-UPDATE-TRECEIV'                          56390000
564000                               TO DP013-PARAGRAPH                 56400000
564100              MOVE 'UNSUCCESSFUL DELETE ON TRECDIS'               56410000
564200                               TO DP013-MESSAGE-TEXT (1)          56420000
564300              MOVE SQLCA       TO DP013-SQLCA                     56430000
564400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        56440000
564500              SET DP013-DB2-ABEND                                 56450000
564600                  DP013-XCTL-DISPLAY-RESTART                      56460000
564700                               TO TRUE                            56470000
564800              PERFORM DP013-0000-PROCESS-ABEND                    56480000
564900     END-EVALUATE.                                                56490000
565000                                                                  56500000
565100/                                                                 56510000
565200*----------------------------------------------------------------*56520000
565300*    BY DELETING THE NOTIFICATION ROWS, R.I. WITH DELETE CASCADE *56530000
565400*    DELETES ALL TROUBLE DETAIL ROWS AS WELL.                    *56540000
565500*----------------------------------------------------------------*56550000
565600                                                                  56560000
565700 7395-DELETE-TROUBLE.                                             56570000
565800                                                                  56580000
565900     EXEC SQL                                                     56590000
566000          DELETE                                                  56600000
566100            FROM TTRBNTF                                          56610000
566200           WHERE PO_NBR       = :DK-PO-NBR                        56620000
566300             AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   56630000
566400     END-EXEC.                                                    56640000
566500                                                                  56650000
566600     EVALUATE TRUE                                                56660000
566700         WHEN SQLCODE = +0                                        56670000
566800         WHEN SQLCODE = +100                                      56680000
566900              CONTINUE                                            56690000
567000                                                                  56700000
567100         WHEN SQLWARN0 NOT = SPACES                               56710000
567200         WHEN SQLCODE < +0                                        56720000
567300         WHEN SQLCODE > +0                                        56730000
567400              MOVE '7395-DELETE-TROUBLE'                          56740000
567500                               TO DP013-PARAGRAPH                 56750000
567600              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               56760000
567700                               TO DP013-MESSAGE-TEXT (1)          56770000
567800              MOVE PV-ABEND-MSG-KEYS                              56780000
567900                               TO DP013-MESSAGE-TEXT (2)          56790000
568000              MOVE SQLCA       TO DP013-SQLCA                     56800000
568100              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        56810000
568200              SET DP013-DB2-ABEND                                 56820000
568300                  DP013-XCTL-DISPLAY-RESTART                      56830000
568400                               TO TRUE                            56840000
568500              PERFORM DP013-0000-PROCESS-ABEND                    56850000
568600     END-EVALUATE.                                                56860000
568700/                                                                 56870000
568710* JAK 06/2007 - ADD CODE TO CALL SHIPMENT CONTROL MODULE          56871086
568720******************************************************************56872082
568730*  THIS PARAGRAPH CHECKS TO SEE IF THE DC IS DOWNLOADING TO WMS   56873082
568740******************************************************************56874082
568750 7400-CHECK-ASNDWN.                                               56875082
568760                                                                  56876082
568770     MOVE RECEIV-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.               56877082
568780                                                                  56878082
568790     EXEC SQL                                                     56879082
568791          SELECT   FUNC_TXT                                       56879182
568792            INTO  :KRPRPM-FUNC-TXT                                56879282
568793            FROM                                                  56879382
568794                  TKRPRPM                                         56879482
568795            WHERE                                                 56879582
568796                  LOC_ID            = :KRPRPM-LOC-ID              56879682
568797              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    56879782
568798              AND FUNC_PRC_STAT_CDE = 'AC'                        56879882
568799              AND INTFC_SYS_CDE     = 'KHL'                       56879982
568800              AND FUNC_TXT          = 'Y'                         56880082
568810              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            56881082
568811     END-EXEC.                                                    56881182
568812                                                                  56881282
568813     EVALUATE TRUE                                                56881382
568814         WHEN SQLCODE = ZERO                                      56881482
568815              SET PS-ASNS-TO-WMS-YES    TO TRUE                   56881582
568816         WHEN SQLCODE = +100                                      56881682
568817              SET PS-ASNS-TO-WMS-NO     TO TRUE                   56881782
568822         WHEN SQLWARN0 NOT = SPACES                               56882282
568823         WHEN SQLCODE  NOT = ZERO                                 56882382
568824             SET PS-ERROR             TO TRUE                     56882482
568825             MOVE '7400-CHECK-ASNDWN' TO DP013-PARAGRAPH          56882582
568826             MOVE 'UNSUCCESSFUL CHECK OF TKRPRPM'                 56882682
568827                            TO DP013-MESSAGE-TEXT (1)             56882782
568828             MOVE SQLCA     TO DP013-SQLCA                        56882882
568829             MOVE 'TKRPRPM' TO DP013-DB2-TABLE-NAME (1)           56882982
568830             SET DP013-DB2-ABEND                                  56883082
568831                 DP013-XCTL-DISPLAY-RESTART TO TRUE               56883182
568832             PERFORM DP013-0000-PROCESS-ABEND                     56883282
568833     END-EVALUATE.                                                56883382
568834                                                                  56883482
568835***************************************************************** 56883582
568836*  THIS PARAGRAPH GETS THE CURRENT OPER ID                        56883682
568837***************************************************************** 56883782
568838 7410-SELECT-TRECEIV.                                             56883882
568839                                                                  56883982
568840     MOVE ASC-KEY-PO-NBR         TO RECEIV-ORD-NBR.               56884082
568841     MOVE ASC-KEY-REC-SEQ-NBR    TO RECEIV-REC-SEQ-NBR.           56884182
568842                                                                  56884282
568843     EXEC SQL                                                     56884382
568844          SELECT   CURR_OPER_UNT_ID                               56884482
568845            INTO  :RECEIV-CURR-OPER-UNT-ID                        56884582
568846            FROM                                                  56884682
568847                  TRECEIV                                         56884782
568848            WHERE                                                 56884882
568849                  ORD_NBR           = :RECEIV-ORD-NBR             56884982
568850              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         56885082
568851              AND VER_STATUS_CDE    = 'A'                         56885182
568852     END-EXEC.                                                    56885282
568853                                                                  56885382
568854     EVALUATE TRUE                                                56885482
568855         WHEN SQLCODE = ZERO                                      56885582
568856         WHEN SQLCODE = -811                                      56885682
568857              CONTINUE                                            56885782
568858         WHEN SQLCODE = +100                                      56885882
568859              MOVE ZERO             TO RECEIV-CURR-OPER-UNT-ID    56885982
568864         WHEN SQLWARN0 NOT = SPACES                               56886482
568865         WHEN SQLCODE  NOT = ZERO                                 56886582
568866             SET PS-ERROR             TO TRUE                     56886682
568867             MOVE '7410-SELECT-TRECEIV' TO DP013-PARAGRAPH        56886782
568868             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                56886882
568869                            TO DP013-MESSAGE-TEXT (1)             56886982
568870             MOVE SQLCA     TO DP013-SQLCA                        56887082
568871             MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)           56887182
568872             SET DP013-DB2-ABEND                                  56887282
568873                 DP013-XCTL-DISPLAY-RESTART TO TRUE               56887382
568874             PERFORM DP013-0000-PROCESS-ABEND                     56887482
568875     END-EVALUATE.                                                56887582
568876                                                                  56887682
568928***************************************************************** 56892882
568929*  THIS PARAGRAPH GETS THE TRIP-ID FROM THE PO/RCVR.              56892982
568930***************************************************************** 56893082
568931 7430-GET-TRIP-ID.                                                56893182
568932                                                                  56893282
568933     MOVE ASC-KEY-PO-NBR        TO SHPTPO-PO-NBR.                 56893382
568934     MOVE ASC-KEY-REC-SEQ-NBR   TO SHPTPO-REC-SEQ-NBR.            56893482
568935                                                                  56893582
568936     EXEC SQL                                                     56893682
568937         SELECT A.TRIP_ID                                         56893782
568938           INTO :SHIPMT-TRIP-ID                                   56893882
568939           FROM TSHIPMT   A                                       56893982
568940              , TSHPTPO   B                                       56894082
568941          WHERE B.PO_NBR         = :SHPTPO-PO-NBR                 56894182
568942            AND B.REC_SEQ_NBR    = :SHPTPO-REC-SEQ-NBR            56894282
568943            AND A.SHIPT_ID       = B.SHIPT_ID                     56894382
568944            AND B.PRIM_SHIPT_IND = 'Y'                            56894483
568945     END-EXEC.                                                    56894583
568946                                                                  56894683
568947     EVALUATE TRUE                                                56894783
568948         WHEN SQLCODE = ZERO                                      56894883
568949             CONTINUE                                             56894983
568954         WHEN SQLWARN0 NOT = SPACES                               56895483
568955         WHEN SQLCODE  NOT = ZERO                                 56895583
568956             SET PS-ERROR             TO TRUE                     56895683
568957             MOVE '7430-GET-TRIP-ID' TO DP013-PARAGRAPH           56895783
568958             MOVE 'UNSUCCESSFUL SELECT OF TRIP-ID'                56895883
568959                            TO DP013-MESSAGE-TEXT (1)             56895983
568960             MOVE SQLCA     TO DP013-SQLCA                        56896083
568961             MOVE 'TSHIPMT' TO DP013-DB2-TABLE-NAME (1)           56896183
568962             MOVE 'TSHPTPO' TO DP013-DB2-TABLE-NAME (2)           56896283
568963             SET DP013-DB2-ABEND                                  56896383
568964                 DP013-XCTL-DISPLAY-RESTART TO TRUE               56896483
568965             PERFORM DP013-0000-PROCESS-ABEND                     56896583
568966     END-EVALUATE.                                                56896683
568967                                                                  56896783
568968*---------------------------------------------------------------- 56896883
568969* LINK TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     56896983
568970*  COPYBOOK WSWS001.                                              56897083
568971*---------------------------------------------------------------- 56897183
568972 7440-CALL-WMS-MODULE.                                            56897283
568973                                                                  56897383
568974     SET WS001-PKSLIP-INACTIVE      TO TRUE.                      56897483
568975     MOVE SHIPMT-TRIP-ID            TO WS001-TRIP-ID.             56897583
568976     MOVE ASC-KEY-OPER-UNT-ID       TO WS001-OPER-UNT-ID.         56897683
568977     MOVE DP020-USERID              TO WS001-USER-ID.             56897783
568978     MOVE ASC-KEY-PO-NBR            TO WS001-PO-NBR.              56897883
568979     MOVE ZEROS                     TO WS001-PO-LNE-NBR.          56897983
568980     MOVE ASC-KEY-REC-SEQ-NBR       TO WS001-RCVR-NBR.            56898083
568981     MOVE ZEROS                     TO WS001-PREPK-ID.            56898183
568982     MOVE ZEROS                     TO WS001-SKU-NBR.             56898283
568983     MOVE ZEROS                     TO WS001-KOHLS-SHIPT-ID.      56898383
568984     MOVE 'RC'                      TO WS001-SHIPMENT-SOURCE.     56898483
568985     MOVE SPACES                    TO WS001-DTL-ASN-LEVEL-IND.   56898583
568986     MOVE DP020-SRC-TASK-NUMBER     TO WS001-SRC-TASK-NUMBER.     56898683
568987     MOVE PC-CURRENT-PROGRAM-NAME   TO WS001-CALLING-PROGRAM-NAME.56898783
568988                                                                  56898883
568989     MOVE LENGTH OF WS001-FIELDS    TO PV-COMMAREA-LENGTH.        56898983
568990                                                                  56899083
568991     EXEC CICS                                                    56899183
568992         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       56899283
568993              COMMAREA (WS001-FIELDS)                             56899383
568994              LENGTH   (PV-COMMAREA-LENGTH)                       56899483
568995     END-EXEC.                                                    56899583
568996                                                                  56899683
568997     EVALUATE TRUE                                                56899783
568998         WHEN WS001-SUCCESSFUL                                    56899883
568999              CONTINUE                                            56899983
569000                                                                  56900083
569001         WHEN OTHER                                               56900183
569002             SET PS-ERROR             TO TRUE                     56900283
569003             SET DP013-CICS-ABEND                                 56900383
569004                 DP013-NO-ROLLBACK TO TRUE                        56900483
569005             MOVE '7440-CALL-WMS-MODULE'   TO DP013-PARAGRAPH     56900583
569006             MOVE 'UNSUCCESSFUL CALL TO SHIPPING CONTROL MODULE'  56900683
569007                  TO DP013-MESSAGE-TEXT (1)                       56900783
569008             PERFORM DP013-0000-PROCESS-ABEND                     56900883
569009                                                                  56900983
569010     END-EVALUATE.                                                56901083
569011                                                                  56901183
569012* JAK 06/2007 - END                                               56901286
569013                                                                  56901383
569014*----------------------------------------------------------------*56901483
569015* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *56901583
569020*----------------------------------------------------------------*56902000
569100                                                                  56910000
569200 9100-READ-SEL-QUEUE.                                             56920000
569300     EXEC CICS                                                    56930000
569400         READQ TS                                                 56940000
569500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        56950000
569600             INTO  (RC013-DC-SELECT-RECORD)                       56960000
569700             ITEM  (ASC-SEL-ITEM)                                 56970000
569800             RESP  (PV-CICS-RESP)                                 56980000
569900     END-EXEC.                                                    56990000
570000                                                                  57000000
570100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       57010000
570200         CONTINUE                                                 57020000
570300     ELSE                                                         57030000
570400         SET DP013-LOGIC-ABEND                                    57040000
570500             DP013-NO-ROLLBACK     TO TRUE                        57050000
570600         MOVE '9100-READ-SEL-QUEUE'                               57060000
570700                                   TO DP013-PARAGRAPH             57070000
570800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   57080000
570900                                   TO DP013-MESSAGE-TEXT (1)      57090000
571000         PERFORM DP013-0000-PROCESS-ABEND                         57100000
571100     END-IF.                                                      57110000
571200*----------------------------------------------------------------*57120000
571300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *57130000
571400*----------------------------------------------------------------*57140000
571500 9200-REWRITE-LIST-QUEUE.                                         57150000
571600     EXEC CICS                                                    57160000
571700          WRITEQ TS                                               57170000
571800              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      57180000
571900              FROM   (RC013-DC-SELECT-RECORD)                     57190000
572000              ITEM   (ASC-SEL-ITEM)                               57200000
572100              RESP   (PV-CICS-RESP)                               57210000
572200              REWRITE                                             57220000
572300     END-EXEC.                                                    57230000
572400                                                                  57240000
572500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   57250000
572600         SET DP013-CICS-ABEND                                     57260000
572700             DP013-NO-ROLLBACK     TO TRUE                        57270000
572800         MOVE '9200-REWRITE-LIST-QUEUE'                           57280000
572900                                   TO DP013-PARAGRAPH             57290000
573000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   57300000
573100                                   TO DP013-MESSAGE-TEXT (1)      57310000
573200         PERFORM DP013-0000-PROCESS-ABEND                         57320000
573300     END-IF.                                                      57330000
573400                                                                  57340000
573500 EJECT                                                            57350000
573600                                                                  57360081
573601 9903-WRITE-CICS-LOG.                                             57360195
573602                                                                  57360295
573603     EXEC CICS                                                    57360395
573604         WRITEQ TD                                                57360495
573605             QUEUE  ('CSSL')                                      57360595
573606             FROM   (PV-CICS-MSG-AREA)                            57360695
573607             RESP   (PV-CICS-RESP)                                57360795
573608     END-EXEC.                                                    57360895
573609     MOVE SPACES                  TO PV-CICS-MSG-AREA.            57360995
573610                                                                  57361095
573620                                                                  57362095
573700 9950-CALL-PO-RCVR-TRKING-MOD.                                    57370081
573800                                                                  57380081
573900     MOVE DK-PO-NBR                 TO RC071-PO-NBR.              57390081
574000     MOVE DK-REC-SEQ-NBR            TO RC071-PO-RCVR.             57400081
574100     IF RC071-DC-FUNCTION-CODE = '0B'                             57410081
574200         MOVE ZEROES                    TO RC071-PREPK-ID         57420081
574300         MOVE ZEROES                    TO RC071-PO-LINE          57430081
574400     ELSE                                                         57440081
574500         IF RECEIV-PKGNG-CDE = 'I' OR 'M'                         57450081
574600            MOVE RECITM-PREPK-ID           TO RC071-PREPK-ID      57460081
574700            MOVE ZEROES                    TO RC071-PO-LINE       57470081
574800         ELSE                                                     57480081
574900            MOVE RECITM-ORD-LNE-NBR        TO RC071-PO-LINE       57490081
575000            MOVE ZEROES                    TO RC071-PREPK-ID      57500081
575100         END-IF                                                   57510081
575200     END-IF.                                                      57520081
575300     MOVE DK-OPER-UNT-ID            TO RC071-SIGNON-LOCATION.     57530081
575400     MOVE DP020-USERID              TO RC071-USER-ID.             57540081
575500     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM.     57550081
575600                                                                  57560081
575700     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  57570081
575800                                        RC071-COMMAREA            57580081
575900                                        RC071-FIELDS.             57590081
576000                                                                  57600081
576100     IF RC071-SUCCESSFUL                                          57610081
576200         CONTINUE                                                 57620081
576300     ELSE                                                         57630081
576400         SET DP013-NO-ROLLBACK                                    57640081
576500             DP013-CICS-ABEND      TO TRUE                        57650081
576600         MOVE '9950-CALL-PO-RCVR-TRKING-MOD'                      57660081
576700                                   TO DP013-PARAGRAPH             57670081
576800         MOVE DK-PO-NBR            TO PV-PO-NBR-PIC9              57680081
576900         MOVE DK-REC-SEQ-NBR       TO PV-REC-SEQ-NBR-PIC9         57690081
577000         STRING                                                   57700081
577100               'CALL TO RCKUT137 NOT SUCCESSFUL '                 57710081
577200               'RETURN CODE = '                                   57720081
577300               RC071-SUCCESS-IND                                  57730081
577400                                DELIMITED BY SIZE                 57740081
577500                                 INTO DP013-MESSAGE-TEXT (1)      57750081
577600         STRING 'PO/RECEIVER = '                                  57760081
577700                 PV-PO-NBR-PIC9                                   57770081
577800                 ' '                                              57780081
577900                 PV-REC-SEQ-NBR-PIC9                              57790081
578000                                DELIMITED BY SIZE                 57800081
578100                                 INTO DP013-MESSAGE-TEXT (2)      57810081
578200         PERFORM DP013-0000-PROCESS-ABEND                         57820081
578300                                                                  57830081
578400      END-IF.                                                     57840081
578500                                                                  57850081
578600 EJECT                                                            57860000
578700*----------------------------------------------------------------*57870000
578800*    ABEND PROCESSOR MODULE                                      *57880000
578900*----------------------------------------------------------------*57890000
579000                                                                  57900000
579100     COPY DPPD013.                                                57910074
