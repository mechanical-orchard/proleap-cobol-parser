000100***************************************************************** 00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300***************************************************************** 00030099
000400                                                                  00040099
000500 PROGRAM-ID.             SUKRP002.                                00050099
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060099
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070099
000800 DATE-WRITTEN            JUNE, 1996.                              00080099
000900 DATE-COMPILED.                                                   00090099
001000***************************************************************** 00100099
001100***************************************************************** 00110099
001200*                                                               * 00120099
001300*  THIS PROGRAM WILL PRINT THE UCC-128 CHECK-IN STATISTICS      * 00130099
001400*  REPORT.                                                      * 00140099
001500***************************************************************** 00150099
001600*  CHANGED 03/31/98 BY DENISE HAHN                              * 00160099
001700*   WR# 6154 ADD USERID'S OF THE RECEIVING ASSOCIATES WHO       * 00170099
001800*            CHECKED-IN THE TRAILER TO THE CHECK-IN COMPLETION  * 00180099
001900*            REPORT.  CREATE HEADING-LINE-3B.                   * 00190099
002000*                                                               * 00200099
002100***************************************************************** 00210099
002200*  CHANGED 04/24/98 BY DENISE HAHN                              * 00220099
002300*   WR# 6203 ADDED FIELD TO CONTROL CARD - WHEN = 'C', THIS     * 00230099
002400*            THAT THERE IS ONLY 1 REPORT TO PRINT AND THAT THE  * 00240099
002500*            PRINTER SHOULD CUT THE PAPER AFTER THE REPORT IS   * 00250099
002600*            COMPLETE.                                          * 00260099
002700*                                                               * 00270099
002800***************************************************************** 00280099
002900*  CHANGED 08/04/00 BY LARRY SCHLEICHER                         * 00290099
003000*   WR#      ADDED CHECKS TO DETERMINE IF THE PO HAS HAD A      * 00300099
003100*            'REDO ON CASEPACK' OR HAS 'INACTIVE PACKSLIPS'.    * 00310099
003200*            FOR PO'S WHERE THIS IS TRUE, ADDED THE MESSAGE     * 00320099
003300*            TO THE REMARKS SECTION.                            * 00330099
003400*                                                               * 00340099
003500***************************************************************** 00350099
003600*  CHANGED 10/24/02 BY ALBERT A VINOD                           * 00360099
003700*   WR# 21361 REMOVED GROUP VARIABLE PV-SKU AND REMOVED ALL     * 00370099
003800*             REFERENCES OF DB2 TABLES TSK AND TUPCSKU.         * 00380099
003500***************************************************************** 00381099
003600*  CHANGED 09/30/14 BY CHERI PARMLEY                            * 00382099
003700*   CHG# 0094517  EXPANDED PO# FROM 7 TO 8 DIGITS               * 00383099
003900***************************************************************** 00390099
004000*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00400099
004100*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00410099
004200*                                                               * 00420099
004300***************************************************************** 00430099
004400***************************************************************** 00440099
004500 ENVIRONMENT DIVISION.                                            00450099
004600***************************************************************** 00460099
004700                                                                  00470099
004800 CONFIGURATION SECTION.                                           00480099
004900                                                                  00490099
005000 SOURCE-COMPUTER.        IBM-3090.                                00500099
005100 OBJECT-COMPUTER.        IBM-3090.                                00510099
005200                                                                  00520099
005300 INPUT-OUTPUT SECTION.                                            00530099
005400                                                                  00540099
005500 FILE-CONTROL.                                                    00550099
005600*                                                                 00560099
005700     SELECT EXTRACT-FILE                                          00570099
005800         ASSIGN TO INP01.                                         00580099
005900                                                                  00590099
006000     SELECT SU-CARTON-NOT-RCVD-FILE                               00600099
006100         ASSIGN TO RPT01.                                         00610099
006200*                                                                 00620099
006300***************************************************************** 00630099
006400 DATA DIVISION.                                                   00640099
006500***************************************************************** 00650099
006600*                                                                 00660099
006700 FILE SECTION.                                                    00670099
006800*                                                                 00680099
006900 FD  EXTRACT-FILE                                                 00690099
007000     LABEL RECORDS ARE STANDARD                                   00700099
007100     RECORDING MODE IS F                                          00710099
007200     BLOCK CONTAINS 0 RECORDS                                     00720099
007300     RECORD CONTAINS 200 CHARACTERS.                              00730099
007400 01  EXTRACT-RECORD                  PIC X(200).                  00740099
007500                                                                  00750099
007600 FD  SU-CARTON-NOT-RCVD-FILE                                      00760099
007700     RECORDING MODE IS F                                          00770099
007800     BLOCK CONTAINS 0  RECORDS.                                   00780099
007900 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00790099
008000*                                                                 00800099
008100                                                                  00810099
008200 WORKING-STORAGE SECTION.                                         00820099
008300**************************************************************    00830099
008400* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00840099
008500**************************************************************    00850099
008600 01  CC-CONTROL-CARD.                                             00860099
008700     05  CC-PRINTER-ID                PIC  X(08).                 00870099
008800     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00880099
008900     05  CC-TRACK-NBR                 PIC  9(01).                 00890099
009000     05  FILLER                       PIC  X(01).                 00900099
009100     05  CC-CUT-REPORT                PIC  X(01).                 00910099
009200         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00920099
009300     05  CC-REQUESTOR-ID              PIC  X(08).                 00930099
009400     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00940099
009500         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00950099
009600     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00960099
009700         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00970099
009800     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00980099
009900         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00990099
010000     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 01000099
010100         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     01010099
010200     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 01020099
010300         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     01030099
010400     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 01040099
010500         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     01050099
010600     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 01060099
010700         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     01070099
010800*JPL                                                              01080099
010900     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 01090099
011000         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     01100099
011100     05  FILLER                       PIC  X(01).                 01110099
011200     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 01120099
011300         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     01130099
011400         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     01140099
011500*                                                                 01150099
011600 01  PROGRAM-SWITCHES.                                            01160099
011700     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     01170099
011800         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     01180099
011900     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01190099
012000         88  PS-STATUS-FOUND                       VALUE 'Y'.     01200099
012100         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01210099
012200     05  PS-PO-FOUND-SW              PIC  X(01)    VALUE 'Y'.     01220099
012300         88  PS-PO-FOUND                           VALUE 'Y'.     01230099
012400         88  PS-PO-NOT-FOUND                       VALUE 'N'.     01240099
012500     05  PS-DETAIL-REC-WRITTEN-SW    PIC  X(01)    VALUE 'N'.     01250099
012600         88  PS-DETAIL-REC-WRITTEN                 VALUE 'Y'.     01260099
012700         88  PS-NO-DETAIL-REC-WRITTEN              VALUE 'N'.     01270099
012800     05  PS-PO-SEQUENCE-CHANGE-SW    PIC  X(01)    VALUE 'N'.     01280099
012900         88  PS-PO-SEQUENCE-SET                    VALUE 'N'.     01290099
013000         88  PS-PO-SEQUENCE-CHANGE                 VALUE 'Y'.     01300099
013100     05  PS-EOF-UID-CURSOR-IND       PIC  X(01)    VALUE 'N'.     01310099
013200         88  PS-EOF-UID-CURSOR                     VALUE 'Y'.     01320099
013300         88  PS-NOT-EOF-UID-CURSOR                 VALUE 'N'.     01330099
013400     05  PS-EOF-RCVR-CURSOR-IND      PIC  X(01)    VALUE 'N'.     01340099
013500         88  PS-EOF-RCVR-CURSOR                    VALUE 'Y'.     01350099
013600         88  PS-NOT-EOF-RCVR-CURSOR                VALUE 'N'.     01360099
013700     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01370099
013800         88  PS-ERROR-RECORD                       VALUE 'A'.     01380099
013900         88  PS-DETAIL-RECORD                      VALUE 'B'.     01390099
014000*                                                                 01400099
014100 01  PC-CONSTANTS.                                                01410099
014200     05  PC-1                        PIC S9(03)    VALUE +1       01420099
014300                                                   COMP-3.        01430099
014400     05  PC-2                        PIC S9(03)    VALUE +2       01440099
014500                                                   COMP-3.        01450099
014600     05  PC-3                        PIC S9(03)    VALUE +3       01460099
014700                                                   COMP-3.        01470099
014800     05  PC-7                        PIC S9(01)    VALUE +7.      01480099
014900     05  PC-11                       PIC S9(03)    VALUE +11      01490099
015000                                                   COMP-3.        01500099
015100     05  PC-13                       PIC S9(03)    VALUE +13      01510099
015200                                                   COMP-3.        01520099
015300     05  PC-60                       PIC S9(03)    VALUE +60      01530099
015400                                                   COMP-3.        01540099
015500     05  PC-NINE-9-9                 PIC S9(09)    COMP           01550099
015600                                        VALUE +999999999.         01560099
015700     05  PC-NEG-9S                       PIC S9(09)               01570099
015800                                        VALUE -999999999.         01580099
015900     05  PC-NINE-9-18                PIC S9(18)    COMP-3         01590099
016000                                        VALUE +999999999999999999.01600099
016100     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01610099
016200     05  PC-AST                      PIC  X(03)    VALUE '***'.   01620099
016300     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01630099
016400     05  PC-00                       PIC  X(02)    VALUE '00'.    01640099
016500     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01650099
016600     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01660099
016700     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01670099
016800     05  PC-IN                       PIC  X(02)    VALUE 'IN'.    01680099
016900     05  PC-A                        PIC  X(01)    VALUE 'A'.     01690099
017000     05  PC-B                        PIC  X(01)    VALUE 'B'.     01700099
017100     05  PC-N                        PIC  X(01)    VALUE 'N'.     01710099
017200     05  PC-I                        PIC  X(01)    VALUE 'I'.     01720099
017300     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   01730099
017400     05  PC-SUKRP002                 PIC  X(08)    VALUE          01740099
017500         'SUKRP002'.                                              01750099
017600     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01760099
017700     05  PC-MISDIRECTS               PIC  X(20)    VALUE          01770099
017800         'MISDIRECT'.                                             01780099
017900     05  PC-FREE-ASTRAY.                                          01790099
018000         10  FILLER                  PIC  X(16)    VALUE          01800099
018100         'FREE ASTRAY FOR '.                                      01810099
018200         10  FREE-ASTRAY-REC-SEQ     PIC  9(03).                  01820099
018300     05  PC-DUPLICATES               PIC  X(20)    VALUE          01830099
018400         'DUPLICATES '.                                           01840099
018500     05  PC-NOT-FOUND                PIC  X(20)    VALUE          01850099
018600         'NOT FOUNDS '.                                           01860099
018700     05  PC-NOT-SCANNED              PIC  X(20)    VALUE          01870099
018800         'NOT SCANNED'.                                           01880099
018900     05  PC-REDO-ON-CASEPACK         PIC  X(20)    VALUE          01890099
019000         'REDO ON CASEPACK'.                                      01900099
019100     05  PC-INACTIVE-PACKSLIPS       PIC  X(20)    VALUE          01910099
019200         'INACTIVE PACKSLIPS'.                                    01920099
019300     05  PC-COMPANY-MISDIRECT        PIC  X(11)    VALUE          01930099
019400         'COMP MSDRCT'.                                           01940099
019500*                                                                 01950099
019600 01  DN-DB2-NULL-INDICATORS.                                      01960099
019700     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01970099
019800*                                                                 01980099
019900 01  PV-MISC-FIELDS.                                              01990099
020000     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     02000099
020100                                                   COMP-3.        02010099
020200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     02020099
020300                                                   COMP-3.        02030099
020400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     02040099
020500                                                   COMP-3.        02050099
020600     05  PV-DB2-COUNT                PIC S9(05)    VALUE ZERO     02060099
020700                                                   COMP SYNC.     02070099
020800     05  PV-DB2-COUNT2               PIC S9(05)    VALUE ZERO     02080099
020900                                                   COMP SYNC.     02090099
021000     05  PV-DB2-COUNT3               PIC S9(05)    VALUE ZERO     02100099
021100                                                   COMP SYNC.     02110099
021200     05  PV-DB2-COUNT4               PIC S9(05)    VALUE ZERO     02120099
021300                                                   COMP SYNC.     02130099
021400     05  PV-DIFFERENCE               PIC S9(04)    VALUE ZERO     02140099
021500                                                   COMP SYNC.     02150099
021600     05  PV-DOWNLOAD-CNT             PIC S9(05)    VALUE ZERO     02160099
021700                                                   COMP SYNC.     02170099
021800     05  PV-STATUS                   PIC  X(02).                  02180099
021900     05  PV-CURSOR-IND               PIC  X(01).                  02190099
022000     05  PV-TRIP-ID                  PIC  9(09).                  02200099
022100     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     02210099
022200                                                   COMP SYNC.     02220099
022300     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  02230099
022400     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    02240099
022500***************************************************************   02250099
022600*   GROUP VARIABLE PV-SKU REMOVED.                 WR # 21361 *   02260099
022700***************************************************************   02270099
022800****************************************************************  02280099
022900*  CHANGES MADE FOR WR # 21361 ENDS HERE.                      *  02290099
023000****************************************************************  02300099
023100     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    02310099
023200     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    02320099
023300     05  PV-PO-RECEIVER.                                          02330099
      *CLP 09/30/14                                                     02331099
023400         10  PV-PO                   PIC  9(08)    VALUE ZERO.    02340099
023500         10  FILLER                  PIC  X(01)    VALUE '-'.     02350099
023600         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    02360099
023700         10  PV-RECEIVER-X REDEFINES PV-RECEIVER                  02370099
023800                                     PIC  X(03).                  02380099
023900     05  PV-SHIPT-UNT-ID             PIC S9(18)    VALUE ZERO     02390099
024000                                                   COMP-3.        02400099
024100     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  02410099
024200     05  PV-TODAYS-DATE.                                          02420099
024300         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02430099
024400         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02440099
024500         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02450099
024600     05  PV-TODAYS-TIME.                                          02460099
024700         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02470099
024800         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02480099
024900         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02490099
025000         10  FILLER                  PIC  9(02)    VALUE ZERO.    02500099
025100     05  PV-DB2-DATE.                                             02510099
025200         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02520099
025300         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02530099
025400         10  FILLER                  PIC  X(01)    VALUE ZERO.    02540099
025500         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02550099
025600         10  FILLER                  PIC  X(01)    VALUE ZERO.    02560099
025700         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02570099
025800     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02580099
025900     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02590099
026000         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02600099
026100         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02610099
026200         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02620099
026300         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02630099
026400     05  PV-OUT-SERIAL-SHIP-CODE.                                 02640099
026500         10  FILLER                   PIC  X(05)    VALUE '(00) '.02650099
026600         10  PV-OUT-S-S-C-1           PIC  X(01).                 02660099
026700         10  FILLER                   PIC  X(01) VALUE SPACES.    02670099
026800         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02680099
026900         10  FILLER                   PIC  X(01) VALUE SPACES.    02690099
027000         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02700099
027100         10  FILLER                   PIC  X(01) VALUE SPACES.    02710099
027200         10  PV-OUT-S-S-C-18          PIC  X(01).                 02720099
027300     05  PV-HOLD-UID                  PIC  X(07)  VALUE SPACES.   02730099
027400     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02740099
027500                                                                  02750099
027600 01  PV-TOTAL-FIELDS.                                             02760099
027700     05  PV-TRLR-CRTN-TOT             PIC S9(05)  COMP-3          02770099
027800                                                  VALUE ZERO.     02780099
027900     05  PV-DWNLD-CRTN-TOT            PIC S9(05)  COMP-3          02790099
028000                                                  VALUE ZERO.     02800099
028100     05  PV-SCAN-CRTN-TOT             PIC S9(05)  COMP-3          02810099
028200                                                  VALUE ZERO.     02820099
028300*                                                                 02830099
028400 01  PV-EXCEPTION-FIELDS.                                         02840099
028500     05  PV-SCANNED-COUNT             PIC S9(05)  COMP SYNC.      02850099
028600     05  PV-SCANNED-IND               PIC  X(01).                 02860099
028700     05  PV-DUP-SCAN-IND              PIC  X(01).                 02870099
028800     05  PV-NEVER-SCANNED-IND         PIC  X(01).                 02880099
028900     05  PV-MISDIRECT-IND             PIC  X(01).                 02890099
029000     05  PV-NOT-FOUND-IND             PIC  X(01).                 02900099
029100     05  PV-FREE-ASTRAY-IND           PIC  X(01).                 02910099
029200     05  PV-ANOTHER-TRAILER-IND       PIC  X(01).                 02920099
029300     05  PV-AUTO-VE-IND               PIC  X(01).                 02930099
029400                                                                  02940099
029500     COPY DPWS024.                                                02950099
029600                                                                  02960099
029700     COPY SURD001.                                                02970099
029800                                                                  02980099
029900***************************************************************   02990099
030000* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                 *   03000099
030100***************************************************************   03010099
030200     COPY DSWS004.                                                03020099
030300                                                                  03030099
030400 EJECT                                                            03040099
030500*                                                                 03050099
030600******************************************************************03060099
030700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               03070099
030800******************************************************************03080099
030900     COPY DPWS132O.                                               03090099
031000*                                                                 03100099
031100*                                                                 03110099
031200 01  HEADING-LINES.                                               03120099
031300     05  HEADING-LINE-1.                                          03130099
031400         10  FILLER                  PIC  X(05)    VALUE SPACES.  03140099
031500         10  FILLER                  PIC  X(40)    VALUE          03150099
031600             '****************************************'.          03160099
031700         10  FILLER                  PIC  X(05)    VALUE SPACES.  03170099
031800         10  FILLER                  PIC  X(32)    VALUE          03180099
031900             'CHECK-IN COMPLETION - STATISTICS'.                  03190099
032000         10  FILLER                  PIC  X(50)    VALUE SPACES.  03200099
032100*                                                                 03210099
032200     05  HEADING-LINE-1A.                                         03220099
032300         10  FILLER                  PIC  X(05)    VALUE SPACES.  03230099
032400         10  FILLER                  PIC  X(03)    VALUE '*  '.   03240099
032500         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  03250099
032600         10  FILLER                  PIC  X(01)    VALUE '*'.     03260099
032700         10  FILLER                  PIC  X(87)    VALUE SPACES.  03270099
032800*                                                                 03280099
032900     05  HEADING-LINE-1B.                                         03290099
033000         10  FILLER                  PIC  X(05)    VALUE SPACES.  03300099
033100         10  FILLER                  PIC  X(40)    VALUE          03310099
033200             '****************************************'.          03320099
033300         10  FILLER                  PIC  X(87)    VALUE SPACES.  03330099
033400*                                                                 03340099
033500     05  HEADING-LINE-2.                                          03350099
033600         10  FILLER                  PIC  X(03)    VALUE SPACE.   03360099
033700         10  FILLER                  PIC  X(09)    VALUE          03370099
033800             'CARRIER: '.                                         03380099
033900         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  03390099
034000         10  FILLER                  PIC  X(03)    VALUE SPACE.   03400099
034100         10  FILLER                  PIC  X(09)    VALUE          03410099
034200             'TRAILER: '.                                         03420099
034300         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  03430099
034400         10  FILLER                  PIC  X(04)    VALUE SPACE.   03440099
034500         10  FILLER                  PIC  X(09)    VALUE          03450099
034600             'TRIP ID: '.                                         03460099
034700         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  03470099
034800         10  FILLER                  PIC  X(14)    VALUE SPACE.   03480099
034900         10  FILLER                  PIC  X(16)    VALUE          03490099
035000             'TRAILER STATUS: '.                                  03500099
035100         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  03510099
035200         10  FILLER                  PIC  X(38)    VALUE SPACES.  03520099
035300*                                                                 03530099
035400     05  HEADING-LINE-3.                                          03540099
035500         10  FILLER                  PIC  X(03)    VALUE SPACES.  03550099
035600         10  FILLER                  PIC  X(16)    VALUE          03560099
035700             'ARRIVAL DATE:   '.                                  03570099
035800         10  HL3-ARRIVAL-DATE.                                    03580099
035900             15  HL3-ARRIVAL-DATE-MM                              03590099
036000                                     PIC  X(02)    VALUE SPACES.  03600099
036100             15  FILLER              PIC  X(01)    VALUE '/'.     03610099
036200             15  HL3-ARRIVAL-DATE-DD                              03620099
036300                                     PIC  X(02)    VALUE SPACES.  03630099
036400             15  FILLER              PIC  X(01)    VALUE '/'.     03640099
036500             15  HL3-ARRIVAL-DATE-CC                              03650099
036600                                     PIC  X(02)    VALUE SPACES.  03660099
036700             15  HL3-ARRIVAL-DATE-YY                              03670099
036800                                     PIC  X(02)    VALUE SPACES.  03680099
036900         10  FILLER                  PIC  X(11)    VALUE SPACES.  03690099
037000         10  FILLER                  PIC  X(23)    VALUE          03700099
037100             'BEGIN UNLOADING DATE:  '.                           03710099
037200         10  HL3-BEG-UNLOAD-DATE.                                 03720099
037300             15  HL3-BEG-UNLOAD-DATE-MM                           03730099
037400                                     PIC  X(02)    VALUE SPACES.  03740099
037500             15  FILLER              PIC  X(01)    VALUE '/'.     03750099
037600             15  HL3-BEG-UNLOAD-DATE-DD                           03760099
037700                                     PIC  X(02)    VALUE SPACES.  03770099
037800             15  FILLER              PIC  X(01)    VALUE '/'.     03780099
037900             15  HL3-BEG-UNLOAD-DATE-CC                           03790099
038000                                     PIC  X(02)    VALUE SPACES.  03800099
038100             15  HL3-BEG-UNLOAD-DATE-YY                           03810099
038200                                     PIC  X(02)    VALUE SPACES.  03820099
038300         10  FILLER                  PIC  X(03)    VALUE SPACES.  03830099
038400         10  FILLER                  PIC  X(15)    VALUE          03840099
038500             'UNLOADED DATE: '.                                   03850099
038600         10  HL3-UNLOADED-DATE.                                   03860099
038700             15  HL3-UNLOADED-DATE-MM                             03870099
038800                                     PIC  X(02)    VALUE SPACES.  03880099
038900             15  FILLER              PIC  X(01)    VALUE '/'.     03890099
039000             15  HL3-UNLOADED-DATE-DD                             03900099
039100                                     PIC  X(02)    VALUE SPACES.  03910099
039200             15  FILLER              PIC  X(01)    VALUE '/'.     03920099
039300             15  HL3-UNLOADED-DATE-CC                             03930099
039400                                     PIC  X(02)    VALUE SPACES.  03940099
039500             15  HL3-UNLOADED-DATE-YY                             03950099
039600                                     PIC  X(02)    VALUE SPACES.  03960099
039700         10  FILLER                  PIC  X(31)    VALUE SPACES.  03970099
039800*                                                                 03980099
039900     05  HEADING-LINE-3B.                                         03990099
040000          10  FILLER                 PIC  X(03)  VALUE SPACE.     04000099
040100          10  FILLER                 PIC  X(22)  VALUE            04010099
040200              'RECEIVING ASSOCIATES: '.                           04020099
040300          10  HL3B-USERID-TABLE.                                  04030099
040400              15 FILLER  OCCURS 12 TIMES                          04040099
040500                         INDEXED BY HL3B-UID-IDX.                 04050099
040600                 20 HL3B-USER-ID     PIC  X(07) VALUE SPACE.      04060099
040700                 20 HL3B-COMMA       PIC  X(01) VALUE SPACE.      04070099
040800                 20 FILLER           PIC  X(01) VALUE SPACE.      04080099
040900*                                                                 04090099
041000     05  HEADING-LINE-4.                                          04100099
041100         10  FILLER                  PIC  X(48)    VALUE SPACES.  04110099
041200         10  FILLER                  PIC  X(07)    VALUE          04120099
041300             'TROUBLE'.                                           04130099
041400         10  FILLER                  PIC  X(04)    VALUE SPACES.  04140099
041500         10  FILLER                  PIC  X(03)    VALUE          04150099
041600             'PBS'.                                               04160099
041700         10  FILLER                  PIC  X(04)    VALUE SPACES.  04170099
041800         10  FILLER                  PIC  X(07)    VALUE          04180099
041900             'TRAILER'.                                           04190099
042000         10  FILLER                  PIC  X(05)    VALUE SPACES.  04200099
042100         10  FILLER                  PIC  X(08)    VALUE          04210099
042200             'DOWNLOAD'.                                          04220099
042300         10  FILLER                  PIC  X(03)    VALUE SPACES.  04230099
042400         10  FILLER                  PIC  X(07)    VALUE          04240099
042500             'SCANNED'.                                           04250099
042600         10  FILLER                  PIC  X(03)    VALUE SPACES.  04260099
042700         10  FILLER                  PIC  X(10)    VALUE          04270099
042800             'DWNLD/SCND'.                                        04280099
042900         10  FILLER                  PIC  X(23)    VALUE SPACES.  04290099
043000*                                                                 04300099
043100     05  HEADING-LINE-5.                                          04310099
043200         10  FILLER                  PIC  X(03)    VALUE SPACES.  04320099
043300         10  FILLER                  PIC  X(11)    VALUE          04330099
043400             'PO/RECEIVER'.                                       04340099
043500         10  FILLER                  PIC  X(02)    VALUE SPACES.  04350099
043600         10  FILLER                  PIC  X(04)    VALUE          04360099
043700             'DEPT'.                                              04370099
043800         10  FILLER                  PIC  X(02)    VALUE SPACES.  04380099
043900         10  FILLER                  PIC  X(11)    VALUE          04390099
044000             'VENDOR NAME'.                                       04400099
044100         10  FILLER                  PIC  X(15)    VALUE SPACES.  04410099
044200         10  FILLER                  PIC  X(06)    VALUE          04420099
044300             'STATUS'.                                            04430099
044400         10  FILLER                  PIC  X(05)    VALUE SPACES.  04440099
044500         10  FILLER                  PIC  X(03)    VALUE          04450099
044600             'IND'.                                               04460099
044700         10  FILLER                  PIC  X(04)    VALUE SPACES.  04470099
044800         10  FILLER                  PIC  X(07)    VALUE          04480099
044900             'CTN CNT'.                                           04490099
045000         10  FILLER                  PIC  X(05)    VALUE SPACES.  04500099
045100         10  FILLER                  PIC  X(07)    VALUE          04510099
045200             'CTN CNT'.                                           04520099
045300         10  FILLER                  PIC  X(04)    VALUE SPACES.  04530099
045400         10  FILLER                  PIC  X(07)    VALUE          04540099
045500             'CTN CNT'.                                           04550099
045600         10  FILLER                  PIC  X(03)    VALUE SPACES.  04560099
045700         10  FILLER                  PIC  X(10)    VALUE          04570099
045800             'DIFFERENCE'.                                        04580099
045900         10  FILLER                  PIC  X(04)    VALUE SPACES.  04590099
046000         10  FILLER                  PIC  X(07)    VALUE          04600099
046100             'REMARKS'.                                           04610099
046200         10  FILLER                  PIC  X(12)    VALUE SPACES.  04620099
046300*                                                                 04630099
046400*                                                                 04640099
046500 01  MISCELLANEOUS-LINES.                                         04650099
046600     05  END-OF-REPORT-LINE.                                      04660099
046700         10  FILLER                  PIC  X(44)    VALUE SPACES.  04670099
046800         10  FILLER                  PIC  X(45)    VALUE          04680099
046900             '*******   E N D   O F   R E P O R T   *******'.     04690099
047000         10  FILLER                  PIC  X(43)    VALUE SPACES.  04700099
047100*                                                                 04710099
047200 01  DETAIL-LINES.                                                04720099
047300     05  DETAIL-LINE1.                                            04730099
047400         10  FILLER                  PIC  X(03)    VALUE SPACES.  04740099
      *CLP 09/30/14                                                     04741099
047500         10  DL1-PO-RECEIVER         PIC  X(12)    VALUE SPACES.  04750099
047600         10  FILLER                  PIC  X(01)    VALUE SPACES.  04760099
047700         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  04770099
047800         10  FILLER                  PIC  X(03)    VALUE SPACES.  04780099
047900         10  DL1-VENDOR-NAME         PIC  X(25)    VALUE SPACES.  04790099
048000         10  FILLER                  PIC  X(01)    VALUE SPACES.  04800099
048100         10  DL1-TROUBLE             PIC  X(09)    VALUE SPACES.  04810099
048200         10  DL1-TROUBLE-AST         PIC  X(01)    VALUE SPACES.  04820099
048300         10  FILLER                  PIC  X(02)    VALUE SPACES.  04830099
048400         10  DL1-PBS-IND             PIC  X(01)    VALUE SPACES.  04840099
048500         10  FILLER                  PIC  X(06)    VALUE SPACES.  04850099
048600         10  DL1-ASN-CARTON-CNT      PIC  ZZZ9     VALUE ZERO.    04860099
048700         10  FILLER                  PIC  X(09)    VALUE SPACES.  04870099
048800         10  DL1-DOWNLOAD-CNT        PIC  ZZZZ9   VALUE ZERO.     04880099
048900         10  FILLER                  PIC  X(05)    VALUE SPACES.  04890099
049000         10  DL1-SCANNED-CNT         PIC  ZZZZ9   VALUE ZERO.     04900099
049100         10  FILLER                  PIC  X(07)    VALUE SPACES.  04910099
049200         10  DL1-DIFFERENCE          PIC  ZZZ9     VALUE SPACES.  04920099
049300         10  FILLER                  PIC  X(04)    VALUE SPACES.  04930099
049400         10  DL1-ASTERISK            PIC  X(01)    VALUE SPACES.  04940099
049500         10  FILLER                  PIC  X(01)    VALUE SPACES.  04950099
049600         10  DL1-REMARKS             PIC  X(20)    VALUE SPACES.  04960099
049700     05  DETAIL-LINE2.                                            04970099
049800         10  FILLER                  PIC  X(112)   VALUE SPACES.  04980099
049900         10  DL2-REMARKS             PIC  X(20)    VALUE SPACES.  04990099
050000*                                                                 05000099
050100 01  TOTAL-LINES.                                                 05010099
050200     05  TOTAL-LINE1.                                             05020099
050300         10  FILLER                  PIC  X(46)    VALUE SPACES.  05030099
050400         10  FILLER                  PIC  X(19)    VALUE          05040099
050500             'FINAL TOTAL        '.                               05050099
050600         10  TL1-ASN-CARTON-CNT      PIC  ZZ,ZZ9   VALUE ZERO.    05060099
050700         10  FILLER                  PIC  X(07)    VALUE SPACES.  05070099
050800         10  TL1-DOWNLOAD-CNT        PIC  ZZZ,ZZ9   VALUE ZERO.   05080099
050900         10  FILLER                  PIC  X(03)    VALUE SPACES.  05090099
051000         10  TL1-SCANNED-CNT         PIC  ZZZ,ZZ9   VALUE ZERO.   05100099
051100         10  FILLER                  PIC  X(35)    VALUE SPACES.  05110099
051200                                                                  05120099
051300                                                                  05130099
051400 01  EL1-ERROR-LINE-1F.                                           05140099
051500     05  FILLER                      PIC  X(02)     VALUE SPACES. 05150099
051600     05  FILLER                      PIC  X(48)     VALUE         05160099
051700         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05170099
051800     05  FILLER                      PIC  X(49)     VALUE         05180099
051900         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     05190099
052000     05  FILLER                      PIC  X(33)     VALUE         05200099
052100         ' COMPLETED.                      '.                     05210099
052200                                                                  05220099
052300 01  EL1-ERROR-LINE-1P.                                           05230099
052400     05  FILLER                      PIC  X(02)     VALUE SPACES. 05240099
052500     05  FILLER                      PIC  X(48)     VALUE         05250099
052600         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05260099
052700     05  FILLER                      PIC  X(49)     VALUE         05270099
052800         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     05280099
052900     05  FILLER                      PIC  X(33)     VALUE         05290099
053000         'COMPLETED.                       '.                     05300099
053100                                                                  05310099
053200 01  EL2-ERROR-LINE-2F.                                           05320099
053300     05  FILLER                      PIC  X(02)     VALUE SPACES. 05330099
053400     05  FILLER                      PIC  X(36)     VALUE         05340099
053500         'NONE OF YOUR REPORTS WERE CREATED.  '.                  05350099
053600     05  FILLER                      PIC  X(36)     VALUE         05360099
053700         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  05370099
053800     05  FILLER                      PIC  X(58)     VALUE SPACES. 05380099
053900                                                                  05390099
054000 01  EL2-ERROR-LINE-2P.                                           05400099
054100     05  FILLER                      PIC  X(02)     VALUE SPACES. 05410099
054200     05  FILLER                      PIC  X(49)     VALUE         05420099
054300         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     05430099
054400     05  FILLER                      PIC  X(41)     VALUE         05440099
054500         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             05450099
054600     05  FILLER                      PIC  X(40)     VALUE         05460099
054700         'DETERMINE IF THEY NEED TO BE CREATED).  '.              05470099
054800                                                                  05480099
054900 01  EL3-ERROR-LINE-3.                                            05490099
055000     05  FILLER                      PIC  X(02)     VALUE SPACES. 05500099
055100     05  FILLER                      PIC  X(50)     VALUE         05510099
055200         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05520099
055300     05  FILLER                      PIC  X(81)     VALUE SPACES. 05530099
055400                                                                  05540099
055500 01  EL4-ERROR-LINE-4.                                            05550099
055600     05  FILLER                      PIC  X(07)     VALUE SPACES. 05560099
055700     05  FILLER                      PIC  X(12)     VALUE         05570099
055800         'REQUESTOR:  '.                                          05580099
055900     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 05590099
056000     05  FILLER                      PIC  X(10)     VALUE SPACES. 05600099
056100     05  FILLER                      PIC  X(22)     VALUE         05610099
056200         'PRINTER DESTINATION:  '.                                05620099
056300     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05630099
056400     05  FILLER                      PIC  X(65)     VALUE SPACES. 05640099
056500                                                                  05650099
056600                                                                  05660099
056700 01  EL5-ERROR-LINE-5.                                            05670099
056800     05  FILLER                      PIC  X(07)     VALUE SPACES. 05680099
056900     05  FILLER                      PIC  X(20)     VALUE         05690099
057000         'REQUESTED REPORTS:  '.                                  05700099
057100*JPL                                                              05710099
057200     05  FILLER                      PIC  X(105)    VALUE SPACES. 05720099
057300*JPL 05  FILLER                      PIC  X(08)     VALUE         05730099
057400*JPL     'STATS   '.                                              05740099
057500*JPL 05  FILLER                      PIC  X(18)     VALUE         05750099
057600*JPL     'PO/STR WRKSHEET   '.                                    05760099
057700*JPL 05  FILLER                      PIC  X(17)     VALUE         05770099
057800*JPL     'CRTNS NOT RCVD   '.                                     05780099
057900*JPL 05  FILLER                      PIC  X(14)     VALUE         05790099
058000*JPL     'FREE ASTRAY   '.                                        05800099
058100*JPL 05  FILLER                      PIC  X(12)     VALUE         05810099
058200*JPL     'MISDIRECT   '.                                          05820099
058300*JPL 05  FILLER                      PIC  X(17)     VALUE         05830099
058400*JPL     'DUPLICATE SCAN   '.                                     05840099
058500*JPL 05  FILLER                      PIC  X(14)     VALUE         05850099
058600*JPL     'SCAN NOT FOUND'.                                        05860099
058700*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 05870099
058800                                                                  05880099
058900 01  EL5-ERROR-LINE-5B.                                           05890099
059000     05  FILLER                      PIC  X(07)     VALUE SPACES. 05900099
059100     05  FILLER                      PIC  X(04)     VALUE SPACES. 05910099
059200     05  FILLER                      PIC  X(08)     VALUE         05920099
059300         'STATS   '.                                              05930099
059400     05  FILLER                      PIC  X(18)     VALUE         05940099
059500         'PO/STR UNT ADJ    '.                                    05950099
059600     05  FILLER                      PIC  X(17)     VALUE         05960099
059700         'CRTNS NOT RCVD   '.                                     05970099
059800     05  FILLER                      PIC  X(14)     VALUE         05980099
059900         'FREE ASTRAY   '.                                        05990099
060000     05  FILLER                      PIC  X(12)     VALUE         06000099
060100         'MISDIRECT   '.                                          06010099
060200     05  FILLER                      PIC  X(17)     VALUE         06020099
060300         'DUPLICATE SCAN   '.                                     06030099
060400     05  FILLER                      PIC  X(18)     VALUE         06040099
060500         'SCAN NOT FOUND    '.                                    06050099
060600     05  FILLER                      PIC  X(17)     VALUE         06060099
060700         'UNUSED LABELS    '.                                     06070099
060800*JPL                                                              06080099
060900*01  EL6-ERROR-LINE-6.                                            06090099
061000*    05  FILLER                      PIC  X(29)     VALUE SPACES. 06100099
061100*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 06110099
061200*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06120099
061300*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06130099
061400*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06140099
061500*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06150099
061600*    05  FILLER                      PIC  X(15)     VALUE SPACES. 06160099
061700*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06170099
061800*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06180099
061900*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06190099
062000*    05  FILLER                      PIC  X(13)     VALUE SPACES. 06200099
062100*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06210099
062200*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06220099
062300*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06230099
062400*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06240099
062500                                                                  06250099
062600 01  EL6-ERROR-LINE-6B.                                           06260099
062700     05  FILLER                      PIC  X(13)     VALUE SPACES. 06270099
062800     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 06280099
062900     05  FILLER                      PIC  X(12)     VALUE SPACES. 06290099
063000     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06300099
063100     05  FILLER                      PIC  X(16)     VALUE SPACES. 06310099
063200     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06320099
063300     05  FILLER                      PIC  X(15)     VALUE SPACES. 06330099
063400     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06340099
063500     05  FILLER                      PIC  X(12)     VALUE SPACES. 06350099
063600     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06360099
063700     05  FILLER                      PIC  X(13)     VALUE SPACES. 06370099
063800     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06380099
063900     05  FILLER                      PIC  X(16)     VALUE SPACES. 06390099
064000     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06400099
064100     05  FILLER                      PIC  X(17)     VALUE SPACES. 06410099
064200*JPL                                                              06420099
064300     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 06430099
064400     05  FILLER                      PIC  X(10)     VALUE SPACES. 06440099
064500                                                                  06450099
064600                                                                  06460099
064700***************************************************************** 06470099
064800*  COPY BOOK FOR SHIPMENT TABLE                                   06480099
064900***************************************************************** 06490099
065000     EXEC SQL                                                     06500099
065100          INCLUDE TSHIPMT                                         06510099
065200     END-EXEC.                                                    06520099
065300                                                                  06530099
065400***************************************************************** 06540099
065500*  COPY BOOK FOR SHIPMENT PO TABLE                                06550099
065600***************************************************************** 06560099
065700     EXEC SQL                                                     06570099
065800          INCLUDE TSHPTPO                                         06580099
065900     END-EXEC.                                                    06590099
066000                                                                  06600099
066100***************************************************************** 06610099
066200*  COPY BOOK FOR PURCHASE ORDER TABLE                             06620099
066300***************************************************************** 06630099
066400     EXEC SQL                                                     06640099
066500          INCLUDE TPURCHS                                         06650099
066600     END-EXEC.                                                    06660099
066700                                                                  06670099
066800***************************************************************** 06680099
066900*  COPY BOOK FOR EXTERNAL ENTITY TABLE                            06690099
067000***************************************************************** 06700099
067100     EXEC SQL                                                     06710099
067200          INCLUDE TEXTENT                                         06720099
067300     END-EXEC.                                                    06730099
067400                                                                  06740099
067500***************************************************************** 06750099
067600*  COPY BOOK FOR EXTERNAL ENTITY NAME TABLE                       06760099
067700***************************************************************** 06770099
067800     EXEC SQL                                                     06780099
067900          INCLUDE TENTNME                                         06790099
068000     END-EXEC.                                                    06800099
068100                                                                  06810099
068200***************************************************************** 06820099
068300*  COPY BOOK FOR THE TROUBLE REASON TABLE                         06830099
068400***************************************************************** 06840099
068500     EXEC SQL                                                     06850099
068600          INCLUDE TTRBRSN                                         06860099
068700     END-EXEC.                                                    06870099
068800                                                                  06880099
068900***************************************************************** 06890099
069000*  COPY BOOK FOR THE TROUBLE NOTIFICATION TABLE                   06900099
069100***************************************************************** 06910099
069200     EXEC SQL                                                     06920099
069300          INCLUDE TTRBNTF                                         06930099
069400     END-EXEC.                                                    06940099
069500                                                                  06950099
069600***************************************************************** 06960099
069700*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    06970099
069800***************************************************************** 06980099
069900     EXEC SQL                                                     06990099
070000          INCLUDE TSHUUPC                                         07000099
070100     END-EXEC.                                                    07010099
070200                                                                  07020099
070300***************************************************************** 07030099
070400*  COPY BOOK FOR PACKSLIP TABLE                                   07040099
070500***************************************************************** 07050099
070600     EXEC SQL                                                     07060099
070700          INCLUDE TPKSLIP                                         07070099
070800     END-EXEC.                                                    07080099
070900                                                                  07090099
071000***************************************************************** 07100099
071100*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T07110099
071200***************************************************************** 07120099
071300     EXEC SQL                                                     07130099
071400          INCLUDE TINPKSU                                         07140099
071500     END-EXEC.                                                    07150099
071600                                                                  07160099
071700***************************************************************** 07170099
071800*  COPY BOOK FOR SHIPMENT UNIT BARCODE NUMBER                    T07180099
071900***************************************************************** 07190099
072000     EXEC SQL                                                     07200099
072100          INCLUDE TSULBXF                                         07210099
072200     END-EXEC.                                                    07220099
072300                                                                  07230099
072400***************************************************************** 07240099
072500*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           07250099
072600***************************************************************** 07260099
072700     EXEC SQL                                                     07270099
072800          INCLUDE TSHUNLO                                         07280099
072900     END-EXEC.                                                    07290099
073000                                                                  07300099
073100***************************************************************** 07310099
073200*  COPY BOOK FOR SHIPMENT UNIT TABLE                              07320099
073300***************************************************************** 07330099
073400     EXEC SQL                                                     07340099
073500          INCLUDE TSHPUNT                                         07350099
073600     END-EXEC.                                                    07360099
073700                                                                  07370099
073800***************************************************************** 07380099
073900*   REMOVED REFERENCES OF TSK DB2 TABLE              WR # 21361 * 07390099
074000***************************************************************** 07400099
074100***************************************************************** 07410099
074200*   REMOVED REFERENCES OF TUPCSKU DB2 TABLE          WR # 21361 * 07420099
074300***************************************************************** 07430099
074400***************************************************************** 07440099
074500*  CHANGES MADE FOR WR # 21361 ENDS HERE                        * 07450099
074600***************************************************************** 07460099
074700***************************************************************** 07470099
074800*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           07480099
074900***************************************************************** 07490099
075000     EXEC SQL                                                     07500099
075100          INCLUDE TVHTRIP                                         07510099
075200     END-EXEC.                                                    07520099
075300                                                                  07530099
075400***************************************************************** 07540099
075500*  COPY BOOK FOR THE VEHICLE TABLE                                07550099
075600***************************************************************** 07560099
075700     EXEC SQL                                                     07570099
075800          INCLUDE TVEHICL                                         07580099
075900     END-EXEC.                                                    07590099
076000                                                                  07600099
076100***************************************************************** 07610099
076200*  COPY BOOK FOR TRIP STATUS TABLE                                07620099
076300***************************************************************** 07630099
076400     EXEC SQL                                                     07640099
076500          INCLUDE TTRIPST                                         07650099
076600     END-EXEC.                                                    07660099
076700                                                                  07670099
076800***************************************************************** 07680099
076900*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           07690099
077000***************************************************************** 07700099
077100     EXEC SQL                                                     07710099
077200          INCLUDE TTRSTYP                                         07720099
077300     END-EXEC.                                                    07730099
077400                                                                  07740099
077500***************************************************************** 07750099
077600*  COPY BOOK FOR THE RECEIVER TABLE                               07760099
077700***************************************************************** 07770099
077800     EXEC SQL                                                     07780099
077900          INCLUDE TRECEIV                                         07790099
078000     END-EXEC.                                                    07800099
078100                                                                  07810099
078200***************************************************************** 07820099
078300*  DB2 COMMUNICATION AREA                                         07830099
078400***************************************************************** 07840099
078500     EXEC SQL                                                     07850099
078600         INCLUDE SQLCA                                            07860099
078700     END-EXEC.                                                    07870099
078800                                                                  07880099
078900***************************************************************** 07890099
079000*  DB2 COMMUNICATION AREA2                                        07900099
079100***************************************************************** 07910099
079200     COPY SQLCA2.                                                 07920099
079300                                                                  07930099
079400***************************************************************** 07940099
079500*  TRAILER-CSR                                                    07950099
079600***************************************************************** 07960099
079700     EXEC SQL                                                     07970099
079800       DECLARE TRAILER-CSR CURSOR FOR                             07980099
079900         SELECT DISTINCT                                          07990099
080000                'B'                                               08000099
080100              , C.PO_NBR                                          08010099
080200              , C.REC_SEQ_NBR                                     08020099
080300              , 0                                                 08030099
080400          FROM  TVHTRIP A                                         08040099
080500              , TSHIPMT B                                         08050099
080600              , TSHPTPO C                                         08060099
080700              , TRECEIV D                                         08070099
080800          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             08080099
080900            AND A.TRIP_ID           = B.TRIP_ID                   08090099
081000            AND C.SHIPT_ID          = B.SHIPT_ID                  08100099
081100            AND C.PO_NBR          = D.ORD_NBR                     08110099
081200            AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR                 08120099
081300            AND D.VER_STATUS_CDE  = 'A'                           08130099
081400       UNION                                                      08140099
081500         SELECT DISTINCT                                          08150099
081600                'C'                                               08160099
081700              , B.PO_NBR                                          08170099
081800              , 0                                                 08180099
081900              , B.SEQ_NBR                                         08190099
082000          FROM  TSHUNLO A                                         08200099
082100              , TINPKSU B                                         08210099
082200          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             08220099
082300            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08230099
082400            AND A.SCN_LOC_ID        = 'RECV'                      08240099
082500            AND A.ACTV_CDE          = 'A'                         08250099
082600            AND A.SHIPT_UNT_ID NOT IN                             08260099
082700             (SELECT E.SHIPT_UNT_ID                               08270099
082800              FROM  TVHTRIP A                                     08280099
082900                  , TSHIPMT B                                     08290099
083000                  , TSHPTPO C                                     08300099
083100                  , TPKSLIP D                                     08310099
083200                  , TINPKSU E                                     08320099
083300              WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID         08330099
083400                AND A.TRIP_ID           = B.TRIP_ID               08340099
083500                AND B.SHIPT_ID          = C.SHIPT_ID              08350099
083600                AND C.PO_NBR            = D.PO_NBR                08360099
083700                AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR           08370099
083800                AND D.PO_NBR            = E.PO_NBR                08380099
083900                AND D.SEQ_NBR           = E.SEQ_NBR)              08390099
084000       UNION                                                      08400099
084100         SELECT DISTINCT                                          08410099
084200                'A'                                               08420099
084300              , B.TRN_NBR                                         08430099
084400              , 0                                                 08440099
084500              , 0                                                 08450099
084600          FROM  TSHUNLO A                                         08460099
084700              , TSHUUPC B                                         08470099
084800          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             08480099
084900            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08490099
085000            AND A.SCN_LOC_ID        = 'RECV'                      08500099
085100            AND A.ACTV_CDE          = 'A'                         08510099
085200            AND NOT EXISTS                                        08520099
085300             (SELECT C.SHIPT_UNT_ID                               08530099
085400              FROM TINPKSU C                                      08540099
085500              WHERE A.SHIPT_UNT_ID  = C.SHIPT_UNT_ID)             08550099
085600       ORDER BY 2, 1                                              08560099
085700     END-EXEC.                                                    08570099
085800                                                                  08580099
085900***************************************************************** 08590099
086000*  ADDED UID_CURSOR 3/31/98  DENISE HAHN                          08600099
086100***************************************************************** 08610099
086200*  RECEIVING ASSOCIATE USERID CURSOR -- THIS CURSOR WILL RETRIEVE 08620099
086300*  THE USERIDS OF ALL THE ASSOCIATES THAT CHECKED-IN THIS TRAILER 08630099
086400***************************************************************** 08640099
086500     EXEC SQL                                                     08650099
086600         DECLARE UID_CURSOR CURSOR FOR                            08660099
086700             SELECT                                               08670099
086800                    DISTINCT A.CRE_USR_ID                         08680099
086900             FROM                                                 08690099
087000                    TSHUNLO A                                     08700099
087100             WHERE                                                08710099
087200                 A.TRIP_ID = :SU001-MANIFEST-NBR                  08720099
087300             AND A.SCN_LOC_ID   = 'RECV'                          08730099
087400            AND  A.ACTV_CDE     = 'A'                             08740099
087500         ORDER BY 1                                               08750099
087600     END-EXEC.                                                    08760099
087700                                                                  08770099
087800*                                                                 08780099
087900***************************************************************** 08790099
088000*  THIS CURSOR IS USED WHEN THERE ARE MULTIPLE ORIGINAL RECEIVER  08800099
088100*  NUMBERS.                                                       08810099
088200***************************************************************** 08820099
088300     EXEC SQL                                                     08830099
088400         DECLARE RCVR_CURSOR CURSOR FOR                           08840099
088500             SELECT DISTINCT B.REC_SEQ_NBR                        08850099
088600             FROM TPKSLIP A                                       08860099
088700                , TPKSLIP B                                       08870099
088800            WHERE A.PO_NBR          = :RECEIV-ORD-NBR             08880099
088900              AND A.REC_SEQ_NBR     = :RECEIV-REC-SEQ-NBR         08890099
089000              AND A.VER_STAT_CDE    = :PC-A                       08900099
089100              AND B.PO_NBR          = A.PO_NBR                    08910099
089200              AND B.SEQ_NBR         = A.ORIG_PKSL_SEQ_NBR         08920099
089300              AND B.VER_STAT_CDE    = :PC-A                       08930099
089400     END-EXEC.                                                    08940099
089500                                                                  08950099
089600*                                                                 08960099
089700 PROCEDURE DIVISION.                                              08970099
089800*                                                                 08980099
089900 0000-MAINLINE-PROCESSING.                                        08990099
090000******************************************************************09000099
090100*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 09010099
090200* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * 09020099
090300* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 09030099
090400* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 09040099
090500******************************************************************09050099
090600     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           09060099
090700     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   09070099
090800                                                                  09080099
090900     IF CC-PRINT-SUKRP002                                         09090099
091000         PERFORM 0100-INITIALIZATION                              09100099
091100         IF SU001-DETAIL-RECORD                                   09110099
091200             PERFORM 1000-PROCESS-EXTRACT-FILE                    09120099
091300             IF PS-ERROR-RECORD                                   09130099
091400                 PERFORM 7000-WRITE-ERROR-REPORT                  09140099
091500             END-IF                                               09150099
091600         ELSE                                                     09160099
091700             PERFORM 7000-WRITE-ERROR-REPORT                      09170099
091800         END-IF                                                   09180099
091900         CLOSE EXTRACT-FILE                                       09190099
092000               SU-CARTON-NOT-RCVD-FILE                            09200099
092100     END-IF.                                                      09210099
092200                                                                  09220099
092300     GOBACK.                                                      09230099
092400*                                                                 09240099
092500*                                                                 09250099
092600 0100-INITIALIZATION.                                             09260099
092700******************************************************************09270099
092800**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               09280099
092900******************************************************************09290099
093000     ACCEPT PV-TODAYS-DATE                                        09300099
093100       FROM DATE.                                                 09310099
093200                                                                  09320099
093300     ACCEPT PV-TODAYS-TIME                                        09330099
093400       FROM TIME.                                                 09340099
093500                                                                  09350099
093600     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         09360099
093700     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             09370099
093800     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               09380099
093900     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              09390099
094000                                                                  09400099
094100     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              09410099
094200     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            09420099
094300     MOVE PC-SUKRP002            TO DP132O-PROGRAM-NAME.          09430099
094400                                                                  09440099
094500******************************************************************09450099
094600**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  09460099
094700******************************************************************09470099
094800     IF CC-PRINT-ENTIRE-TRIP                                      09480099
094900        STRING 'ENTIRE TRIP-REQUESTED BY '                        09490099
095000               CC-REQUESTOR-ID  DELIMITED BY SIZE                 09500099
095100               INTO HL1A-CC-IND-DESC                              09510099
095200     ELSE                                                         09520099
095300        STRING 'SELECTED PO''S REQUESTED BY '                     09530099
095400               CC-REQUESTOR-ID  DELIMITED BY SIZE                 09540099
095500               INTO HL1A-CC-IND-DESC.                             09550099
095600                                                                  09560099
095700     OPEN INPUT  EXTRACT-FILE                                     09570099
095800          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         09580099
095900                                                                  09590099
096000     PERFORM 2200-READ-EXTRACT.                                   09600099
096100                                                                  09610099
096200     MOVE SU001-MANIFEST-NBR     TO PV-TRIP-ID                    09620099
096300                                    VHTRIP-TRIP-ID                09630099
096400                                    SHUNLO-TRIP-ID                09640099
096500                                    SHIPMT-TRIP-ID.               09650099
096600                                                                  09660099
096700     SET PS-DETAIL-RECORD        TO TRUE.                         09670099
096800                                                                  09680099
096900     PERFORM 1100-SELECT-TRAILER.                                 09690099
097000                                                                  09700099
097100     MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC.                     09710099
097200     MOVE PV-TRIP-ID             TO HL2-TRIP-ID.                  09720099
097300     MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT.             09730099
097400                                                                  09740099
097500     IF DN-VEH-NBR = -1                                           09750099
097600         MOVE SPACES             TO HL2-TRAILER                   09760099
097700     ELSE                                                         09770099
097800         MOVE VHTRIP-VEH-NBR     TO HL2-TRAILER                   09780099
097900     END-IF.                                                      09790099
098000*                                                                 09800099
098100*                                                                 09810099
098200 1000-PROCESS-EXTRACT-FILE.                                       09820099
098300******************************************************************09830099
098400**  PERFORMS THE PROCESSING FOR THE PROGRAM.                      09840099
098500******************************************************************09850099
098600     IF PS-DETAIL-RECORD                                          09860099
098700         PERFORM 1500-SELECT-RECEIVING-UIDS                       09870099
098800     END-IF.                                                      09880099
098900                                                                  09890099
099000     IF PS-DETAIL-RECORD                                          09900099
099100         MOVE PC-AR TO PV-STATUS                                  09910099
099200         SET PS-STATUS-NOT-FOUND TO TRUE                          09920099
099300         PERFORM 1200-SELECT-STATUS                               09930099
099400     END-IF.                                                      09940099
099500                                                                  09950099
099600     IF PS-DETAIL-RECORD                                          09960099
099700         IF PS-STATUS-FOUND                                       09970099
099800             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              09980099
099900             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           09990099
100000             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           10000099
100100             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           10010099
100200             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           10020099
100300         ELSE                                                     10030099
100400             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           10040099
100500             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           10050099
100600             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           10060099
100700             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           10070099
100800         END-IF                                                   10080099
100900         MOVE PC-UG    TO PV-STATUS                               10090099
101000         SET PS-STATUS-NOT-FOUND TO TRUE                          10100099
101100         PERFORM 1200-SELECT-STATUS                               10110099
101200     END-IF.                                                      10120099
101300                                                                  10130099
101400     IF PS-DETAIL-RECORD                                          10140099
101500         IF PS-STATUS-FOUND                                       10150099
101600             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              10160099
101700             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        10170099
101800             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        10180099
101900             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        10190099
102000             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        10200099
102100         ELSE                                                     10210099
102200             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        10220099
102300             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        10230099
102400             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        10240099
102500             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        10250099
102600         END-IF                                                   10260099
102700         MOVE PC-UN    TO PV-STATUS                               10270099
102800         SET PS-STATUS-NOT-FOUND TO TRUE                          10280099
102900         PERFORM 1200-SELECT-STATUS                               10290099
103000     END-IF.                                                      10300099
103100                                                                  10310099
103200     IF PS-DETAIL-RECORD                                          10320099
103300         IF PS-STATUS-FOUND                                       10330099
103400             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              10340099
103500             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          10350099
103600             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          10360099
103700             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          10370099
103800             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          10380099
103900         ELSE                                                     10390099
104000             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          10400099
104100             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          10410099
104200             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          10420099
104300             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          10430099
104400         END-IF                                                   10440099
104500                                                                  10450099
104600*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  10460099
104700         IF CC-PRTR-CNTL-IND = 'P'                                10470099
104800             MOVE CC-TRACK-NBR    TO DS004-PLC-LF-FORM-NBR        10480099
104900             MOVE DS004-PES-8LPI  TO DS004-PLC-LF-LPI             10490099
105000                                                                  10500099
105100             WRITE SU-CARTON-NOT-RCVD-RECORD                      10510099
105200               FROM DS004-PLC-LOAD-FORM                           10520099
105300                 AFTER ADVANCING 1 LINE                           10530099
105400         END-IF                                                   10540099
105500                                                                  10550099
105600         PERFORM 8000-WRITE-REPORT-HEADERS                        10560099
105700                                                                  10570099
105800         PERFORM 2200-READ-EXTRACT                                10580099
105900                                                                  10590099
106000         PERFORM 2000-PROCESS-SU                                  10600099
106100     END-IF.                                                      10610099
106200                                                                  10620099
106300     IF PS-DETAIL-RECORD                                          10630099
106400         PERFORM 3000-PRINT-TOTALS                                10640099
106500                                                                  10650099
106600         WRITE SU-CARTON-NOT-RCVD-RECORD                          10660099
106700           FROM END-OF-REPORT-LINE                                10670099
106800             AFTER ADVANCING 2 LINES                              10680099
106900*                                                                 10690099
107000*    IF THIS IS A PRINTEK PRINTER 'AND' CONTROL CARD STATES TO    10700099
107100*    CUT AFTER PRINTING, SEND A CUT COMMAND                       10710099
107200*    ADDED 4/24/98 DENISE HAHN.                                   10720099
107300*                                                                 10730099
107400         IF  CC-PRTR-CNTL-IND = 'P'  AND                          10740099
107500             CC-CUT-REPORT-AT-END                                 10750099
107600                 WRITE SU-CARTON-NOT-RCVD-RECORD                  10760099
107700                   FROM DS004-PLC-CUT-FORM                        10770099
107800                     AFTER ADVANCING 1 LINE                       10780099
107900         END-IF                                                   10790099
108000     END-IF.                                                      10800099
108100                                                                  10810099
108200 1100-SELECT-TRAILER.                                             10820099
108300     MOVE '1100-SELECT-TRAILER '                                  10830099
108400                                 TO PV-ABEND-PARAGRAPH.           10840099
108500     EXEC SQL                                                     10850099
108600       SELECT A.OWNER_SCAC_ID                                     10860099
108700             ,A.VEH_NBR                                           10870099
108800             ,B.TRIP_STATUS_CDE                                   10880099
108900       INTO  :VHTRIP-OWNER-SCAC-ID                                10890099
109000            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          10900099
109100            ,:TRIPST-TRIP-STATUS-CDE                              10910099
109200       FROM   TVHTRIP A                                           10920099
109300             ,TTRIPST B                                           10930099
109400             ,TTRSTYP C                                           10940099
109500       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                10950099
109600         AND  B.TRIP_STATUS_CDE ^= 'DE'                           10960099
109700         AND  C.PRTY_CDE =                                        10970099
109800              (SELECT MAX(E.PRTY_CDE)                             10980099
109900                 FROM TTRIPST D                                   10990099
110000                     ,TTRSTYP E                                   11000099
110100                WHERE D.TRIP_ID         = A.TRIP_ID               11010099
110200                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      11020099
110300         AND  A.TRIP_ID         = B.TRIP_ID                       11030099
110400         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               11040099
110500     END-EXEC.                                                    11050099
110600                                                                  11060099
110700     EVALUATE TRUE                                                11070099
110800       WHEN SQLCODE = ZEROS                                       11080099
110900         CONTINUE                                                 11090099
111000       WHEN SQLCODE = +100                                        11100099
111100         MOVE SPACES TO VHTRIP-VEH-NBR                            11110099
111200                        VHTRIP-OWNER-SCAC-ID                      11120099
111300                        TRIPST-TRIP-STATUS-CDE                    11130099
111400       WHEN SQLCODE = -904                                        11140099
111500       WHEN SQLCODE = -911                                        11150099
111600       WHEN SQLCODE = -913                                        11160099
111700         SET PS-ERROR-RECORD TO TRUE                              11170099
111800         MOVE SPACES TO VHTRIP-VEH-NBR                            11180099
111900                        VHTRIP-OWNER-SCAC-ID                      11190099
112000                        TRIPST-TRIP-STATUS-CDE                    11200099
112100       WHEN OTHER                                                 11210099
112200         DISPLAY PV-ABEND-PARAGRAPH                               11220099
112300         PERFORM Z999-SQL-ERROR                                   11230099
112400     END-EVALUATE.                                                11240099
112500                                                                  11250099
112600 1200-SELECT-STATUS.                                              11260099
112700     MOVE '1200-SELECT-STATUS  '                                  11270099
112800                                 TO PV-ABEND-PARAGRAPH.           11280099
112900     EXEC SQL                                                     11290099
113000       SELECT STATUS_DTE                                          11300099
113100       INTO  :TRIPST-STATUS-DTE                                   11310099
113200       FROM   TTRIPST                                             11320099
113300       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                11330099
113400         AND  TRIP_STATUS_CDE    = :PV-STATUS                     11340099
113500     END-EXEC.                                                    11350099
113600                                                                  11360099
113700     EVALUATE TRUE                                                11370099
113800       WHEN SQLCODE = ZEROS                                       11380099
113900         SET PS-STATUS-FOUND TO TRUE                              11390099
114000       WHEN SQLCODE = +100                                        11400099
114100         SET PS-STATUS-NOT-FOUND TO TRUE                          11410099
114200       WHEN SQLCODE = -904                                        11420099
114300       WHEN SQLCODE = -911                                        11430099
114400       WHEN SQLCODE = -913                                        11440099
114500         SET PS-ERROR-RECORD TO TRUE                              11450099
114600       WHEN OTHER                                                 11460099
114700         DISPLAY PV-ABEND-PARAGRAPH                               11470099
114800         PERFORM Z999-SQL-ERROR                                   11480099
114900     END-EVALUATE.                                                11490099
115000                                                                  11500099
115100                                                                  11510099
115200 1500-SELECT-RECEIVING-UIDS.                                      11520099
115300******************************************************************11530099
115400* OPEN A CURSOR TO SELECT ALL THE USERIDS OF ALL THE RECEIVING    11540099
115500* ASSOCIATES WHO CHECKED-IN THIS TRAILER.                         11550099
115600******************************************************************11560099
115700                                                                  11570099
115800     INITIALIZE HL3B-USERID-TABLE                                 11580099
115900                PV-HOLD-UID.                                      11590099
116000     SET HL3B-UID-IDX TO +1.                                      11600099
116100     SET HL3B-UID-IDX DOWN BY +1.                                 11610099
116200                                                                  11620099
116300     PERFORM 1600-OPEN-UID-CURSOR.                                11630099
116400     IF PS-DETAIL-RECORD                                          11640099
116500         PERFORM 1700-FETCH-UID-CURSOR                            11650099
116600     END-IF.                                                      11660099
116700                                                                  11670099
116800     PERFORM UNTIL PS-EOF-UID-CURSOR                              11680099
116900                OR PS-ERROR-RECORD                                11690099
117000         IF SHUNLO-CRE-USR-ID = PV-HOLD-UID                       11700099
117100             CONTINUE                                             11710099
117200         ELSE                                                     11720099
117300             IF HL3B-UID-IDX > 0                                  11730099
117400                 MOVE ','          TO HL3B-COMMA (HL3B-UID-IDX)   11740099
117500             END-IF                                               11750099
117600                                                                  11760099
117700             SET HL3B-UID-IDX UP BY +1                            11770099
117800             MOVE SHUNLO-CRE-USR-ID TO                            11780099
117900                             HL3B-USER-ID (HL3B-UID-IDX)          11790099
118000             MOVE SHUNLO-CRE-USR-ID TO PV-HOLD-UID                11800099
118100         END-IF                                                   11810099
118200         PERFORM 1700-FETCH-UID-CURSOR                            11820099
118300     END-PERFORM.                                                 11830099
118400                                                                  11840099
118500     IF PS-DETAIL-RECORD                                          11850099
118600         PERFORM 1800-CLOSE-UID-CURSOR                            11860099
118700     END-IF.                                                      11870099
118800                                                                  11880099
118900                                                                  11890099
119000 1600-OPEN-UID-CURSOR.                                            11900099
119100******************************************************************11910099
119200*  THIS PROCEDURE WILL OPEN THE UID CURSOR.                       11920099
119300******************************************************************11930099
119400                                                                  11940099
119500     EXEC SQL                                                     11950099
119600          OPEN UID_CURSOR                                         11960099
119700     END-EXEC.                                                    11970099
119800                                                                  11980099
119900     EVALUATE TRUE                                                11990099
120000         WHEN SQLCODE = ZERO                                      12000099
120100              SET PS-NOT-EOF-UID-CURSOR                           12010099
120200                               TO  TRUE                           12020099
120300         WHEN SQLCODE = -904                                      12030099
120400         WHEN SQLCODE = -911                                      12040099
120500         WHEN SQLCODE = -913                                      12050099
120600              SET PS-ERROR-RECORD TO TRUE                         12060099
120700         WHEN SQLWARN0 NOT EQUAL SPACE                            12070099
120800         WHEN SQLCODE NOT EQUAL ZERO                              12080099
120900              MOVE '1600-OPEN-UID-CURSOR'                         12090099
121000                               TO  PV-ABEND-PARAGRAPH             12100099
121100              MOVE 'OPEN UID_CURSOR'                              12110099
121200                               TO  PV-DB2-OPERATION-ATTEMPTED     12120099
121300              DISPLAY '** PARAGRAPH ** '                          12130099
121400                                   PV-ABEND-PARAGRAPH             12140099
121500              DISPLAY '** OPERATION ** '                          12150099
121600                                   PV-DB2-OPERATION-ATTEMPTED     12160099
121700              PERFORM Z999-SQL-ERROR                              12170099
121800     END-EVALUATE.                                                12180099
121900                                                                  12190099
122000                                                                  12200099
122100 1700-FETCH-UID-CURSOR.                                           12210099
122200******************************************************************12220099
122300*  THIS PROCEDURE WILL FETCH THE UID-CURSOR.                      12230099
122400******************************************************************12240099
122500                                                                  12250099
122600     EXEC SQL                                                     12260099
122700          FETCH UID_CURSOR                                        12270099
122800          INTO                                                    12280099
122900                 :SHUNLO-CRE-USR-ID                               12290099
123000     END-EXEC.                                                    12300099
123100                                                                  12310099
123200     EVALUATE TRUE                                                12320099
123300         WHEN SQLCODE = ZERO                                      12330099
123400              CONTINUE                                            12340099
123500                                                                  12350099
123600         WHEN SQLCODE = +100                                      12360099
123700              SET PS-EOF-UID-CURSOR                               12370099
123800                               TO  TRUE                           12380099
123900         WHEN SQLCODE = -904                                      12390099
124000         WHEN SQLCODE = -911                                      12400099
124100         WHEN SQLCODE = -913                                      12410099
124200              SET PS-ERROR-RECORD TO TRUE                         12420099
124300         WHEN SQLWARN0 NOT EQUAL SPACE                            12430099
124400         WHEN SQLCODE NOT EQUAL ZERO                              12440099
124500              MOVE '1700-FETCH-UID-CURSOR'                        12450099
124600                               TO  PV-ABEND-PARAGRAPH             12460099
124700              MOVE 'FETCH UID_CURSOR'                             12470099
124800                               TO  PV-DB2-OPERATION-ATTEMPTED     12480099
124900              DISPLAY '** PARAGRAPH ** '                          12490099
125000                                   PV-ABEND-PARAGRAPH             12500099
125100              DISPLAY '** OPERATION ** '                          12510099
125200                                   PV-DB2-OPERATION-ATTEMPTED     12520099
125300              PERFORM Z999-SQL-ERROR                              12530099
125400     END-EVALUATE.                                                12540099
125500                                                                  12550099
125600                                                                  12560099
125700 1800-CLOSE-UID-CURSOR.                                           12570099
125800******************************************************************12580099
125900*  THIS PROCEDURE WILL CLOSE THE UID_CURSOR.                      12590099
126000******************************************************************12600099
126100                                                                  12610099
126200     EXEC SQL                                                     12620099
126300         CLOSE UID_CURSOR                                         12630099
126400     END-EXEC.                                                    12640099
126500                                                                  12650099
126600     EVALUATE TRUE                                                12660099
126700         WHEN SQLCODE = -904                                      12670099
126800         WHEN SQLCODE = -911                                      12680099
126900         WHEN SQLCODE = -913                                      12690099
127000              SET PS-ERROR-RECORD TO TRUE                         12700099
127100         WHEN SQLWARN0 NOT EQUAL SPACE                            12710099
127200         WHEN SQLCODE NOT EQUAL ZERO                              12720099
127300              MOVE '1800-CLOSE-UID-CURSOR'                        12730099
127400                               TO  PV-ABEND-PARAGRAPH             12740099
127500              MOVE 'CLOSE UID_CURSOR'                             12750099
127600                               TO  PV-DB2-OPERATION-ATTEMPTED     12760099
127700              DISPLAY '** PARAGRAPH ** '                          12770099
127800                                   PV-ABEND-PARAGRAPH             12780099
127900              DISPLAY '** OPERATION ** '                          12790099
128000                                   PV-DB2-OPERATION-ATTEMPTED     12800099
128100              PERFORM Z999-SQL-ERROR                              12810099
128200     END-EVALUATE.                                                12820099
128300                                                                  12830099
128400                                                                  12840099
128500 2000-PROCESS-SU.                                                 12850099
128600******************************************************************12860099
128700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *12870099
128800*  CARTONS NOT RECEIVED REPORT.                                  *12880099
128900******************************************************************12890099
129000     PERFORM 2300-PROCESS-EXTRACT                                 12900099
129100         UNTIL PS-END-OF-EXTRACT                                  12910099
129200            OR PS-ERROR-RECORD.                                   12920099
129300                                                                  12930099
129400 2200-READ-EXTRACT.                                               12940099
129500      READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                 12950099
129600        AT END                                                    12960099
129700           SET PS-END-OF-EXTRACT TO TRUE                          12970099
129800           MOVE PC-NINE-9-9 TO SU001-PO-NUMBER                    12980099
129900                               SU001-REC-SEQ-NBR                  12990099
130000           MOVE PC-NINE-9-18 TO SU001-SHIPT-UNT-ID.               13000099
130100                                                                  13010099
130200 2300-PROCESS-EXTRACT.                                            13020099
130300     MOVE SU001-PO-NUMBER        TO PV-PO                         13030099
130400                                    PV-SAVE-PO.                   13040099
130500     MOVE SU001-REC-SEQ-NBR      TO PV-RECEIVER                   13050099
130600                                    PV-SAVE-RECEIVER              13060099
130700                                    PKSLIP-REC-SEQ-NBR.           13070099
130800     IF SU001-PO-NUMBER = PC-NEG-9S                               13080099
130900         MOVE PC-COMPANY-MISDIRECT TO PV-PO-RECEIVER              13090099
131000     END-IF.                                                      13100099
131100     MOVE SU001-SHIPT-UNT-ID     TO PV-SHIPT-UNT-ID.              13110099
131200     MOVE PV-RECEIVER            TO TRBNTF-REC-SEQ-NBR            13120099
131300                                    RECEIV-REC-SEQ-NBR.           13130099
131400     MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER               13140099
131500     SET PS-PO-FOUND TO TRUE.                                     13150099
131600     MOVE PV-SAVE-PO             TO PURCHS-PO-NBR                 13160099
131700                                    PKSLIP-PO-NBR                 13170099
131800                                    TRBNTF-PO-NBR                 13180099
131900                                    RECEIV-ORD-NBR.               13190099
132000     PERFORM 2500-SELECT-PO-INFO                                  13200099
132100                                                                  13210099
132200     IF PS-DETAIL-RECORD                                          13220099
132300         IF PS-PO-FOUND                                           13230099
132400             MOVE PURCHS-DEPT-NBR        TO DL1-DEPT              13240099
132500             MOVE ENTNME-ENT-NAME-DESC   TO DL1-VENDOR-NAME       13250099
132600         ELSE                                                     13260099
132700             MOVE SPACES                 TO DL1-DEPT              13270099
132800             MOVE SPACES                 TO DL1-VENDOR-NAME       13280099
132900         END-IF                                                   13290099
133000         PERFORM 2600-SELECT-TROUBLE                              13300099
133100     END-IF.                                                      13310099
133200                                                                  13320099
133300     IF PS-DETAIL-RECORD                                          13330099
133400         PERFORM 2700-SELECT-TRECEIV                              13340099
133500     END-IF.                                                      13350099
133600                                                                  13360099
133700     IF PS-DETAIL-RECORD                                          13370099
133800         IF RECEIV-PACK-BY-ST-IND = 'Y'                           13380099
133900             MOVE RECEIV-PACK-BY-ST-IND TO DL1-PBS-IND            13390099
134000         ELSE                                                     13400099
134100             MOVE SPACES                TO DL1-PBS-IND            13410099
134200         END-IF                                                   13420099
134300         PERFORM 2800-SUM-CARTONS                                 13430099
134400     END-IF.                                                      13440099
134500                                                                  13450099
134600     IF PS-DETAIL-RECORD                                          13460099
134700         MOVE PV-DB2-COUNT TO DL1-DOWNLOAD-CNT                    13470099
134800                              PV-DOWNLOAD-CNT                     13480099
134900         ADD PV-DB2-COUNT  TO PV-DWNLD-CRTN-TOT                   13490099
135000         IF RECEIV-EXPTED-CART-CNT = PV-DOWNLOAD-CNT              13500099
135100             MOVE SPACES TO  DL1-ASTERISK                         13510099
135200         ELSE                                                     13520099
135300             MOVE '*'    TO  DL1-ASTERISK                         13530099
135400         END-IF                                                   13540099
135500         INITIALIZE PV-EXCEPTION-FIELDS                           13550099
135600         SET PS-PO-SEQUENCE-SET TO TRUE                           13560099
135700         MOVE SU001-SCANNED-IND TO PV-SCANNED-IND                 13570099
135800         PERFORM 2400-PROCESS-EXTRACT                             13580099
135900           UNTIL PS-PO-SEQUENCE-CHANGE                            13590099
136000              OR PS-END-OF-EXTRACT                                13600099
136100*LMM                                                              13610099
136200         IF PV-FREE-ASTRAY-IND = PC-Y                             13620099
136300             MOVE 0                      TO DL1-ASN-CARTON-CNT    13630099
136400             IF PV-DOWNLOAD-CNT NOT = 0                           13640099
136500                 MOVE '*'    TO  DL1-ASTERISK                     13650099
136600             ELSE                                                 13660099
136700                 MOVE SPACES TO  DL1-ASTERISK                     13670099
136800             END-IF                                               13680099
136900         ELSE                                                     13690099
137000             MOVE RECEIV-EXPTED-CART-CNT TO DL1-ASN-CARTON-CNT    13700099
137100             ADD  RECEIV-EXPTED-CART-CNT TO PV-TRLR-CRTN-TOT      13710099
137200         END-IF                                                   13720099
137300         MOVE PV-SCANNED-COUNT TO DL1-SCANNED-CNT                 13730099
137400         ADD  PV-SCANNED-COUNT TO PV-SCAN-CRTN-TOT                13740099
137500         COMPUTE PV-DIFFERENCE = PV-DB2-COUNT - PV-SCANNED-COUNT  13750099
137600         MOVE PV-DIFFERENCE TO DL1-DIFFERENCE                     13760099
137700         SET PS-NO-DETAIL-REC-WRITTEN TO TRUE                     13770099
137800         MOVE SPACES         TO DL1-REMARKS                       13780099
137900         IF PV-MISDIRECT-IND = PC-Y                               13790099
138000             IF PV-AUTO-VE-IND = PC-Y                             13800099
138100                CONTINUE                                          13810099
138200             ELSE                                                 13820099
138300                MOVE PC-AST             TO PV-RECEIVER-X          13830099
138400                MOVE PV-PO-RECEIVER     TO DL1-PO-RECEIVER        13840099
138500             END-IF                                               13850099
138600             MOVE PC-MISDIRECTS TO DL1-REMARKS                    13860099
138700             IF  PV-LINE-CNT > PC-60                              13870099
138800                  PERFORM 8000-WRITE-REPORT-HEADERS               13880099
138900             END-IF                                               13890099
139000             PERFORM 8400-WRITE-DETAIL-LINES                      13900099
139100             SET PS-DETAIL-REC-WRITTEN TO TRUE                    13910099
139200         END-IF                                                   13920099
139300         IF PV-FREE-ASTRAY-IND = PC-Y                             13930099
139400             IF  PV-LINE-CNT > PC-60                              13940099
139500                  PERFORM 8000-WRITE-REPORT-HEADERS               13950099
139600             END-IF                                               13960099
139700*LMM                                                              13970099
139800                 IF PV-AUTO-VE-IND = PC-Y                         13980099
139900                    PERFORM 2980-GET-ORIG-RCVR-NBR                13990099
140000                 ELSE                                             14000099
140100                    MOVE PC-AST             TO PV-RECEIVER-X      14010099
140200                    MOVE PV-PO-RECEIVER     TO DL1-PO-RECEIVER    14020099
140300                    MOVE PV-SAVE-RECEIVER   TO FREE-ASTRAY-REC-SEQ14030099
140400                    IF PS-DETAIL-REC-WRITTEN                      14040099
140500                       MOVE PC-FREE-ASTRAY TO DL2-REMARKS         14050099
140600                       MOVE PC-1               TO PV-LINE-SUB     14060099
140700                       PERFORM 8500-WRITE-DETAIL-LINES            14070099
140800                    ELSE                                          14080099
140900                        MOVE PC-FREE-ASTRAY TO DL1-REMARKS        14090099
141000                        MOVE PC-2               TO PV-LINE-SUB    14100099
141100                        PERFORM 8400-WRITE-DETAIL-LINES           14110099
141200                        SET PS-DETAIL-REC-WRITTEN TO TRUE         14120099
141300                    END-IF                                        14130099
141400                 END-IF                                           14140099
141500         END-IF                                                   14150099
141600         IF PV-DUP-SCAN-IND = PC-Y                                14160099
141700         OR PV-ANOTHER-TRAILER-IND = PC-Y                         14170099
141800             IF PV-LINE-CNT > PC-60                               14180099
141900                 PERFORM 8000-WRITE-REPORT-HEADERS                14190099
142000             END-IF                                               14200099
142100             IF PS-DETAIL-REC-WRITTEN                             14210099
142200                 MOVE PC-DUPLICATES TO DL2-REMARKS                14220099
142300                 MOVE PC-1            TO PV-LINE-SUB              14230099
142400                 PERFORM 8500-WRITE-DETAIL-LINES                  14240099
142500                 MOVE PC-2            TO PV-LINE-SUB              14250099
142600             ELSE                                                 14260099
142700                 MOVE PC-DUPLICATES TO DL1-REMARKS                14270099
142800                 PERFORM 8400-WRITE-DETAIL-LINES                  14280099
142900                 SET PS-DETAIL-REC-WRITTEN TO TRUE                14290099
143000             END-IF                                               14300099
143100         END-IF                                                   14310099
143200         IF PV-NOT-FOUND-IND = PC-Y                               14320099
143300             IF  PV-LINE-CNT > PC-60                              14330099
143400                  PERFORM 8000-WRITE-REPORT-HEADERS               14340099
143500             END-IF                                               14350099
143600             IF PS-DETAIL-REC-WRITTEN                             14360099
143700                 MOVE PC-NOT-FOUND  TO DL2-REMARKS                14370099
143800                 MOVE PC-1            TO PV-LINE-SUB              14380099
143900                 PERFORM 8500-WRITE-DETAIL-LINES                  14390099
144000                 MOVE PC-2            TO PV-LINE-SUB              14400099
144100             ELSE                                                 14410099
144200                 MOVE PC-NOT-FOUND  TO DL1-REMARKS                14420099
144300                 PERFORM 8400-WRITE-DETAIL-LINES                  14430099
144400                 SET PS-DETAIL-REC-WRITTEN TO TRUE                14440099
144500             END-IF                                               14450099
144600         END-IF                                                   14460099
144700         IF PV-NEVER-SCANNED-IND = PC-Y                           14470099
144800             IF  PV-LINE-CNT > PC-60                              14480099
144900                  PERFORM 8000-WRITE-REPORT-HEADERS               14490099
145000             END-IF                                               14500099
145100             IF PS-DETAIL-REC-WRITTEN                             14510099
145200                 MOVE PC-NOT-SCANNED TO DL2-REMARKS               14520099
145300                 MOVE PC-1            TO PV-LINE-SUB              14530099
145400                 PERFORM 8500-WRITE-DETAIL-LINES                  14540099
145500                 MOVE PC-2            TO PV-LINE-SUB              14550099
145600             ELSE                                                 14560099
145700                 MOVE PC-NOT-SCANNED TO DL1-REMARKS               14570099
145800                 PERFORM 8400-WRITE-DETAIL-LINES                  14580099
145900                 SET PS-DETAIL-REC-WRITTEN TO TRUE                14590099
146000             END-IF                                               14600099
146100         END-IF                                                   14610099
146200         PERFORM 2900-CHECK-CASEPACK-REDO                         14620099
146300         IF PV-DB2-COUNT3 > 0                                     14630099
146400             IF  PV-LINE-CNT > PC-60                              14640099
146500                  PERFORM 8000-WRITE-REPORT-HEADERS               14650099
146600             END-IF                                               14660099
146700             IF PS-DETAIL-REC-WRITTEN                             14670099
146800                 MOVE PC-REDO-ON-CASEPACK TO DL2-REMARKS          14680099
146900                 MOVE PC-1            TO PV-LINE-SUB              14690099
147000                 PERFORM 8500-WRITE-DETAIL-LINES                  14700099
147100                 MOVE PC-2            TO PV-LINE-SUB              14710099
147200             ELSE                                                 14720099
147300                 MOVE PC-REDO-ON-CASEPACK TO DL2-REMARKS          14730099
147400                 PERFORM 8400-WRITE-DETAIL-LINES                  14740099
147500                 SET PS-DETAIL-REC-WRITTEN TO TRUE                14750099
147600             END-IF                                               14760099
147700         END-IF                                                   14770099
147800         PERFORM 2950-CHECK-INACTIVE-PACKSLIP                     14780099
147900         IF PV-DB2-COUNT4 > 0                                     14790099
148000             IF  PV-LINE-CNT > PC-60                              14800099
148100                  PERFORM 8000-WRITE-REPORT-HEADERS               14810099
148200             END-IF                                               14820099
148300             IF PS-DETAIL-REC-WRITTEN                             14830099
148400                 MOVE PC-INACTIVE-PACKSLIPS TO DL2-REMARKS        14840099
148500                 MOVE PC-1            TO PV-LINE-SUB              14850099
148600                 PERFORM 8500-WRITE-DETAIL-LINES                  14860099
148700                 MOVE PC-2            TO PV-LINE-SUB              14870099
148800             ELSE                                                 14880099
148900                 MOVE PC-INACTIVE-PACKSLIPS TO DL2-REMARKS        14890099
149000                 PERFORM 8400-WRITE-DETAIL-LINES                  14900099
149100                 SET PS-DETAIL-REC-WRITTEN TO TRUE                14910099
149200             END-IF                                               14920099
149300         END-IF                                                   14930099
149400         IF PS-DETAIL-REC-WRITTEN                                 14940099
149500             CONTINUE                                             14950099
149600         ELSE                                                     14960099
149700             IF  PV-LINE-CNT > PC-60                              14970099
149800                  PERFORM 8000-WRITE-REPORT-HEADERS               14980099
149900             END-IF                                               14990099
150000             PERFORM 8400-WRITE-DETAIL-LINES                      15000099
150100         END-IF                                                   15010099
150200     END-IF.                                                      15020099
150300                                                                  15030099
150400 2400-PROCESS-EXTRACT.                                            15040099
150500     IF SU001-SCANNED-IND = PC-Y                                  15050099
150600         ADD 1 TO PV-SCANNED-COUNT                                15060099
150700     END-IF.                                                      15070099
150800     IF SU001-MISDIRECT-IND = PC-Y                                15080099
150900         MOVE SU001-MISDIRECT-IND TO PV-MISDIRECT-IND             15090099
151000     END-IF.                                                      15100099
151100     IF SU001-NOT-FOUND-IND = PC-Y                                15110099
151200         MOVE SU001-NOT-FOUND-IND TO PV-NOT-FOUND-IND             15120099
151300     END-IF.                                                      15130099
151400     IF SU001-FREE-ASTRAY-IND = PC-Y                              15140099
151500         MOVE SU001-FREE-ASTRAY-IND TO PV-FREE-ASTRAY-IND         15150099
151600     END-IF.                                                      15160099
151700     IF SU001-ANOTHER-TRAILER-IND = PC-Y                          15170099
151800         MOVE SU001-ANOTHER-TRAILER-IND TO PV-ANOTHER-TRAILER-IND 15180099
151900     END-IF.                                                      15190099
152000     IF SU001-AUTO-VE-IND = PC-Y                                  15200099
152100         MOVE SU001-AUTO-VE-IND TO PV-AUTO-VE-IND                 15210099
152200     END-IF.                                                      15220099
152300                                                                  15230099
152400     PERFORM 2200-READ-EXTRACT.                                   15240099
152500     IF SU001-PO-NUMBER NOT = PV-SAVE-PO OR                       15250099
152600        SU001-REC-SEQ-NBR NOT = PV-SAVE-RECEIVER                  15260099
152700         SET PS-PO-SEQUENCE-CHANGE TO TRUE                        15270099
152800     END-IF.                                                      15280099
152900     IF SU001-SHIPT-UNT-ID = PV-SHIPT-UNT-ID                      15290099
153000         IF SU001-SCANNED-IND = PC-Y AND                          15300099
153100            PV-SCANNED-IND = PC-Y                                 15310099
153200             MOVE PC-Y TO PV-DUP-SCAN-IND                         15320099
153300         END-IF                                                   15330099
153400     ELSE                                                         15340099
153500         MOVE SU001-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID               15350099
153600* THIS "IF" TEST ASSUMES THAT THE INPUT RECORDS ARE SORTED ON THE 15360099
153700* SU001-SCANNED-IND FIELD.  IF THE CURRENT RECORD HAS A NEW       15370099
153800* SHIPT-UNT-ID VALUE AND THE PREVIOUS RECORD DID NOT HAVE A 'Y'   15380099
153900* IN THE SU001-SCANNED-IND FIELD, THE CARTON WAS NEVER SCANNED.   15390099
154000         IF PV-SCANNED-IND NOT = PC-Y                             15400099
154100             MOVE PC-Y TO PV-NEVER-SCANNED-IND                    15410099
154200         END-IF                                                   15420099
154300     END-IF.                                                      15430099
154400     MOVE SU001-SCANNED-IND TO PV-SCANNED-IND.                    15440099
154500                                                                  15450099
154600                                                                  15460099
154700 2500-SELECT-PO-INFO.                                             15470099
154800     MOVE '2500-SELECT-PO-INFO'                                   15480099
154900                                 TO PV-ABEND-PARAGRAPH.           15490099
155000                                                                  15500099
155100     EXEC SQL                                                     15510099
155200        SELECT  A.DEPT_NBR                                        15520099
155300               ,B.ENT_NAME_DESC                                   15530099
155400          INTO :PURCHS-DEPT-NBR                                   15540099
155500              ,:ENTNME-ENT-NAME-DESC                              15550099
155600          FROM  TPURCHS A                                         15560099
155700               ,TENTNME B                                         15570099
155800      WHERE A.PO_NBR         = :PURCHS-PO-NBR                     15580099
155900        AND A.VER_STATUS_CDE = 'A'                                15590099
156000        AND B.TYPE_CDE       = '01'                               15600099
156100        AND A.ENT_ID = B.ENT_ID                                   15610099
156200     END-EXEC                                                     15620099
156300                                                                  15630099
156400     EVALUATE TRUE                                                15640099
156500       WHEN SQLCODE = ZEROS                                       15650099
156600         CONTINUE                                                 15660099
156700       WHEN SQLCODE = +100                                        15670099
156800         SET PS-PO-NOT-FOUND TO TRUE                              15680099
156900       WHEN SQLCODE = -904                                        15690099
157000       WHEN SQLCODE = -911                                        15700099
157100       WHEN SQLCODE = -913                                        15710099
157200         SET PS-ERROR-RECORD TO TRUE                              15720099
157300       WHEN OTHER                                                 15730099
157400         DISPLAY PV-ABEND-PARAGRAPH                               15740099
157500         DISPLAY 'PO NUMBER: ' PURCHS-PO-NBR                      15750099
157600         PERFORM Z999-SQL-ERROR                                   15760099
157700     END-EVALUATE.                                                15770099
157800                                                                  15780099
157900                                                                  15790099
158000                                                                  15800099
158100 2600-SELECT-TROUBLE.                                             15810099
158200     MOVE '2600-SELECT-TROUBLE'                                   15820099
158300                                 TO PV-ABEND-PARAGRAPH.           15830099
158400     EXEC SQL                                                     15840099
158500         SELECT B.TRBL_SHT_DESC                                   15850099
158600         INTO :TRBRSN-TRBL-SHT-DESC                               15860099
158700         FROM  TTRBNTF A                                          15870099
158800              ,TTRBRSN B                                          15880099
158900         WHERE A.PO_NBR           = :TRBNTF-PO-NBR                15890099
159000               AND A.REC_SEQ_NBR  = :TRBNTF-REC-SEQ-NBR           15900099
159100               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               15910099
159200               AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE                15920099
159300     END-EXEC.                                                    15930099
159400                                                                  15940099
159500                                                                  15950099
159600     EVALUATE TRUE                                                15960099
159700         WHEN SQLCODE = +0                                        15970099
159800             MOVE TRBRSN-TRBL-SHT-DESC TO DL1-TROUBLE             15980099
159900             MOVE SPACE                TO DL1-TROUBLE-AST         15990099
160000         WHEN SQLCODE = -811                                      16000099
160100             MOVE TRBRSN-TRBL-SHT-DESC TO DL1-TROUBLE             16010099
160200             MOVE '*'                  TO DL1-TROUBLE-AST         16020099
160300         WHEN SQLCODE = +100                                      16030099
160400             MOVE SPACES               TO DL1-TROUBLE             16040099
160500                                          DL1-TROUBLE-AST         16050099
160600         WHEN SQLCODE = -904                                      16060099
160700         WHEN SQLCODE = -911                                      16070099
160800         WHEN SQLCODE = -913                                      16080099
160900             SET PS-ERROR-RECORD TO TRUE                          16090099
161000         WHEN OTHER                                               16100099
161100           DISPLAY PV-ABEND-PARAGRAPH                             16110099
161200           DISPLAY 'PO NUMBER: ' TRBNTF-PO-NBR                    16120099
161300           DISPLAY 'RECEIVER SEQ NBR: ' TRBNTF-REC-SEQ-NBR        16130099
161400           PERFORM Z999-SQL-ERROR                                 16140099
161500     END-EVALUATE.                                                16150099
161600                                                                  16160099
161700 2700-SELECT-TRECEIV.                                             16170099
161800     MOVE '2700-SELECT-TRECEIV'                                   16180099
161900                                 TO PV-ABEND-PARAGRAPH.           16190099
162000     EXEC SQL                                                     16200099
162100          SELECT EXPTED_CART_CNT                                  16210099
162200               , PACK_BY_ST_IND                                   16220099
162300            INTO :RECEIV-EXPTED-CART-CNT                          16230099
162400               , :RECEIV-PACK-BY-ST-IND                           16240099
162500            FROM TRECEIV                                          16250099
162600           WHERE ORD_NBR        = :RECEIV-ORD-NBR                 16260099
162700             AND REC_SEQ_NBR    = :RECEIV-REC-SEQ-NBR             16270099
162800             AND VER_STATUS_CDE = 'A'                             16280099
162900     END-EXEC.                                                    16290099
163000                                                                  16300099
163100                                                                  16310099
163200     EVALUATE TRUE                                                16320099
163300         WHEN SQLCODE = +0                                        16330099
163400             CONTINUE                                             16340099
163500         WHEN SQLCODE = +100                                      16350099
163600            MOVE 0 TO RECEIV-EXPTED-CART-CNT                      16360099
163700         WHEN SQLCODE = -904                                      16370099
163800         WHEN SQLCODE = -911                                      16380099
163900         WHEN SQLCODE = -913                                      16390099
164000            SET PS-ERROR-RECORD TO TRUE                           16400099
164100         WHEN OTHER                                               16410099
164200           DISPLAY PV-ABEND-PARAGRAPH                             16420099
164300           DISPLAY 'PO NUMBER: ' RECEIV-ORD-NBR                   16430099
164400           DISPLAY 'RECEIVER SEQ NBR: ' RECEIV-REC-SEQ-NBR        16440099
164500           PERFORM Z999-SQL-ERROR                                 16450099
164600     END-EVALUATE.                                                16460099
164700                                                                  16470099
164800 2800-SUM-CARTONS.                                                16480099
164900     MOVE '2800-SUM-CARTONS   '                                   16490099
165000                                 TO PV-ABEND-PARAGRAPH.           16500099
165100     MOVE ZERO TO PV-DB2-COUNT.                                   16510099
165200                                                                  16520099
165300*    EXEC SQL                                                     16530099
165400*        SELECT COUNT(*)                                          16540099
165500*           INTO :PV-DB2-COUNT                                    16550099
165600*           FROM TPKSLIP A                                        16560099
165700*              , TINPKSU B                                        16570099
165800*         WHERE A.PO_NBR            = :PKSLIP-PO-NBR              16580099
165900*           AND A.REC_SEQ_NBR       = :PKSLIP-REC-SEQ-NBR         16590099
166000*           AND A.VER_STAT_CDE      = :PC-A                       16600099
166100*           AND A.PO_NBR            = B.PO_NBR                    16610099
166200*           AND A.SEQ_NBR           = B.SEQ_NBR                   16620099
166300*    END-EXEC.                                                    16630099
166400                                                                  16640099
166410     EXEC SQL                                                     16641099
166420          SELECT  COUNT(*)                                        16642099
166430          INTO  :PV-DB2-COUNT                                     16643099
166440          FROM   TSHIPMT A                                        16644099
166450                ,TSHPTPO B                                        16645099
166460                ,TPKSLIP C                                        16646099
166470                ,TINPKSU D                                        16647099
166480                ,TSHPUNT E                                        16648099
166490          WHERE A.TRIP_ID =     :VHTRIP-TRIP-ID                   16649099
166491            AND B.PO_NBR  =     :PKSLIP-PO-NBR                    16649199
166492            AND B.REC_SEQ_NBR = :PKSLIP-REC-SEQ-NBR               16649299
166493            AND B.PO_NBR      = C.PO_NBR                          16649399
166494            AND B.REC_SEQ_NBR = C.REC_SEQ_NBR                     16649499
166495            AND B.PRIM_SHIPT_IND= 'Y'                             16649599
166496            AND C.VER_STAT_CDE = 'A'                              16649699
166497            AND B.PO_NBR   = D.PO_NBR                             16649799
166498            AND D.SEQ_NBR   = C.SEQ_NBR                           16649899
166499            AND A.SHIPT_ID = B.SHIPT_ID                           16649999
166500            AND D.SHIPT_UNT_ID = E.SHIPT_UNT_ID                   16650099
166501            AND E.ACTV_IND = 'A'                                  16650199
166502     END-EXEC                                                     16650299
166503                                                                  16650399
166510                                                                  16651099
166600     EVALUATE TRUE                                                16660099
166700         WHEN SQLCODE = +0                                        16670099
166800             CONTINUE                                             16680099
166900         WHEN SQLCODE = -904                                      16690099
167000         WHEN SQLCODE = -911                                      16700099
167100         WHEN SQLCODE = -913                                      16710099
167200            SET PS-ERROR-RECORD TO TRUE                           16720099
167300         WHEN OTHER                                               16730099
167400           DISPLAY PV-ABEND-PARAGRAPH                             16740099
167500           DISPLAY 'PO NUMBER: ' PKSLIP-PO-NBR                    16750099
167600           DISPLAY 'RECEIVER SEQ NBR: ' PKSLIP-REC-SEQ-NBR        16760099
167700           PERFORM Z999-SQL-ERROR                                 16770099
167800     END-EVALUATE.                                                16780099
167900                                                                  16790099
168000 2900-CHECK-CASEPACK-REDO.                                        16800099
168100     MOVE '2900-CHECK-CASEPACK-REDO'                              16810099
168200                                 TO PV-ABEND-PARAGRAPH.           16820099
168300     MOVE ZERO TO PV-DB2-COUNT3.                                  16830099
168400                                                                  16840099
168500     EXEC SQL                                                     16850099
168600         SELECT COUNT(*)                                          16860099
168700            INTO :PV-DB2-COUNT3                                   16870099
168800            FROM TPKSLIP A                                        16880099
168900               , TINPKSU B                                        16890099
169000               , TSULBXF C                                        16900099
169100          WHERE A.PO_NBR            = :PKSLIP-PO-NBR              16910099
169200            AND A.REC_SEQ_NBR       = :PKSLIP-REC-SEQ-NBR         16920099
169300            AND A.VER_STAT_CDE      = :PC-A                       16930099
169400            AND A.PO_NBR            = B.PO_NBR                    16940099
169500            AND A.SEQ_NBR           = B.SEQ_NBR                   16950099
169600            AND B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              16960099
169700            AND C.STAT_CDE          = :PC-I                       16970099
169800     END-EXEC.                                                    16980099
169900                                                                  16990099
170000                                                                  17000099
170100     EVALUATE TRUE                                                17010099
170200         WHEN SQLCODE = +0                                        17020099
170300             CONTINUE                                             17030099
170400         WHEN SQLCODE = -904                                      17040099
170500         WHEN SQLCODE = -911                                      17050099
170600         WHEN SQLCODE = -913                                      17060099
170700            SET PS-ERROR-RECORD TO TRUE                           17070099
170800         WHEN OTHER                                               17080099
170900           DISPLAY PV-ABEND-PARAGRAPH                             17090099
171000           DISPLAY 'PO NUMBER: ' PKSLIP-PO-NBR                    17100099
171100           DISPLAY 'RECEIVER SEQ NBR: ' PKSLIP-REC-SEQ-NBR        17110099
171200           PERFORM Z999-SQL-ERROR                                 17120099
171300     END-EVALUATE.                                                17130099
171400                                                                  17140099
171500 2950-CHECK-INACTIVE-PACKSLIP.                                    17150099
171600     MOVE '2950-CHECK-INACTIVE-PACKSLIP'                          17160099
171700                                 TO PV-ABEND-PARAGRAPH.           17170099
171800     MOVE ZERO TO PV-DB2-COUNT4.                                  17180099
171900                                                                  17190099
172000     EXEC SQL                                                     17200099
172100         SELECT COUNT(*)                                          17210099
172200            INTO :PV-DB2-COUNT4                                   17220099
172300            FROM TPKSLIP                                          17230099
172400          WHERE PO_NBR              = :PKSLIP-PO-NBR              17240099
172500            AND REC_SEQ_NBR         = :PKSLIP-REC-SEQ-NBR         17250099
172600            AND VER_STAT_CDE        = :PC-A                       17260099
172700            AND PKSL_STAT_CDE       = :PC-IN                      17270099
172800     END-EXEC.                                                    17280099
172900                                                                  17290099
173000     EVALUATE TRUE                                                17300099
173100         WHEN SQLCODE = +0                                        17310099
173200             CONTINUE                                             17320099
173300         WHEN SQLCODE = -904                                      17330099
173400         WHEN SQLCODE = -911                                      17340099
173500         WHEN SQLCODE = -913                                      17350099
173600            SET PS-ERROR-RECORD TO TRUE                           17360099
173700         WHEN OTHER                                               17370099
173800           DISPLAY PV-ABEND-PARAGRAPH                             17380099
173900           DISPLAY 'PO NUMBER: ' PKSLIP-PO-NBR                    17390099
174000           DISPLAY 'RECEIVER SEQ NBR: ' PKSLIP-REC-SEQ-NBR        17400099
174100           PERFORM Z999-SQL-ERROR                                 17410099
174200     END-EVALUATE.                                                17420099
174300                                                                  17430099
174400                                                                  17440099
174500 2980-GET-ORIG-RCVR-NBR.                                          17450099
174600     PERFORM 2981-OPEN-RCVR-CSR                                   17460099
174700                                                                  17470099
174800     PERFORM 2982-FETCH-RCVR-CSR                                  17480099
174900                                                                  17490099
175000     PERFORM UNTIL PS-EOF-RCVR-CURSOR                             17500099
175100        MOVE PKSLIP-REC-SEQ-NBR TO FREE-ASTRAY-REC-SEQ            17510099
175200        MOVE PC-FREE-ASTRAY  TO DL1-REMARKS                       17520099
175300                                DL2-REMARKS                       17530099
175400        IF PS-DETAIL-REC-WRITTEN                                  17540099
175500           MOVE PC-1             TO PV-LINE-SUB                   17550099
175600           PERFORM 8500-WRITE-DETAIL-LINES                        17560099
175700        ELSE                                                      17570099
175800           MOVE PC-2             TO PV-LINE-SUB                   17580099
175900           PERFORM 8400-WRITE-DETAIL-LINES                        17590099
176000           SET PS-DETAIL-REC-WRITTEN TO TRUE                      17600099
176100        END-IF                                                    17610099
176200        PERFORM 2982-FETCH-RCVR-CSR                               17620099
176300     END-PERFORM                                                  17630099
176400                                                                  17640099
176500     PERFORM 2983-CLOSE-RCVR-CSR.                                 17650099
176600                                                                  17660099
176700                                                                  17670099
176800******************************************************************17680099
176900*  OPEN THE RCVR CSR                                              17690099
177000******************************************************************17700099
177100 2981-OPEN-RCVR-CSR.                                              17710099
177200     EXEC SQL                                                     17720099
177300          OPEN RCVR_CURSOR                                        17730099
177400     END-EXEC.                                                    17740099
177500                                                                  17750099
177600     EVALUATE TRUE                                                17760099
177700         WHEN SQLCODE = ZERO                                      17770099
177800              SET PS-NOT-EOF-RCVR-CURSOR                          17780099
177900                               TO  TRUE                           17790099
178000         WHEN SQLCODE = -904                                      17800099
178100         WHEN SQLCODE = -911                                      17810099
178200         WHEN SQLCODE = -913                                      17820099
178300              SET PS-ERROR-RECORD TO TRUE                         17830099
178400         WHEN SQLWARN0 NOT EQUAL SPACE                            17840099
178500         WHEN SQLCODE NOT EQUAL ZERO                              17850099
178600              MOVE '2981-OPEN-RCVR-CURSOR'                        17860099
178700                               TO  PV-ABEND-PARAGRAPH             17870099
178800              MOVE 'OPEN RCVR_CURSOR'                             17880099
178900                               TO  PV-DB2-OPERATION-ATTEMPTED     17890099
179000              DISPLAY '** PARAGRAPH ** '                          17900099
179100                                   PV-ABEND-PARAGRAPH             17910099
179200              DISPLAY '** OPERATION ** '                          17920099
179300                                   PV-DB2-OPERATION-ATTEMPTED     17930099
179400              PERFORM Z999-SQL-ERROR                              17940099
179500     END-EVALUATE.                                                17950099
179600                                                                  17960099
179700******************************************************************17970099
179800*  FETCH THE RCVR-CSR                                             17980099
179900******************************************************************17990099
180000 2982-FETCH-RCVR-CSR.                                             18000099
180100                                                                  18010099
180200     EXEC SQL                                                     18020099
180300          FETCH RCVR_CURSOR                                       18030099
180400          INTO :PKSLIP-REC-SEQ-NBR                                18040099
180500     END-EXEC.                                                    18050099
180600                                                                  18060099
180700     EVALUATE TRUE                                                18070099
180800         WHEN SQLCODE = ZERO                                      18080099
180900             CONTINUE                                             18090099
181000         WHEN SQLCODE = +100                                      18100099
181100             SET PS-EOF-RCVR-CURSOR                               18110099
181200                               TO  TRUE                           18120099
181300         WHEN SQLCODE = -904                                      18130099
181400         WHEN SQLCODE = -911                                      18140099
181500         WHEN SQLCODE = -913                                      18150099
181600              SET PS-ERROR-RECORD TO TRUE                         18160099
181700         WHEN SQLWARN0 NOT EQUAL SPACE                            18170099
181800         WHEN SQLCODE NOT EQUAL ZERO                              18180099
181900              MOVE '2982-FETCH-RCVR-CURSOR'                       18190099
182000                               TO  PV-ABEND-PARAGRAPH             18200099
182100              MOVE 'FETCH RCVR_CURSOR'                            18210099
182200                               TO  PV-DB2-OPERATION-ATTEMPTED     18220099
182300              DISPLAY '** PARAGRAPH ** '                          18230099
182400                                   PV-ABEND-PARAGRAPH             18240099
182500              DISPLAY '** OPERATION ** '                          18250099
182600                                   PV-DB2-OPERATION-ATTEMPTED     18260099
182700              PERFORM Z999-SQL-ERROR                              18270099
182800     END-EVALUATE.                                                18280099
182900                                                                  18290099
183000******************************************************************18300099
183100*  CLOSE THE RCVR_CURSOR                                          18310099
183200******************************************************************18320099
183300 2983-CLOSE-RCVR-CSR.                                             18330099
183400                                                                  18340099
183500     EXEC SQL                                                     18350099
183600         CLOSE RCVR_CURSOR                                        18360099
183700     END-EXEC.                                                    18370099
183800                                                                  18380099
183900     EVALUATE TRUE                                                18390099
184000         WHEN SQLCODE = -904                                      18400099
184100         WHEN SQLCODE = -911                                      18410099
184200         WHEN SQLCODE = -913                                      18420099
184300              SET PS-ERROR-RECORD TO TRUE                         18430099
184400         WHEN SQLWARN0 NOT EQUAL SPACE                            18440099
184500         WHEN SQLCODE NOT EQUAL ZERO                              18450099
184600              MOVE '2983-CLOSE-RCVR-CURSOR'                       18460099
184700                               TO  PV-ABEND-PARAGRAPH             18470099
184800              MOVE 'CLOSE RCVR_CURSOR'                            18480099
184900                               TO  PV-DB2-OPERATION-ATTEMPTED     18490099
185000              DISPLAY '** PARAGRAPH ** '                          18500099
185100                                   PV-ABEND-PARAGRAPH             18510099
185200              DISPLAY '** OPERATION ** '                          18520099
185300                                   PV-DB2-OPERATION-ATTEMPTED     18530099
185400              PERFORM Z999-SQL-ERROR                              18540099
185500     END-EVALUATE.                                                18550099
185600                                                                  18560099
185700 3000-PRINT-TOTALS.                                               18570099
185800                                                                  18580099
185900     IF  PV-LINE-CNT > PC-60                                      18590099
186000          PERFORM 8000-WRITE-REPORT-HEADERS                       18600099
186100     END-IF.                                                      18610099
186200                                                                  18620099
186300     MOVE PV-TRLR-CRTN-TOT TO TL1-ASN-CARTON-CNT.                 18630099
186400     MOVE PV-DWNLD-CRTN-TOT TO TL1-DOWNLOAD-CNT.                  18640099
186500     MOVE PV-SCAN-CRTN-TOT TO TL1-SCANNED-CNT.                    18650099
186600                                                                  18660099
186700     WRITE SU-CARTON-NOT-RCVD-RECORD                              18670099
186800       FROM TOTAL-LINE1                                           18680099
186900         AFTER ADVANCING 2 LINES.                                 18690099
187000                                                                  18700099
187100 7000-WRITE-ERROR-REPORT.                                         18710099
187200******************************************************************18720099
187300*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *18730099
187400******************************************************************18740099
187500     PERFORM 8200-WRITE-TOP-LINE.                                 18750099
187600                                                                  18760099
187700     WRITE SU-CARTON-NOT-RCVD-RECORD                              18770099
187800       FROM HEADING-LINE-1                                        18780099
187900         AFTER ADVANCING 1 LINE.                                  18790099
188000                                                                  18800099
188100     WRITE SU-CARTON-NOT-RCVD-RECORD                              18810099
188200       FROM HEADING-LINE-1A                                       18820099
188300         AFTER ADVANCING 1 LINE.                                  18830099
188400                                                                  18840099
188500     WRITE SU-CARTON-NOT-RCVD-RECORD                              18850099
188600       FROM HEADING-LINE-1B                                       18860099
188700         AFTER ADVANCING 1 LINE.                                  18870099
188800                                                                  18880099
188900     WRITE SU-CARTON-NOT-RCVD-RECORD                              18890099
189000       FROM HEADING-LINE-2                                        18900099
189100         AFTER ADVANCING 4 LINES.                                 18910099
189200                                                                  18920099
189300     IF SU001-DETAIL-RECORD                                       18930099
189400         WRITE SU-CARTON-NOT-RCVD-RECORD                          18940099
189500           FROM EL1-ERROR-LINE-1P                                 18950099
189600             AFTER ADVANCING 3 LINES                              18960099
189700                                                                  18970099
189800         WRITE SU-CARTON-NOT-RCVD-RECORD                          18980099
189900           FROM EL2-ERROR-LINE-2P                                 18990099
190000             AFTER ADVANCING 2 LINES                              19000099
190100     ELSE                                                         19010099
190200         WRITE SU-CARTON-NOT-RCVD-RECORD                          19020099
190300           FROM EL1-ERROR-LINE-1F                                 19030099
190400             AFTER ADVANCING 3 LINES                              19040099
190500                                                                  19050099
190600         WRITE SU-CARTON-NOT-RCVD-RECORD                          19060099
190700           FROM EL2-ERROR-LINE-2F                                 19070099
190800             AFTER ADVANCING 2 LINES                              19080099
190900     END-IF.                                                      19090099
191000                                                                  19100099
191100     WRITE SU-CARTON-NOT-RCVD-RECORD                              19110099
191200       FROM EL3-ERROR-LINE-3                                      19120099
191300         AFTER ADVANCING 2 LINES.                                 19130099
191400                                                                  19140099
191500     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     19150099
191600     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      19160099
191700     WRITE SU-CARTON-NOT-RCVD-RECORD                              19170099
191800       FROM EL4-ERROR-LINE-4                                      19180099
191900         AFTER ADVANCING 3 LINES.                                 19190099
192000                                                                  19200099
192100     WRITE SU-CARTON-NOT-RCVD-RECORD                              19210099
192200       FROM EL5-ERROR-LINE-5                                      19220099
192300         AFTER ADVANCING 2 LINE.                                  19230099
192400*JPL                                                              19240099
192500     WRITE SU-CARTON-NOT-RCVD-RECORD                              19250099
192600       FROM EL5-ERROR-LINE-5B                                     19260099
192700         AFTER ADVANCING 2 LINE.                                  19270099
192800                                                                  19280099
192900     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              19290099
193000     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              19300099
193100     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              19310099
193200     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              19320099
193300     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              19330099
193400     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              19340099
193500     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              19350099
193600*JPL                                                              19360099
193700     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              19370099
193800                                                                  19380099
193900*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              19390099
194000*JPL   FROM EL6-ERROR-LINE-6                                      19400099
194100*JPL     AFTER ADVANCING 1 LINE.                                  19410099
194200*JPL                                                              19420099
194300     WRITE SU-CARTON-NOT-RCVD-RECORD                              19430099
194400       FROM EL6-ERROR-LINE-6B                                     19440099
194500         AFTER ADVANCING 1 LINE.                                  19450099
194600                                                                  19460099
194700     WRITE SU-CARTON-NOT-RCVD-RECORD                              19470099
194800       FROM END-OF-REPORT-LINE                                    19480099
194900         AFTER ADVANCING 6 LINES.                                 19490099
195000                                                                  19500099
195100                                                                  19510099
195200 8000-WRITE-REPORT-HEADERS.                                       19520099
195300******************************************************************19530099
195400*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *19540099
195500*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *19550099
195600******************************************************************19560099
195700     PERFORM 8200-WRITE-TOP-LINE.                                 19570099
195800                                                                  19580099
195900     WRITE SU-CARTON-NOT-RCVD-RECORD                              19590099
196000       FROM HEADING-LINE-1                                        19600099
196100         AFTER ADVANCING 1 LINE.                                  19610099
196200                                                                  19620099
196300     WRITE SU-CARTON-NOT-RCVD-RECORD                              19630099
196400       FROM HEADING-LINE-1A                                       19640099
196500         AFTER ADVANCING 1 LINE.                                  19650099
196600                                                                  19660099
196700     WRITE SU-CARTON-NOT-RCVD-RECORD                              19670099
196800       FROM HEADING-LINE-1B                                       19680099
196900         AFTER ADVANCING 1 LINE.                                  19690099
197000                                                                  19700099
197100     WRITE SU-CARTON-NOT-RCVD-RECORD                              19710099
197200       FROM HEADING-LINE-2                                        19720099
197300         AFTER ADVANCING 1 LINE.                                  19730099
197400                                                                  19740099
197500     WRITE SU-CARTON-NOT-RCVD-RECORD                              19750099
197600       FROM HEADING-LINE-3                                        19760099
197700         AFTER ADVANCING 2 LINES.                                 19770099
197800                                                                  19780099
197900     WRITE SU-CARTON-NOT-RCVD-RECORD                              19790099
198000       FROM HEADING-LINE-3B                                       19800099
198100         AFTER ADVANCING 2 LINES.                                 19810099
198200                                                                  19820099
198300     WRITE SU-CARTON-NOT-RCVD-RECORD                              19830099
198400       FROM HEADING-LINE-4                                        19840099
198500         AFTER ADVANCING 2 LINES.                                 19850099
198600                                                                  19860099
198700     WRITE SU-CARTON-NOT-RCVD-RECORD                              19870099
198800       FROM HEADING-LINE-5                                        19880099
198900         AFTER ADVANCING 1 LINE.                                  19890099
199000                                                                  19900099
199100     MOVE PC-13           TO PV-LINE-CNT.                         19910099
199200     MOVE PC-2            TO PV-LINE-SUB.                         19920099
199300                                                                  19930099
199400                                                                  19940099
199500 8200-WRITE-TOP-LINE.                                             19950099
199600******************************************************************19960099
199700*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *19970099
199800*     NEEDED FOR AN ASN NUMBER.                                  *19980099
199900******************************************************************19990099
200000     ADD 1                        TO PV-PAGE-CNT.                 20000099
200100                                                                  20010099
200200     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          20020099
200300                                                                  20030099
200400     WRITE SU-CARTON-NOT-RCVD-RECORD                              20040099
200500       FROM DP132O-STANDRD-HEADER-132-COLS                        20050099
200600         AFTER ADVANCING PAGE.                                    20060099
200700                                                                  20070099
200800                                                                  20080099
200900 8400-WRITE-DETAIL-LINES.                                         20090099
201000******************************************************************20100099
201100*     WRITES THE DETAIL LINE INFORMATION.                        *20110099
201200******************************************************************20120099
201300     WRITE SU-CARTON-NOT-RCVD-RECORD                              20130099
201400       FROM DETAIL-LINE1                                          20140099
201500         AFTER ADVANCING PV-LINE-SUB LINES.                       20150099
201600                                                                  20160099
201700     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              20170099
201800                                                                  20180099
201900 8500-WRITE-DETAIL-LINES.                                         20190099
202000******************************************************************20200099
202100*     WRITES THE DETAIL LINE INFORMATION.                        *20210099
202200******************************************************************20220099
202300     WRITE SU-CARTON-NOT-RCVD-RECORD                              20230099
202400       FROM DETAIL-LINE2                                          20240099
202500         AFTER ADVANCING PV-LINE-SUB LINES.                       20250099
202600                                                                  20260099
202700     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              20270099
202800                                                                  20280099
202900******************************************************************20290099
203000*     SQL WARNING OR ERROR PROCESSING                            *20300099
203100*                                                                *20310099
203200******************************************************************20320099
203300                                                                  20330099
203400                                                                  20340099
203500*---------------                                                  20350099
203600 Z999-SQL-ERROR.                                                  20360099
203700*---------------                                                  20370099
203800                                                                  20380099
203900     MOVE SQLCODE    TO SQLCODE2.                                 20390099
204000     MOVE SQLERRD(3) TO SQLERRD3.                                 20400099
204100     DISPLAY '** ABEND **       ** = SQLERROR'.                   20410099
204200     DISPLAY '** PROGRAM        ** = SUKRP002'.                   20420099
204300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  20430099
204400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  20440099
204500     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   20450099
204600     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  20460099
204700     EXEC SQL                                                     20470099
204800         COMMIT                                                   20480099
204900     END-EXEC.                                                    20490099
205000     MOVE +4013 TO PV-ABEND-CODE.                                 20500099
205100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         20510099
