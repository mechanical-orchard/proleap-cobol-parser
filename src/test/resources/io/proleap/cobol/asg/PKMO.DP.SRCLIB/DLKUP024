000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    DLKUP024.                                         00020000
000300 AUTHOR.        JEAN KURKOWSKI.                                   00030000
000400                                                                  00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  JULY 2007.                                        00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 CONFIGURATION SECTION.                                           00100000
001100 SOURCE-COMPUTER. IBM-3090.                                       00110000
001200 OBJECT-COMPUTER. IBM-3090.                                       00120000
001300                                                                  00130000
001400****************************************************************  00140000
001500*                                                              *  00150000
001600*     THIS IS A COPY OF DLKUP001 FOR BATCH USE. ANY CHANGES    *  00160000
001700*     NEED TO BE MADE IN BOTH PLACES.                          *  00170000
001800*                                                              *  00180000
001900*     CALLED MODULE THAT IS USED TO SECURE THE NEXT SEQUENCE   *  00190000
002000*     NUMBER FOR THE PURPOSE OF NUMBERING DETAIL BUSINESS      *  00200000
002100*     EVENTS WITHIN A LABOR ASSIGNMENT.                        *  00210000
002200*                                                              *  00220000
002300*     THIS MODULE ALSO CALLS DLKUT002 WITH COPYBOOK DLWS004.   *  00230000
002400*                                                              *  00240000
002500*  DB2 ACCESS:                                                 *  00250000
002600*     DLT_ASGMT (DLT00004) TABLE                               *  00260000
002700*                SELECTS                                       *  00270000
002800*                UPDATES                                       *  00280000
002900*                                                              *  00290000
003000*     USED ONLY IN BATCH PROGRAMS.                             *  00300000
003100*                                                              *  00310000
003200*  COPYBOOK: DLWS020                                           *  00320000
003300*                                                              *  00330000
003400*                                                              *  00340000
003500****************************************************************  00350000
003600                                                                  00360000
003700 DATA DIVISION.                                                   00370000
003800 WORKING-STORAGE SECTION.                                         00380000
003900                                                                  00390000
004000 01  PV-CHARACTER-FIELDS.                                         00400000
004100     05  PV-KEY-START-DATE        PIC X(10)  VALUE SPACES.        00410000
004200     05  PV-KEY-NBR-TXT           PIC X(10)  VALUE SPACES.        00420000
004300                                                                  00430000
004400 01  PV-COMP-FIELDS.                                              00440000
004500     05  PV-WORK-SEQ-NBR          PIC S9(04) VALUE 0 COMP.        00450000
004600     05  PV-RETRY-COUNTER         PIC S9(04) VALUE 0 COMP.        00460000
004700     05  PV-KEY-NBR-SEQ-NBR       PIC S9(09) VALUE 0 COMP.        00470000
004800                                                                  00480000
004900 01  PS-SWITCHES.                                                 00490000
005000     05  PS-UPDATE-COMPLETE-SW        PIC X(01)  VALUE ' '.       00500000
005100         88  PS-UPDATE-COMPLETE                  VALUE 'C'.       00510000
005200         88  PS-UPDATE-ERROR                     VALUE 'E'.       00520000
005300                                                                  00530000
005400 01  PC-CONSTANTS.                                                00540000
005500     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       00550000
005600     05  PC-N                        PIC X      VALUE 'N'.        00560000
005700     05  PC-ASTERISK-LINE            PIC X(40)  VALUE ALL '*'.    00570000
005800     05  PC-FIVE-BLANKS              PIC X(05)  VALUE '     '.    00580000
005900     05  PC-TEN-BLANKS               PIC X(10)  VALUE SPACES.     00590000
006000                                                                  00600000
006100****************************************************************  00610000
006200*    DLT00003 - DLT_TEM_ASGMT                                  *  00620000
006300*    DLT00004 - DLT_ASGMT                                      *  00630000
006400*                                                              *  00640000
006500****************************************************************  00650000
006600                                                                  00660000
006700     EXEC SQL                                                     00670000
006800         INCLUDE DLT00004                                         00680000
006900     END-EXEC.                                                    00690000
007000                                                                  00700000
007100     EXEC SQL                                                     00710000
007200         INCLUDE DLT00003                                         00720000
007300     END-EXEC.                                                    00730000
007400                                                                  00740000
007500     EXEC SQL                                                     00750000
007600          INCLUDE SQLCA                                           00760000
007700     END-EXEC.                                                    00770000
007800                                                                  00780000
007900****************************************************************  00790000
008000*    COPYBOOK USED TO CALL DLKUT002                            *  00800000
008100****************************************************************  00810000
008200                                                                  00820000
008300     COPY DLWS004.                                                00830000
008400                                                                  00840000
008500                                                                  00850000
008600 LINKAGE SECTION.                                                 00860000
008700     COPY DLWS020.                                                00870000
008800                                                                  00880000
008900                                                                  00890000
009000 PROCEDURE DIVISION USING DL020-ASGMT-COMMAREA.                   00900000
009100                                                                  00910000
009200     SET DL020-SUCCESSFUL  TO TRUE.                               00920000
009300                                                                  00930000
009400     EVALUATE TRUE                                                00940000
009500         WHEN DL020-BY-ASGMT-KEY                                  00950000
009600              PERFORM 1000-FIND-SEQUENCE-NBR                      00960000
009700                                                                  00970000
009800         WHEN OTHER                                               00980000
009900              SET DL020-INVALID-ACCESS TO TRUE                    00990000
010000                                                                  01000000
010100     END-EVALUATE.                                                01010000
010200                                                                  01020000
010300     GOBACK.                                                      01030000
010400                                                                  01040000
010500                                                                  01050000
010600****************************************************************  01060000
010700*    VALIDATE THAT ALL INPUT FIELDS ARE PRESENT.               *  01070000
010800*        STOP PROCESSING AND RETURN IF THERE ARE ANY ERRORS.   *  01080000
010900*                                                              *  01090000
011000****************************************************************  01100000
011100                                                                  01110000
011200 1000-FIND-SEQUENCE-NBR.                                          01120000
011300                                                                  01130000
011400     EVALUATE TRUE                                                01140000
011500         WHEN DL020-KEY-START-DTE = SPACES                        01150000
011600              SET DL020-KEY-FIELDS-MISSING TO TRUE                01160000
011700                                                                  01170000
011800         WHEN DL020-KEY-NBR-TXT = SPACES                          01180000
011900              SET DL020-KEY-FIELDS-MISSING TO TRUE                01190000
012000                                                                  01200000
012100         WHEN DL020-KEY-NBR-SEQ-NBR = 0                           01210000
012200              SET DL020-KEY-FIELDS-MISSING TO TRUE                01220000
012300                                                                  01230000
012400         WHEN DL020-NBRS-NEED-QTY-EMPTY                           01240000
012500              SET DL020-NBR-NEED-QTY-0 TO TRUE                    01250000
012600                                                                  01260000
012700         WHEN OTHER                                               01270000
012800              IF DL020-COMMIT-UPDATE OR                           01280000
012900                 DL020-DO-NOT-COMMIT-UPDATE                       01290000
013000                 CONTINUE                                         01300000
013100              ELSE                                                01310000
013200                 SET DL020-COMMIT-CODE-INVALID TO TRUE            01320000
013300              END-IF                                              01330000
013400                                                                  01340000
013500              IF DL020-FIND-NEXT-ASGMT OR                         01350000
013600                 DL020-DO-NOT-FIND-NEXT-ASGMT                     01360000
013700                 CONTINUE                                         01370000
013800              ELSE                                                01380000
013900                 SET DL020-FIND-ASGMT-INVALID TO TRUE             01390000
014000              END-IF                                              01400000
014100                                                                  01410000
014200              IF DL020-SUCCESSFUL                                 01420000
014300                 PERFORM 2000-PROCESS-ASSIGNMENTS                 01430000
014400              END-IF                                              01440000
014500                                                                  01450000
014600     END-EVALUATE.                                                01460000
014700                                                                  01470000
014800                                                                  01480000
014900****************************************************************  01490000
015000*    SELECT THE ASSIGNMENT FROM THE DLT-ASGMT (DLT00004)       *  01500000
015100*       TABLE.  CHECK THE ASGMT-STP-RSN-CDE.                   *  01510000
015200*       IF IT IS AN "N", COMPUTE THE NEXT SEQUENCE NUMBERS TO  *  01520000
015300*       TO BE USED BY ADDING THE NUMBER NEEDED TO THE          *  01530000
015400*       LAST-USD-SEQ-NBR.  THEN UPDATE THE ROW WITH NEW VALUE. *  01540000
015500*                                                              *  01550000
015600****************************************************************  01560000
015700                                                                  01570000
015800 2000-PROCESS-ASSIGNMENTS.                                        01580000
015900                                                                  01590000
016000     MOVE DL020-KEY-START-DTE   TO PV-KEY-START-DATE.             01600000
016100     MOVE DL020-KEY-NBR-TXT     TO PV-KEY-NBR-TXT.                01610000
016200     MOVE DL020-KEY-NBR-SEQ-NBR TO PV-KEY-NBR-SEQ-NBR.            01620000
016300                                                                  01630000
016400     PERFORM 3000-SELECT-ASSIGNMENT.                              01640000
016500                                                                  01650000
016600     EVALUATE TRUE                                                01660000
016700        WHEN DL020-SQL-ERROR                                      01670000
016800             MOVE SQLCA TO DL020-SQLCA                            01680000
016900                                                                  01690000
017000        WHEN DLT00004-ASGMT-STP-RSN-CDE = 'N'                     01700000
017100             COMPUTE PV-WORK-SEQ-NBR =                            01710000
017200                             DLT00004-LAST-USD-SEQ-NBR +          01720000
017300                             DL020-NBR-OF-NBRS-NEED-QTY           01730000
017400             PERFORM 5000-UPDATE-ASSIGNMENT                       01740000
017500                                                                  01750000
017600             EVALUATE TRUE                                        01760000
017700                 WHEN PS-UPDATE-COMPLETE                          01770000
017800                      SET DL020-SUCCESSFUL TO TRUE                01780000
017900                      SET DL020-ASGMT-FOUND TO TRUE               01790000
018000                                                                  01800000
018100                      COMPUTE DL020-SEQ-START-NBR =               01810000
018200                                  DLT00004-LAST-USD-SEQ-NBR + 1   01820000
018300                      MOVE PV-WORK-SEQ-NBR TO DL020-SEQ-END-NBR   01830000
018400                                                                  01840000
018500                 WHEN PS-UPDATE-ERROR                             01850000
018600                      PERFORM 3000-SELECT-ASSIGNMENT              01860000
018700                      PERFORM 5000-UPDATE-ASSIGNMENT              01870000
018800                                                                  01880000
018900                 WHEN DL020-SQL-CONTENTION                        01890000
019000                      CONTINUE                                    01900000
019100                                                                  01910000
019200                 WHEN OTHER                                       01920000
019300                      SET DL020-SQL-ERROR TO TRUE                 01930000
019400                                                                  01940000
019500             END-EVALUATE                                         01950000
019600                                                                  01960000
019700*        *******************************************************  01970000
019800*          FORMAT DATA TO SEND BACK AND DO COMMIT IF REQUIRED. *  01980000
019900*        *******************************************************  01990000
020000                                                                  02000000
020100             IF PS-UPDATE-COMPLETE                                02010000
020200                COMPUTE DL020-SEQ-START-NBR =                     02020000
020300                                  DLT00004-LAST-USD-SEQ-NBR + 1   02030000
020400                MOVE PV-WORK-SEQ-NBR TO DL020-SEQ-END-NBR         02040000
020500                                                                  02050000
020600                IF DL020-COMMIT-UPDATE                            02060000
020700                   PERFORM 8000-COMMIT                            02070000
020800                END-IF                                            02080000
020900             END-IF                                               02090000
021000                                                                  02100000
021100*        *******************************************************  02110000
021200*          "T" INDICATES THE SYSTEM CLOSED THE ASSIGNMENT      *  02120000
021300*              BECAUSE IT HAD BEEN OPENED FOR X NUMBER OF      *  02130000
021400*              MINUTES.                                        *  02140000
021500*        *******************************************************  02150000
021600        WHEN DLT00004-ASGMT-STP-RSN-CDE = 'T' AND                 02160000
021700             DL020-FIND-NEXT-ASGMT                                02170000
021800             PERFORM 4000-CALL-DLKUT002                           02180000
021900                                                                  02190000
022000        WHEN OTHER                                                02200000
022100             SET DL020-ASGMT-CLOSED TO TRUE                       02210000
022200             SET DL020-ASGMT-CLOSED-RETURN TO TRUE                02220000
022300                                                                  02230000
022400     END-EVALUATE.                                                02240000
022500                                                                  02250000
022600                                                                  02260000
022700 3000-SELECT-ASSIGNMENT.                                          02270000
022800                                                                  02280000
022900     PERFORM                                                      02290000
023000         WITH TEST AFTER                                          02300000
023100         VARYING PV-RETRY-COUNTER                                 02310000
023200         FROM 1 BY 1                                              02320000
023300         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  02330000
023400            OR SQLCODE = ZERO                                     02340000
023500                                                                  02350000
023600         EXEC SQL                                                 02360000
023700             SELECT                                               02370000
023800                    LAST_USD_SEQ_NBR                              02380000
023900                   ,ASGMT_STP_RSN_CDE                             02390000
024000                   ,WK_TYP_DESC                                   02400000
024100                   ,WK_AREA_DESC                                  02410000
024200                   ,DC_NBR                                        02420000
024300              INTO                                                02430000
024400                    :DLT00004-LAST-USD-SEQ-NBR                    02440000
024500                   ,:DLT00004-ASGMT-STP-RSN-CDE                   02450000
024600                   ,:DLT00004-WK-TYP-DESC                         02460000
024700                   ,:DLT00004-WK-AREA-DESC                        02470000
024800                   ,:DLT00004-DC-NBR                              02480000
024900              FROM  DLT_ASGMT                                     02490000
025000             WHERE  ASGMT_STRT_DTE    = :PV-KEY-START-DATE        02500000
025100               AND  ASGMT_NBR_SEQ_NBR = :PV-KEY-NBR-SEQ-NBR       02510000
025200               AND  ASGMT_NBR_TXT     = :PV-KEY-NBR-TXT           02520000
025300         END-EXEC                                                 02530000
025400                                                                  02540000
025500         EVALUATE TRUE                                            02550000
025600             WHEN SQLCODE = ZERO                                  02560000
025700             WHEN SQLCODE = -904                                  02570000
025800             WHEN SQLCODE = -913                                  02580000
025900             WHEN SQLCODE = -911                                  02590000
026000                  CONTINUE                                        02600000
026100                                                                  02610000
026200             WHEN SQLWARN0 NOT = SPACES                           02620000
026300             WHEN SQLCODE NOT = ZERO                              02630000
026400                  MOVE +4             TO PV-RETRY-COUNTER         02640000
026500         END-EVALUATE                                             02650000
026600     END-PERFORM.                                                 02660000
026700                                                                  02670000
026800     IF SQLCODE NOT = ZERO AND                                    02680000
026900        PV-RETRY-COUNTER > PC-MAX-RETRIES                         02690000
027000                                                                  02700000
027100        MOVE '3000-' TO DL020-SQL-ERROR-PARA                      02710000
027200                                                                  02720000
027300        SET DL020-SQL-ERROR TO TRUE                               02730000
027400        MOVE SQLCODE        TO DL020-ASGMT-SQLCODE                02740000
027500        MOVE SQLCA          TO DL020-SQLCA                        02750000
027600     END-IF.                                                      02760000
027700                                                                  02770000
027800 4000-CALL-DLKUT002.                                              02780000
027900                                                                  02790000
028000     INITIALIZE DL004-ASGMT-COMMAREA.                             02800000
028100     SET DL004-BY-WK-TYP-AREA-KEY TO TRUE.                        02810000
028200                                                                  02820000
028300     MOVE DLT00004-WK-TYP-DESC  TO DL004-KEY-WK-TYP.              02830000
028400     MOVE DLT00004-WK-AREA-DESC TO DL004-KEY-WK-AREA.             02840000
028500     MOVE DLT00004-DC-NBR       TO DL004-KEY-DC-NBR.              02850000
028600                                                                  02860000
028700     CALL DL004-USER-PGM USING DL004-ASGMT-COMMAREA.              02870000
028800                                                                  02880000
028900     EVALUATE TRUE                                                02890000
029000         WHEN DL004-SUCCESSFUL                                    02900000
029100          AND DL004-ASGMT-FOUND                                   02910000
029200              MOVE DL004-ASGMT-START-DTE   TO PV-KEY-START-DATE   02920000
029300              MOVE DL004-ASGMT-NBR-TXT     TO PV-KEY-NBR-TXT      02930000
029400              MOVE DL004-ASGMT-NBR-SEQ-NBR TO PV-KEY-NBR-SEQ-NBR  02940000
029500                                                                  02950000
029600              PERFORM 3000-SELECT-ASSIGNMENT                      02960000
029700                                                                  02970000
029800              EVALUATE TRUE                                       02980000
029900                 WHEN DL020-SQL-ERROR                             02990000
030000*  2/23/2004          SET DL020-SQL-ERROR TO TRUE                 03000000
030100*  2/23/2004          MOVE DL004-SQLCA TO DL020-SQLCA             03010000
030200                     CONTINUE                                     03020000
030300                                                                  03030000
030400                 WHEN DLT00004-ASGMT-STP-RSN-CDE = 'N'            03040000
030500                      COMPUTE PV-WORK-SEQ-NBR =                   03050000
030600                                      DLT00004-LAST-USD-SEQ-NBR + 03060000
030700                                      DL020-NBR-OF-NBRS-NEED-QTY  03070000
030800                      PERFORM 5000-UPDATE-ASSIGNMENT              03080000
030900                                                                  03090000
031000                      EVALUATE TRUE                               03100000
031100                          WHEN PS-UPDATE-COMPLETE                 03110000
031200                               PERFORM 4100-MOVE-DLWS004-FIELDS   03120000
031300                                                                  03130000
031400                          WHEN PS-UPDATE-ERROR                    03140000
031500                               PERFORM 5000-UPDATE-ASSIGNMENT     03150000
031600                                                                  03160000
031700                          WHEN DL020-SQL-CONTENTION               03170000
031800                               CONTINUE                           03180000
031900                                                                  03190000
032000                          WHEN OTHER                              03200000
032100                               CONTINUE                           03210000
032200                                                                  03220000
032300                      END-EVALUATE                                03230000
032400                                                                  03240000
032500*        *******************************************************  03250000
032600*          FORMAT DATA TO SEND BACK AND DO COMMIT IF REQUIRED. *  03260000
032700*        *******************************************************  03270000
032800                                                                  03280000
032900                      IF DL020-ASGMT-SQLCODE = 0                  03290000
033000                         COMPUTE DL020-SEQ-START-NBR =            03300000
033100                                  DLT00004-LAST-USD-SEQ-NBR + 1   03310000
033200                         MOVE PV-WORK-SEQ-NBR TO                  03320000
033300                                       DL020-SEQ-END-NBR          03330000
033400                                                                  03340000
033500                         IF DL020-COMMIT-UPDATE                   03350000
033600                            PERFORM 8000-COMMIT                   03360000
033700                         END-IF                                   03370000
033800                      END-IF                                      03380000
033900                                                                  03390000
034000                 WHEN OTHER                                       03400000
034100                      SET DL020-ASGMT-CLOSED TO TRUE              03410000
034200                                                                  03420000
034300              END-EVALUATE                                        03430000
034400                                                                  03440000
034500         WHEN DL004-SUCCESSFUL                                    03450000
034600          AND DL004-ASGMT-NOT-FOUND                               03460000
034700              SET DL020-ASGMT-CLOSED-RETURN TO TRUE               03470000
034800                                                                  03480000
034900         WHEN OTHER                                               03490000
035000              SET DL020-CALLED-MODULE-FAILURE TO TRUE             03500000
035100              MOVE DL004-CALL-MOD-FAIL-NM  TO                     03510000
035200                                     DL020-CALL-MOD-FAIL-NM       03520000
035300              MOVE DL004-CALL-MOD-FAIL-ERR-CDE TO                 03530000
035400                                     DL020-CALL-MOD-FAIL-ERR-CDE  03540000
035500                                                                  03550000
035600     END-EVALUATE.                                                03560000
035700                                                                  03570000
035800                                                                  03580000
035900 4100-MOVE-DLWS004-FIELDS.                                        03590000
036000                                                                  03600000
036100     MOVE DL004-ASGMT-START-DTE   TO DL020-NXT-START-DTE.         03610000
036200     MOVE DL004-ASGMT-NBR-TXT     TO DL020-NXT-NBR-TXT.           03620000
036300     MOVE DL004-ASGMT-NBR-SEQ-NBR TO DL020-NXT-NBR-SEQ-NBR.       03630000
036400     SET DL020-ASGMT-NEXT-USED TO TRUE.                           03640000
036500                                                                  03650000
036600                                                                  03660000
036700                                                                  03670000
036800 5000-UPDATE-ASSIGNMENT.                                          03680000
036900                                                                  03690000
037000     PERFORM                                                      03700000
037100         WITH TEST AFTER                                          03710000
037200         VARYING PV-RETRY-COUNTER                                 03720000
037300         FROM 1 BY 1                                              03730000
037400         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  03740000
037500            OR SQLCODE = ZERO                                     03750000
037600            OR SQLCODE = +100                                     03760000
037700                                                                  03770000
037800         EXEC SQL                                                 03780000
037900             UPDATE DLT_ASGMT                                     03790000
038000                SET LAST_USD_SEQ_NBR  =  :PV-WORK-SEQ-NBR         03800000
038100                                                                  03810000
038200             WHERE  ASGMT_STRT_DTE    = :PV-KEY-START-DATE        03820000
038300               AND  ASGMT_NBR_SEQ_NBR = :PV-KEY-NBR-SEQ-NBR       03830000
038400               AND  ASGMT_NBR_TXT     = :PV-KEY-NBR-TXT           03840000
038500               AND  LAST_USD_SEQ_NBR  =                           03850000
038600                                :DLT00004-LAST-USD-SEQ-NBR        03860000
038700               AND  ASGMT_STP_RSN_CDE = :PC-N                     03870000
038800         END-EXEC                                                 03880000
038900                                                                  03890000
039000         EVALUATE TRUE                                            03900000
039100             WHEN SQLCODE = ZERO                                  03910000
039200                  SET PS-UPDATE-COMPLETE TO TRUE                  03920000
039300             WHEN SQLCODE = +100                                  03930000
039400                  SET PS-UPDATE-COMPLETE TO TRUE                  03940000
039500                                                                  03950000
039600             WHEN SQLCODE = -904                                  03960000
039700             WHEN SQLCODE = -913                                  03970000
039800             WHEN SQLCODE = -911                                  03980000
039900                  CONTINUE                                        03990000
040000             WHEN SQLWARN0 NOT = SPACES                           04000000
040100             WHEN SQLCODE NOT = ZERO                              04010000
040200                  MOVE +4             TO PV-RETRY-COUNTER         04020000
040300         END-EVALUATE                                             04030000
040400     END-PERFORM.                                                 04040000
040500                                                                  04050000
040600     IF SQLCODE = 0 OR                                            04060000
040700        SQLCODE = +100                                            04070000
040800        CONTINUE                                                  04080000
040900     ELSE                                                         04090000
041000        IF PV-RETRY-COUNTER > PC-MAX-RETRIES                      04100000
041100           MOVE '5000-' TO DL020-SQL-ERROR-PARA                   04110000
041200                                                                  04120000
041300           SET DL020-SQL-ERROR TO TRUE                            04130000
041400           MOVE SQLCODE        TO DL020-ASGMT-SQLCODE             04140000
041500           MOVE SQLCA          TO DL020-SQLCA                     04150000
041600        END-IF                                                    04160000
041700     END-IF.                                                      04170000
041800                                                                  04180000
041900******************************************************************04190000
042000*                                                                *04200000
042100******************************************************************04210000
042200 8000-COMMIT.                                                     04220000
042300                                                                  04230000
042400     EXEC SQL                                                     04240000
042500          COMMIT                                                  04250000
042600     END-EXEC.                                                    04260000
042700                                                                  04270000
042800     EVALUATE TRUE                                                04280000
042900         WHEN SQLCODE = ZERO                                      04290000
043000         WHEN SQLCODE = +100                                      04300000
043100             CONTINUE                                             04310000
043200         WHEN OTHER                                               04320000
043300              DISPLAY 'DLKUP024 - ERROR ON COMMIT'                04330000
043400     END-EVALUATE.                                                04340000
043500                                                                  04350000
043600                                                                  04360000
043700                                                                  04370000
