000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.    PCKUT075.                                         00020011
000300 AUTHOR.        JEAN KURKOWSKI.                                   00030011
000400                                                                  00040011
000500******************************************************************00050011
000600* TO BE USED TO TAKE PACK-TO-LIGHT BUSINESS EVENT FOR AN          00060011
000700* OUTBOUND CLOSE AND WRITE THE INFORMATION TO THE EAI             00070011
000800* BUSINESS EVENT EXPORT TABLES                                    00080011
000900*                                                                 00090007
001000* THIS PROGRAM WAS CONVERTED FROM PCKCS765 AND CHGD TO BATCH      00100007
001100*                                                                 00110007
001200******************************************************************00120001
001300                                                                  00130001
001400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00140001
001500 DATE-WRITTEN.  JULY 2007.                                        00150001
001600 DATE-COMPILED.                                                   00160001
001700                                                                  00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900 CONFIGURATION SECTION.                                           00190001
002000 SOURCE-COMPUTER. IBM-3090.                                       00200001
002100 OBJECT-COMPUTER. IBM-3090.                                       00210001
002200                                                                  00220001
002300 DATA DIVISION.                                                   00230001
002400 WORKING-STORAGE SECTION.                                         00240001
002500                                                                  00250001
002600 01  PS-SWITCHES.                                                 00260001
002700     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00270001
002800         88  PS-ERROR-YES                       VALUE 'Y'.        00280001
002900         88  PS-ERROR-NO                        VALUE 'N'.        00290001
003000     05  PS-P4-INTERFACE-SW           PIC X(01) VALUE 'N'.        00300001
003100         88  PS-P4-INTERFACE-YES                VALUE 'Y'.        00310001
003200         88  PS-P4-INTERFACE-NO                 VALUE 'N'.        00320001
003210     05  PS-USER-FOUND-SW             PIC X(01) VALUE 'N'.        00321028
003220         88  PS-USER-FOUND-YES                  VALUE 'Y'.        00322028
003230         88  PS-USER-FOUND-NO                   VALUE 'N'.        00323028
003300                                                                  00330001
003400 01  DK-DB2-KEYS.                                                 00340017
003500     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00350001
003600     05  DK-MODU-NBR                  PIC S9(04) COMP.            00360001
003700                                                                  00370001
003800 01  PV-PROGRAM-VARIABLES.                                        00380017
003900     05  PV-DISP-SQLCODE              PIC -999    VALUE ZEROES.   00390017
003901     05  PV-DISP-SQLCODE-2            PIC -999    VALUE ZEROES.   00390118
003902     05  PV-DISP-SQLCODE-3            PIC -999    VALUE ZEROES.   00390225
003903     05  PV-DISP-OPER                 PIC 9(04)   VALUE ZEROES.   00390325
003910     05  PV-USER-ID                   PIC X(08)   VALUE SPACES.   00391017
004000     05  PV-PICK-MADE-TM.                                         00400001
004100         10  PV-PICK-BYTE OCCURS 25   PIC X(01).                  00410001
004200     05  PV-PLACE-PTR                 PIC S9(03) COMP-3.          00420001
004300     05  PV-SUB                       PIC S9(03) COMP-3.          00430001
004400     05  PV-HOLD-TWO                  PIC X(02).                  00440001
004500     05  PV-HOLD-FOUR                 PIC X(04).                  00450001
004600     05  PV-HOLD-PTR                  PIC S9(03) COMP-3.          00460001
004700     05  PV-START-TIMESTAMP.                                      00470001
004800         10 PV-START-DATE.                                        00480001
004900             15 PV-START-CCYY         PIC X(04).                  00490001
005000             15 FILLER                PIC X(01) VALUE '-'.        00500001
005100             15 PV-START-MM           PIC X(02).                  00510001
005200             15 FILLER                PIC X(01) VALUE '-'.        00520001
005300             15 PV-START-DD           PIC X(02).                  00530001
005400         10 PV-START-TIME.                                        00540001
005500             15 FILLER                PIC X(01) VALUE '-'.        00550001
005600             15 PV-START-HOUR.                                    00560001
005700                 20 PV-START-HOUR-N   PIC 9(02).                  00570001
005800             15 FILLER                PIC X(01) VALUE '.'.        00580001
005900             15 PV-START-MIN          PIC X(02).                  00590001
006000             15 FILLER                PIC X(01) VALUE '.'.        00600001
006100             15 PV-START-SEC          PIC X(02).                  00610001
006200             15 FILLER                PIC X(01) VALUE '.'.        00620001
006300             15 FILLER                PIC X(06) VALUE ZERO.       00630001
006400                                                                  00640001
006500     05  PV-HOLD-LOCATION             PIC X(10).                  00650001
006600     05  PV-LENGTH                    PIC S9(03) COMP-3.          00660001
006700     05  PV-DUMMY                     PIC S9(03) COMP-3           00670001
006800                                          VALUE ZERO.             00680001
006900                                                                  00690001
007000     05  PV-LABOR-ASGMT-STRT-DTE      PIC X(10) VALUE SPACES.     00700001
007100     05  PV-LABOR-ASGMT-NBR-TXT       PIC X(10) VALUE SPACES.     00710001
007200     05  PV-LABOR-ASGMT-NBR-SEQ-NBR   PIC S9(09) COMP VALUE ZERO. 00720001
007300     05  PV-LABOR-SEQ-START-NBR       PIC S9(09) COMP VALUE ZERO. 00730001
007400                                                                  00740001
007500     05  PV-CURRENT-TIME.                                         00750001
007600         10  PV-CURRENT-HOUR          PIC 99.                     00760001
007700         10  PV-CURRENT-MINUTE        PIC 99.                     00770001
007800         10  PV-CURRENT-SECOND        PIC 99.                     00780001
007900         10  PV-CURRENT-HUNDRETH      PIC 99.                     00790001
008000                                                                  00800001
008100     05  PV-FORMAT-TIME.                                          00810001
008200         10  PV-FORMAT-HH             PIC 99.                     00820001
008300         10  FILLER                   PIC X(01) VALUE ':'.        00830001
008400         10  PV-FORMAT-MM             PIC 99.                     00840001
008500         10  FILLER                   PIC X(01) VALUE ':'.        00850001
008600         10  PV-FORMAT-SS             PIC 99.                     00860001
008700         10  FILLER                   PIC X(01) VALUE ':'.        00870001
008800         10  PV-FORMAT-HUND           PIC 99.                     00880001
008900     05  PV-LOG-MSG                   PIC X(110) VALUE SPACES.    00890015
009000                                                                  00900001
009100 01  PV-ERROR-MSG.                                                00910001
009200     05  FILLER                       PIC X(12)                   00920001
009300         VALUE ' PCKUT075 '.                                      00930004
009400     05  PV-ERROR-TIME                PIC X(11).                  00940001
009500     05  FILLER                       PIC X(06)                   00950001
009600                                           VALUE ' PARA-'.        00960001
009700     05  PV-ERROR-PARA                PIC X(05) VALUE SPACES.     00970001
009800     05  FILLER                       PIC X(02) VALUE SPACES.     00980001
009900     05  PV-ERROR-TEXT                PIC X(44) VALUE SPACES.     00990001
010000                                                                  01000001
010100 01  PV-KEY-MSGS.                                                 01010001
010200     05  PV-OPER-TEXT.                                            01020001
010300         10  FILLER                   PIC X(06)                   01030001
010400             VALUE ' LOC= '.                                      01040001
010500         10  PV-MSG-OPER              PIC 9(04).                  01050001
010600                                                                  01060001
010700     05  PV-MODU-TEXT.                                            01070001
010800         10  FILLER                   PIC X(05)                   01080001
010900             VALUE ' DC= '.                                       01090001
011000         10  PV-MSG-MODU-DC           PIC 9(04).                  01100001
011100         10  FILLER                   PIC X(07)                   01110001
011200             VALUE ' MODU= '.                                     01120001
011300         10  PV-MSG-MODU              PIC 9(02).                  01130001
011400                                                                  01140001
011500     05  PV-DLKUT410-TEXT1.                                       01150009
011600         10  FILLER                   PIC X(07)                   01160001
011700             VALUE ' USER= '.                                     01170001
011800         10  PV-DLKUT410-USER         PIC X(08).                  01180009
011900                                                                  01190001
012000         10  FILLER                   PIC X(08)                   01200001
012100             VALUE ' WKTYP= '.                                    01210001
012200         10  PV-DLKUT410-WK-TYP       PIC X(15).                  01220009
012300                                                                  01230001
012400         10  FILLER                   PIC X(13)                   01240001
012500             VALUE ' WKTYP DESC= '.                               01250001
012600         10  PV-DLKUT410-WK-TYP-DESC  PIC X(15).                  01260009
012700                                                                  01270001
012800     05  PV-DLKUT410-TEXT2.                                       01280009
012900                                                                  01290001
013000         10  FILLER                   PIC X(09)                   01300001
013100             VALUE ' WKAREA= '.                                   01310001
013200         10  PV-DLKUT410-WK-AREA-DESC PIC X(20).                  01320009
013300                                                                  01330001
013400         10  FILLER                   PIC X(08)                   01340001
013500             VALUE ' DC=  '.                                      01350001
013600         10  PV-DLKUT410-DC-NBR       PIC 9(04).                  01360009
013700                                                                  01370001
013800         10  FILLER                   PIC X(10)                   01380001
013900             VALUE ' CRE USER='.                                  01390001
014000         10  PV-DLKUT410-CRE-USERID   PIC X(08).                  01400009
014100                                                                  01410001
014200         10  FILLER                   PIC X(10)                   01420001
014300             VALUE ' USER TYP='.                                  01430001
014400         10  PV-DLKUT410-USER-TYP     PIC X(01).                  01440009
014500                                                                  01450001
014600                                                                  01460001
014700     05  PV-XLKUP046-TEXT1.                                       01470014
014800         10  FILLER                   PIC X(07)                   01480001
014900             VALUE ' USER= '.                                     01490001
015000         10  PV-XLKUP046-USER         PIC X(08).                  01500014
015100                                                                  01510001
015200         10  FILLER                   PIC X(10)                   01520001
015300             VALUE ' OBJ TXT= '.                                  01530001
015400         10  PV-XLKUP046-OBJTXT       PIC X(40).                  01540014
015500                                                                  01550001
015600     05  PV-XLKUP046-TEXT2.                                       01560014
015700         10  FILLER                   PIC X(15)                   01570001
015800             VALUE ' OBJ ACTN TXT= '.                             01580001
015900         10  PV-XLKUP046-OBJACTNTXT   PIC X(40).                  01590014
016000                                                                  01600001
016100     05  PV-XLKUT067-TEXT.                                        01610001
016200         10  FILLER                   PIC X(09)                   01620001
016300             VALUE ' PICKER= '.                                   01630001
016400         10  PV-XLKUT067-USERID       PIC X(10).                  01640001
016500         10  FILLER                   PIC X(16)                   01650001
016600             VALUE ' RETURN FIELDS= '.                            01660001
016700         10  PV-XLKUT067-RETURN-FIELDS                            01670001
016800                                      PIC X(57).                  01680001
016900                                                                  01690001
017000     05  PV-DLKUP024-TEXT.                                        01700014
017100         10  FILLER                   PIC X(12)                   01710001
017200             VALUE ' START DTE= '.                                01720001
017300         10  PV-DLKUP024-DATE         PIC X(10).                  01730014
017400         10  FILLER                   PIC X(12)                   01740001
017500             VALUE ' ASGMT TXT= '.                                01750001
017600         10  PV-DLKUP024-TXT          PIC X(10).                  01760014
017700         10  FILLER                   PIC X(12)                   01770001
017800             VALUE ' ASGMT SEQ= '.                                01780001
017900         10  PV-DLKUP024-SEQ          PIC 9(09).                  01790014
018000                                                                  01800001
018100*    FOR FORMATTING SLQCA INTO SOMETHING READABLE                 01810001
018200     COPY DPWS004.                                                01820001
018300/                                                                 01830001
018400*    DLKUP024 COMMAREA                                            01840014
018510     COPY DLWS020.                                                01851013
018520***  COPY DLWS001.   (COMMAREA FOR CICS VERSION - DLKUP001)       01852013
018600/                                                                 01860001
018700*    DLKUT410 COMMAREA                                            01870009
018800     COPY DLWS019.                                                01880009
018900/                                                                 01890001
019000*    XLKUT067                                                     01900001
019100     COPY XLWS067.                                                01910001
019200/                                                                 01920001
019300*    XLKUP046 COMMAREA                                            01930014
019410     COPY XLWS091.                                                01941012
019420***  COPY XLWS072.  (COMMAREA FOR CICS VERSION - XLKUP033)        01942012
019500/                                                                 01950001
019600*    FORMAT FOR PCT_BUS_EVNT_DTL                                  01960001
019700     COPY PCWS242.                                                01970001
019800                                                                  01980001
019900*    FORMATTING TEMPLATE                                          01990001
020000     COPY DLWS011.                                                02000001
020100                                                                  02010001
020200*    ABEND FIELDS                                                 02020001
020300*    COPY DPWS013.                                                02030001
020400/                                                                 02040001
020500*    CORP PARM TABLE                                              02050001
020600     EXEC SQL                                                     02060001
020700         INCLUDE TKRPRPM                                          02070001
020800     END-EXEC.                                                    02080001
020900                                                                  02090001
021000*    PACK-TO-LITE MODULES                                         02100001
021100     EXEC SQL                                                     02110001
021200         INCLUDE TP2LMOD                                          02120001
021300     END-EXEC.                                                    02130001
021310                                                                  02131028
021320*     XLT_USR                                                     02132028
021330     EXEC SQL                                                     02133028
021340         INCLUDE XLT00024                                         02134028
021350     END-EXEC.                                                    02135028
021360                                                                  02136028
021370*     DLT_TMP_EMP                                                 02137028
021380     EXEC SQL                                                     02138028
021390         INCLUDE DLT00002                                         02139028
021391     END-EXEC.                                                    02139128
021400                                                                  02140001
021500     EXEC SQL                                                     02150001
021600          INCLUDE SQLCA                                           02160001
021700     END-EXEC.                                                    02170001
021800                                                                  02180001
021900                                                                  02190001
022000 LINKAGE SECTION.                                                 02200001
022100                                                                  02210001
022200     COPY PCWS246.                                                02220001
022300/                                                                 02230001
022400 PROCEDURE DIVISION USING PC246-COMMAREA.                         02240001
022500                                                                  02250001
022510     INITIALIZE PS-SWITCHES                                       02251024
022511                PV-PROGRAM-VARIABLES.                             02251124
022520                                                                  02252024
022600     PERFORM 1000-INITIALIZE.                                     02260001
022700                                                                  02270001
022800     IF PS-ERROR-NO                                               02280001
022900         IF PS-P4-INTERFACE-YES                                   02290001
023000             PERFORM 2000-CLOSE-DA-BOX                            02300001
023100         END-IF                                                   02310001
023200     END-IF.                                                      02320001
023300                                                                  02330001
023400     PERFORM 9999-RETURN.                                         02340001
023500                                                                  02350001
023600 1000-INITIALIZE.                                                 02360001
023700                                                                  02370001
023800     SET PS-ERROR-NO                                              02380001
023900         PS-P4-INTERFACE-NO                                       02390023
023910         PC246-SUCCESSFUL             TO TRUE.                    02391023
024000                                                                  02400001
024100     MOVE FUNCTION UPPER-CASE(PC246-BOXCLOSE-USER-ID)             02410005
024200                                      TO PV-USER-ID.              02420005
024300                                                                  02430001
024400     PERFORM 7030-SELECT-TKRPRPM.                                 02440001
024500                                                                  02450001
024600     IF PS-ERROR-NO                                               02460001
024700         IF KRPRPM-FUNC-TXT = 'Y'                                 02470001
024800             STRING 'PCKUT075 BC - '                              02480015
024900                    PC246-DC-NBR                                  02490001
025000                    ' '                                           02500001
025100                    PC246-LOCATION-NM                             02510001
025200                    ' '                                           02520001
025300                    PC246-BOX-BAR-CODE-NBR                        02530001
025400                    ' '                                           02540001
025500                    PC246-BOXCLOSE-DATE                           02550001
025600***                  DELIMITED BY SIZE                            02560015
025700***                                         INTO PV-LOG-MSG       02570015
025800***          PERFORM 9900-WRITE-LOG                               02580015
025900***          STRING PC246-BOXCLOSE-TIME                           02590015
025901                    ' '                                           02590115
025910                    PC246-BOXCLOSE-TIME                           02591015
026000                    ' '                                           02600001
026100                    PC246-BOXCLOSE-USER-ID                        02610001
026200                     DELIMITED BY SIZE                            02620001
026300                                            INTO PV-LOG-MSG       02630001
026400             PERFORM 9900-WRITE-LOG                               02640002
026500         END-IF                                                   02650001
026600     END-IF.                                                      02660001
026700                                                                  02670001
026800     IF PS-ERROR-NO                                               02680001
026900         PERFORM 7000-SELECT-TKRPRPM                              02690001
027000     END-IF.                                                      02700001
027100                                                                  02710001
027200     IF PS-ERROR-NO                                               02720001
027300         IF PS-P4-INTERFACE-YES                                   02730001
027310                                                                  02731027
027400***          PERFORM 8600-CALL-XLKUT067                           02740027
027401                                                                  02740128
027402             MOVE SPACES              TO XL067-USER-FOUND-CODE    02740228
027403             PERFORM 7100-KOHLS-USER                              02740328
027410                                                                  02741027
027500***          IF XL067-SUCCESSFUL                                  02750027
027600***              IF XL067-USER-NOT-FOUND                          02760027
027700***                  SET PS-ERROR-YES     TO TRUE                 02770027
027800***              END-IF                                           02780027
027900***          ELSE                                                 02790027
028000***              SET PS-ERROR-YES         TO TRUE                 02800027
028100***          END-IF                                               02810027
028110                                                                  02811027
028200         END-IF                                                   02820001
028300     END-IF.                                                      02830001
028400                                                                  02840001
028500 2000-CLOSE-DA-BOX.                                               02850001
028600     IF KRPRPM-FUNC-TXT = 'Y'                                     02860001
028700         MOVE ' PCKUT075 START 2000- PARA '     TO PV-LOG-MSG     02870007
028800         PERFORM 9900-WRITE-LOG                                   02880002
028900     END-IF.                                                      02890001
029000     PERFORM 3000-MANAGE-ASSIGNMENT.                              02900001
029100     IF PS-ERROR-NO                                               02910001
029200         PERFORM 4000-CREATE-BUSINESS-EVENT                       02920001
029300     END-IF.                                                      02930001
029400     IF KRPRPM-FUNC-TXT = 'Y'                                     02940001
029500         MOVE ' PCKUT075 END 2000- PARA '     TO PV-LOG-MSG       02950007
029600         PERFORM 9900-WRITE-LOG                                   02960002
029700     END-IF.                                                      02970001
029800                                                                  02980001
029900 3000-MANAGE-ASSIGNMENT.                                          02990001
030000     IF KRPRPM-FUNC-TXT = 'Y'                                     03000001
030100         MOVE ' PCKUT075 START 3000- PARA '     TO PV-LOG-MSG     03010007
030200         PERFORM 9900-WRITE-LOG                                   03020002
030300     END-IF.                                                      03030001
030400                                                                  03040001
030500     PERFORM 3120-DETERMINE-MOD-NBR.                              03050001
030600                                                                  03060001
030700     PERFORM 7050-SELECT-TP2LMOD.                                 03070001
030800     IF P2LMOD-MODU-MDSE-TYP-CDE = 'H'                            03080001
030900         MOVE 'HRTW '                  TO P2LMOD-DFLT-STR-ZN-ID   03090001
031000     END-IF.                                                      03100001
031100                                                                  03110001
031200     IF PS-ERROR-NO                                               03120001
031300         PERFORM 8450-LINK-DLKUT410                               03130009
031400     END-IF.                                                      03140001
031500     IF KRPRPM-FUNC-TXT = 'Y'                                     03150001
031600         MOVE ' PCKUT075 END 3000- PARA '     TO PV-LOG-MSG       03160007
031700         PERFORM 9900-WRITE-LOG                                   03170002
031800     END-IF.                                                      03180001
031900                                                                  03190001
032000/                                                                 03200001
032100 3120-DETERMINE-MOD-NBR.                                          03210001
032200     IF KRPRPM-FUNC-TXT = 'Y'                                     03220001
032300         MOVE ' PCKUT075 START 3120- PARA '     TO PV-LOG-MSG     03230007
032400         PERFORM 9900-WRITE-LOG                                   03240002
032500     END-IF.                                                      03250001
032600                                                                  03260001
032700     MOVE PC246-LOCATION-NM           TO PV-HOLD-LOCATION.        03270001
032800     PERFORM VARYING PV-LENGTH FROM 10 BY -1                      03280001
032900             UNTIL PV-HOLD-LOCATION (PV-LENGTH:1) NOT = SPACES    03290001
033000         ADD 1                        TO PV-DUMMY                 03300001
033100     END-PERFORM.                                                 03310001
033200                                                                  03320001
033300     EVALUATE PV-LENGTH                                           03330001
033400         WHEN 4                                                   03340001
033500             MOVE PV-HOLD-LOCATION(1:1)                           03350001
033600                                      TO DK-MODU-NBR              03360001
033700         WHEN 5                                                   03370001
033800             MOVE PV-HOLD-LOCATION(1:2)                           03380001
033900                                      TO DK-MODU-NBR              03390001
034000         WHEN OTHER                                               03400001
034100             MOVE ZEROES              TO DK-MODU-NBR              03410001
034200     END-EVALUATE.                                                03420001
034300     IF KRPRPM-FUNC-TXT = 'Y'                                     03430001
034400         MOVE ' PCKUT075 END 3120- PARA '     TO PV-LOG-MSG       03440007
034500         PERFORM 9900-WRITE-LOG                                   03450002
034600     END-IF.                                                      03460001
034700/                                                                 03470001
034800 4000-CREATE-BUSINESS-EVENT.                                      03480001
034900     IF KRPRPM-FUNC-TXT = 'Y'                                     03490001
035000         MOVE ' PCKUT075 START 4000- PARA '     TO PV-LOG-MSG     03500007
035100         PERFORM 9900-WRITE-LOG                                   03510002
035200     END-IF.                                                      03520001
035300                                                                  03530001
035400*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      03540001
035500     PERFORM 8400-CALL-DLKUP024.                                  03550014
035600                                                                  03560001
035700*    UPDATE EAI TABLES                                            03570001
035800     IF PS-ERROR-NO                                               03580001
035900         PERFORM 8410-CALL-XLKUP046                               03590014
036000     END-IF.                                                      03600001
036100     IF KRPRPM-FUNC-TXT = 'Y'                                     03610001
036200         MOVE ' PCKUT075 END 4000- PARA '     TO PV-LOG-MSG       03620007
036300         PERFORM 9900-WRITE-LOG                                   03630002
036400     END-IF.                                                      03640001
036500                                                                  03650001
036600 7000-SELECT-TKRPRPM.                                             03660001
036700     IF KRPRPM-FUNC-TXT = 'Y'                                     03670001
036810         INITIALIZE  PV-LOG-MSG                                   03681030
036820         STRING ' PCKUT075 START 7000- PARA '                     03682030
036830              ' PS-P4-INTERFACE-SW:' PS-P4-INTERFACE-SW           03683030
036840              ' PS-ERROR-SW:'        PS-ERROR-SW                  03684030
036850               DELIMITED BY SIZE          INTO PV-LOG-MSG         03685030
036900         PERFORM 9900-WRITE-LOG                                   03690002
037000     END-IF.                                                      03700001
037100                                                                  03710001
037200     MOVE PC246-DC-NBR                TO KRPRPM-LOC-ID.           03720001
037300     SET PS-P4-INTERFACE-NO           TO TRUE.                    03730001
037400     EXEC SQL                                                     03740001
037500         SELECT FUNC_TXT                                          03750001
037600         INTO :PS-P4-INTERFACE-SW                                 03760001
037700         FROM                                                     03770001
037800             TKRPRPM                                              03780001
037900         WHERE                                                    03790001
038000             LOC_ID                   = :KRPRPM-LOC-ID            03800001
038100         AND INTFC_SYS_CDE            = 'DLX'                     03810001
038200         AND SYS_PRC_FUNC_CDE         = 'DLP2LI'                  03820001
038300         WITH UR                                                  03830001
038400     END-EXEC.                                                    03840001
038500                                                                  03850001
038600     EVALUATE TRUE                                                03860001
038700         WHEN SQLCODE = ZERO                                      03870001
038800             CONTINUE                                             03880001
038900         WHEN OTHER                                               03890001
038910***                                                               03891019
038920*** DMH ADDED DISPLAYS - 8/21/2007                                03892019
038930***                                                               03893019
038940             MOVE SQLCODE             TO PV-DISP-SQLCODE          03894019
038950             MOVE KRPRPM-LOC-ID       TO PV-DISP-OPER             03895019
038960             DISPLAY ' PCKUT075 - 7000 - '                        03896022
038970                     ' SQLCODE:'         PV-DISP-SQLCODE          03897019
038980                     ' TKRPRPM '                                  03898019
038990                     ' DLX  DLP2LI'                               03899019
038991***                                                               03899119
039000             MOVE '7000-'             TO PV-ERROR-PARA            03900001
039100             MOVE 'SQL ERROR - TKRPRPM'                           03910001
039200                                      TO PV-ERROR-TEXT            03920001
039300             PERFORM 9700-SQL-ERROR                               03930001
039400                                                                  03940001
039500     END-EVALUATE.                                                03950001
039600     IF KRPRPM-FUNC-TXT = 'Y'                                     03960001
039610         INITIALIZE  PV-LOG-MSG                                   03961030
039620         MOVE SQLCODE             TO PV-DISP-SQLCODE              03962030
039630         MOVE KRPRPM-LOC-ID       TO PV-DISP-OPER                 03963030
039700         STRING ' PCKUT075 END 7000- PARA '                       03970030
039710              ' PS-P4-INTERFACE-SW:' PS-P4-INTERFACE-SW           03971030
039711              ' PS-ERROR-SW:'        PS-ERROR-SW                  03971130
039712              ' SQLCODE:'            PV-DISP-SQLCODE              03971230
039713              ' OPER:'               PV-DISP-OPER                 03971330
039720               DELIMITED BY SIZE          INTO PV-LOG-MSG         03972030
039800         PERFORM 9900-WRITE-LOG                                   03980002
039900     END-IF.                                                      03990001
040000                                                                  04000001
040100 7030-SELECT-TKRPRPM.                                             04010001
040200                                                                  04020001
040300     MOVE PC246-DC-NBR                TO KRPRPM-LOC-ID.           04030001
040400                                                                  04040001
040500     EXEC SQL                                                     04050001
040600         SELECT FUNC_TXT                                          04060001
040700         INTO :KRPRPM-FUNC-TXT                                    04070001
040800         FROM                                                     04080001
040900             TKRPRPM                                              04090001
041000         WHERE                                                    04100001
041100             LOC_ID                   = :KRPRPM-LOC-ID            04110001
041200         AND INTFC_SYS_CDE            = 'DLX'                     04120001
041300         AND SYS_PRC_FUNC_CDE         = 'DLPLDI'                  04130001
041400         AND CURRENT TIMESTAMP BETWEEN                            04140001
041500             FUNC_BEG_TMST AND FUNC_END_TMST                      04150001
041600         WITH UR                                                  04160001
041700     END-EXEC.                                                    04170001
041800                                                                  04180001
041900     EVALUATE TRUE                                                04190001
042000         WHEN SQLCODE = ZERO                                      04200001
042100             CONTINUE                                             04210001
042200         WHEN OTHER                                               04220001
042210***                                                               04221019
042220*** DMH ADDED DISPLAYS - 8/21/2007                                04222019
042230***                                                               04223019
042240             MOVE SQLCODE             TO PV-DISP-SQLCODE          04224019
042250             MOVE KRPRPM-LOC-ID       TO PV-DISP-OPER             04225019
042260             DISPLAY ' PCKUT075 - 7030 - '                        04226022
042270                     ' SQLCODE:'         PV-DISP-SQLCODE          04227019
042280                     ' TKRPRPM '                                  04228019
042290                     ' DLX  DLPLDI'                               04229019
042291***                                                               04229119
042300             MOVE '7030-'             TO PV-ERROR-PARA            04230019
042400             MOVE 'SQL ERROR - TKRPRPM'                           04240001
042500                                      TO PV-ERROR-TEXT            04250001
042600             PERFORM 9700-SQL-ERROR                               04260001
042700                                                                  04270001
042800     END-EVALUATE.                                                04280001
042900                                                                  04290001
043000 7050-SELECT-TP2LMOD.                                             04300001
043100                                                                  04310001
043200     MOVE PC246-DC-NBR               TO DK-OPER-UNT-ID.           04320001
043300     EXEC SQL                                                     04330001
043400         SELECT                                                   04340001
043500             MODU_NBR                                             04350001
043600            ,DFLT_STR_ZN_ID                                       04360001
043700            ,MODU_MDSE_TYP_CDE                                    04370001
043800         INTO                                                     04380001
043900             :P2LMOD-MODU-NBR                                     04390001
044000            ,:P2LMOD-DFLT-STR-ZN-ID                               04400001
044100            ,:P2LMOD-MODU-MDSE-TYP-CDE                            04410001
044200         FROM                                                     04420001
044300             TP2LMOD                                              04430001
044400         WHERE                                                    04440001
044500             OPER_UNT_ID              = :DK-OPER-UNT-ID           04450001
044600         AND FCLTY_ID                 = 1                         04460001
044700         AND MODU_NBR                 = :DK-MODU-NBR              04470001
044800         WITH UR                                                  04480001
044900     END-EXEC.                                                    04490001
045000                                                                  04500001
045100     EVALUATE TRUE                                                04510001
045200         WHEN SQLCODE = ZERO                                      04520001
045300             CONTINUE                                             04530001
045400         WHEN SQLCODE = +100                                      04540001
045410***                                                               04541019
045420*** DMH ADDED DISPLAYS - 8/21/2007                                04542019
045430***                                                               04543019
045440             MOVE SQLCODE             TO PV-DISP-SQLCODE          04544019
045450             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04545019
045460             DISPLAY ' PCKUT075 - 7050 - '                        04546022
045470                     ' SQLCODE:'         PV-DISP-SQLCODE          04547019
045480                     ' TP2LMOD '                                  04548019
045490                     ' MOD:'             DK-MODU-NBR              04549019
045491***                                                               04549119
045500             MOVE '7050-'             TO PV-ERROR-PARA            04550001
045600             MOVE 'STR ZN NOTFOUND'   TO PV-ERROR-TEXT            04560001
045700             PERFORM 9700-SQL-ERROR                               04570001
045800             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04580001
045900             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04590001
046000             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04600001
046100             PERFORM 9900-WRITE-LOG                               04610002
046200                                                                  04620001
046300         WHEN SQLCODE = -904                                      04630001
046400         WHEN SQLCODE = -913                                      04640001
046500         WHEN SQLCODE = -911                                      04650001
046510***                                                               04651019
046520*** DMH ADDED DISPLAYS - 8/21/2007                                04652019
046530***                                                               04653019
046540             MOVE SQLCODE             TO PV-DISP-SQLCODE          04654019
046550             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04655019
046560             DISPLAY ' PCKUT075 - 7050 - '                        04656022
046570                     ' SQLCODE:'         PV-DISP-SQLCODE          04657019
046580                     ' TP2LMOD '                                  04658019
046590                     ' MOD:'             DK-MODU-NBR              04659019
046591***                                                               04659119
046600             MOVE '7050-'             TO PV-ERROR-PARA            04660001
046700             MOVE 'SQL ERROR - TP2LMOD'                           04670001
046800                                      TO PV-ERROR-TEXT            04680001
046900             PERFORM 9700-SQL-ERROR                               04690001
047000             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04700001
047100             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04710001
047200             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04720001
047300             PERFORM 9900-WRITE-LOG                               04730002
047400                                                                  04740001
047500         WHEN SQLWARN0 NOT = SPACES                               04750001
047600         WHEN SQLCODE NOT = ZERO                                  04760001
047610***                                                               04761019
047620*** DMH ADDED DISPLAYS - 8/21/2007                                04762019
047630***                                                               04763019
047640             MOVE SQLCODE             TO PV-DISP-SQLCODE          04764019
047650             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER             04765019
047660             DISPLAY ' PCKUT075 - 7050 - '                        04766022
047670                     ' SQLCODE:'         PV-DISP-SQLCODE          04767019
047680                     ' TP2LMOD '                                  04768019
047690                     ' MOD:'             DK-MODU-NBR              04769019
047691***                                                               04769119
047700             MOVE '7050-'             TO PV-ERROR-PARA            04770001
047800             MOVE 'SQL ERROR - TP2LMOD'                           04780001
047900                                      TO PV-ERROR-TEXT            04790001
048000             PERFORM 9700-SQL-ERROR                               04800001
048100             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04810001
048200             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04820001
048300             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04830001
048400             PERFORM 9900-WRITE-LOG                               04840002
048500                                                                  04850001
048600     END-EVALUATE.                                                04860001
048700/                                                                 04870001
048710 7100-KOHLS-USER.                                                 04871028
048720                                                                  04872028
048730     IF KRPRPM-FUNC-TXT = 'Y'                                     04873028
048740         MOVE ' PCKUT075 START 7100- PARA '     TO PV-LOG-MSG     04874028
048750         PERFORM 9900-WRITE-LOG                                   04875028
048760     END-IF.                                                      04876028
048770                                                                  04877028
048780     SET PS-USER-FOUND-NO             TO TRUE                     04878028
048790     MOVE PV-USER-ID                  TO XLT00024-USR-ID          04879028
048791                                                                  04879128
048792                                                                  04879228
048793     EXEC SQL                                                     04879328
048794         SELECT  'Y'                                              04879428
048795              INTO  :PS-USER-FOUND-SW                             04879528
048796              FROM   XLT_USR    USR                               04879628
048797          WHERE  USR.USR_ID       = :XLT00024-USR-ID              04879728
048798          WITH UR                                                 04879828
048799     END-EXEC                                                     04879928
048800                                                                  04880028
048801     EVALUATE TRUE                                                04880128
048802         WHEN SQLCODE = ZERO                                      04880228
048803             SET XL067-USER-IS-KOHLS  TO TRUE                     04880328
048804                                                                  04880428
048805              IF KRPRPM-FUNC-TXT = 'Y'                            04880528
048806                 MOVE ' PCKUT075 START 7100- KOHLS ASSOCIATE'     04880628
048807                                            TO PV-LOG-MSG         04880728
048808                 PERFORM 9900-WRITE-LOG                           04880828
048809               END-IF                                             04880928
048810                                                                  04881028
048811         WHEN SQLCODE = +100                                      04881128
048812                                                                  04881228
048813              IF KRPRPM-FUNC-TXT = 'Y'                            04881328
048814                 MOVE ' PCKUT075 START 7100- NOT KOHLS ASSOCIATE' 04881428
048815                                            TO PV-LOG-MSG         04881528
048816                 PERFORM 9900-WRITE-LOG                           04881628
048817               END-IF                                             04881728
048818                                                                  04881828
048819             PERFORM 7105-TEMP-USER                               04881928
048820                                                                  04882028
048821         WHEN SQLCODE = -904                                      04882128
048822         WHEN SQLCODE = -911                                      04882228
048823         WHEN SQLCODE = -913                                      04882328
048824         WHEN SQLWARN0 NOT = SPACES                               04882428
048825              AND SQLCODE NOT = ZERO                              04882528
048826                                                                  04882628
048827             SET PS-ERROR-YES         TO TRUE                     04882728
048828             MOVE SQLCODE             TO  PV-DISP-SQLCODE         04882828
048829             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            04882928
048830             DISPLAY ' PCKUT075 - 7100 - '                        04883028
048831                     ' SQLCODE: '         PV-DISP-SQLCODE         04883128
048832                     ' TP2LMOD '                                  04883228
048833             DISPLAY ' PCKUT075 - 7100 - '                        04883328
048834                     ' OPER: '            PV-DISP-OPER            04883428
048835                     ' MODULE: '          DK-MODU-NBR             04883528
048836                                                                  04883628
048837             MOVE '7100-'             TO PV-ERROR-PARA            04883728
048838             MOVE 'SQL ERROR - TP2LMOD'                           04883828
048839                                      TO PV-ERROR-TEXT            04883928
048840             PERFORM 9700-SQL-ERROR                               04884028
048841             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04884128
048842             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04884228
048843             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04884328
048844             PERFORM 9900-WRITE-LOG                               04884428
048845                                                                  04884528
048846     END-EVALUATE.                                                04884628
048847/                                                                 04884728
048848 7105-TEMP-USER.                                                  04884828
048849                                                                  04884928
048850     IF KRPRPM-FUNC-TXT = 'Y'                                     04885028
048851         MOVE ' PCKUT075 START 7105- PARA '     TO PV-LOG-MSG     04885128
048852         PERFORM 9900-WRITE-LOG                                   04885228
048853     END-IF.                                                      04885328
048854                                                                  04885428
048855                                                                  04885528
048856     SET PS-USER-FOUND-NO             TO TRUE                     04885628
048857     MOVE PV-USER-ID                  TO DLT00002-TMP-USR-ID      04885728
048858                                                                  04885828
048859     EXEC SQL                                                     04885928
048860         SELECT  'Y'                                              04886028
048861              INTO  :PS-USER-FOUND-SW                             04886128
048862              FROM   DLT_TMP_EMP                                  04886228
048863          WHERE  TMP_USR_ID       = :DLT00002-TMP-USR-ID          04886328
048864          WITH UR                                                 04886428
048865     END-EXEC                                                     04886528
048866                                                                  04886628
048867     EVALUATE TRUE                                                04886728
048868         WHEN SQLCODE = ZERO                                      04886828
048869             SET XL067-USER-IS-TEMP TO TRUE                       04886928
048870                                                                  04887028
048871              IF KRPRPM-FUNC-TXT = 'Y'                            04887128
048872                 MOVE ' PCKUT075 START 7105- TEMP ASSOCIATE'      04887228
048873                                            TO PV-LOG-MSG         04887328
048874                 PERFORM 9900-WRITE-LOG                           04887428
048875               END-IF                                             04887528
048876                                                                  04887628
048877                                                                  04887728
048878         WHEN SQLCODE = +100                                      04887828
048879             SET PS-ERROR-YES                                     04887928
048880                 XL067-USER-NOT-FOUND                             04888029
048881                 PC246-UNKNOWN-USER   TO TRUE                     04888129
048882                                                                  04888229
048883              IF KRPRPM-FUNC-TXT = 'Y'                            04888329
048884                 MOVE ' PCKUT075 START 7105- NOT FOUND ASSOC'     04888429
048885                                            TO PV-LOG-MSG         04888529
048886                 PERFORM 9900-WRITE-LOG                           04888629
048887               END-IF                                             04888729
048888                                                                  04888829
048889         WHEN SQLCODE = -904                                      04888929
048890         WHEN SQLCODE = -911                                      04889029
048891         WHEN SQLCODE = -913                                      04889129
048892         WHEN SQLWARN0 NOT = SPACES                               04889229
048893              AND SQLCODE NOT = ZERO                              04889329
048894                                                                  04889429
048895             MOVE SQLCODE             TO  PV-DISP-SQLCODE         04889529
048896             MOVE DK-OPER-UNT-ID      TO  PV-DISP-OPER            04889629
048897             DISPLAY ' PCKUT075 - 7105 - '                        04889729
048898                     ' SQLCODE: '         PV-DISP-SQLCODE         04889829
048899                     ' TP2LMOD '                                  04889929
048900             DISPLAY ' PCKUT075 - 7105 - '                        04890029
048901                     ' OPER: '            PV-DISP-OPER            04890129
048902                     ' MODULE: '          DK-MODU-NBR             04890229
048903                                                                  04890329
048904             MOVE '7105-'             TO PV-ERROR-PARA            04890429
048905             MOVE 'SQL ERROR - TP2LMOD'                           04890529
048906                                      TO PV-ERROR-TEXT            04890629
048907             PERFORM 9700-SQL-ERROR                               04890729
048908             MOVE DK-OPER-UNT-ID      TO PV-MSG-MODU-DC           04890829
048909             MOVE DK-MODU-NBR         TO PV-MSG-MODU              04890929
048910             MOVE PV-MODU-TEXT        TO PV-LOG-MSG               04891029
048911             PERFORM 9900-WRITE-LOG                               04891129
048912                                                                  04891229
048913     END-EVALUATE.                                                04891329
048914                                                                  04891429
048915                                                                  04891529
048920 8400-CALL-DLKUP024.                                              04892014
049000                                                                  04900001
049100     INITIALIZE DL020-ASGMT-COMMAREA.                             04910010
049200                                                                  04920001
049300     SET DL020-BY-ASGMT-KEY                                       04930010
049400         DL020-COMMIT-UPDATE                                      04940010
049500         DL020-FIND-NEXT-ASGMT        TO TRUE.                    04950010
049600                                                                  04960001
049700     MOVE DL019-ESO-ASGMT-START-DTE   TO DL020-KEY-START-DTE      04970010
049800                                         PV-LABOR-ASGMT-STRT-DTE. 04980001
049900     MOVE DL019-ESO-ASGMT-NBR-TXT     TO DL020-KEY-NBR-TXT        04990010
050000                                         PV-LABOR-ASGMT-NBR-TXT.  05000001
050100     MOVE DL019-ESO-ASGMT-NBR-SEQ-NBR TO DL020-KEY-NBR-SEQ-NBR    05010010
050200                                       PV-LABOR-ASGMT-NBR-SEQ-NBR.05020001
050300                                                                  05030001
050400     MOVE 1                          TO DL020-NBR-OF-NBRS-NEED-QTY05040010
050500     MOVE 'PCKUT075'                  TO DL020-ORIG-CALLING-PGM-NM05050010
050600                                                                  05060001
050700     CALL DL020-USER-PGM USING DL020-ASGMT-COMMAREA.              05070010
050800                                                                  05080001
050900     IF DL020-SUCCESSFUL                                          05090010
051000         IF DL020-ASGMT-NEXT-USED                                 05100010
051100             MOVE DL020-NXT-START-DTE                             05110010
051200                                   TO PV-LABOR-ASGMT-STRT-DTE     05120001
051300             MOVE DL020-NXT-NBR-TXT                               05130010
051400                                   TO PV-LABOR-ASGMT-NBR-TXT      05140001
051500             MOVE DL020-NXT-NBR-SEQ-NBR                           05150010
051600                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  05160001
051700             MOVE DL020-SEQ-START-NBR                             05170010
051800                                   TO PV-LABOR-SEQ-START-NBR      05180001
051900         ELSE                                                     05190001
052000             MOVE DL020-SEQ-START-NBR                             05200010
052100                                   TO PV-LABOR-SEQ-START-NBR      05210001
052200         END-IF                                                   05220001
052300                                                                  05230001
052400     ELSE                                                         05240001
052500         MOVE '8400-'                 TO PV-ERROR-PARA            05250001
052600         MOVE 'SQL ERROR IN DLKUP024'                             05260014
052700                                      TO PV-ERROR-TEXT            05270001
052800         MOVE DL020-SQLCA             TO SQLCA                    05280010
052900         PERFORM 9700-SQL-ERROR                                   05290001
053000                                                                  05300001
053100         MOVE DL020-KEY-START-DTE     TO PV-DLKUP024-DATE         05310014
053200         MOVE DL020-KEY-NBR-TXT       TO PV-DLKUP024-TXT          05320014
053300         MOVE DL020-KEY-NBR-SEQ-NBR   TO PV-DLKUP024-SEQ          05330014
053400         MOVE PV-DLKUP024-TEXT        TO PV-LOG-MSG               05340014
053500         PERFORM 9900-WRITE-LOG                                   05350002
053600                                                                  05360001
053700         STRING ' PARA= '                                         05370001
053800                DL020-SQL-ERROR-PARA                              05380010
053900                 ' PGM= '                                         05390001
054000               DL020-CALL-MOD-FAIL-NM                             05400010
054100                 ' ERR CODE= '                                    05410001
054200               DL020-CALL-MOD-FAIL-ERR-CDE                        05420010
054300                 DELIMITED BY SIZE INTO PV-LOG-MSG                05430001
054400         PERFORM 9900-WRITE-LOG                                   05440002
054500                                                                  05450001
054600     END-IF.                                                      05460001
054700/                                                                 05470001
054800 8410-CALL-XLKUP046.                                              05480014
054900                                                                  05490001
055000     INITIALIZE XL091-EAI-EXPORT-COMMAREA                         05500010
055100                PC242-DTL-TXT-AREA.                               05510001
055200                                                                  05520001
055300     SET XL091-PC-APP-ID          TO TRUE.                        05530010
055400     SET XL091-COMMIT-UPDATE      TO TRUE.                        05540010
055500                                                                  05550001
055600     MOVE 'PCKUT075'              TO XL091-ORIG-CALLING-PGM-NM.   05560010
055700     MOVE 'PACKTOLIGHT'           TO XL091-EVNT-OBJ-TXT.          05570010
055800     MOVE 'OUTBOUND CLOSE'        TO XL091-EVNT-OBJ-ACTN-TXT.     05580010
055900     MOVE PV-USER-ID              TO XL091-CRE-BY-USR-ID.         05590010
056000     MOVE 'PCKUT075'              TO XL091-CRE-PGM-NM.            05600010
056100                                                                  05610001
056200     MOVE PC246-DC-NBR            TO XL091-EVNT-KY-1-NBR.         05620010
056300                                                                  05630001
056400     MOVE DK-MODU-NBR             TO XL091-EVNT-KY-1-TXT.         05640010
056500     MOVE PC246-BOX-BAR-CODE-NBR  TO XL091-EVNT-KY-2-TXT.         05650010
056600                                                                  05660001
056700     MOVE PC246-BOXCLOSE-DATE-YYYY TO PV-START-CCYY.              05670001
056800     MOVE PC246-BOXCLOSE-DATE-MM  TO PV-START-MM.                 05680001
056900     MOVE PC246-BOXCLOSE-DATE-DD  TO PV-START-DD.                 05690001
057000                                                                  05700001
057100     MOVE PC246-BOXCLOSE-TIME-HH  TO PV-START-HOUR-N.             05710001
057200     MOVE PC246-BOXCLOSE-TIME-MM  TO PV-START-MIN.                05720001
057300     MOVE PC246-BOXCLOSE-TIME-SS  TO PV-START-SEC.                05730001
057400     MOVE PV-START-TIMESTAMP      TO XL091-EVNT-KY-1-TMST.        05740010
057500                                                                  05750001
057600*    POPULATE DETAIL AREA                                         05760001
057700     SET XL091-PCWS242-COPYBOOK TO TRUE.                          05770010
057800                                                                  05780001
057900     INITIALIZE PC242-DTL-TXT-AREA.                               05790001
058000                                                                  05800001
058100     SET PC242-P2L-CLOSE-OTBND-CRTN   TO TRUE.                    05810001
058200                                                                  05820001
058300     MOVE PV-LABOR-ASGMT-STRT-DTE     TO PC242-AM-ASGMT-STRT-DTE. 05830001
058400     MOVE PV-LABOR-ASGMT-NBR-TXT      TO PC242-AM-ASGMT-NBR-TXT.  05840001
058500     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR  TO                          05850001
058600                                   PC242-AM-ASGMT-NBR-SEQ-NBR.    05860001
058700     MOVE PV-LABOR-SEQ-START-NBR      TO                          05870001
058800                                   PC242-AM-ASGMT-SEQ-DTL-NBR.    05880001
058900                                                                  05890001
059000     MOVE P2LMOD-DFLT-STR-ZN-ID TO PC242-AM-STR-ZN-ID.            05900001
059100                                                                  05910001
059200     MOVE PC242-DTL-TXT-AREA          TO XL091-DTL-TXT.           05920010
059300                                                                  05930001
059400     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         05940010
059500                                                                  05950001
059600     IF XL091-SUCCESSFUL                                          05960010
059700        CONTINUE                                                  05970001
059800     ELSE                                                         05980001
059900         MOVE PV-USER-ID              TO PV-XLKUP046-USER         05990014
060000                                                                  06000001
060100         MOVE 'OUTBOUND CLOSE'        TO PV-XLKUP046-OBJTXT       06010014
060200         MOVE PV-XLKUP046-TEXT1       TO PV-LOG-MSG               06020014
060300         PERFORM 9900-WRITE-LOG                                   06030002
060400                                                                  06040001
060500         MOVE 'OUTBOUND CLOSE'        TO PV-XLKUP046-OBJACTNTXT   06050014
060600         MOVE PV-XLKUP046-TEXT2       TO PV-LOG-MSG               06060014
060700         PERFORM 9900-WRITE-LOG                                   06070002
060800                                                                  06080001
060900         IF XL091-SQL-ERROR                                       06090010
061000             MOVE '8410-'             TO PV-ERROR-PARA            06100001
061100             MOVE 'SQL ERROR IN XLKUP046'                         06110014
061200                                      TO PV-ERROR-TEXT            06120001
061300             MOVE XL091-SQLCA         TO SQLCA                    06130010
061400             PERFORM 9700-SQL-ERROR                               06140001
061500                                                                  06150001
061600         END-IF                                                   06160001
061700                                                                  06170001
061800     END-IF.                                                      06180001
061900/                                                                 06190001
062000 8450-LINK-DLKUT410.                                              06200009
062100                                                                  06210001
062200     INITIALIZE DL019-PGM-COMMAREA.                               06220009
062300                                                                  06230001
062400     SET DL019-ESTABLISH-ASGMT        TO TRUE.                    06240009
062500     SET DL019-COMMIT-UPDATE          TO TRUE.                    06250009
062600     MOVE 'PCKUT075'                  TO DL019-CALLING-PGM-NM.    06260009
062700     MOVE PV-USER-ID                  TO DL019-SIGN-ON-USR-ID.    06270009
062800                                                                  06280001
062900     SET DL011-AN-P2L-WRK-TYP         TO TRUE.                    06290001
063000     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL019-ASGMT-NBR-WRK-TYP. 06300009
063100                                                                  06310001
063200     SET DL011-P2L-WRK-TYP            TO TRUE.                    06320001
063300     MOVE DL011-KEY-WK-TYP            TO DL019-EAI-WK-TYP-DESC.   06330009
063400                                                                  06340001
063500     MOVE P2LMOD-DFLT-STR-ZN-ID       TO DL011-P2-WRK-AREA-5-9.   06350001
063600     MOVE P2LMOD-MODU-NBR             TO DL011-P2-WRK-AREA-MOD-4-606360001
063700     MOVE DL011-P2L-MOD-WRK-AREA      TO DL019-EAI-WK-AREA-DESC.  06370009
063800                                                                  06380001
063900     MOVE PC246-DC-NBR                TO DL019-EAI-DC-NBR.        06390009
064000                                                                  06400001
064100     MOVE PV-USER-ID                  TO DL019-EAI-CRE-BY-USR-ID. 06410009
064200                                                                  06420001
064300                                                                  06430001
064400*    THIS IS KNOWN FROM THE VERIFICATION OF THE USERID            06440001
064500     IF XL067-USER-IS-KOHLS                                       06450001
064600         SET DL019-EAI-USR-IS-KOHLS   TO TRUE                     06460009
064700     ELSE                                                         06470001
064800         SET DL019-EAI-USR-IS-TMP     TO TRUE                     06480009
064900     END-IF.                                                      06490001
065000                                                                  06500001
065100     CALL DL019-USER-PGM USING DL019-PGM-COMMAREA.                06510009
065200                                                                  06520001
065300     EVALUATE TRUE                                                06530001
065400         WHEN DL019-SUCCESSFUL                                    06540009
065500                 CONTINUE                                         06550001
065600                                                                  06560001
065700         WHEN DL019-SQL-ERROR                                     06570009
065710***                                                               06571020
065720*** DMH ADDED DISPLAYS - 8/21/2007                                06572020
065730***                                                               06573020
065740             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           06574020
065750             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        06575020
065751             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    06575125
065752                                       TO  PV-DISP-SQLCODE-3      06575225
065760             DISPLAY ' PCKUT075 - 8450 - CALL TO DLKUT410 - '     06576020
065770             DISPLAY ' PCKUT075 - DLWS019 '                       06577020
065780                     ' PROCESS CODE:'   DL019-PROCESS-CDE         06578020
065790                     ' COMMIT CODE:'    DL019-COMMIT-CDE          06579020
065791                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      06579120
065792                     ' USER ID:'        DL019-SIGN-ON-USR-ID      06579220
065793                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   06579320
065794             DISPLAY ' PCKUT075 - DLWS019 '                       06579420
065795                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     06579520
065796                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    06579620
065797                     ' DC:'             PV-DISP-OPER              06579720
065798                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   06579820
065799                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     06579920
065800             DISPLAY ' PCKUT075 - DLWS019 '                       06580020
065801                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 06580120
065802             DISPLAY ' PCKUT075 - DLWS019 '                       06580220
065803                     ' RETURN CODE:'     DL019-RETURN-CODE        06580321
065804                     ' SQLCODE:'         PV-DISP-SQLCODE          06580420
065805                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    06580520
065806                     '-'          DL019-CALL-MOD-FAIL-NM          06580620
065807                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     06580720
065808                     '-'          PV-DISP-SQLCODE-3               06580825
065809***                                                               06580920
065810             MOVE '8450-'             TO PV-ERROR-PARA            06581001
065900             MOVE 'SQL ERROR IN DLKUT410'                         06590009
066000                                      TO PV-ERROR-TEXT            06600001
066100             MOVE DL019-SQLCA         TO SQLCA                    06610009
066200             PERFORM 9700-SQL-ERROR                               06620001
066300                                                                  06630001
066400         WHEN DL019-CALLED-MODULE-FAILURE AND                     06640009
066500              DL019-CALL-MOD-FAIL-SQL-PARA NOT = SPACES           06650009
066600                                                                  06660001
066610***                                                               06661020
066620*** DMH ADDED DISPLAYS - 8/21/2007                                06662020
066630***                                                               06663020
066640             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           06664020
066650             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        06665020
066651             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    06665125
066652                                       TO  PV-DISP-SQLCODE-3      06665225
066660             DISPLAY ' PCKUT075 - 8450 - CALL TO DLKUT410 - '     06666020
066670             DISPLAY ' PCKUT075 - DLWS019 '                       06667020
066680                     ' PROCESS CODE:'   DL019-PROCESS-CDE         06668020
066690                     ' COMMIT CODE:'    DL019-COMMIT-CDE          06669020
066691                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      06669120
066692                     ' USER ID:'        DL019-SIGN-ON-USR-ID      06669220
066693                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   06669320
066694             DISPLAY ' PCKUT075 - DLWS019 '                       06669420
066695                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     06669520
066696                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    06669620
066697                     ' DC:'             PV-DISP-OPER              06669720
066698                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   06669820
066699                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     06669920
066700             DISPLAY ' PCKUT075 - DLWS019 '                       06670020
066701                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 06670120
066702             DISPLAY ' PCKUT075 - DLWS019 '                       06670220
066703                     ' RETURN CODE:'     DL019-RETURN-CODE        06670321
066704                     ' SQLCODE:'         PV-DISP-SQLCODE          06670420
066705                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    06670520
066706                     '-'          DL019-CALL-MOD-FAIL-NM          06670620
066707                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     06670720
066708                     '-'          PV-DISP-SQLCODE-3               06670825
066709***                                                               06670920
066710             MOVE '8450-'             TO PV-ERROR-PARA            06671001
066800             SET PC246-SQL-ERROR      TO TRUE                     06680001
066900                                                                  06690001
067000*            HANDLE EACH KIND OF SQL ERROR AS NEEDED              06700001
067100             MOVE DL019-CALL-MOD-FAIL-SQL-CDE                     06710009
067200                                      TO SQLCODE                  06720001
067300                                                                  06730001
067400             IF SQLCODE = ZERO                                    06740001
067500                 CONTINUE                                         06750001
067600             ELSE                                                 06760001
067700                 PERFORM 8451-ERROR                               06770001
067800             END-IF                                               06780001
067900                                                                  06790001
068000         WHEN DL019-INVALID-ACCESS                                06800009
068010***                                                               06801020
068020*** DMH ADDED DISPLAYS - 8/21/2007                                06802020
068030***                                                               06803020
068040             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           06804020
068050             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        06805020
068051             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    06805125
068052                                       TO  PV-DISP-SQLCODE-3      06805225
068060             DISPLAY ' PCKUT075 - 8450 - CALL TO DLKUT410 - '     06806020
068070             DISPLAY ' PCKUT075 - DLWS019 '                       06807020
068080                     ' PROCESS CODE:'   DL019-PROCESS-CDE         06808020
068090                     ' COMMIT CODE:'    DL019-COMMIT-CDE          06809020
068091                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      06809120
068092                     ' USER ID:'        DL019-SIGN-ON-USR-ID      06809220
068093                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   06809320
068094             DISPLAY ' PCKUT075 - DLWS019 '                       06809420
068095                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     06809520
068096                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    06809620
068097                     ' DC:'             PV-DISP-OPER              06809720
068098                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   06809820
068099                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     06809920
068100             DISPLAY ' PCKUT075 - DLWS019 '                       06810020
068101                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 06810120
068102             DISPLAY ' PCKUT075 - DLWS019 '                       06810220
068103                     ' RETURN CODE:'     DL019-RETURN-CODE        06810321
068104                     ' SQLCODE:'         PV-DISP-SQLCODE          06810420
068105                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    06810520
068106                     '-'          DL019-CALL-MOD-FAIL-NM          06810620
068107                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     06810720
068108                     '-'          PV-DISP-SQLCODE-3               06810825
068109***                                                               06810920
068110             SET PS-ERROR-YES         TO TRUE                     06811001
068200             MOVE '8450-'             TO PV-ERROR-PARA            06820001
068300             MOVE 'INVALID ACCESS - DLKUT410'                     06830009
068400                                      TO PV-ERROR-TEXT            06840001
068500             PERFORM 9001-GENERIC-ERROR                           06850001
068600                                                                  06860001
068700                                                                  06870001
068800         WHEN OTHER                                               06880001
068810***                                                               06881020
068820*** DMH ADDED DISPLAYS - 8/21/2007                                06882020
068830***                                                               06883020
068840             MOVE  DL019-EAI-DC-NBR    TO  PV-DISP-OPER           06884020
068850             MOVE  DL019-ASGMT-SQLCODE TO  PV-DISP-SQLCODE        06885020
068851             MOVE  DL019-CALL-MOD-FAIL-SQL-CDE                    06885125
068852                                       TO  PV-DISP-SQLCODE-3      06885225
068860             DISPLAY ' PCKUT075 - 8450 - CALL TO DLKUT410 - '     06886020
068870             DISPLAY ' PCKUT075 - DLWS019 '                       06887020
068880                     ' PROCESS CODE:'   DL019-PROCESS-CDE         06888020
068890                     ' COMMIT CODE:'    DL019-COMMIT-CDE          06889020
068891                     ' CALLING PGM:'    DL019-CALLING-PGM-NM      06889120
068892                     ' USER ID:'        DL019-SIGN-ON-USR-ID      06889220
068893                     ' ASGMG WK TYP:'   DL019-ASGMT-NBR-WRK-TYP   06889320
068894             DISPLAY ' PCKUT075 - DLWS019 '                       06889420
068895                     ' WK TYP:'         DL019-EAI-WK-TYP-DESC     06889520
068896                     ' WK AREA:'        DL019-EAI-WK-AREA-DESC    06889620
068897                     ' DC:'             PV-DISP-OPER              06889720
068898                     ' CRE USR ID:'     DL019-EAI-CRE-BY-USR-ID   06889820
068899                     ' USER TYP:'       DL019-EAI-USR-TYP-CDE     06889920
068900             DISPLAY ' PCKUT075 - DLWS019 '                       06890020
068901                     ' TEAM INPT:'    DL019-EST-TEAM-INPUT-FIELDS 06890120
068902             DISPLAY ' PCKUT075 - DLWS019 '                       06890220
068903                     ' RETURN CODE:'     DL019-RETURN-CODE        06890321
068904                     ' SQLCODE:'         PV-DISP-SQLCODE          06890420
068905                     ' PARA: '    DL019-CALL-MOD-FAIL-SQL-PARA    06890520
068906                     '-'          DL019-CALL-MOD-FAIL-NM          06890620
068907                     '-'          DL019-CALL-MOD-FAIL-ERR-CDE     06890720
068908                     '-'          PV-DISP-SQLCODE-3               06890825
068909***                                                               06890920
068910             SET PS-ERROR-YES         TO TRUE                     06891001
069000             MOVE '8450-'             TO PV-ERROR-PARA            06900001
069100             STRING                                               06910001
069200                  'DLKUT410 - ERROR= '                            06920009
069300                  DL019-RETURN-CODE                               06930009
069400                  ' / MODULE= ' DL019-CALL-MOD-FAIL-NM            06940009
069500                  DELIMITED BY SIZE                               06950001
069600                                    INTO PV-ERROR-TEXT            06960001
069700             PERFORM 9001-GENERIC-ERROR                           06970001
069800     END-EVALUATE.                                                06980001
069900                                                                  06990001
070000 8451-ERROR.                                                      07000001
070100     PERFORM 9001-GENERIC-ERROR.                                  07010001
070110     MOVE  DL019-CALL-MOD-FAIL-SQL-CDE TO PV-DISP-SQLCODE-3       07011025
070200     STRING 'MODULE ERROR - '                                     07020001
070300         DL019-CALL-MOD-FAIL-SQL-PARA                             07030009
070400      ' / ' DL019-CALL-MOD-FAIL-NM                                07040009
070500      ' / '   DL019-CALL-MOD-FAIL-ERR-CDE                         07050009
070600      ' / '   PV-DISP-SQLCODE-3                                   07060025
070700         DELIMITED BY SIZE                                        07070001
070800         INTO PV-LOG-MSG.                                         07080001
070900     PERFORM 9900-WRITE-LOG.                                      07090002
071000                                                                  07100001
071100     MOVE PV-USER-ID                  TO PV-DLKUT410-USER.        07110009
071200     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO PV-DLKUT410-WK-TYP.      07120009
071300     MOVE DL011-KEY-WK-TYP            TO PV-DLKUT410-WK-TYP-DESC. 07130009
071400     MOVE DL011-P2L-MOD-WRK-AREA      TO PV-DLKUT410-WK-AREA-DESC.07140009
071500     MOVE PC246-DC-NBR                TO PV-DLKUT410-DC-NBR.      07150009
071600     MOVE PV-USER-ID                  TO PV-DLKUT410-CRE-USERID.  07160009
071700     MOVE DL019-EAI-USR-TYP-CDE       TO PV-DLKUT410-USER-TYP.    07170009
071800                                                                  07180001
071900     MOVE PV-DLKUT410-TEXT1           TO PV-LOG-MSG.              07190009
072000     PERFORM 9900-WRITE-LOG.                                      07200002
072100     MOVE PV-DLKUT410-TEXT2           TO PV-LOG-MSG.              07210009
072200     PERFORM 9900-WRITE-LOG.                                      07220002
072300                                                                  07230001
072400     PERFORM 9700-SQL-ERROR.                                      07240001
072500/                                                                 07250001
072600*8600-CALL-XLKUT067.                                              07260028
072601***                                                               07260128
072610***  IF KRPRPM-FUNC-TXT = 'Y'                                     07261028
072620***      MOVE ' PCKUT075 START 8600- PARA '     TO PV-LOG-MSG     07262028
072630***      PERFORM 9900-WRITE-LOG                                   07263028
072640***  END-IF.                                                      07264028
072650***                                                               07265028
072660***                                                               07266028
072700***  INITIALIZE XL067-USER-COMMAREA.                              07270028
072710***                                                               07271028
072720***  MOVE SPACES  TO  XL067-USER-FOUND-CODE                       07272028
072730***                   XL067-FIRST-NAME                            07273028
072740***                   XL067-LAST-NAME                             07274028
072750***                   XL067-MIDDLE-INITIAL                        07275028
072760***                   XL067-USERID                                07276028
072770***                   XL067-KEY-USER-ID.                          07277028
072780***                                                               07278028
072800***  SET XL067-BY-USER-ID                                         07280028
072900***      XL067-SELECT-BOTH-USERS      TO TRUE.                    07290028
073000***                                                               07300028
073100***  MOVE PV-USER-ID                  TO XL067-KEY-USER-ID.       07310028
073200***  MOVE 'PCKUT075'                  TO XL067-ORIG-CALLING-PGM-NM07320028
073300***                                                               07330028
073400***  CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               07340028
073410***                                                               07341028
073420***  IF KRPRPM-FUNC-TXT = 'Y'                                     07342028
073430***      MOVE SPACES TO PV-LOG-MSG                                07343028
073440***      STRING ' PCKUT075 - XL067-USER-FOUND-CODE:'              07344028
073450***           XL067-USER-FOUND-CODE      DELIMITED BY SIZE        07345028
073460***                                 INTO PV-LOG-MSG               07346028
073470***      PERFORM 9900-WRITE-LOG                                   07347028
073480***  END-IF.                                                      07348028
073500***                                                               07350028
073510***                                                               07351016
073520*** DMH ADDED ADDITIONAL DISPLAYS - 8/21/2007                     07352016
073530***                                                               07353016
073540***  EVALUATE TRUE                                                07354028
073550***      WHEN XL067-SUCCESSFUL                                    07355028
073560***          CONTINUE                                             07356028
073570***      WHEN OTHER                                               07357028
073580***           MOVE  XL067-KOHLS-SQLCODE  TO  PV-DISP-SQLCODE      07358028
073590***           MOVE  XL067-TEMP-SQLCODE   TO  PV-DISP-SQLCODE-2    07359028
073591***           DISPLAY ' PCKUT075 - CALL XLKUT067 '                07359128
073592***           DISPLAY ' XLWS067 - '                               07359228
073593***                   ' ACCESS METHOD:' XL067-ACCESS-METHOD       07359328
073594***                   ' VIEW:'          XL067-VIEW-SELECTION      07359428
073595***           DISPLAY ' XLWS067 - '                               07359528
073596***                   ' KEYS:'          XL067-KEYS                07359628
073597***                   ' RETURN CODE:'   XL067-RETURN-CODE         07359728
073598***                   ' KOHLS SQLCODE:' PV-DISP-SQLCODE           07359828
073599***                   ' TEMP SQLCODE:'  PV-DISP-SQLCODE-2         07359928
073600***           DISPLAY ' XLWS067 - '                               07360028
073601***                   ' CALLING PGM:' XL067-ORIG-CALLING-PGM-NM   07360128
073602***                   ' PARA: '  XL067-KOHLS-NOT-FOUND-NBR        07360228
073603***                   '-'        XL067-KOHLS-CONTENTION-NBR       07360328
073604***                   '-'        XL067-KOHLS-ERROR-NBR            07360428
073605***                   '-'        XL067-TEMP-NOT-FOUND-NBR         07360528
073606***                   '-'        XL067-TEMP-CONTENTION-NBR        07360628
073607***                   '-'        XL067-TEMP-ERROR-NBR             07360728
073608***                   '-'        XL067-CALL-MOD-FAIL-NM           07360828
073609***                   '-'        XL067-CALL-MOD-FAIL-ERR-CDE      07360928
073610***  END-EVALUATE.                                                07361028
073611***                                                               07361116
073620***  EVALUATE TRUE                                                07362028
073700***      WHEN XL067-SUCCESSFUL                                    07370028
073800***          CONTINUE                                             07380028
073900***      WHEN XL067-SQL-ERROR                                     07390028
074000***          SET PC246-SQL-ERROR      TO TRUE                     07400028
074100***          PERFORM 8601-ERROR                                   07410028
074200***      WHEN XL067-INVALID-ACCESS                                07420028
074300***          SET PC246-ERROR          TO TRUE                     07430028
074400***          PERFORM 8601-ERROR                                   07440028
074500***      WHEN OTHER                                               07450028
074600***          SET PC246-ERROR          TO TRUE                     07460028
074700***          PERFORM 8601-ERROR                                   07470028
074800***  END-EVALUATE.                                                07480028
074900***                                                               07490028
075000*8601-ERROR.                                                      07500028
075100***                                                               07510028
075200***  MOVE XL067-SQLCA                 TO SQLCA.                   07520028
075300***  MOVE '8601-'                     TO PV-ERROR-PARA.           07530028
075400***  STRING 'CALL XLKUT067-'                                      07540028
075500***          PC246-DC-NBR                                         07550028
075600***          '-CHK PICKERBARCODE IN PCC'                          07560028
075700***          DELIMITED BY SIZE                                    07570028
075800***     INTO PV-ERROR-TEXT.                                       07580028
075900***  PERFORM 9700-SQL-ERROR.                                      07590028
076000***                                                               07600028
076100***  MOVE PV-USER-ID                  TO PV-XLKUT067-USERID.      07610028
076200***  STRING                                                       07620028
076300***          XL067-KOHLS-NOT-FOUND-NBR                            07630028
076400***      '/' XL067-KOHLS-CONTENTION-NBR                           07640028
076500***      '/' XL067-KOHLS-ERROR-NBR                                07650028
076600***      '/' XL067-TEMP-NOT-FOUND-NBR                             07660028
076700***      '/' XL067-TEMP-CONTENTION-NBR                            07670028
076800***      '/' XL067-TEMP-ERROR-NBR                                 07680028
076900***      '/' XL067-CALL-MOD-FAIL-NM                               07690028
077000***      '/' XL067-CALL-MOD-FAIL-ERR-CDE                          07700028
077100***          DELIMITED BY SIZE                                    07710028
077200***     INTO PV-XLKUT067-RETURN-FIELDS.                           07720028
077300***                                                               07730028
077400***  MOVE PV-XLKUT067-TEXT            TO PV-LOG-MSG.              07740028
077500***  PERFORM 9900-WRITE-LOG.                                      07750028
077600***                                                               07760028
077700/                                                                 07770001
077800 9000-FORMAT-TIME.                                                07780001
077900     ACCEPT PV-CURRENT-TIME FROM TIME.                            07790001
078000     MOVE PV-CURRENT-HOUR             TO PV-FORMAT-HH.            07800001
078100     MOVE PV-CURRENT-MINUTE           TO PV-FORMAT-MM.            07810001
078200     MOVE PV-CURRENT-SECOND           TO PV-FORMAT-SS.            07820001
078300     MOVE PV-CURRENT-HUNDRETH         TO PV-FORMAT-HUND.          07830001
078400                                                                  07840001
078500 9001-GENERIC-ERROR.                                              07850001
078600     SET PC246-ERROR                  TO TRUE.                    07860001
078700     PERFORM 9000-FORMAT-TIME.                                    07870001
078800     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           07880001
078900     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              07890001
079000     PERFORM 9900-WRITE-LOG.                                      07900002
079100                                                                  07910001
079200 9700-SQL-ERROR.                                                  07920001
079300                                                                  07930001
079400     SET PC246-SQL-ERROR                                          07940001
079500         PS-ERROR-YES                 TO TRUE.                    07950001
079600     MOVE SPACES                      TO PV-LOG-MSG.              07960001
079700     PERFORM 9900-WRITE-LOG.                                      07970002
079800     PERFORM 9000-FORMAT-TIME.                                    07980001
079900     MOVE PV-FORMAT-TIME              TO PV-ERROR-TIME.           07990001
080000     MOVE PV-ERROR-MSG                TO PV-LOG-MSG.              08000001
080100     PERFORM 9900-WRITE-LOG.                                      08010002
080200                                                                  08020001
080300***  PERFORM 9800-WRITE-SQLCA.                                    08030001
080400                                                                  08040001
080500                                                                  08050001
080600 9800-WRITE-SQLCA.                                                08060001
080700*                                                                 08070001
080800**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               08080001
080900*                                                                 08090001
081000     CALL 'DSNTIAR' USING SQLCA                                   08100001
081100                          DP004-FORMATTED-MESSAGE                 08110001
081200                          DP004-ERROR-LINE-LENGTH.                08120001
081300*                                                                 08130001
081400     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              08140001
081500     PERFORM 9900-WRITE-LOG.                                      08150002
081600                                                                  08160001
081700     PERFORM                                                      08170001
081800         VARYING DP004-MSG-IDX                                    08180001
081900         FROM 1 BY 1                                              08190001
082000         UNTIL DP004-MSG-IDX > DP004-MAX-MESSAGE-LINES            08200001
082100             MOVE DP004-MESSAGE-LINE (DP004-MSG-IDX)              08210001
082200                                      TO PV-LOG-MSG               08220001
082300             PERFORM 9900-WRITE-LOG                               08230002
082400     END-PERFORM.                                                 08240001
082500                                                                  08250001
082600     MOVE DP004-ASTERISK-LINE         TO PV-LOG-MSG.              08260001
082700     PERFORM 9900-WRITE-LOG.                                      08270002
082800                                                                  08280001
082900 9900-WRITE-LOG.                                                  08290002
083000                                                                  08300001
083100     DISPLAY PV-LOG-MSG.                                          08310002
083200     MOVE SPACES                      TO PV-LOG-MSG.              08320001
083300                                                                  08330001
083400                                                                  08340001
083500 9999-RETURN.                                                     08350001
083600                                                                  08360001
083700     GOBACK.                                                      08370001
