      ***************************************************************** 00010000
       IDENTIFICATION DIVISION.                                         00020000
      ***************************************************************** 00030000
      *                                                                 00040000
       PROGRAM-ID.             SUKRP065.                                00050000
       AUTHOR.                 DAVE WELLER.                             00060000
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
       DATE-WRITTEN.           AUGUST 2012.                             00080000
       DATE-COMPILED.                                                   00090000
      *                                                                 00100000
111912***************************************************************** 00110044
111912*                                                                 00120044
111912******************************************************************00130044
111912*  MODULE TYPE: COBOL2 DB2 BATCH                                  00140044
111912*                                                                 00150044
111912*  DESCRIPTION:                                                   00160044
111912*                                                                 00170044
111912*  THIS PROGRAM WILL TAKE THE OUTPUT FILE FROM SUKUT153 AFTER IT  00180044
      *  HAS BEEN SORTED AND USE IT TO CREATE THE HOURLY MANIFEST       00190044
      *  PRICING REPORT.                                                00200044
000400*                                                                 00210044
111912*========================== CHANGE LOG ===========================00220044
111912*  BY        DATE     #                DESCRIPTION                00230044
111912*=================================================================00240044
111912*  C.PARMLEY 11-19-12 CRQ000000037068  ADDED DEPT AND DESC TO     00250044
111912*                                      REPORT, REPORT WILL ALSO   00260048
111912*                                      DISPLAY A NO P/C LINE WHEN 00270048
111912*                                      NO PRICE CHANGES FOR A     00280048
111912*                                      STORE.                     00290048
111912******************************************************************00300044
       ENVIRONMENT DIVISION.                                            00310000
      ***************************************************************** 00320000
       CONFIGURATION SECTION.                                           00330000
       SOURCE-COMPUTER.                        IBM-3090.                00340000
       OBJECT-COMPUTER.                        IBM-3090.                00350000
       INPUT-OUTPUT SECTION.                                            00360000
       FILE-CONTROL.                                                    00370000
                                                                        00380000
           SELECT INPUT-FILE                                            00390000
               ASSIGN TO INP01.                                         00400000
                                                                        00410000
           SELECT REPORT-FILE-1                                         00420000
               ASSIGN TO RPT01.                                         00430000
      ***************************************************************** 00440000
       DATA DIVISION.                                                   00450000
      ***************************************************************** 00460000
       FILE SECTION.                                                    00470000
                                                                        00480000
       FD  INPUT-FILE                                                   00490000
           RECORDING MODE IS F                                          00500000
           LABEL RECORDS ARE STANDARD                                   00510000
           BLOCK CONTAINS 0 RECORDS.                                    00520000
       01  INPUT-RECORD                     PIC X(200).                 00530008
                                                                        00540000
       FD  REPORT-FILE-1                                                00550000
           RECORDING MODE IS F                                          00560000
           BLOCK CONTAINS 0 RECORDS                                     00570014
           LABEL RECORDS ARE OMITTED                                    00580014
           DATA RECORD IS REPORT-RECORD-1.                              00590014
       01  REPORT-RECORD-1                  PIC X(133).                 00600001
                                                                        00610000
      ***************************************************************** 00620000
       WORKING-STORAGE SECTION.                                         00630000
      ***************************************************************** 00640000
                                                                        00650000
       01  PS-SWITCHES.                                                 00660000
           05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00670000
               88  PS-PRINT-DETAILS-NO                VALUE 'Y'.        00680000
               88  PS-PRINT-DETAILS                   VALUE 'N'.        00690000
           05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00700000
               88  PS-END-OF-INPUT                    VALUE 'Y'.        00710000
               88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00720000
           05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00730000
               88  PS-NEW-PAGE                        VALUE 'Y'.        00740000
               88  PS-SAME-PAGE                       VALUE 'N'.        00750000
           05  PS-AUTO-RECEIVER-SW          PIC X(01) VALUE 'N'.        00760000
               88  PS-AUTO-RECEIVER                   VALUE 'Y'.        00770000
               88  PS-AUTO-RECEIVER-NO                VALUE 'N'.        00780000
       01  SD-SYSTEM-DATE.                                              00790000
           05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00800000
           05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00810000
           05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00820000
                                                                        00830000
       01  ST-SYSTEM-TIME.                                              00840000
           05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00850000
           05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00860000
           05  FILLER                     PIC  9(04)   VALUE ZERO.      00870000
                                                                        00880000
       01  PV-VARIABLES.                                                00890000
           05  PV-READ-COUNT                PIC S9(7) COMP-3            00900000
                                                      VALUE ZERO.       00910000
           05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00920000
                                                      VALUE ZERO.       00930000
           05  PV-PAGE-COUNT                PIC S9(3) COMP-3            00940000
                                                      VALUE ZERO.       00950000
           05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       00960000
                                                       COMP SYNC.       00970000
           05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00980000
           05  PV-PREV-LOC                  PIC 9(04) COMP.             00990001
           05  PV-PREV-TRIP-ID              PIC S9(09) COMP.            01000001
           05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01010000
                                                                        01020000
           05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01030000
           05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01040000
           05  PV-ERROR-MESSAGE-1           PIC X(60) VALUE SPACES.     01050000
           05  PV-ERROR-MESSAGE-2           PIC X(60) VALUE SPACES.     01060000
                                                                        01070000
      ******************************************************************01080000
       01  PV-DATE-FIELD.                                               01090000
           05  PV-DB2-TMST.                                             01100000
               10 PV-DB2-TMST-CCYY          PIC  9(04).                 01110000
               10 FILLER                    PIC  X(01).                 01120000
               10 PV-DB2-TMST-MM            PIC  9(02).                 01130000
               10 FILLER                    PIC  X(01).                 01140000
               10 PV-DB2-TMST-DD            PIC  9(02).                 01150000
               10 FILLER                    PIC  X(01).                 01160000
               10 PV-DB2-TMST-HH            PIC  9(02).                 01170000
               10 FILLER                    PIC  X(01).                 01180000
               10 PV-DB2-TMST-MN            PIC  9(02).                 01190000
               10 FILLER                    PIC  X(01).                 01200000
               10 PV-DB2-TMST-SS            PIC  9(02).                 01210000
               10 FILLER                    PIC  X(07).                 01220000
           05  PV-FORMAT-DATE.                                          01230000
               10 PV-FORMAT-DATE-MM         PIC  9(02).                 01240000
               10 FILLER                    PIC  X(01) VALUE '/'.       01250000
               10 PV-FORMAT-DATE-DD         PIC  9(02).                 01260000
               10 FILLER                    PIC  X(01) VALUE '/'.       01270000
               10 PV-FORMAT-DATE-YY         PIC  9(02).                 01280000
                                                                        01290000
           05  PV-DB2-TMST-1.                                           01300000
               10  PV-DB2-DATE-1                PIC X(10) VALUE SPACES. 01310000
               10  FILLER                       PIC X(16) VALUE         01320000
                                    '-00.00.00.000000'.                 01330000
           05  PV-DB2-TMST-2.                                           01340000
               10  PV-DB2-DATE-2                PIC X(10) VALUE SPACES. 01350000
               10  FILLER                       PIC X(16) VALUE         01360000
                                    '-23.59.59.999999'.                 01370000
           05  PV-DB2-DATE.                                             01380000
               10  PV-DB2-DATE-CC          PIC X(02) VALUE ZERO.        01390000
               10  PV-DB2-DATE-YY          PIC X(02) VALUE ZERO.        01400000
               10  FILLER                  PIC X(01) VALUE ZERO.        01410000
               10  PV-DB2-DATE-MM          PIC X(02) VALUE ZERO.        01420000
               10  FILLER                  PIC X(01) VALUE ZERO.        01430000
               10  PV-DB2-DATE-DD          PIC X(02) VALUE ZERO.        01440000
                                                                        01450000
                                                                        01460000
       01  PV-ABEND-FIELDS.                                             01470000
           05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01480000
                                                       COMP SYNC.       01490000
           05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT045'.01500000
           05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01510000
           05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    01520000
           05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01530000
           05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01540000
           05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01550000
       01  PC-CONSTANTS.                                                01560000
           05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP065'. 01570000
           05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         01580000
                                                      COMP-3.           01590000
      ******************************************************************01600000
      *  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01610000
      ******************************************************************01620000
           COPY DPWS132O.                                               01630000
      *                                                                 01640000
                                                                        01650000
       01  HL-HEADING-LINE-2.                                           01660000
           05  FILLER                      PIC  X(54)  VALUE SPACE.     01670001
           05  FILLER                      PIC  X(28)  VALUE            01680000
                  'MANIFEST PRICE CHANGE REPORT'.                       01690001
           05  FILLER                      PIC  X(50)  VALUE SPACE.     01700001
                                                                        01710000
       01  HL-HEADING-LINE-3.                                           01720000
           05  FILLER                      PIC  X(04)  VALUE SPACE.     01730001
           05  FILLER                      PIC  X(14)  VALUE            01740000
                  'STORE NUMBER: '.                                     01750000
           05  HL3-LOC-NBR                 PIC  9999.                   01760015
           05  FILLER                      PIC  X(02)  VALUE SPACE.     01770007
           05  HL3-LOC-NM                  PIC  X(20).                  01780006
           05  FILLER                      PIC  X(11)  VALUE SPACE.     01790006
                                                                        01800000
       01  HL-HEADING-LINE-4.                                           01810000
           05  FILLER                      PIC  X(12)  VALUE SPACE.     01820001
           05  FILLER                      PIC  X(06)  VALUE            01830000
                  'SCAC: '.                                             01840000
           05  HL4-SCAC                    PIC  X(4).                   01850001
           05  FILLER                      PIC  X(110) VALUE SPACE.     01860001
                                                                        01870000
       01  HL-HEADING-LINE-5.                                           01880000
           05  FILLER                      PIC  X(06)  VALUE SPACE.     01890001
           05  FILLER                      PIC  X(12)  VALUE            01900000
                  'TRAILER ID: '.                                       01910000
           05  HL5-TRLR-ID                 PIC  X(12).                  01920004
           05  FILLER                      PIC  X(102) VALUE SPACE.     01930004
                                                                        01940000
       01  HL-HEADING-LINE-6.                                           01950000
           05  FILLER                      PIC  X(02)  VALUE SPACE.     01960001
           05  FILLER                      PIC  X(16)  VALUE            01970000
                  'TRAILER SERIAL: '.                                   01980000
           05  HL6-TRLR-SRL                PIC  X(10).                  01990000
           05  FILLER                      PIC  X(100) VALUE SPACE.     02000001
                                                                        02010000
       01  HL-HEADING-LINE-7.                                           02020000
           05  FILLER                      PIC  X(24)  VALUE            02030000
              'DEPT                    '.                               02040034
111912     05  FILLER                      PIC  X(30)  VALUE            02050031
111912         '    SKU                       '.                        02060039
           05  FILLER                      PIC  X(21)  VALUE SPACE.     02070037
           05  FILLER                      PIC  X(39)  VALUE            02080001
              'OLD       NEW        EFF          PRICE'.                02090001
           05  FILLER                      PIC  X(14)  VALUE            02100001
              '    PRICE  QTY'.                                         02110001
           05  FILLER                      PIC  X(10)  VALUE SPACE.     02120001
                                                                        02130000
       01  HL-HEADING-LINE-8.                                           02140000
111912     05  FILLER                      PIC  X(30)  VALUE            02150028
111912        'NBR    DESCRIPTION          NB'.                         02160039
111912     05  FILLER                      PIC  X(30)  VALUE            02170026
111912         'R            DESCRIPTION     '.                         02180039
111912     05  FILLER                      PIC  X(15)  VALUE SPACE.     02190037
           05  FILLER                      PIC  X(41)  VALUE            02200001
              'PRICE     PRICE      DATE         CHG ID'.               02210001
           05  FILLER                      PIC  X(13)  VALUE            02220001
              ' CHG TYP SHPT'.                                          02230001
           05  FILLER                      PIC  X(10)  VALUE SPACE.     02240001
                                                                        02250000
       01  HL-HEADING-LINE-9.                                           02260001
           05  FILLER                      PIC  X(24)  VALUE            02270000
111912        '----   -----------------'.                               02280039
111912     05  FILLER                      PIC  X(19)  VALUE            02290042
111912        '--- -----------    '.                                    02300042
111912     05  FILLER                      PIC  X(08)  VALUE            02310026
111912        '--------'.                                               02320036
111912     05  FILLER                      PIC  X(24)  VALUE            02330040
111912        '---------------------   '.                               02340040
           05  FILLER                      PIC  X(42)  VALUE            02350001
              '--------  ---------  ----------   ------'.               02360001
           05  FILLER                      PIC  X(22)  VALUE            02370001
              '------- -----'.                                          02380001
           05  FILLER                      PIC  X(10)  VALUE SPACE.     02390003
                                                                        02400000
       01  ER-END-OF-REPORT-LINE.                                       02410000
           05  FILLER                       PIC X(20)  VALUE            02420012
               ' ** END OF REPORT **'.                                  02430012
           05  FILLER                       PIC X(112)  VALUE SPACES.   02440012
                                                                        02450000
       01  EP-EMPTY-REPORT-LINE.                                        02460000
           05  FILLER                       PIC X(34)  VALUE SPACES.    02470000
           05  FILLER                       PIC X(52)  VALUE            02480000
            '*************** EMPTY INPUT FILE *******************'.     02490000
           05  FILLER                       PIC X(49)  VALUE SPACES.    02500000
                                                                        02510000
       01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    02520000
                                                                        02530000
                                                                        02540000
       01  DL-DETAIL-LINE-1.                                            02550000
           05  DL-DETAIL-L1.                                            02560000
111912        10  DL1-DEPT-NBR                 PIC ZZZZ.                02570045
111912        10  FILLER                       PIC X(03) VALUE SPACES.  02580043
111912        10  DL1-DEPT-NM                  PIC X(20) VALUE SPACES.  02590043
111912        10  FILLER                       PIC X(01) VALUE SPACES.  02600040
111912        10  DL1-SKU-NBR                  PIC X(10) VALUE SPACES.  02610034
111912        10  FILLER                       PIC X(05) VALUE SPACES.  02620040
111912        10  DL1-SKU-DESC                 PIC X(30) VALUE SPACES.  02630034
111912        10  FILLER                       PIC X(02) VALUE SPACES.  02640023
111912        10  DL1-PREV-PRC                 PIC Z(05).ZZ.            02650048
              10  FILLER                       PIC X(02) VALUE SPACES.  02660001
111912        10  DL1-CURR-PRC                 PIC Z(05).ZZ.            02670048
              10  FILLER                       PIC X(03) VALUE SPACES.  02680001
              10  DL1-EFF-DTE                  PIC X(10).               02690000
              10  FILLER                       PIC X(02) VALUE SPACES.  02700001
111912        10  DL1-PRCHG-ID                 PIC ZZZZZZZ.             02710048
              10  FILLER                       PIC X(02) VALUE SPACES.  02720005
              10  DL1-PRC-CHG-TYP              PIC X(7)  VALUE SPACES.  02730005
              10  FILLER                       PIC X(01) VALUE SPACES.  02740005
111912        10  DL1-QTY-SHPT                 PIC Z(04)Z.              02750048
              10  FILLER                       PIC X(01) VALUE SPACES.  02760000
                                                                        02770000
      ******************************************************************02780000
      *  RECORD LAYOUT FOR INPUT FILE                                   02790000
      ******************************************************************02800000
           COPY SURD105.                                                02810001
                                                                        02820009
     *     EXEC SQL                                                     02830019
     *         INCLUDE SUT00095                                         02840019
     *     END-EXEC.                                                    02850019
                                                                        02860000
      ******************************************************************02870000
      *  COPYBOOK USED BY MBS SYSTEM                                    02880000
      ******************************************************************02890000
           COPY DPWS003.                                                02900000
      *                                                                 02910000
      ******************************************************************02920000
      *  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 02930000
      ******************************************************************02940000
           COPY DPWS024.                                                02950000
                                                                        02960000
      ******************************************************************02970000
      * CORPORATE DATE ROUTINES                                         02980000
      ******************************************************************02990000
           COPY DPWS500.                                                03000000
                                                                        03010000
      ******************************************************************03020000
       PROCEDURE DIVISION.                                              03030000
      ******************************************************************03040000
       0000-MAINLINE.                                                   03050000
                                                                        03060000
           OPEN INPUT  INPUT-FILE                                       03070000
                OUTPUT REPORT-FILE-1.                                   03080000
                                                                        03090000
           PERFORM 2100-READ-INPUT.                                     03100001
           PERFORM 1000-INITIALIZE.                                     03110000
           IF PS-END-OF-INPUT                                           03120000
111912         CONTINUE                                                 03130049
           ELSE                                                         03140000
               PERFORM 8000-WRITE-MAIN-HEADINGS                         03150000
               PERFORM 2000-PROCESS-INPUT                               03160001
                   UNTIL PS-END-OF-INPUT                                03170000
           END-IF.                                                      03180000
                                                                        03190000
           PERFORM 9000-EOJ.                                            03200000
                                                                        03210000
           GOBACK.                                                      03220000
                                                                        03230000
      ******************************************************************03240000
       1000-INITIALIZE.                                                 03250000
      ******************************************************************03260000
      *                                                                 03270000
      * LOAD SYSTEM DATE INTO HEADINGS                                  03280000
           ACCEPT SD-SYSTEM-DATE FROM DATE.                             03290000
           ACCEPT ST-SYSTEM-TIME FROM TIME.                             03300000
                                                                        03310000
           MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03320002
           MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03330002
           MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03340002
           MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03350002
           MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03360002
                                                                        03370000
           MOVE PC-CURRENT-PROGRAM-NAME                                 03380000
                                       TO DP132O-PROGRAM-NAME.          03390000
           MOVE 1                      TO DP132O-REPORT-NUMBER          03400000
                                          DP132O-PAGE-NUMBER.           03410000
                                                                        03420000
           MOVE SU105-LOC-NBR          TO PV-PREV-LOC.                  03430001
           MOVE SU105-OTBND-TRIP-ID    TO PV-PREV-TRIP-ID.              03440001
                                                                        03450000
      *                                                                 03460000
      ******************************************************************03470000
       2000-PROCESS-INPUT.                                              03480001
      ******************************************************************03490000
      *                                                                 03500000
           IF SU105-LOC-NBR  = PV-PREV-LOC                              03510001
             AND SU105-OTBND-TRIP-ID = PV-PREV-TRIP-ID                  03520001
                  PERFORM 5500-BUILD-REPORT-ROW                         03530000
           ELSE                                                         03540000
      * IF THE LOC-NBR CHANGES, IT'S END-OF-REPORT FOR THIS LOC.        03550013
               IF SU105-LOC-NBR NOT = PV-PREV-LOC                       03560013
                   WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE     03570013
                       AFTER ADVANCING 2 LINES                          03580013
               END-IF                                                   03590013
      * EACH TIME A STORE OR TRUCK CHANGES THE PAGE NBR IS RESET        03600013
               MOVE 0                     TO PV-PAGE-COUNT              03610002
               SET PS-NEW-PAGE TO TRUE                                  03620000
               PERFORM 8000-WRITE-MAIN-HEADINGS                         03630000
               SET PS-SAME-PAGE TO TRUE                                 03640001
               PERFORM 5500-BUILD-REPORT-ROW                            03650001
               MOVE SU105-OTBND-TRIP-ID   TO PV-PREV-TRIP-ID            03660001
               MOVE SU105-LOC-NBR         TO PV-PREV-LOC                03670001
           END-IF.                                                      03680000
                                                                        03690000
           PERFORM 2100-READ-INPUT.                                     03700001
      *                                                                 03710000
      ******************************************************************03720000
      *  READ NEXT INPUT FILE RECORD.                                   03730000
      ******************************************************************03740000
       2100-READ-INPUT.                                                 03750001
                                                                        03760000
           READ INPUT-FILE INTO SU105-INPUT-RECORD                      03770001
              AT END                                                    03780000
                 SET PS-END-OF-INPUT TO TRUE                            03790000
              NOT AT END                                                03800000
                 ADD +1                   TO PV-READ-COUNT              03810000
           END-READ.                                                    03820000
      *                                                                 03830000
      ******************************************************************03840000
      *  PRINT DETAIL REPORT LINE.                                      03850000
      ******************************************************************03860000
       3000-PRINT-DETAILS.                                              03870000
      *                                                                 03880000
      *CHECK FOR OVERFLOW.                                              03890000
           ADD 1 TO PV-LINE-COUNT.                                      03900000
           IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         03910000
               SET PS-NEW-PAGE TO TRUE                                  03920000
               PERFORM 8000-WRITE-MAIN-HEADINGS                         03930000
           END-IF.                                                      03940000
                                                                        03950000
                                                                        03960000
      *WRITE DETAIL LINE.                                               03970000
                   WRITE REPORT-RECORD-1                                03980000
                     FROM DL-DETAIL-LINE-1                              03990000
                       AFTER ADVANCING 1 LINES.                         04000000
      *                                                                 04010000
      ******************************************************************04020000
      *  BUILD REPORT ROW.                                              04030000
      ******************************************************************04040000
       5500-BUILD-REPORT-ROW.                                           04050000
      *                                                                 04060000
           MOVE  SU105-SKU-NBR             TO DL1-SKU-NBR.              04070001
           MOVE  SU105-PRIC-EFF-STRT-DTE   TO DL1-EFF-DTE.              04080001
           MOVE  SU105-PREV-UNT-RTL-AMT    TO DL1-PREV-PRC.             04090001
           MOVE  SU105-UNT-RTL-AMT         TO DL1-CURR-PRC.             04100001
           MOVE  SU105-PRCHG-ID            TO DL1-PRCHG-ID.             04110001
           IF SU105-PRCHG-TYP-CDE  = 'MDA'                              04120016
             MOVE 'MRK DN'                 TO DL1-PRC-CHG-TYP           04130016
           ELSE                                                         04140001
           IF SU105-PRCHG-TYP-CDE  = 'MUA'                              04150005
             MOVE 'MRK UP'                 TO DL1-PRC-CHG-TYP           04160016
           ELSE                                                         04170005
           IF SU105-PRCHG-TYP-CDE  = 'RCP'                              04180005
             MOVE '1ST CLR'                TO DL1-PRC-CHG-TYP           04190005
           ELSE                                                         04200005
           IF SU105-PRCHG-TYP-CDE  = 'MK2'                              04210005
             MOVE 'ADD CLR'                TO DL1-PRC-CHG-TYP           04220005
           ELSE                                                         04230005
           IF SU105-PRCHG-TYP-CDE  = 'CTA'                              04240016
             MOVE 'CLR ACT'                TO DL1-PRC-CHG-TYP           04250016
           ELSE                                                         04260016
           IF SU105-PRCHG-TYP-CDE  = 'CLR'                              04270016
             MOVE 'CLRNCE '                TO DL1-PRC-CHG-TYP           04280016
           ELSE                                                         04290016
           IF SU105-PRCHG-TYP-CDE  = 'FNL'                              04300016
             MOVE 'FINAL  '                TO DL1-PRC-CHG-TYP           04310016
           ELSE                                                         04320016
           IF SU105-PRCHG-TYP-CDE  = 'CON'                              04330016
             MOVE 'CON CLR'                TO DL1-PRC-CHG-TYP           04340016
           ELSE                                                         04350016
111912       IF SU105-SKU-DESC    = 'NO P/C ITEMS ON TRAILER'           04360046
111912           MOVE SPACE                TO DL1-PRC-CHG-TYP           04370045
111912                                        DL1-SKU-NBR               04380047
             ELSE                                                       04390045
                 MOVE 'INV TYP'            TO DL1-PRC-CHG-TYP           04400045
111912       END-IF                                                     04410045
           END-IF.                                                      04420045
           MOVE  SU105-SKU-DESC            TO DL1-SKU-DESC.             04430001
           MOVE  SU105-SUMMED-UNT-QTY      TO DL1-QTY-SHPT.             04440001
111912     MOVE  SU105-DEPT-NBR            TO DL1-DEPT-NBR.             04450024
111912     MOVE  SU105-DEPT-NM             TO DL1-DEPT-NM.              04460025
                                                                        04470000
           PERFORM 3000-PRINT-DETAILS.                                  04480000
      *                                                                 04490000
      ******************************************************************04500000
       8000-WRITE-MAIN-HEADINGS.                                        04510000
      ******************************************************************04520000
      *                                                                 04530000
           ADD 1                         TO PV-PAGE-COUNT.              04540000
           MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         04550000
           MOVE ZERO                     TO PV-LINE-COUNT.              04560000
           MOVE SU105-LOC-NBR            TO HL3-LOC-NBR.                04570001
           MOVE SU105-LOC-NM             TO HL3-LOC-NM.                 04580006
           MOVE SU105-SCAC-CDE           TO HL4-SCAC.                   04590001
           MOVE SU105-TRLR-ID            TO HL5-TRLR-ID.                04600001
           MOVE SU105-TRLR-SRL-NBR       TO HL6-TRLR-SRL.               04610001
                                                                        04620000
           WRITE REPORT-RECORD-1 FROM                                   04630000
               DP132O-STANDRD-HEADER-132-COLS                           04640000
               AFTER ADVANCING PAGE.                                    04650000
                                                                        04660000
           WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     04670000
               AFTER ADVANCING 1 LINE                                   04680000
                                                                        04690000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2                 04700001
              AFTER ADVANCING 1 LINES.                                  04710001
                                                                        04720001
           WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     04730000
               AFTER ADVANCING 1 LINE                                   04740000
                                                                        04750000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3                 04760001
              AFTER ADVANCING 1 LINES.                                  04770000
                                                                        04780000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4                 04790001
              AFTER ADVANCING 1 LINES.                                  04800000
                                                                        04810000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-5                 04820001
              AFTER ADVANCING 1 LINES.                                  04830000
                                                                        04840000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-6                 04850001
              AFTER ADVANCING 1 LINES.                                  04860000
                                                                        04870000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-7                 04880001
              AFTER ADVANCING 1 LINES.                                  04890000
                                                                        04900000
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-8                 04910001
              AFTER ADVANCING 1 LINES.                                  04920000
                                                                        04930001
           WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-9                 04940001
              AFTER ADVANCING 1 LINES.                                  04950001
                                                                        04960001
           ADD 11                           TO PV-LINE-COUNT.           04970000
      *                                                                 04980000
      ******************************************************************04990000
       9000-EOJ.                                                        05000000
      ******************************************************************05010000
      *                                                                 05020000
           WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             05030000
              AFTER ADVANCING 2 LINES                                   05040000
                                                                        05050000
      *CLOSE FILES.                                                     05060000
           CLOSE INPUT-FILE                                             05070000
                                                                        05080000
           CLOSE REPORT-FILE-1                                          05090000
                                                                        05100000
                                                                        05110000
           MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 05120000
           DISPLAY 'TOTAL INPUT RECORDS READ ' PV-DISPLAY-COUNT.        05130000
                                                                        05140000
      *                                                                 05150000
