000100***************************************************************** 02/14/96
000200 IDENTIFICATION DIVISION.                                         FSKUT130
000300*****************************************************************    LV001
000400                                                                  FSKUT130
000500 PROGRAM-ID.             FSKUT130.                                FSKUT130
000600 AUTHOR.                 BOB FORD.                                FSKUT130
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 FSKUT130
000800 DATE-WRITTEN            11-08-2004.                              FSKUT130
000900 DATE-COMPILED.                                                   FSKUT130
001000                                                                  FSKUT130
001100***************************************************************** FSKUT130
001400*  THIS PROGRAM CREATES THE DATE PORTION OF THE 'WHERE' CLAUSE  * FSKUT130
001500*  FOR THE UNLOAD OF TUPC.                                   *    FSKUT130
001600***************************************************************** FSKUT130
002000* CHANGED 11/06/2004 BY BOB FORD                                  FSKUT130
002100*   WR# WR26357                                                   FSKUT130
002200*         NEW PROGRAM                                             FSKUT130
002500***************************************************************** FSKUT130
002600 ENVIRONMENT DIVISION.                                            FSKUT130
002700***************************************************************** FSKUT130
002800                                                                  FSKUT130
002900 CONFIGURATION SECTION.                                           FSKUT130
003000                                                                  FSKUT130
003100 SOURCE-COMPUTER.        IBM-3090.                                FSKUT130
003200 OBJECT-COMPUTER.        IBM-3090.                                FSKUT130
003300                                                                  FSKUT130
003400 INPUT-OUTPUT SECTION.                                            FSKUT130
003500                                                                  FSKUT130
003600 FILE-CONTROL.                                                    FSKUT130
003700*                                                                 FSKUT130
006300     SELECT DATE-CARD-FILE1       ASSIGN   TO  OUT01.                     
006400*                                                                         
004500***************************************************************** FSKUT130
004600 DATA DIVISION.                                                   FSKUT130
004700***************************************************************** FSKUT130
004800*                                                                 FSKUT130
004900 FILE SECTION.                                                    FSKUT130
005000*                                                                 FSKUT130
007800 FD  DATE-CARD-FILE1                                                      
007900     LABEL RECORDS ARE STANDARD                                           
008000     RECORDING MODE IS F                                                  
008200     BLOCK CONTAINS 0 RECORDS.                                            
008300 01  DATE-CARD-REC1                  PIC  X(80).                          
008400*                                                                         
006300 WORKING-STORAGE SECTION.                                         FSKUT130
006400*                                                                 FSKUT130
006500 01  FILLER.                                                      FSKUT130
006600     05  FILLER                      PIC  X(36)    VALUE          FSKUT130
006700         ' ***** WORKING STORAGE PGM=FSKUT130 '.                  FSKUT130
007400 EJECT                                                            FSKUT130
004200*                                                                         
017200 01  CC-DATES.                                                            
017300     05  CC-PRCG-DATE                  PIC X(10).                         
017410     05  FILLER                        PIC X(70).                         
017700                                                                          
008200 01  PC-CONSTANTS.                                                FSKUT130
012500     05  PC-N                        PIC  X(01)  VALUE 'N'.       FSKUT130
006100     05  PC-PROGRAM-NAME         PIC X(8)     VALUE 'FSKUT130'.           
014800 EJECT                                                            FSKUT130
014900*                                                                 FSKUT130
021600 01  OUTPUT-REC1.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(22) VALUE                       
                                          'AND ((EFF_BEG_DTE <= '''.            
021800     05 OR1-PRCG-DTE                 PIC X(10).                           
021800     05 FILLER                      PIC X(1)  VALUE ''''.                 
021800     05 FILLER                      PIC X(1)  VALUE ')'.                  
021800     05 FILLER                      PIC X(28) VALUE SPACE.                
014900*                                                                 FSKUT130
021600 01  OUTPUT-REC2.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(22) VALUE                       
                                          'AND ((EFF_END_DTE >= '''.            
021800     05 OR2-PRCG-DTE                 PIC X(10).                           
021800     05 FILLER                      PIC X(1)  VALUE ''''.                 
021800     05 FILLER                      PIC X(1)  VALUE ')'.                  
021800     05 FILLER                      PIC X(28) VALUE SPACE.                
014900*                                                                 FSKUT130
021600 01  OUTPUT-REC3.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(29) VALUE                       
                                     ' OR  (EFF_END_DTE  IS NULL)))'.           
021800     05 FILLER                      PIC X(33) VALUE SPACE.                
006200*                                                                 FSKUT130
021600 01  OUTPUT-REC4.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(33) VALUE                       
                           'AND A.INTR_UPC_ID = B.INTR_UPC_ID'.                 
021800     05 FILLER                      PIC X(29) VALUE SPACE.                
006200*                                                                 FSKUT130
021600 01  OUTPUT-REC5.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(33) VALUE                       
                           'AND B.SKU_STAT_CDE NOT IN (''98'') '.               
021800     05 FILLER                      PIC X(29) VALUE SPACE.                
006200*                                                                 FSKUT130
021600 01  OUTPUT-REC6.                                                         
021800     05 FILLER                      PIC X(18) VALUE SPACE.                
021700     05 FILLER                      PIC X(22) VALUE                       
                           'ORDER BY A.INTR_UPC_ID'.                            
021800     05 FILLER                      PIC X(01) VALUE ';'.                  
021800     05 FILLER                      PIC X(39) VALUE SPACE.                
006200*                                                                 FSKUT130
023601     COPY DPWS500.                                                        
023602*                                                                         
027500 EJECT                                                                    
020400*                                                                 FSKUT130
021300***************************************************************** FSKUT130
021400*PROCEDURE DIVISION.                                              FSKUT130
021500***************************************************************** FSKUT130
021600 PROCEDURE DIVISION.                                              FSKUT130
021700*                                                                 FSKUT130
021800 A000-MAINLINE-PROCESSING.                                        FSKUT130
021900*                                                                 FSKUT130
022000     PERFORM A100-INITIALIZATION.                                 FSKUT130
022100*                                                                 FSKUT130
022100     MOVE CC-PRCG-DATE TO OR1-PRCG-DTE,                           FSKUT130
022100                          OR2-PRCG-DTE.                           FSKUT130
022100*                                                                 FSKUT130
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC1.                               
129300     DISPLAY 'DATE CARD1 = ' OUTPUT-REC1.                                 
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC2.                               
129300     DISPLAY 'DATE CARD2 = ' OUTPUT-REC2.                                 
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC3.                               
129300     DISPLAY 'DATE CARD3 = ' OUTPUT-REC3.                                 
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC4.                               
129300     DISPLAY 'DATE CARD4 = ' OUTPUT-REC4.                                 
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC5.                               
129300     DISPLAY 'DATE CARD5 = ' OUTPUT-REC5.                                 
129300     WRITE DATE-CARD-REC1 FROM OUTPUT-REC6.                               
129300     DISPLAY 'DATE CARD6 = ' OUTPUT-REC6.                                 
022300*                                                                 FSKUT130
022400     PERFORM Y100-END-ROUTINE.                                    FSKUT130
022500*                                                                 FSKUT130
022600     GOBACK.                                                      FSKUT130
022700*                                                                 FSKUT130
022800 EJECT                                                            FSKUT130
022900******************************************************************FSKUT130
023000** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 FSKUT130
023100** CALL CALENDAR ROUTINES TO RETRIEVE VALUES NEEDED IN PROGRAM    FSKUT130
023200******************************************************************FSKUT130
023300 A100-INITIALIZATION.                                             FSKUT130
023400*                                                                 FSKUT130
023500     OPEN  OUTPUT DATE-CARD-FILE1                                 FSKUT130
019200     INITIALIZE OUTPUT-REC1                                               
019200                OUTPUT-REC2                                               
019200                OUTPUT-REC3.                                              
           ACCEPT CC-DATES.                                                     
           DISPLAY 'CC-PRCG-DTE = ' CC-PRCG-DATE.                               
023700*                                                                 FSKUT130
027500 EJECT                                                            FSKUT130
051900******************************************************************FSKUT130
052000*   CLOSES FILES AND DISPLAYS MESSAGES.                          *FSKUT130
052100******************************************************************FSKUT130
052200 Y100-END-ROUTINE.                                                FSKUT130
052300*                                                                 FSKUT130
052400     CLOSE  DATE-CARD-FILE1.                                      FSKUT130
222900     DISPLAY '*******************************************'                
222800     DISPLAY '**  FSKUT130 COMPLETE **'.                                  
052500*                                                                 FSKUT130
052600 EJECT                                                            FSKUT130
224000*****************************************************************         
