000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKCS098.                                         00020000
000300 AUTHOR.        CHRIS KUNSTMANN.                                  00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  09/99.                                            00050000
000600 DATE-COMPILED.                                                   00060000
000700*---------------------------------------------------------------* 00070000
000800*    W098 - INNER PREPACK INQUIRY PROGRAM                         00080000
000900*---------------------------------------------------------------* 00090000
001000*                                                               * 00100000
001100*    THIS PROGRAM DISPLAYS ALL PACK DATA FOR A GIVEN PO NBR.    * 00110000
001200*    F7/F8 TO SCROLL THROUGH LINES IN A PACK, IN CASE IT        * 00120000
001300*    DOESN'T FIT ON ONE SCREEN. F19/F20 TO SCROLL FROM PACK TO  * 00130000
001400*    PACK FOR A SPECIFIC PO.                                    * 00140000
001500*                                                               * 00150000
001600*---------------------------------------------------------------* 00160000
W24803******************************************************************00170000
W24803* 04/25/03 - RAMAKRISHNA PRASAD V, IGSI - WR NO. 24803           *00180000
W24803*                                                                 00190000
W24803*       - IN MAP POKM098 REPLACED DEPARTMENT, CLASS AND           00200000
W24803*         SEQUENCE NUMBER BY DEPARTMENT, MAJOR CLASS, SUB CLASS   00210000
W24803*         AND SKU NUMBER.                                         00220000
W24803*       - ADDED NEW COPYBOOKS XLT00003 AND XLT00004               00230000
W24803*       - THE DECLARE & FETCH CURSOR OF PURITM-CSR HAS BEEN       00240000
W24803*         CHANGED FOR GETING ITEM NUMBER                          00250000
W24803*       - TO DISPLAY THE MAJOR CLASS,SUB CLASS AND 8 DIGITS       00260000
W24803*         SKU IN THE SCREEN XLKUT DOMAIN HAS BEEN CALLED FOR      00270000
W24803*         NI SKU CONVERSION                                       00280000
W24803*                                                                 00290000
W24803******************************************************************00300000
P5207 ******************************************************************00301000
P5207 * 05/24/14 - SHEBENA  - CR NO - CHG0081355                       *00302013
P5207 *         THE PROGRAM WAS MODIFIED AS TO RETRIEVE AND DISPLAY    *00303012
P5207 *         THE MULTI PACK DETAILS AS WELL.                        *00304012
P5207 *         CHANGE TAG - P5207                                     *00305012
P5207 ******************************************************************00306000
C98147* 11/25/14 - LINDA FRIESS     - CHG0098147                        00307014
C98147*         EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND ADJUSTED      00308015
C98147*         FILLER IN PROGRAM                                       00309015
C98147******************************************************************00309114
076319* DATE  10/27/2021                                                00309217
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00309317
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00309417
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00309517
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00309618
076312*                                                               * 00309717
076318*---------------------------------------------------------------* 00309817
CICS  *  CHANGED 11/15/2022    BY BARB SCHULTZ    WR: CHG0278485        00309920
CICS  *                                                               * 00310019
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00310119
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00310219
CICS  *---------------------------------------------------------------* 00310519
001700                                                                  00311019
001800 ENVIRONMENT DIVISION.                                            00320000
001900                                                                  00330000
002000 DATA DIVISION.                                                   00340000
002100                                                                  00350000
002200 WORKING-STORAGE SECTION.                                         00360000
002300*                                                                 00370000
002400 01  PC-PROGRAM-CONSTANTS.                                        00380000
002500     05  PC-CURRENT-MAP-NAME          PIC  X(08)     VALUE        00390000
002600                                                     'PO098A  '.  00400000
002700     05  PC-CURRENT-MAPSET-NAME       PIC  X(08)     VALUE        00410000
002800                                                     'POKM098 '.  00420000
002900     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)     VALUE        00430000
003000                                                     'POKCS098'.  00440000
003100     05  PC-LIST-QUEUE-SEQ            PIC  9(01)     VALUE 1.     00450000
003200     05  PC-LIST2-QUEUE-SEQ           PIC  9(01)     VALUE 4.     00460000
003300     05  PC-ITEMS-PER-PANEL           PIC S9(04)     VALUE +10    00470000
003400                                                      COMP SYNC.  00480000
003500     05  PC-MAX-BLOCKS                PIC S9(04)     VALUE +2     00490000
003600                                                      COMP SYNC.  00500000
003700     05  PC-MAX-ITEMS                 PIC S9(09)     VALUE        00510000
003800                                                         +1000000 00520000
003900                                                      COMP-3.     00530000
004000     05  PC-NUMBER-LENGTH             PIC S9(04)     VALUE +7     00540000
004100                                                      COMP SYNC.  00550000
004200                                                                  00560000
004300 01  PC-TSYMSG-NUMBERS.                                           00570000
004400     05  PC-TSYMSG-00008              PIC 9(5)       VALUE 00008. 00580000
004500     05  PC-TSYMSG-00069              PIC 9(5)       VALUE 00069. 00590000
004600     05  PC-TSYMSG-00070              PIC 9(5)       VALUE 00070. 00600000
004700     05  PC-TSYMSG-00279              PIC 9(5)       VALUE 00279. 00610000
004800     05  PC-TSYMSG-00461              PIC 9(5)       VALUE 00461. 00620000
004900     05  PC-TSYMSG-00588              PIC 9(5)       VALUE 00588. 00630000
005000     05  PC-TSYMSG-01279              PIC 9(5)       VALUE 01279. 00640000
005100     05  PC-TSYMSG-02093              PIC 9(5)       VALUE 02093. 00650000
005200     05  PC-TSYMSG-02095              PIC 9(5)       VALUE 02095. 00660000
005300     05  PC-TSYMSG-02096              PIC 9(5)       VALUE 02096. 00670000
005400     05  PC-TSYMSG-02117              PIC 9(5)       VALUE 02117. 00680000
005400     05  PC-TSYMSG-02762              PIC 9(5)       VALUE 02762. 00690000
005500                                                                  00700000
005600 01  PS-PROGRAM-SUBSCRIPTS.                                       00710000
005700     05  PS-SUB                       PIC S9(04)   VALUE +0       00720000
005800                                                     COMP SYNC.   00730000
005900                                                                  00740000
006000 01  PS-PROGRAM-SWITCHES.                                         00750000
006100     05  PS-ERROR-SW                  PIC X(01)      VALUE 'Y'.   00760000
006200         88  PS-ERROR-NO                             VALUE 'Y'.   00770000
006300         88  PS-ERROR                                VALUE 'N'.   00780000
006400     05  PS-COMMAREA-SW               PIC X(01)      VALUE 'N'.   00790000
006500         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00800000
006600         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00810000
006700     05  PS-LIST-END-SW               PIC X(01)      VALUE 'N'.   00820000
006800         88  PS-LIST-NOT-END                         VALUE 'N'.   00830000
006900         88  PS-LIST-END                             VALUE 'Y'.   00840000
           05  PS-RV-STATUS-SW              PIC X(01)      VALUE 'N'.   00850000
               88  PS-RV-STATUS                            VALUE 'Y'.   00860000
               88  PS-NOT-RV-STATUS                        VALUE 'N'.   00870000
007000                                                                  00880000
007100 01  PV-PROGRAM-VARIABLES.                                        00890000
007200     05  PV-COMP3-FIELDS              COMP-3.                     00900000
007300         10  PV-READ-COUNT            PIC S9(09)     VALUE ZEROES.00910000
007400         10  PV-TOP-ITEM              PIC S9(09)     VALUE ZEROES.00920000
007500         10  PV-BOTTOM-ITEM           PIC S9(09)     VALUE ZEROES.00930000
007600                                                                  00940000
007700     05  PV-REMAINDER                 PIC S9(04)     VALUE ZEROES 00950000
007800                                                     COMP SYNC.   00960000
007900     05  PV-BLOCK-NUMBER              PIC S9(04)     VALUE ZEROES 00970000
008000                                                     COMP SYNC.   00980000
008100     05  PV-CICS-RESP                 PIC S9(04)     VALUE ZEROES 00990000
008200                                                     COMP SYNC.   01000000
008300     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)     VALUE ZEROES 01010000
008400                                                     COMP SYNC.   01020000
008500     05  PV-PACK-HIGH-BLOCK-WRITTEN   PIC S9(04)     VALUE ZEROES 01030000
008600                                                     COMP SYNC.   01040000
008700     05  PV-PO-PREPK-ID               PIC S9(04)     VALUE ZEROES 01050000
008800                                                     COMP SYNC.   01060000
008900     05  PV-KEY-DATA.                                             01070000
009000         10  PV-LIST-QUEUE-NAME.                                  01080000
009100             15  PV-LIST-TERM-ID      PIC  X(04).                 01090000
009200             15  PV-LIST-TASK-NBR     PIC S9(05)     COMP-3.      01100000
009300             15  PV-LIST-SEQ          PIC  9(01).                 01110000
009400         10  PV-PACK-QUEUE-NAME.                                  01120000
009500             15  PV-PACK-TERM-ID      PIC  X(04).                 01130000
009600             15  PV-PACK-TASK-NBR     PIC S9(05)     COMP-3.      01140000
009700             15  PV-PACK-SEQ          PIC  9(01).                 01150000
009800         10  PV-PO-NBR                PIC S9(09)     COMP.        01160000
009900         10  PV-DEPT-NBR              PIC  X(03).                 01170000
010000         10  FILLER                   PIC S9(09)     COMP.        01180000
010100                                                                  01190000
W24803     05 PV-SUB-CL-NBR                 PIC  9(04).                 01200000
W24803     05 PV-TEMP-MAJ-CL.                                           01210000
W24803        10 PV-TEMP-MAJ-CL-1           PIC  9(01)     VALUE  0.    01220000
W24803        10 FILLER                     PIC  9(01)     VALUE  0.    01230000
W24803     05 PV-MAJ-CL-NBR  REDEFINES PV-TEMP-MAJ-CL                   01240000
W24803                                      PIC  9(02).                 01250000
W24803     05 PV-TEMP-SKU.                                              01260000
W24803        10 PV-TEMP-DEPT               PIC  9(03)     VALUE  0.    01270000
W24803        10 PV-TEMP-CLASS              PIC  9(02)     VALUE  0.    01280000
W24803        10 PV-TEMP-SKU-SEQ-NBR        PIC  9(03)     VALUE  0.    01290000
W24803     05  PV-SKU   REDEFINES PV-TEMP-SKU                           01300000
W24803                                      PIC  9(08).                 01310000
W24803     05  PV-NULL-INDICATOR-VARIABLES.                             01320000
W24803         10 PV-MAJ-CL-NBR-IND         PIC S9(4) COMP VALUE +0.    01330000
W24803         10 PV-SUB-CL-NBR-IND         PIC S9(4) COMP VALUE +0.    01340000
W24803         10 PV-SKU-NBR-IND            PIC S9(4) COMP VALUE +0.    01350000
W24803         10 PV-VS-NBR-IND             PIC S9(4) COMP VALUE +0.    01360000
W24803         10 PV-SKU-DESC-IND           PIC S9(4) COMP VALUE +0.    01370000
W24803         10 PV-CSTM-CLOR-DESC-IND     PIC S9(4) COMP VALUE +0.    01380000
W24803         10 PV-SIZE-DESC-IND          PIC S9(4) COMP VALUE +0.    01390000
010200*---------------------------------------------------------------* 01400000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01410019
010400*---------------------------------------------------------------* 01420000
010500                                                                  01430000
010600     COPY DPWS030.                                                01440000
CICS       COPY DPWS930.                                                01441019
010700                                                                  01450000
010800*---------------------------------------------------------------* 01460000
010900*    STANDARD COMMAREA.                                         * 01470000
011000*---------------------------------------------------------------* 01480000
011100                                                                  01490000
011200     COPY DPWS020.                                                01500000
011300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01510000
011400                                                                  01520000
011500*---------------------------------------------------------------* 01530000
011600*    INTER-APPLICATION COMMAREA.                                * 01540000
011700*---------------------------------------------------------------* 01550000
011800                                                                  01560000
011900         10  INTER-APPL-COMM-AREA     PIC X(200).                 01570000
012000     COPY POWS013.                                                01580000
012100                                                                  01590000
012200*---------------------------------------------------------------* 01600000
012300*    SPECIFIC COMMMAREA FOR POKCS098.                           * 01610000
012400*---------------------------------------------------------------* 01620000
012500         10  ASC-SPECIFIC-COMMAREA.                               01630000
012600             15  ASC-KEY-DATA.                                    01640000
012700                 20  ASC-LIST-QUEUE-NAME.                         01650000
012800                     25  ASC-LIST-TERM-ID  PIC  X(04).            01660000
012900                     25  ASC-LIST-TASK-NBR PIC S9(05) COMP-3.     01670000
013000                     25  ASC-LIST-SEQ      PIC  9(01).            01680000
013100                 20  ASC-PACK-QUEUE-NAME.                         01690000
013200                     25  ASC-PACK-TERM-ID  PIC  X(04).            01700000
013300                     25  ASC-PACK-TASK-NBR PIC S9(05) COMP-3.     01710000
013400                     25  ASC-PACK-SEQ      PIC  9(01).            01720000
013500                 20  ASC-PO-NBR            PIC S9(09) COMP.       01730000
013600                 20  ASC-DEPT-NBR          PIC  X(03).            01740000
013700                 20  ASC-TOTAL-UNITS       PIC S9(09) COMP.       01750000
013800                 20  ASC-NBR-INNER-PACKS   PIC S9(09) COMP.       01760000
013900                                                                  01770000
014000             15  ASC-PACK-BLOCK-ENTRIES    OCCURS 2 TIMES.        01780000
014100                 20  ASC-PACK-LIST-NUMBER  PIC S9(03) COMP-3.     01790000
014200                 20  ASC-PACK-PREPK-ID     PIC S9(04) COMP.       01800000
014300                 20  ASC-PACK-SKU          PIC  9(08).            01810000
014300                 20  ASC-PACK-DESC         PIC  X(40).            01820000
014400                 20  ASC-PACK-UPC-NBR      PIC  9(15).            01830000
014500                 20  ASC-PACK-CONVEYABLE   PIC  X.                01840000
014600                 20  ASC-PACK-CARTONS      PIC S9(09) COMP.       01850000
014700                 20  ASC-UNITS-PER-CARTON  PIC S9(09) COMP.       01860000
014800                 20  ASC-PACK-INNER-QTY    PIC S9(09) COMP.       01870000
014900             15  ASC-PACK-SUB              PIC S9(04) COMP SYNC.  01880000
015000             15  ASC-NBR-PACKS-READ        PIC S9(09) COMP-3.     01890000
015100             15  ASC-PACK-DISPLAYED        PIC S9(04) COMP SYNC.  01900000
015200             15  ASC-PACK-HIGH-BLOCK-WRITTEN                      01910000
015300                                           PIC S9(04) COMP SYNC.  01920000
015400                                                                  01930000
015500* LINE LEVEL DATA FOR ONE PACK.                                   01940000
015600             15  ASC-BLOCK-ENTRIES         OCCURS 2 TIMES.        01950000
015700                 20  ASC-ITEM-ENTRIES      OCCURS 10 TIMES.       01960000
015800                     25  ASC-LIST-ITEM-NUMBER                     01970000
015900                                           PIC S9(09) COMP-3.     01980000
016000                     25  ASC-CL-NBR        PIC  X(02).            01990000
W24803                     25  ASC-MAJ-CL-NBR    PIC  X(02).            02000000
W24803                     25  ASC-SKU-NBR       PIC  X(08).            02010000
016200                     25  ASC-VEND-STYL-NAME PIC  X(10).           02020000
W24803                     25  ASC-SKU-DESC      PIC  X(13).            02030000
016400                     25  ASC-COLOR-DESC    PIC  X(10).            02040000
016500                     25  ASC-SIZE-DESC     PIC  X(10).            02050000
016600                     25  ASC-PREPK-RATO-QTY PIC S9(04) COMP.      02060000
016700                     25  ASC-UNT-QTY       PIC S9(05) COMP.       02070000
016800             15  ASC-BLK-SUB               PIC S9(04) COMP SYNC.  02080000
016900             15  ASC-ITEM-SUB              PIC S9(04) COMP SYNC.  02090000
017000             15  ASC-NBR-ITEMS-READ        PIC S9(09) COMP-3.     02100000
017100             15  ASC-ITEM-AT-TOP-OF-PANEL  PIC S9(09) COMP-3.     02110000
017200             15  ASC-ITEM-AT-BOT-OF-PANEL  PIC S9(09) COMP-3.     02120000
017300             15  ASC-HIGH-BLOCK-WRITTEN    PIC S9(04) COMP SYNC.  02130000
017400             15  ASC-ITEMS-LEFT-INDICATOR  PIC  X(01).            02140000
017500                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  02150000
017600                 88  ASC-ITEMS-LEFT-ON-DB-NO          VALUE 'N'.  02160000
017700             15  ASC-START-ITEM-REQUEST.                          02170000
017800                 20  ASC-START-ITEM-REQUEST-N PIC  9(07).         02180000
W24803         10  FILLER                           PIC X(1312).        02190000
017900                                                                  02200000
018000*---------------------------------------------------------------* 02210000
018100*    ABEND PROCESSING COPYBOOK.                                 * 02220000
018200*---------------------------------------------------------------* 02230000
018300                                                                  02240000
018400     COPY DPWS013.                                                02250000
018500                                                                  02260000
018600*---------------------------------------------------------------* 02270000
018700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02280000
018800*---------------------------------------------------------------* 02290000
018900                                                                  02300000
019000     COPY DPWS015.                                                02310000
019100                                                                  02320000
019200*---------------------------------------------------------------* 02330000
019300*    FUNCTION KEYS COPYBOOK.                                    * 02340000
019400*---------------------------------------------------------------* 02350000
019500                                                                  02360000
019600     COPY DPWS016.                                                02370000
019700                                                                  02380000
019800*---------------------------------------------------------------* 02390000
019900*    NUMERIC EDIT LAYOUT.                                       * 02400000
020000*---------------------------------------------------------------* 02410000
020100                                                                  02420000
020200     COPY DPWS010I.                                               02430000
020300                                                                  02440000
020400*---------------------------------------------------------------* 02450000
020500*    MAP LAYOUT                                                 * 02460000
020600*---------------------------------------------------------------* 02470000
020700                                                                  02480000
020800     COPY POKM098.                                                02490000
W24803*---------------------------------------------------------------* 02500000
020900                                                                  02510000
021000 01  MR-OCCURS-LAYOUT          REDEFINES  PO098AO.                02520000
C98147     05  FILLER                PIC X(260).                        02530015
021200     05  MR-SCROLL-AREA OCCURS 10 TIMES.                          02540000
W24803*                                                                 02550000
W24803         10  MR-DEPTL          PIC S9(04) COMP.                   02560000
W24803         10  MR-DEPTA          PIC  X(01).                        02570000
W24803         10  MR-DEPTC          PIC  X(01).                        02580000
W24803         10  FILLER            PIC  X(01).                        02590000
W24803         10  MR-DEPTH          PIC  X(01).                        02600000
W24803         10  FILLER            PIC  X(01).                        02610000
W24803         10  MR-DEPT           PIC  X(03).                        02620000
W24803                                                                  02630000
W24803         10  MR-MAJ-CLASSL     PIC S9(04) COMP.                   02640000
W24803         10  MR-MAJ-CLASSA     PIC  X(01).                        02650000
W24803         10  MR-MAJ-CLASSC     PIC  X(01).                        02660000
W24803         10  FILLER            PIC  X(01).                        02670000
W24803         10  MR-MAJ-CLASSH     PIC  X(01).                        02680000
W24803         10  FILLER            PIC  X(01).                        02690000
W24803         10  MR-MAJ-CLASS      PIC  X(02).                        02700000
W24803*                                                                 02710000
W24803         10  MR-SUB-CLASSL     PIC S9(04) COMP.                   02720000
W24803         10  MR-SUB-CLASSA     PIC  X(01).                        02730000
W24803         10  MR-SUB-CLASSC     PIC  X(01).                        02740000
W24803         10  FILLER            PIC  X(01).                        02750000
W24803         10  MR-SUB-CLASSH     PIC  X(01).                        02760000
W24803         10  FILLER            PIC  X(01).                        02770000
W24803         10  MR-SUB-CLASS      PIC  X(02).                        02780000
023600*                                                                 02790000
W24803         10  MR-SKUL           PIC S9(04) COMP.                   02800000
W24803         10  MR-SKUA           PIC  X(01).                        02810000
W24803         10  MR-SKUC           PIC  X(01).                        02820000
W24803         10  FILLER            PIC  X(01).                        02830000
W24803         10  MR-SKUH           PIC  X(01).                        02840000
W24803         10  FILLER            PIC  X(01).                        02850000
W24803         10  MR-SKU            PIC  X(08).                        02860000
W24803*                                                                 02870000
023700         10  MR-STYLEL         PIC S9(04) COMP.                   02880000
023800         10  MR-STYLEA         PIC  X(01).                        02890000
023900         10  MR-STYLEC         PIC  X(01).                        02900000
024000         10  FILLER            PIC  X(01).                        02910000
024100         10  MR-STYLEH         PIC  X(01).                        02920000
024200         10  FILLER            PIC  X(01).                        02930000
024300         10  MR-STYLE          PIC  X(10).                        02940000
024400*                                                                 02950000
024500         10  MR-DESCL          PIC S9(04) COMP.                   02960000
024600         10  MR-DESCA          PIC  X(01).                        02970000
024700         10  MR-DESCC          PIC  X(01).                        02980000
024800         10  FILLER            PIC  X(01).                        02990000
024900         10  MR-DESCH          PIC  X(01).                        03000000
025000         10  FILLER            PIC  X(01).                        03010000
W24803         10  MR-DESC           PIC  X(13).                        03020000
025200*                                                                 03030000
025300         10  MR-COLORL         PIC S9(04) COMP.                   03040000
025400         10  MR-COLORA         PIC  X(01).                        03050000
025500         10  MR-COLORC         PIC  X(01).                        03060000
025600         10  FILLER            PIC  X(01).                        03070000
025700         10  MR-COLORH         PIC  X(01).                        03080000
025800         10  FILLER            PIC  X(01).                        03090000
025900         10  MR-COLOR          PIC  X(10).                        03100000
026000*                                                                 03110000
026100         10  MR-SIZEL          PIC S9(04) COMP.                   03120000
026200         10  MR-SIZEA          PIC  X(01).                        03130000
026300         10  MR-SIZEC          PIC  X(01).                        03140000
026400         10  FILLER            PIC  X(01).                        03150000
026500         10  MR-SIZEH          PIC  X(01).                        03160000
026600         10  FILLER            PIC  X(01).                        03170000
026700         10  MR-SIZE           PIC  X(10).                        03180000
026800*                                                                 03190000
026900         10  MR-CRTN-UNITSL    PIC S9(04) COMP.                   03200000
027000         10  MR-CRTN-UNITSA    PIC  X(01).                        03210000
027100         10  MR-CRTN-UNITSC    PIC  X(01).                        03220000
027200         10  FILLER            PIC  X(01).                        03230000
027300         10  MR-CRTN-UNITSH    PIC  X(01).                        03240000
027400         10  FILLER            PIC  X(01).                        03250000
027500         10  MR-CRTN-UNITS-X.                                     03260000
027600         15  MR-CRTN-UNITS     PIC  ZZ9.                          03270000
027700*                                                                 03280000
027800         10  MR-QTYL           PIC S9(04) COMP.                   03290000
027900         10  MR-QTYA           PIC  X(01).                        03300000
028000         10  MR-QTYC           PIC  X(01).                        03310000
028100         10  FILLER            PIC  X(01).                        03320000
028200         10  MR-QTYH           PIC  X(01).                        03330000
028300         10  FILLER            PIC  X(01).                        03340000
028400         10  MR-QTY-X.                                            03350000
028500             15  MR-QTY        PIC  Z(6).                         03360000
028600                                                                  03370000
028700                                                                  03380000
028800*---------------------------------------------------------------* 03390000
028900*    DB2 AREA FOR PO PREPACK DATA                               * 03400000
029000*---------------------------------------------------------------* 03410000
029100     EXEC SQL                                                     03420000
029200          INCLUDE TPOPRPK                                         03430000
029300     END-EXEC.                                                    03440000
029400*---------------------------------------------------------------* 03450000
029500*    DB2 AREA FOR PO ITEM DATA                                    03460000
029600*---------------------------------------------------------------* 03470000
029700     EXEC SQL                                                     03480000
029800          INCLUDE TPURITM                                         03490000
029900     END-EXEC.                                                    03500000
W24803*---------------------------------------------------------------* 03510000
W24803*    XLT_SKU TABLE                                                03520000
W24803*---------------------------------------------------------------* 03530000
W24803                                                                  03540000
W24803     EXEC SQL                                                     03550000
W24803        INCLUDE XLT00003                                          03560000
W24803     END-EXEC.                                                    03570000
W24803                                                                  03580000
W24803*---------------------------------------------------------------* 03590000
W24803*    XLT_VND_STYL TABLE                                           03600000
W24803*---------------------------------------------------------------* 03610000
W24803                                                                  03620000
W24803     EXEC SQL                                                     03630000
W24803        INCLUDE XLT00004                                          03640000
W24803     END-EXEC.                                                    03650000
W24803                                                                  03660000
030000*---------------------------------------------------------------* 03670000
030100*    DB2 AREA FOR COMMUNICATIONS                                * 03680000
030200*---------------------------------------------------------------* 03690000
030300     EXEC SQL                                                     03700000
030400          INCLUDE SQLCA                                           03710000
030500     END-EXEC.                                                    03720000
030600                                                                  03730000
030700*---------------------------------------------------------------* 03740000
030800*    CURSOR TO OBTAIN EXISTING PREPACK DATA                     * 03750000
030900*---------------------------------------------------------------* 03760000
031000                                                                  03770000
031100     EXEC SQL                                                     03780000
031200        DECLARE POPRPK-CSR CURSOR                                 03790000
031300          FOR SELECT                                              03800000
031400                PO_NBR                                            03810000
031500              , PO_PREPK_ID                                       03820000
031600              , PREPK_DESC                                        03830000
031700              , PREPK_UPC_NBR                                     03840000
031800              , INPK_UNT_QTY                                      03850000
031900              , INPK_CNVYB_IND                                    03860000
032000              , OTPK_UNT_QTY                                      03870000
032100              , OTPK_ORD_QTY                                      03880000
                    , PK_SKU_NBR                                        03890000
032200          FROM                                                    03900000
032300                TPOPRPK                                           03910000
032400          WHERE                                                   03920000
032500                PO_NBR         =  :ASC-PO-NBR                     03930000
032700          ORDER BY                                                03940000
032800                PO_NBR                                            03950000
032900              , PO_PREPK_ID                                       03960000
033000     END-EXEC.                                                    03970000
033100                                                                  03980000
033200*---------------------------------------------------------------* 03990000
033300*    CURSOR TO OBTAIN PRPACK/PURITM DATA                        * 04000000
033400*---------------------------------------------------------------* 04010000
033500     EXEC SQL                                                     04020000
033600          DECLARE PURITM-CSR CURSOR                               04030000
033700          FOR SELECT                                              04040000
W24803                PI.PO_LNE_NBR                                     04050000
W24803              , PI.CL_NBR                                         04060000
W24803              , PI.SKU_SEQ_NBR                                    04070000
W24803              , PI.VEND_STYL_NAME                                 04080000
W24803              , PI.SKU_DESC                                       04090000
W24803              , PI.COLOR_DESC                                     04100000
W24803              , PI.SIZE_DESC                                      04110000
W24803              , V.MAJ_CL_NBR                                      04120000
W24803              , V.SUB_CL_NBR                                      04130000
W24803              , S.SKU_NBR                                         04140000
W24803              , V.VS_NBR                                          04150000
W24803              , S.SKU_DESC                                        04160000
W24803              , S.CSTM_CLOR_DESC                                  04170000
W24803              , S.SIZE_DESC                                       04180000
W24803              , PI.PO_PREPK_ID                                    04190000
W24803              , PI.STATUS_CDE                                     04200000
W24803              , PI.PREPK_RATO_QTY                                 04210000
W24803              , PI.UNT_QTY                                        04220000
034800          FROM                                                    04230000
034900                TPOPRPK PK                                        04240000
W24803               ,TPURITM PI   LEFT OUTER JOIN                      04250000
W24803                XLT_SKU S ON PI.ITM_NBR=S.ITM_NBR                 04260000
W24803                LEFT OUTER JOIN                                   04270000
W24803                XLT_VND_STYL V ON V.STYL_ID = S.STYL_ID           04280000
035100          WHERE                                                   04290000
W24803                PK.PO_NBR         = :POPRPK-PO-NBR                04300000
W24803          AND   PK.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID           04310000
035400          AND   PK.PO_NBR         = PI.PO_NBR                     04320000
035500          AND   PK.PO_PREPK_ID    = PI.PO_PREPK_ID                04330000
035600          AND   PI.VER_STATUS_CDE = 'A'                           04340000
035700          ORDER BY                                                04350000
035800                PO_LNE_NBR                                        04360000
035900     END-EXEC.                                                    04370000
036000                                                                  04380000
036100 LINKAGE SECTION.                                                 04390000
036200                                                                  04400000
036300 01  DFHCOMMAREA.                                                 04410000
036400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04420000
036500                                        DEPENDING ON EIBCALEN.    04430000
036600         10  FILLER                     PIC X.                    04440000
036700                                                                  04450000
036800                                                                  04460000
036900 PROCEDURE DIVISION.                                              04470000
037000                                                                  04480000
037100 0000-MAIN-MODULE.                                                04490000
037200                                                                  04500000
037300     INITIALIZE DP030-CICS-API-FIELDS.                            04510000
037400     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04520000
037500     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04530000
037600     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04540000
037700     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04550000
037800     MOVE LENGTH OF PO098AI       TO DP030-MAP-LENGTH (1).        04560000
037900     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04570000
038000     PERFORM 0001-CALL-CICS-ARCH-API.                             04580000
038100                                                                  04590000
038200     PERFORM 1000-CONTROL-PROCESSING.                             04600000
038300                                                                  04610000
038400     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04620000
038500     PERFORM 0001-CALL-CICS-ARCH-API.                             04630000
038600                                                                  04640000
038700*----------------------------------------------------------------*04650000
038800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *04660000
038900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *04670000
039000*----------------------------------------------------------------*04680000
039100                                                                  04690000
039200 0001-CALL-CICS-ARCH-API.                                         04700000
039300                                                                  04710000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04720019
039500                                    DFHCOMMAREA                   04730019
039600                                    DP030-CICS-API-FIELDS         04740019
039700                                    DP020-STANDARD-COMMAREA       04750019
039800                                    PO098AI.                      04760019
039900                                                                  04770000
040000     IF  DP030-RC-CALL-SUCCESSFUL                                 04780000
040100         CONTINUE                                                 04790000
040200     ELSE                                                         04800000
040300         SET DP013-NO-ROLLBACK        TO TRUE                     04810000
040400         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   04820000
040500         SET DP013-CICS-ABEND         TO TRUE                     04830000
CICS           MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        04840019
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04850019
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04860019
040900         MOVE DP030-RETURN-CODE       TO DP013-MESSAGE-TEXT (3)   04870000
041000         PERFORM DP013-0000-PROCESS-ABEND                         04880000
041100     END-IF.                                                      04890000
041200                                                                  04900000
041300                                                                  04910000
041400 1000-CONTROL-PROCESSING.                                         04920000
041500*----------------------------------------------------------------*04930000
041600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04940000
041700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04950000
041800*                                                                *04960000
041900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04970000
042000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04980000
042100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04990000
042200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05000000
042300*----------------------------------------------------------------*05010000
042400                                                                  05020000
042500     EVALUATE TRUE                                                05030000
042600         WHEN DP020-NEXT-ACT-INITIAL                              05040000
042700             INITIALIZE ASC-SPECIFIC-COMMAREA                     05050000
042800             MOVE EIBTRMID            TO ASC-LIST-TERM-ID         05060000
042900                                         ASC-PACK-TERM-ID         05070000
043000             MOVE DP020-SRC-TASK-NUMBER                           05080000
043100                                      TO ASC-LIST-TASK-NBR        05090000
043200                                         ASC-PACK-TASK-NBR        05100000
043300             MOVE PC-LIST-QUEUE-SEQ   TO ASC-LIST-SEQ             05110000
043400             MOVE PC-LIST2-QUEUE-SEQ  TO ASC-PACK-SEQ             05120000
043500                                                                  05130000
043600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05140000
043700             IF PS-COMMAREA-NOT-VALID                             05150000
043800                 SET DP020-NEXT-ACT-APPL-ERROR                    05160000
043900                     DP020-MSG-FATAL  TO TRUE                     05170000
044000             ELSE                                                 05180000
044100                 PERFORM 5000-CREATE-PACK-QUEUE                   05190000
044200                 PERFORM 4000-BUILD-INITIAL-PANEL                 05200000
044300             END-IF                                               05210000
044400                                                                  05220000
044500         WHEN DP020-NEXT-ACT-READ-MAP                             05230000
044600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05240000
044700                                      TO PV-TOP-ITEM              05250000
044800             PERFORM 2000-PROCESS-PANEL                           05260000
044900                                                                  05270000
045000         WHEN DP020-NEXT-ACT-RETURN                               05280000
045100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05290000
045200                                      TO PV-TOP-ITEM              05300000
045300             MOVE ZERO                TO ASC-ITEM-AT-TOP-OF-PANEL 05310000
045400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05320000
045500                                                                  05330000
045600         WHEN OTHER                                               05340000
045700             SET DP013-LOGIC-ABEND    TO TRUE                     05350000
045800             SET DP013-NO-ROLLBACK    TO TRUE                     05360000
045900             MOVE '1000-CONTROL-PROCESSING'                       05370000
046000                                      TO DP013-PARAGRAPH          05380000
046100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05390000
046200                                      TO DP013-MESSAGE-TEXT(1)    05400000
046300             PERFORM DP013-0000-PROCESS-ABEND                     05410000
046400     END-EVALUATE.                                                05420000
046500                                                                  05430000
046600                                                                  05440000
046700 1100-PROCESS-INTER-APPL-COMM.                                    05450000
046800*----------------------------------------------------------------*05460000
046900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05470000
047000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05480000
047100*----------------------------------------------------------------*05490000
047200                                                                  05500000
047300     SET PS-COMMAREA-VALID            TO TRUE.                    05510000
047400     MOVE SPACE                       TO ASC-START-ITEM-REQUEST.  05520000
047500                                                                  05530000
048100                                                                  05590000
048200     IF PO013-PO-NBR = ZERO                                       05600000
048300         MOVE PC-TSYMSG-00461         TO DP020-MSG-NUMBER         05610000
048400         SET PS-COMMAREA-NOT-VALID                                05620000
048500             DP020-MSG-FATAL          TO TRUE                     05630000
048600     ELSE                                                         05640000
048700         MOVE PO013-PO-NBR            TO ASC-PO-NBR               05650000
048800     END-IF.                                                      05660000
048900                                                                  05670000
049000     IF PO013-DEPT-NBR = SPACES                                   05680000
049100         MOVE PC-TSYMSG-00588         TO DP020-MSG-NUMBER         05690000
049200         SET PS-COMMAREA-NOT-VALID                                05700000
049300             DP020-MSG-FATAL          TO TRUE                     05710000
049400     ELSE                                                         05720000
049500         MOVE PO013-DEPT-NBR          TO ASC-DEPT-NBR             05730000
049600     END-IF.                                                      05740000
049700                                                                  05750000
049800     MOVE ZEROES                      TO PV-PO-PREPK-ID.          05760000
049900     MOVE +1                          TO ASC-BLK-SUB              05770000
050000                                         ASC-ITEM-SUB.            05780000
050100                                                                  05790000
050200                                                                  05800000
050300 2000-PROCESS-PANEL.                                              05810000
050400*----------------------------------------------------------------*05820000
050500*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *05830000
050600*    ON WHAT FUNCTION KEY WAS SELECTED.                          *05840000
050700*----------------------------------------------------------------*05850000
050800                                                                  05860000
050900     EVALUATE TRUE                                                05870000
051000         WHEN DP020-SRC-AID = DP016-CLEAR                         05880000
051100             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05890000
051200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05900000
051300             PERFORM 3200-RESET-ATTRIBUTES                        05910000
051400                                                                  05920000
051500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    05930000
051600             MOVE ASC-KEY-DATA        TO PV-KEY-DATA              05940000
051700             INITIALIZE ASC-SPECIFIC-COMMAREA                     05950000
051800             MOVE ZEROES              TO PV-PO-PREPK-ID           05960000
051900             MOVE +1                  TO ASC-BLK-SUB              05970000
052000                                         ASC-ITEM-SUB             05980000
052100             MOVE PV-KEY-DATA         TO ASC-KEY-DATA             05990000
052200                                                                  06000000
052300             PERFORM 5000-CREATE-PACK-QUEUE                       06010000
052400             PERFORM 4000-BUILD-INITIAL-PANEL                     06020000
052500             PERFORM 3200-RESET-ATTRIBUTES                        06030000
052600                                                                  06040000
052700* F20 'NEXT PK'                                                   06050000
052800** ---------------------- FK-NEXT-SELECTION ------------------*   06060000
052900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06070000
053000             IF ASC-NBR-PACKS-READ > 1                            06080000
053100                 PERFORM 2140-GET-NEXT-PACK                       06090000
053200                 IF PS-LIST-END                                   06100000
053300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06110000
053400                     SET PS-LIST-NOT-END TO TRUE                  06120000
053500                 ELSE                                             06130000
053600                     PERFORM 4000-BUILD-INITIAL-PANEL             06140000
053700                 END-IF                                           06150000
053800                 PERFORM 3200-RESET-ATTRIBUTES                    06160000
053900             ELSE                                                 06170000
054000                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         06180000
054100                 SET DP020-MSG-INFORMATIONAL TO TRUE              06190000
054200             END-IF                                               06200000
054300                                                                  06210000
054400* F19 'PREV PK'                                                   06220000
054500** ---------------------- FK-PREV-SELECTION ------------------*   06230000
054600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06240000
054700             IF ASC-NBR-PACKS-READ > 1                            06250000
054800                 PERFORM 2150-GET-PREV-PACK                       06260000
054900                 IF PS-LIST-END                                   06270000
055000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06280000
055100                     SET PS-LIST-NOT-END TO TRUE                  06290000
055200                 ELSE                                             06300000
055300                     PERFORM 4000-BUILD-INITIAL-PANEL             06310000
055400                 END-IF                                           06320000
055500                 PERFORM 3200-RESET-ATTRIBUTES                    06330000
055600             ELSE                                                 06340000
055700                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         06350000
055800                 SET DP020-MSG-INFORMATIONAL TO TRUE              06360000
055900             END-IF                                               06370000
056000                                                                  06380000
056100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06390000
056200             MOVE +1 TO PV-TOP-ITEM                               06400000
056300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06410000
056400             PERFORM 3200-RESET-ATTRIBUTES                        06420000
056500                                                                  06430000
056600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06440000
056700             PERFORM 2110-BROWSE-BACKWARD                         06450000
056800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06460000
056900             PERFORM 3200-RESET-ATTRIBUTES                        06470000
057000                                                                  06480000
057100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06490000
057200             PERFORM 2120-BROWSE-FORWARD                          06500000
057300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06510000
057400             PERFORM 3200-RESET-ATTRIBUTES                        06520000
057500                                                                  06530000
057600         WHEN DP020-SRC-AID = DP016-ENTER                         06540000
057700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06550000
057800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06560000
057900             IF  PS-ERROR                                         06570000
058000                 CONTINUE                                         06580000
058100             ELSE                                                 06590000
058200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06600000
058300                 PERFORM 3200-RESET-ATTRIBUTES                    06610000
058400             END-IF                                               06620000
058500                                                                  06630000
058600         WHEN OTHER                                               06640000
058700             SET DP013-NO-ROLLBACK    TO TRUE                     06650000
058800             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               06660000
058900             SET DP013-CICS-ABEND     TO TRUE                     06670000
059000             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         06680000
059100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06690000
059200                                      TO DP013-MESSAGE-TEXT (1)   06700000
059300             PERFORM DP013-0000-PROCESS-ABEND                     06710000
059400                                                                  06720000
059500     END-EVALUATE.                                                06730000
059600                                                                  06740000
059700                                                                  06750000
059800 2110-BROWSE-BACKWARD.                                            06760000
059900*----------------------------------------------------------------*06770000
060000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06780000
060100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06790000
060200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06800000
060300*    MESSAGE.                                                    *06810000
060400*----------------------------------------------------------------*06820000
060500                                                                  06830000
060600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06840000
060700         GIVING PV-TOP-ITEM.                                      06850000
060800                                                                  06860000
060900     IF  PV-TOP-ITEM < +1                                         06870000
061000         MOVE +1                      TO PV-TOP-ITEM              06880000
061100*        -- TOP OF LIST --                                        06890000
061200         MOVE PC-TSYMSG-00069         TO DP020-MSG-NUMBER         06900000
061300         SET DP020-MSG-INFORMATIONAL  TO TRUE                     06910000
061400     END-IF.                                                      06920000
061500                                                                  06930000
061600                                                                  06940000
061700 2120-BROWSE-FORWARD.                                             06950000
061800*----------------------------------------------------------------*06960000
061900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *06970000
062000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *06980000
062100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *06990000
062200*----------------------------------------------------------------*07000000
062300                                                                  07010000
062400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07020000
062500         GIVING PV-TOP-ITEM.                                      07030000
062600     IF  PV-TOP-ITEM > ASC-NBR-ITEMS-READ                         07040000
062700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07050000
062800                                      TO PV-TOP-ITEM              07060000
062900*        -- BOTTOM OF LIST --                                     07070000
063000         MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER         07080000
063100         SET DP020-MSG-INFORMATIONAL  TO TRUE                     07090000
063200     ELSE                                                         07100000
063300         COMPUTE PV-BOTTOM-ITEM =                                 07110000
063400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07120000
063500         IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ                  07130000
063600*            -- BOTTOM OF LIST --                                 07140000
063700             MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         07150000
063800             SET DP020-MSG-INFORMATIONAL                          07160000
063900                                      TO TRUE                     07170000
064000         END-IF                                                   07180000
064100     END-IF.                                                      07190000
064200                                                                  07200000
064300 2130-CHECK-FOR-JUMP-BROWSE.                                      07210000
064400*----------------------------------------------------------------*07220000
064500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07230000
064600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07240000
064700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07250000
064800*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07260000
064900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07270000
065000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07280000
065100*----------------------------------------------------------------*07290000
065200                                                                  07300000
065300     SET PS-ERROR-NO                  TO TRUE.                    07310000
065400     IF (ASC-START-ITEM-REQUEST = SPACE)                          07320000
065500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07330000
065600                                      TO PV-TOP-ITEM              07340000
065700     ELSE                                                         07350000
065800         MOVE ASC-START-ITEM-REQUEST  TO DP010I-UNEDITED-FIELD    07360000
065900         MOVE PC-NUMBER-LENGTH        TO DP010I-MAXIMUM-DIGITS    07370000
066000         MOVE +0                      TO DP010I-MAXIMUM-DECIMALS  07380000
066100         SET DP010I-NEGATIVE-NOT-ALLOWED                          07390000
066200                                      TO TRUE                     07400000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07411016
264230                         USING DP010I-NUMERIC-EDIT-AREA           07412016
066400                                                                  07420000
066500         IF  NOT DP010I-ERROR-DETECTED                            07430000
066600             MOVE DP010I-NUMERIC-FIELD                            07440000
066700                                      TO ASC-START-ITEM-REQUEST-N 07450000
066800             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07460000
066900                 IF  ASC-START-ITEM-REQUEST-N >                   07470000
067000                                          ASC-NBR-ITEMS-READ      07480000
067100                     MOVE SPACE       TO ASC-START-ITEM-REQUEST   07490000
067200                     COMPUTE PV-TOP-ITEM =                        07500000
067300                             ASC-NBR-ITEMS-READ                   07510000
067400                             - PC-ITEMS-PER-PANEL + 1             07520000
067500                     IF  PV-TOP-ITEM < +1                         07530000
067600                         MOVE +1      TO PV-TOP-ITEM              07540000
067700                         MOVE PC-TSYMSG-00070                     07550000
067800                                      TO DP020-MSG-NUMBER         07560000
067900                         SET DP020-MSG-INFORMATIONAL              07570000
068000                                      TO TRUE                     07580000
068100                     END-IF                                       07590000
068200                 ELSE                                             07600000
068300                     MOVE ASC-START-ITEM-REQUEST-N                07610000
068400                                      TO PV-TOP-ITEM              07620000
068500                     MOVE SPACE       TO ASC-START-ITEM-REQUEST   07630000
068600                     COMPUTE PV-BOTTOM-ITEM =                     07640000
068700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07650000
068800                     IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ      07660000
068900*                        -- BOTTOM OF LIST --                     07670000
069000                         MOVE PC-TSYMSG-00070                     07680000
069100                                      TO DP020-MSG-NUMBER         07690000
069200                         SET DP020-MSG-INFORMATIONAL              07700000
069300                                      TO TRUE                     07710000
069400                     END-IF                                       07720000
069500                 END-IF                                           07730000
069600             ELSE                                                 07740000
069700*                --- VALUE OUT OF RANGE ----                      07750000
069800                 MOVE PC-TSYMSG-01279 TO DP020-MSG-NUMBER         07760000
069900                 MOVE -1              TO ASTRTITL                 07770000
070000                 SET DP030-SET-CURSOR-APPL-1                      07780000
070100                                      TO TRUE                     07790000
070200                 MOVE DP015-REVERSE   TO ASTRTITH                 07800000
070300                 MOVE DP015-RED       TO ASTRTITC                 07810000
070400                 MOVE DP015-UNP-NUM-BRT-MDT                       07820000
070500                                      TO ASTRTITA                 07830000
070600                 SET DP020-MSG-FATAL                              07840000
070700                     PS-ERROR         TO TRUE                     07850000
070800             END-IF                                               07860000
070900                                                                  07870000
071000         ELSE                                                     07880000
071100             MOVE PC-TSYMSG-00008     TO DP020-MSG-NUMBER         07890000
071200             MOVE -1                  TO ASTRTITL                 07900000
071300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07910000
071400             MOVE DP015-REVERSE       TO ASTRTITH                 07920000
071500             MOVE DP015-RED           TO ASTRTITC                 07930000
071600             MOVE DP015-UNP-NUM-BRT-MDT                           07940000
071700                                      TO ASTRTITA                 07950000
071800             SET DP020-MSG-FATAL                                  07960000
071900                 PS-ERROR             TO TRUE                     07970000
072000         END-IF                                                   07980000
072100     END-IF.                                                      07990000
072200                                                                  08000000
072300                                                                  08010000
072400 2140-GET-NEXT-PACK.                                              08020000
072500*----------------------------------------------------------------*08030000
072600*    GET THE NEXT PACK TO BE PROCESSED                           *08040000
072700*----------------------------------------------------------------*08050000
072800                                                                  08060000
072900     ADD +1                           TO ASC-PACK-DISPLAYED.      08070000
073000     IF ASC-PACK-DISPLAYED NOT > ASC-PACK-HIGH-BLOCK-WRITTEN      08080000
073100         IF ASC-PACK-SUB = PC-MAX-BLOCKS                          08090000
073200             MOVE +1                  TO ASC-PACK-SUB             08100000
073300             MOVE ASC-PACK-BLOCK-ENTRIES (PC-MAX-BLOCKS)          08110000
073400                          TO ASC-PACK-BLOCK-ENTRIES(ASC-PACK-SUB) 08120000
073500             ADD +1                   TO ASC-PACK-SUB             08130000
073600             INITIALIZE ASC-PACK-BLOCK-ENTRIES (ASC-PACK-SUB)     08140000
073700             PERFORM 9100-READ-PACK-QUEUE                         08150000
073800         ELSE                                                     08160000
073900             ADD +1                   TO ASC-PACK-SUB             08170000
074000         END-IF                                                   08180000
074100         MOVE ASC-PACK-PREPK-ID (ASC-PACK-SUB)                    08190000
074200                                      TO PV-PO-PREPK-ID           08200000
074300     ELSE                                                         08210000
074400         SUBTRACT +1 FROM ASC-PACK-DISPLAYED                      08220000
074500         MOVE PC-TSYMSG-02096         TO DP020-MSG-NUMBER         08230000
074600         SET DP020-MSG-INFORMATIONAL  TO TRUE                     08240000
074700         SET PS-LIST-END              TO TRUE                     08250000
074800     END-IF.                                                      08260000
074900                                                                  08270000
075000 2150-GET-PREV-PACK.                                              08280000
075100*----------------------------------------------------------------*08290000
075200*    GET THE PREVIOUS PACK PROCESSED.                             08300000
075300*----------------------------------------------------------------*08310000
075400                                                                  08320000
075500     IF ASC-PACK-DISPLAYED = 1                                    08330000
075600         MOVE PC-TSYMSG-02095         TO DP020-MSG-NUMBER         08340000
075700         SET DP020-MSG-INFORMATIONAL  TO TRUE                     08350000
075800         SET PS-LIST-END              TO TRUE                     08360000
075900     ELSE                                                         08370000
076000         SUBTRACT +1 FROM ASC-PACK-DISPLAYED                      08380000
076100         SUBTRACT +1 FROM ASC-PACK-SUB                            08390000
076200         IF ASC-PACK-SUB = ZERO                                   08400000
076300             MOVE ASC-PACK-BLOCK-ENTRIES (1)                      08410000
076400                          TO ASC-PACK-BLOCK-ENTRIES(PC-MAX-BLOCKS)08420000
076500             MOVE +1                  TO ASC-PACK-SUB             08430000
076600             INITIALIZE ASC-PACK-BLOCK-ENTRIES (ASC-PACK-SUB)     08440000
076700             PERFORM 9100-READ-PACK-QUEUE                         08450000
076800         END-IF                                                   08460000
076900                                                                  08470000
077000         IF ASC-PACK-PREPK-ID (ASC-PACK-SUB) > ZEROES             08480000
077100             MOVE ASC-PACK-PREPK-ID (ASC-PACK-SUB)                08490000
077200                                         TO PV-PO-PREPK-ID        08500000
077300         ELSE                                                     08510000
077400             ADD +1                      TO ASC-PACK-DISPLAYED    08520000
077500             MOVE PC-TSYMSG-02095        TO DP020-MSG-NUMBER      08530000
077600             SET DP020-MSG-INFORMATIONAL                          08540000
077700                 PS-LIST-END             TO TRUE                  08550000
077800         END-IF                                                   08560000
077900     END-IF.                                                      08570000
078000                                                                  08580000
078100                                                                  08590000
078200 2200-MOVE-SCREEN-TO-COMMAREA.                                    08600000
078300*----------------------------------------------------------------*08610000
078400*    RESET ATTRIBUTES.                                           *08620000
078500*----------------------------------------------------------------*08630000
078600                                                                  08640000
078700     IF ASTRTITL > ZERO                                           08650000
078800         MOVE ASTRTITI                TO ASC-START-ITEM-REQUEST   08660000
078900     ELSE                                                         08670000
079000         IF ASTRTITF = DP015-ERASE-EOF                            08680000
079100             INITIALIZE ASC-START-ITEM-REQUEST                    08690000
079200         END-IF                                                   08700000
079300     END-IF.                                                      08710000
079400                                                                  08720000
079500                                                                  08730000
079600 3200-RESET-ATTRIBUTES.                                           08740000
079700*----------------------------------------------------------------*08750000
079800*    RESET ATTRIBUTES.                                           *08760000
079900*----------------------------------------------------------------*08770000
080000                                                                  08780000
080100     MOVE DP015-UNP-ALP-NOR-OFF       TO ASTRTITA.                08790000
080200     MOVE DP015-GREEN                 TO ASTRTITC.                08800000
080300     MOVE DP015-UNDERLINE             TO ASTRTITH.                08810000
080400     MOVE -1                          TO ASTRTITL.                08820000
080500     SET DP030-SET-CURSOR-APPL-1      TO TRUE.                    08830000
080600                                                                  08840000
080700                                                                  08850000
080800 4000-BUILD-INITIAL-PANEL.                                        08860000
080900*----------------------------------------------------------------*08870000
081000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08880000
081100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08890000
081200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08900000
081300*    DISPLAY THE PANEL TO USER.                                  *08910000
081400*----------------------------------------------------------------*08920000
081500                                                                  08930000
081600     IF ASC-NBR-PACKS-READ > ZERO                                 08940000
081700*  GET ALL THE PREPACK LINE DATA FOR THIS PO.                     08950000
081800                                                                  08960000
081900         PERFORM 8200-DELETE-ITEM-QUEUE                           08970000
082000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         08980000
082100                    ASC-BLOCK-ENTRIES (2)                         08990000
082200         MOVE +1                      TO ASC-BLK-SUB              09000000
082300         MOVE +0                      TO ASC-ITEM-SUB             09010000
082400                                         ASC-NBR-ITEMS-READ       09020000
082500                                         ASC-HIGH-BLOCK-WRITTEN   09030000
082600                                         ASC-ITEM-AT-TOP-OF-PANEL 09040000
082700                                                                  09050000
082800         SET ASC-ITEMS-LEFT-ON-DB     TO TRUE                     09060000
082900         INITIALIZE ASC-TOTAL-UNITS                               09070000
083000                    ASC-NBR-INNER-PACKS                           09080000
083100                                                                  09090000
083200         PERFORM 4200-OPEN-PURITM-CSR                             09100000
083300         PERFORM 4250-PROCESS-PURITM-LINE                         09110000
083400         PERFORM 4299-CLOSE-PURITM-CSR                            09120000
083500     END-IF.                                                      09130000
083600                                                                  09140000
083700     MOVE +1                          TO  PV-TOP-ITEM.            09150000
083800     IF ASC-NBR-ITEMS-READ = ZERO                                 09160000
083900         SET DP020-NEXT-ACT-APPL-ERROR                            09170000
084000             DP020-MSG-FATAL          TO TRUE                     09180000
084100         MOVE PC-TSYMSG-02117         TO DP020-MSG-NUMBER         09190000
084200     ELSE                                                         09200000
084300         MOVE -1                      TO ASTRTITL                 09210000
084400         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     09220000
084500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09230000
084600     END-IF.                                                      09240000
                                                                        09250000
           IF PS-RV-STATUS                                              09260000
               MOVE PC-TSYMSG-02762     TO DP020-MSG-NUMBER             09270000
               SET DP020-MSG-INFORMATIONAL TO TRUE                      09280000
           END-IF.                                                      09290000
084700                                                                  09300000
084800 4200-OPEN-PURITM-CSR.                                            09310000
084900*----------------------------------------------------------------*09320000
085000* OPEN THE CURSOR.                                               *09330000
085100*----------------------------------------------------------------*09340000
W24803     MOVE ASC-PO-NBR       TO   POPRPK-PO-NBR.                    09350000
W24803     MOVE PV-PO-PREPK-ID   TO   POPRPK-PO-PREPK-ID.               09360000
085200                                                                  09370000
085300     EXEC SQL                                                     09380000
085400          OPEN PURITM-CSR                                         09390000
085500     END-EXEC.                                                    09400000
085600                                                                  09410000
085700     EVALUATE TRUE                                                09420000
085800         WHEN SQLCODE = ZERO                                      09430000
085900           CONTINUE                                               09440000
086000         WHEN SQLWARN0 NOT EQUAL SPACE                            09450000
086100         WHEN SQLCODE NOT EQUAL ZERO                              09460000
086200           MOVE '4200-OPEN-PURITM-CSR'                            09470000
086300                                      TO DP013-PARAGRAPH          09480000
086400           MOVE 'OPEN PURITM CURSOR'  TO DP013-MESSAGE-TEXT (1)   09490000
086500           MOVE SQLCA                 TO DP013-SQLCA              09500000
086600           MOVE 'TPURITM'             TO DP013-DB2-TABLE-NAME (1) 09510000
086700           MOVE 'TPOPRPK'             TO DP013-DB2-TABLE-NAME (2) 09520000
086800           SET DP013-DB2-ABEND        TO TRUE                     09530000
086900           PERFORM DP013-0000-PROCESS-ABEND                       09540000
087000     END-EVALUATE.                                                09550000
087100                                                                  09560000
087200                                                                  09570000
087300 4250-PROCESS-PURITM-LINE.                                        09580000
087400*----------------------------------------------------------------*09590000
087500* PROCESS PREPACK LINE INFORMATION                               *09600000
087600*----------------------------------------------------------------*09610000
087700                                                                  09620000
087800     PERFORM                                                      09630000
087900       VARYING PV-READ-COUNT                                      09640000
088000       FROM 1 BY 1                                                09650000
088100       UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                      09660000
088200          OR (ASC-ITEMS-LEFT-ON-DB-NO))                           09670000
088300                                                                  09680000
088400         PERFORM 4275-FETCH-PURITM                                09690000
088500                                                                  09700000
               IF  PURITM-STATUS-CDE = 'RV'                             09710000
                   SET PS-RV-STATUS TO TRUE                             09720000
               END-IF                                                   09730000
                                                                        09740000
088600         IF  ASC-ITEMS-LEFT-ON-DB                                 09750000
088700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                09760000
088800                 ADD +1               TO ASC-ITEM-SUB             09770000
088900             ELSE                                                 09780000
089000                 ADD +1               TO ASC-BLK-SUB              09790000
089100                 MOVE +1              TO ASC-ITEM-SUB             09800000
089200                                                                  09810000
089300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS                  09820000
089400                     MOVE +1          TO ASC-BLK-SUB              09830000
089500                     PERFORM 7200-WRITE-ITEM-QUEUE                09840000
089600                     MOVE ASC-BLOCK-ENTRIES (PC-MAX-BLOCKS)       09850000
089700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 09860000
089800                     ADD +1           TO ASC-BLK-SUB              09870000
089900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   09880000
090000                 END-IF                                           09890000
090100             END-IF                                               09900000
090200             ADD +1                   TO ASC-NBR-ITEMS-READ       09910000
090300             MOVE ASC-NBR-ITEMS-READ                              09920000
090400                                      TO ASC-LIST-ITEM-NUMBER     09930000
090500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  09940000
W24803             IF  PV-SKU-NBR-IND = 0                               09950000
W24803                 MOVE XLT00004-SUB-CL-NBR TO PV-SUB-CL-NBR        09960000
W24803                 MOVE PV-SUB-CL-NBR(3:2)  TO ASC-CL-NBR           09970000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       09980000
W24803                 MOVE XLT00004-MAJ-CL-NBR TO PV-MAJ-CL-NBR        09990000
W24803                 MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR       10000000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10010000
W24803                 MOVE XLT00003-SKU-NBR    TO PV-SKU               10020000
W24803                 MOVE PV-SKU              TO ASC-SKU-NBR          10030000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10040000
W24803                 MOVE XLT00004-VS-NBR     TO ASC-VEND-STYL-NAME   10050000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10060000
W24803                 MOVE XLT00003-SKU-DESC   TO ASC-SKU-DESC         10070000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10080000
W24803                 MOVE XLT00003-CSTM-CLOR-DESC TO ASC-COLOR-DESC   10090000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10100000
W24803                 MOVE XLT00003-SIZE-DESC  TO ASC-SIZE-DESC        10110000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10120000
W24803             ELSE                                                 10130000
W24803                 INITIALIZE PV-SKU                                10140000
W24803                 INITIALIZE PV-MAJ-CL-NBR                         10150000
W24803                 MOVE PURITM-CL-NBR       TO ASC-CL-NBR           10160000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10170000
W24803                 MOVE PURITM-CL-NBR(1:1)  TO PV-TEMP-MAJ-CL-1     10180000
W24803                 MOVE PV-MAJ-CL-NBR       TO ASC-MAJ-CL-NBR       10190000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10200000
W24803                 MOVE ASC-DEPT-NBR        TO PV-TEMP-DEPT         10210000
W24803                 MOVE PURITM-CL-NBR       TO PV-TEMP-CLASS        10220000
W24803                 MOVE PURITM-SKU-SEQ-NBR  TO PV-TEMP-SKU-SEQ-NBR  10230000
W24803                 MOVE PV-SKU              TO ASC-SKU-NBR          10240000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10250000
W24803                 MOVE PURITM-VEND-STYL-NAME TO ASC-VEND-STYL-NAME 10260000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10270000
W24803                 MOVE PURITM-SKU-DESC     TO ASC-SKU-DESC         10280000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10290000
W24803                 MOVE PURITM-COLOR-DESC   TO ASC-COLOR-DESC       10300000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10310000
W24803                 MOVE PURITM-SIZE-DESC    TO ASC-SIZE-DESC        10320000
W24803                                (ASC-BLK-SUB, ASC-ITEM-SUB)       10330000
W24803             END-IF                                               10340000
091800             MOVE PURITM-PREPK-RATO-QTY                           10350000
091900                                      TO ASC-PREPK-RATO-QTY       10360000
092000                             (ASC-BLK-SUB, ASC-ITEM-SUB)          10370000
092100             MOVE PURITM-UNT-QTY      TO ASC-UNT-QTY              10380000
092200                             (ASC-BLK-SUB, ASC-ITEM-SUB)          10390000
092300             ADD PURITM-UNT-QTY       TO ASC-TOTAL-UNITS          10400000
092400         END-IF                                                   10410000
092500     END-PERFORM.                                                 10420000
092600                                                                  10430000
092700     IF  ASC-NBR-ITEMS-READ > ZERO                                10440000
092800         MOVE +1                      TO ASC-BLK-SUB              10450000
092900         PERFORM 7200-WRITE-ITEM-QUEUE                            10460000
093000         ADD +1                       TO ASC-BLK-SUB              10470000
093100         PERFORM 7200-WRITE-ITEM-QUEUE                            10480000
093200                                                                  10490000
093300         MOVE 1                       TO ASC-BLK-SUB              10500000
093400                                         PV-BLOCK-NUMBER          10510000
093500     END-IF.                                                      10520000
093600                                                                  10530000
093700 4275-FETCH-PURITM.                                               10540000
093800*----------------------------------------------------------------*10550000
093900* FETCH PREPACK LINE INFORMATION                                 *10560000
094000*----------------------------------------------------------------*10570000
094100                                                                  10580000
094200     EXEC SQL                                                     10590000
094300       FETCH PURITM-CSR                                           10600000
094400         INTO :PURITM-PO-LNE-NBR                                  10610000
W24803             ,:PURITM-CL-NBR                                      10620000
W24803             ,:PURITM-SKU-SEQ-NBR                                 10630000
W24803             ,:PURITM-VEND-STYL-NAME                              10640000
W24803             ,:PURITM-SKU-DESC                                    10650000
W24803             ,:PURITM-COLOR-DESC                                  10660000
W24803             ,:PURITM-SIZE-DESC                                   10670000
W24803             ,:XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND              10680000
W24803             ,:XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND              10690000
W24803             ,:XLT00003-SKU-NBR:PV-SKU-NBR-IND                    10700000
W24803             ,:XLT00004-VS-NBR:PV-VS-NBR-IND                      10710000
W24803             ,:XLT00003-SKU-DESC:PV-SKU-DESC-IND                  10720000
W24803             ,:XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND      10730000
W24803             ,:XLT00003-SIZE-DESC:PV-SIZE-DESC-IND                10740000
095100             ,:PURITM-PO-PREPK-ID                                 10750000
                   ,:PURITM-STATUS-CDE                                  10760000
095200             ,:PURITM-PREPK-RATO-QTY                              10770000
095300             ,:PURITM-UNT-QTY                                     10780000
095400     END-EXEC.                                                    10790000
095500                                                                  10800000
095600     EVALUATE TRUE                                                10810000
095700       WHEN SQLCODE = +0                                          10820000
W24803         CONTINUE                                                 10830000
095900       WHEN SQLCODE = +100                                        10840000
096000         SET ASC-ITEMS-LEFT-ON-DB-NO  TO TRUE                     10850000
096100                                                                  10860000
096200       WHEN SQLWARN0 NOT = SPACE                                  10870000
096300       WHEN SQLCODE < +0                                          10880000
096400       WHEN SQLCODE > +0                                          10890000
096500         MOVE '4275-FETCH-PURITM'     TO DP013-PARAGRAPH          10900000
096600         MOVE 'FETCH PURITM CURSOR'   TO DP013-MESSAGE-TEXT(1)    10910000
096700         MOVE SQLCA                   TO DP013-SQLCA              10920000
096800         MOVE 'TPURITM'               TO DP013-DB2-TABLE-NAME (1) 10930000
096900         MOVE 'TPOPRPK'               TO DP013-DB2-TABLE-NAME (2) 10940000
097000         SET DP013-DB2-ABEND                                      10950000
097100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   10960000
097200         PERFORM DP013-0000-PROCESS-ABEND                         10970000
097300     END-EVALUATE.                                                10980000
097400                                                                  10990000
097500                                                                  11000000
097600 4299-CLOSE-PURITM-CSR.                                           11010000
097700*----------------------------------------------------------------*11020000
097800* CLOSE THE CURSOR.                                              *11030000
097900*----------------------------------------------------------------*11040000
098000                                                                  11050000
098100     EXEC SQL                                                     11060000
098200         CLOSE PURITM-CSR                                         11070000
098300     END-EXEC.                                                    11080000
098400                                                                  11090000
098500     EVALUATE TRUE                                                11100000
098600         WHEN SQLCODE = ZERO                                      11110000
098700           CONTINUE                                               11120000
098800         WHEN SQLWARN0 NOT EQUAL SPACE                            11130000
098900         WHEN SQLCODE NOT EQUAL ZERO                              11140000
099000           MOVE '4299-CLOSE-PURITM-CSR'                           11150000
099100                                      TO DP013-PARAGRAPH          11160000
099200           MOVE 'CLOSE PURITM CURSOR' TO DP013-MESSAGE-TEXT (1)   11170000
099300           MOVE SQLCA                 TO DP013-SQLCA              11180000
099400           SET DP013-DB2-ABEND        TO TRUE                     11190000
099500           PERFORM DP013-0000-PROCESS-ABEND                       11200000
099600     END-EVALUATE.                                                11210000
099700                                                                  11220000
099800                                                                  11230000
099900 4400-MOVE-COMMAREA-TO-SCREEN.                                    11240000
100000*----------------------------------------------------------------*11250000
100100*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *11260000
100200*----------------------------------------------------------------*11270000
100300                                                                  11280000
100400     MOVE ASC-PO-NBR                  TO APONUMO.                 11290000
100500     MOVE ASC-TOTAL-UNITS             TO ATOTUNTO.                11300000
100600     IF ASC-PACK-INNER-QTY (ASC-PACK-SUB) = ZEROES                11310000
100700         MOVE ZEROES                  TO ASC-NBR-INNER-PACKS      11320000
100800     ELSE                                                         11330000
100900         COMPUTE ASC-NBR-INNER-PACKS =                            11340000
101000                     ASC-UNITS-PER-CARTON (ASC-PACK-SUB) /        11350000
101100                     ASC-PACK-INNER-QTY (ASC-PACK-SUB)            11360000
101200     END-IF.                                                      11370000
101300                                                                  11380000
101400     MOVE ASC-NBR-INNER-PACKS         TO ANOFINPO.                11390000
101500                                                                  11400000
101600     MOVE ASC-PACK-PREPK-ID (ASC-PACK-SUB)                        11410000
101700                                      TO APACKIDO.                11420000
101800     MOVE ASC-PACK-DESC (ASC-PACK-SUB)                            11430000
101900                                      TO APDESCRO.                11440000
101800     MOVE ASC-PACK-SKU  (ASC-PACK-SUB)                            11450000
101900                                      TO APCKSKUO.                11460000
102000     MOVE ASC-PACK-UPC-NBR (ASC-PACK-SUB)                         11470000
102100                                      TO APCKUPCO.                11480000
102200     MOVE ASC-PACK-CONVEYABLE (ASC-PACK-SUB)                      11490000
102300                                      TO ACIPINDO.                11500000
102400     MOVE ASC-PACK-CARTONS (ASC-PACK-SUB)                         11510000
102500                                      TO ANOFCTNO.                11520000
P5207 *    IF PO013-PO-PKGNG-CDE = 'M'                                  11569012
P5207      IF ASC-UNITS-PER-CARTON (ASC-PACK-SUB) = 0                   11569112
P5207         MOVE 1                        TO ANOFINPO                 11569200
P5207         MOVE ASC-PACK-INNER-QTY (ASC-PACK-SUB)                    11569300
P5207                                       TO AUPRCTNO                 11569400
P5207         MOVE ASC-PACK-INNER-QTY (ASC-PACK-SUB)                    11569500
P5207                                       TO AUPRINPO                 11569600
P5207      ELSE                                                         11569700
P5207         MOVE ASC-UNITS-PER-CARTON (ASC-PACK-SUB)                  11569800
P5207                                       TO AUPRCTNO                 11569900
P5207         MOVE ASC-PACK-INNER-QTY (ASC-PACK-SUB)                    11570000
P5207                                       TO AUPRINPO                 11570100
P5207      END-IF.                                                      11570200
103000                                                                  11571000
103100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             11580000
103200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          11590000
103300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          11600000
103400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             11610000
103500                 GIVING PV-BLOCK-NUMBER                           11620000
103600                 REMAINDER PV-REMAINDER                           11630000
103700             IF  PV-REMAINDER > ZERO                              11640000
103800                 ADD +1               TO PV-BLOCK-NUMBER          11650000
103900             END-IF                                               11660000
104000             MOVE +1                  TO ASC-BLK-SUB              11670000
104100             PERFORM 9200-READ-ITEM-QUEUE                         11680000
104200             ADD +1                   TO ASC-BLK-SUB              11690000
104300                                         PV-BLOCK-NUMBER          11700000
104400             PERFORM 9200-READ-ITEM-QUEUE                         11710000
104500     END-IF.                                                      11720000
104600     MOVE +1                          TO ASC-BLK-SUB.             11730000
104700     COMPUTE ASC-ITEM-SUB =                                       11740000
104800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              11750000
104900         + PC-ITEMS-PER-PANEL).                                   11760000
105000                                                                  11770000
105100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        11780000
105200         ADD +1                       TO ASC-BLK-SUB              11790000
105300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            11800000
105400     END-IF.                                                      11810000
105500                                                                  11820000
105600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           11830000
105700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                11840000
105800     PERFORM 4420-FORMAT-ITEM-LINES                               11850000
105900         VARYING PS-SUB                                           11860000
106000         FROM PC-ITEMS-PER-PANEL BY -1                            11870000
106100         UNTIL PS-SUB < +1.                                       11880000
106200                                                                  11890000
106300     MOVE PV-TOP-ITEM                 TO ASC-ITEM-AT-TOP-OF-PANEL 11900000
106400                                         ASTRTITO.                11910000
106500     MOVE ASC-ITEM-AT-BOT-OF-PANEL    TO AENDITO.                 11920000
106600     MOVE ASC-NBR-ITEMS-READ          TO ATOTITO.                 11930000
106700                                                                  11940000
106800     MOVE ASC-NBR-PACKS-READ          TO ATOTPKO.                 11950000
106900     IF ASC-NBR-PACKS-READ = ZEROES                               11960000
107000         MOVE ZEROES                  TO ASTRTPKO                 11970000
107100     ELSE                                                         11980000
107200         MOVE ASC-PACK-LIST-NUMBER (ASC-PACK-SUB)                 11990000
107300                                      TO ASTRTPKO                 12000000
107400     END-IF.                                                      12010000
107500                                                                  12020000
107600                                                                  12030000
107700     IF  DP020-MSG-NUMBER-X = SPACE                               12040000
107800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NBR-ITEMS-READ        12050000
107900*            --- MORE ITEMS TO DISPLAY ----                       12060000
108000             MOVE PC-TSYMSG-00279     TO DP020-MSG-NUMBER         12070000
108100             SET DP020-MSG-INFORMATIONAL TO TRUE                  12080000
108200         ELSE                                                     12090000
108300             MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         12100000
108400             SET DP020-MSG-INFORMATIONAL TO TRUE                  12110000
108500         END-IF                                                   12120000
108600     END-IF.                                                      12130000
108700                                                                  12140000
108800                                                                  12150000
108900 4420-FORMAT-ITEM-LINES.                                          12160000
109000*----------------------------------------------------------------*12170000
109100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *12180000
109200*----------------------------------------------------------------*12190000
109300                                                                  12200000
109400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NBR-ITEMS-READ            12210000
109500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                12220000
W24803         MOVE SPACES                  TO MR-DEPT (PS-SUB)         12230000
W24803                                         MR-SUB-CLASS (PS-SUB)    12240000
W24803                                         MR-MAJ-CLASS (PS-SUB)    12250000
W24803                                         MR-SKU (PS-SUB)          12260000
109900                                         MR-STYLE (PS-SUB)        12270000
110000                                         MR-DESC (PS-SUB)         12280000
110100                                         MR-COLOR (PS-SUB)        12290000
110200                                         MR-SIZE (PS-SUB)         12300000
110300                                         MR-CRTN-UNITS-X (PS-SUB) 12310000
110400                                         MR-QTY-X (PS-SUB)        12320000
110500     ELSE                                                         12330000
110600         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           12340000
W24803             MOVE ASC-DEPT-NBR        TO MR-DEPT (PS-SUB)         12350000
W24803             MOVE ASC-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)          12360000
W24803                                      TO MR-SUB-CLASS (PS-SUB)    12370000
W24803             MOVE ASC-MAJ-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)      12380000
W24803                                      TO MR-MAJ-CLASS (PS-SUB)    12390000
W24803             MOVE ASC-SKU-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)         12400000
W24803                                      TO MR-SKU (PS-SUB)          12410000
111200             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB, ASC-ITEM-SUB)  12420000
111300                                      TO MR-STYLE (PS-SUB)        12430000
111400             MOVE ASC-SKU-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)        12440000
111500                                      TO MR-DESC (PS-SUB)         12450000
111600             MOVE ASC-COLOR-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)      12460000
111700                                      TO MR-COLOR (PS-SUB)        12470000
111800             MOVE ASC-SIZE-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)       12480000
111900                                      TO MR-SIZE (PS-SUB)         12490000
112000             MOVE ASC-PREPK-RATO-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)  12500000
112100                                      TO MR-CRTN-UNITS (PS-SUB)   12510000
112200             MOVE ASC-UNT-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)         12520000
112300                                      TO MR-QTY (PS-SUB)          12530000
112400         END-IF                                                   12540000
112500     END-IF.                                                      12550000
112600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               12560000
112700     IF  ASC-ITEM-SUB < + 1                                       12570000
112800         MOVE PC-ITEMS-PER-PANEL      TO ASC-ITEM-SUB             12580000
112900         MOVE +1                      TO ASC-BLK-SUB              12590000
113000     END-IF.                                                      12600000
113100                                                                  12610000
113200                                                                  12620000
113300 5000-CREATE-PACK-QUEUE.                                          12630000
113400*----------------------------------------------------------------*12640000
113500*    WRITE A NEW PACK BLOCK FROM THE ARRAY TO TEMPORARY STORAGE. *12650000
113600*----------------------------------------------------------------*12660000
113700                                                                  12670000
113800     PERFORM 8100-DELETE-PACK-QUEUE.                              12680000
113900     SET ASC-ITEMS-LEFT-ON-DB         TO TRUE.                    12690000
114000                                                                  12700000
114100     PERFORM 5100-OPEN-POPRPK-CSR.                                12710000
114200     PERFORM 5200-PROCESS-POPRPK.                                 12720000
114300     PERFORM 5300-CLOSE-POPRPK-CSR.                               12730000
114400                                                                  12740000
114500                                                                  12750000
114600 5100-OPEN-POPRPK-CSR.                                            12760000
114700*----------------------------------------------------------------*12770000
114800* OPEN THE CURSOR.                                               *12780000
114900*----------------------------------------------------------------*12790000
115000                                                                  12800000
115100     EXEC SQL                                                     12810000
115200          OPEN POPRPK-CSR                                         12820000
115300     END-EXEC.                                                    12830000
115400                                                                  12840000
115500     EVALUATE TRUE                                                12850000
115600         WHEN SQLCODE = ZERO                                      12860000
115700              CONTINUE                                            12870000
115800         WHEN SQLWARN0 NOT EQUAL SPACE                            12880000
115900         WHEN SQLCODE NOT EQUAL ZERO                              12890000
116000              MOVE '5100-OPEN-POPRPK-CSR'                         12900000
116100                           TO  DP013-PARAGRAPH                    12910000
116200              MOVE 'OPEN PREPACK CURSOR'                          12920000
116300                           TO  DP013-MESSAGE-TEXT (1)             12930000
116400              MOVE SQLCA   TO  DP013-SQLCA                        12940000
116500              SET DP013-DB2-ABEND                                 12950000
116600                           TO  TRUE                               12960000
116700              PERFORM DP013-0000-PROCESS-ABEND                    12970000
116800     END-EVALUATE.                                                12980000
116900                                                                  12990000
117000 5200-PROCESS-POPRPK.                                             13000000
117100******************************************************            13010000
117200*  PROCESS ALL POPRPK DATA HERE                                   13020000
117300******************************************************            13030000
117400                                                                  13040000
117500     PERFORM                                                      13050000
117600       VARYING PV-READ-COUNT                                      13060000
117700       FROM    1 BY 1                                             13070000
117800       UNTIL   ((PV-READ-COUNT > PC-MAX-ITEMS)                    13080000
117900         OR    (ASC-ITEMS-LEFT-ON-DB-NO))                         13090000
118000                                                                  13100000
118100         PERFORM 5250-FETCH-POPRPK                                13110000
118200                                                                  13120000
118300         IF ASC-ITEMS-LEFT-ON-DB                                  13130000
118400             ADD +1                   TO ASC-PACK-SUB             13140000
118500             IF ASC-PACK-SUB > PC-MAX-BLOCKS                      13150000
118600                 MOVE +1              TO ASC-PACK-SUB             13160000
118700                 PERFORM 7100-WRITE-PACK-QUEUE                    13170000
118800                 MOVE ASC-PACK-BLOCK-ENTRIES (PC-MAX-BLOCKS)      13180000
118900                          TO ASC-PACK-BLOCK-ENTRIES(ASC-PACK-SUB) 13190000
119000                 ADD +1               TO ASC-PACK-SUB             13200000
119100                 INITIALIZE ASC-PACK-BLOCK-ENTRIES (ASC-PACK-SUB) 13210000
119200             END-IF                                               13220000
119300             IF PV-PO-PREPK-ID = ZEROES                           13230000
119400               AND POPRPK-PO-PREPK-ID > ZEROES                    13240000
119500* SAVE THE FIRST PREPACK DATA FOUND.                              13250000
119600                 MOVE POPRPK-PO-PREPK-ID                          13260000
119700                                      TO PV-PO-PREPK-ID           13270000
119800             END-IF                                               13280000
119900             ADD +1                   TO  ASC-NBR-PACKS-READ      13290000
120000* SAVE ALL PREPACK DATA IN PACK QUEUE                             13300000
120100             MOVE ASC-NBR-PACKS-READ  TO ASC-PACK-LIST-NUMBER     13310000
120200                                          (ASC-PACK-SUB)          13320000
120300             MOVE POPRPK-PO-PREPK-ID  TO ASC-PACK-PREPK-ID        13330000
120400                                          (ASC-PACK-SUB)          13340000
120500             MOVE POPRPK-PREPK-UPC-NBR                            13350000
120600                                      TO ASC-PACK-UPC-NBR         13360000
120700                                          (ASC-PACK-SUB)          13370000
120800             MOVE POPRPK-PREPK-DESC   TO ASC-PACK-DESC            13380000
120900                                          (ASC-PACK-SUB)          13390000
121000             MOVE POPRPK-INPK-CNVYB-IND TO ASC-PACK-CONVEYABLE    13400000
121100                                          (ASC-PACK-SUB)          13410000
121200             MOVE POPRPK-OTPK-ORD-QTY TO ASC-PACK-CARTONS         13420000
121300                                          (ASC-PACK-SUB)          13430000
121400             MOVE POPRPK-OTPK-UNT-QTY TO ASC-UNITS-PER-CARTON     13440000
121500                                          (ASC-PACK-SUB)          13450000
121600             MOVE POPRPK-INPK-UNT-QTY TO ASC-PACK-INNER-QTY       13460000
121700                                          (ASC-PACK-SUB)          13470000
                   MOVE POPRPK-PK-SKU-NBR   TO ASC-PACK-SKU             13480000
                                                (ASC-PACK-SUB)          13490000
121800         END-IF                                                   13500000
121900     END-PERFORM.                                                 13510000
122000                                                                  13520000
122100     IF ASC-NBR-PACKS-READ > ZERO                                 13530000
122200         MOVE +1                      TO ASC-PACK-SUB             13540000
122300         PERFORM 7100-WRITE-PACK-QUEUE                            13550000
122400         ADD +1                       TO ASC-PACK-SUB             13560000
122500         PERFORM 7100-WRITE-PACK-QUEUE                            13570000
122600                                                                  13580000
122700* READ THE FIRST 2 BLOCKS OF THE PACK QUEUE TO DISPLAY THE FIRST  13590000
122800*  AVAILABLE ON THE SCREEN.                                       13600000
122900         MOVE +1                      TO ASC-PACK-DISPLAYED       13610000
123000                                         ASC-PACK-SUB             13620000
123100         PERFORM 9100-READ-PACK-QUEUE                             13630000
123200         ADD +1                       TO ASC-PACK-DISPLAYED       13640000
123300                                         ASC-PACK-SUB             13650000
123400         PERFORM 9100-READ-PACK-QUEUE                             13660000
123500         MOVE +1                      TO ASC-PACK-DISPLAYED       13670000
123600                                         ASC-PACK-SUB             13680000
123700     END-IF.                                                      13690000
123800                                                                  13700000
123900                                                                  13710000
124000 5250-FETCH-POPRPK.                                               13720000
124100*----------------------------------------------------------------*13730000
124200* FETCH PREPACK INFORMATION                                      *13740000
124300*----------------------------------------------------------------*13750000
124400                                                                  13760000
124500     EXEC SQL                                                     13770000
124600         FETCH POPRPK-CSR                                         13780000
124700         INTO :POPRPK-PO-NBR                                      13790000
124800             ,:POPRPK-PO-PREPK-ID                                 13800000
124900             ,:POPRPK-PREPK-DESC                                  13810000
125000             ,:POPRPK-PREPK-UPC-NBR                               13820000
125100             ,:POPRPK-INPK-UNT-QTY                                13830000
125200             ,:POPRPK-INPK-CNVYB-IND                              13840000
125300             ,:POPRPK-OTPK-UNT-QTY                                13850000
125400             ,:POPRPK-OTPK-ORD-QTY                                13860000
                   ,:POPRPK-PK-SKU-NBR                                  13870000
125500     END-EXEC.                                                    13880000
125600                                                                  13890000
125700     EVALUATE TRUE                                                13900000
125800       WHEN SQLCODE = +0                                          13910000
125900           CONTINUE                                               13920000
126000       WHEN SQLCODE = +100                                        13930000
126100           SET ASC-ITEMS-LEFT-ON-DB-NO TO TRUE                    13940000
126200                                                                  13950000
126300       WHEN SQLWARN0 NOT = SPACE                                  13960000
126400       WHEN SQLCODE < +0                                          13970000
126500       WHEN SQLCODE > +0                                          13980000
126600             MOVE '5250-FETCH-POPRPK'                             13990000
126700                                      TO DP013-PARAGRAPH          14000000
126800             MOVE 'FETCH CURSOR'      TO DP013-MESSAGE-TEXT(1)    14010000
126900             MOVE SQLCA               TO DP013-SQLCA              14020000
127000             MOVE 'TPOPRPK'           TO DP013-DB2-TABLE-NAME (1) 14030000
127100             SET DP013-DB2-ABEND                                  14040000
127200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14050000
127300             PERFORM DP013-0000-PROCESS-ABEND                     14060000
127400     END-EVALUATE.                                                14070000
127500                                                                  14080000
127600                                                                  14090000
127700 5300-CLOSE-POPRPK-CSR.                                           14100000
127800*----------------------------------------------------------------*14110000
127900* CLOSE THE CURSOR.                                              *14120000
128000*----------------------------------------------------------------*14130000
128100                                                                  14140000
128200     EXEC SQL                                                     14150000
128300         CLOSE POPRPK-CSR                                         14160000
128400     END-EXEC.                                                    14170000
128500                                                                  14180000
128600     EVALUATE TRUE                                                14190000
128700         WHEN SQLCODE = ZERO                                      14200000
128800           CONTINUE                                               14210000
128900         WHEN SQLWARN0 NOT EQUAL SPACE                            14220000
129000         WHEN SQLCODE NOT EQUAL ZERO                              14230000
129100           MOVE '5300-CLOSE-POPRPK-CSR'                           14240000
129200                                      TO  DP013-PARAGRAPH         14250000
129300           MOVE 'CLOSE PREPACK CURSOR'                            14260000
129400                                      TO  DP013-MESSAGE-TEXT (1)  14270000
129500           MOVE SQLCA                 TO  DP013-SQLCA             14280000
129600           SET DP013-DB2-ABEND        TO  TRUE                    14290000
129700           PERFORM DP013-0000-PROCESS-ABEND                       14300000
129800     END-EVALUATE.                                                14310000
129900                                                                  14320000
130000                                                                  14330000
130100                                                                  14340000
130200 7100-WRITE-PACK-QUEUE.                                           14350000
130300*----------------------------------------------------------------*14360000
130400*    WRITE A NEW PACK BLOCK FROM THE ARRAY TO TEMPORARY STORAGE. *14370000
130500*----------------------------------------------------------------*14380000
130600                                                                  14390000
130700     COMPUTE PV-PACK-HIGH-BLOCK-WRITTEN =                         14400000
130800         ASC-PACK-HIGH-BLOCK-WRITTEN + 1.                         14410000
130900                                                                  14420000
131000     EXEC CICS                                                    14430000
131100          WRITEQ TS                                               14440000
131200              QUEUE (ASC-PACK-QUEUE-NAME)                         14450000
131300              FROM  (ASC-PACK-BLOCK-ENTRIES (ASC-PACK-SUB) )      14460000
131400              ITEM  (PV-PACK-HIGH-BLOCK-WRITTEN)                  14470000
131500              RESP  (PV-CICS-RESP)                                14480000
131600     END-EXEC.                                                    14490000
131700                                                                  14500000
131800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          14510000
131900         CONTINUE                                                 14520000
132000     ELSE                                                         14530000
132100         SET DP013-CICS-ABEND                                     14540000
132200             DP013-NO-ROLLBACK        TO TRUE                     14550000
132300         MOVE '7100-WRITE-PACK-QUEUE' TO DP013-PARAGRAPH          14560000
132400         MOVE 'ATTEMPTING TO WRITE PACK QUEUE'                    14570000
132500                                      TO DP013-MESSAGE-TEXT(1)    14580000
132600         PERFORM DP013-0000-PROCESS-ABEND                         14590000
132700     END-IF.                                                      14600000
132800     ADD +1                       TO ASC-PACK-HIGH-BLOCK-WRITTEN. 14610000
132900                                                                  14620000
133000                                                                  14630000
133100 7200-WRITE-ITEM-QUEUE.                                           14640000
133200*----------------------------------------------------------------*14650000
133300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *14660000
133400*----------------------------------------------------------------*14670000
133500                                                                  14680000
133600     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           14690000
133700         ASC-HIGH-BLOCK-WRITTEN + 1.                              14700000
133800                                                                  14710000
133900     EXEC CICS                                                    14720000
134000         WRITEQ TS                                                14730000
134100             QUEUE (ASC-LIST-QUEUE-NAME)                          14740000
134200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               14750000
134300             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     14760000
134400             RESP  (PV-CICS-RESP)                                 14770000
134500     END-EXEC.                                                    14780000
134600                                                                  14790000
134700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      14800000
134800         SET DP013-CICS-ABEND                                     14810000
134900             DP013-NO-ROLLBACK        TO TRUE                     14820000
135000         MOVE '7200-WRITE-ITEM-QUEUE' TO DP013-PARAGRAPH          14830000
135100         MOVE 'ATTEMPTING TO WRITE IEM QUEUE  '                   14840000
135200                                      TO DP013-MESSAGE-TEXT(1)    14850000
135300         PERFORM DP013-0000-PROCESS-ABEND                         14860000
135400     END-IF.                                                      14870000
135500     ADD +1                           TO ASC-HIGH-BLOCK-WRITTEN.  14880000
135600                                                                  14890000
135700                                                                  14900000
135800 8100-DELETE-PACK-QUEUE.                                          14910000
135900*----------------------------------------------------------------*14920000
136000*  DELETE THE PACK TEMP STORAGE QUEUE.                           *14930000
136100*----------------------------------------------------------------*14940000
136200                                                                  14950000
136300     EXEC CICS                                                    14960000
136400         DELETEQ TS                                               14970000
136500             QUEUE (ASC-PACK-QUEUE-NAME)                          14980000
136600             RESP  (PV-CICS-RESP)                                 14990000
136700     END-EXEC.                                                    15000000
136800                                                                  15010000
136900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15020000
137000        (PV-CICS-RESP = DFHRESP(QIDERR))                          15030000
137100         CONTINUE                                                 15040000
137200     ELSE                                                         15050000
137300         SET DP013-CICS-ABEND         TO TRUE                     15060000
137400         SET DP013-NO-ROLLBACK        TO TRUE                     15070000
137500                                                                  15080000
137600         MOVE '8100-DELETE-PACK-QUEUE'                            15090000
137700                                      TO DP013-PARAGRAPH          15100000
137800         MOVE 'ERROR TRYING TO DELETE PACK ID QUEUE'              15110000
137900                                      TO DP013-MESSAGE-TEXT (1)   15120000
138000         PERFORM DP013-0000-PROCESS-ABEND                         15130000
138100     END-IF.                                                      15140000
138200                                                                  15150000
138300                                                                  15160000
138400 8200-DELETE-ITEM-QUEUE.                                          15170000
138500*----------------------------------------------------------------*15180000
138600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *15190000
138700*----------------------------------------------------------------*15200000
138800                                                                  15210000
138900     EXEC CICS                                                    15220000
139000         DELETEQ TS                                               15230000
139100             QUEUE (ASC-LIST-QUEUE-NAME)                          15240000
139200             RESP  (PV-CICS-RESP)                                 15250000
139300     END-EXEC.                                                    15260000
139400                                                                  15270000
139500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15280000
139600        (PV-CICS-RESP = DFHRESP(QIDERR))                          15290000
139700         CONTINUE                                                 15300000
139800     ELSE                                                         15310000
139900         SET DP013-CICS-ABEND         TO TRUE                     15320000
140000         SET DP013-NO-ROLLBACK        TO TRUE                     15330000
140100                                                                  15340000
140200         MOVE '8200-DELETE-ITEM-QUEUE'                            15350000
140300                                      TO DP013-PARAGRAPH          15360000
140400         MOVE 'ERROR TRYING TO DELETE ITEM QUEUE'                 15370000
140500                                      TO DP013-MESSAGE-TEXT (1)   15380000
140600         PERFORM DP013-0000-PROCESS-ABEND                         15390000
140700     END-IF.                                                      15400000
140800                                                                  15410000
140900     MOVE +0                          TO ASC-HIGH-BLOCK-WRITTEN.  15420000
141000                                                                  15430000
141100                                                                  15440000
141200 9100-READ-PACK-QUEUE.                                            15450000
141300*----------------------------------------------------------------*15460000
141400*    READ A BLOCK FROM PACK TEMP STORAGE QUEUE INTO THE ARRAY.   *15470000
141500*----------------------------------------------------------------*15480000
141600                                                                  15490000
141700     EXEC CICS                                                    15500000
141800         READQ TS                                                 15510000
141900             QUEUE (ASC-PACK-QUEUE-NAME)                          15520000
142000             INTO  (ASC-PACK-BLOCK-ENTRIES(ASC-PACK-SUB))         15530000
142100             ITEM  (ASC-PACK-DISPLAYED)                           15540000
142200             RESP  (PV-CICS-RESP)                                 15550000
142300     END-EXEC.                                                    15560000
142400                                                                  15570000
142500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       15580000
142600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     15590000
142700         CONTINUE                                                 15600000
142800     ELSE                                                         15610000
142900         SET DP013-CICS-ABEND                                     15620000
143000             DP013-NO-ROLLBACK        TO TRUE                     15630000
143100         MOVE '9100-READ-PACK-QUEUE'  TO DP013-PARAGRAPH          15640000
143200         MOVE 'ERROR TRYING TO READ FROM PACK QUEUE'              15650000
143300                                      TO DP013-MESSAGE-TEXT(1)    15660000
143400         PERFORM DP013-0000-PROCESS-ABEND                         15670000
143500     END-IF.                                                      15680000
143600                                                                  15690000
143700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         15700000
143800         INITIALIZE ASC-PACK-BLOCK-ENTRIES(ASC-PACK-SUB)          15710000
143900     END-IF.                                                      15720000
144000                                                                  15730000
144100                                                                  15740000
144200 9200-READ-ITEM-QUEUE.                                            15750000
144300*----------------------------------------------------------------*15760000
144400*    READ A BLOCK FROM ITEM TEMP STORAGE QUEUE INTO THE ARRAY.   *15770000
144500*----------------------------------------------------------------*15780000
144600                                                                  15790000
144700     EXEC CICS                                                    15800000
144800         READQ TS                                                 15810000
144900             QUEUE (ASC-LIST-QUEUE-NAME)                          15820000
145000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               15830000
145100             ITEM  (PV-BLOCK-NUMBER)                              15840000
145200             RESP  (PV-CICS-RESP)                                 15850000
145300     END-EXEC.                                                    15860000
145400                                                                  15870000
145500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       15880000
145600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     15890000
145700         CONTINUE                                                 15900000
145800     ELSE                                                         15910000
145900         SET DP013-CICS-ABEND                                     15920000
146000             DP013-NO-ROLLBACK        TO TRUE                     15930000
146100         MOVE '9200-READ-ITEM-QUEUE'  TO DP013-PARAGRAPH          15940000
146200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      15950000
146300                                      TO DP013-MESSAGE-TEXT(1)    15960000
146400         PERFORM DP013-0000-PROCESS-ABEND                         15970000
146500     END-IF.                                                      15980000
146600                                                                  15990000
146700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         16000000
146800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               16010000
146900     END-IF.                                                      16020000
147000                                                                  16030000
147100                                                                  16040000
147200*----------------------------------------------------------------*16050000
147300*    ABEND PROCESSOR MODULE                                      *16060000
147400*----------------------------------------------------------------*16070000
147500                                                                  16080000
147600     COPY DPPD013.                                                16090000
