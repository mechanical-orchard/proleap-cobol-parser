000100***************************************************************** 00010077
000200 IDENTIFICATION DIVISION.                                         00020077
000300***************************************************************** 00030077
000400                                                                  00040077
000500 PROGRAM-ID.             SUKRP014.                                00050077
000600 AUTHOR.                 MARY SARDINA.                            00060077
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070077
000800 DATE-WRITTEN            OCTOBER   1997.                          00080077
000900 DATE-COMPILED.                                                   00090077
001000***************************************************************** 00100077
001100***************************************************************** 00110077
001200*  THIS PROGRAM WILL CREATE THE LISTING OF INPROCESS AUDITS     * 00120077
001300***************************************************************** 00130077
001400*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00140077
001500*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00150077
001600*                                                               * 00160077
001400*  CHANGED 10/13/14 BY CHERI PARMLEY                            * 00161082
001500*   CHG# 0094517 EXPANDED PO# FROM 7 TO 8 DIGITS                * 00162082
001700***************************************************************** 00170077
001800***************************************************************** 00180077
001900 ENVIRONMENT DIVISION.                                            00190077
002000***************************************************************** 00200077
002100                                                                  00210077
002200 CONFIGURATION SECTION.                                           00220077
002300                                                                  00230077
002400 SOURCE-COMPUTER.        IBM-3090.                                00240077
002500 OBJECT-COMPUTER.        IBM-3090.                                00250077
002600                                                                  00260077
002700 INPUT-OUTPUT SECTION.                                            00270077
002800                                                                  00280077
002900 FILE-CONTROL.                                                    00290077
003000*                                                                 00300077
003100     SELECT CARTON-FILE                                           00310077
003200         ASSIGN TO INP01.                                         00320077
003300                                                                  00330077
003400     SELECT SU-CARTON-AUDIT-RPT-FILE                              00340077
003500         ASSIGN TO RPT01.                                         00350077
003600*                                                                 00360077
003700***************************************************************** 00370077
003800 DATA DIVISION.                                                   00380077
003900***************************************************************** 00390077
004000*                                                                 00400077
004100 FILE SECTION.                                                    00410077
004200*                                                                 00420077
004300 FD  CARTON-FILE                                                  00430077
004400     RECORDING MODE IS F                                          00440077
004500     BLOCK CONTAINS 0  RECORDS.                                   00450077
004600 01  CARTON-RECORD                   PIC  X(200).                 00460077
004700*                                                                 00470077
004800 FD  SU-CARTON-AUDIT-RPT-FILE                                     00480077
004900     RECORDING MODE IS F                                          00490077
005000     BLOCK CONTAINS 0  RECORDS.                                   00500077
005100 01  SU-CARTON-AUDIT-RPT-RECORD      PIC  X(132).                 00510077
005200*                                                                 00520077
005300                                                                  00530077
005400 WORKING-STORAGE SECTION.                                         00540077
005500*                                                                 00550077
005600 01  PROGRAM-SWITCHES.                                            00560077
005700     05  PS-END-OF-CARTON-FILE-SW    PIC  X(01)    VALUE 'N'.     00570077
005800         88  PS-END-OF-CARTON-FILE                 VALUE 'Y'.     00580077
005900         88  PS-NOT-END-OF-CARTON-FILE             VALUE 'N'.     00590077
006000     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00600077
006100         88  PS-FIRST-TIME                         VALUE 'Y'.     00610077
006200         88  PS-NOT-FIRST-TIME                     VALUE 'N'.     00620077
006300     05  PS-ERROR-FOUND-SW           PIC  X(01)    VALUE 'N'.     00630077
006400         88  PS-ERROR-FOUND                        VALUE 'Y'.     00640077
006500         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00650077
006600     05  PS-RECEIVER-ERROR-SW        PIC  X(01)    VALUE 'N'.     00660077
006700         88  PS-RECEIVER-ERROR                     VALUE 'Y'.     00670077
006800         88  PS-NO-RECEIVER-ERROR                  VALUE 'N'.     00680077
006900     05  PS-PRINT-SW                 PIC  X(01)    VALUE 'N'.     00690077
007000         88  PS-PRINT-ALL                          VALUE 'Y'.     00700077
007100         88  PS-PRINT-ONLY-DC                      VALUE 'N'.     00710077
007200*                                                                 00720077
007300 01  PC-CONSTANTS.                                                00730077
007400     05  PC-1                        PIC S9(03)    VALUE +1       00740077
007500                                                   COMP-3.        00750077
007600     05  PC-2                        PIC S9(03)    VALUE +2       00760077
007700                                                   COMP-3.        00770077
007800     05  PC-3                        PIC S9(03)    VALUE +3       00780077
007900                                                   COMP-3.        00790077
008000     05  PC-7                        PIC S9(01)    VALUE +7.      00800077
008100     05  PC-12                       PIC S9(03)    VALUE +12      00810077
008200                                                   COMP-3.        00820077
008300     05  PC-60                       PIC S9(03)    VALUE +60      00830077
008400                                                   COMP-3.        00840077
008500     05  PC-DASH                     PIC  X(01)    VALUE '-'.     00850077
008600     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00860077
008700     05  PC-00                       PIC  X(02)    VALUE '00'.    00870077
008800     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    00880077
008900     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     00890077
009000     05  PC-SUKRP014                 PIC  X(08)    VALUE          00900077
009100         'SUKRP014'.                                              00910077
009200     05  PC-100-PCT-CHECK            PIC  X(05)    VALUE          00920077
009300         '100% '.                                                 00930077
009400     05  PC-SPOT-CHECK               PIC  X(05)    VALUE          00940077
009500         'SPOT '.                                                 00950077
009600     05  PC-REWORK                   PIC  X(05)    VALUE          00960077
009700         'REWRK'.                                                 00970077
009800     05  PC-DATE-SPACE               PIC  X(10)    VALUE          00980077
009900         '  /  /    '.                                            00990077
010000     05  PC-TIME-SPACE               PIC  X(05)    VALUE          01000077
010100         '  :  '.                                                 01010077
010200     05  PC-IN-PROCESS               PIC  X(10)    VALUE          01020077
010300         'IN PROCESS'.                                            01030077
010400     05  PC-COMPLETE                 PIC  X(10)    VALUE          01040077
010500         '  COMPLETE'.                                            01050077
010600     05  PC-UNKNOWN                  PIC  X(10)    VALUE          01060077
010700         'UNKNOWN   '.                                            01070077
010800     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          01080077
010900         '9999-09-09-09.09.09.999999'.                            01090077
011000     05  PC-OVER-SHORT-MSG           PIC  X(28)    VALUE          01100077
011100         'RCVR LEVEL OVER/SHORT EXISTS'.                          01110077
011200     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01120077
011300     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01130077
011400     05  PC-MAX-REPORT-LINES         PIC S9(04)  VALUE +62        01140077
011500                                                  COMP SYNC.      01150077
011600*                                                                 01160077
011700 01  PV-MISC-FIELDS.                                              01170077
011800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01180077
011900                                                   COMP-3.        01190077
012000     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01200077
012100                                                   COMP-3.        01210077
012200     05  PV-ERROR-COUNT              PIC S9(04)    VALUE ZERO     01220077
012300                                                   COMP SYNC.     01230077
012400     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     01240077
012500                                                   COMP SYNC.     01250077
012600     05  PV-EXPTED-QTY               PIC S9(04)    VALUE ZERO     01260077
012700                                                   COMP SYNC.     01270077
012800     05  PV-AUDIT-DURATION-TIME      PIC S9(09)    VALUE ZERO     01280077
012900                                                   COMP SYNC.     01290077
013000     05  PV-AUDIT-DURATION-HOURS     PIC S9(09)    VALUE ZERO     01300077
013100                                                   COMP SYNC.     01310077
013200     05  PV-AUDIT-DURATION-MINUTES   PIC S9(09)    VALUE ZERO     01320077
013300                                                   COMP SYNC.     01330077
013400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01340077
013500                                                   COMP SYNC.     01350077
013600     05  PV-CARTONS-IN-ERROR         PIC S9(09)    VALUE ZERO     01360077
013700                                                   COMP SYNC.     01370077
013800     05  PV-CARTONS-IN-AUDIT         PIC S9(09)    VALUE ZERO     01380077
013900                                                   COMP SYNC.     01390077
014000     05  PV-CURR-SHIPT-UNT-ID        PIC S9(18)    VALUE ZERO     01400077
014100                                                   COMP-3.        01410077
014200     05  PV-PCT-CTNS-IN-ERROR        PIC S9(03)V99 VALUE ZERO     01420077
014300                                                   COMP-3.        01430077
014400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01440077
014500     05  PV-AUD-CNTL-NBR             PIC  9(09)    VALUE ZERO.    01450077
014600     05  PV-CURR-AUD-CNTL-NBR        PIC  9(09)    VALUE ZERO.    01460077
014700     05  PV-PREV-AUD-CNTL-NBR        PIC  9(09)    VALUE ZERO.    01470077
014800     05  PV-OPER-UNT-ID              PIC  9(04)    VALUE ZERO.    01480077
014900     05  PV-PREV-OPER-UNT-ID         PIC  S9(04)   COMP VALUE 0.  01490077
      *CLP 10/13/14 START                                               01491081
015000     05  PV-PO-RECEIVER.                                          01500077
015100         10  PV-PO                   PIC  ZZZZZZZ9  VALUE ZERO.   01510081
015200         10  FILLER                  PIC  X(01)    VALUE '-'.     01520077
015300         10  PV-RECEIVER             PIC  9(04)    VALUE ZERO.    01530077
015400     05  PV-CURR-PO-RECEIVER.                                     01540077
015500         10  PV-CURR-PO-NBR          PIC  ZZZZZZZ9  VALUE ZERO.   01550081
015600         10  PV-CURR-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01560077
015700     05  PV-PREV-PO-RECEIVER.                                     01570077
015800         10  PV-PREV-PO-NBR          PIC  ZZZZZZZ9  VALUE ZERO.   01580081
015900         10  PV-PREV-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01590077
016000     05  PV-KEY-PO-RECEIVER.                                      01600077
016100         10  PV-KEY-PO-NBR           PIC  ZZZZZZZ9  VALUE ZERO.   01610081
016200         10  PV-KEY-REC-SEQ-NBR      PIC  9(04)    VALUE ZERO.    01620077
      *CLP 10/13/14 END                                                 01621081
016300     05  PV-TODAYS-DATE.                                          01630077
016400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01640077
016500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01650077
016600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01660077
016700     05  PV-TODAYS-TIME.                                          01670077
016800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01680077
016900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01690077
017000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01700077
017100         10  FILLER                  PIC  9(02)    VALUE ZERO.    01710077
017200     05  PV-DB2-DATE.                                             01720077
017300         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01730077
017400         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    01740077
017500         10  FILLER                  PIC  X(01)    VALUE ZERO.    01750077
017600         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    01760077
017700         10  FILLER                  PIC  X(01)    VALUE ZERO.    01770077
017800         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    01780077
017900     05  PV-DB2-TMST.                                             01790077
018000         10 PV-DB2-TMST-CCYY          PIC  9(04).                 01800077
018100         10 FILLER                    PIC  X(01).                 01810077
018200         10 PV-DB2-TMST-MM            PIC  9(02).                 01820077
018300         10 FILLER                    PIC  X(01).                 01830077
018400         10 PV-DB2-TMST-DD            PIC  9(02).                 01840077
018500         10 FILLER                    PIC  X(01).                 01850077
018600         10 PV-DB2-TMST-HH            PIC  9(02).                 01860077
018700         10 FILLER                    PIC  X(01).                 01870077
018800         10 PV-DB2-TMST-MN            PIC  9(02).                 01880077
018900         10 FILLER                    PIC  X(01).                 01890077
019000         10 PV-DB2-TMST-SS            PIC  9(02).                 01900077
019100         10 FILLER                    PIC  X(07).                 01910077
019200     05  PV-FORMAT-DATE.                                          01920077
019300         10 PV-FORMAT-DATE-MM         PIC  9(02).                 01930077
019400         10 FILLER                    PIC  X(01) VALUE '/'.       01940077
019500         10 PV-FORMAT-DATE-DD         PIC  9(02).                 01950077
019600         10 FILLER                    PIC  X(01) VALUE '/'.       01960077
019700         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 01970077
019800     05  PV-FORMAT-TIME.                                          01980077
019900         10 PV-FORMAT-TIME-HH         PIC  9(02).                 01990077
020000         10 FILLER                    PIC  X(01) VALUE ':'.       02000077
020100         10 PV-FORMAT-TIME-MN         PIC  9(02).                 02010077
020200*                                                                 02020077
020300******************************************************************02030077
020400* COPY BOOK CONTAINING THE LAYOUT OF THE CARTON LEVEL AUDIT       02040077
020500* EXTRACT FILE                                                    02050077
020600******************************************************************02060077
020700 01  SU003-COPYBOOK.                                              02070077
020800     COPY SURD003.                                                02080077
020900/                                                                 02090080
021000*  LOGISTICS DOMAIN LOCATION MODULE                               02091080
021100*                                                                 02092080
021200     COPY XLWS071.                                                02093080
021300/                                                                 02094080
021400******************************************************************02110077
021500* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     02120077
021600******************************************************************02130077
021700     COPY DSWS004.                                                02140077
021800                                                                  02150077
021900******************************************************************02160077
022000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02170077
022100******************************************************************02180077
022200     COPY DPWS132O.                                               02190077
022300*                                                                 02200077
022400*                                                                 02210077
022500 01  HEADING-LINES.                                               02220077
022600     05  HEADING-LINE-0.                                          02230077
022700         10  FILLER                  PIC  X(52)    VALUE SPACES.  02240077
022800         10  FILLER                  PIC  X(28)    VALUE          02250077
022900             'VENDOR ACCURACY CARTON AUDIT'.                      02260077
023000         10  FILLER                  PIC  X(52)    VALUE SPACES.  02270077
023100*                                                                 02280077
023200     05  HEADING-LINE-1.                                          02290077
023300         10  FILLER                  PIC  X(52)    VALUE SPACES.  02300077
023400         10  FILLER                  PIC  X(28)    VALUE          02310077
023500             'LISTING OF INPROCESS AUDITS '.                      02320077
023600         10  FILLER                  PIC  X(52)    VALUE SPACES.  02330077
023700*                                                                 02340077
023800     05  HEADING-LINE-2.                                          02350077
023900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02360077
024000         10  FILLER                  PIC  X(12)    VALUE          02370077
024100             'FACILITY -  '.                                      02380077
024200         10  HL2-FACILITY            PIC  X(04)    VALUE SPACES.  02390077
024300         10  FILLER                  PIC  X(03)    VALUE ' - '.   02400077
024400         10  HL2-FACILITY-DESC       PIC  X(22)    VALUE SPACES.  02410077
024500         10  FILLER                  PIC  X(89)    VALUE SPACES.  02420077
024600                                                                  02430077
024700     05  HEADING-LINE-3.                                          02440077
024800         10  FILLER                  PIC  X(04)    VALUE SPACE.   02450077
024900         10  FILLER                  PIC  X(18)    VALUE          02460077
025000             'AUDIT    AUD   AUD'.                                02470077
025100         10  FILLER                  PIC  X(69)    VALUE SPACE.   02480077
025200         10  FILLER                  PIC  X(40)    VALUE          02490077
025300             'RECEIPT   CART    ADJ     AUDIT   CARTON'.          02500077
025400                                                                  02510077
025500                                                                  02520077
025600     05  HEADING-LINE-4.                                          02530077
025700         10  FILLER                  PIC  X(01)    VALUE SPACE.   02540077
025800         10  FILLER                  PIC  X(46)    VALUE          02550077
025900             'CONTROL NBR TYPE  AREA ST    AUDIT START      '.    02560077
026000         10  FILLER                  PIC  X(45)    VALUE          02570077
      *CLP 10/13/14                                                     02571082
026100             'AUDIT STOP    PO/RECEIVER   VENDOR NAME      '.     02580082
026200         10  FILLER                  PIC  X(39)    VALUE          02590077
026300             'DATE     COUNT   CARTON  CARTON  IN ERR'.           02600077
026400*                                                                 02610077
026500 01  MISCELLANEOUS-LINES.                                         02620077
026600     05  END-OF-REPORT-LINE.                                      02630077
026700         10  FILLER                  PIC  X(44)    VALUE SPACES.  02640077
026800         10  FILLER                  PIC  X(45)    VALUE          02650077
026900             '*******   E N D   O F   R E P O R T   *******'.     02660077
027000         10  FILLER                  PIC  X(43)    VALUE SPACES.  02670077
027100*                                                                 02680077
027200 01  ER-EMPTY-REPORT-LINE.                                        02690077
027300     05  FILLER                          PIC  X(88)  VALUE SPACE. 02700077
027400     05  FILLER                          PIC  X(25)  VALUE        02710077
027500         '******* NO DATA *********'.                             02720077
027600     05  FILLER                          PIC  X(87)  VALUE SPACE. 02730077
027700*                                                                 02740077
027800 01  DETAIL-LINES.                                                02750077
027900     05  DETAIL-LINE1.                                            02760077
028000         10  FILLER                  PIC  X(01)    VALUE SPACES.  02770077
028100         10  DL1-AUD-CNTL-NBR        PIC  X(11)    VALUE SPACES.  02780077
028200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02790077
028300         10  DL1-AUDIT-TYPE          PIC  X(05)    VALUE SPACES.  02800077
028400         10  FILLER                  PIC  X(01)    VALUE SPACES.  02810077
028500         10  DL1-AUDIT-AREA          PIC  X(04)    VALUE SPACES.  02820077
028600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02830077
028700         10  DL1-AUDIT-ST            PIC  X(02)    VALUE SPACES.  02840077
028800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02850077
028900         10  DL1-AUDIT-START-DATE.                                02860077
029000             15  DL1-AUDIT-START-DATE-MM                          02870077
029100                                     PIC  X(02)    VALUE SPACES.  02880077
029200             15  FILLER              PIC  X(01)    VALUE '/'.     02890077
029300             15  DL1-AUDIT-START-DATE-DD                          02900077
029400                                     PIC  X(02)    VALUE SPACES.  02910077
029500             15  FILLER              PIC  X(01)    VALUE '/'.     02920077
029600             15  DL1-AUDIT-START-DATE-CCYY                        02930077
029700                                     PIC  X(04)    VALUE SPACES.  02940077
029800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02950077
029900         10  DL1-AUDIT-START-TIME.                                02960077
030000             15  DL1-AUDIT-START-TIME-HH                          02970077
030100                                     PIC  X(02)    VALUE SPACES.  02980077
030200             15  FILLER              PIC  X(01)    VALUE ':'.     02990077
030300             15  DL1-AUDIT-START-TIME-MN                          03000077
030400                                     PIC  X(02)    VALUE SPACES.  03010077
030500         10  FILLER                  PIC  X(01)    VALUE SPACES.  03020077
030600         10  DL1-AUDIT-STOP-DATE.                                 03030077
030700             15  DL1-AUDIT-STOP-DATE-MM                           03040077
030800                                     PIC  X(02)    VALUE SPACES.  03050077
030900             15  FILLER              PIC  X(01)    VALUE '/'.     03060077
031000             15  DL1-AUDIT-STOP-DATE-DD                           03070077
031100                                     PIC  X(02)    VALUE SPACES.  03080077
031200             15  FILLER              PIC  X(01)    VALUE '/'.     03090077
031300             15  DL1-AUDIT-STOP-DATE-CCYY                         03100077
031400                                     PIC  X(04)    VALUE SPACES.  03110077
031500         10  FILLER                  PIC  X(01)    VALUE SPACES.  03120077
031600         10  DL1-AUDIT-STOP-TIME.                                 03130077
031700             15  DL1-AUDIT-STOP-TIME-HH                           03140077
031800                                     PIC  X(02)    VALUE SPACES.  03150077
031900             15  FILLER              PIC  X(01)    VALUE ':'.     03160077
032000             15  DL1-AUDIT-STOP-TIME-MN                           03170077
032100                                     PIC  X(02)    VALUE SPACES.  03180077
032200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03190077
      *CLP 10/13/14 START                                               03191082
032300         10  DL1-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  03200082
032400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03210077
032500         10  DL1-VENDOR-NAME         PIC  X(14)    VALUE SPACES.  03220082
      *CLP 10/13/14 END                                                 03221082
032600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03230077
032700         10  DL1-DATE-RCVD.                                       03240077
032800             15  DL1-DATE-RCVD-MM    PIC  X(02)    VALUE SPACES.  03250077
032900             15  FILLER              PIC  X(01)    VALUE '/'.     03260077
033000             15  DL1-DATE-RCVD-DD    PIC  X(02)    VALUE SPACES.  03270077
033100             15  FILLER              PIC  X(01)    VALUE '/'.     03280077
033200             15  DL1-DATE-RCVD-CCYY  PIC  X(04)    VALUE SPACES.  03290077
033300         10  FILLER                  PIC  X(01)    VALUE SPACES.  03300077
033400         10  DL1-EXPTED-CART-CNT     PIC  ZZZZZZ9  VALUE ZEROES.  03310077
033500         10  FILLER                  PIC  X(01)    VALUE SPACES.  03320077
033600         10  DL1-ADJ-CART-CNT        PIC  ZZZZZZ9  VALUE ZEROES.  03330077
033700         10  FILLER                  PIC  X(01)    VALUE SPACES.  03340077
033800         10  DL1-AUDITED-CART-CNT    PIC  ZZZZZZ9  VALUE ZEROES.  03350077
033900         10  FILLER                  PIC  X(01)    VALUE SPACES.  03360077
034000         10  DL1-CARTONS-IN-ERROR    PIC  ZZZZZZ9  VALUE ZEROES.  03370077
034100                                                                  03380077
034200 01  CC-CONTROL-CARD.                                             03390077
034300     05  CC-PRINTER-ID                PIC  X(08).                 03400077
034400     05  CC-PRTR-CNTL-IND             PIC  X(01).                 03410077
034500     05  CC-TRACK-NBR                 PIC  9(01).                 03420077
034600*DMB 9/18/01                                                      03430077
034700     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    03440077
034800     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    03450077
034900                                                                  03460077
035000*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE (TSUNAUD)          03470077
035100*                                                                 03480077
035200     EXEC SQL                                                     03490077
035300          INCLUDE TSUNAUD                                         03500077
035400     END-EXEC.                                                    03510077
035500*                                                                 03520077
035600*  COPY BOOK FOR SHIPPING UNIT AUDIT TRANSACTIONS TABLE           03530077
035700*  (TSUATRN)                                                      03540077
035800*                                                                 03550077
035900     EXEC SQL                                                     03560077
036000          INCLUDE TSUATRN                                         03570077
036100     END-EXEC.                                                    03580077
036200*                                                                 03590077
036300*  COPY BOOK FOR THE SHIPPING UNIT AUDIT EXCEPTION TABLE          03600077
036400*  (TSUEXCP)                                                      03610077
036500*                                                                 03620077
036600     EXEC SQL                                                     03630077
036700          INCLUDE TSUEXCP                                         03640077
036800     END-EXEC.                                                    03650077
036900*                                                                 03660077
037000*  COPY BOOK FOR RECEIVER TABLE (TRECEIV)                         03670077
037100*                                                                 03680077
037200     EXEC SQL                                                     03690077
037300          INCLUDE TRECEIV                                         03700077
037400     END-EXEC.                                                    03710077
037500*                                                                 03720077
037600*  COPY BOOK FOR THE PURCHASE ORDER TABLE (TPURCHS)               03730077
037700*                                                                 03740077
037800     EXEC SQL                                                     03750077
037900          INCLUDE TPURCHS                                         03760077
038000     END-EXEC.                                                    03770077
038100*                                                                 03840077
038200*  COPY BOOK FOR THE ENTITY NAME TABLE (TENTNME)                  03850077
038300*                                                                 03860077
038400     EXEC SQL                                                     03870077
038500          INCLUDE TENTNME                                         03880077
038600     END-EXEC.                                                    03890077
038700 EJECT                                                            03900077
038800*  COPY BOOK FOR THE PRINTER TABLE                                03910077
038900*                                                                 03920077
039000     EXEC SQL                                                     03930077
039100          INCLUDE TPRTRID                                         03940077
039200     END-EXEC.                                                    03950077
039300 EJECT                                                            03960077
039400*  DB2 COMMUNICATION AREA                                         03970077
039500*                                                                 03980077
039600     EXEC SQL                                                     03990077
039700         INCLUDE SQLCA                                            04000077
039800     END-EXEC.                                                    04010077
039900 EJECT                                                            04020077
040000*  DB2 COMMUNICATION AREA2                                        04030077
040100*                                                                 04040077
040200     COPY SQLCA2.                                                 04050077
040300                                                                  04060077
040400 EJECT                                                            04070077
040500                                                                  04080077
040600 PROCEDURE DIVISION.                                              04090077
040700*                                                                 04100077
040800 0000-MAINLINE-PROCESSING.                                        04110077
040900******************************************************************04120077
041000**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      04130077
041100******************************************************************04140077
041200     OPEN INPUT  CARTON-FILE                                      04150077
041300          OUTPUT SU-CARTON-AUDIT-RPT-FILE.                        04160077
041400*                                                                 04170077
041500     PERFORM 1000-INITIALIZATION.                                 04180077
041600*                                                                 04190077
041700     IF PS-END-OF-CARTON-FILE                                     04200077
041800         WRITE SU-CARTON-AUDIT-RPT-RECORD                         04210077
041900         FROM  ER-EMPTY-REPORT-LINE                               04220077
042000             AFTER ADVANCING 2 LINES                              04230077
042100     ELSE                                                         04240077
042200         PERFORM 2000-PROCESS-SU                                  04250077
042300             UNTIL PS-END-OF-CARTON-FILE                          04260077
042400*                                                                 04270077
042500         IF  PS-ERROR-FOUND                                       04280077
042600             ADD +1             TO PV-CARTONS-IN-ERROR            04290077
042700             SET PS-NO-ERROR-FOUND TO TRUE                        04300077
042800         END-IF                                                   04310077
042900         MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR        04320077
043000*                                                                 04330077
043100         PERFORM 8400-WRITE-DETAIL-LINES                          04340077
043200                                                                  04350077
043300      END-IF.                                                     04360077
043400*                                                                 04370077
043500      WRITE SU-CARTON-AUDIT-RPT-RECORD                            04380077
043600        FROM END-OF-REPORT-LINE                                   04390077
043700          AFTER ADVANCING 2 LINES.                                04400077
043800                                                                  04410077
043900*DMB 9/18/01        IF CC-PRTR-CNTL-IND = 'P'                     04420077
044000     IF CC-PRTR-CUT-IND = 'Y'                                     04430077
044100         WRITE SU-CARTON-AUDIT-RPT-RECORD                         04440077
044200              FROM DS004-PLC-CUT-FORM                             04450077
044300          AFTER ADVANCING 1 LINE                                  04460077
044400      END-IF.                                                     04470077
044500                                                                  04480077
044600                                                                  04490077
044700     CLOSE CARTON-FILE                                            04500077
044800           SU-CARTON-AUDIT-RPT-FILE.                              04510077
044900*                                                                 04520077
045000     GOBACK.                                                      04530077
045100*                                                                 04540077
045200*                                                                 04550077
045300 1000-INITIALIZATION.                                             04560077
045400******************************************************************04570077
045500**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04580077
045600******************************************************************04590077
045700     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04600077
045800     DISPLAY 'PRINTER CONTROL CARD = ' CC-CONTROL-CARD.           04610077
045900                                                                  04620077
046000     PERFORM 1200-SELECT-TPRTRID.                                 04630077
046100                                                                  04640077
046200     IF PRTRID-PRTR-OPER-UNT-ID = 90                              04650077
046300        SET PS-PRINT-ALL TO TRUE                                  04660077
046400     END-IF.                                                      04670077
046500                                                                  04680077
046600     ACCEPT PV-TODAYS-DATE                                        04690077
046700       FROM DATE.                                                 04700077
046800*                                                                 04710077
046900     ACCEPT PV-TODAYS-TIME                                        04720077
047000       FROM TIME.                                                 04730077
047100*                                                                 04740077
047200     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04750077
047300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 04760077
047400     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   04770077
047500     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  04780077
047600*                                                                 04790077
047700     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04800077
047800     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04810077
047900     MOVE PC-SUKRP014        TO DP132O-PROGRAM-NAME.              04820077
048000                                                                  04830077
048100     PERFORM 7000-READ-CARTON-EXTRACT.                            04840077
048200                                                                  04850077
048300     IF PS-END-OF-CARTON-FILE                                     04860077
048400         CONTINUE                                                 04870077
048500     ELSE                                                         04880077
048600         IF PS-PRINT-ALL                                          04890077
048700            CONTINUE                                              04900077
048800        ELSE                                                      04910077
048900            IF PRTRID-PRTR-OPER-UNT-ID = SU003-AUD-OPER-UNT-ID    04920077
049000               CONTINUE                                           04930077
049100            ELSE                                                  04940077
049200               PERFORM 7000-READ-CARTON-EXTRACT UNTIL             04950077
049300               PRTRID-PRTR-OPER-UNT-ID = SU003-AUD-OPER-UNT-ID OR 04960077
049400               PS-END-OF-CARTON-FILE                              04970077
049500            END-IF                                                04980077
049600        END-IF                                                    04990077
049700     END-IF.                                                      05000077
049800                                                                  05010077
049900     IF PS-END-OF-CARTON-FILE                                     05020077
050000        CONTINUE                                                  05030077
050100     ELSE                                                         05040077
050200        PERFORM 1400-GET-AUDIT-INFO                               05050077
050300        PERFORM 1500-GET-PO-INFO                                  05060077
050400                                                                  05070077
050500        SET PS-FIRST-TIME     TO TRUE                             05080077
050600                                                                  05090077
050700        MOVE SU003-PO-NBR       TO PV-CURR-PO-NBR                 05100077
050800                                   PV-PREV-PO-NBR                 05110077
050900        MOVE SU003-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR            05120077
051000                                   PV-PREV-REC-SEQ-NBR            05130077
051100        MOVE SU003-AUD-CNTL-NBR TO PV-CURR-AUD-CNTL-NBR           05140077
051200                                   PV-PREV-AUD-CNTL-NBR           05150077
051300                                   PV-AUD-CNTL-NBR                05160077
051400        MOVE SU003-AUD-OPER-UNT-ID                                05170077
051500                                TO PV-PREV-OPER-UNT-ID            05180077
051600        MOVE SU003-SHIPT-UNT-ID                                   05190077
051700                           TO PV-CURR-SHIPT-UNT-ID                05200077
051800                                                                  05210077
051900        MOVE PC-MAX-REPORT-LINES                                  05220077
052000                              TO PV-LINE-CNT                      05230077
052100        MOVE +0               TO PV-PAGE-CNT                      05240077
052200        PERFORM 1300-LOCATION-NAME                                05250080
052300                                                                  05260077
052400        MOVE SUNAUD-OPER-UNT-ID   TO PV-OPER-UNT-ID               05270077
052500        MOVE PV-OPER-UNT-ID       TO HL2-FACILITY                 05280077
052600        MOVE XL071-LOC-NM         TO HL2-FACILITY-DESC            05290080
052700     END-IF.                                                      05300077
052800                                                                  05310077
052900*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  05320077
053000     IF CC-PRTR-CNTL-IND = 'P'                                    05330077
053100         MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR     05340077
053200         MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI          05350077
053300                                                                  05360077
053400         WRITE SU-CARTON-AUDIT-RPT-RECORD                         05370077
053500             FROM DS004-PLC-LOAD-FORM                             05380077
053600         AFTER ADVANCING 1 LINE                                   05390077
053700     END-IF.                                                      05400077
053800                                                                  05410077
053900     PERFORM 8000-WRITE-REPORT-HEADERS.                           05420077
054000                                                                  05430077
054100*                                                                 05440077
054200 1100-SELECT-TSUNAUD.                                             05450077
054300******************************************************************05460077
054400**  SELECT INFORMATION FROM THE SHIPPING UNIT AUDIT TABLE FOR THE 05470077
054500**  HEADER PORTION OF THE REPORT.                                 05480077
054600******************************************************************05490077
054700     INITIALIZE DCLTSUNAUD.                                       05500077
054800                                                                  05510077
054900     MOVE '1100-SELECT-TSUNAUD '                                  05520077
055000                                 TO PV-ABEND-PARAGRAPH.           05530077
055100     EXEC SQL                                                     05540077
055200       SELECT  AUD_STRT_TMST                                      05550077
055300              ,AUD_STP_TMST                                       05560077
055400              ,AUD_PSPND_MNIT_QTY                                 05570077
055500              ,AUD_CLO_MNIT_QTY                                   05580077
055600              ,OPER_UNT_ID                                        05590077
055700              ,FCLTY_ID                                           05600077
055800              ,PRC_FCLTY_AREA_ID                                  05610077
055900              ,AUD_STAT_CDE                                       05620077
056000              ,AUD_TYP_CDE                                        05630077
056100         INTO  :SUNAUD-AUD-STRT-TMST                              05640077
056200              ,:SUNAUD-AUD-STP-TMST                               05650077
056300              ,:SUNAUD-AUD-PSPND-MNIT-QTY                         05660077
056400              ,:SUNAUD-AUD-CLO-MNIT-QTY                           05670077
056500              ,:SUNAUD-OPER-UNT-ID                                05680077
056600              ,:SUNAUD-FCLTY-ID                                   05690077
056700              ,:SUNAUD-PRC-FCLTY-AREA-ID                          05700077
056800              ,:SUNAUD-AUD-STAT-CDE                               05710077
056900              ,:SUNAUD-AUD-TYP-CDE                                05720077
057000         FROM  TSUNAUD                                            05730077
057100        WHERE  AUD_CNTL_NBR = :SU003-AUD-CNTL-NBR                 05740077
057200     END-EXEC.                                                    05750077
057300                                                                  05760077
057400     EVALUATE TRUE                                                05770077
057500       WHEN SQLCODE = ZEROS                                       05780077
057600         CONTINUE                                                 05790077
057700       WHEN OTHER                                                 05800077
057800         DISPLAY PV-ABEND-PARAGRAPH                               05810077
057900         PERFORM Z999-SQL-ERROR                                   05820077
058000     END-EVALUATE.                                                05830077
058100                                                                  05840077
058200*                                                                 05850077
058300 1200-SELECT-TPRTRID.                                             05860077
058400******************************************************************05870077
058500**  SELECT INFORMATION FROM THE PRINTER TABLE FOR THE PRINTER ID  05880077
058600**  BEING USED.                                                   05890077
058700******************************************************************05900077
058800     INITIALIZE DCLTPRTRID.                                       05910077
058900                                                                  05920077
059000     MOVE '1200-SELECT-TRPTRID '                                  05930077
059100                                 TO PV-ABEND-PARAGRAPH.           05940077
059200     EXEC SQL                                                     05950077
059300       SELECT  PRTR_OPER_UNT_ID                                   05960077
059400         INTO  :PRTRID-PRTR-OPER-UNT-ID                           05970077
059500         FROM  TPRTRID                                            05980077
059600        WHERE  PRTR_ID      = :CC-PRINTER-ID                      05990077
059700     END-EXEC.                                                    06000077
059800                                                                  06010077
059900     EVALUATE TRUE                                                06020077
060000       WHEN SQLCODE = ZEROS                                       06030077
060100         CONTINUE                                                 06040077
060200       WHEN SQLCODE = +100                                        06050077
060300         MOVE 0 TO PRTRID-PRTR-OPER-UNT-ID                        06060077
060400       WHEN SQLCODE = -811                                        06070077
060500         MOVE 90 TO PRTRID-PRTR-OPER-UNT-ID                       06080077
060600       WHEN OTHER                                                 06090077
060700         DISPLAY PV-ABEND-PARAGRAPH                               06100077
060800         PERFORM Z999-SQL-ERROR                                   06110077
060900     END-EVALUATE.                                                06120077
061000                                                                  06130077
061100*                                                                 06140077
061200 1300-LOCATION-NAME.                                              06150080
061300                                                                  06160080
061400     MOVE '1300-LOCATION-NAME'    TO PV-ABEND-PARAGRAPH.          06191080
061500                                                                  06192080
061600     INITIALIZE XL071-COMMAREA-REC.                               06195080
061700     MOVE SUNAUD-OPER-UNT-ID    TO XL071-LOCATION-NUMBER          06196080
061800                                                                  06197080
061900     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06198080
062000                                                                  06199080
062100     EVALUATE TRUE                                                06199180
062200     WHEN XL071-NO-ERRORS                                         06199280
062300         CONTINUE                                                 06199380
062400     WHEN XL071-LOC-NOT-FOUND                                     06199580
062500     WHEN XL071-DC-ASGMT-NOT-FND                                  06199680
062600         MOVE 'UNKNOWN FACILITY' TO XL071-LOC-NM                  06199880
062700     WHEN XL071-BAD-DB2-RETURN                                    06199980
062800         DISPLAY PV-ABEND-PARAGRAPH                               06200080
062900         DISPLAY 'CALL LOCATION MOD '                             06200180
063000         DISPLAY 'XLT00010'                                       06200280
063100         MOVE XL071-SQLCA             TO SQLCA                    06200380
063200         PERFORM Z999-SQL-ERROR                                   06200580
063300     END-EVALUATE.                                                06200780
063400/                                                                 06200880
063500 1400-GET-AUDIT-INFO.                                             06430077
063600     PERFORM 1100-SELECT-TSUNAUD.                                 06440077
063700                                                                  06450077
063800     MOVE SU003-AUD-CNTL-NBR TO PV-AUD-CNTL-NBR                   06460077
063900                                PV-CURR-AUD-CNTL-NBR.             06470077
064000     MOVE PV-AUD-CNTL-NBR    TO DL1-AUD-CNTL-NBR.                 06480077
064100                                                                  06490077
064200     EVALUATE SUNAUD-AUD-TYP-CDE                                  06500077
064300         WHEN '01'                                                06510077
064400             MOVE PC-100-PCT-CHECK TO DL1-AUDIT-TYPE              06520077
064500         WHEN '02'                                                06530077
064600             MOVE PC-SPOT-CHECK    TO DL1-AUDIT-TYPE              06540077
064700         WHEN '03'                                                06550077
064800             MOVE PC-REWORK        TO DL1-AUDIT-TYPE              06560077
064900         WHEN OTHER                                               06570077
065000             MOVE PC-UNKNOWN       TO DL1-AUDIT-TYPE              06580077
065100     END-EVALUATE.                                                06590077
065200                                                                  06600077
065300     EVALUATE SUNAUD-AUD-STAT-CDE                                 06610077
065400         WHEN 'IP'                                                06620077
065500             MOVE 'IP'          TO DL1-AUDIT-ST                   06630077
065600         WHEN 'CM'                                                06640077
065700             MOVE 'CM'          TO DL1-AUDIT-ST                   06650077
065800         WHEN OTHER                                               06660077
065900             MOVE SUNAUD-AUD-STAT-CDE  TO DL1-AUDIT-ST            06670077
066000     END-EVALUATE.                                                06680077
066100                                                                  06690077
066200     MOVE SUNAUD-AUD-STRT-TMST TO PV-DB2-TMST.                    06700077
066300     MOVE PV-DB2-TMST-MM       TO DL1-AUDIT-START-DATE-MM.        06710077
066400     MOVE PV-DB2-TMST-DD       TO DL1-AUDIT-START-DATE-DD.        06720077
066500     MOVE PV-DB2-TMST-CCYY     TO DL1-AUDIT-START-DATE-CCYY.      06730077
066600     MOVE PV-DB2-TMST-HH       TO DL1-AUDIT-START-TIME-HH.        06740077
066700     MOVE PV-DB2-TMST-MN       TO DL1-AUDIT-START-TIME-MN.        06750077
066800                                                                  06760077
066900     IF  SUNAUD-AUD-STP-TMST = PC-DEFAULT-TMST                    06770077
067000         MOVE SPACES TO DL1-AUDIT-STOP-DATE                       06780077
067100                        DL1-AUDIT-STOP-TIME                       06790077
067200     ELSE                                                         06800077
067300         INITIALIZE DL1-AUDIT-STOP-DATE                           06810077
067400                    DL1-AUDIT-STOP-TIME                           06820077
067500         MOVE SUNAUD-AUD-STP-TMST                                 06830077
067600                               TO PV-DB2-TMST                     06840077
067700         MOVE PV-DB2-TMST-MM   TO DL1-AUDIT-STOP-DATE-MM          06850077
067800         MOVE PV-DB2-TMST-DD   TO DL1-AUDIT-STOP-DATE-DD          06860077
067900         MOVE PV-DB2-TMST-CCYY TO DL1-AUDIT-STOP-DATE-CCYY        06870077
068000         MOVE PV-DB2-TMST-HH   TO DL1-AUDIT-STOP-TIME-HH          06880077
068100         MOVE PV-DB2-TMST-MN   TO DL1-AUDIT-STOP-TIME-MN          06890077
068200     END-IF.                                                      06900077
068300                                                                  06910077
068400     MOVE SUNAUD-PRC-FCLTY-AREA-ID                                06920077
068500                               TO DL1-AUDIT-AREA.                 06930077
068600*                                                                 06940077
068700                                                                  06950077
068800 1500-GET-PO-INFO.                                                06960077
068900     MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER.              06970077
069000                                                                  06980077
069100     PERFORM 2100-FETCH-TRECEIV-INFO.                             06990077
069200                                                                  07000077
069300     PERFORM 2150-SELECT-ENTNME.                                  07010077
069400     MOVE ENTNME-ENT-NAME-DESC   TO DL1-VENDOR-NAME.              07020077
069500                                                                  07030077
069600     IF RECEIV-REC-TMST = SPACE                                   07040077
069700         MOVE SPACES TO                                           07050077
069800                        DL1-DATE-RCVD                             07060077
069900     ELSE                                                         07070077
070000         MOVE PC-DATE-SPACE          TO DL1-DATE-RCVD             07080077
070100         MOVE RECEIV-REC-TMST        TO PV-DB2-TMST               07090077
070200         MOVE PV-DB2-TMST-MM         TO DL1-DATE-RCVD-MM          07100077
070300         MOVE PV-DB2-TMST-DD         TO DL1-DATE-RCVD-DD          07110077
070400         MOVE PV-DB2-TMST-CCYY       TO DL1-DATE-RCVD-CCYY        07120077
070500     END-IF.                                                      07130077
070600     MOVE RECEIV-EXPTED-CART-CNT TO DL1-EXPTED-CART-CNT.          07140077
070700     MOVE RECEIV-ACTL-CART-CNT   TO DL1-ADJ-CART-CNT.             07150077
070800                                                                  07160077
070900     PERFORM 2200-FETCH-TSUATRN-INFO.                             07170077
071000                                                                  07180077
071100     MOVE PV-CARTONS-IN-AUDIT    TO DL1-AUDITED-CART-CNT.         07190077
071200                                                                  07200077
071300 2000-PROCESS-SU.                                                 07210077
071400******************************************************************07220077
071500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *07230077
071600*  VENDOR ACCURACY CARTON AUDIT REPORT.                          *07240077
071700******************************************************************07250077
071800     IF  SU003-AUD-OPER-UNT-ID =  PV-PREV-OPER-UNT-ID             07260077
071900        IF  PV-CURR-AUD-CNTL-NBR  =  PV-PREV-AUD-CNTL-NBR         07270077
072000            IF  PV-CURR-PO-RECEIVER = PV-PREV-PO-RECEIVER         07280077
072100                IF  SU003-SHIPT-UNT-ID = PV-CURR-SHIPT-UNT-ID     07290077
072200                     PERFORM 2010-PROCESS-CARTON-ERRORS           07300077
072300                     PERFORM 7000-READ-CARTON-EXTRACT             07310077
072400                ELSE                                              07320077
072500                     MOVE SU003-SHIPT-UNT-ID                      07330077
072600                           TO PV-CURR-SHIPT-UNT-ID                07340077
072700                     IF  PS-ERROR-FOUND                           07350077
072800                         ADD +1             TO PV-CARTONS-IN-ERROR07360077
072900                         SET PS-NO-ERROR-FOUND TO TRUE            07370077
073000                     END-IF                                       07380077
073100                 END-IF                                           07390077
073200            ELSE                                                  07400077
073300                 IF  PS-ERROR-FOUND                               07410077
073400                     ADD +1             TO PV-CARTONS-IN-ERROR    07420077
073500                     SET PS-NO-ERROR-FOUND TO TRUE                07430077
073600                 END-IF                                           07440077
073700                 MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR07450077
073800                 PERFORM 8400-WRITE-DETAIL-LINES                  07460077
073900*                                                                 07470077
074000                 INITIALIZE PV-CARTONS-IN-ERROR                   07480077
074100                        DL1-CARTONS-IN-ERROR                      07490077
074200                 MOVE PV-CURR-PO-NBR     TO PV-PREV-PO-NBR        07500077
074300                 MOVE PV-CURR-REC-SEQ-NBR TO                      07510077
074400                                        PV-PREV-REC-SEQ-NBR       07520077
074500                 MOVE SU003-SHIPT-UNT-ID                          07530077
074600                           TO PV-CURR-SHIPT-UNT-ID                07540077
074700                 PERFORM 1500-GET-PO-INFO                         07550077
074800                 INITIALIZE                                       07560077
074900                 DL1-AUD-CNTL-NBR                                 07570077
075000                 DL1-AUDIT-TYPE                                   07580077
075100                 DL1-AUDIT-AREA                                   07590077
075200                 DL1-AUDIT-ST                                     07600077
075300                 IF  PS-FIRST-TIME                                07610077
075400                      SET PS-NOT-FIRST-TIME     TO TRUE           07620077
075500                      MOVE SPACES TO                              07630077
075600                      DL1-AUDIT-START-DATE                        07640077
075700                      DL1-AUDIT-START-TIME                        07650077
075800                      DL1-AUDIT-STOP-DATE                         07660077
075900                      DL1-AUDIT-STOP-TIME                         07670077
076000                 ELSE                                             07680077
076100                      CONTINUE                                    07690077
076200                  END-IF                                          07700077
076300        ELSE                                                      07710077
076400             IF  PS-ERROR-FOUND                                   07720077
076500                 ADD +1             TO PV-CARTONS-IN-ERROR        07730077
076600                 SET PS-NO-ERROR-FOUND TO TRUE                    07740077
076700             END-IF                                               07750077
076800             MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR    07760077
076900             PERFORM 8400-WRITE-DETAIL-LINES                      07770077
077000             INITIALIZE PV-CARTONS-IN-ERROR                       07780077
077100                        DL1-CARTONS-IN-ERROR                      07790077
077200             MOVE PC-DATE-SPACE TO                                07800077
077300                        DL1-AUDIT-START-DATE                      07810077
077400                        DL1-AUDIT-STOP-DATE                       07820077
077500             MOVE PC-TIME-SPACE TO                                07830077
077600                        DL1-AUDIT-START-TIME                      07840077
077700                        DL1-AUDIT-STOP-TIME                       07850077
077800             MOVE PV-CURR-PO-NBR     TO PV-PREV-PO-NBR            07860077
077900             MOVE PV-CURR-REC-SEQ-NBR TO                          07870077
078000                                        PV-PREV-REC-SEQ-NBR       07880077
078100             MOVE PV-CURR-AUD-CNTL-NBR TO PV-PREV-AUD-CNTL-NBR    07890077
078200                                        PV-AUD-CNTL-NBR           07900077
078300             MOVE SU003-SHIPT-UNT-ID                              07910077
078400                           TO PV-CURR-SHIPT-UNT-ID                07920077
078500             PERFORM 1400-GET-AUDIT-INFO                          07930077
078600             PERFORM 1500-GET-PO-INFO                             07940077
078700             SET PS-FIRST-TIME     TO TRUE                        07950077
078800             WRITE SU-CARTON-AUDIT-RPT-RECORD                     07960077
078900                  FROM PC-BLANK-LINE                              07970077
079000                    AFTER ADVANCING 1 LINES                       07980077
079100             ADD +1 TO PV-LINE-CNT                                07990077
079200         END-IF                                                   08000077
079300     ELSE                                                         08010077
079400         IF  PS-ERROR-FOUND                                       08020077
079500             ADD +1             TO PV-CARTONS-IN-ERROR            08030077
079600             SET PS-NO-ERROR-FOUND TO TRUE                        08040077
079700         END-IF                                                   08050077
079800         MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR        08060077
079900         PERFORM 8400-WRITE-DETAIL-LINES                          08070077
080000         INITIALIZE PV-CARTONS-IN-ERROR                           08080077
080100                    DL1-CARTONS-IN-ERROR                          08090077
080200         MOVE PC-DATE-SPACE TO                                    08100077
080300                    DL1-AUDIT-START-DATE                          08110077
080400                    DL1-AUDIT-STOP-DATE                           08120077
080500         MOVE PC-TIME-SPACE TO                                    08130077
080600                    DL1-AUDIT-START-TIME                          08140077
080700                    DL1-AUDIT-STOP-TIME                           08150077
080800         PERFORM 1400-GET-AUDIT-INFO                              08160077
080900         PERFORM 1500-GET-PO-INFO                                 08170077
081000         SET PS-FIRST-TIME     TO TRUE                            08180077
081100         WRITE SU-CARTON-AUDIT-RPT-RECORD                         08190077
081200              FROM PC-BLANK-LINE                                  08200077
081300                AFTER ADVANCING 1 LINES                           08210077
081400         ADD +1 TO PV-LINE-CNT                                    08220077
081500         IF PS-PRINT-ALL                                          08230077
081600            MOVE SU003-PO-NBR       TO PV-CURR-PO-NBR             08240077
081700                                       PV-PREV-PO-NBR             08250077
081800            MOVE SU003-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR        08260077
081900                                       PV-PREV-REC-SEQ-NBR        08270077
082000            MOVE SU003-AUD-CNTL-NBR TO PV-CURR-AUD-CNTL-NBR       08280077
082100                                       PV-PREV-AUD-CNTL-NBR       08290077
082200                                       PV-AUD-CNTL-NBR            08300077
082300            MOVE SU003-AUD-OPER-UNT-ID                            08310077
082400                                    TO PV-PREV-OPER-UNT-ID        08320077
082500            MOVE SU003-SHIPT-UNT-ID                               08330077
082600                               TO PV-CURR-SHIPT-UNT-ID            08340077
082700            MOVE PC-MAX-REPORT-LINES                              08350077
082800                                  TO PV-LINE-CNT                  08360077
082900            MOVE +0               TO PV-PAGE-CNT                  08370077
083000            PERFORM 1300-LOCATION-NAME                            08380080
083100                                                                  08390077
083200            MOVE SUNAUD-OPER-UNT-ID   TO PV-OPER-UNT-ID           08400077
083300            MOVE PV-OPER-UNT-ID       TO HL2-FACILITY             08410077
083400            MOVE XL071-LOC-NM         TO HL2-FACILITY-DESC        08420080
083500            PERFORM 8000-WRITE-REPORT-HEADERS                     08430077
083600        ELSE                                                      08440077
083700            SET PS-END-OF-CARTON-FILE TO TRUE                     08450077
083800        END-IF                                                    08460077
083900     END-IF.                                                      08470077
084000                                                                  08480077
084100******************************************************************08490077
084200*  CHECK IF THIS CARTON IS IN ERROR.  A CARTON IS IN ERROR IF    *08500077
084300*  ONE OF THE FOLLOWING IS TRUE:                                 *08510077
084400*    -- THE QUANTITY EXPECTED AND THE QUANTITY AUDITED ARE NOT   *08520077
084500*       THE SAME ON THE CARTON EXTRACT FILE                      *08530077
084600*                           ** OR **                             *08540077
084700*    -- THERE ARE ROWS PRESENT ON THE TSUEXCP TABLE WHICH        *08550077
084800*       CONTAINS SHIPPING UNIT AUDIT EXCEPTION INFORMATION       *08560077
084900*                           ** OR **                             *08570077
085000*  EACH CARTON IN THE AUDIT HAS BEEN ASSIGNED A UNIQUE           *08580077
085100*  SHIPT-UNT-ID.  WHEN THIS CHANGES, WE ARE NOW EXAMINING A      *08590077
085200*  DIFFERENT CARTON FOR ERRORS.                                  *08600077
085300******************************************************************08610077
085400 2010-PROCESS-CARTON-ERRORS.                                      08620077
085500                                                                  08630077
085600     IF  SU003-QTY-EXP NOT = SU003-QTY-AUD                        08640077
085700         SET PS-ERROR-FOUND        TO TRUE                        08650077
085800     ELSE                                                         08660077
085900         PERFORM 2300-CHECK-TSUEXCP                               08670077
086000         IF  PV-ERROR-COUNT > +0                                  08680077
086100             SET PS-ERROR-FOUND    TO TRUE                        08690077
086200         END-IF                                                   08700077
086300     END-IF.                                                      08710077
086400 2100-FETCH-TRECEIV-INFO.                                         08720077
086500******************************************************************08730077
086600*  FETCH RECEIVER RELATED INFORMATION                            *08740077
086700******************************************************************08750077
086800     INITIALIZE DCLTRECEIV                                        08760077
086900                DCLTPURCHS                                        08770077
087000                DCLTENTNME.                                       08780077
087100                                                                  08790077
087200     MOVE '2100-FETCH-TRECEIV-INFO'                               08800077
087300                                 TO PV-ABEND-PARAGRAPH.           08810077
087400                                                                  08820077
087500     EXEC SQL                                                     08830077
087600       SELECT  A.REC_TMST                                         08840077
087700              ,A.EXPTED_CART_CNT                                  08850077
087800              ,A.ACTL_CART_CNT                                    08860077
087900         INTO  :RECEIV-REC-TMST                                   08870077
088000              ,:RECEIV-EXPTED-CART-CNT                            08880077
088100              ,:RECEIV-ACTL-CART-CNT                              08890077
088200         FROM  TRECEIV A                                          08900077
088300        WHERE  A.ORD_NBR        = :SU003-PO-NBR                   08910077
088400          AND  A.REC_SEQ_NBR    = :SU003-REC-SEQ-NBR              08920077
088500     END-EXEC.                                                    08930077
088600                                                                  08940077
088700     EVALUATE TRUE                                                08950077
088800       WHEN SQLCODE = ZEROS                                       08960077
088900         CONTINUE                                                 08970077
089000       WHEN SQLCODE = +100                                        08980077
089100         CONTINUE                                                 08990077
089200       WHEN OTHER                                                 09000077
089300         DISPLAY PV-ABEND-PARAGRAPH                               09010077
089400         PERFORM Z999-SQL-ERROR                                   09020077
089500     END-EVALUATE.                                                09030077
089600                                                                  09040077
089700                                                                  09050077
089800 2150-SELECT-ENTNME.                                              09060077
089900******************************************************************09070077
090000*  FETCH THE VENDOR NAME                                          09080077
090100******************************************************************09090077
090200     INITIALIZE DCLTENTNME                                        09100077
090300                                                                  09110077
090400     MOVE '2150-SELECT-ENTNME'                                    09120077
090500                                 TO PV-ABEND-PARAGRAPH.           09130077
090600                                                                  09140077
090700     EXEC SQL                                                     09150077
090800       SELECT   ENT_NAME_DESC                                     09160077
090900         INTO  :ENTNME-ENT-NAME-DESC                              09170077
091000         FROM  TPURCHS A                                          09180077
091100              ,TENTNME B                                          09190077
091200        WHERE  A.PO_NBR         = :SU003-PO-NBR                   09200077
091300          AND  A.VER_STATUS_CDE = :PC-ACTIVE-STATUS               09210077
091400          AND  B.ENT_ID         = A.ENT_ID                        09220077
091500          AND  B.TYPE_CDE       = :PC-LONG-NAME                   09230077
091600     END-EXEC.                                                    09240077
091700                                                                  09250077
091800     EVALUATE TRUE                                                09260077
091900       WHEN SQLCODE = ZEROS                                       09270077
092000         CONTINUE                                                 09280077
092100       WHEN SQLCODE = +100                                        09290077
092200         MOVE 'UNKNOWN VENDOR  ' TO ENTNME-ENT-NAME-DESC          09300077
092300       WHEN OTHER                                                 09310077
092400         DISPLAY PV-ABEND-PARAGRAPH                               09320077
092500         PERFORM Z999-SQL-ERROR                                   09330077
092600     END-EVALUATE.                                                09340077
092700                                                                  09350077
092800                                                                  09360077
092900 2200-FETCH-TSUATRN-INFO.                                         09370077
093000******************************************************************09380077
093100*  FETCH AUDIT CARTON COUNT INFORMATION                          *09390077
093200******************************************************************09400077
093300     INITIALIZE PV-CARTONS-IN-AUDIT.                              09410077
093400                                                                  09420077
093500     MOVE '2200-FETCH-TSUATRN-INFO'                               09430077
093600                                 TO PV-ABEND-PARAGRAPH.           09440077
093700                                                                  09450077
093800     EXEC SQL                                                     09460077
093900       SELECT  COUNT(*)                                           09470077
094000         INTO  :PV-CARTONS-IN-AUDIT                               09480077
094100         FROM  TSUATRN                                            09490077
094200        WHERE  AUD_CNTL_NBR   = :SU003-AUD-CNTL-NBR               09500077
094300          AND  TRN_NBR        = :SU003-PO-NBR                     09510077
094400          AND  REC_SEQ_NBR    = :SU003-REC-SEQ-NBR                09520077
094500     END-EXEC.                                                    09530077
094600                                                                  09540077
094700     EVALUATE TRUE                                                09550077
094800       WHEN SQLCODE = ZEROS                                       09560077
094900       WHEN SQLCODE = +100                                        09570077
095000         CONTINUE                                                 09580077
095100       WHEN OTHER                                                 09590077
095200         DISPLAY PV-ABEND-PARAGRAPH                               09600077
095300         PERFORM Z999-SQL-ERROR                                   09610077
095400     END-EVALUATE.                                                09620077
095500                                                                  09630077
095600                                                                  09640077
095700 2300-CHECK-TSUEXCP.                                              09650077
095800******************************************************************09660077
095900*  FETCH THE SHIPPING UNIT AUDIT EXCEPTION COUNT INFORMATION     *09670077
096000******************************************************************09680077
096100     INITIALIZE PV-ERROR-COUNT.                                   09690077
096200                                                                  09700077
096300     MOVE '2300-CHECK-TSUEXCP'   TO PV-ABEND-PARAGRAPH.           09710077
096400                                                                  09720077
096500     EXEC SQL                                                     09730077
096600       SELECT  COUNT(*)                                           09740077
096700         INTO  :PV-ERROR-COUNT                                    09750077
096800         FROM  TSUEXCP                                            09760077
096900        WHERE  AUD_CNTL_NBR   = :SU003-AUD-CNTL-NBR               09770077
097000          AND  SHIPT_UNT_ID   = :SU003-SHIPT-UNT-ID               09780077
097100          AND  UPC_NBR        = :SU003-UPC                        09790077
097200     END-EXEC.                                                    09800077
097300                                                                  09810077
097400     EVALUATE TRUE                                                09820077
097500       WHEN SQLCODE = ZEROS                                       09830077
097600       WHEN SQLCODE = +100                                        09840077
097700         CONTINUE                                                 09850077
097800       WHEN OTHER                                                 09860077
097900         DISPLAY PV-ABEND-PARAGRAPH                               09870077
098000         PERFORM Z999-SQL-ERROR                                   09880077
098100     END-EVALUATE.                                                09890077
098200                                                                  09900077
098300                                                                  09910077
098400 7000-READ-CARTON-EXTRACT.                                        09920077
098500******************************************************************09930077
098600*  READ A RECORD FROM THE CARTON EXTRACT FILE.                   *09940077
098700******************************************************************09950077
098800     INITIALIZE SU003-EXTRACT-RECORD.                             09960077
098900                                                                  09970077
099000     READ CARTON-FILE INTO SU003-EXTRACT-RECORD                   09980077
099100        AT END                                                    09990077
099200           SET PS-END-OF-CARTON-FILE TO TRUE.                     10000077
099300                                                                  10010077
099400     IF PS-END-OF-CARTON-FILE                                     10020077
099500         CONTINUE                                                 10030077
099600     ELSE                                                         10040077
099700         MOVE SU003-PO-NBR       TO PV-CURR-PO-NBR                10050077
099800                                    PV-PO                         10060077
099900         MOVE SU003-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR           10070077
100000                                    PV-RECEIVER                   10080077
100100         MOVE SU003-AUD-CNTL-NBR TO PV-CURR-AUD-CNTL-NBR          10090077
100200     END-IF.                                                      10100077
100300                                                                  10110077
100400                                                                  10120077
100500 8000-WRITE-REPORT-HEADERS.                                       10130077
100600******************************************************************10140077
100700*  PRINT THE HEADING FOR THE REPORT.                             *10150077
100800******************************************************************10160077
100900     PERFORM 8200-WRITE-TOP-LINE.                                 10170077
101000*                                                                 10180077
101100     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10190077
101200       FROM HEADING-LINE-0                                        10200077
101300         AFTER ADVANCING 1 LINE.                                  10210077
101400*                                                                 10220077
101500     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10230077
101600       FROM HEADING-LINE-1                                        10240077
101700         AFTER ADVANCING 1 LINE.                                  10250077
101800*                                                                 10260077
101900     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10270077
102000       FROM HEADING-LINE-2                                        10280077
102100         AFTER ADVANCING 3 LINES.                                 10290077
102200*                                                                 10300077
102300     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10310077
102400       FROM HEADING-LINE-3                                        10320077
102500         AFTER ADVANCING 2 LINES.                                 10330077
102600*                                                                 10340077
102700     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10350077
102800       FROM HEADING-LINE-4                                        10360077
102900         AFTER ADVANCING 1 LINES.                                 10370077
103000*                                                                 10380077
103100     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10390077
103200       FROM PC-BLANK-LINE                                         10400077
103300         AFTER ADVANCING 1 LINES.                                 10410077
103400*                                                                 10420077
103500     MOVE PC-12                   TO PV-LINE-CNT.                 10430077
103600*                                                                 10440077
103700 8200-WRITE-TOP-LINE.                                             10450077
103800******************************************************************10460077
103900*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *10470077
104000*     NEEDED FOR AN ASN NUMBER.                                  *10480077
104100******************************************************************10490077
104200     ADD 1                        TO PV-PAGE-CNT.                 10500077
104300*                                                                 10510077
104400     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          10520077
104500*                                                                 10530077
104600     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10540077
104700       FROM DP132O-STANDRD-HEADER-132-COLS                        10550077
104800         AFTER ADVANCING PAGE.                                    10560077
104900*                                                                 10570077
105000*                                                                 10580077
105100 8400-WRITE-DETAIL-LINES.                                         10590077
105200******************************************************************10600077
105300*     WRITES THE DETAIL LINE INFORMATION.                        *10610077
105400******************************************************************10620077
105500     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                        10630077
105600          PERFORM 8000-WRITE-REPORT-HEADERS                       10640077
105700     ELSE                                                         10650077
105800         WRITE SU-CARTON-AUDIT-RPT-RECORD                         10660077
105900           FROM DETAIL-LINE1                                      10670077
106000             AFTER ADVANCING 1 LINE                               10680077
106100     END-IF.                                                      10690077
106200*                                                                 10700077
106300         ADD +1                          TO PV-LINE-CNT.          10710077
106400*                                                                 10720077
106500*                                                                 10730077
106600******************************************************************10740077
106700*     SQL WARNING OR ERROR PROCESSING                            *10750077
106800******************************************************************10760077
106900                                                                  10770077
107000*                                                                 10780077
107100 Z999-SQL-ERROR.                                                  10790077
107200*---------------                                                  10800077
107300                                                                  10810077
107400     MOVE SQLCODE    TO SQLCODE2.                                 10820077
107500     MOVE SQLERRD(3) TO SQLERRD3.                                 10830077
107600     DISPLAY '** ABEND **       ** = SQLERROR'.                   10840077
107700     DISPLAY '** PROGRAM        ** = SUKRP014'.                   10850077
107800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  10860077
107900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  10870077
108000     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   10880077
108100     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  10890077
108200     EXEC SQL                                                     10900077
108300         COMMIT                                                   10910077
108400     END-EXEC.                                                    10920077
108500     MOVE +4013 TO PV-ABEND-CODE.                                 10930077
108600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10940077
