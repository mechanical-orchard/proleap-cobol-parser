000100*****************************************************************         
000200 IDENTIFICATION DIVISION.                                                 
000300*****************************************************************         
000400 PROGRAM-ID.             SSKRP003.                                        
000500 AUTHOR.                 MICHELE RINDFLEISCH.                             
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000700 DATE-WRITTEN            JUNE 2001.                                       
000800 DATE-COMPILED.                                                           
000900*****************************************************************         
001000*                                                                         
001100*  THIS PROGRAM CREATES 1 WEEKLY NET SALES TENDER ANALYSIS FILE.          
002500*                                                                         
002600*   INPUT: INP01 - CONTAINS A WEEK ENDING DATE THAT DETERMINES            
002700*                  THE WEEK TO BE USED TO CREATE THE REPORT.              
002800*                                                                         
003600*  OUTPUT: OUT03 - NET SALES TENDER ANALYSIS EXCEL REPORT FILE            
004400*                  BY STORE                                               
004500*--------------------------------------------------------------           
004600*                                                                         
005200*  THE CONTROL DATE FILE IS USED TO DETERMINE THE                         
005500*  WEEK DATES TO BE USED IN THE CURSOR.                                   
005600*                                                                         
005700*  THE RANGE OF PARTITION NUMBERS SELECTED ARE USED IN A CURSOR           
005800*  TO SELECT ROWS FROM THE DB2 TABLE TSASUM FOR TENDER VALUES.            
005900*                                                                         
006000*  EACH TENDER TYPE IS ACCUMULATED INTO THE APPROPRIATE RECORD            
006100*  IN THE INTERNAL TABLE BY STORE.                                        
006200*                                                                         
006300*  ONCE END OF CURSOR IS REACHED, THE FILE IS GENERATED.                  
006400*                                                                         
006800*****************************************************************         
007220*   CHANGE DATE: 11/01                                                    
007230*   BY: MICHELE RINDFLEISCH              WR/IR#: WR23086                  
006700*                                                                         
007220*   CHANGE DATE: 01/02                                                    
007230*   BY: SANDY POTTER                     WR/IR#: WR23168                  
006700*                                                                         
007220*   CHANGE DATE: 04/09                                                    
007230*   BY: SANDY POTTER                     WR/IR#: PM00460932               
006700*                                                                         
007220*   CHANGE DATE: 04/23                                                    
007230*   BY: SANDY POTTER                     WR/IR#: WR23650                  
006700*                                                                         
007220*   CHANGE DATE: 06/20                                                    
007230*   BY: SANDY POTTER                     WR/IR#: PM00476061               
082108*                                                                         
082108*   CHANGE DATE: 08/21/08                                                 
082108*   BY: KAREN GIVENS                     WR/IR#: WR35028                  
CR9308*                                                                         
CR9308*   CHANGE DATE: 07/11/11                                                 
CR9308*   DESCRIPTION: INCREASED THE REPORT RECORD LAYOUT FIELD SIZE            
CR9308*   BY: COGNIZANT                        WR/IR#:                          
P8612 *                                                                         
P8612 *   CHANGE DATE: 10/15/14                                                 
P8612 *   DESCRIPTION: REMOVED ALL THE REFERENCE TO TSASUMH TABLE.              
P8612 *   BY: COGNIZANT                        WR/IR#: CHG0092405               
SEPHOR*                                                                         
SEPHOR*   CHANGE DATE: 06/16/21                                                 
SEPHOR*   BY: JIM HUNTER                   WR/IR#:  CHG0262731                  
SEPHOR*   CHANGES: ADDING SEPHORA CHARGE CARDS TO CSV FILES.                    
SEPHOR*   10/15/21 - FOLLOWING CHANGES MADE:                                    
SEPHOR*          FOR NOW THE SEPHORA CHARGE CARD NUMBERS WILL NOT BE            
SEPHOR*          ADDED TO THE OUTPUT FILE.  IT WILL BE ADDED WHEN               
SEPHOR*          SEPHORA CHARGE CARDS ARE ACCEPTED AT KOHL'S OR                 
SEPHOR*          ANY OTHER TENDER TYPE IS ADDED TO THE FILE.                    
SEPHOR*          SEE ALL COMMENTED SEPHOR* LINES FOR FUTURE CHANGES.            
SEPHOR*   NOTE:  IT HAS BEEN CONFIRMED THAT THE 2 REPORTS AND                   
SEPHOR*          FIRST 2 FILES CREATED BY THIS PROGRAM ARE NOT BEING            
SEPHOR*          USED AND HAVE BEEN TURNED OFF.  ALL LOGIC RELATED TO           
SEPHOR*          THEM HAS BEEN DELETED.  THIS PROGRAM WILL ONLY CREATE          
SEPHOR*          THE WEEKLY CSV FILE STILL USED BY THE BUSINESS.                
SEPHOR*                                                                         
267236*   CHANGE DATE: 02/23/22                                                 
267236*   BY: BARB SCHULTZ                 WR/IR#:  CHG0267236                  
267236*   CHANGES: CHANGING THE INPUT CONTROL CARD TO SACC035 SO THIS           
267236*   PROGRAM CAN RUN AFTER SAK131 RUNS INSTEAD OF RUNNING ON               
267236*   SUNDAY NIGHT. THIS WAY IT WILL PICK UP ALL OF THE CHANGES THAT        
267236*   THE SALES AUDIT TEAM IS MAKING FOR THE PREVIOUS WEEK.                 
267236*                                                                         
SEPHOR*   CHANGE DATE: 03/22/22                                                 
SEPHOR*   BY: JIM HUNTER                   WR/IR#:  CHG0268463                  
SEPHOR*   CHANGES: ADDING SEPHORA GIFT CARD SALES AND TENDERS TO THE            
SEPHOR*          CSV FILE.                                                      
SEPHOR*          SINCE SEPHORA CHARGE CARDS HAVE NOT BEEN INTRODUCED,           
SEPHOR*          THE CHANGES MADE IN 2021 WILL BE UPDATED TO REPLACE            
SEPHOR*          THE CHARGE CARDS WITH THE GIFT CARD TENDERS.  THEY             
SEPHOR*          WILL BE ADDED TO THE NET TOTAL SALES FIELD.                    
SEPHOR*          GIFT CARD SALES WILL BE ADDED AS A NEW COLUMN AND BE           
SEPHOR*          SUBTRACTED FROM FLASH TOTAL.                                   
SEPH02*                                                                         
SEPH02*   CHANGE DATE: 08/31/22                                                 
SEPH02*   BY: JIM HUNTER                   WR/IR#:  CHG0273953                  
SEPH02*   CHANGES: BECAUSE SEPHORA GIFT CARD SALES AND TENDERS ARE              
SEPH02*          ALSO INCLUDED IN THE TSASUM KOHL'S GIFT CARD SALES             
SEPH02*          AND TENDERS NUMBERS, THEY SHOULD NOT SUBTRACT FROM             
SEPH02*          THE SALES TOTAL OR ADD TO THE TENDERS TOTAL TO                 
SEPH02*          AVOID DOUBLE COUNTING THEM.                                    
SEPH03*                                                                         
SEPH03*   CHANGE DATE: 12/20/22                                                 
SEPH03*   BY: BARB SCHULTZ                 WR/IR#:  CHG0278871                  
SEPH03*   CHANGES: SUBTRACTED SEPHORA GC SOLD FROM NON-MERCH SALES              
SEPH03*          AND NET TOTAL SALES TO GET FLASH TOTAL.                        
SEPH03*          SUBTRACTED SEPHORA GC TENDERS(SGT) FROM GIFTCRT/KMRC           
SEPH03*          AND ADDED IT (SGT) TO NET TOTAL SALES CALCULATION.             
SEPH03*          ALSO ADDED (SGT) TO THE PRORATION OF TAXES.                    
SEPH03*          THESE CHANGES ARE BEING MADE TO ADJUST THE SEPH02              
SEPH03*          CHANGES MADE ABOVE BECAUSE POC INCLUDED THE SEPHORA            
SEPH03*          GIFT CARD SALES AND TENDERS IN THE TSASUM BLACKHAWK            
SEPH03*          GIFT CARD SALES AND TENDERS INSTEAD OF THE KOHL'S              
SEPH03*          GIFT CARD SALES AND TENDERS.                                   
SEPH03*                                                                         
COBRND*   CHANGE DATE: 03/06/23                                                 
COBRND*   BY: JIM HUNTER                   WR/IR#:  CHG0284865                  
COBRND*   CHANGES: FOR THE NEW COBRAND VISA CHARGE CARDS.                       
COBRND*          GET COBRAND VISA NET (CVN) FROM THE TSASUM TABLE.              
COBRND*          THE NEW COBRAND TENDER NUMBERS SHOULD BE ADDED TO              
COBRND*          THE NET TOTAL SALES AS WELL AS THE TAX PRORATION               
COBRND*          CALCULATIONS.  THEY ALSO NEED TO BE SUBTRACTED                 
COBRND*          FROM THE BANK CARD TOTALS.                                     
COBRND*          THE LENGTH OF THE CSV FILE WILL BE NEED TO BE                  
COBRND*          INCREASED BY 20 CHARACTERS.                                    
PAYVEN*                                                                         
PAYVEN*   CHANGE DATE: 07/06/23                                                 
PAYVEN*   BY: JIM HUNTER                   WR/IR#:  CHG0290395                  
PAYVEN*   CHANGES: FOR THE NEW PAYPAL AND VENMO CHARGE CARDS.                   
PAYVEN*          GET PAYPAL (PPS AND PPR) AND VENMO (VMS AND VMR)               
PAYVEN*          FROM THE TSASUM TABLE.                                         
PAYVEN*          THE NEW PAYPAL AND VENMO TENDER NUMBERS SHOULD BE ADDED        
PAYVEN*          TO THE NET TOTAL SALES AS WELL AS THE TAX PRORATION            
PAYVEN*          CALCULATIONS.                                                  
PAYVEN*          THE LENGTH OF THE CSV FILE WILL NEED TO BE                     
PAYVEN*          INCREASED BY 20 CHARACTERS.                                    
COBTRL*                                                                         
COBTRL*   CHANGE DATE: 11/02/23                                                 
COBTRL*   BY: JIM HUNTER                   WR/IR#:  CHG0297024                  
COBTRL*   CHANGES: ADDING LOGIC TO ADJUST CATEGORIES FOR COBRAND                
COBTRL*          TRAILING TRANSACTIONS.  THESE TRANSACTIONS ARE THOSE           
COBTRL*          MADE AGAINST KOHL'S CHARGE ACCOUNTS (MAINLY RETURNS)           
COBTRL*          FOR CUSTOMERS WHO NOW HAVE COBRAND ACCOUNTS INSTEAD.           
COBTRL*          THEY WILL COME FROM THE TSASUM TABLE, REGISTER ZERO,           
COBTRL*          CATEGORY TTN (COBRAND TRAILING NET).                           
COBTRL*          TTN WILL BE SUBTRACTED FROM KCN AND ADDED TO CVN.              
COBTRL*          THIS PROGRAM PROCESSES TENDERS BUT NOT PAYMENTS.               
007300*****************************************************************         
007400 ENVIRONMENT DIVISION.                                                    
007500*****************************************************************         
007600                                                                          
007700 CONFIGURATION SECTION.                                                   
007800                                                                          
007900 SOURCE-COMPUTER.        IBM-3090.                                        
008000 OBJECT-COMPUTER.        IBM-3090.                                        
008100                                                                          
008200 INPUT-OUTPUT SECTION.                                                    
008300                                                                          
008400 FILE-CONTROL.                                                            
008500                                                                          
008900     SELECT CONTROL-DATE-FILE                                             
009000         ASSIGN TO INP02.                                                 
009100                                                                          
082108     SELECT BYSTORE-CSV-OUTPUT-FILE                                       
082108         ASSIGN TO OUT03.                                                 
082108                                                                          
010400******************************************************************        
010500 DATA DIVISION.                                                           
010600******************************************************************        
010700                                                                          
010800 FILE SECTION.                                                            
010900                                                                          
011900 FD  CONTROL-DATE-FILE                                                    
012000     RECORDING MODE IS F                                                  
012100     LABEL RECORDS ARE STANDARD                                           
012200     BLOCK CONTAINS 0 RECORDS                                             
012300     RECORD CONTAINS 80 CHARACTERS                                        
012400     DATA RECORD IS CONTROL-DATE-RECORD.                                  
012500                                                                          
012600 01  CONTROL-DATE-RECORD             PIC X(80).                           
012700                                                                          
082108 FD  BYSTORE-CSV-OUTPUT-FILE                                              
082108     RECORDING MODE IS F                                                  
082108     BLOCK CONTAINS 0  RECORDS                                            
082108     LABEL RECORDS ARE OMITTED                                            
082108     DATA RECORD IS BYSTORE-CSV-OUTPUT-RECORD.                            
082108                                                                          
COBRND*01  BYSTORE-CSV-OUTPUT-RECORD       PIC  X(280).                         
PAYVEN 01  BYSTORE-CSV-OUTPUT-RECORD       PIC  X(300).                         
082108                                                                          
016000******************************************************************        
016100 WORKING-STORAGE SECTION.                                                 
016200******************************************************************        
016300 01  FILLER                          PIC X(50)  VALUE                     
016400     ' *** WORKING STORAGE STARTS HERE FOR SSKRP003 *** '.                
016500                                                                          
017700******************************************************************        
017800* RECORD LAYOUT FOR INPUT DATE CONTROL CARD                               
017900******************************************************************        
018000 01  CC-DATE-CARD.                                                        
267236     05  CC-BEGIN-DATE-CARD-CCYYMMDD PIC X(10) VALUE SPACES.              
267236     05  FILLER                      PIC X(01)    VALUE SPACES.           
267236     05  CC-END-DATE-CARD-CCYYMMDD   PIC X(10) VALUE SPACES.              
267236     05  FILLER                      PIC X(59)    VALUE SPACES.           
018600                                                                          
018700******************************************************************        
018800*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)                     
018900******************************************************************        
019000     COPY DPWS500.                                                        
019100                                                                          
019200******************************************************************        
019300 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZEROES            
019400                                                  COMP SYNC.              
019500     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.            
019600     88  AC-DATE-CARD-ERROR                       VALUE +4003.            
019700     88  AC-DB2-ERROR                             VALUE +4013.            
019800     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.            
019900     88  AC-BYDATE-TABLE-ERROR                    VALUE +4020.            
020000     88  AC-BYSTORE-TABLE-ERROR                   VALUE +4021.            
020100                                                                          
020200******************************************************************        
020300*  PROGRAM SWITCHES                                                       
020400******************************************************************        
020500 01  PS-PROGRAM-SWITCHES.                                                 
020600     05  PS-END-OF-CSR-SW              PIC X(01)  VALUE 'N'.              
020700         88  PS-YES-END-OF-CSR                    VALUE 'Y'.              
021000     05  PS-END-OF-DATE-FILE-SW        PIC X(01)  VALUE 'N'.              
021100         88  PS-YES-END-OF-DATE-FILE              VALUE 'Y'.              
021400                                                                          
021500******************************************************************        
021600*  PROGRAM CONSTANTS                                                      
021700******************************************************************        
021800 01  PC-CONSTANTS.                                                        
022000     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)    VALUE 'SSKRP003'.         
022400                                                                          
022500******************************************************************        
022600*  MISC COUNT VARIABLES AND SUBSCRIPTS USED FOR TABLES.                   
022700******************************************************************        
024000 01  PV-MISC-SUB-FIELDS.                                                  
024300     05  TSUB2                       PIC S9(04)    VALUE ZEROES           
024400                                                   COMP SYNC.             
024700     05  MAX-TSUB2                   PIC S9(04)    VALUE +9999            
024800                                                   COMP SYNC.             
025100     05  TOT-BYSTORE-ON-TBL2         PIC S9(04)    VALUE ZEROES           
025200                                                   COMP SYNC.             
025300******************************************************************        
025400*  MISC FIELDS.                                                           
025500******************************************************************        
025600 01  PV-MISC-FIELDS.                                                      
025700     05  PV-CALC-TOTAL                  PIC S9(15)V99                     
025800                                                   VALUE +0.              
025900     05  PV-CALC-PCT                    PIC S9(02)V9                      
026000                                                   VALUE +0.              
025900     05  PV-TOTAL-PCT                   PIC S9(03)V9                      
026000                                                   VALUE +0.              
026100     05  PV-CALC-CASH                   PIC S9(15) VALUE +0.              
026200     05  PV-CALC-GFTCRD-CERT-SOLD       PIC S9(15) VALUE +0.              
026300     05  PV-CALC-GFTCRD-CRT-SLD-RPT-ONL PIC S9(15) VALUE +0.              
026400     05  PV-CALC-EMPL-DISC              PIC S9(15) VALUE +0.              
026500     05  PV-CALC-EMPL-DISC-RPT-ONLY     PIC S9(15) VALUE +0.              
026600     05  PV-CALC-NET-TOTAL              PIC S9(15) VALUE +0.              
026700     05  PV-CALC-FLASH-TOTAL            PIC S9(15) VALUE +0.              
026800     05  PV-CALC-CHECK                  PIC S9(15) VALUE +0.              
026900     05  PV-CALC-GCRD-GCRT-KMRC         PIC S9(15) VALUE +0.              
027000     05  PV-CALC-KOHLS-CHG              PIC S9(15) VALUE +0.              
COBRND     05  PV-CALC-COBRAND-CHG            PIC S9(15) VALUE +0.              
027100     05  PV-CALC-BNKCRD-CHG             PIC S9(15) VALUE +0.              
027200     05  PV-CALC-AMEX-CHG               PIC S9(15) VALUE +0.              
027300     05  PV-CALC-DSCVR-CHG              PIC S9(15) VALUE +0.              
PAYVEN     05  PV-CALC-PAYPAL-CHG             PIC S9(15) VALUE +0.              
PAYVEN     05  PV-CALC-VENMO-CHG              PIC S9(15) VALUE +0.              
027400     05  PV-CALC-DEBIT-CARD             PIC S9(15) VALUE +0.              
SEPHOR     05  PV-CALC-SEPHORA-GC-TNDR        PIC S9(15) VALUE +0.              
SEPHOR     05  PV-CALC-SEPHORA-GC-SOLD        PIC S9(15) VALUE +0.              
COBTRL     05  PV-TOTAL-COBRAND-TRL           PIC S9(7)V99  VALUE +0.           
COBTRL     05  PV-TOTAL-COBRAND-TRL-DISPLAY   PIC Z,ZZZ,ZZZ.ZZ-.                
027500                                                                          
027600     05  PV-SAVE-STR-NBR             PIC S9(04)    VALUE ZEROES           
027700                                                   COMP SYNC.             
COBRND*    05  PV-CSV-RECORD               PIC X(280)    VALUE SPACES.          
PAYVEN     05  PV-CSV-RECORD               PIC X(300)    VALUE SPACES.          
028300     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.          
028400     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACES.          
028500     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACES.          
028600     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACES.          
028800     05  PV-DAYS-DIFF                PIC ZZZ,ZZZ,ZZ9-.                    
028900                                                                          
029000******************************************************************        
029100*  MISC TIME AND DATE FIELDS.                                             
029200******************************************************************        
029300                                                                          
029400 01  PV-DATE-AND-TIME-FIELDS.                                             
029500     05  PV-CURRENT-DATE             PIC X(10).                           
029600     05  PV-PRCS-DATE-CCYYMMDD.                                           
029700         10  PV-PRCS-DATE-CCYY       PIC 9(04).                           
029800         10  FILLER                  PIC X(01).                           
029900         10  PV-PRCS-DATE-MM         PIC 9(02).                           
030000         10  FILLER                  PIC X(01).                           
030100         10  PV-PRCS-DATE-DD         PIC 9(02).                           
030200     05  PV-SAVE-CURRENT-DATE        PIC X(10).                           
030300                                                                          
030400     05  PV-CURRENT-TIME             PIC X(08)     VALUE SPACES.          
030500                                                                          
030600     05  PV-CURR-TIME.                                                    
030700         10  PV-CURR-TIME-HH         PIC 9(02)    VALUE ZEROES.           
030800         10  PV-CURR-TIME-MM         PIC 9(02)    VALUE ZEROES.           
030900         10  PV-CURR-TIME-SSHH       PIC 9(04)    VALUE ZEROES.           
031000                                                                          
035000                                                                          
035100******************************************************************        
035200*  CURSOR VARIABLES LOADED EACH TIME THE CURSOR FINDS A RECORD            
035300*  ON THE TSASUM DB.                                                      
035400******************************************************************        
035500                                                                          
035600 01  PV-CURSOR-VARIABLES.                                                 
035700     05  PV-SLS-DTE                    PIC X(10)  VALUE SPACES.           
036000     05  PV-STR-NBR                    PIC S9(04) VALUE ZEROES            
036100                                                  COMP SYNC.              
036200     05  PV-SUM-CTG-CDE                PIC X(03).                         
036300         88  PV-ADD-CASH                    VALUE 'CAS'.                  
036400         88  PV-ADD-CHECK                   VALUE 'VCK', 'TCK',           
036500                                                  'PCK', 'MGT',           
036500                                                  'POS'.                  
036600         88  PV-ADD-GCRD-GCRT-KMRC          VALUE 'GDT', 'GTT',           
036610                                                  'KMT'.                  
036700         88  PV-ADD-KOHLS-CHG               VALUE 'KCS'.                  
COBRND         88  PV-ADD-COBRAND-CHG             VALUE 'CVN'.                  
COBTRL         88  PV-ADD-COBRAND-TRL             VALUE 'TTN'.                  
036800         88  PV-ADD-BNKCRD-CHG              VALUE 'BCS'.                  
036900         88  PV-ADD-AMEX-CHG                VALUE 'AXS'.                  
037000         88  PV-ADD-DSCVR-CHG               VALUE 'NCS'.                  
PAYVEN         88  PV-ADD-PAYPAL-CHG              VALUE 'PPS'.                  
PAYVEN         88  PV-ADD-VENMO-CHG               VALUE 'VMS'.                  
037100         88  PV-ADD-DEBIT-CARD              VALUE 'DBS'.                  
SEPHOR         88  PV-ADD-SEPHORA-GC-TENDER       VALUE 'SGT'.                  
037200                                                                          
037300                                                                          
037400         88  PV-PAY-KHL-CHG-BY-CHK          VALUE 'TCP', 'PCP',           
037500                                                  'MGP'.                  
037600         88  PV-PAY-KLCHG-BY-GCRD-GCRT-KMRC VALUE 'GDP', 'GTP',           
037610                                                  'KMP'.                  
037800                                                                          
037900                                                                          
038000         88  PV-CB-VIA-CHECK-AMT            VALUE 'VCB', 'TCB',           
038100                                                  'PCB', 'MGB'.           
038200         88  PV-CB-VIA-GCRD-GCRT-KMRC-AMT   VALUE 'GDB', 'GTB',           
038210                                                  'KMB'.                  
038300         88  PV-CB-VIA-KOHLS-CHG-AMT        VALUE 'KCB'.                  
038400         88  PV-CB-VIA-BNKCRD-CHG-AMT       VALUE 'BCB'.                  
038500         88  PV-CB-VIA-AMEX-CHG-AMT         VALUE 'AXB'.                  
038600         88  PV-CB-VIA-DSCVR-CHG-AMT        VALUE 'NCB'.                  
038700         88  PV-CB-VIA-DEBIT-CARD-AMT       VALUE 'DBB'.                  
038800                                                                          
038900         88  PV-RET-VIA-CASH                VALUE 'CAR'.                  
039000         88  PV-RET-VIA-KOHLS-CHG           VALUE 'KCR'.                  
039100         88  PV-RET-VIA-BNKCRD-CHG          VALUE 'BCR'.                  
039200         88  PV-RET-VIA-AMEX-CHG            VALUE 'AXR'.                  
039300         88  PV-RET-VIA-DSCVR-CHG           VALUE 'NCR'.                  
PAYVEN         88  PV-RET-VIA-PAYPAL-CHG          VALUE 'PPR'.                  
PAYVEN         88  PV-RET-VIA-VENMO-CHG           VALUE 'VMR'.                  
039310         88  PV-RET-VIA-DEBIT-CARD          VALUE 'DBR'.                  
038900         88  PV-RET-VIA-CHECK               VALUE 'POR'.                  
039400                                                                          
039500         88  PV-KMRC-ISSUED                 VALUE 'KMI'.                  
039600         88  PV-CORP-REFUND-ISSUED          VALUE 'CRI'.                  
039700                                                                          
040000         88  PV-SUB-TAX                     VALUE 'TAX'.                  
040100                                                                          
040200         88  PV-SUB-KOHLS-GFT-CRD-CERT-SOLD VALUE 'GDS', 'GTS'.           
SEPHOR         88  PV-SUB-SEPHORA-GC-SOLD         VALUE 'SGS'.                  
040300         88  PV-SUB-EMPL-DISCOUNT           VALUE 'ECD'.                  
082108         88  PV-NON-MERCH-SLS-AMT           VALUE 'SHS', 'GWS',           
082108                                                  'MAN', 'SPN',           
082108                                                  'PTG', 'TPC'.           
082108         88  PV-NON-MERCH-RTN-AMT           VALUE 'SHR', 'GWR'.           
040400                                                                          
040500     05  PV-CTG-AMT                 PIC S9(15)V9(02) COMP-3.              
040600                                                                          
052100                                                                          
052200******************************************************************        
052300* TABLE OF KOHLS TRANSACTIONS BY STORE, EITHER FOR DAILY, WEEKLY,         
052400* OR MTD.                                                                 
052500******************************************************************        
052600 01  TBL2-KOHLS-TRANS-BY-STORE.                                           
052700     05 TBL2-KOHLS-TRANS-BY-STR OCCURS 9999 TIMES.                        
052800        10 TBL2-STR-NBR             PIC S9(04) COMP.                      
052900        10 TBL2-CASH-TOT-AMT        PIC S9(15)V99 COMP-3.                 
053000        10 TBL2-CASH-TOT-PCT        PIC S9(03)V9(05) COMP-3.              
053100        10 TBL2-CHECK-TOT-AMT       PIC S9(15)V99 COMP-3.                 
053200        10 TBL2-CHECK-TOT-PCT       PIC S9(03)V9(05) COMP-3.              
053300        10 TBL2-GCRD-GCRT-KMRC-TOT-AMT                                    
053310                                    PIC S9(15)V99 COMP-3.                 
053400        10 TBL2-GCRD-GCRT-KMRC-TOT-PCT                                    
053410                                    PIC S9(03)V9(05) COMP-3.              
053500        10 TBL2-KOHLS-CHG-TOT-AMT   PIC S9(15)V99 COMP-3.                 
053600        10 TBL2-KOHLS-CHG-TOT-PCT   PIC S9(03)V9(05) COMP-3.              
COBRND        10 TBL2-COBRAND-CHG-TOT-AMT PIC S9(15)V99 COMP-3.                 
COBRND        10 TBL2-COBRAND-CHG-TOT-PCT PIC S9(03)V9(05) COMP-3.              
053700        10 TBL2-BNKCRD-CHG-TOT-AMT  PIC S9(15)V99 COMP-3.                 
053800        10 TBL2-BNKCRD-CHG-TOT-PCT  PIC S9(03)V9(05) COMP-3.              
053900        10 TBL2-AMEX-CHG-TOT-AMT    PIC S9(15)V99 COMP-3.                 
054000        10 TBL2-AMEX-CHG-TOT-PCT    PIC S9(03)V9(05) COMP-3.              
054100        10 TBL2-DSCVR-CHG-TOT-AMT   PIC S9(15)V99 COMP-3.                 
054200        10 TBL2-DSCVR-CHG-TOT-PCT   PIC S9(03)V9(05) COMP-3.              
PAYVEN        10 TBL2-PAYPAL-CHG-TOT-AMT  PIC S9(15)V99 COMP-3.                 
PAYVEN        10 TBL2-PAYPAL-CHG-TOT-PCT  PIC S9(03)V9(05) COMP-3.              
PAYVEN        10 TBL2-VENMO-CHG-TOT-AMT   PIC S9(15)V99 COMP-3.                 
PAYVEN        10 TBL2-VENMO-CHG-TOT-PCT   PIC S9(03)V9(05) COMP-3.              
054300        10 TBL2-DEBIT-CARD-TOT-AMT  PIC S9(15)V99 COMP-3.                 
054500        10 TBL2-DEBIT-CARD-TOT-PCT  PIC S9(03)V9(05) COMP-3.              
SEPHOR        10 TBL2-SEPHORA-SGT-TOT-AMT PIC S9(15)V99 COMP-3.                 
SEPHOR        10 TBL2-SEPHORA-SGT-TOT-PCT PIC S9(03)V9(05) COMP-3.              
054600        10 TBL2-KOHLS-TOT-SAL-AMT   PIC S9(15)V99 COMP-3.                 
054700        10 TBL2-KOHLS-TAX-AMT       PIC S9(15)V99 COMP-3.                 
054800        10 TBL2-KOHLS-NET-TOT-AMT   PIC S9(15)V99 COMP-3.                 
054900        10 TBL2-KOHLS-GFT-CRD-CERT-AMT                                    
055000                                    PIC S9(15)V99 COMP-3.                 
SEPHOR        10 TBL2-SEPHORA-SGS-TOT-AMT PIC S9(15)V99 COMP-3.                 
055100        10 TBL2-KOHLS-EMPL-DISC-AMT PIC S9(15)V99 COMP-3.                 
082108        10 TBL2-NON-MERCH-SLS-AMT   PIC S9(15)V99 COMP-3.                 
082108        10 TBL2-CSV-TOT-SAL-AMT     PIC S9(15)V99 COMP-3.                 
082108        10 TBL2-CSV-NET-TOT-AMT     PIC S9(15)V99 COMP-3.                 
082108                                                                          
082108******************************************************************        
082108*  BY STORE DATA AFTER TAX PRORATION AND BEFORE ROUNDING                  
082108*  CSV FILE WILL ALSO INCLUDE NON-MERCHANDISE SALES                       
082108******************************************************************        
082108 01  CR-CSV-COLUMN-HDGS-1.                                                
082108     05  FILLER                      PIC  X(02)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'STORE'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(05)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(04)                           
082108                                     VALUE 'CASH'.                        
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'PERSONAL'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'GIFTCRT/'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'KOHLS'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  FILLER                      PIC  X(05)    VALUE SPACES.          
COBRND     05  FILLER                      PIC  X(07)                           
COBRND                                     VALUE 'COBRAND'.                     
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  FILLER                      PIC  X(04)    VALUE SPACES.          
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'BANKCARD'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(08)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(04)                           
082108                                     VALUE 'AMEX'.                        
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'DISCOVER'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(06)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(06)                           
PAYVEN                                     VALUE 'PAYPAL'.                      
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(04)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(07)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(05)                           
PAYVEN                                     VALUE 'VENMO'.                       
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(04)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'DEBIT'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(02)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(10)                           
SEPHOR                                     VALUE 'SEPHORA GC'.                  
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(04)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(09)                           
082108                                     VALUE 'NET TOTAL'.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(09)                           
082108                                     VALUE 'GIFT CRD/'.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(02)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(10)                           
SEPHOR                                     VALUE 'SEPHORA GC'.                  
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'EMP CASH'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'FLASH'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(09)                           
082108                                     VALUE 'NON-MERCH'.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108                                                                          
082108 01  CR-CSV-COLUMN-HDGS-2.                                                
082108     05  FILLER                      PIC  X(01)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(06)                           
082108                                     VALUE 'NUMBER'.                      
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'SALES'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(06)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(06)                           
082108                                     VALUE 'CHECKS'.                      
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(08)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(04)                           
082108                                     VALUE 'KMRC'.                        
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(05)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(07)                           
082108                                     VALUE 'CHARGES'.                     
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  FILLER                      PIC  X(05)    VALUE SPACES.          
COBRND     05  FILLER                      PIC  X(07)                           
COBRND                                     VALUE 'CHARGES'.                     
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  FILLER                      PIC  X(03)    VALUE SPACES.          
COBRND     05  FILLER                      PIC  X(01)    VALUE '%'.             
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(05)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(07)                           
082108                                     VALUE 'CHARGES'.                     
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(05)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(07)                           
082108                                     VALUE 'CHARGES'.                     
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(05)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(07)                           
082108                                     VALUE 'CHARGES'.                     
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(05)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(07)                           
PAYVEN                                     VALUE 'CHARGES'.                     
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(03)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(01)    VALUE '%'.             
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(05)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(07)                           
PAYVEN                                     VALUE 'CHARGES'.                     
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(03)    VALUE SPACES.          
PAYVEN     05  FILLER                      PIC  X(01)    VALUE '%'.             
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'CARDS'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(01)    VALUE '%'.             
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(05)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(07)                           
SEPHOR                                     VALUE 'TENDERS'.                     
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(03)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(01)    VALUE '%'.             
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'SALES'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(03)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(09)                           
082108                                     VALUE 'CERT SOLD'.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  FILLER                      PIC  X(08)    VALUE SPACES.          
SEPHOR     05  FILLER                      PIC  X(04)                           
SEPHOR                                     VALUE 'SOLD'.                        
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(04)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(08)                           
082108                                     VALUE 'DISCOUNT'.                    
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'TOTAL'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  FILLER                      PIC  X(07)    VALUE SPACES.          
082108     05  FILLER                      PIC  X(05)                           
082108                                     VALUE 'SALES'.                       
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108                                                                          
082108 01  CR-CSV-RECORD.                                                       
082108     05  CR-STR-NBR                  PIC  ZZZ9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-CASH-AMT                 PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-CASH-PCT                 PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-CHECK-AMT                PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-CHECK-PCT                PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-GCRD-GCRT-KMRC-AMT       PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-GCRD-GCRT-KMRC-PCT       PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-KOHLS-CHG-AMT            PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-KOHLS-CHG-PCT            PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  CR-COBRAND-CHG-AMT          PIC  -----------9.                   
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
COBRND     05  CR-COBRAND-CHG-PCT          PIC  Z9.9.                           
COBRND     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-BNKCRD-CHG-AMT           PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-BNKCRD-CHG-PCT           PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-AMEX-CHG-AMT             PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-AMEX-CHG-PCT             PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-DSCVR-CHG-AMT            PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-DSCVR-CHG-PCT            PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  CR-PAYPAL-CHG-AMT           PIC  -----------9.                   
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  CR-PAYPAL-CHG-PCT           PIC  Z9.9.                           
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  CR-VENMO-CHG-AMT            PIC  -----------9.                   
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
PAYVEN     05  CR-VENMO-CHG-PCT            PIC  Z9.9.                           
PAYVEN     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-DEBIT-CARD-AMT           PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-DEBIT-CARD-PCT           PIC  Z9.9.                           
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  CR-SEPHORA-SGT-AMT          PIC  -----------9.                   
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  CR-SEPHORA-SGT-PCT          PIC  Z9.9.                           
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-NET-SALES-TOT-AMT        PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-GFTCRD-CRT-TOT-AMT       PIC  -----------9.                   
SEPHOR     05  FILLER                      PIC  X(01)    VALUE ','.             
SEPHOR     05  CR-SEPHORA-SGS-AMT          PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-EMPL-DISC-TOT-AMT        PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-KOHLS-TOT-SLS-AMT        PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108     05  CR-NON-MERCH-SLS-AMT        PIC  -----------9.                   
082108     05  FILLER                      PIC  X(01)    VALUE ','.             
082108*                                                                         
091700******************************************************************        
091800*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                                    
091900******************************************************************        
092000     COPY DPWS004.                                                        
092100                                                                          
092200******************************************************************        
092300*  DB2 COMMUNICATION AREA.                                                
092400******************************************************************        
092500     EXEC SQL                                                             
092600          INCLUDE SQLCA                                                   
092700     END-EXEC.                                                            
092800                                                                          
092900******************************************************************        
093000*  DB2 TABLE DB2PDBA.TEPPART - COSA-PARTITIONING TABLE                    
093100******************************************************************        
093200     EXEC SQL                                                             
093300          INCLUDE TEPPART                                                 
093400     END-EXEC.                                                            
093500                                                                          
093600******************************************************************        
093700*  DB2 TABLE DB2PDBA.TSASUM - COSA OPERATIONAL SUMMARY TABLE              
093800******************************************************************        
093900     EXEC SQL                                                             
094000          INCLUDE TSASUM                                                  
094100     END-EXEC.                                                            
093500                                                                          
094200                                                                          
094300******************************************************************        
094600*                                                                         
094700*  THE FOLLOWING CATEGORY CODE BUCKETS ARE THE VALUES TO BE               
094800*  REPORTED IN THE LISTED TENDER TYPE:                                    
094900*                                                                         
095000*            CASH:  CAS                                                   
095100*            CHECK:  VCK, TCK, PCK, MGT, POS                              
095200*            GIFTCARD/GIFTCERT/KMRC:  GDT, GTT, KMT                       
095300*            KOHLS CHARGE:  KCS                                           
COBRND*            COBRAND CHARGE:  CVN                                         
COBTRL*            COBRAND TRAILING:  TTN  (ADJUSTS KCN AND CVN)                
095400*            BANKCARD CHARGES:  BCS                                       
095500*            AMERICAN EXPRESS CHARGES:  AXS                               
095600*            NOVUS/DISCOVER CHARGES:  NCS                                 
PAYVEN*            PAYPAL CHARGE:  PPS                                          
PAYVEN*            VENMO CHARGE:  VMS                                           
095700*            DEBIT CARD: DBS                                              
SEPHOR*            SEPHORA GIFT CARDS TENDERED: SGT                             
095800*                                                                         
095900*  THE FOLLOWING CATEGORY CODE BUCKETS ARE FOR SUBTRACTION FROM           
096000*  THE INDICATED TENDER TYPES TOTAL AMOUNT. THESE BUCKETS CONTAIN         
096100*  KOHLS CHARGE PAYMENTS:                                                 
096200*                                                                         
096300*            CHECK:  TCP, PCP, MGP                                        
096400*            GIFTCARD/GIFTCERT/KMRC:  GDP, GTP, KMP                       
096600*                                                                         
096700*  THE FOLLOWING CATEGORY CODE BUCKETS ARE NEW OVERPAYMENT OR             
096800*  CASH BACK BUCKETS AND ARE TO BE SUBTRACTED FROM THE INDICATED          
096900*  TENDER TYPES AMOUNT *** ONLY ***:                                      
097000*                                                                         
097100*            CHECK:  VCP, TCB, PCB, MGB                                   
097200*            GIFTCARD/GIFTCERT/KMRC:  GDB, GTB, KMB                       
097300*            KOHLS CHARGE:  KCB                                           
097400*            BANKCARD CHARGES:  BCB                                       
097500*            AMERICAN EXPRESS CHARGES:  AXB                               
097600*            NOVUS/DISCOVER CHARGES:  NCB                                 
097700*            DEBIT CARD: DBB                                              
097800*                                                                         
097900*  THE FOLLOWING CATEGORY CODE BUCKETS ARE RETURNS AND ARE TO BE          
098000*  SUBTRACTED FROM THE INDICATED TENDER TYPES AMOUNT *** ONLY ***         
098100*                                                                         
098200*            CASH: CAR                                                    
098200*            CHECKS:  POR                                                 
098300*            KOHLS CHARGE:  KCR                                           
098400*            BANKCARD CHARGES:  BCR                                       
098500*            AMERICAN EXPRESS CHARGES:  AXR                               
098600*            NOVUS/DISCOVER CHARGES:  NCR                                 
098610*            DEBIT CARD: DBR                                              
098700*            KMRC ISSUED: KMI                                             
098800*            CORPORATE REFUND ISSUED: CRI                                 
098900*                                                                         
099000*  THE FOLLOWING CATEGORY CODE BUCKETS ARE USED TO CALCULATE NET          
099100*  TOTAL SALES BY PRORATING TAXES AMOUNGST CASH, CHECK,                   
099200*  GIFTCARD/KMRC, KOHLS CHARGE, BANKCARD CHARGES, AMERICAN EXPRESS        
099300*  CHARGES, NOVUS/DISCOVER CHARGES AND GIFT CERTIFICATE:                  
099400*                                                                         
099500*             SALE:  SAL                                                  
099600*             TAX:   TAX                                                  
099700*                                                                         
099800*  THE FOLLOWING CATEGORY CODE BUCKETS ARE TO BE SUBTRACTED               
099900*  FROM THE NET TOTAL SALES AMOUNT TO DETERMINE THE FLASH                 
100000*  TOTAL SALES:                                                           
100100*                                                                         
100200*            GIFT CARD/CERTIFCATE SOLD: GDS, GTS                          
SEPHOR*            SEPHORA GIFT CARDS SOLD: SGS                                 
100300*            EMPLOYEE DISCOUNT: ECD                                       
082108*  THE FOLLOWING CATEGORY CODE BUCKETS ARE ACCUMULATED TO SHOW            
082108*  NON-MERCHANDISE SALES AMOUNTS WHICH FINANCE NEEDS TO SUB-              
082108*  TRACT FROM EACH TENDER TYPE.                                           
082108*                                                                         
082108*            SHIPPING SALES - SHIPPING RETURNS:  SHS - SHR                
082108*            GIFT WRAP SALES - GIFT WRAP RETURNS:  GWS - GWR              
082108*            MANIFESTO:  MAN                                              
082108*            SCANNING PENALTY:  SPN                                       
082108*            POSTAGE SALES:  PTG                                          
082108*            BLACKHAWK THIRD PARTY CARD:  TPC                             
100400******************************************************************        
100500     EXEC SQL                                                             
100600       DECLARE REPORT-CURSOR CURSOR FOR                                   
100700          SELECT A.SLS_DTE                                                
100900                ,B.STR_NBR                                                
101000                ,B.SUM_CTG_CDE                                            
101100                ,B.CTG_AMT                                                
101200          FROM  TEPPART A                                                 
101300               ,TSASUM  B                                                 
101400          WHERE A.PARTN_NBR = B.PARTN_NBR                                 
267236            AND (A.SLS_DTE BETWEEN :CC-BEGIN-DATE-CARD-CCYYMMDD           
267236                               AND :CC-END-DATE-CARD-CCYYMMDD)            
101800            AND A.DB_STRUC_CDE = 'O'                                      
101900            AND B.RGST_ID      = 00                                       
102000            AND B.SUM_TYP_CDE IN ('D', 'S')                               
102200            AND B.SUM_CTG_CDE IN ('CAS', 'VCK', 'TCK',                    
102300                                  'PCK', 'MGT', 'GDT',                    
102310                                  'GTT', 'KMT', 'KCS',                    
102400                                  'BCS', 'AXS', 'NCS',                    
082108                                  'DBS', 'POS', 'TAX',                    
COBTRL                                  'SGT', 'CVN', 'TTN',                    
PAYVEN                                  'PPS', 'VMS',                           
102600                                                                          
102700                                  'TCP', 'PCP', 'MGP',                    
102800                                  'GDP', 'GTP', 'KMP',                    
102900                                                                          
103000                                  'VCB', 'TCB', 'PCB',                    
103100                                  'MGB', 'GDB', 'GTB',                    
103110                                  'KMB', 'KCB', 'BCB',                    
103200                                  'AXB', 'NCB',                           
103300                                  'DBB',                                  
103400                                                                          
103500                                  'CAR', 'KCR', 'BCR',                    
103600                                  'AXR', 'NCR', 'DBR',                    
PAYVEN                                  'PPR', 'VMR',                           
103610                                  'KMI', 'CRI', 'POR',                    
082108                                  'SHS', 'SHR', 'GWS',                    
082108                                  'GWR', 'MAN', 'SPN',                    
SEPHOR                                  'PTG', 'TPC', 'SGS',                    
104100                                  'GDS', 'GTS', 'ECD')                    
104200                                                                          
104400          ORDER BY 2,1,3                                                  
104500          WITH UR                                                         
104700     END-EXEC.                                                            
094200                                                                          
094200                                                                          
104946*****************************************************************         
105000 PROCEDURE DIVISION.                                                      
105100                                                                          
105200 0000-MAINLINE.                                                           
105300                                                                          
105400     PERFORM 1000-INITIALIZATION       THRU 1000-EXIT.                    
105500                                                                          
105600     PERFORM 2000-LOAD-STORE-TABLE THRU 2000-EXIT                         
105700         UNTIL PS-YES-END-OF-CSR.                                         
105800                                                                          
105900     PERFORM 7200-CLOSE-CURSOR THRU 7200-EXIT.                            
                                                                                
106100     PERFORM 3000-PRORATE-TAXES THRU 3000-EXIT.                           
082108                                                                          
082108     PERFORM 5000-BUILD-CSV-OUTPUT THRU 5000-EXIT                         
106200                                                                          
           MOVE PV-TOTAL-COBRAND-TRL TO PV-TOTAL-COBRAND-TRL-DISPLAY.           
           DISPLAY 'TOTAL COBRAND TRAILNG TRANSACTIONS = '                      
                    PV-TOTAL-COBRAND-TRL-DISPLAY.                               
                                                                                
082108     CLOSE BYSTORE-CSV-OUTPUT-FILE.                                       
106900                                                                          
107000     GOBACK.                                                              
107100                                                                          
107200                                                                          
107300*****************************************************************         
107400*   IF CURSOR DATA IS NOT PRESENT, PRINT THE 'NO REPORT' MESSAGE.         
107500*   IF DATA IS PRESENT, SET UP THE CONTROL BREAK FIELDS, THEN             
107600*   PRINT THE INITIAL REPORT HEADINGS, FOR BOTH THE BYDATE                
107700*   AND THE BYSTORE REPORTS.                                              
107800*****************************************************************         
107900 1000-INITIALIZATION.                                                     
108000                                                                          
108100     EXEC SQL                                                             
108200         SET :PV-CURRENT-DATE = CURRENT DATE                              
108300     END-EXEC.                                                            
108400                                                                          
108500     MOVE PV-CURRENT-DATE    TO PV-SAVE-CURRENT-DATE                      
108700                                PV-PRCS-DATE-CCYYMMDD.                    
108800                                                                          
108900     ACCEPT PV-CURRENT-TIME FROM TIME.                                    
109000                                                                          
109200     OPEN  INPUT CONTROL-DATE-FILE                                        
082108          OUTPUT BYSTORE-CSV-OUTPUT-FILE.                                 
109700                                                                          
109800     PERFORM 1120-PROCESS-DATE-CARD     THRU 1120-EXIT.                   
110000                                                                          
082108     INITIALIZE CR-CSV-RECORD.                                            
110300                                                                          
110400     INITIALIZE TBL2-KOHLS-TRANS-BY-STORE.                                
111700                                                                          
111800     DISPLAY ' '.                                                         
111900     DISPLAY '******* CURSOR DATES ********'                              
SEPHOR     DISPLAY 'SSKRP003 BEGIN DATE:' CC-BEGIN-DATE-CARD-CCYYMMDD           
SEPHOR     DISPLAY 'SSKRP003 END   DATE:' CC-END-DATE-CARD-CCYYMMDD             
112200     DISPLAY '*****************************'                              
112300                                                                          
112400     PERFORM 7000-OPEN-CURSOR THRU 7000-EXIT.                             
112500                                                                          
112600     PERFORM 7100-FETCH-CURSOR THRU 7100-EXIT.                            
112700                                                                          
112800     IF PS-YES-END-OF-CSR                                                 
112900         DISPLAY ' '                                                      
113000         DISPLAY '*** NO TENDER ANALYSIS DATE PRESENT ***'                
113900     ELSE                                                                 
114100         MOVE PV-STR-NBR      TO PV-SAVE-STR-NBR                          
114300         MOVE +1              TO TSUB2                                    
114500                                 TOT-BYSTORE-ON-TBL2                      
114700         MOVE PV-SAVE-STR-NBR TO TBL2-STR-NBR (TSUB2)                     
115200     END-IF.                                                              
115300                                                                          
115400 1000-EXIT.                                                               
115500     EXIT.                                                                
115600                                                                          
121700                                                                          
121800**********************************                                        
123700* READ DATE PLACED ON INPUT CARD.                                         
123900******************************************************************        
124000 1120-PROCESS-DATE-CARD.                                                  
124100                                                                          
124200     PERFORM 1130-READ-DATE-CARD-FILE THRU 1130-EXIT.                     
124300                                                                          
124400     CLOSE CONTROL-DATE-FILE.                                             
124500                                                                          
124600     DISPLAY ' '.                                                         
124700     DISPLAY PC-CURRENT-PROGRAM-NAME                                      
267236             ' - DATE CARD = (' CC-DATE-CARD ')'.                         
124900                                                                          
125200 1120-EXIT.                                                               
125300     EXIT.                                                                
125400                                                                          
125500******************************************************************        
125600*     READ DATE CONTROL CARD.                                             
125700******************************************************************        
125800 1130-READ-DATE-CARD-FILE.                                                
125900                                                                          
126000     READ CONTROL-DATE-FILE INTO CC-DATE-CARD                             
126100        AT END                                                            
126200           MOVE 'Y' TO PS-END-OF-DATE-FILE-SW                             
126300     END-READ.                                                            
126400                                                                          
126500     IF PS-YES-END-OF-DATE-FILE                                           
126600         MOVE '1130-READ-DATE-CARD-FILE' TO PV-PARAGRAPH-NAME             
126700         MOVE 'NO DATE CARD TO PROCESS'  TO PV-OPERATION-MSG-1            
126800         SET AC-DATE-CARD-ERROR TO TRUE                                   
126900         PERFORM 9999-ABEND                                               
127000     END-IF.                                                              
127100                                                                          
127200 1130-EXIT.                                                               
127300     EXIT.                                                                
127400                                                                          
153900******************************************************************        
154000* LOAD TABLE WITH RECORDS SUMMED BY STORE.                                
154200******************************************************************        
154300 2000-LOAD-STORE-TABLE.                                                   
154400                                                                          
154500     IF PV-STR-NBR = PV-SAVE-STR-NBR                                      
154900         PERFORM 2300-ACCUM-TRANS-BY-STR   THRU 2300-EXIT                 
157800     ELSE                                                                 
157900         ADD +1               TO TSUB2                                    
158000                                 TOT-BYSTORE-ON-TBL2                      
158100         MOVE PV-STR-NBR      TO PV-SAVE-STR-NBR                          
158200         MOVE PV-SAVE-STR-NBR TO TBL2-STR-NBR (TSUB2)                     
158300                                                                          
160000         PERFORM 2300-ACCUM-TRANS-BY-STR   THRU 2300-EXIT                 
161200     END-IF.                                                              
161300                                                                          
161400     PERFORM 7100-FETCH-CURSOR THRU 7100-EXIT.                            
161500                                                                          
161600 2000-EXIT.                                                               
161700     EXIT.                                                                
161800                                                                          
161900                                                                          
162000******************************************************************        
162100* ACCUMULATE **ALL** STORES TOTALS FOR THE DATE, OR DATE RANGE            
162200* BEING PROCESSED.  THE STORE TOTAL TO BE INCREMENTED/DECREMENTED         
162300* IS DETERMINED BY THE HARD TOTAL TYPE (I.E. TSASUM-SUM-CTG-CDE).         
162400* THIS IS DONE AS FOLLOWS:                                                
162500*                                                                         
162600*   FIRST:  FOR EACH TRAN TYPE, ACCUMULATE A TOTAL AMOUNT.                
162700*                                                                         
162800*   SECOND: FOR EACH TRAN TYPE THAT CAN, APPLY PAYMENT OF THE             
162900*           KOHLS CHARGE TO THE TOTAL AMOUNT.                             
163000*                                                                         
163100*   THIRD: FOR EACH TRAN TYPE THAT CAN, APPLY CASH BACK TO                
163200*           *** ONLY *** THE TOTAL AMOUNT.                                
163300*                                                                         
163400*           ***** NOTE: CASH BACK FIELDS CONTAIN                          
163500*           -- NEGATIVE --  AMOUNTS                                       
163600*                                                                         
163700*  FOURTH: FOR EACH TRAN TYPE THAT CAN, APPLY RETURNS TO                  
163800*           *** ONLY *** THE TOTAL AMOUNT.                                
164000*                                                                         
164100*  FIFTH:  ACCUMULATE THE KOHLS GIFT CARD/CERTIFICATE SOLD,               
SEPHOR*          SEPHORA GIFT CARDS SOLD,                                       
164200*          EMPLOYEE DISCOUNT, AND TAX TRANSACTION TYPES.                  
164300*          THESE TOTALS WILL LATER BE USED IN PRORATING THE               
164400*          SALES TAX TO THE PRIMARY TRANS TYPES:  CASH, CHECKS,           
COBRND*          GIFTCARD/KMRC, KOHLS CHARGE, COBRAND, BANKCARD,                
PAYVEN*          AMERICAN EXPRESS, NOVUS/DISCOVER CHARGES, PAYPAL,              
PAYVEN*          VENMO AND GIFT CERTIFICATES.                                   
164700******************************************************************        
186400                                                                          
211100                                                                          
211200******************************************************************        
211300* ACCUMULATE EACH STORES TOTALS FOR THE DATE, OR DATE RANGE               
211400* BEING PROCESSED.  THE STORE TOTAL TO BE INCREMENTED/DECREMENTED         
211500* IS DETERMINED BY THE HARD TOTAL TYPE (I.E. TSASUM-SUM-CTG-CDE).         
211600* THIS IS DONE AS FOLLOWS:                                                
211700*                                                                         
211800*   FIRST:  FOR EACH TRAN TYPE, ACCUMULATE A TOTAL AMOUNT.                
211900*                                                                         
212000*   SECOND: FOR EACH TRAN TYPE THAT CAN, APPLY PAYMENT OF THE             
212100*           KOHLS CHARGE TO THE TOTAL AMOUNT.                             
212200*                                                                         
212300*   THIRD: FOR EACH TRAN TYPE THAT CAN, APPLY CASH BACK TO                
212400*           *** ONLY *** THE TOTAL AMOUNT.                                
212500*                                                                         
212600*           ***** NOTE: CASH BACK FIELDS CONTAIN                          
212700*           -- NEGATIVE --  AMOUNTS                                       
212800*                                                                         
212900*  FOURTH: FOR EACH TRAN TYPE THAT CAN, APPLY RETURNS TO                  
213000*           *** ONLY *** THE TOTAL AMOUNT.                                
213200*                                                                         
213300*  FIFTH:  ACCUMULATE THE KOHLS GIFT CARD/CERTIFICATE SOLD,               
SEPHOR*          SEPHORA GIFT CARDS SOLD,                                       
213400*          EMPLOYEE DISCOUNT, AND TAX TRANSACTION TYPES.                  
213500*          THESE TOTALS WILL LATER BE USED IN PRORATING THE               
213600*          SALES TAX TO THE PRIMARY TRANS TYPES:  CASH, CHECKS,           
COBRND*          GIFTCARD/KMRC, KOHLS CHARGE, COBRAND, BANKCARD,                
PAYVEN*          AMERICAN EXPRESS, NOVUS/DISCOVER CHARGES, PAYPAL,              
PAYVEN*          VENMO AND GIFT CERTIFICATES.                                   
082108*  SIXTH:  ACCUMULATE THE NON-MERCHANDISE SALES AMOUNT FOR EACH           
082108*          STORE.                                                         
213900******************************************************************        
214000 2300-ACCUM-TRANS-BY-STR.                                                 
214100                                                                          
214200     EVALUATE TRUE                                                        
214300*                                                                         
214400* CASH                                                                    
214500*                                                                         
214600       WHEN PV-ADD-CASH                                                   
214700         COMPUTE TBL2-CASH-TOT-AMT (TSUB2) =                              
214800            TBL2-CASH-TOT-AMT (TSUB2) + PV-CTG-AMT                        
214900*                                                                         
215000* CHECK                                                                   
215100*                                                                         
215200       WHEN PV-ADD-CHECK                                                  
215300         COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                             
215400            TBL2-CHECK-TOT-AMT (TSUB2) + PV-CTG-AMT                       
215500*                                                                         
215600*  GIFTCARD/GIFTCERT/KMRC                                                 
215700*                                                                         
215800       WHEN PV-ADD-GCRD-GCRT-KMRC                                         
215900         COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) =                    
216000            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) + PV-CTG-AMT              
216100*                                                                         
216200* KOHLS CHARGE                                                            
216300*                                                                         
216400       WHEN PV-ADD-KOHLS-CHG                                              
216500         COMPUTE TBL2-KOHLS-CHG-TOT-AMT (TSUB2) =                         
216600            TBL2-KOHLS-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                   
COBRND*                                                                         
COBRND* COBRAND CHARGE                                                          
COBRND*                                                                         
COBRND       WHEN PV-ADD-COBRAND-CHG                                            
COBRND         COMPUTE TBL2-COBRAND-CHG-TOT-AMT (TSUB2) =                       
COBRND            TBL2-COBRAND-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                 
COBRND                                                                          
COBRND*        SUBTRACT COBRAND CHARGE FROM BANKCARD CHARGE                     
COBRND         COMPUTE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) =                        
COBRND            TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) - PV-CTG-AMT                  
COBRND*                                                                         
COBTRL* COBRAND TRAILING TRANSACTION                                            
COBTRL*                                                                         
COBTRL       WHEN PV-ADD-COBRAND-TRL                                            
COBTRL*        ADD COBRAND TRAILING TRAN TO COBRAND CHARGE                      
COBTRL         COMPUTE TBL2-COBRAND-CHG-TOT-AMT (TSUB2) =                       
COBTRL            TBL2-COBRAND-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                 
COBTRL            ADD PV-CTG-AMT TO PV-TOTAL-COBRAND-TRL                        
COBTRL                                                                          
COBTRL*        SUBTRACT COBRAND TRAILING TRAN FROM KOHLS CHARGE                 
COBTRL         COMPUTE TBL2-KOHLS-CHG-TOT-AMT (TSUB2) =                         
COBTRL            TBL2-KOHLS-CHG-TOT-AMT (TSUB2) - PV-CTG-AMT                   
216700*                                                                         
216800* BANKCARD CHARGE                                                         
216900*                                                                         
217000       WHEN PV-ADD-BNKCRD-CHG                                             
217100         COMPUTE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) =                        
217200            TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                  
217300*                                                                         
217400* AMERICAN EXPRESS CHARGE                                                 
217500*                                                                         
217600       WHEN PV-ADD-AMEX-CHG                                               
217700         COMPUTE TBL2-AMEX-CHG-TOT-AMT (TSUB2) =                          
217800            TBL2-AMEX-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                    
217900*                                                                         
218000* DISCOVER CHARGE                                                         
218100*                                                                         
218200       WHEN PV-ADD-DSCVR-CHG                                              
218300         COMPUTE TBL2-DSCVR-CHG-TOT-AMT (TSUB2) =                         
218400            TBL2-DSCVR-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                   
PAYVEN*                                                                         
PAYVEN* PAYPAL CHARGE                                                           
PAYVEN*                                                                         
PAYVEN       WHEN PV-ADD-PAYPAL-CHG                                             
PAYVEN         COMPUTE TBL2-PAYPAL-CHG-TOT-AMT (TSUB2) =                        
PAYVEN            TBL2-PAYPAL-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                  
PAYVEN*                                                                         
PAYVEN* VENMO CHARGE                                                            
PAYVEN*                                                                         
PAYVEN       WHEN PV-ADD-VENMO-CHG                                              
PAYVEN         COMPUTE TBL2-VENMO-CHG-TOT-AMT (TSUB2) =                         
PAYVEN            TBL2-VENMO-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                   
218500*                                                                         
218600* DEBIT CARD                                                              
218700*                                                                         
218801**CALCULATE DEBIT CARD TOTAL                                              
218800       WHEN PV-ADD-DEBIT-CARD                                             
218900         COMPUTE TBL2-DEBIT-CARD-TOT-AMT (TSUB2) =                        
219000            TBL2-DEBIT-CARD-TOT-AMT (TSUB2) + PV-CTG-AMT                  
SEPHOR*                                                                         
SEPHOR* SEPHORA GIFT CARD TENDERS                                               
SEPHOR*                                                                         
SEPHOR       WHEN PV-ADD-SEPHORA-GC-TENDER                                      
SEPHOR         COMPUTE TBL2-SEPHORA-SGT-TOT-AMT (TSUB2) =                       
SEPHOR            TBL2-SEPHORA-SGT-TOT-AMT (TSUB2) + PV-CTG-AMT                 
SEPH03                                                                          
SEPH03* SUBTRACT SEPHORA GC TENDER FROM GIFTCRT/KMRC                            
SEPH03         SUBTRACT PV-CTG-AMT FROM                                         
SEPH03            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2)                           
SEPH03*                                                                         
219200* PAY KOHLS CHARGE BY CHECK                                               
219300*                                                                         
219400       WHEN PV-PAY-KHL-CHG-BY-CHK                                         
219500         COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                             
219600            TBL2-CHECK-TOT-AMT (TSUB2) - PV-CTG-AMT                       
219700*                                                                         
219800* PAY KOHLS CHARGE BY GIFTCARD/GIFTCERT/KMRC                              
219900*                                                                         
220000       WHEN PV-PAY-KLCHG-BY-GCRD-GCRT-KMRC                                
220100         COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) =                    
220200            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) - PV-CTG-AMT              
220900*                                                                         
221000* CASH BACK VIA CHECK                                                     
221100*                                                                         
221200       WHEN PV-CB-VIA-CHECK-AMT                                           
221300                                                                          
221400         COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                             
221500            TBL2-CHECK-TOT-AMT (TSUB2) + PV-CTG-AMT                       
221600*                                                                         
221700* CASH BACK VIA GIFTCARD/GIFTCERT/KMRC                                    
221800*                                                                         
221900       WHEN PV-CB-VIA-GCRD-GCRT-KMRC-AMT                                  
222000                                                                          
222100         COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) =                    
222200            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) + PV-CTG-AMT              
223000*                                                                         
223100* CASH BACK VIA KOHLS CHARGE                                              
223200*                                                                         
223300       WHEN  PV-CB-VIA-KOHLS-CHG-AMT                                      
223400         COMPUTE TBL2-KOHLS-CHG-TOT-AMT (TSUB2) =                         
223500            TBL2-KOHLS-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                   
223600*                                                                         
223700* CASH BACK VIA BANKCARD                                                  
223800*                                                                         
223900       WHEN PV-CB-VIA-BNKCRD-CHG-AMT                                      
224000                                                                          
224100         COMPUTE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) =                        
224200            TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                  
224300*                                                                         
224400* CASH BACK VIA AMEX CHG                                                  
224500*                                                                         
224600       WHEN PV-CB-VIA-AMEX-CHG-AMT                                        
224700                                                                          
224800         COMPUTE TBL2-AMEX-CHG-TOT-AMT (TSUB2) =                          
224900            TBL2-AMEX-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                    
225000*                                                                         
225100* CASH BACK VIA DSCVR CHG                                                 
225200*                                                                         
225300       WHEN  PV-CB-VIA-DSCVR-CHG-AMT                                      
225400                                                                          
225500         COMPUTE TBL2-DSCVR-CHG-TOT-AMT (TSUB2) =                         
225600            TBL2-DSCVR-CHG-TOT-AMT (TSUB2) + PV-CTG-AMT                   
225610*                                                                         
225620* CASH BACK VIA DEBIT CARD                                                
225630*                                                                         
225640       WHEN  PV-CB-VIA-DEBIT-CARD-AMT                                     
225650                                                                          
225660         COMPUTE TBL2-DEBIT-CARD-TOT-AMT (TSUB2) =                        
225670            TBL2-DEBIT-CARD-TOT-AMT (TSUB2) + PV-CTG-AMT                  
225700*                                                                         
225800* CASH RETURNS                                                            
225900*                                                                         
226000       WHEN  PV-RET-VIA-CASH                                              
226100                                                                          
226200         COMPUTE TBL2-CASH-TOT-AMT (TSUB2)=                               
226300            TBL2-CASH-TOT-AMT (TSUB2)+ PV-CTG-AMT                         
176500*                                                                         
176600* CHECK (POR) RETURNS                                                     
176700*                                                                         
176800       WHEN  PV-RET-VIA-CHECK                                             
201900                                                                          
215300         COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                             
215400            TBL2-CHECK-TOT-AMT (TSUB2) + PV-CTG-AMT                       
226700*                                                                         
226800* KOHLS CHARGE RETURNS                                                    
226900*                                                                         
227000       WHEN  PV-RET-VIA-KOHLS-CHG                                         
227100                                                                          
227200         COMPUTE TBL2-KOHLS-CHG-TOT-AMT (TSUB2)=                          
227300            TBL2-KOHLS-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                    
227700*                                                                         
227800* BANKCARD CHARGE RETURNS                                                 
227900*                                                                         
228000       WHEN  PV-RET-VIA-BNKCRD-CHG                                        
228100                                                                          
228200         COMPUTE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2)=                         
228300            TBL2-BNKCRD-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                   
228700*                                                                         
228800* AMEX CHARGE RETURNS                                                     
228900*                                                                         
229000       WHEN  PV-RET-VIA-AMEX-CHG                                          
229100                                                                          
229200         COMPUTE TBL2-AMEX-CHG-TOT-AMT (TSUB2)=                           
229300            TBL2-AMEX-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                     
229700*                                                                         
229800* DISCOVER CHARGE RETURN                                                  
229900*                                                                         
230000       WHEN  PV-RET-VIA-DSCVR-CHG                                         
230100                                                                          
230200         COMPUTE TBL2-DSCVR-CHG-TOT-AMT (TSUB2)=                          
230300            TBL2-DSCVR-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                    
PAYVEN*                                                                         
PAYVEN* PAYPAL CHARGE RETURN                                                    
PAYVEN*                                                                         
PAYVEN       WHEN  PV-RET-VIA-PAYPAL-CHG                                        
PAYVEN                                                                          
PAYVEN         COMPUTE TBL2-PAYPAL-CHG-TOT-AMT (TSUB2)=                         
PAYVEN            TBL2-PAYPAL-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                   
PAYVEN*                                                                         
PAYVEN* VENMO CHARGE RETURN                                                     
PAYVEN*                                                                         
PAYVEN       WHEN  PV-RET-VIA-VENMO-CHG                                         
PAYVEN                                                                          
PAYVEN         COMPUTE TBL2-VENMO-CHG-TOT-AMT (TSUB2)=                          
PAYVEN            TBL2-VENMO-CHG-TOT-AMT (TSUB2)+ PV-CTG-AMT                    
230610*                                                                         
230620* DEBIT CARD RETURN                                                       
230630*                                                                         
230640       WHEN  PV-RET-VIA-DEBIT-CARD                                        
230650                                                                          
230660         COMPUTE TBL2-DEBIT-CARD-TOT-AMT (TSUB2)=                         
230670            TBL2-DEBIT-CARD-TOT-AMT (TSUB2)+ PV-CTG-AMT                   
230700*                                                                         
230800* KMRC ISSUED                                                             
230900*                                                                         
231000       WHEN  PV-KMRC-ISSUED                                               
231100                                                                          
231200         COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) =                    
231300            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2 ) + PV-CTG-AMT             
231700*                                                                         
231800* CORPORATE REFUND ISSUED                                                 
231900*                                                                         
232000       WHEN  PV-CORP-REFUND-ISSUED                                        
232100                                                                          
232200         COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                             
232300            TBL2-CHECK-TOT-AMT (TSUB2) + PV-CTG-AMT                       
233400*                                                                         
233500* KOHLS TAX                                                               
233600*                                                                         
233700       WHEN PV-SUB-TAX                                                    
233800         COMPUTE TBL2-KOHLS-TAX-AMT (TSUB2) =                             
233900            TBL2-KOHLS-TAX-AMT (TSUB2) + PV-CTG-AMT                       
234000*                                                                         
234100* KOHLS GIFT CARD/CERTIFICATE SOLD                                        
234200*                                                                         
234300       WHEN PV-SUB-KOHLS-GFT-CRD-CERT-SOLD                                
234400         COMPUTE TBL2-KOHLS-GFT-CRD-CERT-AMT (TSUB2) =                    
234500            TBL2-KOHLS-GFT-CRD-CERT-AMT (TSUB2) + PV-CTG-AMT              
SEPHOR*                                                                         
SEPHOR* SEPHORA GIFT CARD SALES                                                 
SEPHOR*                                                                         
SEPHOR       WHEN PV-SUB-SEPHORA-GC-SOLD                                        
SEPHOR         COMPUTE TBL2-SEPHORA-SGS-TOT-AMT (TSUB2) =                       
SEPHOR            TBL2-SEPHORA-SGS-TOT-AMT (TSUB2) + PV-CTG-AMT                 
SEPH03* SUBTRACTING SEPHORA GC SALES FROM NON-MERCH SALES (TPC)                 
SEPH03         SUBTRACT PV-CTG-AMT FROM                                         
SEPH03            TBL2-NON-MERCH-SLS-AMT (TSUB2)                                
234600*                                                                         
234700* KOHLS EMPLOYEE DISCOUNT                                                 
234800*                                                                         
234900       WHEN PV-SUB-EMPL-DISCOUNT                                          
235000         COMPUTE TBL2-KOHLS-EMPL-DISC-AMT (TSUB2) =                       
235100            TBL2-KOHLS-EMPL-DISC-AMT (TSUB2) + PV-CTG-AMT                 
235200                                                                          
235200*                                                                         
082108* NON-MERCHANDISE SALE AMOUNT                                             
082108* SEPHORA GIFT CARD SALES HAVE ALREADY BEEN SUBTRACTED ABOVE IN THE       
082108* WHEN SGS SECTION                                                        
082108       WHEN PV-NON-MERCH-SLS-AMT                                          
082108         COMPUTE TBL2-NON-MERCH-SLS-AMT   (TSUB2) =                       
082108            TBL2-NON-MERCH-SLS-AMT   (TSUB2) + PV-CTG-AMT                 
082108*                                                                         
082108* NON-MERCHANDISE RETURN AMOUNT                                           
082108*                                                                         
082108       WHEN PV-NON-MERCH-RTN-AMT                                          
082108         COMPUTE TBL2-NON-MERCH-SLS-AMT   (TSUB2) =                       
082108            TBL2-NON-MERCH-SLS-AMT   (TSUB2) + PV-CTG-AMT                 
082108                                                                          
235300     END-EVALUATE.                                                        
235400                                                                          
235500 2300-EXIT.                                                               
235600     EXIT.                                                                
235700                                                                          
262600                                                                          
262700**********************************************************                
262800* THE TOTAL SALES FOR EACH TRANS TYPE INCLUDES TAX.  THE *                
262900* TAX MUST BE PRORATED AS FOLLOWS:                       *                
263000*                                                        *                
263100*      A) DETERMINE WHAT PERCENT OF TOTAL SALES IS THE   *                
263200*         TRAN TYPE SALES.                               *                
263300*                                                        *                
263400*      B) APPLY THAT PERCENT TO THE TOTAL TAX AMOUNT     *                
263500*         TO DETERMINE THE DOLLAR AMOUNT OF TAXES TO     *                
263600*         BE SUBTRACTED FROM THE TOTAL SALES OF THE      *                
263700*         TRAN TYPE.                                     *                
263800*                                                        *                
263900*      C) SUBTRACT THE  CALCULATED PERCENT AMOUNT OF     *                
264000*         TAXES FROM THE TOTAL SALES FOR THE TRAN TYPE.  *                
264100**********************************************************                
264200 3000-PRORATE-TAXES.                                                      
264300                                                                          
265700     PERFORM 3500-CALC-SALES-PCT-BYSTR THRU 3500-EXIT                     
265800       VARYING TSUB2 FROM 1 BY 1                                          
265900         UNTIL TSUB2 > TOT-BYSTORE-ON-TBL2                                
266000          OR TSUB2 > MAX-TSUB2.                                           
266100                                                                          
266200     PERFORM 3600-APPLY-PRORATE-PCT-BYSTR THRU 3600-EXIT                  
266300       VARYING TSUB2 FROM 1 BY 1                                          
266400         UNTIL TSUB2 > TOT-BYSTORE-ON-TBL2                                
266500          OR TSUB2 > MAX-TSUB2.                                           
266600                                                                          
267000 3000-EXIT.                                                               
267100     EXIT.                                                                
267200                                                                          
305700                                                                          
305800****************************************************************          
305900* DETERMINE FOR EACH TRANS TYPE ITS PERCENTAGE OF TOTAL SALES, *          
306000* BY STORE.                                                    *          
306100****************************************************************          
306200 3500-CALC-SALES-PCT-BYSTR.                                               
306300                                                                          
           COMPUTE TBL2-KOHLS-TOT-SAL-AMT (TSUB2) =                             
             (TBL2-CASH-TOT-AMT (TSUB2)           +                             
              TBL2-CHECK-TOT-AMT (TSUB2)          +                             
              TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) +                             
              TBL2-KOHLS-CHG-TOT-AMT (TSUB2)      +                             
COBRND        TBL2-COBRAND-CHG-TOT-AMT (TSUB2)    +                             
              TBL2-BNKCRD-CHG-TOT-AMT (TSUB2)     +                             
              TBL2-AMEX-CHG-TOT-AMT (TSUB2)       +                             
              TBL2-DSCVR-CHG-TOT-AMT (TSUB2)      +                             
PAYVEN        TBL2-PAYPAL-CHG-TOT-AMT (TSUB2)     +                             
PAYVEN        TBL2-VENMO-CHG-TOT-AMT (TSUB2)      +                             
SEPH03        TBL2-SEPHORA-SGT-TOT-AMT (TSUB2)    +                             
              TBL2-DEBIT-CARD-TOT-AMT (TSUB2)).                                 
306400***                                                                       
306500* CASH - PERCENT                                                          
306600***                                                                       
306700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
306800       COMPUTE TBL2-CASH-TOT-PCT (TSUB2) =                                
306900        (TBL2-CASH-TOT-AMT (TSUB2) /                                      
307000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
307100     ELSE                                                                 
307200         MOVE ZEROES TO TBL2-CASH-TOT-PCT (TSUB2)                         
307300     END-IF.                                                              
307400***                                                                       
307500* CHECKS - PERCENT                                                        
307600***                                                                       
307700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
307800       COMPUTE TBL2-CHECK-TOT-PCT (TSUB2) =                               
307900        (TBL2-CHECK-TOT-AMT (TSUB2) /                                     
308000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
308100     ELSE                                                                 
308200         MOVE ZEROES TO TBL2-CHECK-TOT-PCT (TSUB2)                        
308300     END-IF.                                                              
308400***                                                                       
308500* GIFTCARD/GIFTCERT/KMRC  - PERCENT                                       
308600***                                                                       
308700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
308800       COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-PCT (TSUB2) =                      
308900        (TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) /                            
309000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
309100     ELSE                                                                 
309200         MOVE ZEROES TO TBL2-GCRD-GCRT-KMRC-TOT-PCT (TSUB2)               
309300     END-IF.                                                              
309400***                                                                       
309500* KOHLS CHARGE - PERCENT                                                  
309600***                                                                       
309700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
309800       COMPUTE TBL2-KOHLS-CHG-TOT-PCT (TSUB2) =                           
309900        (TBL2-KOHLS-CHG-TOT-AMT (TSUB2) /                                 
310000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
310100     ELSE                                                                 
310200         MOVE ZEROES TO TBL2-KOHLS-CHG-TOT-PCT (TSUB2)                    
310300     END-IF.                                                              
COBRND***                                                                       
COBRND* COBRAND CHARGE - PERCENT                                                
COBRND***                                                                       
COBRND     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
COBRND       COMPUTE TBL2-COBRAND-CHG-TOT-PCT (TSUB2) =                         
COBRND        (TBL2-COBRAND-CHG-TOT-AMT (TSUB2) /                               
COBRND                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
COBRND     ELSE                                                                 
COBRND         MOVE ZEROES TO TBL2-COBRAND-CHG-TOT-PCT (TSUB2)                  
COBRND     END-IF.                                                              
310400***                                                                       
310500* BANKCARD CHARGE - PERCENT                                               
310600***                                                                       
310700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
310800       COMPUTE TBL2-BNKCRD-CHG-TOT-PCT (TSUB2) =                          
310900        (TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) /                                
311000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
311100     ELSE                                                                 
311200         MOVE ZEROES TO TBL2-BNKCRD-CHG-TOT-PCT (TSUB2)                   
311300     END-IF.                                                              
311400***                                                                       
311500* AMEX CHARGE - PERCENT                                                   
311600***                                                                       
311700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
311800       COMPUTE TBL2-AMEX-CHG-TOT-PCT (TSUB2) =                            
311900        (TBL2-AMEX-CHG-TOT-AMT (TSUB2) /                                  
312000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
312100     ELSE                                                                 
312200         MOVE ZEROES TO TBL2-AMEX-CHG-TOT-PCT (TSUB2)                     
312300     END-IF.                                                              
312400***                                                                       
312500* DSCVR CHARGE - PERCENT                                                  
312600***                                                                       
312700     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
312800       COMPUTE TBL2-DSCVR-CHG-TOT-PCT (TSUB2) =                           
312900        (TBL2-DSCVR-CHG-TOT-AMT (TSUB2) /                                 
313000                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
313100     ELSE                                                                 
313200         MOVE ZEROES TO TBL2-DSCVR-CHG-TOT-PCT (TSUB2)                    
313300     END-IF.                                                              
314400                                                                          
PAYVEN***                                                                       
PAYVEN* PAYPAL CHARGE - PERCENT                                                 
PAYVEN***                                                                       
PAYVEN     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
PAYVEN       COMPUTE TBL2-PAYPAL-CHG-TOT-PCT (TSUB2) =                          
PAYVEN        (TBL2-PAYPAL-CHG-TOT-AMT (TSUB2) /                                
PAYVEN                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
PAYVEN     ELSE                                                                 
PAYVEN         MOVE ZEROES TO TBL2-PAYPAL-CHG-TOT-PCT (TSUB2)                   
PAYVEN     END-IF.                                                              
PAYVEN                                                                          
PAYVEN***                                                                       
PAYVEN* VENMO CHARGE - PERCENT                                                  
PAYVEN***                                                                       
PAYVEN     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
PAYVEN       COMPUTE TBL2-VENMO-CHG-TOT-PCT (TSUB2) =                           
PAYVEN        (TBL2-VENMO-CHG-TOT-AMT (TSUB2) /                                 
PAYVEN                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
PAYVEN     ELSE                                                                 
PAYVEN         MOVE ZEROES TO TBL2-VENMO-CHG-TOT-PCT (TSUB2)                    
PAYVEN     END-IF.                                                              
PAYVEN                                                                          
314410***                                                                       
314420* DEBIT CARD - PERCENT                                                    
314430***                                                                       
314440     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
314450       COMPUTE TBL2-DEBIT-CARD-TOT-PCT (TSUB2) =                          
314460        (TBL2-DEBIT-CARD-TOT-AMT (TSUB2) /                                
314470                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
314480     ELSE                                                                 
314490         MOVE ZEROES TO TBL2-DEBIT-CARD-TOT-PCT (TSUB2)                   
314491     END-IF.                                                              
314492                                                                          
SEPHOR***                                                                       
SEPHOR* SEPHORA GIFT CARDS TENDERED - PERCENT                                   
SEPHOR***                                                                       
SEPHOR     IF TBL2-KOHLS-TOT-SAL-AMT (TSUB2) > ZEROES                           
SEPHOR       COMPUTE TBL2-SEPHORA-SGT-TOT-PCT (TSUB2) =                         
SEPHOR        (TBL2-SEPHORA-SGT-TOT-AMT (TSUB2) /                               
SEPHOR                 TBL2-KOHLS-TOT-SAL-AMT (TSUB2))                          
SEPHOR     ELSE                                                                 
SEPHOR         MOVE ZEROES TO TBL2-SEPHORA-SGT-TOT-PCT (TSUB2)                  
SEPHOR     END-IF.                                                              
SEPHOR                                                                          
314500 3500-EXIT.                                                               
314600     EXIT.                                                                
314700                                                                          
314800****************************************************************          
314900* TOTAL TAX IS TO BE PRORATED INTO THE APPROPRIATE TRANSACTION *          
315000* TYPES, IN THIS CASE, BY STORE.                               *          
315100****************************************************************          
315200 3600-APPLY-PRORATE-PCT-BYSTR.                                            
315300                                                                          
315400***                                                                       
315500* CASH - PERCENT                                                          
315600***                                                                       
315700     MOVE ZEROES TO PV-CALC-TOTAL.                                        
315800                                                                          
315900     COMPUTE PV-CALC-TOTAL =                                              
316000         TBL2-CASH-TOT-PCT (TSUB2)  *                                     
316100                               TBL2-KOHLS-TAX-AMT (TSUB2).                
316200                                                                          
316300     COMPUTE TBL2-CASH-TOT-AMT (TSUB2) =                                  
316400                TBL2-CASH-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                
316500                                                                          
316600***                                                                       
316700* CHECKS - PERCENT                                                        
316800***                                                                       
316900     MOVE ZEROES TO PV-CALC-TOTAL.                                        
317000                                                                          
317100     COMPUTE PV-CALC-TOTAL =                                              
317200         TBL2-CHECK-TOT-PCT (TSUB2) *                                     
317300                               TBL2-KOHLS-TAX-AMT (TSUB2).                
317400                                                                          
317500     COMPUTE TBL2-CHECK-TOT-AMT (TSUB2) =                                 
317600                TBL2-CHECK-TOT-AMT (TSUB2) - PV-CALC-TOTAL.               
317700                                                                          
317800***                                                                       
317900* GIFTCARD/GIFTCERT/KMRC  - PERCENT                                       
318000***                                                                       
318100     MOVE ZEROES TO PV-CALC-TOTAL.                                        
318200                                                                          
318300     COMPUTE PV-CALC-TOTAL =                                              
318400         TBL2-GCRD-GCRT-KMRC-TOT-PCT (TSUB2) *                            
318500                               TBL2-KOHLS-TAX-AMT (TSUB2).                
318600                                                                          
318700     COMPUTE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) =                        
318800            TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2) - PV-CALC-TOTAL.          
318900                                                                          
319000***                                                                       
319100* KOHLS CHARGE - PERCENT                                                  
319200***                                                                       
319300     MOVE ZEROES TO PV-CALC-TOTAL.                                        
319400                                                                          
319500     COMPUTE PV-CALC-TOTAL =                                              
319600         TBL2-KOHLS-CHG-TOT-PCT (TSUB2) *                                 
319700                               TBL2-KOHLS-TAX-AMT (TSUB2).                
319800                                                                          
319900     COMPUTE TBL2-KOHLS-CHG-TOT-AMT (TSUB2) =                             
320000           TBL2-KOHLS-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                
320100                                                                          
COBRND***                                                                       
COBRND* COBRAND CHARGE - PERCENT                                                
COBRND***                                                                       
COBRND     MOVE ZEROES TO PV-CALC-TOTAL.                                        
COBRND                                                                          
COBRND     COMPUTE PV-CALC-TOTAL =                                              
COBRND         TBL2-COBRAND-CHG-TOT-PCT (TSUB2) *                               
COBRND                               TBL2-KOHLS-TAX-AMT (TSUB2).                
COBRND                                                                          
COBRND     COMPUTE TBL2-COBRAND-CHG-TOT-AMT (TSUB2) =                           
COBRND           TBL2-COBRAND-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.              
COBRND                                                                          
320200***                                                                       
320300* BANKCARD CHARGE - PERCENT                                               
320400***                                                                       
320500     MOVE ZEROES TO PV-CALC-TOTAL.                                        
320600                                                                          
320700     COMPUTE PV-CALC-TOTAL =                                              
320800               TBL2-BNKCRD-CHG-TOT-PCT (TSUB2) *                          
320900                                 TBL2-KOHLS-TAX-AMT (TSUB2).              
321000                                                                          
321100     COMPUTE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) =                            
321200            TBL2-BNKCRD-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.              
321300                                                                          
321400***                                                                       
321500* AMEX CHARGE - PERCENT                                                   
321600***                                                                       
321700     MOVE ZEROES TO PV-CALC-TOTAL.                                        
321800                                                                          
321900     COMPUTE PV-CALC-TOTAL =                                              
322000         TBL2-AMEX-CHG-TOT-PCT (TSUB2) *                                  
322100                               TBL2-KOHLS-TAX-AMT (TSUB2).                
322200                                                                          
322300     COMPUTE TBL2-AMEX-CHG-TOT-AMT (TSUB2) =                              
322400            TBL2-AMEX-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                
322500                                                                          
322600***                                                                       
322700* DSCVR CHARGE - PERCENT                                                  
322800***                                                                       
322900     MOVE ZEROES TO PV-CALC-TOTAL.                                        
323000                                                                          
323100     COMPUTE PV-CALC-TOTAL =                                              
323200         TBL2-DSCVR-CHG-TOT-PCT (TSUB2) *                                 
323300                               TBL2-KOHLS-TAX-AMT (TSUB2).                
323400                                                                          
323500     COMPUTE TBL2-DSCVR-CHG-TOT-AMT (TSUB2) =                             
323600          TBL2-DSCVR-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                 
323700                                                                          
PAYVEN***                                                                       
PAYVEN* PAYPAL CHARGE - PERCENT                                                 
PAYVEN***                                                                       
PAYVEN     MOVE ZEROES TO PV-CALC-TOTAL.                                        
PAYVEN                                                                          
PAYVEN     COMPUTE PV-CALC-TOTAL =                                              
PAYVEN         TBL2-PAYPAL-CHG-TOT-PCT (TSUB2) *                                
PAYVEN                               TBL2-KOHLS-TAX-AMT (TSUB2).                
PAYVEN                                                                          
PAYVEN     COMPUTE TBL2-PAYPAL-CHG-TOT-AMT (TSUB2) =                            
PAYVEN          TBL2-PAYPAL-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                
PAYVEN                                                                          
PAYVEN***                                                                       
PAYVEN* VENMO CHARGE - PERCENT                                                  
PAYVEN***                                                                       
PAYVEN     MOVE ZEROES TO PV-CALC-TOTAL.                                        
PAYVEN                                                                          
PAYVEN     COMPUTE PV-CALC-TOTAL =                                              
PAYVEN         TBL2-VENMO-CHG-TOT-PCT (TSUB2) *                                 
PAYVEN                               TBL2-KOHLS-TAX-AMT (TSUB2).                
PAYVEN                                                                          
PAYVEN     COMPUTE TBL2-VENMO-CHG-TOT-AMT (TSUB2) =                             
PAYVEN          TBL2-VENMO-CHG-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                 
PAYVEN                                                                          
323800***                                                                       
323900* DEBIT CARD - PERCENT                                                    
324000***                                                                       
324100     MOVE ZEROES TO PV-CALC-TOTAL.                                        
324200                                                                          
324300     COMPUTE PV-CALC-TOTAL =                                              
324400         TBL2-DEBIT-CARD-TOT-PCT (TSUB2) *                                
324500                               TBL2-KOHLS-TAX-AMT (TSUB2).                
324600                                                                          
324700     COMPUTE TBL2-DEBIT-CARD-TOT-AMT (TSUB2) =                            
324800          TBL2-DEBIT-CARD-TOT-AMT (TSUB2) - PV-CALC-TOTAL.                
324900                                                                          
SEPHOR***                                                                       
SEPHOR* SEPHORA GIFT CARDS TENDERED - PERCENT                                   
SEPHOR***                                                                       
SEPHOR     MOVE ZEROES TO PV-CALC-TOTAL.                                        
SEPHOR                                                                          
SEPHOR     COMPUTE PV-CALC-TOTAL =                                              
SEPHOR         TBL2-SEPHORA-SGT-TOT-PCT (TSUB2) *                               
SEPHOR                               TBL2-KOHLS-TAX-AMT (TSUB2).                
SEPHOR                                                                          
SEPHOR     COMPUTE TBL2-SEPHORA-SGT-TOT-AMT (TSUB2) =                           
SEPHOR          TBL2-SEPHORA-SGT-TOT-AMT (TSUB2) - PV-CALC-TOTAL.               
SEPHOR                                                                          
325000 3600-EXIT.                                                               
325100     EXIT.                                                                
325200                                                                          
448400                                                                          
082108******************************************************************        
082108 5000-BUILD-CSV-OUTPUT.                                                   
082108                                                                          
082108     MOVE CR-CSV-COLUMN-HDGS-1          TO PV-CSV-RECORD.                 
082108     PERFORM 8400-WRITE-CSV-RECORD      THRU 8400-EXIT.                   
082108     MOVE CR-CSV-COLUMN-HDGS-2          TO PV-CSV-RECORD.                 
082108     PERFORM 8400-WRITE-CSV-RECORD      THRU 8400-EXIT.                   
082108                                                                          
082108     INITIALIZE CR-CSV-RECORD.                                            
082108                                                                          
082108     PERFORM 5100-PRINT-CSV-DETAIL THRU 5100-EXIT                         
082108       VARYING TSUB2 FROM 1 BY 1                                          
082108         UNTIL TSUB2 > TOT-BYSTORE-ON-TBL2                                
082108          OR TSUB2 > MAX-TSUB2.                                           
082108                                                                          
082108     IF TSUB2 > MAX-TSUB2                                                 
082108         MOVE '5000-BUILD-CSV-OUTPUT'                                     
082108                                   TO PV-PARAGRAPH-NAME                   
082108         MOVE 'BYSTORE TABLE (TBL2) MAX-VALUE TOO SMALL'                  
082108                                   TO PV-OPERATION-MSG-1                  
082108         MOVE '- EXPAND AND RESUBMIT'                                     
082108                                   TO PV-OPERATION-MSG-2                  
082108         SET AC-BYSTORE-TABLE-ERROR TO TRUE                               
082108         PERFORM 9999-ABEND                                               
082108     END-IF.                                                              
082108                                                                          
082108 5000-EXIT.                                                               
082108     EXIT.                                                                
082108                                                                          
082108******************************************************************        
082108 5100-PRINT-CSV-DETAIL.                                                   
082108                                                                          
082108     MOVE TBL2-STR-NBR (TSUB2)        TO CR-STR-NBR.                      
082108***                                                                       
082108* CASH - ACCUM TOTAL AMOUNT AND MOVE PERCENT OF TOTAL NET SALES           
082108***                                                                       
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                             TBL2-CASH-TOT-AMT (TSUB2).                   
082108                                                                          
082108     MOVE TBL2-CASH-TOT-AMT (TSUB2)   TO CR-CASH-AMT.                     
082108                                                                          
082108     COMPUTE PV-CALC-PCT =  TBL2-CASH-TOT-PCT (TSUB2) * 100.              
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-CASH-PCT.                     
082108                                                                          
082108***                                                                       
082108* CHECKS - ACCUM TOTAL AMOUNT AND MOVE PERCENT OF TOTAL NET SALES         
082108***                                                                       
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                             TBL2-CHECK-TOT-AMT (TSUB2).                  
082108                                                                          
082108     MOVE TBL2-CHECK-TOT-AMT (TSUB2)  TO CR-CHECK-AMT.                    
082108                                                                          
082108     COMPUTE PV-CALC-PCT =  TBL2-CHECK-TOT-PCT (TSUB2) * 100.             
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-CHECK-PCT.                    
082108                                                                          
082108***                                                                       
082108* GIFTCARD/GIFTCERT/KMRC - ACCUM TOTAL AMOUNT, AND PERCENT OF             
082108**               TOTAL NET SALES                                          
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                       TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2).               
082108                                                                          
082108     MOVE TBL2-GCRD-GCRT-KMRC-TOT-AMT (TSUB2)                             
082108                                      TO CR-GCRD-GCRT-KMRC-AMT.           
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                 TBL2-GCRD-GCRT-KMRC-TOT-PCT (TSUB2) * 100.               
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-GCRD-GCRT-KMRC-PCT.           
082108                                                                          
082108***                                                                       
082108* KOHL'S CHARGE - ACCUM TOTAL AMOUNT AND PERCENT OF                       
082108***               TOTAL NET SALES                                         
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                          TBL2-KOHLS-CHG-TOT-AMT (TSUB2).                 
082108                                                                          
082108     MOVE TBL2-KOHLS-CHG-TOT-AMT (TSUB2)                                  
082108                                      TO CR-KOHLS-CHG-AMT.                
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                     TBL2-KOHLS-CHG-TOT-PCT (TSUB2) * 100.                
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-KOHLS-CHG-PCT.                
082108                                                                          
COBRND***                                                                       
COBRND* COBRAND CHARGE - ACCUM TOTAL AMOUNT AND PERCENT OF                      
COBRND***                TOTAL NET SALES                                        
COBRND                                                                          
COBRND     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
COBRND          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
COBRND                          TBL2-COBRAND-CHG-TOT-AMT (TSUB2).               
COBRND                                                                          
COBRND     MOVE TBL2-COBRAND-CHG-TOT-AMT (TSUB2)                                
COBRND                                      TO CR-COBRAND-CHG-AMT.              
COBRND                                                                          
COBRND     COMPUTE PV-CALC-PCT =                                                
COBRND                     TBL2-COBRAND-CHG-TOT-PCT (TSUB2) * 100.              
COBRND                                                                          
COBRND     MOVE PV-CALC-PCT                 TO CR-COBRAND-CHG-PCT.              
COBRND                                                                          
082108***                                                                       
082108* BANKCARD CHARGE - ACCUM TOTAL AMOUNT AND PERCENT OF                     
082108***                TOTAL NET SALES                                        
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                          TBL2-BNKCRD-CHG-TOT-AMT (TSUB2).                
082108                                                                          
082108     MOVE TBL2-BNKCRD-CHG-TOT-AMT (TSUB2)                                 
082108                                      TO CR-BNKCRD-CHG-AMT.               
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                     TBL2-BNKCRD-CHG-TOT-PCT (TSUB2) * 100.               
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-BNKCRD-CHG-PCT.               
082108                                                                          
082108***                                                                       
082108* AMERICAN EXPRESS CHARGE - ACCUM TOTAL AMOUNT AND PERCENT                
082108***                         OF TOTAL NET SALES                            
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                          TBL2-AMEX-CHG-TOT-AMT (TSUB2).                  
082108                                                                          
082108     MOVE TBL2-AMEX-CHG-TOT-AMT (TSUB2)                                   
082108                                      TO CR-AMEX-CHG-AMT.                 
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                     TBL2-AMEX-CHG-TOT-PCT (TSUB2) * 100.                 
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-AMEX-CHG-PCT.                 
082108                                                                          
082108***                                                                       
082108* DISCOVER CHARGE  - ACCUM TOTAL AMOUNT AND PERCENT OF                    
082108***                  TOTAL NET SALES                                      
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                          TBL2-DSCVR-CHG-TOT-AMT (TSUB2).                 
082108                                                                          
082108     MOVE TBL2-DSCVR-CHG-TOT-AMT (TSUB2)                                  
082108                                      TO CR-DSCVR-CHG-AMT.                
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                     TBL2-DSCVR-CHG-TOT-PCT (TSUB2) * 100.                
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-DSCVR-CHG-PCT.                
082108                                                                          
PAYVEN***                                                                       
PAYVEN* PAYPAL CHARGE  - ACCUM TOTAL AMOUNT AND PERCENT OF                      
PAYVEN***                TOTAL NET SALES                                        
PAYVEN                                                                          
PAYVEN     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
PAYVEN          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
PAYVEN                          TBL2-PAYPAL-CHG-TOT-AMT (TSUB2).                
PAYVEN                                                                          
PAYVEN     MOVE TBL2-PAYPAL-CHG-TOT-AMT (TSUB2)                                 
PAYVEN                                      TO CR-PAYPAL-CHG-AMT.               
PAYVEN                                                                          
PAYVEN     COMPUTE PV-CALC-PCT =                                                
PAYVEN                     TBL2-PAYPAL-CHG-TOT-PCT (TSUB2) * 100.               
PAYVEN                                                                          
PAYVEN     MOVE PV-CALC-PCT                 TO CR-PAYPAL-CHG-PCT.               
PAYVEN                                                                          
PAYVEN***                                                                       
PAYVEN* VENMO CHARGE  - ACCUM TOTAL AMOUNT AND PERCENT OF                       
PAYVEN***               TOTAL NET SALES                                         
PAYVEN                                                                          
PAYVEN     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
PAYVEN          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
PAYVEN                          TBL2-VENMO-CHG-TOT-AMT (TSUB2).                 
PAYVEN                                                                          
PAYVEN     MOVE TBL2-VENMO-CHG-TOT-AMT (TSUB2)                                  
PAYVEN                                      TO CR-VENMO-CHG-AMT.                
PAYVEN                                                                          
PAYVEN     COMPUTE PV-CALC-PCT =                                                
PAYVEN                     TBL2-VENMO-CHG-TOT-PCT (TSUB2) * 100.                
PAYVEN                                                                          
PAYVEN     MOVE PV-CALC-PCT                 TO CR-VENMO-CHG-PCT.                
PAYVEN                                                                          
082108***                                                                       
082108* DEBIT CARD       - ACCUM TOTAL AMOUNT AND PERCENT OF                    
082108***                  TOTAL NET SALES                                      
082108                                                                          
082108     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
082108          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
082108                          TBL2-DEBIT-CARD-TOT-AMT (TSUB2).                
082108                                                                          
082108     MOVE TBL2-DEBIT-CARD-TOT-AMT (TSUB2)                                 
082108                                      TO CR-DEBIT-CARD-AMT.               
082108                                                                          
082108     COMPUTE PV-CALC-PCT =                                                
082108                    TBL2-DEBIT-CARD-TOT-PCT (TSUB2) * 100.                
082108                                                                          
082108     MOVE PV-CALC-PCT                 TO CR-DEBIT-CARD-PCT.               
082108                                                                          
SEPHOR***                                                                       
SEPHOR* SEPHORA GIFT CARD TENDERS - ACCUM TOTAL AMOUNT AND PERCENT OF           
SEPHOR***                 TOTAL NET SALES                                       
SEPH03                                                                          
SEPH03**   ADDED THE SEPHORA GC TENDERS BACK INTO NET TOTAL SALES.              
SEPH03     COMPUTE TBL2-CSV-NET-TOT-AMT (TSUB2) =                               
SEPH03          TBL2-CSV-NET-TOT-AMT (TSUB2) +                                  
SEPH03                          TBL2-SEPHORA-SGT-TOT-AMT (TSUB2).               
SEPHOR                                                                          
SEPHOR     MOVE TBL2-SEPHORA-SGT-TOT-AMT (TSUB2)                                
SEPHOR                                      TO CR-SEPHORA-SGT-AMT.              
SEPHOR                                                                          
SEPHOR     COMPUTE PV-CALC-PCT =                                                
SEPHOR                     TBL2-SEPHORA-SGT-TOT-PCT (TSUB2) * 100.              
SEPHOR                                                                          
SEPHOR     MOVE PV-CALC-PCT                 TO CR-SEPHORA-SGT-PCT.              
SEPHOR                                                                          
082108***                                                                       
082108* KOHLS NET TOTAL AMOUNT                                                  
082108***                                                                       
082108     MOVE TBL2-CSV-NET-TOT-AMT (TSUB2)                                    
082108                                      TO CR-NET-SALES-TOT-AMT.            
082108                                                                          
082108***                                                                       
082108* KOHLS GIFT CARD/CERTIFICATE                                             
082108***                                                                       
082108                                                                          
082108     MOVE TBL2-KOHLS-GFT-CRD-CERT-AMT (TSUB2)                             
082108                                      TO CR-GFTCRD-CRT-TOT-AMT.           
082108                                                                          
SEPHOR***                                                                       
SEPHOR* SEPHORA GIFT CARD SALES                                                 
SEPHOR***                                                                       
SEPHOR                                                                          
SEPHOR     MOVE TBL2-SEPHORA-SGS-TOT-AMT (TSUB2)                                
SEPHOR                                      TO CR-SEPHORA-SGS-AMT.              
SEPHOR                                                                          
082108***                                                                       
082108* KOHLS EMPLOYEE DISCOUNT                                                 
082108***                                                                       
082108                                                                          
082108     MOVE TBL2-KOHLS-EMPL-DISC-AMT (TSUB2)                                
082108                                      TO CR-EMPL-DISC-TOT-AMT.            
082108                                                                          
082108***                                                                       
082108* KOHL'S STORE TOTAL - CALCULATE TOTAL AMOUNT, THEN AVERAGE               
082108*                      FIRST SUBTRACT THE GIFTCARD/CERT SOLD,             
SEPH02*                      SEPHORA GC'S SOLD,                                 
082108*                      AND EMPLOYEE DISCOUNTS FROM THE NET TOTAL          
082108*                      AMOUNT, BEFORE DIVIDING BY 1000.                   
082108***                                                                       
082108                                                                          
082108     COMPUTE TBL2-CSV-TOT-SAL-AMT (TSUB2) =                               
082108             TBL2-CSV-NET-TOT-AMT (TSUB2)                                 
082108           - TBL2-KOHLS-GFT-CRD-CERT-AMT (TSUB2)                          
SEPH03           - TBL2-SEPHORA-SGS-TOT-AMT (TSUB2)                             
082108           - TBL2-KOHLS-EMPL-DISC-AMT (TSUB2).                            
082108                                                                          
082108     MOVE TBL2-CSV-TOT-SAL-AMT (TSUB2)                                    
082108                                      TO CR-KOHLS-TOT-SLS-AMT.            
082108                                                                          
082108***                                                                       
082108* NON-MERCHANDISE SALES                                                   
082108***                                                                       
082108                                                                          
082108     MOVE TBL2-NON-MERCH-SLS-AMT (TSUB2)                                  
082108                                      TO CR-NON-MERCH-SLS-AMT.            
082108                                                                          
082108***                                                                       
082108* PRINT THE DETAIL LINE                                                   
082108***                                                                       
082108                                                                          
082108     MOVE CR-CSV-RECORD             TO PV-CSV-RECORD.                     
082108     PERFORM 8400-WRITE-CSV-RECORD  THRU 8400-EXIT.                       
082108                                                                          
082108 5100-EXIT.                                                               
082108     EXIT.                                                                
082108                                                                          
448500******************************************************************        
448600 7000-OPEN-CURSOR.                                                        
448700                                                                          
448800     EXEC SQL                                                             
448900          OPEN REPORT-CURSOR                                              
449000     END-EXEC.                                                            
449100                                                                          
449200     EVALUATE TRUE                                                        
449300         WHEN SQLCODE = ZEROES                                            
449400              CONTINUE                                                    
449500         WHEN SQLWARN0 NOT EQUAL SPACES                                   
449600         WHEN SQLCODE NOT EQUAL ZEROES                                    
449700             MOVE '7000-OPEN-CURSOR'                                      
449800                                            TO PV-PARAGRAPH-NAME          
449900             MOVE 'ERROR ON OPEN OF REPORT-CURSOR'                        
450000                                            TO PV-DB2-OPERATION           
450100             PERFORM 9998-SQL-ABEND                                       
450200     END-EVALUATE.                                                        
450300                                                                          
450400 7000-EXIT.                                                               
450500     EXIT.                                                                
450600                                                                          
450700******************************************************************        
450800 7100-FETCH-CURSOR.                                                       
450900                                                                          
451000     EXEC SQL                                                             
451100          FETCH REPORT-CURSOR                                             
451200          INTO :PV-SLS-DTE                                                
451400             , :PV-STR-NBR                                                
451500             , :PV-SUM-CTG-CDE                                            
451600             , :PV-CTG-AMT                                                
451700     END-EXEC.                                                            
451800                                                                          
451900     EVALUATE TRUE                                                        
452000         WHEN SQLCODE = ZEROES                                            
452100             CONTINUE                                                     
452200         WHEN SQLCODE = +100                                              
452300           MOVE 'Y' TO PS-END-OF-CSR-SW                                   
452400         WHEN SQLWARN0 NOT EQUAL SPACES                                   
452500         WHEN SQLCODE NOT EQUAL ZEROES                                    
452600             MOVE '7100-FETCH-CURSOR'                                     
452700                                            TO PV-PARAGRAPH-NAME          
452800             MOVE 'ERROR ON FETCH OF CURSOR'                              
452900                                            TO PV-DB2-OPERATION           
453000             PERFORM 9998-SQL-ABEND                                       
453100     END-EVALUATE.                                                        
453200                                                                          
453300 7100-EXIT.                                                               
453400     EXIT.                                                                
453500                                                                          
453600******************************************************************        
453700 7200-CLOSE-CURSOR.                                                       
453800                                                                          
453900     EXEC SQL                                                             
454000          CLOSE REPORT-CURSOR                                             
454100     END-EXEC.                                                            
454200                                                                          
454300     EVALUATE TRUE                                                        
454400         WHEN SQLCODE = ZEROES                                            
454500              CONTINUE                                                    
454600         WHEN SQLWARN0 NOT EQUAL SPACES                                   
454700         WHEN SQLCODE NOT EQUAL ZEROES                                    
454800             MOVE '7200-CLOSE-CURSOR'                                     
454900                                            TO PV-PARAGRAPH-NAME          
455000             MOVE 'ERROR ON CLOSE OF CURSOR'                              
455100                                            TO PV-DB2-OPERATION           
455200             PERFORM 9998-SQL-ABEND                                       
455300     END-EVALUATE.                                                        
455400                                                                          
455500 7200-EXIT.                                                               
455600     EXIT.                                                                
455700                                                                          
463900                                                                          
082108******************************************************************        
082108*     WRITE CSV HEADINGS OR DETAIL FOR CSV FILE                           
082108******************************************************************        
082108 8400-WRITE-CSV-RECORD.                                                   
082108                                                                          
082108     WRITE BYSTORE-CSV-OUTPUT-RECORD                                      
082108       FROM PV-CSV-RECORD.                                                
082108                                                                          
082108 8400-EXIT.                                                               
082108     EXIT.                                                                
082108                                                                          
474900                                                                          
475000******************************************************************        
475100*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.        
475200******************************************************************        
475300 9998-SQL-ABEND.                                                          
475400                                                                          
475500     DISPLAY ' '.                                                         
475600     DISPLAY '** ABEND     **'.                                           
475700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.                
475800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
475900     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.                       
476000                                                                          
476100******************************************************************        
476200* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED             
476300* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.              
476400******************************************************************        
476500     COPY DPPD004.                                                        
476600                                                                          
476700                                                                          
476800     SET AC-DB2-ERROR TO TRUE.                                            
476900     CALL 'ILBOABN0' USING AC-ABEND-CODE.                                 
477000                                                                          
477100******************************************************************        
477200* 9999-ABEND                                                              
477300*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                          
477400******************************************************************        
477500 9999-ABEND.                                                              
477600                                                                          
477700     DISPLAY ' '.                                                         
477800     DISPLAY '** ABEND           **'.                                     
477900     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.          
478000     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
478100     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.               
478200     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.               
478300     CALL 'ILBOABN0' USING AC-ABEND-CODE.                                 
