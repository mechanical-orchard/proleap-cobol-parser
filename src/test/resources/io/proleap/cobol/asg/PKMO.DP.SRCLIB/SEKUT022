000100*------------------------*                                        00020001
000200 IDENTIFICATION DIVISION.                                         00030001
000300*------------------------*                                        00040001
000400 PROGRAM-ID.     SEKUT022.                                        00050001
000500 AUTHOR.         BARB SCHULTZ.                                    00060001
000600 DATE-WRITTEN.   02/27/13.                                        00070001
000700*---------------------------------------------------------------* 00080001
000800*                UPS PROGRAM                                    * 00090001
000900*---------------------------------------------------------------* 00100001
001300*    PROGRAM OVERVIEW:                                          * 00110001
001400*    THIS PROGRAM READS IN THE FIXED FORMATTED UPS FILE AND     * 00120001
001500*    CREATE THE UPS FILE THAT WILL BE FTP'D TO UPS.             * 00130001
001900*---------------------------------------------------------------* 00140001
002000*                                                               * 00150001
002100* INPUT:                                                        * 00160001
002200*   1. UPS INPUT FILE - SERD010                                 * 00170001
002600*                                                               * 00180001
002700* OUTPUT:                                                       * 00190001
002800*                                                               * 00200001
002900*   1. UPS OUTPUT FILE - SERD011                                * 00210001
003300*                                                               * 00220001
003400*---------------------------------------------------------------* 00230001
003500* CHANGE LOG:                                                   * 00240001
003600*   DATE  01/31/2012                                            * 00250001
003700*       CHANGE MADE: INITIAL VERSION.                           * 00260001
003800*       MADE BY: BARB SCHULTZ            WR/IR #: 3559          * 00270001
003600*   DATE  05/15/2020                                            * 00271001
003700*       CHANGE MADE: RENAME FROM GLKUT097 TO SEKUT022           * 00272001
003800*       MADE BY: JEAN KURK                                      * 00273001
003900*                                                               * 00280001
004000*---------------------------------------------------------------* 00290001
004100                                                                  00300001
004200*---------------------*                                           00310001
004300 ENVIRONMENT DIVISION.                                            00320001
004400*---------------------*                                           00330001
004500 CONFIGURATION SECTION.                                           00340001
004600 SOURCE-COMPUTER.    IBM-3090.                                    00350001
004700 OBJECT-COMPUTER.    IBM-3090.                                    00360001
004800                                                                  00370001
004900 INPUT-OUTPUT SECTION.                                            00380001
005000 FILE-CONTROL.                                                    00390001
005100                                                                  00400001
005200     SELECT UPS-INPUT-FILE         ASSIGN TO INP01.               00410001
005300     SELECT UPS-OUTPUT-FILE        ASSIGN TO OUT01.               00420001
005600                                                                  00430001
005700*--------------*                                                  00440001
005800 DATA DIVISION.                                                   00450001
005900*--------------*                                                  00460001
006000 FILE SECTION.                                                    00470001
006100                                                                  00480001
306800                                                                  00490001
006900 FD  UPS-INPUT-FILE                                               00500001
007000     RECORDING MODE IS F                                          00510001
007100     LABEL RECORDS ARE OMITTED                                    00520001
007200     BLOCK CONTAINS 0 RECORDS.                                    00530001
007400 01  UPS-INPUT-REC             PIC  X(885).                       00540001
306800                                                                  00550001
006900 FD  UPS-OUTPUT-FILE                                              00560001
007000     RECORDING MODE IS F                                          00570001
007100     LABEL RECORDS ARE OMITTED                                    00580001
007200     BLOCK CONTAINS 0 RECORDS.                                    00590001
007400 01  UPS-OUTPUT-REC            PIC  X(885).                       00600001
007500                                                                  00610001
009000 EJECT                                                            00620001
009100                                                                  00630001
009200 WORKING-STORAGE SECTION.                                         00640001
009300                                                                  00650001
010100                                                                  00660001
010200 01  PROGRAM-CONSTANTS.                                           00670001
010300     05  PC-PROGRAM-NAME           PIC X(08)   VALUE 'SEKUT022'.  00680001
010400                                                                  00690001
010900 01  PS-PROGRAM-SWITCHES.                                         00700001
011000     05  PS-INPUT-EOF-SWT          PIC X(01)   VALUE 'N'.         00710001
011100         88  PS-INPUT-EOF                      VALUE 'Y'.         00720001
021900 01  PROGRAM-VARIABLES.                                           00730001
023300     05  PV-WS-CTR                PIC  9(04)   VALUE ZEROS.       00740001
023300     05  PV-TOTAL-NO-FIELDS       PIC  9(04)   VALUE ZEROS.       00750001
063500     05  PV-WRT-COUNT             PIC  9(09)   VALUE ZEROES.      00760001
063500     05  PV-TOTAL-NO-FIELDS-1     PIC  9(05)   VALUE ZEROES.      00770001
050400     05  PV-HOLD-RECORD           PIC  X(885)  VALUE SPACES.      00780001
010400                                                                  00790001
010400                                                                  00800001
039600*----------------------------------------------------------------*00810001
039700*    ABEND DATA AREAS                                             00820001
039800*----------------------------------------------------------------*00830001
039900 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      00840001
040000                                   COMP         SYNC.             00850001
040100                                                                  00860001
040200     88  AC-ANY-ERROR                           VALUE  +4001      00870001
040300                                                THRU   +4019.     00880001
040400     88  AC-BAD-WRITE                           VALUE  +4001.     00890001
040500     88  AC-BAD-READ                            VALUE  +4002.     00900001
040600     88  AC-CONTROL-CARD-ERROR                  VALUE  +4003.     00910001
040700     88  AC-OPEN-ERROR                          VALUE  +4005.     00920001
040800     88  AC-CLOSE-ERROR                         VALUE  +4006.     00930001
040900     88  AC-BAD-DATA                            VALUE  +4008.     00940001
041000     88  AC-DB2-ERROR                           VALUE  +4013.     00950001
041100     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     00960001
041200     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     00970001
041300     88  AC-DATE-ERROR                          VALUE  +4019.     00980001
041500                                                                  00990001
041600 01  ABEND-AREAS.                                                 01000001
041700     05  AA-ABEND-LIT              PIC  X(40)   VALUE             01010001
041800             '*****       ABEND'.                                 01020001
041900     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             01030001
042000             '*****   PROGRAM: SEKUT022'.                         01040001
042100     05  AA-PARAGRAPH-LIT.                                        01050001
042200         10  FILLER                PIC  X(17)   VALUE             01060001
042300             '***** PARAGRAPH: '.                                 01070001
042400         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     01080001
042500     05  AA-MESSAGE-LINE-1.                                       01090001
042600         10  FILLER                PIC  X(06)   VALUE '*****'.    01100001
042700         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     01110001
042800     05  AA-MESSAGE-LINE-2.                                       01120001
042900         10  FILLER                PIC  X(06)   VALUE '*****'.    01130001
043000         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     01140001
043100     05  AA-DB2-ERROR-LIT          PIC  X(40)   VALUE             01150001
043200             '*****    DB2 ERROR'.                                01160001
043300     05  AA-DB2-OPERATION-LIT.                                    01170001
043400         10  FILLER                PIC  X(17)   VALUE             01180001
043500             '***** OPERATION: '.                                 01190001
043600         10  AA-DB2-OPERATION.                                    01200001
043700             15  AA-DB2-OP-1       PIC  X(25)   VALUE SPACES.     01210001
043800             15  AA-DB2-OP-2       PIC  X(25)   VALUE SPACES.     01220001
043900     05  AA-DB2-TABLE-1            PIC  X(08)   VALUE SPACES.     01230001
044000     05  AA-DB2-TABLE-2            PIC  X(08)   VALUE SPACES.     01240001
044100     05  AA-DB2-TABLE-3            PIC  X(08)   VALUE SPACES.     01250001
010800                                                                  01260001
010800******************************************************************01270001
010800* UPS INPUT FILE                                                 *01280001
010800******************************************************************01290001
010800     COPY SERD010.                                                01300001
026100                                                                  01310001
010800******************************************************************01320001
010800*  UPS OUTPUT FILE                                               *01330001
010800******************************************************************01340001
010800     COPY SERD011.                                                01350001
026100                                                                  01360001
045100***************************************************************** 01370001
045200 PROCEDURE DIVISION.                                              01380001
045300***************************************************************** 01390001
045400 0000-PROGRAM-MAINLINE.                                           01400001
045500                                                                  01410001
045600     PERFORM 1000-INITIALIZE.                                     01420001
045700                                                                  01430001
045800     PERFORM 2000-PROCESS-INPUT                                   01440001
045900         UNTIL PS-INPUT-EOF.                                      01450001
046100                                                                  01460001
046000     PERFORM 4000-END-OF-PROGRAM.                                 01470001
046100                                                                  01480001
046200     GOBACK.                                                      01490001
046400                                                                  01500001
046500*----------------------------------------------------------------*01510001
046600*    INITIALIZATION PROCESSING                                   *01520001
046700*    - OPEN FILE.                                                *01530001
046900*----------------------------------------------------------------*01540001
047000 1000-INITIALIZE.                                                 01550001
047100                                                                  01560001
047200     DISPLAY '***-----  SEKUT022  (PROCESSING MSGS)  -----***'.   01570001
047300     DISPLAY ' '.                                                 01580001
047400                                                                  01590001
047500     OPEN INPUT UPS-INPUT-FILE                                    01600001
047600          OUTPUT UPS-OUTPUT-FILE.                                 01610001
047900                                                                  01620001
050300     PERFORM 2500-READ-INPUT.                                     01630001
047900                                                                  01640001
053600*----------------------------------------------------------------*01650001
053700*    PROCESS INPUT                                               *01660001
053700*    CHECK IF PERSON ON THE ITIM FILE IS IN THE TABLE OF         '01670001
053700*       LOCATIONS OR SPECIAL LOCATIONS                           *01680001
053800*----------------------------------------------------------------*01690001
045800 2000-PROCESS-INPUT.                                              01700001
054000     PERFORM 2100-MOVE-FIELDS.                                    01710001
054000     PERFORM 2900-WRITE-OUTPUT-RECORD.                            01720001
054000                                                                  01730001
054000     INITIALIZE SE011-DETAIL.                                     01740001
001600     MOVE SPACES TO PV-HOLD-RECORD.                               01750001
054000                                                                  01760001
050300     PERFORM 2500-READ-INPUT.                                     01770001
054000                                                                  01780001
054000****************************************************************  01790001
045800*  MOVE THE FIELDS FROM THE ITIM FILE TO THE UPS FILE             01800001
054000****************************************************************  01810001
054000 2100-MOVE-FIELDS.                                                01820001
050400*    MOVE SPACES TO PV-HOLD-RECORD.                               01830001
050400     STRING                                                       01840001
050400        SE010-USERID DELIMITED BY '  '                            01850001
050400            ','         DELIMITED BY  SIZE                        01860001
050400        SE010-CAMPUS DELIMITED BY '  '                            01870001
050400            ','         DELIMITED BY SIZE                         01880001
050400        SE010-DEFAULT-CAMPUS DELIMITED BY '  '                    01890001
050400            ','         DELIMITED BY SIZE                         01900001
001600        SE010-FNAME     DELIMITED BY '  '                         01910001
050400            ','         DELIMITED BY SIZE                         01920001
001600        SE010-LNAME     DELIMITED BY '  '                         01930001
050400            ','         DELIMITED BY SIZE                         01940001
001600        SE010-PASSWORD  DELIMITED BY '  '                         01950001
050400            ','         DELIMITED BY SIZE                         01960001
001600        SE010-ADDR1     DELIMITED BY '  '                         01970001
050400            ','         DELIMITED BY SIZE                         01980001
001600*   SE010-ADDR2                                                   01990001
050400            ','         DELIMITED BY SIZE                         02000001
001600*   SE010-ADDR3                                                   02010001
050400            ','         DELIMITED BY SIZE                         02020001
001600        SE010-CITY      DELIMITED BY '  '                         02030001
050400            ','         DELIMITED BY SIZE                         02040001
001600        SE010-STATE     DELIMITED BY '  '                         02050001
050400            ','         DELIMITED BY SIZE                         02060001
001600        SE010-POSTAL-CODE DELIMITED BY '  '                       02070001
050400            ','         DELIMITED BY SIZE                         02080001
001600        SE010-COUNTRY-CODE DELIMITED BY '  '                      02090001
050400            ','         DELIMITED BY SIZE                         02100001
001600        SE010-EMAIL     DELIMITED BY '  '                         02110001
050400            ','         DELIMITED BY SIZE                         02120001
001600        SE010-PHONE     DELIMITED BY '  '                         02130001
050400            ','         DELIMITED BY SIZE                         02140001
001600        SE010-IDLEVEL   DELIMITED BY ' '                          02150001
050400            ','         DELIMITED BY SIZE                         02160001
001600* SE010-GL-ACCOUNT                                                02170001
050400            ','         DELIMITED BY SIZE                         02180001
001600* SE010-DEPARTMENT                                                02190001
050400            ','         DELIMITED BY SIZE                         02200001
001600* SE010-CUSTOM-3                                                  02210001
050400            ','         DELIMITED BY SIZE                         02220001
001600* SE010-CUSTOM-4                                                  02230001
050400            ','         DELIMITED BY SIZE                         02240001
001600* SE010-CUSTOM-5                                                  02250001
050400            ','         DELIMITED BY SIZE                         02260001
001600* SE010-CUSTOM-6                                                  02270001
050400            ','         DELIMITED BY SIZE                         02280001
001600* SE010-CUSTOM-7                                                  02290001
050400            ','         DELIMITED BY SIZE                         02300001
001600* SE010-CUSTOM-8                                                  02310001
050400            ','         DELIMITED BY SIZE                         02320001
001600* SE010-CUSTOM-9                                                  02330001
050400            ','         DELIMITED BY SIZE                         02340001
001600* SE010-CUSTOM-10                                                 02350001
050400            ','         DELIMITED BY SIZE                         02360001
001600         INTO PV-HOLD-RECORD.                                     02370001
001600     MOVE PV-HOLD-RECORD TO SE011-DETAIL.                         02380001
010400                                                                  02390001
060000****************************************************************  02400001
060000*     READ THE INPUT FILE                                         02410001
060000****************************************************************  02420001
060000 2500-READ-INPUT.                                                 02430001
060000     READ UPS-INPUT-FILE INTO SE010-UPS-DETAIL                    02440001
060000         AT END                                                   02450001
060000             SET PS-INPUT-EOF TO TRUE.                            02460001
060000                                                                  02470001
062000******************************************************************02480001
062100*    WRITE DETAIL OUTPUT RECORD                                  *02490001
062200******************************************************************02500001
062300 2900-WRITE-OUTPUT-RECORD.                                        02510001
062400                                                                  02520001
062500     WRITE UPS-OUTPUT-REC FROM SE011-DETAIL.                      02530001
063200                                                                  02540001
063500     ADD 1 TO PV-WRT-COUNT.                                       02550001
063200                                                                  02560001
063200****************************************************************  02570001
052000*    END OF PROGRAM                                              *02580001
052100*    - CLOSE THE FILES                                           *02590001
063200****************************************************************  02600001
052300 4000-END-OF-PROGRAM.                                             02610001
052400                                                                  02620001
052500     DISPLAY '****-----------------------------------------****'. 02630001
052600     DISPLAY '**----     END OF SEKUT022 PROCESSING!     ----**'. 02640001
052700     DISPLAY '****-----------------------------------------****'. 02650001
052800     DISPLAY ' '.                                                 02660001
052900                                                                  02670001
047500     CLOSE UPS-INPUT-FILE                                         02680001
047600           UPS-OUTPUT-FILE.                                       02690001
