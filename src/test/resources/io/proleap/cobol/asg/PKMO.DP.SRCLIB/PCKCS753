000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    PCKCS753.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER                                   00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  DECEMBER, 2001.                                   00070001
000800 DATE-COMPILED.                                                   00080001
000900*----------------------------------------------------------------*00090001
001000*    S753 - PC - UNITS WORKED - CURRENT YEAR VS. PREVIOUS YEAR   *00100001
001100*----------------------------------------------------------------*00110001
1122RM* DATE  11/07/2022                                              *         
1122RM*            - ADD COPYBOOK DPWS930                             *         
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            *         
1122RM*              DYNAMIC.                                         *         
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      *         
1122RM*-----------------------------------------------------------------        
001200 ENVIRONMENT DIVISION.                                            00120001
001300 DATA DIVISION.                                                   00130001
001400                                                                  00140001
001500 WORKING-STORAGE SECTION.                                         00150001
001600*----------------------------------------------------------------*00160001
001700*   PROGRAM CONSTANTS                                            *00170001
001800*----------------------------------------------------------------*00180001
001900 01  PC-PROGRAM-CONSTANTS.                                        00190001
002000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PC753A  '.  00200001
002100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM753 '.  00210001
002200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS753'.  00220001
002300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00230088
002400     05  PC-PROCESS-AREA-FORMAT    PIC  X(01)  VALUE '3'.         00240089
002500     05  PC-PROCSS-GROUP-FORMAT    PIC  X(01)  VALUE '4'.         00250089
002600     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00260001
002700     05  PC-000                    PIC  X(03)  VALUE '000'.       00270001
002800     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00280001
002900     05  PC-100                    PIC  9(03)  VALUE  100.        00290011
003000     05  PC-01                     PIC  X(02)  VALUE '01'.        00300001
003100     05  PC-3                      PIC  S9(4) COMP VALUE 3.       00310001
003200     05  PC-85                     PIC  9(04)  VALUE 0085.        00320001
003300     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00330001
003400     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00340001
003500     05  PC-MGMX                   PIC  X(04)  VALUE 'MGMX'.      00350001
003600     05  PC-A                      PIC  X(01)  VALUE 'A'.         00360001
003700     05  PC-S                      PIC  X(01)  VALUE 'S'.         00370001
003800     05  PC-CRNT-YR-RTL-WRKD-CO    PIC S9(18)V99 COMP-3.          00380013
003900     05  PC-PREV-YR-RTL-WRKD-CO    PIC S9(18)V99 COMP-3.          00390013
004000     05  PC-RTL-VRNCE-WRKD-CO      PIC S9(18)V99 COMP-3.          00400013
004100     05  PC-CRNT-YR-QTY-WRKD-CO    PIC S9(18) COMP-3.             00410013
004200     05  PC-PREV-YR-QTY-WRKD-CO    PIC S9(18) COMP-3.             00420013
004300     05  PC-QTY-VRNCE-WRKD-CO      PIC S9(18) COMP-3.             00430013
004400     05  PC-CRNT-YR-CTN-WRKD-CO    PIC S9(18) COMP-3.             00440013
004500     05  PC-PREV-YR-CTN-WRKD-CO    PIC S9(18) COMP-3.             00450013
004600     05  PC-CTN-VRNCE-WRKD-CO      PIC S9(18) COMP-3.             00460013
004700     05  PC-CRNT-YR-POR-WRKD-CO    PIC S9(18) COMP-3.             00470013
004800     05  PC-PREV-YR-POR-WRKD-CO    PIC S9(18) COMP-3.             00480013
004900     05  PC-POR-VRNCE-WRKD-CO      PIC S9(18) COMP-3.             00490013
005000     05  PC-CRNT-YR-RTL-VRFD-CO    PIC S9(18)V99 COMP-3.          00500015
005100     05  PC-PREV-YR-RTL-VRFD-CO    PIC S9(18)V99 COMP-3.          00510016
005200     05  PC-RTL-VRNCE-VRFD-CO      PIC S9(18)V99 COMP-3.          00520016
005300     05  PC-CRNT-YR-QTY-VRFD-CO    PIC S9(18) COMP-3.             00530032
005400     05  PC-PREV-YR-QTY-VRFD-CO    PIC S9(18) COMP-3.             00540032
005500     05  PC-QTY-VRNCE-VRFD-CO      PIC S9(18) COMP-3.             00550015
005600     05  PC-CRNT-YR-CTN-VRFD-CO    PIC S9(18) COMP-3.             00560015
005700     05  PC-PREV-YR-CTN-VRFD-CO    PIC S9(18) COMP-3.             00570015
005800     05  PC-CTN-VRNCE-VRFD-CO      PIC S9(18) COMP-3.             00580015
005900     05  PC-CRNT-YR-POR-VRFD-CO    PIC S9(18) COMP-3.             00590015
006000     05  PC-PREV-YR-POR-VRFD-CO    PIC S9(18) COMP-3.             00600015
006100     05  PC-POR-VRNCE-VRFD-CO      PIC S9(18) COMP-3.             00610015
006200     05  PC-CRNT-YR-RTL-WRKD-DC    PIC S9(18)V99 COMP-3.          00620013
006300     05  PC-PREV-YR-RTL-WRKD-DC    PIC S9(18)V99 COMP-3.          00630013
006400     05  PC-RTL-VRNCE-WRKD-DC      PIC S9(18)V99 COMP-3.          00640013
006500     05  PC-CRNT-YR-QTY-WRKD-DC    PIC S9(18) COMP-3.             00650013
006600     05  PC-PREV-YR-QTY-WRKD-DC    PIC S9(18) COMP-3.             00660013
006700     05  PC-QTY-VRNCE-WRKD-DC      PIC S9(18) COMP-3.             00670013
006800     05  PC-CRNT-YR-CTN-WRKD-DC    PIC S9(18) COMP-3.             00680013
006900     05  PC-PREV-YR-CTN-WRKD-DC    PIC S9(18) COMP-3.             00690013
007000     05  PC-CTN-VRNCE-WRKD-DC      PIC S9(18) COMP-3.             00700013
007100     05  PC-CRNT-YR-POR-WRKD-DC    PIC S9(18) COMP-3.             00710013
007200     05  PC-PREV-YR-POR-WRKD-DC    PIC S9(18) COMP-3.             00720013
007300     05  PC-POR-VRNCE-WRKD-DC      PIC S9(18) COMP-3.             00730013
007400     05  PC-CRNT-YR-RTL-VRFD-DC    PIC S9(18)V99 COMP-3.          00740013
007500     05  PC-PREV-YR-RTL-VRFD-DC    PIC S9(18)V99 COMP-3.          00750016
007600     05  PC-RTL-VRNCE-VRFD-DC      PIC S9(18)V99 COMP-3.          00760016
007700     05  PC-CRNT-YR-QTY-VRFD-DC    PIC S9(18) COMP-3.             00770032
007800     05  PC-PREV-YR-QTY-VRFD-DC    PIC S9(18) COMP-3.             00780032
007900     05  PC-QTY-VRNCE-VRFD-DC      PIC S9(18) COMP-3.             00790013
008000     05  PC-CRNT-YR-CTN-VRFD-DC    PIC S9(18) COMP-3.             00800013
008100     05  PC-PREV-YR-CTN-VRFD-DC    PIC S9(18) COMP-3.             00810013
008200     05  PC-CTN-VRNCE-VRFD-DC      PIC S9(18) COMP-3.             00820013
008300     05  PC-CRNT-YR-POR-VRFD-DC    PIC S9(18) COMP-3.             00830013
008400     05  PC-PREV-YR-POR-VRFD-DC    PIC S9(18) COMP-3.             00840013
008500     05  PC-POR-VRNCE-VRFD-DC      PIC S9(18) COMP-3.             00850013
008600                                                                  00860009
008700*-----------------------------------------------------------------00870001
008800*  DB2 KEYS                                                       00880001
008900*-----------------------------------------------------------------00890001
009000 01  DB-KEYS.                                                     00900001
009100     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00910066
009200     05  DK-OPER-DESC                   PIC X(05) VALUE SPACES.   00920066
009300     05  DK-FROM-DATE                   PIC X(10) VALUE SPACES.   00930083
009400     05  DK-FROM-DATE-X REDEFINES DK-FROM-DATE.                   00940083
009500         10  DK-FROM-DTE-YY             PIC 9(4).                 00950083
009600         10  FILLER                     PIC X.                    00960083
009700         10  DK-FROM-DTE-MM             PIC X(2).                 00970083
009800         10  FILLER                     PIC X.                    00980083
009900         10  DK-FROM-DTE-DD             PIC X(2).                 00990083
010000     05  DK-TO-DATE                     PIC X(10).                01000083
010100     05  DK-TO-DATE-X REDEFINES DK-TO-DATE.                       01010083
010200         10  DK-TO-DTE-YY               PIC 9(4).                 01020081
010300         10  FILLER                     PIC X(1).                 01030081
010400         10  DK-TO-DTE-MM               PIC X(2).                 01040081
010500         10  FILLER                     PIC X(1).                 01050081
010600         10  DK-TO-DTE-DD               PIC X(2).                 01060081
010700     05  DK-PREV-FROM-DATE              PIC X(10).                01070006
010800     05  DK-PREV-TO-DATE                PIC X(10).                01080006
010900     05  DK-PROCESS-GROUP               PIC X(06).                01090014
011000     05  DK-PROCESS-AREA                PIC X(06).                01100014
011100     05  DK-FISCAL-WEEK.                                          01110006
011200         10  DK-FISCAL-YEAR             PIC X(04) VALUE SPACES.   01120006
011300         10  DK-FISCAL-WK               PIC X(02) VALUE SPACES.   01130006
011400     05  DK-FISCAL-MONTH.                                         01140006
011500         10  DK-FISCAL-YR               PIC X(04) VALUE SPACES.   01150006
011600         10  DK-FISCAL-MN               PIC X(02) VALUE SPACES.   01160006
011700     05  DK-PERCENT-FORMAT.                                       01170006
011800         10  DK-NUMBER                  PIC ZZ9.9 VALUE ZEROES.   01180088
011900     05  DK-NUMBER-FORMAT               PIC ZZZZZZ,ZZZ,ZZ9-.      01190088
012000     05  DK-DOLLAR-FORMAT               PIC $$$$$$,$$$,$$9-.      01200088
012100                                                                  01210001
012200*----------------------------------------------------------------*01220001
012300*  SYSTEM MESSAGES                                               *01230001
012400*----------------------------------------------------------------*01240001
012500*   00005 = INVALID VALUE                                         01250001
012600*   00007 = REQUIRED ENTRY                                        01260001
012700*   00008 = MUST BE NUMERIC                                       01270001
012800*   00009 = INVALID DATE                                          01280001
012900*   00045 = INVALID FUNCTION KEY                                  01290001
013000*   00069 - TOP OF LIST                                          *01300055
013100*   00070 - BOTTOM OF LIST                                       *01310055
013200*   00973 = ONLY ONE MAY BE SELECTED.                             01320001
013300*   21040 = YOU ARE NOT AUTHORIZED TO VIEW THIS DATA              01330001
013400*   02221 = CREATE FROM DATE MUST BE BEFORE CREATE TO DATE        01340001
013500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  01350001
013600*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01360001
013700*   02378 - YOU CANNOT USE A DATE RANGE FOR THIS SEARCH           01370001
013800*   02416 - INVALID DATE OR DATE RANGE                            01380001
013900*   02698 - DATE RANGE INVALID                                    01390001
014000*   02873 - F-KEY NOT FUNCTIONAL-CAN ONLY VIEW PO LVL FOR SPCFC DC01400001
014100*   02876 - F-KEY NOT FUNCTIONAL-CURRENT DATE MUST BE WITHIN RANGE01410065
014200*                                                                 01420001
014300*----------------------------------------------------------------*01430001
014400 01  PC-TSYMSG-NUMBERS.                                           01440001
014500     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          01450001
014600     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          01460001
014700     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          01470001
014800     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          01480001
014900     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          01490001
015000     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          01500001
015100     05  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.          01510055
015200     05  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.          01520055
015300     05  PC-TSYMSG-00973       PIC  9(05)  VALUE  00973.          01530001
015400     05  PC-TSYMSG-21040       PIC  9(05)  VALUE  21040.          01540001
015500     05  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.          01550001
015600     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          01560001
015700     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          01570001
015800     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          01580001
015900     05  PC-TSYMSG-02378       PIC  9(05)  VALUE  02378.          01590001
016000     05  PC-TSYMSG-02416       PIC  9(05)  VALUE  02416.          01600001
016100     05  PC-TSYMSG-02516       PIC  9(05)  VALUE  02516.          01610001
016200     05  PC-TSYMSG-02697       PIC  9(05)  VALUE  02697.          01620001
016300     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          01630001
016400     05  PC-TSYMSG-02873       PIC  9(05)  VALUE  02873.          01640001
016500     05  PC-TSYMSG-02876       PIC  9(05)  VALUE  02876.          01650065
016600                                                                  01660001
016700*----------------------------------------------------------------*01670001
016800*   PROGRAM MESSAGES                                             *01680001
016900*----------------------------------------------------------------*01690001
017000 01  PM-PROGRAM-MESSAGES.                                         01700001
017100     05  PM-ABEND-INFO-A.                                         01710001
017200         10  FILLER                PIC X(15)   VALUE              01720001
017300                                   'DP020-SRC-AID: '.             01730001
017400         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01740001
017500         10  FILLER                PIC X(19)   VALUE              01750001
017600                                   '. DP020-FK-ACTION: '.         01760001
017700         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01770001
017800         10  FILLER                PIC X(22)   VALUE              01780001
017900                                   '. DP020-FK-DISPN-IND: '.      01790001
018000         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01800001
018100         10  FILLER                PIC X(01)   VALUE '.'.         01810001
018200         10  FILLER                PIC X(19)   VALUE SPACE.       01820001
018300                                                                  01830001
018400*----------------------------------------------------------------*01840001
018500*   SWITCHES                                                     *01850001
018600*----------------------------------------------------------------*01860001
018700 01  PS-PROGRAM-SWITCHES.                                         01870001
018800     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01880001
018900         88  PS-ERROR                          VALUE  'Y'.        01890001
019000         88  PS-NO-ERROR                       VALUE  'N'.        01900001
019100     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01910001
019200         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01920001
019300         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01930001
019400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01940015
019500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01950015
019600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01960015
019700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01970056
019800         88  PS-LIST-END                            VALUE  'Y'.   01980056
019900         88  PS-NO-LIST-END                         VALUE  'N'.   01990056
020000                                                                  02000001
020100*----------------------------------------------------------------*02010001
020200*   PROGRAM VARIABLES                                            *02020001
020300*----------------------------------------------------------------*02030001
020400 01  PV-PROGRAM-VARIABLES.                                        02040001
020500     05  PV-KEY-PREV-YEAR             PIC S9(08) COMP-3.                  
020600     05  PV-KEY-YEAR-N            PIC 9(08).                              
020700     05  PV-KEY-YEAR-X REDEFINES PV-KEY-YEAR-N PIC X(08).                 
020800     05  PV-DIVIDEND              PIC S9(03)V9999 VALUE ZEROES.   02050035
020900     05  PV-RACF-ERROR-CODE       PIC  9(04)  VALUE ZEROES.       02060001
021000     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0.           02110001
021100     05  PV-CICS-RESPONSE         PIC S9(08)  VALUE ZEROES        02120001
021200                                   COMP SYNC.                     02130001
021300     05  PV-CICS-MSG-AREA2        PIC  X(100) VALUE SPACE.        02140001
021400     05  PV-CURRENT-DATE          PIC  X(10)  VALUE SPACES.       02150047
021500     05  PV-KEY-DATE              PIC  X(10)  VALUE SPACES.       02160001
021600     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     02170001
021700         10  PV-KEY-YY            PIC  9(04).                     02180001
021800         10  PV-DASH-1            PIC  X(01).                     02190001
021900         10  PV-KEY-MM            PIC  9(02).                     02200001
022000         10  PV-DASH-2            PIC  X(01).                     02210001
022100         10  PV-KEY-DD            PIC  9(02).                     02220001
022200     05  PV-KEY-YEAR-NBR          PIC  9(04)  VALUE ZEROES.       02230018
022300     05  PV-KEY-WEEK.                                             02240001
022400         10  PV-KEY-YEAR          PIC X(04) VALUE SPACES.         02250017
022500         10  PV-KEY-WK            PIC X(02) VALUE SPACES.         02260001
022600     05  PV-KEY-MNTH.                                             02270001
022700         10  PV-KEY-YR            PIC X(04) VALUE SPACES.         02280017
022800         10  PV-KEY-MN            PIC X(02) VALUE SPACES.         02290001
022900                                                                  02300001
023000*----------------------------------------------------------------*02310001
023100*    MAP LAYOUT                                                  *02320001
023200*----------------------------------------------------------------*02330001
023300     COPY PCKM753.                                                02340001
023400                                                                  02350001
023500*----------------------------------------------------------------*02360001
023600*    ATTRIBUTE SETTINGS COPYBOOK.                                *02370001
023700*----------------------------------------------------------------*02380001
023800     COPY DPWS015.                                                02390001
023900                                                                  02400001
024000*----------------------------------------------------------------*02410001
024100*    FUNCTION KEYS COPYBOOK                                      *02420001
024200*----------------------------------------------------------------*02430001
024300     COPY DPWS016.                                                02440001
024400                                                                  02450001
024500*----------------------------------------------------------------*02460001
024600*    ABEND PROCESSING COPYBOOK.                                  *02470001
024700*----------------------------------------------------------------*02480001
024800     COPY DPWS013.                                                02490001
024900                                                                  02500001
025000*----------------------------------------------------------------*02510001
025100*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *02520001
025200*  SUB-ROUTINE (DPKUT100).                                       *02530001
025300*----------------------------------------------------------------*02540001
025400     COPY DPWS010I.                                               02550001
025500                                                                  02560001
025600*----------------------------------------------------------------*02570001
025700*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *02580001
025800*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *02590001
025900*----------------------------------------------------------------*02600001
026000     COPY DPWS030.                                                02610001
1122RM     COPY DPWS930.                                                02610001
026100                                                                  02620001
026200*---------------------------------------------------------------* 02630002
026300* SELECTION QUEUE LAYOUT                                        * 02640002
026400*---------------------------------------------------------------* 02650002
026500     COPY PCWS215.                                                02660002
026600                                                                  02670002
026700*----------------------------------------------------------------*02680001
026800*    STANDARD COMMAREA.                                         * 02690002
026900*---------------------------------------------------------------* 02700002
027000     COPY DPWS020.                                                02710002
027100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02720002
027200                                                                  02730002
027300*---------------------------------------------------------------* 02740002
027400* INTER-APPLICATION COMMAREA.                                   * 02750002
027500*   PCWS213 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02760002
027600*             SPEC SCREEN.                                      * 02770002
027700*   PCWS214 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02780002
027800*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02790002
027900*---------------------------------------------------------------* 02800002
028000         10  INTER-APPL-COMM-AREA       PIC X(200).               02810002
028100     COPY PCWS213.                                                02820002
028200     COPY PCWS214.                                                02830002
028300                                                                  02840002
028400*---------------------------------------------------------------* 02850002
028500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02860002
028600*---------------------------------------------------------------* 02870002
028700         10  ASC-SPECIFIC-COMMAREA.                               02880001
028800             15  ASC-OPER-UNT-ID-X           PIC  X(04).          02890001
028900             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   02900001
029000                 20  ASC-OPER-UNT-ID         PIC  9(04).          02910001
029100             15  ASC-OPER-NAME               PIC  X(25).          02920001
029200             15  ASC-OPER-DESC               PIC  X(05).          02930057
029300             15  ASC-PROCESS-GROUP           PIC  X(06).          02940015
029400             15  ASC-PROCESS-AREA            PIC  X(06).          02950015
029500             15  ASC-TITLE1                  PIC  X(50).          02960003
029600             15  ASC-TITLE2                  PIC  X(60).          02970003
029700             15  ASC-TITLE3                  PIC  X(60).          02980003
029800             15  ASC-TITLE4                  PIC  X(25).          02990023
029900             15  ASC-CRNT-YR-RTL-WRKD        PIC S9(15)V99 COMP-3.03000013
030000             15  ASC-CRNT-PRCT-WRKD          PIC S9(05)V9.        03010039
030100             15  ASC-PREV-YR-RTL-WRKD        PIC S9(15)V99 COMP-3.03020013
030200             15  ASC-PREV-PRCT-WRKD          PIC S9(05)V9.        03030039
030300             15  ASC-RTL-VRNCE-WRKD          PIC S9(15)V99 COMP-3.03040013
030400             15  ASC-RTL-VRNCE-PCT-WRKD      PIC S9(06)V9.        03050039
030500             15  ASC-CRNT-YR-QTY-WRKD        PIC S9(15) COMP-3.   03060013
030600             15  ASC-CRNT-QTY-PRCT-WRKD      PIC S9(05)V9.        03070039
030700             15  ASC-PREV-YR-QTY-WRKD        PIC S9(15) COMP-3.   03080013
030800             15  ASC-PREV-QTY-PRCT-WRKD      PIC S9(05)V9.        03090039
030900             15  ASC-QTY-VRNCE-WRKD          PIC S9(15) COMP-3.   03100013
031000             15  ASC-QTY-VRNCE-PCT-WRKD      PIC S9(06)V9.        03110039
031100             15  ASC-CRNT-YR-CTN-WRKD        PIC S9(15) COMP-3.   03120013
031200             15  ASC-CRNT-CTN-PRCT-WRKD      PIC S9(05)V9.        03130039
031300             15  ASC-PREV-YR-CTN-WRKD        PIC S9(15) COMP-3.   03140013
031400             15  ASC-PREV-CTN-PRCT-WRKD      PIC S9(05)V9.        03150039
031500             15  ASC-CTN-VRNCE-WRKD          PIC S9(15) COMP-3.   03160013
031600             15  ASC-CTN-VRNCE-PCT-WRKD      PIC S9(06)V9.        03170039
031700             15  ASC-CRNT-YR-POR-WRKD        PIC S9(15) COMP-3.   03180013
031800             15  ASC-CRNT-POR-PRCT-WRKD      PIC S9(05)V9.        03190039
031900             15  ASC-PREV-YR-POR-WRKD        PIC S9(15) COMP-3.   03200013
032000             15  ASC-PREV-POR-PRCT-WRKD      PIC S9(05)V9.        03210039
032100             15  ASC-POR-VRNCE-WRKD          PIC S9(15) COMP-3.   03220013
032200             15  ASC-POR-VRNCE-PCT-WRKD      PIC S9(06)V9.        03230039
032300             15  ASC-CRNT-YR-RTL-VRFD        PIC S9(15) COMP-3.   03240032
032400             15  ASC-CRNT-PRCT-VRFD          PIC S9(05)V9.        03250039
032500             15  ASC-PREV-YR-RTL-VRFD        PIC S9(15) COMP-3.   03260032
032600             15  ASC-PREV-PRCT-VRFD          PIC S9(05)V9.        03270039
032700             15  ASC-RTL-VRNCE-VRFD          PIC S9(15) COMP-3.   03280032
032800             15  ASC-RTL-VRNCE-PCT-VRFD      PIC S9(06)V9.        03290039
032900             15  ASC-CRNT-YR-QTY-VRFD        PIC S9(15) COMP-3.   03300013
033000             15  ASC-CRNT-QTY-PRCT-VRFD      PIC S9(05)V9.        03310039
033100             15  ASC-PREV-YR-QTY-VRFD        PIC S9(15) COMP-3.   03320013
033200             15  ASC-PREV-QTY-PRCT-VRFD      PIC S9(05)V9.        03330039
033300             15  ASC-QTY-VRNCE-VRFD          PIC S9(15) COMP-3.   03340013
033400             15  ASC-QTY-VRNCE-PCT-VRFD      PIC S9(06)V9.        03350039
033500             15  ASC-CRNT-YR-CTN-VRFD        PIC S9(15) COMP-3.   03360013
033600             15  ASC-CRNT-CTN-PRCT-VRFD      PIC S9(05)V9.        03370039
033700             15  ASC-PREV-YR-CTN-VRFD        PIC S9(15) COMP-3.   03380013
033800             15  ASC-PREV-CTN-PRCT-VRFD      PIC S9(05)V9.        03390039
033900             15  ASC-CTN-VRNCE-VRFD          PIC S9(15) COMP-3.   03400013
034000             15  ASC-CTN-VRNCE-PCT-VRFD      PIC S9(06)V9.        03410039
034100             15  ASC-CRNT-YR-POR-VRFD        PIC S9(15) COMP-3.   03420013
034200             15  ASC-CRNT-POR-PRCT-VRFD      PIC S9(05)V9.        03430039
034300             15  ASC-PREV-YR-POR-VRFD        PIC S9(15) COMP-3.   03440013
034400             15  ASC-PREV-POR-PRCT-VRFD      PIC S9(05)V9.        03450039
034500             15  ASC-POR-VRNCE-VRFD          PIC S9(15) COMP-3.   03460013
034600             15  ASC-POR-VRNCE-PCT-VRFD      PIC S9(06)V9.        03470039
034700             15  ASC-CRNT-BUS-DTE.                                03480001
034800                20  ASC-CRNT-BUS-YY          PIC 9(4).            03490016
034900                20  ASC-CRNT-BUS-MM          PIC X(2).            03500001
035000                20  ASC-CRNT-BUS-DD          PIC X(2).            03510001
035100             15  ASC-PREV-BUS-DTE            PIC X(10).           03520004
035200             15  ASC-FROM-DATE.                                   03530001
035300                20  ASC-FROM-DTE-MM          PIC X(2).            03540001
035400                20  ASC-FROM-DTE-DD          PIC X(2).            03550001
035500                20  ASC-FROM-DTE-YY          PIC 9(4).            03560016
035600             15  ASC-PREV-FROM-DATE          PIC X(10).           03570004
035700             15  ASC-TO-DATE.                                     03580001
035800                20  ASC-TO-DTE-MM            PIC X(2).            03590001
035900                20  ASC-TO-DTE-DD            PIC X(2).            03600001
036000                20  ASC-TO-DTE-YY            PIC 9(4).            03610016
036100             15  ASC-PREV-TO-DATE            PIC X(10).           03620004
036200             15  ASC-FISCAL-WEEK.                                 03630001
036300                 20  ASC-FSL-WK-YY            PIC 9(4).           03640053
036400                 20  ASC-FSL-WK-WK            PIC X(2).           03650053
036500             15  ASC-FISCAL-MONTH.                                03660001
036600                 20  ASC-FSL-MN-YY            PIC 9(4).           03670053
036700                 20  ASC-FSL-MN-MN            PIC X(2).           03680053
036800             15  ASC-DAY-OF-WK               PIC X(1).            03690003
036900             15  ASC-PRINTER-ID.                                  03700001
037000                 20  ASC-PRINTER-ID-1-3       PIC X(3).           03710053
037100                 20  ASC-PRINTER-ID-4-8       PIC X(5).           03720053
037200             15  ASC-BLK-SUB                  PIC S9(04) COMP     03730054
037300                                                         SYNC.    03740054
037400             15  ASC-ITEM-SUB                 PIC S9(04) COMP     03750054
037500                                                         SYNC.    03760054
037600             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  03770054
037700             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  03780054
037800             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  03790054
037900             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  03800054
038000             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  03810054
038100             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     03820054
038200                                                         SYNC.    03830054
038300             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  03840054
038400             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  03850054
038500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03860054
038600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     03870054
038700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     03880054
038800             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03890054
038900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03900054
039000                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03910054
039100             15  ASC-LIST-QUEUE-NAME.                             03920054
039200                 20  ASC-LIST-TERM-ID         PIC  X(04).         03930054
039300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03940054
039400                 20  ASC-LIST-SEQ             PIC  9(01).         03950054
039500                                                                  03960054
039600             15  ASC-START-ITEM-REQUEST.                          03970054
039700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03980054
039800                                                                  03990054
039900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04000054
040000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04010054
040100             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04020053
040200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04030053
040300             15  ASC-SEL-QUEUE-NAME.                              04040053
040400                 20  ASC-SEL-TERM-ID          PIC  X(04).         04050053
040500                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04060053
040600                 20  ASC-SEL-SEQ              PIC  9(01).         04070053
040700             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04080053
040800                                                                  04090053
040900                                                                  04100001
041000*-----------------------------------------------------------------04110001
041100*  XLT_LOC - LOCATION TABLE                                       04120089
041200*-----------------------------------------------------------------04130001
041300     EXEC SQL                                                     04140001
041400          INCLUDE XLT00010                                        04150089
041500     END-EXEC.                                                    04160001
041600                                                                  04170001
041700*-----------------------------------------------------------------04180001
041800*  DATE TABLE                                                     04190001
041900*-----------------------------------------------------------------04200001
042000     EXEC SQL                                                     04210001
042100          INCLUDE TDTATTR                                         04220001
042200     END-EXEC.                                                    04230001
042300                                                                  04240001
042400*-----------------------------------------------------------------04250001
042500*  PROCESS AREA TO PROCESS GROUP ASSOCIATION TABLE                04260001
042600*  PCT_PRC_AREA_ASSN                                              04270001
042700*-----------------------------------------------------------------04280001
042800     EXEC SQL                                                     04290001
042900          INCLUDE PCT00003                                        04300001
043000     END-EXEC.                                                    04310001
043100                                                                  04320001
043200*-----------------------------------------------------------------04330001
043300*  SUMMARY OF UNITS WORKED TABLE                                  04340001
043400*  PCT_SUM_WRKD                                                   04350001
043500*-----------------------------------------------------------------04360001
043600     EXEC SQL                                                     04370001
043700          INCLUDE PCT00005                                        04380001
043800     END-EXEC.                                                    04390001
043900                                                                  04400001
044000*-----------------------------------------------------------------04410001
044100*  SUMMARY OF UNITS VERIFIED TABLE                                04420001
044200*  PCT_SUM_VRFD                                                   04430001
044300*-----------------------------------------------------------------04440001
044400     EXEC SQL                                                     04450001
044500          INCLUDE PCT00006                                        04460001
044600     END-EXEC.                                                    04470001
044700                                                                  04480001
044800     EXEC SQL                                                     04450001
044900          INCLUDE SYSDUMMY                                        04460001
045000     END-EXEC.                                                    04470001
045100                                                                  04480001
045200*-----------------------------------------------------------------04490001
045300*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                04500001
045400*-----------------------------------------------------------------04510001
045500     EXEC SQL                                                     04520001
045600          INCLUDE SQLCA                                           04530001
045700     END-EXEC.                                                    04540001
045800                                                                  04550001
045900*-----------------------------------------------------------------04560001
046000 LINKAGE SECTION.                                                 04570001
046100*-----------------------------------------------------------------04580001
046200 01  DFHCOMMAREA.                                                 04590001
046300     05  FILLER                         OCCURS  1 TO 4072 TIMES   04600001
046400                                        DEPENDING ON EIBCALEN.    04610001
046500         10  FILLER                     PIC X.                    04620001
046600                                                                  04630001
046700                                                                  04640001
046800 PROCEDURE DIVISION.                                              04650001
046900*----------------------------------------------------------------*04660001
047000*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *04670001
047100*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *04680001
047200*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *04690001
047300*                                                                *04700001
047400*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *04710001
047500*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *04720001
047600*----------------------------------------------------------------*04730001
047700 0000-MAIN-MODULE.                                                04740001
047800     INITIALIZE DP030-CICS-API-FIELDS.                            04750001
047900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04760001
048000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04770001
048100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04780001
048200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04790001
048300     MOVE LENGTH OF PC753AI        TO DP030-MAP-LENGTH (1).       04800001
048400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04810001
048500     PERFORM 0001-CALL-CICS-ARCH-API.                             04820001
048600                                                                  04830001
048700     PERFORM 1000-CONTROL-PROCESSING                              04840001
048800                                                                  04850001
048900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04860001
049000     PERFORM 0001-CALL-CICS-ARCH-API.                             04870001
049100                                                                  04880001
049200*----------------------------------------------------------------*04890001
049300 0001-CALL-CICS-ARCH-API.                                         04900001
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04910001
1122RM     CALL DP930-CICS-ARCH-API                                             
1122RM                     USING DFHEIBLK                                       
049500                           DFHCOMMAREA                            04920001
049600                           DP030-CICS-API-FIELDS                  04930001
049700                           DP020-STANDARD-COMMAREA                04940001
049800                           PC753AI.                               04950001
049900                                                                  04960001
050000     IF  DP030-RC-CALL-SUCCESSFUL                                 04970001
050100         CONTINUE                                                 04980001
050200     ELSE                                                         04990001
050300         SET DP013-NO-ROLLBACK                                    05000001
050400             DP013-XCTL-DISPLAY-RESTART                           05010001
050500             DP013-CICS-ABEND      TO TRUE                        05020001
050600         MOVE 'BEFORE 0000-MAIN-MODULE'                           05030001
050700                                   TO DP013-PARAGRAPH             05040001
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL'                   05050001
1122RM*                                  TO DP013-MESSAGE-TEXT (2)      05060001
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
051000         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      05070001
051100         STRING  'RETURN CODE - '     DELIMITED BY SIZE           05080001
051200                  DP030-RETURN-CODE   DELIMITED BY SIZE           05090001
051300                                 INTO DP013-MESSAGE-TEXT (3)      05100001
051400         PERFORM DP013-0000-PROCESS-ABEND                         05110001
051500     END-IF.                                                      05120001
051600                                                                  05130001
051700*----------------------------------------------------------------*05140001
051800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05150001
051900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05160001
052000*----------------------------------------------------------------*05170001
052100 1000-CONTROL-PROCESSING.                                         05180001
052200                                                                  05190001
052300     EVALUATE TRUE                                                05200001
052400         WHEN DP020-NEXT-ACT-INITIAL                              05210001
052500             INITIALIZE ASC-SPECIFIC-COMMAREA                     05220001
052600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05230007
052700             PERFORM 4000-BUILD-INITIAL-PANEL                     05240001
052800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05250006
052900                                                                  05260001
053000         WHEN DP020-NEXT-ACT-READ-MAP                             05270001
053100             PERFORM 2000-FKEY-PROCESSING                         05280001
053200                                                                  05290001
053300         WHEN DP020-NEXT-ACT-RETURN                               05300001
053400*            INITIALIZE ASC-SPECIFIC-COMMAREA                     05310001
053500             PERFORM 4000-BUILD-INITIAL-PANEL                     05320001
053600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05330006
053700                                                                  05340001
053800         WHEN OTHER                                               05350001
053900             SET DP013-LOGIC-ABEND                                05360001
054000                 DP013-NO-ROLLBACK TO TRUE                        05370001
054100             MOVE 'PCKCS753 - 1000-CONTROL-PROCESSING'            05380001
054200                                   TO  DP013-PARAGRAPH            05390001
054300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05400001
054400                                   TO  DP013-MESSAGE-TEXT(1)      05410001
054500             MOVE DP020-NEXT-APPL-ACTIVITY                        05420001
054600                                   TO DP013-MESSAGE-TEXT(2)       05430001
054700             PERFORM DP013-0000-PROCESS-ABEND                     05440001
054800     END-EVALUATE.                                                05450001
054900                                                                  05460001
055000*----------------------------------------------------------------*05470007
055100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05480007
055200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05490007
055300*----------------------------------------------------------------*05500007
055400 1100-PROCESS-INTER-APPL-COMM.                                    05510007
055500                                                                  05520007
055600     SET PS-COMMAREA-VALID         TO TRUE.                       05530007
055700                                                                  05540007
055800     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          05550007
055900         MOVE PC213-OPER-UNT-ID       TO ASC-OPER-UNT-ID          05560015
056000         MOVE PC213-CRNT-BUS-DTE      TO ASC-CRNT-BUS-DTE         05570015
056100         MOVE PC213-FROM-DATE         TO ASC-FROM-DATE            05580007
056200         MOVE PC213-TO-DATE           TO ASC-TO-DATE              05590007
056300         MOVE PC213-FISCAL-WEEK       TO ASC-FISCAL-WEEK          05600007
056400         MOVE PC213-FISCAL-MONTH      TO ASC-FISCAL-MONTH         05610007
056500         MOVE PC213-PRINTER-ID        TO ASC-PRINTER-ID           05620007
056600     ELSE                                                         05630007
056700         SET ASC-USE-SELECTION-QUEUE TO TRUE                      05640052
056800         MOVE PC214-NUMBER-OF-SELECTED-ITEMS TO                   05650052
056900                                      ASC-NUMBER-OF-SELECTED-ITEMS05660052
057000         MOVE PC214-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  05670052
057100         MOVE PC214-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      05680052
057200         MOVE PC214-OPER-UNT-ID        TO ASC-OPER-UNT-ID         05690052
057300         MOVE PC214-BUSN-DATE          TO ASC-CRNT-BUS-DTE        05700052
057400         MOVE PC214-FROM-DATE          TO ASC-FROM-DATE           05710052
057500         MOVE PC214-TO-DATE            TO ASC-TO-DATE             05720052
057600         MOVE PC214-PROCESS-GROUP      TO ASC-PROCESS-GROUP       05730052
057700         MOVE PC214-PROCESS-AREA       TO ASC-PROCESS-AREA        05740052
057800         MOVE PC214-FISCAL-WEEK        TO ASC-FISCAL-WEEK         05750052
057900         MOVE PC214-FISCAL-MONTH       TO ASC-FISCAL-MONTH        05760052
058000         MOVE PC214-PRINTER-ID         TO ASC-PRINTER-ID          05770052
058100         PERFORM 1120-PREPARE-LIST-ENTRY                          05780052
058200     END-IF.                                                      05790007
058300                                                                  05800007
058400*-----------------------------------------------------------------05810052
058500*  PREPARE LIST ENTRY                                             05820052
058600*-----------------------------------------------------------------05830052
058700 1120-PREPARE-LIST-ENTRY.                                         05840052
058800                                                                  05850052
058900     MOVE PC215-MAX-ITEMS          TO ASC-SEL-SUB.                05860052
059000     MOVE ZERO                     TO ASC-SEL-ITEM.               05870052
059100     PERFORM 1130-GET-NEXT-RECORD.                                05880052
059200                                                                  05890052
059300*-----------------------------------------------------------------05900052
059400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05910052
059500*-----------------------------------------------------------------05920052
059600 1130-GET-NEXT-RECORD.                                            05930052
059700     ADD +1                       TO ASC-SEL-SUB.                 05940052
059800                                                                  05950052
059900     IF  ASC-SEL-SUB > PC215-MAX-ITEMS                            05960052
060000         ADD +1                   TO ASC-SEL-ITEM                 05970052
060100         MOVE +1                  TO ASC-SEL-SUB                  05980052
060200     END-IF.                                                      05990052
060300                                                                  06000052
060400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06010052
060500         PERFORM 9100-READ-SEL-QUEUE                              06020052
060600         IF  PC215-ITEM (ASC-SEL-SUB) > ZERO                      06030052
060700             MOVE PC215-OPER-DESC(ASC-SEL-SUB) TO ASC-OPER-DESC   06040052
060800             MOVE PC215-AREA  (ASC-SEL-SUB) TO ASC-PROCESS-AREA   06050052
060900             MOVE PC215-GROUP (ASC-SEL-SUB) TO ASC-PROCESS-GROUP  06060052
061000             SET PC215-INQ (ASC-SEL-SUB) TO TRUE                  06070052
061100             PERFORM 9200-REWRITE-SEL-QUEUE                       06080052
061200         ELSE                                                     06090052
061300             SUBTRACT +1 FROM ASC-SEL-SUB                         06100052
061400             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             06110052
061500             SET DP020-MSG-INFORMATIONAL                          06120052
061600                 PS-LIST-END             TO TRUE                  06130052
061700         END-IF                                                   06140052
061800     ELSE                                                         06150052
061900         SUBTRACT +1 FROM ASC-SEL-ITEM                            06160052
062000         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  06170052
062100         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             06180052
062200         SET DP020-MSG-INFORMATIONAL                              06190052
062300             PS-LIST-END             TO TRUE                      06200052
062400     END-IF.                                                      06210052
062500                                                                  06220052
062600*----------------------------------------------------------------*06230052
062700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *06240052
062800*    PROCESSED.                                                  *06250052
062900*----------------------------------------------------------------*06260052
063000 1140-GET-PREV-RECORD.                                            06270052
063100     SUBTRACT +1 FROM ASC-SEL-SUB.                                06280052
063200                                                                  06290052
063300     IF  ASC-SEL-SUB < +1                                         06300052
063400         SUBTRACT +1 FROM ASC-SEL-ITEM                            06310052
063500         MOVE PC215-MAX-ITEMS     TO ASC-SEL-SUB                  06320052
063600     END-IF.                                                      06330052
063700                                                                  06340052
063800     IF  ASC-SEL-ITEM > ZERO                                      06350052
063900         PERFORM 9100-READ-SEL-QUEUE                              06360052
064000         MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO ASC-OPER-DESC      06370052
064100         MOVE PC215-AREA  (ASC-SEL-SUB) TO ASC-PROCESS-AREA       06380052
064200         MOVE PC215-GROUP (ASC-SEL-SUB) TO ASC-PROCESS-GROUP      06390052
064300         SET PC215-INQ (ASC-SEL-SUB) TO TRUE                      06400052
064400         PERFORM 9200-REWRITE-SEL-QUEUE                           06410052
064500     ELSE                                                         06420052
064600         MOVE +1                  TO ASC-SEL-ITEM                 06430052
064700                                     ASC-SEL-SUB                  06440052
064800         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             06450052
064900         SET DP020-MSG-INFORMATIONAL                              06460052
065000             PS-LIST-END             TO TRUE                      06470052
065100     END-IF.                                                      06480052
065200                                                                  06490052
065300*----------------------------------------------------------------*06500001
065400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06510001
065500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06520001
065600* EDITS.                                                         *06530001
065700*----------------------------------------------------------------*06540001
065800 2000-FKEY-PROCESSING.                                            06550001
065900                                                                  06560001
066000     EVALUATE TRUE                                                06570001
066100                                                                  06580001
066200         WHEN DP020-SRC-AID = DP016-CLEAR                         06590001
066300*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06600006
066400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06610001
066500                                                                  06620001
066600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06630001
066700*            INITIALIZE ASC-SPECIFIC-COMMAREA                     06640006
066800             PERFORM 4000-BUILD-INITIAL-PANEL                     06650071
066900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06660006
067000                                                                  06670001
067100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06680052
067200             IF  ASC-USE-SELECTION-QUEUE                          06690052
067300                 MOVE ZEROES TO ASC-OPER-UNT-ID                   06700068
067400                 PERFORM 1130-GET-NEXT-RECORD                     06710068
067500                 IF PS-LIST-END                                   06720052
067600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06730052
067700                     SET PS-NO-LIST-END TO TRUE                   06740052
067800                 ELSE                                             06750052
067900                     PERFORM 2050-DELETE-LIST-QUEUE               06760052
068000                     PERFORM 4000-BUILD-INITIAL-PANEL             06770052
068100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06780060
068200                 END-IF                                           06790052
068300              ELSE                                                06800052
068400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06810052
068500*                --- BOTTOM OF LIST ---                           06820052
068600                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         06830052
068700                 SET DP020-MSG-INFORMATIONAL TO TRUE              06840052
068800             END-IF                                               06850052
068900                                                                  06860052
069000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06870052
069100             IF  ASC-USE-SELECTION-QUEUE                          06880052
069200                 MOVE ZEROES TO ASC-OPER-UNT-ID                   06890068
069300                 PERFORM 1140-GET-PREV-RECORD                     06900052
069400                 IF PS-LIST-END                                   06910052
069500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06920052
069600                     SET PS-NO-LIST-END TO TRUE                   06930052
069700                 ELSE                                             06940052
069800                     PERFORM 2050-DELETE-LIST-QUEUE               06950052
069900                     PERFORM 4000-BUILD-INITIAL-PANEL             06960052
070000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06970060
070100                 END-IF                                           06980052
070200             ELSE                                                 06990052
070300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07000052
070400                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         07010052
070500                 SET DP020-MSG-INFORMATIONAL TO TRUE              07020052
070600             END-IF                                               07030052
070700                                                                  07040052
070800         WHEN OTHER                                               07050001
070900*            PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07060006
071000*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07070006
071100                                                                  07080001
071200             IF  PS-NO-ERROR                                      07090001
071300                 SET DP030-CONTINUE-GO TO TRUE                    07100001
071400                 PERFORM 2100-CHECK-FUNCTION-KEY                  07110001
071500                 IF  PS-NO-ERROR                                  07120001
071600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07130001
071700                 ELSE                                             07140001
071800                     SET DP030-OVERRIDE-GO TO TRUE                07150001
071900                 END-IF                                           07160001
072000             ELSE                                                 07170001
072100                 SET DP030-OVERRIDE-GO TO TRUE                    07180001
072200             END-IF                                               07190001
072300     END-EVALUATE.                                                07200001
072400                                                                  07210001
072500*----------------------------------------------------------------*07220052
072600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07230052
072700*----------------------------------------------------------------*07240052
072800 2050-DELETE-LIST-QUEUE.                                          07250052
072900                                                                  07260052
073000     EXEC CICS                                                    07270052
073100         DELETEQ TS                                               07280052
073200             QUEUE (ASC-LIST-QUEUE-NAME)                          07290052
073300             RESP  (PV-CICS-RESPONSE)                             07300057
073400     END-EXEC.                                                    07310052
073500                                                                  07320052
073600     IF (PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                   07330057
073700        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      07340057
073800         CONTINUE                                                 07350052
073900     ELSE                                                         07360052
074000         SET DP013-CICS-ABEND      TO TRUE                        07370052
074100         SET DP013-NO-ROLLBACK     TO TRUE                        07380052
074200                                                                  07390052
074300         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         07400052
074400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07410052
074500                                   TO DP013-MESSAGE-TEXT (1)      07420052
074600         PERFORM DP013-0000-PROCESS-ABEND                         07430052
074700     END-IF.                                                      07440052
074800                                                                  07450052
074900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  07460052
075000                                                                  07470052
075100*----------------------------------------------------------------*07480001
075200*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *07490001
075300*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *07500001
075400*  FROM THE CICS ARCHITECTURE API.                               *07510001
075500*----------------------------------------------------------------*07520001
075600 2100-CHECK-FUNCTION-KEY.                                         07530001
075700                                                                  07540001
075800     IF PS-NO-ERROR                                               07550001
075900         EVALUATE TRUE                                            07560001
076000                                                                  07570001
076100* ENTER                                                           07580001
076200             WHEN DP020-SRC-AID = DP016-ENTER                     07590001
076300                 PERFORM 4000-BUILD-INITIAL-PANEL                 07600001
076400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07610001
076500                                                                  07620001
076600* F22 - THRU PERIOD REQUESTED                                     07630005
076700             WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          07640005
076800                 IF PS-NO-ERROR                                   07650001
076900                     PERFORM 5000-RETRIEVE-CURR-DATE              07660063
077000                     MOVE ASC-FROM-DTE-YY TO PV-KEY-YY            07670063
077100                     MOVE ASC-FROM-DTE-MM TO PV-KEY-MM            07680063
077200                     MOVE ASC-FROM-DTE-DD TO PV-KEY-DD            07690063
077300                     MOVE '-'   TO PV-DASH-1                      07700063
077400                                   PV-DASH-2                      07710063
077500                     MOVE PV-KEY-DATE  TO  DK-FROM-DATE           07720063
077600                     MOVE ASC-TO-DTE-YY TO PV-KEY-YY              07730063
077700                     MOVE ASC-TO-DTE-MM TO PV-KEY-MM              07740063
077800                     MOVE ASC-TO-DTE-DD TO PV-KEY-DD              07750063
077900                     MOVE '-'   TO PV-DASH-1                      07760063
078000                                   PV-DASH-2                      07770063
078100                     MOVE PV-KEY-DATE  TO  DK-TO-DATE             07780063
078200                     IF ((PV-CURRENT-DATE > DK-FROM-DATE OR       07790073
078300                          PV-CURRENT-DATE = DK-FROM-DATE) AND     07800073
078400                         (PV-CURRENT-DATE < DK-TO-DATE OR         07810072
078500                          PV-CURRENT-DATE = DK-TO-DATE))          07820072
078600                           PERFORM 4000-BUILD-INITIAL-PANEL       07830072
078700                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   07840063
078800                     ELSE                                         07850063
078900                         SET PS-ERROR                             07860063
079000                             DP020-MSG-FATAL  TO TRUE             07870063
079100                         MOVE PC-TSYMSG-02876 TO DP020-MSG-NUMBER 07880064
079200                     END-IF                                       07890063
079300                 END-IF                                           07900047
079400                                                                  07910001
079500* F23 - THRU BUSINESS DAY                                         07920005
079600             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          07930005
079700                 IF PS-NO-ERROR                                   07940001
079800                     PERFORM 5000-RETRIEVE-CURR-DATE              07950048
079900                     MOVE ASC-FROM-DTE-YY TO PV-KEY-YY            07960048
080000                     MOVE ASC-FROM-DTE-MM TO PV-KEY-MM            07970048
080100                     MOVE ASC-FROM-DTE-DD TO PV-KEY-DD            07980048
080200                     MOVE '-'   TO PV-DASH-1                      07990048
080300                                   PV-DASH-2                      08000048
080400                     MOVE PV-KEY-DATE  TO  DK-FROM-DATE           08010048
080500                     MOVE ASC-TO-DTE-YY TO PV-KEY-YY              08020048
080600                     MOVE ASC-TO-DTE-MM TO PV-KEY-MM              08030048
080700                     MOVE ASC-TO-DTE-DD TO PV-KEY-DD              08040048
080800                     MOVE '-'   TO PV-DASH-1                      08050048
080900                                   PV-DASH-2                      08060048
081000                     MOVE PV-KEY-DATE  TO  DK-TO-DATE             08070048
081100                     IF ((PV-CURRENT-DATE > DK-FROM-DATE OR       08080073
081200                          PV-CURRENT-DATE = DK-FROM-DATE) AND     08090073
081300                         (PV-CURRENT-DATE < DK-TO-DATE OR         08100072
081400                          PV-CURRENT-DATE = DK-TO-DATE))          08110072
081500                           MOVE PV-CURRENT-DATE TO PV-KEY-DATE    08120072
081600                                                   DK-TO-DATE     08130072
081700                           PERFORM 4250-GET-TDTATTR               08140072
081800                           MOVE DTATTR-LY-THIS-DAY-KY-DTE         08150072
081900                                              TO DK-PREV-TO-DATE  08160072
082000                           MOVE ASC-PREV-FROM-DATE                08170072
082100                                             TO DK-PREV-FROM-DATE 08180072
082200                           PERFORM 5200-CREATE-TITLE-LINES        08190072
082300                           PERFORM 4300-GET-UNITS-WORKED          08200072
082400                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   08210072
082500                     ELSE                                         08220072
082600                         SET PS-ERROR                             08230072
082700                             DP020-MSG-FATAL  TO TRUE             08240072
082800                         MOVE PC-TSYMSG-02876 TO DP020-MSG-NUMBER 08250072
082900                     END-IF                                       08260072
083000                 END-IF                                           08270047
083100                                                                  08280001
083200* F24 - PRINT REPORTS                                             08290005
083300             WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          08300005
083400                 IF PS-NO-ERROR                                   08340086
083500                     INITIALIZE PC214-INTER-APPL-COMMAREA         08360086
083600                     MOVE ASC-OPER-UNT-ID  TO PC214-OPER-UNT-ID   08430086
083700                     MOVE ASC-CRNT-BUS-DTE TO PC214-BUSN-DATE     08440086
083800                     MOVE ASC-FROM-DATE    TO PC214-FROM-DATE     08450086
083900                     MOVE ASC-TO-DATE      TO PC214-TO-DATE       08460086
084000                     MOVE ASC-FISCAL-WEEK  TO PC214-FISCAL-WEEK   08470086
084100                     MOVE ASC-FISCAL-MONTH TO PC214-FISCAL-MONTH  08480086
084200                     MOVE ASC-PRINTER-ID   TO PC214-PRINTER-ID    08490086
084300                 END-IF                                           08500086
084400                                                                  08510069
084500             WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)             08520001
084600             WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)               08530001
084700*                PERFORM 2110-PREPARE-INTER-APPL-COMM             08540015
084800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08550015
084900*                                                                 08560001
085000* OTHER                                                           08570001
085100             WHEN OTHER                                           08580001
085200                 SET DP013-NO-ROLLBACK                            08590001
085300                     DP013-XCTL-DISPLAY-RESTART                   08600001
085400                     DP013-CICS-ABEND  TO TRUE                    08610001
085500                 MOVE '2100-CHECK-FUNCTION-KEY'                   08620001
085600                                       TO DP013-PARAGRAPH         08630001
085700                 MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'  08640001
085800                                       TO DP013-MESSAGE-TEXT (1)  08650001
085900              MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:'08660001
086000                                       TO DP013-MESSAGE-TEXT (2)  08670001
086100                 MOVE DP020-SRC-AID    TO PM-A-SRC-AID            08680001
086200                 MOVE DP020-FK-ACTION (DP020-SRC-AID)             08690001
086300                                       TO PM-A-FK-ACTION          08700001
086400                 MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)          08710001
086500                                       TO PM-A-FK-DISPN           08720001
086600                 MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)  08730001
086700                 MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'    08740001
086800                                       TO DP013-MESSAGE-TEXT (4)  08750001
086900                 PERFORM DP013-0000-PROCESS-ABEND                 08760001
087000         END-EVALUATE                                             08770001
087100     END-IF.                                                      08780001
087200                                                                  08790001
087300*----------------------------------------------------------------*08800001
087400*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *08810001
087500*  IT HERE.                                                      *08820001
087600*----------------------------------------------------------------*08830001
087700 4000-BUILD-INITIAL-PANEL.                                        08840001
087800     PERFORM 4100-CHECK-OPER-UNT.                                 08850001
087900     PERFORM 4200-CREATE-TITLE-LINES.                             08860008
088000     PERFORM 4300-GET-UNITS-WORKED.                               08870008
088100                                                                  08880008
088200*----------------------------------------------------------------*08890001
088300*  CHECK TO SEE IF THE INFORMATION REQUESTED IS AT A DC LEVEL OR *08900003
088400*  COMPANY LEVEL.                                                *08910003
088500*----------------------------------------------------------------*08920001
088600 4100-CHECK-OPER-UNT.                                             08930006
088700                                                                  08940006
088800     IF ASC-OPER-UNT-ID > ZEROES                                  08950036
088900         MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID                08960001
089000         EXEC SQL                                                 08970006
089100              SELECT LOC_NM                                       08980089
089200              INTO :XLT00010-LOC-NM                               08990089
089300                FROM XLT_LOC                                      09000089
089400              WHERE LOC_NBR  =  :DK-OPER-UNT-ID                   09010089
089500         END-EXEC                                                 09020003
089600                                                                  09030003
089700         EVALUATE TRUE                                            09040003
089800             WHEN SQLCODE = +0                                    09050003
089900                 MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME         09060089
090000             WHEN OTHER                                           09070003
090100                 MOVE SPACES             TO ASC-OPER-NAME         09080066
090200         END-EVALUATE                                             09090003
090300     ELSE                                                         09100066
090400         IF PC215-OPER-DESC (ASC-SEL-SUB) > SPACES                09110066
090500             MOVE PC215-OPER-DESC (ASC-SEL-SUB) TO DK-OPER-DESC   09120066
090600             EXEC SQL                                             09130066
090700                  SELECT  LOC_NBR                                 09140089
090800                         ,LOC_NM                                  09150089
090900                    INTO  :XLT00010-LOC-NBR                       09160089
091000                         ,:XLT00010-LOC-NM                        09170089
091100                    FROM  XLT_LOC                                 09180089
091200                   WHERE  LOC_5_ABBR_NM =  :DK-OPER-DESC          09190090
091300             END-EXEC                                             09200066
091400             EVALUATE TRUE                                        09210066
091500                 WHEN SQLCODE = +0                                09220066
091600                     MOVE XLT00010-LOC-NBR   TO ASC-OPER-UNT-ID   09230089
091700                                                DK-OPER-UNT-ID    09240066
091800                     MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME     09250089
091900                 WHEN OTHER                                       09260066
092000                     MOVE ZEROES       TO ASC-OPER-UNT-ID         09270067
092100                                          DK-OPER-UNT-ID          09280066
092200                     MOVE SPACES       TO ASC-OPER-NAME           09290066
092300             END-EVALUATE                                         09300066
092400     END-IF.                                                      09310003
092500                                                                  09320003
092600*----------------------------------------------------------------*09330008
092700*  RETRIEVE PREVIOUS DATE AND CREATE TITLE LINES                  09340043
092800*----------------------------------------------------------------*09350008
092900 4200-CREATE-TITLE-LINES.                                         09360008
093000     IF ASC-CRNT-BUS-YY       > SPACES                            09370008
093100         MOVE ASC-CRNT-BUS-YY TO PV-KEY-YY                        09380043
093200         MOVE ASC-CRNT-BUS-MM TO PV-KEY-MM                        09390043
093300         MOVE ASC-CRNT-BUS-DD TO PV-KEY-DD                        09400043
093400         MOVE '-'             TO PV-DASH-1                        09410043
093500                                 PV-DASH-2                        09420043
093600         MOVE PV-KEY-DATE     TO DK-FROM-DATE                     09430043
093700                                 DK-TO-DATE                       09440043
093800         PERFORM 4250-GET-TDTATTR                                 09450008
093900         MOVE DTATTR-LY-THIS-DAY-KY-DTE TO DK-PREV-FROM-DATE      09460043
094000                                           DK-PREV-TO-DATE        09470043
094100                                           ASC-PREV-BUS-DTE       09480043
094200         STRING 'CURRENT.: ' DELIMITED BY SIZE                    09490043
094300                'BUSINESS DATE ' DELIMITED BY SIZE                09500008
094400                DK-FROM-DATE  DELIMITED BY SIZE                   09510008
094500                   INTO ASC-TITLE2                                09520008
094600         STRING 'PREVIOUS: ' DELIMITED BY SIZE                    09530043
094700                'BUSINESS DATE ' DELIMITED BY SIZE                09540008
094800                DK-PREV-FROM-DATE  DELIMITED BY SIZE              09550008
094900                   INTO ASC-TITLE3                                09560008
095000     ELSE                                                         09570008
095100         IF ASC-FROM-DTE-YY       > SPACES                        09580043
095200             MOVE ASC-FROM-DTE-YY TO PV-KEY-YY                    09590020
095300             MOVE ASC-FROM-DTE-MM TO PV-KEY-MM                    09600043
095400             MOVE ASC-FROM-DTE-DD TO PV-KEY-DD                    09610043
095500             MOVE '-'   TO PV-DASH-1                              09620019
095600                           PV-DASH-2                              09630019
095700             MOVE PV-KEY-DATE  TO  DK-FROM-DATE                   09640020
095800             PERFORM 4250-GET-TDTATTR                             09650043
095900             MOVE DTATTR-LY-THIS-DAY-KY-DTE TO DK-PREV-FROM-DATE  09660043
096000                                               ASC-PREV-FROM-DATE 09670043
096100             MOVE ASC-TO-DTE-YY TO PV-KEY-YY                      09680020
096200             MOVE ASC-TO-DTE-MM TO PV-KEY-MM                      09690043
096300             MOVE ASC-TO-DTE-DD TO PV-KEY-DD                      09700043
096400             MOVE '-'           TO PV-DASH-1                      09710043
096500                                   PV-DASH-2                      09720043
096600             MOVE PV-KEY-DATE   TO DK-TO-DATE                     09730020
096700             PERFORM 4250-GET-TDTATTR                             09740008
096800             MOVE DTATTR-LY-THIS-DAY-KY-DTE TO DK-PREV-TO-DATE    09750043
096900                                               ASC-PREV-TO-DATE   09760043
097000             STRING 'CURRENT.: ' DELIMITED BY SIZE                09770051
097100                    'BUSINESS DATE RANGE ' DELIMITED BY SIZE      09780008
097200                    DK-FROM-DATE  DELIMITED BY SIZE               09790008
097300                    ' TO '        DELIMITED BY SIZE               09800008
097400                    DK-TO-DATE    DELIMITED BY SIZE               09810008
097500                       INTO ASC-TITLE2                            09820008
097600             STRING 'PREVIOUS: ' DELIMITED BY SIZE                09830051
097700                    'BUSINESS DATE RANGE ' DELIMITED BY SIZE      09840008
097800                    DK-PREV-FROM-DATE  DELIMITED BY SIZE          09850008
097900                    ' TO '        DELIMITED BY SIZE               09860008
098000                    DK-PREV-TO-DATE    DELIMITED BY SIZE          09870008
098100                       INTO ASC-TITLE3                            09880008
098200         ELSE                                                     09890008
098300             IF ASC-FSL-WK-YY       > SPACES                      09900008
098400                 MOVE ASC-FSL-WK-YY TO PV-KEY-YEAR                09910008
098500                 MOVE ASC-FSL-WK-WK TO PV-KEY-WK                  09920008
098600                 PERFORM 4275-GET-WEEK-DATES                      09930008
098700                 MOVE DTATTR-FSCL-WK-BEG-DTE TO DK-FROM-DATE      09940008
098800                 MOVE DK-FROM-DTE-YY TO ASC-FROM-DTE-YY           09950081
098900                 MOVE DK-FROM-DTE-MM TO ASC-FROM-DTE-MM           09960081
099000                 MOVE DK-FROM-DTE-DD TO ASC-FROM-DTE-DD           09970081
099100                 MOVE DTATTR-FSCL-WK-END-DTE TO DK-TO-DATE        09980008
099200                 MOVE DK-TO-DTE-YY TO ASC-TO-DTE-YY               09990081
099300                 MOVE DK-TO-DTE-MM TO ASC-TO-DTE-MM               10000081
099400                 MOVE DK-TO-DTE-DD TO ASC-TO-DTE-DD               10010081
099500                 MOVE DK-FROM-DATE TO PV-KEY-DATE                 10020081
099600                 PERFORM 4250-GET-TDTATTR                         10030043
099700                 MOVE DTATTR-LY-THIS-DAY-KY-DTE TO                10040043
099800                                               DK-PREV-FROM-DATE  10050043
099900                                               ASC-PREV-FROM-DATE 10060043
100000                 MOVE DK-TO-DATE      TO PV-KEY-DATE              10070043
100100                 PERFORM 4250-GET-TDTATTR                         10080043
100200                 MOVE DTATTR-LY-THIS-DAY-KY-DTE TO                10090043
100300                                                 DK-PREV-TO-DATE  10100043
100400                                                 ASC-PREV-TO-DATE 10110043
100500                 STRING 'CURRENT.: ' DELIMITED BY SIZE            10120051
100600                        'WTD INCL ' DELIMITED BY SIZE             10130008
100700                      DK-FROM-DATE  DELIMITED BY SIZE             10140043
100800                         ' TO '     DELIMITED BY SIZE             10150043
100900                        DK-TO-DATE  DELIMITED BY SIZE             10160043
101000                           INTO ASC-TITLE2                        10170008
101100                 STRING 'PREVIOUS: ' DELIMITED BY SIZE            10180051
101200                        'WTD INCL ' DELIMITED BY SIZE             10190008
101300                 DK-PREV-FROM-DATE  DELIMITED BY SIZE             10200043
101400                         ' TO '     DELIMITED BY SIZE             10210043
101500                   DK-PREV-TO-DATE  DELIMITED BY SIZE             10220008
101600                           INTO ASC-TITLE3                        10230008
101700             ELSE                                                 10240008
101800                 IF ASC-FSL-MN-YY   > SPACES                      10250008
101900                     MOVE ASC-FSL-MN-YY TO PV-KEY-YR              10260008
102000                     MOVE ASC-FSL-MN-MN TO PV-KEY-MN              10270008
102100                     PERFORM 4280-GET-MONTH-DATES                 10280008
102200                     MOVE DTATTR-FSCL-MN-BEG-DTE TO DK-FROM-DATE  10290008
102300                     MOVE DK-FROM-DTE-YY TO ASC-FROM-DTE-YY       10300082
102400                     MOVE DK-FROM-DTE-MM TO ASC-FROM-DTE-MM       10310082
102500                     MOVE DK-FROM-DTE-DD TO ASC-FROM-DTE-DD       10320082
102600                     MOVE DTATTR-FSCL-MN-END-DTE TO DK-TO-DATE    10330008
102700                     MOVE DK-TO-DTE-YY TO ASC-TO-DTE-YY           10340082
102800                     MOVE DK-TO-DTE-MM TO ASC-TO-DTE-MM           10350082
102900                     MOVE DK-TO-DTE-DD TO ASC-TO-DTE-DD           10360082
103000                     MOVE DK-FROM-DATE TO PV-KEY-DATE             10370082
103100                     PERFORM 4250-GET-TDTATTR                     10380043
103200                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            10390043
103300                                               DK-PREV-FROM-DATE  10400043
103400                                               ASC-PREV-FROM-DATE 10410043
103500                     MOVE DK-TO-DATE      TO PV-KEY-DATE          10420043
103600                     PERFORM 4250-GET-TDTATTR                     10430043
103700                     MOVE DTATTR-LY-THIS-DAY-KY-DTE TO            10440043
103800                                                 DK-PREV-TO-DATE  10450043
103900                                                 ASC-PREV-TO-DATE 10460043
104000                    STRING 'CURRENT.: ' DELIMITED BY SIZE         10470051
104100                           'MTD INCL ' DELIMITED BY SIZE          10480043
104200                         DK-FROM-DATE  DELIMITED BY SIZE          10490043
104300                           ' TO '      DELIMITED BY SIZE          10500043
104400                           DK-TO-DATE  DELIMITED BY SIZE          10510043
104500                              INTO ASC-TITLE2                     10520043
104600                    STRING 'PREVIOUS: ' DELIMITED BY SIZE         10530051
104700                           'MTD INCL ' DELIMITED BY SIZE          10540043
104800                    DK-PREV-FROM-DATE  DELIMITED BY SIZE          10550043
104900                           ' TO '      DELIMITED BY SIZE          10560043
105000                      DK-PREV-TO-DATE  DELIMITED BY SIZE          10570043
105100                               INTO ASC-TITLE3                    10580043
105200                 END-IF                                           10590008
105300             END-IF                                               10600008
105400         END-IF                                                   10610008
105500     END-IF.                                                      10620008
105600                                                                  10630008
105700*----------------------------------------------------------------*10640001
105800*    RETRIEVE THE PREVIOUS DATE                                   10650043
105900*----------------------------------------------------------------*10660001
106000 4250-GET-TDTATTR.                                                10670008
106100                                                                  10680001
106200     EXEC SQL                                                     10690091
106300          SELECT                                                  10681091
106400                LY_THIS_DAY_KY_DTE                                10683091
106500             ,  FSCL_YR_NBR                                               
106600             ,  FSCL_MN_NBR                                               
106700             ,  DAY_OF_WK_NBR                                             
106800         INTO                                                     10710091
106900                :DTATTR-LY-THIS-DAY-KY-DTE                                
107000             ,  :DTATTR-FSCL-YR-NBR                                       
107100             ,  :DTATTR-FSCL-MN-NBR                                       
107200             ,  :DTATTR-DAY-OF-WK-NBR                                     
107300                                                                          
107400         FROM TDTATTR                                             10720091
107500          WHERE KY_DTE   =  :PV-KEY-DATE                          10730091
107600     END-EXEC                                                             
107700                                                                          
107800*    EXEC SQL                                                     10690091
107900                                                                  10750001
108000      EVALUATE TRUE                                               10760001
108100          WHEN SQLCODE = +0                                       10770001
108200             IF DTATTR-LY-THIS-DAY-KY-DTE = '9999-09-09'          10710091
108300                 PERFORM 7000-GET-WEEK52                                  
108400             END-IF                                                       
108500                                                                          
108600          WHEN SQLCODE = +100                                     10790001
108700              SET PS-ERROR                                        10800001
108800                  DP020-MSG-FATAL         TO TRUE                 10810001
108900              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     10820001
109000          WHEN OTHER                                              10830001
109100              MOVE '4250-GET-TDTATTR   '   TO DP013-PARAGRAPH     10840008
109200              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  10850001
109300              MOVE SQLCA   TO DP013-SQLCA                         10860001
109400              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         10870001
109500              SET DP013-DB2-ABEND                                 10880001
109600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              10890001
109700              PERFORM DP013-0000-PROCESS-ABEND                    10900001
109800      END-EVALUATE.                                               10910001
109900                                                                  10920001
110000*----------------------------------------------------------------*10930006
110100*    RETRIEVE THE WEEKLY DATE                                     10940043
110200*----------------------------------------------------------------*10950006
110300 4275-GET-WEEK-DATES.                                             10960008
110400                                                                  10970006
110500     EXEC SQL                                                     10980006
110600          SELECT DISTINCT(FSCL_WK_BEG_DTE)                        10990045
110700                ,FSCL_WK_END_DTE                                  11000014
110800            INTO :DTATTR-FSCL-WK-BEG-DTE                          11010006
110900                ,:DTATTR-FSCL-WK-END-DTE                          11020006
111000            FROM TDTATTR                                          11030006
111100          WHERE FSCL_YR_NBR =  :PV-KEY-YEAR                       11040012
111200            AND FSCL_WK_NBR =  :PV-KEY-WK                         11050012
111300      END-EXEC.                                                   11060006
111400                                                                  11070006
111500      EVALUATE TRUE                                               11080006
111600          WHEN SQLCODE = +0                                       11090006
111700              CONTINUE                                            11100006
111800          WHEN SQLCODE = +100                                     11110006
111900              SET PS-ERROR                                        11120006
112000                  DP020-MSG-FATAL         TO TRUE                 11130006
112100              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     11140006
112200          WHEN OTHER                                              11150006
112300              MOVE '4275-GET-WEEK-DATES'   TO DP013-PARAGRAPH     11160008
112400              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  11170006
112500              MOVE SQLCA   TO DP013-SQLCA                         11180006
112600              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         11190006
112700              SET DP013-DB2-ABEND                                 11200006
112800                  DP013-XCTL-DISPLAY-RESTART TO TRUE              11210006
112900              PERFORM DP013-0000-PROCESS-ABEND                    11220006
113000      END-EVALUATE.                                               11230006
113100                                                                  11240006
113200*----------------------------------------------------------------*11250006
113300*    RETRIEVE THE MONTHLY DATES                                   11260043
113400*----------------------------------------------------------------*11270006
113500 4280-GET-MONTH-DATES.                                            11280008
113600                                                                  11290006
113700     EXEC SQL                                                     11300006
113800          SELECT DISTINCT(FSCL_MN_BEG_DTE)                        11310045
113900                ,FSCL_MN_END_DTE                                  11320014
114000            INTO :DTATTR-FSCL-MN-BEG-DTE                          11330006
114100                ,:DTATTR-FSCL-MN-END-DTE                          11340006
114200            FROM TDTATTR                                          11350006
114300          WHERE FSCL_YR_NBR =  :PV-KEY-YR                         11360012
114400            AND FSCL_MN_NBR =  :PV-KEY-MN                         11370012
114500      END-EXEC.                                                   11380006
114600                                                                  11390006
114700      EVALUATE TRUE                                               11400006
114800          WHEN SQLCODE = +0                                       11410006
114900              CONTINUE                                            11420006
115000          WHEN SQLCODE = +100                                     11430006
115100              SET PS-ERROR                                        11440006
115200                  DP020-MSG-FATAL         TO TRUE                 11450006
115300              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     11460006
115400          WHEN OTHER                                              11470006
115500              MOVE '4280-GET-MONTH-DATE'   TO DP013-PARAGRAPH     11480008
115600              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  11490006
115700              MOVE SQLCA   TO DP013-SQLCA                         11500006
115800              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         11510006
115900              SET DP013-DB2-ABEND                                 11520006
116000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              11530006
116100              PERFORM DP013-0000-PROCESS-ABEND                    11540006
116200      END-EVALUATE.                                               11550006
116300                                                                  11560006
116400*----------------------------------------------------------------*11570009
116500*    RETRIEVE UNITS WORKED INFORMATION                            11580009
116600*----------------------------------------------------------------*11590009
116700 4300-GET-UNITS-WORKED.                                           11600009
116800     IF ASC-PROCESS-GROUP > SPACES                                11610009
116900         IF ASC-OPER-UNT-ID > ZEROES                              11620015
117000             STRING 'PROCESS GROUP '          DELIMITED BY SIZE   11630047
117100                   ASC-PROCESS-GROUP          DELIMITED BY SPACES 11640009
117200                    ' RECAP - % TO DC TOTAL'   DELIMITED BY SIZE  11650059
117300                       INTO ASC-TITLE1                            11660009
117400             PERFORM 4320-GET-DC-UNITS-WORKED                     11670009
117500             PERFORM 4330-GET-PROC-GROUP-UNITS                    11680009
117600             PERFORM 4530-CALC-PRCNT-PRCESS-DC                    11690011
117700         ELSE                                                     11700009
117800             STRING 'PROCESS GROUP '          DELIMITED BY SIZE   11710047
117900                   ASC-PROCESS-GROUP          DELIMITED BY SPACES 11720009
118000               ' RECAP - % TO COMPANY TOTAL'   DELIMITED BY SIZE  11730059
118100                       INTO ASC-TITLE1                            11740009
118200             PERFORM 4310-GET-CO-UNITS-WORKED                     11750009
118300             PERFORM 4335-GET-PROC-GROUP-UNITS                    11760009
118400             PERFORM 4520-CALC-PRCNT-PRCESS-CO                    11770011
118500         END-IF                                                   11780009
118600     ELSE                                                         11790009
118700         IF ASC-PROCESS-AREA  > SPACES                            11800009
118800             IF ASC-OPER-UNT-ID > ZEROES                          11810015
118900                 STRING 'PROCESS AREA '      DELIMITED BY SIZE    11820047
119000                       ASC-PROCESS-AREA      DELIMITED BY SPACES  11830009
119100                      ' RECAP - % TO DC TOTAL' DELIMITED BY SIZE  11840059
119200                           INTO ASC-TITLE1                        11850009
119300                 PERFORM 4320-GET-DC-UNITS-WORKED                 11860009
119400                 PERFORM 4340-GET-PROC-AREA-UNITS                 11870009
119500                 PERFORM 4530-CALC-PRCNT-PRCESS-DC                11880011
119600             ELSE                                                 11890009
119700                 STRING 'PROCESS AREA '      DELIMITED BY SIZE    11900047
119800                       ASC-PROCESS-AREA      DELIMITED BY SPACES  11910009
119900                 ' RECAP - % TO COMPANY TOTAL' DELIMITED BY SIZE  11920059
120000                           INTO ASC-TITLE1                        11930009
120100                 PERFORM 4310-GET-CO-UNITS-WORKED                 11940009
120200                 PERFORM 4345-GET-PROC-AREA-UNITS                 11950009
120300                 PERFORM 4520-CALC-PRCNT-PRCESS-CO                11960011
120400             END-IF                                               11970009
120500         ELSE                                                     11980010
120600             IF ASC-OPER-UNT-ID > ZEROES                          11990015
120700                 STRING 'DC SUMMARY RECAP - ' DELIMITED BY SIZE   12000047
120800                         '% TO COMPANY TOTAL' DELIMITED BY SIZE   12010047
120900                           INTO ASC-TITLE1                        12020010
121000                 PERFORM 4310-GET-CO-UNITS-WORKED                 12030010
121100                 PERFORM 4320-GET-DC-UNITS-WORKED                 12040010
121200                 PERFORM 4510-CALC-PRCNT-DC-CO                    12050011
121300             ELSE                                                 12060010
121400                 STRING 'CO SUMMARY RECAP - ' DELIMITED BY SIZE   12070047
121500                        '% TO COMPANY TOTAL'  DELIMITED BY SIZE   12080047
121600                           INTO ASC-TITLE1                        12090010
121700                 PERFORM 4310-GET-CO-UNITS-WORKED                 12100010
121800                 PERFORM 4500-CALC-PRCNT-CO                       12110011
121900             END-IF                                               12120010
122000         END-IF                                                   12130010
122100     END-IF.                                                      12140009
122200                                                                  12150009
122300*----------------------------------------------------------------*12160009
122400*    RETRIEVE UNITS WORKED FOR ENTIRE COMPANY                     12170009
122500*----------------------------------------------------------------*12180009
122600 4310-GET-CO-UNITS-WORKED.                                        12190009
122700** - GET CURRENT YEAR'S UNITS                                     12200009
122800     EXEC SQL                                                     12210009
122900          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  12220009
123000                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 12230009
123100                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              12240009
123200                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             12250011
123300            INTO  :PC-CRNT-YR-QTY-WRKD-CO                         12260009
123400                 ,:PC-CRNT-YR-CTN-WRKD-CO                         12270009
123500                 ,:PC-CRNT-YR-POR-WRKD-CO                         12280009
123600                 ,:PC-CRNT-YR-RTL-WRKD-CO                         12290009
123700           FROM PCT_SUM_WRKD                                      12300009
123800         WHERE BUS_DTE   >= :DK-FROM-DATE                         12310009
123900           AND BUS_DTE   <= :DK-TO-DATE                           12320009
124000     END-EXEC.                                                    12330009
124100      EVALUATE TRUE                                               12340009
124200          WHEN SQLCODE = +0                                       12350009
124300              CONTINUE                                            12360009
124400          WHEN SQLCODE = +100                                     12370009
124500            MOVE ZEROES TO PC-CRNT-YR-QTY-WRKD-CO                 12380009
124600                           PC-CRNT-YR-CTN-WRKD-CO                 12390009
124700                           PC-CRNT-YR-POR-WRKD-CO                 12400009
124800                           PC-CRNT-YR-RTL-WRKD-CO                 12410009
124900          WHEN SQLCODE = -305                                     12420024
125000            MOVE ZEROES TO PC-CRNT-YR-QTY-WRKD-CO                 12430024
125100                           PC-CRNT-YR-CTN-WRKD-CO                 12440024
125200                           PC-CRNT-YR-POR-WRKD-CO                 12450024
125300                           PC-CRNT-YR-RTL-WRKD-CO                 12460024
125400          WHEN OTHER                                              12470009
125500              MOVE '4310-GET-CO-UNITS-WORKED'  TO DP013-PARAGRAPH 12480009
125600              MOVE 'GETTING CRNT UNITS' TO DP013-MESSAGE-TEXT (1) 12490009
125700              MOVE SQLCA   TO DP013-SQLCA                         12500009
125800              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     12510009
125900              SET DP013-DB2-ABEND                                 12520009
126000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              12530009
126100              PERFORM DP013-0000-PROCESS-ABEND                    12540009
126200      END-EVALUATE.                                               12550009
126300                                                                  12560009
126400** - GET PREVIOUS YEAR'S UNITS                                    12570009
126500     EXEC SQL                                                     12580009
126600          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  12590009
126700                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 12600009
126800                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              12610009
126900                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             12620011
127000            INTO  :PC-PREV-YR-QTY-WRKD-CO                         12630009
127100                 ,:PC-PREV-YR-CTN-WRKD-CO                         12640009
127200                 ,:PC-PREV-YR-POR-WRKD-CO                         12650009
127300                 ,:PC-PREV-YR-RTL-WRKD-CO                         12660009
127400           FROM PCT_SUM_WRKD                                      12670009
127500         WHERE BUS_DTE   >= :DK-PREV-FROM-DATE                    12680009
127600           AND BUS_DTE   <= :DK-PREV-TO-DATE                      12690009
127700     END-EXEC.                                                    12700009
127800      EVALUATE TRUE                                               12710009
127900          WHEN SQLCODE = +0                                       12720009
128000              CONTINUE                                            12730009
128100          WHEN SQLCODE = +100                                     12740009
128200            MOVE ZEROES TO PC-PREV-YR-QTY-WRKD-CO                 12750009
128300                           PC-PREV-YR-CTN-WRKD-CO                 12760009
128400                           PC-PREV-YR-POR-WRKD-CO                 12770009
128500                           PC-PREV-YR-RTL-WRKD-CO                 12780009
128600          WHEN SQLCODE = -305                                     12790024
128700            MOVE ZEROES TO PC-PREV-YR-QTY-WRKD-CO                 12800024
128800                           PC-PREV-YR-CTN-WRKD-CO                 12810024
128900                           PC-PREV-YR-POR-WRKD-CO                 12820024
129000                           PC-PREV-YR-RTL-WRKD-CO                 12830024
129100          WHEN OTHER                                              12840009
129200              MOVE '4310-GET-CO-UNITS-WORKED'  TO DP013-PARAGRAPH 12850009
129300              MOVE 'GETTING PREV UNITS' TO DP013-MESSAGE-TEXT (1) 12860009
129400              MOVE SQLCA   TO DP013-SQLCA                         12870009
129500              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     12880009
129600              SET DP013-DB2-ABEND                                 12890009
129700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              12900009
129800              PERFORM DP013-0000-PROCESS-ABEND                    12910009
129900      END-EVALUATE.                                               12920009
130000                                                                  12930009
130100** - COMPUTE VARIANCE                                             12940009
130200      COMPUTE PC-QTY-VRNCE-WRKD-CO = PC-CRNT-YR-QTY-WRKD-CO -     12950009
130300                                     PC-PREV-YR-QTY-WRKD-CO.      12960009
130400      COMPUTE PC-CTN-VRNCE-WRKD-CO = PC-CRNT-YR-CTN-WRKD-CO -     12970009
130500                                     PC-PREV-YR-CTN-WRKD-CO.      12980009
130600      COMPUTE PC-POR-VRNCE-WRKD-CO = PC-CRNT-YR-POR-WRKD-CO -     12990009
130700                                     PC-PREV-YR-POR-WRKD-CO.      13000009
130800      COMPUTE PC-RTL-VRNCE-WRKD-CO = PC-CRNT-YR-RTL-WRKD-CO -     13010009
130900                                     PC-PREV-YR-RTL-WRKD-CO.      13020009
131000                                                                  13030009
131100** - GET CURRENT YEAR'S VERIFIED                                  13040022
131200     EXEC SQL                                                     13050022
131300          SELECT DECIMAL(SUM(UNT_VRFD_QTY),15,0)                  13060022
131400                ,DECIMAL(SUM(CART_VRFD_QTY),15,0)                 13070022
131500                ,DECIMAL(SUM(PO_RCVR_VRFD_QTY),15,0)              13080022
131600                ,DECIMAL(SUM(EXTD_RTL_VRFD_AMT),15,2)             13090022
131700            INTO  :PC-CRNT-YR-QTY-VRFD-CO                         13100022
131800                 ,:PC-CRNT-YR-CTN-VRFD-CO                         13110022
131900                 ,:PC-CRNT-YR-POR-VRFD-CO                         13120022
132000                 ,:PC-CRNT-YR-RTL-VRFD-CO                         13130022
132100           FROM PCT_SUM_VRFD                                      13140022
132200         WHERE BUS_DTE   >= :DK-FROM-DATE                         13150022
132300           AND BUS_DTE   <= :DK-TO-DATE                           13160022
132400     END-EXEC.                                                    13170022
132500      EVALUATE TRUE                                               13180022
132600          WHEN SQLCODE = +0                                       13190022
132700              CONTINUE                                            13200022
132800          WHEN SQLCODE = +100                                     13210022
132900            MOVE ZEROES TO PC-CRNT-YR-QTY-VRFD-CO                 13220022
133000                           PC-CRNT-YR-CTN-VRFD-CO                 13230022
133100                           PC-CRNT-YR-POR-VRFD-CO                 13240022
133200                           PC-CRNT-YR-RTL-VRFD-CO                 13250022
133300          WHEN SQLCODE = -305                                     13260024
133400            MOVE ZEROES TO PC-CRNT-YR-QTY-VRFD-CO                 13270025
133500                           PC-CRNT-YR-CTN-VRFD-CO                 13280025
133600                           PC-CRNT-YR-POR-VRFD-CO                 13290025
133700                           PC-CRNT-YR-RTL-VRFD-CO                 13300025
133800          WHEN OTHER                                              13310022
133900              MOVE '4310-GET-CO-UNITS-WORKED'  TO DP013-PARAGRAPH 13320022
134000              MOVE 'GETTING CRNT VRFD ' TO DP013-MESSAGE-TEXT (1) 13330022
134100              MOVE SQLCA   TO DP013-SQLCA                         13340022
134200              MOVE 'PCT_SUM_VRFD' TO DP013-DB2-TABLE-NAME (1)     13350022
134300              SET DP013-DB2-ABEND                                 13360022
134400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              13370022
134500              PERFORM DP013-0000-PROCESS-ABEND                    13380022
134600      END-EVALUATE.                                               13390022
134700                                                                  13400022
134800** - GET PREVIOUS YEAR'S VERIFIED                                 13410022
134900     EXEC SQL                                                     13420022
135000          SELECT DECIMAL(SUM(UNT_VRFD_QTY),15,0)                  13430022
135100                ,DECIMAL(SUM(CART_VRFD_QTY),15,0)                 13440022
135200                ,DECIMAL(SUM(PO_RCVR_VRFD_QTY),15,0)              13450022
135300                ,DECIMAL(SUM(EXTD_RTL_VRFD_AMT),15,2)             13460022
135400            INTO  :PC-PREV-YR-QTY-VRFD-CO                         13470022
135500                 ,:PC-PREV-YR-CTN-VRFD-CO                         13480022
135600                 ,:PC-PREV-YR-POR-VRFD-CO                         13490022
135700                 ,:PC-PREV-YR-RTL-VRFD-CO                         13500022
135800           FROM PCT_SUM_VRFD                                      13510022
135900         WHERE BUS_DTE   >= :DK-PREV-FROM-DATE                    13520022
136000           AND BUS_DTE   <= :DK-PREV-TO-DATE                      13530022
136100     END-EXEC.                                                    13540022
136200      EVALUATE TRUE                                               13550022
136300          WHEN SQLCODE = +0                                       13560022
136400              CONTINUE                                            13570022
136500          WHEN SQLCODE = +100                                     13580022
136600            MOVE ZEROES TO PC-PREV-YR-QTY-VRFD-CO                 13590022
136700                           PC-PREV-YR-CTN-VRFD-CO                 13600022
136800                           PC-PREV-YR-POR-VRFD-CO                 13610022
136900                           PC-PREV-YR-RTL-VRFD-CO                 13620022
137000          WHEN SQLCODE = -305                                     13630024
137100            MOVE ZEROES TO PC-PREV-YR-QTY-VRFD-CO                 13640025
137200                           PC-PREV-YR-CTN-VRFD-CO                 13650025
137300                           PC-PREV-YR-POR-VRFD-CO                 13660025
137400                           PC-PREV-YR-RTL-VRFD-CO                 13670025
137500          WHEN OTHER                                              13680022
137600              MOVE '4310-GET-CO-UNITS-WORKED'  TO DP013-PARAGRAPH 13690022
137700              MOVE 'GETTING PREV VRFD ' TO DP013-MESSAGE-TEXT (1) 13700022
137800              MOVE SQLCA   TO DP013-SQLCA                         13710022
137900              MOVE 'PCT_SUM_VRFD' TO DP013-DB2-TABLE-NAME (1)     13720022
138000              SET DP013-DB2-ABEND                                 13730022
138100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              13740022
138200              PERFORM DP013-0000-PROCESS-ABEND                    13750022
138300      END-EVALUATE.                                               13760022
138400                                                                  13770022
138500** - COMPUTE VARIANCE                                             13780022
138600      COMPUTE PC-QTY-VRNCE-VRFD-CO = PC-CRNT-YR-QTY-VRFD-CO -     13790022
138700                                     PC-PREV-YR-QTY-VRFD-CO.      13800022
138800      COMPUTE PC-CTN-VRNCE-VRFD-CO = PC-CRNT-YR-CTN-VRFD-CO -     13810022
138900                                     PC-PREV-YR-CTN-VRFD-CO.      13820022
139000      COMPUTE PC-POR-VRNCE-VRFD-CO = PC-CRNT-YR-POR-VRFD-CO -     13830022
139100                                     PC-PREV-YR-POR-VRFD-CO.      13840022
139200      COMPUTE PC-RTL-VRNCE-VRFD-CO = PC-CRNT-YR-RTL-VRFD-CO -     13850022
139300                                     PC-PREV-YR-RTL-VRFD-CO.      13860022
139400                                                                  13870022
139500*----------------------------------------------------------------*13880022
139600*    RETRIEVE UNITS WORKED FOR ENTIRE DC                          13890009
139700*----------------------------------------------------------------*13900009
139800 4320-GET-DC-UNITS-WORKED.                                        13910009
139900** - GET CURRENT YEAR'S UNITS                                     13920009
140000     MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                    13930009
140100     EXEC SQL                                                     13940009
140200          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  13950009
140300                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 13960009
140400                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              13970009
140500                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             13980011
140600            INTO  :PC-CRNT-YR-QTY-WRKD-DC                         13990009
140700                 ,:PC-CRNT-YR-CTN-WRKD-DC                         14000009
140800                 ,:PC-CRNT-YR-POR-WRKD-DC                         14010009
140900                 ,:PC-CRNT-YR-RTL-WRKD-DC                         14020009
141000           FROM PCT_SUM_WRKD                                      14030009
141100         WHERE BUS_DTE    >= :DK-FROM-DATE                        14040009
141200           AND BUS_DTE    <= :DK-TO-DATE                          14050009
141300           AND OPER_UNT_ID = :DK-OPER-UNT-ID                      14060009
141400     END-EXEC.                                                    14070009
141500      EVALUATE TRUE                                               14080009
141600          WHEN SQLCODE = +0                                       14090009
141700              CONTINUE                                            14100009
141800          WHEN SQLCODE = +100                                     14110009
141900            MOVE ZEROES TO PC-CRNT-YR-QTY-WRKD-DC                 14120009
142000                           PC-CRNT-YR-CTN-WRKD-DC                 14130009
142100                           PC-CRNT-YR-POR-WRKD-DC                 14140009
142200                           PC-CRNT-YR-RTL-WRKD-DC                 14150009
142300          WHEN SQLCODE = -305                                     14160024
142400            MOVE ZEROES TO PC-CRNT-YR-QTY-WRKD-DC                 14170024
142500                           PC-CRNT-YR-CTN-WRKD-DC                 14180024
142600                           PC-CRNT-YR-POR-WRKD-DC                 14190024
142700                           PC-CRNT-YR-RTL-WRKD-DC                 14200024
142800          WHEN OTHER                                              14210009
142900              MOVE '4320-GET-DC-UNITS-WORKED'  TO DP013-PARAGRAPH 14220009
143000              MOVE 'GETTING CRNT UNITS' TO DP013-MESSAGE-TEXT (1) 14230009
143100              MOVE SQLCA   TO DP013-SQLCA                         14240009
143200              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     14250009
143300              SET DP013-DB2-ABEND                                 14260009
143400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14270009
143500              PERFORM DP013-0000-PROCESS-ABEND                    14280009
143600      END-EVALUATE.                                               14290009
143700                                                                  14300009
143800** - GET PREVIOUS YEAR'S UNITS                                    14310009
143900     EXEC SQL                                                     14320009
144000          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  14330009
144100                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 14340009
144200                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              14350009
144300                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             14360011
144400            INTO  :PC-PREV-YR-QTY-WRKD-DC                         14370009
144500                 ,:PC-PREV-YR-CTN-WRKD-DC                         14380009
144600                 ,:PC-PREV-YR-POR-WRKD-DC                         14390009
144700                 ,:PC-PREV-YR-RTL-WRKD-DC                         14400009
144800           FROM PCT_SUM_WRKD                                      14410009
144900         WHERE BUS_DTE    >= :DK-PREV-FROM-DATE                   14420009
145000           AND BUS_DTE    <= :DK-PREV-TO-DATE                     14430009
145100           AND OPER_UNT_ID = :DK-OPER-UNT-ID                      14440009
145200     END-EXEC.                                                    14450009
145300      EVALUATE TRUE                                               14460009
145400          WHEN SQLCODE = +0                                       14470009
145500              CONTINUE                                            14480009
145600          WHEN SQLCODE = +100                                     14490009
145700            MOVE ZEROES TO PC-PREV-YR-QTY-WRKD-DC                 14500009
145800                           PC-PREV-YR-CTN-WRKD-DC                 14510009
145900                           PC-PREV-YR-POR-WRKD-DC                 14520009
146000                           PC-PREV-YR-RTL-WRKD-DC                 14530009
146100          WHEN SQLCODE = -305                                     14540024
146200            MOVE ZEROES TO PC-PREV-YR-QTY-WRKD-DC                 14550030
146300                           PC-PREV-YR-CTN-WRKD-DC                 14560030
146400                           PC-PREV-YR-POR-WRKD-DC                 14570030
146500                           PC-PREV-YR-RTL-WRKD-DC                 14580030
146600          WHEN OTHER                                              14590009
146700              MOVE '4320-GET-DC-UNITS-WORKED'  TO DP013-PARAGRAPH 14600009
146800              MOVE 'GETTING PREV UNITS' TO DP013-MESSAGE-TEXT (1) 14610009
146900              MOVE SQLCA   TO DP013-SQLCA                         14620009
147000              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     14630009
147100              SET DP013-DB2-ABEND                                 14640009
147200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14650009
147300              PERFORM DP013-0000-PROCESS-ABEND                    14660009
147400      END-EVALUATE.                                               14670009
147500                                                                  14680009
147600** - COMPUTE VARIANCE                                             14690009
147700      COMPUTE PC-QTY-VRNCE-WRKD-DC = PC-CRNT-YR-QTY-WRKD-DC -     14700030
147800                                     PC-PREV-YR-QTY-WRKD-DC.      14710009
147900      COMPUTE PC-CTN-VRNCE-WRKD-DC = PC-CRNT-YR-CTN-WRKD-DC -     14720030
148000                                     PC-PREV-YR-CTN-WRKD-DC.      14730009
148100      COMPUTE PC-POR-VRNCE-WRKD-DC = PC-CRNT-YR-POR-WRKD-DC -     14740030
148200                                     PC-PREV-YR-POR-WRKD-DC.      14750009
148300      COMPUTE PC-RTL-VRNCE-WRKD-DC = PC-CRNT-YR-RTL-WRKD-DC -     14760030
148400                                     PC-PREV-YR-RTL-WRKD-DC.      14770009
148500                                                                  14780009
148600** - GET CURRENT YEAR'S VERIFIED                                  14790022
148700     EXEC SQL                                                     14800022
148800          SELECT DECIMAL(SUM(UNT_VRFD_QTY),15,0)                  14810022
148900                ,DECIMAL(SUM(CART_VRFD_QTY),15,0)                 14820022
149000                ,DECIMAL(SUM(PO_RCVR_VRFD_QTY),15,0)              14830022
149100                ,DECIMAL(SUM(EXTD_RTL_VRFD_AMT),15,2)             14840022
149200            INTO  :PC-CRNT-YR-QTY-VRFD-DC                         14850022
149300                 ,:PC-CRNT-YR-CTN-VRFD-DC                         14860022
149400                 ,:PC-CRNT-YR-POR-VRFD-DC                         14870022
149500                 ,:PC-CRNT-YR-RTL-VRFD-DC                         14880022
149600           FROM PCT_SUM_VRFD                                      14890022
149700         WHERE BUS_DTE    >= :DK-FROM-DATE                        14900022
149800           AND BUS_DTE    <= :DK-TO-DATE                          14910022
149900           AND OPER_UNT_ID = :DK-OPER-UNT-ID                      14920022
150000     END-EXEC.                                                    14930022
150100      EVALUATE TRUE                                               14940022
150200          WHEN SQLCODE = +0                                       14950022
150300              CONTINUE                                            14960022
150400          WHEN SQLCODE = +100                                     14970022
150500            MOVE ZEROES TO PC-CRNT-YR-QTY-VRFD-DC                 14980022
150600                           PC-CRNT-YR-CTN-VRFD-DC                 14990022
150700                           PC-CRNT-YR-POR-VRFD-DC                 15000022
150800                           PC-CRNT-YR-RTL-VRFD-DC                 15010022
150900          WHEN SQLCODE = -305                                     15020024
151000            MOVE ZEROES TO PC-CRNT-YR-QTY-VRFD-DC                 15030025
151100                           PC-CRNT-YR-CTN-VRFD-DC                 15040025
151200                           PC-CRNT-YR-POR-VRFD-DC                 15050025
151300                           PC-CRNT-YR-RTL-VRFD-DC                 15060025
151400          WHEN OTHER                                              15070022
151500              MOVE '4320-GET-DC-UNITS-WORKED'  TO DP013-PARAGRAPH 15080022
151600              MOVE 'GETTING CRNT VRFD ' TO DP013-MESSAGE-TEXT (1) 15090022
151700              MOVE SQLCA   TO DP013-SQLCA                         15100022
151800              MOVE 'PCT_SUM_VRFD' TO DP013-DB2-TABLE-NAME (1)     15110022
151900              SET DP013-DB2-ABEND                                 15120022
152000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              15130022
152100              PERFORM DP013-0000-PROCESS-ABEND                    15140022
152200      END-EVALUATE.                                               15150022
152300                                                                  15160022
152400** - GET PREVIOUS YEAR'S UNITS                                    15170022
152500     EXEC SQL                                                     15180022
152600          SELECT DECIMAL(SUM(UNT_VRFD_QTY),15,0)                  15190022
152700                ,DECIMAL(SUM(CART_VRFD_QTY),15,0)                 15200022
152800                ,DECIMAL(SUM(PO_RCVR_VRFD_QTY),15,0)              15210022
152900                ,DECIMAL(SUM(EXTD_RTL_VRFD_AMT),15,2)             15220022
153000            INTO  :PC-PREV-YR-QTY-VRFD-DC                         15230022
153100                 ,:PC-PREV-YR-CTN-VRFD-DC                         15240022
153200                 ,:PC-PREV-YR-POR-VRFD-DC                         15250022
153300                 ,:PC-PREV-YR-RTL-VRFD-DC                         15260022
153400           FROM PCT_SUM_VRFD                                      15270022
153500         WHERE BUS_DTE    >= :DK-PREV-FROM-DATE                   15280022
153600           AND BUS_DTE    <= :DK-PREV-TO-DATE                     15290022
153700           AND OPER_UNT_ID = :DK-OPER-UNT-ID                      15300022
153800     END-EXEC.                                                    15310022
153900      EVALUATE TRUE                                               15320022
154000          WHEN SQLCODE = +0                                       15330022
154100              CONTINUE                                            15340022
154200          WHEN SQLCODE = +100                                     15350022
154300            MOVE ZEROES TO PC-PREV-YR-QTY-VRFD-DC                 15360022
154400                           PC-PREV-YR-CTN-VRFD-DC                 15370022
154500                           PC-PREV-YR-POR-VRFD-DC                 15380022
154600                           PC-PREV-YR-RTL-VRFD-DC                 15390022
154700          WHEN SQLCODE = -305                                     15400024
154800            MOVE ZEROES TO PC-PREV-YR-QTY-VRFD-DC                 15410030
154900                           PC-PREV-YR-CTN-VRFD-DC                 15420030
155000                           PC-PREV-YR-POR-VRFD-DC                 15430030
155100                           PC-PREV-YR-RTL-VRFD-DC                 15440030
155200          WHEN OTHER                                              15450022
155300              MOVE '4320-GET-DC-UNITS-WORKED'  TO DP013-PARAGRAPH 15460022
155400              MOVE 'GETTING PREV VRFD ' TO DP013-MESSAGE-TEXT (1) 15470022
155500              MOVE SQLCA   TO DP013-SQLCA                         15480022
155600              MOVE 'PCT_SUM_VRFD' TO DP013-DB2-TABLE-NAME (1)     15490022
155700              SET DP013-DB2-ABEND                                 15500022
155800                  DP013-XCTL-DISPLAY-RESTART TO TRUE              15510022
155900              PERFORM DP013-0000-PROCESS-ABEND                    15520022
156000      END-EVALUATE.                                               15530022
156100                                                                  15540022
156200** - COMPUTE VARIANCE                                             15550022
156300      COMPUTE PC-QTY-VRNCE-VRFD-DC = PC-CRNT-YR-QTY-VRFD-DC -     15560022
156400                                     PC-PREV-YR-QTY-VRFD-DC.      15570022
156500      COMPUTE PC-CTN-VRNCE-VRFD-DC = PC-CRNT-YR-CTN-VRFD-DC -     15580022
156600                                     PC-PREV-YR-CTN-VRFD-DC.      15590022
156700      COMPUTE PC-POR-VRNCE-VRFD-DC = PC-CRNT-YR-POR-VRFD-DC -     15600022
156800                                     PC-PREV-YR-POR-VRFD-DC.      15610022
156900      COMPUTE PC-RTL-VRNCE-VRFD-DC = PC-CRNT-YR-RTL-VRFD-DC -     15620025
157000                                     PC-PREV-YR-RTL-VRFD-DC.      15630022
157100                                                                  15640022
157200*----------------------------------------------------------------*15650022
157300*    RETRIEVE UNITS WORKED FOR ENTIRE PROCESS GROUP WITH OPER     15660022
157400*----------------------------------------------------------------*15670009
157500 4330-GET-PROC-GROUP-UNITS.                                       15680009
157600     MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                    15690078
157700     MOVE ASC-PROCESS-GROUP TO DK-PROCESS-GROUP.                  15700078
157800                                                                  15710078
157900     IF ASC-PROCESS-GROUP = 'MISC  '                              15720078
158000** - GET CURRENT YEAR'S UNITS                                     15730009
158100         EXEC SQL                                                 15740078
158200              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            15750078
158300                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           15760078
158400                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        15770078
158500                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       15780078
158600                INTO  :ASC-CRNT-YR-QTY-WRKD                       15790078
158700                     ,:ASC-CRNT-YR-CTN-WRKD                       15800078
158800                     ,:ASC-CRNT-YR-POR-WRKD                       15810078
158900                     ,:ASC-CRNT-YR-RTL-WRKD                       15820078
159000               FROM PCT_SUM_WRKD A                                15830078
159100             WHERE A.BUS_DTE        >= :DK-FROM-DATE              15840078
159200               AND A.BUS_DTE        <= :DK-TO-DATE                15850078
159300               AND A.OPER_UNT_ID     = :DK-OPER-UNT-ID            15860078
159400               AND NOT EXISTS                                     15870078
159500                   (SELECT *                                      15880078
159600              FROM  PCT_PRC_AREA_ASSN B                           15890078
159700             WHERE B.OPER_UNT_ID     = A.OPER_UNT_ID              15900078
159800               AND B.PRCG_AREA_CDE   = A.PRCG_AREA_CDE)           15910078
159900         END-EXEC                                                 15920078
160000          EVALUATE TRUE                                           15930078
160100              WHEN SQLCODE = +0                                   15940078
160200                  CONTINUE                                        15950078
160300              WHEN SQLCODE = +100                                 15960078
160400                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               15970078
160500                               ASC-CRNT-YR-CTN-WRKD               15980078
160600                               ASC-CRNT-YR-POR-WRKD               15990078
160700                               ASC-CRNT-YR-RTL-WRKD               16000078
160800              WHEN SQLCODE = -305                                 16010078
160900                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               16020078
161000                               ASC-CRNT-YR-CTN-WRKD               16030078
161100                               ASC-CRNT-YR-POR-WRKD               16040078
161200                               ASC-CRNT-YR-RTL-WRKD               16050078
161300              WHEN OTHER                                          16060078
161400                  MOVE '4330-GET-PROC-GROUP-UNITS' TO             16070078
161500                                                  DP013-PARAGRAPH 16080078
161600                  MOVE 'GETTING CRNT UNITS' TO                    16090078
161700                                           DP013-MESSAGE-TEXT (1) 16100078
161800                  MOVE SQLCA   TO DP013-SQLCA                     16110078
161900                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 16120078
162000                  SET DP013-DB2-ABEND                             16130078
162100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          16140078
162200                  PERFORM DP013-0000-PROCESS-ABEND                16150078
162300          END-EVALUATE                                            16160078
162400                                                                  16170009
162500** - GET PREVIOUS YEAR'S UNITS                                    16180009
162600         EXEC SQL                                                 16190078
162700              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            16200078
162800                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           16210078
162900                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        16220078
163000                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       16230078
163100                INTO  :ASC-PREV-YR-QTY-WRKD                       16240078
163200                     ,:ASC-PREV-YR-CTN-WRKD                       16250078
163300                     ,:ASC-PREV-YR-POR-WRKD                       16260078
163400                     ,:ASC-PREV-YR-RTL-WRKD                       16270078
163500               FROM PCT_SUM_WRKD A                                16280078
163600             WHERE A.BUS_DTE        >= :DK-PREV-FROM-DATE         16290078
163700               AND A.BUS_DTE        <= :DK-PREV-TO-DATE           16300078
163800               AND A.OPER_UNT_ID     = :DK-OPER-UNT-ID            16310078
163900               AND NOT EXISTS                                     16320078
164000                   (SELECT *                                      16330078
164100              FROM  PCT_PRC_AREA_ASSN B                           16340078
164200             WHERE B.OPER_UNT_ID     = A.OPER_UNT_ID              16350078
164300               AND B.PRCG_AREA_CDE   = A.PRCG_AREA_CDE)           16360079
164400          END-EXEC                                                16370078
164500          EVALUATE TRUE                                           16380078
164600              WHEN SQLCODE = +0                                   16390078
164700                  CONTINUE                                        16400078
164800              WHEN SQLCODE = +100                                 16410078
164900                MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD               16420078
165000                               ASC-PREV-YR-CTN-WRKD               16430078
165100                               ASC-PREV-YR-POR-WRKD               16440078
165200                               ASC-PREV-YR-RTL-WRKD               16450078
165300              WHEN SQLCODE = -305                                 16460078
165400                MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD               16470078
165500                               ASC-PREV-YR-CTN-WRKD               16480078
165600                               ASC-PREV-YR-POR-WRKD               16490078
165700                               ASC-PREV-YR-RTL-WRKD               16500078
165800              WHEN OTHER                                          16510078
165900                  MOVE '4330-GET-PROC-GROUP-UNITS' TO             16520078
166000                                                  DP013-PARAGRAPH 16530078
166100                  MOVE 'GETTING PREV UNITS' TO                    16540078
166200                                           DP013-MESSAGE-TEXT (1) 16550078
166300                  MOVE SQLCA   TO DP013-SQLCA                     16560078
166400                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 16570078
166500                  SET DP013-DB2-ABEND                             16580078
166600                      DP013-XCTL-DISPLAY-RESTART TO TRUE          16590078
166700                  PERFORM DP013-0000-PROCESS-ABEND                16600078
166800          END-EVALUATE                                            16610078
166900                                                                  16620078
167000      ELSE                                                        16630078
167100                                                                  16640009
167200** - GET CURRENT YEAR'S UNITS                                     16650078
167300         EXEC SQL                                                 16660078
167400              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            16670078
167500                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           16680078
167600                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        16690078
167700                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       16700078
167800                INTO  :ASC-CRNT-YR-QTY-WRKD                       16710078
167900                     ,:ASC-CRNT-YR-CTN-WRKD                       16720078
168000                     ,:ASC-CRNT-YR-POR-WRKD                       16730078
168100                     ,:ASC-CRNT-YR-RTL-WRKD                       16740078
168200               FROM PCT_SUM_WRKD A                                16750078
168300                   ,PCT_PRC_AREA_ASSN B                           16760078
168400             WHERE A.BUS_DTE        >= :DK-FROM-DATE              16770078
168500               AND A.BUS_DTE        <= :DK-TO-DATE                16780078
168600               AND A.OPER_UNT_ID     = :DK-OPER-UNT-ID            16790078
168700               AND A.OPER_UNT_ID     = B.OPER_UNT_ID              16800078
168800               AND A.PRCG_AREA_CDE   = B.PRCG_AREA_CDE            16810078
168900               AND B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP          16820078
169000         END-EXEC                                                 16830078
169100          EVALUATE TRUE                                           16840078
169200              WHEN SQLCODE = +0                                   16850078
169300                  CONTINUE                                        16860078
169400              WHEN SQLCODE = +100                                 16870078
169500                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               16880078
169600                               ASC-CRNT-YR-CTN-WRKD               16890078
169700                               ASC-CRNT-YR-POR-WRKD               16900078
169800                               ASC-CRNT-YR-RTL-WRKD               16910078
169900              WHEN SQLCODE = -305                                 16920078
170000                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               16930078
170100                               ASC-CRNT-YR-CTN-WRKD               16940078
170200                               ASC-CRNT-YR-POR-WRKD               16950078
170300                               ASC-CRNT-YR-RTL-WRKD               16960078
170400              WHEN OTHER                                          16970078
170500                  MOVE '4330-GET-PROC-GROUP-UNITS' TO             16980078
170600                                                  DP013-PARAGRAPH 16990078
170700                  MOVE 'GETTING CRNT UNITS' TO                    17000078
170800                                           DP013-MESSAGE-TEXT (1) 17010078
170900                  MOVE SQLCA   TO DP013-SQLCA                     17020078
171000                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 17030078
171100                  SET DP013-DB2-ABEND                             17040078
171200                      DP013-XCTL-DISPLAY-RESTART TO TRUE          17050078
171300                  PERFORM DP013-0000-PROCESS-ABEND                17060078
171400          END-EVALUATE                                            17070078
171500                                                                  17080078
171600** - GET PREVIOUS YEAR'S UNITS                                    17090078
171700         EXEC SQL                                                 17100078
171800              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            17110078
171900                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           17120078
172000                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        17130078
172100                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       17140078
172200                INTO  :ASC-PREV-YR-QTY-WRKD                       17150078
172300                     ,:ASC-PREV-YR-CTN-WRKD                       17160078
172400                     ,:ASC-PREV-YR-POR-WRKD                       17170078
172500                     ,:ASC-PREV-YR-RTL-WRKD                       17180078
172600               FROM PCT_SUM_WRKD A                                17190078
172700                   ,PCT_PRC_AREA_ASSN B                           17200078
172800             WHERE A.BUS_DTE        >= :DK-PREV-FROM-DATE         17210078
172900               AND A.BUS_DTE        <= :DK-PREV-TO-DATE           17220078
173000               AND A.OPER_UNT_ID     = :DK-OPER-UNT-ID            17230078
173100               AND A.OPER_UNT_ID     = B.OPER_UNT_ID              17240078
173200               AND A.PRCG_AREA_CDE   = B.PRCG_AREA_CDE            17250078
173300               AND B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP          17260078
173400          END-EXEC                                                17270078
173500          EVALUATE TRUE                                           17280078
173600              WHEN SQLCODE = +0                                   17290078
173700                  CONTINUE                                        17300078
173800              WHEN SQLCODE = +100                                 17310078
173900                  MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD             17320078
174000                                 ASC-PREV-YR-CTN-WRKD             17330078
174100                                 ASC-PREV-YR-POR-WRKD             17340078
174200                                 ASC-PREV-YR-RTL-WRKD             17350078
174300              WHEN SQLCODE = -305                                 17360078
174400                  MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD             17370078
174500                                 ASC-PREV-YR-CTN-WRKD             17380078
174600                                 ASC-PREV-YR-POR-WRKD             17390078
174700                                 ASC-PREV-YR-RTL-WRKD             17400078
174800              WHEN OTHER                                          17410078
174900                  MOVE '4330-GET-PROC-GROUP-UNITS' TO             17420078
175000                                                  DP013-PARAGRAPH 17430078
175100                  MOVE 'GETTING PREV UNITS' TO                    17440078
175200                                           DP013-MESSAGE-TEXT (1) 17450078
175300                  MOVE SQLCA   TO DP013-SQLCA                     17460078
175400                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 17470078
175500                  SET DP013-DB2-ABEND                             17480078
175600                      DP013-XCTL-DISPLAY-RESTART TO TRUE          17490078
175700                  PERFORM DP013-0000-PROCESS-ABEND                17500078
175800          END-EVALUATE                                            17510078
175900      END-IF.                                                     17520078
176000                                                                  17530078
176100** - COMPUTE VARIANCE                                             17540078
176200      COMPUTE ASC-QTY-VRNCE-WRKD = ASC-CRNT-YR-QTY-WRKD -         17550009
176300                                   ASC-PREV-YR-QTY-WRKD.          17560009
176400      COMPUTE ASC-CTN-VRNCE-WRKD = ASC-CRNT-YR-CTN-WRKD -         17570009
176500                                   ASC-PREV-YR-CTN-WRKD.          17580009
176600      COMPUTE ASC-POR-VRNCE-WRKD = ASC-CRNT-YR-POR-WRKD -         17590009
176700                                   ASC-PREV-YR-POR-WRKD.          17600009
176800      COMPUTE ASC-RTL-VRNCE-WRKD = ASC-CRNT-YR-RTL-WRKD -         17610009
176900                                   ASC-PREV-YR-RTL-WRKD.          17620009
177000                                                                  17630009
177100** - MOVE ZEROES TO VERIFED                                       17640022
177200      MOVE ZEROES TO  ASC-QTY-VRNCE-VRFD                          17650022
177300                      ASC-CRNT-YR-QTY-VRFD                        17660022
177400                      ASC-PREV-YR-QTY-VRFD                        17670022
177500                      ASC-CTN-VRNCE-VRFD                          17680022
177600                      ASC-CRNT-YR-CTN-VRFD                        17690022
177700                      ASC-PREV-YR-CTN-VRFD                        17700022
177800                      ASC-POR-VRNCE-VRFD                          17710022
177900                      ASC-CRNT-YR-POR-VRFD                        17720022
178000                      ASC-PREV-YR-POR-VRFD                        17730022
178100                      ASC-RTL-VRNCE-VRFD                          17740022
178200                      ASC-CRNT-YR-RTL-VRFD                        17750022
178300                      ASC-PREV-YR-RTL-VRFD.                       17760022
178400      MOVE ' - NOT APPLICABLE - ' TO ASC-TITLE4.                  17770061
178500                                                                  17780022
178600*----------------------------------------------------------------*17790022
178700*    RETRIEVE UNITS WORKED FOR ENTIRE PROCESS GROUP               17800009
178800*----------------------------------------------------------------*17810009
178900 4335-GET-PROC-GROUP-UNITS.                                       17820009
179000     MOVE ASC-PROCESS-GROUP TO DK-PROCESS-GROUP.                  17830078
179100                                                                  17840009
179200     IF ASC-PROCESS-GROUP = 'MISC  '                              17850078
179300** - GET CURRENT YEAR'S UNITS                                     17860078
179400         EXEC SQL                                                 17870078
179500              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            17880078
179600                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           17890078
179700                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        17900078
179800                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       17910078
179900                INTO  :ASC-CRNT-YR-QTY-WRKD                       17920078
180000                     ,:ASC-CRNT-YR-CTN-WRKD                       17930078
180100                     ,:ASC-CRNT-YR-POR-WRKD                       17940078
180200                     ,:ASC-CRNT-YR-RTL-WRKD                       17950078
180300               FROM PCT_SUM_WRKD A                                17960078
180400             WHERE A.BUS_DTE        >= :DK-FROM-DATE              17970078
180500               AND A.BUS_DTE        <= :DK-TO-DATE                17980078
180600               AND NOT EXISTS                                     17990078
180700                   (SELECT *                                      18000078
180800              FROM  PCT_PRC_AREA_ASSN B                           18010078
180900             WHERE B.OPER_UNT_ID     = A.OPER_UNT_ID              18020078
181000               AND B.PRCG_AREA_CDE   = A.PRCG_AREA_CDE)           18030078
181100         END-EXEC                                                 18040078
181200          EVALUATE TRUE                                           18050078
181300              WHEN SQLCODE = +0                                   18060078
181400                  CONTINUE                                        18070078
181500              WHEN SQLCODE = +100                                 18080078
181600                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               18090078
181700                               ASC-CRNT-YR-CTN-WRKD               18100078
181800                               ASC-CRNT-YR-POR-WRKD               18110078
181900                               ASC-CRNT-YR-RTL-WRKD               18120078
182000              WHEN SQLCODE = -305                                 18130078
182100                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               18140078
182200                               ASC-CRNT-YR-CTN-WRKD               18150078
182300                               ASC-CRNT-YR-POR-WRKD               18160078
182400                               ASC-CRNT-YR-RTL-WRKD               18170078
182500              WHEN OTHER                                          18180078
182600                  MOVE '4335-GET-PROC-GROUP-UNITS' TO             18190078
182700                                                  DP013-PARAGRAPH 18200078
182800                  MOVE 'GETTING CRNT UNITS' TO                    18210078
182900                                           DP013-MESSAGE-TEXT (1) 18220078
183000                  MOVE SQLCA   TO DP013-SQLCA                     18230078
183100                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 18240078
183200                  SET DP013-DB2-ABEND                             18250078
183300                      DP013-XCTL-DISPLAY-RESTART TO TRUE          18260078
183400                  PERFORM DP013-0000-PROCESS-ABEND                18270078
183500          END-EVALUATE                                            18280078
183600                                                                  18290078
183700** - GET PREVIOUS YEAR'S UNITS                                    18300078
183800         EXEC SQL                                                 18310078
183900              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            18320078
184000                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           18330078
184100                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        18340078
184200                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       18350078
184300                INTO  :ASC-PREV-YR-QTY-WRKD                       18360078
184400                     ,:ASC-PREV-YR-CTN-WRKD                       18370078
184500                     ,:ASC-PREV-YR-POR-WRKD                       18380078
184600                     ,:ASC-PREV-YR-RTL-WRKD                       18390078
184700               FROM PCT_SUM_WRKD A                                18400078
184800             WHERE A.BUS_DTE        >= :DK-PREV-FROM-DATE         18410078
184900               AND A.BUS_DTE        <= :DK-PREV-TO-DATE           18420078
185000               AND NOT EXISTS                                     18430078
185100                   (SELECT *                                      18440078
185200              FROM  PCT_PRC_AREA_ASSN B                           18450078
185300             WHERE B.OPER_UNT_ID     = A.OPER_UNT_ID              18460078
185400               AND B.PRCG_AREA_CDE   = A.PRCG_AREA_CDE)           18470079
185500          END-EXEC                                                18480078
185600          EVALUATE TRUE                                           18490078
185700              WHEN SQLCODE = +0                                   18500078
185800                  CONTINUE                                        18510078
185900              WHEN SQLCODE = +100                                 18520078
186000                MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD               18530078
186100                               ASC-PREV-YR-CTN-WRKD               18540078
186200                               ASC-PREV-YR-POR-WRKD               18550078
186300                               ASC-PREV-YR-RTL-WRKD               18560078
186400              WHEN SQLCODE = -305                                 18570078
186500                MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD               18580078
186600                               ASC-PREV-YR-CTN-WRKD               18590078
186700                               ASC-PREV-YR-POR-WRKD               18600078
186800                               ASC-PREV-YR-RTL-WRKD               18610078
186900              WHEN OTHER                                          18620078
187000                  MOVE '4335-GET-PROC-GROUP-UNITS' TO             18630078
187100                                                  DP013-PARAGRAPH 18640078
187200                  MOVE 'GETTING PREV UNITS' TO                    18650078
187300                                           DP013-MESSAGE-TEXT (1) 18660078
187400                  MOVE SQLCA   TO DP013-SQLCA                     18670078
187500                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 18680078
187600                  SET DP013-DB2-ABEND                             18690078
187700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          18700078
187800                  PERFORM DP013-0000-PROCESS-ABEND                18710078
187900          END-EVALUATE                                            18720078
188000                                                                  18730078
188100      ELSE                                                        18740078
188200                                                                  18750078
188300** - GET CURRENT YEAR'S UNITS                                     18760078
188400         EXEC SQL                                                 18770078
188500              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            18780078
188600                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           18790078
188700                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        18800078
188800                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       18810078
188900                INTO  :ASC-CRNT-YR-QTY-WRKD                       18820078
189000                     ,:ASC-CRNT-YR-CTN-WRKD                       18830078
189100                     ,:ASC-CRNT-YR-POR-WRKD                       18840078
189200                     ,:ASC-CRNT-YR-RTL-WRKD                       18850078
189300               FROM PCT_SUM_WRKD A                                18860078
189400                   ,PCT_PRC_AREA_ASSN B                           18870078
189500             WHERE A.BUS_DTE        >= :DK-FROM-DATE              18880078
189600               AND A.BUS_DTE        <= :DK-TO-DATE                18890078
189700               AND A.OPER_UNT_ID     = B.OPER_UNT_ID              18900078
189800               AND A.PRCG_AREA_CDE   = B.PRCG_AREA_CDE            18910078
189900               AND B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP          18920078
190000         END-EXEC                                                 18930078
190100          EVALUATE TRUE                                           18940078
190200              WHEN SQLCODE = +0                                   18950078
190300                  CONTINUE                                        18960078
190400              WHEN SQLCODE = +100                                 18970078
190500                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               18980078
190600                               ASC-CRNT-YR-CTN-WRKD               18990078
190700                               ASC-CRNT-YR-POR-WRKD               19000078
190800                               ASC-CRNT-YR-RTL-WRKD               19010078
190900              WHEN SQLCODE = -305                                 19020078
191000                MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD               19030078
191100                               ASC-CRNT-YR-CTN-WRKD               19040078
191200                               ASC-CRNT-YR-POR-WRKD               19050078
191300                               ASC-CRNT-YR-RTL-WRKD               19060078
191400              WHEN OTHER                                          19070078
191500                  MOVE '4335-GET-PROC-GROUP-UNITS' TO             19080078
191600                                                  DP013-PARAGRAPH 19090078
191700                  MOVE 'GETTING CRNT UNITS' TO                    19100078
191800                                           DP013-MESSAGE-TEXT (1) 19110078
191900                  MOVE SQLCA   TO DP013-SQLCA                     19120078
192000                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 19130078
192100                  SET DP013-DB2-ABEND                             19140078
192200                      DP013-XCTL-DISPLAY-RESTART TO TRUE          19150078
192300                  PERFORM DP013-0000-PROCESS-ABEND                19160078
192400          END-EVALUATE                                            19170078
192500                                                                  19180078
192600** - GET PREVIOUS YEAR'S UNITS                                    19190078
192700         EXEC SQL                                                 19200078
192800              SELECT DECIMAL(SUM(A.UNT_WRKD_QTY),15,0)            19210078
192900                    ,DECIMAL(SUM(A.CART_WRKD_QTY),15,0)           19220078
193000                    ,DECIMAL(SUM(A.PO_RCVR_WRKD_QTY),15,0)        19230078
193100                    ,DECIMAL(SUM(A.EXTD_RTL_WRKD_AMT),15,2)       19240078
193200                INTO  :ASC-PREV-YR-QTY-WRKD                       19250078
193300                     ,:ASC-PREV-YR-CTN-WRKD                       19260078
193400                     ,:ASC-PREV-YR-POR-WRKD                       19270078
193500                     ,:ASC-PREV-YR-RTL-WRKD                       19280078
193600               FROM PCT_SUM_WRKD A                                19290078
193700                   ,PCT_PRC_AREA_ASSN B                           19300078
193800             WHERE A.BUS_DTE        >= :DK-PREV-FROM-DATE         19310078
193900               AND A.BUS_DTE        <= :DK-PREV-TO-DATE           19320078
194000               AND A.OPER_UNT_ID     = B.OPER_UNT_ID              19330078
194100               AND A.PRCG_AREA_CDE   = B.PRCG_AREA_CDE            19340078
194200               AND B.PRC_AREA_GP_CDE = :DK-PROCESS-GROUP          19350078
194300          END-EXEC                                                19360078
194400          EVALUATE TRUE                                           19370078
194500              WHEN SQLCODE = +0                                   19380078
194600                  CONTINUE                                        19390078
194700              WHEN SQLCODE = +100                                 19400078
194800                  MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD             19410078
194900                                 ASC-PREV-YR-CTN-WRKD             19420078
195000                                 ASC-PREV-YR-POR-WRKD             19430078
195100                                 ASC-PREV-YR-RTL-WRKD             19440078
195200              WHEN SQLCODE = -305                                 19450078
195300                  MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD             19460078
195400                                 ASC-PREV-YR-CTN-WRKD             19470078
195500                                 ASC-PREV-YR-POR-WRKD             19480078
195600                                 ASC-PREV-YR-RTL-WRKD             19490078
195700              WHEN OTHER                                          19500078
195800                  MOVE '4335-GET-PROC-GROUP-UNITS' TO             19510078
195900                                                  DP013-PARAGRAPH 19520078
196000                  MOVE 'GETTING PREV UNITS' TO                    19530078
196100                                           DP013-MESSAGE-TEXT (1) 19540078
196200                  MOVE SQLCA   TO DP013-SQLCA                     19550078
196300                  MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1) 19560078
196400                  SET DP013-DB2-ABEND                             19570078
196500                      DP013-XCTL-DISPLAY-RESTART TO TRUE          19580078
196600                  PERFORM DP013-0000-PROCESS-ABEND                19590078
196700          END-EVALUATE                                            19600078
196800      END-IF.                                                     19610078
196900** - COMPUTE VARIANCE                                             19620009
197000      COMPUTE ASC-QTY-VRNCE-WRKD = ASC-CRNT-YR-QTY-WRKD -         19630009
197100                                   ASC-PREV-YR-QTY-WRKD.          19640009
197200      COMPUTE ASC-CTN-VRNCE-WRKD = ASC-CRNT-YR-CTN-WRKD -         19650009
197300                                   ASC-PREV-YR-CTN-WRKD.          19660009
197400      COMPUTE ASC-POR-VRNCE-WRKD = ASC-CRNT-YR-POR-WRKD -         19670009
197500                                   ASC-PREV-YR-POR-WRKD.          19680009
197600      COMPUTE ASC-RTL-VRNCE-WRKD = ASC-CRNT-YR-RTL-WRKD -         19690009
197700                                   ASC-PREV-YR-RTL-WRKD.          19700009
197800                                                                  19710009
197900** - MOVE ZEROES TO VERIFED                                       19720022
198000      MOVE ZEROES TO  ASC-QTY-VRNCE-VRFD                          19730022
198100                      ASC-CRNT-YR-QTY-VRFD                        19740022
198200                      ASC-PREV-YR-QTY-VRFD                        19750022
198300                      ASC-CTN-VRNCE-VRFD                          19760022
198400                      ASC-CRNT-YR-CTN-VRFD                        19770022
198500                      ASC-PREV-YR-CTN-VRFD                        19780022
198600                      ASC-POR-VRNCE-VRFD                          19790022
198700                      ASC-CRNT-YR-POR-VRFD                        19800022
198800                      ASC-PREV-YR-POR-VRFD                        19810022
198900                      ASC-RTL-VRNCE-VRFD                          19820022
199000                      ASC-CRNT-YR-RTL-VRFD                        19830022
199100                      ASC-PREV-YR-RTL-VRFD.                       19840022
199200      MOVE ' - NOT APPLICABLE - ' TO ASC-TITLE4.                  19850059
199300                                                                  19860022
199400*----------------------------------------------------------------*19870009
199500*    RETRIEVE UNITS WORKED FOR ENTIRE PROCESS AREA WITH OPER      19880061
199600*----------------------------------------------------------------*19890009
199700 4340-GET-PROC-AREA-UNITS.                                        19900009
199800** - GET CURRENT YEAR'S UNITS                                     19910009
199900     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     19920009
200000     MOVE ASC-PROCESS-AREA TO DK-PROCESS-AREA.                    19930009
200100     EXEC SQL                                                     19940009
200200          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  19950009
200300                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 19960009
200400                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              19970009
200500                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             19980011
200600            INTO  :ASC-CRNT-YR-QTY-WRKD                           19990009
200700                 ,:ASC-CRNT-YR-CTN-WRKD                           20000009
200800                 ,:ASC-CRNT-YR-POR-WRKD                           20010009
200900                 ,:ASC-CRNT-YR-RTL-WRKD                           20020009
201000           FROM PCT_SUM_WRKD                                      20030009
201100         WHERE BUS_DTE        >= :DK-FROM-DATE                    20040009
201200           AND BUS_DTE        <= :DK-TO-DATE                      20050009
201300           AND OPER_UNT_ID     = :DK-OPER-UNT-ID                  20060009
201400           AND PRCG_AREA_CDE   = :DK-PROCESS-AREA                 20070009
201500     END-EXEC.                                                    20080009
201600      EVALUATE TRUE                                               20090009
201700          WHEN SQLCODE = +0                                       20100009
201800              CONTINUE                                            20110009
201900          WHEN SQLCODE = +100                                     20120009
202000            MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD                   20130009
202100                           ASC-CRNT-YR-CTN-WRKD                   20140009
202200                           ASC-CRNT-YR-POR-WRKD                   20150009
202300                           ASC-CRNT-YR-RTL-WRKD                   20160009
202400          WHEN SQLCODE = -305                                     20170024
202500            MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD                   20180024
202600                           ASC-CRNT-YR-CTN-WRKD                   20190024
202700                           ASC-CRNT-YR-POR-WRKD                   20200024
202800                           ASC-CRNT-YR-RTL-WRKD                   20210024
202900          WHEN OTHER                                              20220009
203000              MOVE '4340-GET-PROC-AREA-UNITS ' TO DP013-PARAGRAPH 20230009
203100              MOVE 'GETTING CRNT UNITS' TO DP013-MESSAGE-TEXT (1) 20240009
203200              MOVE SQLCA   TO DP013-SQLCA                         20250009
203300              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     20260009
203400              SET DP013-DB2-ABEND                                 20270009
203500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              20280009
203600              PERFORM DP013-0000-PROCESS-ABEND                    20290009
203700      END-EVALUATE.                                               20300009
203800                                                                  20310009
203900** - GET PREVIOUS YEAR'S UNITS                                    20320009
204000     EXEC SQL                                                     20330009
204100          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  20340009
204200                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 20350009
204300                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              20360009
204400                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             20370011
204500            INTO  :ASC-PREV-YR-QTY-WRKD                           20380009
204600                 ,:ASC-PREV-YR-CTN-WRKD                           20390009
204700                 ,:ASC-PREV-YR-POR-WRKD                           20400009
204800                 ,:ASC-PREV-YR-RTL-WRKD                           20410009
204900           FROM PCT_SUM_WRKD                                      20420009
205000         WHERE BUS_DTE        >= :DK-PREV-FROM-DATE               20430077
205100           AND BUS_DTE        <= :DK-PREV-TO-DATE                 20440077
205200           AND OPER_UNT_ID     = :DK-OPER-UNT-ID                  20450009
205300           AND PRCG_AREA_CDE   = :DK-PROCESS-AREA                 20460009
205400     END-EXEC.                                                    20470009
205500      EVALUATE TRUE                                               20480009
205600          WHEN SQLCODE = +0                                       20490009
205700              CONTINUE                                            20500009
205800          WHEN SQLCODE = +100                                     20510009
205900            MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD                   20520009
206000                           ASC-PREV-YR-CTN-WRKD                   20530009
206100                           ASC-PREV-YR-POR-WRKD                   20540009
206200                           ASC-PREV-YR-RTL-WRKD                   20550009
206300          WHEN SQLCODE = -305                                     20560024
206400            MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD                   20570024
206500                           ASC-PREV-YR-CTN-WRKD                   20580024
206600                           ASC-PREV-YR-POR-WRKD                   20590024
206700                           ASC-PREV-YR-RTL-WRKD                   20600024
206800          WHEN OTHER                                              20610009
206900              MOVE '4340-GET-PROC-AREA-UNITS ' TO DP013-PARAGRAPH 20620009
207000              MOVE 'GETTING PREV UNITS' TO DP013-MESSAGE-TEXT (1) 20630009
207100              MOVE SQLCA   TO DP013-SQLCA                         20640009
207200              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     20650009
207300              SET DP013-DB2-ABEND                                 20660009
207400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              20670009
207500              PERFORM DP013-0000-PROCESS-ABEND                    20680009
207600      END-EVALUATE.                                               20690009
207700                                                                  20700009
207800** - COMPUTE VARIANCE                                             20710009
207900      COMPUTE ASC-QTY-VRNCE-WRKD = ASC-CRNT-YR-QTY-WRKD -         20720009
208000                                   ASC-PREV-YR-QTY-WRKD.          20730009
208100      COMPUTE ASC-CTN-VRNCE-WRKD = ASC-CRNT-YR-CTN-WRKD -         20740009
208200                                   ASC-PREV-YR-CTN-WRKD.          20750009
208300      COMPUTE ASC-POR-VRNCE-WRKD = ASC-CRNT-YR-POR-WRKD -         20760009
208400                                   ASC-PREV-YR-POR-WRKD.          20770009
208500      COMPUTE ASC-RTL-VRNCE-WRKD = ASC-CRNT-YR-RTL-WRKD -         20780009
208600                                   ASC-PREV-YR-RTL-WRKD.          20790009
208700                                                                  20800009
208800** - MOVE ZEROES TO VERIFED                                       20810022
208900      MOVE ZEROES TO  ASC-QTY-VRNCE-VRFD                          20820022
209000                      ASC-CRNT-YR-QTY-VRFD                        20830022
209100                      ASC-PREV-YR-QTY-VRFD                        20840022
209200                      ASC-CTN-VRNCE-VRFD                          20850022
209300                      ASC-CRNT-YR-CTN-VRFD                        20860022
209400                      ASC-PREV-YR-CTN-VRFD                        20870022
209500                      ASC-POR-VRNCE-VRFD                          20880022
209600                      ASC-CRNT-YR-POR-VRFD                        20890022
209700                      ASC-PREV-YR-POR-VRFD                        20900022
209800                      ASC-RTL-VRNCE-VRFD                          20910022
209900                      ASC-CRNT-YR-RTL-VRFD                        20920022
210000                      ASC-PREV-YR-RTL-VRFD.                       20930022
210100      MOVE ' - NOT APPLICABLE - ' TO ASC-TITLE4.                  20940059
210200                                                                  20950022
210300*----------------------------------------------------------------*20960009
210400*    RETRIEVE UNITS WORKED FOR ENTIRE PROCESS AREA                20970009
210500*----------------------------------------------------------------*20980009
210600 4345-GET-PROC-AREA-UNITS.                                        20990009
210700** - GET CURRENT YEAR'S UNITS                                     21000009
210800     MOVE ASC-PROCESS-AREA TO DK-PROCESS-AREA.                    21010009
210900     EXEC SQL                                                     21020009
211000          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  21030009
211100                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 21040009
211200                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              21050009
211300                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             21060011
211400            INTO  :ASC-CRNT-YR-QTY-WRKD                           21070009
211500                 ,:ASC-CRNT-YR-CTN-WRKD                           21080009
211600                 ,:ASC-CRNT-YR-POR-WRKD                           21090009
211700                 ,:ASC-CRNT-YR-RTL-WRKD                           21100009
211800           FROM PCT_SUM_WRKD                                      21110009
211900         WHERE BUS_DTE        >= :DK-FROM-DATE                    21120009
212000           AND BUS_DTE        <= :DK-TO-DATE                      21130009
212100           AND PRCG_AREA_CDE   = :DK-PROCESS-AREA                 21140009
212200     END-EXEC.                                                    21150009
212300      EVALUATE TRUE                                               21160009
212400          WHEN SQLCODE = +0                                       21170009
212500              CONTINUE                                            21180009
212600          WHEN SQLCODE = +100                                     21190009
212700            MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD                   21200009
212800                           ASC-CRNT-YR-CTN-WRKD                   21210009
212900                           ASC-CRNT-YR-POR-WRKD                   21220009
213000                           ASC-CRNT-YR-RTL-WRKD                   21230009
213100          WHEN SQLCODE = -305                                     21240024
213200            MOVE ZEROES TO ASC-CRNT-YR-QTY-WRKD                   21250024
213300                           ASC-CRNT-YR-CTN-WRKD                   21260024
213400                           ASC-CRNT-YR-POR-WRKD                   21270024
213500                           ASC-CRNT-YR-RTL-WRKD                   21280024
213600          WHEN OTHER                                              21290009
213700              MOVE '4345-GET-PROC-AREA-UNITS ' TO DP013-PARAGRAPH 21300009
213800              MOVE 'GETTING CRNT UNITS' TO DP013-MESSAGE-TEXT (1) 21310009
213900              MOVE SQLCA   TO DP013-SQLCA                         21320009
214000              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     21330009
214100              SET DP013-DB2-ABEND                                 21340009
214200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              21350009
214300              PERFORM DP013-0000-PROCESS-ABEND                    21360009
214400      END-EVALUATE.                                               21370009
214500                                                                  21380009
214600** - GET PREVIOUS YEAR'S UNITS                                    21390009
214700     EXEC SQL                                                     21400009
214800          SELECT DECIMAL(SUM(UNT_WRKD_QTY),15,0)                  21410009
214900                ,DECIMAL(SUM(CART_WRKD_QTY),15,0)                 21420009
215000                ,DECIMAL(SUM(PO_RCVR_WRKD_QTY),15,0)              21430009
215100                ,DECIMAL(SUM(EXTD_RTL_WRKD_AMT),15,2)             21440011
215200            INTO  :ASC-PREV-YR-QTY-WRKD                           21450009
215300                 ,:ASC-PREV-YR-CTN-WRKD                           21460009
215400                 ,:ASC-PREV-YR-POR-WRKD                           21470009
215500                 ,:ASC-PREV-YR-RTL-WRKD                           21480009
215600           FROM PCT_SUM_WRKD                                      21490009
215700         WHERE BUS_DTE        >= :DK-PREV-FROM-DATE               21500077
215800           AND BUS_DTE        <= :DK-PREV-TO-DATE                 21510077
215900           AND PRCG_AREA_CDE   = :DK-PROCESS-AREA                 21520009
216000     END-EXEC.                                                    21530009
216100      EVALUATE TRUE                                               21540009
216200          WHEN SQLCODE = +0                                       21550009
216300              CONTINUE                                            21560009
216400          WHEN SQLCODE = +100                                     21570009
216500            MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD                   21580009
216600                           ASC-PREV-YR-CTN-WRKD                   21590009
216700                           ASC-PREV-YR-POR-WRKD                   21600009
216800                           ASC-PREV-YR-RTL-WRKD                   21610009
216900          WHEN SQLCODE = -305                                     21620024
217000            MOVE ZEROES TO ASC-PREV-YR-QTY-WRKD                   21630025
217100                           ASC-PREV-YR-CTN-WRKD                   21640025
217200                           ASC-PREV-YR-POR-WRKD                   21650025
217300                           ASC-PREV-YR-RTL-WRKD                   21660025
217400          WHEN OTHER                                              21670009
217500              MOVE '4345-GET-PROC-AREA-UNITS ' TO DP013-PARAGRAPH 21680009
217600              MOVE 'GETTING PREV UNITS' TO DP013-MESSAGE-TEXT (1) 21690009
217700              MOVE SQLCA   TO DP013-SQLCA                         21700009
217800              MOVE 'PCT_SUM_WRKD' TO DP013-DB2-TABLE-NAME (1)     21710009
217900              SET DP013-DB2-ABEND                                 21720009
218000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              21730009
218100              PERFORM DP013-0000-PROCESS-ABEND                    21740009
218200      END-EVALUATE.                                               21750009
218300                                                                  21760009
218400** - COMPUTE VARIANCE                                             21770009
218500      COMPUTE ASC-QTY-VRNCE-WRKD = ASC-CRNT-YR-QTY-WRKD -         21780009
218600                                   ASC-PREV-YR-QTY-WRKD.          21790009
218700      COMPUTE ASC-CTN-VRNCE-WRKD = ASC-CRNT-YR-CTN-WRKD -         21800009
218800                                   ASC-PREV-YR-CTN-WRKD.          21810009
218900      COMPUTE ASC-POR-VRNCE-WRKD = ASC-CRNT-YR-POR-WRKD -         21820009
219000                                   ASC-PREV-YR-POR-WRKD.          21830009
219100      COMPUTE ASC-RTL-VRNCE-WRKD = ASC-CRNT-YR-RTL-WRKD -         21840009
219200                                   ASC-PREV-YR-RTL-WRKD.          21850009
219300                                                                  21860009
219400** - MOVE ZEROES TO VERIFED                                       21870022
219500      MOVE ZEROES TO  ASC-QTY-VRNCE-VRFD                          21880022
219600                      ASC-CRNT-YR-QTY-VRFD                        21890022
219700                      ASC-PREV-YR-QTY-VRFD                        21900022
219800                      ASC-CTN-VRNCE-VRFD                          21910022
219900                      ASC-CRNT-YR-CTN-VRFD                        21920022
220000                      ASC-PREV-YR-CTN-VRFD                        21930022
220100                      ASC-POR-VRNCE-VRFD                          21940022
220200                      ASC-CRNT-YR-POR-VRFD                        21950022
220300                      ASC-PREV-YR-POR-VRFD                        21960022
220400                      ASC-RTL-VRNCE-VRFD                          21970022
220500                      ASC-CRNT-YR-RTL-VRFD                        21980022
220600                      ASC-PREV-YR-RTL-VRFD.                       21990022
220700      MOVE ' - NOT APPLICABLE - ' TO ASC-TITLE4.                  22000059
220800                                                                  22010022
220900*----------------------------------------------------------------*22020009
221000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *22030009
221100*----------------------------------------------------------------*22040009
221200 4400-MOVE-COMMAREA-TO-SCREEN.                                    22050001
221300     IF ASC-OPER-UNT-ID  > ZEROES                                 22060087
221400         MOVE ASC-OPER-UNT-ID      TO AOPERO                      22061087
221500     ELSE                                                         22062087
221600         MOVE SPACES               TO AOPERO                      22063087
221700     END-IF.                                                      22064087
221800     MOVE ASC-OPER-NAME            TO ANAMEO.                     22070001
221900     MOVE ASC-TITLE1               TO ATITLE1O.                   22080006
222000     MOVE ASC-TITLE2               TO ATITLE2O.                   22090006
222100     MOVE ASC-TITLE3               TO ATITLE3O.                   22100006
222200     MOVE ASC-TITLE4               TO ATITLE4O.                   22110022
222300     MOVE ASC-CRNT-YR-RTL-WRKD     TO DK-DOLLAR-FORMAT.           22120006
222400     MOVE DK-DOLLAR-FORMAT         TO ACYRWO.                     22130006
222500     MOVE ASC-CRNT-PRCT-WRKD       TO DK-NUMBER.                  22140006
222600     MOVE DK-PERCENT-FORMAT        TO ACYRPWO.                    22150006
222700     MOVE ASC-PREV-YR-RTL-WRKD     TO DK-DOLLAR-FORMAT.           22160006
222800     MOVE DK-DOLLAR-FORMAT         TO APYRWO.                     22170006
222900     MOVE ASC-PREV-PRCT-WRKD       TO DK-NUMBER.                  22180006
223000     MOVE DK-PERCENT-FORMAT        TO APYRPWO.                    22190006
223100     MOVE ASC-RTL-VRNCE-WRKD       TO DK-DOLLAR-FORMAT.           22200006
223200     MOVE DK-DOLLAR-FORMAT         TO ARVWO.                      22210006
223300     MOVE ASC-RTL-VRNCE-PCT-WRKD   TO DK-NUMBER.                  22220006
223400     MOVE DK-PERCENT-FORMAT        TO ARVPWO.                     22230006
223500     MOVE ASC-CRNT-YR-QTY-WRKD     TO DK-NUMBER-FORMAT            22240006
223600     MOVE DK-NUMBER-FORMAT         TO ACYQWO.                     22250006
223700     MOVE ASC-CRNT-QTY-PRCT-WRKD   TO DK-NUMBER.                  22260006
223800     MOVE DK-PERCENT-FORMAT        TO ACYQPWO.                    22270006
223900     MOVE ASC-PREV-YR-QTY-WRKD     TO DK-NUMBER-FORMAT.           22280006
224000     MOVE DK-NUMBER-FORMAT         TO APYQWO.                     22290006
224100     MOVE ASC-PREV-QTY-PRCT-WRKD   TO DK-NUMBER.                  22300006
224200     MOVE DK-PERCENT-FORMAT        TO APYQPWO.                    22310006
224300     MOVE ASC-QTY-VRNCE-WRKD       TO DK-NUMBER-FORMAT.           22320006
224400     MOVE DK-NUMBER-FORMAT         TO AQVWO.                      22330006
224500     MOVE ASC-QTY-VRNCE-PCT-WRKD   TO DK-NUMBER.                  22340006
224600     MOVE DK-PERCENT-FORMAT        TO AQVPWO.                     22350006
224700     MOVE ASC-CRNT-YR-CTN-WRKD     TO DK-NUMBER-FORMAT.           22360006
224800     MOVE DK-NUMBER-FORMAT         TO ACYCWO.                     22370006
224900     MOVE ASC-CRNT-CTN-PRCT-WRKD   TO DK-NUMBER.                  22380006
225000     MOVE DK-PERCENT-FORMAT        TO ACYCPWO.                    22390006
225100     MOVE ASC-PREV-YR-CTN-WRKD     TO DK-NUMBER-FORMAT.           22400006
225200     MOVE DK-NUMBER-FORMAT         TO APYCWO.                     22410006
225300     MOVE ASC-PREV-CTN-PRCT-WRKD   TO DK-NUMBER.                  22420006
225400     MOVE DK-PERCENT-FORMAT        TO APYCPWO.                    22430006
225500     MOVE ASC-CTN-VRNCE-WRKD       TO DK-NUMBER-FORMAT.           22440006
225600     MOVE DK-NUMBER-FORMAT         TO ACVWO.                      22450006
225700     MOVE ASC-CTN-VRNCE-PCT-WRKD   TO DK-NUMBER.                  22460006
225800     MOVE DK-PERCENT-FORMAT        TO ACVPWO.                     22470006
225900     MOVE ASC-CRNT-YR-POR-WRKD     TO DK-NUMBER-FORMAT.           22480006
226000     MOVE DK-NUMBER-FORMAT         TO ACYPWO.                     22490006
226100     MOVE ASC-CRNT-POR-PRCT-WRKD   TO DK-NUMBER.                  22500006
226200     MOVE DK-PERCENT-FORMAT        TO ACYPPWO.                    22510006
226300     MOVE ASC-PREV-YR-POR-WRKD     TO DK-NUMBER-FORMAT.           22520006
226400     MOVE DK-NUMBER-FORMAT         TO APYPWO.                     22530006
226500     MOVE ASC-PREV-POR-PRCT-WRKD   TO DK-NUMBER.                  22540006
226600     MOVE DK-PERCENT-FORMAT        TO APYPPWO.                    22550006
226700     MOVE ASC-POR-VRNCE-WRKD       TO DK-NUMBER-FORMAT.           22560006
226800     MOVE DK-NUMBER-FORMAT         TO APVWO.                      22570006
226900     MOVE ASC-POR-VRNCE-PCT-WRKD   TO DK-NUMBER.                  22580006
227000     MOVE DK-PERCENT-FORMAT        TO APVPWO.                     22590006
227100     MOVE ASC-CRNT-YR-RTL-VRFD     TO DK-DOLLAR-FORMAT.           22600006
227200     MOVE DK-DOLLAR-FORMAT         TO ACYRVO.                     22610006
227300     MOVE ASC-CRNT-PRCT-VRFD       TO DK-NUMBER.                  22620006
227400     MOVE DK-PERCENT-FORMAT        TO ACYRPVO.                    22630006
227500     MOVE ASC-PREV-YR-RTL-VRFD     TO DK-DOLLAR-FORMAT.           22640006
227600     MOVE DK-DOLLAR-FORMAT         TO APYRVO.                     22650006
227700     MOVE ASC-PREV-PRCT-VRFD       TO DK-NUMBER.                  22660006
227800     MOVE DK-PERCENT-FORMAT        TO APYRPVO.                    22670006
227900     MOVE ASC-RTL-VRNCE-VRFD       TO DK-DOLLAR-FORMAT.           22680006
228000     MOVE DK-DOLLAR-FORMAT         TO ARVVO.                      22690006
228100     MOVE ASC-RTL-VRNCE-PCT-VRFD   TO DK-NUMBER.                  22700006
228200     MOVE DK-PERCENT-FORMAT        TO ARVPVO.                     22710006
228300     MOVE ASC-CRNT-YR-QTY-VRFD     TO DK-NUMBER-FORMAT            22720006
228400     MOVE DK-NUMBER-FORMAT         TO ACYQVO.                     22730006
228500     MOVE ASC-CRNT-QTY-PRCT-VRFD   TO DK-NUMBER.                  22740006
228600     MOVE DK-PERCENT-FORMAT        TO ACYQPVO.                    22750006
228700     MOVE ASC-PREV-YR-QTY-VRFD     TO DK-NUMBER-FORMAT.           22760006
228800     MOVE DK-NUMBER-FORMAT         TO APYQVO.                     22770006
228900     MOVE ASC-PREV-QTY-PRCT-VRFD   TO DK-NUMBER.                  22780006
229000     MOVE DK-PERCENT-FORMAT        TO APYQPVO.                    22790006
229100     MOVE ASC-QTY-VRNCE-VRFD       TO DK-NUMBER-FORMAT.           22800006
229200     MOVE DK-NUMBER-FORMAT         TO AQVVO.                      22810006
229300     MOVE ASC-QTY-VRNCE-PCT-VRFD   TO DK-NUMBER.                  22820006
229400     MOVE DK-PERCENT-FORMAT        TO AQVPVO.                     22830006
229500     MOVE ASC-CRNT-YR-CTN-VRFD     TO DK-NUMBER-FORMAT.           22840006
229600     MOVE DK-NUMBER-FORMAT         TO ACYCVO.                     22850006
229700     MOVE ASC-CRNT-CTN-PRCT-VRFD   TO DK-NUMBER.                  22860006
229800     MOVE DK-PERCENT-FORMAT        TO ACYCPVO.                    22870006
229900     MOVE ASC-PREV-YR-CTN-VRFD     TO DK-NUMBER-FORMAT.           22880006
230000     MOVE DK-NUMBER-FORMAT         TO APYCVO.                     22890006
230100     MOVE ASC-PREV-CTN-PRCT-VRFD   TO DK-NUMBER.                  22900006
230200     MOVE DK-PERCENT-FORMAT        TO APYCPVO.                    22910006
230300     MOVE ASC-CTN-VRNCE-VRFD       TO DK-NUMBER-FORMAT.           22920006
230400     MOVE DK-NUMBER-FORMAT         TO ACVVO.                      22930006
230500     MOVE ASC-CTN-VRNCE-PCT-VRFD   TO DK-NUMBER.                  22940006
230600     MOVE DK-PERCENT-FORMAT        TO ACVPVO.                     22950006
230700     MOVE ASC-CRNT-YR-POR-VRFD     TO DK-NUMBER-FORMAT.           22960006
230800     MOVE DK-NUMBER-FORMAT         TO ACYPVO.                     22970006
230900     MOVE ASC-CRNT-POR-PRCT-VRFD   TO DK-NUMBER.                  22980006
231000     MOVE DK-PERCENT-FORMAT        TO ACYPPVO.                    22990006
231100     MOVE ASC-PREV-YR-POR-VRFD     TO DK-NUMBER-FORMAT.           23000006
231200     MOVE DK-NUMBER-FORMAT         TO APYPVO.                     23010006
231300     MOVE ASC-PREV-POR-PRCT-VRFD   TO DK-NUMBER.                  23020006
231400     MOVE DK-PERCENT-FORMAT        TO APYPPVO.                    23030006
231500     MOVE ASC-POR-VRNCE-VRFD       TO DK-NUMBER-FORMAT.           23040006
231600     MOVE DK-NUMBER-FORMAT         TO APVVO.                      23050006
231700     MOVE ASC-POR-VRNCE-PCT-VRFD   TO DK-NUMBER.                  23060006
231800     MOVE DK-PERCENT-FORMAT        TO APVPVO.                     23070006
231900                                                                  23080006
232000*----------------------------------------------------------------*23090011
232100*    MOVE FIELDS FOR COMPANY TOTALS                               23100011
232200*----------------------------------------------------------------*23110011
232300 4500-CALC-PRCNT-CO.                                              23120011
232400     MOVE PC-CRNT-YR-RTL-WRKD-CO  TO ASC-CRNT-YR-RTL-WRKD.        23130011
232500     MOVE PC-PREV-YR-RTL-WRKD-CO  TO ASC-PREV-YR-RTL-WRKD.        23140011
232600     MOVE PC-RTL-VRNCE-WRKD-CO    TO ASC-RTL-VRNCE-WRKD.          23150011
232700     MOVE PC-CRNT-YR-QTY-WRKD-CO  TO ASC-CRNT-YR-QTY-WRKD.        23160011
232800     MOVE PC-PREV-YR-QTY-WRKD-CO  TO ASC-PREV-YR-QTY-WRKD.        23170011
232900     MOVE PC-QTY-VRNCE-WRKD-CO    TO ASC-QTY-VRNCE-WRKD.          23180011
233000     MOVE PC-CRNT-YR-CTN-WRKD-CO  TO ASC-CRNT-YR-CTN-WRKD.        23190011
233100     MOVE PC-PREV-YR-CTN-WRKD-CO  TO ASC-PREV-YR-CTN-WRKD.        23200011
233200     MOVE PC-CTN-VRNCE-WRKD-CO    TO ASC-CTN-VRNCE-WRKD.          23210011
233300     MOVE PC-CRNT-YR-POR-WRKD-CO  TO ASC-CRNT-YR-POR-WRKD.        23220011
233400     MOVE PC-PREV-YR-POR-WRKD-CO  TO ASC-PREV-YR-POR-WRKD.        23230011
233500     MOVE PC-POR-VRNCE-WRKD-CO    TO ASC-POR-VRNCE-WRKD.          23240011
233600     MOVE PC-CRNT-YR-RTL-VRFD-CO  TO ASC-CRNT-YR-RTL-VRFD.        23250011
233700     MOVE PC-PREV-YR-RTL-VRFD-CO  TO ASC-PREV-YR-RTL-VRFD.        23260011
233800     MOVE PC-RTL-VRNCE-VRFD-CO    TO ASC-RTL-VRNCE-VRFD.          23270011
233900     MOVE PC-CRNT-YR-QTY-VRFD-CO  TO ASC-CRNT-YR-QTY-VRFD.        23280011
234000     MOVE PC-PREV-YR-QTY-VRFD-CO  TO ASC-PREV-YR-QTY-VRFD.        23290011
234100     MOVE PC-QTY-VRNCE-VRFD-CO    TO ASC-QTY-VRNCE-VRFD.          23300011
234200     MOVE PC-CRNT-YR-CTN-VRFD-CO  TO ASC-CRNT-YR-CTN-VRFD.        23310011
234300     MOVE PC-PREV-YR-CTN-VRFD-CO  TO ASC-PREV-YR-CTN-VRFD.        23320011
234400     MOVE PC-CTN-VRNCE-VRFD-CO    TO ASC-CTN-VRNCE-VRFD.          23330011
234500     MOVE PC-CRNT-YR-POR-VRFD-CO  TO ASC-CRNT-YR-POR-VRFD.        23340011
234600     MOVE PC-PREV-YR-POR-VRFD-CO  TO ASC-PREV-YR-POR-VRFD.        23350011
234700     MOVE PC-POR-VRNCE-VRFD-CO    TO ASC-POR-VRNCE-VRFD.          23360011
234800     MOVE PC-100                  TO ASC-CRNT-PRCT-WRKD           23370011
234900                                     ASC-PREV-PRCT-WRKD           23380011
235000                                     ASC-CRNT-QTY-PRCT-WRKD       23390011
235100                                     ASC-PREV-QTY-PRCT-WRKD       23400011
235200                                     ASC-CRNT-CTN-PRCT-WRKD       23410011
235300                                     ASC-PREV-CTN-PRCT-WRKD       23420011
235400                                     ASC-CRNT-POR-PRCT-WRKD       23430011
235500                                     ASC-PREV-POR-PRCT-WRKD       23440011
235600                                     ASC-CRNT-PRCT-VRFD           23450011
235700                                     ASC-PREV-PRCT-VRFD           23460011
235800                                     ASC-CRNT-QTY-PRCT-VRFD       23470011
235900                                     ASC-PREV-QTY-PRCT-VRFD       23480011
236000                                     ASC-CRNT-CTN-PRCT-VRFD       23490011
236100                                     ASC-PREV-CTN-PRCT-VRFD       23500011
236200                                     ASC-CRNT-POR-PRCT-VRFD       23510011
236300                                     ASC-PREV-POR-PRCT-VRFD.      23520042
236400     IF PC-PREV-YR-RTL-WRKD-CO NOT = ZERO                         23530042
236500         DIVIDE PC-RTL-VRNCE-WRKD-CO BY PC-PREV-YR-RTL-WRKD-CO    23540042
236600                 GIVING PV-DIVIDEND ROUNDED                       23550076
236700             MULTIPLY PV-DIVIDEND BY 100                          23560042
236800                 GIVING ASC-RTL-VRNCE-PCT-WRKD                    23570042
236900             IF ASC-RTL-VRNCE-PCT-WRKD = ZERO                     23580084
237000                 MOVE .1  TO ASC-RTL-VRNCE-PCT-WRKD               23590084
237100             END-IF                                               23600084
237200     ELSE                                                         23610042
237300         IF PC-CRNT-YR-RTL-WRKD-CO = ZERO                         23620042
237400             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-WRKD                 23630042
237500         ELSE                                                     23640042
237600             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-WRKD                 23650042
237700         END-IF                                                   23660042
237800     END-IF.                                                      23670042
237900     IF PC-PREV-YR-QTY-WRKD-CO NOT = ZERO                         23680042
238000         DIVIDE PC-QTY-VRNCE-WRKD-CO BY PC-PREV-YR-QTY-WRKD-CO    23690042
238100                 GIVING PV-DIVIDEND ROUNDED                       23700076
238200             MULTIPLY PV-DIVIDEND BY 100                          23710042
238300                 GIVING ASC-QTY-VRNCE-PCT-WRKD                    23720042
238400             IF ASC-QTY-VRNCE-PCT-WRKD = ZERO                     23730084
238500                 MOVE .1  TO ASC-QTY-VRNCE-PCT-WRKD               23740084
238600             END-IF                                               23750084
238700     ELSE                                                         23760042
238800         IF PC-CRNT-YR-QTY-WRKD-CO = ZERO                         23770042
238900             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-WRKD                 23780042
239000         ELSE                                                     23790042
239100             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-WRKD                 23800042
239200         END-IF                                                   23810042
239300     END-IF.                                                      23820042
239400     IF PC-PREV-YR-CTN-WRKD-CO NOT = ZERO                         23830042
239500         DIVIDE PC-CTN-VRNCE-WRKD-CO BY PC-PREV-YR-CTN-WRKD-CO    23840042
239600                 GIVING PV-DIVIDEND ROUNDED                       23850076
239700             MULTIPLY PV-DIVIDEND BY 100                          23860042
239800                 GIVING ASC-CTN-VRNCE-PCT-WRKD                    23870042
239900             IF ASC-CTN-VRNCE-PCT-WRKD = ZERO                     23880084
240000                 MOVE .1  TO ASC-CTN-VRNCE-PCT-WRKD               23890084
240100             END-IF                                               23900084
240200     ELSE                                                         23910042
240300         IF PC-CRNT-YR-CTN-WRKD-CO = ZERO                         23920042
240400             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-WRKD                 23930042
240500         ELSE                                                     23940042
240600             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-WRKD                 23950042
240700         END-IF                                                   23960042
240800     END-IF.                                                      23970042
240900     IF PC-PREV-YR-POR-WRKD-CO NOT = ZERO                         23980042
241000         DIVIDE PC-POR-VRNCE-WRKD-CO BY PC-PREV-YR-POR-WRKD-CO    23990042
241100                 GIVING PV-DIVIDEND ROUNDED                       24000076
241200             MULTIPLY PV-DIVIDEND BY 100                          24010042
241300                 GIVING ASC-POR-VRNCE-PCT-WRKD                    24020042
241400             IF ASC-POR-VRNCE-PCT-WRKD = ZERO                     24030084
241500                 MOVE .1  TO ASC-POR-VRNCE-PCT-WRKD               24040084
241600             END-IF                                               24050084
241700     ELSE                                                         24060042
241800         IF PC-CRNT-YR-POR-WRKD-CO = ZERO                         24070042
241900             MOVE ZEROS TO ASC-POR-VRNCE-PCT-WRKD                 24080042
242000         ELSE                                                     24090042
242100             MOVE 999.9 TO ASC-POR-VRNCE-PCT-WRKD                 24100042
242200         END-IF                                                   24110042
242300     END-IF.                                                      24120042
242400     IF PC-PREV-YR-RTL-VRFD-CO NOT = ZERO                         24130042
242500         DIVIDE PC-RTL-VRNCE-VRFD-CO BY PC-PREV-YR-RTL-VRFD-CO    24140042
242600                 GIVING PV-DIVIDEND ROUNDED                       24150076
242700             MULTIPLY PV-DIVIDEND BY 100                          24160042
242800                 GIVING ASC-RTL-VRNCE-PCT-VRFD                    24170042
242900             IF ASC-RTL-VRNCE-PCT-VRFD = ZERO                     24180084
243000                 MOVE .1  TO ASC-RTL-VRNCE-PCT-VRFD               24190084
243100             END-IF                                               24200084
243200     ELSE                                                         24210042
243300         IF PC-CRNT-YR-RTL-VRFD-CO = ZERO                         24220042
243400             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-VRFD                 24230042
243500         ELSE                                                     24240042
243600             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-VRFD                 24250042
243700         END-IF                                                   24260042
243800     END-IF.                                                      24270042
243900     IF PC-PREV-YR-QTY-VRFD-CO NOT = ZERO                         24280042
244000         DIVIDE PC-QTY-VRNCE-VRFD-CO BY PC-PREV-YR-QTY-VRFD-CO    24290042
244100                 GIVING PV-DIVIDEND ROUNDED                       24300076
244200             MULTIPLY PV-DIVIDEND BY 100                          24310042
244300                 GIVING ASC-QTY-VRNCE-PCT-VRFD                    24320042
244400             IF ASC-QTY-VRNCE-PCT-VRFD = ZERO                     24330084
244500                 MOVE .1  TO ASC-QTY-VRNCE-PCT-VRFD               24340084
244600             END-IF                                               24350084
244700     ELSE                                                         24360042
244800         IF PC-CRNT-YR-QTY-VRFD-CO = ZERO                         24370042
244900             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-VRFD                 24380042
245000         ELSE                                                     24390042
245100             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-VRFD                 24400042
245200         END-IF                                                   24410042
245300     END-IF.                                                      24420042
245400     IF PC-PREV-YR-CTN-VRFD-CO NOT = ZERO                         24430042
245500         DIVIDE PC-CTN-VRNCE-VRFD-CO BY PC-PREV-YR-CTN-VRFD-CO    24440042
245600                 GIVING PV-DIVIDEND ROUNDED                       24450076
245700             MULTIPLY PV-DIVIDEND BY 100                          24460042
245800                 GIVING ASC-CTN-VRNCE-PCT-VRFD                    24470042
245900             IF ASC-CTN-VRNCE-PCT-VRFD = ZERO                     24480084
246000                 MOVE .1  TO ASC-CTN-VRNCE-PCT-VRFD               24490084
246100             END-IF                                               24500084
246200     ELSE                                                         24510042
246300         IF PC-CRNT-YR-CTN-VRFD-CO = ZERO                         24520042
246400             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-VRFD                 24530042
246500         ELSE                                                     24540042
246600             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-VRFD                 24550042
246700         END-IF                                                   24560042
246800     END-IF.                                                      24570042
246900     IF PC-PREV-YR-POR-VRFD-CO NOT = ZERO                         24580042
247000         DIVIDE PC-POR-VRNCE-VRFD-CO BY PC-PREV-YR-POR-VRFD-CO    24590042
247100                 GIVING PV-DIVIDEND ROUNDED                       24600076
247200             MULTIPLY PV-DIVIDEND BY 100                          24610042
247300                 GIVING ASC-POR-VRNCE-PCT-VRFD                    24620042
247400             IF ASC-POR-VRNCE-PCT-VRFD = ZERO                     24630084
247500                 MOVE .1  TO ASC-POR-VRNCE-PCT-VRFD               24640084
247600             END-IF                                               24650084
247700     ELSE                                                         24660042
247800         IF PC-CRNT-YR-POR-VRFD-CO = ZERO                         24670042
247900             MOVE ZEROS TO ASC-POR-VRNCE-PCT-VRFD                 24680042
248000         ELSE                                                     24690042
248100             MOVE 999.9 TO ASC-POR-VRNCE-PCT-VRFD                 24700042
248200         END-IF                                                   24710042
248300     END-IF.                                                      24720042
248400                                                                  24730042
248500*----------------------------------------------------------------*24740011
248600*    CALCULATE PERCENTS FOR DC TO COMPANY TOTALS                  24750011
248700*----------------------------------------------------------------*24760011
248800 4510-CALC-PRCNT-DC-CO.                                           24770011
248900     IF PC-CRNT-YR-RTL-WRKD-DC NOT = ZERO                         24780036
249000         DIVIDE PC-CRNT-YR-RTL-WRKD-DC BY PC-CRNT-YR-RTL-WRKD-CO  24790011
249100                 GIVING PV-DIVIDEND ROUNDED                       24800076
249200             MULTIPLY PV-DIVIDEND BY 100                          24810011
249300                 GIVING ASC-CRNT-PRCT-WRKD                        24820011
249400             IF ASC-CRNT-PRCT-WRKD = ZERO                         24821085
249500                 MOVE .1  TO ASC-CRNT-PRCT-WRKD                   24822085
249600             END-IF                                               24823085
249700     ELSE                                                         24830011
249800         MOVE ZERO TO ASC-CRNT-PRCT-WRKD                          24840011
249900     END-IF.                                                      24850011
250000     MOVE PC-CRNT-YR-RTL-WRKD-DC TO ASC-CRNT-YR-RTL-WRKD.         24860011
250100     IF PC-PREV-YR-RTL-WRKD-DC NOT = ZERO                         24870036
250200         DIVIDE PC-PREV-YR-RTL-WRKD-DC BY PC-PREV-YR-RTL-WRKD-CO  24880011
250300                 GIVING PV-DIVIDEND ROUNDED                       24890076
250400             MULTIPLY PV-DIVIDEND BY 100                          24900011
250500                 GIVING ASC-PREV-PRCT-WRKD                        24910011
250600             IF ASC-PREV-PRCT-WRKD = ZERO                         24911085
250700                 MOVE .1  TO ASC-PREV-PRCT-WRKD                   24912085
250800             END-IF                                               24913085
250900     ELSE                                                         24920011
251000         MOVE ZERO TO ASC-PREV-PRCT-WRKD                          24930011
251100     END-IF.                                                      24940011
251200     MOVE PC-PREV-YR-RTL-WRKD-DC TO ASC-PREV-YR-RTL-WRKD.         24950011
251300     IF PC-PREV-YR-RTL-WRKD-DC NOT = ZERO                         24960040
251400         DIVIDE PC-RTL-VRNCE-WRKD-DC BY PC-PREV-YR-RTL-WRKD-DC    24970040
251500                 GIVING PV-DIVIDEND ROUNDED                       24980076
251600             MULTIPLY PV-DIVIDEND BY 100                          24990011
251700                 GIVING ASC-RTL-VRNCE-PCT-WRKD                    25000011
251800             IF ASC-RTL-VRNCE-PCT-WRKD = ZERO                     25010084
251900                 MOVE .1  TO ASC-RTL-VRNCE-PCT-WRKD               25020084
252000             END-IF                                               25030084
252100     ELSE                                                         25040011
252200         IF PC-CRNT-YR-RTL-WRKD-DC = ZERO                         25050041
252300             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-WRKD                 25060041
252400         ELSE                                                     25070041
252500             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-WRKD                 25080041
252600         END-IF                                                   25090041
252700     END-IF.                                                      25100041
252800     MOVE PC-RTL-VRNCE-WRKD-DC TO ASC-RTL-VRNCE-WRKD.             25110011
252900     IF PC-CRNT-YR-QTY-WRKD-DC NOT = ZERO                         25120036
253000         DIVIDE PC-CRNT-YR-QTY-WRKD-DC BY PC-CRNT-YR-QTY-WRKD-CO  25130011
253100                 GIVING PV-DIVIDEND ROUNDED                       25140076
253200             MULTIPLY PV-DIVIDEND BY 100                          25150011
253300                 GIVING ASC-CRNT-QTY-PRCT-WRKD                    25160011
253400             IF ASC-CRNT-QTY-PRCT-WRKD = ZERO                     25161085
253500                 MOVE .1  TO ASC-CRNT-QTY-PRCT-WRKD               25162085
253600             END-IF                                               25163085
253700     ELSE                                                         25170011
253800         MOVE ZERO TO ASC-CRNT-QTY-PRCT-WRKD                      25180011
253900     END-IF.                                                      25190011
254000     MOVE PC-CRNT-YR-QTY-WRKD-DC  TO ASC-CRNT-YR-QTY-WRKD.        25200011
254100     IF PC-PREV-YR-QTY-WRKD-DC NOT = ZERO                         25210036
254200         DIVIDE PC-PREV-YR-QTY-WRKD-DC BY PC-PREV-YR-QTY-WRKD-CO  25220011
254300                 GIVING PV-DIVIDEND ROUNDED                       25230076
254400             MULTIPLY PV-DIVIDEND BY 100                          25240011
254500                 GIVING ASC-PREV-QTY-PRCT-WRKD                    25250011
254600             IF ASC-PREV-QTY-PRCT-WRKD = ZERO                     25251085
254700                 MOVE .1  TO ASC-PREV-QTY-PRCT-WRKD               25252085
254800             END-IF                                               25253085
254900     ELSE                                                         25260011
255000         MOVE ZERO TO ASC-PREV-QTY-PRCT-WRKD                      25270011
255100     END-IF.                                                      25280011
255200     MOVE PC-PREV-YR-QTY-WRKD-DC  TO ASC-PREV-YR-QTY-WRKD.        25290011
255300     IF PC-PREV-YR-QTY-WRKD-DC NOT = ZERO                         25300040
255400         DIVIDE PC-QTY-VRNCE-WRKD-DC BY PC-PREV-YR-QTY-WRKD-DC    25310040
255500                 GIVING PV-DIVIDEND ROUNDED                       25320076
255600             MULTIPLY PV-DIVIDEND BY 100                          25330011
255700                 GIVING ASC-QTY-VRNCE-PCT-WRKD                    25340011
255800             IF ASC-QTY-VRNCE-PCT-WRKD = ZERO                     25350084
255900                 MOVE .1  TO ASC-QTY-VRNCE-PCT-WRKD               25360084
256000             END-IF                                               25370084
256100     ELSE                                                         25380011
256200         IF PC-CRNT-YR-QTY-WRKD-DC = ZERO                         25390041
256300             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-WRKD                 25400041
256400         ELSE                                                     25410041
256500             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-WRKD                 25420041
256600         END-IF                                                   25430041
256700     END-IF.                                                      25440011
256800     MOVE PC-QTY-VRNCE-WRKD-DC  TO ASC-QTY-VRNCE-WRKD.            25450011
256900     IF PC-CRNT-YR-CTN-WRKD-DC NOT = ZERO                         25460036
257000         DIVIDE PC-CRNT-YR-CTN-WRKD-DC BY PC-CRNT-YR-CTN-WRKD-CO  25470011
257100                 GIVING PV-DIVIDEND ROUNDED                       25480076
257200             MULTIPLY PV-DIVIDEND BY 100                          25490011
257300                 GIVING ASC-CRNT-CTN-PRCT-WRKD                    25500011
257400             IF ASC-CRNT-CTN-PRCT-WRKD = ZERO                     25501085
257500                 MOVE .1  TO ASC-CRNT-CTN-PRCT-WRKD               25502085
257600             END-IF                                               25503085
257700     ELSE                                                         25510011
257800         MOVE ZERO TO ASC-CRNT-CTN-PRCT-WRKD                      25520011
257900     END-IF.                                                      25530011
258000     MOVE PC-CRNT-YR-CTN-WRKD-DC TO ASC-CRNT-YR-CTN-WRKD.         25540011
258100     IF PC-PREV-YR-CTN-WRKD-DC NOT = ZERO                         25550036
258200         DIVIDE PC-PREV-YR-CTN-WRKD-DC BY PC-PREV-YR-CTN-WRKD-CO  25560011
258300                 GIVING PV-DIVIDEND ROUNDED                       25570076
258400             MULTIPLY PV-DIVIDEND BY 100                          25580011
258500                 GIVING ASC-PREV-CTN-PRCT-WRKD                    25590011
258600             IF ASC-PREV-CTN-PRCT-WRKD = ZERO                     25591085
258700                 MOVE .1  TO ASC-PREV-CTN-PRCT-WRKD               25592085
258800             END-IF                                               25593085
258900     ELSE                                                         25600011
259000         MOVE ZERO TO ASC-PREV-CTN-PRCT-WRKD                      25610011
259100     END-IF.                                                      25620011
259200     MOVE PC-PREV-YR-CTN-WRKD-DC TO ASC-PREV-YR-CTN-WRKD.         25630011
259300     IF PC-PREV-YR-CTN-WRKD-DC NOT = ZERO                         25640040
259400         DIVIDE PC-CTN-VRNCE-WRKD-DC BY PC-PREV-YR-CTN-WRKD-DC    25650040
259500                 GIVING PV-DIVIDEND ROUNDED                       25660076
259600             MULTIPLY PV-DIVIDEND BY 100                          25670011
259700                 GIVING ASC-CTN-VRNCE-PCT-WRKD                    25680011
259800             IF ASC-CTN-VRNCE-PCT-WRKD = ZERO                     25690084
259900                 MOVE .1  TO ASC-CTN-VRNCE-PCT-WRKD               25700084
260000             END-IF                                               25710084
260100     ELSE                                                         25720011
260200         IF PC-CRNT-YR-CTN-WRKD-DC = ZERO                         25730041
260300             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-WRKD                 25740041
260400         ELSE                                                     25750041
260500             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-WRKD                 25760041
260600         END-IF                                                   25770041
260700     END-IF.                                                      25780011
260800     MOVE PC-CTN-VRNCE-WRKD-DC TO ASC-CTN-VRNCE-WRKD.             25790011
260900     IF PC-CRNT-YR-POR-WRKD-DC NOT = ZERO                         25800036
261000         DIVIDE PC-CRNT-YR-POR-WRKD-DC BY PC-CRNT-YR-POR-WRKD-CO  25810011
261100                 GIVING PV-DIVIDEND ROUNDED                       25820076
261200             MULTIPLY PV-DIVIDEND BY 100                          25830011
261300                 GIVING ASC-CRNT-POR-PRCT-WRKD                    25840011
261400             IF ASC-CRNT-POR-PRCT-WRKD = ZERO                     25841085
261500                 MOVE .1  TO ASC-CRNT-POR-PRCT-WRKD               25842085
261600             END-IF                                               25843085
261700     ELSE                                                         25850011
261800         MOVE ZERO TO ASC-CRNT-POR-PRCT-WRKD                      25860011
261900     END-IF.                                                      25870011
262000     MOVE PC-CRNT-YR-POR-WRKD-DC TO ASC-CRNT-YR-POR-WRKD.         25880011
262100     IF PC-PREV-YR-POR-WRKD-DC NOT = ZERO                         25890036
262200         DIVIDE PC-PREV-YR-POR-WRKD-DC BY PC-PREV-YR-POR-WRKD-CO  25900011
262300                 GIVING PV-DIVIDEND ROUNDED                       25910076
262400             MULTIPLY PV-DIVIDEND BY 100                          25920011
262500                 GIVING ASC-PREV-POR-PRCT-WRKD                    25930011
262600             IF ASC-PREV-POR-PRCT-WRKD = ZERO                     25931085
262700                 MOVE .1  TO ASC-PREV-POR-PRCT-WRKD               25932085
262800             END-IF                                               25933085
262900     ELSE                                                         25940011
263000         MOVE ZERO TO ASC-PREV-POR-PRCT-WRKD                      25950011
263100     END-IF.                                                      25960011
263200     MOVE PC-PREV-YR-POR-WRKD-DC TO ASC-PREV-YR-POR-WRKD.         25970011
263300     IF PC-PREV-YR-POR-WRKD-DC NOT = ZERO                         25980040
263400         DIVIDE PC-POR-VRNCE-WRKD-DC BY PC-PREV-YR-POR-WRKD-DC    25990040
263500                 GIVING PV-DIVIDEND ROUNDED                       26000076
263600             MULTIPLY PV-DIVIDEND BY 100                          26010011
263700                 GIVING ASC-POR-VRNCE-PCT-WRKD                    26020011
263800             IF ASC-POR-VRNCE-PCT-WRKD = ZERO                     26030084
263900                 MOVE .1  TO ASC-POR-VRNCE-PCT-WRKD               26040084
264000             END-IF                                               26050084
264100     ELSE                                                         26060011
264200         IF PC-CRNT-YR-POR-WRKD-DC = ZERO                         26070041
264300             MOVE ZEROS TO ASC-POR-VRNCE-PCT-WRKD                 26080041
264400         ELSE                                                     26090041
264500             MOVE 999.9 TO ASC-POR-VRNCE-PCT-WRKD                 26100041
264600         END-IF                                                   26110041
264700     END-IF.                                                      26120011
264800     MOVE PC-POR-VRNCE-WRKD-DC TO ASC-POR-VRNCE-WRKD.             26130011
264900     IF PC-CRNT-YR-RTL-VRFD-DC NOT = ZERO                         26140036
265000         DIVIDE PC-CRNT-YR-RTL-VRFD-DC BY PC-CRNT-YR-RTL-VRFD-CO  26150011
265100                 GIVING PV-DIVIDEND ROUNDED                       26160076
265200             MULTIPLY PV-DIVIDEND BY 100                          26170011
265300                 GIVING ASC-CRNT-PRCT-VRFD                        26180011
265400             IF ASC-CRNT-PRCT-VRFD     = ZERO                     26181085
265500                 MOVE .1  TO ASC-CRNT-PRCT-VRFD                   26182085
265600             END-IF                                               26183085
265700     ELSE                                                         26190011
265800         MOVE ZERO TO ASC-CRNT-PRCT-VRFD                          26200011
265900     END-IF.                                                      26210011
266000     MOVE PC-CRNT-YR-RTL-VRFD-DC TO ASC-CRNT-YR-RTL-VRFD.         26220011
266100     IF PC-PREV-YR-RTL-VRFD-DC NOT = ZERO                         26230036
266200         DIVIDE PC-PREV-YR-RTL-VRFD-DC BY PC-PREV-YR-RTL-VRFD-CO  26240011
266300                 GIVING PV-DIVIDEND ROUNDED                       26250076
266400             MULTIPLY PV-DIVIDEND BY 100                          26260011
266500                 GIVING ASC-PREV-PRCT-VRFD                        26270011
266600             IF ASC-PREV-PRCT-VRFD     = ZERO                     26271085
266700                 MOVE .1  TO ASC-PREV-PRCT-VRFD                   26272085
266800             END-IF                                               26273085
266900     ELSE                                                         26280011
267000         MOVE ZERO TO ASC-PREV-PRCT-VRFD                          26290011
267100     END-IF.                                                      26300011
267200     MOVE PC-PREV-YR-RTL-VRFD-DC TO ASC-PREV-YR-RTL-VRFD.         26310011
267300     IF PC-PREV-YR-RTL-VRFD-DC NOT = ZERO                         26320040
267400         DIVIDE PC-RTL-VRNCE-VRFD-DC BY PC-PREV-YR-RTL-VRFD-DC    26330040
267500                 GIVING PV-DIVIDEND ROUNDED                       26340076
267600             MULTIPLY PV-DIVIDEND BY 100                          26350011
267700                 GIVING ASC-RTL-VRNCE-PCT-VRFD                    26360011
267800             IF ASC-RTL-VRNCE-PCT-VRFD = ZERO                     26370084
267900                 MOVE .1  TO ASC-RTL-VRNCE-PCT-VRFD               26380084
268000             END-IF                                               26390084
268100     ELSE                                                         26400011
268200         IF PC-CRNT-YR-RTL-VRFD-DC = ZERO                         26410041
268300             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-VRFD                 26420041
268400         ELSE                                                     26430041
268500             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-VRFD                 26440041
268600         END-IF                                                   26450041
268700     END-IF.                                                      26460011
268800     MOVE PC-RTL-VRNCE-VRFD-DC TO ASC-RTL-VRNCE-VRFD.             26470011
268900     IF PC-CRNT-YR-QTY-VRFD-DC NOT = ZERO                         26480036
269000         DIVIDE PC-CRNT-YR-QTY-VRFD-DC BY PC-CRNT-YR-QTY-VRFD-CO  26490011
269100                 GIVING PV-DIVIDEND ROUNDED                       26500076
269200             MULTIPLY PV-DIVIDEND BY 100                          26510011
269300                 GIVING ASC-CRNT-QTY-PRCT-VRFD                    26520011
269400             IF ASC-CRNT-QTY-PRCT-VRFD = ZERO                     26521085
269500                 MOVE .1  TO ASC-CRNT-QTY-PRCT-VRFD               26522085
269600             END-IF                                               26523085
269700     ELSE                                                         26530011
269800         MOVE ZERO TO ASC-CRNT-QTY-PRCT-VRFD                      26540011
269900     END-IF.                                                      26550011
270000     MOVE PC-CRNT-YR-QTY-VRFD-DC TO ASC-CRNT-YR-QTY-VRFD.         26560011
270100     IF PC-PREV-YR-QTY-VRFD-DC NOT = ZERO                         26570036
270200         DIVIDE PC-PREV-YR-QTY-VRFD-DC BY PC-PREV-YR-QTY-VRFD-CO  26580011
270300                 GIVING PV-DIVIDEND ROUNDED                       26590076
270400             MULTIPLY PV-DIVIDEND BY 100                          26600011
270500                 GIVING ASC-PREV-QTY-PRCT-VRFD                    26610011
270600             IF ASC-PREV-QTY-PRCT-VRFD = ZERO                     26611085
270700                 MOVE .1  TO ASC-PREV-QTY-PRCT-VRFD               26612085
270800             END-IF                                               26613085
270900     ELSE                                                         26620011
271000         MOVE ZERO TO ASC-PREV-QTY-PRCT-VRFD                      26630011
271100     END-IF.                                                      26640011
271200     MOVE PC-PREV-YR-QTY-VRFD-DC TO ASC-PREV-YR-QTY-VRFD.         26650011
271300     IF PC-PREV-YR-QTY-VRFD-DC NOT = ZERO                         26660040
271400         DIVIDE PC-QTY-VRNCE-VRFD-DC BY PC-PREV-YR-QTY-VRFD-DC    26670040
271500                 GIVING PV-DIVIDEND ROUNDED                       26680076
271600             MULTIPLY PV-DIVIDEND BY 100                          26690011
271700                 GIVING ASC-QTY-VRNCE-PCT-VRFD                    26700011
271800             IF ASC-QTY-VRNCE-PCT-VRFD = ZERO                     26710084
271900                 MOVE .1  TO ASC-QTY-VRNCE-PCT-VRFD               26720084
272000             END-IF                                               26730084
272100     ELSE                                                         26740011
272200         IF PC-CRNT-YR-QTY-VRFD-DC = ZERO                         26750041
272300             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-VRFD                 26760041
272400         ELSE                                                     26770041
272500             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-VRFD                 26780041
272600         END-IF                                                   26790041
272700     END-IF.                                                      26800011
272800     MOVE PC-QTY-VRNCE-VRFD-DC TO ASC-QTY-VRNCE-VRFD.             26810011
272900     IF PC-CRNT-YR-CTN-VRFD-DC NOT = ZERO                         26820036
273000         DIVIDE PC-CRNT-YR-CTN-VRFD-DC BY PC-CRNT-YR-CTN-VRFD-CO  26830011
273100                 GIVING PV-DIVIDEND ROUNDED                       26840076
273200             MULTIPLY PV-DIVIDEND BY 100                          26850011
273300                 GIVING ASC-CRNT-CTN-PRCT-VRFD                    26860011
273400             IF ASC-CRNT-CTN-PRCT-VRFD = ZERO                     26861085
273500                 MOVE .1  TO ASC-CRNT-CTN-PRCT-VRFD               26862085
273600             END-IF                                               26863085
273700     ELSE                                                         26870011
273800         MOVE ZERO TO ASC-CRNT-CTN-PRCT-VRFD                      26880011
273900     END-IF.                                                      26890011
274000     MOVE PC-CRNT-YR-CTN-VRFD-DC TO ASC-CRNT-YR-CTN-VRFD.         26900011
274100     IF PC-PREV-YR-CTN-VRFD-DC NOT = ZERO                         26910036
274200         DIVIDE PC-PREV-YR-CTN-VRFD-DC BY PC-PREV-YR-CTN-VRFD-CO  26920011
274300                 GIVING PV-DIVIDEND ROUNDED                       26930076
274400             MULTIPLY PV-DIVIDEND BY 100                          26940011
274500                 GIVING ASC-PREV-CTN-PRCT-VRFD                    26950011
274600             IF ASC-PREV-CTN-PRCT-VRFD = ZERO                     26951085
274700                 MOVE .1  TO ASC-PREV-CTN-PRCT-VRFD               26952085
274800             END-IF                                               26953085
274900     ELSE                                                         26960011
275000         MOVE ZERO TO ASC-PREV-CTN-PRCT-VRFD                      26970011
275100     END-IF.                                                      26980011
275200     MOVE PC-PREV-YR-CTN-VRFD-DC TO ASC-PREV-YR-CTN-VRFD.         26990011
275300     IF PC-PREV-YR-CTN-VRFD-DC NOT = ZERO                         27000040
275400         DIVIDE PC-CTN-VRNCE-VRFD-DC BY PC-PREV-YR-CTN-VRFD-DC    27010040
275500                 GIVING PV-DIVIDEND ROUNDED                       27020076
275600             MULTIPLY PV-DIVIDEND BY 100                          27030011
275700                 GIVING ASC-CTN-VRNCE-PCT-VRFD                    27040011
275800             IF ASC-CTN-VRNCE-PCT-VRFD = ZERO                     27050084
275900                 MOVE .1  TO ASC-CTN-VRNCE-PCT-VRFD               27060084
276000             END-IF                                               27070084
276100     ELSE                                                         27080011
276200         IF PC-CRNT-YR-CTN-VRFD-DC = ZERO                         27090041
276300             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-VRFD                 27100041
276400         ELSE                                                     27110041
276500             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-VRFD                 27120041
276600         END-IF                                                   27130041
276700     END-IF.                                                      27140011
276800     MOVE PC-CTN-VRNCE-VRFD-DC TO ASC-CTN-VRNCE-VRFD.             27150011
276900     IF PC-CRNT-YR-POR-VRFD-DC NOT = ZERO                         27160036
277000         DIVIDE PC-CRNT-YR-POR-VRFD-DC BY PC-CRNT-YR-POR-VRFD-CO  27170011
277100                 GIVING PV-DIVIDEND ROUNDED                       27180076
277200             MULTIPLY PV-DIVIDEND BY 100                          27190011
277300                 GIVING ASC-CRNT-POR-PRCT-VRFD                    27200011
277400             IF ASC-CRNT-POR-PRCT-VRFD = ZERO                     27201085
277500                 MOVE .1  TO ASC-CRNT-POR-PRCT-VRFD               27202085
277600             END-IF                                               27203085
277700     ELSE                                                         27210011
277800         MOVE ZERO TO ASC-CRNT-POR-PRCT-VRFD                      27220011
277900     END-IF.                                                      27230011
278000     MOVE PC-CRNT-YR-POR-VRFD-DC TO ASC-CRNT-YR-POR-VRFD.         27240011
278100     IF PC-PREV-YR-POR-VRFD-DC NOT = ZERO                         27250036
278200         DIVIDE PC-PREV-YR-POR-VRFD-DC BY PC-PREV-YR-POR-VRFD-CO  27260011
278300                 GIVING PV-DIVIDEND ROUNDED                       27270076
278400             MULTIPLY PV-DIVIDEND BY 100                          27280011
278500                 GIVING ASC-PREV-POR-PRCT-VRFD                    27290011
278600             IF ASC-PREV-POR-PRCT-VRFD = ZERO                     27291085
278700                 MOVE .1  TO ASC-PREV-POR-PRCT-VRFD               27292085
278800             END-IF                                               27293085
278900     ELSE                                                         27300011
279000         MOVE ZERO TO ASC-PREV-POR-PRCT-VRFD                      27310011
279100     END-IF.                                                      27320011
279200     MOVE PC-PREV-YR-POR-VRFD-DC TO ASC-PREV-YR-POR-VRFD.         27330011
279300     IF PC-PREV-YR-POR-VRFD-DC NOT = ZERO                         27340040
279400         DIVIDE PC-POR-VRNCE-VRFD-DC BY PC-PREV-YR-POR-VRFD-DC    27350040
279500                 GIVING PV-DIVIDEND ROUNDED                       27360076
279600             MULTIPLY PV-DIVIDEND BY 100                          27370011
279700                 GIVING ASC-POR-VRNCE-PCT-VRFD                    27380011
279800             IF ASC-POR-VRNCE-PCT-VRFD = ZERO                     27390084
279900                 MOVE .1  TO ASC-POR-VRNCE-PCT-VRFD               27400084
280000             END-IF                                               27410084
280100     ELSE                                                         27420011
280200         IF PC-CRNT-YR-POR-VRFD-DC = ZERO                         27430041
280300             MOVE ZEROS TO ASC-POR-VRNCE-PCT-VRFD                 27440041
280400         ELSE                                                     27450041
280500             MOVE 999.9 TO ASC-POR-VRNCE-PCT-VRFD                 27460041
280600         END-IF                                                   27470041
280700     END-IF.                                                      27480011
280800     MOVE PC-POR-VRNCE-VRFD-DC TO ASC-POR-VRNCE-VRFD.             27490011
280900                                                                  27500011
281000*----------------------------------------------------------------*27510011
281100*    CALCULATE PERCENTS FOR PROCESS GROUP/AREA TO COMPANY TOTALS  27520011
281200*----------------------------------------------------------------*27530011
281300 4520-CALC-PRCNT-PRCESS-CO.                                       27540011
281400     IF ASC-CRNT-YR-RTL-WRKD NOT = ZERO                           27550036
281500         DIVIDE ASC-CRNT-YR-RTL-WRKD BY PC-CRNT-YR-RTL-WRKD-CO    27560011
281600                 GIVING PV-DIVIDEND ROUNDED                       27570076
281700             MULTIPLY PV-DIVIDEND BY 100                          27580011
281800                 GIVING ASC-CRNT-PRCT-WRKD                        27590011
281900             IF ASC-CRNT-PRCT-WRKD     = ZERO                     27591085
282000                 MOVE .1  TO ASC-CRNT-PRCT-WRKD                   27592085
282100             END-IF                                               27593085
282200     ELSE                                                         27600011
282300         MOVE ZERO TO ASC-CRNT-PRCT-WRKD                          27610011
282400     END-IF.                                                      27620011
282500                                                                  27630011
282600     IF ASC-PREV-YR-RTL-WRKD NOT = ZERO                           27640036
282700         DIVIDE ASC-PREV-YR-RTL-WRKD BY PC-PREV-YR-RTL-WRKD-CO    27650011
282800                 GIVING PV-DIVIDEND ROUNDED                       27660076
282900             MULTIPLY PV-DIVIDEND BY 100                          27670011
283000                 GIVING ASC-PREV-PRCT-WRKD                        27680011
283100             IF ASC-PREV-PRCT-WRKD     = ZERO                     27681085
283200                 MOVE .1  TO ASC-PREV-PRCT-WRKD                   27682085
283300             END-IF                                               27683085
283400     ELSE                                                         27690011
283500         MOVE ZERO TO ASC-PREV-PRCT-WRKD                          27700011
283600     END-IF.                                                      27710011
283700                                                                  27720011
283800     IF ASC-PREV-YR-RTL-WRKD NOT = ZERO                           27730040
283900         DIVIDE ASC-RTL-VRNCE-WRKD BY ASC-PREV-YR-RTL-WRKD        27740040
284000                 GIVING PV-DIVIDEND ROUNDED                       27750076
284100             MULTIPLY PV-DIVIDEND BY 100                          27760011
284200                 GIVING ASC-RTL-VRNCE-PCT-WRKD                    27770011
284300             IF ASC-RTL-VRNCE-PCT-WRKD = ZERO                     27780084
284400                 MOVE .1  TO ASC-RTL-VRNCE-PCT-WRKD               27790084
284500             END-IF                                               27800084
284600     ELSE                                                         27810011
284700         IF ASC-CRNT-YR-RTL-WRKD = ZERO                           27820058
284800             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-WRKD                 27830041
284900         ELSE                                                     27840041
285000             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-WRKD                 27850041
285100         END-IF                                                   27860041
285200     END-IF.                                                      27870011
285300                                                                  27880011
285400     IF ASC-CRNT-YR-QTY-WRKD NOT = ZERO                           27890036
285500         DIVIDE ASC-CRNT-YR-QTY-WRKD BY PC-CRNT-YR-QTY-WRKD-CO    27900011
285600                 GIVING PV-DIVIDEND ROUNDED                       27910076
285700             MULTIPLY PV-DIVIDEND BY 100                          27920011
285800                 GIVING ASC-CRNT-QTY-PRCT-WRKD                    27930011
285900             IF ASC-CRNT-QTY-PRCT-WRKD = ZERO                     27931085
286000                 MOVE .1  TO ASC-CRNT-QTY-PRCT-WRKD               27932085
286100             END-IF                                               27933085
286200     ELSE                                                         27940011
286300         MOVE ZERO TO ASC-CRNT-QTY-PRCT-WRKD                      27950011
286400     END-IF.                                                      27960011
286500                                                                  27970011
286600     IF ASC-PREV-YR-QTY-WRKD NOT = ZERO                           27980036
286700         DIVIDE ASC-PREV-YR-QTY-WRKD BY PC-PREV-YR-QTY-WRKD-CO    27990011
286800                 GIVING PV-DIVIDEND ROUNDED                       28000076
286900             MULTIPLY PV-DIVIDEND BY 100                          28010011
287000                 GIVING ASC-PREV-QTY-PRCT-WRKD                    28020011
287100             IF ASC-PREV-QTY-PRCT-WRKD = ZERO                     28021085
287200                 MOVE .1  TO ASC-PREV-QTY-PRCT-WRKD               28022085
287300             END-IF                                               28023085
287400     ELSE                                                         28030011
287500         MOVE ZERO TO ASC-PREV-QTY-PRCT-WRKD                      28040011
287600     END-IF.                                                      28050011
287700                                                                  28060011
287800     IF ASC-PREV-YR-QTY-WRKD NOT = ZERO                           28070040
287900         DIVIDE ASC-QTY-VRNCE-WRKD BY ASC-PREV-YR-QTY-WRKD        28080040
288000                 GIVING PV-DIVIDEND ROUNDED                       28090076
288100             MULTIPLY PV-DIVIDEND BY 100                          28100011
288200                 GIVING ASC-QTY-VRNCE-PCT-WRKD                    28110011
288300             IF ASC-QTY-VRNCE-PCT-WRKD = ZERO                     28120084
288400                 MOVE .1  TO ASC-QTY-VRNCE-PCT-WRKD               28130084
288500             END-IF                                               28140084
288600     ELSE                                                         28150011
288700         IF ASC-CRNT-YR-QTY-WRKD = ZERO                           28160058
288800             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-WRKD                 28170041
288900         ELSE                                                     28180041
289000             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-WRKD                 28190041
289100         END-IF                                                   28200041
289200     END-IF.                                                      28210011
289300                                                                  28220011
289400     IF ASC-CRNT-YR-CTN-WRKD NOT = ZERO                           28230036
289500         DIVIDE ASC-CRNT-YR-CTN-WRKD BY PC-CRNT-YR-CTN-WRKD-CO    28240011
289600                 GIVING PV-DIVIDEND ROUNDED                       28250076
289700             MULTIPLY PV-DIVIDEND BY 100                          28260011
289800                 GIVING ASC-CRNT-CTN-PRCT-WRKD                    28270011
289900             IF ASC-CRNT-CTN-PRCT-WRKD = ZERO                     28271085
290000                 MOVE .1  TO ASC-CRNT-CTN-PRCT-WRKD               28272085
290100             END-IF                                               28273085
290200     ELSE                                                         28280011
290300         MOVE ZERO TO ASC-CRNT-CTN-PRCT-WRKD                      28290011
290400     END-IF.                                                      28300011
290500                                                                  28310011
290600     IF ASC-PREV-YR-CTN-WRKD NOT = ZERO                           28320036
290700         DIVIDE ASC-PREV-YR-CTN-WRKD BY PC-PREV-YR-CTN-WRKD-CO    28330011
290800                 GIVING PV-DIVIDEND ROUNDED                       28340076
290900             MULTIPLY PV-DIVIDEND BY 100                          28350011
291000                 GIVING ASC-PREV-CTN-PRCT-WRKD                    28360011
291100             IF ASC-PREV-CTN-PRCT-WRKD = ZERO                     28361085
291200                 MOVE .1  TO ASC-PREV-CTN-PRCT-WRKD               28362085
291300             END-IF                                               28363085
291400     ELSE                                                         28370011
291500         MOVE ZERO TO ASC-PREV-CTN-PRCT-WRKD                      28380011
291600     END-IF.                                                      28390011
291700                                                                  28400011
291800     IF ASC-PREV-YR-CTN-WRKD NOT = ZERO                           28410040
291900         DIVIDE ASC-CTN-VRNCE-WRKD BY ASC-PREV-YR-CTN-WRKD        28420040
292000                 GIVING PV-DIVIDEND ROUNDED                       28430076
292100             MULTIPLY PV-DIVIDEND BY 100                          28440011
292200                 GIVING ASC-CTN-VRNCE-PCT-WRKD                    28450011
292300             IF ASC-CTN-VRNCE-PCT-WRKD = ZERO                     28460084
292400                 MOVE .1  TO ASC-CTN-VRNCE-PCT-WRKD               28470084
292500             END-IF                                               28480084
292600     ELSE                                                         28490011
292700         IF ASC-CRNT-YR-CTN-WRKD = ZERO                           28500058
292800             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-WRKD                 28510041
292900         ELSE                                                     28520041
293000             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-WRKD                 28530041
293100         END-IF                                                   28540041
293200     END-IF.                                                      28550011
293300                                                                  28560011
293400     IF ASC-CRNT-YR-POR-WRKD NOT = ZERO                           28570036
293500         DIVIDE ASC-CRNT-YR-POR-WRKD BY PC-CRNT-YR-POR-WRKD-CO    28580011
293600                 GIVING PV-DIVIDEND ROUNDED                       28590076
293700             MULTIPLY PV-DIVIDEND BY 100                          28600011
293800                 GIVING ASC-CRNT-POR-PRCT-WRKD                    28610011
293900             IF ASC-CRNT-POR-PRCT-WRKD = ZERO                     28611085
294000                 MOVE .1  TO ASC-CRNT-POR-PRCT-WRKD               28612085
294100             END-IF                                               28613085
294200     ELSE                                                         28620011
294300         MOVE ZERO TO ASC-CRNT-POR-PRCT-WRKD                      28630011
294400     END-IF.                                                      28640011
294500                                                                  28650011
294600     IF ASC-PREV-YR-POR-WRKD > ZERO                               28660011
294700         DIVIDE ASC-PREV-YR-POR-WRKD BY PC-PREV-YR-POR-WRKD-CO    28670011
294800                 GIVING PV-DIVIDEND ROUNDED                       28680076
294900             MULTIPLY PV-DIVIDEND BY 100                          28690011
295000                 GIVING ASC-PREV-POR-PRCT-WRKD                    28700011
295100             IF ASC-PREV-POR-PRCT-WRKD = ZERO                     28701085
295200                 MOVE .1  TO ASC-PREV-POR-PRCT-WRKD               28702085
295300             END-IF                                               28703085
295400     ELSE                                                         28710011
295500         MOVE ZERO TO ASC-PREV-POR-PRCT-WRKD                      28720011
295600     END-IF.                                                      28730011
295700                                                                  28740011
295800     IF ASC-PREV-YR-POR-WRKD NOT = ZERO                           28750040
295900         DIVIDE ASC-POR-VRNCE-WRKD BY ASC-PREV-YR-POR-WRKD        28760040
296000                 GIVING PV-DIVIDEND ROUNDED                       28770076
296100             MULTIPLY PV-DIVIDEND BY 100                          28780011
296200                 GIVING ASC-POR-VRNCE-PCT-WRKD                    28790011
296300             IF ASC-POR-VRNCE-PCT-WRKD = ZERO                     28800084
296400                 MOVE .1  TO ASC-POR-VRNCE-PCT-WRKD               28810084
296500             END-IF                                               28820084
296600     ELSE                                                         28830011
296700         IF ASC-CRNT-YR-POR-WRKD = ZERO                           28840058
296800             MOVE ZEROS TO ASC-POR-VRNCE-PCT-WRKD                 28850041
296900         ELSE                                                     28860041
297000             MOVE 999.9 TO ASC-POR-VRNCE-PCT-WRKD                 28870041
297100         END-IF                                                   28880041
297200     END-IF.                                                      28890011
297300                                                                  28900011
297400     IF ASC-CRNT-YR-RTL-VRFD NOT = ZERO                           28910036
297500         DIVIDE ASC-CRNT-YR-RTL-VRFD BY PC-CRNT-YR-RTL-VRFD-CO    28920011
297600                 GIVING PV-DIVIDEND ROUNDED                       28930076
297700             MULTIPLY PV-DIVIDEND BY 100                          28940011
297800                 GIVING ASC-CRNT-PRCT-VRFD                        28950011
297900             IF ASC-CRNT-PRCT-VRFD     = ZERO                     28951085
298000                 MOVE .1  TO ASC-CRNT-PRCT-VRFD                   28952085
298100             END-IF                                               28953085
298200     ELSE                                                         28960011
298300         MOVE ZERO TO ASC-CRNT-PRCT-VRFD                          28970011
298400     END-IF.                                                      28980011
298500                                                                  28990011
298600     IF ASC-PREV-YR-RTL-VRFD NOT = ZERO                           29000036
298700         DIVIDE ASC-PREV-YR-RTL-VRFD BY PC-PREV-YR-RTL-VRFD-CO    29010011
298800                 GIVING PV-DIVIDEND ROUNDED                       29020076
298900             MULTIPLY PV-DIVIDEND BY 100                          29030011
299000                 GIVING ASC-PREV-PRCT-VRFD                        29040011
299100             IF ASC-PREV-PRCT-VRFD     = ZERO                     29041085
299200                 MOVE .1  TO ASC-PREV-PRCT-VRFD                   29042085
299300             END-IF                                               29043085
299400     ELSE                                                         29050011
299500         MOVE ZERO TO ASC-PREV-PRCT-VRFD                          29060011
299600     END-IF.                                                      29070011
299700                                                                  29080011
299800     IF ASC-PREV-YR-RTL-VRFD NOT = ZERO                           29090040
299900         DIVIDE ASC-RTL-VRNCE-VRFD BY ASC-PREV-YR-RTL-VRFD        29100040
300000                 GIVING PV-DIVIDEND ROUNDED                       29110076
300100             MULTIPLY PV-DIVIDEND BY 100                          29120011
300200                 GIVING ASC-RTL-VRNCE-PCT-VRFD                    29130011
300300             IF ASC-RTL-VRNCE-PCT-VRFD = ZERO                     29140084
300400                 MOVE .1  TO ASC-RTL-VRNCE-PCT-VRFD               29150084
300500             END-IF                                               29160084
300600     ELSE                                                         29170011
300700         IF ASC-CRNT-YR-RTL-VRFD = ZERO                           29180058
300800             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-VRFD                 29190041
300900         ELSE                                                     29200041
301000             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-VRFD                 29210041
301100         END-IF                                                   29220041
301200     END-IF.                                                      29230011
301300                                                                  29240011
301400     IF ASC-CRNT-YR-QTY-VRFD NOT = ZERO                           29250036
301500         DIVIDE ASC-CRNT-YR-QTY-VRFD BY PC-CRNT-YR-QTY-VRFD-CO    29260011
301600                 GIVING PV-DIVIDEND ROUNDED                       29270076
301700             MULTIPLY PV-DIVIDEND BY 100                          29280011
301800                 GIVING ASC-CRNT-QTY-PRCT-VRFD                    29290011
301900             IF ASC-CRNT-QTY-PRCT-VRFD = ZERO                     29291085
302000                 MOVE .1  TO ASC-CRNT-QTY-PRCT-VRFD               29292085
302100             END-IF                                               29293085
302200     ELSE                                                         29300011
302300         MOVE ZERO TO ASC-CRNT-QTY-PRCT-VRFD                      29310011
302400     END-IF.                                                      29320011
302500                                                                  29330011
302600     IF ASC-PREV-YR-QTY-VRFD NOT = ZERO                           29340036
302700         DIVIDE ASC-PREV-YR-QTY-VRFD BY PC-PREV-YR-QTY-VRFD-CO    29350011
302800                 GIVING PV-DIVIDEND ROUNDED                       29360076
302900             MULTIPLY PV-DIVIDEND BY 100                          29370011
303000                 GIVING ASC-PREV-QTY-PRCT-VRFD                    29380011
303100             IF ASC-PREV-QTY-PRCT-VRFD = ZERO                     29381085
303200                 MOVE .1  TO ASC-PREV-QTY-PRCT-VRFD               29382085
303300             END-IF                                               29383085
303400     ELSE                                                         29390011
303500         MOVE ZERO TO ASC-PREV-QTY-PRCT-VRFD                      29400011
303600     END-IF.                                                      29410011
303700                                                                  29420011
303800     IF ASC-PREV-YR-QTY-VRFD NOT = ZERO                           29430040
303900         DIVIDE ASC-QTY-VRNCE-VRFD BY ASC-PREV-YR-QTY-VRFD        29440040
304000                 GIVING PV-DIVIDEND ROUNDED                       29450076
304100             MULTIPLY PV-DIVIDEND BY 100                          29460011
304200                 GIVING ASC-QTY-VRNCE-PCT-VRFD                    29470011
304300             IF ASC-QTY-VRNCE-PCT-VRFD = ZERO                     29471084
304400                 MOVE .1  TO ASC-QTY-VRNCE-PCT-VRFD               29472084
304500             END-IF                                               29473084
304600     ELSE                                                         29480011
304700         IF ASC-CRNT-YR-QTY-VRFD = ZERO                           29490058
304800             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-VRFD                 29500041
304900         ELSE                                                     29510041
305000             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-VRFD                 29520041
305100         END-IF                                                   29530041
305200     END-IF.                                                      29540011
305300                                                                  29550011
305400     IF ASC-CRNT-YR-CTN-VRFD NOT = ZERO                           29560036
305500         DIVIDE ASC-CRNT-YR-CTN-VRFD BY PC-CRNT-YR-CTN-VRFD-CO    29570011
305600                 GIVING PV-DIVIDEND ROUNDED                       29580076
305700             MULTIPLY PV-DIVIDEND BY 100                          29590011
305800                 GIVING ASC-CRNT-CTN-PRCT-VRFD                    29600011
305900             IF ASC-CRNT-CTN-PRCT-VRFD = ZERO                     29601085
306000                 MOVE .1  TO ASC-CRNT-CTN-PRCT-VRFD               29602085
306100             END-IF                                               29603085
306200     ELSE                                                         29610011
306300         MOVE ZERO TO ASC-CRNT-CTN-PRCT-VRFD                      29620011
306400     END-IF.                                                      29630011
306500                                                                  29640011
306600     IF ASC-PREV-YR-CTN-VRFD NOT = ZERO                           29650036
306700         DIVIDE ASC-PREV-YR-CTN-VRFD BY PC-PREV-YR-CTN-VRFD-CO    29660011
306800                 GIVING PV-DIVIDEND ROUNDED                       29670076
306900             MULTIPLY PV-DIVIDEND BY 100                          29680011
307000                 GIVING ASC-PREV-CTN-PRCT-VRFD                    29690011
307100             IF ASC-PREV-CTN-PRCT-VRFD = ZERO                     29691085
307200                 MOVE .1  TO ASC-PREV-CTN-PRCT-VRFD               29692085
307300             END-IF                                               29693085
307400     ELSE                                                         29700011
307500         MOVE ZERO TO ASC-PREV-CTN-PRCT-VRFD                      29710011
307600     END-IF.                                                      29720011
307700                                                                  29730011
307800     IF ASC-PREV-YR-CTN-VRFD NOT = ZERO                           29740040
307900         DIVIDE ASC-CTN-VRNCE-VRFD BY ASC-PREV-YR-CTN-VRFD        29750040
308000                 GIVING PV-DIVIDEND ROUNDED                       29760076
308100             MULTIPLY PV-DIVIDEND BY 100                          29770011
308200                 GIVING ASC-CTN-VRNCE-PCT-VRFD                    29780011
308300             IF ASC-CTN-VRNCE-PCT-VRFD = ZERO                     29781084
308400                 MOVE .1  TO ASC-CTN-VRNCE-PCT-VRFD               29782084
308500             END-IF                                               29783084
308600     ELSE                                                         29790011
308700         IF ASC-CRNT-YR-CTN-VRFD = ZERO                           29800058
308800             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-VRFD                 29810041
308900         ELSE                                                     29820041
309000             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-VRFD                 29830041
309100         END-IF                                                   29840041
309200     END-IF.                                                      29850011
309300                                                                  29860011
309400     IF ASC-CRNT-YR-POR-VRFD NOT = ZERO                           29870036
309500         DIVIDE ASC-CRNT-YR-POR-VRFD BY PC-CRNT-YR-POR-VRFD-CO    29880011
309600                 GIVING PV-DIVIDEND ROUNDED                       29890076
309700             MULTIPLY PV-DIVIDEND BY 100                          29900011
309800                 GIVING ASC-CRNT-POR-PRCT-VRFD                    29910011
309900             IF ASC-CRNT-POR-PRCT-VRFD = ZERO                     29911085
310000                 MOVE .1  TO ASC-CRNT-POR-PRCT-VRFD               29912085
310100             END-IF                                               29913085
310200     ELSE                                                         29920011
310300         MOVE ZERO TO ASC-CRNT-POR-PRCT-VRFD                      29930011
310400     END-IF.                                                      29940011
310500                                                                  29950011
310600     IF ASC-PREV-YR-POR-VRFD NOT = ZERO                           29960036
310700         DIVIDE ASC-PREV-YR-POR-VRFD BY PC-PREV-YR-POR-VRFD-CO    29970011
310800                 GIVING PV-DIVIDEND ROUNDED                       29980076
310900             MULTIPLY PV-DIVIDEND BY 100                          29990011
311000                 GIVING ASC-PREV-POR-PRCT-VRFD                    30000011
311100             IF ASC-PREV-POR-PRCT-VRFD = ZERO                     30001085
311200                 MOVE .1  TO ASC-PREV-POR-PRCT-VRFD               30002085
311300             END-IF                                               30003085
311400     ELSE                                                         30010011
311500         MOVE ZERO TO ASC-PREV-POR-PRCT-VRFD                      30020011
311600     END-IF.                                                      30030011
311700                                                                  30040011
311800     IF ASC-PREV-YR-POR-VRFD NOT = ZERO                           30050040
311900         DIVIDE ASC-POR-VRNCE-VRFD BY ASC-PREV-YR-POR-VRFD        30060040
312000                 GIVING PV-DIVIDEND ROUNDED                       30070076
312100             MULTIPLY PV-DIVIDEND BY 100                          30080011
312200                 GIVING ASC-POR-VRNCE-PCT-VRFD                    30090011
312300             IF ASC-POR-VRNCE-PCT-VRFD = ZERO                     30091084
312400                 MOVE .1  TO ASC-POR-VRNCE-PCT-VRFD               30092084
312500             END-IF                                               30093084
312600     ELSE                                                         30100011
312700         IF ASC-CRNT-YR-POR-VRFD = ZERO                           30110058
312800             MOVE ZEROS TO ASC-POR-VRNCE-PCT-VRFD                 30120041
312900         ELSE                                                     30130041
313000             MOVE 999.9 TO ASC-POR-VRNCE-PCT-VRFD                 30140041
313100         END-IF                                                   30150041
313200     END-IF.                                                      30160011
313300                                                                  30170011
313400*----------------------------------------------------------------*30180011
313500*    CALCULATE PERCENTS FOR PROCESS GROUP/AREA TO DC TOTALS       30190011
313600*----------------------------------------------------------------*30200011
313700 4530-CALC-PRCNT-PRCESS-DC.                                       30210011
313800     IF ASC-CRNT-YR-RTL-WRKD NOT = ZERO                           30220036
313900         DIVIDE ASC-CRNT-YR-RTL-WRKD BY PC-CRNT-YR-RTL-WRKD-DC    30230011
314000                 GIVING PV-DIVIDEND ROUNDED                       30240076
314100             MULTIPLY PV-DIVIDEND BY 100                          30250011
314200                 GIVING ASC-CRNT-PRCT-WRKD                        30260011
314300             IF ASC-CRNT-PRCT-WRKD     = ZERO                     30261085
314400                 MOVE .1  TO ASC-CRNT-PRCT-WRKD                   30262085
314500             END-IF                                               30263085
314600     ELSE                                                         30270011
314700         MOVE ZERO TO ASC-CRNT-PRCT-WRKD                          30280011
314800     END-IF.                                                      30290011
314900                                                                  30300011
315000     IF ASC-PREV-YR-RTL-WRKD NOT = ZERO                           30310036
315100         DIVIDE ASC-PREV-YR-RTL-WRKD BY PC-PREV-YR-RTL-WRKD-DC    30320011
315200                 GIVING PV-DIVIDEND ROUNDED                       30330076
315300             MULTIPLY PV-DIVIDEND BY 100                          30340011
315400                 GIVING ASC-PREV-PRCT-WRKD                        30350011
315500             IF ASC-PREV-PRCT-WRKD     = ZERO                     30351085
315600                 MOVE .1  TO ASC-PREV-PRCT-WRKD                   30352085
315700             END-IF                                               30353085
315800     ELSE                                                         30360011
315900         MOVE ZERO TO ASC-PREV-PRCT-WRKD                          30370011
316000     END-IF.                                                      30380011
316100                                                                  30390011
316200     IF ASC-PREV-YR-RTL-WRKD NOT = ZERO                           30400040
316300         DIVIDE ASC-RTL-VRNCE-WRKD BY ASC-PREV-YR-RTL-WRKD        30410040
316400                 GIVING PV-DIVIDEND ROUNDED                       30420076
316500             MULTIPLY PV-DIVIDEND BY 100                          30430011
316600                 GIVING ASC-RTL-VRNCE-PCT-WRKD                    30440011
316700             IF ASC-RTL-VRNCE-PCT-WRKD = ZERO                     30441084
316800                 MOVE .1  TO ASC-RTL-VRNCE-PCT-WRKD               30442084
316900             END-IF                                               30443084
317000     ELSE                                                         30450011
317100         IF ASC-CRNT-YR-RTL-WRKD = ZERO                           30460058
317200             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-WRKD                 30470041
317300         ELSE                                                     30480041
317400             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-WRKD                 30490041
317500         END-IF                                                   30500041
317600     END-IF.                                                      30510011
317700                                                                  30520011
317800     IF ASC-CRNT-YR-QTY-WRKD NOT = ZERO                           30530036
317900         DIVIDE ASC-CRNT-YR-QTY-WRKD BY PC-CRNT-YR-QTY-WRKD-DC    30540011
318000                 GIVING PV-DIVIDEND ROUNDED                       30550076
318100             MULTIPLY PV-DIVIDEND BY 100                          30560011
318200                 GIVING ASC-CRNT-QTY-PRCT-WRKD                    30570011
318300             IF ASC-CRNT-QTY-PRCT-WRKD = ZERO                     30571085
318400                 MOVE .1  TO ASC-CRNT-QTY-PRCT-WRKD               30572085
318500             END-IF                                               30573085
318600     ELSE                                                         30580011
318700         MOVE ZERO TO ASC-CRNT-QTY-PRCT-WRKD                      30590011
318800     END-IF.                                                      30600011
318900                                                                  30610011
319000     IF ASC-PREV-YR-QTY-WRKD NOT = ZERO                           30620036
319100         DIVIDE ASC-PREV-YR-QTY-WRKD BY PC-PREV-YR-QTY-WRKD-DC    30630011
319200                 GIVING PV-DIVIDEND ROUNDED                       30640076
319300             MULTIPLY PV-DIVIDEND BY 100                          30650011
319400                 GIVING ASC-PREV-QTY-PRCT-WRKD                    30660011
319500             IF ASC-PREV-QTY-PRCT-WRKD = ZERO                     30661085
319600                 MOVE .1  TO ASC-PREV-QTY-PRCT-WRKD               30662085
319700             END-IF                                               30663085
319800     ELSE                                                         30670011
319900         MOVE ZERO TO ASC-PREV-QTY-PRCT-WRKD                      30680011
320000     END-IF.                                                      30690011
320100                                                                  30700011
320200     IF ASC-PREV-YR-QTY-WRKD NOT = ZERO                           30710040
320300         DIVIDE ASC-QTY-VRNCE-WRKD BY ASC-PREV-YR-QTY-WRKD        30720040
320400                 GIVING PV-DIVIDEND ROUNDED                       30730076
320500             MULTIPLY PV-DIVIDEND BY 100                          30740011
320600                 GIVING ASC-QTY-VRNCE-PCT-WRKD                    30750011
320700             IF ASC-QTY-VRNCE-PCT-WRKD = ZERO                     30751084
320800                 MOVE .1  TO ASC-QTY-VRNCE-PCT-WRKD               30752084
320900             END-IF                                               30753084
321000     ELSE                                                         30760011
321100         IF ASC-CRNT-YR-QTY-WRKD = ZERO                           30770058
321200             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-WRKD                 30780041
321300         ELSE                                                     30790041
321400             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-WRKD                 30800041
321500         END-IF                                                   30810041
321600     END-IF.                                                      30820011
321700                                                                  30830011
321800     IF ASC-CRNT-YR-CTN-WRKD NOT = ZERO                           30840036
321900         DIVIDE ASC-CRNT-YR-CTN-WRKD BY PC-CRNT-YR-CTN-WRKD-DC    30850011
322000                 GIVING PV-DIVIDEND ROUNDED                       30860076
322100             MULTIPLY PV-DIVIDEND BY 100                          30870011
322200                 GIVING ASC-CRNT-CTN-PRCT-WRKD                    30880011
322300             IF ASC-CRNT-CTN-PRCT-WRKD = ZERO                     30881085
322400                 MOVE .1  TO ASC-CRNT-CTN-PRCT-WRKD               30882085
322500             END-IF                                               30883085
322600     ELSE                                                         30890011
322700         MOVE ZERO TO ASC-CRNT-CTN-PRCT-WRKD                      30900011
322800     END-IF.                                                      30910011
322900                                                                  30920011
323000     IF ASC-PREV-YR-CTN-WRKD NOT = ZERO                           30930036
323100         DIVIDE ASC-PREV-YR-CTN-WRKD BY PC-PREV-YR-CTN-WRKD-DC    30940011
323200                 GIVING PV-DIVIDEND ROUNDED                       30950076
323300             MULTIPLY PV-DIVIDEND BY 100                          30960011
323400                 GIVING ASC-PREV-CTN-PRCT-WRKD                    30970011
323500             IF ASC-PREV-CTN-PRCT-WRKD = ZERO                     30971085
323600                 MOVE .1  TO ASC-PREV-CTN-PRCT-WRKD               30972085
323700             END-IF                                               30973085
323800     ELSE                                                         30980011
323900         MOVE ZERO TO ASC-PREV-CTN-PRCT-WRKD                      30990011
324000     END-IF.                                                      31000011
324100                                                                  31010011
324200     IF ASC-PREV-YR-CTN-WRKD NOT = ZERO                           31020040
324300         DIVIDE ASC-CTN-VRNCE-WRKD BY ASC-PREV-YR-CTN-WRKD        31030040
324400                 GIVING PV-DIVIDEND ROUNDED                       31040076
324500             MULTIPLY PV-DIVIDEND BY 100                          31050011
324600                 GIVING ASC-CTN-VRNCE-PCT-WRKD                    31060011
324700             IF ASC-CTN-VRNCE-PCT-WRKD = ZERO                     31061084
324800                 MOVE .1  TO ASC-CTN-VRNCE-PCT-WRKD               31062084
324900             END-IF                                               31063084
325000     ELSE                                                         31070011
325100         IF ASC-CRNT-YR-CTN-WRKD = ZERO                           31080058
325200             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-WRKD                 31090041
325300         ELSE                                                     31100041
325400             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-WRKD                 31110041
325500         END-IF                                                   31120041
325600     END-IF.                                                      31130011
325700                                                                  31140011
325800     IF ASC-CRNT-YR-POR-WRKD NOT = ZERO                           31150036
325900         DIVIDE ASC-CRNT-YR-POR-WRKD BY PC-CRNT-YR-POR-WRKD-DC    31160011
326000                 GIVING PV-DIVIDEND ROUNDED                       31170076
326100             MULTIPLY PV-DIVIDEND BY 100                          31180011
326200                 GIVING ASC-CRNT-POR-PRCT-WRKD                    31190011
326300             IF ASC-CRNT-POR-PRCT-WRKD = ZERO                     31191085
326400                 MOVE .1  TO ASC-CRNT-POR-PRCT-WRKD               31192085
326500             END-IF                                               31193085
326600     ELSE                                                         31200011
326700         MOVE ZERO TO ASC-CRNT-POR-PRCT-WRKD                      31210011
326800     END-IF.                                                      31220011
326900                                                                  31230011
327000     IF ASC-PREV-YR-POR-WRKD NOT = ZERO                           31240036
327100         DIVIDE ASC-PREV-YR-POR-WRKD BY PC-PREV-YR-POR-WRKD-DC    31250011
327200                 GIVING PV-DIVIDEND ROUNDED                       31260076
327300             MULTIPLY PV-DIVIDEND BY 100                          31270011
327400                 GIVING ASC-PREV-POR-PRCT-WRKD                    31280011
327500             IF ASC-PREV-POR-PRCT-WRKD = ZERO                     31281085
327600                 MOVE .1  TO ASC-PREV-POR-PRCT-WRKD               31282085
327700             END-IF                                               31283085
327800     ELSE                                                         31290011
327900         MOVE ZERO TO ASC-PREV-POR-PRCT-WRKD                      31300011
328000     END-IF.                                                      31310011
328100                                                                  31320011
328200     IF ASC-PREV-YR-POR-WRKD NOT = ZERO                           31330040
328300         DIVIDE ASC-POR-VRNCE-WRKD BY ASC-PREV-YR-POR-WRKD        31340040
328400                 GIVING PV-DIVIDEND ROUNDED                       31350076
328500             MULTIPLY PV-DIVIDEND BY 100                          31360011
328600                 GIVING ASC-POR-VRNCE-PCT-WRKD                    31370011
328700             IF ASC-POR-VRNCE-PCT-WRKD = ZERO                     31371084
328800                 MOVE .1  TO ASC-POR-VRNCE-PCT-WRKD               31372084
328900             END-IF                                               31373084
329000     ELSE                                                         31380011
329100         IF ASC-CRNT-YR-POR-WRKD = ZERO                           31390058
329200             MOVE ZEROS TO ASC-POR-VRNCE-PCT-WRKD                 31400041
329300         ELSE                                                     31410041
329400             MOVE 999.9 TO ASC-POR-VRNCE-PCT-WRKD                 31420041
329500         END-IF                                                   31430041
329600     END-IF.                                                      31440011
329700                                                                  31450011
329800     IF ASC-CRNT-YR-RTL-VRFD NOT = ZERO                           31460036
329900         DIVIDE ASC-CRNT-YR-RTL-VRFD BY PC-CRNT-YR-RTL-VRFD-DC    31470011
330000                 GIVING PV-DIVIDEND ROUNDED                       31480076
330100             MULTIPLY PV-DIVIDEND BY 100                          31490011
330200                 GIVING ASC-CRNT-PRCT-VRFD                        31500011
330300             IF ASC-CRNT-PRCT-VRFD     = ZERO                     31501085
330400                 MOVE .1  TO ASC-CRNT-PRCT-VRFD                   31502085
330500             END-IF                                               31503085
330600     ELSE                                                         31510011
330700         MOVE ZERO TO ASC-CRNT-PRCT-VRFD                          31520011
330800     END-IF.                                                      31530011
330900                                                                  31540011
331000     IF ASC-PREV-YR-RTL-VRFD NOT = ZERO                           31550036
331100         DIVIDE ASC-PREV-YR-RTL-VRFD BY PC-PREV-YR-RTL-VRFD-DC    31560011
331200                 GIVING PV-DIVIDEND ROUNDED                       31570076
331300             MULTIPLY PV-DIVIDEND BY 100                          31580011
331400                 GIVING ASC-PREV-PRCT-VRFD                        31590011
331500             IF ASC-PREV-PRCT-VRFD     = ZERO                     31591085
331600                 MOVE .1  TO ASC-PREV-PRCT-VRFD                   31592085
331700             END-IF                                               31593085
331800     ELSE                                                         31600011
331900         MOVE ZERO TO ASC-PREV-PRCT-VRFD                          31610011
332000     END-IF.                                                      31620011
332100                                                                  31630011
332200     IF ASC-PREV-YR-RTL-VRFD NOT = ZERO                           31640040
332300         DIVIDE ASC-RTL-VRNCE-VRFD BY ASC-PREV-YR-RTL-VRFD        31650040
332400                 GIVING PV-DIVIDEND ROUNDED                       31660076
332500             MULTIPLY PV-DIVIDEND BY 100                          31670011
332600                 GIVING ASC-RTL-VRNCE-PCT-VRFD                    31680011
332700             IF ASC-RTL-VRNCE-PCT-VRFD = ZERO                     31681084
332800                 MOVE .1  TO ASC-RTL-VRNCE-PCT-VRFD               31682084
332900             END-IF                                               31683084
333000     ELSE                                                         31690011
333100         IF ASC-CRNT-YR-RTL-VRFD = ZERO                           31700058
333200             MOVE ZEROS TO ASC-RTL-VRNCE-PCT-VRFD                 31710041
333300         ELSE                                                     31720041
333400             MOVE 999.9 TO ASC-RTL-VRNCE-PCT-VRFD                 31730041
333500         END-IF                                                   31740041
333600     END-IF.                                                      31750011
333700                                                                  31760011
333800     IF ASC-CRNT-YR-QTY-VRFD NOT = ZERO                           31770036
333900         DIVIDE ASC-CRNT-YR-QTY-VRFD BY PC-CRNT-YR-QTY-VRFD-DC    31780011
334000                 GIVING PV-DIVIDEND ROUNDED                       31790076
334100             MULTIPLY PV-DIVIDEND BY 100                          31800011
334200                 GIVING ASC-CRNT-QTY-PRCT-VRFD                    31810011
334300             IF ASC-CRNT-QTY-PRCT-VRFD = ZERO                     31811085
334400                 MOVE .1  TO ASC-CRNT-QTY-PRCT-VRFD               31812085
334500             END-IF                                               31813085
334600     ELSE                                                         31820011
334700         MOVE ZERO TO ASC-CRNT-QTY-PRCT-VRFD                      31830011
334800     END-IF.                                                      31840011
334900                                                                  31850011
335000     IF ASC-PREV-YR-QTY-VRFD NOT = ZERO                           31860036
335100         DIVIDE ASC-PREV-YR-QTY-VRFD BY PC-PREV-YR-QTY-VRFD-DC    31870011
335200                 GIVING PV-DIVIDEND ROUNDED                       31880076
335300             MULTIPLY PV-DIVIDEND BY 100                          31890011
335400                 GIVING ASC-PREV-QTY-PRCT-VRFD                    31900011
335500             IF ASC-PREV-QTY-PRCT-VRFD = ZERO                     31901085
335600                 MOVE .1  TO ASC-PREV-QTY-PRCT-VRFD               31902085
335700             END-IF                                               31903085
335800     ELSE                                                         31910011
335900         MOVE ZERO TO ASC-PREV-QTY-PRCT-VRFD                      31920011
336000     END-IF.                                                      31930011
336100                                                                  31940011
336200     IF ASC-PREV-YR-QTY-VRFD NOT = ZERO                           31950040
336300         DIVIDE ASC-QTY-VRNCE-VRFD BY ASC-PREV-YR-QTY-VRFD        31960040
336400                 GIVING PV-DIVIDEND ROUNDED                       31970076
336500             MULTIPLY PV-DIVIDEND BY 100                          31980011
336600                 GIVING ASC-QTY-VRNCE-PCT-VRFD                    31990011
336700             IF ASC-QTY-VRNCE-PCT-VRFD = ZERO                     31991084
336800                 MOVE .1  TO ASC-QTY-VRNCE-PCT-VRFD               31992084
336900             END-IF                                               31993084
337000     ELSE                                                         32000011
337100         IF ASC-CRNT-YR-QTY-VRFD = ZERO                           32010058
337200             MOVE ZEROS TO ASC-QTY-VRNCE-PCT-VRFD                 32020041
337300         ELSE                                                     32030041
337400             MOVE 999.9 TO ASC-QTY-VRNCE-PCT-VRFD                 32040041
337500         END-IF                                                   32050041
337600     END-IF.                                                      32060011
337700                                                                  32070011
337800     IF ASC-CRNT-YR-CTN-VRFD NOT = ZERO                           32080058
337900         DIVIDE ASC-CRNT-YR-CTN-VRFD BY PC-CRNT-YR-CTN-VRFD-DC    32090058
338000                 GIVING PV-DIVIDEND ROUNDED                       32100076
338100             MULTIPLY PV-DIVIDEND BY 100                          32110011
338200                 GIVING ASC-CRNT-CTN-PRCT-VRFD                    32120011
338300             IF ASC-CRNT-CTN-PRCT-VRFD = ZERO                     32121085
338400                 MOVE .1  TO ASC-CRNT-CTN-PRCT-VRFD               32122085
338500             END-IF                                               32123085
338600     ELSE                                                         32130011
338700         MOVE ZERO TO ASC-CRNT-CTN-PRCT-VRFD                      32140058
338800     END-IF.                                                      32150011
338900                                                                  32160011
339000     IF ASC-PREV-YR-CTN-VRFD NOT = ZERO                           32170036
339100         DIVIDE ASC-PREV-YR-CTN-VRFD BY PC-PREV-YR-CTN-VRFD-DC    32180011
339200                 GIVING PV-DIVIDEND ROUNDED                       32190076
339300             MULTIPLY PV-DIVIDEND BY 100                          32200011
339400                 GIVING ASC-PREV-CTN-PRCT-VRFD                    32210011
339500             IF ASC-PREV-CTN-PRCT-VRFD = ZERO                     32211085
339600                 MOVE .1  TO ASC-PREV-CTN-PRCT-VRFD               32212085
339700             END-IF                                               32213085
339800     ELSE                                                         32220011
339900         MOVE ZERO TO ASC-PREV-CTN-PRCT-VRFD                      32230058
340000     END-IF.                                                      32240011
340100                                                                  32250011
340200     IF ASC-PREV-YR-CTN-VRFD NOT = ZERO                           32260058
340300         DIVIDE ASC-CTN-VRNCE-VRFD BY ASC-PREV-YR-CTN-VRFD        32270058
340400                 GIVING PV-DIVIDEND ROUNDED                       32280076
340500             MULTIPLY PV-DIVIDEND BY 100                          32290058
340600                 GIVING ASC-CTN-VRNCE-PCT-VRFD                    32300058
340700             IF ASC-CTN-VRNCE-PCT-VRFD = ZERO                     32301084
340800                 MOVE .1  TO ASC-CTN-VRNCE-PCT-VRFD               32302084
340900             END-IF                                               32303084
341000     ELSE                                                         32310058
341100         IF ASC-CRNT-YR-CTN-VRFD = ZERO                           32320058
341200             MOVE ZEROS TO ASC-CTN-VRNCE-PCT-VRFD                 32330058
341300         ELSE                                                     32340058
341400             MOVE 999.9 TO ASC-CTN-VRNCE-PCT-VRFD                 32350058
341500         END-IF                                                   32360058
341600     END-IF.                                                      32370058
341700                                                                  32380011
341800     IF ASC-CRNT-YR-POR-VRFD NOT = ZERO                           32390036
341900         DIVIDE ASC-CRNT-YR-POR-VRFD BY PC-CRNT-YR-POR-VRFD-DC    32400011
342000                 GIVING PV-DIVIDEND ROUNDED                       32410076
342100             MULTIPLY PV-DIVIDEND BY 100                          32420011
342200                 GIVING ASC-CRNT-POR-PRCT-VRFD                    32430011
342300             IF ASC-CRNT-POR-PRCT-VRFD = ZERO                     32431085
342400                 MOVE .1  TO ASC-CRNT-POR-PRCT-VRFD               32432085
342500             END-IF                                               32433085
342600     ELSE                                                         32440011
342700         MOVE ZERO TO ASC-CRNT-POR-PRCT-VRFD                      32450011
342800     END-IF.                                                      32460011
342900                                                                  32470011
343000     IF ASC-PREV-YR-POR-VRFD NOT = ZERO                           32480036
343100         DIVIDE ASC-PREV-YR-POR-VRFD BY PC-PREV-YR-POR-VRFD-DC    32490011
343200                 GIVING PV-DIVIDEND ROUNDED                       32500076
343300             MULTIPLY PV-DIVIDEND BY 100                          32510011
343400                 GIVING ASC-PREV-POR-PRCT-VRFD                    32520011
343500             IF ASC-PREV-POR-PRCT-VRFD = ZERO                     32521085
343600                 MOVE .1  TO ASC-PREV-POR-PRCT-VRFD               32522085
343700             END-IF                                               32523085
343800     ELSE                                                         32530011
343900         MOVE ZERO TO ASC-PREV-POR-PRCT-VRFD                      32540011
344000     END-IF.                                                      32550011
344100                                                                  32560011
344200     IF ASC-PREV-YR-POR-VRFD NOT = ZERO                           32570040
344300         DIVIDE ASC-POR-VRNCE-VRFD BY ASC-PREV-YR-POR-VRFD        32580040
344400                 GIVING PV-DIVIDEND ROUNDED                       32590076
344500             MULTIPLY PV-DIVIDEND BY 100                          32600011
344600                 GIVING ASC-POR-VRNCE-PCT-VRFD                    32610011
344700             IF ASC-POR-VRNCE-PCT-VRFD = ZERO                     32611084
344800                 MOVE .1  TO ASC-POR-VRNCE-PCT-VRFD               32612084
344900             END-IF                                               32613084
345000     ELSE                                                         32620011
345100         IF ASC-CRNT-YR-POR-VRFD = ZERO                           32630058
345200             MOVE ZEROS TO ASC-POR-VRNCE-PCT-VRFD                 32640041
345300         ELSE                                                     32650041
345400             MOVE 999.9 TO ASC-POR-VRNCE-PCT-VRFD                 32660041
345500         END-IF                                                   32670041
345600     END-IF.                                                      32680011
345700                                                                  32690011
345800*----------------------------------------------------------------*32700047
345900*    RETRIEVE CURRENT DATE                                        32710047
346000*----------------------------------------------------------------*32720047
346100 5000-RETRIEVE-CURR-DATE.                                         32730047
346200     EXEC SQL                                                     32740047
346300          SELECT DISTINCT(CURRENT DATE)                           32750049
346400            INTO  :PV-CURRENT-DATE                                32760047
346500           FROM XLT_LOC                                           32770089
346600     END-EXEC.                                                    32780047
346700                                                                  32790047
346800      EVALUATE TRUE                                               32800048
346900          WHEN SQLCODE = +0                                       32810048
347000              CONTINUE                                            32820048
347100          WHEN OTHER                                              32830048
347200              MOVE '5000-RETRIEVE-CURR-DATE ' TO DP013-PARAGRAPH  32840048
347300              MOVE 'RETRIEVING CURR DTE' TO DP013-MESSAGE-TEXT (1)32850048
347400              MOVE SQLCA   TO DP013-SQLCA                         32860048
347500              MOVE 'XLT_LOC' TO DP013-DB2-TABLE-NAME (1)          32870089
347600              SET DP013-DB2-ABEND                                 32880048
347700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              32890048
347800              PERFORM DP013-0000-PROCESS-ABEND                    32900048
347900      END-EVALUATE.                                               32910048
348000*----------------------------------------------------------------*32920047
348100*  CREATE TITLE LINES AND GET PREVIOUS DATES                      32930047
348200*----------------------------------------------------------------*32940047
348300 5200-CREATE-TITLE-LINES.                                         32950047
348400     STRING 'CURRENT.: ' DELIMITED BY SIZE                        32960047
348500            'BUSINESS DATE RANGE ' DELIMITED BY SIZE              32970047
348600            DK-FROM-DATE  DELIMITED BY SIZE                       32980047
348700            ' TO '        DELIMITED BY SIZE                       32990047
348800            DK-TO-DATE    DELIMITED BY SIZE                       33000047
348900               INTO ASC-TITLE2.                                   33010047
349000     STRING 'PREVIOUS: ' DELIMITED BY SIZE                        33020047
349100            'BUSINESS DATE RANGE ' DELIMITED BY SIZE              33030047
349200            DK-PREV-FROM-DATE  DELIMITED BY SIZE                  33040047
349300            ' TO '        DELIMITED BY SIZE                       33050047
349400            DK-PREV-TO-DATE    DELIMITED BY SIZE                  33060047
349500               INTO ASC-TITLE3.                                   33070047
349600                                                                  33080047
349700 7000-GET-WEEK52.                                                         
349800*    GET DATA FROM WEEK 52 OF THE PREVIOUS FISCAL YEAR.                   
349900                                                                          
350000     EXEC SQL                                                             
350100         SELECT                                                           
350200             LY_THIS_DAY_KY_DTE                                           
350300         INTO :DTATTR-LY-THIS-DAY-KY-DTE                          10710091
350400         FROM TDTATTR                                                     
350500         WHERE                                                            
350600             FSCL_YR_NBR = :DTATTR-FSCL-YR-NBR                            
350700         AND FSCL_MN_NBR = :DTATTR-FSCL-MN-NBR                            
350800         AND FSCL_WK_NBR = '52'                                           
350900         AND DAY_OF_WK_NBR = :DTATTR-DAY-OF-WK-NBR                        
351000                                                                          
351100     END-EXEC                                                             
351200                                                                          
351300     EVALUATE TRUE                                                10760001
351400         WHEN SQLCODE = ZERO                                      10770001
351500             CONTINUE                                                     
351600                                                                          
351700         WHEN SQLCODE = +100                                      10790001
351800         WHEN SQLCODE = -802                                      10790001
351900             SET PS-ERROR                                         10800001
352000                  DP020-MSG-FATAL         TO TRUE                 10810001
352100             MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER      10820001
352200         WHEN OTHER                                               10830001
352300             MOVE '7000-GET-WEEK52    '   TO DP013-PARAGRAPH      10840008
352400             MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)   10850001
352500             MOVE SQLCA   TO DP013-SQLCA                          10860001
352600             MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)          10870001
352700             SET DP013-DB2-ABEND                                  10880001
352800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10890001
352900             PERFORM DP013-0000-PROCESS-ABEND                     10900001
353000     END-EVALUATE.                                                10910001
353100                                                                          
353200*-----------------------------------------------------------------33090052
353300*  READ THE LIST QUEUE RECORD                                     33100052
353400*-----------------------------------------------------------------33110052
353500 9100-READ-SEL-QUEUE.                                             33120052
353600                                                                  33130052
353700     EXEC CICS                                                    33140052
353800         READQ TS                                                 33150052
353900             QUEUE (ASC-SEL-QUEUE-NAME)                           33160052
354000             INTO  (PC215-SELECT-RECORD)                          33170052
354100             ITEM  (ASC-SEL-ITEM)                                 33180052
354200             RESP  (PV-CICS-RESPONSE)                             33190057
354300     END-EXEC.                                                    33200052
354400     IF PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                    33210057
354500         CONTINUE                                                 33220052
354600     ELSE                                                         33230052
354700         SET DP013-LOGIC-ABEND                                    33240052
354800             DP013-NO-ROLLBACK   TO   TRUE                        33250052
354900         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          33260052
355000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   33270052
355100                                 TO   DP013-MESSAGE-TEXT (1)      33280052
355200         PERFORM DP013-0000-PROCESS-ABEND                         33290052
355300     END-IF.                                                      33300052
355400                                                                  33310052
355500*-----------------------------------------------------------------33320052
355600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *33330052
355700*-----------------------------------------------------------------33340052
355800 9200-REWRITE-SEL-QUEUE.                                          33350052
355900                                                                  33360052
356000     EXEC CICS                                                    33370052
356100          WRITEQ TS                                               33380052
356200              QUEUE  (ASC-SEL-QUEUE-NAME)                         33390052
356300              FROM   (PC215-SELECT-RECORD)                        33400052
356400              ITEM   (ASC-SEL-ITEM)                               33410052
356500              RESP   (PV-CICS-RESPONSE)                           33420057
356600              REWRITE                                             33430052
356700     END-EXEC.                                                    33440052
356800                                                                  33450052
356900     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               33460057
357000         SET DP013-CICS-ABEND                                     33470052
357100             DP013-NO-ROLLBACK     TO TRUE                        33480052
357200         MOVE '9200-REWRITE-SEL-QUEUE'                            33490052
357300                                   TO DP013-PARAGRAPH             33500052
357400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33510052
357500                                   TO DP013-MESSAGE-TEXT (1)      33520052
357600         PERFORM DP013-0000-PROCESS-ABEND                         33530052
357700     END-IF.                                                      33540052
357800                                                                  33550052
357900*----------------------------------------------------------------*33560011
358000*    ABEND PROCESSOR MODULE                                      *33570011
358100*----------------------------------------------------------------*33580011
358200     COPY DPPD013.                                                33590011
358300                                                                  33600001
