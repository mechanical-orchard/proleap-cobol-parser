000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKRF882.                                00040000
000500 AUTHOR.                 DEANNA BRANTNER.                         00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            MAY, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM DISPLAYS A CARTON'S PURCHASE ORDER AND OTHER INFO  00110000
001200* ON THE LRT (LASER RADIO TERMINAL) AND ACCEPTS AN F-KEY.         00120000
001300******************************************************************00130000
001400******************************************************************00140068
001500*  CHANGED 04/23/13 BY C. PARMLEY          PR#5148B              *00150066
001600*  SET RFID INDICATOR IN 7400- PARA                              *00160066
001700*  TAGGED BY PR5148B - CLP - 04/23/2013                          *00170066
001800*                                          CRQ#:0055296          *00180066
001900*                                                                *00190066
002000*  CHANGED 12/17/13 BY C. PARMLEY          PR#5148D              *00200066
002100*  CHECK FOR RFID AUD STATUS IN 7555-CHECK-RFID-AUDIT-STAT       *00210066
002200*  SO IF RFID AUDIT FAILED STILL GET THE CORRECT CASI CODE ON    *00220066
002300*  THE LABEL.                                                    *00230066
002400*                                          CRQ#:0068598          *00240066
002500*  CHANGED 07/12/17 BY J. ARENDT      CHG0176459                 *00250068
002600*  ADDED CODE TO PROGRAM FOR THE "RFID TAG YOUR STORE / SHORT    *00260068
002700*  -TERM SOLUTION" PROJECT.                                      *00270068
002800******************************************************************00280066
002900 ENVIRONMENT DIVISION.                                            00290000
003000 DATA DIVISION.                                                   00300000
003100                                                                  00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300******************************************************************00330000
003400 01  CA-COMMAREA.                                                 00340000
003500     COPY PCWS038.                                                00350000
003600     COPY PCWS233.                                                00360000
003700   02  CA-COMMAREA-SW           PIC X(1).                         00370000
003800       88  CA-USE-PCWS233-COMMAREA    VALUE 'A'.                  00380000
003900       88  CA-USE-PCWS038-COMMAREA    VALUE 'B'.                  00390000
004000   02  CA-LAST-PROGRAM          PIC X(8).                         00400000
004100       88  CA-LAST-PROG-PCKRF868      VALUE 'PCKRF868'.           00410000
004200       88  CA-LAST-PROG-PCKRF884      VALUE 'PCKRF884'.           00420000
004300                                                                  00430000
004400******************************************************************00440000
004500* COMMAREA FOR PCKRF888                                           00450000
004600******************************************************************00460000
004700     COPY PCWS039.                                                00470000
004800                                                                  00480000
004900******************************************************************00490000
005000 01  DK-DB2-KEYS.                                                 00500000
005100     05  DK-PO-NBR                PIC  S9(9) COMP.                00510000
005200     05  DK-PO-RCVR               PIC  S9(9) COMP.                00520000
005300     05  DK-OPER-UNT-ID           PIC S9(4)   COMP-3.             00530000
005400     05  DK-STORE-NUMBER          PIC S9(4)   COMP-3.             00540000
005500     05  DK-STR-NBR               PIC 9(4) VALUE ZEROES.          00550000
005600     05  DK-STR-NBR-N REDEFINES DK-STR-NBR.                       00560000
005700         10  FILLER               PIC 9(1).                       00570000
005800         10  DK-STR-NBR-1-3       PIC 9(3).                       00580000
005900     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00590000
006000     05  DK-SHIPT-UNT-ID-2        PIC S9(18)V COMP-3.             00600000
006100     05  DK-SHIPT-UNT-ID-3        PIC S9(18)V COMP-3.             00610000
006200     05  DK-PURCHASE-ORDER        PIC  S9(9) COMP VALUE ZEROES.   00620000
006300     05  DK-PURCHASE-ORDER-N      PIC   9(9) VALUE ZEROES.        00630000
006400     05  DK-PURCHASE-ORDER-X REDEFINES DK-PURCHASE-ORDER-N.       00640000
006500         10  DK-PURCHS-ORD        PIC   X(9).                     00650000
006600     05  DK-RCVR-NBR              PIC  S9(9) COMP VALUE ZEROES.   00660000
006700     05  DK-RCVR-NBR-N            PIC   9(9) VALUE ZEROES.        00670000
006800     05  DK-RCVR-NBR-X  REDEFINES DK-RCVR-NBR-N.                  00680000
006900         10  FILLER               PIC   9(6).                     00690000
007000         10  DK-RECVR-NBR         PIC   X(3).                     00700000
007100     05  DK-LNE-NBR               PIC  S9(9) COMP VALUE ZEROES.   00710000
007200     05  DK-LNE-NBR-N             PIC   9(9) VALUE ZEROES.        00720000
007300     05  DK-LINE-NBR-X  REDEFINES DK-LNE-NBR-N.                   00730000
007400         10  FILLER               PIC   X(6).                     00740000
007500         10  DK-LINE-NBR          PIC   X(3).                     00750000
007600     05  DK-PREPK-ID              PIC  S9(4) COMP VALUE ZEROES.   00760000
007700     05  DK-STATUS-CDE            PIC   X(2) VALUE SPACES.        00770050
007800                                                                  00780000
007900 01  PC-PROGRAM-CONSTANTS.                                        00790000
008000     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00800000
008100                                                     COMP SYNC.   00810000
008200     05  PC-CALLED-FROM-PG               PIC  X(08)  VALUE SPACES.00820000
008300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00830000
008400         'PCKRF882'.                                              00840000
008500     05  PC-OTHER-PGM                    PIC  X(08)  VALUE        00850000
008600         'PCKRF880'.                                              00860000
008700     05  PC-NEXT-PGM                     PIC  X(08)  VALUE        00870000
008800         'PCKRF883'.                                              00880000
008900     05  PC-PRTR-VALIDATION-PGM      PIC  X(08)  VALUE 'DPKCS060'.00890000
009000     05  PC-REPORT-PGM               PIC  X(08)  VALUE 'PCKRF881'.00900001
009100     05  PC-DC-RF-APPL-PGM               PIC  X(08)  VALUE        00910000
009200         'MPKCS027'.                                              00920000
009300     05  PC-DUPLICATE                    PIC  X(04)  VALUE 'E882'.00930000
009400     05  PC-LABEL-INFO-PGM               PIC  X(08)  VALUE        00940000
009500         'PCKRF888'.                                              00950000
009600     05  PC-LOCATION-MODULE              PIC  X(08)  VALUE        00960043
009700         'XLKUT071'.                                              00970031
009800     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00980000
009900         'END OF SESSION     '.                                   00990000
010000     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        01000000
010100         'INVALID SELECTION  '.                                   01010000
010200     05  PC-INVALID-VALUE-MSG            PIC  X(19)  VALUE        01020000
010300         'INVALID VALUE      '.                                   01030000
010400     05  PC-INVALID-PRTR-ID              PIC  X(19)  VALUE        01040000
010500         'INVALID PRINTER ID '.                                   01050000
010600     05  PC-NEED-PRTR-ID                 PIC  X(19)  VALUE        01060000
010700         'NEED PRINTER ID    '.                                   01070000
010800     05  PC-SOCKET-COMM-ERROR            PIC  X(19)  VALUE        01080000
010900         'SOCKET COMM ERROR  '.                                   01090000
011000     05  PC-INVALID-PRT-FMT              PIC  X(19)  VALUE        01100000
011100         'INVALID PRINT FORMT'.                                   01110000
011200     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01120000
011300         'UNRECOGNIZED PF KEY'.                                   01130000
011400     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        01140000
011500         'USER NOT AUTHORIZED'.                                   01150000
011600     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        01160000
011700         'NUMERIC VALUE REQ. '.                                   01170000
011800     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01180000
011900         'TRANS NOT AVAILABLE'.                                   01190000
012000     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        01200000
012100         'CICS ABEND -CALL DP'.                                   01210000
012200     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        01220000
012300         'CICSAUTH BAD RETURN'.                                   01230000
012400     05  PC-CICS-888-MSG                 PIC  X(19)  VALUE        01240000
012500         'CICS 888 BAD RETURN'.                                   01250000
012600     05  PC-CICS-707-MSG                 PIC  X(19)  VALUE        01260000
012700         'CICS 707 BAD RETURN'.                                   01270000
012800     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        01280000
012900         'SELECTION NOT AVAIL'.                                   01290000
013000     05  PC-CARTON-STATUS-ERROR          PIC X(19)   VALUE        01300000
013100         'CARTON STATUS ERROR'.                                   01310000
013200     05  PC-LBL-PRINT-MSG                PIC X(19)   VALUE        01320000
013300         'LABEL PRT REQUESTED'.                                   01330000
013400     05  PC-NO-LABEL-AVAILABLE           PIC  X(19)  VALUE        01340000
013500         'NO LABEL AVAILABLE '.                                   01350000
013600     05  PC-INNPK-USE-KOHLS-SML           PIC  X(19)  VALUE       01360000
013700         'INRPK-USE KOHLS SML'.                                   01370000
013800     05  PC-A                       PIC X(01)   VALUE 'A'.        01380000
013900     05  PC-E                       PIC X(01)   VALUE 'E'.        01390000
014000     05  PC-G                       PIC X(01)   VALUE 'G'.        01400000
014100     05  PC-I                       PIC X(01)   VALUE 'I'.        01410000
014200     05  PC-K                       PIC X(01)   VALUE 'K'.        01420000
014300     05  PC-N                       PIC X(01)   VALUE 'N'.        01430000
014400     05  PC-P                       PIC X(01)   VALUE 'P'.        01440000
014500     05  PC-Q                       PIC X(01)   VALUE 'Q'.        01450000
014600     05  PC-S                       PIC X(01)   VALUE 'S'.        01460000
014700     05  PC-Y                       PIC X(01)   VALUE 'Y'.        01470000
014800     05  PC-01                      PIC X(02)   VALUE '01'.       01480000
014900     05  PC-02                      PIC X(02)   VALUE '02'.       01490001
015000     05  PC-03                      PIC X(02)   VALUE '03'.       01500000
015100     05  PC-05                      PIC X(02)   VALUE '05'.       01510000
015200     05  PC-90                      PIC  X(02)  VALUE '90'.       01520000
015300     05  PC-MGMX                    PIC X(04)   VALUE 'MGMX'.     01530000
015400     05  PC-SHOF                    PIC X(04)   VALUE 'SHOF'.     01540000
015500     05  PC-SHON                    PIC X(04)   VALUE 'SHON'.     01550000
015600     05  PC-VENDOR-ASN              PIC X(10) VALUE 'VENDOR ASN'. 01560000
015700     05  PC-CHECK-IN                PIC X(10) VALUE 'CHECK IN  '. 01570000
015800     05  PC-CSEPK-SPLT              PIC X(10) VALUE 'CSEPK SPLT'. 01580000
015900     05  PC-MANUAL                  PIC X(10) VALUE 'MANUAL    '. 01590000
016000     05  PC-PCK-2-LIT               PIC X(10) VALUE 'PCK-2-LITE'. 01600000
016100     05  PC-RECEIVING               PIC X(10) VALUE 'RECEIVING '. 01610000
016200     05  PC-RDM                     PIC X(10) VALUE 'RDM       '. 01620000
016300     05  PC-SMOOTHING               PIC X(10) VALUE 'SMOOTHING '. 01630000
016400     05  PC-FAST-XFER               PIC X(10) VALUE 'FAST XFER '. 01640000
016500     05  PC-MSTR-CNTR               PIC X(10) VALUE 'MSTR CONTR'. 01650000
016600     05  PC-CRTN-BULD               PIC X(10) VALUE 'CRTN BUILD'. 01660000
016700     05  PC-JEWELRY                 PIC X(10) VALUE 'P2L-JEWLRY'. 01670027
016800     05  PC-DAMAGED                 PIC X(10) VALUE 'DAMAGED   '. 01680027
016810     05  PC-3WD-PRTY-WHSE           PIC X(10) VALUE '3PRTY WHSE'. 01681069
016900     05  PC-UNKNOWN                 PIC X(10) VALUE 'UNKNOWN   '. 01690000
017000     05  PC-ASN                     PIC X(03) VALUE 'ASN'.        01700000
017100     05  PC-CKN                     PIC X(03) VALUE 'CKN'.        01710000
017200     05  PC-CPS                     PIC X(03) VALUE 'CPS'.        01720000
017300     05  PC-MAN                     PIC X(03) VALUE 'MAN'.        01730000
017400     05  PC-P2L                     PIC X(03) VALUE 'P2L'.        01740000
017500     05  PC-RCV                     PIC X(03) VALUE 'RCV'.        01750000
017600     05  PC-RDM2                    PIC X(03) VALUE 'RDM'.        01760000
017700     05  PC-SMO                     PIC X(03) VALUE 'SMO'.        01770000
017800     05  PC-FXR                     PIC X(03) VALUE 'FXR'.        01780000
017900     05  PC-MST                     PIC X(03) VALUE 'MST'.        01790000
018000     05  PC-MSC                     PIC X(03) VALUE 'MSC'.        01800000
018100     05  PC-JWL                     PIC X(03) VALUE 'JWL'.        01810027
018200     05  PC-DMG                     PIC X(03) VALUE 'DMG'.        01820027
018210     05  PC-3WD                     PIC X(03) VALUE '3WD'.        01821069
018300     05  PC-SPACES                  PIC X(03) VALUE '   '.        01830000
018400                                                                  01840012
018500     05  PC-TABLE-MAX               PIC S9(04) COMP               01850012
018600                                               VALUE +500.        01860012
018700                                                                  01870000
018800                                                                  01880000
018900 01  PS-PROGRAM-SWITCHES.                                         01890000
019000     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01900000
019100         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01910000
019200         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01920000
019300     05  PS-PRINTER-FOUND-SW             PIC  X(01)  VALUE 'N'.   01930000
019400         88  PS-NO-PRINTER-FOUND                     VALUE 'N'.   01940000
019500         88  PS-PRINTER-FOUND                        VALUE 'Y'.   01950000
019600     05  PS-PRINTER-INVALID-SW           PIC  X(01)  VALUE 'N'.   01960000
019700         88  PS-PRINTER-VALID                        VALUE 'N'.   01970000
019800         88  PS-PRINTER-INVALID                      VALUE 'Y'.   01980000
019900     05  PS-PREPK-SAME-MULTIPLE          PIC  X(01)  VALUE 'N'.   01990000
020000         88  PS-PREPK-SAME-MULTIPLE-NO               VALUE 'N'.   02000000
020100         88  PS-PREPK-SAME-MULTIPLE-YES              VALUE 'Y'.   02010000
020200     05  PS-ADJUSTMENT-SW                PIC  X(01)  VALUE 'N'.   02020000
020300         88  PS-ADJ-NO                               VALUE 'N'.   02030000
020400         88  PS-ADJ-YES                              VALUE 'Y'.   02040000
020500     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   02050000
020600         88  PS-ERROR-NO                             VALUE 'N'.   02060000
020700         88  PS-ERROR-YES                            VALUE 'Y'.   02070000
020800     05  PS-FOUND-ON-TLBVRDA-SW          PIC  X(01)  VALUE  'N'.  02080000
020900         88  PS-FOUND-ON-TLBVRDA                     VALUE  'Y'.  02090000
021000         88  PS-NOT-FOUND-TLBVRDA                    VALUE  'N'.  02100000
021100     05  PS-ZERO-RCVR-SEQ-SW             PIC  X(01)  VALUE 'Y'.   02110029
021200         88  PS-ZERO-RCVR-SEQ-YES                    VALUE 'Y'.   02120029
021300         88  PS-ZERO-RCVR-SEQ-NO                     VALUE 'N'.   02130025
021400                                                                  02140000
021500  01 PT-INDEXES.                                                  02150000
021600     05  PT-TABLE-ENTRIES           PIC 9(5)  VALUE ZEROES.       02160000
021700     05  PT-PREPK-TABLE-ENTRIES     PIC 9(5)  VALUE ZEROES.       02170000
021800                                                                  02180000
021900 01  PT-PURCHASE-ORDER-TABLE.                                     02190000
022000     05  PT-PURCHASE-ORDER-INFO OCCURS 500 TIMES                  02200000
022100                      INDEXED BY PT-PO-IDX.                       02210000
022200         10  PT-PURCHASE-ORDER      PIC  S9(9) COMP VALUE ZEROES. 02220000
022300         10  PT-RCVR-NBR            PIC  S9(9) COMP VALUE ZEROES. 02230000
022400         10  PT-DEPT                PIC   X(3) VALUE SPACE.       02240000
022500         10  PT-PKGNG-CDE           PIC   X(1) VALUE SPACE.       02250000
022600             88  PT-PREPK-PO              VALUE 'M', 'I'.         02260000
022700         10  PT-UPC-NBR            PIC  S9(15)V COMP-3 VALUE ZERO.02270000
022800         10  PT-LNE-NBR             PIC  S9(9) COMP  VALUE ZEROES.02280000
022900         10  PT-LNE-SW              PIC   X(1)       VALUE SPACE. 02290000
023000             88  PT-SINGLE-LINE             VALUE 'S'.            02300000
023100             88  PT-MULTI-LINE              VALUE 'M'.            02310000
023200             88  PT-NO-LINE                 VALUE ' '.            02320000
023300         10  PT-PREPK-ID            PIC  S9(4) COMP VALUE ZEROES. 02330000
023400         10  PT-PREPK-SW            PIC   X(1) VALUE SPACE.       02340000
023500             88  PT-SINGLE-PREPK           VALUE 'S'.             02350000
023600             88  PT-MULTI-PREPK            VALUE 'M'.             02360000
023700             88  PT-NO-PREPK               VALUE ' '.             02370000
023800         10  PT-NBR-UNITS           PIC   9(09)  VALUE ZEROES.    02380000
023900         10  PT-NBR-PACKS           PIC   9(09)  VALUE ZEROES.    02390000
024000                                                                  02400000
024100 01  PT-PREPK-LINE-TABLE.                                         02410000
024200     05  PT-PREPK-LINE-INFO    OCCURS 1000 TIMES                  02420000
024300                      INDEXED BY PT-PREPK-IDX.                    02430000
024400         10  PT-PREPK-LNE-NBR         PIC  9(9) VALUE ZEROES.     02440000
024500         10  PT-PREPK-LNE-RATIO       PIC  9(4) VALUE ZEROES.     02450000
024600         10  PT-PREPK-NBR-UNITS       PIC  9(9) VALUE ZEROES.     02460000
024700         10  PT-PREPK-MULTIPLE        PIC  9(4) VALUE ZEROES.     02470000
024800         10  PT-PREPK-REMAINDER       PIC  9(9) VALUE ZEROES.     02480000
024900                                                                  02490000
025000 01  PV-PROGRAM-VARIABLES.                                        02500000
025100     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02510000
025200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0.    02520000
025300     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  02530000
025400                                                     COMP SYNC.   02540000
025500     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02550000
025600     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  02560000
025700                                                     COMP SYNC.   02570000
025800     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02580000
025900     05  PV-DUPLICATE-IND                PIC  X(01)  VALUE SPACE. 02590000
026000         88 PV-VALID-DUP-IND             VALUE 'Y', 'N'.          02600000
026100     05  PV-LABEL-IND                    PIC  X(01)  VALUE SPACE. 02610000
026200         88 PV-VALID-LBL-IND             VALUE 'Y', 'N'.          02620000
026300     05  PV-FKEY-MSG1.                                            02630000
026400         10  FILLER                      PIC  X(19)  VALUE        02640000
026500             'PRESS ENTER TO CONT'.                               02650000
026600     05  PV-FKEY-MSG2.                                            02660000
026700         10  FILLER                      PIC  X(19)  VALUE        02670000
026800             'LBL REQ  F3 TO CONT'.                               02680000
026900     05  PV-DB2-TIMESTAMP                PIC  X(26).              02690000
027000     05  PV-DB2-REFORMAT-DATE.                                    02700000
027100         10  PV-DB2-DATE-YY              PIC  X(02).              02710000
027200         10  FILLER                      PIC  X(01).              02720000
027300         10  PV-DB2-DATE-MM              PIC  X(02).              02730000
027400         10  FILLER                      PIC  X(01).              02740000
027500         10  PV-DB2-DATE-DD              PIC  X(02).              02750000
027600     05  PV-DISPLAY-DATE.                                         02760000
027700         10  PV-DISPLAY-DATE-MM          PIC  X(02).              02770000
027800         10  FILLER                      PIC  X(01)  VALUE '/'.   02780000
027900         10  PV-DISPLAY-DATE-DD          PIC  X(02).              02790000
028000         10  FILLER                      PIC  X(01)  VALUE '/'.   02800000
028100         10  PV-DISPLAY-DATE-YY          PIC  X(02).              02810000
028200     05  PV-SU-BC-DIVERT-CODE.                                    02820000
028300         10  FILLER                      PIC X(02).               02830000
028400         10  PV-SU-BC-DIVERT-CD          PIC Z(03).               02840000
028500     05  PV-IP-ADDRESS                   PIC X(15).               02850000
028600     05 PV-DC-5-CHAR-ABBR                PIC X(05) VALUE SPACES.  02860000
028700     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          02870000
028800         10 FILLER                       PIC  X(03).              02880000
028900         10 PV-2-DIGIT-DC-ABBR           PIC  X(02).              02890000
029000     05  PV-LINE-SHPD-UNITS              PIC S9(9)V COMP-3.       02900000
029100     05  PV-PREPK-TOT-UNITS              PIC  9(09) VALUE ZEROES. 02910000
029200     05  PV-PREPK-SHPD-UNITS             PIC S9(9)V COMP-3.       02920020
029300     05  PV-PREPK-RATIO-UNITS            PIC S9(4)V COMP.         02930022
029400     05  PV-PREPK-IN-CRTN                PIC S9(9)V COMP-3.       02940021
029500     05  PV-PREPK-MULTIPLE               PIC  9(09) VALUE ZEROES. 02950000
029600     05  PV-CRTN-TOTAL-UNITS             PIC  9(09) VALUE ZEROES. 02960000
029700     05  PV-CRTN-TOTAL-UNITS-N REDEFINES PV-CRTN-TOTAL-UNITS.     02970000
029800         10  FILLER                      PIC  9(05).              02980000
029900         10  PV-CRTN-TOTAL-UNTS          PIC  9(04).              02990000
030000     05  PV-CRTN-TOTAL-PACKS             PIC  9(09) VALUE ZEROES. 03000000
030100     05  PV-CRTN-TOTAL-PACKS-N REDEFINES PV-CRTN-TOTAL-PACKS.     03010000
030200         10  FILLER                      PIC  9(05).              03020000
030300         10  PV-CRTN-TOTAL-PAKS          PIC  9(04).              03030000
030400     05  PV-CHILDRN-IN-MASTER            PIC S9(09) VALUE +0 COMP.03040000
030500     05  PV-CHLDN-IN-MSTR                PIC  9(09) VALUE ZEROES. 03050000
030600     05  PV-CHLD-IN-MSTR-N  REDEFINES PV-CHLDN-IN-MSTR.           03060000
030700         10  FILLER                      PIC  9(05).              03070000
030800         10  PV-CHLD-IN-MSTR             PIC  9(04).              03080000
030900                                                                  03090000
031000     05  PV-LAST5-SHIPT-UNT-ID         PIC  9(18)  VALUE ZEROES.  03100000
031100     05  PV-LAST5-SHIPT-UNT-ID-R REDEFINES PV-LAST5-SHIPT-UNT-ID. 03110000
031200         10  FILLER                    PIC  9(13).                03120000
031300         10  PV-LAST5-VNDR-BC          PIC  9(05).                03130000
031400******************************************************************03140031
031500*    DOMAIN ITEM MODULE                                           03150009
031600******************************************************************03160031
031700     COPY XLWS001.                                                03170009
031800                                                                  03180031
031900******************************************************************03190031
032000*    LOCATION MODULE                                              03200031
032100******************************************************************03210031
032200     COPY XLWS071.                                                03220031
032300                                                                  03230031
032400******************************************************************03240000
032500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               03250000
032600******************************************************************03260000
032700     COPY DPWS013.                                                03270000
032800                                                                  03280000
032900******************************************************************03290000
033000*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        03300000
033100******************************************************************03310000
033200     COPY DPWS008.                                                03320000
033300                                                                  03330000
033400******************************************************************03340000
033500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 03350000
033600******************************************************************03360000
033700     COPY DPWS010I.                                               03370000
033800                                                                  03380000
033900******************************************************************03390000
034000*  GENERATED DSECT FOR THE PCKM882 MAPSET                         03400000
034100******************************************************************03410000
034200     COPY PCKM882.                                                03420000
034300                                                                  03430000
034400******************************************************************03440000
034500*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   03450000
034600******************************************************************03460000
034700     COPY DPWS015.                                                03470000
034800                                                                  03480000
034900******************************************************************03490000
035000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      03500000
035100******************************************************************03510000
035200     COPY DFHAID.                                                 03520000
035300                                                                  03530000
035400******************************************************************03540000
035500*  COMPILE INFORMATION FOR HELP SCREEN                            03550000
035600******************************************************************03560000
035700     COPY PCWS188.                                                03570000
035800                                                                  03580000
035900******************************************************************03590000
036000*  COMMUNICATION AREA FOR HELP SCREEN PROGRAM                     03600000
036100******************************************************************03610000
036200     COPY PCWS192.                                                03620000
036300                                                                  03630000
036400******************************************************************03640000
036500*  PRINTER VALIDATION ROUTINE COPYBOOK                            03650000
036600******************************************************************03660000
036700     COPY DPWS072.                                                03670000
036800                                                                  03680000
036900******************************************************************03690000
037000*  LABEL PRINT MODULE COMMUNICATION AREA                          03700000
037100******************************************************************03710000
037200     COPY PCWS140.                                                03720000
037300                                                                  03730000
037400*-----------------------------------------------------------------03740000
037500*  THE PURCHASING ITEM TABLE                                      03750000
037600*-----------------------------------------------------------------03760000
037700     EXEC SQL                                                     03770000
037800         INCLUDE TPURITM                                          03780000
037900     END-EXEC.                                                    03790000
038000                                                                  03800000
038100*-----------------------------------------------------------------03810000
038200* THE RECEVING ITEM TABLE                                         03820000
038300*-----------------------------------------------------------------03830000
038400     EXEC SQL                                                     03840000
038500         INCLUDE TRECITM                                          03850000
038600     END-EXEC.                                                    03860000
038700                                                                  03870000
038800*-----------------------------------------------------------------03880000
038900*  THE PURCHASING TABLE                                           03890000
039000*-----------------------------------------------------------------03900000
039100     EXEC SQL                                                     03910000
039200         INCLUDE TPURCHS                                          03920000
039300     END-EXEC.                                                    03930000
039400                                                                  03940000
039500*-----------------------------------------------------------------03950000
039600*                                                                 03960000
039700*-----------------------------------------------------------------03970000
039800     EXEC SQL                                                     03980000
039900         INCLUDE TPKSLIP                                          03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
040200*-----------------------------------------------------------------04020053
040300*                                                                 04030053
040400*-----------------------------------------------------------------04040053
040500     EXEC SQL                                                     04050053
040600         INCLUDE TSHPUNT                                          04060053
040700     END-EXEC.                                                    04070053
040800                                                                  04080053
040900*-----------------------------------------------------------------04090053
041000*                                                                 04100053
041100*-----------------------------------------------------------------04110053
041200     EXEC SQL                                                     04120053
041300         INCLUDE TINPKSU                                          04130053
041400     END-EXEC.                                                    04140053
041500                                                                  04150053
041600*-----------------------------------------------------------------04160000
041700*                                                                 04170000
041800*-----------------------------------------------------------------04180000
041900     EXEC SQL                                                     04190000
042000         INCLUDE SUT00026                                         04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300*-----------------------------------------------------------------04230000
042400*                                                                 04240000
042500*-----------------------------------------------------------------04250000
042600     EXEC SQL                                                     04260000
042700         INCLUDE TSUQADJ                                          04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000*-----------------------------------------------------------------04300000
043100*  THE RECEIVING TABLE                                            04310000
043200*-----------------------------------------------------------------04320000
043300     EXEC SQL                                                     04330000
043400         INCLUDE TRECEIV                                          04340000
043500     END-EXEC.                                                    04350000
043600                                                                  04360000
043700*-----------------------------------------------------------------04370000
043800*  THE SHIPPING UNIT TABLE                                        04380000
043900*-----------------------------------------------------------------04390000
044000     EXEC SQL                                                     04400000
044100         INCLUDE SUT00024                                         04410000
044200     END-EXEC.                                                    04420000
044300                                                                  04430000
044400*-----------------------------------------------------------------04440000
044500*  THE UPC TABLE                                                  04450000
044600*-----------------------------------------------------------------04460000
044700     EXEC SQL                                                     04470000
044800         INCLUDE SUT00028                                         04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100*-----------------------------------------------------------------04510000
045200*  THE CARTON DIVERT (FROM CONVEYOR SYSTEM) TABLE                 04520000
045300*-----------------------------------------------------------------04530000
045400     EXEC SQL                                                     04540000
045500         INCLUDE TSUCRDV                                          04550000
045600     END-EXEC.                                                    04560000
045700                                                                  04570000
045800*-----------------------------------------------------------------04580000
045900*  DB2 TABLE FOR VIRTUAL LABEL DATA                               04590000
046000*-----------------------------------------------------------------04600000
046100     EXEC SQL                                                     04610000
046200          INCLUDE TLBVRDA                                         04620000
046300     END-EXEC.                                                    04630000
046400                                                                  04640000
046500*-----------------------------------------------------------------04650000
046600*  DB2 TABLE FOR DISTRIBUTION HEADER                              04660000
046700*-----------------------------------------------------------------04670000
046800     EXEC SQL                                                     04680000
046900          INCLUDE TDISTHD                                         04690000
047000     END-EXEC.                                                    04700000
047100                                                                  04710000
047200*-----------------------------------------------------------------04720000
047300*  DB2 TABLE FOR DISTRIBUTION DETAIL                              04730000
047400*-----------------------------------------------------------------04740000
047500     EXEC SQL                                                     04750000
047600          INCLUDE TDISTDT                                         04760000
047700     END-EXEC.                                                    04770000
047800                                                                  04780000
047900*-----------------------------------------------------------------04790000
048000*  CARTON AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)                    04800000
048100*-----------------------------------------------------------------04810000
048200     EXEC SQL                                                     04820000
048300         INCLUDE SUT00015                                         04830000
048400     END-EXEC.                                                    04840000
048500                                                                  04850000
048600************************************************************      04860000
048700*    DEFINITION FOR CURSOR.                                       04870000
048800************************************************************      04880000
048900     EXEC SQL                                                     04890000
049000          DECLARE CART-UPC-PO-CSR CURSOR FOR                      04900000
049100          SELECT  DISTINCT TRN_NBR                                04910000
049200                 ,RCVR_SEQ_NBR                                    04920000
049300            FROM  SUT_OTBND_UPC                                   04930000
049400            WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID               04940000
049500     END-EXEC.                                                    04950000
049600                                                                  04960000
049700     EXEC SQL                                                     04970000
049800          DECLARE TPKSLIP-PO-CSR CURSOR FOR                       04980000
049900          SELECT  DISTINCT B.PO_NBR                               04990000
050000                 ,C.REC_SEQ_NBR                                   05000000
050100            FROM  SUT_OTBND_CART A                                05010000
050200                 ,SUT_OTBND_VND B                                 05020000
050300                 ,TPKSLIP C                                       05030000
050400            WHERE A.SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID             05040000
050500              AND A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               05050000
050600              AND B.PO_NBR        =  C.PO_NBR                     05060000
050700              AND B.PKSL_SEQ_NBR  =  C.SEQ_NBR                    05070000
050800              AND C.VER_STAT_CDE  =  :PC-A                        05080000
050900     END-EXEC.                                                    05090000
051000                                                                  05100000
051100     EXEC SQL                                                     05110052
051200          DECLARE PKSLIP-PO-INBD-CSR CURSOR FOR                   05120054
051300          SELECT  DISTINCT B.PO_NBR                               05130052
051400                 ,C.REC_SEQ_NBR                                   05140052
051500            FROM  TSHPUNT A                                       05150054
051600                 ,TINPKSU B                                       05160054
051700                 ,TPKSLIP C                                       05170054
051800            WHERE A.SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID             05180052
051900              AND A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               05190052
052000              AND B.PO_NBR        =  C.PO_NBR                     05200052
052100              AND B.SEQ_NBR       =  C.SEQ_NBR                    05210052
052200              AND C.VER_STAT_CDE  =  :PC-A                        05220052
052300     END-EXEC.                                                    05230052
052400                                                                  05240052
052500     EXEC SQL                                                     05250000
052600          DECLARE PREPKID-CSR CURSOR FOR                          05260000
052700          SELECT  DISTINCT B.PREPK_ID                             05270000
052800            FROM  TRECITM B                                       05280000
052900            WHERE B.ORD_NBR     =  :DK-PURCHASE-ORDER             05290000
053000              AND B.REC_SEQ_NBR =  :DK-RCVR-NBR                   05300000
053100              AND B.ORD_LNE_NBR  IN                               05310000
053200                (SELECT A.TRN_LNE_NBR                             05320000
053300                 FROM  SUT_OTBND_UPC A                            05330000
053400            WHERE A.SHIPT_UNT_ID =  :DK-SHIPT-UNT-ID)             05340000
053500     END-EXEC.                                                    05350000
053600                                                                  05360000
053700     EXEC SQL                                                     05370000
053800          DECLARE PREPK-LNE-CSR CURSOR FOR                        05380000
053900          SELECT  ORD_LNE_NBR                                     05390000
054000                 ,PREPK_RATO_QTY                                  05400000
054100            FROM  TRECITM                                         05410000
054200            WHERE ORD_NBR     =  :DK-PURCHASE-ORDER               05420000
054300              AND REC_SEQ_NBR =  :DK-RCVR-NBR                     05430000
054400              AND PREPK_ID    =  :DK-PREPK-ID                     05440000
054500     END-EXEC.                                                    05450000
054600                                                                  05460000
054700     EXEC SQL                                                     05470000
054800          DECLARE OTBND-CART-CSR CURSOR FOR                       05480000
054900          SELECT  B.SHIPT_UNT_ID                                  05490000
055000            FROM  SUT_OTBND_CART A                                05500000
055100                 ,SUT_OTBND_CART B                                05510000
055200            WHERE A.PRNT_CART_ID = :DK-SHIPT-UNT-ID               05520000
055300              AND B.PRNT_CART_ID = A.SHIPT_UNT_ID                 05530000
055400              AND B.MSTR_CART_IND     = 'N'                       05540000
055500     END-EXEC.                                                    05550000
055600                                                                  05560000
055700     EXEC SQL                                                     05570000
055800          DECLARE OTBND-CART-CSR2 CURSOR FOR                      05580000
055900          SELECT  SHIPT_UNT_ID                                    05590000
056000            FROM  SUT_OTBND_CART                                  05600000
056100            WHERE PRNT_CART_ID = :DK-SHIPT-UNT-ID                 05610000
056200              AND MSTR_CART_IND     = 'N'                         05620000
056300     END-EXEC.                                                    05630000
056400                                                                  05640000
056500     EXEC SQL                                                     05650020
056600          DECLARE PREPK_PACK_CSR CURSOR FOR                       05660020
056700           SELECT SUM(A.SHPD_UNT_QTY)                             05670020
056800                , SUM(B.PREPK_RATO_QTY)                           05680020
056900             FROM SUT_OTBND_UPC A                                 05690020
057000                , TRECITM B                                       05700020
057100            WHERE A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              05710020
057200              AND A.TRN_NBR       = :DK-PO-NBR                    05720020
057300              AND A.RCVR_SEQ_NBR  = :DK-PO-RCVR                   05730020
057400              AND A.TRN_NBR       = B.ORD_NBR                     05740020
057500              AND A.RCVR_SEQ_NBR  = B.REC_SEQ_NBR                 05750020
057600              AND A.TRN_LNE_NBR   = B.ORD_LNE_NBR                 05760020
057700            GROUP BY A.TRN_NBR                                    05770020
057800                    ,A.RCVR_SEQ_NBR                               05780020
057900                    ,B.PREPK_ID                                   05790020
058000     END-EXEC.                                                    05800020
058100                                                                  05810020
058200*-----------------------------------------------------------------05820000
058300*  COMMUNICATIONS AREA FOR DB2                                    05830000
058400*-----------------------------------------------------------------05840000
058500     EXEC SQL                                                     05850000
058600         INCLUDE SQLCA                                            05860000
058700     END-EXEC.                                                    05870000
058800                                                                  05880000
058900******************************************************************05890000
059000 LINKAGE SECTION.                                                 05900000
059100******************************************************************05910000
059200 01  DFHCOMMAREA.                                                 05920000
059300     05  FILLER                       OCCURS 1 TO 4072 TIMES      05930000
059400                                      DEPENDING ON EIBCALEN.      05940000
059500         10  FILLER                   PIC X.                      05950000
059600                                                                  05960000
059700******************************************************************05970000
059800 PROCEDURE DIVISION.                                              05980000
059900******************************************************************05990000
060000 0000-PROGRAM-MAINLINE.                                           06000000
060100                                                                  06010000
060200                                                                  06020000
060300     INITIALIZE PC038-COMMON-DATA                                 06030000
060400                PC039-COMMAREA-REC.                               06040000
060500     MOVE DFHCOMMAREA  TO PC039-COMMAREA-REC.                     06050000
060600     IF PC039-CALLED-FROM-STAT-ACT                                06060000
060700         PERFORM 0500-BEGIN-PROCESS                               06070000
060800     ELSE                                                         06080000
060900         INITIALIZE  CA-COMMAREA                                  06090000
061000         MOVE DFHCOMMAREA                TO CA-COMMAREA           06100000
061100         MOVE LOW-VALUES                 TO PC882AI               06110000
061200         PERFORM 0500-BEGIN-PROCESS                               06120000
061300     END-IF.                                                      06130000
061400                                                                  06140000
061500******************************************************************06150000
061600 0500-BEGIN-PROCESS.                                              06160000
061700******************************************************************06170000
061800                                                                  06180000
061900     EVALUATE TRUE                                                06190000
062000         WHEN EIBTRNID = 'Z278'                                   06200000
062100             MOVE DFHCOMMAREA          TO PC192-COMMAREA          06210000
062200             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             06220000
062300             SET PC038-PROCESS-SCREEN  TO TRUE                    06230000
062400             MOVE PC192-HOST-SAVE-MAP  TO PC882AO                 06240000
062500             MOVE -1                   TO APRINTIDL               06250000
062600             PERFORM 1050-INITIALIZE-RETURN                       06260000
062700             PERFORM 8000-SEND-MAP                                06270000
062800             PERFORM 8200-RETURN-TRANID                           06280000
062900                                                                  06290000
063000         WHEN EIBCALEN = ZERO                                     06300000
063100         WHEN EIBAID = DFHCLEAR                                   06310000
063200         WHEN PC038-INITIALIZE-SCREEN                             06320000
063300             SET PC038-PROCESS-SCREEN     TO TRUE                 06330000
063400             MOVE -1                      TO APRINTIDL            06340000
063500             PERFORM 1000-INITIALIZE                              06350000
063600             MOVE PC-CURRENT-PROGRAM-NAME TO PC038-LAST-PROGRAM   06360000
063700             PERFORM 8000-SEND-MAP                                06370000
063800             PERFORM 8200-RETURN-TRANID                           06380000
063900                                                                  06390000
064000         WHEN EIBAID = DFHPF3                                     06400000
064100             MOVE PC-N               TO PV-DUPLICATE-IND          06410000
064200             MOVE PC-OTHER-PGM       TO PV-TRANSFER-PROGRAM       06420000
064300             PERFORM 8300-XCTL-TO-SELECTED-PROGRAM                06430000
064400                                                                  06440000
064500*---------------------------------------------------------------- 06450000
064600***** THE SAME F4 FUNCTIONALITY EXISTS IN PROGRAM PCKRF881.  ANY  06460000
064700***** CHANGES MADE HERE SHOULD PROBABLY BE MADE THERE ALSO.       06470000
064800*---------------------------------------------------------------- 06480000
064900         WHEN EIBAID = DFHPF4                                     06490000
065000             IF ((PC038-SRC-ASN AND                               06500027
065100                  PC038-SULBXF-BARCODE NOT > SPACE) OR            06510027
065200                  PC038-INACTIVATED OR PC038-SRC-DMG)             06520027
065300                 MOVE PC-NO-LABEL-AVAILABLE     TO AFKMSG2O       06530000
065400                 MOVE SPACES                    TO APRINTIDO      06540000
065500                 MOVE -1                        TO APRINTIDL      06550000
065600                 PERFORM 8100-SEND-DATA-ONLY                      06560000
065700                 PERFORM 8200-RETURN-TRANID                       06570000
065800             ELSE                                                 06580000
065900             IF PC038-SRC-ASN AND PC038-SHPUNT-CART-TYP-CDE = 'I' 06590000
066000                 MOVE PC-INNPK-USE-KOHLS-SML    TO AFKMSG2O       06600000
066100                 MOVE SPACES                    TO APRINTIDO      06610000
066200                 MOVE -1                        TO APRINTIDL      06620000
066300                 PERFORM 8100-SEND-DATA-ONLY                      06630000
066400                 PERFORM 8200-RETURN-TRANID                       06640000
066500             ELSE                                                 06650000
066600                  PERFORM 8400-RECEIVE-MAP                        06660000
066700                  MOVE PC-N               TO PV-DUPLICATE-IND     06670000
066800                  PERFORM 7000-CHECK-4-PRINTER-ID                 06680000
066900                  IF PS-PRINTER-FOUND                             06690000
067000                      INITIALIZE PC039-COMMAREA-REC               06700000
067100                      SET PC039-CALLED-FROM-STAT-PO  TO TRUE      06710000
067200                      MOVE PC038-CALLED-PGM-NME TO                06720000
067300                                              PC039-CALLED-PGM-NME06730000
067400                      MOVE PC038-USER-ID     TO  PC039-CRA-REQ-ID 06740000
067500                      MOVE PC038-PRINTER-ID-1-3 TO                06750000
067600                                                 PC039-PRINTER-ID 06760000
067700                      MOVE PC038-SULBXF-BARCODE TO                06770000
067800                                               PC039-KOHLS-BARCODE06780000
067900                      MOVE PC038-CARTON-ID-ENTERED   TO           06790000
068000                                           PC039-CARTON-ID-ENTERED06800000
068100                      MOVE PC038-CARTON-ON-TABLE     TO           06810000
068200                                             PC039-CARTON-ON-TABLE06820000
068300                      MOVE PC038-SOURCE-ID    TO  PC039-SOURCE-ID 06830000
068400                      MOVE PC038-LABEL-CREATED TO  PC039-LBL-TYPE 06840000
068500                      MOVE PC038-SHPUNT-SHIPT-UNT-ID  TO          06850000
068600                                               DK-SHIPT-UNT-ID    06860000
068700                      PERFORM 5900-SELECT-VENDOR-BARCODE          06870000
068800                      MOVE DK-SHIPT-UNT-ID  TO PC039-SHIPT-UNT-ID 06880000
068900                      MOVE PC038-SHPUNT-DEST-OPER TO              06890000
069000                                                    PC039-STR-NBR 06900000
069100                      IF PC038-SRC-ASN                            06910000
069200                         MOVE PC038-SHPUNT-DEST-OPER TO           06920000
069300                                                    PC039-STR-NBR 06930000
069400                      END-IF                                      06940000
069500                                                                  06950069
069600                      IF  PC038-SHPUNT-CART-TYP-CDE  >  SPACES    06960002
069700                          MOVE PC038-SHPUNT-CART-TYP-CDE TO       06970002
069800                                                  PC039-LBL-FORMAT06980002
069900                      ELSE                                        06990002
070000                          MOVE PC038-SULBXF-CART-TYP-CDE TO       07000002
070100                                                  PC039-LBL-FORMAT07010002
070200                      END-IF                                      07020002
070300                                                                  07030069
070400                      MOVE PC038-CURR-OPER-UNT TO                 07040000
070500                                             PC039-CURR-OPER-UNT  07050000
070600                      MOVE PC-LABEL-INFO-PGM TO                   07060000
070700                                            PV-TRANSFER-PROGRAM   07070000
070800                      MOVE SPACES            TO  EIBAID           07080000
070900                      PERFORM 8350-LINK-TO-888-PROGRAM            07090000
071000                      MOVE -1                        TO APRINTIDL 07100000
071100                      IF  PS-ERROR-NO                             07110000
071200                          MOVE PC-LBL-PRINT-MSG      TO AFKMSG2O  07120000
071300                      END-IF                                      07130000
071400                      MOVE PC039-CALLED-PGM-NME  TO               07140000
071500                                            PC038-CALLED-PGM-NME  07150000
071600                      PERFORM 8100-SEND-DATA-ONLY                 07160000
071700                      PERFORM 8200-RETURN-TRANID                  07170000
071800                  ELSE                                            07180000
071900                      MOVE PC-NEED-PRTR-ID           TO AFKMSG2O  07190000
072000                      MOVE -1                        TO APRINTIDL 07200000
072100                      MOVE PC039-CALLED-PGM-NME  TO               07210000
072200                                            PC038-CALLED-PGM-NME  07220000
072300                      PERFORM 8100-SEND-DATA-ONLY                 07230000
072400                      PERFORM 8200-RETURN-TRANID                  07240000
072500                  END-IF                                          07250000
072600             END-IF                                               07260000
072700             END-IF                                               07270000
072800                                                                  07280000
072900         WHEN EIBAID = DFHENTER                                   07290000
073000             EVALUATE TRUE                                        07300000
073100                 WHEN  PC038-SCANNED-ONTO-TRLR                    07310000
073200                 WHEN  PC038-DIVERTED-TO-TRLR                     07320000
073300                 WHEN  PC038-LOADED-ONTO-TRLR                     07330000
073400                    MOVE PC-NEXT-PGM TO PV-TRANSFER-PROGRAM       07340000
073500                 WHEN OTHER                                       07350000
073600                    MOVE PC038-CALLED-PGM-NME TO PC-CALLED-FROM-PG07360000
073700                    INITIALIZE PC038-COMMON-DATA                  07370000
073800                    MOVE PC-CALLED-FROM-PG TO PC038-CALLED-PGM-NME07380000
073900                    MOVE PC-OTHER-PGM TO PV-TRANSFER-PROGRAM      07390000
074000             END-EVALUATE                                         07400000
074100             PERFORM 8300-XCTL-TO-SELECTED-PROGRAM                07410000
074200                                                                  07420000
074300         WHEN EIBAID = DFHPF1                                     07430000
074400             PERFORM 8400-RECEIVE-MAP                             07440000
074500             MOVE PC882AO             TO PC192-HOST-SAVE-MAP      07450000
074600             PERFORM 1200-HELP-SCREEN                             07460000
074700             PERFORM 8200-RETURN-TRANID                           07470000
074800                                                                  07480000
074900         WHEN OTHER                                               07490000
075000              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AFKMSG2O         07500000
075100              MOVE -1        TO APRINTIDL                         07510000
075200              PERFORM 8100-SEND-DATA-ONLY                         07520000
075300              PERFORM 8200-RETURN-TRANID                          07530000
075400     END-EVALUATE.                                                07540000
075500                                                                  07550000
075600     GOBACK.                                                      07560000
075700*-----------------------------------------------------------------07570000
075800 1000-INITIALIZE.                                                 07580000
075900*-----------------------------------------------------------------07590000
076000                                                                  07600000
076100     MOVE PC038-SHPUNT-SHIPT-UNT-ID TO ACARTNIDO                  07610000
076200                                       DK-SHIPT-UNT-ID.           07620000
076300     PERFORM 5900-SELECT-VENDOR-BARCODE.                          07630000
076400     MOVE DK-SHIPT-UNT-ID       TO DK-SHIPT-UNT-ID-3.             07640000
076500     EVALUATE TRUE                                                07650000
076600         WHEN PC038-SRC-ASN                                       07660000
076700              MOVE PC-VENDOR-ASN TO ACREATEO                      07670000
076800              PERFORM 3500-TRY-LBVRDA-FOR-DATA                    07680000
076900              IF PS-NOT-FOUND-TLBVRDA                             07690000
077000                  PERFORM 2000-CART-UPC-CURSOR-DRIVER             07700026
077100              ELSE                                                07710048
077200                  PERFORM 2220-SELECT-STAT-CDE                    07720051
077300              END-IF                                              07730048
077400              IF PS-ZERO-RCVR-SEQ-YES AND                         07740026
077500                 PS-NOT-FOUND-TLBVRDA                             07750026
077600                 MOVE ZEROES TO PT-TABLE-ENTRIES                  07760045
077700                 PERFORM 3000-TPKSLIP-CURSOR-DRIVER               07770026
077800              END-IF                                              07780000
077900                                                                  07790052
078000                                                                  07800069
078100              IF PS-ZERO-RCVR-SEQ-YES AND                         07810052
078200                 PS-NOT-FOUND-TLBVRDA                             07820052
078300                 MOVE ZEROES TO PT-TABLE-ENTRIES                  07830052
078400                 PERFORM 3400-TPKSLIP-CURSOR-INBOUND              07840052
078500              END-IF                                              07850052
078600                                                                  07860069
078700                                                                  07870052
078800         WHEN PC038-SRC-CHECK-IN                                  07880000
078900              MOVE PC-CHECK-IN   TO ACREATEO                      07890000
079000              PERFORM 3500-TRY-LBVRDA-FOR-DATA                    07900000
079100              IF PS-NOT-FOUND-TLBVRDA                             07910000
079200                  PERFORM 2000-CART-UPC-CURSOR-DRIVER             07920026
079300              ELSE                                                07930048
079400                  PERFORM 2220-SELECT-STAT-CDE                    07940048
079500              END-IF                                              07950026
079600              IF PS-ZERO-RCVR-SEQ-YES AND                         07960026
079700                 PS-NOT-FOUND-TLBVRDA                             07970026
079800                 MOVE ZEROES TO PT-TABLE-ENTRIES                  07980044
079900                 PERFORM 3000-TPKSLIP-CURSOR-DRIVER               07990026
080000              END-IF                                              08000000
080100         WHEN PC038-SRC-CSEPK-SPLT                                08010000
080200              MOVE PC-CSEPK-SPLT TO ACREATEO                      08020000
080300              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08030000
080400         WHEN PC038-SRC-MANUAL                                    08040000
080500              MOVE PC-MANUAL     TO ACREATEO                      08050000
080600              PERFORM 3000-TPKSLIP-CURSOR-DRIVER                  08060000
080700         WHEN PC038-SRC-P2L                                       08070000
080800              MOVE PC-PCK-2-LIT  TO ACREATEO                      08080000
080900              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08090000
081000         WHEN PC038-SRC-RECEIVING                                 08100000
081100              MOVE PC-RECEIVING  TO ACREATEO                      08110000
081200              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08120000
081300         WHEN PC038-SRC-RDM                                       08130000
081400              MOVE PC-RDM        TO ACREATEO                      08140000
081500              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08150000
081600         WHEN PC038-SRC-SMOOTHING                                 08160000
081700              MOVE PC-SMOOTHING  TO ACREATEO                      08170000
081800              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08180000
081900         WHEN PC038-SRC-FAST-XFER                                 08190000
082000              MOVE PC-FAST-XFER  TO ACREATEO                      08200000
082100              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08210000
082200         WHEN PC038-SRC-MSTR-CNTR                                 08220000
082300              MOVE PC-MSTR-CNTR      TO ACREATEO                  08230000
082400         WHEN PC038-SRC-CRTN-BULD                                 08240000
082500              MOVE PC-CRTN-BULD      TO ACREATEO                  08250000
082600              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08260000
082700         WHEN PC038-SRC-JWL                                       08270027
082800              MOVE PC-JEWELRY   TO ACREATEO                       08280027
082900              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08290027
083000         WHEN PC038-SRC-DMG                                       08300027
083100              MOVE PC-DAMAGED   TO ACREATEO                       08310027
083200              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08320027
083210         WHEN PC038-SRC-3WD                                       08321069
083220              MOVE PC-3WD-PRTY-WHSE TO ACREATEO                   08322069
083230              PERFORM 2000-CART-UPC-CURSOR-DRIVER                 08323069
083300         WHEN OTHER                                               08330000
083400              MOVE PC-UNKNOWN    TO ACREATEO                      08340000
083500              PERFORM 3000-TPKSLIP-CURSOR-DRIVER                  08350000
083600     END-EVALUATE.                                                08360000
083700                                                                  08370000
083800     IF PT-TABLE-ENTRIES > +1                                     08380000
083900         MOVE 'MULTIPLE' TO APORCVRO                              08390000
084000         SET PC038-MULTI-PO  TO TRUE                              08400000
084100     ELSE                                                         08410000
084200         MOVE PT-PURCHASE-ORDER (+1) TO PC038-PO-NBR              08420000
084300                                        DK-PURCHASE-ORDER-N       08430000
084400         MOVE PT-RCVR-NBR       (+1) TO PC038-RCVR-SEQ-NBR        08440000
084500                                        DK-RCVR-NBR-N             08450000
084600         STRING 'PO:'         DELIMITED BY SIZE                   08460048
084700                DK-PURCHS-ORD DELIMITED BY SIZE                   08470048
084800                '-'           DELIMITED BY SIZE                   08480000
084900                DK-RECVR-NBR  DELIMITED BY SIZE                   08490000
085000                '-'           DELIMITED BY SIZE                   08500047
085100                DK-STATUS-CDE DELIMITED BY SIZE                   08510047
085200                                 INTO  APORCVRO                   08520000
085300     END-IF.                                                      08530000
085400                                                                  08540000
085500     IF PS-NOT-FOUND-TLBVRDA                                      08550000
085600         PERFORM VARYING PT-PO-IDX                                08560000
085700             FROM 1 BY 1                                          08570000
085800                 UNTIL PT-PO-IDX > PT-TABLE-ENTRIES               08580000
085900                    OR PT-PO-IDX > PC-TABLE-MAX                   08590012
086000                     PERFORM 4000-GET-LINE-INFO                   08600000
086100                     PERFORM 4500-NBR-UNTS-PCKS                   08610000
086200         END-PERFORM                                              08620000
086300                                                                  08630000
086400         PERFORM VARYING PT-PO-IDX                                08640000
086500             FROM 1 BY 1                                          08650000
086600                 UNTIL PT-PO-IDX > PT-TABLE-ENTRIES               08660017
086700                    OR PT-PO-IDX > PC-TABLE-MAX                   08670017
086800                                                                  08680069
086900                    PERFORM 4900-DETERMIN-UNTS                    08690000
087000                    SET PS-ADJ-NO   TO  TRUE                      08700000
087100                    PERFORM 4950-DETERMIN-ADJS                    08710000
087200         END-PERFORM                                              08720000
087300                                                                  08730017
087400         IF PT-TABLE-ENTRIES = 0                                  08740000
087500             MOVE +1 TO PT-TABLE-ENTRIES                          08750000
087600         END-IF                                                   08760000
087700                                                                  08770000
087800         IF PT-SINGLE-LINE (+1)                                   08780000
087900                 MOVE '0000'         TO ATEXTO                    08790000
088000                 MOVE 'LNE:'         TO ALNEPCKO                  08800000
088100                 PERFORM 4200-GET-DEPT-CL-SKU                     08810000
088200         ELSE                                                     08820000
088300                                                                  08830069
088400         IF PT-NO-LINE (+1)                                       08840011
088500                 MOVE 'UNKNOWN'      TO ATEXTO                    08850011
088600                 MOVE 'LNE:'         TO ALNEPCKO                  08860011
088700                 PERFORM 4200-GET-DEPT-CL-SKU                     08870011
088800         ELSE                                                     08880011
088900                                                                  08890069
089000             IF PT-PREPK-PO (+1)                                  08900000
089100                 SET PC038-PREPK       TO TRUE                    08910000
089200                 MOVE PT-PREPK-ID (+1) TO PC038-PREPK-ID          08920000
089300                 MOVE 'PACK ID:'       TO ALNEPCKO                08930055
089400                 IF PT-MULTI-PREPK (+1)                           08940000
089500                     SET PC038-MULTI-PREPK TO TRUE                08950000
089600                     MOVE 'MULTIPLE'       TO ATEXTO              08960000
089700                 ELSE                                             08970000
089800                     MOVE PC038-PREPK-ID   TO ATEXTO              08980000
089900                 END-IF                                           08990000
090000             ELSE                                                 09000000
090100                 SET PC038-MULTI-LNE TO TRUE                      09010000
090200                 MOVE 'MULTIPLE'     TO ATEXTO                    09020000
090300                 MOVE 'LNE:'         TO ALNEPCKO                  09030000
090400             END-IF                                               09040000
090500         END-IF                                                   09050000
090600         END-IF                                                   09060011
090700     ELSE                                                         09070000
090800         IF  PC039-PREPK                                          09080000
090900                 MOVE 'PACK ID:'       TO ALNEPCKO                09090055
091000                 MOVE PC039-PREPK-ID   TO ATEXTO                  09100000
091100        ELSE                                                      09110000
091200                 MOVE 'LNE:'           TO ALNEPCKO                09120000
091300                 MOVE PC039-LNE-NBR    TO ATEXTO                  09130000
091400        END-IF                                                    09140000
091500     END-IF.                                                      09150000
091600                                                                  09160000
091700     IF PS-NOT-FOUND-TLBVRDA                                      09170000
091800         INITIALIZE PC038-LNE-SHPD-QTY                            09180000
091900                    PC038-PREPK-PAK-QTY                           09190000
092000                                                                  09200000
092100         PERFORM VARYING PT-PO-IDX                                09210000
092200             FROM 1 BY 1                                          09220000
092300             UNTIL PT-PO-IDX > PT-TABLE-ENTRIES                   09230000
092400                                                                  09240069
092500                OR PT-PO-IDX > PC-TABLE-MAX                       09250013
092600                                                                  09260069
092700                 ADD PT-NBR-UNITS (PT-PO-IDX)  TO                 09270000
092800                                             PV-CRTN-TOTAL-UNITS  09280000
092900                                             PC038-LNE-SHPD-QTY   09290000
093000                 ADD PT-NBR-PACKS (PT-PO-IDX)  TO                 09300000
093100                                             PV-CRTN-TOTAL-PACKS  09310000
093200                                             PC038-PREPK-PAK-QTY  09320000
093300         END-PERFORM                                              09330000
093400         IF  PC038-PREPK                                          09340000
093500             MOVE  PC038-PREPK-PAK-QTY TO PC039-PACKS-IN-CRTN     09350000
093600         END-IF                                                   09360000
093700     ELSE                                                         09370000
093800         SET PS-ADJ-NO   TO  TRUE                                 09380000
093900         PERFORM 4950-DETERMIN-ADJS                               09390000
094000                                                                  09400000
094100         IF PS-ADJ-NO                                             09410000
094200             MOVE LBVRDA-OTPK-UNT-QTY     TO PV-CRTN-TOTAL-UNITS  09420000
094300                                             PC038-LNE-SHPD-QTY   09430000
094400         ELSE                                                     09440000
094500             SET PT-PO-IDX TO 1                                   09450000
094600             PERFORM 4900-DETERMIN-UNTS                           09460000
094700             MOVE PT-NBR-UNITS (1)        TO PV-CRTN-TOTAL-UNITS  09470000
094800                                             PC038-LNE-SHPD-QTY   09480000
094900         END-IF                                                   09490000
095000         MOVE LBVRDA-PREPK-UNT-QTY    TO PV-CRTN-TOTAL-PACKS      09500000
095100         MOVE LBVRDA-PREPK-UNT-QTY    TO PC038-PREPK-PAK-QTY      09510000
095200         IF  LBVRDA-PREPK-UNT-QTY  >  0                           09520000
095300             COMPUTE PC039-PACKS-IN-CRTN  =                       09530000
095400                     LBVRDA-PREPK-UNT-QTY / LBVRDA-PREPK-UNT-QTY  09540000
095500         ELSE                                                     09550000
095600             MOVE  ZEROES             TO PC039-PACKS-IN-CRTN      09560000
095700         END-IF                                                   09570000
095800         MOVE  PC039-PACKS-IN-CRTN    TO PV-CRTN-TOTAL-PAKS       09580000
095900     END-IF.                                                      09590000
096000                                                                  09600000
096100                                                                  09610000
096200     STRING 'UNT:'                       DELIMITED BY SIZE        09620000
096300            PV-CRTN-TOTAL-UNTS           DELIMITED BY SIZE        09630000
096400            ' '                          DELIMITED BY SIZE        09640000
096500            '#PCK:'                      DELIMITED BY SIZE        09650057
096600             PV-CRTN-TOTAL-PAKS          DELIMITED BY SIZE        09660000
096700                                    INTO AUNTPCKO.                09670000
096800                                                                  09680000
096900     IF PC038-SRC-MSTR-CNTR                                       09690000
097000         MOVE 'MULTIPLE'     TO APORCVRO                          09700000
097100         MOVE 'MULTIPLE'     TO ATEXTO                            09710000
097200         MOVE 'LNE:'         TO ALNEPCKO                          09720000
097300         IF PC038-SHPUNT-SHIPT-UNT-ID = PC038-NEXT-SHIPT-UNT-ID   09730000
097400             PERFORM 5000-COUNT-CHILDREN-OF-MASTER                09740000
097500             PERFORM 5100-COUNT-UNIT-OF-CHILDREN                  09750000
097600         ELSE                                                     09760000
097700             PERFORM 5050-COUNT-CHILDREN-OF-MASTER                09770000
097800             PERFORM 5500-COUNT-UNIT-OF-CHILDREN                  09780000
097900         END-IF                                                   09790000
098000                                                                  09800069
098100         INITIALIZE PV-CRTN-TOTAL-UNITS                           09810000
098200                    PC038-LNE-SHPD-QTY                            09820007
098300                                                                  09830069
098400         PERFORM VARYING PT-PO-IDX                                09840000
098500             FROM 1 BY 1                                          09850000
098600                 UNTIL PT-PO-IDX > PT-TABLE-ENTRIES               09860000
098700                     ADD PT-NBR-UNITS (PT-PO-IDX)  TO             09870000
098800                                             PV-CRTN-TOTAL-UNITS  09880000
098900                                             PC038-LNE-SHPD-QTY   09890000
099000         END-PERFORM                                              09900000
099100         MOVE PV-CHILDRN-IN-MASTER TO PV-CHLDN-IN-MSTR            09910000
099200         MOVE SPACES               TO  AUNTPCKO                   09920000
099300         STRING 'UNT '        DELIMITED BY SIZE                   09930000
099400          PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE                   09940000
099500                ' CHLD '      DELIMITED BY SIZE                   09950000
099600              PV-CHLD-IN-MSTR DELIMITED BY SIZE                   09960000
099700                  ' '         DELIMITED BY SIZE                   09970000
099800                          INTO   AUNTPCKO                         09980000
099900         IF PC038-SRC-ASN                                         09990000
100000              MOVE SPACES                TO  AFKMSG1O             10000000
100100         ELSE                                                     10010000
100200         IF PS-ADJ-YES                                            10020000
100300              MOVE 'MSTR CONTNR  ADJST'  TO  AFKMSG1O             10030000
100400         ELSE                                                     10040000
100500              MOVE 'MASTER CONTAINER'    TO  AFKMSG1O             10050000
100600         END-IF                                                   10060000
100700         END-IF                                                   10070000
100800     ELSE                                                         10080000
100900         IF PC038-SHPUNT-SHIPT-UNT-ID  NOT =                      10090000
101000                                       PC038-NEXT-SHIPT-UNT-ID    10100000
101100             IF NOT PC038-PREPK                                   10110000
101200                 PERFORM 4900-DETERMIN-UNTS                       10120000
101300                                                                  10130069
101400                 INITIALIZE PV-CRTN-TOTAL-UNITS                   10140000
101500                            PC038-LNE-SHPD-QTY                    10150007
101600                                                                  10160069
101700                 PERFORM VARYING PT-PO-IDX                        10170000
101800                    FROM 1 BY 1                                   10180000
101900                       UNTIL PT-PO-IDX > 1                        10190000
102000                           ADD PT-NBR-UNITS (PT-PO-IDX) TO        10200000
102100                                             PV-CRTN-TOTAL-UNITS  10210000
102200                                             PC038-LNE-SHPD-QTY   10220000
102300                 END-PERFORM                                      10230000
102400                 MOVE SPACES   TO  AUNTPCKO                       10240000
102500                 STRING 'UNT: '      DELIMITED BY SIZE            10250055
102600                  PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE           10260000
102700                                  INTO   AUNTPCKO                 10270000
102800             END-IF                                               10280000
102900             IF PC038-SRC-ASN                                     10290000
103000                  MOVE SPACES               TO  AFKMSG1O          10300000
103100             ELSE                                                 10310000
103200             IF PS-ADJ-YES                                        10320000
103300                 MOVE 'CHLD CONTNR  ADJST'  TO  AFKMSG1O          10330000
103400             ELSE                                                 10340000
103500                 MOVE '  CHILD CONTAINER'   TO  AFKMSG1O          10350000
103600             END-IF                                               10360000
103700             END-IF                                               10370000
103800         ELSE                                                     10380000
103900             IF PS-ADJ-YES                                        10390000
104000                 MOVE '   ADJUSTED   '   TO AFKMSG1O              10400000
104100             ELSE                                                 10410000
104200                 MOVE SPACES             TO AFKMSG1O              10420000
104300             END-IF                                               10430000
104400         END-IF                                                   10440000
104500     END-IF.                                                      10450000
104600     MOVE PV-FKEY-MSG1 TO AFKMSG2O.                               10460000
104700                                                                  10470000
104800*-----------------------------------------------------------------10480000
104900 1050-INITIALIZE-RETURN.                                          10490000
105000*-----------------------------------------------------------------10500000
105100                                                                  10510000
105200     MOVE PC038-CARTON-ID-ENTERED TO ACARTNIDO.                   10520000
105300     EVALUATE TRUE                                                10530000
105400         WHEN PC038-SRC-ASN                                       10540000
105500              MOVE PC-VENDOR-ASN TO ACREATEO                      10550000
105600         WHEN PC038-SRC-CHECK-IN                                  10560000
105700              MOVE PC-CHECK-IN   TO ACREATEO                      10570000
105800         WHEN PC038-SRC-CSEPK-SPLT                                10580000
105900              MOVE PC-CSEPK-SPLT TO ACREATEO                      10590000
106000         WHEN PC038-SRC-MANUAL                                    10600000
106100              MOVE PC-MANUAL     TO ACREATEO                      10610000
106200         WHEN PC038-SRC-P2L                                       10620000
106300              MOVE PC-PCK-2-LIT  TO ACREATEO                      10630000
106400         WHEN PC038-SRC-RECEIVING                                 10640000
106500              MOVE PC-RECEIVING  TO ACREATEO                      10650000
106600         WHEN PC038-SRC-RDM                                       10660000
106700              MOVE PC-RDM        TO ACREATEO                      10670000
106800         WHEN PC038-SRC-SMOOTHING                                 10680000
106900              MOVE PC-SMOOTHING  TO ACREATEO                      10690000
107000         WHEN PC038-SRC-FAST-XFER                                 10700000
107100              MOVE PC-FAST-XFER  TO ACREATEO                      10710000
107200         WHEN PC038-SRC-MSTR-CNTR                                 10720000
107300              MOVE PC-MSTR-CNTR  TO ACREATEO                      10730000
107400         WHEN PC038-SRC-CRTN-BULD                                 10740000
107500              MOVE PC-CRTN-BULD  TO ACREATEO                      10750000
107600         WHEN PC038-SRC-JWL                                       10760027
107700              MOVE PC-JEWELRY    TO ACREATEO                      10770027
107800         WHEN PC038-SRC-DMG                                       10780027
107900              MOVE PC-DAMAGED    TO ACREATEO                      10790027
107910         WHEN PC038-SRC-3WD                                       10791069
107920              MOVE PC-3WD-PRTY-WHSE TO ACREATEO                   10792069
108000         WHEN OTHER                                               10800000
108100              MOVE PC-UNKNOWN    TO ACREATEO                      10810000
108200     END-EVALUATE.                                                10820000
108300                                                                  10830000
108400     IF PC038-MULTI-PO                                            10840000
108500         MOVE 'MULTIPLE' TO APORCVRO                              10850000
108600     ELSE                                                         10860000
108700         MOVE PC038-PO-NBR       TO DK-PURCHASE-ORDER-N           10870000
108800         MOVE PC038-RCVR-SEQ-NBR TO DK-RCVR-NBR-N                 10880000
108900         STRING 'PO:'         DELIMITED BY SIZE                   10890048
109000                DK-PURCHS-ORD DELIMITED BY SIZE                   10900048
109100                '-'           DELIMITED BY SIZE                   10910000
109200                DK-RECVR-NBR  DELIMITED BY SIZE                   10920000
109300                '-'           DELIMITED BY SIZE                   10930047
109400                DK-STATUS-CDE DELIMITED BY SIZE                   10940047
109500                      INTO APORCVRO                               10950000
109600     END-IF.                                                      10960000
109700                                                                  10970000
109800     IF PC038-MULTI-PREPK                                         10980000
109900         MOVE 'PACK'      TO ALNEPCKO                             10990056
110000         MOVE 'MULTIPLE'  TO ATEXTO                               11000000
110100     ELSE                                                         11010000
110200         IF PC038-PREPK                                           11020000
110300             MOVE 'PACK'         TO ALNEPCKO                      11030056
110400             MOVE PC038-PREPK-ID TO ATEXTO                        11040000
110500         ELSE                                                     11050000
110600             IF PC038-MULTI-LNE                                   11060000
110700                 MOVE 'LNE: '    TO ALNEPCKO                      11070000
110800                 MOVE 'MULTIPLE' TO ATEXTO                        11080000
110900             ELSE                                                 11090000
111000                 MOVE 'LNE: '    TO ALNEPCKO                      11100000
111100                 MOVE PC038-PO-LNE-NBR   TO DK-LNE-NBR-N          11110000
111200                 STRING DK-LINE-NBR      DELIMITED BY SIZE        11120000
111300                        ' '              DELIMITED BY SIZE        11130000
111400                        '('              DELIMITED BY SIZE        11140000
111500                     PC038-SKU-NBR       DELIMITED BY SIZE        11150008
111600                        ')'              DELIMITED BY SIZE        11160000
111700                              INTO ATEXTO                         11170000
111800             END-IF                                               11180000
111900         END-IF                                                   11190000
112000     END-IF.                                                      11200000
112100                                                                  11210000
112200     MOVE PC038-LNE-SHPD-QTY     TO    PV-CRTN-TOTAL-UNITS.       11220000
112300     MOVE PC038-PREPK-PAK-QTY    TO    PV-CRTN-TOTAL-PACKS.       11230000
112400     IF PV-CRTN-TOTAL-UNITS > 0 AND PV-CRTN-TOTAL-PACKS > 0       11240000
112500         IF PC038-ADJ                                             11250000
112600             STRING 'UNT:'        DELIMITED BY SIZE               11260055
112700               PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE              11270000
112800                               INTO   AUNTPCKO                    11280000
112900         ELSE                                                     11290000
113000             STRING 'UNT:'         DELIMITED BY SIZE              11300000
113100               PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE              11310000
113200              ' '                  DELIMITED BY SIZE              11320000
113300              '#PCK:'              DELIMITED BY SIZE              11330056
113400               PV-CRTN-TOTAL-PAKS  DELIMITED BY SIZE              11340000
113500                               INTO   AUNTPCKO                    11350000
113600         END-IF                                                   11360000
113700     ELSE                                                         11370000
113800         IF PV-CRTN-TOTAL-PACKS > 0                               11380000
113900              STRING '#PCK: '      DELIMITED BY SIZE              11390056
114000               PV-CRTN-TOTAL-PAKS  DELIMITED BY SIZE              11400000
114100                               INTO   AUNTPCKO                    11410000
114200         ELSE                                                     11420000
114300             IF PV-CRTN-TOTAL-UNITS > 0                           11430000
114400                 STRING 'UNT: '      DELIMITED BY SIZE            11440055
114500                  PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE           11450000
114600                                  INTO   AUNTPCKO                 11460000
114700         END-IF                                                   11470000
114800     END-IF.                                                      11480000
114900                                                                  11490000
115000     IF PC038-SRC-MSTR-CNTR                                       11500000
115100         MOVE 'MULTIPLE'     TO APORCVRO                          11510000
115200         MOVE 'MULTIPLE'     TO ATEXTO                            11520000
115300         MOVE 'LNE:'         TO ALNEPCKO                          11530000
115400         MOVE PC038-LNE-SHPD-QTY   TO  PV-CRTN-TOTAL-UNITS        11540000
115500         MOVE PC038-CHLDRN-IN-MSTR TO  PV-CHILDRN-IN-MASTER       11550000
115600         MOVE PV-CHILDRN-IN-MASTER TO PV-CHLDN-IN-MSTR            11560000
115700         STRING 'UNT '        DELIMITED BY SIZE                   11570000
115800          PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE                   11580000
115900                ' CHLD '      DELIMITED BY SIZE                   11590000
116000              PV-CHLD-IN-MSTR DELIMITED BY SIZE                   11600000
116100                  ' '         DELIMITED BY SIZE                   11610000
116200                          INTO   AUNTPCKO                         11620000
116300         IF PC038-ADJ                                             11630000
116400              MOVE 'MSTR CONTNR  ADJST'  TO  AFKMSG1O             11640000
116500         ELSE                                                     11650000
116600              MOVE 'MASTER CONTAINER'    TO  AFKMSG1O             11660000
116700         END-IF                                                   11670000
116800     ELSE                                                         11680000
116900         IF PC038-SHPUNT-SHIPT-UNT-ID  NOT =                      11690000
117000                                       PC038-NEXT-SHIPT-UNT-ID    11700000
117100             IF NOT PC038-PREPK                                   11710000
117200                 MOVE PC038-LNE-SHPD-QTY   TO  PV-CRTN-TOTAL-UNITS11720000
117300                 STRING 'UNT: '      DELIMITED BY SIZE            11730055
117400                  PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE           11740000
117500                                  INTO   AUNTPCKO                 11750000
117600             END-IF                                               11760000
117700             IF PC038-SRC-ASN                                     11770000
117800                  MOVE SPACES               TO  AFKMSG1O          11780000
117900             ELSE                                                 11790000
118000             IF PC038-ADJ                                         11800000
118100                 MOVE 'CHLD CONTNR  ADJST'  TO  AFKMSG1O          11810000
118200             ELSE                                                 11820000
118300                 MOVE '  CHILD CONTAINER'   TO  AFKMSG1O          11830000
118400             END-IF                                               11840000
118500             END-IF                                               11850000
118600         ELSE                                                     11860000
118700             IF PC038-ADJ                                         11870000
118800                 MOVE '   ADJUSTED   '   TO AFKMSG1O              11880000
118900             ELSE                                                 11890000
119000                 MOVE SPACES             TO AFKMSG1O              11900000
119100             END-IF                                               11910000
119200         END-IF                                                   11920000
119300     END-IF.                                                      11930000
119400     MOVE PV-FKEY-MSG1 TO AFKMSG2O.                               11940000
119500                                                                  11950000
119600*-----------------------------------------------------------------11960000
119700 1200-HELP-SCREEN.                                                11970000
119800*-----------------------------------------------------------------11980000
119900                                                                  11990000
120000     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      12000000
120100     MOVE 'PCKRF882'                  TO PC192-PROGRAM-NAME       12010000
120200     COPY PCPD188.                                                12020000
120300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      12030000
120400     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     12040000
120500     PERFORM 8220-XCTL-TO-HELP.                                   12050000
120600                                                                  12060000
120700*-----------------------------------------------------------------12070000
120800 2000-CART-UPC-CURSOR-DRIVER.                                     12080000
120900                                                                  12090000
121000     PERFORM 2100-OPEN-CART-UPC-CURSOR.                           12100000
121100     PERFORM 2200-FETCH-CART-UPC-CURSOR.                          12110000
121200     PERFORM 2300-CLOSE-CART-UPC-CURSOR.                          12120000
121300                                                                  12130000
121400*--------------------------------------------------------------   12140000
121500 2100-OPEN-CART-UPC-CURSOR.                                       12150000
121600                                                                  12160000
121700     EXEC SQL                                                     12170000
121800         OPEN CART-UPC-PO-CSR                                     12180000
121900     END-EXEC.                                                    12190000
122000                                                                  12200000
122100     EVALUATE TRUE                                                12210000
122200          WHEN SQLCODE = +0                                       12220000
122300                 CONTINUE                                         12230000
122400          WHEN SQLCODE NOT EQUAL +0                               12240000
122500               MOVE '2100-OPEN-CART-UPC-CURSOR'                   12250000
122600                                               TO DP013-PARAGRAPH 12260000
122700               MOVE 'ERROR OPENING THE CURSOR'                    12270000
122800                                        TO DP013-MESSAGE-TEXT (1) 12280000
122900               MOVE SQLCA        TO DP013-SQLCA                   12290000
123000               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      12300000
123100               SET DP013-DB2-ABEND                                12310000
123200                   DP013-ROLLBACK   TO TRUE                       12320000
123300               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             12330000
123400     END-EVALUATE.                                                12340000
123500                                                                  12350000
123600*---------------------------------------------------------------  12360000
123700 2200-FETCH-CART-UPC-CURSOR.                                      12370000
123800                                                                  12380000
123900     PERFORM VARYING PT-PO-IDX                                    12390000
124000         FROM 1 BY 1                                              12400000
124100         UNTIL  SQLCODE NOT = +0                                  12410000
124200                                                                  12420000
124300         EXEC SQL                                                 12430000
124400             FETCH CART-UPC-PO-CSR                                12440000
124500             INTO :SUT00028-TRN-NBR                               12450000
124600                 ,:SUT00028-RCVR-SEQ-NBR                          12460000
124700         END-EXEC                                                 12470000
124800                                                                  12480000
124900         EVALUATE TRUE                                            12490000
125000             WHEN SQLCODE = +0                                    12500000
125100                 MOVE SUT00028-TRN-NBR TO                         12510000
125200                                    PT-PURCHASE-ORDER (PT-PO-IDX) 12520000
125300                 MOVE SUT00028-RCVR-SEQ-NBR TO                    12530000
125400                                          PT-RCVR-NBR (PT-PO-IDX) 12540000
125500                 ADD 1 TO PT-TABLE-ENTRIES                        12550000
125600                 IF SUT00028-RCVR-SEQ-NBR = 0                     12560025
125700                    SET PS-ZERO-RCVR-SEQ-YES TO TRUE              12570025
125800                 ELSE                                             12580030
125900                    SET PS-ZERO-RCVR-SEQ-NO  TO TRUE              12590030
126000                 END-IF                                           12600025
126100                 PERFORM 2210-SELECT-PCKG-CDE                     12610000
126200             WHEN SQLCODE NOT EQUAL +0                            12620000
126300                 CONTINUE                                         12630000
126400         END-EVALUATE                                             12640000
126500     END-PERFORM.                                                 12650000
126600                                                                  12660000
126700*---------------------------------------------------------------  12670000
126800 2210-SELECT-PCKG-CDE.                                            12680000
126900                                                                  12690000
127000     EXEC SQL                                                     12700000
127100         SELECT PKGNG_CDE                                         12710000
127200              , STATUS_CDE                                        12720047
127300          INTO :RECEIV-PKGNG-CDE                                  12730000
127400             , :RECEIV-STATUS-CDE                                 12740047
127500           FROM TRECEIV                                           12750000
127600          WHERE ORD_NBR     = :SUT00028-TRN-NBR                   12760000
127700            AND REC_SEQ_NBR = :SUT00028-RCVR-SEQ-NBR              12770000
127800     END-EXEC                                                     12780000
127900                                                                  12790000
128000     EVALUATE TRUE                                                12800000
128100         WHEN SQLCODE = +0                                        12810000
128200             MOVE RECEIV-PKGNG-CDE  TO  PT-PKGNG-CDE (PT-PO-IDX)  12820000
128300             MOVE RECEIV-STATUS-CDE TO  DK-STATUS-CDE             12830047
128400             PERFORM 2215-SELECT-DEPT-NBR                         12840000
128500         WHEN SQLCODE NOT EQUAL +0                                12850000
128600             MOVE ZERO              TO  SQLCODE                   12860000
128700             MOVE SPACES            TO  PT-PKGNG-CDE (PT-PO-IDX)  12870000
128800     END-EVALUATE.                                                12880000
128900                                                                  12890000
129000*---------------------------------------------------------------  12900000
129100 2215-SELECT-DEPT-NBR.                                            12910000
129200                                                                  12920000
129300     EXEC SQL                                                     12930000
129400         SELECT DEPT_NBR                                          12940000
129500          INTO :PURCHS-DEPT-NBR                                   12950000
129600           FROM TPURCHS                                           12960000
129700          WHERE PO_NBR     = :SUT00028-TRN-NBR                    12970000
129800     END-EXEC                                                     12980000
129900                                                                  12990000
130000     EVALUATE TRUE                                                13000000
130100         WHEN SQLCODE = +0                                        13010000
130200             MOVE PURCHS-DEPT-NBR   TO  PT-DEPT (PT-PO-IDX)       13020000
130300         WHEN SQLCODE NOT EQUAL +0                                13030000
130400             MOVE SPACES            TO  PT-DEPT (PT-PO-IDX)       13040000
130500             MOVE ZEROES            TO  SQLCODE                   13050000
130600     END-EVALUATE.                                                13060000
130700                                                                  13070000
130800*---------------------------------------------------------------  13080048
130900 2220-SELECT-STAT-CDE.                                            13090048
131000                                                                  13100048
131100     MOVE PT-PURCHASE-ORDER (+1) TO     DK-PO-NBR                 13110049
131200     MOVE PT-RCVR-NBR       (+1) TO     DK-PO-RCVR                13120049
131300     EXEC SQL                                                     13130050
131400         SELECT STATUS_CDE                                        13140048
131500          INTO :RECEIV-STATUS-CDE                                 13150048
131600           FROM TRECEIV                                           13160048
131700          WHERE ORD_NBR     = :DK-PO-NBR                          13170049
131800            AND REC_SEQ_NBR = :DK-PO-RCVR                         13180049
131900     END-EXEC                                                     13190048
132000                                                                  13200048
132100     EVALUATE TRUE                                                13210048
132200         WHEN SQLCODE = +0                                        13220048
132300             MOVE RECEIV-STATUS-CDE TO  DK-STATUS-CDE             13230048
132400         WHEN SQLCODE NOT EQUAL +0                                13240048
132500             MOVE SPACES            TO  DK-STATUS-CDE             13250048
132600     END-EVALUATE.                                                13260048
132700                                                                  13270048
132800*--------------------------------------------------------------   13280000
132900 2300-CLOSE-CART-UPC-CURSOR.                                      13290000
133000                                                                  13300000
133100     EXEC SQL                                                     13310000
133200         CLOSE CART-UPC-PO-CSR                                    13320000
133300     END-EXEC                                                     13330000
133400                                                                  13340000
133500     EVALUATE TRUE                                                13350000
133600          WHEN SQLCODE = +0                                       13360000
133700                 CONTINUE                                         13370000
133800          WHEN SQLCODE NOT EQUAL +0                               13380000
133900               MOVE '2300-CLOS-CART-UPC-CURSOR'                   13390000
134000                                               TO DP013-PARAGRAPH 13400000
134100               MOVE 'ERROR CLOSING THE CURSOR'                    13410000
134200                                        TO DP013-MESSAGE-TEXT (1) 13420000
134300               MOVE SQLCA        TO DP013-SQLCA                   13430000
134400               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      13440000
134500               SET DP013-DB2-ABEND                                13450000
134600                   DP013-ROLLBACK   TO TRUE                       13460000
134700               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             13470000
134800     END-EVALUATE.                                                13480000
134900                                                                  13490000
135000*--------------------------------------------------------------   13500000
135100 3000-TPKSLIP-CURSOR-DRIVER.                                      13510000
135200                                                                  13520000
135300     PERFORM 3100-OPEN-TPKSLIP-CURSOR.                            13530000
135400     PERFORM 3200-FETCH-TPKSLIP-CURSOR.                           13540000
135500     PERFORM 3300-CLOSE-TPKSLIP-CURSOR.                           13550000
135600                                                                  13560000
135700*--------------------------------------------------------------   13570000
135800 3100-OPEN-TPKSLIP-CURSOR.                                        13580000
135900                                                                  13590000
136000     EXEC SQL                                                     13600000
136100         OPEN TPKSLIP-PO-CSR                                      13610000
136200     END-EXEC                                                     13620000
136300                                                                  13630000
136400     EVALUATE TRUE                                                13640000
136500          WHEN SQLCODE = +0                                       13650000
136600                 CONTINUE                                         13660000
136700          WHEN SQLCODE NOT EQUAL +0                               13670000
136800               MOVE '3100-OPEN-TPKSLIP-CURSOR' TO DP013-PARAGRAPH 13680000
136900               MOVE 'ERROR OPENING THE CURSOR'                    13690000
137000                                        TO DP013-MESSAGE-TEXT (1) 13700000
137100               MOVE SQLCA        TO DP013-SQLCA                   13710000
137200               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      13720000
137300               SET DP013-DB2-ABEND                                13730000
137400                   DP013-ROLLBACK   TO TRUE                       13740000
137500               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             13750000
137600     END-EVALUATE.                                                13760000
137700                                                                  13770000
137800*---------------------------------------------------------------  13780000
137900 3200-FETCH-TPKSLIP-CURSOR.                                       13790000
138000                                                                  13800000
138100     PERFORM VARYING PT-PO-IDX                                    13810000
138200         FROM 1 BY 1                                              13820000
138300         UNTIL  SQLCODE NOT = +0                                  13830000
138400                                                                  13840000
138500         EXEC SQL                                                 13850000
138600             FETCH TPKSLIP-PO-CSR                                 13860000
138700             INTO :SUT00026-PO-NBR                                13870000
138800                 ,:PKSLIP-REC-SEQ-NBR                             13880000
138900         END-EXEC                                                 13890000
139000                                                                  13900000
139100         EVALUATE TRUE                                            13910000
139200             WHEN SQLCODE = +0                                    13920000
139300                 MOVE SUT00026-PO-NBR TO                          13930000
139400                                    PT-PURCHASE-ORDER (PT-PO-IDX) 13940000
139500                 MOVE PKSLIP-REC-SEQ-NBR  TO                      13950000
139600                                          PT-RCVR-NBR (PT-PO-IDX) 13960000
139700                 ADD 1 TO PT-TABLE-ENTRIES                        13970000
139800                 IF  PKSLIP-REC-SEQ-NBR  = 0                      13980052
139900                    SET PS-ZERO-RCVR-SEQ-YES TO TRUE              13990052
140000                 ELSE                                             14000052
140100                    SET PS-ZERO-RCVR-SEQ-NO  TO TRUE              14010052
140200                 END-IF                                           14020052
140300                 PERFORM 3210-SELECT-PCKG-CDE                     14030000
140400             WHEN SQLCODE NOT EQUAL +0                            14040000
140500                 CONTINUE                                         14050000
140600         END-EVALUATE                                             14060000
140700     END-PERFORM.                                                 14070000
140800                                                                  14080000
140900*---------------------------------------------------------------  14090000
141000 3210-SELECT-PCKG-CDE.                                            14100000
141100                                                                  14110000
141200     EXEC SQL                                                     14120000
141300         SELECT PKGNG_CDE                                         14130000
141400              , STATUS_CDE                                        14140047
141500          INTO :RECEIV-PKGNG-CDE                                  14150000
141600             , :RECEIV-STATUS-CDE                                 14160047
141700           FROM TRECEIV                                           14170000
141800          WHERE ORD_NBR     = :SUT00026-PO-NBR                    14180000
141900            AND REC_SEQ_NBR = :PKSLIP-REC-SEQ-NBR                 14190000
142000     END-EXEC.                                                    14200000
142100                                                                  14210000
142200     EVALUATE TRUE                                                14220000
142300         WHEN SQLCODE = +0                                        14230000
142400             MOVE RECEIV-PKGNG-CDE  TO  PT-PKGNG-CDE (PT-PO-IDX)  14240000
142500             MOVE RECEIV-STATUS-CDE TO  DK-STATUS-CDE             14250047
142600         WHEN SQLCODE NOT EQUAL +0                                14260000
142700             MOVE SPACES            TO  PT-PKGNG-CDE (PT-PO-IDX)  14270000
142800             MOVE ZEROES            TO  SQLCODE                   14280000
142900     END-EVALUATE.                                                14290000
143000                                                                  14300000
143100*---------------------------------------------------------------  14310048
143200 3220-SELECT-STAT-CDE.                                            14320048
143300                                                                  14330048
143400     MOVE PT-PURCHASE-ORDER (+1) TO     DK-PO-NBR                 14340049
143500     MOVE PT-RCVR-NBR       (+1) TO     DK-PO-RCVR                14350049
143600     EXEC SQL                                                     14360048
143700         SELECT STATUS_CDE                                        14370048
143800          INTO :RECEIV-STATUS-CDE                                 14380048
143900           FROM TRECEIV                                           14390048
144000          WHERE ORD_NBR     = :DK-PO-NBR                          14400049
144100            AND REC_SEQ_NBR = :DK-PO-RCVR                         14410049
144200     END-EXEC.                                                    14420048
144300                                                                  14430048
144400     EVALUATE TRUE                                                14440048
144500         WHEN SQLCODE = +0                                        14450048
144600             MOVE RECEIV-STATUS-CDE TO  DK-STATUS-CDE             14460048
144700         WHEN SQLCODE NOT EQUAL +0                                14470048
144800             MOVE SPACES            TO  DK-STATUS-CDE             14480048
144900     END-EVALUATE.                                                14490048
145000                                                                  14500048
145100*--------------------------------------------------------------   14510048
145200 3300-CLOSE-TPKSLIP-CURSOR.                                       14520000
145300                                                                  14530000
145400     EXEC SQL                                                     14540000
145500         CLOSE TPKSLIP-PO-CSR                                     14550000
145600     END-EXEC.                                                    14560000
145700                                                                  14570000
145800     EVALUATE TRUE                                                14580000
145900          WHEN SQLCODE = +0                                       14590000
146000                 CONTINUE                                         14600000
146100          WHEN SQLCODE NOT EQUAL +0                               14610000
146200               MOVE '3300-CLOS-TPKSLIP-CURSOR' TO DP013-PARAGRAPH 14620000
146300               MOVE 'ERROR CLOSING THE CURSOR'                    14630000
146400                                        TO DP013-MESSAGE-TEXT (1) 14640000
146500               MOVE SQLCA        TO DP013-SQLCA                   14650000
146600               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      14660000
146700               SET DP013-DB2-ABEND                                14670000
146800                   DP013-ROLLBACK   TO TRUE                       14680000
146900               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             14690000
147000     END-EVALUATE.                                                14700000
147100                                                                  14710000
147200*--------------------------------------------------------------   14720052
147300 3400-TPKSLIP-CURSOR-INBOUND.                                     14730052
147400                                                                  14740052
147500     PERFORM 3410-OPEN-TPKSLIP-INBND-CSR.                         14750052
147600     PERFORM 3420-FETCH-TPKSLIP-INBND-CSR.                        14760052
147700     PERFORM 3440-CLOSE-TPKSLIP-INBND-CSR.                        14770052
147800                                                                  14780052
147900*--------------------------------------------------------------   14790052
148000 3410-OPEN-TPKSLIP-INBND-CSR.                                     14800052
148100                                                                  14810052
148200     EXEC SQL                                                     14820052
148300         OPEN PKSLIP-PO-INBD-CSR                                  14830054
148400     END-EXEC                                                     14840052
148500                                                                  14850052
148600     EVALUATE TRUE                                                14860052
148700          WHEN SQLCODE = +0                                       14870052
148800                 CONTINUE                                         14880052
148900          WHEN SQLCODE NOT EQUAL +0                               14890052
149000               MOVE '3410-OPEN-TPKSLIP-INBND-CSR'                 14900052
149100                                               TO DP013-PARAGRAPH 14910052
149200               MOVE 'ERROR OPENING THE CURSOR'                    14920052
149300                                        TO DP013-MESSAGE-TEXT (1) 14930052
149400               MOVE SQLCA        TO DP013-SQLCA                   14940052
149500               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      14950052
149600               MOVE 'TINPKSU'    TO DP013-DB2-TABLE-NAME (2)      14960052
149700               MOVE 'TSHPUNT'    TO DP013-DB2-TABLE-NAME (3)      14970052
149800               SET DP013-DB2-ABEND                                14980052
149900                   DP013-ROLLBACK   TO TRUE                       14990052
150000               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             15000052
150100     END-EVALUATE.                                                15010052
150200                                                                  15020052
150300*---------------------------------------------------------------  15030052
150400 3420-FETCH-TPKSLIP-INBND-CSR.                                    15040052
150500                                                                  15050052
150600     PERFORM VARYING PT-PO-IDX                                    15060052
150700         FROM 1 BY 1                                              15070052
150800         UNTIL  SQLCODE NOT = +0                                  15080052
150900                                                                  15090052
151000         EXEC SQL                                                 15100052
151100             FETCH PKSLIP-PO-INBD-CSR                             15110054
151200             INTO :INPKSU-PO-NBR                                  15120052
151300                 ,:PKSLIP-REC-SEQ-NBR                             15130052
151400         END-EXEC                                                 15140052
151500                                                                  15150052
151600         EVALUATE TRUE                                            15160052
151700             WHEN SQLCODE = +0                                    15170052
151800                 MOVE INPKSU-PO-NBR TO                            15180052
151900                                    PT-PURCHASE-ORDER (PT-PO-IDX) 15190052
152000                 MOVE PKSLIP-REC-SEQ-NBR  TO                      15200052
152100                                          PT-RCVR-NBR (PT-PO-IDX) 15210052
152200                 ADD 1 TO PT-TABLE-ENTRIES                        15220052
152300                 PERFORM 3430-SELECT-PCKG-CDE-INBND               15230052
152400             WHEN SQLCODE NOT EQUAL +0                            15240052
152500                 CONTINUE                                         15250052
152600         END-EVALUATE                                             15260052
152700     END-PERFORM.                                                 15270052
152800                                                                  15280052
152900*---------------------------------------------------------------  15290052
153000 3430-SELECT-PCKG-CDE-INBND.                                      15300052
153100                                                                  15310052
153200     EXEC SQL                                                     15320052
153300         SELECT PKGNG_CDE                                         15330052
153400              , STATUS_CDE                                        15340052
153500          INTO :RECEIV-PKGNG-CDE                                  15350052
153600             , :RECEIV-STATUS-CDE                                 15360052
153700           FROM TRECEIV                                           15370052
153800          WHERE ORD_NBR     = :INPKSU-PO-NBR                      15380052
153900            AND REC_SEQ_NBR = :PKSLIP-REC-SEQ-NBR                 15390052
154000     END-EXEC.                                                    15400052
154100                                                                  15410052
154200     EVALUATE TRUE                                                15420052
154300         WHEN SQLCODE = +0                                        15430052
154400             MOVE RECEIV-PKGNG-CDE  TO  PT-PKGNG-CDE (PT-PO-IDX)  15440052
154500             MOVE RECEIV-STATUS-CDE TO  DK-STATUS-CDE             15450052
154600         WHEN SQLCODE NOT EQUAL +0                                15460052
154700             MOVE SPACES            TO  PT-PKGNG-CDE (PT-PO-IDX)  15470052
154800             MOVE ZEROES            TO  SQLCODE                   15480052
154900     END-EVALUATE.                                                15490052
155000                                                                  15500052
155100*---------------------------------------------------------------  15510052
155200 3440-CLOSE-TPKSLIP-INBND-CSR.                                    15520052
155300                                                                  15530052
155400     EXEC SQL                                                     15540052
155500         CLOSE PKSLIP-PO-INBD-CSR                                 15550054
155600     END-EXEC.                                                    15560052
155700                                                                  15570052
155800     EVALUATE TRUE                                                15580052
155900          WHEN SQLCODE = +0                                       15590052
156000                 CONTINUE                                         15600052
156100          WHEN SQLCODE NOT EQUAL +0                               15610052
156200               MOVE '3430-CLOSE-TPKSLIP-INBND-CSR'                15620052
156300                                               TO DP013-PARAGRAPH 15630052
156400               MOVE 'ERROR CLOSING THE CURSOR'                    15640052
156500                                        TO DP013-MESSAGE-TEXT (1) 15650052
156600               MOVE SQLCA        TO DP013-SQLCA                   15660052
156700               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      15670052
156800               MOVE 'TINPSKU'    TO DP013-DB2-TABLE-NAME (2)      15680052
156900               MOVE 'TSHPUNT'    TO DP013-DB2-TABLE-NAME (3)      15690052
157000               SET DP013-DB2-ABEND                                15700052
157100                   DP013-ROLLBACK   TO TRUE                       15710052
157200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             15720052
157300     END-EVALUATE.                                                15730052
157400                                                                  15740052
157500*-----------------------------------------------------------------15750052
157600 3500-TRY-LBVRDA-FOR-DATA.                                        15760052
157700*-----------------------------------------------------------------15770000
157800                                                                  15780000
157900     MOVE PC038-SHPUNT-DEST-OPER     TO PC039-STR-NBR             15790000
158000                                        DK-STORE-NUMBER.          15800037
158100                                                                  15810000
158200     EXEC SQL                                                     15820000
158300          SELECT  PO_NBR                                          15830033
158400                 ,RCVR_SEQ_NBR                                    15840033
158500                 ,PREPK_ID                                        15850033
158600                 ,PO_LNE_NBR                                      15860033
158700                 ,PREPK_PRCG_LNE_NBR                              15870033
158800                 ,PREPK_ID                                        15880033
158900                 ,OTPK_UNT_QTY                                    15890033
159000                 ,INPK_UNT_QTY                                    15900033
159100                 ,DEPT_DESC                                       15910033
159200                 ,MAJ_CL_DESC                                     15920033
159300                 ,SEASET_NM                                       15930033
159400                 ,FIXT_ID                                         15940033
159500                 ,STR_ZN_ID                                       15950033
159600                 ,DEST_OPER_UNT_ID                                15960033
159700                 ,PREPK_RATO_QTY                                  15970033
159800                 ,PREPK_UNT_QTY                                   15980033
159900                 ,INPK_CNVYB_IND                                  15990033
160000            INTO :LBVRDA-PO-NBR                                   16000000
160100                ,:LBVRDA-RCVR-SEQ-NBR                             16010000
160200                ,:LBVRDA-PREPK-ID                                 16020000
160300                ,:LBVRDA-PO-LNE-NBR                               16030000
160400                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       16040000
160500                ,:LBVRDA-PREPK-ID                                 16050000
160600                ,:LBVRDA-OTPK-UNT-QTY                             16060000
160700                ,:LBVRDA-INPK-UNT-QTY                             16070000
160800                ,:LBVRDA-DEPT-DESC                                16080000
160900                ,:LBVRDA-MAJ-CL-DESC                              16090000
161000                ,:LBVRDA-SEASET-NM                                16100000
161100                ,:LBVRDA-FIXT-ID                                  16110000
161200                ,:LBVRDA-STR-ZN-ID                                16120000
161300                ,:LBVRDA-DEST-OPER-UNT-ID                         16130000
161400                ,:LBVRDA-PREPK-RATO-QTY                           16140000
161500                ,:LBVRDA-PREPK-UNT-QTY                            16150000
161600                ,:LBVRDA-INPK-CNVYB-IND                           16160000
161700            FROM  TLBVRDA                                         16170033
161800           WHERE  BRCDE_NBR         =  :PC038-SULBXF-BARCODE      16180033
161900             AND  DEST_OPER_UNT_ID  =  :DK-STORE-NUMBER           16190033
162000     END-EXEC.                                                    16200000
162100                                                                  16210000
162200     EVALUATE TRUE                                                16220000
162300         WHEN SQLCODE = ZERO                                      16230000
162400             IF PC039-LBL-FORMAT = PC-P                           16240000
162500                 MOVE PC-G TO PC039-LBL-FORMAT                    16250000
162600             ELSE                                                 16260000
162700                 MOVE PC-S TO PC039-LBL-FORMAT                    16270000
162800             END-IF                                               16280000
162900             ADD 1 TO PT-TABLE-ENTRIES                            16290000
163000             SET PC039-4-BY-4-LBL           TO TRUE               16300000
163100             SET PT-SINGLE-LINE (PT-PO-IDX) TO TRUE               16310000
163200             SET PT-SINGLE-PREPK (PT-PO-IDX) TO TRUE              16320000
163300             MOVE LBVRDA-PO-NBR  TO PC039-PO-NBR                  16330000
163400                                    PT-PURCHASE-ORDER (PT-PO-IDX) 16340000
163500             MOVE LBVRDA-RCVR-SEQ-NBR  TO PC039-PO-RCVR           16350000
163600                                          PT-RCVR-NBR (PT-PO-IDX) 16360000
163700             MOVE LBVRDA-PREPK-ID      TO PC039-PREPK-ID          16370000
163800                                          PT-PREPK-ID (PT-PO-IDX) 16380000
163900             MOVE LBVRDA-INPK-UNT-QTY       TO PC039-INPK-UNITS   16390000
164000             MOVE LBVRDA-DEPT-DESC          TO PC039-DEPT-NAME    16400000
164100             MOVE LBVRDA-MAJ-CL-DESC        TO PC039-MAJOR-CLASS  16410000
164200             MOVE LBVRDA-SEASET-NM          TO PC039-SEASONAL-SET 16420000
164300             MOVE LBVRDA-FIXT-ID            TO PC039-FIXTURE      16430000
164400             MOVE LBVRDA-STR-ZN-ID          TO PC039-ZONE         16440000
164500             MOVE LBVRDA-PREPK-RATO-QTY     TO PC039-PREPK-RATIO  16450000
164600             MOVE LBVRDA-PREPK-UNT-QTY      TO PC039-PREPK-UNT-QTY16460000
164700             PERFORM 3510-GET-OTPK-FROM-UPC                       16470000
164800             IF LBVRDA-PREPK-ID > ZEROES                          16480000
164900                 MOVE LBVRDA-PREPK-PRCG-LNE-NBR TO                16490000
165000                                           PC039-LNE-NBR          16500000
165100                                           PT-LNE-NBR (PT-PO-IDX) 16510000
165200                 SET  PC039-PREPK          TO TRUE                16520000
165300             ELSE                                                 16530000
165400                 MOVE LBVRDA-PO-LNE-NBR TO PC039-LNE-NBR          16540000
165500                                           PT-LNE-NBR (PT-PO-IDX) 16550000
165600             END-IF                                               16560000
165700             IF LBVRDA-INPK-CNVYB-IND   = PC-Y                    16570000
165800                 SET PC039-INPK   TO TRUE                         16580000
165900             ELSE                                                 16590000
166000                 SET PC039-FCSE   TO TRUE                         16600000
166100             END-IF                                               16610000
166200             SET PS-FOUND-ON-TLBVRDA TO TRUE                      16620000
166300             INITIALIZE XL071-COMMAREA-REC                        16630039
166400             MOVE DK-STR-NBR         TO XL071-LOCATION-NUMBER     16640035
166500             PERFORM 7500-GET-LOCATION-INFO                       16650035
166600             MOVE XL071-LOC-10-ABBR-NM TO  PC140-RF-STR-NAME      16660035
166700         WHEN SQLCODE = +100                                      16670000
166800             SET PS-NOT-FOUND-TLBVRDA TO TRUE                     16680000
166900         WHEN OTHER                                               16690000
167000               MOVE '3500-TRY-LBVRDA-FOR-DATA' TO DP013-PARAGRAPH 16700000
167100               MOVE SQLCA        TO DP013-SQLCA                   16710000
167200               MOVE 'TLBVRDA'    TO DP013-DB2-TABLE-NAME (1)      16720000
167300               SET DP013-DB2-ABEND                                16730000
167400                   DP013-ROLLBACK   TO TRUE                       16740000
167500               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             16750000
167600     END-EVALUATE.                                                16760000
167700                                                                  16770000
167800*-----------------------------------------------------------------16780000
167900*  GET THE OUTERPACK QYT FOR THE CARTON FROM THE UPC TABLE       -16790000
168000*-----------------------------------------------------------------16800000
168100 3510-GET-OTPK-FROM-UPC.                                          16810000
168200                                                                  16820000
168300     IF PC038-ON-TSHPUNT                                          16830000
168400         MOVE  PC038-CARTON-ID-ENTERED                            16840000
168500           TO  DK-SHIPT-UNT-ID-2                                  16850000
168600     ELSE                                                         16860000
168700         MOVE  PC038-SHPUNT-SHIPT-UNT-ID                          16870000
168800           TO  DK-SHIPT-UNT-ID-2                                  16880000
168900     END-IF.                                                      16890000
169000                                                                  16900000
169100     MOVE  PC038-CARTON-ID-ENTERED     TO  DK-SHIPT-UNT-ID-2.     16910000
169200                                                                  16920000
169300     EXEC SQL                                                     16930000
169400         SELECT SUM(SHPD_UNT_QTY)                                 16940000
169500          INTO :PV-LINE-SHPD-UNITS                                16950000
169600          FROM SUT_OTBND_UPC                                      16960000
169700         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID-2             16970000
169800     END-EXEC                                                     16980000
169900                                                                  16990000
170000     EVALUATE TRUE                                                17000000
170100         WHEN SQLCODE = +0                                        17010000
170200             MOVE PV-LINE-SHPD-UNITS TO  PC039-OTPK-UNITS         17020000
170300                                         PC039-PREPK-UNT-QTY      17030000
170400                                         LBVRDA-OTPK-UNT-QTY      17040000
170500         WHEN SQLCODE = -305                                      17050000
170600              CONTINUE                                            17060000
170700                                                                  17070000
170800         WHEN SQLCODE NOT EQUAL +0                                17080000
170900             MOVE ZEROES             TO  PC039-OTPK-UNITS         17090000
171000                                         PC039-PREPK-UNT-QTY      17100000
171100                                         LBVRDA-OTPK-UNT-QTY      17110000
171200     END-EVALUATE.                                                17120000
171300                                                                  17130000
171400                                                                  17140000
171500*-----------------------------------------------------------------17150000
171600 4000-GET-LINE-INFO.                                              17160000
171700                                                                  17170000
171800     EXEC SQL                                                     17180000
171900         SELECT DISTINCT TRN_LNE_NBR                              17190000
172000               ,UPC_NBR                                           17200000
172100          INTO :SUT00028-TRN-LNE-NBR                              17210000
172200              ,:SUT00028-UPC-NBR                                  17220000
172300           FROM SUT_OTBND_UPC                                     17230000
172400          WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                 17240000
172500     END-EXEC.                                                    17250000
172600                                                                  17260000
172700     EVALUATE TRUE                                                17270000
172800         WHEN SQLCODE = +0                                        17280000
172900             MOVE SUT00028-TRN-LNE-NBR TO PT-LNE-NBR (PT-PO-IDX)  17290000
173000                                        PC038-PO-LNE-NBR          17300000
173100             MOVE SUT00028-UPC-NBR   TO PT-UPC-NBR (PT-PO-IDX)    17310000
173200                                        PC038-UPC-NBR             17320000
173300             SET PC038-LINE                                       17330000
173400                 PT-SINGLE-LINE (PT-PO-IDX) TO TRUE               17340000
173500         WHEN SQLCODE = -811                                      17350000
173600             SET PC038-MULTI-LNE                                  17360000
173700                 PT-MULTI-LINE (PT-PO-IDX)  TO TRUE               17370000
173800             IF PT-PREPK-PO  (PT-PO-IDX)                          17380000
173900                 PERFORM 4100-GET-PREPK-PO                        17390000
174000             END-IF                                               17400000
174100         WHEN SQLCODE NOT EQUAL +0                                17410000
174200             MOVE ZEROES             TO PT-LNE-NBR (PT-PO-IDX)    17420000
174300                                        PT-UPC-NBR (PT-PO-IDX)    17430000
174400     END-EVALUATE.                                                17440000
174500                                                                  17450000
174600*-----------------------------------------------------------------17460000
174700 4100-GET-PREPK-PO.                                               17470000
174800                                                                  17480000
174900     MOVE PT-PURCHASE-ORDER (PT-PO-IDX) TO DK-PURCHASE-ORDER.     17490000
175000     MOVE PT-RCVR-NBR (PT-PO-IDX)       TO DK-RCVR-NBR.           17500000
175100     EXEC SQL                                                     17510000
175200         SELECT DISTINCT B.PREPK_ID                               17520000
175300          INTO :RECITM-PREPK-ID                                   17530000
175400           FROM TRECITM B                                         17540000
175500          WHERE B.ORD_NBR      =  :DK-PURCHASE-ORDER              17550000
175600            AND B.REC_SEQ_NBR  =  :DK-RCVR-NBR                    17560000
175700            AND B.ORD_LNE_NBR  IN                                 17570000
175800              (SELECT A.TRN_LNE_NBR                               17580000
175900               FROM SUT_OTBND_UPC A                               17590000
176000               WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID            17600014
176100                 AND A.TRN_NBR      = :DK-PURCHASE-ORDER          17610014
176200                 AND A.RCVR_SEQ_NBR = :DK-RCVR-NBR)               17620014
176300     END-EXEC.                                                    17630000
176400                                                                  17640000
176500     EVALUATE TRUE                                                17650000
176600         WHEN SQLCODE = +0                                        17660000
176700             MOVE RECITM-PREPK-ID  TO PT-PREPK-ID (PT-PO-IDX)     17670000
176800             SET PT-SINGLE-PREPK (PT-PO-IDX) TO TRUE              17680000
176900         WHEN SQLCODE = -811                                      17690000
177000             SET PT-MULTI-PREPK (PT-PO-IDX) TO TRUE               17700000
177100         WHEN SQLCODE NOT EQUAL +0                                17710000
177200             MOVE ZEROES             TO PT-PREPK-ID (PT-PO-IDX)   17720000
177300     END-EVALUATE.                                                17730000
177400                                                                  17740000
177500*-----------------------------------------------------------------17750000
177600                                                                  17760009
177700*-----------------------------------------------------------------17770009
177800 4200-GET-DEPT-CL-SKU.                                            17780009
177900                                                                  17790009
178000     MOVE PT-PURCHASE-ORDER (+1)  TO DK-PURCHASE-ORDER.           17800009
178100     MOVE PT-RCVR-NBR (+1)        TO DK-RCVR-NBR.                 17810009
178200     MOVE PT-LNE-NBR (+1)         TO DK-LNE-NBR.                  17820009
178300                                                                  17830009
178400     EXEC SQL                                                     17840009
178500         SELECT                                                   17850009
178600         DISTINCT                                                 17860009
178700                B.ITM_NBR                                         17870009
178800             ,  B.SKU_SEQ_NBR                                     17880009
178900               ,C.DEPT_NBR                                        17890009
179000          INTO                                                    17900009
179100               :PURITM-ITM-NBR                                    17910009
179200             , :PURITM-SKU-SEQ-NBR                                17920009
179300              ,:PURCHS-DEPT-NBR                                   17930009
179400           FROM TRECITM A                                         17940009
179500               ,TPURITM B                                         17950009
179600               ,TPURCHS C                                         17960009
179700          WHERE A.ORD_NBR        =  :DK-PURCHASE-ORDER            17970009
179800            AND A.REC_SEQ_NBR    =  :DK-RCVR-NBR                  17980009
179900            AND A.ORD_NBR        =  B.PO_NBR                      17990009
180000            AND A.ORD_LNE_NBR    =  :DK-LNE-NBR                   18000009
180100            AND A.ORD_LNE_NBR    =  B.APP_PO_LNE_NBR              18010009
180200            AND A.VER_STATUS_CDE =  'A'                           18020009
180300            AND A.PO_VER_NBR     =  B.VER_NBR                     18030009
180400            AND A.ORD_NBR        =  C.PO_NBR                      18040009
180500     END-EXEC                                                     18050009
180600                                                                  18060010
180700     EVALUATE TRUE                                                18070010
180800         WHEN SQLCODE = +0                                        18080010
180900              IF  PURITM-SKU-SEQ-NBR = ZERO OR '999'              18090010
181000                  CONTINUE                                        18100010
181100              ELSE                                                18110010
181200                  PERFORM 4205-GET-SKU                            18120010
181300              END-IF                                              18130010
181400         WHEN SQLCODE = +100                                      18140010
181500              CONTINUE                                            18150010
181600         WHEN SQLCODE NOT EQUAL +0                                18160010
181700              CONTINUE                                            18170010
181800     END-EVALUATE.                                                18180010
181900                                                                  18190009
182000                                                                  18200009
182100 4205-GET-SKU.                                                    18210009
182200     INITIALIZE XL001-ITEM-COMMAREA                               18220009
182300     SET XL001-SELECT-SKU                                         18230009
182400         XL001-BY-ITEM                TO TRUE                     18240009
182500                                                                  18250009
182600     MOVE PURITM-ITM-NBR              TO XL001-KEY-ITM-NBR        18260009
182700                                                                  18270009
182800     PERFORM 8600-CALL-XLKUT001.                                  18280009
182900                                                                  18290009
183000     EVALUATE TRUE                                                18300009
183100         WHEN XL001-SKU-SQLCODE = ZERO                            18310009
183200         WHEN XL001-SKU-SQLCODE = -811                            18320009
183300         WHEN XL001-SKU-SQLCODE = +100                            18330009
183400             MOVE XL001-SKU-NBR TO PC038-SKU-NBR                  18340009
183500             MOVE 'LNE:'     TO ALNEPCKO                          18350009
183600             MOVE PT-LNE-NBR(+1)  TO DK-LNE-NBR                   18360009
183700             MOVE DK-LNE-NBR      TO DK-LNE-NBR-N                 18370009
183800             STRING DK-LINE-NBR        DELIMITED BY SIZE          18380009
183900                       ' '             DELIMITED BY SIZE          18390009
184000                       '('             DELIMITED BY SIZE          18400009
184100                    PC038-SKU-NBR      DELIMITED BY SIZE          18410009
184200                       ')'             DELIMITED BY SIZE          18420009
184300                                   INTO ATEXTO                    18430009
184400                                                                  18440009
184500         WHEN OTHER                                               18450009
184600             MOVE ZEROES             TO PC038-SKU-NBR             18460009
184700     END-EVALUATE.                                                18470009
184800/                                                                 18480009
184900*-----------------------------------------------------------------18490000
185000 4500-NBR-UNTS-PCKS.                                              18500000
185100                                                                  18510000
185200     IF PT-PREPK-PO (PT-PO-IDX)                                   18520014
185300         PERFORM 4600-PREPKID-CURSOR-DRIVER                       18530000
185400     END-IF.                                                      18540000
185500                                                                  18550000
185600*--------------------------------------------------------------   18560000
185700 4600-PREPKID-CURSOR-DRIVER.                                      18570000
185800                                                                  18580000
186300     PERFORM 4650-OPEN-PREPK-CURSOR.                              18630021
186400     PERFORM 4655-FETCH-PREPK-CURSOR.                             18640021
186500     PERFORM 4660-CLOSE-PREPK-CURSOR.                             18650021
186600                                                                  18660021
193100                                                                  19310000
193200*--------------------------------------------------------------   19320021
193210*                                                             -   19321069
193220*--------------------------------------------------------------   19322069
193300 4650-OPEN-PREPK-CURSOR.                                          19330021
193400                                                                  19340021
193500     MOVE PT-PURCHASE-ORDER (PT-PO-IDX) TO DK-PO-NBR.             19350021
193600     MOVE PT-RCVR-NBR (PT-PO-IDX)       TO DK-PO-RCVR.            19360021
193700     EXEC SQL                                                     19370021
193800         OPEN PREPK_PACK_CSR                                      19380021
193900     END-EXEC                                                     19390021
194000                                                                  19400021
194100     EVALUATE TRUE                                                19410021
194200          WHEN SQLCODE = +0                                       19420021
194300                 CONTINUE                                         19430021
194400          WHEN SQLCODE NOT EQUAL +0                               19440021
194500               MOVE '4650-OPEN-PREPK-CURSOR  ' TO DP013-PARAGRAPH 19450021
194600               MOVE 'ERROR OPENING THE CURSOR'                    19460021
194700                                        TO DP013-MESSAGE-TEXT (1) 19470021
194800               MOVE SQLCA        TO DP013-SQLCA                   19480021
194900               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      19490021
195000               SET DP013-DB2-ABEND                                19500021
195100                   DP013-ROLLBACK   TO TRUE                       19510021
195200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             19520021
195300     END-EVALUATE.                                                19530021
195400                                                                  19540021
195500                                                                  19550021
195600                                                                  19560021
195700*--------------------------------------------------------------   19570021
195800 4655-FETCH-PREPK-CURSOR.                                         19580021
195900                                                                  19590021
196000     MOVE  ZEROES  TO  PT-NBR-PACKS (PT-PO-IDX).                  19600021
196100                                                                  19610021
196200     PERFORM                                                      19620021
196300       UNTIL  SQLCODE NOT = +0                                    19630021
196400                                                                  19640021
196500         EXEC SQL                                                 19650021
196600             FETCH PREPK_PACK_CSR                                 19660021
196700             INTO :PV-PREPK-SHPD-UNITS                            19670021
196800                 ,:PV-PREPK-RATIO-UNITS                           19680022
196900         END-EXEC                                                 19690021
197000                                                                  19700021
197100         EVALUATE TRUE                                            19710021
197200             WHEN SQLCODE = +0                                    19720021
197300                 IF  PV-PREPK-RATIO-UNITS  > 0  AND               19730021
197400                     PV-PREPK-SHPD-UNITS   > 0                    19740022
197500                     DIVIDE  PV-PREPK-SHPD-UNITS  BY              19750021
197600                             PV-PREPK-RATIO-UNITS                 19760021
197700                      GIVING PV-PREPK-IN-CRTN                     19770021
197800                      ADD  PV-PREPK-IN-CRTN                       19780021
197900                       TO  PT-NBR-PACKS (PT-PO-IDX)               19790021
198000                 END-IF                                           19800022
198100                                                                  19810021
198200             WHEN SQLCODE NOT EQUAL +0                            19820021
198300                 CONTINUE                                         19830021
198400         END-EVALUATE                                             19840021
198500     END-PERFORM.                                                 19850021
198600                                                                  19860021
198700                                                                  19870021
198800*--------------------------------------------------------------   19880021
198900 4660-CLOSE-PREPK-CURSOR.                                         19890021
199000                                                                  19900021
199100     EXEC SQL                                                     19910021
199200         CLOSE PREPK_PACK_CSR                                     19920021
199300     END-EXEC.                                                    19930021
199400                                                                  19940021
199500     EVALUATE TRUE                                                19950021
199600          WHEN SQLCODE = +0                                       19960021
199700              CONTINUE                                            19970021
199800          WHEN SQLCODE NOT EQUAL +0                               19980021
199900               MOVE '4660-CLOSE-PREPK-CURSOR ' TO DP013-PARAGRAPH 19990021
200000               MOVE 'ERROR CLOSING THE CURSOR'                    20000021
200100                                        TO DP013-MESSAGE-TEXT (1) 20010021
200200               MOVE SQLCA        TO DP013-SQLCA                   20020021
200300               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      20030021
200400               SET DP013-DB2-ABEND                                20040021
200500                   DP013-ROLLBACK   TO TRUE                       20050021
200600               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             20060021
200700     END-EVALUATE.                                                20070021
200800                                                                  20080021
200900                                                                  20090021
201000                                                                  20100021
214400                                                                  21440000
214500*-----------------------------------------------------------------21450000
214600 4900-DETERMIN-UNTS.                                              21460000
214700*-----------------------------------------------------------------21470000
214800                                                                  21480000
214900     MOVE PT-PURCHASE-ORDER(PT-PO-IDX)                            21490016
215000       TO DK-PO-NBR.                                              21500016
215100     MOVE PT-RCVR-NBR(PT-PO-IDX)                                  21510016
215200       TO DK-PO-RCVR.                                             21520016
215300                                                                  21530015
215400     EXEC SQL                                                     21540000
215500         SELECT SUM(SHPD_UNT_QTY)                                 21550000
215600          INTO :PV-LINE-SHPD-UNITS                                21560000
215700          FROM SUT_OTBND_UPC                                      21570000
215800         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID-3             21580000
215900           AND TRN_NBR          =  :DK-PO-NBR                     21590015
216000           AND RCVR_SEQ_NBR     =  :DK-PO-RCVR                    21600015
216100     END-EXEC                                                     21610000
216200                                                                  21620000
216300     EVALUATE TRUE                                                21630000
216400         WHEN SQLCODE = +0                                        21640000
216500             MOVE PV-LINE-SHPD-UNITS TO  PT-NBR-UNITS(PT-PO-IDX)  21650000
216600         WHEN SQLCODE = -305                                      21660000
216700              PERFORM 4910-DETERMIN-UNTS                          21670000
216800         WHEN SQLCODE NOT EQUAL +0                                21680000
216900             MOVE ZEROES             TO  PT-NBR-UNITS(PT-PO-IDX)  21690000
217000                                         SQLCODE                  21700000
217100     END-EVALUATE.                                                21710000
217200                                                                  21720000
217300*-----------------------------------------------------------------21730000
217400 4910-DETERMIN-UNTS.                                              21740000
217500*-----------------------------------------------------------------21750000
217600                                                                  21760000
217700     MOVE  PC038-NEXT-SHIPT-UNT-ID  TO  DK-SHIPT-UNT-ID-2         21770000
217800     EXEC SQL                                                     21780000
217900         SELECT SUM(SHPD_UNT_QTY)                                 21790000
218000          INTO :PV-LINE-SHPD-UNITS                                21800000
218100          FROM SUT_OTBND_UPC                                      21810000
218200         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID-2             21820000
218300     END-EXEC                                                     21830000
218400                                                                  21840000
218500     EVALUATE TRUE                                                21850000
218600         WHEN SQLCODE = +0                                        21860000
218700             MOVE PV-LINE-SHPD-UNITS TO  PT-NBR-UNITS(PT-PO-IDX)  21870000
218800         WHEN SQLCODE NOT EQUAL +0                                21880000
218900             MOVE ZEROES             TO  PT-NBR-UNITS(PT-PO-IDX)  21890000
219000                                         SQLCODE                  21900000
219100     END-EVALUATE.                                                21910000
219200                                                                  21920000
219300*-----------------------------------------------------------------21930000
219400 4950-DETERMIN-ADJS.                                              21940000
219500*-----------------------------------------------------------------21950000
219600                                                                  21960000
219700     EXEC SQL                                                     21970000
219800         SELECT UPC_NBR                                           21980000
219900          INTO :SUQADJ-UPC-NBR                                    21990000
220000          FROM TSUQADJ                                            22000000
220100         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID               22010000
220200     END-EXEC                                                     22020000
220300                                                                  22030000
220400     EVALUATE TRUE                                                22040000
220500         WHEN SQLCODE = +0                                        22050000
220600         WHEN SQLCODE = -811                                      22060000
220700             SET PS-ADJ-YES                                       22070000
220800                 PC038-ADJ  TO  TRUE                              22080000
220900         WHEN SQLCODE NOT EQUAL +0                                22090000
221000             SET PS-ADJ-NO   TO  TRUE                             22100000
221100     END-EVALUATE.                                                22110000
221200                                                                  22120000
221300*-----------------------------------------------------------------22130000
221400 5000-COUNT-CHILDREN-OF-MASTER.                                   22140000
221500*-----------------------------------------------------------------22150000
221600                                                                  22160000
221700     EXEC SQL                                                     22170000
221800         SELECT COUNT(*)                                          22180000
221900         INTO   :PV-CHILDRN-IN-MASTER                             22190000
222000         FROM   SUT_OTBND_CART A                                  22200000
222100               ,SUT_OTBND_CART B                                  22210000
222200         WHERE  A.PRNT_CART_ID = :DK-SHIPT-UNT-ID                 22220000
222300           AND  B.PRNT_CART_ID = A.SHIPT_UNT_ID                   22230000
222400           AND  B.MSTR_CART_IND = 'N'                             22240000
222500     END-EXEC.                                                    22250000
222600                                                                  22260000
222700     EVALUATE TRUE                                                22270000
222800         WHEN SQLCODE = +0                                        22280000
222900             MOVE PV-CHILDRN-IN-MASTER TO PC038-CHLDRN-IN-MSTR    22290000
223000         WHEN SQLCODE NOT EQUAL +0                                22300000
223100             CONTINUE                                             22310000
223200     END-EVALUATE.                                                22320000
223300                                                                  22330000
223400*-----------------------------------------------------------------22340000
223500 5050-COUNT-CHILDREN-OF-MASTER.                                   22350000
223600*-----------------------------------------------------------------22360000
223700                                                                  22370000
223800     EXEC SQL                                                     22380000
223900         SELECT COUNT(*)                                          22390000
224000         INTO   :PV-CHILDRN-IN-MASTER                             22400000
224100         FROM   SUT_OTBND_CART                                    22410000
224200         WHERE  PRNT_CART_ID = :DK-SHIPT-UNT-ID                   22420000
224300           AND  MSTR_CART_IND = 'N'                               22430000
224400     END-EXEC.                                                    22440000
224500                                                                  22450000
224600     EVALUATE TRUE                                                22460000
224700         WHEN SQLCODE = +0                                        22470000
224800             MOVE PV-CHILDRN-IN-MASTER TO PC038-CHLDRN-IN-MSTR    22480000
224900         WHEN SQLCODE NOT EQUAL +0                                22490000
225000             CONTINUE                                             22500000
225100     END-EVALUATE.                                                22510000
225200                                                                  22520000
225300*--------------------------------------------------------------   22530000
225400 5100-COUNT-UNIT-OF-CHILDREN.                                     22540000
225500*--------------------------------------------------------------   22550000
225600                                                                  22560000
225700     PERFORM 5200-OPEN-OTBND-CART-CURSOR.                         22570000
225800     PERFORM 5300-FETCH-OTBND-CART-CURSOR.                        22580000
225900     PERFORM 5400-CLOSE-OTBND-CART-CURSOR.                        22590000
226000                                                                  22600000
226100*--------------------------------------------------------------   22610000
226200 5200-OPEN-OTBND-CART-CURSOR.                                     22620000
226300                                                                  22630000
226400     EXEC SQL                                                     22640000
226500         OPEN OTBND-CART-CSR                                      22650000
226600     END-EXEC                                                     22660000
226700                                                                  22670000
226800     EVALUATE TRUE                                                22680000
226900          WHEN SQLCODE = +0                                       22690000
227000                 CONTINUE                                         22700000
227100          WHEN SQLCODE NOT EQUAL +0                               22710000
227200               MOVE '5200-OPEN-OTBND-CART-CURSOR'                 22720000
227300                                               TO DP013-PARAGRAPH 22730000
227400               MOVE 'ERROR OPENING THE CURSOR'                    22740000
227500                                        TO DP013-MESSAGE-TEXT (1) 22750000
227600               MOVE SQLCA        TO DP013-SQLCA                   22760000
227700               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      22770000
227800               SET DP013-DB2-ABEND                                22780000
227900                   DP013-ROLLBACK   TO TRUE                       22790000
228000               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             22800000
228100     END-EVALUATE.                                                22810000
228200                                                                  22820000
228300*---------------------------------------------------------------  22830000
228400 5300-FETCH-OTBND-CART-CURSOR.                                    22840000
228500                                                                  22850000
228600     PERFORM VARYING PT-PO-IDX                                    22860000
228700         FROM 1 BY 1                                              22870000
228800         UNTIL  SQLCODE = +100                                    22880000
228900                                                                  22890000
229000         EXEC SQL                                                 22900000
229100             FETCH OTBND-CART-CSR                                 22910000
229200             INTO :SUT00024-SHIPT-UNT-ID                          22920000
229300         END-EXEC                                                 22930000
229400                                                                  22940000
229500         EVALUATE TRUE                                            22950000
229600             WHEN SQLCODE = +0                                    22960000
229700                 ADD +1 TO PT-TABLE-ENTRIES                       22970000
229800                 MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID-3  22980000
229900                 PERFORM 4900-DETERMIN-UNTS                       22990000
230000             WHEN SQLCODE NOT EQUAL +0                            23000000
230100                 CONTINUE                                         23010000
230200         END-EVALUATE                                             23020000
230300     END-PERFORM.                                                 23030000
230400                                                                  23040000
230500*--------------------------------------------------------------   23050000
230600 5400-CLOSE-OTBND-CART-CURSOR.                                    23060000
230700                                                                  23070000
230800     EXEC SQL                                                     23080000
230900         CLOSE OTBND-CART-CSR                                     23090000
231000     END-EXEC.                                                    23100000
231100                                                                  23110000
231200     EVALUATE TRUE                                                23120000
231300          WHEN SQLCODE = +0                                       23130000
231400                 CONTINUE                                         23140000
231500          WHEN SQLCODE NOT EQUAL +0                               23150000
231600               MOVE '5400-CLOS-OTBND-CART-CURSOR'                 23160000
231700                                               TO DP013-PARAGRAPH 23170000
231800               MOVE 'ERROR CLOSING THE CURSOR'                    23180000
231900                                        TO DP013-MESSAGE-TEXT (1) 23190000
232000               MOVE SQLCA        TO DP013-SQLCA                   23200000
232100               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      23210000
232200               SET DP013-DB2-ABEND                                23220000
232300                   DP013-ROLLBACK   TO TRUE                       23230000
232400               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             23240000
232500     END-EVALUATE.                                                23250000
232600                                                                  23260000
232700*--------------------------------------------------------------   23270000
232800 5500-COUNT-UNIT-OF-CHILDREN.                                     23280000
232900                                                                  23290000
233000*--------------------------------------------------------------   23300000
233100     PERFORM 5600-OPEN-OTBND-CART-CURSOR.                         23310000
233200     PERFORM 5700-FETCH-OTBND-CART-CURSOR.                        23320000
233300     PERFORM 5800-CLOSE-OTBND-CART-CURSOR.                        23330000
233400                                                                  23340000
233500*--------------------------------------------------------------   23350000
233600 5600-OPEN-OTBND-CART-CURSOR.                                     23360000
233700                                                                  23370000
233800     EXEC SQL                                                     23380000
233900         OPEN OTBND-CART-CSR2                                     23390000
234000     END-EXEC                                                     23400000
234100                                                                  23410000
234200     EVALUATE TRUE                                                23420000
234300          WHEN SQLCODE = +0                                       23430000
234400                 CONTINUE                                         23440000
234500          WHEN SQLCODE NOT EQUAL +0                               23450000
234600               MOVE '5600-OPEN-OTBND-CART-CURSOR'                 23460000
234700                                               TO DP013-PARAGRAPH 23470000
234800               MOVE 'ERROR OPENING THE CURSOR'                    23480000
234900                                        TO DP013-MESSAGE-TEXT (1) 23490000
235000               MOVE SQLCA        TO DP013-SQLCA                   23500000
235100               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      23510000
235200               SET DP013-DB2-ABEND                                23520000
235300                   DP013-ROLLBACK   TO TRUE                       23530000
235400               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             23540000
235500     END-EVALUATE.                                                23550000
235600                                                                  23560000
235700*---------------------------------------------------------------  23570000
235800 5700-FETCH-OTBND-CART-CURSOR.                                    23580000
235900                                                                  23590000
236000     PERFORM VARYING PT-PO-IDX                                    23600000
236100         FROM 1 BY 1                                              23610000
236200         UNTIL  SQLCODE = +100                                    23620000
236300                                                                  23630000
236400         EXEC SQL                                                 23640000
236500             FETCH OTBND-CART-CSR2                                23650000
236600             INTO :SUT00024-SHIPT-UNT-ID                          23660000
236700         END-EXEC                                                 23670000
236800                                                                  23680000
236900         EVALUATE TRUE                                            23690000
237000             WHEN SQLCODE = +0                                    23700000
237100                 ADD +1 TO PT-TABLE-ENTRIES                       23710000
237200                 MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID-3  23720000
237300                 PERFORM 4900-DETERMIN-UNTS                       23730000
237400             WHEN SQLCODE NOT EQUAL +0                            23740000
237500                 CONTINUE                                         23750000
237600         END-EVALUATE                                             23760000
237700     END-PERFORM.                                                 23770000
237800                                                                  23780000
237900*--------------------------------------------------------------   23790000
238000 5800-CLOSE-OTBND-CART-CURSOR.                                    23800000
238100                                                                  23810000
238200     EXEC SQL                                                     23820000
238300         CLOSE OTBND-CART-CSR2                                    23830000
238400     END-EXEC.                                                    23840000
238500                                                                  23850000
238600     EVALUATE TRUE                                                23860000
238700          WHEN SQLCODE = +0                                       23870000
238800                 CONTINUE                                         23880000
238900          WHEN SQLCODE NOT EQUAL +0                               23890000
239000               MOVE '5800-CLOS-OTBND-CART-CURSOR'                 23900000
239100                                               TO DP013-PARAGRAPH 23910000
239200               MOVE 'ERROR CLOSING THE CURSOR'                    23920000
239300                                        TO DP013-MESSAGE-TEXT (1) 23930000
239400               MOVE SQLCA        TO DP013-SQLCA                   23940000
239500               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      23950000
239600               SET DP013-DB2-ABEND                                23960000
239700                   DP013-ROLLBACK   TO TRUE                       23970000
239800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             23980000
239900     END-EVALUATE.                                                23990000
240000                                                                  24000000
240100*-----------------------------------------------------------------24010000
240200 5900-SELECT-VENDOR-BARCODE.                                      24020000
240300*-----------------------------------------------------------------24030000
240400*   THIS PARA WILL REPLACE THE DK-SHIPT-UNT-ID WITH THE           24040000
240500*   SUT024-SHIPT-UNT-ID FIELD WHEN THE DK-SHIPT-UNT-ID CONTAINS   24050000
240600*   A VENDOR BAR CODE                                             24060000
240700                                                                  24070000
240800     EXEC SQL                                                     24080000
240900         SELECT SHIPT_UNT_ID                                      24090000
241000         INTO   :SUT00024-SHIPT-UNT-ID                            24100000
241100         FROM   SUT_OTBND_CART                                    24110000
241200         WHERE  ORIG_CART_ID = :DK-SHIPT-UNT-ID                   24120000
241300           AND  ACTV_IND     = 'Y'                                24130000
241400     END-EXEC.                                                    24140000
241500                                                                  24150000
241600     EVALUATE TRUE                                                24160000
241700         WHEN SQLCODE = +0                                        24170000
241800             MOVE SUT00024-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID       24180000
241900         WHEN SQLCODE = +100                                      24190000
242000             CONTINUE                                             24200000
242100         WHEN SQLCODE NOT EQUAL +0                                24210000
242200               MOVE '5900-SELECT-VENDOR-BARCODE'                  24220000
242300                                               TO DP013-PARAGRAPH 24230000
242400               MOVE 'ERROR SELECTING SUT_OTBND_CART'              24240000
242500                                        TO DP013-MESSAGE-TEXT (1) 24250000
242600               MOVE SQLCA        TO DP013-SQLCA                   24260000
242700               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      24270000
242800               SET DP013-DB2-ABEND                                24280000
242900                   DP013-ROLLBACK   TO TRUE                       24290000
243000               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             24300000
243100     END-EVALUATE.                                                24310000
243200                                                                  24320000
243300*-----------------------------------------------------------------24330000
243400* CHECK FOR PRINTER ID.                                           24340000
243500*-----------------------------------------------------------------24350000
243600 7000-CHECK-4-PRINTER-ID.                                         24360000
243700                                                                  24370000
243800     IF  APRINTIDL > ZERO                                         24380000
243900         MOVE APRINTIDI       TO PC038-PRINTER-ID                 24390000
244000         SET PS-PRINTER-FOUND TO TRUE                             24400000
244100     ELSE                                                         24410000
244200         IF APRINTIDA = DP015-ERASE-EOF                           24420000
244300             MOVE SPACES             TO PC038-PRINTER-ID          24430000
244400             SET PS-NO-PRINTER-FOUND TO TRUE                      24440000
244500         END-IF                                                   24450000
244600     END-IF.                                                      24460000
244700                                                                  24470000
244800*-----------------------------------------------------------------24480000
244900* VALIDATE PRINTER ID.                                            24490000
245000*-----------------------------------------------------------------24500000
245100 7100-VALIDATE-PRINTER.                                           24510000
245200                                                                  24520000
245300     MOVE PC-REPORT-PGM          TO  DP072-RPT-PGM-NME.           24530001
245400     MOVE PC039-CURR-OPER-UNT    TO  DP072-ORIGIN-OPER-UNT-ID     24540000
245500                                     DP072-OPER-UNT-ID.           24550000
245600     MOVE 1                      TO  DP072-ORIGIN-FCLTY-ID        24560000
245700                                     DP072-FCLTY-ID.              24570000
245800     MOVE PC038-PRINTER-ID-1-3   TO  DP072-PRINTER-ID.            24580000
245900     SET DP072-VALIDATE          TO  TRUE.                        24590000
246000     IF PC039-4-BY-4-LBL                                          24600000
246100         MOVE PC-01              TO  DP072-RPT-PGM-TYP-ID         24610001
246200     ELSE                                                         24620000
246300         MOVE PC-02              TO  DP072-RPT-PGM-TYP-ID         24630001
246400     END-IF.                                                      24640000
246500                                                                  24650000
246600     EXEC CICS                                                    24660000
246700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  24670000
246800               COMMAREA (DP072-COMM-AREA)                         24680000
246900               RESP     (PV-CICS-RESPONSE)                        24690000
247000     END-EXEC                                                     24700000
247100                                                                  24710000
247200     EVALUATE TRUE                                                24720000
247300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 24730000
247400              IF PC039-4-BY-4-LBL                                 24740000
247500                  PERFORM 7200-VALIDATE-PRINTER-SML               24750000
247600              ELSE                                                24760000
247700                  IF PC039-PGYBK-LBL                              24770000
247800                      PERFORM 7300-VALIDATE-PIGGY-BACK            24780000
247900                  ELSE                                            24790000
248000                      SET PS-PRINTER-INVALID    TO  TRUE          24800000
248100                  END-IF                                          24810000
248200              END-IF                                              24820000
248300         WHEN OTHER                                               24830000
248400             SET PS-PRINTER-INVALID                               24840000
248500                 PS-ERROR-YES          TO  TRUE                   24850000
248600     END-EVALUATE.                                                24860000
248700                                                                  24870000
248800*-----------------------------------------------------------------24880000
248900* CHECK PRINTER ID TO MAKE SURE THAT IT CAN PRINT SML LABELS      24890000
249000*-----------------------------------------------------------------24900000
249100 7200-VALIDATE-PRINTER-SML.                                       24910000
249200                                                                  24920000
249300     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               24930000
249400         SET  PS-PRINTER-INVALID   TO TRUE                        24940000
249500     END-IF.                                                      24950000
249600                                                                  24960000
249700     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  24970000
249800         SET  PS-PRINTER-VALID        TO TRUE                     24980000
249900         MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS           24990000
250000     ELSE                                                         25000000
250100         SET  PS-PRINTER-INVALID                                  25010000
250200              PS-ERROR-YES         TO  TRUE                       25020000
250300     END-IF.                                                      25030000
250400                                                                  25040000
250500*-----------------------------------------------------------------25050000
250600* CHECK PRINTER ID TO MAKE SURE THAT IT CAN PRINT PIGGYBACK LABEL 25060000
250700*-----------------------------------------------------------------25070000
250800 7300-VALIDATE-PIGGY-BACK.                                        25080000
250900                                                                  25090000
251000     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  25100000
251100         SET  PS-PRINTER-VALID        TO TRUE                     25110000
251200         MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS           25120000
251300     ELSE                                                         25130000
251400         SET  PS-PRINTER-INVALID                                  25140000
251500              PS-ERROR-YES         TO  TRUE                       25150000
251600     END-IF.                                                      25160000
251700                                                                  25170000
251800*---------------------------------------------------------------- 25180000
251900 7400-FILL-PC140.                                                 25190000
252000*---------------------------------------------------------------- 25200000
252100                                                                  25210000
252200     INITIALIZE PC140-RF-CRTN-STAT-APPL-LBL.                      25220000
252300     INITIALIZE XL071-COMMAREA-REC.                               25230039
252400     SET PC140-RF-CRTN-STAT-APPL   TO TRUE.                       25240034
252500     MOVE DP072-PRTR-OPER-UNT-ID   TO XL071-LOCATION-NUMBER.      25250034
252600     PERFORM 7500-GET-LOCATION-INFO.                              25260034
252700     MOVE XL071-LOC-10-ABBR-NM     TO  PC039-STR-NAME.            25270041
252800                                                                  25280000
252900     MOVE PC039-LBL-FORMAT         TO PC140-RF-LBL-FORMAT.        25290000
253000     IF PC140-RF-CHECKIN-SML  OR                                  25300005
253100        PC140-RF-DEST-LBL                                         25310004
253200        PERFORM 7550-CHECK-AUDIT-STAT                             25320000
253300        IF  PC140-RF-AUDIT-STATUS > SPACE                         25330066
253400            CONTINUE                                              25340066
253500        ELSE                                                      25350066
253600                                                                  25360069
253700            PERFORM 7555-CHECK-RFID-AUDIT-STAT                    25370065
253800        END-IF                                                    25380065
253900     END-IF.                                                      25390034
254000                                                                  25400000
254100     MOVE PC039-LBL-TYPE           TO PC140-RF-LBL-TYPE.          25410000
254200     MOVE PC039-PACK-TYPE          TO PC140-RF-PACK-TYPE.         25420000
254300     MOVE PC039-CASE-TYPE          TO PC140-RF-CASE-TYPE.         25430000
254400     MOVE PC038-PRINTER-ID-1-3     TO PC140-RF-PRTR-ID.           25440000
254500     MOVE PC039-CRA-REQ-ID         TO PC140-RF-USERID.            25450000
254600     MOVE PC039-STR-NBR            TO PC140-RF-STR-NBR.           25460000
254700     MOVE PC039-STR-NAME           TO PC140-RF-STR-NAME.          25470041
254800     MOVE PC039-PO-NBR             TO PC140-RF-PO-NBR.            25480000
254900     MOVE PC039-PO-RCVR            TO PC140-RF-PO-RCVR.           25490000
255000     MOVE PC039-LNE-NBR            TO PC140-RF-LNE-NBR.           25500000
255100     MOVE PC039-PREPK-ID           TO PC140-RF-PREPK-ID.          25510000
255200     MOVE PC039-DEPT               TO PC140-RF-DEPT.              25520000
255300     MOVE PC039-CLASS              TO PC140-RF-CLASS.             25530000
255400     MOVE PC039-SKU                TO PC140-RF-SKU.               25540000
255500     MOVE PC039-STYLE              TO PC140-RF-STYLE.             25550000
255600     MOVE PC039-OTPK-UNITS         TO PC140-RF-OTPK-UNITS.        25560000
255700     MOVE PC039-INPK-UNITS         TO PC140-RF-INPK-UNITS.        25570000
255800     MOVE PC039-DEPT-NAME          TO PC140-RF-DEPT-NAME.         25580000
255900     MOVE PC039-MAJOR-CLASS        TO PC140-RF-MAJOR-CLASS.       25590000
256000     MOVE PC039-SEASONAL-SET       TO PC140-RF-SEASONAL-SET.      25600000
256100     MOVE PC039-FIXTURE            TO PC140-RF-FIXTURE.           25610000
256200     MOVE PC039-ZONE               TO PC140-RF-ZONE.              25620000
256600     MOVE PC039-TRIP-ARRIVE-DATE   TO PC140-TRIP-ARRIVE-DATE.     25660059
257000                                                                  25700000
257100     IF PC039-GENERIC-SML                                         25710000
257200        MOVE PC039-RF-ZNE-LINE-1      TO PC140-RF-ZNE-LINE-1      25720000
257300        MOVE PC039-RF-ZNE-LINE-2      TO PC140-RF-ZNE-LINE-2      25730000
257400        MOVE PC039-RF-ZNE-LINE-3      TO PC140-RF-ZNE-LINE-3      25740000
257500     END-IF                                                       25750000
257600                                                                  25760000
257700     MOVE PC039-PREPK-UNT-QTY      TO PC140-RF-UNTS-IN-PCK.       25770000
257800     MOVE PC039-PACKS-IN-CRTN      TO PC140-RF-PACKS-IN-CRTN.     25780000
257900     MOVE PC039-PREPK-RATIO        TO PC140-RF-PREPK-RATIO.       25790000
258000     MOVE PC039-KOHLS-BARCODE      TO PC140-RF-KOHLS-BARCODE.     25800000
258100                                                                  25810003
258300     IF  PC038-ORIG-SHIPT-UNT-ID  >  0                            25830003
258400         MOVE PC038-ORIG-SHIPT-UNT-ID  TO PV-LAST5-SHIPT-UNT-ID   25840003
258500     ELSE                                                         25850003
258600         MOVE PC039-SHIPT-UNT-ID       TO PV-LAST5-SHIPT-UNT-ID   25860003
258700     END-IF.                                                      25870003
258900                                                                  25890003
259000     MOVE PV-LAST5-VNDR-BC         TO PC140-RF-VNDR-BC-LAST-5.    25900000
259100     MOVE PV-IP-ADDRESS            TO PC140-RF-IP-ADDRESS.        25910000
259300     MOVE PC039-RFID-IND           TO PC140-RFID-IND.             25930069
259500     MOVE PC039-LABEL-PRINT-IND    TO PC140-LABEL-PRINT-IND.      25950069
259600     PERFORM 7600-LINK-TO-PCKCS707.                               25960000
259700                                                                  25970000
259800*---------------------------------------------------------------- 25980000
259900 7500-GET-LOCATION-INFO.                                          25990034
260000*---------------------------------------------------------------- 26000000
260100                                                                  26010000
260200* THE XLT_LOC TABLE WAS REMOVED BUT REPLACED WITH THE LOCATION    26020046
260300* HIERARCY DOMAIN TABLE XL00010        DMB 2/2004                 26030038
260400                                                                  26040031
260500     CALL PC-LOCATION-MODULE  USING                               26050031
260600                                    DFHEIBLK                      26060031
260700                                    XL071-COMMAREA                26070031
260800                                    XL071-COMMAREA-REC.           26080031
260900                                                                  26090031
261000     EVALUATE TRUE                                                26100000
261100         WHEN XL071-NO-ERRORS                                     26110031
261200              MOVE XL071-LOC-5-ABBR-NM  TO  PV-DC-5-CHAR-ABBR     26120032
261300              MOVE PV-2-DIGIT-DC-ABBR   TO  PC140-CRA-DC-ID       26130032
261500              MOVE DP072-PRTR-OPER-UNT-ID                         26150066
261600                                        TO  PC140-CRA-OPER-UNT-ID 26160066
261700         WHEN XL071-LOC-NOT-FOUND                                 26170031
261800         WHEN XL071-DC-ASGMT-NOT-FND                              26180036
261900              MOVE  PC-90   TO  PC140-CRA-DC-ID                   26190000
262000                                PC140-CRA-OPER-UNT-ID             26200000
262100         WHEN XL071-BAD-DB2-RETURN                                26210031
262200             MOVE '6100-GET-DC-LOCATION' TO DP013-PARAGRAPH       26220000
262300             MOVE XL071-SQLCA TO SQLCA                            26230043
262400             MOVE SQLCA      TO DP013-SQLCA                       26240000
262500             MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME(1)           26250038
262600             SET DP013-DB2-ABEND                                  26260000
262700                 DP013-ROLLBACK                                   26270000
262800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26280000
262900             PERFORM DP014-0000-PROCESS-ABEND                     26290000
263000     END-EVALUATE.                                                26300000
263100                                                                  26310000
263200*---------------------------------------------------------------- 26320000
263300 7550-CHECK-AUDIT-STAT.                                           26330000
263400*---------------------------------------------------------------- 26340000
263500                                                                  26350000
263600     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            26360000
263700     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      26370000
263800     MOVE PC039-LNE-NBR            TO SUT00015-PO-LNE-NBR.        26380000
263900     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       26390000
264000                                                                  26400000
264100     IF  PC039-PREPK-ID  >  0                                     26410006
264200         MOVE  ZEROES  TO  SUT00015-PO-LNE-NBR                    26420006
264300     END-IF.                                                      26430006
264400                                                                  26440006
264500     EXEC SQL                                                     26450000
264600          SELECT AUD_STAT_CDE                                     26460000
264700          INTO  :SUT00015-AUD-STAT-CDE                            26470000
264800          FROM   SUT_PO_AUD_REQ                                   26480000
264900          WHERE  PO_NBR       = :SUT00015-PO-NBR                  26490000
265000          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            26500000
265100          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              26510000
265200          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             26520000
265300     END-EXEC.                                                    26530000
265400                                                                  26540000
265500     EVALUATE TRUE                                                26550000
265600         WHEN SQLCODE = ZERO                                      26560000
265700            MOVE SUT00015-AUD-STAT-CDE                            26570000
265800                                  TO  PC140-RF-AUDIT-STATUS       26580000
265900         WHEN SQLCODE = +100                                      26590000
266000              IF  SUT00015-PO-LNE-NBR  =  ZEROES                  26600009
266100                  MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS         26610009
266200              ELSE                                                26620009
266300                  PERFORM 7560-CHECK-AUDIT-STAT-OLINE             26630009
266400              END-IF                                              26640009
266500         WHEN SQLWARN0 NOT = SPACES                               26650000
266600         WHEN SQLCODE NOT EQUAL ZERO                              26660000
266700             MOVE '7550-CHECK-AUDIT-STAT' TO DP013-PARAGRAPH      26670000
266800             MOVE SQLCA      TO DP013-SQLCA                       26680000
266900             MOVE 'SUT_PO_AUD_REQ' TO DP013-DB2-TABLE-NAME(1)     26690000
267000             SET DP013-DB2-ABEND                                  26700000
267100                 DP013-ROLLBACK                                   26710000
267200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26720000
267300             PERFORM DP014-0000-PROCESS-ABEND                     26730000
267400     END-EVALUATE.                                                26740000
267500                                                                  26750000
267600*---------------------------------------------------------------- 26760062
267700 7555-CHECK-RFID-AUDIT-STAT.                                      26770063
267800*---------------------------------------------------------------- 26780062
267900                                                                  26790062
268000     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            26800062
268100     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      26810062
268200     MOVE 0                        TO SUT00015-PO-LNE-NBR.        26820062
268300     MOVE -9999                    TO SUT00015-PO-PREPK-ID.       26830062
268400                                                                  26840062
268500                                                                  26850062
268600     EXEC SQL                                                     26860062
268700          SELECT AUD_STAT_CDE                                     26870062
268800          INTO  :SUT00015-AUD-STAT-CDE                            26880062
268900          FROM   SUT_PO_AUD_REQ                                   26890062
269000          WHERE  PO_NBR       = :SUT00015-PO-NBR                  26900062
269100          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            26910062
269200          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              26920062
269300          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             26930062
269400     END-EXEC.                                                    26940062
269500                                                                  26950062
269600     EVALUATE TRUE                                                26960062
269700         WHEN SQLCODE = ZERO                                      26970062
269800            MOVE SUT00015-AUD-STAT-CDE                            26980062
269900                          TO  PC140-RF-AUDIT-STATUS               26990062
270000         WHEN SQLCODE = +100                                      27000062
270100            MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS               27010062
270200         WHEN SQLWARN0 NOT = SPACES                               27020062
270300         WHEN SQLCODE NOT EQUAL ZERO                              27030062
270400             MOVE '7755-CHECK-RFID-AUDIT-STAT' TO DP013-PARAGRAPH 27040062
270500             MOVE SQLCA      TO DP013-SQLCA                       27050062
270600             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    27060062
270700             SET DP013-DB2-ABEND                                  27070062
270800                 DP013-ROLLBACK                                   27080062
270900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27090062
271000             PERFORM DP014-0000-PROCESS-ABEND                     27100062
271100     END-EVALUATE.                                                27110062
271200                                                                  27120062
271300*---------------------------------------------------------------- 27130009
271400* CHECK AUDIT STATUS FOR 0 LINE FOR PACK-BY-STORE               - 27140009
271500*---------------------------------------------------------------- 27150009
271600 7560-CHECK-AUDIT-STAT-OLINE.                                     27160009
271700*---------------------------------------------------------------- 27170009
271800                                                                  27180009
271900     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            27190009
272000     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      27200009
272100     MOVE ZEROES                   TO SUT00015-PO-LNE-NBR.        27210009
272200     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       27220009
272300                                                                  27230009
272400     EXEC SQL                                                     27240009
272500          SELECT AUD_STAT_CDE                                     27250009
272600          INTO  :SUT00015-AUD-STAT-CDE                            27260009
272700          FROM   SUT_PO_AUD_REQ                                   27270009
272800          WHERE  PO_NBR       = :SUT00015-PO-NBR                  27280009
272900          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            27290009
273000          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              27300009
273100          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             27310009
273200     END-EXEC.                                                    27320009
273300                                                                  27330009
273400     EVALUATE TRUE                                                27340009
273500         WHEN SQLCODE = ZERO                                      27350009
273600              MOVE SUT00015-AUD-STAT-CDE                          27360009
273700                                  TO  PC140-RF-AUDIT-STATUS       27370009
273800              MOVE  ZEROES  TO  PC039-LNE-NBR                     27380009
273900         WHEN SQLCODE = +100                                      27390009
274000              MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS             27400009
274100         WHEN SQLCODE = -811                                      27410058
274200              PERFORM 7570-CHECK-AUDIT-STAT-ORG-OPER              27420058
274300         WHEN SQLWARN0 NOT = SPACES                               27430009
274400         WHEN SQLCODE NOT EQUAL ZERO                              27440009
274500             MOVE '7560-CHECK-AUDIT-STAT-0LINE'                   27450009
274600                                          TO DP013-PARAGRAPH      27460009
274700             MOVE SQLCA      TO DP013-SQLCA                       27470009
274800             MOVE 'SUT_PO_AUD_REQ' TO DP013-DB2-TABLE-NAME(1)     27480009
274900             SET DP013-DB2-ABEND                                  27490009
275000                 DP013-ROLLBACK                                   27500009
275100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27510009
275200             PERFORM DP014-0000-PROCESS-ABEND                     27520009
275300     END-EVALUATE.                                                27530009
275400                                                                  27540009
275500*--------------------------------------------------------------   27550058
275600* CHECK FOR 0 LINE FOR PACK-BY-STORE.  NEED TO SPECIFY THE    -   27560058
275700* OPER UNT ID OF THE FACILITY THAT ORIGINALLY CREATED THE     -   27570058
275800* AUDIT.                                                      -   27580058
275900*--------------------------------------------------------------   27590058
276000 7570-CHECK-AUDIT-STAT-ORG-OPER.                                  27600058
276100     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            27610058
276200     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      27620058
276300     MOVE ZEROES                   TO SUT00015-PO-LNE-NBR.        27630058
276400     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       27640058
276500     MOVE PC038-SHPUNT-ORGN-OPER   TO SUT00015-OPER-UNT-ID.       27650058
276600                                                                  27660058
276700     EXEC SQL                                                     27670058
276800          SELECT AUD_STAT_CDE                                     27680058
276900          INTO  :SUT00015-AUD-STAT-CDE                            27690058
277000          FROM   SUT_PO_AUD_REQ                                   27700058
277100          WHERE  PO_NBR       = :SUT00015-PO-NBR                  27710058
277200          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            27720058
277300          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              27730058
277400          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             27740058
277500          AND    OPER_UNT_ID  = :SUT00015-OPER-UNT-ID             27750058
277600     END-EXEC.                                                    27760058
277700                                                                  27770058
277800     EVALUATE TRUE                                                27780058
277900         WHEN SQLCODE = ZERO                                      27790058
278000              MOVE SUT00015-AUD-STAT-CDE                          27800058
278100                                  TO  PC140-RF-AUDIT-STATUS       27810058
278200              MOVE  ZEROES  TO  PC039-LNE-NBR                     27820058
278300         WHEN SQLCODE = +100                                      27830058
278400              MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS             27840058
278500         WHEN SQLWARN0 NOT = SPACES                               27850058
278600         WHEN SQLCODE NOT EQUAL ZERO                              27860058
278700             MOVE '7570-CHECK-AUDIT-STAT-ORG-OPER'                27870058
278800                                          TO DP013-PARAGRAPH      27880058
278900             MOVE SQLCA      TO DP013-SQLCA                       27890058
279000             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    27900058
279100             SET DP013-DB2-ABEND                                  27910058
279200                 DP013-ROLLBACK                                   27920058
279300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27930058
279400             PERFORM DP014-0000-PROCESS-ABEND                     27940058
279500     END-EVALUATE.                                                27950058
279600                                                                  27960058
279700*----------------------------------------------------------------*27970009
279800* LINK TO THE LABEL PRINTING PROGRAM - PCKCS707                   27980009
279900*----------------------------------------------------------------*27990009
280000 7600-LINK-TO-PCKCS707.                                           28000009
280100                                                                  28010009
280200                                                                  28020009
280300     MOVE 400  TO  PC-COMMAREA-LENGTH.                            28030009
280400                                                                  28040009
280500     EXEC CICS                                                    28050009
280600          LINK PROGRAM  ('PCKCS707')                              28060009
280700               COMMAREA (PC140-LABELMST)                          28070000
280800               LENGTH   (PC-COMMAREA-LENGTH)                      28080000
280900               RESP     (PV-CICS-RESPONSE)                        28090000
281000     END-EXEC.                                                    28100000
281100                                                                  28110000
281200     EVALUATE TRUE                                                28120000
281300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28130000
281400              CONTINUE                                            28140000
281500         WHEN OTHER                                               28150000
281600              PERFORM DP014-0000-PROCESS-ABEND                    28160000
281700     END-EVALUATE.                                                28170000
281800     IF PC140-CRA-SOCKET-COMM-ERROR                               28180000
281900         MOVE PC-SOCKET-COMM-ERROR   TO AFKMSG2O                  28190000
282000         SET PS-ERROR-YES            TO TRUE                      28200000
282100     ELSE                                                         28210000
282200         IF PC140-CRA-INVALID-PRT-FMT                             28220000
282300             MOVE PC-INVALID-PRT-FMT     TO AFKMSG2O              28230000
282400             SET PS-ERROR-YES            TO TRUE                  28240000
282500         ELSE                                                     28250000
282600             MOVE -1                     TO APRINTIDL             28260000
282700         END-IF                                                   28270000
282800     END-IF.                                                      28280000
282900                                                                  28290000
283000*---------------------------------------------------------------  28300000
283100 8000-SEND-MAP.                                                   28310000
283200*-----------------------------------------------------------------28320000
283300                                                                  28330000
283400     EXEC CICS                                                    28340000
283500         SEND MAP       ('PC882A')                                28350000
283600              MAPSET    ('PCKM882')                               28360000
283700              ERASE                                               28370000
283800              CURSOR                                              28380000
283900              RESP      (PV-CICS-RESPONSE)                        28390000
284000     END-EXEC.                                                    28400000
284100                                                                  28410000
284200     EVALUATE TRUE                                                28420000
284300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28430000
284400              CONTINUE                                            28440000
284500         WHEN OTHER                                               28450000
284600              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           28460000
284700              MOVE 'UNABLE TO SEND MAP'                           28470000
284800                                     TO DP013-MESSAGE-TEXT (1)    28480000
284900              SET DP013-CICS-ABEND   TO TRUE                      28490000
285000              SET DP013-ROLLBACK     TO TRUE                      28500000
285100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              28510000
285200     END-EVALUATE.                                                28520000
285300                                                                  28530000
285400*-----------------------------------------------------------------28540000
285500 8100-SEND-DATA-ONLY.                                             28550000
285600*-----------------------------------------------------------------28560000
285700                                                                  28570000
285800     EXEC CICS                                                    28580000
285900         SEND MAP       ('PC882A')                                28590000
286000              MAPSET    ('PCKM882')                               28600000
286100              CURSOR                                              28610000
286200              DATAONLY                                            28620000
286300              RESP      (PV-CICS-RESPONSE)                        28630000
286400     END-EXEC.                                                    28640000
286500                                                                  28650000
286600     EVALUATE TRUE                                                28660000
286700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28670000
286800              CONTINUE                                            28680000
286900         WHEN OTHER                                               28690000
287000              MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH       28700000
287100              MOVE 'UNABLE TO SEND DATA'                          28710000
287200                                     TO DP013-MESSAGE-TEXT (1)    28720000
287300              SET DP013-CICS-ABEND   TO TRUE                      28730000
287400              SET DP013-ROLLBACK     TO TRUE                      28740000
287500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              28750000
287600     END-EVALUATE.                                                28760000
287700                                                                  28770000
287800*-----------------------------------------------------------------28780000
287900 8200-RETURN-TRANID.                                              28790000
288000*-----------------------------------------------------------------28800000
288100                                                                  28810000
288200     MOVE LENGTH OF CA-COMMAREA   TO PC-COMMAREA-LENGTH           28820000
288300     EXEC CICS                                                    28830000
288400         RETURN TRANSID   (PC-DUPLICATE)                          28840000
288500                COMMAREA  (CA-COMMAREA)                           28850000
288600                LENGTH    (PC-COMMAREA-LENGTH)                    28860000
288700                RESP      (PV-CICS-RESPONSE)                      28870000
288800     END-EXEC.                                                    28880000
288900                                                                  28890000
289000     EVALUATE TRUE                                                28900000
289100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28910000
289200              CONTINUE                                            28920000
289300         WHEN OTHER                                               28930000
289400              MOVE '8200-RETURN-TRANID' TO DP013-PARAGRAPH        28940000
289500              MOVE 'UNABLE TO RETURN TO TRANID'                   28950000
289600                                     TO DP013-MESSAGE-TEXT (1)    28960000
289700              SET DP013-CICS-ABEND   TO TRUE                      28970000
289800              SET DP013-ROLLBACK     TO TRUE                      28980000
289900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              28990000
290000     END-EVALUATE.                                                29000000
290100                                                                  29010000
290200*-----------------------------------------------------------------29020000
290300 8220-XCTL-TO-HELP.                                               29030000
290400*-----------------------------------------------------------------29040000
290500                                                                  29050000
290600     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       29060000
290700                                                                  29070000
290800     EXEC CICS                                                    29080000
290900         XCTL                                                     29090000
291000             PROGRAM   (PV-TRANSFER-PROGRAM)                      29100000
291100             COMMAREA  (PC192-COMMAREA)                           29110000
291200             LENGTH    (PC-COMMAREA-LENGTH)                       29120000
291300             RESP      (PV-CICS-RESPONSE)                         29130000
291400     END-EXEC.                                                    29140000
291500                                                                  29150000
291600     EVALUATE TRUE                                                29160000
291700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29170000
291800              CONTINUE                                            29180000
291900         WHEN OTHER                                               29190000
292000             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          29200000
292100             MOVE 'PCKRF882 - UNABLE TO XCTL TO PROGRAM: '        29210000
292200                                      TO DP013-MESSAGE-TEXT (1)   29220000
292300             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   29230000
292400             SET DP013-CICS-ABEND                                 29240000
292500                 DP013-ROLLBACK       TO TRUE                     29250000
292600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29260000
292700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AFKMSG2O            29270000
292800             SET PC038-PROCESS-SCREEN TO TRUE                     29280000
292900             MOVE -1                  TO AFKMSG2L                 29290000
293000             PERFORM 8000-SEND-MAP                                29300000
293100             PERFORM 8200-RETURN-TRANID                           29310000
293200     END-EVALUATE.                                                29320000
293300                                                                  29330000
293400*-----------------------------------------------------------------29340000
293500 8300-XCTL-TO-SELECTED-PROGRAM.                                   29350000
293600*-----------------------------------------------------------------29360000
293700                                                                  29370000
293800     SET PC038-INITIALIZE-SCREEN     TO TRUE.                     29380000
293900     MOVE PC-CURRENT-PROGRAM-NAME    TO PC038-LAST-PROGRAM.       29390000
294000                                                                  29400000
294100     MOVE LENGTH OF CA-COMMAREA   TO PC-COMMAREA-LENGTH           29410000
294200     EXEC CICS                                                    29420000
294300         XCTL                                                     29430000
294400             PROGRAM   (PV-TRANSFER-PROGRAM)                      29440000
294500             COMMAREA  (CA-COMMAREA)                              29450000
294600             LENGTH    (PC-COMMAREA-LENGTH)                       29460000
294700             RESP      (PV-CICS-RESPONSE)                         29470000
294800     END-EXEC.                                                    29480000
294900                                                                  29490000
295000     EVALUATE TRUE                                                29500000
295100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29510000
295200              CONTINUE                                            29520000
295300         WHEN OTHER                                               29530000
295400              MOVE '8300-XCTL-TO-SELECTED-PROGRAM'                29540000
295500                                               TO DP013-PARAGRAPH 29550000
295600              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       29560000
295700                                        TO DP013-MESSAGE-TEXT (1) 29570000
295800              MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)  29580000
295900              SET DP013-CICS-ABEND   TO TRUE                      29590000
296000              SET DP013-ROLLBACK     TO TRUE                      29600000
296100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              29610000
296200              MOVE PC-TRANS-UNAVAILABLE-MSG TO AFKMSG2O           29620000
296300              SET PC038-PROCESS-SCREEN TO TRUE                    29630000
296400              PERFORM 8100-SEND-DATA-ONLY                         29640000
296500              PERFORM 8200-RETURN-TRANID                          29650000
296600     END-EVALUATE.                                                29660000
296700                                                                  29670000
296800*-----------------------------------------------------------------29680000
296900 8350-LINK-TO-888-PROGRAM.                                        29690000
297000*-----------------------------------------------------------------29700000
297100                                                                  29710000
297200     MOVE LENGTH OF PC039-COMMAREA-REC   TO PC-COMMAREA-LENGTH    29720000
297300                                                                  29730000
297400     EXEC CICS                                                    29740000
297500         LINK                                                     29750000
297600             PROGRAM   (PV-TRANSFER-PROGRAM)                      29760000
297700             COMMAREA  (PC039-COMMAREA-REC)                       29770000
297800             LENGTH    (PC-COMMAREA-LENGTH)                       29780000
297900             RESP      (PV-CICS-RESPONSE)                         29790000
298000     END-EXEC.                                                    29800000
298100                                                                  29810000
298200     EVALUATE TRUE                                                29820000
298300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29830000
298400              EVALUATE TRUE                                       29840000
298500                  WHEN PC039-SUCCESSFUL                           29850000
298600                       MOVE PC039-PRINTER-ID                      29860000
298700                                          TO PC038-PRINTER-ID-1-3 29870000
298800                       PERFORM 7100-VALIDATE-PRINTER              29880000
298900                       IF  PS-PRINTER-VALID                       29890000
299000                           PERFORM 7400-FILL-PC140                29900000
299100                           IF  PC140-CRA-SUCCESSFUL               29910000
299200                               MOVE PV-FKEY-MSG2      TO AFKMSG2O 29920000
299300                           END-IF                                 29930000
299400                       ELSE                                       29940000
299500                           MOVE PC-INVALID-PRTR-ID    TO AFKMSG2O 29950000
299600                           SET  PS-ERROR-YES          TO TRUE     29960000
299700                       END-IF                                     29970000
299800                                                                  29980000
299900                 WHEN PC039-ERROR                                 29990000
300000                 WHEN PC039-INVALID-SQL                           30000000
300100                      MOVE PC-CICS-888-MSG        TO AFKMSG2O     30010000
300200                      SET  PS-ERROR-YES           TO TRUE         30020000
300300              END-EVALUATE                                        30030000
300400                                                                  30040000
300500         WHEN OTHER                                               30050000
300600              MOVE '8350-LINK-TO-888-PROGRAM'  TO DP013-PARAGRAPH 30060000
300700              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       30070000
300800                                        TO DP013-MESSAGE-TEXT (1) 30080000
300900              MOVE 'PCKRF888'           TO DP013-MESSAGE-TEXT (2) 30090000
301000              SET DP013-CICS-ABEND   TO TRUE                      30100000
301100              SET DP013-ROLLBACK     TO TRUE                      30110000
301200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              30120000
301300              MOVE PC-TRANS-UNAVAILABLE-MSG TO AFKMSG2O           30130000
301400              SET PC038-PROCESS-SCREEN TO TRUE                    30140000
301500              PERFORM 8100-SEND-DATA-ONLY                         30150000
301600              PERFORM 8200-RETURN-TRANID                          30160000
301700     END-EVALUATE.                                                30170000
301800                                                                  30180000
301900*-----------------------------------------------------------------30190000
302000 8400-RECEIVE-MAP.                                                30200000
302100*-----------------------------------------------------------------30210000
302200                                                                  30220000
302300     EXEC CICS                                                    30230000
302400         RECEIVE MAP    ('PC882A')                                30240000
302500                 MAPSET ('PCKM882')                               30250000
302600                 RESP   (PV-CICS-RESPONSE)                        30260000
302700     END-EXEC.                                                    30270000
302800                                                                  30280000
302900     EVALUATE TRUE                                                30290000
303000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30300000
303100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                30310000
303200              CONTINUE                                            30320000
303300         WHEN OTHER                                               30330000
303400              MOVE '8400-RECEIVE-MAP' TO DP013-PARAGRAPH          30340000
303500              MOVE 'UNABLE TO RECEIVE MAP'                        30350000
303600                                     TO DP013-MESSAGE-TEXT (1)    30360000
303700              SET DP013-LOGIC-ABEND  TO TRUE                      30370000
303800              SET DP013-ROLLBACK     TO TRUE                      30380000
303900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              30390000
304000     END-EVALUATE.                                                30400000
304100                                                                  30410069
304200 8600-CALL-XLKUT001.                                              30420009
304300                                                                  30430009
304400     CALL XL001-VSM-PGM  USING DFHEIBLK                           30440009
304500                              XL001-COMMAREA                      30450009
304600                              XL001-ITEM-COMMAREA.                30460009
304700                                                                  30470009
304800     EVALUATE TRUE                                                30480009
304900         WHEN XL001-SUCCESSFUL                                    30490009
305000         WHEN XL001-SKU-NOT-FOUND                                 30500009
305100         WHEN XL001-UPC-NOT-FOUND                                 30510009
305200             CONTINUE                                             30520009
305300         WHEN OTHER                                               30530009
305400             MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH         30540009
305500             MOVE 'PCKRF882 - DB2 ERROR IN PROGRAM: '             30550009
305600                                      TO DP013-MESSAGE-TEXT (1)   30560009
305700             MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2)   30570009
305800             SET DP013-CICS-ABEND                                 30580009
305900                 DP013-ROLLBACK       TO TRUE                     30590009
306000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30600009
306100             MOVE PC-TRANS-UNAVAILABLE-MSG                        30610009
306200                                      TO AFKMSG2O                 30620009
306300              SET PC038-PROCESS-SCREEN TO TRUE                    30630009
306400              PERFORM 8100-SEND-DATA-ONLY                         30640009
306500              PERFORM 8200-RETURN-TRANID                          30650009
306600     END-EVALUATE.                                                30660009
306700                                                                  30670069
306800*-----------------------------------------------------------------30680000
306900 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  30690000
307000*-----------------------------------------------------------------30700000
307100                                                                  30710000
307200     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            30720000
307300     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           30730000
307400     INITIALIZE DP013-SRC-TASK-NUMBER                             30740000
307500                DP013-STACK.                                      30750000
307600     SET DP013-LINK-RETURN           TO TRUE.                     30760000
307700                                                                  30770000
307800     EXEC CICS                                                    30780000
307900         LINK                                                     30790000
308000             PROGRAM   (DP013-NAME)                               30800000
308100             COMMAREA  (DP013-PARAMETERS)                         30810000
308200             LENGTH    (DP013-LENGTH)                             30820000
308300     END-EXEC.                                                    30830000
308400                                                                  30840000
308500*----------------------------------------------------------------*30850000
308600*    ABEND PROCESSOR MODULE                                      *30860000
308700*----------------------------------------------------------------*30870000
308800     COPY DPPD014.                                                30880000
