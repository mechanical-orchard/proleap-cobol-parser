00001 ******************************************************************01/06/93
00002  IDENTIFICATION DIVISION.                                         DPKUT039
00003 ******************************************************************   LV013
00004  PROGRAM-ID.    DPKUT039.                                            CL**9
00005  AUTHOR.        CHUCK ALBERTY -- EXACTA.                             CL**7
00006  INSTALLATION.  KOHLS.                                               CL**7
00007  DATE-WRITTEN   DECEMBER, 1992.                                      CL**7
00008  DATE-COMPILED.                                                      CL**7
00009 ******************************************************************   CL*13
00010 *  THIS PROGRAM DOES THE SAME THING IN BATCH THAT DPKUT038 DOES      CL*13
00011 *  IN CICS.  WHAT THAT MEANS IS IT GETS INFORMATION FROM MBS         CL*13
00012 *  TABLES.  IT IS INTENDED TO BE USED AS A COMMON ROUTINE THAT       CL*13
00013 *  CAN BE CALLED BY OTHER BATCH PROGRAMS.                            CL*13
00014 ******************************************************************   CL*13
00015 *                                                                    CL**7
00016 *                                                                    CL**7
00017 ******************************************************************   CL**7
00018  ENVIRONMENT DIVISION.                                               CL**7
00019 ******************************************************************   CL**7
00020  CONFIGURATION SECTION.                                              CL**7
00021 *                                                                    CL**7
00022  SOURCE-COMPUTER.        IBM-3090.                                   CL**7
00023  OBJECT-COMPUTER.        IBM-3090.                                   CL**7
00024 *                                                                    CL**7
00025  INPUT-OUTPUT SECTION.                                               CL**7
00026 *                                                                    CL**7
00027  FILE-CONTROL.                                                       CL**7
00028 *                                                                    CL**7
00029 *                                                                    CL**7
00030 ******************************************************************   CL**7
00031  DATA DIVISION.                                                      CL**7
00032 ******************************************************************   CL**7
00033  FILE SECTION.                                                       CL**7
00034 *                                                                    CL**7
00035 *                                                                    CL**7
00036  WORKING-STORAGE SECTION.                                            CL**7
00037 *                                                                    CL**7
00038 ******************************************************************   CL**8
00039 ***  COMMON WORKING STORAGE SHARED BY THIS PROGRAM AND THE CICS      CL*10
00040 ***  PROGRAM 'DPKUT038' THAT IS LINKED TO AS IF IT WERE A SUB-       CL*12
00041 ***  ROUTINE.                                                        CL*10
00042 ******************************************************************   CL**8
00043      COPY DPWS007.                                                   CL*13
00044 *                                                                    CL**7
00045 *                                                                    CL**7
00046  LINKAGE SECTION.                                                    CL**7
00047 ******************************************************************   CL**8
00048 ***  THESE FIELDS ARE USED TO PASS DATA TO AND FROM THE CALLING      CL**8
00049 ***  PROGRAM AND THIS SUBROUTINE.  THIS MEMBER IS ALSO USED IN       CL**8
00050 ***  THE CICS PROGRAM 'DPKUT038'.                                    CL**9
00051 ******************************************************************   CL**8
00052      COPY DPWS003.                                                   CL*13
00053 *                                                                    CL**7
00054 *                                                                    CL**7
00055 ******************************************************************   CL**7
00056  PROCEDURE DIVISION USING DP003-MBS-SUBROUTINE-FIELDS.               CL**7
00057 ******************************************************************   CL**7
00058                                                                      CL**7
00059  0000-PROGRAM-MAINLINE.                                              CL**7
00060 ******************************************************************   CL**7
00061 *  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                      CL**7
00062 ******************************************************************   CL**7
00063      PERFORM 1000-INITIAL-PROCESS.                                   CL**7
00064 *                                                                    CL**7
00065      PERFORM 2000-MAIN-PROCESS                                       CL**7
00066        UNTIL PS-DONE-PROCESSING.                                     CL**7
00067 *                                                                    CL**7
00068      GOBACK.                                                         CL**7
00069 *                                                                    CL**7
00070 *                                                                    CL**7
00071  1000-INITIAL-PROCESS.                                               CL**7
00072 ******************************************************************   CL**7
00073 *  -- INITIALIZE FIELDS IN WORKING STORAGE THAT MUST BE BLANKED      CL**7
00074 *     OUT FOR MULTIPLE CALLS TO THIS SUBROUTINE IN ONE EXECUTION     CL**7
00075 *     OF A 'CALLING' PROGRAM.                                        CL**7
00076 *  -- SET THE RETURN CODE TO THE 'SUCCESSFUL' VALUE.                 CL**7
00077 *  -- PERFORM VALIDATION OF INPUT FIELDS.                            CL**7
00078 *  -- IF ANY ERRORS ON INPUT FIELDS, SET SWITCH SO PROGRAM STOPS     CL**7
00079 *     PROCESSING BEFORE ANY OF THE 'REAL' PROCESSING TAKES PLACE.    CL**7
00080 ******************************************************************   CL**7
00081      INITIALIZE PS-DONE-PROCESSING-SW                                CL**7
00082                 DP003-OUTPUT-FIELDS.                                 CL**7
00083 *                                                                    CL**7
00084      MOVE PRV-00                     TO DP003-RETURN-DATA.           CL**7
00085 *                                                                    CL**7
00086      PERFORM 1100-VALIDATE-INPUT-REQUEST.                            CL**7
00087 *                                                                    CL**7
00088      IF  DP003-SUCCESSFUL                                            CL**7
00089          CONTINUE                                                    CL**7
00090      ELSE                                                            CL**7
00091          SET PS-DONE-PROCESSING      TO TRUE                         CL**7
00092      END-IF.                                                         CL**7
00093 *                                                                    CL**7
00094 *                                                                    CL**7
00095      COPY DPPD010.                                                   CL*13
