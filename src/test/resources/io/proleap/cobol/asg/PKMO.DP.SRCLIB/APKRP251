000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP251.                                        00020000
000300 AUTHOR.         MICHELE RINDFLEISCH                              00030000
000400 DATE-WRITTEN.   10/28/2005.                                      00040010
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070011
000800*                                                           *     00080000
000900*    NEW STORE UNJOURNALIZED RECEIPT 60 - 300 DAYS OLD RPT  *     00090006
001000*                                                           *     00100000
001100*   PROGRAM OVERVIEW:                                       *     00110000
001200*                                                           *     00120000
001300*    THIS PROGRAM CREATES THE NEW STORE UNJOURNALIZED       *     00130006
001310*   RECEIPT 60 - 300 DAY OLD REPORT FOR ALL THE NEW STORES. *     00131007
001320*   THE INPUT REPORT DATA FILE IS PRODUCED IN APKUT107.     *     00132007
001330*   THE OTHER INPUT FILE IS THE DATE FILE CREATED IN        *     00133007
001400*   APKUT106.                                               *     00140007
001480*                                                           *     00148000
001481*   THE REPORT WILL BE IN DESCENDING VERIFICATION           *     00148108
001482*   EXCEPTION AMOUNT SEQUENCE.  A REPORT LINE WILL BE       *     00148207
001483*   CREATED FOR EACH NEW STORE PO WHICH HAS UNJOURNALIZED   *     00148308
001484*   RECEIPTS WITHIN A START AND END DATE RANGE AND WHICH    *     00148408
001485*   HAVE BEEN VERIFIED.                                     *     00148508
001487*                                                           *     00148708
001490*   INPUT:                                                  *     00149000
001500*  1) UNJRNLZD-RECEIPT-DATA-FILE             (APRD107)      *     00150000
001600*  2) UNJRNLZD-RECEIPT-DATE-FILE             (APRD108)      *     00160000
001700*                                                           *     00170000
001800*   OUTPUT:                                                 *     00180000
001900*                                                           *     00190000
002000*  3) RPT01-FILE                             (DPWS150O)     *     00200000
002100*                                                           *     00210000
002200***************************************************************** 00220000
002300*                                                               * 00230000
002400* CHANGE LOG:                                                   * 00240000
002500***************************************************************** 00250000
002600/                                                                 00260000
002700 ENVIRONMENT DIVISION.                                            00270000
002800 CONFIGURATION SECTION.                                           00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000 FILE-CONTROL.                                                    00300000
003100                                                                  00310000
003200     SELECT UNJRNLZD-RECEIPT-DATA-FILE  ASSIGN TO UT-S-INP01.     00320000
003300     SELECT UNJRNLZD-RECEIPT-DATE-FILE  ASSIGN TO UT-S-INP02.     00330000
003400     SELECT RPT01-FILE                  ASSIGN TO UT-S-RPT01.     00340000
003500                                                                  00350000
003600 DATA DIVISION.                                                   00360000
003700 FILE SECTION.                                                    00370000
003800 FD  UNJRNLZD-RECEIPT-DATA-FILE                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     DATA RECORD IS UNJRNLZD-RECEIPT-DATA-RECORD.                 00420000
004300 01  UNJRNLZD-RECEIPT-DATA-RECORD PIC X(95).                      00430000
004400                                                                  00440000
004500 FD  UNJRNLZD-RECEIPT-DATE-FILE                                   00450000
004600     RECORDING MODE IS F                                          00460000
004700     LABEL RECORDS ARE STANDARD                                   00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     DATA RECORD IS UNJRNLZD-RECEIPT-DATE-RECORD.                 00490000
005000 01  UNJRNLZD-RECEIPT-DATE-RECORD PIC X(41).                      00500000
005100                                                                  00510000
005200 FD  RPT01-FILE                                                   00520000
005300     RECORDING MODE IS F                                          00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     DATA RECORD IS RPT01-RECORD.                                 00560000
005700 01  RPT01-RECORD                PIC  X(150).                     00570000
005800                                                                  00580000
005900 EJECT                                                            00590000
006000 WORKING-STORAGE SECTION.                                         00600000
006100                                                                  00610000
006200 01  PROGRAM-WORKAREA.                                            00620000
006300     05  FILLER                  PIC  X(30)           VALUE       00630000
006400         '** BEGINING OF APKRP251 W/S **'.                        00640000
006500                                                                  00650000
006600     05  PW-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.00660000
006700     05  PW-PROGRAM-NAME         PIC  X(08)           VALUE       00670000
006800         'APKRP251'.                                              00680000
006900                                                                  00690000
007000 01  CONTROL-CARD-RECORD.                                         00700000
007100     05  CC-REPORT-TYPE          PIC  X(01).                      00710000
007200     05  CC-REPORT-TITLE         PIC  X(46).                      00720000
007300     05  FILLER                  PIC  X(33).                      00730000
007400                                                                  00740000
007500 01  PRINT-FIELDS.                                                00750000
007600     05  PR-MAX-LINES            PIC S9(05)   COMP-3  VALUE +64.  00760000
007700     05  PR-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +99.  00770000
007800     05  PR-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   00780000
007900     05  PR-DETAIL-CC            PIC S9(01)   COMP-3  VALUE +0.   00790000
008000     05  PR-CC                   PIC S9(01)   COMP-3  VALUE +0.   00800000
008100                                                                  00810000
008200     05  PR-LINE                 PIC  X(150)  VALUE SPACES.       00820000
008300                                                                  00830000
008400 01  PROGRAM-SWITCHES-SUBSCRIPTS.                                 00840000
008500     05  PS-END-OF-RECEIPT-RECS-SW                                00850000
008600                                 PIC  X(01)   VALUE 'N'.          00860000
008700         88  END-OF-RECEIPT-RECS              VALUE 'Y'.          00870000
008800                                                                  00880000
008900 01  PW-CURRENT-DATE.                                             00890000
009000     05  PW-CURRENT-YEAR         PIC  9(02).                      00900000
009100     05  PW-CURRENT-MONTH        PIC  9(02).                      00910000
009200     05  PW-CURRENT-DAY          PIC  9(02).                      00920000
009300                                                                  00930000
009400 01  PW-CURRENT-TIME.                                             00940000
009500     05  PW-CURRENT-HOUR         PIC  9(02).                      00950000
009600     05  PW-CURRENT-MINUTE       PIC  9(02).                      00960000
009700     05  FILLER                  PIC  9(02)           VALUE 00.   00970000
009800                                                                  00980000
009900 01  PR-END-DATE.                                                 00990000
010000     05  PR-END-MONTH            PIC  9(02)   VALUE ZERO.         01000000
010100     05  FILLER                  PIC  X(01)   VALUE '/'.          01010000
010200     05  PR-END-DAY              PIC  9(02)   VALUE ZERO.         01020000
010300     05  FILLER                  PIC  X(01)   VALUE '/'.          01030000
010400     05  PR-END-YEAR             PIC  9(04)   VALUE ZERO.         01040000
010500                                                                  01050000
010600 01  PR-START-DATE.                                               01060000
010700     05  PR-START-MONTH          PIC  9(02)   VALUE ZERO.         01070000
010800     05  FILLER                  PIC  X(01)   VALUE '/'.          01080000
010900     05  PR-START-DAY            PIC  9(02)   VALUE ZERO.         01090000
011000     05  FILLER                  PIC  X(01)   VALUE '/'.          01100000
011100     05  PR-START-YEAR           PIC  9(04)   VALUE ZERO.         01110000
011200                                                                  01120000
011300 01  PW-END-DATE.                                                 01130000
011400     05  PW-END-YEAR             PIC  9(04)   VALUE ZERO.         01140000
011500     05  FILLER                  PIC  X(01)   VALUE '-'.          01150000
011600     05  PW-END-MONTH            PIC  9(02)   VALUE ZERO.         01160000
011700     05  FILLER                  PIC  X(01)   VALUE '-'.          01170000
011800     05  PW-END-DAY              PIC  9(02)   VALUE ZERO.         01180000
011900                                                                  01190000
012000 01  PW-START-DATE.                                               01200000
012100     05  PW-START-YEAR           PIC  9(04)   VALUE ZERO.         01210000
012200     05  FILLER                  PIC  X(01)   VALUE '-'.          01220000
012300     05  PW-START-MONTH          PIC  9(02)   VALUE ZERO.         01230000
012400     05  FILLER                  PIC  X(01)   VALUE '-'.          01240000
012500     05  PW-START-DAY            PIC  9(02)   VALUE ZERO.         01250000
012600                                                                  01260000
012700 01  PW-TOTAL-UNJOURNALIZED     PIC S9(10)V99 VALUE ZERO          01270000
012800                                                  COMP-3.         01280000
012900 EJECT                                                            01290000
013000*  INPUT RECORD AREA                                              01300000
013100                                                                  01310000
013200     COPY APRD107.                                                01320000
013300                                                                  01330000
013400 EJECT                                                            01340000
013500*  UNJOURNALIZED RECEIPT DATE FILE                                01350000
013600     COPY APRD108.                                                01360000
013700                                                                  01370000
013800 EJECT                                                            01380000
013900*  PRINT AREA                                                     01390000
014000                                                                  01400000
014100     COPY DPWS150O.                                               01410000
014200                                                                  01420000
014300 01  HDR-LINE2.                                                   01430000
014400     05  FILLER                  PIC  X(53)   VALUE SPACES.       01440000
014500     05  HL2-TITLE               PIC  X(46)   VALUE SPACES.       01450000
014600     05  FILLER                  PIC  X(51)   VALUE SPACES.       01460000
014700                                                                  01470000
014800 01  HDR-LINE3.                                                   01480000
014900     05  FILLER                  PIC  X(59)   VALUE SPACES.       01490000
015000     05  FILLER                  PIC  X(07)   VALUE 'DATES: '.    01500000
015100     05  HL3-START-DATE          PIC  X(10)   VALUE SPACES.       01510000
015200     05  FILLER                  PIC  X(06)   VALUE ' THRU '.     01520000
015300     05  HL3-END-DATE            PIC  X(10)   VALUE SPACES.       01530000
015400     05  FILLER                  PIC  X(58)   VALUE SPACES.       01540000
015500                                                                  01550000
015600 01  HDR-LINE4.                                                   01560000
015700     05  FILLER                  PIC  X(42)    VALUE SPACES.      01570000
015800     05  FILLER                  PIC  X(02)    VALUE 'PO'.        01580000
015900     05  FILLER                  PIC  X(45)    VALUE SPACES.      01590000
016000     05  FILLER                  PIC  X(13)    VALUE              01600000
016100                                            'UNJOURNALIZED'.      01610000
016200     05  FILLER                  PIC  X(04)    VALUE SPACES.      01620000
016300     05  FILLER                  PIC  X(13)    VALUE              01630000
016400                                            'UNJOURNALIZED'.      01640000
016500     05  FILLER                  PIC  X(03)    VALUE SPACES.      01650000
016600     05  FILLER                  PIC  X(13)    VALUE              01660000
016700                                            'UNJOURNALIZED'.      01670000
016800     05  FILLER                  PIC  X(04)    VALUE SPACES.      01680000
016900     05  FILLER                  PIC  X(07)    VALUE              01690000
017000                                                  'OPEN TO'.      01700000
017100     05  FILLER                  PIC  X(04)    VALUE SPACES.      01710000
017200                                                                  01720000
017300 01  HDR-LINE5.                                                   01730000
017400     05  FILLER                  PIC  X(03)    VALUE SPACES.      01740000
017500     05  FILLER                  PIC  X(11)    VALUE              01750000
017600                                              'VENDOR NAME'.      01760000
017700     05  FILLER                  PIC  X(22)    VALUE SPACES.      01770000
017800     05  FILLER                  PIC  X(04)    VALUE 'DEPT'.      01780000
017900     05  FILLER                  PIC  X(02)    VALUE SPACES.      01790000
018000     05  FILLER                  PIC  X(06)    VALUE              01800000
018100                                                   'NUMBER'.      01810000
018200     05  FILLER                  PIC  X(05)    VALUE SPACES.      01820000
018300     05  FILLER                  PIC  X(13)    VALUE              01830000
018400                                            'VERIFIED COST'.      01840000
018500     05  FILLER                  PIC  X(04)    VALUE SPACES.      01850000
018600     05  FILLER                  PIC  X(12)    VALUE              01860000
018700                                             'INVOICE COST'.      01870000
018800     05  FILLER                  PIC  X(07)    VALUE SPACES.      01880000
018900     05  FILLER                  PIC  X(03)    VALUE 'NIR'.       01890000
019000     05  FILLER                  PIC  X(14)    VALUE SPACES.      01900000
019100     05  FILLER                  PIC  X(09)    VALUE              01910000
019200                                                'RECEIVERS'.      01920000
019300     05  FILLER                  PIC  X(07)    VALUE SPACES.      01930000
019400     05  FILLER                  PIC  X(05)    VALUE 'TOTAL'.     01940000
019500     05  FILLER                  PIC  X(12)    VALUE SPACES.      01950000
019600     05  FILLER                  PIC  X(08)    VALUE 'BUY DATE'.  01960000
019700     05  FILLER                  PIC  X(03)    VALUE SPACES.      01970000
019800                                                                  01980000
019900 01  HDR-LINE6.                                                   01990000
020000     05  FILLER                  PIC  X(03)    VALUE SPACES.      02000000
020100     05  FILLER                  PIC  X(30)    VALUE              02010000
020200                           '------------------------------'.      02020000
020300     05  FILLER                  PIC  X(03)    VALUE SPACES.      02030000
020400     05  FILLER                  PIC  X(04)    VALUE '----'.      02040000
020410     05  FILLER                  PIC  X(02)    VALUE SPACES.      02041000
020420     05  FILLER                  PIC  X(09)    VALUE              02042000
020430                                                '---------'.      02043000
020440     05  FILLER                  PIC  X(02)    VALUE SPACES.      02044000
020450     05  FILLER                  PIC  X(14)    VALUE              02045000
020460                                           '--------------'.      02046000
020470     05  FILLER                  PIC  X(03)    VALUE SPACES.      02047000
020480     05  FILLER                  PIC  X(16)    VALUE              02048000
020490                                         '----------------'.      02049000
020500     05  FILLER                  PIC  X(03)    VALUE SPACES.      02050000
020600     05  FILLER                  PIC  X(14)    VALUE              02060000
020700                                           '--------------'.      02070000
020800     05  FILLER                  PIC  X(03)    VALUE SPACES.      02080000
020900     05  FILLER                  PIC  X(13)    VALUE              02090000
021000                                            '-------------'.      02100000
021010     05  FILLER                  PIC  X(03)    VALUE SPACES.      02101000
021020     05  FILLER                  PIC  X(14)    VALUE              02102000
021030                                           '--------------'.      02103000
021040     05  FILLER                  PIC  X(03)    VALUE SPACES.      02104000
021050     05  FILLER                  PIC  X(08)    VALUE              02105000
021060                                                 '--------'.      02106000
021070     05  FILLER                  PIC  X(02)    VALUE SPACES.      02107000
021080                                                                  02108000
021090 01  DETAIL-LINE                 PIC  X(150)   VALUE SPACES.      02109000
021100                                                                  02110000
021200 01  PO-DETAIL-LINE              REDEFINES  DETAIL-LINE.          02120000
021300     05  FILLER                  PIC  X(03).                      02130000
021400     05  PDL-VENDOR-NAME         PIC  X(30).                      02140000
021500     05  FILLER                  PIC  X(04).                      02150000
021600     05  PDL-DEPARTMENT          PIC  X(03).                      02160000
021700     05  FILLER                  PIC  X(02).                      02170000
021800     05  PDL-PO-NBR              PIC  Z(09).                      02180000
021900     05  FILLER                  PIC  X(02).                      02190000
022000     05  PDL-VERIFIED-COST       PIC ZZZ,ZZZ,ZZ9.99-.             02200004
022100     05  FILLER                  PIC  X(02).                      02210000
022200     05  PDL-TOT-GROSS-COST      PIC Z,ZZZ,ZZZ,ZZ9.99-.           02220009
022300     05  FILLER                  PIC  X(02).                      02230000
022400     05  PDL-UNJRNLZD-NIR        PIC ZZZ,ZZZ,ZZ9.99-.             02240004
022500     05  FILLER                  PIC  X(02).                      02250000
022600     05  PDL-UNJRNLZD-RECEIVERS  PIC ZZ,ZZZ,ZZ9.99-.              02260004
022700     05  FILLER                  PIC  X(02).                      02270000
022800     05  PDL-TOT-INV-COST        PIC ZZZ,ZZZ,ZZ9.99-.             02280004
022900     05  FILLER                  PIC  X(04).                      02290000
023000     05  PDL-OTB-PER-NBR         PIC  X(06).                      02300000
023100     05  FILLER                  PIC  X(03).                      02310000
023200                                                                  02320000
023300 01  EOR-END-OF-REPORT.                                           02330000
023400     05  FILLER                  PIC  X(62)  VALUE SPACES.        02340000
023500     05  FILLER                  PIC  X(26)  VALUE                02350000
023600         '*****  END OF REPORT *****'.                            02360000
023700     05  FILLER                  PIC  X(62)  VALUE SPACES.        02370000
023800                                                                  02380000
023900 EJECT                                                            02390000
024000*  ABEND AREA                                                     02400000
024100                                                                  02410000
024200 01  ABEND-CODE                  PIC S9(04)  COMP  VALUE ZERO.    02420000
024300     88  AC-MISSING-DATE-REC                 VALUE +4001.         02430000
024400                                                                  02440000
024500 01  ABEND-AREAS.                                                 02450000
024600     05  AA-ABEND-LIT            PIC  X(40)  VALUE                02460000
024700             '*****       ABEND'.                                 02470000
024800     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02480000
024900             '*****   PROGRAM: '.                                 02490000
025000     05  AA-PARAGRAPH-LIT        PIC  X(40)  VALUE                02500000
025100             '***** PARAGRAPH: '.                                 02510000
025200     05  AA-ABEND-OPERATION      PIC  X(50)  VALUE SPACES.        02520000
025300     05  AA-MESSAGE-LINE.                                         02530000
025400         10  FILLER              PIC  X(06)  VALUE '*****'.       02540000
025500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02550000
025600                                                                  02560000
025700 01  FILLER                      PIC  X(25)  VALUE                02570000
025800     '** END OF APKRP251 W/S **'.                                 02580000
025900                                                                  02590000
026000 EJECT                                                            02600000
026100 PROCEDURE DIVISION.                                              02610000
026200                                                                  02620000
026300***************************************************************** 02630000
026400*  MAIN PARAGRAPH                                                 02640000
026500***************************************************************** 02650000
026600 0000-MAIN.                                                       02660000
026700                                                                  02670000
026800     MOVE '0000-MAIN'            TO   PW-CURRENT-PARAGRAPH.       02680000
026900                                                                  02690000
027000     PERFORM 1000-BEGIN-PROGRAM.                                  02700000
027100                                                                  02710000
027200     PERFORM 2000-PROCESS-INPUT                                   02720000
027300         UNTIL END-OF-RECEIPT-RECS.                               02730000
027400                                                                  02740000
027500     PERFORM 3000-END-PROGRAM.                                    02750000
027600                                                                  02760000
027700     GOBACK.                                                      02770000
027800                                                                  02780000
027900 EJECT                                                            02790000
028000***************************************************************** 02800000
028300*  CALLED FROM 0000-MAIN                                          02830000
028400***************************************************************** 02840000
028500 1000-BEGIN-PROGRAM.                                              02850000
028600                                                                  02860000
028700     MOVE '1000-BEGIN-PROGRAM'   TO   PW-CURRENT-PARAGRAPH.       02870000
028800                                                                  02880000
028900     ACCEPT CONTROL-CARD-RECORD.                                  02890000
029000     IF CC-REPORT-TYPE = 'U'                                      02900000
029100        MOVE CC-REPORT-TITLE TO HL2-TITLE                         02910000
029200     ELSE                                                         02920000
029300        MOVE 'CONTROL REPORT TYPE MUST BE -U-'                    02930000
029400            TO AA-MESSAGE-LINE                                    02940000
029500        PERFORM 9999-ABEND                                        02950000
029600     END-IF.                                                      02960000
029700                                                                  02970000
029800     OPEN INPUT  UNJRNLZD-RECEIPT-DATA-FILE                       02980000
029900          INPUT  UNJRNLZD-RECEIPT-DATE-FILE                       02990000
030000          OUTPUT RPT01-FILE.                                      03000000
030100                                                                  03010000
030200     ACCEPT PW-CURRENT-DATE      FROM DATE.                       03020000
030300     MOVE PW-CURRENT-MONTH       TO   DP150O-RUN-MONTH.           03030000
030400     MOVE PW-CURRENT-DAY         TO   DP150O-RUN-DAY.             03040000
030500     MOVE PW-CURRENT-YEAR        TO   DP150O-RUN-YEAR.            03050000
030600                                                                  03060000
030700     ACCEPT PW-CURRENT-TIME      FROM TIME.                       03070000
030800     MOVE PW-CURRENT-HOUR        TO   DP150O-RUN-HOUR.            03080000
030900     MOVE PW-CURRENT-MINUTE      TO   DP150O-RUN-MINUTE.          03090000
031000                                                                  03100000
031100     MOVE PW-PROGRAM-NAME        TO   DP150O-PROGRAM-NAME.        03110000
031200     MOVE 1                      TO   DP150O-REPORT-NUMBER.       03120000
031300                                                                  03130000
031400     PERFORM 8100-READ-RECEIPT-DATE-FILE.                         03140000
031500                                                                  03150000
031600     MOVE AP108-START-DATE       TO   PW-START-DATE.              03160000
031700     MOVE PW-START-YEAR          TO   PR-START-YEAR.              03170000
031800     MOVE PW-START-MONTH         TO   PR-START-MONTH.             03180000
031900     MOVE PW-START-DAY           TO   PR-START-DAY.               03190000
032000     MOVE PR-START-DATE          TO   HL3-START-DATE.             03200000
032100                                                                  03210000
032200     MOVE AP108-END-DATE         TO   PW-END-DATE.                03220000
032300     MOVE PW-END-YEAR            TO   PR-END-YEAR.                03230000
032400     MOVE PW-END-MONTH           TO   PR-END-MONTH.               03240000
032500     MOVE PW-END-DAY             TO   PR-END-DAY.                 03250000
032600     MOVE PR-END-DATE            TO   HL3-END-DATE.               03260000
032700                                                                  03270000
032800     MOVE SPACE                  TO   DETAIL-LINE.                03280000
032900                                                                  03290000
033000     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         03300000
033100                                                                  03310000
033200 EJECT                                                            03320000
033300***************************************************************** 03330000
033400*  MAIN PROGRAM LOOP, ENSURES WE WILL GET THE REPORT PRINTED      03340000
033500*  EVEN IF NO INPUT.                                              03350000
033600*                                                                 03360000
033700*  CALLED FROM 0000-MAIN                                          03370000
033800***************************************************************** 03380000
033900 2000-PROCESS-INPUT.                                              03390000
034000                                                                  03400000
034100                                                                  03410000
034200     MOVE '2000-PROCESS-INPUT'   TO   PW-CURRENT-PARAGRAPH.       03420000
034300                                                                  03430000
034400     COMPUTE PW-TOTAL-UNJOURNALIZED =                             03440000
034500           AP107-UNJRNLZD-NIR + AP107-UNJRNLZD-RECEIVER.          03450000
034600                                                                  03460000
034700*  PROCESS INPUT RECORD                                           03470000
034800                                                                  03480000
034900     MOVE AP107-VENDOR-NAME       TO  PDL-VENDOR-NAME.            03490000
035000     MOVE AP107-DEPT              TO  PDL-DEPARTMENT.             03500000
035100     MOVE AP107-PO-NBR            TO  PDL-PO-NBR.                 03510000
035200     MOVE AP107-VERIFIED-COST     TO  PDL-VERIFIED-COST.          03520000
035300     MOVE AP107-TOT-GROSS-COST    TO  PDL-TOT-GROSS-COST.         03530009
035400     MOVE AP107-UNJRNLZD-NIR      TO  PDL-UNJRNLZD-NIR.           03540000
035500     MOVE AP107-UNJRNLZD-RECEIVER TO  PDL-UNJRNLZD-RECEIVERS.     03550000
035600     MOVE PW-TOTAL-UNJOURNALIZED  TO  PDL-TOT-INV-COST.           03560000
035700     MOVE AP107-OTB-PER-NBR       TO  PDL-OTB-PER-NBR.            03570000
035800                                                                  03580000
035900*  WRITE REPORT & CLEAR DETAIL                                    03590000
036000                                                                  03600000
036100     PERFORM 9100-WRITE-DETAIL.                                   03610000
036200                                                                  03620000
036300     MOVE SPACE                  TO   DETAIL-LINE.                03630000
036400     MOVE 1                      TO   PR-DETAIL-CC.               03640000
036500                                                                  03650000
036600     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         03660000
036700                                                                  03670000
036800 EJECT                                                            03680000
036900***************************************************************** 03690000
037000*                                                                 03700000
037100*  CALLED FROM 0000-MAIN                                          03710000
037200***************************************************************** 03720000
037300 3000-END-PROGRAM.                                                03730000
037400                                                                  03740000
037500     MOVE '3000-END-PROGRAM'     TO   PW-CURRENT-PARAGRAPH.       03750000
037600                                                                  03760000
037700     PERFORM 9300-WRITE-END-OF-RPT.                               03770000
037800                                                                  03780000
037900     CLOSE       UNJRNLZD-RECEIPT-DATA-FILE                       03790000
038000                 UNJRNLZD-RECEIPT-DATE-FILE                       03800000
038100                 RPT01-FILE.                                      03810000
038200                                                                  03820000
038300 EJECT                                                            03830000
038400***************************************************************** 03840000
038500*  THIS ROUTINE READS THE REPORT DATA FILE FROM APKUT107          03850000
038600*                                                                 03860000
038700*  CALLED FROM 1000-BEGIN-PROGRAM                                 03870000
038800*  CALLED FROM 2000-PROCESS-INPUT                                 03880000
038900***************************************************************** 03890000
039000 8000-READ-RECEIPT-DATA-FILE.                                     03900000
039100                                                                  03910000
039200     MOVE '8000-READ-RECEIPT-DATA-FILE'                           03920000
039300                                 TO   PW-CURRENT-PARAGRAPH.       03930000
039400                                                                  03940000
039500     READ UNJRNLZD-RECEIPT-DATA-FILE INTO AP107-RECORD            03950000
039600         AT END                                                   03960000
039700             SET END-OF-RECEIPT-RECS TO TRUE.                     03970000
039800                                                                  03980000
039900 EJECT                                                            03990000
040000***************************************************************** 04000000
040100*  THIS ROUTINE READS THE REPORT DATE FILE FROM APKUT106          04010000
040200*                                                                 04020000
040300*  CALLED FROM 1000-BEGIN-PROGRAM                                 04030000
040400***************************************************************** 04040000
040500 8100-READ-RECEIPT-DATE-FILE.                                     04050000
040600                                                                  04060000
040700     MOVE '8100-READ-RECEIPT-DATE-FILE'                           04070000
040800                                 TO   PW-CURRENT-PARAGRAPH.       04080000
040900                                                                  04090000
041000     READ UNJRNLZD-RECEIPT-DATE-FILE INTO AP108-RECORD            04100000
041100         AT END                                                   04110000
041200             MOVE 'EMPTY UNJOURNALIZED RECEIPT DATES FILE'        04120000
041300                                         TO AA-MESSAGE            04130000
041400             SET AC-MISSING-DATE-REC     TO TRUE                  04140000
041500             PERFORM 9999-ABEND.                                  04150000
041600                                                                  04160000
041700 EJECT                                                            04170000
041800***************************************************************** 04180000
041900*  THIS IS THE ACTUAL WRITE TO THE REPORT FILE.  IT USES PR-CC    04190000
042000*  TO DETERMINE THE HORIZONTAL SPACING.                           04200000
042100*                                                                 04210000
042200*  CALLED FROM 9100-WRITE-DETAIL                                  04220000
042300*  CALLED FROM 9200-WRITE-HEADING                                 04230000
042400***************************************************************** 04240000
042500 9000-WRITE-REPORT.                                               04250000
042600                                                                  04260000
042700     MOVE '9000-WRITE-REPORT'    TO   PW-CURRENT-PARAGRAPH.       04270000
042800                                                                  04280000
042900     IF PR-CC = 0                                                 04290000
043000         MOVE 1                  TO   PR-CC                       04300000
043100         WRITE RPT01-RECORD FROM PR-LINE                          04310000
043200             AFTER ADVANCING PAGE                                 04320000
043300     ELSE                                                         04330000
043400         WRITE RPT01-RECORD FROM PR-LINE                          04340000
043500             AFTER ADVANCING PR-CC                                04350000
043600     END-IF.                                                      04360000
043700                                                                  04370000
043800*  BUMP LINE COUNT                                                04380000
043900                                                                  04390000
044000     ADD PR-CC                   TO   PR-LINE-COUNT.              04400000
044100                                                                  04410000
044200 EJECT                                                            04420000
044300***************************************************************** 04430000
044400*  REPORT DETAIL FOR EACH OF THE REPORTS.  THIS ROUTINE CHECKS    04440000
044500*  FOR PAGE OVERFLOW AND PERFORMS A HEADING ROUTINE IF NECESSARY  04450000
044600*                                                                 04460000
044700***************************************************************** 04470000
044800 9100-WRITE-DETAIL.                                               04480000
044900                                                                  04490000
045000     MOVE '9100-WRITE-DETAIL'    TO   PW-CURRENT-PARAGRAPH.       04500000
045100                                                                  04510000
045200*  CHECK FOR PAGE OVERFLOW.                                       04520000
045300*                                                                 04530000
045400*  WE WANT TO DISPLAY VENDOR & PO ONCE PER PAGE, AT A PO BREAK OR 04540000
045500*  AT A PAGE BREAK                                                04550000
045600                                                                  04560000
045700     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             04570000
045800         PERFORM 9200-WRITE-HEADING                               04580000
045900         MOVE 1                  TO   PR-DETAIL-CC                04590000
046000     END-IF.                                                      04600000
046100                                                                  04610000
046200*  MOVE TO PRINT AREA & WRITE REPORT LINE                         04620000
046300                                                                  04630000
046400     MOVE PR-DETAIL-CC           TO   PR-CC.                      04640000
046500     MOVE DETAIL-LINE            TO   PR-LINE.                    04650000
046600     PERFORM 9000-WRITE-REPORT.                                   04660000
046700                                                                  04670000
046800 EJECT                                                            04680000
046900***************************************************************** 04690000
047000*  REPORT AND COLUMN HEADINGS FOR EACH OF THE FOUR REPORTS        04700000
047100*                                                                 04710000
047200*  CALLED FROM 9100-WRITE-DETAIL                                  04720000
047300***************************************************************** 04730000
047400 9200-WRITE-HEADING.                                              04740000
047500                                                                  04750000
047600     MOVE '9200-WRITE-HEADING'   TO   PW-CURRENT-PARAGRAPH.       04760000
047700                                                                  04770000
047800*  BUMP PAGE COUNT                                                04780000
047900                                                                  04790000
048000     ADD 1                       TO   PR-PAGE-COUNT.              04800000
048100     MOVE PR-PAGE-COUNT          TO   DP150O-PAGE-NUMBER.         04810000
048200                                                                  04820000
048300*  CLEAR LINE COUNT                                               04830000
048400                                                                  04840000
048500     MOVE 0                      TO   PR-LINE-COUNT.              04850000
048600                                                                  04860000
048700*  HEADING LINE 1 (STANDARD)                                      04870000
048800                                                                  04880000
048900     MOVE 0                      TO   PR-CC.                      04890000
049000     MOVE DP150O-STANDRD-HEADER-150-COLS                          04900000
049100                                 TO   PR-LINE.                    04910000
049200     PERFORM 9000-WRITE-REPORT.                                   04920000
049300                                                                  04930000
049400*  HEADING LINE 2 (REPORT TITLE)                                  04940000
049500                                                                  04950000
049600     MOVE 1                      TO   PR-CC.                      04960000
049700     MOVE HDR-LINE2              TO   PR-LINE.                    04970000
049800     PERFORM 9000-WRITE-REPORT.                                   04980000
049900                                                                  04990000
050000*  HEADING LINE 3 (REPORT DATES)                                  05000000
050100                                                                  05010000
050200     MOVE 1                      TO   PR-CC.                      05020000
050300     MOVE HDR-LINE3              TO   PR-LINE.                    05030000
050400     PERFORM 9000-WRITE-REPORT.                                   05040000
050500                                                                  05050000
050600*  HEADING LINE 4 - 6 (DETAIL LINES HEADING)                      05060000
050700                                                                  05070000
050800     MOVE 2                      TO   PR-CC.                      05080000
050900     MOVE HDR-LINE4              TO   PR-LINE.                    05090000
051000     PERFORM 9000-WRITE-REPORT.                                   05100000
051100                                                                  05110000
051200     MOVE 1                      TO   PR-CC.                      05120000
051300     MOVE HDR-LINE5              TO   PR-LINE.                    05130000
051400     PERFORM 9000-WRITE-REPORT.                                   05140000
051500                                                                  05150000
051600     MOVE 1                      TO   PR-CC.                      05160000
051700     MOVE HDR-LINE6              TO   PR-LINE.                    05170000
051800     PERFORM 9000-WRITE-REPORT.                                   05180000
051900                                                                  05190000
052000 EJECT                                                            05200000
052100***************************************************************** 05210000
052200*  END OF REPORT LINES FOR THE REPORT                             05220000
052300*                                                                 05230000
052400*  CALLED FROM 3000-END-PROGRAM                                   05240000
052500***************************************************************** 05250000
052600 9300-WRITE-END-OF-RPT.                                           05260000
052700                                                                  05270000
052800     MOVE '9300-WRITE-END-OF-RPT' TO PW-CURRENT-PARAGRAPH.        05280000
052900                                                                  05290000
053000*  DO HEADING IF NOT DONE YET                                     05300000
053100                                                                  05310000
053200     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             05320000
053300         PERFORM 9200-WRITE-HEADING                               05330000
053400     END-IF.                                                      05340000
053500                                                                  05350000
053600*  END OF REPORT LITERAL                                          05360000
053700                                                                  05370000
053800     MOVE 2                      TO   PR-CC.                      05380000
053900     MOVE EOR-END-OF-REPORT      TO   PR-LINE.                    05390000
054000     PERFORM 9000-WRITE-REPORT.                                   05400000
054100                                                                  05410000
054200 EJECT                                                            05420000
054300***************************************************************** 05430000
054400*  ABEND ROUTINE                                                  05440000
054500***************************************************************** 05450000
054600 9999-ABEND.                                                      05460000
054700                                                                  05470000
054800     DISPLAY '*** PROGRAM   = ' PW-PROGRAM-NAME.                  05480000
054900     DISPLAY '*** PARAGRAPH = ' PW-CURRENT-PARAGRAPH.             05490000
055000     DISPLAY '*** MESSAGE   = ' AA-MESSAGE-LINE.                  05500000
055100                                                                  05510000
055200     CALL 'ILBOABN0'            USING ABEND-CODE.                 05520000
055300                                                                  05530000
