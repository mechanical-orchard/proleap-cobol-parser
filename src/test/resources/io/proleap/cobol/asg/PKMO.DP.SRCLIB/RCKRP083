000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.    RCKRP083.                                         00050099
000600 AUTHOR.        TKMA479.                                          00060099
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070099
000800 DATE-WRITTEN   SEPTEMBER 2012.                                   00080099
000900 DATE-COMPILED.                                                   00090099
001330******************************************************************00091099
001300* CHANGE HISTORY:                                                *00092099
001300*    CHANGES                                                     *00093099
001300*     MADE BY: PRITHIVIRAJ S (COGNIZANT)                         *00094099
001300*     DATE:    10/24/2014                                        *00095099
001300*                                                                *00096099
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00097099
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 11/26/2014     *00098099
001340******************************************************************00099099
001000                                                                  00100099
001100******************************************************************00110099
001200* PAGE BREAKS ON SEASONAL SET                                     00120099
001300******************************************************************00130099
001400                                                                  00140099
001500 ENVIRONMENT DIVISION.                                            00150099
001600 CONFIGURATION SECTION.                                           00160099
001700 SOURCE-COMPUTER.        IBM-3090.                                00170099
001800 OBJECT-COMPUTER.        IBM-3090.                                00180099
001900                                                                  00190099
002000 INPUT-OUTPUT SECTION.                                            00200099
002100 FILE-CONTROL.                                                    00210099
002200                                                                  00220099
002300     SELECT INPUT-FILE                                            00230099
002400         ASSIGN TO INP01.                                         00240099
002500                                                                  00250099
002600     SELECT REPORT-FILE                                           00260099
002700         ASSIGN TO RPT01.                                         00270099
002800                                                                  00280099
002900 DATA DIVISION.                                                   00290099
003000 FILE SECTION.                                                    00300099
003100                                                                  00310099
003200 FD  INPUT-FILE                                                   00320099
003300     RECORDING MODE IS F                                          00330099
003400     LABEL RECORDS ARE STANDARD                                   00340099
003500     RECORD CONTAINS 110                                          00350099
003600     BLOCK CONTAINS 0 RECORDS                                     00360099
003700     DATA RECORD IS INPUT-RECORD.                                 00370099
003800                                                                  00380099
003900 01  INPUT-RECORD              PIC  X(110).                       00390099
004000                                                                  00400099
004100 FD  REPORT-FILE                                                  00410099
004200     RECORDING MODE IS F                                          00420099
004300     LABEL RECORDS ARE STANDARD                                   00430099
004400*CHG98147 - START                                                 00440099
004500*    RECORD CONTAINS 200                                          00450099
004600     RECORD CONTAINS 250                                          00460099
004700     BLOCK CONTAINS 0 RECORDS                                     00470099
004800     DATA RECORD IS REPORT-RECORD.                                00480099
004900                                                                  00490099
005000*01  REPORT-RECORD             PIC  X(200).                       00500099
005100 01  REPORT-RECORD             PIC  X(250).                       00510099
005200*CHG98147 - END                                                   00520099
005300                                                                  00530099
005400******************************************************************00540099
005500 WORKING-STORAGE SECTION.                                         00550099
005600******************************************************************00560099
005700 01  PS-PROGRAM-SWITCHES.                                         00570099
005800     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00580099
005900         88  PS-EOF-INPUT                        VALUE 'Y'.       00590099
006000         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00600099
006100                                                                  00610099
006200 01  PC-PROGRAM-CONSTANTS.                                        00620099
006300     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'RCKRP083'. 00630099
006400     05  PC-MAX-LINES                 PIC 99    VALUE 75.         00640099
006500     05  PC-REPORT-NBR                PIC X(10) VALUE             00650099
006600                                                  'RCKRP083-1'.   00660099
006700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3 COMP.   00670099
006800                                                                  00680099
006900 01  PC-NO-INPUT-LINE.                                            00690099
007000     05 FILLER                      PIC X(75) VALUE SPACES.       00700099
007100     05 FILLER                      PIC X(50) VALUE               00710099
007200     '       ***  THERE IS NO DATA TO REPORT  ***       '.        00720099
007300     05 FILLER                      PIC X(75) VALUE SPACES.       00730099
007400                                                                  00740099
007500 01  PC-END-OF-REPORT-LINE.                                       00750099
007600     05 FILLER                      PIC X(75) VALUE SPACES.       00760099
007700     05 FILLER                      PIC X(50) VALUE               00770099
007800     '             ***  END OF REPORT  ***              '.        00780099
007900     05 FILLER                      PIC X(75) VALUE SPACES.       00790099
008000                                                                  00800099
008100 01  PV-PROGRAM-VARIABLES.                                        00810099
008200     05  PV-DETAIL-WRITES             PIC 9(9)   VALUE 0.         00820099
008300     05  PV-RECORDS-READ              PIC 9(9)   VALUE 0.         00830099
008400     05  PV-LINE-COUNT                PIC 9(09)  VALUE 80.        00840099
008500     05  PV-PAGE-COUNT                PIC 9(09)  VALUE 0.         00850099
008600     05  PV-SQLCODE                   PIC 9999-.                  00860099
008700     05  PV-DEPT-NBR-N                PIC 9(4)   VALUE 0.         00870099
008800     05  PV-DEPT-NBR-X REDEFINES PV-DEPT-NBR-N                    00880099
008900                                      PIC X(4).                   00890099
009000     05  PV-TMST                      PIC X(26)  VALUE SPACES.    00900099
009100     05  PV-DATE                      PIC X(10)  VALUE SPACES.    00910099
009200     05  WS-HOLD-SET-YR               PIC X(4)   VALUE SPACES.    00920099
009300     05  WS-HOLD-SET                  PIC X(5)   VALUE SPACES.    00930099
009400     05  WS-HOLD-DEPT                 PIC 9(4)   VALUE 0.         00940099
009500     05  WS-HOLD-DMA-NBR              PIC X(2)   VALUE SPACES.    00950099
009600     05  WS-HOLD-BYR-NBR              PIC X(3)   VALUE SPACES.    00960099
009700     05  WS-HOLD-DMM-NM               PIC X(18)  VALUE SPACES.    00970099
009800     05  WS-HOLD-BYR-NM               PIC X(18)  VALUE SPACES.    00980099
009900     05  PV-CURR-DATE.                                            00990099
010000         10  PV-CURR-YY               PIC  9(02) VALUE ZERO.      01000099
010100         10  PV-CURR-MM               PIC  9(02) VALUE ZERO.      01010099
010200         10  PV-CURR-DD               PIC  9(02) VALUE ZERO.      01020099
010300     05  PV-CURR-TIME.                                            01030099
010400         10  PV-CURR-HH               PIC  9(02) VALUE ZERO.      01040099
010500         10  PV-CURR-MN               PIC  9(02) VALUE ZERO.      01050099
010600         10  PV-CURR-TIME-SSHH        PIC  9(04) VALUE ZERO.      01060099
010700     05  PV-SEASONAL-SET.                                         01070099
010800         10  PV-SET-YEAR              PIC  X(04).                 01080099
010900         10  FILLER                   PIC  X     VALUE '-'.       01090099
011000         10  PV-SET-NAME              PIC  X(05).                 01100099
011100                                                                  01110099
011200 01  PV-SET-TOTALS.                                               01120099
011300     05  PV-SET-TOT-PO-QTY             PIC   9(7)  VALUE 0.       01130099
011400     05  PV-SET-TOT-UNT-QTY            PIC  S9(11) VALUE 0.       01140099
011410*CHG98147 - START                                                 01141099
011411     05  PV-SET-TOT-PO-SPLIT-QTY       PIC  S9(11) VALUE 0.       01141199
011412     05  PV-SET-TOT-PO-SPLIT-DIFF      PIC  S9(11) VALUE 0.       01141299
011413*CHG98147 - END                                                   01141399
011500     05  PV-SET-TOT-PO-ALLOC-QTY       PIC  S9(11) VALUE 0.       01150099
011600     05  PV-SET-TOT-PO-ALLOC-DIFF      PIC  S9(11) VALUE 0.       01160099
011700     05  PV-SET-TOT-RCVR-ALLOC-QTY     PIC  S9(11) VALUE 0.       01170099
011800     05  PV-SET-TOT-RCVR-ALLOC-DIFF    PIC  S9(11) VALUE 0.       01180099
011900     05  PV-SET-TOT-RCVR-VERFYD-QTY    PIC  S9(11) VALUE 0.       01190099
012000                                                                  01200099
012100                                                                  01210099
012200     05 PV-FIRST-NAME.                                            01220099
012300        10 PV-FIRST-NAME-BYTE  OCCURS 12 TIMES INDEXED BY INX1    01230099
012400                                      PIC X(01).                  01240099
012500     05 PV-LAST-NAME.                                             01250099
012600        10 PV-LAST-NAME-BYTE   OCCURS 18 TIMES INDEXED BY INX2    01260099
012700                                      PIC X(01).                  01270099
012800     05 PV-NAME.                                                  01280099
012900        10 PV-NAME-BYTE        OCCURS 30 TIMES INDEXED BY INX3    01290099
013000                                      PIC X(01).                  01300099
013100                                                                  01310099
013200 01  WS-RPT-SECTION.                                              01320099
013300     05 FILLER                      PIC X(2)  VALUE SPACES.       01330099
013400     05 SECT-SEASET-YY              PIC X(2)  VALUE SPACES.       01340099
013500     05 FILLER                      PIC X(1)  VALUE '-'.          01350099
013600     05 SECT-SEASET-SHRT-NM         PIC X(5)  VALUE SPACES.       01360099
013700                                                                  01370099
013800 01  WS-RPT-SEC-NO-DATA.                                          01380099
013900     05 FILLER                      PIC X(2)  VALUE SPACES.       01390099
014000     05 FILLER                      PIC X(30) VALUE               01400099
014100        '*** NO DATA TO REPORT ***     '.                         01410099
014200     05 FILLER                      PIC X(168) VALUE SPACES.      01420099
014300                                                                  01430099
014400 01  WS-RPT-HEADER1.                                              01440099
014500     05 FILLER                      PIC X(71) VALUE SPACES.       01450099
014600     05 FILLER                      PIC X(58) VALUE               01460099
014700     'SEASONAL SET RECAP REPORT - BY  SET/DMM/BYR/DEPT/PO - VER2'.01470099
014800     05 FILLER                      PIC X(71) VALUE SPACES.       01480099
014900                                                                  01490099
015000 01  WS-RPT-HEADER2.                                              01500099
015100     05 FILLER                      PIC X(2)  VALUE SPACES.       01510099
015200     05 FILLER                      PIC X(06) VALUE 'SET:  '.     01520099
015300     05 H2-SEASET-CCYY              PIC X(4).                     01530099
015400     05 FILLER                      PIC X(1)  VALUE '-'.          01540099
015500     05 H2-SEASET-SHRT-NM           PIC X(5).                     01550099
015600     05 FILLER                      PIC X(01) VALUE SPACES.       01560099
015700     05 H2-SEASONAL-SET-NAME        PIC X(25).                    01570099
015800                                                                  01580099
015900 01  WS-RPT-HEADER4.                                              01590099
016000     05 FILLER                       PIC X(63)  VALUE SPACES.     01600099
016100     05 FILLER                       PIC X(05)  VALUE 'TOTAL'.    01610099
016200     05 FILLER                       PIC X(12)  VALUE SPACES.     01620099
016300     05 FILLER                       PIC X(05)  VALUE 'TOTAL'.    01630099
016400     05 FILLER                       PIC X(113) VALUE SPACES.     01640099
016500                                                                  01650099
016600 01  WS-RPT-HEADER5.                                              01660099
016700     05 FILLER                       PIC X(63) VALUE SPACES.      01670099
016800     05 FILLER                       PIC X(05) VALUE 'VALUE'.     01680099
016900     05 FILLER                       PIC X(12) VALUE SPACES.      01690099
017000     05 FILLER                       PIC X(05) VALUE 'VALUE'.     01700099
017100     05 FILLER                       PIC X(02) VALUE SPACES.      01710099
017200     05 FILLER                       PIC X(05) VALUE 'TOTAL'.     01720099
017300     05 FILLER                       PIC X(17) VALUE SPACES.      01730099
017400     05 FILLER                       PIC X(03) VALUE 'SET'.       01740099
017500     05 FILLER                       PIC X(9)  VALUE SPACES.      01750099
017600     05 FILLER                       PIC X(05) VALUE 'TOTAL'.     01760099
017700*CHG98147 - START                                                 01770099
017800     05 FILLER                       PIC X(12) VALUE SPACES.      01780099
017900     05 FILLER                       PIC X(02) VALUE 'PO'.        01790099
018000     05 FILLER                       PIC X(14) VALUE SPACES.      01800099
018100     05 FILLER                       PIC X(02) VALUE 'PO'.        01810099
018200*CHG98147 - END                                                   01820099
018300     05 FILLER                       PIC X(12) VALUE SPACES.      01830099
018400     05 FILLER                       PIC X(02) VALUE 'PO'.        01840099
018500     05 FILLER                       PIC X(14) VALUE SPACES.      01850099
018600     05 FILLER                       PIC X(02) VALUE 'PO'.        01860099
018700     05 FILLER                       PIC X(06) VALUE SPACES.      01870099
018800     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  01880099
018900     05 FILLER                       PIC X(08) VALUE SPACES.      01890099
019000     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  01900099
019100     05 FILLER                       PIC X(06) VALUE SPACES.      01910099
019200     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  01920099
019300                                                                  01930099
019400 01  WS-RPT-HEADER6.                                              01940099
019500     05 FILLER                       PIC X(50) VALUE SPACES.      01950099
019600     05 FILLER                       PIC X(2)  VALUE 'PO'.        01960099
019700     05 FILLER                       PIC X(12) VALUE SPACES.      01970099
019800     05 FILLER                       PIC X(4)  VALUE 'COST'.      01980099
019900     05 FILLER                       PIC X(11) VALUE SPACES.      01990099
020000     05 FILLER                       PIC X(6)  VALUE 'RETAIL'.    02000099
020100     05 FILLER                       PIC X(3)  VALUE SPACES.      02010099
020200     05 FILLER                       PIC X(4)  VALUE 'SKUS'.      02020099
020300     05 FILLER                       PIC X(2)  VALUE SPACES.      02030099
020400     05 FILLER                       PIC X(2)  VALUE 'ST'.        02040099
020500     05 FILLER                       PIC X(6)  VALUE SPACES.      02050099
020600     05 FILLER                       PIC X(3)  VALUE 'SET'.       02060099
020700     05 FILLER                       PIC X(2)  VALUE SPACES.      02070099
020800     05 FILLER                       PIC X(5)  VALUE 'SHORT'.     02080099
020900     05 FILLER                       PIC X(10) VALUE SPACES.      02090099
021000     05 FILLER                       PIC X(4)  VALUE 'UNIT'.      02100099
021100*CHG98147 - START                                                 02110099
021200     05 FILLER                       PIC X(09) VALUE SPACES.      02120099
021300     05 FILLER                       PIC X(5)  VALUE 'SPLIT'.     02130099
021400     05 FILLER                       PIC X(11) VALUE SPACES.      02140099
021500     05 FILLER                       PIC X(05) VALUE 'SPLIT'.     02150099
021600*CHG98147 - END                                                   02160099
021700     05 FILLER                       PIC X(09) VALUE SPACES.      02170099
021800     05 FILLER                       PIC X(5)  VALUE 'ALLOC'.     02180099
021900     05 FILLER                       PIC X(11) VALUE SPACES.      02190099
022000     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02200099
022100     05 FILLER                       PIC X(9)  VALUE SPACES.      02210099
022200     05 FILLER                       PIC X(08) VALUE 'ALLOC'.     02220099
022300     05 FILLER                       PIC X(08) VALUE SPACES.      02230099
022400     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02240099
022500     05 FILLER                       PIC X(06) VALUE SPACES.      02250099
022600     05 FILLER                       PIC X(08) VALUE 'VERIFIED'.  02260099
022700                                                                  02270099
022800 01  WS-RPT-HEADER7.                                              02280099
022900     05 FILLER                       PIC X(2)  VALUE SPACES.      02290099
023000     05 FILLER                       PIC X(3)  VALUE 'DMM'.       02300099
023100     05 FILLER                       PIC X(16) VALUE SPACES.      02310099
023200     05 FILLER                       PIC X(5)  VALUE 'BUYER'.     02320099
023300     05 FILLER                       PIC X(14) VALUE SPACES.      02330099
023400     05 FILLER                       PIC X(4)  VALUE 'DEPT'.      02340099
023500     05 FILLER                       PIC X(02) VALUE SPACES.      02350099
023600     05 FILLER                       PIC X(06) VALUE 'NUMBER'.    02360099
023700     05 FILLER                       PIC X(10) VALUE SPACES.      02370099
023800     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02380099
023900     05 FILLER                       PIC X(11) VALUE SPACES.      02390099
024000     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02400099
024100     05 FILLER                       PIC X(04) VALUE SPACES.      02410099
024200     05 FILLER                       PIC X(03) VALUE 'QTY'.       02420099
024300     05 FILLER                       PIC X(2)  VALUE SPACES.      02430099
024400     05 FILLER                       PIC X(02) VALUE 'CD'.        02440099
024500     05 FILLER                       PIC X(1)  VALUE SPACES.      02450099
024600     05 FILLER                       PIC X(03) VALUE 'PKG'.       02460099
024700     05 FILLER                       PIC X(1)  VALUE SPACES.      02470099
024800     05 FILLER                       PIC X(05) VALUE 'YEAR'.      02480099
024900     05 FILLER                       PIC X(2)  VALUE SPACES.      02490099
025000     05 FILLER                       PIC X(06) VALUE 'NAME'.      02500099
025100     05 FILLER                       PIC X(04) VALUE SPACES.      02510099
025200     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02520099
025300*CHG98147 - START                                                 02530099
025400     05 FILLER                       PIC X(06) VALUE SPACES.      02540099
025500     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02550099
025600     05 FILLER                       PIC X(08) VALUE SPACES.      02560099
025700     05 FILLER                       PIC X(08) VALUE '    DIFF'.  02570099
025800*CHG98147 - END                                                   02580099
025900     05 FILLER                       PIC X(06) VALUE SPACES.      02590099
026000     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02600099
026100     05 FILLER                       PIC X(12) VALUE SPACES.      02610099
026200     05 FILLER                       PIC X(04) VALUE 'DIFF'.      02620099
026300     05 FILLER                       PIC X(06) VALUE SPACES.      02630099
026400     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02640099
026500     05 FILLER                       PIC X(12) VALUE SPACES.      02650099
026600     05 FILLER                       PIC X(04) VALUE 'DIFF'.      02660099
026700     05 FILLER                       PIC X(06) VALUE SPACES.      02670099
026800     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  02680099
026900                                                                  02690099
027000 01  WS-DETAIL-REC.                                               02700099
027100     05 FILLER                       PIC X(2)  VALUE SPACES.      02710099
027200     05 WS-DTL-DMM-NAME              PIC X(18) VALUE SPACES.      02720099
027300     05 FILLER                       PIC X(01) VALUE SPACES.      02730099
027400     05 WS-DTL-BYR-NAME              PIC X(18) VALUE SPACES.      02740099
027500     05 FILLER                       PIC X(01) VALUE SPACES.      02750099
027600     05 WS-DTL-DEPT                  PIC ZZZ9.                    02760099
027700     05 FILLER                       PIC X(01) VALUE SPACES.      02770099
027800*PS 11/26/2014 CHANGE STARTS                                      02780099
027800     05 WS-DTL-PO                    PIC ZZZZZZZ9.                02781099
027900     05 FILLER                       PIC X(02) VALUE SPACES.      02790099
027800*PS 11/26/2014 CHANGE ENDS                                        02791099
028000     05 WS-DTL-TOT-COST              PIC ZZ,ZZZ,ZZ9.99.           02800099
028100     05 FILLER                       PIC X(04) VALUE SPACES.      02810099
028200     05 WS-DTL-TOT-RETAIL            PIC ZZ,ZZZ,ZZ9.99.           02820099
028300     05 FILLER                       PIC X(02) VALUE SPACES.      02830099
028400     05 WS-DTL-QTY-SKUS              PIC ZZZZ9.                   02840099
028500     05 FILLER                       PIC X(02) VALUE SPACES.      02850099
028600     05 WS-DTL-STAT-CODE             PIC XX.                      02860099
028700     05 FILLER                       PIC X(02) VALUE SPACES.      02870099
028800     05 WS-DTL-PKGNG-CDE             PIC X.                       02880099
028900     05 FILLER                       PIC X(02) VALUE SPACES.      02890099
029000     05 WS-DTL-SEASET-YR             PIC X(04).                   02900099
029100     05 FILLER                       PIC X(02) VALUE SPACES.      02910099
029200     05 WS-DTL-SEASET-SHRT-NM        PIC X(05).                   02920099
029300     05 FILLER                       PIC X(04) VALUE SPACES.      02930099
029400     05 WS-DTL-TOT-UNITS             PIC ZZ,ZZZ,ZZ9.              02940099
029500*CHG98147 - START                                                 02950099
029600     05 FILLER                       PIC X(04) VALUE SPACES.      02960099
029700     05 WS-DTL-PO-SPLIT-QTY          PIC ZZ,ZZZ,ZZ9.              02970099
029800     05 FILLER                       PIC X(05) VALUE SPACES.      02980099
029900     05 WS-DTL-PO-SPLIT-DIFF         PIC ZZ,ZZZ,ZZ9-.             02990099
030000*CHG98147 - END                                                   03000099
030100     05 FILLER                       PIC X(04) VALUE SPACES.      03010099
030200     05 WS-DTL-PO-ALLOC-QTY          PIC ZZ,ZZZ,ZZ9.              03020099
030300     05 FILLER                       PIC X(05) VALUE SPACES.      03030099
030400     05 WS-DTL-PO-ALLOC-DIFF         PIC ZZ,ZZZ,ZZ9-.             03040099
030500     05 FILLER                       PIC X(04) VALUE SPACES.      03050099
030600     05 WS-DTL-RCVR-ALLOC-QTY        PIC ZZ,ZZZ,ZZ9.              03060099
030700     05 FILLER                       PIC X(05) VALUE SPACES.      03070099
030800     05 WS-DTL-RCVR-ALLOC-DIFF       PIC ZZ,ZZZ,ZZ9-.             03080099
030900     05 FILLER                       PIC X(04) VALUE SPACES.      03090099
031000     05 WS-DTL-RCVR-VERFYD           PIC ZZ,ZZZ,ZZ9.              03100099
031100                                                                  03110099
031200 01  WS-SET-TOT-REC.                                              03120099
031300     05 FILLER                       PIC X(45) VALUE SPACES.      03130099
031400     05 WS-SET-TOT-PO                PIC ZZZZZZ9.                 03140099
031500     05 FILLER                       PIC X(3) VALUE SPACES.       03150099
031600     05 FILLER                       PIC X(5) VALUE 'SET  '.      03160099
031700     05 WS-SET-TOT-SET               PIC X(5).                    03170099
031800     05 FILLER                       PIC X(01) VALUE SPACES.      03180099
031900     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     03190099
032000     05 FILLER                       PIC X(41) VALUE SPACES.      03200099
032100     05 WS-SET-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           03210099
032200*CHG98147 - START                                                 03220099
032300     05 FILLER                       PIC X(01) VALUE SPACES.      03230099
032310     05 WS-SET-TOT-PO-SPLIT-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03231099
032320     05 FILLER                       PIC X(02) VALUE SPACES.      03232099
032330     05 WS-SET-TOT-PO-SPLIT-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03233099
032400*CHG98147 - END                                                   03240099
032500     05 FILLER                       PIC X(01) VALUE SPACES.      03250099
032600     05 WS-SET-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03260099
032700     05 FILLER                       PIC X(02) VALUE SPACES.      03270099
032800     05 WS-SET-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03280099
032900     05 FILLER                       PIC X(01) VALUE SPACES.      03290099
033000     05 WS-SET-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           03300099
033100     05 FILLER                       PIC X(02) VALUE SPACES.      03310099
033200     05 WS-SET-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          03320099
033300     05 FILLER                       PIC X(01) VALUE SPACES.      03330099
033400     05 WS-SET-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           03340099
033500                                                                  03350099
033600 01  WS-DPT-TOT-REC.                                              03360099
033700     05 FILLER                       PIC X(45) VALUE SPACES.      03370099
033800     05 WS-DPT-TOT-PO                PIC ZZZZZZ9.                 03380099
033900     05 FILLER                       PIC X(3)  VALUE SPACES.      03390099
034000     05 FILLER                       PIC X(4) VALUE 'DEPT'.       03400099
034100     05 FILLER                       PIC X(2) VALUE SPACES.       03410099
034200     05 WS-DPT-TOT-DEPT              PIC ZZZ9.                    03420099
034300     05 FILLER                       PIC X(1) VALUE SPACES.       03430099
034400     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     03440099
034500     05 FILLER                       PIC X(41) VALUE SPACES.      03450099
034600     05 WS-DPT-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           03460099
034700     05 FILLER                       PIC X(01) VALUE SPACES.      03470099
034800     05 WS-DPT-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03480099
034900     05 FILLER                       PIC X(02) VALUE SPACES.      03490099
035000     05 WS-DPT-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03500099
035100     05 FILLER                       PIC X(01) VALUE SPACES.      03510099
035200     05 WS-DPT-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           03520099
035300     05 FILLER                       PIC X(02) VALUE SPACES.      03530099
035400     05 WS-DPT-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          03540099
035500     05 FILLER                       PIC X(01) VALUE SPACES.      03550099
035600     05 WS-DPT-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           03560099
035700                                                                  03570099
035800 01  WS-RPT-TOT-REC.                                              03580099
035900     05 FILLER                       PIC X(45) VALUE SPACES.      03590099
036000     05 WS-RPT-TOT-PO                PIC ZZZZZZ9.                 03600099
036100     05 FILLER                       PIC X(14) VALUE SPACES.      03610099
036200     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     03620099
036300     05 FILLER                       PIC X(41) VALUE SPACES.      03630099
036400     05 WS-RPT-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           03640099
036500     05 FILLER                       PIC X(01) VALUE SPACES.      03650099
036600     05 WS-RPT-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03660099
036700     05 FILLER                       PIC X(02) VALUE SPACES.      03670099
036800     05 WS-RPT-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03680099
036900     05 FILLER                       PIC X(01) VALUE SPACES.      03690099
037000     05 WS-RPT-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           03700099
037100     05 FILLER                       PIC X(02) VALUE SPACES.      03710099
037200     05 WS-RPT-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          03720099
037300     05 FILLER                       PIC X(01) VALUE SPACES.      03730099
037400     05 WS-RPT-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           03740099
037500                                                                  03750099
037600*CHG98147 - START                                                 03760099
037700 01  WS-BLANK-LINE.                                               03770099
037800*    05 FILLER                       PIC  X(200) VALUE SPACES.    03780099
037900     05 FILLER                       PIC  X(250) VALUE SPACES.    03790099
038000*CHG98147 - END                                                   03800099
038100                                                                  03810099
038200 01  PV-ABEND-FIELDS.                                             03820099
038300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         03830099
038400                                                 COMP SYNC.       03840099
038500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKRP082'.03850099
038600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    03860099
038700     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    03870099
038800     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    03880099
038900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03890099
039000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03900099
039100     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    03910099
039200                                                                  03920099
039300******************************************************************03930099
039400*  INPUT FILE                                                     03940099
039500******************************************************************03950099
039600     COPY RCRD092.                                                03960099
039700                                                                  03970099
039800*CHG98147 - START                                                 03980099
039900***************************************************************** 03990099
040000*  STANDARD REPORT HEADER FOR A 200 COLUMN REPORT.              * 04000099
040100***************************************************************** 04010099
040200*                                                                 04020099
040300*    COPY DPWS200.                                                04030099
040400*                                                                 04040099
040500***************************************************************** 04050099
040600*  STANDARD REPORT HEADER FOR A 250 COLUMN REPORT.              * 04060099
040700***************************************************************** 04070099
040800*                                                                 04080099
040900     COPY DPWS250O.                                               04090099
041000*                                                                 04100099
041100*CHG98147 - END                                                   04110099
041200***********************************************************       04120099
041300*  DB2 SQL COMMUNICATION AREA                                     04130099
041400***********************************************************       04140099
041500     EXEC SQL                                                     04150099
041600         INCLUDE SQLCA                                            04160099
041700     END-EXEC.                                                    04170099
041800                                                                  04180099
041900***********************************************************       04190099
042000*  TSEASET                                                        04200099
042100***********************************************************       04210099
042200     EXEC SQL                                                     04220099
042300         INCLUDE TSEASET                                          04230099
042400     END-EXEC.                                                    04240099
042500                                                                  04250099
042600***********************************************************       04260099
042700*  XLT_DEPT(XLT00002)                                             04270099
042800***********************************************************       04280099
042900     EXEC SQL                                                     04290099
043000         INCLUDE XLT00002                                         04300099
043100     END-EXEC.                                                    04310099
043200                                                                  04320099
043300***********************************************************       04330099
043400*  USED FOR DB2 ERROR MESSAGE BUILDING                    *       04340099
043500***********************************************************       04350099
043600     COPY DPWS004.                                                04360099
043700                                                                  04370099
043800******************************************************************04380099
043900 PROCEDURE DIVISION.                                              04390099
044000******************************************************************04400099
044100 0000-PROGRAM-MAINLINE.                                           04410099
044200                                                                  04420099
044300     PERFORM 1000-INITIAL.                                        04430099
044400                                                                  04440099
044500     IF PS-NOT-EOF-INPUT                                          04450099
044600        PERFORM 2000-PROCESS-INPUT-FILE                           04460099
044700           UNTIL PS-EOF-INPUT                                     04470099
044800        PERFORM 9000-EOJ                                          04480099
044900     END-IF.                                                      04490099
045000                                                                  04500099
045100     PERFORM 9100-CLOSE-FILES.                                    04510099
045200                                                                  04520099
045300     GOBACK.                                                      04530099
045400                                                                  04540099
045500                                                                  04550099
045600 1000-INITIAL.                                                    04560099
045700                                                                  04570099
045800     OPEN INPUT  INPUT-FILE                                       04580099
045900          OUTPUT REPORT-FILE.                                     04590099
046000                                                                  04600099
046100*CHG98147 - START                                                 04610099
046200*    MOVE PC-PROGRAM-NAME TO DP200-PROGRAM-NAME.                  04620099
046300*    MOVE PC-REPORT-NBR TO DP200-REPORT-NUMBER.                   04630099
046400     MOVE PC-PROGRAM-NAME TO DP250O-PROGRAM-NAME.                 04640099
046500     MOVE PC-REPORT-NBR TO DP250O-REPORT-NUMBER.                  04650099
046600*CHG98147 - END                                                   04660099
046700                                                                  04670099
046800     PERFORM 7100-GET-TIMESTAMP.                                  04680099
046900                                                                  04690099
047000*CHG98147 - START                                                 04700099
047100*    MOVE 1                    TO DP200-REPORT-NUMBER.            04710099
047200*    MOVE 0                    TO DP200-PAGE-NUMBER.              04720099
047300     MOVE 1                    TO DP250O-REPORT-NUMBER.           04730099
047400     MOVE 0                    TO DP250O-PAGE-NUMBER.             04740099
047500*CHG98147 - END                                                   04750099
047600                                                                  04760099
047700     PERFORM 7000-READ-INPUT-FILE.                                04770099
047800                                                                  04780099
047900     IF PS-NOT-EOF-INPUT                                          04790099
048000        MOVE RC092-SEASET-YR TO WS-HOLD-SET-YR                    04800099
048100        MOVE RC092-SEASET-SHRT-NM TO WS-HOLD-SET                  04810099
048200     ELSE                                                         04820099
048300        PERFORM 8200-NO-DATA                                      04830099
048400     END-IF.                                                      04840099
048500                                                                  04850099
048600******************************************************************04860099
048700* PROCESS INPUT RECORDS                                          *04870099
048800******************************************************************04880099
048900 2000-PROCESS-INPUT-FILE.                                         04890099
049000                                                                  04900099
049100     MOVE '2000-PROCESS-INPUT-FILE.'    TO PV-ABEND-PARAGRAPH.    04910099
049200                                                                  04920099
049300     MOVE RC092-DEPT-NBR TO PV-DEPT-NBR-N.                        04930099
049400     MOVE RC092-DMM-NM   TO WS-DTL-DMM-NAME.                      04940099
049500     MOVE RC092-BUYER-NM TO WS-DTL-BYR-NAME.                      04950099
049600     MOVE RC092-DEPT-NBR  TO WS-DTL-DEPT.                         04960099
049700     MOVE RC092-PO-NUMBER TO WS-DTL-PO.                           04970099
049800     MOVE RC092-TOT-VAL-COST-AMT TO WS-DTL-TOT-COST.              04980099
049900     MOVE RC092-TOT-VAL-RTL-AMT TO WS-DTL-TOT-RETAIL.             04990099
050000     MOVE RC092-TOT-SKUS-QTY TO WS-DTL-QTY-SKUS.                  05000099
050100     MOVE RC092-STATUS-CDE TO WS-DTL-STAT-CODE.                   05010099
050200     MOVE RC092-PKGNG-CDE TO WS-DTL-PKGNG-CDE.                    05020099
050300     MOVE RC092-SEASET-YR TO WS-DTL-SEASET-YR.                    05030099
050400     MOVE RC092-SEASET-SHRT-NM TO WS-DTL-SEASET-SHRT-NM.          05040099
050500     MOVE RC092-TOT-UNT-QTY TO WS-DTL-TOT-UNITS.                  05050099
050600*CHG98147 - START                                                 05060099
050700     MOVE RC092-PO-SPLIT-QTY TO WS-DTL-PO-SPLIT-QTY.              05070099
050800     MOVE RC092-PO-SPLIT-DIFF TO WS-DTL-PO-SPLIT-DIFF.            05080099
050900*CHG98147 - END                                                   05090099
051000     MOVE RC092-PO-ALLOC-QTY TO WS-DTL-PO-ALLOC-QTY.              05100099
051100     MOVE RC092-PO-ALLOC-DIFF TO WS-DTL-PO-ALLOC-DIFF.            05110099
051200     MOVE RC092-RCVR-ALLOC-QTY TO WS-DTL-RCVR-ALLOC-QTY.          05120099
051300     MOVE RC092-RCVR-ALLOC-DIFF TO WS-DTL-RCVR-ALLOC-DIFF.        05130099
051400     MOVE RC092-RCVR-VERFYD-QTY TO WS-DTL-RCVR-VERFYD.            05140099
051500                                                                  05150099
051600     PERFORM 8000-WRITE-REPORT-RECORD.                            05160099
051700                                                                  05170099
051800     PERFORM 7000-READ-INPUT-FILE.                                05180099
051900                                                                  05190099
052000 3400-GET-SEASET-INFO.                                            05200099
052100                                                                  05210099
052200     MOVE '3400-GET-SEASET-INFO       ' TO PV-ABEND-PARAGRAPH.    05220099
052300                                                                  05230099
052400     EXEC SQL                                                     05240099
052500          SELECT SEASET_NM                                        05250099
052600            INTO :SEASET-SEASET-NM                                05260099
052700            FROM TSEASET                                          05270099
052800           WHERE SEASET_YR      = :SEASET-SEASET-YR               05280099
052900             AND SEASET_SHRT_NM = :SEASET-SEASET-SHRT-NM          05290099
053000     END-EXEC.                                                    05300099
053100                                                                  05310099
053200     EVALUATE TRUE                                                05320099
053300        WHEN SQLCODE = 0                                          05330099
053400           MOVE SEASET-SEASET-NM TO H2-SEASONAL-SET-NAME          05340099
053500        WHEN OTHER                                                05350099
053600           MOVE '3400-GET-SEASET-INFO'                            05360099
053700                                  TO PV-ABEND-PARAGRAPH           05370099
053800           MOVE 'SELECT TSEASET'                                  05380099
053900                                  TO PV-ABEND-OPERATION           05390099
054000           MOVE ' '               TO PV-ABEND-STRUCTURE-1         05400099
054100           MOVE 'SELECT      '    TO PV-DB2-OPERATION-MESSAGE-1   05410099
054200           PERFORM 9900-DB2-ABEND                                 05420099
054300     END-EVALUATE.                                                05430099
054400                                                                  05440099
054500 3500-GET-DEPT-INFO.                                              05450099
054600                                                                  05460099
054700     MOVE '3500-GET-DEPT-INFO       ' TO PV-ABEND-PARAGRAPH.      05470099
054800                                                                  05480099
054900     EXEC SQL                                                     05490099
055000          SELECT DEPT_NM                                          05500099
055100            INTO :XLT00002-DEPT-NM                                05510099
055200            FROM XLT_DEPT                                         05520099
055300           WHERE DEPT_NBR = :XLT00002-DEPT-NBR                    05530099
055400     END-EXEC.                                                    05540099
055500                                                                  05550099
055600     EVALUATE TRUE                                                05560099
055700        WHEN SQLCODE = 0                                          05570099
055800           CONTINUE                                               05580099
055900        WHEN OTHER                                                05590099
056000           MOVE '3500-GET-DEPT-INFO'                              05600099
056100                                  TO PV-ABEND-PARAGRAPH           05610099
056200           MOVE 'SELECT XLT_DEPT'                                 05620099
056300                                  TO PV-ABEND-OPERATION           05630099
056400           MOVE ' '               TO PV-ABEND-STRUCTURE-1         05640099
056500           MOVE 'SELECT      '    TO PV-DB2-OPERATION-MESSAGE-1   05650099
056600           PERFORM 9900-DB2-ABEND                                 05660099
056700     END-EVALUATE.                                                05670099
056800                                                                  05680099
056900******************************************************************05690099
057000* MOVE SET TOTALS                                                 05700099
057100******************************************************************05710099
057200 6100-MOVE-SET-TOTALS.                                            05720099
057300                                                                  05730099
057400     MOVE WS-HOLD-SET                TO WS-SET-TOT-SET.           05740099
057500     MOVE PV-SET-TOT-PO-QTY          TO WS-SET-TOT-PO.            05750099
057600     MOVE PV-SET-TOT-UNT-QTY         TO WS-SET-TOT-UNITS.         05760099
057610*CHG98147 - START                                                 05761099
057611     MOVE PV-SET-TOT-PO-SPLIT-QTY    TO WS-SET-TOT-PO-SPLIT-QTY.  05761199
057612     MOVE PV-SET-TOT-PO-SPLIT-DIFF   TO WS-SET-TOT-PO-SPLIT-DIFF. 05761299
057620*CHG98147 - END                                                   05762099
057700     MOVE PV-SET-TOT-PO-ALLOC-QTY    TO WS-SET-TOT-PO-ALLOC-QTY.  05770099
057800     MOVE PV-SET-TOT-PO-ALLOC-DIFF   TO WS-SET-TOT-PO-ALLOC-DIFF. 05780099
057900     MOVE PV-SET-TOT-RCVR-ALLOC-QTY  TO WS-SET-TOT-RCVR-ALLOC-QTY.05790099
058000     MOVE PV-SET-TOT-RCVR-ALLOC-DIFF TO                           05800099
058100        WS-SET-TOT-RCVR-ALLOC-DIFF.                               05810099
058200     MOVE PV-SET-TOT-RCVR-VERFYD-QTY TO WS-SET-TOT-RCVR-VERFYD.   05820099
058300                                                                  05830099
058400******************************************************************05840099
058500* ACCUMULATE TOTALS                                               05850099
058600******************************************************************05860099
058700 6300-ACCUM-TOTALS.                                               05870099
058800                                                                  05880099
058900     ADD 1                     TO  PV-SET-TOT-PO-QTY.             05890099
059000     ADD RC092-TOT-UNT-QTY     TO  PV-SET-TOT-UNT-QTY.            05900099
059010*CHG98147 - START                                                 05901099
059011     ADD RC092-PO-SPLIT-QTY    TO  PV-SET-TOT-PO-SPLIT-QTY.       05901199
059012     ADD RC092-PO-SPLIT-DIFF   TO  PV-SET-TOT-PO-SPLIT-DIFF.      05901299
059020*CHG98147 - END                                                   05902099
059100     ADD RC092-PO-ALLOC-QTY    TO  PV-SET-TOT-PO-ALLOC-QTY.       05910099
059200     ADD RC092-PO-ALLOC-DIFF   TO  PV-SET-TOT-PO-ALLOC-DIFF.      05920099
059300     ADD RC092-RCVR-ALLOC-QTY  TO  PV-SET-TOT-RCVR-ALLOC-QTY.     05930099
059400     ADD RC092-RCVR-ALLOC-DIFF TO  PV-SET-TOT-RCVR-ALLOC-DIFF.    05940099
059500     ADD RC092-RCVR-VERFYD-QTY TO  PV-SET-TOT-RCVR-VERFYD-QTY.    05950099
059600                                                                  05960099
059700******************************************************************05970099
059800* READS RECORD FROM THE INPUT FILE                                05980099
059900******************************************************************05990099
060000 7000-READ-INPUT-FILE.                                            06000099
060100     MOVE '7000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    06010099
060200                                                                  06020099
060300     READ INPUT-FILE                                              06030099
060400          INTO RCRD092-SEASET-PO-EXTRACT                          06040099
060500            AT END                                                06050099
060600               SET PS-EOF-INPUT     TO TRUE.                      06060099
060700                                                                  06070099
060800     IF PS-NOT-EOF-INPUT                                          06080099
060900        ADD 1 TO PV-RECORDS-READ                                  06090099
061000     END-IF.                                                      06100099
061100                                                                  06110099
061200******************************************************************06120099
061300 7100-GET-TIMESTAMP.                                              06130099
061400***************************************************************** 06140099
061500                                                                  06150099
061600     MOVE '7100-GET-TIMESTAMP         ' TO PV-ABEND-PARAGRAPH.    06160099
061700                                                                  06170099
061800     EXEC SQL                                                     06180099
061900         SET :PV-TMST = CURRENT TIMESTAMP                         06190099
062000     END-EXEC.                                                    06200099
062100                                                                  06210099
062200     EVALUATE TRUE                                                06220099
062300        WHEN SQLCODE = ZERO                                       06230099
062400           MOVE PV-TMST(1:10)    TO PV-DATE                       06240099
062500*CHG98147 - START                                                 06250099
062600*          MOVE PV-TMST(1:4)     TO DP200-RUN-YEAR                06260099
062700*          MOVE PV-TMST(6:2)     TO DP200-RUN-MONTH               06270099
062800*          MOVE PV-TMST(9:2)     TO DP200-RUN-DAY                 06280099
062900*          MOVE PV-TMST(12:2)    TO DP200-RUN-HOUR                06290099
063000*          MOVE PV-TMST(15:2)    TO DP200-RUN-MINUTE              06300099
063100           MOVE PV-TMST(1:4)     TO DP250O-RUN-YEAR               06310099
063200           MOVE PV-TMST(6:2)     TO DP250O-RUN-MONTH              06320099
063300           MOVE PV-TMST(9:2)     TO DP250O-RUN-DAY                06330099
063400           MOVE PV-TMST(12:2)    TO DP250O-RUN-HOUR               06340099
063500           MOVE PV-TMST(15:2)    TO DP250O-RUN-MINUTE             06350099
063600*CHG98147 - END                                                   06360099
063700        WHEN OTHER                                                06370099
063800           MOVE '7100-GET-TIMESTAMP'                              06380099
063900                                  TO PV-ABEND-PARAGRAPH           06390099
064000           MOVE 'SET TIMESTAMP  ' TO PV-ABEND-OPERATION           06400099
064100           MOVE ' '               TO PV-ABEND-STRUCTURE-1         06410099
064200           MOVE 'SET TIMESTAMP'   TO PV-DB2-OPERATION-MESSAGE-1   06420099
064300           PERFORM 9900-DB2-ABEND                                 06430099
064400     END-EVALUATE.                                                06440099
064500                                                                  06450099
064600******************************************************************06460099
064700* WRITE OUTPUT                                                    06470099
064800******************************************************************06480099
064900 8000-WRITE-REPORT-RECORD.                                        06490099
065000                                                                  06500099
065100     IF (RC092-SEASET-YR = WS-HOLD-SET-YR) AND                    06510099
065200        (RC092-SEASET-SHRT-NM = WS-HOLD-SET)                      06520099
065300        IF PV-LINE-COUNT > PC-MAX-LINES                           06530099
065400           PERFORM 8100-NEW-PAGE                                  06540099
065500        END-IF                                                    06550099
065600     ELSE                                                         06560099
065700        INITIALIZE WS-SET-TOT-REC                                 06570099
065800        PERFORM 6100-MOVE-SET-TOTALS                              06580099
065900        WRITE REPORT-RECORD FROM WS-SET-TOT-REC                   06590099
066000            AFTER ADVANCING 2 LINE                                06600099
066100        WRITE REPORT-RECORD FROM WS-BLANK-LINE                    06610099
066200            AFTER ADVANCING 1 LINES                               06620099
066300        ADD 3 TO PV-LINE-COUNT                                    06630099
066400        MOVE RC092-SEASET-YR TO WS-HOLD-SET-YR                    06640099
066500        MOVE RC092-SEASET-SHRT-NM TO WS-HOLD-SET                  06650099
066600        INITIALIZE PV-SET-TOTALS                                  06660099
066700                                                                  06670099
066800        PERFORM 8100-NEW-PAGE                                     06680099
066900     END-IF.                                                      06690099
067000                                                                  06700099
067100     WRITE REPORT-RECORD FROM WS-DETAIL-REC                       06710099
067200         AFTER ADVANCING 1 LINE.                                  06720099
067300                                                                  06730099
067400     ADD 1 TO PV-DETAIL-WRITES.                                   06740099
067500     ADD 1 TO PV-LINE-COUNT.                                      06750099
067600                                                                  06760099
067700     PERFORM 6300-ACCUM-TOTALS.                                   06770099
067800                                                                  06780099
067900******************************************************************06790099
068000* NEW PAGE                                                        06800099
068100******************************************************************06810099
068200 8100-NEW-PAGE.                                                   06820099
068300                                                                  06830099
068400     ADD 1 TO PV-PAGE-COUNT.                                      06840099
068500*CHG98147 - START                                                 06850099
068600*    MOVE PV-PAGE-COUNT TO DP200-PAGE-NUMBER.                     06860099
068700     MOVE PV-PAGE-COUNT TO DP250O-PAGE-NUMBER.                    06870099
068800                                                                  06880099
068900*    WRITE REPORT-RECORD FROM DP200-STANDRD-HEADER-200-COLS       06890099
069000     WRITE REPORT-RECORD FROM DP250O-STANDRD-HEADER-250-COLS      06900099
069100         AFTER ADVANCING PAGE.                                    06910099
069200*CHG98147 - END                                                   06920099
069300                                                                  06930099
069400     WRITE REPORT-RECORD FROM WS-RPT-HEADER1                      06940099
069500         AFTER ADVANCING 2 LINES.                                 06950099
069600                                                                  06960099
069700     INITIALIZE WS-RPT-SECTION.                                   06970099
069800     MOVE WS-HOLD-SET-YR(3:2) TO SECT-SEASET-YY.                  06980099
069900     MOVE WS-HOLD-SET TO SECT-SEASET-SHRT-NM.                     06990099
070000                                                                  07000099
070100     WRITE REPORT-RECORD FROM WS-RPT-SECTION                      07010099
070200         AFTER ADVANCING 1 LINES.                                 07020099
070300                                                                  07030099
070400     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       07040099
070500         AFTER ADVANCING 1 LINES.                                 07050099
070600                                                                  07060099
070700     MOVE WS-HOLD-SET-YR TO SEASET-SEASET-YR.                     07070099
070800     MOVE WS-HOLD-SET    TO SEASET-SEASET-SHRT-NM.                07080099
070900                                                                  07090099
071000     PERFORM 3400-GET-SEASET-INFO.                                07100099
071100                                                                  07110099
071200     MOVE WS-HOLD-SET-YR TO H2-SEASET-CCYY.                       07120099
071300     MOVE WS-HOLD-SET    TO H2-SEASET-SHRT-NM.                    07130099
071400                                                                  07140099
071500     WRITE REPORT-RECORD FROM WS-RPT-HEADER2                      07150099
071600         AFTER ADVANCING 1 LINES.                                 07160099
071700                                                                  07170099
071800     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       07180099
071900         AFTER ADVANCING 1 LINES.                                 07190099
072000                                                                  07200099
072100     WRITE REPORT-RECORD FROM WS-RPT-HEADER4                      07210099
072200         AFTER ADVANCING 1 LINES.                                 07220099
072300                                                                  07230099
072400     WRITE REPORT-RECORD FROM WS-RPT-HEADER5                      07240099
072500         AFTER ADVANCING 1 LINES.                                 07250099
072600                                                                  07260099
072700     WRITE REPORT-RECORD FROM WS-RPT-HEADER6                      07270099
072800         AFTER ADVANCING 1 LINES.                                 07280099
072900                                                                  07290099
073000     WRITE REPORT-RECORD FROM WS-RPT-HEADER7                      07300099
073100         AFTER ADVANCING 1 LINES.                                 07310099
073200                                                                  07320099
073300     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       07330099
073400         AFTER ADVANCING 1 LINES.                                 07340099
073500                                                                  07350099
073600     MOVE 12 TO PV-LINE-COUNT.                                    07360099
073700                                                                  07370099
073800******************************************************************07380099
073900* NO DATA                                                         07390099
074000******************************************************************07400099
074100 8200-NO-DATA.                                                    07410099
074200                                                                  07420099
074300     ADD 1 TO PV-PAGE-COUNT.                                      07430099
074400*CHG98147 - START                                                 07440099
074500*    MOVE PV-PAGE-COUNT TO DP200-PAGE-NUMBER.                     07450099
074600     MOVE PV-PAGE-COUNT TO DP250O-PAGE-NUMBER.                    07460099
074700                                                                  07470099
074800*    WRITE REPORT-RECORD FROM DP200-STANDRD-HEADER-200-COLS       07480099
074900     WRITE REPORT-RECORD FROM DP250O-STANDRD-HEADER-250-COLS      07490099
075000         AFTER ADVANCING PAGE.                                    07500099
075100*CHG98147 - END                                                   07510099
075200                                                                  07520099
075300     WRITE REPORT-RECORD FROM WS-RPT-HEADER1                      07530099
075400         AFTER ADVANCING 2 LINES.                                 07540099
075500                                                                  07550099
075600     WRITE REPORT-RECORD FROM WS-RPT-SEC-NO-DATA                  07560099
075700         AFTER ADVANCING 1 LINES.                                 07570099
075800                                                                  07580099
075900     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       07590099
076000         AFTER ADVANCING 1 LINES.                                 07600099
076100                                                                  07610099
076200     WRITE REPORT-RECORD FROM WS-RPT-HEADER4                      07620099
076300         AFTER ADVANCING 1 LINES.                                 07630099
076400                                                                  07640099
076500     WRITE REPORT-RECORD FROM WS-RPT-HEADER5                      07650099
076600         AFTER ADVANCING 1 LINES.                                 07660099
076700                                                                  07670099
076800     WRITE REPORT-RECORD FROM WS-RPT-HEADER6                      07680099
076900         AFTER ADVANCING 1 LINES.                                 07690099
077000                                                                  07700099
077100     WRITE REPORT-RECORD FROM WS-RPT-HEADER7                      07710099
077200         AFTER ADVANCING 1 LINES.                                 07720099
077300                                                                  07730099
077400     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       07740099
077500         AFTER ADVANCING 1 LINES.                                 07750099
077600                                                                  07760099
077700     WRITE REPORT-RECORD FROM PC-NO-INPUT-LINE                    07770099
077800         AFTER ADVANCING 1 LINES.                                 07780099
077900                                                                  07790099
078000 9000-EOJ.                                                        07800099
078100                                                                  07810099
078200     PERFORM 6100-MOVE-SET-TOTALS.                                07820099
078300                                                                  07830099
078400     IF PV-LINE-COUNT > PC-MAX-LINES                              07840099
078500        PERFORM 8100-NEW-PAGE                                     07850099
078600     END-IF.                                                      07860099
078700                                                                  07870099
078800     WRITE REPORT-RECORD FROM WS-SET-TOT-REC                      07880099
078900         AFTER ADVANCING 2 LINES.                                 07890099
079000                                                                  07900099
079100******************************************************************07910099
079200*  CLOSE FILES                                                    07920099
079300******************************************************************07930099
079400 9100-CLOSE-FILES.                                                07940099
079500                                                                  07950099
079600*DISPLAY COUNTS.                                                  07960099
079700     DISPLAY ' '.                                                 07970099
079800     DISPLAY '*********** RCKRP083 COUNTS ************'.          07980099
079900     DISPLAY '*** RECORDS READ     ==> ' PV-RECORDS-READ.         07990099
080000     DISPLAY '*** DETAILS WRITTEN  ==> ' PV-DETAIL-WRITES.        08000099
080100     DISPLAY '****************************************'.          08010099
080200     DISPLAY ' '.                                                 08020099
080300                                                                  08030099
080400     CLOSE INPUT-FILE                                             08040099
080500           REPORT-FILE.                                           08050099
080600                                                                  08060099
080700******************************************************************08070099
080800 9900-DB2-ABEND.                                                  08080099
080900******************************************************************08090099
081000                                                                  08100099
081100     MOVE SQLCODE TO PV-SQLCODE.                                  08110099
081200     DISPLAY '*** DB2 ERROR '.                                    08120099
081300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       08130099
081400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 08140099
081500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               08150099
081600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               08160099
081700     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       08170099
081800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       08180099
081900     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                08190099
082000                                                                  08200099
082100*ABEND                                                            08210099
082200                                                                  08220099
082300     DISPLAY '*** RCKRP082 ABEND ***'.                            08230099
082400                                                                  08240099
082500     COPY DPPD004.                                                08250099
082600                                                                  08260099
082700     MOVE +4013 TO PV-ABEND-CODE.                                 08270099
082800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08280099
