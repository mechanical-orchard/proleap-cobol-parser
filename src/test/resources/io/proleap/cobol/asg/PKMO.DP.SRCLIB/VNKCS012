000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKCS012.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  06/29/93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - V012                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100000
001100*    DESCRIPTION - SERVICES/PROGRAMS/INCENTIVES MAINTENANCE     * 00110000
001200*    MAPSET      - VNKM012                                      * 00120000
001300*                                                               * 00130000
001400*    THIS SCREEN ALLOWS USERS TO MAINTAIN VENDOR SERVICES,      * 00140000
001500*    PROGRAMS AND INCENTIVES.                                   * 00150000
001600*                                                               * 00160000
001700* DATE  05/27/2003                                              * 00170000
001800*     CHANGE MADE: VENDOR MULTI PRE-PACK USAGE PROJECT.  ADDED  * 00180000
001900*     NEW COMMAREA FIELD, ASC-PO-PREPK-CDE.  ADDED EDI-PO-PREPK-* 00190000
002000*     CDE TO CURSOR IN PARAGRAPH 4010.  INCLUDE ASC-PO-PREPK-CDE* 00200000
002100*     IN MOVES TO VNWS013 COPYBOOK IN PARAGRAPH 5500.           * 00210000
002200*     MADE BY: KEVIN CATLIN            WR/IR #: WR24663         * 00220000
002300*                                                               * 00230000
002400* DATE  11/05/2003                                              * 00240000
002500*     CHANGE MADE: ADDED CODE TO MOVE THE 4 NEW COLUMNS FROM    * 00250000
002600*     TEXTENT (GVRNG_IND, GVRNG_ENT_ID, CART_LBL_IND,           * 00260000
002700*     CART_LBL_EFF_DTE) TO THE RMS PO MESSAGING CODE.           * 00270000
002800*     MADE BY: MIKE BESKE              WR/IR #: WR25358         * 00280000
002900*                                                               * 00290000
003000* DATE  04/01/2005                                              * 00300000
003100*     CHANGE MADE: ADDED 2 NEW MESSAGES, AND LOGIC IN THE RETURN* 00310000
003200*     FROM CALLING VNKCS023 TO IDENTIFY THE FACT THAT THE       * 00320000
003300*     MAX NUMBER OF CAPABILITIES OR RELATIONSHIPS WAS EXCEEDED  * 00330000
003400*     WHEN SENDING A 'NEW VENDOR' MESSAGE TO RMS.               * 00340000
003500*     MADE BY: JACK KRAMER             WR/IR #: WR25278         * 00350000
003600*                                                               * 00360000
003700* DATE  07/21/2005                                              * 00370000
003800*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    * 00380000
003900*     RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       * 00390000
004000*     COPYBOOK VNWS013.                                         * 00400000
004100*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         * 00410000
004200*                                                               * 00420000
004300* DATE  02/07/2006                                              * 00430000
004400*     CHANGE MADE: CORRECTED BUG IN THE CODE IN PARAGRAPH       * 00440000
004500*     5400-PROCESS-INCENTIVES. THE NULL INDICATORS DN-DISCOUNT- * 00450000
004600*     PCT AND DN-EXT-PAY-DAYS-QTY WERE NOT BEING SET FOR MOS    * 00460000
004700*     TRADE AND BROADCAST DISCOUNTS.  WHENEVER THE COOP AD OR   * 00470000
004800*     OTHER DOLLARS INDICATORS WERE UPDATED, THE PERCENTAGES    * 00480000
004900*     FOR MOS, TRADE AND BROADCAST WERE GETTING NULLED OUT ON   * 00490000
005000*     THE DATABASE.  CODE WAS ADDED TO MOVE +1 TO THE NULL      * 00500000
005100*     INDICATORS MENTIONED ABOVE TO STOP THE NULLING OF THE DATA* 00510000
005200*     MADE BY: MIKE BESKE              WR/IR #: P000848162      * 00520000
005300*                                                               * 00530000
005400* DATE  03/14/2006                                              * 00540000
005500*     CHANGE MADE: REMOVED CODE THAT PROCESSES THE COOP AD AND  * 00550000
005600*     FIXTURE/OTHER DOLLARS INDICATORS.  THESE WILL NOT BE ON   * 00560000
005700*     THE SCREEN ANYMORE PER OKAY FROM WAYNE OSTLING.           * 00570000
005800*     ADDED CODE FOR DISPLAYING THE EFFECTIVE DATES FOR NEW STORE 00580000
005900*     DISC, MOS DISC, TRADE DISC, BROADCAST OFFINVOICE DISC.    * 00590000
006000*     ADDED CODE FOR NEW INCENTIVES: COOP ALW, MARKDOWN ALW,    * 00600000
006100*     TABLE/TOWER DATING.  FIXED THE BUG WHEN UPDATING ANY IN-  * 00610000
006200*     CNTIVE THAT HAS A PERCENT ASSOCIATED WITH IT.  THE BUG    * 00620000
006300*     WOULD EXPIRE AND ADD NEW ROWS FOR ALL OF THE ACTIVE IN-   * 00630000
006400*     CENTIVES WITH PERCENTAGES EVEN ONES THAT HAD NO CHANGES   * 00640000
006500*     DONE TO THEM.  CODE WAS ADDED TO PARA 4000- TO FORMAT THE * 00650000
006600*     FIELD ASC-NEW-STORE-DISC TO CORRECT THE BUG.  THE NEW     * 00660000
006700*     INCENTIVES WERE ADDED TO THE RMS MESSAGING CODE IN PARA   * 00670000
006800*     5500-.                                                    * 00680000
006900*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00690000
007000*                                                               * 00700000
007100* DATE  04/05/2006                                              * 00710000
007200*     CHANGE MADE: ADDED CODE IN PARA 5500- TO MOVE ZERO TO     * 00720000
007300*     VN013-BRDL-DISC-PCT.  THE CODE TO ACTUALLY PROCESS THE    * 00730000
007400*     BRIDAL ALLOWANCE PERCENTAGE WILL BE ADDED IN THE PROGRAM  * 00740000
007500*     IN A LATER PHASE. THIS CHANGE IS JUST INITIALIZING THE    * 00750000
007600*     FIELD FOR THE MQ MESSAGING TO RMS PO.                     * 00760000
007700*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00770000
007800*                                                               * 00780000
007900* DATE  05/29/2007                                              * 00790000
008000*     CHANGE MADE: DIRECT SHIP PROCESS                          * 00800000
008100*     ADDED PROCESSING FOR THE NEW DIRECT SHIP RATE AND PERCENT * 00810000
008200*     FIELDS FROM TSERTYP. WHEN THE DIRECT SHIP INDICATOR = 'N' * 00820000
008300*     THEN THE RATE AND PERCENT MUST BOTH BE ZEROES.  WHEN IT   * 00830000
008400*     IS 'Y' EITHER THE RATE ** OR  ** THE PERCENT MUST HAVE A  * 00840000
008500*     POSITIVE VALUE WITH THE THE OTHER HAVING ZEROES.          * 00850000
008600*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31112         * 00860000
008700*                                                               * 00870000
008800*    DATE  05/31/2007                                           * 00880000
008900*     RESTORED THIS PROGRAM BACK INTO PRODUCTION. AT THIS TIME  * 00890000
009000*     AN ISSUE WAS OCCURING WHEN A DEPARTMENT WAS ADDED TO A    * 00900000
009100*     VENDOR, THEN ATTEMPTING TO DO THE MAINTAINENCE PROCESS    * 00910000
009200*     FAILED.                                                   * 00920000
009300*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31112         * 00930000
009400*                                                               * 00940000
009500*    DATE  06/05/2007                                           * 00950000
009600*     CHANGE MADE: DIRECT SHIP PROCESS                          * 00960000
009700*     THE ISSUE THAT OCCURED ON 05/31/07 WAS A S0C7 THAT        * 00970000
009800*     WAS THE RESULT OF THE COPYBOOK VNWS013 BEING MODIFIED BUT * 00980000
009900*     NOT BEING COMPILED WITH THE OTHER PROGRAMS.  IT ENDS      * 00990000
010000*     UP THOUGH THAT THE COPYBOOK DIDN'T REQUIRE A CHANGE       * 01000000
010100*     AFTER ALL SO THE ONLY CHANGE NEEDED WAS TO REMOVE THE     * 01010000
010200*     LOGIC RELATED TO THE RMS FIELDS THAT ARE NOT TO BE IN     * 01020000
010300*     VNWS013.  THE REMAINDER OF THE DIRECT SHIP PROCESS        * 01030000
010400*     NOTED ABOVE ON 5/29/07 IS NOW IN THE PROGRAM.             * 01040000
010500*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: P001027977      * 01050000
010600*                                                               * 01060000
010700*    DATE  05/02/2013                                           * 01070000
010800*     CHANGE MADE: ADDED A NEW RFID COMPLIANT SWITCH WHICH IS   * 01080000
010900*     MAINTAINABLE WITH EITHER A 'N'OR 'T' OR 'C'. THE DEFAULT  * 01090000
011000*     IS 'N'.                                                   * 01100000
011100*     MADE BY: CHERI PARMLEY           WR/IR #: 5148B           * 01110000
011200*                                                               * 01120000
011300*    DATE  08/28/2013                                           * 01130000
011400*     CHANGE MADE: UN-COMMENT CODING THAT WAS IN PLACE WHICH    * 01140000
011500*     DISABLED THE 'T' TAGGING. THE PREVIOUS INSTALL WENT INTO  * 01150000
011600*     PRODUCTION WITHOUT THE TAGGING PIECE. SO NOW TAGGING IS   * 01160000
011700*     VALID.                                                    * 01170000
011800*     MADE BY: CHERI PARMLEY           WR/IR #: 5148B           * 01180000
011810*                                                               * 01181000
011820*    DATE  12/17/2014                  TAG: PRB0048560          * 01182000
011830*CASE1 : WHEN THE USER UPDATED THE DIRECT SHIP AGREEMENT TO 'N' * 01183000
011840*     AND SET THE CHRG_PCT AND CHRG_AMT FIELDSTO ZERO, DEFAULT  * 01184000
011850*     VALUES OF DIRECT SHIP AGREEMENT,CHRG_PCT AND CHRG_AMT *     01185000
011860*CASE2 : WHEN RFID STATUS CHANGED FROM 'N' TO 'T', DIRECT SHIP  * 01186000
011870*     CHARGE% AND CHARGE AMT SET TO ZERO. HENCE, SOME CODES ARE * 01187000
011880*     REARRANGED TO GET CORRECT CHARGE% AND CHARGE AMT.         * 01188000
011890*CASE3 : WHEN DIRECT SHIP IND = 'Y' AND RATE IS NON-ZERO, PF15  * 01189000
011891*     IS PRESSED.FOUND THAT DB ENTRY IS MADE AND UPDATE MSG IS  * 01189100
011892*     DISPLAYED IN CICS SCREEN. SAME DOESN"T HAPPEN WHEN PCT IS * 01189200
011893*     NON-ZERO.HENCE, CODE ADDED TO MOVE DB VALUES TO PCT OLD   * 01189300
011894*     VALUE.                                                    * 01189400
011895*     MADE BY: LENIN MANIEZHILAN       WR/IR #:PRB0048560       * 01189500
011896*                                                               * 01189600
011897*    DATE  01/26/2015                                             01189700
011898*     DUE TO THE PRODUCTION ISSUE IN THIS SCREEN, BACKED OUT    * 01189800
011899*     THE CHANGES MADE BY THE PRB PRB0048560 AND MOVING THE     * 01189900
011900*     CODE FROM ARCHIVE LIBRARY                                 * 01190000
011901*     MADE BY: RAVI GUNTHA (COGNIZANT) WR/IR #:CHG0103185       * 01190100
011902*    DATE 02/02/2015                                            * 01190200
011903*     PRODUCTION ISSUE HAS BEEN SOLVED & THE CODE HAS BEEN FIXED* 01190300
011904*     MADE BY: LENIN MANIEZHILAN(COGNIZANT) WR/IR#:INC1252497   * 01190400
011905*---------------------------------------------------------------* 01190501
011906* CHANGE LOG:                                                   * 01190601
011907*  DATE  09/07/2021                                              *01190701
011908*            - CHANGE CALL OF DPKUT100 TO                       * 01190801
011909*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 01190901
011910*              MAKING THE CALL DYNAMIC VS STATIC                * 01191001
011911*      MADE BY: GERMAN BANDA            WR/IR #: CHG0261091      *01191103
011912*                                                               * 01191201
011907*  DATE  01/05/2023                                              *01191304
011908*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               * 01191404
011911*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *01191704
011912*                                                               * 01191804
011913*---------------------------------------------------------------* 01191900
011914                                                                  01192000
011915 ENVIRONMENT DIVISION.                                            01192100
011916 DATA DIVISION.                                                   01192200
011917/                                                                 01192300
011918 WORKING-STORAGE SECTION.                                         01192400
011920                                                                  01192500
011930 01  DN-DB2-NULL-INDICATORS.                                      01193000
011940     05  DN-LEADTIME-DAYS-QTY         PIC S9(04) VALUE +0         01194000
011950                                                  COMP.           01195000
011960     05  DN-TKT-MKR-IND               PIC S9(04) VALUE +0         01196000
011970                                                  COMP.           01197000
011980     05  DN-BULK-STK-TKT-IND          PIC S9(04) VALUE +0         01198000
011990                                                  COMP.           01199000
012000     05  DN-DISCOUNT-PCT              PIC S9(04) VALUE +0         01200000
012100                                                  COMP.           01210000
012200     05  DN-EXT-PAY-DAYS-QTY          PIC S9(04) VALUE +0         01220000
012300                                                  COMP.           01230000
012400     05  DN-EXPIRATION-DATE           PIC S9(04) VALUE +0         01240000
012500                                                  COMP.           01250000
012600     05  DN-PARTIAL-IND               PIC S9(04) VALUE +0         01260000
012700                                                  COMP.           01270000
012800     05  DN-CHRG-PCT                  PIC S9(04) VALUE +0         01280000
012900                                                  COMP.           01290000
013000     05  DN-CHRG-AMT                  PIC S9(04) VALUE +0         01300000
013100                                                  COMP.           01310000
013200     05  DN-CHRG-FCTR-CDE             PIC S9(04) VALUE +0         01320000
013300                                                  COMP.           01330000
013400                                                                  01340000
013500 01  DK-DB2-KEYS.                                                 01350000
013600     05  DK-DEPT-NBR                  PIC  X(03) VALUE SPACES.    01360000
013700     05  DK-VEND-TYPE                 PIC  X(01) VALUE SPACE.     01370000
013800     05  DK-VEND-NAME                 PIC  X(30) VALUE SPACES.    01380000
013900     05  DK-DMA-NBR                   PIC  X(02) VALUE SPACES.    01390000
014000     05  DK-GMA-NBR                   PIC  X(02) VALUE SPACES.    01400000
014100     05  DK-INHOUSE-NUMBER            PIC S9(03) VALUE +0         01410000
014200                                                 COMP-3.          01420000
014300     05  DK-ENT-ID                    PIC S9(09) VALUE +0         01430000
014400                                                 COMP.            01440000
014500     05  DK-AGRMT-TYP-ID              PIC  X(01) VALUE SPACES.    01450000
014600     05  DK-TYPE-CDE                  PIC S9(04) VALUE +0         01460000
014700                                                 COMP.            01470000
014800                                                                  01480000
014900 01  PC-PROGRAM-CONSTANTS.                                        01490000
015000     05  PC-TRANS-ID                  PIC X(04)  VALUE 'V012'.    01500000
015100     05  PC-OPERATING-COMPANY         PIC X(02)  VALUE '03'.      01510000
015200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'VNKCS012'.01520000
015300     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'VN012A  '.01530000
015400     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'VNKM012 '.01540000
015500     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        01550000
015600                                                 COMP.            01560000
015700     05  PC-VNKCS023                  PIC X(08)  VALUE 'VNKCS023'.01570000
015800     05  PC-INTER-APPL-CODES.                                     01580000
015900         10  PC-INTER-APPL-CRIT-SPEC  PIC X(01)  VALUE '1'.       01590000
016000         10  PC-INTER-APPL-LIST       PIC X(01)  VALUE '2'.       01600000
016100                                                                  01610000
016200     05  PC-TSYMSG-NUMBERS.                                       01620000
016300         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01630000
016400         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01640000
016500         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01650000
016600         10  PC-TSYMSG-00014          PIC 9(05)  VALUE 00014.     01660000
016700         10  PC-TSYMSG-00046          PIC 9(05)  VALUE 00046.     01670000
016800         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01680000
016900         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01690000
017000         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01700000
017100         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01710000
017200         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01720000
017300         10  PC-TSYMSG-00174          PIC 9(05)  VALUE 00174.     01730000
017400         10  PC-TSYMSG-00308          PIC 9(05)  VALUE 00308.     01740000
017500         10  PC-TSYMSG-00984          PIC 9(05)  VALUE 00984.     01750000
017600         10  PC-TSYMSG-00635          PIC 9(05)  VALUE 00635.     01760000
017700         10  PC-TSYMSG-00636          PIC 9(05)  VALUE 00636.     01770000
017800         10  PC-TSYMSG-01318          PIC 9(05)  VALUE 01318.     01780000
017900         10  PC-TSYMSG-01375          PIC 9(05)  VALUE 01375.     01790000
018000         10  PC-TSYMSG-02521          PIC 9(05)  VALUE 02521.     01800000
018100         10  PC-TSYMSG-02522          PIC 9(05)  VALUE 02522.     01810000
018200         10  PC-TSYMSG-02523          PIC 9(05)  VALUE 02523.     01820000
018300         10  PC-TSYMSG-02524          PIC 9(05)  VALUE 02524.     01830000
018400         10  PC-TSYMSG-02525          PIC 9(05)  VALUE 02525.     01840000
018500         10  PC-TSYMSG-02526          PIC 9(05)  VALUE 02526.     01850000
018600         10  PC-TSYMSG-02585          PIC 9(05)  VALUE 02585.     01860000
018700         10  PC-TSYMSG-02586          PIC 9(05)  VALUE 02586.     01870000
018800         10  PC-TSYMSG-02587          PIC 9(05)  VALUE 02587.     01880000
018900         10  PC-TSYMSG-02645          PIC 9(05)  VALUE 02645.     01890000
019000         10  PC-TSYMSG-02646          PIC 9(05)  VALUE 02646.     01900000
019100         10  PC-TSYMSG-03380          PIC 9(05)  VALUE 03380.     01910000
019200         10  PC-TSYMSG-03381          PIC 9(05)  VALUE 03381.     01920000
019300         10  PC-TSYMSG-03474          PIC 9(05)  VALUE 03474.     01930000
019400         10  PC-TSYMSG-03475          PIC 9(05)  VALUE 03475.     01940000
019500         10  PC-TSYMSG-03476          PIC 9(05)  VALUE 03476.     01950000
019600         10  PC-TSYMSG-03477          PIC 9(05)  VALUE 03477.     01960000
019700         10  PC-TSYMSG-03478          PIC 9(05)  VALUE 03478.     01970000
019800         10  PC-TSYMSG-03479          PIC 9(05)  VALUE 03479.     01980000
019900         10  PC-TSYMSG-03557          PIC 9(05)  VALUE 03557.     01990000
020000         10  PC-TSYMSG-03558          PIC 9(05)  VALUE 03558.     02000000
020100         10  PC-TSYMSG-03559          PIC 9(05)  VALUE 03559.     02010000
020200         10  PC-TSYMSG-03732          PIC 9(05)  VALUE 03732.     02020000
020300         10  PC-TSYMSG-03733          PIC 9(05)  VALUE 03733.     02030000
020400                                                                  02040000
020500 01  PS-PROGRAM-SWITCHES.                                         02050000
020600     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       02060000
020700         88  PS-ERROR                            VALUE 'Y'.       02070000
020800         88  PS-NO-ERROR                         VALUE 'N'.       02080000
020900     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       02090000
021000         88  PS-LIST-END                         VALUE 'Y'.       02100000
021100         88  PS-NO-LIST-END                      VALUE 'N'.       02110000
021200     05  PS-EOF-SERVICE-CSR-SW        PIC X(01)  VALUE 'N'.       02120000
021300         88  PS-EOF-SERVICE-CSR                  VALUE 'Y'.       02130000
021400     05  PS-RMS-INTERFACE-SW          PIC X(01)  VALUE 'N'.       02140000
021500         88  PS-NO-RMS-INTERFACE-NEEDED          VALUE 'N'.       02150000
021600         88  PS-RMS-INTERFACE-NEEDED             VALUE 'Y'.       02160000
021700     05  PS-PRE-TICK-CHANGED-SW       PIC X(01)  VALUE 'N'.       02170000
021800         88  PS-PRE-TICK-NOT-CHANGED             VALUE 'N'.       02180000
021900         88  PS-PRE-TICK-CHANGED-TO-N            VALUE 'Y'.       02190000
022000                                                                  02200000
022100 01  PV-PROGRAM-VARIABLES.                                        02210000
022200     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         02220000
022300                                                 COMP SYNC.       02230000
022400     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         02240000
022500                                                 COMP SYNC.       02250000
022600     05  PV-INHOUSE-NBR-X.                                        02260000
022700         10  PV-INHOUSE-NBR           PIC  9(03) VALUE ZERO.      02270000
022800     05  PV-INHOUSE-NUMBER            PIC S9(03) VALUE +0         02280000
022900                                                 COMP-3.          02290000
023000     05  PV-DC-SPLIT-DAYS             PIC  X(04) VALUE SPACES.    02300000
023100     05  PV-PCT-FORMAT                PIC  Z9.99.                 02310000
023200     05  PV-EFFECTIVE-DATE            PIC  X(10).                 02320000
023300     05  PV-EFFECTIVE-DATE-RED REDEFINES PV-EFFECTIVE-DATE.       02330000
023400         10  PV-EFFECTIVE-CCYY        PIC  X(04).                 02340000
023500         10  FILLER                   PIC  X(01).                 02350000
023600         10  PV-EFFECTIVE-MM          PIC  X(02).                 02360000
023700         10  FILLER                   PIC  X(01).                 02370000
023800         10  PV-EFFECTIVE-DD          PIC  X(02).                 02380000
023900     05  PV-EFF-DATE                  PIC  X(10).                 02390000
024000     05  PV-EFF-DATE-RED REDEFINES PV-EFF-DATE.                   02400000
024100         10  PV-EFF-MM                PIC  X(02).                 02410000
024200         10  PV-EFF-SLASH1            PIC  X(01).                 02420000
024300         10  PV-EFF-DD                PIC  X(02).                 02430000
024400         10  PV-EFF-SLASH2            PIC  X(01).                 02440000
024500         10  PV-EFF-CCYY              PIC  X(04).                 02450000
024600     05  PV-TABLE-NAME                PIC  X(08) VALUE SPACES.    02460000
024700     05  PV-MAX-SEQ-NBR               PIC S9(04) VALUE +0         02470000
024800                                                 COMP.            02480000
024900     05  PV-NEXT-SEQ-NBR              PIC S9(04) VALUE +0         02490000
025000                                                 COMP.            02500000
025100     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         02510000
025200                                                 COMP.            02520000
025300                                                                  02530000
025400     05  PV-ERROR-MESSAGE-AREA.                                   02540000
025500         10  PV-ERROR-MSG-1.                                      02550000
025600             15  FILLER               PIC X(21)  VALUE            02560000
025700                 'UNSUCCESSFUL CALL TO '.                         02570000
025800             15  PV-ERROR-PGM-NAME    PIC X(08).                  02580000
025900             15  FILLER               PIC X(11)  VALUE            02590000
026000                 ' IN PARA:  '.                                   02600000
026100             15  PV-ERROR-PARA-NAME   PIC X(30).                  02610000
026200         10  PV-ERROR-MSG-2.                                      02620000
026300             15  PV-ERROR-MESSAGE     PIC X(57).                  02630000
026400         10  PV-ERROR-MSG-3.                                      02640000
026500             15  PV-ERROR-TYPE        PIC X(15).                  02650000
026600             15  PV-OPTIONAL-TEXT     PIC X(10).                  02660000
026700             15  PV-ERROR-REASON      PIC X(30).                  02670000
026800                                                                  02680000
026900/                                                                 02690000
027000*----------------------------------------------------------------*02700000
027100*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *02710000
027200*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *02720000
027300*----------------------------------------------------------------*02730000
027400                                                                  02740000
027500     COPY VNWS003.                                                02750000
027600/                                                                 02760000
027700                                                                  02770000
027800*----------------------------------------------------------------*02780000
027900*    MAP LAYOUT                                                  *02790000
028000*----------------------------------------------------------------*02800000
028100                                                                  02810000
028200     COPY VNKM012.                                                02820000
028300                                                                  02830000
028400/                                                                 02840000
028500*----------------------------------------------------------------*02850000
028600*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *02860000
028700*----------------------------------------------------------------*02870000
028800                                                                  02880000
028900     COPY DPWS003.                                                02890000
029000                                                                  02900000
029100*----------------------------------------------------------------*02910000
029200*    CICSAUTH PROCESSING COPYBOOK.                               *02920000
029300*----------------------------------------------------------------*02930000
029400                                                                  02940000
029500     COPY DPWS008.                                                02950000
029600                                                                  02960000
029700/                                                                 02970000
029800*----------------------------------------------------------------*02980000
029900*    ATTRIBUTE SETTINGS COPYBOOK.                                *02990000
030000*----------------------------------------------------------------*03000000
030100                                                                  03010000
030200     COPY DPWS015.                                                03020000
030300                                                                  03030000
030400/                                                                 03040000
030500*----------------------------------------------------------------*03050000
030600*    FUNCTION KEYS COPYBOOK                                      *03060000
030700*----------------------------------------------------------------*03070000
030800                                                                  03080000
030900     COPY DPWS016.                                                03090000
031000                                                                  03100000
031100/                                                                 03110000
031200*----------------------------------------------------------------*03120000
031300*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *03130000
031400*    SUB-ROUTINE (VNKUT100).                                     *03140000
031500*----------------------------------------------------------------*03150000
031600     COPY DPWS010I.                                               03160000
031700                                                                  03170000
031800/                                                                 03180000
031900*----------------------------------------------------------------*03190000
032000*    THE CALLING PARAMETER LIST (VNWS013) FOR THE RMS DATA       *03200000
032100*    BUILDER SUB-ROUTINE (VNKCS023)                              *03210000
032200*----------------------------------------------------------------*03220000
032300 01  VN013-COMMAREA.                                              03230000
032400     COPY VNWS013.                                                03240000
032500                                                                  03250000
032600/                                                                 03260000
032700*----------------------------------------------------------------*03270000
032800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API                *03280004
033000*----------------------------------------------------------------*03300000
033100     COPY DPWS030.                                                03310000
033100     COPY DPWS930.                                                03311004
033200                                                                  03320000
033300/                                                                 03330000
033400*----------------------------------------------------------------*03340000
033500*    STANDARD COMMAREA.                                          *03350000
033600*----------------------------------------------------------------*03360000
033700                                                                  03370000
033800     COPY DPWS020.                                                03380000
033900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03390000
034000                                                                  03400000
034100*----------------------------------------------------------------*03410000
034200*    INTER-APPLICATION COMMAREA.                                 *03420000
034300*----------------------------------------------------------------*03430000
034400                                                                  03440000
034500         10  INTER-APPL-COMM-AREA PIC X(200).                     03450000
034600     COPY VNWS001.                                                03460000
034700     COPY VNWS002.                                                03470000
034800*----------------------------------------------------------------*03480000
034900*    SPECIFIC COMMMAREA FOR VNKCS012.                            *03490000
035000*----------------------------------------------------------------*03500000
035100         10  ASC-SPECIFIC-COMMAREA.                               03510000
035200             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03520000
035300             15  ASC-USE-SELECTION-QUEUE-IND                      03530000
035400                                           PIC X(01).             03540000
035500                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        03550000
035600             15  ASC-SEL-QUEUE-NAME        PIC X(08).             03560000
035700             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     03570000
035800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03580000
035900                                           PIC S9(09) COMP-3.     03590000
036000             15  ASC-SEL-SUB               PIC S9(04) COMP.       03600000
036100             15  ASC-SEL-ITEM              PIC S9(04) COMP.       03610000
036200             15  ASC-PRE-FIELDS-CHANGED-SW PIC X(01).             03620000
036300                 88  ASC-PRE-FIELDS-CHANGED     VALUE 'Y'.        03630000
036400             15  ASC-SUP-FIELDS-CHANGED-SW PIC X(01).             03640000
036500                 88  ASC-SUP-FIELDS-CHANGED     VALUE 'Y'.        03650000
036600             15  ASC-SVC-FIELDS-CHANGED-SW PIC X(01).             03660000
036700                 88  ASC-SVC-FIELDS-CHANGED     VALUE 'Y'.        03670000
036800             15  ASC-INC-FIELDS-CHANGED-SW PIC X(01).             03680000
036900                 88  ASC-INC-FIELDS-CHANGED     VALUE 'Y'.        03690000
037000             15  ASC-KEY-FIELDS.                                  03700000
037100                 20  ASC-KEY-DEPT-NBR      PIC X(03).             03710000
037200                 20  ASC-KEY-INHOUSE-NBR   PIC 9(03).             03720000
037300                 20  ASC-KEY-ENT-ID        PIC S9(9) COMP.        03730000
037400             15  ASC-SCREEN-FIELDS.                               03740000
037500                 20  ASC-ENT-NAME-DESC      PIC X(30).            03750000
037600                 20  ASC-DUN-NBR            PIC X(09).            03760000
037700                 20  ASC-PRE-TICK-IND       PIC X(01).            03770000
037800                 20  ASC-PACK-BY-STORE-Y-N  PIC X(01).            03780000
037900                 20  ASC-HANGER-INSERT-Y-N  PIC X(01).            03790000
038000                 20  ASC-DRCT-SHP-IND       PIC X(01).            03800000
038100                 20  ASC-DRCT-SHP-PCT-SAVE  PIC X(05).            03810000
038200                 20  ASC-DRCT-SHP-PCT-ONE   PIC X(05).            03820000
038300                 20  ASC-DRCT-SHP-PCT-ONE-N REDEFINES             03830000
038400                     ASC-DRCT-SHP-PCT-ONE   PIC Z9.99.            03840000
038500                 20  ASC-DRCT-SHP-PCT       PIC X(05).            03850000
038600                 20  ASC-DRCT-SHP-PCT-N     PIC 9(2)V99.          03860000
038700                 20  ASC-DRCT-SHP-RATE-SAVE PIC X(07).            03870000
038800                 20  ASC-DRCT-SHP-RATE-ONE  PIC X(07).            03880000
038900                 20  ASC-DRCT-SHP-RATE-ONE-N REDEFINES            03890000
039000                     ASC-DRCT-SHP-RATE-ONE  PIC ZZZ9.99.          03900000
039100                 20  ASC-DRCT-SHP-RATE      PIC X(07).            03910000
039200                 20  ASC-DRCT-SHP-RATE-N    PIC 9(4)V99.          03920000
039300                 20  ASC-PRE-TICK-LEAD-TIME PIC X(03).            03930000
039400                 20  ASC-PRE-TICK-LEAD-TIME-N REDEFINES           03940000
039500                     ASC-PRE-TICK-LEAD-TIME PIC 9(03).            03950000
039600                 20  ASC-PRE-TICK-MAKER     PIC X(01).            03960000
039700                 20  ASC-PRE-TICK-BULK      PIC X(01).            03970000
039800                 20  ASC-SUPPLIES-UPC-Y-N   PIC X(01).            03980000
039900                 20  ASC-SUP-TICK-IND       PIC X(01).            03990000
040000                 20  ASC-NEW-STORE-DISC-IND PIC X(01).            04000000
040100                 20  ASC-NEW-STORE-DISC-SAVE PIC X(05).           04010000
040200                 20  ASC-NEW-STORE-DAYS-SAVE PIC X(03).           04020000
040300                 20  ASC-NEW-STORE-DISC-ONE PIC X(05).            04030000
040400                 20  ASC-NEW-STORE-DISC-ONE-N REDEFINES           04040000
040500                     ASC-NEW-STORE-DISC-ONE PIC Z9.99.            04050000
040600                 20  ASC-NEW-STORE-DAYS-ONE PIC X(03).            04060000
040700                 20  ASC-NEW-STORE-DAYS-ONE-N REDEFINES           04070000
040800                     ASC-NEW-STORE-DAYS-ONE PIC 9(03).            04080000
040900                 20  ASC-NEW-STORE-DISC     PIC X(05).            04090000
041000                 20  ASC-NEW-STORE-DISC-N   PIC 99V99.            04100000
041100                 20  ASC-NEW-STORE-DAYS     PIC X(03).            04110000
041200                 20  ASC-NEW-STORE-DAYS-N REDEFINES               04120000
041300                     ASC-NEW-STORE-DAYS     PIC 9(03).            04130000
041400                 20  ASC-SUP-TICK-LEAD-TIME PIC X(03).            04140000
041500                 20  ASC-SUP-TICK-LEAD-TIME-N REDEFINES           04150000
041600                     ASC-SUP-TICK-LEAD-TIME PIC 9(03).            04160000
041700                 20  ASC-MOS-DISC-IND       PIC X(01).            04170000
041800                 20  ASC-MOS-DISC-ONE       PIC X(05).            04180000
041900                 20  ASC-MOS-DISC-ONE-N REDEFINES                 04190000
042000                     ASC-MOS-DISC-ONE       PIC Z9.99.            04200000
042100                 20  ASC-MOS-DISC-SAVE      PIC X(05).            04210000
042200                 20  ASC-MOS-DISC           PIC X(05).            04220000
042300                 20  ASC-MOS-DISC-N         PIC 9(02)V99.         04230000
042400                 20  ASC-SUP-TICK-MAKER     PIC X(01).            04240000
042500                 20  ASC-TRADE-DISC-IND     PIC X(01).            04250000
042600                 20  ASC-TRADE-DISC-ONE     PIC X(05).            04260000
042700                 20  ASC-TRADE-DISC-ONE-N REDEFINES               04270000
042800                     ASC-TRADE-DISC-ONE     PIC Z9.99.            04280000
042900                 20  ASC-TRADE-DISC-SAVE    PIC X(05).            04290000
043000                 20  ASC-TRADE-DISC         PIC X(05).            04300000
043100                 20  ASC-TRADE-DISC-N       PIC 9(02)V99.         04310000
043200                 20  ASC-SUP-TICK-BULK      PIC X(01).            04320000
043300                 20  ASC-ADVTS-DISC-IND     PIC X(01).            04330000
043400                 20  ASC-ADVTS-DISC-ONE     PIC X(05).            04340000
043500                 20  ASC-ADVTS-DISC-ONE-N REDEFINES               04350000
043600                     ASC-ADVTS-DISC-ONE     PIC Z9.99.            04360000
043700                 20  ASC-ADVTS-DISC-SAVE    PIC X(05).            04370000
043800                 20  ASC-ADVTS-DISC         PIC X(05).            04380000
043900                 20  ASC-ADVTS-DISC-N       PIC 9(02)V99.         04390000
044000                 20  ASC-DC-SPLIT-IND       PIC X(01).            04400000
044100                 20  ASC-DC-SPLIT-DAYS      PIC 9(04).            04410000
044200                 20  ASC-STATUS-CDE         PIC X(01).            04420000
044300                 20  ASC-PRIM-TYP-CDE       PIC X(01).            04430000
044400                 20  ASC-VND-IN-RMS-IND     PIC X(01).            04440000
044500                 20  ASC-PO-PREPK-CDE       PIC X(01).            04450000
044600                 20  ASC-COOP-ALW-IND       PIC X(01).            04460000
044700                 20  ASC-COOP-ALW-SAVE      PIC X(05).            04470000
044800                 20  ASC-COOP-ALW-ONE       PIC X(05).            04480000
044900                 20  ASC-COOP-ALW-ONE-N REDEFINES                 04490000
045000                     ASC-COOP-ALW-ONE       PIC Z9.99.            04500000
045100                 20  ASC-COOP-ALW           PIC X(05).            04510000
045200                 20  ASC-COOP-ALW-N         PIC 99V99.            04520000
045300                 20  ASC-PROFIT-ALW-IND     PIC X(01).            04530000
045400                 20  ASC-PROFIT-ALW-SAVE    PIC X(05).            04540000
045500                 20  ASC-PROFIT-ALW-ONE     PIC X(05).            04550000
045600                 20  ASC-PROFIT-ALW-ONE-N REDEFINES               04560000
045700                     ASC-PROFIT-ALW-ONE     PIC Z9.99.            04570000
045800                 20  ASC-PROFIT-ALW         PIC X(05).            04580000
045900                 20  ASC-PROFIT-ALW-N       PIC 99V99.            04590000
046000                 20  ASC-TBL-TWR-IND        PIC X(01).            04600000
046100                 20  ASC-TBL-TWR-DAYS-SAVE  PIC X(03).            04610000
046200                 20  ASC-TBL-TWR-DAYS-ONE   PIC X(03).            04620000
046300                 20  ASC-TBL-TWR-DAYS-ONE-N REDEFINES             04630000
046400                     ASC-TBL-TWR-DAYS-ONE   PIC 9(03).            04640000
046500                 20  ASC-TBL-TWR-DAYS       PIC X(03).            04650000
046600                 20  ASC-TBL-TWR-DAYS-N REDEFINES                 04660000
046700                     ASC-TBL-TWR-DAYS       PIC 9(03).            04670000
046800                 20  ASC-NEW-STORE-EFFDATE  PIC X(10).            04680000
046900                 20  ASC-MOS-DISC-EFFDATE   PIC X(10).            04690000
047000                 20  ASC-TRADE-DISC-EFFDATE PIC X(10).            04700000
047100                 20  ASC-ADVTS-DISC-EFFDATE PIC X(10).            04710000
047200                 20  ASC-COOP-ALW-EFFDATE   PIC X(10).            04720000
047300                 20  ASC-PROFIT-ALW-EFFDATE PIC X(10).            04730000
047400                 20  ASC-TBL-TWR-EFFDATE    PIC X(10).            04740000
047500                 20  ASC-RFID-STATUS-N-T-C  PIC X(01).            04750000
047600             15  ASC-OLD-SCREEN-VALUES.                           04760000
047700                 20  ASC-PRE-TICK-IND-OLD   PIC X(01).            04770000
047800                 20  ASC-PACK-BY-STORE-Y-N-OLD  PIC X(01).        04780000
047900                 20  ASC-HANGER-INSERT-Y-N-OLD  PIC X(01).        04790000
048000                 20  ASC-DRCT-SHP-IND-OLD       PIC X(01).        04800000
048100                 20  ASC-DRCT-SHP-PCT-N-OLD     PIC 9(02)V99.     04810000
048200                 20  ASC-DRCT-SHP-PCT-OLD       PIC X(05).        04820000
048300                 20  ASC-DRCT-SHP-RATE-OLD      PIC X(07).        04830000
048400                 20  ASC-DRCT-SHP-RATE-N-OLD    PIC 9(04)V99.     04840000
048500                 20  ASC-PRE-TICK-LEAD-TIME-OLD PIC X(03).        04850000
048600                 20  ASC-PRE-TICK-LEAD-TIME-N-OLD REDEFINES       04860000
048700                     ASC-PRE-TICK-LEAD-TIME-OLD PIC 9(03).        04870000
048800                 20  ASC-PRE-TICK-MAKER-OLD     PIC X(01).        04880000
048900                 20  ASC-PRE-TICK-BULK-OLD      PIC X(01).        04890000
049000                 20  ASC-SUPPLIES-UPC-Y-N-OLD   PIC X(01).        04900000
049100                 20  ASC-SUP-TICK-IND-OLD       PIC X(01).        04910000
049200                 20  ASC-NEW-STORE-DISC-IND-OLD PIC X(01).        04920000
049300                 20  ASC-NEW-STORE-DISC-OLD     PIC X(05).        04930000
049400                 20  ASC-NEW-STORE-DISC-N-OLD   PIC 99V99.        04940000
049500                 20  ASC-NEW-STORE-DAYS-OLD     PIC X(03).        04950000
049600                 20  ASC-NEW-STORE-DAYS-N-OLD REDEFINES           04960000
049700                     ASC-NEW-STORE-DAYS-OLD     PIC 9(03).        04970000
049800                 20  ASC-SUP-TICK-LEAD-TIME-OLD PIC X(03).        04980000
049900                 20  ASC-SUP-TICK-LEAD-TIME-N-OLD REDEFINES       04990000
050000                     ASC-SUP-TICK-LEAD-TIME-OLD PIC 9(03).        05000000
050100                 20  ASC-MOS-DISC-IND-OLD       PIC X(01).        05010000
050200                 20  ASC-MOS-DISC-OLD           PIC X(05).        05020000
050300                 20  ASC-MOS-DISC-N-OLD         PIC 99V99.        05030000
050400                 20  ASC-SUP-TICK-MAKER-OLD     PIC X(01).        05040000
050500                 20  ASC-TRADE-DISC-IND-OLD     PIC X(01).        05050000
050600                 20  ASC-TRADE-DISC-OLD         PIC X(05).        05060000
050700                 20  ASC-TRADE-DISC-N-OLD       PIC 99V99.        05070000
050800                 20  ASC-SUP-TICK-BULK-OLD      PIC X(01).        05080000
050900                 20  ASC-ADVTS-DISC-IND-OLD     PIC X(01).        05090000
051000                 20  ASC-ADVTS-DISC-OLD         PIC X(05).        05100000
051100                 20  ASC-ADVTS-DISC-N-OLD       PIC 99V99.        05110000
051200                 20  ASC-DC-SPLIT-IND-OLD       PIC X(01).        05120000
051300                 20  ASC-DC-SPLIT-DAYS-OLD      PIC 9(04).        05130000
051400                 20  ASC-COOP-ALW-IND-OLD       PIC X(01).        05140000
051500                 20  ASC-COOP-ALW-OLD           PIC X(05).        05150000
051600                 20  ASC-COOP-ALW-N-OLD         PIC 99V99.        05160000
051700                 20  ASC-PROFIT-ALW-IND-OLD     PIC X(01).        05170000
051800                 20  ASC-PROFIT-ALW-OLD         PIC X(05).        05180000
051900                 20  ASC-PROFIT-ALW-N-OLD       PIC 99V99.        05190000
052000                 20  ASC-TBL-TWR-IND-OLD        PIC X(01).        05200000
052100                 20  ASC-TBL-TWR-DAYS-OLD       PIC X(03).        05210000
052200                 20  ASC-TBL-TWR-DAYS-N-OLD REDEFINES             05220000
052300                     ASC-TBL-TWR-DAYS-OLD       PIC 9(03).        05230000
052400                 20  ASC-RFID-STATUS-N-T-C-OLD  PIC X(01).        05240000
052500                                                                  05250000
052600/                                                                 05260000
052700*----------------------------------------------------------------*05270000
052800*    ABEND PROCESSING COPYBOOK.                                  *05280000
052900*----------------------------------------------------------------*05290000
053000                                                                  05300000
053100     COPY DPWS013.                                                05310000
053200/                                                                 05320000
053300                                                                  05330000
053400*----------------------------------------------------------------*05340000
053500*    DB2 SQL COMMUNICATION AREA                                   05350000
053600*----------------------------------------------------------------*05360000
053700     EXEC SQL                                                     05370000
053800          INCLUDE SQLCA                                           05380000
053900     END-EXEC.                                                    05390000
054000/                                                                 05400000
054100                                                                  05410000
054200*----------------------------------------------------------------*05420000
054300*    DB2 DCLGEN FOR VENDOR DEPARTMENT TABLE                       05430000
054400*----------------------------------------------------------------*05440000
054500     EXEC SQL                                                     05450000
054600          INCLUDE TVNDDPT                                         05460000
054700     END-EXEC.                                                    05470000
054800/                                                                 05480000
054900                                                                  05490000
055000*----------------------------------------------------------------*05500000
055100*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              05510000
055200*----------------------------------------------------------------*05520000
055300     EXEC SQL                                                     05530000
055400          INCLUDE TEXTENT                                         05540000
055500     END-EXEC.                                                    05550000
055600/                                                                 05560000
055700                                                                  05570000
055800*----------------------------------------------------------------*05580000
055900*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE         05590000
056000*----------------------------------------------------------------*05600000
056100     EXEC SQL                                                     05610000
056200          INCLUDE TENTNME                                         05620000
056300     END-EXEC.                                                    05630000
056400/                                                                 05640000
056500                                                                  05650000
056600*----------------------------------------------------------------*05660000
056700*    DB2 DCLGEN FOR VENDOR AGREEMENT TABLE                        05670000
056800*----------------------------------------------------------------*05680000
056900     EXEC SQL                                                     05690000
057000          INCLUDE TVNDAGR                                         05700000
057100     END-EXEC.                                                    05710000
057200/                                                                 05720000
057300                                                                  05730000
057400*----------------------------------------------------------------*05740000
057500*    DB2 DCLGEN FOR SERVICE TYPE TABLE                            05750000
057600*----------------------------------------------------------------*05760000
057700     EXEC SQL                                                     05770000
057800          INCLUDE TSERTYP                                         05780000
057900     END-EXEC.                                                    05790000
058000                                                                  05800000
058100/                                                                 05810000
058200*----------------------------------------------------------------*05820000
058300*    DB2 DCLGEN FOR PROGRAM TYPE TABLE                            05830000
058400*----------------------------------------------------------------*05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE TPGMTYP                                         05860000
058700     END-EXEC.                                                    05870000
058800                                                                  05880000
058900/                                                                 05890000
059000*----------------------------------------------------------------*05900000
059100*    DB2 DCLGEN FOR INCENTIVES TYPE TABLE                         05910000
059200*----------------------------------------------------------------*05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE TINCTYP                                         05940000
059500     END-EXEC.                                                    05950000
059600/                                                                 05960000
059700/                                                                 05970000
059800*---------------------------------------------------------------* 05980000
059900*  CURSOR TO SELECT SERVICES/PROGRAMS/INCENTIVES FOR A DEPT     * 05990000
060000*---------------------------------------------------------------* 06000000
060100                                                                  06010000
060200     EXEC SQL                                                     06020000
060300         DECLARE SERVICE-CSR CURSOR FOR                           06030000
060400             SELECT 'TSERTYP'                                     06040000
060500                   ,B.SERVICE_ID                                  06050000
060600                   ,.0000                                         06060000
060700                   ,0000                                          06070000
060800                   ,A.EFFECTIVE_DATE                              06080000
060900                   ,A.CHRG_PCT                                    06090000
061000                   ,A.CHRG_AMT                                    06100000
061100             FROM TVNDAGR A                                       06110000
061200                 ,TSERTYP B                                       06120000
061300             WHERE A.DEPT_NBR          = :DK-DEPT-NBR             06130000
061400               AND A.ENT_ID            = :DK-ENT-ID               06140000
061500               AND A.AGRMT_TYP_ID      = '4'                      06150000
061600               AND A.EFFECTIVE_DATE   <= CURRENT DATE             06160000
061700               AND A.EXPIRATION_DATE  >  CURRENT DATE             06170000
061800               AND A.TYP_CDE           = B.SERVICE_ID             06180000
061900         UNION                                                    06190000
062000             SELECT 'TPGMTYP'                                     06200000
062100                   ,D.PROGRAM_ID                                  06210000
062200                   ,.0000                                         06220000
062300                   ,C.LEADTIME_DAYS_QTY                           06230000
062400                   ,C.EFFECTIVE_DATE                              06240000
062500                   ,.0000                                         06250000
062600                   ,0000                                          06260000
062700             FROM TVNDAGR C                                       06270000
062800                 ,TPGMTYP D                                       06280000
062900             WHERE C.DEPT_NBR          = :DK-DEPT-NBR             06290000
063000               AND C.ENT_ID            = :DK-ENT-ID               06300000
063100               AND C.AGRMT_TYP_ID      = '6'                      06310000
063200               AND C.EFFECTIVE_DATE   <= CURRENT DATE             06320000
063300               AND C.EXPIRATION_DATE  >  CURRENT DATE             06330000
063400               AND C.TYP_CDE           = D.PROGRAM_ID             06340000
063500         UNION                                                    06350000
063600             SELECT 'TINCTYP'                                     06360000
063700                   ,F.INCENTIVE_ID                                06370000
063800                   ,E.DISCOUNT_PCT                                06380000
063900                   ,E.EXT_PAY_DAYS_QTY                            06390000
064000                   ,E.EFFECTIVE_DATE                              06400000
064100                   ,.0000                                         06410000
064200                   ,0000                                          06420000
064300             FROM TVNDAGR E                                       06430000
064400                 ,TINCTYP F                                       06440000
064500             WHERE E.DEPT_NBR          = :DK-DEPT-NBR             06450000
064600               AND E.ENT_ID            = :DK-ENT-ID               06460000
064700               AND E.AGRMT_TYP_ID      = '5'                      06470000
064800               AND E.EFFECTIVE_DATE   <= CURRENT DATE             06480000
064900               AND E.EXPIRATION_DATE  >  CURRENT DATE             06490000
065000               AND E.TYP_CDE           = F.INCENTIVE_ID           06500000
065100             ORDER BY 1,2                                         06510000
065200             OPTIMIZE FOR 15 ROWS                                 06520000
065300     END-EXEC.                                                    06530000
065400                                                                  06540000
065500/                                                                 06550000
065600 LINKAGE SECTION.                                                 06560000
065700                                                                  06570000
065800 01  DFHCOMMAREA.                                                 06580000
065900     05  FILLER                       OCCURS  1 TO 4072 TIMES     06590000
066000                                      DEPENDING ON EIBCALEN.      06600000
066100         10  FILLER                   PIC X.                      06610000
066200                                                                  06620000
066300/                                                                 06630000
066400 PROCEDURE DIVISION.                                              06640000
066500                                                                  06650000
066600*----------------------------------------------------------------*06660000
066700*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *06670000
066800*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *06680000
066900*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *06690000
067000*                                                                *06700000
067100*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *06710000
067200*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *06720000
067300*----------------------------------------------------------------*06730000
067400 0000-MAIN-MODULE.                                                06740000
067500                                                                  06750000
067600     INITIALIZE DP030-CICS-API-FIELDS.                            06760000
067700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06770000
067800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06780000
067900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06790000
068000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06800000
068100     MOVE LENGTH OF VN012AI        TO DP030-MAP-LENGTH (1).       06810000
068200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06820000
068300     PERFORM 0001-CALL-CICS-ARCH-API.                             06830000
068400                                                                  06840000
068500     PERFORM 1000-CONTROL-PROCESSING.                             06850000
068600                                                                  06860000
068700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06870000
068800     PERFORM 0001-CALL-CICS-ARCH-API.                             06880000
068900                                                                  06890000
069000/                                                                 06900000
069100 0001-CALL-CICS-ARCH-API.                                         06910000
069200                                                                  06920000
069300*    CALL 'DPKCS030' USING DFHEIBLK                               06930004
069300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06931005
069400                           DFHCOMMAREA                            06940000
069500                           DP030-CICS-API-FIELDS                  06950000
069600                           DP020-STANDARD-COMMAREA                06960000
069700                           VN012AI.                               06970000
069800                                                                  06980000
069900     IF  DP030-RC-CALL-SUCCESSFUL                                 06990000
070000         CONTINUE                                                 07000000
070100     ELSE                                                         07010000
070200         SET DP013-NO-ROLLBACK                                    07020000
070300             DP013-XCTL-DISPLAY-RESTART                           07030000
070400             DP013-CICS-ABEND      TO TRUE                        07040000
070500         MOVE 'BEFORE 0000-MAIN-MODULE'                           07050000
070600                                   TO DP013-PARAGRAPH             07060000
070700*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07070004
070800*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07080004
070700         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07081004
070800-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07082004
070900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07090000
071000         PERFORM DP013-0000-PROCESS-ABEND                         07100000
071100     END-IF.                                                      07110000
071200                                                                  07120000
071300/                                                                 07130000
071400*----------------------------------------------------------------*07140000
071500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07150000
071600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07160000
071700*----------------------------------------------------------------*07170000
071800                                                                  07180000
071900 1000-CONTROL-PROCESSING.                                         07190000
072000                                                                  07200000
072100     EVALUATE TRUE                                                07210000
072200         WHEN DP020-NEXT-ACT-INITIAL                              07220000
072300              PERFORM 1100-PROCESS-INTER-APPL-COMM                07230000
072400              IF  PS-ERROR                                        07240000
072500                  CONTINUE                                        07250000
072600              ELSE                                                07260000
072700                  PERFORM 4000-BUILD-INITIAL-PANEL                07270000
072800                  PERFORM 3200-RESET-ATTRIBUTES                   07280000
072900                  PERFORM 3500-SAVE-SCREEN-FIELDS                 07290000
073000              END-IF                                              07300000
073100                                                                  07310000
073200         WHEN DP020-NEXT-ACT-READ-MAP                             07320000
073300              PERFORM 2000-PROCESS-PANEL                          07330000
073400                                                                  07340000
073500         WHEN DP020-NEXT-ACT-RETURN                               07350000
073600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07360000
073700              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07370000
073800                                                                  07380000
073900         WHEN OTHER                                               07390000
074000              SET DP013-LOGIC-ABEND                               07400000
074100                  DP013-NO-ROLLBACK TO TRUE                       07410000
074200              MOVE '1000-CONTROL-PROCESSING'                      07420000
074300                                    TO DP013-PARAGRAPH            07430000
074400              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  07440000
074500                                    TO DP013-MESSAGE-TEXT(1)      07450000
074600              MOVE DP020-NEXT-APPL-ACTIVITY                       07460000
074700                                    TO DP013-MESSAGE-TEXT(2)      07470000
074800              PERFORM DP013-0000-PROCESS-ABEND                    07480000
074900     END-EVALUATE.                                                07490000
075000                                                                  07500000
075100/                                                                 07510000
075200*----------------------------------------------------------------*07520000
075300*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *07530000
075400*    INTER-APPLICATION FORMAT CODE.                              *07540000
075500*----------------------------------------------------------------*07550000
075600 1100-PROCESS-INTER-APPL-COMM.                                    07560000
075700                                                                  07570000
075800     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07580000
075900     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   07590000
076000                                                                  07600000
076100     EVALUATE DP020-INT-APPL-FORMAT-IND                           07610000
076200         WHEN PC-INTER-APPL-CRIT-SPEC                             07620000
076300              MOVE VN001-DEPARTMENT-NUMBER TO DK-DEPT-NBR         07630000
076400                                              ASC-KEY-DEPT-NBR    07640000
076500              MOVE VN001-VENDOR-TYPE       TO DK-VEND-TYPE        07650000
076600              MOVE VN001-VENDOR-NAME       TO DK-VEND-NAME        07660000
076700              MOVE VN001-INHOUSE-NUMBER    TO PV-INHOUSE-NBR-X    07670000
076800              MOVE PV-INHOUSE-NBR          TO DK-INHOUSE-NUMBER   07680000
076900                                              ASC-KEY-INHOUSE-NBR 07690000
077000                                                                  07700000
077100              IF DK-VEND-TYPE = 'E'                               07710000
077200                  PERFORM 1111-GET-ENTERPRISE-ID                  07720000
077300              ELSE                                                07730000
077400                  PERFORM 1110-GET-ENTERPRISE-ID                  07740000
077500              END-IF                                              07750000
077600                                                                  07760000
077700         WHEN PC-INTER-APPL-LIST                                  07770000
077800              IF VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            07780000
077900                  SET DP030-OVERRIDE-GO                           07790000
078000                      DP020-MSG-WARNING                           07800000
078100                      DP020-NEXT-ACT-APPL-ERROR TO TRUE           07810000
078200                  MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER        07820000
078300              ELSE                                                07830000
078400                  SET ASC-USE-SELECTION-QUEUE TO TRUE             07840000
078500                  MOVE VN002-NUMBER-OF-SELECTED-ITEMS             07850000
078600                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07860000
078700                  MOVE VN002-NUMBER-OF-TS-ITEMS                   07870000
078800                                   TO ASC-NUMBER-OF-TS-ITEMS      07880000
078900                  MOVE VN002-SEL-QUEUE-NAME                       07890000
079000                                   TO ASC-SEL-QUEUE-NAME          07900000
079100                  PERFORM 1120-PREPARE-LIST-ENTRY                 07910000
079200                                                                  07920000
079300             END-IF                                               07930000
079400                                                                  07940000
079500         WHEN OTHER                                               07950000
079600              MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER            07960000
079700              SET  DP020-MSG-FATAL                                07970000
079800                   DP020-NEXT-ACT-APPL-ERROR TO TRUE              07980000
079900     END-EVALUATE.                                                07990000
080000                                                                  08000000
080100 1110-GET-ENTERPRISE-ID.                                          08010000
080200                                                                  08020000
080300     PERFORM                                                      08030000
080400         WITH TEST AFTER                                          08040000
080500         VARYING PV-RETRY-COUNTER                                 08050000
080600         FROM 1 BY 1                                              08060000
080700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08070000
080800             OR (SQLCODE = +0)                                    08080000
080900             OR (SQLCODE = +100))                                 08090000
081000                                                                  08100000
081100         EXEC SQL                                                 08110000
081200              SELECT ENT_ID                                       08120000
081300                INTO :VNDDPT-ENT-ID                               08130000
081400                FROM TVNDDPT                                      08140000
081500               WHERE DEPT_NBR    = :DK-DEPT-NBR                   08150000
081600                 AND INHOUSE_NBR = :DK-INHOUSE-NUMBER             08160000
081700         END-EXEC                                                 08170000
081800                                                                  08180000
081900         EVALUATE TRUE                                            08190000
082000             WHEN SQLCODE = +0                                    08200000
082100                  MOVE VNDDPT-ENT-ID TO ASC-KEY-ENT-ID            08210000
082200                                        DK-ENT-ID                 08220000
082300                                                                  08230000
082400             WHEN SQLCODE = +100                                  08240000
082500                  SET PS-ERROR                                    08250000
082600                      DP020-MSG-FATAL                             08260000
082700                      DP020-NEXT-ACT-APPL-ERROR                   08270000
082800                                     TO TRUE                      08280000
082900                  MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER        08290000
083000                                                                  08300000
083100             WHEN SQLCODE = -904                                  08310000
083200             WHEN SQLCODE = -913                                  08320000
083300                  CONTINUE                                        08330000
083400                                                                  08340000
083500             WHEN SQLWARN0 NOT = SPACES                           08350000
083600             WHEN SQLCODE < +0                                    08360000
083700             WHEN SQLCODE > +0                                    08370000
083800                  MOVE '1110-GET-ENTERPRISE-ID'                   08380000
083900                                  TO DP013-PARAGRAPH              08390000
084000                  MOVE 'UNSUCCESSFUL SELECT ENTERPRIS ID'         08400000
084100                                  TO DP013-MESSAGE-TEXT (1)       08410000
084200                  MOVE SQLCA      TO DP013-SQLCA                  08420000
084300                  MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)     08430000
084400                  SET DP013-DB2-ABEND                             08440000
084500                      DP013-XCTL-DISPLAY-RESTART                  08450000
084600                                  TO TRUE                         08460000
084700                  PERFORM DP013-0000-PROCESS-ABEND                08470000
084800         END-EVALUATE                                             08480000
084900     END-PERFORM.                                                 08490000
085000                                                                  08500000
085100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        08510000
085200         MOVE '1110-GET-ENTERPRISE-ID'                            08520000
085300                                  TO DP013-PARAGRAPH              08530000
085400         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE ID'      08540000
085500                                  TO DP013-MESSAGE-TEXT (1)       08550000
085600         MOVE SQLCA               TO DP013-SQLCA                  08560000
085700         MOVE 'TVNDDPT '          TO DP013-DB2-TABLE-NAME (1)     08570000
085800         SET DP013-DB2-ABEND                                      08580000
085900             DP013-XCTL-DISPLAY-RESTART                           08590000
086000                                  TO TRUE                         08600000
086100         PERFORM DP013-0000-PROCESS-ABEND                         08610000
086200     END-IF.                                                      08620000
086300                                                                  08630000
086400 1111-GET-ENTERPRISE-ID.                                          08640000
086500                                                                  08650000
086600     PERFORM                                                      08660000
086700         WITH TEST AFTER                                          08670000
086800         VARYING PV-RETRY-COUNTER                                 08680000
086900         FROM 1 BY 1                                              08690000
087000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08700000
087100             OR (SQLCODE = +0)                                    08710000
087200             OR (SQLCODE = +100))                                 08720000
087300                                                                  08730000
087400         EXEC SQL                                                 08740000
087500              SELECT A.ENT_ID                                     08750000
087600                INTO :VNDDPT-ENT-ID                               08760000
087700                FROM TVNDDPT A                                    08770000
087800                    ,TENTNME B                                    08780000
087900               WHERE A.DEPT_NBR      = :DK-DEPT-NBR               08790000
088000                 AND B.ENT_ID        = A.ENT_ID                   08800000
088100                 AND B.ENT_NAME_DESC = :DK-VEND-NAME              08810000
088200                 AND B.TYPE_CDE      = '01'                       08820000
088300         END-EXEC                                                 08830000
088400                                                                  08840000
088500         EVALUATE TRUE                                            08850000
088600             WHEN SQLCODE = +0                                    08860000
088700                  MOVE VNDDPT-ENT-ID TO ASC-KEY-ENT-ID            08870000
088800                                        DK-ENT-ID                 08880000
088900                                                                  08890000
089000             WHEN SQLCODE = +100                                  08900000
089100                  SET PS-ERROR                                    08910000
089200                      DP020-MSG-FATAL                             08920000
089300                      DP020-NEXT-ACT-APPL-ERROR                   08930000
089400                                     TO TRUE                      08940000
089500                  MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER        08950000
089600                                                                  08960000
089700             WHEN SQLCODE = -904                                  08970000
089800             WHEN SQLCODE = -913                                  08980000
089900                  CONTINUE                                        08990000
090000                                                                  09000000
090100             WHEN SQLWARN0 NOT = SPACES                           09010000
090200             WHEN SQLCODE < +0                                    09020000
090300             WHEN SQLCODE > +0                                    09030000
090400                  MOVE '1111-GET-ENTERPRISE-ID'                   09040000
090500                                  TO DP013-PARAGRAPH              09050000
090600                  MOVE 'UNSUCCESSFUL SELECT ENTERPRIS ID'         09060000
090700                                  TO DP013-MESSAGE-TEXT (1)       09070000
090800                  MOVE SQLCA      TO DP013-SQLCA                  09080000
090900                  MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)     09090000
091000                  SET DP013-DB2-ABEND                             09100000
091100                      DP013-XCTL-DISPLAY-RESTART                  09110000
091200                                  TO TRUE                         09120000
091300                  PERFORM DP013-0000-PROCESS-ABEND                09130000
091400         END-EVALUATE                                             09140000
091500     END-PERFORM.                                                 09150000
091600                                                                  09160000
091700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09170000
091800         MOVE '1111-GET-ENTERPRISE-ID'                            09180000
091900                                  TO DP013-PARAGRAPH              09190000
092000         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE ID'      09200000
092100                                  TO DP013-MESSAGE-TEXT (1)       09210000
092200         MOVE SQLCA               TO DP013-SQLCA                  09220000
092300         MOVE 'TVNDDPT '          TO DP013-DB2-TABLE-NAME (1)     09230000
092400         SET DP013-DB2-ABEND                                      09240000
092500             DP013-XCTL-DISPLAY-RESTART                           09250000
092600                                  TO TRUE                         09260000
092700         PERFORM DP013-0000-PROCESS-ABEND                         09270000
092800     END-IF.                                                      09280000
092900                                                                  09290000
093000*----------------------------------------------------------------*09300000
093100*    ENTRY IS FROM A LIST.  GET THE VENDOR NUMBER FROM THE       *09310000
093200*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *09320000
093300*----------------------------------------------------------------*09330000
093400 1120-PREPARE-LIST-ENTRY.                                         09340000
093500                                                                  09350000
093600     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                09360000
093700     MOVE ZERO                     TO ASC-SEL-ITEM.               09370000
093800     PERFORM 2110-GET-NEXT-VENDOR.                                09380000
093900                                                                  09390000
094000/                                                                 09400000
094100*----------------------------------------------------------------*09410000
094200*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*09420000
094300*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*09430000
094400*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *09440000
094500*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *09450000
094600*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *09460000
094700*----------------------------------------------------------------*09470000
094800                                                                  09480000
094900 2000-PROCESS-PANEL.                                              09490000
095000                                                                  09500000
095100     EVALUATE TRUE                                                09510000
095200                                                                  09520000
095300         WHEN DP020-SRC-AID = DP016-CLEAR                         09530000
095400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09540000
095500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09550000
095600                                                                  09560000
095700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     09570000
095800             INITIALIZE ASC-SCREEN-FIELDS                         09580000
095900             MOVE ASC-KEY-DEPT-NBR TO DK-DEPT-NBR                 09590000
096000             MOVE ASC-KEY-INHOUSE-NBR                             09600000
096100                                   TO DK-INHOUSE-NUMBER           09610000
096200             MOVE ASC-KEY-ENT-ID   TO DK-ENT-ID                   09620000
096300             PERFORM 4000-BUILD-INITIAL-PANEL                     09630000
096400             PERFORM 3200-RESET-ATTRIBUTES                        09640000
096500             PERFORM 3500-SAVE-SCREEN-FIELDS                      09650000
096600                                                                  09660000
096700                                                                  09670000
096800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09680000
096900             IF  ASC-USE-SELECTION-QUEUE                          09690000
097000                 PERFORM 2110-GET-NEXT-VENDOR                     09700000
097100                 IF PS-LIST-END                                   09710000
097200                    SET PS-NO-LIST-END                            09720000
097300                                   TO TRUE                        09730000
097400                 ELSE                                             09740000
097500                    PERFORM 4000-BUILD-INITIAL-PANEL              09750000
097600                    PERFORM 3200-RESET-ATTRIBUTES                 09760000
097700                    PERFORM 3500-SAVE-SCREEN-FIELDS               09770000
097800                 END-IF                                           09780000
097900             ELSE                                                 09790000
098000*                --- BOTTOM OF LIST ---                           09800000
098100                 MOVE PC-TSYMSG-00070                             09810000
098200                                   TO DP020-MSG-NUMBER            09820000
098300                 SET DP020-MSG-INFORMATIONAL                      09830000
098400                     PS-LIST-END   TO TRUE                        09840000
098500             END-IF                                               09850000
098600                                                                  09860000
098700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09870000
098800             IF  ASC-USE-SELECTION-QUEUE                          09880000
098900                 PERFORM 2120-GET-PREV-VENDOR                     09890000
099000                 IF PS-LIST-END                                   09900000
099100                    SET PS-NO-LIST-END                            09910000
099200                                   TO TRUE                        09920000
099300                 ELSE                                             09930000
099400                    PERFORM 4000-BUILD-INITIAL-PANEL              09940000
099500                    PERFORM 3200-RESET-ATTRIBUTES                 09950000
099600                    PERFORM 3500-SAVE-SCREEN-FIELDS               09960000
099700                 END-IF                                           09970000
099800             ELSE                                                 09980000
099900*                --- TOP OF LIST ---                              09990000
100000                 MOVE PC-TSYMSG-00069                             10000000
100100                                   TO DP020-MSG-NUMBER            10010000
100200                 SET DP020-MSG-INFORMATIONAL                      10020000
100300                     PS-LIST-END   TO TRUE                        10030000
100400             END-IF                                               10040000
100500                                                                  10050000
100600         WHEN OTHER                                               10060000
100700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10070000
100800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10080000
100900             IF  PS-NO-ERROR                                      10090000
101000                 SET DP030-CONTINUE-GO                            10100000
101100                                   TO TRUE                        10110000
101200                 PERFORM 2100-CHECK-FUNCTION-KEY                  10120000
101300             ELSE                                                 10130000
101400                 SET DP030-OVERRIDE-GO                            10140000
101500                                   TO TRUE                        10150000
101600             END-IF                                               10160000
101700     END-EVALUATE.                                                10170000
101800                                                                  10180000
101900/                                                                 10190000
102000*----------------------------------------------------------------*10200000
102100*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *10210000
102200*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*10220000
102300*    FROM THE CICS ARCHITECTURE API.                             *10230000
102400*----------------------------------------------------------------*10240000
102500                                                                  10250000
102600 2100-CHECK-FUNCTION-KEY.                                         10260000
102700                                                                  10270000
102800     EVALUATE TRUE                                                10280000
102900         WHEN DP020-SRC-AID = DP016-ENTER                         10290000
103000             CONTINUE                                             10300000
103100                                                                  10310000
103200         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  10320000
103300             MOVE ASC-KEY-DEPT-NBR TO VN001-DEPARTMENT-NUMBER     10330000
103400             MOVE ASC-KEY-INHOUSE-NBR                             10340000
103500                                   TO VN001-INHOUSE-NUMBER        10350000
103600             MOVE ASC-ENT-NAME-DESC                               10360000
103700                                   TO VN001-VENDOR-NAME           10370000
103800             MOVE ASC-DUN-NBR      TO VN001-DUNS-NUMBER           10380000
103900                                                                  10390000
104000         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               10400000
104100             PERFORM 3600-CHECK-IF-FIELDS-CHANGED                 10410000
104200             IF  ASC-PRE-FIELDS-CHANGED                           10420000
104300             OR  ASC-SUP-FIELDS-CHANGED                           10430000
104400             OR  ASC-SVC-FIELDS-CHANGED                           10440000
104500             OR  ASC-INC-FIELDS-CHANGED                           10450000
104600                 SET DP030-CONTINUE-GO                            10460000
104700                                   TO TRUE                        10470000
104800                 PERFORM 5000-UPDATE-PROCESSING                   10480000
104900                 IF PS-RMS-INTERFACE-NEEDED                       10490000
105000                     PERFORM 5500-INTERFACE-TO-RMS                10500000
105100                 END-IF                                           10510000
105200             ELSE                                                 10520000
105300                 MOVE PC-TSYMSG-00046                             10530000
105400                                   TO DP020-MSG-NUMBER            10540000
105500                 SET DP020-MSG-INFORMATIONAL                      10550000
105600                                   TO TRUE                        10560000
105700             END-IF                                               10570000
105800                                                                  10580000
105900         WHEN OTHER                                               10590000
106000             SET DP013-NO-ROLLBACK                                10600000
106100                 DP013-XCTL-DISPLAY-RESTART                       10610000
106200                 DP013-CICS-ABEND  TO TRUE                        10620000
106300             MOVE '2100-CHECK-FUNCTION-KEY'                       10630000
106400                                   TO DP013-PARAGRAPH             10640000
106500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10650000
106600                                   TO DP013-MESSAGE-TEXT (1)      10660000
106700             PERFORM DP013-0000-PROCESS-ABEND                     10670000
106800     END-EVALUATE.                                                10680000
106900                                                                  10690000
107000/                                                                 10700000
107100*----------------------------------------------------------------*10710000
107200*    GET THE VENDOR NUMBER (KEY) OF THE NEXT SELECTED OBJECT     *10720000
107300*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *10730000
107400*----------------------------------------------------------------*10740000
107500 2110-GET-NEXT-VENDOR.                                            10750000
107600                                                                  10760000
107700     ADD +1                        TO ASC-SEL-SUB.                10770000
107800     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            10780000
107900         ADD +1                    TO ASC-SEL-ITEM                10790000
108000         MOVE +1                   TO ASC-SEL-SUB                 10800000
108100     END-IF.                                                      10810000
108200                                                                  10820000
108300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10830000
108400         PERFORM 9100-READ-SEL-QUEUE                              10840000
108500         IF  VN003-ITEM (ASC-SEL-SUB) > ZERO                      10850000
108600             INITIALIZE ASC-SCREEN-FIELDS                         10860000
108700             MOVE VN003-VEND-TYPE (ASC-SEL-SUB)                   10870000
108800                                   TO DK-VEND-TYPE                10880000
108900             MOVE VN003-DEPARTMENT (ASC-SEL-SUB)                  10890000
109000                                   TO ASC-KEY-DEPT-NBR            10900000
109100                                      DK-DEPT-NBR                 10910000
109200             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      10920000
109300                                   TO ASC-KEY-ENT-ID              10930000
109400                                      DK-ENT-ID                   10940000
109500             SET VN003-INQ (ASC-SEL-SUB)                          10950000
109600                                   TO TRUE                        10960000
109700             PERFORM 9200-REWRITE-SEL-QUEUE                       10970000
109800         ELSE                                                     10980000
109900             SUBTRACT +1 FROM ASC-SEL-SUB                         10990000
110000*            --- BOTTOM OF LIST ---                               11000000
110100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11010000
110200             SET DP020-MSG-INFORMATIONAL                          11020000
110300                 PS-LIST-END                                      11030000
110400                                   TO TRUE                        11040000
110500         END-IF                                                   11050000
110600     ELSE                                                         11060000
110700         SUBTRACT +1 FROM ASC-SEL-ITEM                            11070000
110800         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 11080000
110900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11090000
111000         SET DP020-MSG-INFORMATIONAL                              11100000
111100             PS-LIST-END                                          11110000
111200                                   TO TRUE                        11120000
111300     END-IF.                                                      11130000
111400                                                                  11140000
111500/                                                                 11150000
111600*----------------------------------------------------------------*11160000
111700*    GET THE VENDOR NUMBER (KEY) OF THE PREVIOUS SELECTED        *11170000
111800*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *11180000
111900*----------------------------------------------------------------*11190000
112000 2120-GET-PREV-VENDOR.                                            11200000
112100                                                                  11210000
112200     SUBTRACT +1 FROM ASC-SEL-SUB.                                11220000
112300     IF  ASC-SEL-SUB < +1                                         11230000
112400         SUBTRACT +1 FROM ASC-SEL-ITEM                            11240000
112500         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 11250000
112600     END-IF.                                                      11260000
112700                                                                  11270000
112800     IF  ASC-SEL-ITEM > ZERO                                      11280000
112900         PERFORM 9100-READ-SEL-QUEUE                              11290000
113000         INITIALIZE ASC-SCREEN-FIELDS                             11300000
113100         MOVE VN003-DEPARTMENT (ASC-SEL-SUB)                      11310000
113200                                   TO ASC-KEY-DEPT-NBR            11320000
113300                                      DK-DEPT-NBR                 11330000
113400         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          11340000
113500                                   TO ASC-KEY-ENT-ID              11350000
113600                                      DK-ENT-ID                   11360000
113700     ELSE                                                         11370000
113800         MOVE +1                   TO ASC-SEL-ITEM                11380000
113900                                      ASC-SEL-SUB                 11390000
114000*        --- TOP OF LIST ---                                      11400000
114100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11410000
114200         SET DP020-MSG-INFORMATIONAL                              11420000
114300             PS-LIST-END           TO TRUE                        11430000
114400     END-IF.                                                      11440000
114500                                                                  11450000
114600/                                                                 11460000
114700*----------------------------------------------------------------*11470000
114800*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *11480000
114900*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *11490000
115000*----------------------------------------------------------------*11500000
115100 2200-MOVE-SCREEN-TO-COMMAREA.                                    11510000
115200                                                                  11520000
115300     IF  ATKIND1L > ZERO                                          11530000
115400         MOVE ATKIND1I             TO ASC-PRE-TICK-IND            11540000
115500     ELSE                                                         11550000
115600         IF  ATKIND1F = DP015-ERASE-EOF                           11560000
115700             MOVE SPACES           TO ASC-PRE-TICK-IND            11570000
115800         END-IF                                                   11580000
115900     END-IF.                                                      11590000
116000                                                                  11600000
116100     IF  ALDTME1L > ZERO                                          11610000
116200         MOVE ALDTME1I               TO ASC-PRE-TICK-LEAD-TIME    11620000
116300     ELSE                                                         11630000
116400         IF  ALDTME1F = DP015-ERASE-EOF                           11640000
116500             MOVE ZERO               TO ASC-PRE-TICK-LEAD-TIME    11650000
116600         END-IF                                                   11660000
116700     END-IF.                                                      11670000
116800                                                                  11680000
116900     IF  ATKMKR1L > ZERO                                          11690000
117000         MOVE ATKMKR1I             TO ASC-PRE-TICK-MAKER          11700000
117100     ELSE                                                         11710000
117200         IF  ATKMKR1F = DP015-ERASE-EOF                           11720000
117300             MOVE SPACES           TO ASC-PRE-TICK-MAKER          11730000
117400         END-IF                                                   11740000
117500     END-IF.                                                      11750000
117600                                                                  11760000
117700     IF  ABKTKT1L > ZERO                                          11770000
117800         MOVE ABKTKT1I             TO ASC-PRE-TICK-BULK           11780000
117900     ELSE                                                         11790000
118000         IF  ABKTKT1F = DP015-ERASE-EOF                           11800000
118100             MOVE SPACES           TO ASC-PRE-TICK-BULK           11810000
118200         END-IF                                                   11820000
118300     END-IF.                                                      11830000
118400                                                                  11840000
118500                                                                  11850000
118600     IF  APKSTORL > ZERO                                          11860000
118700         MOVE APKSTORI              TO ASC-PACK-BY-STORE-Y-N      11870000
118800     ELSE                                                         11880000
118900         IF  APKSTORF = DP015-ERASE-EOF                           11890000
119000             MOVE SPACES           TO ASC-PACK-BY-STORE-Y-N       11900000
119100         END-IF                                                   11910000
119200     END-IF.                                                      11920000
119300                                                                  11930000
119400                                                                  11940000
119500     IF  AHNGIS1L > ZERO                                          11950000
119600         MOVE AHNGIS1I              TO ASC-HANGER-INSERT-Y-N      11960000
119700     ELSE                                                         11970000
119800         IF  AHNGIS1F = DP015-ERASE-EOF                           11980000
119900             MOVE SPACES           TO ASC-HANGER-INSERT-Y-N       11990000
120000         END-IF                                                   12000000
120100     END-IF.                                                      12010000
120200                                                                  12020000
120300     IF ADIRSHPL >  ZERO                                          12030000
120400         MOVE  ADIRSHPI             TO ASC-DRCT-SHP-IND           12040000
120500     ELSE                                                         12050000
120600         IF ADIRSHPF = DP015-ERASE-EOF                            12060000
120700            MOVE SPACES             TO ASC-DRCT-SHP-IND           12070000
120800         END-IF                                                   12080000
120900     END-IF.                                                      12090000
121000                                                                  12100000
121100     IF RFDCOMPL >  ZERO                                          12110000
121200         MOVE  RFDCOMPI             TO ASC-RFID-STATUS-N-T-C      12120000
121300     ELSE                                                         12130000
121400         IF RFDCOMPF = DP015-ERASE-EOF                            12140000
121500            MOVE SPACES             TO ASC-RFID-STATUS-N-T-C      12150000
121600         END-IF                                                   12160000
121700     END-IF.                                                      12170000
121800                                                                  12180000
121900     IF ADIRRTEL > ZERO                                           12190000
122000         MOVE  ADIRRTEI             TO ASC-DRCT-SHP-RATE-N        12200000
122100                                       ASC-DRCT-SHP-RATE          12210000
122200     ELSE                                                         12220000
122300         IF ADIRRTEF   = DP015-ERASE-EOF                          12230000
122400            MOVE ZEROES             TO ASC-DRCT-SHP-RATE-N        12240000
122500            MOVE SPACES             TO ASC-DRCT-SHP-RATE          12250000
122600         END-IF                                                   12260000
122700     END-IF.                                                      12270000
122800                                                                  12280000
122900     IF ADIRPCTL > ZERO                                           12290000
123000         MOVE  ADIRPCTI             TO ASC-DRCT-SHP-PCT-N         12300000
123100                                       ASC-DRCT-SHP-PCT           12310000
123200     ELSE                                                         12320000
123300         IF ADIRPCTF = DP015-ERASE-EOF                            12330000
123400            MOVE ZEROES             TO ASC-DRCT-SHP-PCT-N         12340000
123500            MOVE SPACES             TO ASC-DRCT-SHP-PCT           12350000
123600         END-IF                                                   12360000
123700     END-IF.                                                      12370000
123800                                                                  12380000
123900     IF  ADCSINDL > ZERO                                          12390000
124000         MOVE ADCSINDI              TO ASC-DC-SPLIT-IND           12400000
124100     ELSE                                                         12410000
124200         IF  ADCSINDF = DP015-ERASE-EOF                           12420000
124300             MOVE SPACES           TO ASC-DC-SPLIT-IND            12430000
124400         END-IF                                                   12440000
124500     END-IF.                                                      12450000
124600                                                                  12460000
124700     IF  ADCSDAYL > ZERO                                          12470000
124800         MOVE ADCSDAYI               TO ASC-DC-SPLIT-DAYS         12480000
124900     ELSE                                                         12490000
125000         IF  ADCSDAYF = DP015-ERASE-EOF                           12500000
125100             MOVE ZERO               TO ASC-DC-SPLIT-DAYS         12510000
125200         END-IF                                                   12520000
125300     END-IF.                                                      12530000
125400                                                                  12540000
125500                                                                  12550000
125600     IF  ASUPUCPL > ZERO                                          12560000
125700         MOVE ASUPUCPI             TO ASC-SUPPLIES-UPC-Y-N        12570000
125800     ELSE                                                         12580000
125900         IF  ASUPUCPF = DP015-ERASE-EOF                           12590000
126000             MOVE SPACES           TO ASC-SUPPLIES-UPC-Y-N        12600000
126100         END-IF                                                   12610000
126200     END-IF.                                                      12620000
126300                                                                  12630000
126400                                                                  12640000
126500     IF  ATKIND2L > ZERO                                          12650000
126600         MOVE ATKIND2I             TO ASC-SUP-TICK-IND            12660000
126700     ELSE                                                         12670000
126800         IF  ATKIND2F = DP015-ERASE-EOF                           12680000
126900             MOVE SPACES           TO ASC-SUP-TICK-IND            12690000
127000         END-IF                                                   12700000
127100     END-IF.                                                      12710000
127200                                                                  12720000
127300                                                                  12730000
127400     IF  ALDTME2L > ZERO                                          12740000
127500         MOVE ALDTME2I               TO ASC-SUP-TICK-LEAD-TIME    12750000
127600     ELSE                                                         12760000
127700         IF  ALDTME2F = DP015-ERASE-EOF                           12770000
127800             MOVE ZERO               TO ASC-SUP-TICK-LEAD-TIME    12780000
127900         END-IF                                                   12790000
128000     END-IF.                                                      12800000
128100                                                                  12810000
128200     IF  ATKMKR2L > ZERO                                          12820000
128300         MOVE ATKMKR2I             TO ASC-SUP-TICK-MAKER          12830000
128400     ELSE                                                         12840000
128500         IF  ATKMKR2F = DP015-ERASE-EOF                           12850000
128600             MOVE SPACES           TO ASC-SUP-TICK-MAKER          12860000
128700         END-IF                                                   12870000
128800     END-IF.                                                      12880000
128900                                                                  12890000
129000     IF  ABKTKT2L > ZERO                                          12900000
129100         MOVE ABKTKT2I             TO ASC-SUP-TICK-BULK           12910000
129200     ELSE                                                         12920000
129300         IF  ABKTKT2F = DP015-ERASE-EOF                           12930000
129400             MOVE SPACES           TO ASC-SUP-TICK-BULK           12940000
129500         END-IF                                                   12950000
129600     END-IF.                                                      12960000
129700                                                                  12970000
129800     IF  ANEWSTRL > ZERO                                          12980000
129900         MOVE ANEWSTRI               TO ASC-NEW-STORE-DISC-IND    12990000
130000     ELSE                                                         13000000
130100         IF  ANEWSTRF = DP015-ERASE-EOF                           13010000
130200             MOVE SPACES             TO ASC-NEW-STORE-DISC-IND    13020000
130300         END-IF                                                   13030000
130400     END-IF.                                                      13040000
130500                                                                  13050000
130600     IF  ANEWPCTL > ZERO                                          13060000
130700         MOVE ANEWPCTI             TO ASC-NEW-STORE-DISC-N        13070000
130800                                      ASC-NEW-STORE-DISC          13080000
130900     ELSE                                                         13090000
131000         IF  ANEWPCTF = DP015-ERASE-EOF                           13100000
131100             MOVE SPACES           TO ASC-NEW-STORE-DISC          13110000
131200             MOVE ZERO             TO ASC-NEW-STORE-DISC-N        13120000
131300         END-IF                                                   13130000
131400     END-IF.                                                      13140000
131500                                                                  13150000
131600     IF  ANEWDAYL > ZERO                                          13160000
131700         MOVE ANEWDAYI             TO ASC-NEW-STORE-DAYS          13170000
131800     ELSE                                                         13180000
131900         IF  ANEWDAYF = DP015-ERASE-EOF                           13190000
132000             MOVE ZERO             TO ASC-NEW-STORE-DAYS          13200000
132100         END-IF                                                   13210000
132200     END-IF.                                                      13220000
132300                                                                  13230000
132400     IF AMOSDISL  > ZERO                                          13240000
132500         MOVE AMOSDISI               TO ASC-MOS-DISC-IND          13250000
132600     ELSE                                                         13260000
132700         IF AMOSDISF  = DP015-ERASE-EOF                           13270000
132800             MOVE SPACES             TO ASC-MOS-DISC-IND          13280000
132900         END-IF                                                   13290000
133000     END-IF.                                                      13300000
133100                                                                  13310000
133200     IF AMOSPCTL  > ZERO                                          13320000
133300         MOVE AMOSPCTI             TO ASC-MOS-DISC-N              13330000
133400                                      ASC-MOS-DISC                13340000
133500     ELSE                                                         13350000
133600         IF AMOSPCTF  = DP015-ERASE-EOF                           13360000
133700             MOVE SPACES           TO ASC-MOS-DISC                13370000
133800             MOVE ZERO             TO ASC-MOS-DISC-N              13380000
133900         END-IF                                                   13390000
134000     END-IF.                                                      13400000
134100                                                                  13410000
134200     IF ATRDDISL  > ZERO                                          13420000
134300         MOVE ATRDDISI               TO ASC-TRADE-DISC-IND        13430000
134400     ELSE                                                         13440000
134500         IF ATRDDISF  = DP015-ERASE-EOF                           13450000
134600             MOVE SPACES             TO ASC-TRADE-DISC-IND        13460000
134700         END-IF                                                   13470000
134800     END-IF.                                                      13480000
134900                                                                  13490000
135000     IF ATRDPCTL  > ZERO                                          13500000
135100         MOVE ATRDPCTI             TO ASC-TRADE-DISC-N            13510000
135200                                      ASC-TRADE-DISC              13520000
135300     ELSE                                                         13530000
135400         IF ATRDPCTF  = DP015-ERASE-EOF                           13540000
135500             MOVE SPACES           TO ASC-TRADE-DISC              13550000
135600             MOVE ZERO             TO ASC-TRADE-DISC-N            13560000
135700         END-IF                                                   13570000
135800     END-IF.                                                      13580000
135900                                                                  13590000
136000     IF AADVDISL  > ZERO                                          13600000
136100         MOVE AADVDISI               TO ASC-ADVTS-DISC-IND        13610000
136200     ELSE                                                         13620000
136300         IF AADVDISF  = DP015-ERASE-EOF                           13630000
136400             MOVE SPACES             TO ASC-ADVTS-DISC-IND        13640000
136500         END-IF                                                   13650000
136600     END-IF.                                                      13660000
136700                                                                  13670000
136800     IF AADVPCTL  > ZERO                                          13680000
136900         MOVE AADVPCTI             TO ASC-ADVTS-DISC-N            13690000
137000                                      ASC-ADVTS-DISC              13700000
137100     ELSE                                                         13710000
137200         IF AADVPCTF  = DP015-ERASE-EOF                           13720000
137300             MOVE SPACES           TO ASC-ADVTS-DISC              13730000
137400             MOVE ZERO             TO ASC-ADVTS-DISC-N            13740000
137500         END-IF                                                   13750000
137600     END-IF.                                                      13760000
137700                                                                  13770000
137800     IF  ACOPALWL > ZERO                                          13780000
137900         MOVE ACOPALWI               TO ASC-COOP-ALW-IND          13790000
138000     ELSE                                                         13800000
138100         IF  ACOPALWF = DP015-ERASE-EOF                           13810000
138200             MOVE SPACES             TO ASC-COOP-ALW-IND          13820000
138300         END-IF                                                   13830000
138400     END-IF.                                                      13840000
138500                                                                  13850000
138600     IF  ACOPPCTL > ZERO                                          13860000
138700         MOVE ACOPPCTI             TO ASC-COOP-ALW-N              13870000
138800                                      ASC-COOP-ALW                13880000
138900     ELSE                                                         13890000
139000         IF  ACOPPCTF = DP015-ERASE-EOF                           13900000
139100             MOVE SPACES           TO ASC-COOP-ALW                13910000
139200             MOVE ZERO             TO ASC-COOP-ALW-N              13920000
139300         END-IF                                                   13930000
139400     END-IF.                                                      13940000
139500                                                                  13950000
139600     IF  APFTALWL > ZERO                                          13960000
139700         MOVE APFTALWI               TO ASC-PROFIT-ALW-IND        13970000
139800     ELSE                                                         13980000
139900         IF  APFTALWF = DP015-ERASE-EOF                           13990000
140000             MOVE SPACES             TO ASC-PROFIT-ALW-IND        14000000
140100         END-IF                                                   14010000
140200     END-IF.                                                      14020000
140300                                                                  14030000
140400     IF  APFTPCTL > ZERO                                          14040000
140500         MOVE APFTPCTI             TO ASC-PROFIT-ALW-N            14050000
140600                                      ASC-PROFIT-ALW              14060000
140700     ELSE                                                         14070000
140800         IF  APFTPCTF = DP015-ERASE-EOF                           14080000
140900             MOVE SPACES           TO ASC-PROFIT-ALW              14090000
141000             MOVE ZERO             TO ASC-PROFIT-ALW-N            14100000
141100         END-IF                                                   14110000
141200     END-IF.                                                      14120000
141300                                                                  14130000
141400     IF  ATBLINDL > ZERO                                          14140000
141500         MOVE ATBLINDI               TO ASC-TBL-TWR-IND           14150000
141600     ELSE                                                         14160000
141700         IF  ATBLINDF = DP015-ERASE-EOF                           14170000
141800             MOVE SPACES             TO ASC-TBL-TWR-IND           14180000
141900         END-IF                                                   14190000
142000     END-IF.                                                      14200000
142100                                                                  14210000
142200     IF  ATBLDAYL > ZERO                                          14220000
142300         MOVE ATBLDAYI             TO ASC-TBL-TWR-DAYS            14230000
142400     ELSE                                                         14240000
142500         IF  ATBLDAYF = DP015-ERASE-EOF                           14250000
142600             MOVE ZERO             TO ASC-TBL-TWR-DAYS            14260000
142700         END-IF                                                   14270000
142800     END-IF.                                                      14280000
142900                                                                  14290000
143000/                                                                 14300000
143100*----------------------------------------------------------------*14310000
143200*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *14320000
143300*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *14330000
143400*----------------------------------------------------------------*14340000
143500 3000-EDIT-DATA-IN-COMMAREA.                                      14350000
143600                                                                  14360000
143700     PERFORM 3200-RESET-ATTRIBUTES.                               14370000
143800                                                                  14380000
143900                                                                  14390000
144000     IF  ASC-SUP-TICK-BULK = 'Y' OR 'N' OR ' '                    14400000
144100         CONTINUE                                                 14410000
144200     ELSE                                                         14420000
144300         SET PS-ERROR              TO TRUE                        14430000
144400         SET DP020-MSG-FATAL       TO TRUE                        14440000
144500         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            14450000
144600         MOVE DP015-UNP-ALP-BRT-OFF                               14460000
144700                                   TO ABKTKT2A                    14470000
144800         MOVE DP015-RED            TO ABKTKT2C                    14480000
144900         MOVE DP015-REVERSE        TO ABKTKT2H                    14490000
145000         MOVE -1                   TO ABKTKT2L                    14500000
145100         SET DP030-SET-CURSOR-APPL-1                              14510000
145200                                   TO TRUE                        14520000
145300     END-IF.                                                      14530000
145400                                                                  14540000
145500                                                                  14550000
145600     IF  ASC-SUP-TICK-MAKER = 'V' OR 'U' OR ' '                   14560000
145700         CONTINUE                                                 14570000
145800     ELSE                                                         14580000
145900         SET PS-ERROR              TO TRUE                        14590000
146000         SET DP020-MSG-FATAL       TO TRUE                        14600000
146100         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            14610000
146200         MOVE DP015-UNP-ALP-BRT-OFF                               14620000
146300                                   TO ATKMKR2A                    14630000
146400         MOVE DP015-RED            TO ATKMKR2C                    14640000
146500         MOVE DP015-REVERSE        TO ATKMKR2H                    14650000
146600         MOVE -1                   TO ATKMKR2L                    14660000
146700         SET DP030-SET-CURSOR-APPL-1                              14670000
146800                                   TO TRUE                        14680000
146900     END-IF.                                                      14690000
147000                                                                  14700000
147100                                                                  14710000
147200     IF  ASC-SUP-TICK-LEAD-TIME > SPACES                          14720000
147300         MOVE ASC-SUP-TICK-LEAD-TIME                              14730000
147400                                   TO DP010I-UNEDITED-FIELD       14740000
147500         MOVE LENGTH OF ASC-SUP-TICK-LEAD-TIME                    14750000
147600                                   TO DP010I-MAXIMUM-DIGITS       14760000
147700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     14770000
147800         SET DP010I-NEGATIVE-NOT-ALLOWED                          14780000
147900                                   TO TRUE                        14790000
148010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14801001
148020                         USING DP010I-NUMERIC-EDIT-AREA           14802001
148100         IF  DP010I-ERROR-DETECTED                                14810000
148200             SET PS-ERROR                                         14820000
148300                 DP020-MSG-FATAL   TO TRUE                        14830000
148400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14840000
148500             MOVE DP015-UNP-ALP-BRT-OFF                           14850000
148600                                   TO ALDTME2A                    14860000
148700             MOVE DP015-RED        TO ALDTME2C                    14870000
148800             MOVE DP015-REVERSE    TO ALDTME2H                    14880000
148900             MOVE -1               TO ALDTME2L                    14890000
149000             SET DP030-SET-CURSOR-APPL-1                          14900000
149100                                   TO TRUE                        14910000
149200         ELSE                                                     14920000
149300             MOVE DP010I-NUMERIC-FIELD                            14930000
149400                                   TO ASC-SUP-TICK-LEAD-TIME-N    14940000
149500         END-IF                                                   14950000
149600     END-IF.                                                      14960000
149700                                                                  14970000
149800     IF  ANEWDAYL > ZERO                                          14980000
149900         MOVE ASC-NEW-STORE-DAYS TO ASC-NEW-STORE-DAYS-SAVE       14990000
150000       ELSE                                                       15000000
150100         MOVE ASC-NEW-STORE-DAYS-N TO ASC-NEW-STORE-DAYS-ONE-N    15010000
150200         MOVE ASC-NEW-STORE-DAYS-ONE TO ASC-NEW-STORE-DAYS-SAVE   15020000
150300     END-IF.                                                      15030000
150400     IF  ASC-NEW-STORE-DAYS-SAVE > SPACES                         15040000
150500         MOVE ASC-NEW-STORE-DAYS-SAVE TO DP010I-UNEDITED-FIELD    15050000
150600         MOVE LENGTH OF ASC-NEW-STORE-DAYS-SAVE                   15060000
150700                                   TO DP010I-MAXIMUM-DIGITS       15070000
150800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15080000
150900         SET DP010I-NEGATIVE-NOT-ALLOWED                          15090000
151000                                   TO TRUE                        15100000
151110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15111001
151120                         USING DP010I-NUMERIC-EDIT-AREA           15112001
151200         IF ANEWPCTL = -1                                         15120000
151300            MOVE +0               TO ANEWPCTL                     15130000
151400         END-IF                                                   15140000
151500         IF  DP010I-ERROR-DETECTED                                15150000
151600             SET PS-ERROR                                         15160000
151700                 DP020-MSG-FATAL   TO TRUE                        15170000
151800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15180000
151900             MOVE DP015-UNP-ALP-BRT-OFF                           15190000
152000                                   TO ANEWDAYA                    15200000
152100             MOVE DP015-RED        TO ANEWDAYC                    15210000
152200             MOVE DP015-REVERSE    TO ANEWDAYH                    15220000
152300             MOVE -1               TO ANEWDAYL                    15230000
152400             SET DP030-SET-CURSOR-APPL-1                          15240000
152500                                   TO TRUE                        15250000
152600         ELSE                                                     15260000
152700             MOVE DP010I-NUMERIC-FIELD                            15270000
152800                                   TO ASC-NEW-STORE-DAYS-N        15280000
152900         END-IF                                                   15290000
153000     END-IF.                                                      15300000
153100     IF  ANEWPCTL > ZERO                                          15310000
153200         MOVE ASC-NEW-STORE-DISC TO ASC-NEW-STORE-DISC-SAVE       15320000
153300       ELSE                                                       15330000
153400         MOVE ASC-NEW-STORE-DISC-N TO ASC-NEW-STORE-DISC-ONE-N    15340000
153500         MOVE ASC-NEW-STORE-DISC-ONE TO ASC-NEW-STORE-DISC-SAVE   15350000
153600     END-IF.                                                      15360000
153700     IF  ASC-NEW-STORE-DISC-SAVE > SPACES                         15370000
153800         MOVE ASC-NEW-STORE-DISC-SAVE TO DP010I-UNEDITED-FIELD    15380000
153900         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       15390000
154000         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     15400000
154100         SET DP010I-NEGATIVE-NOT-ALLOWED                          15410000
154200                                   TO TRUE                        15420000
154310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15431001
154320                         USING DP010I-NUMERIC-EDIT-AREA           15432001
154400         IF  DP010I-ERROR-DETECTED                                15440000
154500             SET PS-ERROR                                         15450000
154600                 DP020-MSG-FATAL   TO TRUE                        15460000
154700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15470000
154800             MOVE DP015-UNP-ALP-BRT-OFF                           15480000
154900                                   TO ANEWPCTA                    15490000
155000             MOVE DP015-RED        TO ANEWPCTC                    15500000
155100             MOVE DP015-REVERSE    TO ANEWPCTH                    15510000
155200             MOVE -1               TO ANEWPCTL                    15520000
155300             SET DP030-SET-CURSOR-APPL-1                          15530000
155400                                   TO TRUE                        15540000
155500         ELSE                                                     15550000
155600             MOVE DP010I-NUMERIC-FIELD                            15560000
155700                                   TO ASC-NEW-STORE-DISC-N        15570000
155800             MOVE ASC-NEW-STORE-DISC-N                            15580000
155900                                   TO ANEWPCTO                    15590000
156000             MOVE ANEWPCTO         TO ASC-NEW-STORE-DISC          15600000
156100         END-IF                                                   15610000
156200     ELSE                                                         15620000
156300         MOVE ZEROES               TO ASC-NEW-STORE-DISC-N        15630000
156400     END-IF.                                                      15640000
156500                                                                  15650000
156600     IF AMOSPCTL  > ZERO                                          15660000
156700         MOVE ASC-MOS-DISC       TO ASC-MOS-DISC-SAVE             15670000
156800       ELSE                                                       15680000
156900         MOVE ASC-MOS-DISC-N     TO ASC-MOS-DISC-ONE-N            15690000
157000         MOVE ASC-MOS-DISC-ONE   TO ASC-MOS-DISC-SAVE             15700000
157100     END-IF.                                                      15710000
157200     IF  ASC-MOS-DISC-SAVE > SPACES                               15720000
157300         MOVE ASC-MOS-DISC-SAVE    TO DP010I-UNEDITED-FIELD       15730000
157400         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       15740000
157500         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     15750000
157600         SET DP010I-NEGATIVE-NOT-ALLOWED                          15760000
157700                                   TO TRUE                        15770000
157810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15781001
157820                         USING DP010I-NUMERIC-EDIT-AREA           15782001
157900         IF  DP010I-ERROR-DETECTED                                15790000
158000             SET PS-ERROR                                         15800000
158100                 DP020-MSG-FATAL   TO TRUE                        15810000
158200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15820000
158300             MOVE DP015-UNP-ALP-BRT-OFF                           15830000
158400                                   TO AMOSPCTA                    15840000
158500             MOVE DP015-RED        TO AMOSPCTC                    15850000
158600             MOVE DP015-REVERSE    TO AMOSPCTH                    15860000
158700             MOVE -1               TO AMOSPCTL                    15870000
158800             SET DP030-SET-CURSOR-APPL-1                          15880000
158900                                   TO TRUE                        15890000
159000         ELSE                                                     15900000
159100             MOVE DP010I-NUMERIC-FIELD                            15910000
159200                                   TO ASC-MOS-DISC-N              15920000
159300             MOVE ASC-MOS-DISC-N   TO AMOSPCTO                    15930000
159400             MOVE AMOSPCTO         TO ASC-MOS-DISC                15940000
159500         END-IF                                                   15950000
159600     ELSE                                                         15960000
159700         MOVE ZEROES               TO ASC-MOS-DISC-N              15970000
159800     END-IF.                                                      15980000
159900                                                                  15990000
160000     IF ATRDPCTL  > ZERO                                          16000000
160100         MOVE ASC-TRADE-DISC     TO ASC-TRADE-DISC-SAVE           16010000
160200       ELSE                                                       16020000
160300         MOVE ASC-TRADE-DISC-N   TO ASC-TRADE-DISC-ONE-N          16030000
160400         MOVE ASC-TRADE-DISC-ONE TO ASC-TRADE-DISC-SAVE           16040000
160500     END-IF.                                                      16050000
160600     IF  ASC-TRADE-DISC-SAVE > SPACES                             16060000
160700         MOVE ASC-TRADE-DISC-SAVE  TO DP010I-UNEDITED-FIELD       16070000
160800         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       16080000
160900         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     16090000
161000         SET DP010I-NEGATIVE-NOT-ALLOWED                          16100000
161100                                   TO TRUE                        16110000
161210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16121001
161220                         USING DP010I-NUMERIC-EDIT-AREA           16122001
161300         IF  DP010I-ERROR-DETECTED                                16130000
161400             SET PS-ERROR                                         16140000
161500                 DP020-MSG-FATAL   TO TRUE                        16150000
161600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16160000
161700             MOVE DP015-UNP-ALP-BRT-OFF                           16170000
161800                                   TO ATRDPCTA                    16180000
161900             MOVE DP015-RED        TO ATRDPCTC                    16190000
162000             MOVE DP015-REVERSE    TO ATRDPCTH                    16200000
162100             MOVE -1               TO ATRDPCTL                    16210000
162200             SET DP030-SET-CURSOR-APPL-1                          16220000
162300                                   TO TRUE                        16230000
162400         ELSE                                                     16240000
162500             MOVE DP010I-NUMERIC-FIELD                            16250000
162600                                   TO ASC-TRADE-DISC-N            16260000
162700             MOVE ASC-TRADE-DISC-N TO ATRDPCTO                    16270000
162800             MOVE ATRDPCTO         TO ASC-TRADE-DISC              16280000
162900         END-IF                                                   16290000
163000     ELSE                                                         16300000
163100         MOVE ZEROES               TO ASC-TRADE-DISC-N            16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     IF AADVPCTL  > ZERO                                          16340000
163500         MOVE ASC-ADVTS-DISC     TO ASC-ADVTS-DISC-SAVE           16350000
163600       ELSE                                                       16360000
163700         MOVE ASC-ADVTS-DISC-N   TO ASC-ADVTS-DISC-ONE-N          16370000
163800         MOVE ASC-ADVTS-DISC-ONE TO ASC-ADVTS-DISC-SAVE           16380000
163900     END-IF.                                                      16390000
164000     IF  ASC-ADVTS-DISC-SAVE > SPACES                             16400000
164100         MOVE ASC-ADVTS-DISC-SAVE  TO DP010I-UNEDITED-FIELD       16410000
164200         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       16420000
164300         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     16430000
164400         SET DP010I-NEGATIVE-NOT-ALLOWED                          16440000
164500                                   TO TRUE                        16450000
164610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16461001
164620                         USING DP010I-NUMERIC-EDIT-AREA           16462001
164700         IF  DP010I-ERROR-DETECTED                                16470000
164800             SET PS-ERROR                                         16480000
164900                 DP020-MSG-FATAL   TO TRUE                        16490000
165000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16500000
165100             MOVE DP015-UNP-ALP-BRT-OFF                           16510000
165200                                   TO AADVPCTA                    16520000
165300             MOVE DP015-RED        TO AADVPCTC                    16530000
165400             MOVE DP015-REVERSE    TO AADVPCTH                    16540000
165500             MOVE -1               TO AADVPCTL                    16550000
165600             SET DP030-SET-CURSOR-APPL-1                          16560000
165700                                   TO TRUE                        16570000
165800         ELSE                                                     16580000
165900             MOVE DP010I-NUMERIC-FIELD                            16590000
166000                                   TO ASC-ADVTS-DISC-N            16600000
166100             MOVE ASC-ADVTS-DISC-N TO AADVPCTO                    16610000
166200             MOVE AADVPCTO         TO ASC-ADVTS-DISC              16620000
166300         END-IF                                                   16630000
166400     ELSE                                                         16640000
166500         MOVE ZEROES               TO ASC-ADVTS-DISC-N            16650000
166600     END-IF.                                                      16660000
166700                                                                  16670000
166800     IF ACOPPCTL  > ZERO                                          16680000
166900         MOVE ASC-COOP-ALW       TO ASC-COOP-ALW-SAVE             16690000
167000       ELSE                                                       16700000
167100         MOVE ASC-COOP-ALW-N   TO ASC-COOP-ALW-ONE-N              16710000
167200         MOVE ASC-COOP-ALW-ONE TO ASC-COOP-ALW-SAVE               16720000
167300     END-IF.                                                      16730000
167400     IF  ASC-COOP-ALW-SAVE > SPACES                               16740000
167500         MOVE ASC-COOP-ALW-SAVE  TO DP010I-UNEDITED-FIELD         16750000
167600         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       16760000
167700         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     16770000
167800         SET DP010I-NEGATIVE-NOT-ALLOWED                          16780000
167900                                   TO TRUE                        16790000
168010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16801001
168020                         USING DP010I-NUMERIC-EDIT-AREA           16802001
168100         IF  DP010I-ERROR-DETECTED                                16810000
168200             SET PS-ERROR                                         16820000
168300                 DP020-MSG-FATAL   TO TRUE                        16830000
168400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16840000
168500             MOVE DP015-UNP-ALP-BRT-OFF                           16850000
168600                                   TO ACOPPCTA                    16860000
168700             MOVE DP015-RED        TO ACOPPCTC                    16870000
168800             MOVE DP015-REVERSE    TO ACOPPCTH                    16880000
168900             MOVE -1               TO ACOPPCTL                    16890000
169000             SET DP030-SET-CURSOR-APPL-1                          16900000
169100                                   TO TRUE                        16910000
169200         ELSE                                                     16920000
169300             MOVE DP010I-NUMERIC-FIELD                            16930000
169400                                   TO ASC-COOP-ALW-N              16940000
169500             MOVE ASC-COOP-ALW-N   TO ACOPPCTO                    16950000
169600             MOVE ACOPPCTO         TO ASC-COOP-ALW                16960000
169700         END-IF                                                   16970000
169800     ELSE                                                         16980000
169900         MOVE ZEROES               TO ASC-COOP-ALW-N              16990000
170000     END-IF.                                                      17000000
170100                                                                  17010000
170200     IF APFTPCTL  > ZERO                                          17020000
170300         MOVE ASC-PROFIT-ALW     TO ASC-PROFIT-ALW-SAVE           17030000
170400       ELSE                                                       17040000
170500         MOVE ASC-PROFIT-ALW-N   TO ASC-PROFIT-ALW-ONE-N          17050000
170600         MOVE ASC-PROFIT-ALW-ONE TO ASC-PROFIT-ALW-SAVE           17060000
170700     END-IF.                                                      17070000
170800     IF  ASC-PROFIT-ALW-SAVE > SPACES                             17080000
170900         MOVE ASC-PROFIT-ALW-SAVE  TO DP010I-UNEDITED-FIELD       17090000
171000         MOVE 2                    TO DP010I-MAXIMUM-DIGITS       17100000
171100         MOVE 2                    TO DP010I-MAXIMUM-DECIMALS     17110000
171200         SET DP010I-NEGATIVE-NOT-ALLOWED                          17120000
171300                                   TO TRUE                        17130000
171410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17141001
171420                         USING DP010I-NUMERIC-EDIT-AREA           17142001
171500         IF  DP010I-ERROR-DETECTED                                17150000
171600             SET PS-ERROR                                         17160000
171700                 DP020-MSG-FATAL   TO TRUE                        17170000
171800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17180000
171900             MOVE DP015-UNP-ALP-BRT-OFF                           17190000
172000                                   TO APFTPCTA                    17200000
172100             MOVE DP015-RED        TO APFTPCTC                    17210000
172200             MOVE DP015-REVERSE    TO APFTPCTH                    17220000
172300             MOVE -1               TO APFTPCTL                    17230000
172400             SET DP030-SET-CURSOR-APPL-1                          17240000
172500                                   TO TRUE                        17250000
172600         ELSE                                                     17260000
172700             MOVE DP010I-NUMERIC-FIELD                            17270000
172800                                   TO ASC-PROFIT-ALW-N            17280000
172900             MOVE ASC-PROFIT-ALW-N TO APFTPCTO                    17290000
173000             MOVE APFTPCTO         TO ASC-PROFIT-ALW              17300000
173100         END-IF                                                   17310000
173200     ELSE                                                         17320000
173300         MOVE ZEROES               TO ASC-PROFIT-ALW-N            17330000
173400     END-IF.                                                      17340000
173500                                                                  17350000
173600     IF  ATBLDAYL > ZERO                                          17360000
173700         MOVE ASC-TBL-TWR-DAYS TO ASC-TBL-TWR-DAYS-SAVE           17370000
173800       ELSE                                                       17380000
173900         MOVE ASC-TBL-TWR-DAYS-N TO ASC-TBL-TWR-DAYS-ONE-N        17390000
174000         MOVE ASC-TBL-TWR-DAYS-ONE TO ASC-TBL-TWR-DAYS-SAVE       17400000
174100     END-IF.                                                      17410000
174200     IF  ASC-TBL-TWR-DAYS-SAVE > SPACES                           17420000
174300         MOVE ASC-TBL-TWR-DAYS-SAVE TO DP010I-UNEDITED-FIELD      17430000
174400         MOVE LENGTH OF ASC-TBL-TWR-DAYS-SAVE                     17440000
174500                                   TO DP010I-MAXIMUM-DIGITS       17450000
174600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17460000
174700         SET DP010I-NEGATIVE-NOT-ALLOWED                          17470000
174800                                   TO TRUE                        17480000
174910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17491001
174920                         USING DP010I-NUMERIC-EDIT-AREA           17492001
175000         IF  DP010I-ERROR-DETECTED                                17500000
175100             SET PS-ERROR                                         17510000
175200                 DP020-MSG-FATAL   TO TRUE                        17520000
175300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17530000
175400             MOVE DP015-UNP-ALP-BRT-OFF                           17540000
175500                                   TO ATBLDAYA                    17550000
175600             MOVE DP015-RED        TO ATBLDAYC                    17560000
175700             MOVE DP015-REVERSE    TO ATBLDAYH                    17570000
175800             MOVE -1               TO ATBLDAYL                    17580000
175900             SET DP030-SET-CURSOR-APPL-1                          17590000
176000                                   TO TRUE                        17600000
176100         ELSE                                                     17610000
176200             MOVE DP010I-NUMERIC-FIELD                            17620000
176300                                   TO ASC-TBL-TWR-DAYS-N          17630000
176400         END-IF                                                   17640000
176500     END-IF.                                                      17650000
176600                                                                  17660000
176700***************************************************************   17670000
176800**  NEW STORE DAYS AND DISCOUNT CHECKING                     **   17680000
176900***************************************************************   17690000
177000     IF ANEWDAYL = -1 OR ANEWPCTL = -1                            17700000
177100        CONTINUE                                                  17710000
177200     ELSE                                                         17720000
177300        IF ASC-NEW-STORE-DISC-IND = 'Y'                           17730000
177400           IF ASC-NEW-STORE-DISC-N  > ZERO OR                     17740000
177500              ASC-NEW-STORE-DAYS-N > ZERO                         17750000
177600              CONTINUE                                            17760000
177700           ELSE                                                   17770000
177800              SET PS-ERROR              TO TRUE                   17780000
177900              SET DP020-MSG-FATAL       TO TRUE                   17790000
178000              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       17800000
178100              MOVE DP015-UNP-ALP-BRT-OFF                          17810000
178200                                        TO ANEWDAYA               17820000
178300                                           ANEWPCTA               17830000
178400              MOVE DP015-RED            TO ANEWDAYC               17840000
178500                                           ANEWPCTC               17850000
178600              MOVE DP015-REVERSE        TO ANEWDAYH               17860000
178700                                           ANEWPCTH               17870000
178800              MOVE -1                   TO ANEWDAYL               17880000
178900                                           ANEWPCTL               17890000
179000              SET DP030-SET-CURSOR-APPL-1                         17900000
179100                                        TO TRUE                   17910000
179200           END-IF                                                 17920000
179300        END-IF                                                    17930000
179400     END-IF.                                                      17940000
179500                                                                  17950000
179600***************************************************************   17960000
179700**  NEW STORE DISCOUNT INDICATOR CHECKING                    **   17970000
179800***************************************************************   17980000
179900     IF  ASC-NEW-STORE-DISC-IND = 'Y' OR 'N'                      17990000
180000         CONTINUE                                                 18000000
180100     ELSE                                                         18010000
180200         SET PS-ERROR              TO TRUE                        18020000
180300         SET DP020-MSG-FATAL       TO TRUE                        18030000
180400         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            18040000
180500         MOVE DP015-UNP-ALP-BRT-OFF                               18050000
180600                                   TO ANEWSTRA                    18060000
180700         MOVE DP015-RED            TO ANEWSTRC                    18070000
180800         MOVE DP015-REVERSE        TO ANEWSTRH                    18080000
180900         MOVE -1                   TO ANEWSTRL                    18090000
181000         SET DP030-SET-CURSOR-APPL-1                              18100000
181100                                   TO TRUE                        18110000
181200     END-IF.                                                      18120000
181300                                                                  18130000
181400***************************************************************   18140000
181500**  MERCHANDISE OUT OF STOCK DISCOUNT CHECKING               **   18150000
181600***************************************************************   18160000
181700     IF AMOSPCTL = -1                                             18170000
181800        CONTINUE                                                  18180000
181900     ELSE                                                         18190000
182000        IF ASC-MOS-DISC-IND = 'Y'                                 18200000
182100           IF ASC-MOS-DISC-N  > ZERO                              18210000
182200              CONTINUE                                            18220000
182300           ELSE                                                   18230000
182400              SET PS-ERROR              TO TRUE                   18240000
182500              SET DP020-MSG-FATAL       TO TRUE                   18250000
182600              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       18260000
182700              MOVE DP015-UNP-ALP-BRT-OFF                          18270000
182800                                        TO AMOSPCTA               18280000
182900              MOVE DP015-RED            TO AMOSPCTC               18290000
183000              MOVE DP015-REVERSE        TO AMOSPCTH               18300000
183100              MOVE -1                   TO AMOSPCTL               18310000
183200              SET DP030-SET-CURSOR-APPL-1                         18320000
183300                                        TO TRUE                   18330000
183400           END-IF                                                 18340000
183500        END-IF                                                    18350000
183600     END-IF.                                                      18360000
183700                                                                  18370000
183800***************************************************************   18380000
183900**  MERCHANDISE OUT OF STOCK DISCOUNT INDICATOR CHECKING     **   18390000
184000***************************************************************   18400000
184100     IF  ASC-MOS-DISC-IND = 'Y' OR 'N'                            18410000
184200         CONTINUE                                                 18420000
184300     ELSE                                                         18430000
184400         SET PS-ERROR              TO TRUE                        18440000
184500         SET DP020-MSG-FATAL       TO TRUE                        18450000
184600         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            18460000
184700         MOVE DP015-UNP-ALP-BRT-OFF                               18470000
184800                                   TO AMOSDISA                    18480000
184900         MOVE DP015-RED            TO AMOSDISC                    18490000
185000         MOVE DP015-REVERSE        TO AMOSDISH                    18500000
185100         MOVE -1                   TO AMOSDISL                    18510000
185200         SET DP030-SET-CURSOR-APPL-1                              18520000
185300                                   TO TRUE                        18530000
185400     END-IF.                                                      18540000
185500***************************************************************   18550000
185600**  TRADE DISCOUNT CHECKING                                  **   18560000
185700***************************************************************   18570000
185800     IF ATRDPCTL = -1                                             18580000
185900        CONTINUE                                                  18590000
186000     ELSE                                                         18600000
186100        IF ASC-TRADE-DISC-IND = 'Y'                               18610000
186200           IF ASC-TRADE-DISC-N  > ZERO                            18620000
186300              CONTINUE                                            18630000
186400           ELSE                                                   18640000
186500              SET PS-ERROR              TO TRUE                   18650000
186600              SET DP020-MSG-FATAL       TO TRUE                   18660000
186700              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       18670000
186800              MOVE DP015-UNP-ALP-BRT-OFF                          18680000
186900                                        TO ATRDPCTA               18690000
187000              MOVE DP015-RED            TO ATRDPCTC               18700000
187100              MOVE DP015-REVERSE        TO ATRDPCTH               18710000
187200              MOVE -1                   TO ATRDPCTL               18720000
187300              SET DP030-SET-CURSOR-APPL-1                         18730000
187400                                        TO TRUE                   18740000
187500           END-IF                                                 18750000
187600        END-IF                                                    18760000
187700     END-IF.                                                      18770000
187800                                                                  18780000
187900***************************************************************   18790000
188000**  TRADE DISCOUNT INDICATOR CHECKING                        **   18800000
188100***************************************************************   18810000
188200     IF  ASC-TRADE-DISC-IND = 'Y' OR 'N'                          18820000
188300         CONTINUE                                                 18830000
188400     ELSE                                                         18840000
188500         SET PS-ERROR              TO TRUE                        18850000
188600         SET DP020-MSG-FATAL       TO TRUE                        18860000
188700         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            18870000
188800         MOVE DP015-UNP-ALP-BRT-OFF                               18880000
188900                                   TO ATRDDISA                    18890000
189000         MOVE DP015-RED            TO ATRDDISC                    18900000
189100         MOVE DP015-REVERSE        TO ATRDDISH                    18910000
189200         MOVE -1                   TO ATRDDISL                    18920000
189300         SET DP030-SET-CURSOR-APPL-1                              18930000
189400                                   TO TRUE                        18940000
189500     END-IF.                                                      18950000
189600***************************************************************   18960000
189700**  ADVTS DISCOUNT CHECKING                                  **   18970000
189800***************************************************************   18980000
189900     IF AADVPCTL = -1                                             18990000
190000        CONTINUE                                                  19000000
190100     ELSE                                                         19010000
190200        IF ASC-ADVTS-DISC-IND = 'Y'                               19020000
190300           IF ASC-ADVTS-DISC-N  > ZERO                            19030000
190400              CONTINUE                                            19040000
190500           ELSE                                                   19050000
190600              SET PS-ERROR              TO TRUE                   19060000
190700              SET DP020-MSG-FATAL       TO TRUE                   19070000
190800              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       19080000
190900              MOVE DP015-UNP-ALP-BRT-OFF                          19090000
191000                                        TO AADVPCTA               19100000
191100              MOVE DP015-RED            TO AADVPCTC               19110000
191200              MOVE DP015-REVERSE        TO AADVPCTH               19120000
191300              MOVE -1                   TO AADVPCTL               19130000
191400              SET DP030-SET-CURSOR-APPL-1                         19140000
191500                                        TO TRUE                   19150000
191600           END-IF                                                 19160000
191700        END-IF                                                    19170000
191800     END-IF.                                                      19180000
191900                                                                  19190000
192000***************************************************************   19200000
192100**  ADVTS DISCOUNT INDICATOR CHECKING                        **   19210000
192200***************************************************************   19220000
192300     IF  ASC-ADVTS-DISC-IND = 'Y' OR 'N'                          19230000
192400         CONTINUE                                                 19240000
192500     ELSE                                                         19250000
192600         SET PS-ERROR              TO TRUE                        19260000
192700         SET DP020-MSG-FATAL       TO TRUE                        19270000
192800         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            19280000
192900         MOVE DP015-UNP-ALP-BRT-OFF                               19290000
193000                                   TO AADVDISA                    19300000
193100         MOVE DP015-RED            TO AADVDISC                    19310000
193200         MOVE DP015-REVERSE        TO AADVDISH                    19320000
193300         MOVE -1                   TO AADVDISL                    19330000
193400         SET DP030-SET-CURSOR-APPL-1                              19340000
193500                                   TO TRUE                        19350000
193600     END-IF.                                                      19360000
193700                                                                  19370000
193800***************************************************************   19380000
193900**  COOP ALLOWANCE CHECKING                                  **   19390000
194000***************************************************************   19400000
194100     IF ACOPPCTL = -1                                             19410000
194200        CONTINUE                                                  19420000
194300     ELSE                                                         19430000
194400        IF ASC-COOP-ALW-IND = 'Y'                                 19440000
194500           IF ASC-COOP-ALW-N  > ZERO                              19450000
194600              CONTINUE                                            19460000
194700           ELSE                                                   19470000
194800              SET PS-ERROR              TO TRUE                   19480000
194900              SET DP020-MSG-FATAL       TO TRUE                   19490000
195000              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       19500000
195100              MOVE DP015-UNP-ALP-BRT-OFF                          19510000
195200                                        TO ACOPPCTA               19520000
195300              MOVE DP015-RED            TO ACOPPCTC               19530000
195400              MOVE DP015-REVERSE        TO ACOPPCTH               19540000
195500              MOVE -1                   TO ACOPPCTL               19550000
195600              SET DP030-SET-CURSOR-APPL-1                         19560000
195700                                        TO TRUE                   19570000
195800           END-IF                                                 19580000
195900        END-IF                                                    19590000
196000     END-IF.                                                      19600000
196100                                                                  19610000
196200***************************************************************   19620000
196300**  COOP ALLOWANCE INDICATOR CHECKING                        **   19630000
196400***************************************************************   19640000
196500     IF  ASC-COOP-ALW-IND = 'Y' OR 'N'                            19650000
196600         CONTINUE                                                 19660000
196700     ELSE                                                         19670000
196800         SET PS-ERROR              TO TRUE                        19680000
196900         SET DP020-MSG-FATAL       TO TRUE                        19690000
197000         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            19700000
197100         MOVE DP015-UNP-ALP-BRT-OFF                               19710000
197200                                   TO ACOPALWA                    19720000
197300         MOVE DP015-RED            TO ACOPALWC                    19730000
197400         MOVE DP015-REVERSE        TO ACOPALWH                    19740000
197500         MOVE -1                   TO ACOPALWL                    19750000
197600         SET DP030-SET-CURSOR-APPL-1                              19760000
197700                                   TO TRUE                        19770000
197800     END-IF.                                                      19780000
197900                                                                  19790000
198000***************************************************************   19800000
198100**  PROFITASST/ADCOOP ALLOWANCE CHECKING                     **   19810000
198200***************************************************************   19820000
198300     IF APFTPCTL = -1                                             19830000
198400        CONTINUE                                                  19840000
198500     ELSE                                                         19850000
198600        IF ASC-PROFIT-ALW-IND = 'Y'                               19860000
198700           IF ASC-PROFIT-ALW-N  > ZERO                            19870000
198800              CONTINUE                                            19880000
198900           ELSE                                                   19890000
199000              SET PS-ERROR              TO TRUE                   19900000
199100              SET DP020-MSG-FATAL       TO TRUE                   19910000
199200              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       19920000
199300              MOVE DP015-UNP-ALP-BRT-OFF                          19930000
199400                                        TO APFTPCTA               19940000
199500              MOVE DP015-RED            TO APFTPCTC               19950000
199600              MOVE DP015-REVERSE        TO APFTPCTH               19960000
199700              MOVE -1                   TO APFTPCTL               19970000
199800              SET DP030-SET-CURSOR-APPL-1                         19980000
199900                                        TO TRUE                   19990000
200000           END-IF                                                 20000000
200100        END-IF                                                    20010000
200200     END-IF.                                                      20020000
200300                                                                  20030000
200400***************************************************************   20040000
200500**  PROFITASST/ADCOOP ALLOWANCE INDICATOR CHECKING           **   20050000
200600***************************************************************   20060000
200700     IF  ASC-PROFIT-ALW-IND = 'Y' OR 'N'                          20070000
200800         CONTINUE                                                 20080000
200900     ELSE                                                         20090000
201000         SET PS-ERROR              TO TRUE                        20100000
201100         SET DP020-MSG-FATAL       TO TRUE                        20110000
201200         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            20120000
201300         MOVE DP015-UNP-ALP-BRT-OFF                               20130000
201400                                   TO APFTALWA                    20140000
201500         MOVE DP015-RED            TO APFTALWC                    20150000
201600         MOVE DP015-REVERSE        TO APFTALWH                    20160000
201700         MOVE -1                   TO APFTALWL                    20170000
201800         SET DP030-SET-CURSOR-APPL-1                              20180000
201900                                   TO TRUE                        20190000
202000     END-IF.                                                      20200000
202100                                                                  20210000
202200***************************************************************   20220000
202300**  TABLE/TOWER DATING DAYS CHECKING                         **   20230000
202400***************************************************************   20240000
202500     IF ATBLDAYL = -1                                             20250000
202600        CONTINUE                                                  20260000
202700     ELSE                                                         20270000
202800        IF ASC-TBL-TWR-IND = 'Y'                                  20280000
202900           IF ASC-TBL-TWR-DAYS-N > ZERO                           20290000
203000              CONTINUE                                            20300000
203100           ELSE                                                   20310000
203200              SET PS-ERROR              TO TRUE                   20320000
203300              SET DP020-MSG-FATAL       TO TRUE                   20330000
203400              MOVE PC-TSYMSG-01375      TO DP020-MSG-NUMBER       20340000
203500              MOVE DP015-UNP-ALP-BRT-OFF                          20350000
203600                                        TO ATBLDAYA               20360000
203700              MOVE DP015-RED            TO ATBLDAYC               20370000
203800              MOVE DP015-REVERSE        TO ATBLDAYH               20380000
203900              MOVE -1                   TO ATBLDAYL               20390000
204000              SET DP030-SET-CURSOR-APPL-1                         20400000
204100                                        TO TRUE                   20410000
204200           END-IF                                                 20420000
204300        END-IF                                                    20430000
204400     END-IF.                                                      20440000
204500                                                                  20450000
204600***************************************************************   20460000
204700**  TABLE/TOWER DATING INDICATOR CHECKING                    **   20470000
204800***************************************************************   20480000
204900     IF  ASC-TBL-TWR-IND = 'Y' OR 'N'                             20490000
205000         CONTINUE                                                 20500000
205100     ELSE                                                         20510000
205200         SET PS-ERROR              TO TRUE                        20520000
205300         SET DP020-MSG-FATAL       TO TRUE                        20530000
205400         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            20540000
205500         MOVE DP015-UNP-ALP-BRT-OFF                               20550000
205600                                   TO ATBLINDA                    20560000
205700         MOVE DP015-RED            TO ATBLINDC                    20570000
205800         MOVE DP015-REVERSE        TO ATBLINDH                    20580000
205900         MOVE -1                   TO ATBLINDL                    20590000
206000         SET DP030-SET-CURSOR-APPL-1                              20600000
206100                                   TO TRUE                        20610000
206200     END-IF.                                                      20620000
206300                                                                  20630000
206400     IF  ASC-SUP-TICK-IND = 'Y' OR 'N' OR 'P'                     20640000
206500         CONTINUE                                                 20650000
206600     ELSE                                                         20660000
206700         SET PS-ERROR              TO TRUE                        20670000
206800         SET DP020-MSG-FATAL       TO TRUE                        20680000
206900         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            20690000
207000         MOVE DP015-UNP-ALP-BRT-OFF                               20700000
207100                                   TO ATKIND2A                    20710000
207200         MOVE DP015-RED            TO ATKIND2C                    20720000
207300         MOVE DP015-REVERSE        TO ATKIND2H                    20730000
207400         MOVE -1                   TO ATKIND2L                    20740000
207500         SET DP030-SET-CURSOR-APPL-1                              20750000
207600                                   TO TRUE                        20760000
207700     END-IF.                                                      20770000
207800                                                                  20780000
207900***************************************************************   20790000
208000**  DIRECT SHIP CHECK #1                                     **   20800000
208100**  VALIDATE THE DIRECT SHIP RATE IS NUMERIC                 **   20810000
208200***************************************************************   20820000
208300                                                                  20830000
208400     IF ADIRRTEL  > ZERO                                          20840000
208500         MOVE ASC-DRCT-SHP-RATE     TO ASC-DRCT-SHP-RATE-SAVE     20850000
208600       ELSE                                                       20860000
208700         MOVE ASC-DRCT-SHP-RATE-N   TO ASC-DRCT-SHP-RATE-ONE-N    20870000
208800         MOVE ASC-DRCT-SHP-RATE-ONE TO ASC-DRCT-SHP-RATE-SAVE     20880000
208900     END-IF.                                                      20890000
209000                                                                  20900000
209100     IF  ASC-DRCT-SHP-RATE-SAVE > SPACES                          20910000
209200         MOVE ASC-DRCT-SHP-RATE-SAVE TO DP010I-UNEDITED-FIELD     20920000
209300         MOVE LENGTH OF ASC-DRCT-SHP-RATE-SAVE                    20930000
209400                                    TO DP010I-MAXIMUM-DIGITS      20940000
209500         MOVE 2                     TO DP010I-MAXIMUM-DECIMALS    20950000
209600         SET DP010I-NEGATIVE-NOT-ALLOWED                          20960000
209700                                   TO TRUE                        20970000
209810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20981001
209820                         USING DP010I-NUMERIC-EDIT-AREA           20982001
209900         IF  DP010I-ERROR-DETECTED                                20990000
210000             SET PS-ERROR                                         21000000
210100                 DP020-MSG-FATAL   TO TRUE                        21010000
210200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21020000
210300             MOVE DP015-UNP-ALP-BRT-OFF                           21030000
210400                                   TO ADIRRTEA                    21040000
210500             MOVE DP015-RED        TO ADIRRTEC                    21050000
210600             MOVE DP015-REVERSE    TO ADIRRTEH                    21060000
210700             MOVE -1               TO ADIRRTEL                    21070000
210800             SET DP030-SET-CURSOR-APPL-1                          21080000
210900                                   TO TRUE                        21090000
211000         ELSE                                                     21100000
211100             MOVE DP010I-NUMERIC-FIELD                            21110000
211200                                     TO ASC-DRCT-SHP-RATE-N       21120000
211300             MOVE ASC-DRCT-SHP-RATE-N TO ADIRRTEO                 21130000
211400             MOVE ADIRRTEO           TO ASC-DRCT-SHP-RATE         21140000
211500         END-IF                                                   21150000
211600     ELSE                                                         21160000
211700         MOVE ZEROES                 TO ASC-DRCT-SHP-RATE-N       21170000
211800     END-IF.                                                      21180000
211900                                                                  21190000
212000***************************************************************   21200000
212100**  DIRECT SHIP CHECK #2                                     **   21210000
212200**  VALIDATE THE DIRECT SHIP PERCENT IS NUMERIC              **   21220000
212300***************************************************************   21230000
212400                                                                  21240000
212500     IF ADIRPCTL  > ZERO                                          21250000
212600         MOVE ASC-DRCT-SHP-PCT      TO ASC-DRCT-SHP-PCT-SAVE      21260000
212700     ELSE                                                         21270000
212800         MOVE ASC-DRCT-SHP-PCT-N    TO ASC-DRCT-SHP-PCT-ONE-N     21280000
212900         MOVE ASC-DRCT-SHP-PCT-ONE  TO ASC-DRCT-SHP-PCT-SAVE      21290000
213000     END-IF.                                                      21300000
213100                                                                  21310000
213200     IF  ASC-DRCT-SHP-PCT-SAVE > SPACES                           21320000
213300         MOVE ASC-DRCT-SHP-PCT-SAVE TO DP010I-UNEDITED-FIELD      21330000
213400         MOVE 2                     TO DP010I-MAXIMUM-DIGITS      21340000
213500         MOVE 2                     TO DP010I-MAXIMUM-DECIMALS    21350000
213600         SET DP010I-NEGATIVE-NOT-ALLOWED                          21360000
213700                                    TO TRUE                       21370000
213810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21381001
213820                         USING DP010I-NUMERIC-EDIT-AREA           21382001
213900         IF  DP010I-ERROR-DETECTED                                21390000
214000             SET PS-ERROR                                         21400000
214100                 DP020-MSG-FATAL   TO TRUE                        21410000
214200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21420000
214300             MOVE DP015-UNP-ALP-BRT-OFF                           21430000
214400                                   TO ADIRPCTA                    21440000
214500             MOVE DP015-RED        TO ADIRPCTC                    21450000
214600             MOVE DP015-REVERSE    TO ADIRPCTH                    21460000
214700             MOVE -1               TO ADIRPCTL                    21470000
214800             SET DP030-SET-CURSOR-APPL-1                          21480000
214900                                   TO TRUE                        21490000
215000         ELSE                                                     21500000
215100             MOVE DP010I-NUMERIC-FIELD                            21510000
215200                                     TO ASC-DRCT-SHP-PCT-N        21520000
215300             MOVE ASC-DRCT-SHP-PCT-N TO ADIRPCTO                  21530000
215400             MOVE ADIRPCTO         TO ASC-DRCT-SHP-PCT            21540000
215500         END-IF                                                   21550000
215600     ELSE                                                         21560000
215700         MOVE ZEROES               TO ASC-DRCT-SHP-PCT-N          21570000
215800     END-IF.                                                      21580000
215900                                                                  21590000
216000***************************************************************   21600000
216100**  DIRECT SHIP CHECK #3                                     **   21610000
216200**  IF THE INDICATOR = 'N' THEN DIRECT SHIP RATE AND PCT     **   21620000
216300**  MUST BOTH BE ZEROES.                                     **   21630000
216400***************************************************************   21640000
216500                                                                  21650000
216600     IF ADIRRTEL = -1 OR ADIRPCTL = -1                            21660000
216700        CONTINUE                                                  21670000
216800     ELSE                                                         21680000
216900       IF ASC-DRCT-SHP-IND = 'N'                                  21690000
217000         IF ((ASC-DRCT-SHP-RATE-N > 0) AND                        21700000
217100             (ASC-DRCT-SHP-PCT-N > 0))                            21710000
217200          SET PS-ERROR              TO TRUE                       21720000
217300          SET DP020-MSG-FATAL       TO TRUE                       21730000
217400          MOVE PC-TSYMSG-03558      TO DP020-MSG-NUMBER           21740000
217500          MOVE DP015-UNP-ALP-BRT-OFF                              21750000
217600                                    TO ADIRRTEA                   21760000
217700                                       ADIRPCTA                   21770000
217800          MOVE DP015-RED            TO ADIRRTEC                   21780000
217900                                       ADIRPCTC                   21790000
218000          MOVE DP015-REVERSE        TO ADIRRTEH                   21800000
218100                                       ADIRPCTH                   21810000
218200          MOVE -1                   TO ADIRRTEL                   21820000
218300          SET DP030-SET-CURSOR-APPL-1                             21830000
218400                                     TO TRUE                      21840000
218500         ELSE                                                     21850000
218600           CONTINUE                                               21860000
218700         END-IF                                                   21870000
218800       END-IF                                                     21880000
218900     END-IF.                                                      21890000
219000                                                                  21900000
219100***************************************************************   21910000
219200**  DIRECT SHIP CHECK #4                                     **   21920000
219300**  IF THE INDICATOR = 'N' THEN DIRECT SHIP RATE AND PCT     **   21930000
219400**  MUST BOTH BE ZEROES.                                     **   21940000
219500***************************************************************   21950000
219600                                                                  21960000
219700     IF ADIRRTEL = -1 OR ADIRPCTL = -1                            21970000
219800        CONTINUE                                                  21980000
219900     ELSE                                                         21990000
220000       IF ASC-DRCT-SHP-IND = 'N'                                  22000000
220100         IF ((ASC-DRCT-SHP-RATE-N > 0) AND                        22010000
220200             (ASC-DRCT-SHP-PCT-N = 0))                            22020000
220300          SET PS-ERROR              TO TRUE                       22030000
220400          SET DP020-MSG-FATAL       TO TRUE                       22040000
220500          MOVE PC-TSYMSG-03558      TO DP020-MSG-NUMBER           22050000
220600          MOVE DP015-UNP-ALP-BRT-OFF                              22060000
220700                                    TO ADIRRTEA                   22070000
220800          MOVE DP015-RED            TO ADIRRTEC                   22080000
220900          MOVE DP015-REVERSE        TO ADIRRTEH                   22090000
221000          MOVE -1                   TO ADIRRTEL                   22100000
221100          SET DP030-SET-CURSOR-APPL-1                             22110000
221200                                     TO TRUE                      22120000
221300         ELSE                                                     22130000
221400           CONTINUE                                               22140000
221500         END-IF                                                   22150000
221600       END-IF                                                     22160000
221700     END-IF.                                                      22170000
221800                                                                  22180000
221900***************************************************************   22190000
222000**  DIRECT SHIP CHECK #5                                     **   22200000
222100**  IF THE INDICATOR = 'N' THEN DIRECT SHIP RATE AND PCT     **   22210000
222200**  MUST BOTH BE ZEROES.                                     **   22220000
222300***************************************************************   22230000
222400                                                                  22240000
222500     IF ADIRRTEL = -1 OR ADIRPCTL = -1                            22250000
222600        CONTINUE                                                  22260000
222700     ELSE                                                         22270000
222800       IF ASC-DRCT-SHP-IND = 'N'                                  22280000
222900         IF ((ASC-DRCT-SHP-RATE-N = 0) AND                        22290000
223000             (ASC-DRCT-SHP-PCT-N > 0))                            22300000
223100          SET PS-ERROR              TO TRUE                       22310000
223200          SET DP020-MSG-FATAL       TO TRUE                       22320000
223300          MOVE PC-TSYMSG-03558      TO DP020-MSG-NUMBER           22330000
223400          MOVE DP015-UNP-ALP-BRT-OFF                              22340000
223500                                    TO ADIRPCTA                   22350000
223600          MOVE DP015-RED            TO ADIRPCTC                   22360000
223700          MOVE DP015-REVERSE        TO ADIRPCTH                   22370000
223800          MOVE -1                   TO ADIRPCTL                   22380000
223900          SET DP030-SET-CURSOR-APPL-1                             22390000
224000                                     TO TRUE                      22400000
224100         ELSE                                                     22410000
224200           CONTINUE                                               22420000
224300         END-IF                                                   22430000
224400       END-IF                                                     22440000
224500     END-IF.                                                      22450000
224600                                                                  22460000
224700***************************************************************   22470000
224800**  DIRECT SHIP CHECK #6                                     **   22480000
224900**  IF THE INDICATOR = 'Y' THEN THE DIRECT SHIP RATE OR      **   22490000
225000**  DIRECT SHIP PCT CAN'T BOTH BE GREATER THAN ZEROES.       **   22500000
225100***************************************************************   22510000
225200                                                                  22520000
225300     IF ADIRRTEL = -1 OR ADIRPCTL = -1                            22530000
225400        CONTINUE                                                  22540000
225500     ELSE                                                         22550000
225600       IF ASC-DRCT-SHP-IND = 'Y'                                  22560000
225700         IF ((ASC-DRCT-SHP-RATE-N > 0) AND                        22570000
225800             (ASC-DRCT-SHP-PCT-N > 0))                            22580000
225900          SET PS-ERROR              TO TRUE                       22590000
226000          SET DP020-MSG-FATAL       TO TRUE                       22600000
226100          MOVE PC-TSYMSG-03557      TO DP020-MSG-NUMBER           22610000
226200          MOVE DP015-UNP-ALP-BRT-OFF                              22620000
226300                                    TO ADIRRTEA                   22630000
226400                                       ADIRPCTA                   22640000
226500          MOVE DP015-RED            TO ADIRRTEC                   22650000
226600                                       ADIRPCTC                   22660000
226700          MOVE DP015-REVERSE        TO ADIRRTEH                   22670000
226800                                       ADIRPCTH                   22680000
226900          MOVE -1                   TO ADIRRTEL                   22690000
227000          SET DP030-SET-CURSOR-APPL-1                             22700000
227100                                     TO TRUE                      22710000
227200         ELSE                                                     22720000
227300           CONTINUE                                               22730000
227400         END-IF                                                   22740000
227500       END-IF                                                     22750000
227600     END-IF.                                                      22760000
227700                                                                  22770000
227800***************************************************************   22780000
227900**  DIRECT SHIP CHECK #7                                     **   22790000
228000**  IF THE INDICATOR = 'Y' THEN THE DIRECT SHIP RATE OR      **   22800000
228100**  DIRECT SHIP PCT MUST BE ZEROES, NOT BOTH.                **   22810000
228200***************************************************************   22820000
228300                                                                  22830000
228400     IF ADIRRTEL = -1 OR ADIRPCTL = -1                            22840000
228500        CONTINUE                                                  22850000
228600     ELSE                                                         22860000
228700       IF ASC-DRCT-SHP-IND = 'Y'                                  22870000
228800         IF ((ASC-DRCT-SHP-RATE-N = 0) AND                        22880000
228900             (ASC-DRCT-SHP-PCT-N = 0))                            22890000
229000          SET PS-ERROR              TO TRUE                       22900000
229100          SET DP020-MSG-FATAL       TO TRUE                       22910000
229200          MOVE PC-TSYMSG-03559      TO DP020-MSG-NUMBER           22920000
229300          MOVE DP015-UNP-ALP-BRT-OFF                              22930000
229400                                    TO ADIRRTEA                   22940000
229500                                       ADIRPCTA                   22950000
229600          MOVE DP015-RED            TO ADIRRTEC                   22960000
229700                                       ADIRPCTC                   22970000
229800          MOVE DP015-REVERSE        TO ADIRRTEH                   22980000
229900                                       ADIRPCTH                   22990000
230000          MOVE -1                   TO ADIRRTEL                   23000000
230100          SET DP030-SET-CURSOR-APPL-1                             23010000
230200                                     TO TRUE                      23020000
230300         ELSE                                                     23030000
230400           CONTINUE                                               23040000
230500         END-IF                                                   23050000
230600       END-IF                                                     23060000
230700     END-IF.                                                      23070000
230800                                                                  23080000
230900***************************************************************   23090000
231000**  RFID STATUS CHECK #9 - TAGGING OR COMPLIANT              **   23100000
231100**  THE INDICATOR CAN ONLY BE 'N' OR 'T' OR 'C'              **   23110000
231200***************************************************************   23120000
231300                                                                  23130000
231400     IF ASC-RFID-STATUS-N-T-C  = 'N' OR 'T' OR 'C'                23140000
231500        CONTINUE                                                  23150000
231600     ELSE                                                         23160000
231700        SET PS-ERROR              TO TRUE                         23170000
231800        SET DP020-MSG-FATAL       TO TRUE                         23180000
231900        MOVE PC-TSYMSG-03732      TO DP020-MSG-NUMBER             23190000
232000        MOVE DP015-UNP-ALP-BRT-OFF                                23200000
232100                                  TO RFDCOMPA                     23210000
232200        MOVE DP015-RED            TO RFDCOMPC                     23220000
232300        MOVE DP015-REVERSE        TO RFDCOMPH                     23230000
232400        MOVE -1                   TO RFDCOMPL                     23240000
232500        SET DP030-SET-CURSOR-APPL-1                               23250000
232600                                   TO TRUE                        23260000
232700     END-IF.                                                      23270000
232800                                                                  23280000
232900*    CANNOT GO FROM 'N' TO COMPLIANT, MUST HAVE TAGGING FIRST     23290000
233000                                                                  23300000
233100     IF ASC-RFID-STATUS-N-T-C      = 'C' AND                      23310000
233200        ASC-RFID-STATUS-N-T-C-OLD  = 'N'                          23320000
233300        SET PS-ERROR              TO TRUE                         23330000
233400        SET DP020-MSG-FATAL       TO TRUE                         23340000
233500        MOVE PC-TSYMSG-03733      TO DP020-MSG-NUMBER             23350000
233600        MOVE DP015-UNP-ALP-BRT-OFF                                23360000
233700                                  TO RFDCOMPA                     23370000
233800        MOVE DP015-RED            TO RFDCOMPC                     23380000
233900        MOVE DP015-REVERSE        TO RFDCOMPH                     23390000
234000        MOVE -1                   TO RFDCOMPL                     23400000
234100        SET DP030-SET-CURSOR-APPL-1                               23410000
234200                                   TO TRUE                        23420000
234300     END-IF.                                                      23430000
234400                                                                  23440000
234500***************************************************************   23450000
234600**  DIRECT SHIP CHECK #8                                     **   23460000
234700**  THE INDICATOR CAN ONLY BE 'N' OR 'Y'                     **   23470000
234800***************************************************************   23480000
234900                                                                  23490000
235000     IF ASC-DRCT-SHP-IND = 'Y' OR 'N'                             23500000
235100        CONTINUE                                                  23510000
235200     ELSE                                                         23520000
235300        SET PS-ERROR              TO TRUE                         23530000
235400        SET DP020-MSG-FATAL       TO TRUE                         23540000
235500        MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER             23550000
235600        MOVE DP015-UNP-ALP-BRT-OFF                                23560000
235700                                  TO ADIRSHPA                     23570000
235800        MOVE DP015-RED            TO ADIRSHPC                     23580000
235900        MOVE DP015-REVERSE        TO ADIRSHPH                     23590000
236000        MOVE -1                   TO ADIRSHPL                     23600000
236100        SET DP030-SET-CURSOR-APPL-1                               23610000
236200                                   TO TRUE                        23620000
236300     END-IF.                                                      23630000
236400                                                                  23640000
236500***************************************************************   23650000
236600                                                                  23660000
236700     IF  ASC-SUPPLIES-UPC-Y-N = 'Y' OR 'N'                        23670000
236800         CONTINUE                                                 23680000
236900     ELSE                                                         23690000
237000         SET PS-ERROR              TO TRUE                        23700000
237100         SET DP020-MSG-FATAL       TO TRUE                        23710000
237200         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            23720000
237300         MOVE DP015-UNP-ALP-BRT-OFF                               23730000
237400                                   TO ASUPUCPA                    23740000
237500         MOVE DP015-RED            TO ASUPUCPC                    23750000
237600         MOVE DP015-REVERSE        TO ASUPUCPH                    23760000
237700         MOVE -1                   TO ASUPUCPL                    23770000
237800         SET DP030-SET-CURSOR-APPL-1                              23780000
237900                                   TO TRUE                        23790000
238000     END-IF.                                                      23800000
238100                                                                  23810000
238200                                                                  23820000
238300     IF  ASC-HANGER-INSERT-Y-N = 'Y' OR 'N'                       23830000
238400         CONTINUE                                                 23840000
238500     ELSE                                                         23850000
238600         SET PS-ERROR              TO TRUE                        23860000
238700         SET DP020-MSG-FATAL       TO TRUE                        23870000
238800         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            23880000
238900         MOVE DP015-UNP-ALP-BRT-OFF                               23890000
239000                                   TO AHNGIS1A                    23900000
239100         MOVE DP015-RED            TO AHNGIS1C                    23910000
239200         MOVE DP015-REVERSE        TO AHNGIS1H                    23920000
239300         MOVE -1                   TO AHNGIS1L                    23930000
239400         SET DP030-SET-CURSOR-APPL-1                              23940000
239500                                   TO TRUE                        23950000
239600     END-IF.                                                      23960000
239700                                                                  23970000
239800***************************************************************   23980000
239900**  DC SPLIT REQUIRED INDICATOR CHECKING                     **   23990000
240000***************************************************************   24000000
240100     IF  ASC-DC-SPLIT-IND = 'Y' OR 'N'                            24010000
240200         CONTINUE                                                 24020000
240300     ELSE                                                         24030000
240400         SET PS-ERROR              TO TRUE                        24040000
240500         SET DP020-MSG-FATAL       TO TRUE                        24050000
240600         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            24060000
240700         MOVE DP015-UNP-ALP-BRT-OFF                               24070000
240800                                   TO ADCSINDA                    24080000
240900         MOVE DP015-RED            TO ADCSINDC                    24090000
241000         MOVE DP015-REVERSE        TO ADCSINDH                    24100000
241100         MOVE -1                   TO ADCSINDL                    24110000
241200         SET DP030-SET-CURSOR-APPL-1                              24120000
241300                                   TO TRUE                        24130000
241400     END-IF.                                                      24140000
241500                                                                  24150000
241600***************************************************************   24160000
241700** DC SPLIT IND CONDITION CHECK #1                           **   24170000
241800**  IF THE INDICATOR WAS PREVIOUSLY 'Y' OR 'N' AND SPACE IS  **   24180000
241900**  ENTERED, THIS IS AN ERROR.                               **   24190000
242000***************************************************************   24200000
242100     IF  ASC-DC-SPLIT-IND = SPACE                                 24210000
242200         IF  ASC-DC-SPLIT-IND-OLD = 'Y' OR 'N'                    24220000
242300         SET PS-ERROR              TO TRUE                        24230000
242400         SET DP020-MSG-FATAL       TO TRUE                        24240000
242500         MOVE PC-TSYMSG-02585      TO DP020-MSG-NUMBER            24250000
242600         MOVE DP015-UNP-ALP-BRT-OFF                               24260000
242700                                   TO ADCSINDA                    24270000
242800         MOVE DP015-RED            TO ADCSINDC                    24280000
242900         MOVE DP015-REVERSE        TO ADCSINDH                    24290000
243000         MOVE -1                   TO ADCSINDL                    24300000
243100         SET DP030-SET-CURSOR-APPL-1                              24310000
243200                                   TO TRUE                        24320000
243300     END-IF.                                                      24330000
243400                                                                  24340000
243500***************************************************************   24350000
243600** DC SPLIT IND CONDITION CHECK #2                           **   24360000
243700**  IF THE INDICATOR HAS 'Y' ENTERED, THEN THE LEADTIME DAYS **   24370000
243800**  MUST BE ZERO.                                            **   24380000
243900***************************************************************   24390000
244000     IF  ASC-DC-SPLIT-IND = 'Y'                                   24400000
244100         IF  ASC-DC-SPLIT-DAYS NOT = ZERO                         24410000
244200         SET PS-ERROR              TO TRUE                        24420000
244300         SET DP020-MSG-FATAL       TO TRUE                        24430000
244400         MOVE PC-TSYMSG-02586      TO DP020-MSG-NUMBER            24440000
244500         MOVE DP015-UNP-ALP-BRT-OFF                               24450000
244600                                   TO ADCSDAYA                    24460000
244700         MOVE DP015-RED            TO ADCSDAYC                    24470000
244800         MOVE DP015-REVERSE        TO ADCSDAYH                    24480000
244900         MOVE -1                   TO ADCSDAYL                    24490000
245000         SET DP030-SET-CURSOR-APPL-1                              24500000
245100                                   TO TRUE                        24510000
245200     END-IF.                                                      24520000
245300                                                                  24530000
245400***************************************************************   24540000
245500** DC SPLIT IND CONDITION CHECK #3                           **   24550000
245600**  IF THE INDICATOR HAS 'N' ENTERED, THEN THE LEADTIME DAYS **   24560000
245700**  MUST NOT BE ZERO.                                        **   24570000
245800***************************************************************   24580000
245900     IF  ASC-DC-SPLIT-IND = 'N'                                   24590000
246000         IF  ASC-DC-SPLIT-DAYS = ZERO                             24600000
246100         SET PS-ERROR              TO TRUE                        24610000
246200         SET DP020-MSG-FATAL       TO TRUE                        24620000
246300         MOVE PC-TSYMSG-02587      TO DP020-MSG-NUMBER            24630000
246400         MOVE DP015-UNP-ALP-BRT-OFF                               24640000
246500                                   TO ADCSDAYA                    24650000
246600         MOVE DP015-RED            TO ADCSDAYC                    24660000
246700         MOVE DP015-REVERSE        TO ADCSDAYH                    24670000
246800         MOVE -1                   TO ADCSDAYL                    24680000
246900         SET DP030-SET-CURSOR-APPL-1                              24690000
247000                                   TO TRUE                        24700000
247100     END-IF.                                                      24710000
247200                                                                  24720000
247300***************************************************************   24730000
247400** DC SPLIT IND CONDITION CHECK #4                           **   24740000
247500**  IF THE LEADTIME DAYS HAD A VALUE GREATER THEN ZERO       **   24750000
247600**  ENTERED AND THE INDICATOR IS SPACE (IT WAS NEVER CHANGED)**   24760000
247700**  THEN THE INDICATOR WILL DEFAULT TO 'N'.                  **   24770000
247800***************************************************************   24780000
247900     IF ASC-DC-SPLIT-IND     = ' ' AND                            24790000
248000        ASC-DC-SPLIT-IND-OLD = ' '                                24800000
248100        MOVE ASC-DC-SPLIT-DAYS TO PV-DC-SPLIT-DAYS                24810000
248200        INSPECT PV-DC-SPLIT-DAYS REPLACING LEADING ' ' BY ZERO    24820000
248300        IF PV-DC-SPLIT-DAYS > ZERO                                24830000
248400           MOVE 'N' TO ASC-DC-SPLIT-IND                           24840000
248500       END-IF                                                     24850000
248600     END-IF.                                                      24860000
248700                                                                  24870000
248800                                                                  24880000
248900     IF  ASC-PRE-TICK-BULK = 'Y' OR 'N' OR ' '                    24890000
249000         CONTINUE                                                 24900000
249100     ELSE                                                         24910000
249200         SET PS-ERROR              TO TRUE                        24920000
249300         SET DP020-MSG-FATAL       TO TRUE                        24930000
249400         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            24940000
249500         MOVE DP015-UNP-ALP-BRT-OFF                               24950000
249600                                   TO ABKTKT1A                    24960000
249700         MOVE DP015-RED            TO ABKTKT1C                    24970000
249800         MOVE DP015-REVERSE        TO ABKTKT1H                    24980000
249900         MOVE -1                   TO ABKTKT1L                    24990000
250000         SET DP030-SET-CURSOR-APPL-1                              25000000
250100                                   TO TRUE                        25010000
250200     END-IF.                                                      25020000
250300                                                                  25030000
250400     IF  ASC-PACK-BY-STORE-Y-N = 'Y' OR 'N'                       25040000
250500         CONTINUE                                                 25050000
250600     ELSE                                                         25060000
250700         SET PS-ERROR              TO TRUE                        25070000
250800         SET DP020-MSG-FATAL       TO TRUE                        25080000
250900         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            25090000
251000         MOVE DP015-UNP-ALP-BRT-OFF                               25100000
251100                                   TO APKSTORA                    25110000
251200         MOVE DP015-RED            TO APKSTORC                    25120000
251300         MOVE DP015-REVERSE        TO APKSTORH                    25130000
251400         MOVE -1                   TO APKSTORL                    25140000
251500         SET DP030-SET-CURSOR-APPL-1                              25150000
251600                                   TO TRUE                        25160000
251700     END-IF.                                                      25170000
251800     IF  ASC-PACK-BY-STORE-Y-N = 'Y'                              25180000
251900         IF ASC-PRE-TICK-IND   = 'Y'                              25190000
252000             CONTINUE                                             25200000
252100         ELSE                                                     25210000
252200             SET PS-ERROR              TO TRUE                    25220000
252300             SET DP020-MSG-FATAL       TO TRUE                    25230000
252400             MOVE PC-TSYMSG-01318      TO DP020-MSG-NUMBER        25240000
252500             MOVE DP015-UNP-ALP-BRT-OFF                           25250000
252600                                       TO APKSTORA                25260000
252700             MOVE DP015-RED            TO APKSTORC                25270000
252800             MOVE DP015-REVERSE        TO APKSTORH                25280000
252900             MOVE -1                   TO APKSTORL                25290000
253000             MOVE DP015-UNP-ALP-BRT-OFF                           25300000
253100                                       TO ATKIND1A                25310000
253200             MOVE DP015-RED            TO ATKIND1C                25320000
253300             MOVE DP015-REVERSE        TO ATKIND1H                25330000
253400             MOVE -1                   TO ATKIND1L                25340000
253500             SET DP030-SET-CURSOR-APPL-1                          25350000
253600                                       TO TRUE                    25360000
253700             SET DP030-SET-CURSOR-APPL-1                          25370000
253800                                       TO TRUE                    25380000
253900         END-IF                                                   25390000
254000     END-IF.                                                      25400000
254100                                                                  25410000
254200     IF  ASC-PRE-TICK-MAKER = 'K' OR 'V' OR ' '                   25420000
254300         CONTINUE                                                 25430000
254400     ELSE                                                         25440000
254500         SET PS-ERROR              TO TRUE                        25450000
254600         SET DP020-MSG-FATAL       TO TRUE                        25460000
254700         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            25470000
254800         MOVE DP015-UNP-ALP-BRT-OFF                               25480000
254900                                   TO ATKMKR1A                    25490000
255000         MOVE DP015-RED            TO ATKMKR1C                    25500000
255100         MOVE DP015-REVERSE        TO ATKMKR1H                    25510000
255200         MOVE -1                   TO ATKMKR1L                    25520000
255300         SET DP030-SET-CURSOR-APPL-1                              25530000
255400                                   TO TRUE                        25540000
255500     END-IF.                                                      25550000
255600                                                                  25560000
255700                                                                  25570000
255800     IF  ASC-PRE-TICK-LEAD-TIME > SPACES                          25580000
255900         MOVE ASC-PRE-TICK-LEAD-TIME                              25590000
256000                                   TO DP010I-UNEDITED-FIELD       25600000
256100         MOVE LENGTH OF ASC-PRE-TICK-LEAD-TIME                    25610000
256200                                   TO DP010I-MAXIMUM-DIGITS       25620000
256300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     25630000
256400         SET DP010I-NEGATIVE-NOT-ALLOWED                          25640000
256500                                   TO TRUE                        25650000
256610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         25661001
256620                         USING DP010I-NUMERIC-EDIT-AREA           25662001
256700         IF  DP010I-ERROR-DETECTED                                25670000
256800             SET PS-ERROR                                         25680000
256900                 DP020-MSG-FATAL   TO TRUE                        25690000
257000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            25700000
257100             MOVE DP015-UNP-ALP-BRT-OFF                           25710000
257200                                   TO ALDTME1A                    25720000
257300             MOVE DP015-RED        TO ALDTME1C                    25730000
257400             MOVE DP015-REVERSE    TO ALDTME1H                    25740000
257500             MOVE -1               TO ALDTME1L                    25750000
257600             SET DP030-SET-CURSOR-APPL-1                          25760000
257700                                   TO TRUE                        25770000
257800         ELSE                                                     25780000
257900             MOVE DP010I-NUMERIC-FIELD                            25790000
258000                                   TO ASC-PRE-TICK-LEAD-TIME-N    25800000
258100         END-IF                                                   25810000
258200     END-IF.                                                      25820000
258300                                                                  25830000
258400     IF  ASC-PRE-TICK-IND = 'Y' OR 'N' OR 'P'                     25840000
258500         CONTINUE                                                 25850000
258600     ELSE                                                         25860000
258700         SET PS-ERROR              TO TRUE                        25870000
258800         SET DP020-MSG-FATAL       TO TRUE                        25880000
258900         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            25890000
259000         MOVE DP015-UNP-ALP-BRT-OFF                               25900000
259100                                   TO ATKIND1A                    25910000
259200         MOVE DP015-RED            TO ATKIND1C                    25920000
259300         MOVE DP015-REVERSE        TO ATKIND1H                    25930000
259400         MOVE -1                   TO ATKIND1L                    25940000
259500         SET DP030-SET-CURSOR-APPL-1                              25950000
259600                                   TO TRUE                        25960000
259700     END-IF.                                                      25970000
259800                                                                  25980000
259900     IF  ASC-SUP-TICK-IND = 'Y' OR 'P'                            25990000
260000         IF  ASC-SUP-TICK-BULK = SPACES                           26000000
260100             SET PS-ERROR          TO TRUE                        26010000
260200             SET DP020-MSG-FATAL   TO TRUE                        26020000
260300             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            26030000
260400             MOVE DP015-UNP-ALP-BRT-OFF                           26040000
260500                                   TO ABKTKT2A                    26050000
260600             MOVE DP015-RED        TO ABKTKT2C                    26060000
260700             MOVE DP015-REVERSE    TO ABKTKT2H                    26070000
260800             MOVE -1               TO ABKTKT2L                    26080000
260900             SET DP030-SET-CURSOR-APPL-1                          26090000
261000                                   TO TRUE                        26100000
261100         END-IF                                                   26110000
261200     END-IF.                                                      26120000
261300                                                                  26130000
261400     IF  ASC-SUP-TICK-IND = 'Y' OR 'P'                            26140000
261500         IF  ASC-SUP-TICK-MAKER = SPACES                          26150000
261600             SET PS-ERROR          TO TRUE                        26160000
261700             SET DP020-MSG-FATAL   TO TRUE                        26170000
261800             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            26180000
261900             MOVE DP015-UNP-ALP-BRT-OFF                           26190000
262000                                   TO ATKMKR2A                    26200000
262100             MOVE DP015-RED        TO ATKMKR2C                    26210000
262200             MOVE DP015-REVERSE    TO ATKMKR2H                    26220000
262300             MOVE -1               TO ATKMKR2L                    26230000
262400             SET DP030-SET-CURSOR-APPL-1                          26240000
262500                                   TO TRUE                        26250000
262600         END-IF                                                   26260000
262700     END-IF.                                                      26270000
262800                                                                  26280000
262900     IF  ASC-NEW-STORE-DISC-IND = 'Y'                             26290000
263000         IF  ASC-NEW-STORE-DAYS   = SPACES                        26300000
263100         AND ASC-NEW-STORE-DISC-N = ZEROES                        26310000
263200             SET PS-ERROR          TO TRUE                        26320000
263300             SET DP020-MSG-FATAL   TO TRUE                        26330000
263400             MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER            26340000
263500             MOVE DP015-UNP-ALP-BRT-OFF                           26350000
263600                                   TO ANEWPCTA                    26360000
263700                                      ANEWDAYA                    26370000
263800             MOVE DP015-RED        TO ANEWPCTC                    26380000
263900                                      ANEWDAYC                    26390000
264000             MOVE DP015-REVERSE    TO ANEWPCTH                    26400000
264100                                      ANEWDAYH                    26410000
264200             MOVE -1               TO ANEWPCTL                    26420000
264300             SET DP030-SET-CURSOR-APPL-1                          26430000
264400                                   TO TRUE                        26440000
264500         END-IF                                                   26450000
264600     END-IF.                                                      26460000
264700                                                                  26470000
264800     IF ASC-NEW-STORE-DISC-IND = 'N'                              26480000
264900         IF ASC-NEW-STORE-DAYS-N > ZEROES OR                      26490000
265000            ASC-NEW-STORE-DISC-N > ZEROES                         26500000
265100             SET PS-ERROR          TO TRUE                        26510000
265200             SET DP020-MSG-FATAL   TO TRUE                        26520000
265300             MOVE PC-TSYMSG-00635  TO DP020-MSG-NUMBER            26530000
265400             MOVE DP015-UNP-ALP-BRT-OFF                           26540000
265500                                   TO ANEWSTRA                    26550000
265600             MOVE DP015-RED        TO ANEWSTRC                    26560000
265700             MOVE DP015-REVERSE    TO ANEWSTRH                    26570000
265800             MOVE -1               TO ANEWSTRL                    26580000
265900             SET DP030-SET-CURSOR-APPL-1                          26590000
266000                                   TO TRUE                        26600000
266100         END-IF                                                   26610000
266200     END-IF.                                                      26620000
266300                                                                  26630000
266400     IF  ASC-MOS-DISC-IND = 'Y'                                   26640000
266500         IF  ASC-MOS-DISC-N = ZEROS                               26650000
266600             SET PS-ERROR          TO TRUE                        26660000
266700             SET DP020-MSG-FATAL   TO TRUE                        26670000
266800             MOVE PC-TSYMSG-02521  TO DP020-MSG-NUMBER            26680000
266900             MOVE DP015-UNP-ALP-BRT-OFF                           26690000
267000                                   TO AMOSPCTA                    26700000
267100             MOVE DP015-RED        TO AMOSPCTC                    26710000
267200             MOVE DP015-REVERSE    TO AMOSPCTH                    26720000
267300             MOVE -1               TO AMOSPCTL                    26730000
267400             SET DP030-SET-CURSOR-APPL-1                          26740000
267500                                   TO TRUE                        26750000
267600         END-IF                                                   26760000
267700     END-IF.                                                      26770000
267800                                                                  26780000
267900     IF ASC-MOS-DISC-IND = 'N'                                    26790000
268000         IF ASC-MOS-DISC-N > ZEROES                               26800000
268100             SET PS-ERROR          TO TRUE                        26810000
268200             SET DP020-MSG-FATAL   TO TRUE                        26820000
268300             MOVE PC-TSYMSG-02522  TO DP020-MSG-NUMBER            26830000
268400             MOVE DP015-UNP-ALP-BRT-OFF                           26840000
268500                                   TO AMOSPCTA                    26850000
268600             MOVE DP015-RED        TO AMOSPCTC                    26860000
268700             MOVE DP015-REVERSE    TO AMOSPCTH                    26870000
268800             MOVE -1               TO AMOSPCTL                    26880000
268900             SET DP030-SET-CURSOR-APPL-1                          26890000
269000                                   TO TRUE                        26900000
269100         END-IF                                                   26910000
269200     END-IF.                                                      26920000
269300                                                                  26930000
269400     IF  ASC-TRADE-DISC-IND = 'Y'                                 26940000
269500         IF  ASC-TRADE-DISC-N = ZEROS                             26950000
269600             SET PS-ERROR          TO TRUE                        26960000
269700             SET DP020-MSG-FATAL   TO TRUE                        26970000
269800             MOVE PC-TSYMSG-02523  TO DP020-MSG-NUMBER            26980000
269900             MOVE DP015-UNP-ALP-BRT-OFF                           26990000
270000                                   TO ATRDPCTA                    27000000
270100             MOVE DP015-RED        TO ATRDPCTC                    27010000
270200             MOVE DP015-REVERSE    TO ATRDPCTH                    27020000
270300             MOVE -1               TO ATRDPCTL                    27030000
270400             SET DP030-SET-CURSOR-APPL-1                          27040000
270500                                   TO TRUE                        27050000
270600         END-IF                                                   27060000
270700     END-IF.                                                      27070000
270800                                                                  27080000
270900     IF ASC-TRADE-DISC-IND = 'N'                                  27090000
271000         IF ASC-TRADE-DISC-N > ZEROES                             27100000
271100             SET PS-ERROR          TO TRUE                        27110000
271200             SET DP020-MSG-FATAL   TO TRUE                        27120000
271300             MOVE PC-TSYMSG-02524  TO DP020-MSG-NUMBER            27130000
271400             MOVE DP015-UNP-ALP-BRT-OFF                           27140000
271500                                   TO ATRDPCTA                    27150000
271600             MOVE DP015-RED        TO ATRDPCTC                    27160000
271700             MOVE DP015-REVERSE    TO ATRDPCTH                    27170000
271800             MOVE -1               TO ATRDPCTL                    27180000
271900             SET DP030-SET-CURSOR-APPL-1                          27190000
272000                                   TO TRUE                        27200000
272100         END-IF                                                   27210000
272200     END-IF.                                                      27220000
272300                                                                  27230000
272400     IF  ASC-ADVTS-DISC-IND = 'Y'                                 27240000
272500         IF  ASC-ADVTS-DISC-N = ZEROS                             27250000
272600             SET PS-ERROR          TO TRUE                        27260000
272700             SET DP020-MSG-FATAL   TO TRUE                        27270000
272800             MOVE PC-TSYMSG-02525  TO DP020-MSG-NUMBER            27280000
272900             MOVE DP015-UNP-ALP-BRT-OFF                           27290000
273000                                   TO AADVPCTA                    27300000
273100             MOVE DP015-RED        TO AADVPCTC                    27310000
273200             MOVE DP015-REVERSE    TO AADVPCTH                    27320000
273300             MOVE -1               TO AADVPCTL                    27330000
273400             SET DP030-SET-CURSOR-APPL-1                          27340000
273500                                   TO TRUE                        27350000
273600         END-IF                                                   27360000
273700     END-IF.                                                      27370000
273800                                                                  27380000
273900     IF ASC-ADVTS-DISC-IND = 'N'                                  27390000
274000         IF ASC-ADVTS-DISC-N > ZEROES                             27400000
274100             SET PS-ERROR          TO TRUE                        27410000
274200             SET DP020-MSG-FATAL   TO TRUE                        27420000
274300             MOVE PC-TSYMSG-02526  TO DP020-MSG-NUMBER            27430000
274400             MOVE DP015-UNP-ALP-BRT-OFF                           27440000
274500                                   TO AADVPCTA                    27450000
274600             MOVE DP015-RED        TO AADVPCTC                    27460000
274700             MOVE DP015-REVERSE    TO AADVPCTH                    27470000
274800             MOVE -1               TO AADVPCTL                    27480000
274900             SET DP030-SET-CURSOR-APPL-1                          27490000
275000                                   TO TRUE                        27500000
275100         END-IF                                                   27510000
275200     END-IF.                                                      27520000
275300                                                                  27530000
275400     IF  ASC-COOP-ALW-IND = 'Y'                                   27540000
275500         IF  ASC-COOP-ALW-N = ZEROS                               27550000
275600             SET PS-ERROR          TO TRUE                        27560000
275700             SET DP020-MSG-FATAL   TO TRUE                        27570000
275800             MOVE PC-TSYMSG-03474  TO DP020-MSG-NUMBER            27580000
275900             MOVE DP015-UNP-ALP-BRT-OFF                           27590000
276000                                   TO ACOPPCTA                    27600000
276100             MOVE DP015-RED        TO ACOPPCTC                    27610000
276200             MOVE DP015-REVERSE    TO ACOPPCTH                    27620000
276300             MOVE -1               TO ACOPPCTL                    27630000
276400             SET DP030-SET-CURSOR-APPL-1                          27640000
276500                                   TO TRUE                        27650000
276600         END-IF                                                   27660000
276700     END-IF.                                                      27670000
276800                                                                  27680000
276900     IF ASC-COOP-ALW-IND = 'N'                                    27690000
277000         IF ASC-COOP-ALW-N > ZEROES                               27700000
277100             SET PS-ERROR          TO TRUE                        27710000
277200             SET DP020-MSG-FATAL   TO TRUE                        27720000
277300             MOVE PC-TSYMSG-03475  TO DP020-MSG-NUMBER            27730000
277400             MOVE DP015-UNP-ALP-BRT-OFF                           27740000
277500                                   TO ACOPPCTA                    27750000
277600             MOVE DP015-RED        TO ACOPPCTC                    27760000
277700             MOVE DP015-REVERSE    TO ACOPPCTH                    27770000
277800             MOVE -1               TO ACOPPCTL                    27780000
277900             SET DP030-SET-CURSOR-APPL-1                          27790000
278000                                   TO TRUE                        27800000
278100         END-IF                                                   27810000
278200     END-IF.                                                      27820000
278300                                                                  27830000
278400     IF  ASC-PROFIT-ALW-IND = 'Y'                                 27840000
278500         IF  ASC-PROFIT-ALW-N = ZEROS                             27850000
278600             SET PS-ERROR          TO TRUE                        27860000
278700             SET DP020-MSG-FATAL   TO TRUE                        27870000
278800             MOVE PC-TSYMSG-03476  TO DP020-MSG-NUMBER            27880000
278900             MOVE DP015-UNP-ALP-BRT-OFF                           27890000
279000                                   TO APFTPCTA                    27900000
279100             MOVE DP015-RED        TO APFTPCTC                    27910000
279200             MOVE DP015-REVERSE    TO APFTPCTH                    27920000
279300             MOVE -1               TO APFTPCTL                    27930000
279400             SET DP030-SET-CURSOR-APPL-1                          27940000
279500                                   TO TRUE                        27950000
279600         END-IF                                                   27960000
279700     END-IF.                                                      27970000
279800                                                                  27980000
279900     IF ASC-PROFIT-ALW-IND = 'N'                                  27990000
280000         IF ASC-PROFIT-ALW-N > ZEROES                             28000000
280100             SET PS-ERROR          TO TRUE                        28010000
280200             SET DP020-MSG-FATAL   TO TRUE                        28020000
280300             MOVE PC-TSYMSG-03477  TO DP020-MSG-NUMBER            28030000
280400             MOVE DP015-UNP-ALP-BRT-OFF                           28040000
280500                                   TO APFTPCTA                    28050000
280600             MOVE DP015-RED        TO APFTPCTC                    28060000
280700             MOVE DP015-REVERSE    TO APFTPCTH                    28070000
280800             MOVE -1               TO APFTPCTL                    28080000
280900             SET DP030-SET-CURSOR-APPL-1                          28090000
281000                                   TO TRUE                        28100000
281100         END-IF                                                   28110000
281200     END-IF.                                                      28120000
281300                                                                  28130000
281400     IF  ASC-TBL-TWR-IND = 'Y'                                    28140000
281500         IF  ASC-TBL-TWR-DAYS   = SPACES                          28150000
281600             SET PS-ERROR          TO TRUE                        28160000
281700             SET DP020-MSG-FATAL   TO TRUE                        28170000
281800             MOVE PC-TSYMSG-03478  TO DP020-MSG-NUMBER            28180000
281900             MOVE DP015-UNP-ALP-BRT-OFF                           28190000
282000                                   TO ATBLDAYA                    28200000
282100             MOVE DP015-RED        TO ATBLDAYC                    28210000
282200             MOVE DP015-REVERSE    TO ATBLDAYH                    28220000
282300             MOVE -1               TO ATBLDAYL                    28230000
282400             SET DP030-SET-CURSOR-APPL-1                          28240000
282500                                   TO TRUE                        28250000
282600         END-IF                                                   28260000
282700     END-IF.                                                      28270000
282800                                                                  28280000
282900     IF ASC-TBL-TWR-IND = 'N'                                     28290000
283000         IF ASC-TBL-TWR-DAYS-N > ZEROES                           28300000
283100             SET PS-ERROR          TO TRUE                        28310000
283200             SET DP020-MSG-FATAL   TO TRUE                        28320000
283300             MOVE PC-TSYMSG-03479  TO DP020-MSG-NUMBER            28330000
283400             MOVE DP015-UNP-ALP-BRT-OFF                           28340000
283500                                   TO ATBLDAYA                    28350000
283600             MOVE DP015-RED        TO ATBLDAYC                    28360000
283700             MOVE DP015-REVERSE    TO ATBLDAYH                    28370000
283800             MOVE -1               TO ATBLDAYL                    28380000
283900             SET DP030-SET-CURSOR-APPL-1                          28390000
284000                                   TO TRUE                        28400000
284100         END-IF                                                   28410000
284200     END-IF.                                                      28420000
284300                                                                  28430000
284400                                                                  28440000
284500     IF  ASC-PRE-TICK-IND = 'Y' OR 'P'                            28450000
284600         IF  ASC-PRE-TICK-BULK = SPACES                           28460000
284700             SET PS-ERROR          TO TRUE                        28470000
284800             SET DP020-MSG-FATAL   TO TRUE                        28480000
284900             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            28490000
285000             MOVE DP015-UNP-ALP-BRT-OFF                           28500000
285100                                   TO ABKTKT1A                    28510000
285200             MOVE DP015-RED        TO ABKTKT1C                    28520000
285300             MOVE DP015-REVERSE    TO ABKTKT1H                    28530000
285400             MOVE -1               TO ABKTKT1L                    28540000
285500             SET DP030-SET-CURSOR-APPL-1                          28550000
285600                                   TO TRUE                        28560000
285700         END-IF                                                   28570000
285800     END-IF.                                                      28580000
285900                                                                  28590000
286000     IF  ASC-PRE-TICK-IND = 'Y' OR 'P'                            28600000
286100         IF  ASC-PRE-TICK-MAKER = SPACES                          28610000
286200             SET PS-ERROR          TO TRUE                        28620000
286300             SET DP020-MSG-FATAL   TO TRUE                        28630000
286400             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            28640000
286500             MOVE DP015-UNP-ALP-BRT-OFF                           28650000
286600                                   TO ATKMKR1A                    28660000
286700             MOVE DP015-RED        TO ATKMKR1C                    28670000
286800             MOVE DP015-REVERSE    TO ATKMKR1H                    28680000
286900             MOVE -1               TO ATKMKR1L                    28690000
287000             SET DP030-SET-CURSOR-APPL-1                          28700000
287100                                   TO TRUE                        28710000
287200         END-IF                                                   28720000
287300     END-IF.                                                      28730000
287400                                                                  28740000
287500/                                                                 28750000
287600*----------------------------------------------------------------*28760000
287700*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *28770000
287800*----------------------------------------------------------------*28780000
287900                                                                  28790000
288000 3200-RESET-ATTRIBUTES.                                           28800000
288100                                                                  28810000
288200     MOVE DP015-UNP-NUM-NOR-OFF TO ADCSDAYA.                      28820000
288300                                                                  28830000
288400     MOVE DP015-UNP-ALP-NOR-OFF TO ATKIND1A                       28840000
288500                                   ALDTME1A                       28850000
288600                                   ATKMKR1A                       28860000
288700                                   ABKTKT1A                       28870000
288800                                   APKSTORA                       28880000
288900                                   AHNGIS1A                       28890000
289000                                   ADIRSHPA                       28900000
289100                                   ADIRRTEA                       28910000
289200                                   ADIRPCTA                       28920000
289300                                   ADCSINDA                       28930000
289400                                   ASUPUCPA                       28940000
289500                                   ATKIND2A                       28950000
289600                                   ALDTME2A                       28960000
289700                                   ATKMKR2A                       28970000
289800                                   ABKTKT2A                       28980000
289900                                   ANEWSTRA                       28990000
290000                                   ANEWPCTA                       29000000
290100                                   ANEWDAYA                       29010000
290200                                   AMOSDISA                       29020000
290300                                   AMOSPCTA                       29030000
290400                                   ATRDDISA                       29040000
290500                                   ATRDPCTA                       29050000
290600                                   AADVDISA                       29060000
290700                                   AADVPCTA                       29070000
290800                                   ACOPALWA                       29080000
290900                                   ACOPPCTA                       29090000
291000                                   APFTALWA                       29100000
291100                                   APFTPCTA                       29110000
291200                                   ATBLINDA                       29120000
291300                                   ATBLDAYA                       29130000
291400                                   RFDCOMPA.                      29140000
291500                                                                  29150000
291600     MOVE DP015-GREEN           TO ATKIND1C                       29160000
291700                                   ALDTME1C                       29170000
291800                                   ATKMKR1C                       29180000
291900                                   ABKTKT1C                       29190000
292000                                   APKSTORC                       29200000
292100                                   AHNGIS1C                       29210000
292200                                   ADIRSHPC                       29220000
292300                                   ADIRRTEC                       29230000
292400                                   ADIRPCTC                       29240000
292500                                   ADCSINDC                       29250000
292600                                   ADCSDAYC                       29260000
292700                                   ASUPUCPC                       29270000
292800                                   ATKIND2C                       29280000
292900                                   ALDTME2C                       29290000
293000                                   ATKMKR2C                       29300000
293100                                   ABKTKT2C                       29310000
293200                                   ANEWSTRC                       29320000
293300                                   ANEWPCTC                       29330000
293400                                   ANEWDAYC                       29340000
293500                                   AMOSDISC                       29350000
293600                                   AMOSPCTC                       29360000
293700                                   ATRDDISC                       29370000
293800                                   ATRDPCTC                       29380000
293900                                   AADVDISC                       29390000
294000                                   AADVPCTC                       29400000
294100                                   ACOPALWC                       29410000
294200                                   ACOPPCTC                       29420000
294300                                   APFTALWC                       29430000
294400                                   APFTPCTC                       29440000
294500                                   ATBLINDC                       29450000
294600                                   ATBLDAYC                       29460000
294700                                   RFDCOMPC.                      29470000
294800                                                                  29480000
294900     MOVE DP015-UNDERLINE       TO ATKIND1H                       29490000
295000                                   ALDTME1H                       29500000
295100                                   ATKMKR1H                       29510000
295200                                   ABKTKT1H                       29520000
295300                                   APKSTORH                       29530000
295400                                   AHNGIS1H                       29540000
295500                                   ADIRSHPH                       29550000
295600                                   ADIRRTEH                       29560000
295700                                   ADIRPCTH                       29570000
295800                                   ADCSINDH                       29580000
295900                                   ADCSDAYH                       29590000
296000                                   ASUPUCPH                       29600000
296100                                   ATKIND2H                       29610000
296200                                   ALDTME2H                       29620000
296300                                   ATKMKR2H                       29630000
296400                                   ABKTKT2H                       29640000
296500                                   ANEWSTRH                       29650000
296600                                   ANEWPCTH                       29660000
296700                                   ANEWDAYH                       29670000
296800                                   AMOSDISH                       29680000
296900                                   AMOSPCTH                       29690000
297000                                   ATRDDISH                       29700000
297100                                   ATRDPCTH                       29710000
297200                                   AADVDISH                       29720000
297300                                   AADVPCTH                       29730000
297400                                   ACOPALWH                       29740000
297500                                   ACOPPCTH                       29750000
297600                                   APFTALWH                       29760000
297700                                   APFTPCTH                       29770000
297800                                   ATBLINDH                       29780000
297900                                   ATBLDAYH                       29790000
298000                                   RFDCOMPH.                      29800000
298100                                                                  29810000
298200                                                                  29820000
298300/                                                                 29830000
298400*----------------------------------------------------------------*29840000
298500*  SAVE ORIGINAL SCREEN VALUES FOR LATER COMPARSION.             *29850000
298600*----------------------------------------------------------------*29860000
298700                                                                  29870000
298800 3500-SAVE-SCREEN-FIELDS.                                         29880000
298900                                                                  29890000
299000     MOVE ASC-PRE-TICK-IND        TO ASC-PRE-TICK-IND-OLD.        29900000
299100     MOVE ASC-PRE-TICK-LEAD-TIME  TO ASC-PRE-TICK-LEAD-TIME-OLD.  29910000
299200     MOVE ASC-PRE-TICK-MAKER      TO ASC-PRE-TICK-MAKER-OLD.      29920000
299300     MOVE ASC-PRE-TICK-BULK       TO ASC-PRE-TICK-BULK-OLD.       29930000
299400     MOVE ASC-PACK-BY-STORE-Y-N   TO ASC-PACK-BY-STORE-Y-N-OLD.   29940000
299500     MOVE ASC-HANGER-INSERT-Y-N   TO ASC-HANGER-INSERT-Y-N-OLD.   29950000
299600     MOVE ASC-DRCT-SHP-IND        TO ASC-DRCT-SHP-IND-OLD.        29960000
299700     MOVE ASC-DC-SPLIT-IND        TO ASC-DC-SPLIT-IND-OLD.        29970000
299800     MOVE ASC-DC-SPLIT-DAYS       TO ASC-DC-SPLIT-DAYS-OLD.       29980000
299900     MOVE ASC-SUPPLIES-UPC-Y-N    TO ASC-SUPPLIES-UPC-Y-N-OLD.    29990000
300000     MOVE ASC-SUP-TICK-IND        TO ASC-SUP-TICK-IND-OLD.        30000000
300100     MOVE ASC-SUP-TICK-LEAD-TIME  TO ASC-SUP-TICK-LEAD-TIME-OLD.  30010000
300200     MOVE ASC-SUP-TICK-MAKER      TO ASC-SUP-TICK-MAKER-OLD.      30020000
300300     MOVE ASC-SUP-TICK-BULK       TO ASC-SUP-TICK-BULK-OLD.       30030000
300400     MOVE ASC-NEW-STORE-DISC-IND  TO ASC-NEW-STORE-DISC-IND-OLD.  30040000
300500     MOVE ASC-MOS-DISC-IND        TO ASC-MOS-DISC-IND-OLD.        30050000
300600     MOVE ASC-TRADE-DISC-IND      TO ASC-TRADE-DISC-IND-OLD.      30060000
300700     MOVE ASC-ADVTS-DISC-IND      TO ASC-ADVTS-DISC-IND-OLD.      30070000
300800     MOVE ASC-COOP-ALW-IND        TO ASC-COOP-ALW-IND-OLD.        30080000
300900     MOVE ASC-PROFIT-ALW-IND      TO ASC-PROFIT-ALW-IND-OLD.      30090000
301000     MOVE ASC-TBL-TWR-IND         TO ASC-TBL-TWR-IND-OLD.         30100000
301100     MOVE ASC-RFID-STATUS-N-T-C   TO ASC-RFID-STATUS-N-T-C-OLD.   30110000
301200                                                                  30120000
301300     IF ASC-NEW-STORE-DISC = SPACES                               30130000
301400         MOVE ' 0.00'                  TO ASC-NEW-STORE-DISC-OLD  30140000
301500                                         ASC-NEW-STORE-DISC-SAVE  30150000
301600     ELSE                                                         30160000
301700         MOVE ASC-NEW-STORE-DISC TO ASC-NEW-STORE-DISC-OLD        30170000
301800                                    ASC-NEW-STORE-DISC-SAVE       30180000
301900     END-IF.                                                      30190000
302000     MOVE ASC-NEW-STORE-DISC-SAVE TO ASC-NEW-STORE-DISC.          30200000
302100                                                                  30210000
302200     IF ASC-MOS-DISC       = SPACES                               30220000
302300         MOVE ' 0.00'                  TO ASC-MOS-DISC-OLD        30230000
302400                                          ASC-MOS-DISC-SAVE       30240000
302500       ELSE                                                       30250000
302600         MOVE ASC-MOS-DISC             TO ASC-MOS-DISC-OLD        30260000
302700                                          ASC-MOS-DISC-SAVE       30270000
302800     END-IF.                                                      30280000
302900     MOVE ASC-MOS-DISC-SAVE            TO ASC-MOS-DISC.           30290000
303000                                                                  30300000
303100     IF ASC-TRADE-DISC      = SPACES                              30310000
303200         MOVE ' 0.00'                  TO ASC-TRADE-DISC-OLD      30320000
303300                                          ASC-TRADE-DISC-SAVE     30330000
303400       ELSE                                                       30340000
303500         MOVE ASC-TRADE-DISC           TO ASC-TRADE-DISC-OLD      30350000
303600                                          ASC-TRADE-DISC-SAVE     30360000
303700     END-IF.                                                      30370000
303800     MOVE ASC-TRADE-DISC-SAVE          TO ASC-TRADE-DISC.         30380000
303900                                                                  30390000
304000     IF ASC-ADVTS-DISC     = SPACES                               30400000
304100         MOVE ' 0.00'                  TO ASC-ADVTS-DISC-OLD      30410000
304200                                          ASC-ADVTS-DISC-SAVE     30420000
304300       ELSE                                                       30430000
304400         MOVE ASC-ADVTS-DISC           TO ASC-ADVTS-DISC-OLD      30440000
304500                                          ASC-ADVTS-DISC-SAVE     30450000
304600     END-IF.                                                      30460000
304700     MOVE ASC-ADVTS-DISC-SAVE          TO ASC-ADVTS-DISC.         30470000
304800                                                                  30480000
304900     IF ASC-COOP-ALW       = SPACES                               30490000
305000         MOVE ' 0.00'                  TO ASC-COOP-ALW-OLD        30500000
305100                                          ASC-COOP-ALW-SAVE       30510000
305200       ELSE                                                       30520000
305300         MOVE ASC-COOP-ALW             TO ASC-COOP-ALW-OLD        30530000
305400                                          ASC-COOP-ALW-SAVE       30540000
305500     END-IF.                                                      30550000
305600     MOVE ASC-COOP-ALW-SAVE            TO ASC-COOP-ALW.           30560000
305700                                                                  30570000
305800     IF ASC-PROFIT-ALW     = SPACES                               30580000
305900         MOVE ' 0.00'                  TO ASC-PROFIT-ALW-OLD      30590000
306000                                          ASC-PROFIT-ALW-SAVE     30600000
306100       ELSE                                                       30610000
306200         MOVE ASC-PROFIT-ALW           TO ASC-PROFIT-ALW-OLD      30620000
306300                                          ASC-PROFIT-ALW-SAVE     30630000
306400     END-IF.                                                      30640000
306500     MOVE ASC-PROFIT-ALW-SAVE          TO ASC-PROFIT-ALW.         30650000
306600                                                                  30660000
306700     IF ASC-NEW-STORE-DAYS = SPACES                               30670000
306800       MOVE ZERO    TO ASC-NEW-STORE-DAYS-OLD                     30680000
306900                       ASC-NEW-STORE-DAYS-SAVE                    30690000
307000      ELSE                                                        30700000
307100       MOVE ASC-NEW-STORE-DAYS      TO ASC-NEW-STORE-DAYS-OLD     30710000
307200                                       ASC-NEW-STORE-DAYS-SAVE    30720000
307300     END-IF.                                                      30730000
307400     MOVE ASC-NEW-STORE-DAYS-SAVE TO ASC-NEW-STORE-DAYS.          30740000
307500                                                                  30750000
307600     IF ASC-TBL-TWR-DAYS   = SPACES                               30760000
307700       MOVE ZERO    TO ASC-TBL-TWR-DAYS-OLD                       30770000
307800                       ASC-TBL-TWR-DAYS-SAVE                      30780000
307900      ELSE                                                        30790000
308000       MOVE ASC-TBL-TWR-DAYS        TO ASC-TBL-TWR-DAYS-OLD       30800000
308100                                       ASC-TBL-TWR-DAYS-SAVE      30810000
308200     END-IF.                                                      30820000
308300     MOVE ASC-TBL-TWR-DAYS-SAVE   TO ASC-TBL-TWR-DAYS.            30830000
308400                                                                  30840000
308500     IF ASC-DRCT-SHP-PCT = SPACES                                 30850000
308600         MOVE ' 0.00'                  TO ASC-DRCT-SHP-PCT-OLD    30860000
308700                                          ASC-DRCT-SHP-PCT-SAVE   30870000
308800     ELSE                                                         30880000
308900         MOVE ASC-DRCT-SHP-PCT         TO ASC-DRCT-SHP-PCT-OLD    30890000
309000                                          ASC-DRCT-SHP-PCT-SAVE   30900000
309100     END-IF.                                                      30910000
309200     MOVE ASC-DRCT-SHP-PCT-SAVE        TO ASC-DRCT-SHP-PCT.       30920000
309300                                                                  30930000
309400     IF ASC-DRCT-SHP-RATE = SPACES                                30940000
309500         MOVE '   0.00'                TO ASC-DRCT-SHP-RATE-OLD   30950000
309600                                          ASC-DRCT-SHP-RATE-SAVE  30960000
309700       ELSE                                                       30970000
309800         MOVE ASC-DRCT-SHP-RATE        TO ASC-DRCT-SHP-RATE-OLD   30980000
309900                                          ASC-DRCT-SHP-RATE-SAVE  30990000
310000     END-IF.                                                      31000000
310100     MOVE ASC-DRCT-SHP-RATE-SAVE       TO ASC-DRCT-SHP-RATE.      31010000
310200                                                                  31020000
310300/                                                                 31030000
310400*----------------------------------------------------------------*31040000
310500*  CHECK TO SEE IF ANY FIELDS CHANGED.                           *31050000
310600*----------------------------------------------------------------*31060000
310700                                                                  31070000
310800 3600-CHECK-IF-FIELDS-CHANGED.                                    31080000
310900                                                                  31090000
311000     MOVE 'N'                    TO ASC-PRE-FIELDS-CHANGED-SW     31100000
311100                                    ASC-SUP-FIELDS-CHANGED-SW     31110000
311200                                    ASC-SVC-FIELDS-CHANGED-SW     31120000
311300                                    ASC-INC-FIELDS-CHANGED-SW.    31130000
311400                                                                  31140000
311500*----------------------------------------------------------------*31150000
311600*  IF ANY OF THE PRE-TICKETED OR SUPRESS TICKETING FIELDS CHANGE *31160000
311700*  BUT THE INDICATOR IS STILL SET TO 'N', DO NOT UPDATE, AND     *31170000
311800*  RESTORE ORIGINAL VALUES FOR DISPLAY                           *31180000
311900*----------------------------------------------------------------*31190000
312000     IF  ASC-PRE-TICK-IND        = ASC-PRE-TICK-IND-OLD           31200000
312100     AND ASC-PRE-TICK-LEAD-TIME  = ASC-PRE-TICK-LEAD-TIME-OLD     31210000
312200     AND ASC-PRE-TICK-MAKER      = ASC-PRE-TICK-MAKER-OLD         31220000
312300     AND ASC-PRE-TICK-BULK       = ASC-PRE-TICK-BULK-OLD          31230000
312400         CONTINUE                                                 31240000
312500     ELSE                                                         31250000
312600         SET ASC-PRE-FIELDS-CHANGED                               31260000
312700                                 TO TRUE                          31270000
312800         IF  ASC-PRE-TICK-IND     = 'N'                           31280000
312900         AND ASC-PRE-TICK-IND-OLD = 'N'                           31290000
313000             MOVE 'N'            TO ASC-PRE-FIELDS-CHANGED-SW     31300000
313100             MOVE ASC-PRE-TICK-LEAD-TIME-N-OLD                    31310000
313200                                 TO ALDTME1O                      31320000
313300                                    ASC-PRE-TICK-LEAD-TIME-N      31330000
313400             MOVE ASC-PRE-TICK-MAKER-OLD                          31340000
313500                                 TO ATKMKR1O                      31350000
313600                                    ASC-PRE-TICK-MAKER            31360000
313700             MOVE ASC-PRE-TICK-BULK-OLD                           31370000
313800                                 TO ABKTKT1O                      31380000
313900                                    ASC-PRE-TICK-BULK             31390000
314000         END-IF                                                   31400000
314100     END-IF.                                                      31410000
314200                                                                  31420000
314300     IF  ASC-SUP-TICK-IND        = ASC-SUP-TICK-IND-OLD           31430000
314400     AND ASC-SUP-TICK-LEAD-TIME  = ASC-SUP-TICK-LEAD-TIME-OLD     31440000
314500     AND ASC-SUP-TICK-MAKER      = ASC-SUP-TICK-MAKER-OLD         31450000
314600     AND ASC-SUP-TICK-BULK       = ASC-SUP-TICK-BULK-OLD          31460000
314700         CONTINUE                                                 31470000
314800     ELSE                                                         31480000
314900         SET ASC-SUP-FIELDS-CHANGED                               31490000
315000                                 TO TRUE                          31500000
315100         IF  ASC-SUP-TICK-IND     = 'N'                           31510000
315200         AND ASC-SUP-TICK-IND-OLD = 'N'                           31520000
315300             MOVE 'N'            TO ASC-SUP-FIELDS-CHANGED-SW     31530000
315400             MOVE ASC-SUP-TICK-LEAD-TIME-N-OLD                    31540000
315500                                 TO ALDTME2O                      31550000
315600                                    ASC-SUP-TICK-LEAD-TIME-N      31560000
315700             MOVE ASC-SUP-TICK-MAKER-OLD                          31570000
315800                                 TO ATKMKR2O                      31580000
315900                                    ASC-SUP-TICK-MAKER            31590000
316000             MOVE ASC-SUP-TICK-BULK-OLD                           31600000
316100                                 TO ABKTKT2O                      31610000
316200                                    ASC-SUP-TICK-BULK             31620000
316300         END-IF                                                   31630000
316400     END-IF.                                                      31640000
316500                                                                  31650000
316600*----------------------------------------------------------------*31660000
316700*  IF ANY OF THE SERVICE AND PROGRAMS FIELDS CHANGE,             *31670000
316800*  BUT THE INDICATOR IS STILL SET TO 'N', DO NOT UPDATE, AND     *31680000
316900*  RESTORE ORIGINAL VALUES FOR DISPLAY                           *31690000
317000*----------------------------------------------------------------*31700000
317100     IF  ASC-PACK-BY-STORE-Y-N   = ASC-PACK-BY-STORE-Y-N-OLD      31710000
317200     AND ASC-HANGER-INSERT-Y-N   = ASC-HANGER-INSERT-Y-N-OLD      31720000
317300     AND ASC-DC-SPLIT-IND        = ASC-DC-SPLIT-IND-OLD           31730000
317400     AND ASC-DC-SPLIT-DAYS       = ASC-DC-SPLIT-DAYS-OLD          31740000
317500     AND ASC-SUPPLIES-UPC-Y-N    = ASC-SUPPLIES-UPC-Y-N-OLD       31750000
317600     AND ASC-DRCT-SHP-IND        = ASC-DRCT-SHP-IND-OLD           31760000
317700     AND ASC-DRCT-SHP-PCT        = ASC-DRCT-SHP-PCT-OLD           31770000
317800     AND ASC-DRCT-SHP-RATE       = ASC-DRCT-SHP-RATE-OLD          31780000
317900     AND ASC-RFID-STATUS-N-T-C   = ASC-RFID-STATUS-N-T-C-OLD      31790000
318000         CONTINUE                                                 31800000
318100     ELSE                                                         31810000
318200         SET ASC-SVC-FIELDS-CHANGED                               31820000
318300                                 TO TRUE                          31830000
318400         IF  ASC-PACK-BY-STORE-Y-N     = 'N'                      31840000
318500         AND ASC-PACK-BY-STORE-Y-N-OLD = 'N'                      31850000
318600         AND ASC-HANGER-INSERT-Y-N     = 'N'                      31860000
318700         AND ASC-HANGER-INSERT-Y-N-OLD = 'N'                      31870000
318800         AND ASC-SUPPLIES-UPC-Y-N      = 'N'                      31880000
318900         AND ASC-SUPPLIES-UPC-Y-N-OLD  = 'N'                      31890000
319000         AND ASC-DC-SPLIT-IND          = 'N'                      31900000
319100         AND ASC-DC-SPLIT-IND-OLD      = 'N'                      31910000
319200         AND ASC-DC-SPLIT-DAYS         = ZERO                     31920000
319300         AND ASC-DC-SPLIT-DAYS-OLD     = ZERO                     31930000
319400         AND ASC-DRCT-SHP-IND          = 'N'                      31940000
319500         AND ASC-DRCT-SHP-IND-OLD      = 'N'                      31950000
319600         AND ASC-RFID-STATUS-N-T-C     = 'N'                      31960000
319700         AND ASC-RFID-STATUS-N-T-C-OLD  = 'N'                     31970000
319800             MOVE 'N'            TO ASC-SVC-FIELDS-CHANGED-SW     31980000
319900             MOVE ASC-DRCT-SHP-PCT-N-OLD                          31990000
320000                                 TO ADIRPCTO                      32000000
320100                                    ASC-DRCT-SHP-PCT-N            32010000
320200             MOVE ASC-DRCT-SHP-RATE-N-OLD                         32020000
320300                                 TO ADIRRTEO                      32030000
320400                                    ASC-DRCT-SHP-RATE-N           32040000
320500         END-IF                                                   32050000
320600     END-IF.                                                      32060000
320700                                                                  32070000
320800*----------------------------------------------------------------*32080000
320900*  IF ANY OF THE INCENTIVES FIELDS CHANGE,                       *32090000
321000*  BUT THE INDICATOR IS STILL SET TO 'N', DO NOT UPDATE, AND     *32100000
321100*  RESTORE ORIGINAL VALUES FOR DISPLAY                           *32110000
321200*----------------------------------------------------------------*32120000
321300     IF  ASC-NEW-STORE-DISC-IND  = ASC-NEW-STORE-DISC-IND-OLD     32130000
321400     AND ASC-NEW-STORE-DISC      = ASC-NEW-STORE-DISC-OLD         32140000
321500     AND ASC-NEW-STORE-DAYS      = ASC-NEW-STORE-DAYS-OLD         32150000
321600     AND ASC-MOS-DISC-IND        = ASC-MOS-DISC-IND-OLD           32160000
321700     AND ASC-MOS-DISC            = ASC-MOS-DISC-OLD               32170000
321800     AND ASC-TRADE-DISC-IND      = ASC-TRADE-DISC-IND-OLD         32180000
321900     AND ASC-TRADE-DISC          = ASC-TRADE-DISC-OLD             32190000
322000     AND ASC-ADVTS-DISC-IND      = ASC-ADVTS-DISC-IND-OLD         32200000
322100     AND ASC-ADVTS-DISC          = ASC-ADVTS-DISC-OLD             32210000
322200     AND ASC-COOP-ALW-IND        = ASC-COOP-ALW-IND-OLD           32220000
322300     AND ASC-COOP-ALW            = ASC-COOP-ALW-OLD               32230000
322400     AND ASC-PROFIT-ALW-IND      = ASC-PROFIT-ALW-IND-OLD         32240000
322500     AND ASC-PROFIT-ALW          = ASC-PROFIT-ALW-OLD             32250000
322600     AND ASC-TBL-TWR-IND         = ASC-TBL-TWR-IND-OLD            32260000
322700     AND ASC-TBL-TWR-DAYS        = ASC-TBL-TWR-DAYS-OLD           32270000
322800         CONTINUE                                                 32280000
322900     ELSE                                                         32290000
323000         SET ASC-INC-FIELDS-CHANGED                               32300000
323100                                 TO TRUE                          32310000
323200         IF  ASC-NEW-STORE-DISC-IND     = 'N'                     32320000
323300         AND ASC-NEW-STORE-DISC-IND-OLD = 'N'                     32330000
323400         AND ASC-MOS-DISC-IND           = 'N'                     32340000
323500         AND ASC-MOS-DISC-IND-OLD       = 'N'                     32350000
323600         AND ASC-TRADE-DISC-IND         = 'N'                     32360000
323700         AND ASC-TRADE-DISC-IND-OLD     = 'N'                     32370000
323800         AND ASC-ADVTS-DISC-IND         = 'N'                     32380000
323900         AND ASC-ADVTS-DISC-IND-OLD     = 'N'                     32390000
324000         AND ASC-COOP-ALW-IND           = 'N'                     32400000
324100         AND ASC-COOP-ALW-IND-OLD       = 'N'                     32410000
324200         AND ASC-PROFIT-ALW-IND         = 'N'                     32420000
324300         AND ASC-PROFIT-ALW-IND-OLD     = 'N'                     32430000
324400         AND ASC-TBL-TWR-IND            = 'N'                     32440000
324500         AND ASC-TBL-TWR-IND-OLD        = 'N'                     32450000
324600             MOVE 'N'            TO ASC-INC-FIELDS-CHANGED-SW     32460000
324700             MOVE ASC-NEW-STORE-DISC-N-OLD                        32470000
324800                                 TO ANEWPCTO                      32480000
324900                                    ASC-NEW-STORE-DISC-N          32490000
325000             MOVE ASC-NEW-STORE-DAYS-N-OLD                        32500000
325100                                 TO ANEWDAYO                      32510000
325200                                    ASC-NEW-STORE-DAYS-N          32520000
325300             MOVE ASC-MOS-DISC-N-OLD                              32530000
325400                                 TO AMOSPCTO                      32540000
325500                                    ASC-MOS-DISC-N                32550000
325600             MOVE ASC-TRADE-DISC-N-OLD                            32560000
325700                                 TO ATRDPCTO                      32570000
325800                                    ASC-TRADE-DISC-N              32580000
325900             MOVE ASC-ADVTS-DISC-N-OLD                            32590000
326000                                 TO AADVPCTO                      32600000
326100                                    ASC-ADVTS-DISC-N              32610000
326200             MOVE ASC-COOP-ALW-N-OLD                              32620000
326300                                 TO ACOPPCTO                      32630000
326400                                    ASC-COOP-ALW-N                32640000
326500             MOVE ASC-PROFIT-ALW-N-OLD                            32650000
326600                                 TO APFTPCTO                      32660000
326700                                    ASC-PROFIT-ALW-N              32670000
326800             MOVE ASC-TBL-TWR-DAYS-N-OLD                          32680000
326900                                 TO ATBLDAYO                      32690000
327000                                    ASC-TBL-TWR-DAYS-N            32700000
327100         END-IF                                                   32710000
327200     END-IF.                                                      32720000
327300                                                                  32730000
327400*----------------------------------------------------------------*32740000
327500*  DETERMINE IF AN INTERFACE TO RMS IS NEEDED.  IF ANY OF THE    *32750000
327600*  BELOW FIELDS HAVE CHANGED, IT IS POSSIBLE THAT RMS NEEDS TO   *32760000
327700*  BE UPDATED.  IF THE VENDOR ALREADY EXISTS IN RMS AND THE      *32770000
327800*  VENDOR IS A SUPPLIER (PRIM-TYP-CDE = 'M'), THEN SET SWITCH    *32780000
327900*  FOR INTERROGATION LATER IN THIS PROGRAM AFTER A SUCCESSFUL    *32790000
328000*  UPDATE TO DB2.                                                *32800000
328100*----------------------------------------------------------------*32810000
328200     IF ASC-PACK-BY-STORE-Y-N  =  ASC-PACK-BY-STORE-Y-N-OLD  AND  32820000
328300        ASC-HANGER-INSERT-Y-N  =  ASC-HANGER-INSERT-Y-N-OLD  AND  32830000
328400        ASC-PRE-TICK-LEAD-TIME =  ASC-PRE-TICK-LEAD-TIME-OLD AND  32840000
328500        ASC-PRE-TICK-MAKER     =  ASC-PRE-TICK-MAKER-OLD     AND  32850000
328600        ASC-PRE-TICK-BULK      =  ASC-PRE-TICK-BULK-OLD      AND  32860000
328700        ASC-NEW-STORE-DISC     =  ASC-NEW-STORE-DISC-OLD     AND  32870000
328800        ASC-NEW-STORE-DAYS     =  ASC-NEW-STORE-DAYS-OLD     AND  32880000
328900        ASC-MOS-DISC           =  ASC-MOS-DISC-OLD           AND  32890000
329000        ASC-TRADE-DISC         =  ASC-TRADE-DISC-OLD         AND  32900000
329100        ASC-ADVTS-DISC         =  ASC-ADVTS-DISC-OLD         AND  32910000
329200        ASC-DC-SPLIT-IND       =  ASC-DC-SPLIT-IND-OLD       AND  32920000
329300        ASC-DC-SPLIT-DAYS      =  ASC-DC-SPLIT-DAYS-OLD      AND  32930000
329400        ASC-COOP-ALW           =  ASC-COOP-ALW-OLD           AND  32940000
329500        ASC-PROFIT-ALW         =  ASC-PROFIT-ALW-OLD         AND  32950000
329600        ASC-TBL-TWR-DAYS       =  ASC-TBL-TWR-DAYS-OLD       AND  32960000
329700        ASC-RFID-STATUS-N-T-C  =  ASC-RFID-STATUS-N-T-C-OLD       32970000
329800         CONTINUE                                                 32980000
329900     ELSE                                                         32990000
330000         IF ASC-VND-IN-RMS-IND = 'Y'   AND                        33000000
330100            ASC-PRIM-TYP-CDE   = 'M'                              33010000
330200             SET PS-RMS-INTERFACE-NEEDED  TO TRUE                 33020000
330300         END-IF                                                   33030000
330400     END-IF.                                                      33040000
330500                                                                  33050000
330600     IF (ASC-PRE-TICK-IND     = 'N') AND                          33060000
330700        (ASC-PRE-TICK-IND-OLD = 'Y' OR 'P')                       33070000
330800        IF ASC-VND-IN-RMS-IND = 'Y' AND                           33080000
330900           ASC-PRIM-TYP-CDE   = 'M'                               33090000
331000           SET PS-RMS-INTERFACE-NEEDED                            33100000
331100               PS-PRE-TICK-CHANGED-TO-N  TO TRUE                  33110000
331200        END-IF                                                    33120000
331300     END-IF.                                                      33130000
331400/                                                                 33140000
331500*----------------------------------------------------------------*33150000
331600 4000-BUILD-INITIAL-PANEL.                                        33160000
331700                                                                  33170000
331800     INITIALIZE ASC-SCREEN-FIELDS.                                33180000
331900     INITIALIZE ASC-OLD-SCREEN-VALUES.                            33190000
332000                                                                  33200000
332100     SET PS-NO-ERROR                                              33210000
332200         DP030-SET-CURSOR-APPL-1 TO TRUE.                         33220000
332300     MOVE -1                     TO ATKIND1L.                     33230000
332400                                                                  33240000
332500     MOVE 'N'                    TO ASC-PRE-TICK-IND              33250000
332600                                    ASC-PACK-BY-STORE-Y-N         33260000
332700                                    ASC-HANGER-INSERT-Y-N         33270000
332800                                    ASC-DRCT-SHP-IND              33280000
332900                                    ASC-SUPPLIES-UPC-Y-N          33290000
333000                                    ASC-SUP-TICK-IND              33300000
333100                                    ASC-NEW-STORE-DISC-IND        33310000
333200                                    ASC-MOS-DISC-IND              33320000
333300                                    ASC-TRADE-DISC-IND            33330000
333400                                    ASC-ADVTS-DISC-IND            33340000
333500                                    ASC-COOP-ALW-IND              33350000
333600                                    ASC-PROFIT-ALW-IND            33360000
333700                                    ASC-TBL-TWR-IND               33370000
333800                                    ASC-RFID-STATUS-N-T-C.        33380000
333900                                                                  33390000
334000     PERFORM 4010-GET-HEADING-INFO.                               33400000
334100                                                                  33410000
334200     PERFORM 4020-GET-PRE-TICKET-INFO.                            33420000
334300                                                                  33430000
334400     IF  SQLCODE = +0                                             33440000
334500         MOVE 'Y'                TO ASC-PRE-TICK-IND              33450000
334600         IF  DN-PARTIAL-IND NOT = -1                              33460000
334700             MOVE VNDAGR-PARTIAL-IND                              33470000
334800                                 TO ASC-PRE-TICK-IND              33480000
334900         END-IF                                                   33490000
335000         IF  DN-LEADTIME-DAYS-QTY = -1                            33500000
335100             MOVE ZEROES         TO ASC-PRE-TICK-LEAD-TIME-N      33510000
335200         ELSE                                                     33520000
335300             MOVE VNDAGR-LEADTIME-DAYS-QTY                        33530000
335400                                 TO ASC-PRE-TICK-LEAD-TIME-N      33540000
335500         END-IF                                                   33550000
335600         IF  DN-TKT-MKR-IND = -1                                  33560000
335700             MOVE SPACES         TO ASC-PRE-TICK-MAKER            33570000
335800         ELSE                                                     33580000
335900             MOVE VNDAGR-TKT-MKR-IND                              33590000
336000                                 TO ASC-PRE-TICK-MAKER            33600000
336100         END-IF                                                   33610000
336200         IF  DN-BULK-STK-TKT-IND = -1                             33620000
336300             MOVE SPACES         TO ASC-PRE-TICK-BULK             33630000
336400         ELSE                                                     33640000
336500             MOVE VNDAGR-BULK-STK-TKT-IND                         33650000
336600                                 TO ASC-PRE-TICK-BULK             33660000
336700         END-IF                                                   33670000
336800     ELSE                                                         33680000
336900         MOVE 'N'                TO ASC-PRE-TICK-IND              33690000
337000     END-IF.                                                      33700000
337100                                                                  33710000
337200     PERFORM 4030-GET-SUP-TICKET-INFO.                            33720000
337300                                                                  33730000
337400     IF  SQLCODE = +0                                             33740000
337500         MOVE 'Y'                TO ASC-SUP-TICK-IND              33750000
337600         IF  DN-PARTIAL-IND NOT = -1                              33760000
337700             MOVE VNDAGR-PARTIAL-IND                              33770000
337800                                 TO ASC-SUP-TICK-IND              33780000
337900         END-IF                                                   33790000
338000         IF  DN-LEADTIME-DAYS-QTY = -1                            33800000
338100             MOVE ZEROES         TO ASC-SUP-TICK-LEAD-TIME-N      33810000
338200         ELSE                                                     33820000
338300             MOVE VNDAGR-LEADTIME-DAYS-QTY                        33830000
338400                                 TO ASC-SUP-TICK-LEAD-TIME-N      33840000
338500         END-IF                                                   33850000
338600         IF  DN-TKT-MKR-IND = -1                                  33860000
338700             MOVE SPACES         TO ASC-SUP-TICK-MAKER            33870000
338800         ELSE                                                     33880000
338900             MOVE VNDAGR-TKT-MKR-IND                              33890000
339000                                 TO ASC-SUP-TICK-MAKER            33900000
339100         END-IF                                                   33910000
339200         IF  DN-BULK-STK-TKT-IND = -1                             33920000
339300             MOVE SPACES         TO ASC-SUP-TICK-BULK             33930000
339400         ELSE                                                     33940000
339500             MOVE VNDAGR-BULK-STK-TKT-IND                         33950000
339600                                 TO ASC-SUP-TICK-BULK             33960000
339700         END-IF                                                   33970000
339800     ELSE                                                         33980000
339900         MOVE 'N'                TO ASC-SUP-TICK-IND              33990000
340000     END-IF.                                                      34000000
340100                                                                  34010000
340200     MOVE 'N'                    TO PS-EOF-SERVICE-CSR-SW.        34020000
340300                                                                  34030000
340400     PERFORM 4040-OPEN-SERVICE-CSR.                               34040000
340500     PERFORM 4050-FETCH-SERVICE-CSR.                              34050000
340600                                                                  34060000
340700     PERFORM UNTIL PS-EOF-SERVICE-CSR                             34070000
340800*--- PRB0048560 START CASE 1                                      34080000
340900*      IF DN-CHRG-PCT = -1                                        34090000
341000*          MOVE ZERO  TO ASC-DRCT-SHP-PCT-N                       34100000
341100*      ELSE                                                       34110000
341200*          COMPUTE ASC-DRCT-SHP-PCT-N =                           34120000
341300*                            VNDAGR-CHRG-PCT * 100                34130000
341400*          MOVE ASC-DRCT-SHP-PCT-N TO PV-PCT-FORMAT               34140000
341500*          MOVE PV-PCT-FORMAT TO ASC-DRCT-SHP-PCT                 34150000
341600*      END-IF                                                     34160000
341700*      IF DN-CHRG-AMT = -1                                        34170000
341800*           MOVE ZERO  TO ASC-DRCT-SHP-RATE-N                     34180000
341900*      ELSE                                                       34190000
342000*           MOVE VNDAGR-CHRG-AMT  TO ASC-DRCT-SHP-RATE-N          34200000
342100*      END-IF                                                     34210000
342200*--- PRB0048560 CASE 1 END                                        34220000
342300       EVALUATE PV-TABLE-NAME                                     34230000
342400          WHEN 'TSERTYP'                                          34240000
342500             EVALUATE SERTYP-SERVICE-ID                           34250000
342600                WHEN 2                                            34260000
342700                   MOVE 'Y'       TO ASC-HANGER-INSERT-Y-N        34270000
342800                WHEN 3                                            34280000
342900                   MOVE 'Y'       TO ASC-SUPPLIES-UPC-Y-N         34290000
343000                WHEN 4                                            34300000
343100                   MOVE 'Y'       TO ASC-PACK-BY-STORE-Y-N        34310000
343200                WHEN 10                                           34320000
343300*--- PRB0048560 START CASE 2                                      34330000
343400                  IF DN-CHRG-PCT = -1                             34340000
343500                     MOVE ZERO  TO ASC-DRCT-SHP-PCT-N             34350000
343600                  ELSE                                            34360000
343700                     COMPUTE ASC-DRCT-SHP-PCT-N =                 34370000
343800                             VNDAGR-CHRG-PCT * 100                34380000
343900                     MOVE ASC-DRCT-SHP-PCT-N TO PV-PCT-FORMAT     34390000
344000                     MOVE PV-PCT-FORMAT TO ASC-DRCT-SHP-PCT       34400000
344100                  END-IF                                          34410000
344200                  IF DN-CHRG-AMT = -1                             34420000
344300                     MOVE ZERO   TO ASC-DRCT-SHP-RATE-N           34430000
344400                  ELSE                                            34440000
344500                     MOVE VNDAGR-CHRG-AMT                         34450000
344510                                 TO ASC-DRCT-SHP-RATE-N           34451000
344520*--- PRB0048560 START CASE 3                                      34452000
344530                     MOVE ASC-DRCT-SHP-RATE-N                     34453000
344540                                 TO ASC-DRCT-SHP-RATE-ONE-N       34454000
344550                     MOVE ASC-DRCT-SHP-RATE-ONE                   34455000
344560                                 TO ASC-DRCT-SHP-RATE             34456000
344570*--- PRB0048560 CASE 3 END                                        34457000
344580                  END-IF                                          34458000
344590*--- PRB0048560 CASE 2 END                                        34459000
344600                   MOVE 'Y'       TO ASC-DRCT-SHP-IND             34460000
344700                   IF ASC-DRCT-SHP-PCT-N = 0 AND                  34470000
344800                      ASC-DRCT-SHP-RATE-N = 0                     34480000
344900                        MOVE 'N' TO ASC-DRCT-SHP-IND              34490000
345000                   END-IF                                         34500000
345100                WHEN 11                                           34510000
345200                   MOVE 'T'       TO ASC-RFID-STATUS-N-T-C        34520000
345300                WHEN 12                                           34530000
345400                   MOVE 'C'       TO ASC-RFID-STATUS-N-T-C        34540000
345500             END-EVALUATE                                         34550000
345600          WHEN 'TPGMTYP'                                          34560000
345700             EVALUATE SERTYP-SERVICE-ID                           34570000
345800                WHEN 5                                            34580000
345900                   IF  VNDAGR-EXT-PAY-DAYS-QTY = 0                34590000
346000                       MOVE 'Y'   TO ASC-DC-SPLIT-IND             34600000
346100                       MOVE ZERO  TO ASC-DC-SPLIT-DAYS            34610000
346200                   ELSE                                           34620000
346300                       MOVE 'N'   TO ASC-DC-SPLIT-IND             34630000
346400                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               34640000
346500                                  TO ASC-DC-SPLIT-DAYS            34650000
346600                   END-IF                                         34660000
346700             END-EVALUATE                                         34670000
346800          WHEN 'TINCTYP'                                          34680000
346900             EVALUATE SERTYP-SERVICE-ID                           34690000
347000                WHEN 1                                            34700000
347100                   MOVE 'Y'       TO ASC-NEW-STORE-DISC-IND       34710000
347200                   IF  DN-DISCOUNT-PCT = -1                       34720000
347300                       MOVE ZERO  TO ASC-NEW-STORE-DISC-N         34730000
347400                   ELSE                                           34740000
347500                       COMPUTE ASC-NEW-STORE-DISC-N =             34750000
347600                               VNDAGR-DISCOUNT-PCT * 100          34760000
347700                       MOVE ASC-NEW-STORE-DISC-N TO PV-PCT-FORMAT 34770000
347800                       MOVE PV-PCT-FORMAT TO ASC-NEW-STORE-DISC   34780000
347900                   END-IF                                         34790000
348000                   IF  DN-EXT-PAY-DAYS-QTY = -1                   34800000
348100                       MOVE ZERO  TO ASC-NEW-STORE-DAYS-N         34810000
348200                   ELSE                                           34820000
348300                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               34830000
348400                                  TO ASC-NEW-STORE-DAYS-N         34840000
348500                   END-IF                                         34850000
348600                   IF ASC-NEW-STORE-DISC-N = 0 AND                34860000
348700                      ASC-NEW-STORE-DAYS-N = 0                    34870000
348800                       MOVE 'N' TO ASC-NEW-STORE-DISC-IND         34880000
348900                   END-IF                                         34890000
349000                   MOVE VNDAGR-EFFECTIVE-DATE                     34900000
349100                                TO PV-EFFECTIVE-DATE              34910000
349200                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             34920000
349300                   MOVE PV-EFF-DATE                               34930000
349400                                  TO ASC-NEW-STORE-EFFDATE        34940000
349500                WHEN 7                                            34950000
349600                   MOVE 'Y'       TO ASC-MOS-DISC-IND             34960000
349700                   IF  DN-DISCOUNT-PCT = -1                       34970000
349800                       MOVE ZERO  TO ASC-MOS-DISC-N               34980000
349900                   ELSE                                           34990000
350000                       COMPUTE ASC-MOS-DISC-N =                   35000000
350100                               VNDAGR-DISCOUNT-PCT * 100          35010000
350200                       MOVE ASC-MOS-DISC-N TO PV-PCT-FORMAT       35020000
350300                       MOVE PV-PCT-FORMAT TO ASC-MOS-DISC         35030000
350400                   END-IF                                         35040000
350500                   MOVE VNDAGR-EFFECTIVE-DATE                     35050000
350600                                TO PV-EFFECTIVE-DATE              35060000
350700                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35070000
350800                   MOVE PV-EFF-DATE                               35080000
350900                                  TO ASC-MOS-DISC-EFFDATE         35090000
351000                WHEN 8                                            35100000
351100                   MOVE 'Y'       TO ASC-TRADE-DISC-IND           35110000
351200                   IF  DN-DISCOUNT-PCT = -1                       35120000
351300                       MOVE ZERO  TO ASC-TRADE-DISC-N             35130000
351400                   ELSE                                           35140000
351500                       COMPUTE ASC-TRADE-DISC-N =                 35150000
351600                               VNDAGR-DISCOUNT-PCT * 100          35160000
351700                       MOVE ASC-TRADE-DISC-N TO PV-PCT-FORMAT     35170000
351800                       MOVE PV-PCT-FORMAT TO ASC-TRADE-DISC       35180000
351900                   END-IF                                         35190000
352000                   MOVE VNDAGR-EFFECTIVE-DATE                     35200000
352100                                TO PV-EFFECTIVE-DATE              35210000
352200                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35220000
352300                   MOVE PV-EFF-DATE                               35230000
352400                                  TO ASC-TRADE-DISC-EFFDATE       35240000
352500                WHEN 9                                            35250000
352600                   MOVE 'Y'       TO ASC-ADVTS-DISC-IND           35260000
352700                   IF  DN-DISCOUNT-PCT = -1                       35270000
352800                       MOVE ZERO  TO ASC-ADVTS-DISC-N             35280000
352900                   ELSE                                           35290000
353000                       COMPUTE ASC-ADVTS-DISC-N =                 35300000
353100                               VNDAGR-DISCOUNT-PCT * 100          35310000
353200                       MOVE ASC-ADVTS-DISC-N TO PV-PCT-FORMAT     35320000
353300                       MOVE PV-PCT-FORMAT TO ASC-ADVTS-DISC       35330000
353400                   END-IF                                         35340000
353500                   MOVE VNDAGR-EFFECTIVE-DATE                     35350000
353600                                TO PV-EFFECTIVE-DATE              35360000
353700                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35370000
353800                   MOVE PV-EFF-DATE                               35380000
353900                                  TO ASC-ADVTS-DISC-EFFDATE       35390000
354000                WHEN 10                                           35400000
354100                   MOVE 'Y'       TO ASC-COOP-ALW-IND             35410000
354200                   IF  DN-DISCOUNT-PCT = -1                       35420000
354300                       MOVE ZERO  TO ASC-COOP-ALW-N               35430000
354400                   ELSE                                           35440000
354500                       COMPUTE ASC-COOP-ALW-N =                   35450000
354600                               VNDAGR-DISCOUNT-PCT * 100          35460000
354700                       MOVE ASC-COOP-ALW-N TO PV-PCT-FORMAT       35470000
354800                       MOVE PV-PCT-FORMAT TO ASC-COOP-ALW         35480000
354900                   END-IF                                         35490000
355000                   MOVE VNDAGR-EFFECTIVE-DATE                     35500000
355100                                TO PV-EFFECTIVE-DATE              35510000
355200                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35520000
355300                   MOVE PV-EFF-DATE                               35530000
355400                                  TO ASC-COOP-ALW-EFFDATE         35540000
355500                WHEN 11                                           35550000
355600                   MOVE 'Y'       TO ASC-PROFIT-ALW-IND           35560000
355700                   IF  DN-DISCOUNT-PCT = -1                       35570000
355800                       MOVE ZERO  TO ASC-PROFIT-ALW-N             35580000
355900                   ELSE                                           35590000
356000                       COMPUTE ASC-PROFIT-ALW-N =                 35600000
356100                               VNDAGR-DISCOUNT-PCT * 100          35610000
356200                       MOVE ASC-PROFIT-ALW-N TO PV-PCT-FORMAT     35620000
356300                       MOVE PV-PCT-FORMAT TO ASC-PROFIT-ALW       35630000
356400                   END-IF                                         35640000
356500                   MOVE VNDAGR-EFFECTIVE-DATE                     35650000
356600                                TO PV-EFFECTIVE-DATE              35660000
356700                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35670000
356800                   MOVE PV-EFF-DATE                               35680000
356900                                  TO ASC-PROFIT-ALW-EFFDATE       35690000
357000                WHEN 12                                           35700000
357100                   MOVE 'Y'       TO ASC-TBL-TWR-IND              35710000
357200                   IF  DN-EXT-PAY-DAYS-QTY = -1                   35720000
357300                       MOVE ZERO  TO ASC-TBL-TWR-DAYS-N           35730000
357400                   ELSE                                           35740000
357500                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               35750000
357600                                  TO ASC-TBL-TWR-DAYS-N           35760000
357700                   END-IF                                         35770000
357800                   MOVE VNDAGR-EFFECTIVE-DATE                     35780000
357900                                TO PV-EFFECTIVE-DATE              35790000
358000                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             35800000
358100                   MOVE PV-EFF-DATE                               35810000
358200                                  TO ASC-TBL-TWR-EFFDATE          35820000
358300             END-EVALUATE                                         35830000
358400         END-EVALUATE                                             35840000
358500         PERFORM 4050-FETCH-SERVICE-CSR                           35850000
358600     END-PERFORM.                                                 35860000
358700                                                                  35870000
358800     PERFORM 4060-CLOSE-SERVICE-CSR.                              35880000
358900                                                                  35890000
359000     IF  PS-NO-ERROR                                              35900000
359100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     35910000
359200     END-IF.                                                      35920000
359300                                                                  35930000
359400/                                                                 35940000
359500*----------------------------------------------------------------*35950000
359600*    FORMAT THE EFFECTIVE DATE FROM TVNDAGR FOR SCREEN DISPLAY   *35960000
359700*----------------------------------------------------------------*35970000
359800 4005-FORMAT-EFFECTIVE-DATE.                                      35980000
359900                                                                  35990000
360000*    MOVE VNDAGR-EFFECTIVE-DATE TO PV-EFFECTIVE-DATE.             36000000
360100     MOVE PV-EFFECTIVE-MM       TO PV-EFF-MM.                     36010000
360200     MOVE PV-EFFECTIVE-DD       TO PV-EFF-DD.                     36020000
360300     MOVE PV-EFFECTIVE-CCYY     TO PV-EFF-CCYY.                   36030000
360400     MOVE '/'                   TO PV-EFF-SLASH1                  36040000
360500                                   PV-EFF-SLASH2.                 36050000
360600                                                                  36060000
360700/                                                                 36070000
360800*----------------------------------------------------------------*36080000
360900*    GET THE VENDOR NAME AND DUNS NUMBER                         *36090000
361000*----------------------------------------------------------------*36100000
361100 4010-GET-HEADING-INFO.                                           36110000
361200                                                                  36120000
361300     PERFORM                                                      36130000
361400         WITH TEST AFTER                                          36140000
361500         VARYING PV-RETRY-COUNTER                                 36150000
361600         FROM 1 BY 1                                              36160000
361700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36170000
361800             OR (SQLCODE = +0)                                    36180000
361900             OR (SQLCODE = +100))                                 36190000
362000                                                                  36200000
362100         EXEC SQL                                                 36210000
362200              SELECT A.INHOUSE_NBR                                36220000
362300                    ,B.ENT_NAME_DESC                              36230000
362400                    ,C.DUN_NBR                                    36240000
362500                    ,C.STATUS_CDE                                 36250000
362600                    ,C.EDI_PO_PREPK_CDE                           36260000
362700                    ,C.PRIM_TYP_CDE                               36270000
362800                    ,C.VND_IN_RMS_IND                             36280000
362900                INTO :VNDDPT-INHOUSE-NBR                          36290000
363000                    ,:ENTNME-ENT-NAME-DESC                        36300000
363100                    ,:EXTENT-DUN-NBR                              36310000
363200                    ,:EXTENT-STATUS-CDE                           36320000
363300                    ,:EXTENT-EDI-PO-PREPK-CDE                     36330000
363400                    ,:EXTENT-PRIM-TYP-CDE                         36340000
363500                    ,:EXTENT-VND-IN-RMS-IND                       36350000
363600                FROM TVNDDPT A                                    36360000
363700                    ,TENTNME B                                    36370000
363800                    ,TEXTENT C                                    36380000
363900               WHERE A.DEPT_NBR = :DK-DEPT-NBR                    36390000
364000                 AND A.ENT_ID   = :DK-ENT-ID                      36400000
364100                 AND B.SEQ_NBR  =                                 36410000
364200                     (SELECT MAX(SEQ_NBR)                         36420000
364300                        FROM TENTNME                              36430000
364400                       WHERE ENT_ID   = :DK-ENT-ID                36440000
364500                         AND TYPE_CDE = '01')                     36450000
364600                 AND B.TYPE_CDE = '01'                            36460000
364700                 AND A.ENT_ID   = B.ENT_ID                        36470000
364800                 AND A.ENT_ID   = C.ENT_ID                        36480000
364900         END-EXEC                                                 36490000
365000                                                                  36500000
365100         EVALUATE TRUE                                            36510000
365200             WHEN SQLCODE = +0                                    36520000
365300                  MOVE VNDDPT-INHOUSE-NBR                         36530000
365400                                  TO ASC-KEY-INHOUSE-NBR          36540000
365500                  MOVE ENTNME-ENT-NAME-DESC                       36550000
365600                                  TO ASC-ENT-NAME-DESC            36560000
365700                  MOVE EXTENT-DUN-NBR                             36570000
365800                                  TO ASC-DUN-NBR                  36580000
365900                  MOVE EXTENT-STATUS-CDE                          36590000
366000                                  TO ASC-STATUS-CDE               36600000
366100                  MOVE EXTENT-EDI-PO-PREPK-CDE                    36610000
366200                                  TO ASC-PO-PREPK-CDE             36620000
366300                  MOVE EXTENT-PRIM-TYP-CDE                        36630000
366400                                  TO ASC-PRIM-TYP-CDE             36640000
366500                  MOVE EXTENT-VND-IN-RMS-IND                      36650000
366600                                  TO ASC-VND-IN-RMS-IND           36660000
366700                                                                  36670000
366800             WHEN SQLCODE = +100                                  36680000
366900             WHEN SQLCODE = -904                                  36690000
367000             WHEN SQLCODE = -913                                  36700000
367100                  CONTINUE                                        36710000
367200                                                                  36720000
367300             WHEN SQLWARN0 NOT = SPACES                           36730000
367400             WHEN SQLCODE < +0                                    36740000
367500             WHEN SQLCODE > +0                                    36750000
367600                  MOVE '4010-GET-HEADER-INFO'                     36760000
367700                                  TO DP013-PARAGRAPH              36770000
367800                  MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'      36780000
367900                                  TO DP013-MESSAGE-TEXT (1)       36790000
368000                  MOVE SQLCA      TO DP013-SQLCA                  36800000
368100                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     36810000
368200                  SET DP013-DB2-ABEND                             36820000
368300                      DP013-XCTL-DISPLAY-RESTART                  36830000
368400                                  TO TRUE                         36840000
368500                  PERFORM DP013-0000-PROCESS-ABEND                36850000
368600         END-EVALUATE                                             36860000
368700     END-PERFORM.                                                 36870000
368800                                                                  36880000
368900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36890000
369000         MOVE '4010-GET-HEADER-ID'                                36900000
369100                                  TO DP013-PARAGRAPH              36910000
369200         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    36920000
369300                                  TO DP013-MESSAGE-TEXT (1)       36930000
369400         MOVE SQLCA               TO DP013-SQLCA                  36940000
369500         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     36950000
369600         SET DP013-DB2-ABEND                                      36960000
369700             DP013-XCTL-DISPLAY-RESTART                           36970000
369800                                  TO TRUE                         36980000
369900         PERFORM DP013-0000-PROCESS-ABEND                         36990000
370000     END-IF.                                                      37000000
370100                                                                  37010000
370200/                                                                 37020000
370300*----------------------------------------------------------------*37030000
370400*    GET PRE-TICKETING INFORMATION                               *37040000
370500*----------------------------------------------------------------*37050000
370600 4020-GET-PRE-TICKET-INFO.                                        37060000
370700                                                                  37070000
370800     PERFORM                                                      37080000
370900         WITH TEST AFTER                                          37090000
371000         VARYING PV-RETRY-COUNTER                                 37100000
371100         FROM 1 BY 1                                              37110000
371200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37120000
371300             OR (SQLCODE = +0)                                    37130000
371400             OR (SQLCODE = +100))                                 37140000
371500                                                                  37150000
371600         EXEC SQL                                                 37160000
371700              SELECT A.LEADTIME_DAYS_QTY                          37170000
371800                    ,A.TKT_MKR_IND                                37180000
371900                    ,A.BULK_STK_TKT_IND                           37190000
372000                    ,A.PARTIAL_IND                                37200000
372100                INTO :VNDAGR-LEADTIME-DAYS-QTY                    37210000
372200                        :DN-LEADTIME-DAYS-QTY                     37220000
372300                    ,:VNDAGR-TKT-MKR-IND                          37230000
372400                        :DN-TKT-MKR-IND                           37240000
372500                    ,:VNDAGR-BULK-STK-TKT-IND                     37250000
372600                        :DN-BULK-STK-TKT-IND                      37260000
372700                    ,:VNDAGR-PARTIAL-IND                          37270000
372800                        :DN-PARTIAL-IND                           37280000
372900                FROM TVNDAGR A                                    37290000
373000                    ,TSERTYP B                                    37300000
373100               WHERE A.AGRMT_TYP_ID      = '4'                    37310000
373200                 AND B.SERVICE_ID        = 1                      37320000
373300                 AND B.SERVICE_ID        = A.TYP_CDE              37330000
373400                 AND A.DEPT_NBR          = :DK-DEPT-NBR           37340000
373500                 AND A.ENT_ID            = :DK-ENT-ID             37350000
373600                 AND A.EFFECTIVE_DATE   <= CURRENT DATE           37360000
373700                 AND A.EXPIRATION_DATE  >  CURRENT DATE           37370000
373800         END-EXEC                                                 37380000
373900                                                                  37390000
374000         EVALUATE TRUE                                            37400000
374100             WHEN SQLCODE = +0                                    37410000
374200             WHEN SQLCODE = +100                                  37420000
374300             WHEN SQLCODE = -904                                  37430000
374400             WHEN SQLCODE = -913                                  37440000
374500                  CONTINUE                                        37450000
374600                                                                  37460000
374700             WHEN SQLWARN0 NOT = SPACES                           37470000
374800             WHEN SQLCODE < +0                                    37480000
374900             WHEN SQLCODE > +0                                    37490000
375000                  MOVE '4020-GET-PRE-TICKET-INFO'                 37500000
375100                                  TO DP013-PARAGRAPH              37510000
375200                  MOVE 'UNSUCCESSFUL GET ON PRE-TICKET INFO'      37520000
375300                                  TO DP013-MESSAGE-TEXT (1)       37530000
375400                  MOVE SQLCA      TO DP013-SQLCA                  37540000
375500                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     37550000
375600                  MOVE 'TSERTYP ' TO DP013-DB2-TABLE-NAME (2)     37560000
375700                  SET DP013-DB2-ABEND                             37570000
375800                      DP013-XCTL-DISPLAY-RESTART                  37580000
375900                                  TO TRUE                         37590000
376000                  PERFORM DP013-0000-PROCESS-ABEND                37600000
376100         END-EVALUATE                                             37610000
376200     END-PERFORM.                                                 37620000
376300                                                                  37630000
376400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37640000
376500         MOVE '4020-GET-PRE-TICKET-INFO'                          37650000
376600                                  TO DP013-PARAGRAPH              37660000
376700         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    37670000
376800                                  TO DP013-MESSAGE-TEXT (1)       37680000
376900         MOVE SQLCA               TO DP013-SQLCA                  37690000
377000         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     37700000
377100         MOVE 'TSERTYP '          TO DP013-DB2-TABLE-NAME (2)     37710000
377200         SET DP013-DB2-ABEND                                      37720000
377300             DP013-XCTL-DISPLAY-RESTART                           37730000
377400                                  TO TRUE                         37740000
377500         PERFORM DP013-0000-PROCESS-ABEND                         37750000
377600     END-IF.                                                      37760000
377700                                                                  37770000
377800/                                                                 37780000
377900*----------------------------------------------------------------*37790000
378000*    GET SUPRESS TICKETING INFORMATION                           *37800000
378100*----------------------------------------------------------------*37810000
378200 4030-GET-SUP-TICKET-INFO.                                        37820000
378300                                                                  37830000
378400     PERFORM                                                      37840000
378500         WITH TEST AFTER                                          37850000
378600         VARYING PV-RETRY-COUNTER                                 37860000
378700         FROM 1 BY 1                                              37870000
378800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37880000
378900             OR (SQLCODE = +0)                                    37890000
379000             OR (SQLCODE = +100))                                 37900000
379100                                                                  37910000
379200         EXEC SQL                                                 37920000
379300              SELECT A.LEADTIME_DAYS_QTY                          37930000
379400                    ,A.TKT_MKR_IND                                37940000
379500                    ,A.BULK_STK_TKT_IND                           37950000
379600                    ,A.PARTIAL_IND                                37960000
379700                INTO :VNDAGR-LEADTIME-DAYS-QTY                    37970000
379800                        :DN-LEADTIME-DAYS-QTY                     37980000
379900                    ,:VNDAGR-TKT-MKR-IND                          37990000
380000                        :DN-TKT-MKR-IND                           38000000
380100                    ,:VNDAGR-BULK-STK-TKT-IND                     38010000
380200                        :DN-BULK-STK-TKT-IND                      38020000
380300                    ,:VNDAGR-PARTIAL-IND                          38030000
380400                        :DN-PARTIAL-IND                           38040000
380500                FROM TVNDAGR A                                    38050000
380600                    ,TPGMTYP B                                    38060000
380700               WHERE A.AGRMT_TYP_ID      = '6'                    38070000
380800                 AND B.PROGRAM_ID        = 1                      38080000
380900                 AND B.PROGRAM_ID        = A.TYP_CDE              38090000
381000                 AND A.DEPT_NBR          = :DK-DEPT-NBR           38100000
381100                 AND A.ENT_ID            = :DK-ENT-ID             38110000
381200                 AND A.EFFECTIVE_DATE   <= CURRENT DATE           38120000
381300                 AND A.EXPIRATION_DATE  >  CURRENT DATE           38130000
381400         END-EXEC                                                 38140000
381500                                                                  38150000
381600         EVALUATE TRUE                                            38160000
381700             WHEN SQLCODE = +0                                    38170000
381800             WHEN SQLCODE = +100                                  38180000
381900             WHEN SQLCODE = -904                                  38190000
382000             WHEN SQLCODE = -913                                  38200000
382100                  CONTINUE                                        38210000
382200                                                                  38220000
382300             WHEN SQLWARN0 NOT = SPACES                           38230000
382400             WHEN SQLCODE < +0                                    38240000
382500             WHEN SQLCODE > +0                                    38250000
382600                  MOVE '4030-GET-SUP-TICKET-INFO'                 38260000
382700                                  TO DP013-PARAGRAPH              38270000
382800                  MOVE 'UNSUCCESSFUL GET ON PRE-TICKET INFO'      38280000
382900                                  TO DP013-MESSAGE-TEXT (1)       38290000
383000                  MOVE SQLCA      TO DP013-SQLCA                  38300000
383100                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     38310000
383200                  MOVE 'TPGMTYP ' TO DP013-DB2-TABLE-NAME (2)     38320000
383300                  SET DP013-DB2-ABEND                             38330000
383400                      DP013-XCTL-DISPLAY-RESTART                  38340000
383500                                  TO TRUE                         38350000
383600                  PERFORM DP013-0000-PROCESS-ABEND                38360000
383700         END-EVALUATE                                             38370000
383800     END-PERFORM.                                                 38380000
383900                                                                  38390000
384000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38400000
384100         MOVE '4030-GET-SUP-TICKET-INFO'                          38410000
384200                                  TO DP013-PARAGRAPH              38420000
384300         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    38430000
384400                                  TO DP013-MESSAGE-TEXT (1)       38440000
384500         MOVE SQLCA               TO DP013-SQLCA                  38450000
384600         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     38460000
384700         MOVE 'TPGMTYP '          TO DP013-DB2-TABLE-NAME (2)     38470000
384800         SET DP013-DB2-ABEND                                      38480000
384900             DP013-XCTL-DISPLAY-RESTART                           38490000
385000                                  TO TRUE                         38500000
385100         PERFORM DP013-0000-PROCESS-ABEND                         38510000
385200     END-IF.                                                      38520000
385300                                                                  38530000
385400/                                                                 38540000
385500*----------------------------------------------------------------*38550000
385600* OPEN THE SERVICE CURSOR                                        *38560000
385700*----------------------------------------------------------------*38570000
385800                                                                  38580000
385900 4040-OPEN-SERVICE-CSR.                                           38590000
386000                                                                  38600000
386100     PERFORM                                                      38610000
386200         WITH TEST AFTER                                          38620000
386300         VARYING PV-RETRY-COUNTER                                 38630000
386400         FROM 1 BY 1                                              38640000
386500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38650000
386600            OR (SQLCODE = +0))                                    38660000
386700                                                                  38670000
386800         EXEC SQL                                                 38680000
386900             OPEN SERVICE-CSR                                     38690000
387000         END-EXEC                                                 38700000
387100                                                                  38710000
387200         EVALUATE TRUE                                            38720000
387300             WHEN SQLCODE = +0                                    38730000
387400                  CONTINUE                                        38740000
387500             WHEN SQLCODE = -904                                  38750000
387600             WHEN SQLCODE = -913                                  38760000
387700                  CONTINUE                                        38770000
387800             WHEN SQLWARN0 NOT = SPACE                            38780000
387900             WHEN SQLCODE  NOT = +0                               38790000
388000                  MOVE '4040-OPEN-SERVICE-CSR'                    38800000
388100                                   TO DP013-PARAGRAPH             38810000
388200                  MOVE 'OPEN SERVICE-CSR CURSOR'                  38820000
388300                                   TO DP013-MESSAGE-TEXT (1)      38830000
388400                  MOVE SQLCA       TO DP013-SQLCA                 38840000
388500                  MOVE 'TVNDAGR'   TO DP013-DB2-TABLE-NAME (1)    38850000
388600                  MOVE 'TSERTYP'   TO DP013-DB2-TABLE-NAME (2)    38860000
388700                  MOVE 'TPGMTYP'   TO DP013-DB2-TABLE-NAME (3)    38870000
388800                  MOVE 'TINCTYP'   TO DP013-DB2-TABLE-NAME (4)    38880000
388900                  SET DP013-DB2-ABEND                             38890000
389000                                   TO TRUE                        38900000
389100                  PERFORM DP013-0000-PROCESS-ABEND                38910000
389200         END-EVALUATE                                             38920000
389300     END-PERFORM.                                                 38930000
389400                                                                  38940000
389500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38950000
389600         MOVE '4040-OPEN-SERVICE-CSR'                             38960000
389700                                   TO DP013-PARAGRAPH             38970000
389800         MOVE 'MAX RETRIES EXCEEDED FOR OPEN SERVICE CURSOR'      38980000
389900                                   TO DP013-MESSAGE-TEXT (1)      38990000
390000         MOVE SQLCA                TO DP013-SQLCA                 39000000
390100         SET DP013-DB2-ABEND       TO TRUE                        39010000
390200         PERFORM DP013-0000-PROCESS-ABEND                         39020000
390300     END-IF.                                                      39030000
390400                                                                  39040000
390500/                                                                 39050000
390600*----------------------------------------------------------------*39060000
390700*    FETCH A SERVICE CURSOR ROW                                  *39070000
390800*----------------------------------------------------------------*39080000
390900                                                                  39090000
391000 4050-FETCH-SERVICE-CSR.                                          39100000
391100                                                                  39110000
391200     EXEC SQL                                                     39120000
391300          FETCH  SERVICE-CSR                                      39130000
391400           INTO :PV-TABLE-NAME                                    39140000
391500               ,:SERTYP-SERVICE-ID                                39150000
391600               ,:VNDAGR-DISCOUNT-PCT                              39160000
391700                  :DN-DISCOUNT-PCT                                39170000
391800               ,:VNDAGR-EXT-PAY-DAYS-QTY                          39180000
391900                  :DN-EXT-PAY-DAYS-QTY                            39190000
392000               ,:VNDAGR-EFFECTIVE-DATE                            39200000
392100               ,:VNDAGR-CHRG-PCT                                  39210000
392200                 :DN-CHRG-PCT                                     39220000
392300               ,:VNDAGR-CHRG-AMT                                  39230000
392400                 :DN-CHRG-AMT                                     39240000
392500     END-EXEC.                                                    39250000
392600                                                                  39260000
392700     EVALUATE TRUE                                                39270000
392800         WHEN SQLCODE = +0                                        39280000
392900              CONTINUE                                            39290000
393000         WHEN SQLCODE = +100                                      39300000
393100              SET PS-EOF-SERVICE-CSR                              39310000
393200                                   TO TRUE                        39320000
393300         WHEN SQLWARN0 NOT = SPACE                                39330000
393400         WHEN SQLCODE < +0                                        39340000
393500         WHEN SQLCODE > +0                                        39350000
393600              MOVE '4050-FETCH-SERVICE-CSR'                       39360000
393700                                   TO DP013-PARAGRAPH             39370000
393800              MOVE 'FETCH SERVICE CURSOR'                         39380000
393900                                   TO DP013-MESSAGE-TEXT (1)      39390000
394000              MOVE SQLCA           TO DP013-SQLCA                 39400000
394100              MOVE 'TVNDAGR'       TO DP013-DB2-TABLE-NAME (1)    39410000
394200              MOVE 'TSERTYP'       TO DP013-DB2-TABLE-NAME (2)    39420000
394300              MOVE 'TPGMTYP'       TO DP013-DB2-TABLE-NAME (3)    39430000
394400              MOVE 'TINCTYP'       TO DP013-DB2-TABLE-NAME (4)    39440000
394500              SET DP013-DB2-ABEND  TO TRUE                        39450000
394600              PERFORM DP013-0000-PROCESS-ABEND                    39460000
394700     END-EVALUATE.                                                39470000
394800                                                                  39480000
394900/                                                                 39490000
395000*----------------------------------------------------------------*39500000
395100* CLOSE THE SERVICE CURSOR                                       *39510000
395200*----------------------------------------------------------------*39520000
395300                                                                  39530000
395400 4060-CLOSE-SERVICE-CSR.                                          39540000
395500                                                                  39550000
395600     EXEC SQL                                                     39560000
395700         CLOSE SERVICE-CSR                                        39570000
395800     END-EXEC.                                                    39580000
395900                                                                  39590000
396000     EVALUATE TRUE                                                39600000
396100         WHEN SQLCODE = +0                                        39610000
396200              CONTINUE                                            39620000
396300         WHEN SQLWARN0 NOT = SPACE                                39630000
396400         WHEN SQLCODE  NOT = +0                                   39640000
396500              MOVE '4060-CLOSE-SERVICE-CSR'                       39650000
396600                                   TO DP013-PARAGRAPH             39660000
396700              MOVE 'CLOSE SERCIVE-CSR CURSOR'                     39670000
396800                                   TO DP013-MESSAGE-TEXT (1)      39680000
396900              MOVE SQLCA           TO DP013-SQLCA                 39690000
397000              MOVE 'TVNDAGR'       TO DP013-DB2-TABLE-NAME (1)    39700000
397100              MOVE 'TSERTYP'       TO DP013-DB2-TABLE-NAME (2)    39710000
397200              MOVE 'TPGMTYP'       TO DP013-DB2-TABLE-NAME (3)    39720000
397300              MOVE 'TINCTYP'       TO DP013-DB2-TABLE-NAME (4)    39730000
397400              SET DP013-DB2-ABEND  TO TRUE                        39740000
397500              PERFORM DP013-0000-PROCESS-ABEND                    39750000
397600     END-EVALUATE.                                                39760000
397700                                                                  39770000
397800/                                                                 39780000
397900*----------------------------------------------------------------*39790000
398000*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *39800000
398100*----------------------------------------------------------------*39810000
398200 4400-MOVE-COMMAREA-TO-SCREEN.                                    39820000
398300                                                                  39830000
398400     MOVE ASC-KEY-DEPT-NBR         TO ADPTNBRO.                   39840000
398500     MOVE ASC-ENT-NAME-DESC        TO AVNNAMEO.                   39850000
398600     MOVE ASC-KEY-INHOUSE-NBR      TO AINHSO.                     39860000
398700     MOVE ASC-DUN-NBR              TO ADUNNBRO.                   39870000
398800                                                                  39880000
398900     MOVE ASC-PRE-TICK-IND         TO ATKIND1O.                   39890000
399000     MOVE ASC-PRE-TICK-LEAD-TIME-N TO ALDTME1O.                   39900000
399100     MOVE ASC-PRE-TICK-MAKER       TO ATKMKR1O.                   39910000
399200     MOVE ASC-PRE-TICK-BULK        TO ABKTKT1O.                   39920000
399300                                                                  39930000
399400     MOVE ASC-PACK-BY-STORE-Y-N    TO APKSTORO.                   39940000
399500     MOVE ASC-HANGER-INSERT-Y-N    TO AHNGIS1O.                   39950000
399600     MOVE ASC-DC-SPLIT-IND         TO ADCSINDO.                   39960000
399700     MOVE ASC-DC-SPLIT-DAYS        TO ADCSDAYO.                   39970000
399800     MOVE ASC-SUPPLIES-UPC-Y-N     TO ASUPUCPO.                   39980000
399900     MOVE ASC-DRCT-SHP-IND         TO ADIRSHPO.                   39990000
400000     MOVE ASC-DRCT-SHP-RATE-N      TO ADIRRTEO.                   40000000
400100     MOVE ASC-DRCT-SHP-PCT-N       TO ADIRPCTO.                   40010000
400200                                                                  40020000
400300     MOVE ASC-SUP-TICK-IND         TO ATKIND2O.                   40030000
400400     MOVE ASC-SUP-TICK-LEAD-TIME-N TO ALDTME2O.                   40040000
400500     MOVE ASC-SUP-TICK-MAKER       TO ATKMKR2O.                   40050000
400600     MOVE ASC-SUP-TICK-BULK        TO ABKTKT2O.                   40060000
400700                                                                  40070000
400800     MOVE ASC-NEW-STORE-DISC-IND   TO ANEWSTRO.                   40080000
400900     MOVE ASC-NEW-STORE-DISC-N     TO ANEWPCTO.                   40090000
401000     MOVE ASC-NEW-STORE-DAYS-N     TO ANEWDAYO.                   40100000
401100     MOVE ASC-NEW-STORE-EFFDATE    TO ANEWEFFO.                   40110000
401200     MOVE ASC-MOS-DISC-IND         TO AMOSDISO.                   40120000
401300     MOVE ASC-MOS-DISC-N           TO AMOSPCTO.                   40130000
401400     MOVE ASC-MOS-DISC-EFFDATE     TO AMOSEFFO.                   40140000
401500     MOVE ASC-TRADE-DISC-IND       TO ATRDDISO.                   40150000
401600     MOVE ASC-TRADE-DISC-N         TO ATRDPCTO.                   40160000
401700     MOVE ASC-TRADE-DISC-EFFDATE   TO ATRDEFFO.                   40170000
401800     MOVE ASC-ADVTS-DISC-IND       TO AADVDISO.                   40180000
401900     MOVE ASC-ADVTS-DISC-N         TO AADVPCTO.                   40190000
402000     MOVE ASC-ADVTS-DISC-EFFDATE   TO AADVEFFO.                   40200000
402100     MOVE ASC-COOP-ALW-IND         TO ACOPALWO.                   40210000
402200     MOVE ASC-COOP-ALW-N           TO ACOPPCTO.                   40220000
402300     MOVE ASC-COOP-ALW-EFFDATE     TO ACOPEFFO.                   40230000
402400     MOVE ASC-PROFIT-ALW-IND       TO APFTALWO.                   40240000
402500     MOVE ASC-PROFIT-ALW-N         TO APFTPCTO.                   40250000
402600     MOVE ASC-PROFIT-ALW-EFFDATE   TO APFTEFFO.                   40260000
402700     MOVE ASC-TBL-TWR-IND          TO ATBLINDO.                   40270000
402800     MOVE ASC-TBL-TWR-DAYS-N       TO ATBLDAYO.                   40280000
402900     MOVE ASC-TBL-TWR-EFFDATE      TO ATBLEFFO.                   40290000
403000     MOVE ASC-RFID-STATUS-N-T-C    TO RFDCOMPO.                   40300000
403100                                                                  40310000
403200                                                                  40320000
403300/                                                                 40330000
403400*----------------------------------------------------------------*40340000
403500*    PERFORM UPDATE/INSERT PROCESSING                            *40350000
403600*                                                                *40360000
403700*  DIRECT SHIP RATE AND PERCENT ARE BOTH SERVICE FIELDS SO IF A  *40370000
403800*  SERVICE CHANGE OCCURED THEN BOTH FIELDS WILL BE CALCULATED    *40380000
403900*  WHEN THE SERVICE RECORDS ARE CREATED.  WHEN A SERVICE CHANGE  *40390000
404000*  DOESN'T OCCUR THEN THE TWO FIELDS WILL NEVER BE CALCULATED    *40400000
404100*  SO THE 2 FIELDS MUST BE INITIALIZED WITH ZEROES BEFORE ANY    *40410000
404200*  PROCESSING CAN OCCUR.                                         *40420000
404300*----------------------------------------------------------------*40430000
404400 5000-UPDATE-PROCESSING.                                          40440000
404500                                                                  40450000
404600     MOVE ZEROES                 TO VNDAGR-CHRG-PCT               40460000
404700                                    VNDAGR-CHRG-AMT.              40470000
404800                                                                  40480000
404900     MOVE -1                     TO DN-CHRG-FCTR-CDE.             40490000
405000                                                                  40500000
405100     MOVE ASC-KEY-DEPT-NBR       TO DK-DEPT-NBR.                  40510000
405200     MOVE ASC-KEY-INHOUSE-NBR    TO DK-INHOUSE-NUMBER.            40520000
405300     MOVE ASC-KEY-ENT-ID         TO DK-ENT-ID.                    40530000
405400     MOVE '9999-12-31'           TO VNDAGR-EXPIRATION-DATE.       40540000
405500                                                                  40550000
405600     IF (ASC-PRE-TICK-IND = 'N' AND ASC-PRE-TICK-IND-OLD = ' ')   40560000
405700     OR (ASC-PRE-TICK-IND = 'N' AND ASC-PRE-TICK-IND-OLD = 'N')   40570000
405800         CONTINUE                                                 40580000
405900     ELSE                                                         40590000
406000         IF  ASC-PRE-TICK-IND       = ASC-PRE-TICK-IND-OLD        40600000
406100         AND ASC-PRE-TICK-LEAD-TIME = ASC-PRE-TICK-LEAD-TIME-OLD  40610000
406200         AND ASC-PRE-TICK-MAKER     = ASC-PRE-TICK-MAKER-OLD      40620000
406300         AND ASC-PRE-TICK-BULK      = ASC-PRE-TICK-BULK-OLD       40630000
406400             CONTINUE                                             40640000
406500         ELSE                                                     40650000
406600             PERFORM 5100-PROCESS-PRE-TICKETING                   40660000
406700         END-IF                                                   40670000
406800     END-IF.                                                      40680000
406900                                                                  40690000
407000     IF (ASC-SUP-TICK-IND = 'N' AND ASC-SUP-TICK-IND-OLD = ' ')   40700000
407100     OR (ASC-SUP-TICK-IND = 'N' AND ASC-SUP-TICK-IND-OLD = 'N')   40710000
407200         CONTINUE                                                 40720000
407300     ELSE                                                         40730000
407400         IF  ASC-SUP-TICK-IND       = ASC-SUP-TICK-IND-OLD        40740000
407500         AND ASC-SUP-TICK-LEAD-TIME = ASC-SUP-TICK-LEAD-TIME-OLD  40750000
407600         AND ASC-SUP-TICK-MAKER     = ASC-SUP-TICK-MAKER-OLD      40760000
407700         AND ASC-SUP-TICK-BULK      = ASC-SUP-TICK-BULK-OLD       40770000
407800             CONTINUE                                             40780000
407900         ELSE                                                     40790000
408000             PERFORM 5200-PROCESS-SUP-TICKETING                   40800000
408100         END-IF                                                   40810000
408200     END-IF.                                                      40820000
408300                                                                  40830000
408400     IF  ASC-PACK-BY-STORE-Y-N  = ASC-PACK-BY-STORE-Y-N-OLD       40840000
408500     AND ASC-HANGER-INSERT-Y-N  = ASC-HANGER-INSERT-Y-N-OLD       40850000
408600     AND ASC-DRCT-SHP-IND       = ASC-DRCT-SHP-IND-OLD            40860000
408700     AND ASC-DRCT-SHP-RATE      = ASC-DRCT-SHP-RATE-OLD           40870000
408800     AND ASC-DRCT-SHP-PCT       = ASC-DRCT-SHP-PCT-OLD            40880000
408900     AND ASC-DC-SPLIT-IND       = ASC-DC-SPLIT-IND-OLD            40890000
409000     AND ASC-DC-SPLIT-DAYS      = ASC-DC-SPLIT-DAYS-OLD           40900000
409100     AND ASC-SUPPLIES-UPC-Y-N   = ASC-SUPPLIES-UPC-Y-N-OLD        40910000
409200     AND ASC-RFID-STATUS-N-T-C  = ASC-RFID-STATUS-N-T-C-OLD       40920000
409300         CONTINUE                                                 40930000
409400     ELSE                                                         40940000
409500         PERFORM 5300-PROCESS-SERVICES-PROGRAMS                   40950000
409600     END-IF.                                                      40960000
409700                                                                  40970000
409800     IF  ASC-NEW-STORE-DISC-IND    = ASC-NEW-STORE-DISC-IND-OLD   40980000
409900     AND ASC-NEW-STORE-DISC        = ASC-NEW-STORE-DISC-OLD       40990000
410000     AND ASC-NEW-STORE-DAYS        = ASC-NEW-STORE-DAYS-OLD       41000000
410100     AND ASC-MOS-DISC-IND          = ASC-MOS-DISC-IND-OLD         41010000
410200     AND ASC-MOS-DISC              = ASC-MOS-DISC-OLD             41020000
410300     AND ASC-TRADE-DISC-IND        = ASC-TRADE-DISC-IND-OLD       41030000
410400     AND ASC-TRADE-DISC            = ASC-TRADE-DISC-OLD           41040000
410500     AND ASC-ADVTS-DISC-IND        = ASC-ADVTS-DISC-IND-OLD       41050000
410600     AND ASC-ADVTS-DISC            = ASC-ADVTS-DISC-OLD           41060000
410700     AND ASC-COOP-ALW-IND          = ASC-COOP-ALW-IND-OLD         41070000
410800     AND ASC-COOP-ALW              = ASC-COOP-ALW-OLD             41080000
410900     AND ASC-PROFIT-ALW-IND        = ASC-PROFIT-ALW-IND-OLD       41090000
411000     AND ASC-PROFIT-ALW            = ASC-PROFIT-ALW-OLD           41100000
411100     AND ASC-TBL-TWR-IND           = ASC-TBL-TWR-IND-OLD          41110000
411200     AND ASC-TBL-TWR-DAYS          = ASC-TBL-TWR-DAYS-OLD         41120000
411300         CONTINUE                                                 41130000
411400     ELSE                                                         41140000
411500         PERFORM 5400-PROCESS-INCENTIVES                          41150000
411600     END-IF.                                                      41160000
411700                                                                  41170000
411800     IF PS-NO-ERROR                                               41180000
411900       MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER            41190000
412000       SET DP020-MSG-INFORMATIONAL TO TRUE                        41200000
412100     END-IF.                                                      41210000
412200                                                                  41220000
412300     IF  ASC-USE-SELECTION-QUEUE                                  41230000
412400         PERFORM 5200-UPDATE-SELECTION-QUEUE                      41240000
412500     END-IF.                                                      41250000
412600                                                                  41260000
412700     PERFORM 3500-SAVE-SCREEN-FIELDS.                             41270000
412800                                                                  41280000
412900/                                                                 41290000
413000*----------------------------------------------------------------*41300000
413100*    UPDATE/INSERT PRE-TICKETING ROWS                            *41310000
413200*----------------------------------------------------------------*41320000
413300 5100-PROCESS-PRE-TICKETING.                                      41330000
413400                                                                  41340000
413500     MOVE '4'                    TO DK-AGRMT-TYP-ID.              41350000
413600     MOVE 1                      TO DK-TYPE-CDE                   41360000
413700                                    VNDAGR-TYP-CDE.               41370000
413800                                                                  41380000
413900     MOVE ASC-PRE-TICK-LEAD-TIME-N                                41390000
414000                                 TO VNDAGR-LEADTIME-DAYS-QTY.     41400000
414100     MOVE ASC-PRE-TICK-BULK      TO VNDAGR-BULK-STK-TKT-IND.      41410000
414200     MOVE ASC-PRE-TICK-MAKER     TO VNDAGR-TKT-MKR-IND.           41420000
414300     IF  ASC-PRE-TICK-IND = 'P'                                   41430000
414400         MOVE ASC-PRE-TICK-IND   TO VNDAGR-PARTIAL-IND            41440000
414500         MOVE +1                 TO DN-PARTIAL-IND                41450000
414600     ELSE                                                         41460000
414700         MOVE -1                 TO DN-PARTIAL-IND                41470000
414800     END-IF.                                                      41480000
414900                                                                  41490000
415000     MOVE +1                     TO DN-EXPIRATION-DATE            41500000
415100                                    DN-LEADTIME-DAYS-QTY          41510000
415200                                    DN-BULK-STK-TKT-IND           41520000
415300                                    DN-TKT-MKR-IND.               41530000
415400                                                                  41540000
415500     IF  ASC-PRE-TICK-IND-OLD = 'N'                               41550000
415600     AND (ASC-PRE-TICK-IND     = 'Y' OR 'P')                      41560000
415700         PERFORM 5700-INSERT-TICKET-PROCESS                       41570000
415800     ELSE                                                         41580000
415900         IF (ASC-PRE-TICK-IND-OLD = 'Y' OR 'P')                   41590000
416000         AND ASC-PRE-TICK-IND     = 'N'                           41600000
416100             PERFORM 5800-DELETE-PROCESSING                       41610000
416200         ELSE                                                     41620000
416300             PERFORM 5900-UPDATE-TICKET-PROCESS                   41630000
416400         END-IF                                                   41640000
416500     END-IF.                                                      41650000
416600                                                                  41660000
416700/                                                                 41670000
416800*----------------------------------------------------------------*41680000
416900*    UPDATE/INSERT SUP-TICKETING ROWS                            *41690000
417000*----------------------------------------------------------------*41700000
417100 5200-PROCESS-SUP-TICKETING.                                      41710000
417200                                                                  41720000
417300     MOVE '6'                    TO DK-AGRMT-TYP-ID.              41730000
417400     MOVE 1                      TO DK-TYPE-CDE                   41740000
417500                                    VNDAGR-TYP-CDE.               41750000
417600                                                                  41760000
417700     MOVE ASC-SUP-TICK-LEAD-TIME-N                                41770000
417800                                 TO VNDAGR-LEADTIME-DAYS-QTY.     41780000
417900     MOVE ASC-SUP-TICK-BULK      TO VNDAGR-BULK-STK-TKT-IND.      41790000
418000     MOVE ASC-SUP-TICK-MAKER     TO VNDAGR-TKT-MKR-IND.           41800000
418100     IF  ASC-SUP-TICK-IND = 'P'                                   41810000
418200         MOVE ASC-SUP-TICK-IND   TO VNDAGR-PARTIAL-IND            41820000
418300         MOVE +1                 TO DN-PARTIAL-IND                41830000
418400     ELSE                                                         41840000
418500         MOVE -1                 TO DN-PARTIAL-IND                41850000
418600     END-IF.                                                      41860000
418700                                                                  41870000
418800                                                                  41880000
418900     MOVE +1                     TO DN-EXPIRATION-DATE            41890000
419000                                    DN-LEADTIME-DAYS-QTY          41900000
419100                                    DN-BULK-STK-TKT-IND           41910000
419200                                    DN-TKT-MKR-IND.               41920000
419300                                                                  41930000
419400     IF  ASC-SUP-TICK-IND-OLD = 'N'                               41940000
419500     AND (ASC-SUP-TICK-IND    = 'Y' OR 'P')                       41950000
419600         PERFORM 5700-INSERT-TICKET-PROCESS                       41960000
419700     ELSE                                                         41970000
419800         IF (ASC-SUP-TICK-IND-OLD = 'Y' OR 'P')                   41980000
419900         AND ASC-SUP-TICK-IND     = 'N'                           41990000
420000             PERFORM 5800-DELETE-PROCESSING                       42000000
420100         ELSE                                                     42010000
420200             PERFORM 5900-UPDATE-TICKET-PROCESS                   42020000
420300         END-IF                                                   42030000
420400     END-IF.                                                      42040000
420500                                                                  42050000
420600/                                                                 42060000
420700*----------------------------------------------------------------*42070000
420800* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *42080000
420900* OBJECT WAS UDPATED.                                            *42090000
421000*----------------------------------------------------------------*42100000
421100                                                                  42110000
421200 5200-UPDATE-SELECTION-QUEUE.                                     42120000
421300                                                                  42130000
421400     PERFORM 9100-READ-SEL-QUEUE.                                 42140000
421500                                                                  42150000
421600     SET VN003-UPD (ASC-SEL-SUB)   TO TRUE.                       42160000
421700                                                                  42170000
421800     PERFORM 9200-REWRITE-SEL-QUEUE.                              42180000
421900                                                                  42190000
422000/                                                                 42200000
422100*----------------------------------------------------------------*42210000
422200*    UPDATE/INSERT SERVICES AND/OR PROGRAMS                      *42220000
422300*----------------------------------------------------------------*42230000
422400 5300-PROCESS-SERVICES-PROGRAMS.                                  42240000
422500                                                                  42250000
422600*  PROCESS PACK BY STORE                                          42260000
422700                                                                  42270000
422800     IF  ASC-PACK-BY-STORE-Y-N = ASC-PACK-BY-STORE-Y-N-OLD        42280000
422900         CONTINUE                                                 42290000
423000     ELSE                                                         42300000
423100         MOVE '4'                TO DK-AGRMT-TYP-ID               42310000
423200         MOVE 4                  TO VNDAGR-TYP-CDE                42320000
423300                                    DK-TYPE-CDE                   42330000
423400         IF  ASC-PACK-BY-STORE-Y-N-OLD = 'N'                      42340000
423500         AND ASC-PACK-BY-STORE-Y-N     = 'Y'                      42350000
423600             PERFORM 5700-INSERT-SERVICE-PROCESS                  42360000
423700         ELSE                                                     42370000
423800             IF  ASC-PACK-BY-STORE-Y-N-OLD = 'Y'                  42380000
423900             AND ASC-PACK-BY-STORE-Y-N     = 'N'                  42390000
424000                 PERFORM 5800-DELETE-PROCESSING                   42400000
424100             ELSE                                                 42410000
424200                 PERFORM 5900-UPDATE-SERVICE-PROCESS              42420000
424300             END-IF                                               42430000
424400         END-IF                                                   42440000
424500     END-IF.                                                      42450000
424600                                                                  42460000
424700                                                                  42470000
424800*  PROCESS HANGER INSERT                                          42480000
424900                                                                  42490000
425000     IF  ASC-HANGER-INSERT-Y-N = ASC-HANGER-INSERT-Y-N-OLD        42500000
425100         CONTINUE                                                 42510000
425200     ELSE                                                         42520000
425300         MOVE '4'                TO DK-AGRMT-TYP-ID               42530000
425400         MOVE 2                  TO VNDAGR-TYP-CDE                42540000
425500                                    DK-TYPE-CDE                   42550000
425600         IF  ASC-HANGER-INSERT-Y-N-OLD = 'N'                      42560000
425700         AND ASC-HANGER-INSERT-Y-N     = 'Y'                      42570000
425800             PERFORM 5700-INSERT-SERVICE-PROCESS                  42580000
425900         ELSE                                                     42590000
426000             IF  ASC-HANGER-INSERT-Y-N-OLD = 'Y'                  42600000
426100             AND ASC-HANGER-INSERT-Y-N     = 'N'                  42610000
426200                 PERFORM 5800-DELETE-PROCESSING                   42620000
426300             ELSE                                                 42630000
426400                 PERFORM 5900-UPDATE-SERVICE-PROCESS              42640000
426500             END-IF                                               42650000
426600         END-IF                                                   42660000
426700     END-IF.                                                      42670000
426800                                                                  42680000
426900*  PROCESS DIRECT SHIP INSERT                                     42690000
427000                                                                  42700000
427100     IF  ASC-DRCT-SHP-IND     = ASC-DRCT-SHP-IND-OLD              42710000
427200     AND ASC-DRCT-SHP-RATE    = ASC-DRCT-SHP-RATE-OLD             42720000
427300     AND ASC-DRCT-SHP-PCT     = ASC-DRCT-SHP-PCT-OLD              42730000
427400         CONTINUE                                                 42740000
427500     ELSE                                                         42750000
427600         MOVE '4'                TO DK-AGRMT-TYP-ID               42760000
427700         MOVE 10                 TO VNDAGR-TYP-CDE                42770000
427800                                    DK-TYPE-CDE                   42780000
427900                                                                  42790000
428000         MOVE +1 TO DN-CHRG-FCTR-CDE                              42800000
428100                                                                  42810000
428200         IF ASC-DRCT-SHP-RATE-N > ZEROES                          42820000
428300           MOVE 'I' TO VNDAGR-CHRG-FCTR-CDE                       42830000
428400         ELSE                                                     42840000
428500           MOVE 'C' TO VNDAGR-CHRG-FCTR-CDE                       42850000
428600         END-IF                                                   42860000
428700                                                                  42870000
428800         IF ASC-DRCT-SHP-PCT-N NOT = ZEROES                       42880000
428900             COMPUTE VNDAGR-CHRG-PCT =                            42890000
429000                   ASC-DRCT-SHP-PCT-N / 100                       42900000
429100         ELSE                                                     42910000
429200            MOVE ZEROES TO VNDAGR-CHRG-PCT                        42920000
429300         END-IF                                                   42930000
429400                                                                  42940000
429500         MOVE ASC-DRCT-SHP-RATE-N TO VNDAGR-CHRG-AMT              42950000
429600                                                                  42960000
429700         IF  ASC-DRCT-SHP-IND-OLD      = 'N'                      42970000
429800         AND ASC-DRCT-SHP-IND          = 'Y'                      42980000
429900             PERFORM 5700-INSERT-SERVICE-PROCESS                  42990000
430000         ELSE                                                     43000000
430100             IF  ASC-DRCT-SHP-IND-OLD      = 'Y'                  43010000
430200             AND ASC-DRCT-SHP-IND          = 'N'                  43020000
430300                 PERFORM 5800-DELETE-PROCESSING                   43030000
430400             ELSE                                                 43040000
430500                 PERFORM 5900-UPDATE-SERVICE-PROCESS              43050000
430600             END-IF                                               43060000
430700         END-IF                                                   43070000
430800     END-IF.                                                      43080000
430900                                                                  43090000
431000*  PROCESS RFID TAGGING OR COMPLIANT INSERT                       43100000
431100                                                                  43110000
431200     IF  ASC-RFID-STATUS-N-T-C-OLD = 'N' AND                      43120000
431300         ASC-RFID-STATUS-N-T-C     = 'T'                          43130000
431400*        CREATE '11' TAGGING ROW                                  43140000
431500         MOVE '4'                TO DK-AGRMT-TYP-ID               43150000
431600         MOVE  11                TO VNDAGR-TYP-CDE                43160000
431700                                    DK-TYPE-CDE                   43170000
431800         PERFORM 5700-INSERT-SERVICE-PROCESS                      43180000
431900     ELSE                                                         43190000
432000         IF  ASC-RFID-STATUS-N-T-C-OLD = 'T' AND                  43200000
432100             ASC-RFID-STATUS-N-T-C     = 'N'                      43210000
432200*            EXPIRE '11' TAGGING ROW                              43220000
432300             MOVE '4'                TO DK-AGRMT-TYP-ID           43230000
432400             MOVE  11                TO VNDAGR-TYP-CDE            43240000
432500                                        DK-TYPE-CDE               43250000
432600             PERFORM 5800-DELETE-PROCESSING                       43260000
432700         ELSE                                                     43270000
432800             IF  ASC-RFID-STATUS-N-T-C-OLD = 'T' AND              43280000
432900                 ASC-RFID-STATUS-N-T-C     = 'C'                  43290000
433000*                EXPIRE '11' TAGGING ROW                          43300000
433100                 MOVE '4'                TO DK-AGRMT-TYP-ID       43310000
433200                 MOVE  11                TO VNDAGR-TYP-CDE        43320000
433300                                            DK-TYPE-CDE           43330000
433400                 PERFORM 5800-DELETE-PROCESSING                   43340000
433500*                INSERT '12' TO MARK COMPLIANT                    43350000
433600                 MOVE '4'                TO DK-AGRMT-TYP-ID       43360000
433700                 MOVE  12                TO VNDAGR-TYP-CDE        43370000
433800                                            DK-TYPE-CDE           43380000
433900                 PERFORM 5700-INSERT-SERVICE-PROCESS              43390000
434000             ELSE                                                 43400000
434100                 IF  ASC-RFID-STATUS-N-T-C-OLD = 'C' AND          43410000
434200                     ASC-RFID-STATUS-N-T-C     = 'N'              43420000
434300*                    EXPIRE '12' VENDOR COMPLIANT                 43430000
434400                     MOVE '4'                TO DK-AGRMT-TYP-ID   43440000
434500                     MOVE  12                TO VNDAGR-TYP-CDE    43450000
434600                                                DK-TYPE-CDE       43460000
434700                     PERFORM 5800-DELETE-PROCESSING               43470000
434800                 ELSE                                             43480000
434900                     IF ASC-RFID-STATUS-N-T-C-OLD = 'C' AND       43490000
435000                        ASC-RFID-STATUS-N-T-C     = 'T'           43500000
435100*                       EXPIRE '12' COMPLIANT ROW                 43510000
435200                        MOVE '4'                TO DK-AGRMT-TYP-ID43520000
435300                        MOVE  12                TO VNDAGR-TYP-CDE 43530000
435400                                                   DK-TYPE-CDE    43540000
435500                        PERFORM 5800-DELETE-PROCESSING            43550000
435600*                       INSERT '11' TO TAGGING                    43560000
435700                        MOVE '4'                TO DK-AGRMT-TYP-ID43570000
435800                        MOVE  11                TO VNDAGR-TYP-CDE 43580000
435900                                                   DK-TYPE-CDE    43590000
436000                        PERFORM 5700-INSERT-SERVICE-PROCESS       43600000
436100                     END-IF                                       43610000
436200                 END-IF                                           43620000
436300             END-IF                                               43630000
436400         END-IF                                                   43640000
436500     END-IF.                                                      43650000
436600                                                                  43660000
436700*  PROCESS DC SPLIT REQUIRED INDICATOR AND LEADTIME DAYS          43670000
436800                                                                  43680000
436900     IF  ASC-DC-SPLIT-IND      = ASC-DC-SPLIT-IND-OLD             43690000
437000     AND ASC-DC-SPLIT-DAYS     = ASC-DC-SPLIT-DAYS-OLD            43700000
437100         CONTINUE                                                 43710000
437200     ELSE                                                         43720000
437300         MOVE '6'                TO DK-AGRMT-TYP-ID               43730000
437400         MOVE 5                  TO VNDAGR-TYP-CDE                43740000
437500                                    DK-TYPE-CDE                   43750000
437600         MOVE ASC-DC-SPLIT-DAYS  TO VNDAGR-EXT-PAY-DAYS-QTY       43760000
437700         IF (ASC-DC-SPLIT-IND-OLD      = SPACE)                   43770000
437800         AND (ASC-DC-SPLIT-IND          = 'Y' OR 'N')             43780000
437900             PERFORM 5700-INSERT-SERVICE-PROCESS                  43790000
438000         ELSE                                                     43800000
438100             PERFORM 5900-UPDATE-SERVICE-PROCESS                  43810000
438200         END-IF                                                   43820000
438300     END-IF.                                                      43830000
438400                                                                  43840000
438500*  PROCESS REPLENISHMENT                                          43850000
438600                                                                  43860000
438700                                                                  43870000
438800*  PROCESS SUPPLIES UPC                                           43880000
438900                                                                  43890000
439000     IF  ASC-SUPPLIES-UPC-Y-N = ASC-SUPPLIES-UPC-Y-N-OLD          43900000
439100         CONTINUE                                                 43910000
439200     ELSE                                                         43920000
439300         MOVE '4'                TO DK-AGRMT-TYP-ID               43930000
439400         MOVE 3                  TO VNDAGR-TYP-CDE                43940000
439500                                    DK-TYPE-CDE                   43950000
439600         IF  ASC-SUPPLIES-UPC-Y-N-OLD = 'N'                       43960000
439700         AND ASC-SUPPLIES-UPC-Y-N     = 'Y'                       43970000
439800             PERFORM 5700-INSERT-SERVICE-PROCESS                  43980000
439900         ELSE                                                     43990000
440000             IF  ASC-SUPPLIES-UPC-Y-N-OLD = 'Y'                   44000000
440100             AND ASC-SUPPLIES-UPC-Y-N     = 'N'                   44010000
440200                 PERFORM 5800-DELETE-PROCESSING                   44020000
440300             ELSE                                                 44030000
440400                 PERFORM 5900-UPDATE-SERVICE-PROCESS              44040000
440500             END-IF                                               44050000
440600         END-IF                                                   44060000
440700     END-IF.                                                      44070000
440800                                                                  44080000
440900/                                                                 44090000
441000*----------------------------------------------------------------*44100000
441100*    UPDATE/INSERT INCENTIVES                                    *44110000
441200*----------------------------------------------------------------*44120000
441300 5400-PROCESS-INCENTIVES.                                         44130000
441400                                                                  44140000
441500*  PROCESS NEW STORE DISCOUNT                                     44150000
441600                                                                  44160000
441700     IF  ASC-NEW-STORE-DISC-IND = ASC-NEW-STORE-DISC-IND-OLD      44170000
441800     AND ASC-NEW-STORE-DISC     = ASC-NEW-STORE-DISC-OLD          44180000
441900     AND ASC-NEW-STORE-DAYS     = ASC-NEW-STORE-DAYS-OLD          44190000
442000         CONTINUE                                                 44200000
442100     ELSE                                                         44210000
442200         MOVE '5'                TO DK-AGRMT-TYP-ID               44220000
442300         MOVE 1                  TO VNDAGR-TYP-CDE                44230000
442400                                    DK-TYPE-CDE                   44240000
442500         IF  ASC-NEW-STORE-DISC-N NOT = ZEROES                    44250000
442600             COMPUTE VNDAGR-DISCOUNT-PCT =                        44260000
442700                     ASC-NEW-STORE-DISC-N / 100                   44270000
442800         ELSE                                                     44280000
442900             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           44290000
443000         END-IF                                                   44300000
443100         MOVE ASC-NEW-STORE-DAYS-N                                44310000
443200                                 TO VNDAGR-EXT-PAY-DAYS-QTY       44320000
443300         MOVE +1                 TO DN-DISCOUNT-PCT               44330000
443400                                    DN-EXT-PAY-DAYS-QTY           44340000
443500         IF  ASC-NEW-STORE-DISC-IND-OLD = 'N'                     44350000
443600         AND ASC-NEW-STORE-DISC-IND     = 'Y'                     44360000
443700             PERFORM 5700-INSERT-AGRMNT-PROCESS                   44370000
443800         ELSE                                                     44380000
443900             IF  ASC-NEW-STORE-DISC-IND-OLD = 'Y'                 44390000
444000             AND ASC-NEW-STORE-DISC-IND     = 'N'                 44400000
444100                 PERFORM 5800-DELETE-PROCESSING                   44410000
444200             ELSE                                                 44420000
444300*                ASC-NEW-STORE-DISC-IND-OLD = 'Y' AND             44430000
444400*                ASC-NEW-STORE-DISC-IND     = 'Y'                 44440000
444500                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               44450000
444600             END-IF                                               44460000
444700         END-IF                                                   44470000
444800     END-IF.                                                      44480000
444900                                                                  44490000
445000                                                                  44500000
445100*  PROCESS MERCHANDISE OUT OF STOCK DISCOUNT                      44510000
445200                                                                  44520000
445300     IF  ASC-MOS-DISC-IND       = ASC-MOS-DISC-IND-OLD            44530000
445400     AND ASC-MOS-DISC           = ASC-MOS-DISC-OLD                44540000
445500         CONTINUE                                                 44550000
445600     ELSE                                                         44560000
445700         MOVE '5'                TO DK-AGRMT-TYP-ID               44570000
445800         MOVE 7                  TO VNDAGR-TYP-CDE                44580000
445900                                    DK-TYPE-CDE                   44590000
446000         MOVE +1                 TO DN-DISCOUNT-PCT               44600000
446100                                    DN-EXT-PAY-DAYS-QTY           44610000
446200         IF  ASC-MOS-DISC-N       NOT = ZEROES                    44620000
446300             COMPUTE VNDAGR-DISCOUNT-PCT =                        44630000
446400                     ASC-MOS-DISC-N       / 100                   44640000
446500             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       44650000
446600         ELSE                                                     44660000
446700             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           44670000
446800             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       44680000
446900         END-IF                                                   44690000
447000         IF  ASC-MOS-DISC-IND-OLD = 'N'                           44700000
447100         AND ASC-MOS-DISC-IND     = 'Y'                           44710000
447200             PERFORM 5700-INSERT-AGRMNT-PROCESS                   44720000
447300         ELSE                                                     44730000
447400             IF  ASC-MOS-DISC-IND-OLD = 'Y'                       44740000
447500             AND ASC-MOS-DISC-IND     = 'N'                       44750000
447600                 PERFORM 5800-DELETE-PROCESSING                   44760000
447700             ELSE                                                 44770000
447800                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               44780000
447900             END-IF                                               44790000
448000         END-IF                                                   44800000
448100     END-IF.                                                      44810000
448200                                                                  44820000
448300*  PROCESS TRADE DISCOUNT                                         44830000
448400                                                                  44840000
448500     IF  ASC-TRADE-DISC-IND     = ASC-TRADE-DISC-IND-OLD          44850000
448600     AND ASC-TRADE-DISC         = ASC-TRADE-DISC-OLD              44860000
448700         CONTINUE                                                 44870000
448800     ELSE                                                         44880000
448900         MOVE '5'                TO DK-AGRMT-TYP-ID               44890000
449000         MOVE 8                  TO VNDAGR-TYP-CDE                44900000
449100                                    DK-TYPE-CDE                   44910000
449200         MOVE +1                 TO DN-DISCOUNT-PCT               44920000
449300                                    DN-EXT-PAY-DAYS-QTY           44930000
449400         IF  ASC-TRADE-DISC-N       NOT = ZEROES                  44940000
449500             COMPUTE VNDAGR-DISCOUNT-PCT =                        44950000
449600                     ASC-TRADE-DISC-N       / 100                 44960000
449700             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       44970000
449800         ELSE                                                     44980000
449900             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           44990000
450000             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45000000
450100         END-IF                                                   45010000
450200         IF  ASC-TRADE-DISC-IND-OLD = 'N'                         45020000
450300         AND ASC-TRADE-DISC-IND     = 'Y'                         45030000
450400             PERFORM 5700-INSERT-AGRMNT-PROCESS                   45040000
450500         ELSE                                                     45050000
450600             IF  ASC-TRADE-DISC-IND-OLD = 'Y'                     45060000
450700             AND ASC-TRADE-DISC-IND     = 'N'                     45070000
450800                 PERFORM 5800-DELETE-PROCESSING                   45080000
450900             ELSE                                                 45090000
451000                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               45100000
451100             END-IF                                               45110000
451200         END-IF                                                   45120000
451300     END-IF.                                                      45130000
451400                                                                  45140000
451500*  PROCESS ADVTS DISCOUNT                                         45150000
451600                                                                  45160000
451700     IF  ASC-ADVTS-DISC-IND       = ASC-ADVTS-DISC-IND-OLD        45170000
451800     AND ASC-ADVTS-DISC           = ASC-ADVTS-DISC-OLD            45180000
451900         CONTINUE                                                 45190000
452000     ELSE                                                         45200000
452100         MOVE '5'                TO DK-AGRMT-TYP-ID               45210000
452200         MOVE 9                  TO VNDAGR-TYP-CDE                45220000
452300                                    DK-TYPE-CDE                   45230000
452400         MOVE +1                 TO DN-DISCOUNT-PCT               45240000
452500                                    DN-EXT-PAY-DAYS-QTY           45250000
452600         IF  ASC-ADVTS-DISC-N       NOT = ZEROES                  45260000
452700             COMPUTE VNDAGR-DISCOUNT-PCT =                        45270000
452800                     ASC-ADVTS-DISC-N       / 100                 45280000
452900             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45290000
453000         ELSE                                                     45300000
453100             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           45310000
453200             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45320000
453300         END-IF                                                   45330000
453400         IF  ASC-ADVTS-DISC-IND-OLD = 'N'                         45340000
453500         AND ASC-ADVTS-DISC-IND     = 'Y'                         45350000
453600             PERFORM 5700-INSERT-AGRMNT-PROCESS                   45360000
453700         ELSE                                                     45370000
453800             IF  ASC-ADVTS-DISC-IND-OLD = 'Y'                     45380000
453900             AND ASC-ADVTS-DISC-IND     = 'N'                     45390000
454000                 PERFORM 5800-DELETE-PROCESSING                   45400000
454100             ELSE                                                 45410000
454200                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               45420000
454300             END-IF                                               45430000
454400         END-IF                                                   45440000
454500     END-IF.                                                      45450000
454600                                                                  45460000
454700*  PROCESS COOP (OFF-INVOICE) ALLOWANCE                           45470000
454800                                                                  45480000
454900     IF  ASC-COOP-ALW-IND         = ASC-COOP-ALW-IND-OLD          45490000
455000     AND ASC-COOP-ALW             = ASC-COOP-ALW-OLD              45500000
455100         CONTINUE                                                 45510000
455200     ELSE                                                         45520000
455300         MOVE '5'                TO DK-AGRMT-TYP-ID               45530000
455400         MOVE 10                 TO VNDAGR-TYP-CDE                45540000
455500                                    DK-TYPE-CDE                   45550000
455600         MOVE +1                 TO DN-DISCOUNT-PCT               45560000
455700                                    DN-EXT-PAY-DAYS-QTY           45570000
455800         IF  ASC-COOP-ALW-N         NOT = ZEROES                  45580000
455900             COMPUTE VNDAGR-DISCOUNT-PCT =                        45590000
456000                     ASC-COOP-ALW-N         / 100                 45600000
456100             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45610000
456200         ELSE                                                     45620000
456300             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           45630000
456400             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45640000
456500         END-IF                                                   45650000
456600         IF  ASC-COOP-ALW-IND-OLD = 'N'                           45660000
456700         AND ASC-COOP-ALW-IND       = 'Y'                         45670000
456800             PERFORM 5700-INSERT-AGRMNT-PROCESS                   45680000
456900         ELSE                                                     45690000
457000             IF  ASC-COOP-ALW-IND-OLD = 'Y'                       45700000
457100             AND ASC-COOP-ALW-IND       = 'N'                     45710000
457200                 PERFORM 5800-DELETE-PROCESSING                   45720000
457300             ELSE                                                 45730000
457400                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               45740000
457500             END-IF                                               45750000
457600         END-IF                                                   45760000
457700     END-IF.                                                      45770000
457800                                                                  45780000
457900*  PROCESS PROFITASST/ADCOOP ALLOWANCE                            45790000
458000                                                                  45800000
458100     IF  ASC-PROFIT-ALW-IND       = ASC-PROFIT-ALW-IND-OLD        45810000
458200     AND ASC-PROFIT-ALW           = ASC-PROFIT-ALW-OLD            45820000
458300         CONTINUE                                                 45830000
458400     ELSE                                                         45840000
458500         MOVE '5'                TO DK-AGRMT-TYP-ID               45850000
458600         MOVE 11                 TO VNDAGR-TYP-CDE                45860000
458700                                    DK-TYPE-CDE                   45870000
458800         MOVE +1                 TO DN-DISCOUNT-PCT               45880000
458900                                    DN-EXT-PAY-DAYS-QTY           45890000
459000         IF  ASC-PROFIT-ALW-N       NOT = ZEROES                  45900000
459100             COMPUTE VNDAGR-DISCOUNT-PCT =                        45910000
459200                     ASC-PROFIT-ALW-N       / 100                 45920000
459300             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45930000
459400         ELSE                                                     45940000
459500             MOVE ZEROES         TO VNDAGR-DISCOUNT-PCT           45950000
459600             MOVE ZEROES         TO VNDAGR-EXT-PAY-DAYS-QTY       45960000
459700         END-IF                                                   45970000
459800         IF  ASC-PROFIT-ALW-IND-OLD = 'N'                         45980000
459900         AND ASC-PROFIT-ALW-IND     = 'Y'                         45990000
460000             PERFORM 5700-INSERT-AGRMNT-PROCESS                   46000000
460100         ELSE                                                     46010000
460200             IF  ASC-PROFIT-ALW-IND-OLD = 'Y'                     46020000
460300             AND ASC-PROFIT-ALW-IND     = 'N'                     46030000
460400                 PERFORM 5800-DELETE-PROCESSING                   46040000
460500             ELSE                                                 46050000
460600                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               46060000
460700             END-IF                                               46070000
460800         END-IF                                                   46080000
460900     END-IF.                                                      46090000
461000                                                                  46100000
461100*  PROCESS TABLE/TOWER DATING                                     46110000
461200                                                                  46120000
461300     IF  ASC-TBL-TWR-IND          = ASC-TBL-TWR-IND-OLD           46130000
461400     AND ASC-TBL-TWR-DAYS         = ASC-TBL-TWR-DAYS-OLD          46140000
461500         CONTINUE                                                 46150000
461600     ELSE                                                         46160000
461700         MOVE '5'                TO DK-AGRMT-TYP-ID               46170000
461800         MOVE 12                 TO VNDAGR-TYP-CDE                46180000
461900                                    DK-TYPE-CDE                   46190000
462000         MOVE +1                 TO DN-DISCOUNT-PCT               46200000
462100                                    DN-EXT-PAY-DAYS-QTY           46210000
462200         MOVE ZEROES             TO VNDAGR-DISCOUNT-PCT           46220000
462300         MOVE ASC-TBL-TWR-DAYS-N TO VNDAGR-EXT-PAY-DAYS-QTY       46230000
462400         IF  ASC-TBL-TWR-IND-OLD = 'N'                            46240000
462500         AND ASC-TBL-TWR-IND            = 'Y'                     46250000
462600             PERFORM 5700-INSERT-AGRMNT-PROCESS                   46260000
462700         ELSE                                                     46270000
462800             IF  ASC-TBL-TWR-IND-OLD = 'Y'                        46280000
462900             AND ASC-TBL-TWR-IND            = 'N'                 46290000
463000                 PERFORM 5800-DELETE-PROCESSING                   46300000
463100             ELSE                                                 46310000
463200                 PERFORM 5900-UPDATE-AGRMNT-PROCESS               46320000
463300             END-IF                                               46330000
463400         END-IF                                                   46340000
463500     END-IF.                                                      46350000
463600                                                                  46360000
463700/                                                                 46370000
463800 5500-INTERFACE-TO-RMS.                                           46380000
463900******************************************************************46390000
464000*   CALL THE DATA BUILDER PROGRAM (VNKCS023) WHICH WILL RETRIEVE *46400000
464100*   ADDITIONAL DATA TO INTERFACE THE DEPT TO RMS. IF VNKCS023    *46410000
464200*   DETERMINES THAT ALL OF THE REQUIRED DATA IS AVAILABLE, IT    *46420000
464300*   WILL CALL VNKCS024 TO HAVE THE DEPARTMENT MESSAGE FORMATTED  *46430000
464400*   AND SENT TO RMS FOR UPDATING.                                *46440000
464500******************************************************************46450000
464600     INITIALIZE VN013-VENDOR-INTERFACE-PARMS.                     46460000
464700     SET VN013-ACTION-UPDATE                                      46470000
464800         VN013-FUNCTION-PROGRAMS    TO TRUE.                      46480000
464900                                                                  46490000
465000     MOVE ASC-KEY-ENT-ID            TO VN013-ENT-ID.              46500000
465100     MOVE ASC-DUN-NBR               TO VN013-VND-NBR.             46510000
465200     MOVE ASC-PRIM-TYP-CDE          TO VN013-PRIM-TYP-CDE.        46520000
465300     MOVE ASC-VND-IN-RMS-IND        TO VN013-VND-IN-RMS-IND.      46530000
465400     MOVE ASC-STATUS-CDE            TO VN013-STATUS-CDE.          46540000
465500     MOVE ASC-PO-PREPK-CDE          TO VN013-PO-PREPK-CDE.        46550000
465600     MOVE ASC-ENT-NAME-DESC         TO VN013-ENT-NAME-DESC.       46560000
465700     MOVE ASC-KEY-DEPT-NBR          TO VN013-DEPT-NBR.            46570000
465800                                                                  46580000
465900     IF PS-PRE-TICK-CHANGED-TO-N                                  46590000
466000        MOVE 'N'                      TO VN013-BULK-STK-TKT-IND   46600000
466100        MOVE 'N'                      TO VN013-TKT-MKR-IND        46610000
466200        MOVE 0                        TO VN013-PRETKT-LEADTIME-QTY46620000
466300     ELSE                                                         46630000
466400        MOVE ASC-PRE-TICK-BULK        TO VN013-BULK-STK-TKT-IND   46640000
466500        MOVE ASC-PRE-TICK-MAKER       TO VN013-TKT-MKR-IND        46650000
466600        MOVE ASC-PRE-TICK-LEAD-TIME-N TO VN013-PRETKT-LEADTIME-QTY46660000
466700     END-IF.                                                      46670000
466800                                                                  46680000
466900     MOVE ASC-HANGER-INSERT-Y-N      TO VN013-HANGER-IND.         46690000
467000                                                                  46700000
467100     MOVE ASC-PACK-BY-STORE-Y-N      TO VN013-PACK-BY-STR-IND.    46710000
467200                                                                  46720000
467300     MOVE ASC-DC-SPLIT-IND           TO VN013-SPLIT-REQD-IND.     46730000
467400                                                                  46740000
467500     MOVE ASC-DC-SPLIT-DAYS          TO VN013-SPLIT-LEADTIME-QTY. 46750000
467600                                                                  46760000
467700     MOVE ASC-NEW-STORE-DAYS-N       TO VN013-NSD-EXT-DAYS-QTY.   46770000
467800                                                                  46780000
467900     COMPUTE VN013-NSD-DISC-PCT = ASC-NEW-STORE-DISC-N    / 100.  46790000
468000     COMPUTE VN013-MOS-DISC-PCT = ASC-MOS-DISC-N          / 100.  46800000
468100     COMPUTE VN013-TRD-DISC-PCT = ASC-TRADE-DISC-N        / 100.  46810000
468200     COMPUTE VN013-ADV-DISC-PCT = ASC-ADVTS-DISC-N        / 100.  46820000
468300     COMPUTE VN013-COOP-DISC-PCT = ASC-COOP-ALW-N         / 100.  46830000
468400     COMPUTE VN013-PRFTASST-ADCOOP-PCT = ASC-PROFIT-ALW-N / 100.  46840000
468500     MOVE ZERO                       TO VN013-BRDL-DISC-PCT.      46850000
468600     MOVE ASC-TBL-TWR-DAYS-N         TO VN013-TBL-TWR-DAYS-QTY.   46860000
468700                                                                  46870000
468800     EXEC CICS LINK PROGRAM (PC-VNKCS023)                         46880000
468900                    COMMAREA(VN013-COMMAREA)                      46890000
469000                    RESP    (PV-CICS-RESPONSE)                    46900000
469100     END-EXEC.                                                    46910000
469200                                                                  46920000
469300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       46930000
469400         CONTINUE                                                 46940000
469500     ELSE                                                         46950000
469600         SET DP013-ROLLBACK                                       46960000
469700             DP013-XCTL-DISPLAY-RESTART                           46970000
469800             DP013-CICS-ABEND      TO TRUE                        46980000
469900         MOVE '5500-INTERFACE-TO-RMS'                             46990000
470000                                   TO DP013-PARAGRAPH             47000000
470100         MOVE 'FAILED CALL TO RMS DATA BUILDER ROUTINE: VNKCS023' 47010000
470200                                   TO DP013-MESSAGE-TEXT (1)      47020000
470300         PERFORM DP013-0000-PROCESS-ABEND                         47030000
470400     END-IF.                                                      47040000
470500                                                                  47050000
470600     IF VN013-NO-ERRORS                                           47060000
470700         CONTINUE                                                 47070000
470800     ELSE                                                         47080000
470900         SET DP013-CICS-ABEND                                     47090000
471000             DP013-ROLLBACK                                       47100000
471100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   47110000
471200         MOVE '5500-INTERFACE-TO-RMS'   TO DP013-PARAGRAPH        47120000
471300         MOVE VN013-PARAGRAPH-NAME      TO PV-ERROR-PARA-NAME     47130000
471400         MOVE VN013-MESSAGE             TO PV-ERROR-MESSAGE       47140000
471500         IF VN013-DB-ERROR                                        47150000
471600             MOVE 'DB2 ERROR      '     TO PV-ERROR-TYPE          47160000
471700             MOVE 'SQL CODE: '          TO PV-OPTIONAL-TEXT       47170000
471800             MOVE VN013-SQLCODE         TO PV-ERROR-REASON        47180000
471900         ELSE                                                     47190000
472000             MOVE SPACES                TO PV-OPTIONAL-TEXT       47200000
472100                                           PV-ERROR-REASON        47210000
472200             IF VN013-MQ-ERROR                                    47220000
472300                 MOVE 'MQ SERIES ERROR' TO PV-ERROR-TYPE          47230000
472400             ELSE                                                 47240000
472500                 MOVE 'UNKNOWN ERROR  ' TO PV-ERROR-TYPE          47250000
472600             END-IF                                               47260000
472700         END-IF                                                   47270000
472800         MOVE PV-ERROR-MSG-1       TO DP013-MESSAGE-TEXT (2)      47280000
472900         MOVE PV-ERROR-MSG-2       TO DP013-MESSAGE-TEXT (3)      47290000
473000         MOVE PV-ERROR-MSG-3       TO DP013-MESSAGE-TEXT (4)      47300000
473100         PERFORM DP013-0000-PROCESS-ABEND                         47310000
473200     END-IF.                                                      47320000
473300                                                                  47330000
473400     IF VN013-MAX-CPBLTY-EXCEEDED                                 47340000
473500         SET DP030-OVERRIDE-GO TO TRUE                            47350000
473600         MOVE PC-TSYMSG-03380  TO DP020-MSG-NUMBER                47360000
473700         SET DP020-MSG-WARNING TO TRUE                            47370000
473800     END-IF.                                                      47380000
473900                                                                  47390000
474000     IF VN013-MAX-RLTNSHP-EXCEEDED                                47400000
474100         SET DP030-OVERRIDE-GO TO TRUE                            47410000
474200         MOVE PC-TSYMSG-03381  TO DP020-MSG-NUMBER                47420000
474300         SET DP020-MSG-WARNING TO TRUE                            47430000
474400     END-IF.                                                      47440000
474500                                                                  47450000
474600     IF VN013-MAX-ADDR-EXCEEDED                                   47460000
474700         SET DP030-OVERRIDE-GO TO TRUE                            47470000
474800         MOVE PC-TSYMSG-02645  TO DP020-MSG-NUMBER                47480000
474900         SET DP020-MSG-WARNING TO TRUE                            47490000
475000     END-IF.                                                      47500000
475100                                                                  47510000
475200     IF VN013-MAX-DEPT-EXCEEDED                                   47520000
475300         SET DP030-OVERRIDE-GO TO TRUE                            47530000
475400         MOVE PC-TSYMSG-02646  TO DP020-MSG-NUMBER                47540000
475500         SET DP020-MSG-WARNING TO TRUE                            47550000
475600     END-IF.                                                      47560000
475700                                                                  47570000
475800                                                                  47580000
475900/                                                                 47590000
476000*----------------------------------------------------------------*47600000
476100* PERFORM INSERT PRE AND SUB TICKET PROCESS                      *47610000
476200*----------------------------------------------------------------*47620000
476300                                                                  47630000
476400 5700-INSERT-TICKET-PROCESS.                                      47640000
476500                                                                  47650000
476600     PERFORM 6000-GET-MAX-SEQ-NBR.                                47660000
476700                                                                  47670000
476800     PERFORM 6350-SEE-IF-ROW-EXISTS.                              47680000
476900     IF PV-DB2-COUNT = 0                                          47690000
477000        PERFORM 6300-INSERT-TVNDAGR-TICKET                        47700000
477100     ELSE                                                         47710000
477200             SET PS-ERROR          TO TRUE                        47720000
477300             SET DP020-MSG-FATAL   TO TRUE                        47730000
477400             MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER            47740000
477500     END-IF.                                                      47750000
477600                                                                  47760000
477700/                                                                 47770000
477800*----------------------------------------------------------------*47780000
477900* PERFORM INSERT SERVICE PROCESS                                 *47790000
478000*----------------------------------------------------------------*47800000
478100                                                                  47810000
478200 5700-INSERT-SERVICE-PROCESS.                                     47820000
478300                                                                  47830000
478400     PERFORM 6000-GET-MAX-SEQ-NBR.                                47840000
478500     PERFORM 6350-SEE-IF-ROW-EXISTS.                              47850000
478600     IF PV-DB2-COUNT = 0                                          47860000
478700        PERFORM 6300-INSERT-TVNDAGR-SERVICE                       47870000
478800     ELSE                                                         47880000
478900             SET PS-ERROR          TO TRUE                        47890000
479000             SET DP020-MSG-FATAL   TO TRUE                        47900000
479100             MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER            47910000
479200     END-IF.                                                      47920000
479300                                                                  47930000
479400/                                                                 47940000
479500*----------------------------------------------------------------*47950000
479600* PERFORM INSERT AGREEMENT PROCESS                               *47960000
479700*----------------------------------------------------------------*47970000
479800                                                                  47980000
479900 5700-INSERT-AGRMNT-PROCESS.                                      47990000
480000                                                                  48000000
480100     PERFORM 6000-GET-MAX-SEQ-NBR.                                48010000
480200     PERFORM 6350-SEE-IF-ROW-EXISTS.                              48020000
480300     IF PV-DB2-COUNT = 0                                          48030000
480400        PERFORM 6300-INSERT-TVNDAGR-AGRMNT                        48040000
480500     ELSE                                                         48050000
480600        SET PS-ERROR          TO TRUE                             48060000
480700        SET DP020-MSG-FATAL   TO TRUE                             48070000
480800        MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER                 48080000
480900     END-IF.                                                      48090000
481000                                                                  48100000
481100/                                                                 48110000
481200*----------------------------------------------------------------*48120000
481300* PERFORM DELETE LOGIC                                           *48130000
481400*----------------------------------------------------------------*48140000
481500                                                                  48150000
481600 5800-DELETE-PROCESSING.                                          48160000
481700                                                                  48170000
481800     PERFORM 6010-GET-ACTIVE-TVNDAGR.                             48180000
481900                                                                  48190000
482000     PERFORM 6100-SET-TVNDAGR-EXPRTN-DATE.                        48200000
482100                                                                  48210000
482200/                                                                 48220000
482300*----------------------------------------------------------------*48230000
482400* PERFORM UPDATE PRE-TICKET AND SUB-TICKET PROCESS               *48240000
482500*----------------------------------------------------------------*48250000
482600                                                                  48260000
482700 5900-UPDATE-TICKET-PROCESS.                                      48270000
482800                                                                  48280000
482900     PERFORM 6010-GET-ACTIVE-TVNDAGR.                             48290000
483000     PERFORM 6100-SET-TVNDAGR-EXPRTN-DATE.                        48300000
483100                                                                  48310000
483200     PERFORM 6000-GET-MAX-SEQ-NBR.                                48320000
483300     PERFORM 6350-SEE-IF-ROW-EXISTS.                              48330000
483400     IF PV-DB2-COUNT = 0                                          48340000
483500        PERFORM 6300-INSERT-TVNDAGR-TICKET                        48350000
483600     ELSE                                                         48360000
483700             SET PS-ERROR          TO TRUE                        48370000
483800             SET DP020-MSG-FATAL   TO TRUE                        48380000
483900             MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER            48390000
484000     END-IF.                                                      48400000
484100                                                                  48410000
484200/                                                                 48420000
484300*----------------------------------------------------------------*48430000
484400* PERFORM UPDATE SERVICE PROCESS                                 *48440000
484500*----------------------------------------------------------------*48450000
484600                                                                  48460000
484700 5900-UPDATE-SERVICE-PROCESS.                                     48470000
484800                                                                  48480000
484900     PERFORM 6010-GET-ACTIVE-TVNDAGR.                             48490000
485000     PERFORM 6100-SET-TVNDAGR-EXPRTN-DATE.                        48500000
485100                                                                  48510000
485200     PERFORM 6000-GET-MAX-SEQ-NBR.                                48520000
485300     PERFORM 6350-SEE-IF-ROW-EXISTS.                              48530000
485400     IF PV-DB2-COUNT = 0                                          48540000
485500        PERFORM 6300-INSERT-TVNDAGR-SERVICE                       48550000
485600     ELSE                                                         48560000
485700        SET PS-ERROR          TO TRUE                             48570000
485800        SET DP020-MSG-FATAL   TO TRUE                             48580000
485900        MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER                 48590000
486000     END-IF.                                                      48600000
486100                                                                  48610000
486200/                                                                 48620000
486300*----------------------------------------------------------------*48630000
486400* PERFORM UPDATE AGREEMENT PROCESS                               *48640000
486500*----------------------------------------------------------------*48650000
486600                                                                  48660000
486700 5900-UPDATE-AGRMNT-PROCESS.                                      48670000
486800                                                                  48680000
486900     PERFORM 6010-GET-ACTIVE-TVNDAGR.                             48690000
487000     PERFORM 6100-SET-TVNDAGR-EXPRTN-DATE.                        48700000
487100                                                                  48710000
487200     PERFORM 6000-GET-MAX-SEQ-NBR.                                48720000
487300     PERFORM 6350-SEE-IF-ROW-EXISTS.                              48730000
487400     IF PV-DB2-COUNT = 0                                          48740000
487500        PERFORM 6300-INSERT-TVNDAGR-AGRMNT                        48750000
487600     ELSE                                                         48760000
487700        SET PS-ERROR          TO TRUE                             48770000
487800        SET DP020-MSG-FATAL   TO TRUE                             48780000
487900        MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER                 48790000
488000     END-IF.                                                      48800000
488100                                                                  48810000
488200/                                                                 48820000
488300*----------------------------------------------------------------*48830000
488400*    FIND THE ROW WITH THE HIGHEST SEQUENCE NUMBER               *48840000
488500*----------------------------------------------------------------*48850000
488600                                                                  48860000
488700 6000-GET-MAX-SEQ-NBR.                                            48870000
488800                                                                  48880000
488900     PERFORM                                                      48890000
489000         WITH TEST AFTER                                          48900000
489100         VARYING PV-RETRY-COUNTER                                 48910000
489200         FROM 1 BY 1                                              48920000
489300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48930000
489400             OR (SQLCODE = +0)                                    48940000
489500             OR (SQLCODE = -305))                                 48950000
489600                                                                  48960000
489700         EXEC SQL                                                 48970000
489800              SELECT MAX(SEQ_NBR)                                 48980000
489900                INTO :PV-MAX-SEQ-NBR                              48990000
490000                FROM TVNDAGR                                      49000000
490100               WHERE DEPT_NBR          = :DK-DEPT-NBR             49010000
490200                 AND ENT_ID            = :DK-ENT-ID               49020000
490300                 AND AGRMT_TYP_ID      = :DK-AGRMT-TYP-ID         49030000
490400         END-EXEC                                                 49040000
490500                                                                  49050000
490600         EVALUATE TRUE                                            49060000
490700             WHEN SQLCODE = +0                                    49070000
490800                  COMPUTE PV-NEXT-SEQ-NBR =                       49080000
490900                          PV-MAX-SEQ-NBR + 1                      49090000
491000             WHEN SQLCODE = -305                                  49100000
491100                  MOVE +1         TO PV-NEXT-SEQ-NBR              49110000
491200                                                                  49120000
491300             WHEN SQLCODE = -904                                  49130000
491400             WHEN SQLCODE = -913                                  49140000
491500                  CONTINUE                                        49150000
491600                                                                  49160000
491700             WHEN SQLWARN0 NOT = SPACES                           49170000
491800             WHEN SQLCODE < +0                                    49180000
491900             WHEN SQLCODE > +0                                    49190000
492000                  MOVE '6000-GET-MAX-SEQ-NBR'                     49200000
492100                                  TO DP013-PARAGRAPH              49210000
492200                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          49220000
492300                                  TO DP013-MESSAGE-TEXT (1)       49230000
492400                  MOVE SQLCA      TO DP013-SQLCA                  49240000
492500                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     49250000
492600                  SET DP013-DB2-ABEND                             49260000
492700                      DP013-XCTL-DISPLAY-RESTART                  49270000
492800                                  TO TRUE                         49280000
492900                  PERFORM DP013-0000-PROCESS-ABEND                49290000
493000         END-EVALUATE                                             49300000
493100     END-PERFORM.                                                 49310000
493200                                                                  49320000
493300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49330000
493400         MOVE '6000-GET-MAX-SEQ-NBR'                              49340000
493500                                  TO DP013-PARAGRAPH              49350000
493600         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        49360000
493700                                  TO DP013-MESSAGE-TEXT (1)       49370000
493800         MOVE SQLCA               TO DP013-SQLCA                  49380000
493900         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     49390000
494000         SET DP013-DB2-ABEND                                      49400000
494100             DP013-XCTL-DISPLAY-RESTART                           49410000
494200                                  TO TRUE                         49420000
494300         PERFORM DP013-0000-PROCESS-ABEND                         49430000
494400     END-IF.                                                      49440000
494500                                                                  49450000
494600/                                                                 49460000
494700*----------------------------------------------------------------*49470000
494800*    FIND THE ROW WITH THE HIGHEST SEQUENCE NUMBER WITHIN A TYPE *49480000
494900*----------------------------------------------------------------*49490000
495000                                                                  49500000
495100 6010-GET-ACTIVE-TVNDAGR.                                         49510000
495200                                                                  49520000
495300     PERFORM                                                      49530000
495400         WITH TEST AFTER                                          49540000
495500         VARYING PV-RETRY-COUNTER                                 49550000
495600         FROM 1 BY 1                                              49560000
495700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49570000
495800             OR (SQLCODE = +0)                                    49580000
495900             OR (SQLCODE = -305))                                 49590000
496000                                                                  49600000
496100         EXEC SQL                                                 49610000
496200              SELECT MAX(SEQ_NBR)                                 49620000
496300                INTO :PV-MAX-SEQ-NBR                              49630000
496400                FROM TVNDAGR                                      49640000
496500               WHERE DEPT_NBR          = :DK-DEPT-NBR             49650000
496600                 AND ENT_ID            = :DK-ENT-ID               49660000
496700                 AND AGRMT_TYP_ID      = :DK-AGRMT-TYP-ID         49670000
496800                 AND TYP_CDE           = :DK-TYPE-CDE             49680000
496900         END-EXEC                                                 49690000
497000                                                                  49700000
497100         EVALUATE TRUE                                            49710000
497200             WHEN SQLCODE = +0                                    49720000
497300             WHEN SQLCODE = -305                                  49730000
497400             WHEN SQLCODE = -904                                  49740000
497500             WHEN SQLCODE = -913                                  49750000
497600                  CONTINUE                                        49760000
497700                                                                  49770000
497800             WHEN SQLWARN0 NOT = SPACES                           49780000
497900             WHEN SQLCODE < +0                                    49790000
498000             WHEN SQLCODE > +0                                    49800000
498100                  MOVE '6010-GET-ACTIVE-TVNDAGR'                  49810000
498200                                  TO DP013-PARAGRAPH              49820000
498300                  MOVE 'UNSUCCESSFUL SELECT MAX SEQ NBR'          49830000
498400                                  TO DP013-MESSAGE-TEXT (1)       49840000
498500                  MOVE SQLCA      TO DP013-SQLCA                  49850000
498600                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     49860000
498700                  SET DP013-DB2-ABEND                             49870000
498800                      DP013-XCTL-DISPLAY-RESTART                  49880000
498900                                  TO TRUE                         49890000
499000                  PERFORM DP013-0000-PROCESS-ABEND                49900000
499100         END-EVALUATE                                             49910000
499200     END-PERFORM.                                                 49920000
499300                                                                  49930000
499400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49940000
499500         MOVE '6010-GET-ACTIVE-TVNDAGR'                           49950000
499600                                  TO DP013-PARAGRAPH              49960000
499700         MOVE 'MAX RETRIES EXCEEDED ON SELECT MAX SEQ NBR'        49970000
499800                                  TO DP013-MESSAGE-TEXT (1)       49980000
499900         MOVE SQLCA               TO DP013-SQLCA                  49990000
500000         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     50000000
500100         SET DP013-DB2-ABEND                                      50010000
500200             DP013-XCTL-DISPLAY-RESTART                           50020000
500300                                  TO TRUE                         50030000
500400         PERFORM DP013-0000-PROCESS-ABEND                         50040000
500500     END-IF.                                                      50050000
500600                                                                  50060000
500700/                                                                 50070000
500800*----------------------------------------------------------------*50080000
500900*    SET THE EXPIRATION DATE ON THE TVNDAGR TABLE                *50090000
501000*----------------------------------------------------------------*50100000
501100 6100-SET-TVNDAGR-EXPRTN-DATE.                                    50110000
501200                                                                  50120000
501300     PERFORM                                                      50130000
501400         WITH TEST AFTER                                          50140000
501500         VARYING PV-RETRY-COUNTER                                 50150000
501600         FROM 1 BY 1                                              50160000
501700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50170000
501800             OR (SQLCODE = +0))                                   50180000
501900                                                                  50190000
502000         EXEC SQL                                                 50200000
502100              UPDATE TVNDAGR                                      50210000
502200                 SET EXPIRATION_DATE = CURRENT DATE               50220000
502300               WHERE DEPT_NBR          = :DK-DEPT-NBR             50230000
502400                 AND ENT_ID            = :DK-ENT-ID               50240000
502500                 AND AGRMT_TYP_ID      = :DK-AGRMT-TYP-ID         50250000
502600                 AND SEQ_NBR           = :PV-MAX-SEQ-NBR          50260000
502700                 AND TYP_CDE           = :DK-TYPE-CDE             50270000
502800         END-EXEC                                                 50280000
502900                                                                  50290000
503000         EVALUATE TRUE                                            50300000
503100             WHEN SQLCODE = +0                                    50310000
503200             WHEN SQLCODE = -904                                  50320000
503300             WHEN SQLCODE = -913                                  50330000
503400                  CONTINUE                                        50340000
503500                                                                  50350000
503600             WHEN SQLWARN0 NOT = SPACES                           50360000
503700             WHEN SQLCODE < +0                                    50370000
503800             WHEN SQLCODE > +0                                    50380000
503900                  MOVE '6100-SET-TVNDAGR-EXPRTN-DATE'             50390000
504000                                  TO DP013-PARAGRAPH              50400000
504100                  MOVE 'UNSUCCESSFUL UPDATE ON TVNDAGR'           50410000
504200                                  TO DP013-MESSAGE-TEXT (1)       50420000
504300                  MOVE SQLCA      TO DP013-SQLCA                  50430000
504400                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     50440000
504500                  SET DP013-DB2-ABEND                             50450000
504600                      DP013-XCTL-DISPLAY-RESTART                  50460000
504700                                  TO TRUE                         50470000
504800                  PERFORM DP013-0000-PROCESS-ABEND                50480000
504900         END-EVALUATE                                             50490000
505000     END-PERFORM.                                                 50500000
505100                                                                  50510000
505200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50520000
505300         MOVE '6100-SET-TVNDAGR-EXPRTN-DATE'                      50530000
505400                                  TO DP013-PARAGRAPH              50540000
505500         MOVE 'MAX RETRIES EXCEEDED ON UPDATE TVNDAGR'            50550000
505600                                  TO DP013-MESSAGE-TEXT (1)       50560000
505700         MOVE SQLCA               TO DP013-SQLCA                  50570000
505800         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     50580000
505900         SET DP013-DB2-ABEND                                      50590000
506000             DP013-XCTL-DISPLAY-RESTART                           50600000
506100                                  TO TRUE                         50610000
506200         PERFORM DP013-0000-PROCESS-ABEND                         50620000
506300     END-IF.                                                      50630000
506400                                                                  50640000
506500/                                                                 50650000
506600*----------------------------------------------------------------*50660000
506700*    INSERT A PRE OR SUB TICKET ROW ON THE TVNDAGR TABLE         *50670000
506800*----------------------------------------------------------------*50680000
506900                                                                  50690000
507000 6300-INSERT-TVNDAGR-TICKET.                                      50700000
507100                                                                  50710000
507200     PERFORM                                                      50720000
507300         WITH TEST AFTER                                          50730000
507400         VARYING PV-RETRY-COUNTER                                 50740000
507500         FROM 1 BY 1                                              50750000
507600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50760000
507700             OR (SQLCODE = +0))                                   50770000
507800                                                                  50780000
507900         EXEC SQL                                                 50790000
508000              INSERT INTO TVNDAGR                                 50800000
508100                     ( ENT_ID                                     50810000
508200                      ,DEPT_NBR                                   50820000
508300                      ,AGRMT_TYP_ID                               50830000
508400                      ,SEQ_NBR                                    50840000
508500                      ,TYP_CDE                                    50850000
508600                      ,EFFECTIVE_DATE                             50860000
508700                      ,EXPIRATION_DATE                            50870000
508800                      ,LEADTIME_DAYS_QTY                          50880000
508900                      ,BULK_STK_TKT_IND                           50890000
509000                      ,TKT_MKR_IND                                50900000
509100                      ,LAST_UPD_ID                                50910000
509200                      ,PARTIAL_IND                                50920000
509300                      ,CHRG_PCT                                   50930000
509400                      ,CHRG_FCTR_CDE                              50940000
509500                      ,CHRG_AMT)                                  50950000
509600              VALUES ( :DK-ENT-ID                                 50960000
509700                      ,:DK-DEPT-NBR                               50970000
509800                      ,:DK-AGRMT-TYP-ID                           50980000
509900                      ,:PV-NEXT-SEQ-NBR                           50990000
510000                      ,:VNDAGR-TYP-CDE                            51000000
510100                      , CURRENT DATE                              51010000
510200                      ,:VNDAGR-EXPIRATION-DATE                    51020000
510300                         :DN-EXPIRATION-DATE                      51030000
510400                      ,:VNDAGR-LEADTIME-DAYS-QTY                  51040000
510500                         :DN-LEADTIME-DAYS-QTY                    51050000
510600                      ,:VNDAGR-BULK-STK-TKT-IND                   51060000
510700                         :DN-BULK-STK-TKT-IND                     51070000
510800                      ,:VNDAGR-TKT-MKR-IND                        51080000
510900                         :DN-TKT-MKR-IND                          51090000
511000                      ,:DP020-USERID                              51100000
511100                      ,:VNDAGR-PARTIAL-IND                        51110000
511200                         :DN-PARTIAL-IND                          51120000
511300                      ,:VNDAGR-CHRG-PCT                           51130000
511400                         :DN-CHRG-PCT                             51140000
511500                      ,:VNDAGR-CHRG-FCTR-CDE                      51150000
511600                         :DN-CHRG-FCTR-CDE                        51160000
511700                      ,:VNDAGR-CHRG-AMT                           51170000
511800                         :DN-CHRG-AMT)                            51180000
511900         END-EXEC                                                 51190000
512000                                                                  51200000
512100         EVALUATE TRUE                                            51210000
512200             WHEN SQLCODE = +0                                    51220000
512300             WHEN SQLCODE = -904                                  51230000
512400             WHEN SQLCODE = -913                                  51240000
512500                  CONTINUE                                        51250000
512600                                                                  51260000
512700             WHEN SQLWARN0 NOT = SPACES                           51270000
512800             WHEN SQLCODE < +0                                    51280000
512900             WHEN SQLCODE > +0                                    51290000
513000                  MOVE '6300-INSERT-TVNDAGR-TICKET'               51300000
513100                                  TO DP013-PARAGRAPH              51310000
513200                  MOVE 'UNSUCCESSFUL INSERT FOR TVNDAGR'          51320000
513300                                  TO DP013-MESSAGE-TEXT (1)       51330000
513400                  MOVE SQLCA      TO DP013-SQLCA                  51340000
513500                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     51350000
513600                  SET DP013-DB2-ABEND                             51360000
513700                      DP013-XCTL-DISPLAY-RESTART                  51370000
513800                                  TO TRUE                         51380000
513900                  PERFORM DP013-0000-PROCESS-ABEND                51390000
514000         END-EVALUATE                                             51400000
514100     END-PERFORM.                                                 51410000
514200                                                                  51420000
514300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        51430000
514400         MOVE '6300-INSERT-TVNDAGR-TICKET'                        51440000
514500                                  TO DP013-PARAGRAPH              51450000
514600         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TVNDAGR'        51460000
514700                                  TO DP013-MESSAGE-TEXT (1)       51470000
514800         MOVE SQLCA               TO DP013-SQLCA                  51480000
514900         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     51490000
515000         SET DP013-DB2-ABEND                                      51500000
515100             DP013-XCTL-DISPLAY-RESTART                           51510000
515200                                  TO TRUE                         51520000
515300         PERFORM DP013-0000-PROCESS-ABEND                         51530000
515400     END-IF.                                                      51540000
515500                                                                  51550000
515600/                                                                 51560000
515700*----------------------------------------------------------------*51570000
515800*    INSERT A SERVICE OR PROGRAM ROW                             *51580000
515900*----------------------------------------------------------------*51590000
516000                                                                  51600000
516100 6300-INSERT-TVNDAGR-SERVICE.                                     51610000
516200                                                                  51620000
516300     PERFORM                                                      51630000
516400         WITH TEST AFTER                                          51640000
516500         VARYING PV-RETRY-COUNTER                                 51650000
516600         FROM 1 BY 1                                              51660000
516700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51670000
516800             OR (SQLCODE = +0))                                   51680000
516900                                                                  51690000
517000         EXEC SQL                                                 51700000
517100              INSERT INTO TVNDAGR                                 51710000
517200                     ( ENT_ID                                     51720000
517300                      ,DEPT_NBR                                   51730000
517400                      ,AGRMT_TYP_ID                               51740000
517500                      ,SEQ_NBR                                    51750000
517600                      ,TYP_CDE                                    51760000
517700                      ,EFFECTIVE_DATE                             51770000
517800                      ,EXPIRATION_DATE                            51780000
517900                      ,LEADTIME_DAYS_QTY                          51790000
518000                      ,LAST_UPD_ID                                51800000
518100                      ,CHRG_PCT                                   51810000
518200                      ,CHRG_FCTR_CDE                              51820000
518300                      ,CHRG_AMT)                                  51830000
518400              VALUES ( :DK-ENT-ID                                 51840000
518500                      ,:DK-DEPT-NBR                               51850000
518600                      ,:DK-AGRMT-TYP-ID                           51860000
518700                      ,:PV-NEXT-SEQ-NBR                           51870000
518800                      ,:VNDAGR-TYP-CDE                            51880000
518900                      , CURRENT DATE                              51890000
519000                      ,:VNDAGR-EXPIRATION-DATE                    51900000
519100                         :DN-EXPIRATION-DATE                      51910000
519200                      ,:VNDAGR-EXT-PAY-DAYS-QTY                   51920000
519300                      ,:DP020-USERID                              51930000
519400                      ,:VNDAGR-CHRG-PCT                           51940000
519500                         :DN-CHRG-PCT                             51950000
519600                      ,:VNDAGR-CHRG-FCTR-CDE                      51960000
519700                         :DN-CHRG-FCTR-CDE                        51970000
519800                      ,:VNDAGR-CHRG-AMT                           51980000
519900                         :DN-CHRG-AMT)                            51990000
520000         END-EXEC                                                 52000000
520100                                                                  52010000
520200         EVALUATE TRUE                                            52020000
520300             WHEN SQLCODE = +0                                    52030000
520400             WHEN SQLCODE = -904                                  52040000
520500             WHEN SQLCODE = -913                                  52050000
520600                  CONTINUE                                        52060000
520700                                                                  52070000
520800             WHEN SQLWARN0 NOT = SPACES                           52080000
520900             WHEN SQLCODE < +0                                    52090000
521000             WHEN SQLCODE > +0                                    52100000
521100                  MOVE '6300-INSERT-TVNDAGR-SERVICE'              52110000
521200                                  TO DP013-PARAGRAPH              52120000
521300                  MOVE 'UNSUCCESSFUL INSERT FOR TVNDAGR'          52130000
521400                                  TO DP013-MESSAGE-TEXT (1)       52140000
521500                  MOVE SQLCA      TO DP013-SQLCA                  52150000
521600                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     52160000
521700                  SET DP013-DB2-ABEND                             52170000
521800                      DP013-XCTL-DISPLAY-RESTART                  52180000
521900                                  TO TRUE                         52190000
522000                  PERFORM DP013-0000-PROCESS-ABEND                52200000
522100         END-EVALUATE                                             52210000
522200     END-PERFORM.                                                 52220000
522300                                                                  52230000
522400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        52240000
522500         MOVE '6300-INSERT-TVNDAGR-SERVICE'                       52250000
522600                                  TO DP013-PARAGRAPH              52260000
522700         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TVNDAGR'        52270000
522800                                  TO DP013-MESSAGE-TEXT (1)       52280000
522900         MOVE SQLCA               TO DP013-SQLCA                  52290000
523000         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     52300000
523100         SET DP013-DB2-ABEND                                      52310000
523200             DP013-XCTL-DISPLAY-RESTART                           52320000
523300                                  TO TRUE                         52330000
523400         PERFORM DP013-0000-PROCESS-ABEND                         52340000
523500     END-IF.                                                      52350000
523600                                                                  52360000
523700/                                                                 52370000
523800*----------------------------------------------------------------*52380000
523900*    INSERT AN INCENTIVE ROW                                     *52390000
524000*----------------------------------------------------------------*52400000
524100                                                                  52410000
524200 6300-INSERT-TVNDAGR-AGRMNT.                                      52420000
524300                                                                  52430000
524400     PERFORM                                                      52440000
524500         WITH TEST AFTER                                          52450000
524600         VARYING PV-RETRY-COUNTER                                 52460000
524700         FROM 1 BY 1                                              52470000
524800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52480000
524900             OR (SQLCODE = +0))                                   52490000
525000                                                                  52500000
525100         EXEC SQL                                                 52510000
525200              INSERT INTO TVNDAGR                                 52520000
525300                     ( ENT_ID                                     52530000
525400                      ,DEPT_NBR                                   52540000
525500                      ,AGRMT_TYP_ID                               52550000
525600                      ,SEQ_NBR                                    52560000
525700                      ,TYP_CDE                                    52570000
525800                      ,EFFECTIVE_DATE                             52580000
525900                      ,EXPIRATION_DATE                            52590000
526000                      ,DISCOUNT_PCT                               52600000
526100                      ,EXT_PAY_DAYS_QTY                           52610000
526200                      ,LAST_UPD_ID                                52620000
526300                      ,CHRG_PCT                                   52630000
526400                      ,CHRG_FCTR_CDE                              52640000
526500                      ,CHRG_AMT)                                  52650000
526600              VALUES ( :DK-ENT-ID                                 52660000
526700                      ,:DK-DEPT-NBR                               52670000
526800                      ,:DK-AGRMT-TYP-ID                           52680000
526900                      ,:PV-NEXT-SEQ-NBR                           52690000
527000                      ,:VNDAGR-TYP-CDE                            52700000
527100                      , CURRENT DATE                              52710000
527200                      ,:VNDAGR-EXPIRATION-DATE                    52720000
527300                         :DN-EXPIRATION-DATE                      52730000
527400                      ,:VNDAGR-DISCOUNT-PCT                       52740000
527500                         :DN-DISCOUNT-PCT                         52750000
527600                      ,:VNDAGR-EXT-PAY-DAYS-QTY                   52760000
527700                         :DN-EXT-PAY-DAYS-QTY                     52770000
527800                      ,:DP020-USERID                              52780000
527900                      ,:VNDAGR-CHRG-PCT                           52790000
528000                         :DN-CHRG-PCT                             52800000
528100                      ,:VNDAGR-CHRG-FCTR-CDE                      52810000
528200                         :DN-CHRG-FCTR-CDE                        52820000
528300                      ,:VNDAGR-CHRG-AMT                           52830000
528400                         :DN-CHRG-AMT)                            52840000
528500         END-EXEC                                                 52850000
528600                                                                  52860000
528700         EVALUATE TRUE                                            52870000
528800             WHEN SQLCODE = +0                                    52880000
528900             WHEN SQLCODE = -904                                  52890000
529000             WHEN SQLCODE = -913                                  52900000
529100                  CONTINUE                                        52910000
529200                                                                  52920000
529300             WHEN SQLWARN0 NOT = SPACES                           52930000
529400             WHEN SQLCODE < +0                                    52940000
529500             WHEN SQLCODE > +0                                    52950000
529600                  MOVE '6300-INSERT-TVNDAGR-AGRMNT'               52960000
529700                                  TO DP013-PARAGRAPH              52970000
529800                  MOVE 'UNSUCCESSFUL INSERT FOR TVNDAGR'          52980000
529900                                  TO DP013-MESSAGE-TEXT (1)       52990000
530000                  MOVE SQLCA      TO DP013-SQLCA                  53000000
530100                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     53010000
530200                  SET DP013-DB2-ABEND                             53020000
530300                      DP013-XCTL-DISPLAY-RESTART                  53030000
530400                                  TO TRUE                         53040000
530500                  PERFORM DP013-0000-PROCESS-ABEND                53050000
530600         END-EVALUATE                                             53060000
530700     END-PERFORM.                                                 53070000
530800                                                                  53080000
530900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        53090000
531000         MOVE '6300-INSERT-TVNDAGR-AGRMNT'                        53100000
531100                                  TO DP013-PARAGRAPH              53110000
531200         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TVNDAGR'        53120000
531300                                  TO DP013-MESSAGE-TEXT (1)       53130000
531400         MOVE SQLCA               TO DP013-SQLCA                  53140000
531500         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     53150000
531600         SET DP013-DB2-ABEND                                      53160000
531700             DP013-XCTL-DISPLAY-RESTART                           53170000
531800                                  TO TRUE                         53180000
531900         PERFORM DP013-0000-PROCESS-ABEND                         53190000
532000     END-IF.                                                      53200000
532100                                                                  53210000
532200*----------------------------------------------------------------*53220000
532300 6350-SEE-IF-ROW-EXISTS.                                          53230000
532400                                                                  53240000
532500     PERFORM WITH TEST AFTER                                      53250000
532600             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 53260000
532700               UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES OR         53270000
532800                     SQLCODE = ZERO OR                            53280000
532900                     SQLCODE = +100                               53290000
533000                                                                  53300000
533100        EXEC SQL                                                  53310000
533200                SELECT COUNT(*)                                   53320000
533300                  INTO :PV-DB2-COUNT                              53330000
533400                  FROM TVNDAGR                                    53340000
533500                 WHERE ENT_ID =:DK-ENT-ID                         53350000
533600                   AND DEPT_NBR =:DK-DEPT-NBR                     53360000
533700                   AND AGRMT_TYP_ID =:DK-AGRMT-TYP-ID             53370000
533800                   AND TYP_CDE =:VNDAGR-TYP-CDE                   53380000
533900                   AND EFFECTIVE_DATE   <= CURRENT DATE           53390000
534000                   AND EXPIRATION_DATE  >  CURRENT DATE           53400000
534100        END-EXEC                                                  53410000
534200                                                                  53420000
534300        EVALUATE TRUE                                             53430000
534400            WHEN SQLCODE = ZERO                                   53440000
534500            WHEN SQLCODE = +100                                   53450000
534600            WHEN SQLCODE = -904                                   53460000
534700            WHEN SQLCODE = -913                                   53470000
534800                 CONTINUE                                         53480000
534900                                                                  53490000
535000            WHEN SQLWARN0 NOT = SPACES                            53500000
535100            WHEN SQLCODE < ZERO                                   53510000
535200            WHEN SQLCODE > ZERO                                   53520000
535300                 MOVE '6350-SEE-IF-ROW-EXISTS'                    53530000
535400                                     TO DP013-PARAGRAPH           53540000
535500                 MOVE DK-DEPT-NBR    TO DP013-MESSAGE-TEXT (1)    53550000
535600                 MOVE DK-ENT-ID      TO DP013-MESSAGE-TEXT (2)    53560000
535700                 MOVE SQLCA          TO DP013-SQLCA               53570000
535800                 MOVE 'TVNDAGR'      TO DP013-DB2-TABLE-NAME (1)  53580000
535900                 SET DP013-DB2-ABEND                              53590000
536000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           53600000
536100                 PERFORM DP013-0000-PROCESS-ABEND                 53610000
536200         END-EVALUATE                                             53620000
536300     END-PERFORM.                                                 53630000
536400                                                                  53640000
536500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         53650000
536600         MOVE '6350-SEE-IF-ROW-EXISTS' TO DP013-PARAGRAPH         53660000
536700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO COUNT ROWS' 53670000
536800                                    TO DP013-MESSAGE-TEXT (1)     53680000
536900                 MOVE DK-DEPT-NBR    TO DP013-MESSAGE-TEXT (1)    53690000
537000                 MOVE DK-ENT-ID      TO DP013-MESSAGE-TEXT (2)    53700000
537100         MOVE SQLCA                 TO DP013-SQLCA                53710000
537200         MOVE 'TVNDAGR'             TO DP013-DB2-TABLE-NAME (1)   53720000
537300         SET DP013-DB2-ABEND                                      53730000
537400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   53740000
537500         PERFORM DP013-0000-PROCESS-ABEND                         53750000
537600     END-IF.                                                      53760000
537700                                                                  53770000
537800/                                                                 53780000
537900*----------------------------------------------------------------*53790000
538000*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *53800000
538100*----------------------------------------------------------------*53810000
538200                                                                  53820000
538300 9100-READ-SEL-QUEUE.                                             53830000
538400                                                                  53840000
538500     EXEC CICS                                                    53850000
538600         READQ TS                                                 53860000
538700             QUEUE (ASC-SEL-QUEUE-NAME)                           53870000
538800             INTO  (VN003-VENDOR-SEL-REC)                         53880000
538900             ITEM  (ASC-SEL-ITEM)                                 53890000
539000             RESP  (PV-CICS-RESPONSE)                             53900000
539100     END-EXEC.                                                    53910000
539200                                                                  53920000
539300     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   53930000
539400         CONTINUE                                                 53940000
539500     ELSE                                                         53950000
539600         SET DP013-LOGIC-ABEND                                    53960000
539700             DP013-NO-ROLLBACK     TO TRUE                        53970000
539800         MOVE '9100-READ-SEL-QUEUE'                               53980000
539900                                   TO DP013-PARAGRAPH             53990000
540000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   54000000
540100                                   TO DP013-MESSAGE-TEXT (1)      54010000
540200         PERFORM DP013-0000-PROCESS-ABEND                         54020000
540300     END-IF.                                                      54030000
540400                                                                  54040000
540500/                                                                 54050000
540600*----------------------------------------------------------------*54060000
540700*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *54070000
540800*----------------------------------------------------------------*54080000
540900 9200-REWRITE-SEL-QUEUE.                                          54090000
541000     EXEC CICS                                                    54100000
541100          WRITEQ TS                                               54110000
541200              QUEUE  (ASC-SEL-QUEUE-NAME)                         54120000
541300              FROM   (VN003-VENDOR-SEL-REC)                       54130000
541400              ITEM   (ASC-SEL-ITEM)                               54140000
541500              RESP   (PV-CICS-RESPONSE)                           54150000
541600              REWRITE                                             54160000
541700     END-EXEC.                                                    54170000
541800                                                                  54180000
541900     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               54190000
542000         SET DP013-CICS-ABEND                                     54200000
542100             DP013-NO-ROLLBACK     TO TRUE                        54210000
542200         MOVE '9200-REWRITE-SEL-QUEUE'                            54220000
542300                                   TO DP013-PARAGRAPH             54230000
542400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   54240000
542500                                   TO DP013-MESSAGE-TEXT (1)      54250000
542600         PERFORM DP013-0000-PROCESS-ABEND                         54260000
542700     END-IF.                                                      54270000
542800                                                                  54280000
542900/                                                                 54290000
543000*----------------------------------------------------------------*54300000
543100*    ABEND PROCESSOR MODULE                                      *54310000
543200*----------------------------------------------------------------*54320000
543300                                                                  54330000
543400     COPY DPPD013.                                                54340000
