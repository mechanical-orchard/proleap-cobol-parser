000100******************************************************************00010000
000200**   THIS IS THE COBOL COPY MEMBER TO BE USED WHEN CALLING      **00020000
000300**   DPKCS199.  THIS ROUTINE IS CALLED FROM CICS TO DETERMINE   **00030000
000301**   THE IP ADDRESS FOR THE TERMINAL THAT THE USER IS LOGGED-IN **00030100
000302**   AT.                                                        **00030200
000303**                                                              **00030300
000304**   BEFORE CALLING THIS ROUTINE, MAKE SURE THAT THE LU BEING   **00030400
000305**   PASSED TO IT IS 'TCP0'                                     **00030500
000306**                                                              **00030600
000307**   USAGE:                                                     **00030700
000308**        CALL DP199-DPKCS199 USING DP199-VTAM-LU               **00030800
000309**                                  DP199-IP-ADDR               **00030900
000310**                                  DP199-RETURN-CODE.          **00031000
000311**                                                              **00031100
000312**                                                              **00031200
000313**                                                              **00031300
000314**                                                              **00031400
000320******************************************************************00032000
000400                                                                  00040000
000500 01  DP199-DPKCS199                PIC  X(08)  VALUE 'DPKCS199'.  00050001
000510 01  DP199-TCP-QUERY-PARAMENTERS.                                 00051000
000600*                                                                 00060000
000700*    INPUT PARAMETERS:                                            00070000
000800*                                                                 00080000
000900     05  DP199-INPUT.                                             00090000
001100         10  DP199-VTAM-LU         PIC  X(08)  VALUE SPACE.       00110000
001110*                                                                 00111000
001120*    OUTPUT PARAMETERS:                                           00112000
001130*                                                                 00113000
001200     05  DP199-OUTPUT.                                            00120000
001700         10  DP199-IP-ADDR.                                       00170000
001710             15  DP199-IP-OCTET-1  PIC  X(03)  VALUE SPACE.       00171000
001720             15  DP199-IP-OCTET-2  PIC  X(03)  VALUE SPACE.       00172000
001730             15  DP199-IP-OCTET-3  PIC  X(03)  VALUE SPACE.       00173000
001740             15  DP199-IP-OCTET-4  PIC  X(03)  VALUE SPACE.       00174000
001800         10  DP199-RETURN-CODE     PIC  X(04)  VALUE SPACE.       00180000
001900             88  DP199-RETURN-SUCCESS          VALUE '0000'.      00190000
001910             88  DP199-RETURN-NO-CVTUSR-PTR    VALUE '0001'.      00191000
001920             88  DP199-RETURN-NO-TCP-TBL       VALUE '0002'.      00192000
001930             88  DP199-RETURN-LU-NOT-TCP       VALUE '0003'.      00193000
001940             88  DP199-RETURN-TERM-NOT-HEX     VALUE '0004'.      00194000
