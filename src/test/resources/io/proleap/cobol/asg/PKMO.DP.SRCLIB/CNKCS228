000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    CNKCS228.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER                                   00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  JANUARY, 2001                                     00070001
000800 DATE-COMPILED.                                                   00080001
000900*---------------------------------------------------------------* 00090001
001000*    Y228 - DC-DOOR TO STORE ASSIGNMENT SCREEN                    00100001
001100*    THIS PROGRAM WILL ALLOW THE ASSOCIATE TO ADD OR DELETE DOOR  00110001
001200*    TO STORE ASSIGNMENTS.  YOU GET TO THIS SCREEN EITHER FROM    00120001
001300*    THE CRIT SPEC SCREEN (CNKCS224) OR THE DOOR LIST SCREEN      00130001
001400*    (CNKCS227).                                                  00140099
001500*---------------------------------------------------------------* 00150099
001510* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00151099
001520* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00152099
001530* MAKING THE CALL DYNAMIC VS STATIC.                              00153099
001540*----------------------------------------------------------------*00154099
001550* CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00155099
001560* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00156099
001570* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00157099
001580*-----------------------------------------------------------------00158099
001600 ENVIRONMENT DIVISION.                                            00160099
001700 DATA DIVISION.                                                   00170099
001800                                                                  00180099
001900 WORKING-STORAGE SECTION.                                         00190099
002000                                                                  00200099
002100 01  DK-DB2-KEYS.                                                 00210099
002200     10  DK-DOOR-ID               PIC  X(4)        VALUE SPACES.  00220099
002300     10  DK-OPER-UNT-ID           PIC  S9(4) COMP  VALUE ZEROES.  00230099
002400     10  DK-STR-NBR               PIC  S9(4) COMP  VALUE ZEROES.  00240099
002500     10  DK-STR-NBR1              PIC  S9(4) COMP  VALUE ZEROES.  00250099
002600     10  DK-STR-NBR2              PIC  S9(4) COMP  VALUE ZEROES.  00260099
002700     10  DK-STR-NBR3              PIC  S9(4) COMP  VALUE ZEROES.  00270099
002800     10  DK-DIVERT-NBR            PIC  S9(4) COMP  VALUE ZEROES.  00280099
002900     10  DK-DIVERT-NBR2           PIC  S9(9) COMP  VALUE ZEROES.  00290099
003000     10  DK-DIVERT-LOC            PIC  X(4)        VALUE SPACES.  00300099
003100     10  DK-DOOR-TYPE-CDE         PIC  X(2)        VALUE SPACES.  00310099
003200                                                                  00320099
003300 01  PC-PROGRAM-CONSTANTS.                                        00330099
003400     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS228'.  00340099
003500     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK228  '.  00350099
003600     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM228 '.  00360099
003700     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00370099
003800                                              COMP.               00380099
003900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00390099
004000                                              COMP.               00400099
004100     05  PC-INTER-APPL-CODES.                                     00410099
004200         10  PC-INTER-APPL-CRIT-SPEC PIC  X(01)  VALUE '1'.       00420099
004300         10  PC-INTER-APPL-LIST      PIC  X(01)  VALUE '2'.       00430099
004400     05  PC-A                        PIC  X(01)  VALUE  'A'.      00440099
004500     05  PC-D                        PIC  X(01)  VALUE  'D'.      00450099
004600     05  PC-I                        PIC  X(01)  VALUE  'I'.      00460099
004700     05  PC-L                        PIC  X(01)  VALUE  'L'.      00470099
004800     05  PC-N                        PIC  X(01)  VALUE  'N'.      00480099
004900     05  PC-U                        PIC  X(01)  VALUE  'U'.      00490099
005000     05  PC-Y                        PIC  X(01)  VALUE  'Y'.      00500099
005100     05  PC-SPACE                    PIC  X(01)  VALUE  ' '.      00510099
005200     05  PC-01                       PIC  X(02)  VALUE  '01'.     00520099
005300     05  PC-AC                       PIC  X(02)  VALUE  'AC'.     00530099
005400     05  PC-DC                       PIC  X(02)  VALUE  'DC'.     00540099
005500     05  PC-DS                       PIC  X(02)  VALUE  'DS'.     00550099
005600     05  PC-SH                       PIC  X(02)  VALUE  'SH'.     00560099
005700     05  PC-ST                       PIC  X(02)  VALUE  'ST'.     00570099
005800*    05  PC-MLTDRS                   PIC  X(06)  VALUE  'MLTDRS'. 00580099
005900     05  PC-MLTSTR                   PIC  X(06)  VALUE  'MLTSTR'. 00590099
006000     05  PC-DEFAULT-TIMESTAMP        PIC  X(26)                   00600099
006100                          VALUE  '9999-09-09-09.09.09.999999'.    00610099
006200                                                                  00620099
006300*----------------------------------------------------------------*00630099
006400*  SYSTEM MESSAGES                                                00640099
006500*----------------------------------------------------------------*00650099
006600*   00005 - INVALID VALUE                                         00660099
006700*   00007 - REQUIRED ENTRY                                        00670099
006800*   00008 - MUST BE NUMERIC                                       00680099
006900*   00017 - STORE DOES NOT EXIST                                  00690099
007000*   00059 - UPDATE(S) SUCCESSFUL                                  00700099
007100*   00069 - TOP OF LIST                                           00710099
007200*   00070 - BOTTOM OF LIST                                        00720099
007300*   00115 - DELETE SUCCESSFUL                                     00730099
007400*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00740099
007500*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00750099
007600*   02576 - UPDATING DOOR DEFINITION - PRESS F2 TO CONFIRM        00760099
007700*   02577 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-STORE00770099
007800*   02578 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-DC LO00780099
007900*   02579 - CANNOT CHANGE DOOR TYPE-DOOR CURRENTLY ASSIGNED TO A D00790099
008000*   02582 - UPDATING DOOR TO STORE ASSIGNMENT - PRESS F2 TO CONFIR00800099
008100*   02583 - INVALID ASSIGNMENT - SHIPPING DOORS REQUIRE A STORE TO00810099
008200*   02584 - INVALID ASSIGNMENT - SHUTTLE DOORS REQUIRE DISTRIBUTIO00820099
008300*   02612 - YOU DO NOT HAVE AUTHORITY TO UPDATE                   00830099
008400*   02620 - DOORS SHARING SAME CONVEYOR DIVERT CANNOT HAVE SAME ST00840099
008500*   02621 - F2 - CONFIRM THAT MULTIPLE STORES ARE BEING ASSIGNED T00850099
008600*   02644 - STORE ALREADY ASSIGNED TO ANOTHER DOOR                00860099
008700*   02772 - STORE IS CURRENTLY NOT ASSIGNED TO THIS DC            00870099
008800*   02937 - SHARED DIVERT & LANE ASSIGNMENT CAN NOT HAVE SAME STOR00880099
008900*   02961 - STORE ASSIGNMENT FOR STORAGE DOOR MUST BE CURRENT DC L00890099
009000*   02997 - F2 - CONFIRM THAT STORE IS BEING ASSIGNED MULT DOORS  00900099
009100*   03048 - SAME STORE CAN'T BE ASSIGNED TO MULT DRS W/SAME DIVRT 00910099
009200*   03618 - CANT CHG ASGMT-DIVRTS FOR STR NO MANIFESTED TO TRLR   00920099
009210*   03738 - IF EFC INTERFACE WITH WMOS MUST BE SH FIR E-STORE     00921099
009220*   03804-AMAZON RETURNS CENTER - LABEL PRINT NOT ALLOWED         00922099
009230*   03806-DC NOT SETUP TO PRINT AMAZON RETURNS CENTER LABELS      00923099
009240*   03807-DC NOT SETUP TO ASGN AMAZON LOCATIONS TO SHIP DOORS     00924099
009300*   99901 - INVALID COMMAND WAS ENTERED                           00930099
009400*----------------------------------------------------------------*00940099
009500     05  PC-TSYMSG-NUMBERS.                                       00950099
009600         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00960099
009700         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00970099
009800         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00980099
009900         10  PC-TSYMSG-00017      PIC  9(05)  VALUE  00017.       00990099
010000         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       01000099
010100         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       01010099
010200         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       01020099
010300         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       01030099
010400         10  PC-TSYMSG-02571      PIC  9(05)  VALUE  02571.       01040099
010500         10  PC-TSYMSG-02575      PIC  9(05)  VALUE  02575.       01050099
010600         10  PC-TSYMSG-02576      PIC  9(05)  VALUE  02576.       01060099
010700         10  PC-TSYMSG-02577      PIC  9(05)  VALUE  02577.       01070099
010800         10  PC-TSYMSG-02578      PIC  9(05)  VALUE  02578.       01080099
010900         10  PC-TSYMSG-02579      PIC  9(05)  VALUE  02579.       01090099
011000         10  PC-TSYMSG-02582      PIC  9(05)  VALUE  02582.       01100099
011100         10  PC-TSYMSG-02583      PIC  9(05)  VALUE  02583.       01110099
011200         10  PC-TSYMSG-02584      PIC  9(05)  VALUE  02584.       01120099
011300         10  PC-TSYMSG-02612      PIC  9(05)  VALUE  02612.       01130099
011400         10  PC-TSYMSG-02620      PIC  9(05)  VALUE  02620.       01140099
011500         10  PC-TSYMSG-02621      PIC  9(05)  VALUE  02621.       01150099
011600         10  PC-TSYMSG-02644      PIC  9(05)  VALUE  02644.       01160099
011700         10  PC-TSYMSG-02772      PIC  9(05)  VALUE  02772.       01170099
011800         10  PC-TSYMSG-02937      PIC  9(05)  VALUE  02937.       01180099
011900         10  PC-TSYMSG-02961      PIC  9(05)  VALUE  02961.       01190099
012000         10  PC-TSYMSG-02963      PIC  9(05)  VALUE  02963.       01200099
012100         10  PC-TSYMSG-02997      PIC  9(05)  VALUE  02997.       01210099
012200         10  PC-TSYMSG-03048      PIC  9(05)  VALUE  03048.       01220099
012300         10  PC-TSYMSG-03618      PIC  9(05)  VALUE  03618.       01230099
012310         10  PC-TSYMSG-03738      PIC  9(05)  VALUE  03738.       01231099
012320         10  PC-TSYMSG-03804      PIC  9(05)  VALUE  03804.       01232099
012330         10  PC-TSYMSG-03806      PIC  9(05)  VALUE  03806.       01233099
012340         10  PC-TSYMSG-03807      PIC  9(05)  VALUE  03807.       01234099
012400         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       01240099
012500*                                                                 01250099
012600 01  PS-PROGRAM-SWITCHES.                                         01260099
012700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01270099
012800         88  PS-ERROR                         VALUE  'Y'.         01280099
012900         88  PS-NO-ERROR                      VALUE  'N'.         01290099
013000     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01300099
013100         88  PS-COMMAREA-VALID                VALUE  'Y'.         01310099
013200         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01320099
013300     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01330099
013400         88  PS-LIST-END                      VALUE  'Y'.         01340099
013500         88  PS-NO-LIST-END                   VALUE  'N'.         01350099
013600     05  PS-ACCESS-SW             PIC  X(01)  VALUE  'N'.         01360099
013700         88  PS-ACCESS-ALLOWED                VALUE  'Y'.         01370099
013800         88  PS-ACCESS-NOT-ALLOWED            VALUE  'N'.         01380099
013900     05  PS-DUPLICATE-STORE-SW    PIC  X(01)  VALUE  'N'.         01390099
014000         88  PS-DUPLICATE-STORE-ASGNMT        VALUE  'Y'.         01400099
014100         88  PS-NO-DUPLICATE-STORE-ASGNMT     VALUE  'N'.         01410099
014200     05  PS-DUPLICATE-DR-DVRT-SW  PIC  X(01)  VALUE  'N'.         01420099
014300         88  PS-DUPLICATE-DOOR-DIVERT         VALUE  'Y'.         01430099
014400         88  PS-NO-DUPLICATE-DOOR-DIVERT      VALUE  'N'.         01440099
014500     05  PS-SAME-STR-MLT-DR-SW    PIC  X(01)  VALUE  'N'.         01450099
014600         88  PS-SAME-STR-MLT-DR               VALUE  'Y'.         01460099
014700         88  PS-SAME-STR-MLT-DR-NO            VALUE  'N'.         01470099
014800     05  PS-SAME-STR-MLT-DVT-SW   PIC  X(01)  VALUE  'N'.         01480099
014900         88  PS-SAME-STR-MLT-DVT              VALUE  'Y'.         01490099
015000         88  PS-SAME-STR-MLT-DVT-NO           VALUE  'N'.         01500099
015100     05  PS-MULTIPLE-STORE-SW     PIC  X(01)  VALUE  'Y'.         01510099
015200         88  PS-MULTIPLE-STORES-ALLOWED       VALUE  'Y'.         01520099
015300         88  PS-NO-MULTIPLE-STORES-ALLOWED    VALUE  'N'.         01530099
015400     05  PS-MULTIPLE-DOORS-SW     PIC  X(01)  VALUE  'N'.         01540099
015500         88  PS-MULTIPLE-DOORS-ALLOWED        VALUE  'Y'.         01550099
015600         88  PS-NO-MULTIPLE-DOORS-ALLOWED     VALUE  'N'.         01560099
015700     05  PS-CARTONS-MFST-1-SW     PIC  X(01)  VALUE  'N'.         01570099
015800         88  PS-ALL-CARTONS-MFST-1            VALUE  'Y'.         01580099
015900         88  PS-NOT-ALL-CARTONS-MFST-1        VALUE  'N'.         01590099
016000     05  PS-CARTONS-MFST-2-SW     PIC  X(01)  VALUE  'N'.         01600099
016100         88  PS-ALL-CARTONS-MFST-2            VALUE  'Y'.         01610099
016200         88  PS-NOT-ALL-CARTONS-MFST-2        VALUE  'N'.         01620099
016300     05  PS-CARTONS-MFST-3-SW     PIC  X(01)  VALUE  'N'.         01630099
016400         88  PS-ALL-CARTONS-MFST-3            VALUE  'Y'.         01640099
016500         88  PS-NOT-ALL-CARTONS-MFST-3        VALUE  'N'.         01650099
016510     05  PS-WMOS-EFC-SW           PIC  X(01)  VALUE  'N'.         01651099
016520         88  PS-WMOS-EFC-YES                  VALUE  'Y'.         01652099
016530         88  PS-WMOS-EFC-NO                  VALUE  'N'.          01653099
016540* DMH 07/18/2018                                                  01654099
016550     05  PS-AMAZON-RETURN-CENTER-SW PIC X(01) VALUE  'N'.         01655099
016560         88  PS-AMAZON-RETURN-CENTER-YES      VALUE  'Y'.         01656099
016570         88  PS-AMAZON-RETURN-CENTER-NO       VALUE  'N'.         01657099
016580     05  PS-DC-ASGN-AMAZON-SHIP-SW  PIC X(01) VALUE  'N'.         01658099
016590         88  PS-DC-ASGN-AMAZON-SHIP-YES       VALUE  'Y'.         01659099
016591         88  PS-DC-ASGN-AMAZON-SHIP-NO        VALUE  'N'.         01659199
016592                                                                  01659299
016600                                                                  01660099
016700 01  PV-PROGRAM-VARIABLES.                                        01670099
016800     05  PV-ECOMM-OTBND-ASSGN-SW  PIC X(01)   VALUE SPACES.       01680099
016900         88  PV-ECOMM-OTBND-ASSGN-YES         VALUE 'Y'.          01690099
017000         88  PV-ECOMM-OTBND-ASSGN-NO          VALUE 'N'.          01700099
017100     05  PV-ZERO-SUP-VAR         PIC  Z(09)   VALUE ZEROES.       01710099
017200     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01720099
017300                                              COMP SYNC.          01730099
017400     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01740099
017500                                              COMP SYNC.          01750099
017600     05  PV-NBR-OF-ASGNMT         PIC S9(04)  VALUE +0            01760099
017700                                              COMP SYNC.          01770099
017800     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0            01780099
017900                                              COMP SYNC.          01790099
018000     05  PV-READ-COUNT            PIC S9(09)  VALUE +0            01800099
018100                                              COMP-3.             01810099
018200     05  PC-MAX-ITEMS             PIC S9(09)  VALUE +3            01820099
018300                                              COMP-3.             01830099
018400     05  PV-DOOR-ID               PIC   X(4)        VALUE SPACES. 01840099
018500     05  PV-OPER-UNT-ID           PIC  S9(4) COMP   VALUE ZEROES. 01850099
018600     05  PV-DIVERT-NBR            PIC  S9(4) COMP   VALUE ZEROES. 01860099
018700     05  PV-TRLR-COUNT            PIC  S9(9) COMP   VALUE ZEROES. 01870099
018800     05  PV-DISP-OPER             PIC  9(04).                     01880099
018900     05  PV-DISP-DEST             PIC  9(04).                     01890099
019000     05  PV-DISP-SQLCODE          PIC -9(03).                     01900099
019100*---------------------------------------------------------------* 01910099
019200* SELECTON QUEUE LAYOUT                                         * 01920099
019300*---------------------------------------------------------------* 01930099
019400     COPY CNWS013.                                                01940099
019500                                                                  01950099
019600*----------------------------------------------------------------*01960099
019700*    MAP LAYOUT                                                  *01970099
019800*----------------------------------------------------------------*01980099
019900     COPY CNKM228.                                                01990099
020000                                                                  02000099
020100*----------------------------------------------------------------*02010099
020200**  SECURITY SUBROUTINE PARAMETERS                                02020099
020300*----------------------------------------------------------------*02030099
020400     COPY DPWS008.                                                02040099
020500                                                                  02050099
020600*----------------------------------------------------------------*02060099
020700*    ATTRIBUTE SETTINGS COPYBOOK.                                *02070099
020800*----------------------------------------------------------------*02080099
020900     COPY DPWS015.                                                02090099
021000                                                                  02100099
021100*----------------------------------------------------------------*02110099
021200*    FUNCTION KEYS COPYBOOK                                      *02120099
021300*----------------------------------------------------------------*02130099
021400     COPY DPWS016.                                                02140099
021500                                                                  02150099
021600**--------------------------------------------------------------**02160099
021700** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02170099
021800** SUB-ROUTINE (DPKUT100).                                      **02180099
021900**--------------------------------------------------------------**02190099
022000     COPY DPWS010I.                                               02200099
022100                                                                  02210099
022200**--------------------------------------------------------------**02220099
022300** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*02230099
022400** APPLICATION PROGRAMMING INTERFACE MODULE.                    **02240099
022500**--------------------------------------------------------------**02250099
022600     COPY DPWS030.                                                02260099
022610     COPY DPWS930.                                                02261099
022700                                                                  02270099
022800**--------------------------------------------------------------**02280099
022900*    STANDARD COMMAREA.                                           02290099
023000**--------------------------------------------------------------**02300099
023100     COPY DPWS020.                                                02310099
023200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02320099
023300                                                                  02330099
023400*---------------------------------------------------------------* 02340099
023500* INTER-APPLICATION COMMAREA.                                     02350099
023600*   CNWS011 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02360099
023700*             SPEC SCREEN.                                        02370099
023800*   CNWS012 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02380099
023900*             THE LIST SCREEN                                     02390099
024000*---------------------------------------------------------------* 02400099
024100                                                                  02410099
024200         10  INTER-APPL-COMM-AREA PIC X(200).                     02420099
024300     COPY CNWS011.                                                02430099
024400     COPY CNWS012.                                                02440099
024500***************************************************************** 02450099
024600*    SPECIFIC COMMMAREA FOR CNKCS228.                             02460099
024700***************************************************************** 02470099
024800         10  ASC-SPECIFIC-COMMAREA.                               02480099
024900             15  ASC-FUNCTION              PIC  X(01).            02490099
025000             15  ASC-CURR-OPER-UNT-ID      PIC S9(04)  COMP.      02500099
025100             15  ASC-CURR-FCLTY-ID         PIC S9(04)  COMP.      02510099
025200             15  ASC-CURR-FCLTY-NME        PIC X(25).             02520099
025300             15  ASC-OPER-UNT-ID           PIC  X(04).            02530099
025400             15  ASC-OPER-UNT-ID-X REDEFINES ASC-OPER-UNT-ID.     02540099
025500                 20  ASC-OPER-UNT-ID-N     PIC  9(04).            02550099
025600             15  ASC-FCLTY-ID              PIC S9(04)  COMP.      02560099
025700             15  ASC-FCLTY-NME             PIC X(25).             02570099
025800             15  ASC-DOOR-ID               PIC X(04).             02580099
025900             15  ASC-DOOR-TYPE-CODE        PIC X(02).             02590099
026000             15  ASC-LABEL-SEQ             PIC  X(04).            02600099
026100             15  ASC-LABEL-SEQ-X REDEFINES ASC-LABEL-SEQ.         02610099
026200                 20  ASC-LABEL-SEQ-N       PIC  Z(04).            02620099
026300             15  ASC-DOOR-TYPE-DESC        PIC  X(30).            02630099
026400             15  ASC-LOC-DESC              PIC  X(30).            02640099
026500             15  ASC-LANE-ASGNMT           PIC  X(09).            02650099
026600             15  ASC-LANE-ASGNMT-X REDEFINES ASC-LANE-ASGNMT.     02660099
026700                 20  ASC-LANE-ASGNMT-N     PIC  Z(09).            02670099
026800             15  ASC-LANE-ASGNMT-NUM       PIC  9(09).            02680099
026900             15  ASC-DIVERT-LOC            PIC  X(04).            02690099
027000             15  ASC-STORE-ASGNMT          PIC  X(05).            02700099
027100                 88  ASC-STRE-ASGNMT-MULTI      VALUE 'MULTI'.    02710099
027200             15  ASC-STORE-ASGNMT-R REDEFINES ASC-STORE-ASGNMT.   02720099
027300                 20  ASC-STORE-ASGNMT-N    PIC  Z(05).            02730099
027400             15  ASC-START-TIMESTAMP.                             02740099
027500                 20  ASC-CENTURY           PIC  X(04).            02750099
027600                 20  FILLER                PIC  X(01).            02760099
027700                 20  ASC-MONTH             PIC  X(02).            02770099
027800                 20  FILLER                PIC  X(01).            02780099
027900                 20  ASC-DAY               PIC  X(02).            02790099
028000                 20  FILLER                PIC  X(01).            02800099
028100                 20  ASC-HOUR              PIC  X(02).            02810099
028200                 20  FILLER                PIC  X(01).            02820099
028300                 20  ASC-MINUTE            PIC  X(02).            02830099
028400                 20  ASC-REST              PIC  X(10).            02840099
028500             15  ASC-COUNT                 PIC S9(09) COMP.       02850099
028600             15  ASC-DIVERT-COUNT          PIC S9(09) COMP.       02860099
028700             15  ASC-SAME-STR-MLT-DR-CNT   PIC S9(09) COMP.       02870099
028800             15  ASC-SAME-STR-MLT-DR-DVT   PIC S9(09) COMP.       02880099
028900             15  ASC-DEL1                  PIC  X(01).            02890099
029000             15  ASC-DEL2                  PIC  X(01).            02900099
029100             15  ASC-DEL3                  PIC  X(01).            02910099
029200             15  ASC-STNBR1                PIC  X(04).            02920099
029300             15  ASC-STNBR1-X REDEFINES ASC-STNBR1.               02930099
029400                 20  ASC-STNBR1-N          PIC  9(04).            02940099
029500             15  ASC-STNBR1A               PIC  X(04).            02950099
029600             15  ASC-STNBR1A-X REDEFINES ASC-STNBR1A.             02960099
029700                 20  ASC-STNBR1A-N         PIC  9(04).            02970099
029800             15  ASC-STNBR2                PIC  X(04).            02980099
029900             15  ASC-STNBR2-X REDEFINES ASC-STNBR2.               02990099
030000                 20  ASC-STNBR2-N          PIC  9(04).            03000099
030100             15  ASC-STNBR2A               PIC  X(04).            03010099
030200             15  ASC-STNBR2A-X REDEFINES ASC-STNBR2A.             03020099
030300                 20  ASC-STNBR2A-N         PIC  9(04).            03030099
030400             15  ASC-STNBR3                PIC  X(04).            03040099
030500             15  ASC-STNBR3-X REDEFINES ASC-STNBR3.               03050099
030600                 20  ASC-STNBR3-N          PIC  9(04).            03060099
030700             15  ASC-STNBR3A               PIC  X(04).            03070099
030800             15  ASC-STNBR3A-X REDEFINES ASC-STNBR3A.             03080099
030900                 20  ASC-STNBR3A-N         PIC  9(04).            03090099
031000             15  ASC-STNME1                PIC  X(30).            03100099
031100             15  ASC-STNME1A               PIC  X(30).            03110099
031200             15  ASC-STNME2                PIC  X(30).            03120099
031300             15  ASC-STNME2A               PIC  X(30).            03130099
031400             15  ASC-STNME3                PIC  X(30).            03140099
031500             15  ASC-STNME3A               PIC  X(30).            03150099
031600             15  ASC-DATE1                 PIC  X(10).            03160099
031700             15  ASC-DATE2                 PIC  X(10).            03170099
031800             15  ASC-DATE3                 PIC  X(10).            03180099
031900             15  ASC-TIME1                 PIC  X(05).            03190099
032000             15  ASC-TIME2                 PIC  X(05).            03200099
032100             15  ASC-TIME3                 PIC  X(05).            03210099
032200                                                                  03220099
032201             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03220199
032202*                                                                 03220299
032210             15  ASC-STNBR1-WMOS-SW        PIC  X(01).            03221099
032220                 88  ASC-STNBR1-WMOS-YES        VALUE 'Y'.        03222099
032230                 88  ASC-STNBR1-WMOS-NO         VALUE 'N'.        03223099
032240*                                                                 03224099
032310             15  ASC-STNBR2-WMOS-SW        PIC  X(01).            03231099
032320                 88  ASC-STNBR2-WMOS-YES        VALUE 'Y'.        03232099
032330                 88  ASC-STNBR2-WMOS-NO         VALUE 'N'.        03233099
032340*                                                                 03234099
032360             15  ASC-STNBR3-WMOS-SW        PIC  X(01).            03236099
032370                 88  ASC-STNBR3-WMOS-YES        VALUE 'Y'.        03237099
032380                 88  ASC-STNBR3-WMOS-NO         VALUE 'N'.        03238099
032390                                                                  03239099
032400*SWITCHES                                                         03240099
032500             15  ASC-ACTION-SW          PIC X(03).                03250099
032600                 88  ASC-ADD            VALUE 'ADD'.              03260099
032700                 88  ASC-DELETE         VALUE 'DEL'.              03270099
032800                 88  ASC-UPDATE         VALUE 'UPD'.              03280099
032900             15  ASC-MSG-NUMBER.                                  03290099
033000                 20  ASC-MSG-NUMBER-N      PIC  9(05).            03300099
033100             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            03310099
033200             15  ASC-DOOR-TERM-ID          PIC  X(04).            03320099
033300             15  ASC-SYSTEM-ID             PIC  X(02).            03330099
033400             15  ASC-MSG-TEXT              PIC  X(70).            03340099
033500             15  ASC-USE-SELECTION-QUEUE-IND                      03350099
033600                                           PIC  X(01).            03360099
033700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03370099
033800             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            03380099
033900             15  ASC-NUMBER-OF-ITEMS-READ  PIC S9(09) COMP-3.     03390099
034000             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03400099
034100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03410099
034200                                           PIC S9(09)  COMP-3.    03420099
034300             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    03430099
034400                                                          SYNC.   03440099
034500             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03450099
034600             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03460099
034700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03470099
034800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03480099
034900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03490099
035000                                                                  03500099
035100             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03510099
035200                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     03520099
035300                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     03530099
035400             15  ASC-2ND-CONFIRM-NEEDED-SW PIC  X(01).            03540099
035500                 88  ASC-2ND-CONFIRM-NEED           VALUE  'Y'.   03550099
035600                 88  ASC-2ND-CONFIRM-NEED-NO        VALUE  'N'.   03560099
035700                 88  ASC-2ND-CONFIRM-UNKNOWN        VALUE  ' '.   03570099
035800             15  ASC-2ND-CONFIRM-MULT-SW  PIC  X(01).             03580099
035900                 88  ASC-2ND-CONFIRM-MULT           VALUE  'D'.   03590099
036000                 88  ASC-2ND-CONFIRM-MULT-DR        VALUE  'S'.   03600099
036100                 88  ASC-2ND-CONFIRM-MULT-NO        VALUE  ' '.   03610099
036200             15  ASC-STR-MLT-DR-SW        PIC X(01).              03620099
036300                 88  ASC-STR-1-MLT-DR               VALUE  '1'.   03630099
036400                 88  ASC-STR-2-MLT-DR               VALUE  '2'.   03640099
036500                 88  ASC-STR-3-MLT-DR               VALUE  '3'.   03650099
036600                 88  ASC-STR-MLT-DR-NONE            VALUE  ' '.   03660099
036700                                                                  03670099
036800*----------------------------------------------------------------*03680099
036900*    ABEND PROCESSING COPYBOOK.                                  *03690099
037000*----------------------------------------------------------------*03700099
037100     COPY DPWS013.                                                03710099
037200                                                                  03720099
037300*----------------------------------------------------------------*03730099
037400*    CONTROL DOOR TYPE TABLE                                      03740099
037500*----------------------------------------------------------------*03750099
037600     EXEC SQL                                                     03760099
037700          INCLUDE TCNDRTY                                         03770099
037800     END-EXEC.                                                    03780099
037900                                                                  03790099
038000*----------------------------------------------------------------*03800099
038100*    DB2 TABLE FOR CONTROL DISTRIBUTION CENTER DOORS              03810099
038200*----------------------------------------------------------------*03820099
038300     EXEC SQL                                                     03830099
038400          INCLUDE TCNDCDR                                         03840099
038500     END-EXEC.                                                    03850099
038600                                                                  03860099
038700*----------------------------------------------------------------*03870099
038800*    DB2 TABLE FOR CONTROL DOOR TO STORE TABLE                    03880099
038900*----------------------------------------------------------------*03890099
039000     EXEC SQL                                                     03900099
039100          INCLUDE TCNDRST                                         03910099
039200     END-EXEC.                                                    03920099
039300                                                                  03930099
039400*----------------------------------------------------------------*03940099
039500*    DB2 TABLE FOR CONVEYOR CUTOFF                                03950099
039600*----------------------------------------------------------------*03960099
039700     EXEC SQL                                                     03970099
039800          INCLUDE TSUCDOT                                         03980099
039900     END-EXEC.                                                    03990099
040000                                                                  04000099
040100*----------------------------------------------------------------*04010099
040200*    DB2 TABLE FOR CONVEYOR DIVERTS                               04020099
040300*----------------------------------------------------------------*04030099
040400     EXEC SQL                                                     04040099
040500          INCLUDE TSUCRDV                                         04050099
040600     END-EXEC.                                                    04060099
040700                                                                  04070099
040800*----------------------------------------------------------------*04080099
040900*    COMMAREA USED TO CALL XLKUT071                               04090099
041000*----------------------------------------------------------------*04100099
041100     COPY XLWS071.                                                04110099
041200                                                                  04120099
041300*----------------------------------------------------------------*04130099
041400*    XLT_LOC DATABASE                                             04140099
041500*----------------------------------------------------------------*04150099
041600     EXEC SQL                                                     04160099
041700          INCLUDE XLT00010                                        04170099
041800     END-EXEC.                                                    04180099
041900                                                                  04190099
042000                                                                  04200099
042100*----------------------------------------------------------------*04210099
042200*    XLT_DC_LOC_ASGMT DATABASE                                    04220099
042300*----------------------------------------------------------------*04230099
042400     EXEC SQL                                                     04240099
042500          INCLUDE XLT00014                                        04250099
042600     END-EXEC.                                                    04260099
042700                                                                  04270099
042800*----------------------------------------------------------------*04280099
042900*    DB2 TABLE FOR PARAMETERS                                     04290099
043000*----------------------------------------------------------------*04300099
043100     EXEC SQL                                                     04310099
043200          INCLUDE TKRPRPM                                         04320099
043300     END-EXEC.                                                    04330099
043400                                                                  04340099
043500     EXEC SQL                                                     04350099
043600          INCLUDE TSUOBTR                                         04360099
043700     END-EXEC.                                                    04370099
043800                                                                  04380099
043900     EXEC SQL                                                     04390099
044000          INCLUDE TSUOBTS                                         04400099
044100     END-EXEC.                                                    04410099
044110                                                                  04411099
044120     EXEC SQL                                                     04412099
044130          INCLUDE WST00008                                        04413099
044140     END-EXEC.                                                    04414099
044150                                                                  04415099
044160     EXEC SQL                                                     04416099
044170          INCLUDE WST00009                                        04417099
044180     END-EXEC.                                                    04418099
044190                                                                  04419099
044191     EXEC SQL                                                     04419199
044192          INCLUDE WST00010                                        04419299
044193     END-EXEC.                                                    04419399
044200                                                                  04420099
044300*----------------------------------------------------------------*04430099
044400*    CURSOR USED TO BUILD INITIAL SCREEN                          04440099
044500*----------------------------------------------------------------*04450099
044600     EXEC SQL                                                     04460099
044700        DECLARE ASGNMNT-CSR CURSOR FOR                            04470099
044800           SELECT A.STR_NBR                                       04480099
044900                 ,A.STRT_TMST                                     04490099
045000                 ,B.LOC_NM                                        04500099
045100           FROM  TCNDRST A                                        04510099
045200                ,XLT_LOC B                                        04520099
045300          WHERE  A.OPER_UNT_ID = :DK-OPER-UNT-ID                  04530099
045400            AND  A.DOOR_ID     = :DK-DOOR-ID                      04540099
045500            AND  A.END_TMST    = :PC-DEFAULT-TIMESTAMP            04550099
045600            AND  A.STR_NBR     = B.LOC_NBR                        04560099
045700        ORDER BY A.STRT_TMST                                      04570099
045800     END-EXEC.                                                    04580099
045900                                                                  04590099
046000*----------------------------------------------------------------*04600099
046100*    CURSOR USED TO CHECK FOR MATCHING DIVERT/LANE ASSIGNMENTS    04610099
046200*----------------------------------------------------------------*04620099
046300     EXEC SQL                                                     04630099
046400        DECLARE SAME-DIVERT-CSR CURSOR FOR                        04640099
046500           SELECT A.OPER_UNT_ID                                   04650099
046600                 ,A.DIVERT_NBR                                    04660099
046700                 ,A.DOOR_ID                                       04670099
046800           FROM  TCNDCDR A                                        04680099
046900              ,  TCNDRTY B                                        04690099
047000          WHERE  A.OPER_UNT_ID    =  :DK-OPER-UNT-ID              04700099
047100            AND  A.DOOR_ID        <> :DK-DOOR-ID                  04710099
047200            AND  A.DIVERT_NBR     =  :DK-DIVERT-NBR               04720099
047300            AND  A.DIVERT_LOC_ID  =  :DK-DIVERT-LOC               04730099
047400            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                04740099
047500            AND  B.DIVERT_TYP_CDE = :PC-D                         04750099
047600                                                                  04760099
047700        ORDER BY DOOR_ID                                          04770099
047800     END-EXEC.                                                    04780099
047900                                                                  04790099
048000*----------------------------------------------------------------*04800099
048100*    DB2 AREA FOR COMMUNICATIONS                                  04810099
048200*----------------------------------------------------------------*04820099
048300     EXEC SQL                                                     04830099
048400          INCLUDE SQLCA                                           04840099
048500     END-EXEC.                                                    04850099
048600                                                                  04860099
048700*----------------------------------------------------------------*04870099
048800 LINKAGE SECTION.                                                 04880099
048900                                                                  04890099
049000 01  DFHCOMMAREA.                                                 04900099
049100     05  FILLER                         OCCURS  1 TO 4072 TIMES   04910099
049200                                        DEPENDING ON EIBCALEN.    04920099
049300         10  FILLER                     PIC X.                    04930099
049400                                                                  04940099
049500 PROCEDURE DIVISION.                                              04950099
049600***************************************************************** 04960099
049700** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04970099
049800** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04980099
049900** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04990099
050000**                                                             ** 05000099
050100** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 05010099
050200** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 05020099
050300***************************************************************** 05030099
050400 0000-MAIN-MODULE.                                                05040099
050500     INITIALIZE DP030-CICS-API-FIELDS.                            05050099
050600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05060099
050700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05070099
050800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05080099
050900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05090099
051000     MOVE LENGTH OF CNK228I        TO DP030-MAP-LENGTH (1).       05100099
051100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05110099
051200     PERFORM 0001-CALL-CICS-ARCH-API.                             05120099
051300                                                                  05130099
051400     PERFORM 1000-CONTROL-PROCESSING                              05140099
051500                                                                  05150099
051600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05160099
051700     PERFORM 0001-CALL-CICS-ARCH-API.                             05170099
051800                                                                  05180099
051900 0001-CALL-CICS-ARCH-API.                                         05190099
052000     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05200099
052100                                    DFHCOMMAREA                   05210099
052200                                    DP030-CICS-API-FIELDS         05220099
052300                                    DP020-STANDARD-COMMAREA       05230099
052400                                    CNK228I.                      05240099
052500                                                                  05250099
052600     IF  DP030-RC-CALL-SUCCESSFUL                                 05260099
052700         CONTINUE                                                 05270099
052800     ELSE                                                         05280099
052900         SET DP013-NO-ROLLBACK                                    05290099
053000             DP013-XCTL-DISPLAY-RESTART                           05300099
053100             DP013-CICS-ABEND      TO TRUE                        05310099
053200         MOVE 'BEFORE 0000-MAIN-MODULE'                           05320099
053300                                   TO DP013-PARAGRAPH             05330099
053310         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05331099
053320-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05332099
053600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05360099
053700         PERFORM DP013-0000-PROCESS-ABEND                         05370099
053800     END-IF.                                                      05380099
053900*                                                                 05390099
054000*----------------------------------------------------------------*05400099
054100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05410099
054200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05420099
054300*----------------------------------------------------------------*05430099
054400 1000-CONTROL-PROCESSING.                                         05440099
054500                                                                  05450099
054600     EVALUATE TRUE                                                05460099
054700         WHEN DP020-NEXT-ACT-INITIAL                              05470099
054800              INITIALIZE ASC-SPECIFIC-COMMAREA                    05480099
054900              MOVE EIBTRMID TO ASC-DOOR-TERM-ID                   05490099
055000              PERFORM 1100-PROCESS-INTER-APPL-COMM                05500099
055100                                                                  05510099
055200              IF  PS-COMMAREA-NOT-VALID                           05520099
055300                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           05530099
055400              ELSE                                                05540099
055500                  PERFORM 4000-BUILD-INITIAL-PANEL                05550099
055600                  PERFORM 3200-RESET-ATTRIBUTES                   05560099
055700              END-IF                                              05570099
055800                                                                  05580099
055900         WHEN DP020-NEXT-ACT-READ-MAP                             05590099
056000             PERFORM 2000-PROCESS-PANEL                           05600099
056100*F3-END                                                           05610099
056200         WHEN DP020-NEXT-ACT-RETURN                               05620099
056300             PERFORM 4000-BUILD-INITIAL-PANEL                     05630099
056400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05640099
056500             PERFORM 3200-RESET-ATTRIBUTES                        05650099
056600                                                                  05660099
056700         WHEN OTHER                                               05670099
056800             SET DP013-LOGIC-ABEND TO TRUE                        05680099
056900             SET DP013-NO-ROLLBACK TO TRUE                        05690099
057000             MOVE '1000-CONTROL-PROCESSING'                       05700099
057100                                   TO DP013-PARAGRAPH             05710099
057200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05720099
057300                                   TO DP013-MESSAGE-TEXT(1)       05730099
057400             MOVE DP020-NEXT-APPL-ACTIVITY                        05740099
057500                                   TO DP013-MESSAGE-TEXT(2)       05750099
057600             PERFORM DP013-0000-PROCESS-ABEND                     05760099
057700     END-EVALUATE.                                                05770099
057800*                                                                 05780099
057900******************************************************************05790099
058000** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **05800099
058100** INTER-APPLICATION FORMAT CODE.                               **05810099
058200******************************************************************05820099
058300 1100-PROCESS-INTER-APPL-COMM.                                    05830099
058400     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05840099
058500     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   05850099
058600                                                                  05860099
058700     SET PS-COMMAREA-VALID         TO TRUE.                       05870099
058800                                                                  05880099
058900*WHEN COMING FROM CRIT SPEC (CNKCS224- F24=STRASGN)               05890099
059000     EVALUATE ASC-INT-APPL-FORMAT-IND                             05900099
059100         WHEN PC-INTER-APPL-CRIT-SPEC                             05910099
059200             MOVE CN011-FUNCTION          TO ASC-FUNCTION         05920099
059300             MOVE CN011-CURR-OPER-UNT-ID  TO ASC-CURR-OPER-UNT-ID 05930099
059400             MOVE CN011-CURR-FCLTY-ID     TO ASC-CURR-FCLTY-ID    05940099
059500             MOVE CN011-CURR-FCLTY-NME    TO ASC-CURR-FCLTY-NME   05950099
059600             MOVE CN011-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N    05960099
059700             MOVE CN011-FCLTY-ID          TO ASC-FCLTY-ID         05970099
059800             MOVE CN011-FCLTY-NME         TO ASC-FCLTY-NME        05980099
059900             MOVE CN011-DOOR-ID           TO ASC-DOOR-ID          05990099
060000             MOVE CN011-DOOR-TYPE-CDE     TO ASC-DOOR-TYPE-CODE   06000099
060100             MOVE CN011-DOOR-TYPE-DESC    TO ASC-DOOR-TYPE-DESC   06010099
060200             MOVE CN011-LOC-DESC          TO ASC-LOC-DESC         06020099
060300             MOVE CN011-DIVERT-CODE       TO ASC-LANE-ASGNMT-N    06030099
060400                                             ASC-LANE-ASGNMT-NUM  06040099
060500             MOVE CN011-DIVERT-LOC-ID     TO ASC-DIVERT-LOC       06050099
060600             MOVE CN011-LABEL-SEQ         TO ASC-LABEL-SEQ-N      06060099
060700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06070099
060800                                                                  06080099
060900*WHEN COMING FROM DOOR LIST SCREEN (CNKCS227)                     06090099
061000         WHEN PC-INTER-APPL-LIST                                  06100099
061100           IF CN012-NUMBER-OF-SELECTED-ITEMS > 0                  06110099
061200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06120099
061300             MOVE CN012-NUMBER-OF-SELECTED-ITEMS                  06130099
061400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06140099
061500             MOVE CN012-NUMBER-OF-TS-ITEMS                        06150099
061600                                   TO ASC-NUMBER-OF-TS-ITEMS      06160099
061700             MOVE CN012-SEL-QUEUE-NAME                            06170099
061800                                   TO ASC-SEL-QUEUE-NAME          06180099
061900             MOVE CN012-CURR-OPER-UNT-ID TO ASC-CURR-OPER-UNT-ID  06190099
062000             MOVE CN012-CURR-FCLTY-ID    TO ASC-CURR-FCLTY-ID     06200099
062100             MOVE CN012-OPER-UNT-ID      TO ASC-OPER-UNT-ID-N     06210099
062200             MOVE CN012-FCLTY-ID         TO ASC-FCLTY-ID          06220099
062300             MOVE CN012-FCLTY-NME        TO ASC-FCLTY-NME         06230099
062400             MOVE CN012-FUNCTION         TO ASC-FUNCTION          06240099
062500             MOVE 'UPD'                  TO ASC-ACTION-SW         06250099
062600             PERFORM 1120-PREPARE-LIST-ENTRY                      06260099
062700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06270099
062800         END-IF                                                   06280099
062900     END-EVALUATE.                                                06290099
063000                                                                  06300099
063100*----------------------------------------------------------------*06310099
063200* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *06320099
063300* STORAGE QUEUE PASSED FROM THE LIST.                            *06330099
063400*----------------------------------------------------------------*06340099
063500 1120-PREPARE-LIST-ENTRY.                                         06350099
063600     MOVE CN013-MAX-ITEMS          TO ASC-SEL-SUB.                06360099
063700     MOVE ZERO                     TO ASC-SEL-ITEM.               06370099
063800     PERFORM 1130-GET-NEXT-RECORD.                                06380099
063900                                                                  06390099
064000*---------------------------------------------------------------- 06400099
064100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*06410099
064200*---------------------------------------------------------------- 06420099
064300 1130-GET-NEXT-RECORD.                                            06430099
064400     ADD +1                        TO ASC-SEL-SUB.                06440099
064500                                                                  06450099
064600     SET ASC-UPDATE-TSQ TO TRUE.                                  06460099
064700                                                                  06470099
064800     IF  ASC-SEL-SUB > CN013-MAX-ITEMS                            06480099
064900         ADD +1                    TO ASC-SEL-ITEM                06490099
065000         MOVE +1                   TO ASC-SEL-SUB                 06500099
065100     END-IF.                                                      06510099
065200                                                                  06520099
065300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06530099
065400         PERFORM 9100-READ-SEL-QUEUE                              06540099
065500         IF  CN013-ITEM (ASC-SEL-SUB) > ZERO                      06550099
065600             MOVE CN013-DOOR-ID  (ASC-SEL-SUB)  TO ASC-DOOR-ID    06560099
065700             MOVE CN013-TYPE-CODE (ASC-SEL-SUB)                   06570099
065800                                             TO ASC-DOOR-TYPE-CODE06580099
065900             MOVE CN013-LOC-DESC (ASC-SEL-SUB)  TO ASC-LOC-DESC   06590099
066000             MOVE CN013-LANE-ASGNMT (ASC-SEL-SUB)                 06600099
066100                                         TO ASC-LANE-ASGNMT-N     06610099
066200                                            ASC-LANE-ASGNMT-NUM   06620099
066300             MOVE CN013-DIVERT-LOC-ID (ASC-SEL-SUB)               06630099
066400                                                TO ASC-DIVERT-LOC 06640099
066500             MOVE CN013-LBL-SEQ-NBR (ASC-SEL-SUB)                 06650099
066600                                              TO ASC-LABEL-SEQ-N  06660099
066700             MOVE CN013-STORE-ASGNMT (ASC-SEL-SUB)                06670099
066800                                               TO ASC-STORE-ASGNMT06680099
066900             SET CN013-INQ (ASC-SEL-SUB) TO TRUE                  06690099
067000             PERFORM 9200-REWRITE-SEL-QUEUE                       06700099
067100         ELSE                                                     06710099
067200             SUBTRACT +1 FROM ASC-SEL-SUB                         06720099
067300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06730099
067400             SET DP020-MSG-INFORMATIONAL                          06740099
067500                 PS-LIST-END       TO TRUE                        06750099
067600         END-IF                                                   06760099
067700     ELSE                                                         06770099
067800         SUBTRACT +1 FROM ASC-SEL-ITEM                            06780099
067900         MOVE CN013-MAX-ITEMS      TO ASC-SEL-SUB                 06790099
068000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            06800099
068100         SET DP020-MSG-INFORMATIONAL                              06810099
068200                 PS-LIST-END       TO TRUE                        06820099
068300     END-IF.                                                      06830099
068400                                                                  06840099
068500******************************************************************06850099
068600*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         06860099
068700*  PROCESSED.                                                     06870099
068800******************************************************************06880099
068900 1140-GET-PREV-RECORD.                                            06890099
069000     SUBTRACT +1 FROM ASC-SEL-SUB.                                06900099
069100                                                                  06910099
069200     IF  ASC-SEL-SUB < +1                                         06920099
069300         SUBTRACT +1 FROM ASC-SEL-ITEM                            06930099
069400         MOVE CN013-MAX-ITEMS      TO ASC-SEL-SUB                 06940099
069500     END-IF.                                                      06950099
069600                                                                  06960099
069700     IF  ASC-SEL-ITEM > ZERO                                      06970099
069800         PERFORM 9100-READ-SEL-QUEUE                              06980099
069900         IF  CN013-ITEM (ASC-SEL-SUB) > ZERO                      06990099
070000             MOVE CN013-DOOR-ID  (ASC-SEL-SUB)  TO ASC-DOOR-ID    07000099
070100             MOVE CN013-TYPE-CODE (ASC-SEL-SUB)                   07010099
070200                                            TO ASC-DOOR-TYPE-CODE 07020099
070300             MOVE CN013-LOC-DESC (ASC-SEL-SUB) TO ASC-LOC-DESC    07030099
070400             MOVE CN013-DIVERT-LOC-ID (ASC-SEL-SUB)               07040099
070500                                              TO ASC-DIVERT-LOC   07050099
070600             MOVE CN013-LANE-ASGNMT (ASC-SEL-SUB)                 07060099
070700                                         TO ASC-LANE-ASGNMT-N     07070099
070800                                            ASC-LANE-ASGNMT-NUM   07080099
070900             MOVE CN013-LBL-SEQ-NBR (ASC-SEL-SUB)                 07090099
071000                                              TO ASC-LABEL-SEQ-N  07100099
071100             MOVE CN013-STORE-ASGNMT (ASC-SEL-SUB)                07110099
071200                                               TO ASC-STORE-ASGNMT07120099
071300         END-IF                                                   07130099
071400                                                                  07140099
071500         SET CN013-INQ (ASC-SEL-SUB) TO TRUE                      07150099
071600         PERFORM 9200-REWRITE-SEL-QUEUE                           07160099
071700     ELSE                                                         07170099
071800         MOVE +1                   TO ASC-SEL-ITEM                07180099
071900                                      ASC-SEL-SUB                 07190099
072000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07200099
072100         SET DP020-MSG-INFORMATIONAL                              07210099
072200             PS-LIST-END             TO TRUE                      07220099
072300     END-IF.                                                      07230099
072400                                                                  07240099
072500*----------------------------------------------------------------*07250099
072600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07260099
072700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07270099
072800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07280099
072900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07290099
073000* FUNCTION KEYS CAN GET THIS FAR.                                *07300099
073100*----------------------------------------------------------------*07310099
073200 2000-PROCESS-PANEL.                                              07320099
073300                                                                  07330099
073400     EVALUATE TRUE                                                07340099
073500                                                                  07350099
073600         WHEN DP020-SRC-AID = DP016-CLEAR                         07360099
073700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07370099
073800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07380099
073900                                                                  07390099
074000*F5 REFRESH -                                                     07400099
074100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07410099
074200             PERFORM 4000-BUILD-INITIAL-PANEL                     07420099
074300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07430099
074400             PERFORM 3200-RESET-ATTRIBUTES                        07440099
074500             MOVE -1                TO ADEL1L                     07450099
074600                                                                  07460099
074700*F20-NEXT SEL                                                     07470099
074800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07480099
074900             IF  ASC-USE-SELECTION-QUEUE                          07490099
075000                 PERFORM 1130-GET-NEXT-RECORD                     07500099
075100                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07510099
075200                 IF PS-LIST-END                                   07520099
075300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07530099
075400                     SET PS-NO-LIST-END TO TRUE                   07540099
075500                 ELSE                                             07550099
075600                     PERFORM 5600-CLEAR-SCREEN                    07560099
075700                     PERFORM 4000-BUILD-INITIAL-PANEL             07570099
075800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07580099
075900                     PERFORM 3200-RESET-ATTRIBUTES                07590099
076000                 END-IF                                           07600099
076100             ELSE                                                 07610099
076200*                --- BOTTOM OF LIST ---                           07620099
076300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         07630099
076400                 SET DP020-MSG-INFORMATIONAL TO TRUE              07640099
076500             END-IF                                               07650099
076600                                                                  07660099
076700*F19-PREV SEL                                                     07670099
076800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07680099
076900             IF  ASC-USE-SELECTION-QUEUE                          07690099
077000                 PERFORM 1140-GET-PREV-RECORD                     07700099
077100                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07710099
077200                 IF PS-LIST-END                                   07720099
077300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07730099
077400                     SET PS-NO-LIST-END TO TRUE                   07740099
077500                 ELSE                                             07750099
077600                     PERFORM 5600-CLEAR-SCREEN                    07760099
077700                     PERFORM 4000-BUILD-INITIAL-PANEL             07770099
077800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07780099
077900                     PERFORM 3200-RESET-ATTRIBUTES                07790099
078000                 END-IF                                           07800099
078100             ELSE                                                 07810099
078200                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         07820099
078300                 SET DP020-MSG-INFORMATIONAL TO TRUE              07830099
078400             END-IF                                               07840099
078500                                                                  07850099
078600         WHEN OTHER                                               07860099
078700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07870099
078800             PERFORM 3200-RESET-ATTRIBUTES                        07880099
078900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07890099
079000             IF  PS-NO-ERROR                                      07900099
079100                 SET DP030-CONTINUE-GO TO TRUE                    07910099
079200                 PERFORM 2100-CHECK-FUNCTION-KEY                  07920099
079300                 IF DP020-SRC-AID = DP016-ENTER                   07930099
079400                    PERFORM 3200-RESET-ATTRIBUTES                 07940099
079500                 ELSE                                             07950099
079600                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          07960099
079700                 END-IF                                           07970099
079800             ELSE                                                 07980099
079900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07990099
080000                 SET DP030-OVERRIDE-GO TO TRUE                    08000099
080100             END-IF                                               08010099
080200     END-EVALUATE.                                                08020099
080300                                                                  08030099
080400*----------------------------------------------------------------*08040099
080500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *08050099
080600* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *08060099
080700* FROM THE CICS ARCHITECTURE API.                                *08070099
080800*----------------------------------------------------------------*08080099
080900 2100-CHECK-FUNCTION-KEY.                                         08090099
081000     EVALUATE TRUE                                                08100099
081100         WHEN DP020-SRC-AID = DP016-ENTER                         08110099
081200             PERFORM 3200-RESET-ATTRIBUTES                        08120099
081300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08130099
081400                                                                  08140099
081500*-F02 = CONFIRM UPDATE                                            08150099
081600         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   08160099
081700             IF ASC-2ND-CONFIRM-NEED AND                          08170099
081800                ASC-STR-MLT-DR-NONE  AND                          08180099
081900                ASC-2ND-CONFIRM-MULT-NO                           08190099
082000                    SET ASC-2ND-CONFIRM-MULT                      08200099
082100                        DP020-MSG-FATAL                           08210099
082200                        PS-ERROR                                  08220099
082300                        DP030-SET-CURSOR-APPL-1 TO TRUE           08230099
082400                    MOVE -1              TO ADEL1L                08240099
082500                    MOVE PC-TSYMSG-02621 TO DP020-MSG-NUMBER      08250099
082600             ELSE                                                 08260099
082700             IF ASC-2ND-CONFIRM-NEED AND                          08270099
082800                ASC-2ND-CONFIRM-MULT-NO                           08280099
082900                    SET ASC-2ND-CONFIRM-MULT                      08290099
083000                        DP020-MSG-FATAL                           08300099
083100                        PS-ERROR                                  08310099
083200                        DP030-SET-CURSOR-APPL-1 TO TRUE           08320099
083300                    IF  ASC-STR-1-MLT-DR                          08330099
083400                        MOVE -1              TO ASTNBR1AL         08340099
083500                    ELSE                                          08350099
083600                    IF  ASC-STR-2-MLT-DR                          08360099
083700                        MOVE -1              TO ASTNBR2AL         08370099
083800                    ELSE                                          08380099
083900                        MOVE -1              TO ASTNBR3AL         08390099
084000                    END-IF                                        08400099
084100                    END-IF                                        08410099
084200                    ADD  1  TO  ASC-SAME-STR-MLT-DR-CNT           08420099
084300                        GIVING PV-ZERO-SUP-VAR                    08430099
084400                    MOVE PV-ZERO-SUP-VAR TO DP020-MSG-TEXT        08440099
084500                    MOVE PC-TSYMSG-02997 TO DP020-MSG-NUMBER      08450099
084600             ELSE                                                 08460099
084700                 SET ASC-2ND-CONFIRM-MULT-NO TO TRUE              08470099
084800           END-IF                                                 08480099
084900           END-IF                                                 08490099
085000                                                                  08500099
085100           IF  PS-NO-ERROR                                        08510099
085200                MOVE 'DCDRSTOR' TO DP008-FUNCTION-NAME            08520099
085300                PERFORM 2105-RACF-ACCESS                          08530099
085400                IF PS-ACCESS-NOT-ALLOWED                          08540099
085500                    SET PS-ERROR                                  08550099
085600                        DP020-MSG-FATAL     TO TRUE               08560099
085700                    MOVE PC-TSYMSG-02612    TO DP020-MSG-NUMBER   08570099
085800                    MOVE -1                 TO ADRTYPCL           08580099
085900                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           08590099
086000                END-IF                                            08600099
086100           END-IF                                                 08610099
086200                                                                  08620099
086300*------------------------------------------------------------     08630099
086400*  CHECK TO SEE IF THE ASSOCIATE IS TRYING TO ASSIGN THE          08640099
086500*  SAME STORE TO TWO DIFFERENT DOORS.  IF YES, CHECK THE          08650099
086600*  TKRPRPM TABLE TO SEE IF MULTIPLE DOORS ARE ALLOWED.            08660099
086700*------------------------------------------------------------     08670099
086800           IF PS-NO-ERROR                                         08680099
086900             IF  DK-DOOR-TYPE-CDE  =  'ST'                        08690099
087000                 CONTINUE                                         08700099
087100             ELSE                                                 08710099
087200               PERFORM 4390-PREPARE-2-CHECK                       08720099
087300               IF  PS-DUPLICATE-STORE-ASGNMT                      08730099
087400                   IF  ASC-2ND-CONFIRM-NEED  AND                  08740099
087500                       (ASC-STR-1-MLT-DR  OR                      08750099
087600                        ASC-STR-2-MLT-DR  OR                      08760099
087700                        ASC-STR-3-MLT-DR)                         08770099
087800                        CONTINUE                                  08780099
087900                   ELSE                                           08790099
088000                       SET PS-NO-DUPLICATE-STORE-ASGNMT           08800099
088100                                                    TO TRUE       08810099
088200                       MOVE PC-TSYMSG-02644  TO DP020-MSG-NUMBER  08820099
088300                       SET PS-ERROR                               08830099
088400                           DP020-MSG-FATAL   TO TRUE              08840099
088500                   END-IF                                         08850099
088600* DMH - 3/17/03 - BEGIN                                           08860099
088700               ELSE                                               08870099
088800                   IF  PS-DUPLICATE-DOOR-DIVERT                   08880099
088900                       SET PS-NO-DUPLICATE-DOOR-DIVERT            08890099
089000                                                    TO TRUE       08900099
089100                       MOVE PC-TSYMSG-03048  TO DP020-MSG-NUMBER  08910099
089200                       SET PS-ERROR                               08920099
089300                           DP020-MSG-FATAL   TO TRUE              08930099
089400                   END-IF                                         08940099
089500* DMH - 3/17/03 - END                                             08950099
089600               END-IF                                             08960099
089700             END-IF                                               08970099
089800           END-IF                                                 08980099
089900                                                                  08990099
090000*------------------------------------------------------------     09000099
090100*  CHECK TO SEE IF TWO DOORS SHARE A DIVERT/LANE ASSIGNMENT       09010099
090200*  IF THEY DO, MAKE SURE THAT THE STORES ARE NOT DUPLICATES       09020099
090300*------------------------------------------------------------     09030099
090400           IF PS-NO-ERROR                                         09040099
090500               PERFORM 4210-OPEN-DIVERT-CURSOR                    09050099
090600               PERFORM 4220-READ-ITEMS-FROM-DB                    09060099
090700               PERFORM 4230-CLOSE-DIVERT-CURSOR                   09070099
090800                                                                  09080099
090900               IF PS-DUPLICATE-STORE-ASGNMT                       09090099
091000                   MOVE PC-TSYMSG-02620  TO DP020-MSG-NUMBER      09100099
091100                   SET PS-ERROR                                   09110099
091200                       DP020-MSG-FATAL   TO TRUE                  09120099
091300               ELSE                                               09130099
091400                   IF (ASC-DEL1 = PC-Y) OR                        09140099
091500                      (ASC-STNBR1-N > 0 AND ASC-STNBR1A-N > 0)    09150099
091600                         MOVE ASC-STNBR1-N     TO DK-STR-NBR      09160099
091700                         PERFORM 5000-UPDATE-TCNDRST              09170099
091800                   END-IF                                         09180099
091900                   IF ASC-STNBR1A-N > 0                           09190099
092000                       MOVE ASC-STNBR1A-N     TO DK-STR-NBR       09200099
092100                       PERFORM 5500-INSERT-TCNDRST                09210099
092200                   END-IF                                         09220099
092300                   IF (ASC-DEL2 = PC-Y) OR                        09230099
092400                      (ASC-STNBR2-N > 0 AND ASC-STNBR2A-N > 0)    09240099
092500                         MOVE ASC-STNBR2-N     TO DK-STR-NBR      09250099
092600                         PERFORM 5000-UPDATE-TCNDRST              09260099
092700                   END-IF                                         09270099
092800                   IF ASC-STNBR2A-N > 0                           09280099
092900                       MOVE ASC-STNBR2A-N     TO DK-STR-NBR       09290099
093000                       PERFORM 5500-INSERT-TCNDRST                09300099
093100                   END-IF                                         09310099
093200                   IF (ASC-DEL3 = PC-Y) OR                        09320099
093300                      (ASC-STNBR3-N > 0 AND ASC-STNBR3A-N > 0)    09330099
093400                         MOVE ASC-STNBR3-N     TO DK-STR-NBR      09340099
093500                         PERFORM 5000-UPDATE-TCNDRST              09350099
093600                   END-IF                                         09360099
093700                   IF ASC-STNBR3A-N > 0                           09370099
093800                       MOVE ASC-STNBR3A-N     TO DK-STR-NBR       09380099
093900                       PERFORM 5500-INSERT-TCNDRST                09390099
094000                   END-IF                                         09400099
094100               END-IF                                             09410099
094200           END-IF                                                 09420099
094300           IF PS-NO-ERROR                                         09430099
094400               PERFORM 5600-CLEAR-SCREEN                          09440099
094500               PERFORM 4000-BUILD-INITIAL-PANEL                   09450099
094600               PERFORM 3200-RESET-ATTRIBUTES                      09460099
094700               MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER          09470099
094800               SET DP020-MSG-INFORMATIONAL TO TRUE                09480099
094900           END-IF                                                 09490099
095000           IF PS-NO-ERROR                                         09500099
095100                 IF ASC-ACTION-SW = 'UPD'                         09510099
095200                     PERFORM 9100-READ-SEL-QUEUE                  09520099
095300                     SET CN013-UPD (ASC-SEL-SUB) TO TRUE          09530099
095400                     MOVE ASC-DOOR-ID                             09540099
095500                                    TO CN013-DOOR-ID (ASC-SEL-SUB)09550099
095600                     MOVE ASC-DOOR-TYPE-CODE                      09560099
095700                                  TO CN013-TYPE-CODE (ASC-SEL-SUB)09570099
095800                     MOVE ASC-LOC-DESC                            09580099
095900                                   TO CN013-LOC-DESC (ASC-SEL-SUB)09590099
096000                     MOVE ASC-LANE-ASGNMT-N                       09600099
096100                                TO CN013-LANE-ASGNMT (ASC-SEL-SUB)09610099
096200                     MOVE ASC-DIVERT-LOC                          09620099
096300                             TO CN013-DIVERT-LOC-ID (ASC-SEL-SUB) 09630099
096400                     MOVE ASC-LABEL-SEQ-N                         09640099
096500                               TO CN013-LBL-SEQ-NBR (ASC-SEL-SUB) 09650099
096600                     MOVE  ASC-STNBR1-N  TO  ASC-STORE-ASGNMT-N   09660099
096700                     IF  ASC-STNBR2-N  >  0  OR                   09670099
096800                         ASC-STNBR3-N  >  0                       09680099
096900                         SET  ASC-STRE-ASGNMT-MULTI TO TRUE       09690099
097000                     END-IF                                       09700099
097100                     MOVE ASC-STORE-ASGNMT                        09710099
097200                              TO CN013-STORE-ASGNMT (ASC-SEL-SUB) 09720099
097300                     PERFORM 9200-REWRITE-SEL-QUEUE               09730099
097400                 END-IF                                           09740099
097500             END-IF                                               09750099
097600                                                                  09760099
097700*-F15 = UPDATE DOOR ID                                            09770099
097800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09780099
097900             IF ASC-ACTION-SW = 'UPD'                             09790099
098000                 PERFORM 9100-READ-SEL-QUEUE                      09800099
098100                 SET CN013-UPD (ASC-SEL-SUB) TO TRUE              09810099
098200                 MOVE ASC-DOOR-ID  TO CN013-DOOR-ID (ASC-SEL-SUB) 09820099
098300                 MOVE ASC-DOOR-TYPE-CODE                          09830099
098400                                  TO CN013-TYPE-CODE (ASC-SEL-SUB)09840099
098500                 MOVE ASC-LOC-DESC TO CN013-LOC-DESC (ASC-SEL-SUB)09850099
098600                 MOVE ASC-LANE-ASGNMT-N                           09860099
098700                                TO CN013-LANE-ASGNMT (ASC-SEL-SUB)09870099
098800                 MOVE ASC-DIVERT-LOC                              09880099
098900                             TO CN013-DIVERT-LOC-ID (ASC-SEL-SUB) 09890099
099000                 MOVE ASC-LABEL-SEQ-N                             09900099
099100                               TO CN013-LBL-SEQ-NBR (ASC-SEL-SUB) 09910099
099200                 MOVE ASC-STORE-ASGNMT                            09920099
099300                              TO CN013-STORE-ASGNMT (ASC-SEL-SUB) 09930099
099400                 PERFORM 9200-REWRITE-SEL-QUEUE                   09940099
099500             END-IF                                               09950099
099600                                                                  09960099
099700           PERFORM 3150-SELECT-TCNDCDR                            09970099
099800                                                                  09980099
099900           IF  PS-NO-ERROR                                        09990099
100000                MOVE 'DCDRSTOR' TO DP008-FUNCTION-NAME            10000099
100100                PERFORM 2105-RACF-ACCESS                          10010099
100200                IF PS-ACCESS-NOT-ALLOWED                          10020099
100300                    SET PS-ERROR                                  10030099
100400                        DP020-MSG-FATAL     TO TRUE               10040099
100500                    MOVE PC-TSYMSG-02612    TO DP020-MSG-NUMBER   10050099
100600                    MOVE -1                 TO ADRTYPCL           10060099
100700                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           10070099
100800                END-IF                                            10080099
100900           END-IF                                                 10090099
101000                                                                  10100099
101100*------------------------------------------------------------     10110099
101200*  CHECK TO SEE IF THE ASSOCIATE IS TRYING TO ASSIGN THE          10120099
101300*  SAME STORE TO TWO DIFFERENT DOORS.  IF YES, CHECK THE          10130099
101400*  TKRPRPM TABLE TO SEE IF MULTIPLE DOORS ARE ALLOWED.            10140099
101500*------------------------------------------------------------     10150099
101600           IF PS-NO-ERROR                                         10160099
101700               PERFORM 4390-PREPARE-2-CHECK                       10170099
101800               IF PS-DUPLICATE-STORE-ASGNMT                       10180099
101900                   IF  ASC-2ND-CONFIRM-NEED  AND                  10190099
102000                       (ASC-STR-1-MLT-DR  OR                      10200099
102100                        ASC-STR-2-MLT-DR  OR                      10210099
102200                        ASC-STR-3-MLT-DR)                         10220099
102300                        CONTINUE                                  10230099
102400                   ELSE                                           10240099
102500                   SET PS-NO-DUPLICATE-STORE-ASGNMT TO TRUE       10250099
102600                       MOVE PC-TSYMSG-02644  TO DP020-MSG-NUMBER  10260099
102700                       SET PS-ERROR                               10270099
102800                           DP020-MSG-FATAL   TO TRUE              10280099
102900                   END-IF                                         10290099
103000               END-IF                                             10300099
103100           END-IF                                                 10310099
103200                                                                  10320099
103300*------------------------------------------------------------     10330099
103400*  CHECK TO SEE IF ALL CARTONS FOR STORE ASSIGNMENT BEING         10340099
103500*  CHANGED HAVE BEEN MANIFESTED TO A TRAILER                      10350099
103600*  ADDED DMH - 4/7/08                                             10360099
103700*------------------------------------------------------------     10370099
103800           IF PS-NO-ERROR  AND                                    10380099
103900              ASC-DOOR-TYPE-CODE  =  'SH'                         10390099
104000              SET  PS-ALL-CARTONS-MFST-1                          10400099
104100                   PS-ALL-CARTONS-MFST-2                          10410099
104200                   PS-ALL-CARTONS-MFST-3 TO TRUE                  10420099
104300                IF (ASC-DEL1 = PC-Y) OR                           10430099
104400                   (ASC-STNBR1-N > 0 AND ASC-STNBR1A > 0)         10440099
104500                   PERFORM 4500-CHECK-CRTN-MFST-1                 10450099
104600                   IF  PS-NOT-ALL-CARTONS-MFST-1                  10460099
104700                     MOVE ASC-STNBR1-N    TO DP020-MSG-TEXT       10470099
104800                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     10480099
104900                     SET DP020-MSG-FATAL                          10490099
105000                         ASC-2ND-CONFIRM-UNKNOWN                  10500099
105100                         ASC-2ND-CONFIRM-MULT-NO                  10510099
105200                         PS-ERROR          TO TRUE                10520099
105300                   END-IF                                         10530099
105400              END-IF                                              10540099
105500                                                                  10550099
105600              IF (ASC-DEL2 = PC-Y) OR                             10560099
105700                 (ASC-STNBR2-N > 0 AND ASC-STNBR2A > 0)           10570099
105800                   PERFORM 4600-CHECK-CRTN-MFST-2                 10580099
105900                   IF  PS-NOT-ALL-CARTONS-MFST-2                  10590099
106000                     MOVE ASC-STNBR2-N    TO DP020-MSG-TEXT       10600099
106100                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     10610099
106200                     SET DP020-MSG-FATAL                          10620099
106300                         ASC-2ND-CONFIRM-UNKNOWN                  10630099
106400                         ASC-2ND-CONFIRM-MULT-NO                  10640099
106500                         PS-ERROR          TO TRUE                10650099
106600                   END-IF                                         10660099
106700              END-IF                                              10670099
106800                                                                  10680099
106900              IF (ASC-DEL3 = PC-Y) OR                             10690099
107000                 (ASC-STNBR3-N > 0 AND ASC-STNBR3A > 0)           10700099
107100                   PERFORM 4700-CHECK-CRTN-MFST-3                 10710099
107200                   IF  PS-NOT-ALL-CARTONS-MFST-3                  10720099
107300                     MOVE ASC-STNBR3-N    TO DP020-MSG-TEXT       10730099
107400                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     10740099
107500                     SET DP020-MSG-FATAL                          10750099
107600                         ASC-2ND-CONFIRM-UNKNOWN                  10760099
107700                         ASC-2ND-CONFIRM-MULT-NO                  10770099
107800                         PS-ERROR          TO TRUE                10780099
107900                   END-IF                                         10790099
108000              END-IF                                              10800099
108100           END-IF                                                 10810099
108200                                                                  10820099
108300*------------------------------------------------------------     10830099
108400*  CHECK TO SEE IF TWO DOORS SHARE A DIVERT/LANE ASSIGNMENT       10840099
108500*  IF THEY DO, MAKE SURE THAT THE STORES ARE NOT DUPLICATES       10850099
108600*------------------------------------------------------------     10860099
108700           IF PS-NO-ERROR                                         10870099
108800               PERFORM 4210-OPEN-DIVERT-CURSOR                    10880099
108900               PERFORM 4220-READ-ITEMS-FROM-DB                    10890099
109000               PERFORM 4230-CLOSE-DIVERT-CURSOR                   10900099
109100                                                                  10910099
109200               IF PS-DUPLICATE-STORE-ASGNMT                       10920099
109300                   MOVE PC-TSYMSG-02620  TO DP020-MSG-NUMBER      10930099
109400                   SET DP020-MSG-FATAL   TO TRUE                  10940099
109500               ELSE                                               10950099
109600                   IF (ASC-DEL1 = PC-Y) OR                        10960099
109700                      (ASC-STNBR1-N > 0 AND ASC-STNBR1A > 0) OR   10970099
109800                      (ASC-STNBR1A > 0)                           10980099
109900                        MOVE PC-TSYMSG-02582  TO DP020-MSG-NUMBER 10990099
110000                        SET DP020-MSG-FATAL   TO TRUE             11000099
110100                   ELSE                                           11010099
110200                     IF (ASC-DEL2 = PC-Y) OR                      11020099
110300                        (ASC-STNBR2-N > 0 AND ASC-STNBR2A > 0) OR 11030099
110400                          (ASC-STNBR2A > 0)                       11040099
110500                        MOVE PC-TSYMSG-02582  TO DP020-MSG-NUMBER 11050099
110600                            SET DP020-MSG-FATAL   TO TRUE         11060099
110700                     ELSE                                         11070099
110800                       IF (ASC-DEL3 = PC-Y) OR                    11080099
110900                        (ASC-STNBR3-N > 0 AND ASC-STNBR3A > 0) OR 11090099
111000                        (ASC-STNBR3A > 0)                         11100099
111100                         MOVE PC-TSYMSG-02582 TO DP020-MSG-NUMBER 11110099
111200                         SET DP020-MSG-FATAL  TO TRUE             11120099
111300                       END-IF                                     11130099
111400                     END-IF                                       11140099
111500                 END-IF                                           11150099
111600             END-IF                                               11160099
111700           END-IF                                                 11170099
111800                                                                  11180099
111900*-F17 = DOORLIST -- DOOR TYPE LIST                                11190099
112000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11200099
112100              SET  CN011-FUNCTION-NONE         TO  TRUE           11210099
112200              MOVE ASC-CURR-OPER-UNT-ID TO CN011-CURR-OPER-UNT-ID 11220099
112300              MOVE ASC-CURR-FCLTY-ID    TO CN011-CURR-FCLTY-ID    11230099
112400              MOVE ASC-OPER-UNT-ID-N    TO CN011-OPER-UNT-ID      11240099
112500              MOVE ASC-FCLTY-ID         TO CN011-FCLTY-ID         11250099
112600              MOVE ASC-FCLTY-NME        TO CN011-FCLTY-NME        11260099
112700                                                                  11270099
112800*-F23 = DRSTRLST -- DOOR TO STORE LIST                            11280099
112900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11290099
113000              SET  CN011-FUNCTION-NONE         TO  TRUE           11300099
113100              MOVE ASC-CURR-OPER-UNT-ID TO CN011-CURR-OPER-UNT-ID 11310099
113200              MOVE ASC-CURR-FCLTY-ID    TO CN011-CURR-FCLTY-ID    11320099
113300              MOVE ASC-OPER-UNT-ID-N    TO CN011-OPER-UNT-ID      11330099
113400              MOVE ASC-FCLTY-ID         TO CN011-FCLTY-ID         11340099
113500              MOVE ASC-FCLTY-NME        TO CN011-FCLTY-NME        11350099
113600              MOVE ASC-DOOR-ID          TO CN011-DOOR-ID          11360099
113700              MOVE ASC-DOOR-TYPE-CODE   TO CN011-DOOR-TYPE-CDE    11370099
113800              MOVE ASC-LANE-ASGNMT-N    TO CN011-DIVERT-CODE      11380099
113900              MOVE ASC-DIVERT-LOC       TO CN011-DIVERT-LOC-ID    11390099
114000              MOVE ASC-LABEL-SEQ-N      TO CN011-LABEL-SEQ        11400099
114100                                                                  11410099
114200         WHEN OTHER                                               11420099
114300             SET DP013-NO-ROLLBACK                                11430099
114400                 DP013-XCTL-DISPLAY-RESTART                       11440099
114500                 DP013-CICS-ABEND TO TRUE                         11450099
114600             MOVE '2000-PROCESS-PANEL'                            11460099
114700                                   TO DP013-PARAGRAPH             11470099
114800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11480099
114900                                   TO DP013-MESSAGE-TEXT (1)      11490099
115000             PERFORM DP013-0000-PROCESS-ABEND                     11500099
115100     END-EVALUATE.                                                11510099
115200                                                                  11520099
115300*----------------------------------------------------------------*11530099
115400* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     11540099
115500*----------------------------------------------------------------*11550099
115600 2105-RACF-ACCESS.                                                11560099
115700                                                                  11570099
115800      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  11580099
115900      SET DP008-ACCESS-TYPE-USE          TO TRUE                  11590099
116000                                                                  11600099
116100      EXEC CICS                                                   11610099
116200         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 11620099
116300              COMMAREA (DP008-SECURITY-COMMAREA)                  11630099
116400              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             11640099
116500      END-EXEC                                                    11650099
116600                                                                  11660099
116700      IF DP008-CALL-SUCCESSFUL                                    11670099
116800         IF DP008-ACCESS-ALLOWED                                  11680099
116900             SET PS-ACCESS-ALLOWED TO TRUE                        11690099
117000         ELSE                                                     11700099
117100             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    11710099
117200         END-IF                                                   11720099
117300     ELSE                                                         11730099
117400         MOVE '2105-RACF-ACCESS' TO DP013-PARAGRAPH               11740099
117500          MOVE 'UNABLE TO ACCESS CICS'                            11750099
117600                               TO DP013-MESSAGE-TEXT (1)          11760099
117700          MOVE SQLCA                 TO DP013-SQLCA               11770099
117800          SET DP013-DB2-ABEND                                     11780099
117900              DP013-XCTL-DISPLAY-RESTART TO TRUE                  11790099
118000          PERFORM DP013-0000-PROCESS-ABEND                        11800099
118100      END-IF.                                                     11810099
118200                                                                  11820099
118300*----------------------------------------------------------------*11830099
118400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *11840099
118500* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *11850099
118600* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *11860099
118700* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *11870099
118800*----------------------------------------------------------------*11880099
118900 2200-MOVE-SCREEN-TO-COMMAREA.                                    11890099
119000*DELETE ELECTION #1                                               11900099
119100         IF  ADEL1L > ZERO                                        11910099
119200             MOVE ADEL1I             TO ASC-DEL1                  11920099
119300         ELSE                                                     11930099
119400             IF  ADEL1F = DP015-ERASE-EOF                         11940099
119500                 MOVE SPACES           TO ASC-DEL1                11950099
119600             END-IF                                               11960099
119700         END-IF.                                                  11970099
119800                                                                  11980099
119900*STORE NUMBER #1A                                                 11990099
120000         IF  ASTNBR1AL > ZERO                                     12000099
120100             MOVE ASTNBR1AI             TO ASC-STNBR1A            12010099
120200         ELSE                                                     12020099
120300             IF  ASTNBR1AF = DP015-ERASE-EOF                      12030099
120400                 MOVE SPACES           TO ASC-STNBR1A             12040099
120500                 MOVE SPACES           TO ASC-STNME1A             12050099
120600             END-IF                                               12060099
120700         END-IF.                                                  12070099
120800                                                                  12080099
120900*DELETE ELECTION #2                                               12090099
121000         IF  ADEL2L > ZERO                                        12100099
121100             MOVE ADEL2I             TO ASC-DEL2                  12110099
121200         ELSE                                                     12120099
121300             IF  ADEL2F = DP015-ERASE-EOF                         12130099
121400                 MOVE SPACES         TO ASC-DEL2                  12140099
121500             END-IF                                               12150099
121600         END-IF.                                                  12160099
121700                                                                  12170099
121800*STORE NUMBER #2A                                                 12180099
121900         IF  ASTNBR2AL > ZERO                                     12190099
122000             MOVE ASTNBR2AI             TO ASC-STNBR2A            12200099
122100         ELSE                                                     12210099
122200             IF  ASTNBR2AF = DP015-ERASE-EOF                      12220099
122300                 MOVE SPACES           TO ASC-STNBR2A             12230099
122400                 MOVE SPACES           TO ASC-STNME2A             12240099
122500             END-IF                                               12250099
122600         END-IF.                                                  12260099
122700                                                                  12270099
122800*DELETE ELECTION #3                                               12280099
122900         IF  ADEL3L > ZERO                                        12290099
123000             MOVE ADEL3I             TO ASC-DEL3                  12300099
123100         ELSE                                                     12310099
123200             IF  ADEL3F = DP015-ERASE-EOF                         12320099
123300                 MOVE SPACES         TO ASC-DEL3                  12330099
123400             END-IF                                               12340099
123500         END-IF.                                                  12350099
123600                                                                  12360099
123700*STORE ASSIGNMENT #3A                                             12370099
123800         IF  ASTNBR3AL > ZERO                                     12380099
123900             MOVE ASTNBR3AI            TO ASC-STNBR3A             12390099
124000         ELSE                                                     12400099
124100             IF  ASTNBR3AF = DP015-ERASE-EOF                      12410099
124200                 MOVE SPACES           TO ASC-STNBR3A             12420099
124300                 MOVE SPACES           TO ASC-STNME3A             12430099
124400             END-IF                                               12440099
124500         END-IF.                                                  12450099
124600                                                                  12460099
124700*----------------------------------------------------------------*12470099
124800* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12480099
124900* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *12490099
125000* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12500099
125100*----------------------------------------------------------------*12510099
125200 3000-EDIT-DATA-IN-COMMAREA.                                      12520099
125300                                                                  12530099
125400     IF  ASC-DOOR-TYPE-CODE NOT = PC-SH AND PC-DS AND PC-ST       12540099
125500         SET PS-ERROR                                             12550099
125600             DP020-MSG-FATAL         TO TRUE                      12560099
125700         MOVE PC-TSYMSG-02575        TO DP020-MSG-NUMBER          12570099
125800         MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA                  12580099
125900         MOVE DP015-RED              TO ADRTYPCC                  12590099
126000         MOVE DP015-REVERSE          TO ADRTYPCH                  12600099
126100         MOVE -1                     TO ADRTYPCL                  12610099
126200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12620099
126300     END-IF.                                                      12630099
126400                                                                  12640099
126500     IF  ASC-DEL1      NOT = PC-Y AND PC-SPACE                    12650099
126600         SET PS-ERROR                                             12660099
126700             DP020-MSG-FATAL         TO TRUE                      12670099
126800         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER          12680099
126900         MOVE DP015-UNP-ALP-BRT-OFF  TO ADEL1A                    12690099
127000         MOVE DP015-RED              TO ADEL1C                    12700099
127100         MOVE DP015-REVERSE          TO ADEL1H                    12710099
127200         MOVE -1                     TO ADEL1L                    12720099
127300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12730099
127400     END-IF.                                                      12740099
127500                                                                  12750099
127600     IF  ASC-DEL2      NOT = PC-Y AND PC-SPACE                    12760099
127700         SET PS-ERROR                                             12770099
127800             DP020-MSG-FATAL         TO TRUE                      12780099
127900         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER          12790099
128000         MOVE DP015-UNP-ALP-BRT-OFF  TO ADEL2A                    12800099
128100         MOVE DP015-RED              TO ADEL2C                    12810099
128200         MOVE DP015-REVERSE          TO ADEL2H                    12820099
128300         MOVE -1                     TO ADEL2L                    12830099
128400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12840099
128500     END-IF.                                                      12850099
128600                                                                  12860099
128700     IF  ASC-DEL3      NOT = PC-Y AND PC-SPACE                    12870099
128800         SET PS-ERROR                                             12880099
128900             DP020-MSG-FATAL         TO TRUE                      12890099
129000         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER          12900099
129100         MOVE DP015-UNP-ALP-BRT-OFF  TO ADEL3A                    12910099
129200         MOVE DP015-RED              TO ADEL3C                    12920099
129300         MOVE DP015-REVERSE          TO ADEL3H                    12930099
129400         MOVE -1                     TO ADEL3L                    12940099
129500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12950099
129600     END-IF.                                                      12960099
129700                                                                  12970099
129800*------------------------------------------------------------     12980099
129900*  CHECK TO SEE IF ALL CARTONS FOR STORE ASSIGNMENT BEING         12990099
130000*  CHANGED HAVE BEEN MANIFESTED TO A TRAILER                      13000099
130100*  ADDED DMH - 4/7/08                                             13010099
130200*------------------------------------------------------------     13020099
130300     EVALUATE TRUE                                                13030099
130400         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   13040099
130500           IF PS-NO-ERROR  AND                                    13050099
130600              ASC-DOOR-TYPE-CODE  =  'SH'                         13060099
130700              SET  PS-ALL-CARTONS-MFST-1                          13070099
130800                   PS-ALL-CARTONS-MFST-2                          13080099
130900                   PS-ALL-CARTONS-MFST-3 TO TRUE                  13090099
131000                IF (ASC-DEL1 = PC-Y) OR                           13100099
131100                   (ASC-STNBR1-N > 0 AND ASC-STNBR1A > 0)         13110099
131200                   PERFORM 4500-CHECK-CRTN-MFST-1                 13120099
131300                   IF  PS-NOT-ALL-CARTONS-MFST-1                  13130099
131400                     MOVE ASC-STNBR1-N    TO DP020-MSG-TEXT       13140099
131500                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     13150099
131600                     SET DP020-MSG-FATAL                          13160099
131700                         ASC-2ND-CONFIRM-UNKNOWN                  13170099
131800                         ASC-2ND-CONFIRM-MULT-NO                  13180099
131900                         PS-ERROR          TO TRUE                13190099
132000                   END-IF                                         13200099
132100              END-IF                                              13210099
132200                                                                  13220099
132300              IF (ASC-DEL2 = PC-Y) OR                             13230099
132400                 (ASC-STNBR2-N > 0 AND ASC-STNBR2A > 0)           13240099
132500                   PERFORM 4600-CHECK-CRTN-MFST-2                 13250099
132600                   IF  PS-NOT-ALL-CARTONS-MFST-2                  13260099
132700                     MOVE ASC-STNBR2-N    TO DP020-MSG-TEXT       13270099
132800                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     13280099
132900                     SET DP020-MSG-FATAL                          13290099
133000                         ASC-2ND-CONFIRM-UNKNOWN                  13300099
133100                         ASC-2ND-CONFIRM-MULT-NO                  13310099
133200                         PS-ERROR          TO TRUE                13320099
133300                   END-IF                                         13330099
133400              END-IF                                              13340099
133500                                                                  13350099
133600              IF (ASC-DEL3 = PC-Y) OR                             13360099
133700                 (ASC-STNBR3-N > 0 AND ASC-STNBR3A > 0)           13370099
133800                   PERFORM 4700-CHECK-CRTN-MFST-3                 13380099
133900                   IF  PS-NOT-ALL-CARTONS-MFST-3                  13390099
134000                     MOVE ASC-STNBR3-N    TO DP020-MSG-TEXT       13400099
134100                     MOVE PC-TSYMSG-03618 TO DP020-MSG-NUMBER     13410099
134200                     SET DP020-MSG-FATAL                          13420099
134300                         ASC-2ND-CONFIRM-UNKNOWN                  13430099
134400                         ASC-2ND-CONFIRM-MULT-NO                  13440099
134500                         PS-ERROR          TO TRUE                13450099
134600                   END-IF                                         13460099
134700              END-IF                                              13470099
134800           END-IF                                                 13480099
134900     END-EVALUATE.                                                13490099
135000                                                                  13500099
135100                                                                  13510099
135200     IF PS-NO-ERROR                                               13520099
135300         MOVE ASC-STNBR1-N     TO DK-STR-NBR1                     13530099
135400         MOVE ASC-STNBR2-N     TO DK-STR-NBR2                     13540099
135500         MOVE ASC-STNBR3-N     TO DK-STR-NBR3                     13550099
135600         PERFORM 7000-COUNT-OPEN-TRLRS                            13560099
135700         IF PV-TRLR-COUNT > ZERO                                  13570099
135800             SET PS-ERROR                                         13580099
135900                 DP020-MSG-FATAL                                  13590099
136000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  13600099
136100             MOVE PC-TSYMSG-02963    TO DP020-MSG-NUMBER          13610099
136200             MOVE -1                TO ADEL1L                     13620099
136300         END-IF                                                   13630099
136400     END-IF                                                       13640099
136500                                                                  13650099
136600     IF PS-NO-ERROR                                               13660099
136700         PERFORM 3001-VALIDATE-ASSIGNMENTS                        13670099
136800     END-IF.                                                      13680099
136900                                                                  13690099
137000 3001-VALIDATE-ASSIGNMENTS.                                       13700099
137100     IF  ASC-STNBR1A > SPACES                                     13710099
137200         PERFORM 3010-NUMERIC-STNBR-CHECK                         13720099
137300         IF  PS-NO-ERROR                                          13730099
137400             MOVE ASC-STNBR1A-N TO DK-STR-NBR                     13740099
137500             PERFORM 3110-VALIDATE-STORE-ASGNMNT                  13750099
137510*                                                                 13751099
137520*** 11/13/13 DMH START                                            13752099
137530*                                                                 13753099
137531             IF XL071-LOC-TYP-CDE = PC-DC  AND                    13753199
137532                XL071-E-BUS-IND   = 'Y'                           13753299
137533                PERFORM 3015-CHECK-IF-WMOS-EFC                    13753399
137534                MOVE  PS-WMOS-EFC-SW   TO  ASC-STNBR1-WMOS-SW     13753499
137538             END-IF                                               13753899
137540*                                                                 13754099
137550*** 11/13/13 DMH END                                              13755099
137560*                                                                 13756099
137600             IF  PS-NO-ERROR                                      13760099
137700                 PERFORM 3120-VALIDATE-DOOR-TYPE-CODE             13770099
137800             END-IF                                               13780099
137900         END-IF                                                   13790099
138000     END-IF.                                                      13800099
138100                                                                  13810099
138200     IF  ASC-STNBR2A > SPACES                                     13820099
138300         PERFORM 3010-NUMERIC-STNBR-CHECK                         13830099
138400         IF  PS-NO-ERROR                                          13840099
138500             MOVE ASC-STNBR2A-N TO DK-STR-NBR                     13850099
138600             PERFORM 3110-VALIDATE-STORE-ASGNMNT                  13860099
138610*                                                                 13861099
138620*** 11/13/13 DMH START                                            13862099
138630*                                                                 13863099
138640             IF XL071-LOC-TYP-CDE = PC-DC  AND                    13864099
138650                XL071-E-BUS-IND   = 'Y'                           13865099
138660                PERFORM 3015-CHECK-IF-WMOS-EFC                    13866099
138670                MOVE  PS-WMOS-EFC-SW   TO  ASC-STNBR2-WMOS-SW     13867099
138680             END-IF                                               13868099
138690*                                                                 13869099
138691*** 11/13/13 DMH END                                              13869199
138692*                                                                 13869299
138700             IF  PS-NO-ERROR                                      13870099
138800                 PERFORM 3130-VALIDATE-DOOR-TYPE-CODE             13880099
138900             END-IF                                               13890099
139000         END-IF                                                   13900099
139100     END-IF.                                                      13910099
139200                                                                  13920099
139300     IF  ASC-STNBR3A > SPACES                                     13930099
139400         PERFORM 3010-NUMERIC-STNBR-CHECK                         13940099
139500         IF  PS-NO-ERROR                                          13950099
139600             MOVE ASC-STNBR3A-N TO DK-STR-NBR                     13960099
139700             PERFORM 3110-VALIDATE-STORE-ASGNMNT                  13970099
139710*                                                                 13971099
139720*** 11/13/13 DMH START                                            13972099
139730*                                                                 13973099
139740             IF XL071-LOC-TYP-CDE = PC-DC  AND                    13974099
139750                XL071-E-BUS-IND   = 'Y'                           13975099
139760                PERFORM 3015-CHECK-IF-WMOS-EFC                    13976099
139770                MOVE  PS-WMOS-EFC-SW   TO  ASC-STNBR3-WMOS-SW     13977099
139780             END-IF                                               13978099
139790*                                                                 13979099
139791*** 11/13/13 DMH END                                              13979199
139792*                                                                 13979299
139800             IF  PS-NO-ERROR                                      13980099
139900                 PERFORM 3140-VALIDATE-DOOR-TYPE-CODE             13990099
140000             END-IF                                               14000099
140100         END-IF                                                   14010099
140200     END-IF.                                                      14020099
140300                                                                  14030099
140400     IF PS-NO-ERROR                                               14040099
140500        IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                 14050099
140600            IF  (ASC-DEL1 NOT = PC-Y AND                          14060099
140700                ASC-STNBR1 > SPACES) OR                           14070099
140800                ASC-STNBR1A > SPACES                              14080099
140900                    ADD +1 TO PV-NBR-OF-ASGNMT                    14090099
141000            END-IF                                                14100099
141100            IF  (ASC-DEL2 NOT = PC-Y AND                          14110099
141200                ASC-STNBR2 > SPACES) OR                           14120099
141300                ASC-STNBR2A > SPACES                              14130099
141400                    ADD +1 TO PV-NBR-OF-ASGNMT                    14140099
141500            END-IF                                                14150099
141600            IF  (ASC-DEL3 NOT = PC-Y AND                          14160099
141700                ASC-STNBR3 > SPACES) OR                           14170099
141800                ASC-STNBR3A > SPACES                              14180099
141900                    ADD +1 TO PV-NBR-OF-ASGNMT                    14190099
142000            END-IF                                                14200099
142100            IF  PV-NBR-OF-ASGNMT > 1                              14210099
142200                PERFORM 4392-CHECK-TKRPRPM                        14220099
142300                IF PS-MULTIPLE-STORES-ALLOWED                     14230099
142400                    SET ASC-2ND-CONFIRM-NEED    TO TRUE           14240099
142500                ELSE                                              14250099
142600                     SET ASC-2ND-CONFIRM-NEED-NO TO TRUE          14260099
142700                END-IF                                            14270099
142800            ELSE                                                  14280099
142900                SET ASC-2ND-CONFIRM-NEED-NO TO TRUE               14290099
143000            END-IF                                                14300099
143100        END-IF                                                    14310099
143200     END-IF.                                                      14320099
143300*----------------------------------------------------------------*14330099
143400* MAKE SURE STORE NUMBER IS NUMERIC                               14340099
143500*----------------------------------------------------------------*14350099
143600 3010-NUMERIC-STNBR-CHECK.                                        14360099
143700     IF  ASC-STNBR1A  >  SPACES                                   14370099
143800         MOVE ASC-STNBR1A-N    TO DP010I-UNEDITED-FIELD           14380099
143900         MOVE LENGTH OF ASC-STNBR1A-N  TO DP010I-MAXIMUM-DIGITS   14390099
144000         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 14400099
144100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14410099
144200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14420099
144210              USING DP010I-NUMERIC-EDIT-AREA                      14421099
144300         IF  DP010I-ERROR-DETECTED                                14430099
144400             SET PS-ERROR                                         14440099
144500                 DP020-MSG-FATAL         TO TRUE                  14450099
144600            MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER       14460099
144700            MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA              14470099
144800            MOVE DP015-RED              TO ASTNBR1AC              14480099
144900            MOVE DP015-REVERSE          TO ASTNBR1AH              14490099
145000            MOVE -1                     TO ASTNBR1AL              14500099
145100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   14510099
145200         ELSE                                                     14520099
145300             MOVE DP010I-NUMERIC-FIELD TO ASC-STNBR1A-N           14530099
145400         END-IF                                                   14540099
145500     END-IF.                                                      14550099
145600                                                                  14560099
145700     IF  ASC-STNBR2A  >  SPACES                                   14570099
145800         MOVE ASC-STNBR2A-N    TO DP010I-UNEDITED-FIELD           14580099
145900         MOVE LENGTH OF ASC-STNBR2A-N  TO DP010I-MAXIMUM-DIGITS   14590099
146000         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 14600099
146100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14610099
146200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14620099
146210              USING DP010I-NUMERIC-EDIT-AREA                      14621099
146300         IF  DP010I-ERROR-DETECTED                                14630099
146400             SET PS-ERROR                                         14640099
146500                 DP020-MSG-FATAL         TO TRUE                  14650099
146600            MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER       14660099
146700            MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA              14670099
146800            MOVE DP015-RED              TO ASTNBR2AC              14680099
146900            MOVE DP015-REVERSE          TO ASTNBR2AH              14690099
147000            MOVE -1                     TO ASTNBR2AL              14700099
147100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   14710099
147200         ELSE                                                     14720099
147300             MOVE DP010I-NUMERIC-FIELD TO ASC-STNBR2A-N           14730099
147400         END-IF                                                   14740099
147500     END-IF.                                                      14750099
147600                                                                  14760099
147700     IF  ASC-STNBR3A  >  SPACES                                   14770099
147800         MOVE ASC-STNBR3A-N    TO DP010I-UNEDITED-FIELD           14780099
147900         MOVE LENGTH OF ASC-STNBR3A-N  TO DP010I-MAXIMUM-DIGITS   14790099
148000         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 14800099
148100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14810099
148200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14820099
148210              USING DP010I-NUMERIC-EDIT-AREA                      14821099
148300         IF  DP010I-ERROR-DETECTED                                14830099
148400             SET PS-ERROR                                         14840099
148500                 DP020-MSG-FATAL         TO TRUE                  14850099
148600            MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER       14860099
148700            MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA              14870099
148800            MOVE DP015-RED              TO ASTNBR3AC              14880099
148900            MOVE DP015-REVERSE          TO ASTNBR3AH              14890099
149000            MOVE -1                     TO ASTNBR3AL              14900099
149100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   14910099
149200         ELSE                                                     14920099
149300             MOVE DP010I-NUMERIC-FIELD TO ASC-STNBR3A-N           14930099
149400         END-IF                                                   14940099
149500     END-IF.                                                      14950099
149600                                                                  14960099
149601                                                                  14960199
149602****************************************************************  14960299
149603*  THIS PARAGRAPH WILL CHECK TO SEE IF THE EFC IS INTERFACING  *  14960399
149604*  WITH WMOS.  IF IT IS, THEN THE DC WILL HAVE TO USE A SH     *  14960499
149605*  (SHIPPING) DOOR ASSIGNED TO THE ESTORE NUMBER INSTEAD OF A  *  14960599
149606*  DS (DC SHUTTLE) DOOR ASSIGNED TO THE EFC #.                 *  14960699
149607*  THE INTERFACE TO WMOS ONLY TAKES SH (SHIPPING TRAILERS)     *  14960799
149608****************************************************************  14960899
149610 3015-CHECK-IF-WMOS-EFC.                                          14961099
149611                                                                  14961199
149612     MOVE  DK-STR-NBR           TO  KRPRPM-LOC-ID                 14961299
149613                                                                  14961399
149614     EXEC SQL                                                     14961499
149615         SELECT  FUNC_TXT                                         14961599
149616           INTO :PS-WMOS-EFC-SW                                   14961699
149617           FROM  TKRPRPM                                          14961799
149618          WHERE LOC_ID            = :KRPRPM-LOC-ID                14961899
149619            AND INTFC_SYS_CDE     = 'KHL'                         14961999
149620            AND SYS_PRC_FUNC_CDE  = 'WMOSDC'                      14962099
149621            AND FUNC_PRC_STAT_CDE = :PC-AC                        14962199
149622            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            14962299
149623            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            14962399
149624     END-EXEC                                                     14962499
149625                                                                  14962599
149626     EVALUATE TRUE                                                14962699
149627         WHEN SQLCODE = ZERO                                      14962799
149628              CONTINUE                                            14962899
149629         WHEN SQLCODE = +100                                      14962999
149630              SET  PS-WMOS-EFC-NO   TO  TRUE                      14963099
149631         WHEN SQLWARN0 NOT = SPACES                               14963199
149632         WHEN SQLCODE < +0                                        14963299
149633         WHEN SQLCODE > +0                                        14963399
149634             MOVE '3015-CHECK-IF-WMOS-EFC' TO DP013-PARAGRAPH     14963499
149635             MOVE 'CHECK IF EFC INTERFACES WITH WMOS     '        14963599
149636                                      TO DP013-MESSAGE-TEXT (1)   14963699
149637             MOVE SQLCA        TO DP013-SQLCA                     14963799
149638             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        14963899
149639             SET DP013-DB2-ABEND                                  14963999
149640                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14964099
149641             PERFORM DP013-0000-PROCESS-ABEND                     14964199
149642         END-EVALUATE.                                            14964299
149643                                                                  14964399
149646                                                                  14964699
149650                                                                  14965099
149700****************************************************************  14970099
149800*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  14980099
149900*                                                              *  14990099
150000****************************************************************  15000099
150100                                                                  15010099
150200 3110-VALIDATE-STORE-ASGNMNT.                                     15020099
150300                                                                  15030099
150400     INITIALIZE XL071-COMMAREA.                                   15040099
150500     MOVE DK-STR-NBR TO XL071-LOCATION-NUMBER.                    15050099
150600                                                                  15060099
150700     CALL XL071-LOCATION-MODULE USING                             15070099
150800                                DFHEIBLK                          15080099
150900                                XL071-COMMAREA                    15090099
151000                                XL071-COMMAREA-REC.               15100099
151100                                                                  15110099
151200     EVALUATE TRUE                                                15120099
151300         WHEN XL071-NO-ERRORS                                     15130099
151400         WHEN XL071-DC-ASGMT-NOT-FND                              15140099
151500              CONTINUE                                            15150099
151600                                                                  15160099
151700         WHEN XL071-LOC-NOT-FOUND                                 15170099
151800              SET PS-ERROR                                        15180099
151900                  DP020-MSG-FATAL         TO TRUE                 15190099
152000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15200099
152100              MOVE PC-TSYMSG-00017        TO DP020-MSG-NUMBER     15210099
152200              IF ASC-STNBR1A-N = DK-STR-NBR                       15220099
152300                  MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA        15230099
152400                  MOVE DP015-RED              TO ASTNBR1AC        15240099
152500                  MOVE DP015-REVERSE          TO ASTNBR1AH        15250099
152600                  MOVE -1                     TO ASTNBR1AL        15260099
152700              ELSE                                                15270099
152800                  IF ASC-STNBR2A-N = DK-STR-NBR                   15280099
152900                      MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA    15290099
153000                      MOVE DP015-RED              TO ASTNBR2AC    15300099
153100                      MOVE DP015-REVERSE          TO ASTNBR2AH    15310099
153200                      MOVE -1                     TO ASTNBR2AL    15320099
153300                  ELSE                                            15330099
153400                      IF ASC-STNBR3A-N = DK-STR-NBR               15340099
153500                          MOVE DP015-UNP-ALP-BRT-OFF TO ASTNBR3AA 15350099
153600                          MOVE DP015-RED             TO ASTNBR3AC 15360099
153700                          MOVE DP015-REVERSE         TO ASTNBR3AH 15370099
153800                          MOVE -1                    TO ASTNBR3AL 15380099
153900                      END-IF                                      15390099
154000                  END-IF                                          15400099
154100              END-IF                                              15410099
154200                                                                  15420099
154300         WHEN OTHER                                               15430099
154400              MOVE '3110-VALIDATE-STORE-ASGNMNT'                  15440099
154500                                  TO DP013-PARAGRAPH              15450099
154600              MOVE 'TROUBLE VALIDATING STORE ASSIGNMENT'          15460099
154700                                  TO DP013-MESSAGE-TEXT (1)       15470099
154800              STRING 'LOCATION - '                                15480099
154900                      XL071-LOCATION-NUMBER                       15490099
155000                      DELIMITED BY SIZE                           15500099
155100                      INTO DP013-MESSAGE-TEXT (2)                 15510099
155200              STRING 'BAD SQLCODE - '                             15520099
155300                      XL071-SQLCODE                               15530099
155400                     ' - '                                        15540099
155500                      XL071-DB2-TABLE                             15550099
155600                      DELIMITED BY SIZE                           15560099
155700                      INTO DP013-MESSAGE-TEXT (3)                 15570099
155800              MOVE XL071-SQLCODE TO SQLCODE                       15580099
155900              MOVE XL071-SQLCA   TO DP013-SQLCA                   15590099
156000              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    15600099
156100              SET DP013-DB2-ABEND                                 15610099
156200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              15620099
156300              PERFORM DP013-0000-PROCESS-ABEND                    15630099
156400                                                                  15640099
156500     END-EVALUATE.                                                15650099
156600                                                                  15660099
156700                                                                  15670099
156800*----------------------------------------------------------------*15680099
156900* VALID DOOR/STORE TYPE COMBINATIONS ARE SH/DS AND DS/DC.         15690099
157000* THIS IS FOR NEW STORE NUMBER 1                                  15700099
157100*----------------------------------------------------------------*15710099
157200 3120-VALIDATE-DOOR-TYPE-CODE.                                    15720099
157300                                                                  15730099
157301*                                                                 15730199
157310**  SH = SHIPPING DOOR    DS = STORE                              15731099
157320*                                                                 15732099
157400      IF ASC-DOOR-TYPE-CODE = PC-SH                               15740099
157500          IF XL071-LOC-TYP-CDE = PC-DS                            15750099
157600              MOVE XL071-LOC-NM TO ASC-STNME1A                    15760099
157700              PERFORM 3125-CHECK-DC-STR-ASGNMT                    15770099
157800          ELSE                                                    15780099
157810*                                                                 15781099
157820* DMH 07/19/2018 BEGIN                                            15782099
157821               PERFORM 3160-CHECK-AMAZON-RETURN                   15782199
157822               IF  PS-AMAZON-RETURN-CENTER-YES  AND               15782299
157823                   PS-DC-ASGN-AMAZON-SHIP-YES                     15782399
157824                   MOVE XLT00010-LOC-NM TO ASC-STNME1A            15782499
157826               ELSE                                               15782699
157827               IF  PS-AMAZON-RETURN-CENTER-YES  AND               15782799
157828                   PS-DC-ASGN-AMAZON-SHIP-NO                      15782899
157840*                                                                 15784099
157900                   MOVE XLT00010-LOC-NM TO ASC-STNME1A            15790099
158000                   SET PS-ERROR                                   15800099
158100                       DP020-MSG-FATAL    TO TRUE                 15810099
158200                   MOVE PC-TSYMSG-03807   TO DP020-MSG-NUMBER     15820099
158300                   MOVE DP015-UNP-ALP-BRT-OFF                     15830099
158310                                          TO ASTNBR1AA            15831099
158400                   MOVE DP015-RED         TO ASTNBR1AC            15840099
158500                   MOVE DP015-REVERSE     TO ASTNBR1AH            15850099
158600                   MOVE -1                TO ASTNBR1AL            15860099
158700                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             15870099
158701* DMH 07/19/2018 END                                              15870199
158710               ELSE                                               15871099
158720                   MOVE XL071-LOC-NM TO ASC-STNME1A               15872099
158730                   SET PS-ERROR                                   15873099
158740                       DP020-MSG-FATAL   TO TRUE                  15874099
158750                   MOVE PC-TSYMSG-02583   TO DP020-MSG-NUMBER     15875099
158760                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA       15876099
158770                   MOVE DP015-RED          TO ASTNBR1AC           15877099
158780                   MOVE DP015-REVERSE      TO ASTNBR1AH           15878099
158790                   MOVE -1                 TO ASTNBR1AL           15879099
158791                   MOVE +1                 TO ADEL1L              15879199
158792                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            15879299
158793              END-IF                                              15879399
158794              END-IF                                              15879499
158800          END-IF                                                  15880099
158900      ELSE                                                        15890099
158910*                                                                 15891099
158920**  DS = DC SHUTTLE       DC = DISTRIBUTION CENTER                15892099
158930*                                                                 15893099
159000      IF ASC-DOOR-TYPE-CODE = PC-DS                               15900099
159100          IF XL071-LOC-TYP-CDE = PC-DC                            15910099
159200               MOVE XL071-LOC-NM TO ASC-STNME1A                   15920099
159201*                                                                 15920199
159202*** 11/13/13 DMH BEGIN                                            15920299
159203*                                                                 15920399
159210               IF  XL071-E-BUS-IND  = 'Y'  AND                    15921099
159211                   PS-WMOS-EFC-YES                                15921199
159212                   SET PS-ERROR                                   15921299
159213                       DP020-MSG-FATAL       TO TRUE              15921399
159214                   MOVE PC-TSYMSG-03738       TO DP020-MSG-NUMBER 15921499
159215                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA       15921599
159216                   MOVE DP015-RED              TO ASTNBR1AC       15921699
159217                   MOVE DP015-REVERSE          TO ASTNBR1AH       15921799
159218                   MOVE -1                     TO ASTNBR1AL       15921899
159219                   MOVE +1                     TO ADEL1L          15921999
159220                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            15922099
159221              END-IF                                              15922199
159222*                                                                 15922299
159230*** 11/13/13 DMH END                                              15923099
159240*                                                                 15924099
159300          ELSE                                                    15930099
159400               MOVE XL071-LOC-NM TO ASC-STNME1A                   15940099
159500               SET PS-ERROR                                       15950099
159600                   DP020-MSG-FATAL       TO TRUE                  15960099
159700               MOVE PC-TSYMSG-02584       TO DP020-MSG-NUMBER     15970099
159800               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA           15980099
159900               MOVE DP015-RED              TO ASTNBR1AC           15990099
160000               MOVE DP015-REVERSE          TO ASTNBR1AH           16000099
160100               MOVE -1                     TO ASTNBR1AL           16010099
160200               MOVE +1                     TO ADEL1L              16020099
160300               SET DP030-SET-CURSOR-APPL-1 TO TRUE                16030099
160400          END-IF                                                  16040099
160500      ELSE                                                        16050099
160510*                                                                 16051099
160520**  ST = STORAGE          DC = DISTRIBUTION CENTER                16052099
160530*                                                                 16053099
160600      IF ASC-DOOR-TYPE-CODE = PC-ST                               16060099
160700          IF XL071-LOC-TYP-CDE = PC-DC AND                        16070099
160800             ASC-CURR-OPER-UNT-ID  =  DK-STR-NBR                  16080099
160900               MOVE XL071-LOC-NM TO ASC-STNME1A                   16090099
161000          ELSE                                                    16100099
161100               MOVE XL071-LOC-NM TO ASC-STNME1A                   16110099
161200               SET PS-ERROR                                       16120099
161300                   DP020-MSG-FATAL       TO TRUE                  16130099
161400               MOVE PC-TSYMSG-02961       TO DP020-MSG-NUMBER     16140099
161500               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA           16150099
161600               MOVE DP015-RED              TO ASTNBR1AC           16160099
161700               MOVE DP015-REVERSE          TO ASTNBR1AH           16170099
161800               MOVE -1                     TO ASTNBR1AL           16180099
161900               MOVE +1                     TO ADEL1L              16190099
162000               SET DP030-SET-CURSOR-APPL-1 TO TRUE                16200099
162100          END-IF                                                  16210099
162200      END-IF                                                      16220099
162300      END-IF.                                                     16230099
162400                                                                  16240099
162500                                                                  16250099
162600                                                                  16260099
162700****************************************************************  16270099
162800*                                                              *  16280099
162900*                                                              *  16290099
163000****************************************************************  16300099
163100                                                                  16310099
163200 3125-CHECK-DC-STR-ASGNMT.                                        16320099
163300                                                                  16330099
163400     INITIALIZE XL071-COMMAREA.                                   16340099
163500     MOVE DK-STR-NBR TO XL071-LOCATION-NUMBER.                    16350099
163600     MOVE ASC-OPER-UNT-ID-N TO DK-OPER-UNT-ID.                    16360099
163700                                                                  16370099
163800     CALL XL071-LOCATION-MODULE USING                             16380099
163900                                DFHEIBLK                          16390099
164000                                XL071-COMMAREA                    16400099
164100                                XL071-COMMAREA-REC.               16410099
164200                                                                  16420099
164300     EVALUATE TRUE                                                16430099
164400         WHEN XL071-NO-ERRORS                                     16440099
164500              IF DK-OPER-UNT-ID = XL071-ASGMT-DC-NBR              16450099
164600                 CONTINUE                                         16460099
164700              ELSE                                                16470099
164800                  PERFORM 3500-CHECK-IF-DC-FUTURE                 16480099
164900                  IF  DK-OPER-UNT-ID = XLT00014-DC-NBR            16490099
165000                      MOVE XLT00014-DC-NBR                        16500099
165100                           TO XL071-ASGMT-DC-NBR                  16510099
165200                      MOVE XLT00014-EFF-BEG-DTE                   16520099
165300                           TO XL071-ASGMT-EFF-BEG-DTE             16530099
165400                      MOVE XLT00014-PO-STRT-DTE                   16540099
165500                           TO XL071-ASGMT-PO-STRT-DTE             16550099
165510                  ELSE                                            16551099
165511*                                                                 16551199
165512***  ADDED - DMH - 7/19/2010 BEGIN                                16551299
165513*                                                                 16551399
165520                  PERFORM 3550-CHECK-IF-DC-PREVIOUS               16552099
165521                      IF  DK-OPER-UNT-ID = XLT00014-DC-NBR        16552199
165522                          MOVE XLT00014-DC-NBR                    16552299
165523                            TO XL071-ASGMT-DC-NBR                 16552399
165524                          MOVE XLT00014-EFF-BEG-DTE               16552499
165525                            TO XL071-ASGMT-EFF-BEG-DTE            16552599
165526                          MOVE XLT00014-PO-STRT-DTE               16552699
165527                             TO XL071-ASGMT-PO-STRT-DTE           16552799
165528*                                                                 16552899
165529***  ADDED - DMH - 7/19/2010 END                                  16552999
165530*                                                                 16553099
165531                      ELSE                                        16553199
165532                          IF  XL071-LOC-TYP-CDE  =  'DS'  AND     16553299
165533                              XL071-E-BUS-IND    =  'Y'           16553399
165534                              PERFORM  3530-CHECK-ECOMM-ASSGN     16553499
165535                              IF  PV-ECOMM-OTBND-ASSGN-YES        16553599
165536                                  CONTINUE                        16553699
165537                              ELSE                                16553799
165538                                  PERFORM 3126-FORMAT-ERROR       16553899
165539                              END-IF                              16553999
165540                          ELSE                                    16554099
165541                              PERFORM 3126-FORMAT-ERROR           16554199
165542                          END-IF                                  16554299
165550                      END-IF                                      16555099
166800                  END-IF                                          16680099
166900              END-IF                                              16690099
167000                                                                  16700099
167100         WHEN XL071-DC-ASGMT-NOT-FND                              16710099
167200*** DMH ADDED - 1/10/08 - BEGIN                                   16720099
167300              PERFORM 3500-CHECK-IF-DC-FUTURE                     16730099
167400              IF  DK-OPER-UNT-ID = XLT00014-DC-NBR                16740099
167500                  MOVE XLT00014-DC-NBR                            16750099
167600                       TO XL071-ASGMT-DC-NBR                      16760099
167700                  MOVE XLT00014-EFF-BEG-DTE                       16770099
167800                       TO XL071-ASGMT-EFF-BEG-DTE                 16780099
167900                  MOVE XLT00014-PO-STRT-DTE                       16790099
168000                       TO XL071-ASGMT-PO-STRT-DTE                 16800099
168010              ELSE                                                16801099
168011*                                                                 16801199
168012***  ADDED - DMH - 7/19/2010 BEGIN                                16801299
168013*                                                                 16801399
168014                  PERFORM 3550-CHECK-IF-DC-PREVIOUS               16801499
168015                  IF  DK-OPER-UNT-ID = XLT00014-DC-NBR            16801599
168016                      MOVE XLT00014-DC-NBR                        16801699
168017                        TO XL071-ASGMT-DC-NBR                     16801799
168018                      MOVE XLT00014-EFF-BEG-DTE                   16801899
168019                        TO XL071-ASGMT-EFF-BEG-DTE                16801999
168020                      MOVE XLT00014-PO-STRT-DTE                   16802099
168021                        TO XL071-ASGMT-PO-STRT-DTE                16802199
168022*                                                                 16802299
168023***  ADDED - DMH - 7/19/2010 END                                  16802399
168024*                                                                 16802499
168100                  ELSE                                            16810099
168200                      IF  XL071-LOC-TYP-CDE  =  'DS'  AND         16820099
168300                          XL071-E-BUS-IND    =  'Y'               16830099
168400                          PERFORM  3530-CHECK-ECOMM-ASSGN         16840099
168500                          IF  PV-ECOMM-OTBND-ASSGN-YES            16850099
168600                              CONTINUE                            16860099
168700                          ELSE                                    16870099
168800                              PERFORM 3126-FORMAT-ERROR           16880099
168900                          END-IF                                  16890099
169000                      ELSE                                        16900099
169100                          PERFORM 3126-FORMAT-ERROR               16910099
169200                      END-IF                                      16920099
169210                  END-IF                                          16921099
169300              END-IF                                              16930099
169400*** DMH ADDED - 1/10/08 - END                                     16940099
169500*** REMOVED   PERFORM 3126-FORMAT-ERROR                           16950099
169600                                                                  16960099
169700         WHEN OTHER                                               16970099
169800              MOVE '3135-CHECK-DC-STR-ASGMT'                      16980099
169900                                  TO DP013-PARAGRAPH              16990099
170000              STRING 'SELECT STORE NUMBER - '                     17000099
170100                      XL071-LOCATION-NUMBER                       17010099
170200                     ' - BAD RETURN CODE FROM XLKUT071 - '        17020099
170300                      XL071-RETURN-CODE                           17030099
170400                      DELIMITED BY SIZE                           17040099
170500                      INTO DP013-MESSAGE-TEXT (1)                 17050099
170600              STRING 'SQLCODE - '                                 17060099
170700                      XL071-SQLCODE                               17070099
170800                     ' - '                                        17080099
170900                      XL071-DB2-TABLE                             17090099
171000                      DELIMITED BY SIZE                           17100099
171100                      INTO DP013-MESSAGE-TEXT (2)                 17110099
171200              MOVE XL071-SQLCA     TO DP013-SQLCA                 17120099
171300              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    17130099
171400              MOVE XL071-SQLCODE TO SQLCODE                       17140099
171500              SET DP013-DB2-ABEND                                 17150099
171600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              17160099
171700              PERFORM DP013-0000-PROCESS-ABEND                    17170099
171800                                                                  17180099
171900     END-EVALUATE.                                                17190099
172000                                                                  17200099
172100                                                                  17210099
172200 3126-FORMAT-ERROR.                                               17220099
172300                                                                  17230099
172400     SET PS-ERROR                                                 17240099
172500         DP020-MSG-FATAL         TO TRUE.                         17250099
172600     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         17260099
172700     MOVE PC-TSYMSG-02772        TO DP020-MSG-NUMBER.             17270099
172800     IF ASC-STNBR1A-N = DK-STR-NBR                                17280099
172900         MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA                 17290099
173000         MOVE DP015-RED              TO ASTNBR1AC                 17300099
173100         MOVE DP015-REVERSE          TO ASTNBR1AH                 17310099
173200         MOVE -1                     TO ASTNBR1AL                 17320099
173300     ELSE                                                         17330099
173400         IF ASC-STNBR2A-N = DK-STR-NBR                            17340099
173500             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA             17350099
173600             MOVE DP015-RED              TO ASTNBR2AC             17360099
173700             MOVE DP015-REVERSE          TO ASTNBR2AH             17370099
173800             MOVE -1                     TO ASTNBR2AL             17380099
173900         ELSE                                                     17390099
174000             IF ASC-STNBR3A-N = DK-STR-NBR                        17400099
174100                MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA          17410099
174200                MOVE DP015-RED              TO ASTNBR3AC          17420099
174300                MOVE DP015-REVERSE          TO ASTNBR3AH          17430099
174400                MOVE -1                     TO ASTNBR3AL          17440099
174500             END-IF                                               17450099
174600         END-IF                                                   17460099
174700     END-IF.                                                      17470099
174800                                                                  17480099
174900                                                                  17490099
175000*----------------------------------------------------------------*17500099
175100* VALID DOOR/STORE TYPE COMBINATIONS ARE SH/DS AND DS/DC.         17510099
175200* THIS IS FOR NEW STORE NUMBER 2                                  17520099
175300*----------------------------------------------------------------*17530099
175400 3130-VALIDATE-DOOR-TYPE-CODE.                                    17540099
175500                                                                  17550099
175600      IF ASC-DOOR-TYPE-CODE = PC-SH                               17560099
175700          IF XL071-LOC-TYP-CDE = PC-DS                            17570099
175800              MOVE XL071-LOC-NM TO ASC-STNME2A                    17580099
175810*                                                                 17581099
175820* DMH 07/19/2018 BEGIN                                            17582099
175830               PERFORM 3160-CHECK-AMAZON-RETURN                   17583099
175840               IF  PS-AMAZON-RETURN-CENTER-YES  AND               17584099
175850                   PS-DC-ASGN-AMAZON-SHIP-YES                     17585099
175860                   MOVE XLT00010-LOC-NM TO ASC-STNME2A            17586099
175870               ELSE                                               17587099
175880               IF  PS-AMAZON-RETURN-CENTER-YES  AND               17588099
175890                   PS-DC-ASGN-AMAZON-SHIP-NO                      17589099
175891*                                                                 17589199
175892                   MOVE XLT00010-LOC-NM TO ASC-STNME2A            17589299
175893                   SET PS-ERROR                                   17589399
175894                       DP020-MSG-FATAL    TO TRUE                 17589499
175895                   MOVE PC-TSYMSG-03807   TO DP020-MSG-NUMBER     17589599
175896                   MOVE DP015-UNP-ALP-BRT-OFF                     17589699
175897                                          TO ASTNBR2AA            17589799
175898                   MOVE DP015-RED         TO ASTNBR2AC            17589899
175899                   MOVE DP015-REVERSE     TO ASTNBR2AH            17589999
175900                   MOVE -1                TO ASTNBR2AL            17590099
175901                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             17590199
175902* DMH 07/19/2018 END                                              17590299
175910              ELSE                                                17591099
176000                  MOVE XL071-LOC-NM TO ASC-STNME2A                17600099
176100                  SET PS-ERROR                                    17610099
176200                      DP020-MSG-FATAL     TO TRUE                 17620099
176300                  MOVE PC-TSYMSG-02583    TO DP020-MSG-NUMBER     17630099
176400                  MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA        17640099
176500                  MOVE DP015-RED          TO ASTNBR2AC            17650099
176600                  MOVE DP015-REVERSE      TO ASTNBR2AH            17660099
176700                  MOVE -1                 TO ASTNBR2AL            17670099
176800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17680099
176900              END-IF                                              17690099
176910              END-IF                                              17691099
176920          END-IF                                                  17692099
177000      ELSE                                                        17700099
177100      IF ASC-DOOR-TYPE-CODE = PC-DS                               17710099
177200          IF XL071-LOC-TYP-CDE = PC-DC                            17720099
177300               MOVE XL071-LOC-NM TO ASC-STNME2A                   17730099
177310*                                                                 17731099
177320*** 11/13/13 DMH BEGIN                                            17732099
177330*                                                                 17733099
177340               IF  XL071-E-BUS-IND  = 'Y'  AND                    17734099
177350                   PS-WMOS-EFC-YES                                17735099
177360                   SET PS-ERROR                                   17736099
177370                       DP020-MSG-FATAL       TO TRUE              17737099
177380                   MOVE PC-TSYMSG-03738       TO DP020-MSG-NUMBER 17738099
177390                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA       17739099
177391                   MOVE DP015-RED              TO ASTNBR2AC       17739199
177392                   MOVE DP015-REVERSE          TO ASTNBR2AH       17739299
177393                   MOVE -1                     TO ASTNBR2AL       17739399
177394                   MOVE +1                     TO ADEL2L          17739499
177395                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            17739599
177396              END-IF                                              17739699
177397*                                                                 17739799
177398*** 11/13/13 DMH END                                              17739899
177399*                                                                 17739999
177400          ELSE                                                    17740099
177500               MOVE XL071-LOC-NM TO ASC-STNME2A                   17750099
177600               SET PS-ERROR                                       17760099
177700                   DP020-MSG-FATAL       TO TRUE                  17770099
177800               MOVE PC-TSYMSG-02584       TO DP020-MSG-NUMBER     17780099
177900               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA           17790099
178000               MOVE DP015-RED              TO ASTNBR2AC           17800099
178100               MOVE DP015-REVERSE          TO ASTNBR2AH           17810099
178200               MOVE -1                     TO ASTNBR2AL           17820099
178300               MOVE +1                     TO ADEL1L              17830099
178400               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17840099
178500          END-IF                                                  17850099
178600      ELSE                                                        17860099
178700      IF ASC-DOOR-TYPE-CODE = PC-ST                               17870099
178800          IF XL071-LOC-TYP-CDE = PC-DC AND                        17880099
178900             ASC-CURR-OPER-UNT-ID  =  DK-STR-NBR                  17890099
179000               MOVE XL071-LOC-NM TO ASC-STNME2A                   17900099
179100          ELSE                                                    17910099
179200               MOVE XL071-LOC-NM TO ASC-STNME2A                   17920099
179300               SET PS-ERROR                                       17930099
179400                   DP020-MSG-FATAL       TO TRUE                  17940099
179500               MOVE PC-TSYMSG-02961       TO DP020-MSG-NUMBER     17950099
179600               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA           17960099
179700               MOVE DP015-RED              TO ASTNBR2AC           17970099
179800               MOVE DP015-REVERSE          TO ASTNBR2AH           17980099
179900               MOVE -1                     TO ASTNBR2AL           17990099
180000               MOVE +1                     TO ADEL2L              18000099
180100               SET DP030-SET-CURSOR-APPL-1 TO TRUE                18010099
180200          END-IF                                                  18020099
180300      END-IF                                                      18030099
180400      END-IF.                                                     18040099
180500                                                                  18050099
180600*----------------------------------------------------------------*18060099
180700* VALID DOOR/STORE TYPE COMBINATIONS ARE SH/DS AND DS/DC.         18070099
180800* THIS IS FOR NEW STORE NUMBER 3                                  18080099
180900*----------------------------------------------------------------*18090099
181000 3140-VALIDATE-DOOR-TYPE-CODE.                                    18100099
181100                                                                  18110099
181200      IF ASC-DOOR-TYPE-CODE = PC-SH                               18120099
181300          IF XL071-LOC-TYP-CDE = PC-DS                            18130099
181400              MOVE XL071-LOC-NM TO ASC-STNME3A                    18140099
181500          ELSE                                                    18150099
181510*                                                                 18151099
181520* DMH 07/19/2018 BEGIN                                            18152099
181530               PERFORM 3160-CHECK-AMAZON-RETURN                   18153099
181540               IF  PS-AMAZON-RETURN-CENTER-YES  AND               18154099
181550                   PS-DC-ASGN-AMAZON-SHIP-YES                     18155099
181560                   MOVE XLT00010-LOC-NM   TO ASC-STNME3A          18156099
181570               ELSE                                               18157099
181580               IF  PS-AMAZON-RETURN-CENTER-YES  AND               18158099
181590                   PS-DC-ASGN-AMAZON-SHIP-NO                      18159099
181591*                                                                 18159199
181592                   MOVE XLT00010-LOC-NM   TO ASC-STNME3A          18159299
181593                   SET PS-ERROR                                   18159399
181594                       DP020-MSG-FATAL    TO TRUE                 18159499
181595                   MOVE PC-TSYMSG-03807   TO DP020-MSG-NUMBER     18159599
181596                   MOVE DP015-UNP-ALP-BRT-OFF                     18159699
181597                                          TO ASTNBR3AA            18159799
181598                   MOVE DP015-RED         TO ASTNBR3AC            18159899
181599                   MOVE DP015-REVERSE     TO ASTNBR3AH            18159999
181600                   MOVE -1                TO ASTNBR3AL            18160099
181601                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            18160199
181602* DMH 07/19/2018 END                                              18160299
181603               ELSE                                               18160399
181610                   MOVE XL071-LOC-NM TO ASC-STNME3A               18161099
181700                   SET PS-ERROR                                   18170099
181800                       DP020-MSG-FATAL   TO TRUE                  18180099
181900                   MOVE PC-TSYMSG-02583  TO DP020-MSG-NUMBER      18190099
182000                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA       18200099
182100                   MOVE DP015-RED        TO ASTNBR3AC             18210099
182200                   MOVE DP015-REVERSE    TO ASTNBR3AH             18220099
182300                   MOVE -1               TO ASTNBR3AL             18230099
182400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             18240099
182500               END-IF                                             18250099
182510               END-IF                                             18251099
182520          END-IF                                                  18252099
182600      ELSE                                                        18260099
182700      IF ASC-DOOR-TYPE-CODE = PC-DS                               18270099
182800          IF XL071-LOC-TYP-CDE = PC-DC                            18280099
182900               MOVE XL071-LOC-NM TO ASC-STNME3A                   18290099
182910*                                                                 18291099
182920*** 11/13/13 DMH BEGIN                                            18292099
182930*                                                                 18293099
182940               IF  XL071-E-BUS-IND  = 'Y'  AND                    18294099
182950                   PS-WMOS-EFC-YES                                18295099
182960                   SET PS-ERROR                                   18296099
182970                       DP020-MSG-FATAL       TO TRUE              18297099
182980                   MOVE PC-TSYMSG-03738       TO DP020-MSG-NUMBER 18298099
182990                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA       18299099
182991                   MOVE DP015-RED              TO ASTNBR3AC       18299199
182992                   MOVE DP015-REVERSE          TO ASTNBR3AH       18299299
182993                   MOVE -1                     TO ASTNBR3AL       18299399
182994                   MOVE +1                     TO ADEL3L          18299499
182995                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            18299599
182996              END-IF                                              18299699
182997*                                                                 18299799
182998*** 11/13/13 DMH END                                              18299899
182999*                                                                 18299999
183000          ELSE                                                    18300099
183100               MOVE XL071-LOC-NM TO ASC-STNME3A                   18310099
183200               SET PS-ERROR                                       18320099
183300                   DP020-MSG-FATAL       TO TRUE                  18330099
183400               MOVE PC-TSYMSG-02584       TO DP020-MSG-NUMBER     18340099
183500               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA           18350099
183600               MOVE DP015-RED              TO ASTNBR3AC           18360099
183700               MOVE DP015-REVERSE          TO ASTNBR3AH           18370099
183800               MOVE -1                     TO ASTNBR3AL           18380099
183900               MOVE +1                     TO ADEL1L              18390099
184000               SET DP030-SET-CURSOR-APPL-1 TO TRUE                18400099
184100          END-IF                                                  18410099
184200      ELSE                                                        18420099
184300      IF ASC-DOOR-TYPE-CODE = PC-ST                               18430099
184400          IF XL071-LOC-TYP-CDE = PC-DC AND                        18440099
184500             ASC-CURR-OPER-UNT-ID  =  DK-STR-NBR                  18450099
184600               MOVE XL071-LOC-NM TO ASC-STNME3A                   18460099
184700          ELSE                                                    18470099
184800               MOVE XL071-LOC-NM TO ASC-STNME3A                   18480099
184900               SET PS-ERROR                                       18490099
185000                   DP020-MSG-FATAL       TO TRUE                  18500099
185100               MOVE PC-TSYMSG-02961       TO DP020-MSG-NUMBER     18510099
185200               MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA           18520099
185300               MOVE DP015-RED              TO ASTNBR3AC           18530099
185400               MOVE DP015-REVERSE          TO ASTNBR3AH           18540099
185500               MOVE -1                     TO ASTNBR3AL           18550099
185600               MOVE +1                     TO ADEL3L              18560099
185700               SET DP030-SET-CURSOR-APPL-1 TO TRUE                18570099
185800          END-IF                                                  18580099
185900      END-IF                                                      18590099
186000      END-IF.                                                     18600099
186100                                                                  18610099
186200 3150-SELECT-TCNDCDR.                                             18620099
186300      MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                18630099
186400      MOVE ASC-LANE-ASGNMT-N    TO DK-DIVERT-NBR.                 18640099
186500      MOVE ASC-DIVERT-LOC       TO DK-DIVERT-LOC.                 18650099
186600      MOVE ASC-DOOR-ID          TO DK-DOOR-ID.                    18660099
186700      MOVE ASC-DOOR-TYPE-CODE   TO DK-DOOR-TYPE-CDE.              18670099
186800      MOVE ASC-STNBR1A          TO DK-STR-NBR1.                   18680099
186900      MOVE ASC-STNBR2A          TO DK-STR-NBR2.                   18690099
187000      MOVE ASC-STNBR3A          TO DK-STR-NBR3.                   18700099
187100                                                                  18710099
187200        EXEC SQL                                                  18720099
187300          SELECT  A.DOOR_TYP_CDE                                  18730099
187400                 ,A.DOOR_LOC_DESC                                 18740099
187500                 ,A.DIVERT_NBR                                    18750099
187600                 ,A.DIVERT_LOC_ID                                 18760099
187700                 ,A.DOOR_LBL_SEQ_NBR                              18770099
187800            INTO :CNDCDR-DOOR-TYP-CDE                             18780099
187900                ,:CNDCDR-DOOR-LOC-DESC                            18790099
188000                ,:CNDCDR-DIVERT-NBR                               18800099
188100                ,:CNDCDR-DIVERT-LOC-ID                            18810099
188200                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         18820099
188300            FROM  TCNDCDR A                                       18830099
188400                , TCNDRST B                                       18840099
188500           WHERE  A.OPER_UNT_ID      = :DK-OPER-UNT-ID            18850099
188600             AND  A.DIVERT_NBR       = :DK-DIVERT-NBR             18860099
188700             AND  A.DIVERT_LOC_ID    = :DK-DIVERT-LOC             18870099
188800             AND  NOT A.DOOR_ID      = :DK-DOOR-ID                18880099
188900             AND  A.DOOR_ID          = B.DOOR_ID                  18890099
189000             AND  B.STR_NBR IN (:DK-STR-NBR1                      18900099
189100                               ,:DK-STR-NBR2                      18910099
189200                               ,:DK-STR-NBR3)                     18920099
189300             AND  B.END_TMST         = :PC-DEFAULT-TIMESTAMP      18930099
189400        END-EXEC                                                  18940099
189500                                                                  18950099
189600        EVALUATE TRUE                                             18960099
189700            WHEN SQLCODE = +0                                     18970099
189800                SET PS-ERROR                                      18980099
189900                    DP020-MSG-FATAL         TO TRUE               18990099
190000                MOVE PC-TSYMSG-02937        TO DP020-MSG-NUMBER   19000099
190100                MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA          19010099
190200                MOVE DP015-RED              TO ASTNBR1AC          19020099
190300                MOVE DP015-REVERSE          TO ASTNBR1AH          19030099
190400                MOVE -1                     TO ASTNBR1AL          19040099
190500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               19050099
190600            WHEN SQLCODE = +100                                   19060099
190700                CONTINUE                                          19070099
190800            WHEN SQLWARN0 NOT = SPACES                            19080099
190900            WHEN SQLCODE < +0                                     19090099
191000            WHEN SQLCODE > +0                                     19100099
191100                MOVE '3150-SELECT-TCNDCDR'                        19110099
191200                                          TO DP013-PARAGRAPH      19120099
191300                MOVE 'PROBLEM WITH RETRIEVING ROW'                19130099
191400                                    TO DP013-MESSAGE-TEXT (1)     19140099
191500                MOVE SQLCA      TO DP013-SQLCA                    19150099
191600                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       19160099
191700                SET DP013-DB2-ABEND                               19170099
191800                    DP013-XCTL-DISPLAY-RESTART TO TRUE            19180099
191900                PERFORM DP013-0000-PROCESS-ABEND                  19190099
192000        END-EVALUATE.                                             19200099
192100                                                                  19210099
192110*----------------------------------------------------------------*19211099
192120* CHECK IF THE STORE LOCATION IS FOR AN AMAZON RETURN CENTER     *19212099
192130* DMH - 07/17/2018                                               *19213099
192140*----------------------------------------------------------------*19214099
192150 3160-CHECK-AMAZON-RETURN.                                        19215099
192160                                                                  19216099
192170     SET  PS-AMAZON-RETURN-CENTER-NO  TO  TRUE                    19217099
192180     SET  PS-DC-ASGN-AMAZON-SHIP-NO   TO  TRUE                    19218099
192190     MOVE DK-STR-NBR        TO WST00010-ATTR-ELEM-NBR.            19219099
192191                                                                  19219199
192192     EXEC SQL                                                     19219299
192193          SELECT                                                  19219399
192194                 J.LOC_NM                                         19219499
192197            INTO                                                  19219799
192198                 :XLT00010-LOC-NM                                 19219899
192201            FROM                                                  19220199
192202                 WST_INTGRTN_TYP A                                19220299
192203               , WST_ATTR_DEFN   B                                19220399
192204               , WST_ATTR_ELEM   C                                19220499
192205               , WST_ATTR_ELEM   D                                19220599
192206               , WST_ATTR_ELEM   E                                19220699
192207               , WST_ATTR_ELEM   F                                19220799
192208               , WST_ATTR_ELEM   G                                19220899
192209               , WST_ATTR_ELEM   H                                19220999
192210               , WST_ATTR_ELEM   I                                19221099
192211               , XLT_LOC         J                                19221199
192212           WHERE                                                  19221299
192213                 A.INTGRTN_TYP_CDE   = 'AMAZONLOC'                19221399
192214             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          19221499
192215             AND B.ATTR_DEFN_SEQ_NBR = 1                          19221599
192216             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          19221699
192217             AND C.ATTR_DEFN_SEQ_NBR = 1                          19221799
192218             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          19221899
192219             AND D.ATTR_DEFN_SEQ_NBR = 2                          19221999
192220             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          19222099
192221             AND E.ATTR_DEFN_SEQ_NBR = 3                          19222199
192222             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          19222299
192223             AND F.ATTR_DEFN_SEQ_NBR = 4                          19222399
192224             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          19222499
192225             AND G.ATTR_DEFN_SEQ_NBR = 5                          19222599
192226             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          19222699
192227             AND H.ATTR_DEFN_SEQ_NBR = 6                          19222799
192228             AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE          19222899
192229             AND I.ATTR_DEFN_SEQ_NBR = 7                          19222999
192230             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        19223099
192231             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        19223199
192232             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        19223299
192233             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        19223399
192234             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        19223499
192235             AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR        19223599
192236             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    19223699
192237             AND D.ATTR_ELEM_TXT     = 'Y'                        19223799
192238             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          19223899
192239             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          19223999
192240             AND C.ATTR_ELEM_NBR     =  J.LOC_NBR                 19224099
192241             AND J.LOC_TYP_CDE       = 'ND'                       19224199
192242             AND J.OPN_DTE          <=  CURRENT DATE              19224299
192243             AND J.CLO_DTE          >=  CURRENT DATE              19224399
192244       WITH UR                                                    19224499
192245     END-EXEC.                                                    19224599
192246                                                                  19224699
192247     EVALUATE TRUE                                                19224799
192248         WHEN SQLCODE = ZERO                                      19224899
192249              SET  PS-AMAZON-RETURN-CENTER-YES TO TRUE            19224999
192250              PERFORM 3170-CHECK-DC-AMAZON-SHIP                   19225099
192251         WHEN SQLCODE = +100                                      19225199
192252              SET  PS-AMAZON-RETURN-CENTER-NO                     19225299
192253                                       TO TRUE                    19225399
192254         WHEN SQLWARN0 NOT = SPACES                               19225499
192255             WHEN SQLCODE < ZERO                                  19225599
192256             WHEN SQLCODE > ZERO                                  19225699
192257                 MOVE '3160-CHECK-AMAZON-RETURN'                  19225799
192258                                 TO DP013-PARAGRAPH               19225899
192259                 MOVE 'CHECK IF AMAZON RETURN CENTER        '     19225999
192260                                 TO DP013-MESSAGE-TEXT (1)        19226099
192261                 MOVE SQLCA      TO DP013-SQLCA                   19226199
192262                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      19226299
192263                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      19226399
192264                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      19226499
192265                 SET DP013-DB2-ABEND                              19226599
192266                                 TO TRUE                          19226699
192267                 SET DP013-XCTL-DISPLAY-RESTART                   19226799
192268                                 TO TRUE                          19226899
192269                 PERFORM DP013-0000-PROCESS-ABEND                 19226999
192270         END-EVALUATE.                                            19227099
192271                                                                  19227199
192272                                                                  19227299
192273*----------------------------------------------------------------*19227399
192274* IF STORE IS A AMAZON LOCATION - CHECK IS DC HAS BEEN SETUP TO  *19227499
192275* ASSIGN TO SHIPPING DOORS                                       *19227599
192276* DMH - 07/17/2018                                               *19227699
192277*----------------------------------------------------------------*19227799
192278 3170-CHECK-DC-AMAZON-SHIP.                                       19227899
192279                                                                  19227999
192280     SET  PS-DC-ASGN-AMAZON-SHIP-NO  TO  TRUE                     19228099
192281     MOVE ASC-OPER-UNT-ID-N TO WST00010-ATTR-ELEM-NBR.            19228199
192282                                                                  19228299
192283     EXEC SQL                                                     19228399
192284          SELECT                                                  19228499
192285                 D.ATTR_ELEM_TXT                                  19228599
192286            INTO                                                  19228699
192287                 :WST00010-ATTR-ELEM-TXT                          19228799
192288            FROM                                                  19228899
192289                 WST_INTGRTN_TYP A                                19228999
192290               , WST_ATTR_DEFN   B                                19229099
192291               , WST_ATTR_ELEM   C                                19229199
192292               , WST_ATTR_ELEM   D                                19229299
192293               , WST_ATTR_ELEM   E                                19229399
192294               , WST_ATTR_ELEM   F                                19229499
192295               , XLT_LOC         G                                19229599
192296           WHERE                                                  19229699
192297                 A.INTGRTN_TYP_CDE   = 'AMAZONSHIP'               19229799
192298             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          19229899
192299             AND B.ATTR_DEFN_SEQ_NBR = 1                          19229999
192300             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          19230099
192301             AND C.ATTR_DEFN_SEQ_NBR = 1                          19230199
192302             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          19230299
192303             AND D.ATTR_DEFN_SEQ_NBR = 2                          19230399
192304             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          19230499
192305             AND E.ATTR_DEFN_SEQ_NBR = 3                          19230599
192306             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          19230699
192307             AND F.ATTR_DEFN_SEQ_NBR = 4                          19230799
192308             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        19230899
192309             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        19230999
192310             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        19231099
192311             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    19231199
192312             AND D.ATTR_ELEM_TXT     = 'Y'                        19231299
192313             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          19231399
192314             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          19231499
192315             AND C.ATTR_ELEM_NBR     =  G.LOC_NBR                 19231599
192316       WITH UR                                                    19231699
192317     END-EXEC.                                                    19231799
192318                                                                  19231899
192319     EVALUATE TRUE                                                19231999
192320         WHEN SQLCODE = ZERO                                      19232099
192321              SET  PS-DC-ASGN-AMAZON-SHIP-YES                     19232199
192322                                       TO TRUE                    19232299
192323         WHEN SQLCODE = +100                                      19232399
192324         WHEN SQLCODE = -305                                      19232499
192325              SET  PS-DC-ASGN-AMAZON-SHIP-NO                      19232599
192326                                       TO TRUE                    19232699
192327         WHEN SQLWARN0 NOT = SPACES                               19232799
192328             WHEN SQLCODE < ZERO                                  19232899
192329             WHEN SQLCODE > ZERO                                  19232999
192330                 MOVE '3170-CHECK-DC-AMAZON-SHIP '                19233099
192331                                 TO DP013-PARAGRAPH               19233199
192332                 MOVE 'CHECK IF DC CAN ASSGN AMAZON TO SHIP '     19233299
192333                                 TO DP013-MESSAGE-TEXT (1)        19233399
192334                 MOVE SQLCA      TO DP013-SQLCA                   19233499
192335                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      19233599
192336                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      19233699
192337                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      19233799
192338                 SET DP013-DB2-ABEND                              19233899
192339                                 TO TRUE                          19233999
192340                 SET DP013-XCTL-DISPLAY-RESTART                   19234099
192341                                 TO TRUE                          19234199
192342                 PERFORM DP013-0000-PROCESS-ABEND                 19234299
192343         END-EVALUATE.                                            19234399
192344                                                                  19234499
192345                                                                  19234599
192346*----------------------------------------------------------------*19234699
192350* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *19235099
192400* MAP.                                                           *19240099
192500*----------------------------------------------------------------*19250099
192600 3200-RESET-ATTRIBUTES.                                           19260099
192700     IF ASC-STNBR1-N > 0                                          19270099
192800         MOVE DP015-UNP-ALP-NOR-OFF  TO ADEL1A                    19280099
192900                                        ASTNBR1AA                 19290099
193000         MOVE DP015-GREEN            TO ADEL1C                    19300099
193100                                        ASTNBR1AC                 19310099
193200         MOVE DP015-UNDERLINE        TO ADEL1H                    19320099
193300                                        ASTNBR1AH                 19330099
193400         MOVE -1                     TO ADEL1L                    19340099
193500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19350099
193600     ELSE                                                         19360099
193700         MOVE DP015-PRO-DRK-OFF      TO ADEL1A                    19370099
193800         MOVE DP015-HL-OFF           TO ADEL1H                    19380099
193900         MOVE DP015-UNP-ALP-NOR-OFF  TO ASTNBR1AA                 19390099
194000         MOVE DP015-GREEN            TO ASTNBR1AC                 19400099
194100         MOVE DP015-UNDERLINE        TO ASTNBR1AH                 19410099
194200         MOVE -1                     TO ASTNBR1AL                 19420099
194300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19430099
194400     END-IF                                                       19440099
194500     IF ASC-STNBR2-N > 0                                          19450099
194600         MOVE DP015-UNP-ALP-NOR-OFF  TO ADEL2A                    19460099
194700                                        ASTNBR2AA                 19470099
194800         MOVE DP015-GREEN            TO ADEL2C                    19480099
194900                                        ASTNBR2AC                 19490099
195000         MOVE DP015-UNDERLINE        TO ADEL2H                    19500099
195100                                        ASTNBR2AH                 19510099
195200     ELSE                                                         19520099
195300         MOVE DP015-PRO-DRK-OFF      TO ADEL2A                    19530099
195400         MOVE DP015-HL-OFF           TO ADEL2H                    19540099
195500         MOVE DP015-UNP-ALP-NOR-OFF  TO ASTNBR2AA                 19550099
195600         MOVE DP015-GREEN            TO ASTNBR2AC                 19560099
195700         MOVE DP015-UNDERLINE        TO ASTNBR2AH                 19570099
195800     END-IF                                                       19580099
195900     IF ASC-STNBR3-N > 0                                          19590099
196000         MOVE DP015-UNP-ALP-NOR-OFF  TO ADEL3A                    19600099
196100                                        ASTNBR3AA                 19610099
196200         MOVE DP015-GREEN            TO ADEL3C                    19620099
196300                                        ASTNBR3AC                 19630099
196400         MOVE DP015-UNDERLINE        TO ADEL3H                    19640099
196500                                        ASTNBR3AH                 19650099
196600     ELSE                                                         19660099
196700         MOVE DP015-PRO-DRK-OFF      TO ADEL3A                    19670099
196800         MOVE DP015-HL-OFF           TO ADEL3H                    19680099
196900         MOVE DP015-UNP-ALP-NOR-OFF  TO ASTNBR3AA                 19690099
197000         MOVE DP015-GREEN            TO ASTNBR3AC                 19700099
197100         MOVE DP015-UNDERLINE        TO ASTNBR3AH                 19710099
197200     END-IF.                                                      19720099
197300                                                                  19730099
197400*----------------------------------------------------------------*19740099
197500* CHECK TO SEE IF DC STORE ASSIGNMENT IS IN THE FUTURE BASED ON  *19750099
197600* PARM                                                           *19760099
197700* DMH - 6/25/04                                                  *19770099
197800*----------------------------------------------------------------*19780099
197900 3500-CHECK-IF-DC-FUTURE.                                         19790099
198000                                                                  19800099
198100     PERFORM 3510-GET-PARM-VALUE.                                 19810099
198200     PERFORM 3520-CHECK-FUTURE-DC.                                19820099
198300                                                                  19830099
198400*----------------------------------------------------------------*19840099
198500* GET PARM FOR THE NUMBER OF DAYS PRIOR TO DC ACTIVE ASSIGNMENT  *19850099
198600* THAT DOORS CAN BE SET UP IN NEW DC.                            *19860099
198700* DMH - 6/25/04                                                  *19870099
198800*----------------------------------------------------------------*19880099
198900 3510-GET-PARM-VALUE.                                             19890099
199000                                                                  19900099
199100     EXEC SQL                                                     19910099
199200         SELECT FUNC_QTY                                          19920099
199300          INTO :KRPRPM-FUNC-QTY                                   19930099
199400         FROM  TKRPRPM                                            19940099
199500        WHERE LOC_ID            = :DK-OPER-UNT-ID                 19950099
199600          AND SYS_PRC_FUNC_CDE  = 'DCSTDY'                        19960099
199700          AND FUNC_PRC_STAT_CDE = :PC-AC                          19970099
199800     END-EXEC                                                     19980099
199900                                                                  19990099
200000     EVALUATE TRUE                                                20000099
200100         WHEN SQLCODE = ZERO                                      20010099
200200              CONTINUE                                            20020099
200300         WHEN SQLWARN0 NOT = SPACES                               20030099
200400         WHEN SQLCODE < +0                                        20040099
200500         WHEN SQLCODE > +0                                        20050099
200600             MOVE '3510-GET-PARM-VALUE' TO DP013-PARAGRAPH        20060099
200700             MOVE 'GET NUMBER OF DAYS DC CAN ASSIGN STORE'        20070099
200800                                      TO DP013-MESSAGE-TEXT (1)   20080099
200900             MOVE SQLCA        TO DP013-SQLCA                     20090099
201000             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        20100099
201100             SET DP013-DB2-ABEND                                  20110099
201200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20120099
201300             PERFORM DP013-0000-PROCESS-ABEND                     20130099
201400         END-EVALUATE.                                            20140099
201500                                                                  20150099
201600                                                                  20160099
201700*----------------------------------------------------------------*20170099
201800* GET PARM FOR THE NUMBER OF DAYS PRIOR TO DC ACTIVE ASSIGNMENT  *20180099
201900* THAT DOORS CAN BE SET UP IN NEW DC.                            *20190099
202000* DMH - 6/25/04                                                  *20200099
202100*----------------------------------------------------------------*20210099
202200 3520-CHECK-FUTURE-DC.                                            20220099
202300                                                                  20230099
202400     EXEC SQL                                                     20240099
202500         SELECT A.EFF_BEG_DTE                                     20250099
202600              , A.PO_STRT_DTE                                     20260099
202700              , A.DC_NBR                                          20270099
202800          INTO :XLT00014-EFF-BEG-DTE                              20280099
202900              ,:XLT00014-PO-STRT-DTE                              20290099
203000              ,:XLT00014-DC-NBR                                   20300099
203100           FROM XLT_DC_LOC_ASGMT A                                20310099
203200          WHERE A.LOC_NBR     =  :DK-STR-NBR                      20320099
203300            AND A.EFF_BEG_DTE =                                   20330099
203400                (SELECT MAX(EFF_BEG_DTE)                          20340099
203500                   FROM XLT_DC_LOC_ASGMT B                        20350099
203600                  WHERE B.LOC_NBR = :DK-STR-NBR                   20360099
203700                    AND (DATE(EFF_BEG_DTE)                        20370099
203800                    <= (CURRENT DATE + :KRPRPM-FUNC-QTY DAYS))    20380099
203900                )                                                 20390099
204000     END-EXEC.                                                    20400099
204100                                                                  20410099
204200     EVALUATE TRUE                                                20420099
204300         WHEN SQLCODE = ZERO                                      20430099
204400         WHEN SQLCODE = +100                                      20440099
204500              CONTINUE                                            20450099
204600         WHEN SQLWARN0 NOT = SPACES                               20460099
204700         WHEN SQLCODE < +0                                        20470099
204800         WHEN SQLCODE > +0                                        20480099
204900             MOVE '3520-CHECK-FUTURE-DC' TO DP013-PARAGRAPH       20490099
205000             MOVE 'CHECK IF DC ASSMT IN FUTURE'                   20500099
205100                                     TO DP013-MESSAGE-TEXT (1)    20510099
205200             MOVE SQLCA              TO DP013-SQLCA               20520099
205300             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (1)  20530099
205400             SET DP013-DB2-ABEND                                  20540099
205500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20550099
205600             PERFORM DP013-0000-PROCESS-ABEND                     20560099
205700         END-EVALUATE.                                            20570099
205800                                                                  20580099
205900                                                                  20590099
206000*----------------------------------------------------------------*20600099
206100* CHECK PARM TABLE TO DETERMINE IF DC CAN ASSIGN E-COMMERCE      *20610099
206200* STORE TO OUTBOUND DOOR.                                        *20620099
206300* DMH - 6/25/04                                                  *20630099
206400*----------------------------------------------------------------*20640099
206500 3530-CHECK-ECOMM-ASSGN.                                          20650099
206600                                                                  20660099
206700     SET  PV-ECOMM-OTBND-ASSGN-NO  TO  TRUE.                      20670099
206800                                                                  20680099
206900     EXEC SQL                                                     20690099
207000         SELECT FUNC_TXT                                          20700099
207100          INTO :PV-ECOMM-OTBND-ASSGN-SW                           20710099
207200         FROM  TKRPRPM                                            20720099
207300        WHERE LOC_ID            = :DK-OPER-UNT-ID                 20730099
207400          AND SYS_PRC_FUNC_CDE  = 'DCECDR'                        20740099
207500          AND FUNC_PRC_STAT_CDE = :PC-AC                          20750099
207600     END-EXEC                                                     20760099
207700                                                                  20770099
207800     EVALUATE TRUE                                                20780099
207900         WHEN SQLCODE = ZERO                                      20790099
208000              CONTINUE                                            20800099
208100         WHEN SQLWARN0 NOT = SPACES                               20810099
208200         WHEN SQLCODE < +0                                        20820099
208300         WHEN SQLCODE > +0                                        20830099
208400             MOVE '3530-CHECK-ECOMM-ASSGN' TO DP013-PARAGRAPH     20840099
208500             MOVE 'CAN ECOMM STORE BE ASSGN TO OTBND DOOR'        20850099
208600                                      TO DP013-MESSAGE-TEXT (1)   20860099
208700             MOVE SQLCA        TO DP013-SQLCA                     20870099
208800             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        20880099
208900             SET DP013-DB2-ABEND                                  20890099
209000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20900099
209100             PERFORM DP013-0000-PROCESS-ABEND                     20910099
209200         END-EVALUATE.                                            20920099
209300                                                                  20930099
209400                                                                  20940099
209401*----------------------------------------------------------------*20940199
209402* CHECK TO SEE IF DC STORE ASSIGNMENT IS THE PREVIOUS DC BASED   *20940299
209403* ON PARM                                                        *20940399
209404* DMH - 7/19/2010                                                *20940499
209405*----------------------------------------------------------------*20940599
209410 3550-CHECK-IF-DC-PREVIOUS.                                       20941099
209411                                                                  20941199
209412     PERFORM 3560-GET-PARM-VALUE.                                 20941299
209413     PERFORM 3570-CHECK-PREVIOUS-DC.                              20941399
209414                                                                  20941499
209415*----------------------------------------------------------------*20941599
209416* GET PARM FOR THE NUMBER OF DAYS PRIOR TO CURRENT DATE TO SEE   *20941699
209417* IF THE DC HAD BEEN ASSIGNED TO THE STORE                       *20941799
209418* DMH - 7/19/10                                                  *20941899
209419*----------------------------------------------------------------*20941999
209420 3560-GET-PARM-VALUE.                                             20942099
209421                                                                  20942199
209422     EXEC SQL                                                     20942299
209423         SELECT FUNC_QTY                                          20942399
209424          INTO :KRPRPM-FUNC-QTY                                   20942499
209425         FROM  TKRPRPM                                            20942599
209426        WHERE LOC_ID            = :DK-OPER-UNT-ID                 20942699
209427          AND SYS_PRC_FUNC_CDE  = 'DCPVDY'                        20942799
209428          AND FUNC_PRC_STAT_CDE = :PC-AC                          20942899
209429     END-EXEC                                                     20942999
209430                                                                  20943099
209431     EVALUATE TRUE                                                20943199
209432         WHEN SQLCODE = ZERO                                      20943299
209433              CONTINUE                                            20943399
209434         WHEN SQLWARN0 NOT = SPACES                               20943499
209435         WHEN SQLCODE < +0                                        20943599
209436         WHEN SQLCODE > +0                                        20943699
209437             MOVE '3560-GET-PARM-VALUE' TO DP013-PARAGRAPH        20943799
209438             MOVE 'GET NUMBER OF DAYS PREV DC ASSIGN     '        20943899
209439                                      TO DP013-MESSAGE-TEXT (1)   20943999
209440             MOVE SQLCA        TO DP013-SQLCA                     20944099
209441             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        20944199
209442             SET DP013-DB2-ABEND                                  20944299
209443                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20944399
209444             PERFORM DP013-0000-PROCESS-ABEND                     20944499
209445         END-EVALUATE.                                            20944599
209446                                                                  20944699
209447                                                                  20944799
209448*----------------------------------------------------------------*20944899
209449* DETERMINE IF THE DC IS THE PREVIOUS DC ASSIGNED TO STORE       *20944999
209450* THIS WILL BE USED WHEN STORES MOVE BETWEEN DC'S                *20945099
209451* DMH - 7/19/10                                                  *20945199
209452*----------------------------------------------------------------*20945299
209453 3570-CHECK-PREVIOUS-DC.                                          20945399
209454                                                                  20945499
209455     EXEC SQL                                                     20945599
209456         SELECT A.EFF_BEG_DTE                                     20945699
209457              , A.PO_STRT_DTE                                     20945799
209458              , A.DC_NBR                                          20945899
209459          INTO :XLT00014-EFF-BEG-DTE                              20945999
209460              ,:XLT00014-PO-STRT-DTE                              20946099
209461              ,:XLT00014-DC-NBR                                   20946199
209462           FROM XLT_DC_LOC_ASGMT A                                20946299
209463          WHERE A.LOC_NBR     =  :DK-STR-NBR                      20946399
209464            AND A.EFF_BEG_DTE =                                   20946499
209465                (SELECT MAX(EFF_BEG_DTE)                          20946599
209466                   FROM XLT_DC_LOC_ASGMT B                        20946699
209467                  WHERE B.LOC_NBR = :DK-STR-NBR                   20946799
209468                    AND (DATE(EFF_BEG_DTE)                        20946899
209469                    <= (CURRENT DATE - :KRPRPM-FUNC-QTY DAYS))    20946999
209470                )                                                 20947099
209471     END-EXEC.                                                    20947199
209472                                                                  20947299
209473     EVALUATE TRUE                                                20947399
209474         WHEN SQLCODE = ZERO                                      20947499
209475         WHEN SQLCODE = +100                                      20947599
209476              CONTINUE                                            20947699
209477         WHEN SQLWARN0 NOT = SPACES                               20947799
209478         WHEN SQLCODE < +0                                        20947899
209479         WHEN SQLCODE > +0                                        20947999
209480             MOVE '3570-CHECK-PREVIOUS-DC' TO DP013-PARAGRAPH     20948099
209481             MOVE 'CHECK IF DC ASSMT IS PREVIOUS'                 20948199
209482                                     TO DP013-MESSAGE-TEXT (1)    20948299
209483             MOVE SQLCA              TO DP013-SQLCA               20948399
209484             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (1)  20948499
209485             SET DP013-DB2-ABEND                                  20948599
209486                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20948699
209487             PERFORM DP013-0000-PROCESS-ABEND                     20948799
209488         END-EVALUATE.                                            20948899
209489                                                                  20948999
209490                                                                  20949099
209491                                                                  20949199
209500*----------------------------------------------------------------*20950099
209600*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *20960099
209700*    ENTRY.                                                      *20970099
209800*----------------------------------------------------------------*20980099
209900 4000-BUILD-INITIAL-PANEL.                                        20990099
210000     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           21000099
210100     PERFORM 4010-OPEN-CURSOR.                                    21010099
210200     PERFORM 4020-READ-ITEMS-FROM-DB.                             21020099
210300     PERFORM 4030-CLOSE-CURSOR.                                   21030099
210400     PERFORM 4100-RETRIEVE-LOCDESC-DIVERT.                        21040099
210500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21050099
210600                                                                  21060099
210700*----------------------------------------------------------------*21070099
210800* OPEN THE CURSOR.                                               *21080099
210900*----------------------------------------------------------------*21090099
211000 4010-OPEN-CURSOR.                                                21100099
211100     MOVE ASC-OPER-UNT-ID-N  TO DK-OPER-UNT-ID.                   21110099
211200     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       21120099
211300     PERFORM                                                      21130099
211400         WITH TEST AFTER                                          21140099
211500         VARYING PV-RETRY-COUNTER                                 21150099
211600         FROM 1 BY 1                                              21160099
211700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21170099
211800                   OR (SQLCODE = ZERO))                           21180099
211900                                                                  21190099
212000          EXEC SQL                                                21200099
212100              OPEN ASGNMNT-CSR                                    21210099
212200          END-EXEC                                                21220099
212300                                                                  21230099
212400         EVALUATE TRUE                                            21240099
212500             WHEN SQLCODE = ZERO                                  21250099
212600             WHEN SQLCODE = -904                                  21260099
212700             WHEN SQLCODE = -913                                  21270099
212800                 CONTINUE                                         21280099
212900             WHEN SQLWARN0 NOT = SPACES                           21290099
213000             WHEN SQLCODE < ZERO                                  21300099
213100             WHEN SQLCODE > ZERO                                  21310099
213200                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       21320099
213300                 MOVE 'UNABLE TO OPEN A CURSOR -'                 21330099
213400                                   TO DP013-MESSAGE-TEXT (1)      21340099
213410                 MOVE ASC-OPER-UNT-ID-N  TO PV-DISP-OPER          21341099
213420                 STRING PV-DISP-OPER '-'                          21342099
213430                        DK-DOOR-ID DELIMITED BY SIZE              21343099
213440                              INTO DP013-MESSAGE-TEXT (2)         21344099
213500                 MOVE SQLCA        TO DP013-SQLCA                 21350099
213600                 MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)    21360099
213610                 MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)    21361099
213700                 SET DP013-DB2-ABEND                              21370099
213800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           21380099
213900                 PERFORM DP013-0000-PROCESS-ABEND                 21390099
214000         END-EVALUATE                                             21400099
214100     END-PERFORM.                                                 21410099
214200                                                                  21420099
214300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21430099
214400          MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH            21440099
214500          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'  21450099
214600                                   TO DP013-MESSAGE-TEXT (1)      21460099
214700         MOVE SQLCA                TO DP013-SQLCA                 21470099
214800         MOVE 'TCNDRST '           TO DP013-DB2-TABLE-NAME (1)    21480099
214900         SET DP013-DB2-ABEND                                      21490099
215000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   21500099
215100         PERFORM DP013-0000-PROCESS-ABEND                         21510099
215200     END-IF.                                                      21520099
215300                                                                  21530099
215400*----------------------------------------------------------------*21540099
215500*    READ ITEMS FROM DB                                           21550099
215600*----------------------------------------------------------------*21560099
215700 4020-READ-ITEMS-FROM-DB.                                         21570099
215800     MOVE +0  TO  ASC-NUMBER-OF-ITEMS-READ                        21580099
215900     PERFORM                                                      21590099
216000         VARYING PV-READ-COUNT                                    21600099
216100         FROM 1 BY 1                                              21610099
216200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21620099
216300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21630099
216400                                                                  21640099
216500         PERFORM 4025-FETCH                                       21650099
216600                                                                  21660099
216700         IF ASC-ITEMS-LEFT-ON-DB                                  21670099
216800             ADD +1  TO ASC-NUMBER-OF-ITEMS-READ                  21680099
216900             IF ASC-NUMBER-OF-ITEMS-READ = 1                      21690099
217000                 MOVE CNDRST-STR-NBR      TO ASC-STNBR1-N         21700099
217100                 MOVE CNDRST-STRT-TMST    TO ASC-START-TIMESTAMP  21710099
217200                 STRING ASC-MONTH   DELIMITED BY SPACES           21720099
217300                        '/'         DELIMITED BY SPACES           21730099
217400                        ASC-DAY     DELIMITED BY SPACES           21740099
217500                        '/'         DELIMITED BY SPACES           21750099
217600                        ASC-CENTURY DELIMITED BY SPACES           21760099
217700                                    INTO ASC-DATE1                21770099
217800                 STRING ASC-HOUR    DELIMITED BY SPACES           21780099
217900                        ':'         DELIMITED BY SPACES           21790099
218000                        ASC-MINUTE  DELIMITED BY SPACES           21800099
218100                                    INTO ASC-TIME1                21810099
218200                 MOVE XLT00010-LOC-NM      TO ASC-STNME1          21820099
218300             ELSE                                                 21830099
218400                 IF ASC-NUMBER-OF-ITEMS-READ = 2                  21840099
218500                     MOVE CNDRST-STR-NBR   TO ASC-STNBR2-N        21850099
218600                     MOVE CNDRST-STRT-TMST TO ASC-START-TIMESTAMP 21860099
218700                     STRING ASC-MONTH   DELIMITED BY SPACES       21870099
218800                            '/'         DELIMITED BY SPACES       21880099
218900                            ASC-DAY     DELIMITED BY SPACES       21890099
219000                            '/'         DELIMITED BY SPACES       21900099
219100                            ASC-CENTURY DELIMITED BY SPACES       21910099
219200                                        INTO ASC-DATE2            21920099
219300                     STRING ASC-HOUR    DELIMITED BY SPACES       21930099
219400                            ':'         DELIMITED BY SPACES       21940099
219500                            ASC-MINUTE  DELIMITED BY SPACES       21950099
219600                                         INTO ASC-TIME2           21960099
219700                     MOVE XLT00010-LOC-NM      TO ASC-STNME2      21970099
219800                 ELSE                                             21980099
219900                     IF ASC-NUMBER-OF-ITEMS-READ = 3              21990099
220000                         MOVE CNDRST-STR-NBR   TO ASC-STNBR3-N    22000099
220100                         MOVE CNDRST-STRT-TMST TO                 22010099
220200                                              ASC-START-TIMESTAMP 22020099
220300                         STRING ASC-MONTH   DELIMITED BY SPACES   22030099
220400                                '/'         DELIMITED BY SPACES   22040099
220500                                ASC-DAY     DELIMITED BY SPACES   22050099
220600                                '/'         DELIMITED BY SPACES   22060099
220700                                ASC-CENTURY DELIMITED BY SPACES   22070099
220800                                            INTO ASC-DATE3        22080099
220900                         STRING ASC-HOUR    DELIMITED BY SPACES   22090099
221000                                ':'         DELIMITED BY SPACES   22100099
221100                                ASC-MINUTE  DELIMITED BY SPACES   22110099
221200                                             INTO ASC-TIME3       22120099
221300                         MOVE XLT00010-LOC-NM      TO ASC-STNME3  22130099
221400                     END-IF                                       22140099
221500                 END-IF                                           22150099
221600             END-IF                                               22160099
221700         END-IF                                                   22170099
221800     END-PERFORM.                                                 22180099
221900                                                                  22190099
222000*----------------------------------------------------------------*22200099
222100*    FETCH THE CURSOR                                             22210099
222200*----------------------------------------------------------------*22220099
222300 4025-FETCH.                                                      22230099
222400       EXEC SQL                                                   22240099
222500            FETCH ASGNMNT-CSR                                     22250099
222600            INTO  :CNDRST-STR-NBR                                 22260099
222700                , :CNDRST-STRT-TMST                               22270099
222800                , :XLT00010-LOC-NM                                22280099
222900       END-EXEC                                                   22290099
223000                                                                  22300099
223100     EVALUATE TRUE                                                22310099
223200         WHEN SQLCODE = ZERO                                      22320099
223300         WHEN SQLCODE = +100                                      22330099
223400              CONTINUE                                            22340099
223500         WHEN SQLWARN0 NOT = SPACE                                22350099
223600         WHEN SQLCODE NOT = ZERO                                  22360099
223700              MOVE '4025-FETCH-CURSOR' TO DP013-PARAGRAPH         22370099
223800              MOVE 'COULD NOT FETCH CURSOR'                       22380099
223900                               TO DP013-MESSAGE-TEXT (1)          22390099
224000              MOVE SQLCA       TO DP013-SQLCA                     22400099
224100              SET DP013-DB2-ABEND TO TRUE                         22410099
224200              PERFORM DP013-0000-PROCESS-ABEND                    22420099
224300     END-EVALUATE.                                                22430099
224400                                                                  22440099
224500     IF  SQLCODE EQUAL +100                                       22450099
224600         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      22460099
224700     ELSE                                                         22470099
224800         SET ASC-ITEMS-LEFT-ON-DB TO TRUE                         22480099
224900     END-IF.                                                      22490099
225000                                                                  22500099
225100*----------------------------------------------------------------*22510099
225200* CLOSE THE CURSOR                                               *22520099
225300*----------------------------------------------------------------*22530099
225400 4030-CLOSE-CURSOR.                                               22540099
225500      EXEC SQL                                                    22550099
225600           CLOSE ASGNMNT-CSR                                      22560099
225700      END-EXEC                                                    22570099
225800                                                                  22580099
225900     EVALUATE TRUE                                                22590099
226000         WHEN SQLCODE = ZERO                                      22600099
226100             CONTINUE                                             22610099
226200         WHEN SQLWARN0 NOT = SPACES                               22620099
226300         WHEN SQLCODE < ZERO                                      22630099
226400         WHEN SQLCODE > ZERO                                      22640099
226500             MOVE '4030-CLOSE-CURSOR' TO DP013-PARAGRAPH          22650099
226600             MOVE 'UNABLE TO CLOSE CURSOR '                       22660099
226700                               TO DP013-MESSAGE-TEXT (1)          22670099
226800             MOVE SQLCA        TO DP013-SQLCA                     22680099
226900             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        22690099
227000             SET DP013-DB2-ABEND                                  22700099
227100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22710099
227200             PERFORM DP013-0000-PROCESS-ABEND                     22720099
227300     END-EVALUATE.                                                22730099
227400                                                                  22740099
227500******************************************************************22750099
227600** RETRIEVE LOCATION DESCRIPTION AND DIVERT NUMBER                22760099
227700******************************************************************22770099
227800 4100-RETRIEVE-LOCDESC-DIVERT.                                    22780099
227900      MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                   22790099
228000      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       22800099
228100                                                                  22810099
228200        EXEC SQL                                                  22820099
228300          SELECT  A.DOOR_LOC_DESC                                 22830099
228400                 ,A.DIVERT_NBR                                    22840099
228500                 ,A.DIVERT_LOC_ID                                 22850099
228600                 ,A.DOOR_LBL_SEQ_NBR                              22860099
228700            INTO :CNDCDR-DOOR-LOC-DESC                            22870099
228800                ,:CNDCDR-DIVERT-NBR                               22880099
228900                ,:CNDCDR-DIVERT-LOC-ID                            22890099
229000                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         22900099
229100            FROM  TCNDCDR A                                       22910099
229200               ,  TCNDRTY B                                       22920099
229300           WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID              22930099
229400             AND  A.DOOR_ID        = :DK-DOOR-ID                  22940099
229500             AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE               22950099
229600             AND  B.DIVERT_TYP_CDE = :PC-D                        22960099
229700                                                                  22970099
229800                                                                  22980099
229900        END-EXEC                                                  22990099
230000                                                                  23000099
230100        EVALUATE TRUE                                             23010099
230200            WHEN SQLCODE = +0                                     23020099
230300                MOVE CNDCDR-DOOR-LOC-DESC    TO ASC-LOC-DESC      23030099
230400                MOVE CNDCDR-DIVERT-NBR       TO ASC-LANE-ASGNMT-N 23040099
230500                MOVE CNDCDR-DIVERT-LOC-ID    TO ASC-DIVERT-LOC    23050099
230600                MOVE CNDCDR-DOOR-LBL-SEQ-NBR TO ASC-LABEL-SEQ-N   23060099
230700            WHEN SQLCODE = +100                                   23070099
230800                CONTINUE                                          23080099
230900            WHEN SQLWARN0 NOT = SPACES                            23090099
231000            WHEN SQLCODE < +0                                     23100099
231100            WHEN SQLCODE > +0                                     23110099
231200                MOVE '4100-RETRIEVE-LOCDESC-DIVERT'               23120099
231300                                          TO DP013-PARAGRAPH      23130099
231400                MOVE 'PROBLEM WITH RETRIEVING ROW'                23140099
231500                                    TO DP013-MESSAGE-TEXT (1)     23150099
231600                MOVE SQLCA      TO DP013-SQLCA                    23160099
231700                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       23170099
231800                SET DP013-DB2-ABEND                               23180099
231900                    DP013-XCTL-DISPLAY-RESTART TO TRUE            23190099
232000                PERFORM DP013-0000-PROCESS-ABEND                  23200099
232100        END-EVALUATE.                                             23210099
232200                                                                  23220099
232300*----------------------------------------------------------------*23230099
232400* OPEN THE DIVERT CURSOR.                                        *23240099
232500*----------------------------------------------------------------*23250099
232600 4210-OPEN-DIVERT-CURSOR.                                         23260099
232700     MOVE ASC-OPER-UNT-ID-N  TO DK-OPER-UNT-ID.                   23270099
232800     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       23280099
232900     MOVE ASC-LANE-ASGNMT    TO DK-DIVERT-NBR.                    23290099
233000     MOVE ASC-DIVERT-LOC     TO DK-DIVERT-LOC.                    23300099
233100                                                                  23310099
233200     PERFORM                                                      23320099
233300         WITH TEST AFTER VARYING PV-RETRY-COUNTER                 23330099
233400         FROM 1 BY 1                                              23340099
233500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23350099
233600                   OR (SQLCODE = ZERO))                           23360099
233700                                                                  23370099
233800          EXEC SQL                                                23380099
233900              OPEN SAME-DIVERT-CSR                                23390099
234000          END-EXEC                                                23400099
234100                                                                  23410099
234200         EVALUATE TRUE                                            23420099
234300             WHEN SQLCODE = ZERO                                  23430099
234400             WHEN SQLCODE = -904                                  23440099
234500             WHEN SQLCODE = -913                                  23450099
234600                 CONTINUE                                         23460099
234700             WHEN SQLWARN0 NOT = SPACES                           23470099
234800             WHEN SQLCODE < ZERO                                  23480099
234900             WHEN SQLCODE > ZERO                                  23490099
235000                MOVE '4210-OPEN-DIVERT-CURSOR' TO DP013-PARAGRAPH 23500099
235100                MOVE 'UNABLE TO OPEN A CURSOR -'                  23510099
235200                                   TO DP013-MESSAGE-TEXT (1)      23520099
235300                MOVE SQLCA        TO DP013-SQLCA                  23530099
235310                 MOVE ASC-OPER-UNT-ID-N  TO PV-DISP-OPER          23531099
235320                 STRING PV-DISP-OPER '-'                          23532099
235330                        DK-DOOR-ID DELIMITED BY SIZE              23533099
235340                              INTO DP013-MESSAGE-TEXT (2)         23534099
235400                MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)     23540099
235410                MOVE 'TCNDRTY '   TO DP013-DB2-TABLE-NAME (2)     23541099
235500                SET DP013-DB2-ABEND                               23550099
235600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23560099
235700                PERFORM DP013-0000-PROCESS-ABEND                  23570099
235800         END-EVALUATE                                             23580099
235900     END-PERFORM.                                                 23590099
236000                                                                  23600099
236100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23610099
236200          MOVE '4210-OPEN-DIVERT-CURSOR'   TO DP013-PARAGRAPH     23620099
236300          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'  23630099
236400                                   TO DP013-MESSAGE-TEXT (1)      23640099
236500         MOVE SQLCA                TO DP013-SQLCA                 23650099
236600         MOVE 'TCNDCDR '           TO DP013-DB2-TABLE-NAME (1)    23660099
236700         SET DP013-DB2-ABEND                                      23670099
236800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   23680099
236900         PERFORM DP013-0000-PROCESS-ABEND                         23690099
237000     END-IF.                                                      23700099
237100                                                                  23710099
237200*----------------------------------------------------------------*23720099
237300*    READ ITEMS FROM DB                                           23730099
237400*----------------------------------------------------------------*23740099
237500 4220-READ-ITEMS-FROM-DB.                                         23750099
237600     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            23760099
237700     PERFORM                                                      23770099
237800         VARYING PV-READ-COUNT FROM 1 BY 1                        23780099
237900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23790099
238000            OR (ASC-NO-ITEMS-LEFT-ON-DB)                          23800099
238100            OR (PS-DUPLICATE-STORE-ASGNMT))                       23810099
238200                                                                  23820099
238300            PERFORM 4225-FETCH-DIVERT-CSR                         23830099
238400                                                                  23840099
238500     END-PERFORM.                                                 23850099
238600                                                                  23860099
238700*----------------------------------------------------------------*23870099
238800*    FETCH THE DIVERT CURSOR                                      23880099
238900*----------------------------------------------------------------*23890099
239000 4225-FETCH-DIVERT-CSR.                                           23900099
239100       EXEC SQL                                                   23910099
239200            FETCH SAME-DIVERT-CSR                                 23920099
239300            INTO  :CNDCDR-OPER-UNT-ID                             23930099
239400                , :CNDCDR-DIVERT-NBR                              23940099
239500                , :CNDCDR-DIVERT-LOC-ID                           23950099
239600                , :CNDCDR-DOOR-ID                                 23960099
239700       END-EXEC                                                   23970099
239800                                                                  23980099
239900     EVALUATE TRUE                                                23990099
240000         WHEN SQLCODE = ZERO                                      24000099
240100              PERFORM 4300-CHECK-STORE-ASGNMT                     24010099
240200         WHEN SQLCODE = +100                                      24020099
240300              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 24030099
240400         WHEN SQLWARN0 NOT = SPACE                                24040099
240500         WHEN SQLCODE NOT = ZERO                                  24050099
240600              MOVE '4225-FETCH-CURSOR' TO DP013-PARAGRAPH         24060099
240700              MOVE 'COULD NOT FETCH CURSOR'                       24070099
240800                               TO DP013-MESSAGE-TEXT (1)          24080099
240900              MOVE SQLCA       TO DP013-SQLCA                     24090099
241000              SET DP013-DB2-ABEND TO TRUE                         24100099
241100              PERFORM DP013-0000-PROCESS-ABEND                    24110099
241200     END-EVALUATE.                                                24120099
241300                                                                  24130099
241400*----------------------------------------------------------------*24140099
241500* CLOSE THE DIVERT CURSOR.                                       *24150099
241600*----------------------------------------------------------------*24160099
241700 4230-CLOSE-DIVERT-CURSOR.                                        24170099
241800      EXEC SQL                                                    24180099
241900           CLOSE SAME-DIVERT-CSR                                  24190099
242000      END-EXEC                                                    24200099
242100                                                                  24210099
242200     EVALUATE TRUE                                                24220099
242300         WHEN SQLCODE = ZERO                                      24230099
242400             CONTINUE                                             24240099
242500         WHEN SQLWARN0 NOT = SPACES                               24250099
242600         WHEN SQLCODE < ZERO                                      24260099
242700         WHEN SQLCODE > ZERO                                      24270099
242800             MOVE '4230-CLOSE-DIVERT-CURSOR' TO DP013-PARAGRAPH   24280099
242900             MOVE 'UNABLE TO CLOSE CURSOR '                       24290099
243000                               TO DP013-MESSAGE-TEXT (1)          24300099
243100             MOVE SQLCA        TO DP013-SQLCA                     24310099
243200             MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)        24320099
243300             SET DP013-DB2-ABEND                                  24330099
243400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24340099
243500             PERFORM DP013-0000-PROCESS-ABEND                     24350099
243600     END-EVALUATE.                                                24360099
243700                                                                  24370099
243800*----------------------------------------------------------------*24380099
243900* CHECK STORE ASSIGNMENTS                                         24390099
244000*----------------------------------------------------------------*24400099
244100 4300-CHECK-STORE-ASGNMT.                                         24410099
244200                                                                  24420099
244300     IF ASC-STNBR1A-N > 0                                         24430099
244400         MOVE ASC-STNBR1A-N TO DK-STR-NBR                         24440099
244500         PERFORM 4350-CHECK-4-DUPLICATE-STR                       24450099
244600         IF PS-DUPLICATE-STORE-ASGNMT                             24460099
244700             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA             24470099
244800             MOVE DP015-RED              TO ASTNBR1AC             24480099
244900             MOVE DP015-REVERSE          TO ASTNBR1AH             24490099
245000             MOVE -1                     TO ASTNBR1AL             24500099
245100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  24510099
245200         END-IF                                                   24520099
245300     END-IF.                                                      24530099
245400     IF PS-NO-DUPLICATE-STORE-ASGNMT                              24540099
245500         IF ASC-STNBR2A-N > 0                                     24550099
245600             MOVE ASC-STNBR2A-N TO DK-STR-NBR                     24560099
245700             PERFORM 4350-CHECK-4-DUPLICATE-STR                   24570099
245800             IF PS-DUPLICATE-STORE-ASGNMT                         24580099
245900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA         24590099
246000                 MOVE DP015-RED              TO ASTNBR2AC         24600099
246100                 MOVE DP015-REVERSE          TO ASTNBR2AH         24610099
246200                 MOVE -1                     TO ASTNBR2AL         24620099
246300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24630099
246400             END-IF                                               24640099
246500         END-IF                                                   24650099
246600     END-IF.                                                      24660099
246700     IF PS-NO-DUPLICATE-STORE-ASGNMT                              24670099
246800         IF ASC-STNBR3A-N > 0                                     24680099
246900             MOVE ASC-STNBR3A-N TO DK-STR-NBR                     24690099
247000             PERFORM 4350-CHECK-4-DUPLICATE-STR                   24700099
247100             IF PS-DUPLICATE-STORE-ASGNMT                         24710099
247200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA         24720099
247300                 MOVE DP015-RED              TO ASTNBR3AC         24730099
247400                 MOVE DP015-REVERSE          TO ASTNBR3AH         24740099
247500                 MOVE -1                     TO ASTNBR3AL         24750099
247600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24760099
247700             END-IF                                               24770099
247800         END-IF                                                   24780099
247900     END-IF.                                                      24790099
248000*----------------------------------------------------------------*24800099
248100* CHECK FOR DUPLICATE STORES                                      24810099
248200*----------------------------------------------------------------*24820099
248300 4350-CHECK-4-DUPLICATE-STR.                                      24830099
248400     INITIALIZE ASC-COUNT.                                        24840099
248500     MOVE CNDCDR-OPER-UNT-ID   TO   PV-OPER-UNT-ID.               24850099
248600     MOVE CNDCDR-DOOR-ID       TO   PV-DOOR-ID.                   24860099
248700                                                                  24870099
248800     EXEC SQL                                                     24880099
248900         SELECT COUNT(*)                                          24890099
249000          INTO :ASC-COUNT                                         24900099
249100         FROM  TCNDRST                                            24910099
249200        WHERE OPER_UNT_ID  = :PV-OPER-UNT-ID                      24920099
249300          AND DOOR_ID      = :PV-DOOR-ID                          24930099
249400          AND STR_NBR      = :DK-STR-NBR                          24940099
249500          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                24950099
249600     END-EXEC                                                     24960099
249700                                                                  24970099
249800     EVALUATE TRUE                                                24980099
249900         WHEN SQLCODE = ZERO                                      24990099
250000             IF ASC-COUNT > +0                                    25000099
250100                 SET PS-DUPLICATE-STORE-ASGNMT TO TRUE            25010099
250200             ELSE                                                 25020099
250300                 SET PS-NO-DUPLICATE-STORE-ASGNMT TO TRUE         25030099
250400             END-IF                                               25040099
250500         WHEN SQLWARN0 NOT = SPACES                               25050099
250600         WHEN SQLCODE < +0                                        25060099
250700         WHEN SQLCODE > +0                                        25070099
250800             MOVE '4350-CHECK-4-DUPLICATE-STR' TO DP013-PARAGRAPH 25080099
250900             MOVE 'TROUBLE COUNTING DUPLICATE STR'                25090099
251000                                      TO DP013-MESSAGE-TEXT (1)   25100099
251100             MOVE SQLCA        TO DP013-SQLCA                     25110099
251200             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        25120099
251300             SET DP013-DB2-ABEND                                  25130099
251400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25140099
251500             PERFORM DP013-0000-PROCESS-ABEND                     25150099
251600         END-EVALUATE.                                            25160099
251700                                                                  25170099
251800*----------------------------------------------------------------*25180099
251900* PREPARE TO CHECK FOR MULTIPLE STORES                            25190099
252000*----------------------------------------------------------------*25200099
252100 4390-PREPARE-2-CHECK.                                            25210099
252200                                                                  25220099
252300     PERFORM 4393-CHECK-TKRPRPM.                                  25230099
252400     SET  PS-SAME-STR-MLT-DR-NO  TO  TRUE.                        25240099
252500                                                                  25250099
252600     IF ASC-STNBR1A-N > 0                                         25260099
252700         MOVE ASC-STNBR1A-N TO DK-STR-NBR                         25270099
252800         PERFORM 4391-CHECK-4-MULTIPLE-STORE                      25280099
252900         IF  PS-SAME-STR-MLT-DR                                   25290099
253000* DMH 3/17/03 - BEGIN                                             25300099
253100             PERFORM 4395-CHECK-MLT-STR-SAME-DVRT                 25310099
253200             IF  PS-SAME-STR-MLT-DVT                              25320099
253300                 SET  PS-DUPLICATE-DOOR-DIVERT  TO  TRUE          25330099
253400             ELSE                                                 25340099
253500* DMH 3/17/03 - END                                               25350099
253600                 IF  PS-MULTIPLE-DOORS-ALLOWED                    25360099
253700                     SET ASC-2ND-CONFIRM-NEED                     25370099
253800                         ASC-STR-1-MLT-DR    TO TRUE              25380099
253900                 ELSE                                             25390099
254000                     SET  PS-DUPLICATE-STORE-ASGNMT  TO  TRUE     25400099
254100                 END-IF                                           25410099
254200             END-IF                                               25420099
254300             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR1AA             25430099
254400             MOVE DP015-RED              TO ASTNBR1AC             25440099
254500             MOVE DP015-REVERSE          TO ASTNBR1AH             25450099
254600             MOVE -1                     TO ASTNBR1AL             25460099
254700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  25470099
254800         END-IF                                                   25480099
254900     END-IF.                                                      25490099
255000                                                                  25500099
255100     IF PS-SAME-STR-MLT-DR-NO                                     25510099
255200         IF ASC-STNBR2A-N > 0                                     25520099
255300             MOVE ASC-STNBR2A-N TO DK-STR-NBR                     25530099
255400             PERFORM 4391-CHECK-4-MULTIPLE-STORE                  25540099
255500             IF  PS-SAME-STR-MLT-DR                               25550099
255600* DMH 3/17/03 - BEGIN                                             25560099
255700                 PERFORM 4395-CHECK-MLT-STR-SAME-DVRT             25570099
255800                 IF  PS-SAME-STR-MLT-DVT                          25580099
255900                     SET  PS-DUPLICATE-DOOR-DIVERT  TO  TRUE      25590099
256000                 ELSE                                             25600099
256100* DMH 3/17/03 - END                                               25610099
256200                     IF  PS-MULTIPLE-DOORS-ALLOWED                25620099
256300                         SET ASC-2ND-CONFIRM-NEED                 25630099
256400                             ASC-STR-2-MLT-DR    TO TRUE          25640099
256500                     ELSE                                         25650099
256600                         SET  PS-DUPLICATE-STORE-ASGNMT  TO  TRUE 25660099
256700                     END-IF                                       25670099
256800                 END-IF                                           25680099
256900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR2AA         25690099
257000                 MOVE DP015-RED              TO ASTNBR2AC         25700099
257100                 MOVE DP015-REVERSE          TO ASTNBR2AH         25710099
257200                 MOVE -1                     TO ASTNBR2AL         25720099
257300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              25730099
257400             END-IF                                               25740099
257500         END-IF                                                   25750099
257600     END-IF.                                                      25760099
257700                                                                  25770099
257800     IF PS-SAME-STR-MLT-DR-NO                                     25780099
257900         IF ASC-STNBR3A-N > 0                                     25790099
258000             MOVE ASC-STNBR3A-N TO DK-STR-NBR                     25800099
258100             PERFORM 4391-CHECK-4-MULTIPLE-STORE                  25810099
258200             IF  PS-SAME-STR-MLT-DR                               25820099
258300* DMH 3/17/03 - BEGIN                                             25830099
258400                 PERFORM 4395-CHECK-MLT-STR-SAME-DVRT             25840099
258500                 IF  PS-SAME-STR-MLT-DVT                          25850099
258600                     SET  PS-DUPLICATE-DOOR-DIVERT  TO  TRUE      25860099
258700                 ELSE                                             25870099
258800* DMH 3/17/03 - END                                               25880099
258900                     IF  PS-MULTIPLE-DOORS-ALLOWED                25890099
259000                         SET ASC-2ND-CONFIRM-NEED                 25900099
259100                             ASC-STR-3-MLT-DR    TO TRUE          25910099
259200                     ELSE                                         25920099
259300                         SET  PS-DUPLICATE-STORE-ASGNMT  TO  TRUE 25930099
259400                     END-IF                                       25940099
259500                 END-IF                                           25950099
259600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTNBR3AA         25960099
259700                 MOVE DP015-RED              TO ASTNBR3AC         25970099
259800                 MOVE DP015-REVERSE          TO ASTNBR3AH         25980099
259900                 MOVE -1                     TO ASTNBR3AL         25990099
260000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26000099
260100             END-IF                                               26010099
260200         END-IF                                                   26020099
260300     END-IF.                                                      26030099
260400                                                                  26040099
260500*----------------------------------------------------------------*26050099
260600* CHECK FOR DUPLICATE STORES                                      26060099
260700*----------------------------------------------------------------*26070099
260800 4391-CHECK-4-MULTIPLE-STORE.                                     26080099
260900     INITIALIZE ASC-COUNT.                                        26090099
261000     MOVE ASC-OPER-UNT-ID   TO   PV-OPER-UNT-ID.                  26100099
261100                                                                  26110099
261200     EXEC SQL                                                     26120099
261300         SELECT COUNT(*)                                          26130099
261400          INTO :ASC-SAME-STR-MLT-DR-CNT                           26140099
261500         FROM  TCNDRST                                            26150099
261600        WHERE OPER_UNT_ID  = :PV-OPER-UNT-ID                      26160099
261700          AND STR_NBR      = :DK-STR-NBR                          26170099
261800          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                26180099
261900     END-EXEC                                                     26190099
262000                                                                  26200099
262100     EVALUATE TRUE                                                26210099
262200         WHEN SQLCODE = ZERO                                      26220099
262300             IF ASC-SAME-STR-MLT-DR-CNT > +0                      26230099
262400                 SET PS-SAME-STR-MLT-DR     TO TRUE               26240099
262500             ELSE                                                 26250099
262600                 SET PS-SAME-STR-MLT-DR-NO  TO TRUE               26260099
262700             END-IF                                               26270099
262800         WHEN SQLWARN0 NOT = SPACES                               26280099
262900         WHEN SQLCODE < +0                                        26290099
263000         WHEN SQLCODE > +0                                        26300099
263100             MOVE '4393-CHECK-4-MULTIPLE-STR' TO DP013-PARAGRAPH  26310099
263200             MOVE 'TROUBLE COUNTING MULTIPLE STR'                 26320099
263300                                      TO DP013-MESSAGE-TEXT (1)   26330099
263400             MOVE SQLCA        TO DP013-SQLCA                     26340099
263500             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        26350099
263600             SET DP013-DB2-ABEND                                  26360099
263700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26370099
263800             PERFORM DP013-0000-PROCESS-ABEND                     26380099
263900         END-EVALUATE.                                            26390099
264000                                                                  26400099
264100*----------------------------------------------------------------*26410099
264200* CHECK FOR DUPLICATE STORES @ DOORS W/ SAME DIVERT LOCATION      26420099
264300*----------------------------------------------------------------*26430099
264400 4395-CHECK-MLT-STR-SAME-DVRT.                                    26440099
264500     INITIALIZE ASC-COUNT.                                        26450099
264600     MOVE ASC-OPER-UNT-ID     TO   PV-OPER-UNT-ID.                26460099
264700     MOVE ASC-LANE-ASGNMT-NUM TO   DK-DIVERT-NBR2.                26470099
264800     MOVE ASC-DIVERT-LOC      TO   DK-DIVERT-LOC.                 26480099
264900                                                                  26490099
265000     EXEC SQL                                                     26500099
265100         SELECT COUNT(*)                                          26510099
265200          INTO :ASC-SAME-STR-MLT-DR-DVT                           26520099
265300         FROM  TCNDRST A                                          26530099
265400              ,TCNDCDR B                                          26540099
265500        WHERE A.OPER_UNT_ID   = :PV-OPER-UNT-ID                   26550099
265600          AND A.STR_NBR       = :DK-STR-NBR                       26560099
265700          AND A.END_TMST      = :PC-DEFAULT-TIMESTAMP             26570099
265800          AND A.OPER_UNT_ID   = B.OPER_UNT_ID                     26580099
265900          AND A.DOOR_ID       = B.DOOR_ID                         26590099
266000          AND B.DIVERT_NBR    = :DK-DIVERT-NBR2                   26600099
266100          AND B.DIVERT_LOC_ID = :DK-DIVERT-LOC                    26610099
266200     END-EXEC                                                     26620099
266300                                                                  26630099
266400     EVALUATE TRUE                                                26640099
266500         WHEN SQLCODE = ZERO                                      26650099
266600             IF ASC-SAME-STR-MLT-DR-DVT > +0                      26660099
266700                 SET PS-SAME-STR-MLT-DVT    TO TRUE               26670099
266800             ELSE                                                 26680099
266900                 SET PS-SAME-STR-MLT-DVT-NO TO TRUE               26690099
267000             END-IF                                               26700099
267100         WHEN SQLWARN0 NOT = SPACES                               26710099
267200         WHEN SQLCODE < +0                                        26720099
267300         WHEN SQLCODE > +0                                        26730099
267400             MOVE '4395-CHECK-MLT-STR-SAME-DVRT'                  26740099
267500                                              TO DP013-PARAGRAPH  26750099
267600             MOVE 'CHEK SAME STR MLT DOOR SAME DVRT'              26760099
267700                                      TO DP013-MESSAGE-TEXT (1)   26770099
267800             MOVE SQLCA        TO DP013-SQLCA                     26780099
267900             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        26790099
268000             SET DP013-DB2-ABEND                                  26800099
268100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26810099
268200             PERFORM DP013-0000-PROCESS-ABEND                     26820099
268300         END-EVALUATE.                                            26830099
268400                                                                  26840099
268500*----------------------------------------------------------------*26850099
268600* CHECK FOR TKRPRPM TO SEE IF MULTIPLE STORES CAN BE ASSIGNED TO  26860099
268700* A DOOR.                                                         26870099
268800*----------------------------------------------------------------*26880099
268900 4392-CHECK-TKRPRPM.                                              26890099
269000     MOVE ASC-OPER-UNT-ID   TO   PV-OPER-UNT-ID.                  26900099
269100                                                                  26910099
269200     EXEC SQL                                                     26920099
269300         SELECT FUNC_TXT                                          26930099
269400          INTO :KRPRPM-FUNC-TXT                                   26940099
269500         FROM  TKRPRPM                                            26950099
269600        WHERE LOC_ID            = :PV-OPER-UNT-ID                 26960099
269700          AND SYS_PRC_FUNC_CDE  = :PC-MLTSTR                      26970099
269800*         AND SYS_PRC_FUNC_CDE  = :PC-MLTDRS                      26980099
269900          AND FUNC_PRC_STAT_CDE = :PC-AC                          26990099
270000     END-EXEC                                                     27000099
270100                                                                  27010099
270200     EVALUATE TRUE                                                27020099
270300         WHEN SQLCODE = ZERO                                      27030099
270400             IF KRPRPM-FUNC-TXT = PC-Y                            27040099
270500                 SET PS-MULTIPLE-STORES-ALLOWED    TO TRUE        27050099
270600                 IF ASC-STNBR1A-N > 0                             27060099
270700                     MOVE DP015-GREEN            TO ASTNBR1AC     27070099
270800                     MOVE DP015-HL-OFF           TO ASTNBR1AH     27080099
270900                     MOVE +1                     TO ASTNBR1AL     27090099
271000                 ELSE                                             27100099
271100                     IF ASC-STNBR2A-N > 0                         27110099
271200                         MOVE DP015-GREEN        TO ASTNBR2AC     27120099
271300                         MOVE DP015-HL-OFF       TO ASTNBR2AH     27130099
271400                         MOVE +1                 TO ASTNBR2AL     27140099
271500                     ELSE                                         27150099
271600                         IF ASC-STNBR3A-N > 0                     27160099
271700                             MOVE DP015-GREEN    TO ASTNBR3AC     27170099
271800                             MOVE DP015-HL-OFF   TO ASTNBR3AH     27180099
271900                             MOVE +1             TO ASTNBR3AL     27190099
272000                         END-IF                                   27200099
272100                     END-IF                                       27210099
272200                 END-IF                                           27220099
272300             ELSE                                                 27230099
272400                 SET PS-NO-MULTIPLE-STORES-ALLOWED TO TRUE        27240099
272500             END-IF                                               27250099
272600         WHEN SQLCODE = +100                                      27260099
272700                 SET PS-NO-MULTIPLE-STORES-ALLOWED TO TRUE        27270099
272800         WHEN SQLWARN0 NOT = SPACES                               27280099
272900         WHEN SQLCODE < +0                                        27290099
273000         WHEN SQLCODE > +0                                        27300099
273100             MOVE '4392-CHECK-TKRPRPM ' TO DP013-PARAGRAPH        27310099
273200             MOVE 'TROUBLE FINDING ROW ON TABLE  '                27320099
273300                                      TO DP013-MESSAGE-TEXT (1)   27330099
273400             MOVE SQLCA        TO DP013-SQLCA                     27340099
273500             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        27350099
273600             SET DP013-DB2-ABEND                                  27360099
273700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27370099
273800             PERFORM DP013-0000-PROCESS-ABEND                     27380099
273900         END-EVALUATE.                                            27390099
274000                                                                  27400099
274100*----------------------------------------------------------------*27410099
274200* CHECK FOR TKRPRPM TO SEE IF A STORE CAN BE ASSIGNED TO MULTIPL *27420099
274300* DOORS                                                          *27430099
274400*----------------------------------------------------------------*27440099
274500 4393-CHECK-TKRPRPM.                                              27450099
274600     MOVE ASC-OPER-UNT-ID   TO   PV-OPER-UNT-ID.                  27460099
274700                                                                  27470099
274800     EXEC SQL                                                     27480099
274900         SELECT FUNC_TXT                                          27490099
275000          INTO :KRPRPM-FUNC-TXT                                   27500099
275100         FROM  TKRPRPM                                            27510099
275200        WHERE LOC_ID            = :PV-OPER-UNT-ID                 27520099
275300          AND SYS_PRC_FUNC_CDE  = 'MLTDOR'                        27530099
275400          AND FUNC_PRC_STAT_CDE = :PC-AC                          27540099
275500          AND FUNC_TXT          = 'Y'                             27550099
275600     END-EXEC                                                     27560099
275700                                                                  27570099
275800     EVALUATE TRUE                                                27580099
275900         WHEN SQLCODE = ZERO                                      27590099
276000              SET PS-MULTIPLE-DOORS-ALLOWED     TO TRUE           27600099
276100                                                                  27610099
276200         WHEN SQLCODE = +100                                      27620099
276300              SET PS-NO-MULTIPLE-DOORS-ALLOWED TO TRUE            27630099
276400                                                                  27640099
276500         WHEN SQLWARN0 NOT = SPACES                               27650099
276600         WHEN SQLCODE < +0                                        27660099
276700         WHEN SQLCODE > +0                                        27670099
276800             MOVE '4393-CHECK-TKRPRPM ' TO DP013-PARAGRAPH        27680099
276900             MOVE 'TROUBLE FINDING ROW ON TABLE  '                27690099
277000                                      TO DP013-MESSAGE-TEXT (1)   27700099
277100             MOVE SQLCA        TO DP013-SQLCA                     27710099
277200             MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)        27720099
277300             SET DP013-DB2-ABEND                                  27730099
277400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27740099
277500             PERFORM DP013-0000-PROCESS-ABEND                     27750099
277600         END-EVALUATE.                                            27760099
277700                                                                  27770099
277800                                                                  27780099
277900*----------------------------------------------------------------*27790099
278000* 2ND CONFIRM IF STORE IS TO BE ASSIGNED TO MULTIPLE DOORS.      *27800099
278100*----------------------------------------------------------------*27810099
278200 4394-STR-MLT-DR-CNFM.                                            27820099
278300                                                                  27830099
278400     ADD   1                TO  ASC-COUNT.                        27840099
278500     MOVE  ASC-COUNT        TO  PV-ZERO-SUP-VAR.                  27850099
278600     MOVE  PV-ZERO-SUP-VAR  TO  DP020-MSG-TEXT.                   27860099
278700                                                                  27870099
278800                                                                  27880099
278900                                                                  27890099
279000*----------------------------------------------------------------*27900099
279100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *27910099
279200*----------------------------------------------------------------*27920099
279300 4400-MOVE-COMMAREA-TO-SCREEN.                                    27930099
279400     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   27940099
279500     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   27950099
279600     MOVE ASC-DOOR-ID              TO ADOORIDO.                   27960099
279700     MOVE ASC-LOC-DESC             TO ALOCDSCO.                   27970099
279800     MOVE ASC-LANE-ASGNMT          TO ALANEASGO.                  27980099
279900     MOVE ASC-DIVERT-LOC           TO ADIVLOCO.                   27990099
280000     MOVE ASC-DOOR-TYPE-CODE       TO ADRTYPCO.                   28000099
280100     MOVE ASC-DOOR-TYPE-DESC       TO ADRTYDSO.                   28010099
280200     MOVE ASC-LABEL-SEQ            TO ALBLNBRO.                   28020099
280300     MOVE ASC-DEL1                 TO ADEL1O.                     28030099
280400     MOVE ASC-DEL2                 TO ADEL2O.                     28040099
280500     MOVE ASC-DEL3                 TO ADEL3O.                     28050099
280600     MOVE ASC-STNBR1               TO ASTNBR1O.                   28060099
280700     MOVE ASC-STNME1               TO ASTNME1O.                   28070099
280800     MOVE ASC-STNBR1A              TO ASTNBR1AO.                  28080099
280900     MOVE ASC-STNME1A              TO ASTNME1AO.                  28090099
281000     MOVE ASC-STNBR2               TO ASTNBR2O.                   28100099
281100     MOVE ASC-STNME2               TO ASTNME2O.                   28110099
281200     MOVE ASC-STNBR2A              TO ASTNBR2AO.                  28120099
281300     MOVE ASC-STNME2A              TO ASTNME2AO.                  28130099
281400     MOVE ASC-STNBR3               TO ASTNBR3O.                   28140099
281500     MOVE ASC-STNME3               TO ASTNME3O.                   28150099
281600     MOVE ASC-STNBR3A              TO ASTNBR3AO.                  28160099
281700     MOVE ASC-STNME3A              TO ASTNME3AO.                  28170099
281800     MOVE ASC-DATE1                TO ADATE1O.                    28180099
281900     MOVE ASC-TIME1                TO ATIME1O.                    28190099
282000     MOVE ASC-DATE2                TO ADATE2O.                    28200099
282100     MOVE ASC-TIME2                TO ATIME2O.                    28210099
282200     MOVE ASC-DATE3                TO ADATE3O.                    28220099
282300     MOVE ASC-TIME3                TO ATIME3O.                    28230099
282400                                                                  28240099
282500                                                                  28250099
282600******************************************************************28260099
282700** CHECK IF ALL CARTONS FOR FIRST STORE HAVE BEEN MANIFESTED      28270099
282800** DMH ADDED 4/7/08                                               28280099
282900******************************************************************28290099
283000 4500-CHECK-CRTN-MFST-1.                                          28300099
283100     IF  (ASC-DEL1  = 'Y')  OR                                    28310099
283200         (ASC-STNBR1-N > 0 AND ASC-STNBR1A > 0)                   28320099
283300         PERFORM 4510-CHECK-TSUCDOT-1                             28330099
283400     END-IF.                                                      28340099
283500                                                                  28350099
283600 4510-CHECK-TSUCDOT-1.                                            28360099
283700                                                                  28370099
283800     MOVE ASC-OPER-UNT-ID-N  TO  DK-OPER-UNT-ID                   28380099
283900     MOVE ASC-STNBR1-N       TO  SUOBTR-DEST-OPER-UNT-ID          28390099
284000                                                                  28400099
284100     EXEC SQL                                                     28410099
284200         SELECT MAX(A.END_DIVERT_TMST)                            28420099
284300          INTO :SUCDOT-END-DIVERT-TMST                            28430099
284400         FROM  TSUCDOT A                                          28440099
284500              ,TSUOBTR B                                          28450099
284600        WHERE A.DOOR_ID          = :ASC-DOOR-ID                   28460099
284700          AND A.OPER_UNT_ID      = :DK-OPER-UNT-ID                28470099
284800          AND A.OTBND_TRIP_ID    =  B.OTBND_TRIP_ID               28480099
284900          AND B.DEST_OPER_UNT_ID = :SUOBTR-DEST-OPER-UNT-ID       28490099
285000     END-EXEC                                                     28500099
285100                                                                  28510099
285200     EVALUATE TRUE                                                28520099
285300         WHEN SQLCODE = ZERO                                      28530099
285400              IF  SUCDOT-END-DIVERT-TMST = PC-DEFAULT-TIMESTAMP   28540099
285500                  SET  PS-NOT-ALL-CARTONS-MFST-1                  28550099
285600                       PS-ERROR                   TO  TRUE        28560099
285700              ELSE                                                28570099
285800                  PERFORM 4520-COUNT-DIVERTS-1                    28580099
285900              END-IF                                              28590099
286000                                                                  28600099
286100         WHEN SQLCODE = +100                                      28610099
286200         WHEN SQLCODE = -305                                      28620099
286300              CONTINUE                                            28630099
286400                                                                  28640099
286500         WHEN SQLWARN0 NOT = SPACES                               28650099
286600         WHEN SQLCODE < +0                                        28660099
286700         WHEN SQLCODE > +0                                        28670099
286800             MOVE DK-OPER-UNT-ID            TO PV-DISP-OPER       28680099
286900             MOVE SUOBTR-DEST-OPER-UNT-ID   TO PV-DISP-DEST       28690099
287000             MOVE SQLCODE                   TO PV-DISP-SQLCODE    28700099
287100             MOVE '4510-CHECK-TSUCDOT-1' TO DP013-PARAGRAPH       28710099
287200             MOVE 'CHECK FOR CARTONS NO MANIFESTED TO TRLR'       28720099
287300                                      TO DP013-MESSAGE-TEXT (1)   28730099
287400             STRING ' OPER:' PV-DISP-OPER                         28740099
287500                    ' DEST:' PV-DISP-DEST                         28750099
287600                    ' DOOR:' ASC-DOOR-ID DELIMITED BY SIZE        28760099
287700                                    INTO DP013-MESSAGE-TEXT (2)   28770099
287800             MOVE SQLCA        TO DP013-SQLCA                     28780099
287900             MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)        28790099
288000             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        28800099
288100             SET DP013-DB2-ABEND                                  28810099
288200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28820099
288300             PERFORM DP013-0000-PROCESS-ABEND                     28830099
288400         END-EVALUATE.                                            28840099
288500                                                                  28850099
288600                                                                  28860099
288700 4520-COUNT-DIVERTS-1.                                            28870099
288800     INITIALIZE ASC-DIVERT-COUNT                                  28880099
288900     MOVE ASC-STNBR1-N  TO  DK-STR-NBR                            28890099
289000                                                                  28900099
289100     EXEC SQL                                                     28910099
289200         SELECT COUNT(*)                                          28920099
289300          INTO :ASC-DIVERT-COUNT                                  28930099
289400         FROM  TSUCRDV A                                          28940099
289500        WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID               28950099
289600          AND A.DOOR_ID           = :ASC-DOOR-ID                  28960099
289700          AND A.DEST_OPER_UNT_ID  = :DK-STR-NBR                   28970099
289800          AND A.DIVERT_TMST       > :SUCDOT-END-DIVERT-TMST       28980099
289900          AND A.ACTV_CDE          = 'A'                           28990099
290000          AND A.DIVERT_TMST  IN                                   29000099
290100              (SELECT MAX(B.DIVERT_TMST)                          29010099
290200                 FROM TSUCRDV B                                   29020099
290300                WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID)          29030099
290400     END-EXEC                                                     29040099
290500                                                                  29050099
290600     EVALUATE TRUE                                                29060099
290700         WHEN SQLCODE = ZERO                                      29070099
290800              IF  ASC-DIVERT-COUNT > +0                           29080099
290900                  SET  PS-NOT-ALL-CARTONS-MFST-1                  29090099
291000                       PS-ERROR                   TO  TRUE        29100099
291100              END-IF                                              29110099
291200                                                                  29120099
291300         WHEN SQLWARN0 NOT = SPACES                               29130099
291400         WHEN SQLCODE < +0                                        29140099
291500         WHEN SQLCODE > +0                                        29150099
291600             MOVE '4520-COUNT-DIVERTS-1      ' TO DP013-PARAGRAPH 29160099
291700             MOVE 'COUNT DIVERTS NOT MANIFESTED  '                29170099
291800                                      TO DP013-MESSAGE-TEXT (1)   29180099
291900             MOVE SQLCA        TO DP013-SQLCA                     29190099
292000             MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)        29200099
292100             SET DP013-DB2-ABEND                                  29210099
292200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29220099
292300             PERFORM DP013-0000-PROCESS-ABEND                     29230099
292400         END-EVALUATE.                                            29240099
292500                                                                  29250099
292600                                                                  29260099
292700******************************************************************29270099
292800** CHECK IF ALL CARTONS FOR SECOND STORE HAVE BEEN MANIFESTED     29280099
292900** DMH ADDED 4/7/08                                               29290099
293000******************************************************************29300099
293100 4600-CHECK-CRTN-MFST-2.                                          29310099
293200     IF  (ASC-DEL2  = 'Y')  OR                                    29320099
293300         (ASC-STNBR2-N > 0 AND ASC-STNBR2A > 0)                   29330099
293400         PERFORM 4610-CHECK-TSUCDOT-2                             29340099
293500     END-IF.                                                      29350099
293600                                                                  29360099
293700 4610-CHECK-TSUCDOT-2.                                            29370099
293800                                                                  29380099
293900     MOVE ASC-OPER-UNT-ID-N  TO  DK-OPER-UNT-ID                   29390099
294000     MOVE ASC-STNBR2-N       TO  SUOBTR-DEST-OPER-UNT-ID          29400099
294100                                                                  29410099
294200     EXEC SQL                                                     29420099
294300         SELECT MAX(A.END_DIVERT_TMST)                            29430099
294400          INTO :SUCDOT-END-DIVERT-TMST                            29440099
294500         FROM  TSUCDOT A                                          29450099
294600              ,TSUOBTR B                                          29460099
294700        WHERE A.DOOR_ID          = :ASC-DOOR-ID                   29470099
294800          AND A.OPER_UNT_ID      = :DK-OPER-UNT-ID                29480099
294900          AND A.OTBND_TRIP_ID    =  B.OTBND_TRIP_ID               29490099
295000          AND B.DEST_OPER_UNT_ID = :SUOBTR-DEST-OPER-UNT-ID       29500099
295100     END-EXEC                                                     29510099
295200                                                                  29520099
295300     EVALUATE TRUE                                                29530099
295400         WHEN SQLCODE = ZERO                                      29540099
295500              IF  SUCDOT-END-DIVERT-TMST = PC-DEFAULT-TIMESTAMP   29550099
295600                  SET  PS-NOT-ALL-CARTONS-MFST-2                  29560099
295700                       PS-ERROR                   TO  TRUE        29570099
295800              ELSE                                                29580099
295900                  PERFORM 4620-COUNT-DIVERTS-2                    29590099
296000              END-IF                                              29600099
296100                                                                  29610099
296200         WHEN SQLCODE = +100                                      29620099
296300         WHEN SQLCODE = -305                                      29630099
296400              CONTINUE                                            29640099
296500                                                                  29650099
296600         WHEN SQLWARN0 NOT = SPACES                               29660099
296700         WHEN SQLCODE < +0                                        29670099
296800         WHEN SQLCODE > +0                                        29680099
296900             MOVE DK-OPER-UNT-ID            TO PV-DISP-OPER       29690099
297000             MOVE SUOBTR-DEST-OPER-UNT-ID   TO PV-DISP-DEST       29700099
297100             MOVE SQLCODE                   TO PV-DISP-SQLCODE    29710099
297200             MOVE '4610-CHECK-TSUCDOT-2' TO DP013-PARAGRAPH       29720099
297300             MOVE 'CHECK FOR CARTONS NO MANIFESTED TO TRLR'       29730099
297400                                      TO DP013-MESSAGE-TEXT (1)   29740099
297500             STRING ' OPER:' PV-DISP-OPER                         29750099
297600                    ' DEST:' PV-DISP-DEST                         29760099
297700                    ' DOOR:' ASC-DOOR-ID DELIMITED BY SIZE        29770099
297800                                    INTO DP013-MESSAGE-TEXT (2)   29780099
297900             MOVE SQLCA        TO DP013-SQLCA                     29790099
298000             MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)        29800099
298100             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        29810099
298200             SET DP013-DB2-ABEND                                  29820099
298300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29830099
298400             PERFORM DP013-0000-PROCESS-ABEND                     29840099
298500         END-EVALUATE.                                            29850099
298600                                                                  29860099
298700                                                                  29870099
298800 4620-COUNT-DIVERTS-2.                                            29880099
298900     INITIALIZE ASC-DIVERT-COUNT                                  29890099
299000     MOVE ASC-STNBR2-N  TO  DK-STR-NBR                            29900099
299100                                                                  29910099
299200     EXEC SQL                                                     29920099
299300         SELECT COUNT(*)                                          29930099
299400          INTO :ASC-DIVERT-COUNT                                  29940099
299500         FROM  TSUCRDV A                                          29950099
299600        WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID               29960099
299700          AND A.DOOR_ID           = :ASC-DOOR-ID                  29970099
299800          AND A.DEST_OPER_UNT_ID  = :DK-STR-NBR                   29980099
299900          AND A.DIVERT_TMST       > :SUCDOT-END-DIVERT-TMST       29990099
300000          AND A.ACTV_CDE          = 'A'                           30000099
300100          AND A.DIVERT_TMST  IN                                   30010099
300200              (SELECT MAX(B.DIVERT_TMST)                          30020099
300300                 FROM TSUCRDV B                                   30030099
300400                WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID)          30040099
300500     END-EXEC                                                     30050099
300600                                                                  30060099
300700     EVALUATE TRUE                                                30070099
300800         WHEN SQLCODE = ZERO                                      30080099
300900              IF  ASC-DIVERT-COUNT > +0                           30090099
301000                  SET  PS-NOT-ALL-CARTONS-MFST-2                  30100099
301100                       PS-ERROR                   TO  TRUE        30110099
301200              END-IF                                              30120099
301300                                                                  30130099
301400         WHEN SQLWARN0 NOT = SPACES                               30140099
301500         WHEN SQLCODE < +0                                        30150099
301600         WHEN SQLCODE > +0                                        30160099
301700             MOVE '4620-COUNT-DIVERTS-2      ' TO DP013-PARAGRAPH 30170099
301800             MOVE 'COUNT DIVERTS NOT MANIFESTED  '                30180099
301900                                      TO DP013-MESSAGE-TEXT (1)   30190099
302000             MOVE SQLCA        TO DP013-SQLCA                     30200099
302100             MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)        30210099
302200             SET DP013-DB2-ABEND                                  30220099
302300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30230099
302400             PERFORM DP013-0000-PROCESS-ABEND                     30240099
302500         END-EVALUATE.                                            30250099
302600                                                                  30260099
302700                                                                  30270099
302800******************************************************************30280099
302900** CHECK IF ALL CARTONS FOR THIRD STORE HAVE BEEN MANIFESTED      30290099
303000** DMH ADDED 4/7/08                                               30300099
303100******************************************************************30310099
303200 4700-CHECK-CRTN-MFST-3.                                          30320099
303300     IF  (ASC-DEL3  = 'Y')  OR                                    30330099
303400         (ASC-STNBR3-N > 0 AND ASC-STNBR3A > 0)                   30340099
303500         PERFORM 4710-CHECK-TSUCDOT-3                             30350099
303600     END-IF.                                                      30360099
303700                                                                  30370099
303800 4710-CHECK-TSUCDOT-3.                                            30380099
303900                                                                  30390099
304000     MOVE ASC-OPER-UNT-ID-N  TO  DK-OPER-UNT-ID                   30400099
304100     MOVE ASC-STNBR3-N       TO  SUOBTR-DEST-OPER-UNT-ID          30410099
304200                                                                  30420099
304300     EXEC SQL                                                     30430099
304400         SELECT MAX(A.END_DIVERT_TMST)                            30440099
304500          INTO :SUCDOT-END-DIVERT-TMST                            30450099
304600         FROM  TSUCDOT A                                          30460099
304700              ,TSUOBTR B                                          30470099
304800        WHERE A.DOOR_ID          = :ASC-DOOR-ID                   30480099
304900          AND A.OPER_UNT_ID      = :DK-OPER-UNT-ID                30490099
305000          AND A.OTBND_TRIP_ID    =  B.OTBND_TRIP_ID               30500099
305100          AND B.DEST_OPER_UNT_ID = :SUOBTR-DEST-OPER-UNT-ID       30510099
305200     END-EXEC                                                     30520099
305300                                                                  30530099
305400     EVALUATE TRUE                                                30540099
305500         WHEN SQLCODE = ZERO                                      30550099
305600              IF  SUCDOT-END-DIVERT-TMST = PC-DEFAULT-TIMESTAMP   30560099
305700                  SET  PS-NOT-ALL-CARTONS-MFST-3                  30570099
305800                       PS-ERROR                   TO  TRUE        30580099
305900              ELSE                                                30590099
306000                  PERFORM 4720-COUNT-DIVERTS-3                    30600099
306100              END-IF                                              30610099
306200                                                                  30620099
306300         WHEN SQLCODE = +100                                      30630099
306400         WHEN SQLCODE = -305                                      30640099
306500              CONTINUE                                            30650099
306600                                                                  30660099
306700         WHEN SQLWARN0 NOT = SPACES                               30670099
306800         WHEN SQLCODE < +0                                        30680099
306900         WHEN SQLCODE > +0                                        30690099
307000             MOVE DK-OPER-UNT-ID            TO PV-DISP-OPER       30700099
307100             MOVE SUOBTR-DEST-OPER-UNT-ID   TO PV-DISP-DEST       30710099
307200             MOVE SQLCODE                   TO PV-DISP-SQLCODE    30720099
307300             MOVE '4710-CHECK-TSUCDOT-3' TO DP013-PARAGRAPH       30730099
307400             MOVE 'CHECK FOR CARTONS NO MANIFESTED TO TRLR'       30740099
307500                                      TO DP013-MESSAGE-TEXT (1)   30750099
307600             STRING ' OPER:' PV-DISP-OPER                         30760099
307700                    ' DEST:' PV-DISP-DEST                         30770099
307800                    ' DOOR:' ASC-DOOR-ID DELIMITED BY SIZE        30780099
307900                                    INTO DP013-MESSAGE-TEXT (2)   30790099
308000             MOVE SQLCA        TO DP013-SQLCA                     30800099
308100             MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)        30810099
308200             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        30820099
308300             SET DP013-DB2-ABEND                                  30830099
308400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30840099
308500             PERFORM DP013-0000-PROCESS-ABEND                     30850099
308600         END-EVALUATE.                                            30860099
308700                                                                  30870099
308800                                                                  30880099
308900 4720-COUNT-DIVERTS-3.                                            30890099
309000     INITIALIZE ASC-DIVERT-COUNT                                  30900099
309100     MOVE ASC-STNBR3-N  TO  DK-STR-NBR                            30910099
309200                                                                  30920099
309300     EXEC SQL                                                     30930099
309400         SELECT COUNT(*)                                          30940099
309500          INTO :ASC-DIVERT-COUNT                                  30950099
309600         FROM  TSUCRDV A                                          30960099
309700        WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID               30970099
309800          AND A.DOOR_ID           = :ASC-DOOR-ID                  30980099
309900          AND A.DEST_OPER_UNT_ID  = :DK-STR-NBR                   30990099
310000          AND A.DIVERT_TMST       > :SUCDOT-END-DIVERT-TMST       31000099
310100          AND A.ACTV_CDE          = 'A'                           31010099
310200          AND A.DIVERT_TMST  IN                                   31020099
310300              (SELECT MAX(B.DIVERT_TMST)                          31030099
310400                 FROM TSUCRDV B                                   31040099
310500                WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID)          31050099
310600     END-EXEC                                                     31060099
310700                                                                  31070099
310800     EVALUATE TRUE                                                31080099
310900         WHEN SQLCODE = ZERO                                      31090099
311000              IF  ASC-DIVERT-COUNT > +0                           31100099
311100                  SET  PS-NOT-ALL-CARTONS-MFST-3                  31110099
311200                       PS-ERROR                   TO  TRUE        31120099
311300              END-IF                                              31130099
311400                                                                  31140099
311500         WHEN SQLWARN0 NOT = SPACES                               31150099
311600         WHEN SQLCODE < +0                                        31160099
311700         WHEN SQLCODE > +0                                        31170099
311800             MOVE '4720-COUNT-DIVERTS-3      ' TO DP013-PARAGRAPH 31180099
311900             MOVE 'COUNT DIVERTS NOT MANIFESTED  '                31190099
312000                                      TO DP013-MESSAGE-TEXT (1)   31200099
312100             MOVE SQLCA        TO DP013-SQLCA                     31210099
312200             MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)        31220099
312300             SET DP013-DB2-ABEND                                  31230099
312400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31240099
312500             PERFORM DP013-0000-PROCESS-ABEND                     31250099
312600         END-EVALUATE.                                            31260099
312700                                                                  31270099
312800                                                                  31280099
312900******************************************************************31290099
313000** UPDATE A ROW ON THE DOOR TO STORE TABLE                        31300099
313100******************************************************************31310099
313200 5000-UPDATE-TCNDRST.                                             31320099
313300     MOVE ASC-OPER-UNT-ID-N  TO DK-OPER-UNT-ID.                   31330099
313400     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       31340099
313500                                                                  31350099
313600     EXEC SQL                                                     31360099
313700         UPDATE TCNDRST                                           31370099
313800           SET                                                    31380099
313900              END_TMST       = CURRENT TIMESTAMP                  31390099
314000             ,CRE_USR_ID     = :DP020-USERID                      31400099
314100        WHERE OPER_UNT_ID        = :DK-OPER-UNT-ID                31410099
314200          AND DOOR_ID            = :DK-DOOR-ID                    31420099
314300          AND STR_NBR            = :DK-STR-NBR                    31430099
314400          AND END_TMST           = :PC-DEFAULT-TIMESTAMP          31440099
314500     END-EXEC                                                     31450099
314600                                                                  31460099
314700     EVALUATE TRUE                                                31470099
314800         WHEN SQLCODE = +0                                        31480099
314900         WHEN SQLCODE = -904                                      31490099
315000         WHEN SQLCODE = -913                                      31500099
315100             CONTINUE                                             31510099
315200         WHEN SQLWARN0 NOT = SPACES                               31520099
315300         WHEN SQLCODE < +0                                        31530099
315400         WHEN SQLCODE > +0                                        31540099
315500             MOVE '5000-UPDATE-TCNDRST' TO DP013-PARAGRAPH        31550099
315600             MOVE 'ERROR UPDATING DOOR-TO-STORE TBL'              31560099
315700                                        TO DP013-MESSAGE-TEXT (1) 31570099
315800             MOVE SQLCA        TO DP013-SQLCA                     31580099
315900             MOVE 'TCNDRST'    TO DP013-DB2-TABLE-NAME (1)        31590099
316000             SET DP013-DB2-ABEND                                  31600099
316100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31610099
316200             PERFORM DP013-0000-PROCESS-ABEND                     31620099
316300     END-EVALUATE.                                                31630099
316400                                                                  31640099
316500******************************************************************31650099
316600** INSERT A ROW ON THE DOOR TO STORE TABLE                        31660099
316700******************************************************************31670099
316800 5500-INSERT-TCNDRST.                                             31680099
316900     MOVE ASC-OPER-UNT-ID-N  TO DK-OPER-UNT-ID.                   31690099
317000     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       31700099
317100                                                                  31710099
317200     EXEC SQL                                                     31720099
317300         INSERT                                                   31730099
317400           INTO TCNDRST                                           31740099
317500              (OPER_UNT_ID                                        31750099
317600               ,DOOR_ID                                           31760099
317700               ,STR_NBR                                           31770099
317800               ,STRT_TMST                                         31780099
317900               ,END_TMST                                          31790099
318000               ,CRE_USR_ID)                                       31800099
318100           VALUES                                                 31810099
318200              (:DK-OPER-UNT-ID                                    31820099
318300               ,:DK-DOOR-ID                                       31830099
318400               ,:DK-STR-NBR                                       31840099
318500               ,CURRENT TIMESTAMP                                 31850099
318600               ,:PC-DEFAULT-TIMESTAMP                             31860099
318700               ,:DP020-USERID)                                    31870099
318800     END-EXEC                                                     31880099
318900                                                                  31890099
319000     EVALUATE TRUE                                                31900099
319100         WHEN SQLCODE = +0                                        31910099
319200         WHEN SQLCODE = -904                                      31920099
319300         WHEN SQLCODE = -913                                      31930099
319400             CONTINUE                                             31940099
319500         WHEN SQLWARN0 NOT = SPACES                               31950099
319600         WHEN SQLCODE < +0                                        31960099
319700         WHEN SQLCODE > +0                                        31970099
319800             MOVE '5500-INSERT-TCNDRST' TO DP013-PARAGRAPH        31980099
319900             MOVE 'ERROR INSERTING DOOR-TO-STORE TBL'             31990099
320000                                        TO DP013-MESSAGE-TEXT (1) 32000099
320100             MOVE SQLCA        TO DP013-SQLCA                     32010099
320200             MOVE 'TCNDRST'    TO DP013-DB2-TABLE-NAME (1)        32020099
320300             SET DP013-DB2-ABEND                                  32030099
320400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32040099
320500             PERFORM DP013-0000-PROCESS-ABEND                     32050099
320600     END-EVALUATE.                                                32060099
320700                                                                  32070099
320800*----------------------------------------------------------------*32080099
320900* CLEAR SCREEN BEFORE REBUILDING                                  32090099
321000*----------------------------------------------------------------*32100099
321100 5600-CLEAR-SCREEN.                                               32110099
321200     MOVE SPACES       TO  ASC-DEL1                               32120099
321300                           ASC-DATE1                              32130099
321400                           ASC-TIME1                              32140099
321500                           ASC-STNBR1                             32150099
321600                           ASC-STNME1                             32160099
321700                           ASC-STNBR1A                            32170099
321800                           ASC-STNME1A                            32180099
321900                           ASC-DEL2                               32190099
322000                           ASC-DATE2                              32200099
322100                           ASC-TIME2                              32210099
322200                           ASC-STNBR2                             32220099
322300                           ASC-STNME2                             32230099
322400                           ASC-STNBR2A                            32240099
322500                           ASC-STNME2A                            32250099
322600                           ASC-DEL3                               32260099
322700                           ASC-DATE3                              32270099
322800                           ASC-TIME3                              32280099
322900                           ASC-STNBR3                             32290099
323000                           ASC-STNME3                             32300099
323100                           ASC-STNBR3A                            32310099
323200                           ASC-STNME3A.                           32320099
323300/                                                                 32330099
323400 7000-COUNT-OPEN-TRLRS.                                           32340099
323410     MOVE  ASC-OPER-UNT-ID  TO  SUOBTR-ORGN-OPER-UNT-ID.          32341099
323500     EXEC SQL                                                     32350099
323600         SELECT COUNT(*)                                          32360099
323700         INTO :PV-TRLR-COUNT                                      32370099
323800         FROM                                                     32380099
323900             TSUOBTR BTR                                          32390099
324000           , TSUOBTS BTS                                          32400099
324100         WHERE                                                    32410099
324200             BTR.OTBND_TRIP_ID = BTS.OTBND_TRIP_ID                32420099
324210         AND BTR.ORGN_OPER_UNT_ID = :SUOBTR-ORGN-OPER-UNT-ID      32421099
324300         AND BTR.DEST_OPER_UNT_ID IN (                            32430099
324400                                  :DK-STR-NBR1                    32440099
324500                                , :DK-STR-NBR2                    32450099
324600                                , :DK-STR-NBR3                    32460099
324700                                     )                            32470099
324800         AND BTS.TRIP_STAT_CDE IN ('DO', 'AO')                    32480099
324900         AND BTS.DOOR_ID = :ASC-DOOR-ID                           32490099
325000         AND                                                      32500099
325100             BTS.OTBND_STAT_TMST =                                32510099
325200             (SELECT                                              32520099
325300                 MAX(BTS1.OTBND_STAT_TMST)                        32530099
325400                 FROM TSUOBTS BTS1                                32540099
325500                 WHERE                                            32550099
325600                 BTS1.OTBND_TRIP_ID = BTR.OTBND_TRIP_ID           32560099
325700                   )                                              32570099
325800     END-EXEC.                                                    32580099
325900                                                                  32590099
326000        EVALUATE TRUE                                             32600099
326100            WHEN SQLCODE = +0                                     32610099
326200                CONTINUE                                          32620099
326300            WHEN SQLCODE = -305                                   32630099
326400            WHEN SQLCODE = +100                                   32640099
326500                CONTINUE                                          32650099
326600            WHEN SQLWARN0 NOT = SPACES                            32660099
326700            WHEN SQLCODE < +0                                     32670099
326800            WHEN SQLCODE > +0                                     32680099
326900                MOVE '7000-COUNT-OPEN-TRLRS'                      32690099
327000                                          TO DP013-PARAGRAPH      32700099
327100                MOVE 'COUNTING OPEN TRAILERS AT DOOR'             32710099
327200                                    TO DP013-MESSAGE-TEXT (1)     32720099
327300                MOVE SQLCA      TO DP013-SQLCA                    32730099
327400                MOVE 'TSUOBTR'  TO DP013-DB2-TABLE-NAME (1)       32740099
327500                MOVE 'TSUOBTS'  TO DP013-DB2-TABLE-NAME (2)       32750099
327600                SET DP013-DB2-ABEND                               32760099
327700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            32770099
327800                PERFORM DP013-0000-PROCESS-ABEND                  32780099
327900        END-EVALUATE.                                             32790099
328000/                                                                 32800099
328100*----------------------------------------------------------------*32810099
328200* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *32820099
328300*----------------------------------------------------------------*32830099
328400 9100-READ-SEL-QUEUE.                                             32840099
328500     EXEC CICS                                                    32850099
328600         READQ TS                                                 32860099
328700             QUEUE (ASC-SEL-QUEUE-NAME)                           32870099
328800             INTO  (CN013-SELECT-RECORD)                          32880099
328900             ITEM  (ASC-SEL-ITEM)                                 32890099
329000             RESP  (PV-CICS-RESPONSE)                             32900099
329100     END-EXEC.                                                    32910099
329200                                                                  32920099
329300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       32930099
329400         CONTINUE                                                 32940099
329500     ELSE                                                         32950099
329600         SET DP013-LOGIC-ABEND                                    32960099
329700             DP013-NO-ROLLBACK     TO TRUE                        32970099
329800         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            32980099
329900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   32990099
330000                                   TO DP013-MESSAGE-TEXT (1)      33000099
330100         PERFORM DP013-0000-PROCESS-ABEND                         33010099
330200     END-IF.                                                      33020099
330300                                                                  33030099
330400*----------------------------------------------------------------*33040099
330500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *33050099
330600*----------------------------------------------------------------*33060099
330700 9200-REWRITE-SEL-QUEUE.                                          33070099
330800     EXEC CICS                                                    33080099
330900          WRITEQ TS                                               33090099
331000              QUEUE  (ASC-SEL-QUEUE-NAME)                         33100099
331100              FROM   (CN013-SELECT-RECORD)                        33110099
331200              ITEM   (ASC-SEL-ITEM)                               33120099
331300              RESP   (PV-CICS-RESPONSE)                           33130099
331400              REWRITE                                             33140099
331500     END-EXEC.                                                    33150099
331600                                                                  33160099
331700     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   33170099
331800         SET DP013-CICS-ABEND                                     33180099
331900             DP013-NO-ROLLBACK     TO TRUE                        33190099
332000         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        33200099
332100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33210099
332200                                   TO DP013-MESSAGE-TEXT (1)      33220099
332300         PERFORM DP013-0000-PROCESS-ABEND                         33230099
332400     END-IF.                                                      33240099
332500                                                                  33250099
332600     COPY DPPD013.                                                33260099
332700*----------------------------------------------------------------*33270099
332800*    ABEND PROCESSOR MODULE                                      *33280099
332900*----------------------------------------------------------------*33290099
