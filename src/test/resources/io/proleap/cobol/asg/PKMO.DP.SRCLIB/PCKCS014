000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MARKING APRON RTV PAGES'.                                 00020000
000300 PROGRAM-ID.             PCKCS014.                                00030000
000400 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           FEBRUARY, 1997.                          00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900*    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00090000
001000*    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00100000
001100*    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00110000
001200*    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00120000
001300*    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00130000
001400*    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00140000
001500*    VALUE OF THE CARRIAGE CONTROL.                               00150000
001600                                                                  00160000
001700******************************************************************00170000
001800* THIS PROGRAM PRODUCES THE WORK ORDER DISTRIBUTION SHEET.        00180000
001900******************************************************************00190000
002000                                                                  00200000
002100******************************************************************00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300******************************************************************00230000
002400                                                                  00240000
002500******************************************************************00250000
002600 DATA DIVISION.                                                   00260000
002700******************************************************************00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100******************************************************************00310000
003200                                                                  00320000
003300*                                                                 00330000
003400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00340000
003500*                                                                 00350000
003600     COPY DFHAID.                                                 00360000
003700                                                                  00370000
003800*                                                                 00380000
003900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00390000
004000*                                                                 00400000
004100     COPY DPWS013.                                                00410000
004200 EJECT                                                            00420000
004300*                                                                 00430000
004400*                                                                 00440000
004500*  LAYOUT FOR THE PRINT PACKAGE COMMAND WORKING STORAGE           00450000
004600*                                                                 00460000
004700     COPY DSWS004.                                                00470000
004800 EJECT                                                            00480000
004900*                                                                 00490000
005000*----------------------------------------------------------------*00500000
005100*  LAYOUT FOR THE LOGISTICS DOMAIN ITEM ACCESS MODULE             00510000
005200*----------------------------------------------------------------*00520000
005300     COPY XLWS001.                                                00530000
005400*                                                                 00540000
005500 EJECT                                                            00550000
005600*                                                                 00560000
005700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00570000
005800*  DISTRIBUTION TABLE.                                            00580000
005900*                                                                 00590000
006000     EXEC SQL                                                     00600000
006100          INCLUDE TRECDIS                                         00610000
006200     END-EXEC.                                                    00620000
006300 EJECT                                                            00630000
006400*                                                                 00640000
006500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00650000
006600*  TABLE.                                                         00660000
006700*                                                                 00670000
006800     EXEC SQL                                                     00680000
006900          INCLUDE TRECITM                                         00690000
007000     END-EXEC.                                                    00700000
007100 EJECT                                                            00710000
007200******************************************************************00720000
007300* DCLGEN OF XLT_LOC                                               00730000
007400******************************************************************00740000
007500*                                                                 00750000
007600     EXEC SQL                                                     00760000
007700         INCLUDE XLT00010                                         00770000
007800     END-EXEC.                                                    00780000
007900******************************************************************00790000
008000* DCLGEN OF XLT_DC_LOC_ASGMT                                      00800000
008100******************************************************************00810000
008200*                                                                 00820000
008300     EXEC SQL                                                     00830000
008400         INCLUDE XLT00014                                         00840000
008500     END-EXEC.                                                    00850000
008600 EJECT                                                            00860000
008700*                                                                 00870000
008800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     00880000
008900*                                                                 00890000
009000     EXEC SQL                                                     00900000
009100         INCLUDE TRECEIV                                          00910000
009200     END-EXEC.                                                    00920000
009300 EJECT                                                            00930000
009400*                                                                 00940000
009500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP PO TABLE      00950000
009600*                                                                 00960000
009700     EXEC SQL                                                     00970000
009800         INCLUDE TSHPTPO                                          00980000
009900     END-EXEC.                                                    00990000
010000*                                                                 01000000
010100*                                                                 01010000
010200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT TABLE     01020000
010300*                                                                 01030000
010400     EXEC SQL                                                     01040000
010500         INCLUDE TSHIPMT                                          01050000
010600     END-EXEC.                                                    01060000
010700 EJECT                                                            01070000
010800*                                                                 01080000
010900*                                                                 01090000
011000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VEHICLE TRIP       01100000
011100*                                                                 01110000
011200     EXEC SQL                                                     01120000
011300         INCLUDE TVHTRIP                                          01130000
011400     END-EXEC.                                                    01140000
011500 EJECT                                                            01150000
011600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  01160000
011700*                                                                 01170000
011800     EXEC SQL                                                     01180000
011900          INCLUDE TSTATCD                                         01190000
012000     END-EXEC.                                                    01200000
012100 EJECT                                                            01210000
012800 EJECT                                                            01220000
012900*                                                                 01230000
013000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01240000
013100*  HEADER TABLE                                                   01250000
013200*                                                                 01260000
013300     EXEC SQL                                                     01270000
013400          INCLUDE TPURCHS                                         01280000
013500     END-EXEC.                                                    01290000
013600 EJECT                                                            01300000
013700*                                                                 01310000
013800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01320000
013900*  ITEM TABLE                                                     01330000
014000*                                                                 01340000
014100     EXEC SQL                                                     01350000
014200          INCLUDE TPURITM                                         01360000
014300     END-EXEC.                                                    01370000
014400 EJECT                                                            01380000
014500*                                                                 01390000
014600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    01400000
014700*  TABLE.                                                         01410000
014800*                                                                 01420000
014900     EXEC SQL                                                     01430000
015000          INCLUDE TENTNME                                         01440000
015100     END-EXEC.                                                    01450000
015200 EJECT                                                            01460000
015300*                                                                 01470000
015400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01480000
015500*  INSTRUCTIONS TABLE                                             01490000
015600*                                                                 01500000
015700     EXEC SQL                                                     01510000
015800          INCLUDE TPOINST                                         01520000
015900     END-EXEC.                                                    01530000
016000 EJECT                                                            01540000
016100*                                                                 01550000
016200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01560000
016300*  INSTRUCTIONS CODE TABLE                                        01570000
016400*                                                                 01580000
016500     EXEC SQL                                                     01590000
016600          INCLUDE TINSTCD                                         01600000
016700     END-EXEC.                                                    01610000
016800 EJECT                                                            01620000
016900*                                                                 01630000
017000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORK ORDER         01640000
017100*  INSTRUCTIONS TABLE                                             01650000
017200*                                                                 01660000
017300     EXEC SQL                                                     01670000
017400          INCLUDE TWKORIN                                         01680000
017500     END-EXEC.                                                    01690000
017600/                                                                 01700000
017700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01710000
017800*  NOTIFICATION TABLE                                             01720000
017900*                                                                 01730000
018000     EXEC SQL                                                     01740000
018100          INCLUDE TTRBNTF                                         01750000
018200     END-EXEC.                                                    01760000
018300                                                                  01770000
018400*                                                                 01780000
018500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            01790000
018600*  REASON CODE TABLE                                              01800000
018700*                                                                 01810000
018800     EXEC SQL                                                     01820000
018900          INCLUDE TTRBRSN                                         01830000
019000     END-EXEC.                                                    01840000
019100 EJECT                                                            01850000
019600*                                                                 01860000
019700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET FORMAT      01870000
019800*  TABLE                                                          01880000
019900*                                                                 01890000
020000     EXEC SQL                                                     01900000
020100          INCLUDE TTKTFMT                                         01910000
020200     END-EXEC.                                                    01920000
020300 EJECT                                                            01930000
020400*                                                                 01940000
020500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PRETICKET REQUEST  01950000
020600*  TABLE                                                          01960000
020700*                                                                 01970000
020800     EXEC SQL                                                     01980000
020900          INCLUDE TPTKREQ                                         01990000
021000     END-EXEC.                                                    02000000
021100 EJECT                                                            02010000
021200*                                                                 02020000
021300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET LINE ITEM   02030000
021400*  TABLE                                                          02040000
021500*                                                                 02050000
021600     EXEC SQL                                                     02060000
021700          INCLUDE TPTKLNE                                         02070000
021800     END-EXEC.                                                    02080000
021900 EJECT                                                            02090000
022000*                                                                 02100000
022100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET PLACEMENT   02110000
022200*  DESCRIPTION TABLE                                              02120000
022300*                                                                 02130000
022400     EXEC SQL                                                     02140000
022500          INCLUDE TPLDESC                                         02150000
022600     END-EXEC.                                                    02160000
022700 EJECT                                                            02170000
022800 EJECT                                                            02180000
022900*----------------------------------------------------------------*02190000
023000*    DB2 DCLGEN FOR THE TMDSEAR TABLE                             02200000
023100*----------------------------------------------------------------*02210000
023200     EXEC SQL                                                     02220000
023300          INCLUDE TMDSEAR                                         02230000
023400     END-EXEC.                                                    02240000
023500/                                                                 02250000
023600/                                                                 02260000
023700*----------------------------------------------------------------*02270000
023800*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             02280000
023900*----------------------------------------------------------------*02290000
024000*    EXEC SQL                                                     02300000
024100*         INCLUDE TDCVSVL                                         02310000
024200*    END-EXEC.                                                    02320000
024300/                                                                 02330000
024400*----------------------------------------------------------------*02340000
024500*    DB2 DCLGEN FOR THE TVSCHVL TABLE                             02350000
024600*----------------------------------------------------------------*02360000
024700*    EXEC SQL                                                     02370000
024800*         INCLUDE TVSCHVL                                         02380000
024900*    END-EXEC.                                                    02390000
025000/                                                                 02400000
025100*----------------------------------------------------------------*02410000
025200*    DB2 DCLGEN FOR THE TVNDSTL TABLE                             02420000
025300*----------------------------------------------------------------*02430000
025400*    EXEC SQL                                                     02440000
025500*         INCLUDE TVNDSTL                                         02450000
025600*    END-EXEC.                                                    02460000
025700/                                                                 02470000
025800*----------------------------------------------------------------*02480000
025900*    DB2 DCLGEN FOR THE TMDARVS TABLE                             02490000
026000*----------------------------------------------------------------*02500000
026100     EXEC SQL                                                     02510000
026200          INCLUDE TMDARVS                                         02520000
026300     END-EXEC.                                                    02530000
026400*                                                                 02540000
026500*  COMMUNICATIONS AREA FOR DB2                                    02550000
026600*                                                                 02560000
026700     EXEC SQL                                                     02570000
026800         INCLUDE SQLCA                                            02580000
026900     END-EXEC.                                                    02590000
027000 EJECT                                                            02600000
027800*---------------------------------------------------------------* 02610000
027900*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02620000
028000*---------------------------------------------------------------* 02630000
028100 01  CA-COMMAREA.                                                 02640000
028200     05  CA-WRK-ORD-KEY-X.                                        02650000
028300         10  CA-ORD-NBR-X                PIC  X(08)  VALUE SPACE. 02660000
028400         10  CA-ORD-NBR  REDEFINES  CA-ORD-NBR-X                  02670000
028500                                         PIC  9(08).              02680000
028600         10  CA-RCVR-SEQ-NBR-X           PIC  X(03)  VALUE SPACE. 02690000
028700         10  CA-RCVR-SEQ-NBR  REDEFINES  CA-RCVR-SEQ-NBR-X        02700000
028800                                         PIC  9(03).              02710000
028900         10  CA-ORD-LNE-NBR-X            PIC  X(04)  VALUE SPACE. 02720000
029000         10  CA-ORD-LNE-NBR  REDEFINES  CA-ORD-LNE-NBR-X          02730000
029100                                         PIC  9(04).              02740000
029200         10  CA-WORK-ORD-SEQ-NBR-X       PIC  X(03)  VALUE SPACE. 02750000
029300         10  CA-WORK-ORD-SEQ-NBR  REDEFINES  CA-WORK-ORD-SEQ-NBR-X02760000
029400                                         PIC  9(03).              02770000
029500     05  CA-DESTINATION                  PIC  X(08)  VALUE SPACE. 02780000
029600     05  CA-PREPAIRER-USER-ID            PIC  X(08)  VALUE SPACE. 02790000
029700     05  CA-OPER-UNT-ID                  PIC  X(04)  VALUE SPACE. 02800000
029800     05  CA-OPER-UNT-ID-N REDEFINES  CA-OPER-UNT-ID               02810000
029900                                         PIC  9(04).              02820000
030000     05  CA-FCLTY-ID                     PIC  X(04)  VALUE SPACE. 02830000
030100     05  CA-FCLTY-ID-N REDEFINES  CA-FCLTY-ID                     02840000
030200                                         PIC  9(04).              02850000
030300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02860000
030400     05  CA-PRTR-AUTO-CUTTER-IND         PIC  X(01)  VALUE SPACE. 02870000
030500     05  CA-PRTR-PRTR-BRCDE-IND          PIC  X(01)  VALUE SPACE. 02880000
030600     05  CA-PRTR-PRTR-CNTL-IND           PIC  X(01)  VALUE SPACE. 02890000
030700     05  CA-PRINT-PACKAGE-IND            PIC  X(01)  VALUE SPACE. 02900000
030800     05  CA-LINES-PER-INCH               PIC  X(03)  VALUE SPACE. 02910000
030900     05  FILLER                          PIC  X(08)  VALUE SPACE. 02920000
031000     05  CA-SEL-QUEUE-NAME.                                       02930000
031100         10  FILLER                      PIC X(4).                02940000
031200         10  CA-QUEUE-TASK               PIC S9(5) COMP-3.        02950000
031300         10  FILLER                      PIC X(1).                02960000
031400     05  FILLER                          PIC  X(04)  VALUE SPACE. 02970000
031500     05  CA-DRIB-AREA                    PIC X(480).              02980000
031600     05  CA-LINE-TABLE.                                           02990000
031700         10  CA-LINE-ENTRY OCCURS 999 TIMES INDEXED BY            03000000
031800                                            LINE-IDX.             03010000
031900             15  CA-LINE-NBR             PIC S9(4) COMP.          03020000
032000*                                                                 03030000
032100 01  DK-DB2-KEYS.                                                 03040000
032200     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  03050000
032300                                                     COMP.        03060000
032400     05  DK-RCVR-SEQ-NBR                 PIC S9(09)  VALUE ZEROS  03070000
032500                                                     COMP.        03080000
032600     05  DK-ORD-LNE-NBR                  PIC S9(04)  VALUE ZEROS  03090000
032700                                                     COMP.        03100000
032800     05  DK-WORK-ORD-SEQ-NBR             PIC S9(04)  VALUE ZEROS  03110000
032900                                                     COMP.        03120000
033000     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  03130000
033100                                                     COMP.        03140000
033200     05  DK-OPER-UNT-ID-TALL             PIC S9(04)  VALUE ZEROS  03150000
033300                                                     COMP.        03160000
033400     05  DK-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  03170000
033500                                                     COMP.        03180000
033600     05  DK-STR-NBR                      PIC S9(04)  VALUE ZEROS  03190000
033700                                                     COMP.        03200000
033800     05  DK-TKT-FMT-ID                PIC X(06)    VALUE SPACES.  03210000
033900     05  DK-VS-ID                     PIC S9(09)   COMP VALUE +0. 03220000
034000     05  DK-HNG-TYP-SEQ-NBR           PIC S9(4)    COMP VALUE +0. 03230000
034100     05  DK-MDSEAR-ID                 PIC S9(9)    COMP VALUE +0. 03240000
034200     05  DK-ENT-ID                    PIC S9(09)   COMP VALUE +0. 03250000
034300     05  DK-DEPT-NBR                  PIC X(03)    VALUE SPACES.  03260000
034400     05  DK-SUBCLASS-NBR              PIC X(03)    VALUE SPACE.   03270000
034500     05  DK-MAJCLASS-NBR              PIC X(02)    VALUE SPACE.   03280000
034600     05  DK-AGRMT-TYP-ID              PIC X(01)    VALUE SPACES.  03290000
034700     05  DK-TYP-CDE                   PIC S9(04)   VALUE +0       03300000
034800                                                   COMP.          03310000
034900     05  DK-PREPK-ID                  PIC S9(04)  VALUE ZEROS     03320000
035000                                                     COMP.        03330000
035100     COPY DPWS020.                                                03340000
035200*                                                                 03350000
035300 01  TL1-TROUBLE-LINE-1.                                          03360000
035400     05  FILLER                          PIC X(19)   VALUE        03370000
035500         'T R O U B L E  **  '.                                   03380000
035600     05  FILLER                          PIC X(19)   VALUE        03390000
035700         'T R O U B L E  **  '.                                   03400000
035800     05  FILLER                          PIC X(19)   VALUE        03410000
035900         'T R O U B L E  **  '.                                   03420000
036000     05  FILLER                          PIC X(19)   VALUE        03430000
036100         'T R O U B L E  **  '.                                   03440000
036200     05  FILLER                          PIC X(19)   VALUE        03450000
036300         'T R O U B L E  **  '.                                   03460000
036400     05  FILLER                          PIC X(19)   VALUE        03470000
036500         'T R O U B L E  **  '.                                   03480000
036600     05  FILLER                          PIC X(18)   VALUE        03490000
036700         'T R O U B L E  ** '.                                    03500000
036800*                                                                 03510000
036900 01  TL2-TROUBLE-LINE-2.                                          03520000
037000     05  TL2-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            03530000
037100                                            TRBL-IDX.             03540000
037200         10  FILLER                      PIC X(06)   VALUE SPACES.03550000
037300         10  TL2-TRBL-DESC               PIC X(20).               03560000
037400     05  FILLER                          PIC X(02)   VALUE SPACES.03570000
037500*                                                                 03580000
037600 01  TL3-TROUBLE-LINE-3.                                          03590000
037700     05  TL3-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            03600000
037800                                            TRBL-IDX2.            03610000
037900         10  FILLER                      PIC X(04)   VALUE SPACES.03620000
038000         10  TL3-TRBL-IND                PIC X(01)   VALUE SPACES.03630000
038100         10  TL3-DASH                    PIC X(01)   VALUE SPACES.03640000
038200         10  TL3-TRBL-DESC               PIC X(20).               03650000
038300     05  FILLER                          PIC X(02)   VALUE SPACES.03660000
038400*                                                                 03670000
038500 01  RL1-REPRINT-LINE-1.                                          03680000
038600     05  FILLER                          PIC X(19)   VALUE        03690000
038700         'R E P R I N T  **  '.                                   03700000
038800     05  FILLER                          PIC X(19)   VALUE        03710000
038900         'R E P R I N T  **  '.                                   03720000
039000     05  FILLER                          PIC X(19)   VALUE        03730000
039100         'R E P R I N T  **  '.                                   03740000
039200     05  FILLER                          PIC X(19)   VALUE        03750000
039300         'R E P R I N T  **  '.                                   03760000
039400     05  FILLER                          PIC X(19)   VALUE        03770000
039500         'R E P R I N T  **  '.                                   03780000
039600     05  FILLER                          PIC X(19)   VALUE        03790000
039700         'R E P R I N T  **  '.                                   03800000
039800     05  FILLER                          PIC X(18)   VALUE        03810000
039900         'R E P R I N T  ** '.                                    03820000
040000                                                                  03830000
040100 01  RT1-RTV-DISTRO-LINE-1.                                       03840000
040200     05  FILLER                          PIC X(38)   VALUE        03850000
040300         'R T V   D I S T R I B U T I O N   **  '.                03860000
040400     05  FILLER                          PIC X(38)   VALUE        03870000
040500         'R T V   D I S T R I B U T I O N   **  '.                03880000
040600     05  FILLER                          PIC X(38)   VALUE        03890000
040700         'R T V   D I S T R I B U T I O N   **  '.                03900000
040800     05  FILLER                          PIC X(18)  VALUE SPACE.  03910000
040900*                                                                 03920000
041000 01  HL1-HEADING-LINE-1.                                          03930000
041100     05  FILLER                          PIC X(02)   VALUE SPACE. 03940000
041200     05  HL1-RUN-DATE.                                            03950000
041300         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  03960000
041400         10  FILLER                      PIC  X(01)  VALUE '/'.   03970000
041500         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  03980000
041600         10  FILLER                      PIC  X(01)  VALUE '/'.   03990000
041700         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  04000000
041800     05  FILLER                          PIC  X(02)  VALUE SPACE. 04010000
041900     05  HL1-RUN-TIME.                                            04020000
042000         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  04030000
042100         10  FILLER                      PIC  X(01)  VALUE ':'.   04040000
042200         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  04050000
042300     05  FILLER                          PIC  X(24)  VALUE SPACE. 04060000
042400     05  HL1-RPT-HDR                     PIC  X(46)  VALUE SPACE. 04070000
042500     05  FILLER                          PIC  X(20)  VALUE SPACE. 04080000
042600     05  HL1-PROGRAM-NAME                PIC  X(08)  VALUE SPACE. 04090000
042700     05  FILLER                          PIC  X(01)  VALUE '-'.   04100000
042800     05  HL1-RPT-NBR                     PIC  9(01)  VALUE ZERO.  04110000
042900     05  FILLER                          PIC  X(02)  VALUE SPACE. 04120000
043000     05  FILLER                          PIC  X(05)  VALUE        04130000
043100         'PAGE '.                                                 04140000
043200     05  HL1-PGE-NBR                     PIC  9(01)  VALUE ZERO.  04150000
043300     05  FILLER                          PIC  X(04)  VALUE        04160000
043400         ' OF '.                                                  04170000
043500     05  HL1-OF-PGE-NBR                  PIC  9(01)  VALUE ZERO.  04180000
043600     05  FILLER                          PIC  X(02)  VALUE SPACE. 04190000
043700*                                                                 04200000
043800 01  HL2-HEADING-LINE-2.                                          04210000
043900     05  FILLER                          PIC  X(06)  VALUE SPACE. 04220000
044000     05  FILLER                          PIC  X(13)  VALUE        04230000
044100         '   OPER UNIT:'.                                         04240000
044200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04250000
044300     05  HL2-OPERATING-ID                PIC  X(04)  VALUE SPACE. 04260000
044400     05  FILLER                          PIC  X(24)  VALUE SPACE. 04270000
044500     05  FILLER                          PIC  X(12)  VALUE        04280000
044600         'FACILITY ID:'.                                          04290000
044700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04300000
044800     05  HL2-FACILITY-ID                 PIC  X(04)  VALUE SPACE. 04310000
044900     05  FILLER                          PIC  X(33)  VALUE SPACE. 04320000
045000     05  FILLER                          PIC  X(08)  VALUE        04330000
045100         'TRIP ID:'.                                              04340000
045200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04350000
045300     05  HL2-TRIP-ID                     PIC  ZZZZZZZZZ.          04360000
045400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04370000
045500*                                                                 04380000
045600 01  HL3-HEADING-LINE-3.                                          04390000
045700     05  FILLER                          PIC  X(05)  VALUE SPACE. 04400000
045800     05  FILLER                          PIC  X(14)  VALUE        04410000
045900         'LINE LOCATION:'.                                        04420000
046000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04430000
046100     05  HL3-LNE-LOC                     PIC  X(05)  VALUE SPACE. 04440000
046200     05  FILLER                          PIC  X(23)  VALUE SPACE. 04450000
046300     05  FILLER                          PIC  X(12)  VALUE        04460000
046400         'PREPARED BY:'.                                          04470000
046500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04480000
046600     05  HL3-PREPAIRER-USER-ID           PIC  X(08)  VALUE SPACE. 04490000
046700     05  FILLER                          PIC  X(27)  VALUE SPACE. 04500000
046800     05  FILLER                          PIC  X(10)  VALUE        04510000
046900         'DIVIDE BY:'.                                            04520000
047000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04530000
047100     05  FILLER                          PIC  X(15)  VALUE ALL    04540000
047200         '_'.                                                     04550000
047300     05  FILLER                          PIC  X(11)  VALUE SPACE. 04560000
047400*                                                                 04570000
047500 01  HL4-HEADING-LINE-4.                                          04580000
047600     05  FILLER                          PIC  X(07)  VALUE SPACE. 04590000
047700     05  FILLER                          PIC  X(12)  VALUE        04600000
047800         'VENDOR NAME:'.                                          04610000
047900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04620000
048000     05  HL4-VNDR-NME                    PIC  X(25)  VALUE SPACE. 04630000
048100     05  FILLER                          PIC  X(04)  VALUE SPACE. 04640000
048200     05  FILLER                          PIC  X(11)  VALUE        04650000
048300         'PRINTER ID:'.                                           04660000
048400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04670000
048500     05  HL4-PRINTER-DEST                PIC  X(08)  VALUE SPACE. 04680000
048600     05  FILLER                          PIC  X(30)  VALUE SPACE. 04690000
048700     05  FILLER                          PIC  X(07)  VALUE        04700000
048800         'KEYREC:'.                                               04710000
048900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04720000
049000     05  HL4-KEYREC                      PIC  9(08)  VALUE ZEROS. 04730000
049100     05  FILLER                          PIC  X(18)  VALUE SPACE. 04740000
049200*                                                                 04750000
049300 01  HL5-HEADING-LINE-5.                                          04760000
049400     05  FILLER                          PIC  X(12)  VALUE SPACE. 04770000
049500     05  FILLER                          PIC  X(07)  VALUE        04780000
049600         'PO NBR:'.                                               04790000
049700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04800000
049800     05  HL5-PO-NBR                      PIC  X(08)  VALUE SPACE. 04810000
049900     05  FILLER                          PIC  X(27)  VALUE SPACE. 04820000
050000     05  FILLER                          PIC  X(05)  VALUE        04830000
050100         'DEPT:'.                                                 04840000
050200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04850000
050300     05  HL5-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 04860000
050400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04870000
050500     05  FILLER                          PIC  X(04)  VALUE        04880000
050600         'CLS:'.                                                  04890000
050700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04900000
050800     05  HL5-CLASS-NBR                   PIC  X(02)  VALUE SPACE. 04910000
050900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04920000
051000     05  FILLER                          PIC  X(04)  VALUE        04930000
051100         'SKU:'.                                                  04940000
051200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04950000
051300     05  HL5-SEQ-NBR                     PIC  X(08)  VALUE SPACE. 04960000
051400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04970000
051500     05  FILLER                          PIC  X(18)  VALUE        04980000
051600         'EXPTED CARTON CNT:'.                                    04990000
051700     05  FILLER                          PIC  X(03)  VALUE SPACE. 05000000
051800     05  HL5-TOT-CARTON-CNT              PIC  ZZZ,ZZZ,ZZZ.        05010000
051900     05  FILLER                          PIC  X(12)  VALUE SPACE. 05020000
052000*                                                                 05030000
052100 01  HL6-HEADING-LINE-6.                                          05040000
052200     05  FILLER                          PIC  X(02)  VALUE SPACE. 05050000
052300     05  FILLER                          PIC  X(17)  VALUE        05060000
052400         'RECEIVER SEQ NBR:'.                                     05070000
052500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05080000
052600     05  HL6-RCVR-SEQ-NBR                PIC  X(03)  VALUE SPACE. 05090000
052700     05  FILLER                          PIC  X(32)  VALUE SPACE. 05100000
052800     05  FILLER                          PIC  X(05)  VALUE        05110000
052900         'SIZE:'.                                                 05120000
053000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05130000
053100     05  HL6-SIZE                        PIC  X(20)  VALUE SPACE. 05140000
053200     05  FILLER                          PIC  X(05)  VALUE SPACE. 05150000
053300     05  FILLER                          PIC  X(20)  VALUE        05160000
053400         'ADJUSTED CARTON CNT:'.                                  05170000
053500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05180000
053600     05  HL6-TOT-CARTON-CNT              PIC  ZZZ,ZZZ,ZZZ.        05190000
053700     05  FILLER                          PIC  X(12)  VALUE SPACE. 05200000
053800*                                                                 05210000
053900 01  HL7-HEADING-LINE-7.                                          05220000
054000     05  FILLER                          PIC  X(10)  VALUE SPACE. 05230000
054100     05  FILLER                          PIC  X(09)  VALUE        05240000
054200         'LINE NBR:'.                                             05250000
054300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05260000
054400     05  HL7-LINE-NBR                    PIC  X(04)  VALUE SPACE. 05270000
054500     05  FILLER                          PIC  X(30)  VALUE SPACE. 05280000
054600     05  FILLER                          PIC  X(06)  VALUE        05290000
054700         'COLOR:'.                                                05300000
054800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05310000
054900     05  HL7-COLOR                       PIC  X(20)  VALUE SPACE. 05320000
055000     05  FILLER                          PIC  X(08)  VALUE SPACE. 05330000
055100     05  FILLER                          PIC  X(17)  VALUE        05340000
055200         '    ARRIVED DATE:'.                                     05350000
055300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05360000
055400     05  HL7-REC-DATE                    PIC  X(10).              05370000
055500     05  FILLER                          PIC  X(16)  VALUE SPACE. 05380000
055600*                                                                 05390000
055700 01  HL8-HEADING-LINE-8.                                          05400000
055800     05  FILLER                          PIC  X(04)  VALUE SPACE. 05410000
055900     05  FILLER                          PIC  X(15)  VALUE        05420000
056000         'WORK ORDER NBR:'.                                       05430000
056100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05440000
056200     05  HL8-WORK-ORD-NBR                PIC  X(03)  VALUE SPACE. 05450000
056300     05  FILLER                          PIC  X(28)  VALUE SPACE. 05460000
056400     05  FILLER                          PIC  X(09)  VALUE        05470000
056500         'SKU DESC:'.                                             05480000
056600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05490000
056700     05  HL8-SKU-DESC                    PIC  X(25)  VALUE SPACE. 05500000
056800     05  FILLER                          PIC  X(13)  VALUE SPACE. 05510000
056900     05  FILLER                          PIC  X(08)  VALUE        05520000
057000         'HANGER: '.                                              05530000
057100     05  HL8-HANGER                      PIC  X(01)  VALUE SPACE. 05540000
057200     05  FILLER                          PIC  X(20)  VALUE SPACE. 05550000
057300*                                                                 05560000
057400 01  HL9-HEADING-LINE-9.                                          05570000
057500     05  FILLER                          PIC  X(04)  VALUE SPACE. 05580000
057600     05  FILLER                          PIC  X(15)  VALUE        05590000
057700         'LINE ITEM DESC:'.                                       05600000
057800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05610000
057900     05  HL9-LNE-ITM-DESC                PIC  X(25)  VALUE SPACE. 05620000
058000     05  FILLER                          PIC  X(05)  VALUE SPACE. 05630000
058100     05  FILLER                          PIC  X(10)  VALUE        05640000
058200         'SKU STYLE:'.                                            05650000
058300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05660000
058400     05  HL9-VNDR-STYLE-NME              PIC  X(15)  VALUE SPACE. 05670000
058500     05  FILLER                          PIC  X(17)  VALUE SPACE. 05680000
058600     05  FILLER                          PIC  X(14)  VALUE        05690000
058700         'PRESENTATION: '.                                        05700000
058800     05  HL9-PRESENTATION                PIC  X(07)  VALUE SPACE. 05710000
058900     05  FILLER                          PIC  X(08)  VALUE SPACE. 05720000
059000*                                                                 05730000
059100 01  HL10-HEADING-LINE-10.                                        05740000
059200     05  FILLER                          PIC  X(09)  VALUE SPACE. 05750000
059300     05  FILLER                          PIC  X(10)  VALUE        05760000
059400         'SIZE DESC:'.                                            05770000
059500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05780000
059600     05  HL10-SIZE-DESC                  PIC  X(25)  VALUE SPACE. 05790000
059700     05  FILLER                          PIC  X(06)  VALUE SPACE. 05800000
059800     05  FILLER                          PIC  X(09)  VALUE        05810000
059900         'PO STYLE:'.                                             05820000
060000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05830000
060100     05  HL10-VNDR-STYLE-NME             PIC  X(15)  VALUE SPACE. 05840000
060200     05  FILLER                          PIC  X(06)  VALUE SPACE. 05850000
060300     05  HL10-TICKET-PLCMNT              PIC  X(50)  VALUE SPACES.05860000
060400*                                                                 05870000
060500 01  HL11-HEADING-LINE-11.                                        05880000
060600     05  FILLER                          PIC  X(08)  VALUE SPACE. 05890000
060700     05  FILLER                          PIC  X(11)  VALUE        05900000
060800         'COLOR DESC:'.                                           05910000
060900     05  FILLER                          PIC  X(01)  VALUE SPACE. 05920000
061000     05  HL11-COLOR-DESC                 PIC  X(25)  VALUE SPACE. 05930000
061100     05  FILLER                          PIC  X(04)  VALUE SPACE. 05940000
061200     05  FILLER                          PIC  X(11)  VALUE        05950000
061300         'SKU RETAIL:'.                                           05960000
061400     05  HL11-SKU-RTL                    PIC ZZ,ZZZ.99            05970000
061500                                                     VALUE ZEROS. 05980000
061600     05  FILLER                          PIC  X(22)  VALUE SPACE. 05990000
061700     05  HL11-UPC-CERT-MESSAGE           PIC  X(38)  VALUE SPACE. 06000000
061800     05  FILLER                          PIC  X(03)  VALUE SPACES.06010000
061900*                                                                 06020000
062000 01  HL12-HEADING-LINE-12.                                        06030000
062100     05  FILLER                          PIC  X(05)  VALUE SPACE. 06040000
062200     05  FILLER                          PIC  X(14)  VALUE        06050000
062300         'TICKET RETAIL:'.                                        06060000
062400     05  FILLER                          PIC  X(01)  VALUE SPACE. 06070000
062500     05  HL12-UNT-RTL-PR-AMT             PIC ZZZ,ZZZ.99           06080000
062600                                                     VALUE ZEROS  06090000
062700                                         BLANK WHEN ZERO.         06100000
062800     05  FILLER                          PIC  X(53)  VALUE SPACE. 06110000
062900     05  FILLER                          PIC  X(49)  VALUE SPACE. 06120000
063000*                                                                 06130000
063100 01  HL13-HEADING-LINE-13.                                        06140000
063200     05  FILLER                          PIC  X(01)  VALUE SPACE. 06150000
063300     05  FILLER                          PIC  X(18)  VALUE        06160000
063400         'ACTUAL CARTON CNT:'.                                    06170000
063500     05  FILLER                          PIC  X(01)  VALUE SPACE. 06180000
063600     05  HL13-ACTUAL-CART-CNT            PIC ZZZ,ZZZ,ZZZ          06190000
063700                                                     VALUE ZEROS  06200000
063800                                         BLANK WHEN ZERO.         06210000
063900     05  FILLER                          PIC  X(94)  VALUE SPACE. 06220000
064000     05  FILLER                          PIC  X(07)  VALUE SPACE. 06230000
064100*                                                                 06240000
064200 01  HL13A-HEADING-LINE-13A.                                      06250000
064300     05  FILLER                          PIC  X(01)  VALUE SPACE. 06260000
064400     05  FILLER                          PIC  X(11)  VALUE        06270000
064500         'PRETICKET: '.                                           06280000
064600     05  HL13A-PRETICKET-IND             PIC  X(01)  VALUE SPACES.06290000
064700     05  FILLER                          PIC  X(02)  VALUE SPACE. 06300000
064800     05  FILLER                          PIC  X(13)  VALUE        06310000
064900         'TICKET TYPE: '.                                         06320000
065000     05  FILLER                          PIC  X(02)  VALUE SPACE. 06330000
065100     05  HL13A-TICKET-TYPE               PIC  X(20)  VALUE SPACE. 06340000
065200     05  FILLER                          PIC  X(02)  VALUE SPACE. 06350000
065300     05  FILLER                          PIC  X(18)  VALUE        06360000
065400         'TICKET PLACEMENT: '.                                    06370000
065500     05  HL13A-TICKET-PLACEMENT          PIC  X(50)  VALUE SPACE. 06380000
065600*                                                                 06390000
065700 01  HL14-HEADING-LINE-14.                                        06400000
065800     05  FILLER                          PIC  X(05)  VALUE SPACE. 06410000
065900     05  FILLER                          PIC  X(14)  VALUE        06420000
066000         'SPECIAL INSTR:'.                                        06430000
066100     05  FILLER                          PIC  X(01)  VALUE SPACE. 06440000
066200     05  HL14-SPECIAL-INSTR              PIC  X(100) VALUE SPACE. 06450000
066300     05  FILLER                          PIC  X(12)  VALUE SPACE. 06460000
066400*                                                                 06470000
066500 01  HL15-HEADING-LINE-15.                                        06480000
066600     05  FILLER                          PIC  X(01)  VALUE SPACE. 06490000
066700     05  FILLER                          PIC  X(25)  VALUE        06500000
066800         '*** RTV DISTRIBUTIONS ***'.                             06510000
066900     05  FILLER                          PIC  X(106) VALUE SPACE. 06520000
067000*                                                                 06530000
067100 01  DH1-DETAIL-HEADING-LINE-1.                                   06540000
067200     05  FILLER                          PIC  X(01)  VALUE SPACE. 06550000
067300     05  FILLER                          PIC  X(10)  VALUE        06560000
067400         'STORE/NAME'.                                            06570000
067500     05  FILLER                          PIC  X(01)  VALUE SPACE. 06580000
067600     05  FILLER                          PIC  X(06)  VALUE        06590000
067700         'EXPTED'.                                                06600000
067800     05  FILLER                          PIC  X(03)  VALUE SPACE. 06610000
067900     05  FILLER                          PIC  X(05)  VALUE        06620000
068000         'ITEMS'.                                                 06630000
068100     05  FILLER                          PIC  X(03)  VALUE SPACE. 06640000
068200     05  FILLER                          PIC  X(05)  VALUE        06650000
068300         'ITEMS'.                                                 06660000
068400     05  FILLER                          PIC  X(01)  VALUE SPACE. 06670000
068500     05  FILLER                          PIC  X(07)  VALUE        06680000
068600         'OPEN TO'.                                               06690000
068700     05  FILLER                          PIC  X(03)  VALUE SPACE. 06700000
068800     05  FILLER                          PIC  X(10)  VALUE        06710000
068900         'STORE/NAME'.                                            06720000
069000     05  FILLER                          PIC  X(01)  VALUE SPACE. 06730000
069100     05  FILLER                          PIC  X(06)  VALUE        06740000
069200         'EXPTED'.                                                06750000
069300     05  FILLER                          PIC  X(03)  VALUE SPACE. 06760000
069400     05  FILLER                          PIC  X(05)  VALUE        06770000
069500         'ITEMS'.                                                 06780000
069600     05  FILLER                          PIC  X(03)  VALUE SPACE. 06790000
069700     05  FILLER                          PIC  X(05)  VALUE        06800000
069800         'ITEMS'.                                                 06810000
069900     05  FILLER                          PIC  X(01)  VALUE SPACE. 06820000
070000     05  FILLER                          PIC  X(07)  VALUE        06830000
070100         'OPEN TO'.                                               06840000
070200     05  FILLER                          PIC  X(03)  VALUE SPACE. 06850000
070300     05  FILLER                          PIC  X(10)  VALUE        06860000
070400         'STORE/NAME'.                                            06870000
070500     05  FILLER                          PIC  X(01)  VALUE SPACE. 06880000
070600     05  FILLER                          PIC  X(06)  VALUE        06890000
070700         'EXPTED'.                                                06900000
070800     05  FILLER                          PIC  X(03)  VALUE SPACE. 06910000
070900     05  FILLER                          PIC  X(05)  VALUE        06920000
071000         'ITEMS'.                                                 06930000
071100     05  FILLER                          PIC  X(03)  VALUE SPACE. 06940000
071200     05  FILLER                          PIC  X(05)  VALUE        06950000
071300         'ITEMS'.                                                 06960000
071400     05  FILLER                          PIC  X(01)  VALUE SPACE. 06970000
071500     05  FILLER                          PIC  X(07)  VALUE        06980000
071600         'OPEN TO'.                                               06990000
071700     05  FILLER                          PIC  X(02)  VALUE SPACE. 07000000
071800*                                                                 07010000
071900 01  DH2-DETAIL-HEADING-LINE-2.                                   07020000
072000     05  FILLER                          PIC  X(12)  VALUE SPACE. 07030000
072100     05  FILLER                          PIC  X(05)  VALUE        07040000
072200         'ITEMS'.                                                 07050000
072300     05  FILLER                          PIC  X(05)  VALUE SPACE. 07060000
072400     05  FILLER                          PIC  X(03)  VALUE        07070000
072500         'O/S'.                                                   07080000
072600     05  FILLER                          PIC  X(04)  VALUE SPACE. 07090000
072700     05  FILLER                          PIC  X(04)  VALUE        07100000
072800         'DMGD'.                                                  07110000
072900     05  FILLER                          PIC  X(02)  VALUE SPACE. 07120000
073000     05  FILLER                          PIC  X(07)  VALUE        07130000
073100         'RECEIVE'.                                               07140000
073200     05  FILLER                          PIC  X(14)  VALUE SPACE. 07150000
073300     05  FILLER                          PIC  X(05)  VALUE        07160000
073400         'ITEMS'.                                                 07170000
073500     05  FILLER                          PIC  X(05)  VALUE SPACE. 07180000
073600     05  FILLER                          PIC  X(03)  VALUE        07190000
073700         'O/S'.                                                   07200000
073800     05  FILLER                          PIC  X(04)  VALUE SPACE. 07210000
073900     05  FILLER                          PIC  X(04)  VALUE        07220000
074000         'DMGD'.                                                  07230000
074100     05  FILLER                          PIC  X(02)  VALUE SPACE. 07240000
074200     05  FILLER                          PIC  X(07)  VALUE        07250000
074300         'RECEIVE'.                                               07260000
074400     05  FILLER                          PIC  X(14)  VALUE SPACE. 07270000
074500     05  FILLER                          PIC  X(05)  VALUE        07280000
074600         'ITEMS'.                                                 07290000
074700     05  FILLER                          PIC  X(05)  VALUE SPACE. 07300000
074800     05  FILLER                          PIC  X(03)  VALUE        07310000
074900         'O/S'.                                                   07320000
075000     05  FILLER                          PIC  X(04)  VALUE SPACE. 07330000
075100     05  FILLER                          PIC  X(04)  VALUE        07340000
075200         'DMGD'.                                                  07350000
075300     05  FILLER                          PIC  X(02)  VALUE SPACE. 07360000
075400     05  FILLER                          PIC  X(07)  VALUE        07370000
075500         'RECEIVE'.                                               07380000
075600     05  FILLER                          PIC  X(02)  VALUE SPACE. 07390000
075700*                                                                 07400000
075800 01  DH3-NO-DISTRO-MSG .                                          07410000
075900     05  FILLER                          PIC X(19)   VALUE        07420000
076000         '   NO DISTRO   **  '.                                   07430000
076100     05  FILLER                          PIC X(19)   VALUE        07440000
076200         '   NO DISTRO   **  '.                                   07450000
076300     05  FILLER                          PIC X(19)   VALUE        07460000
076400         '   NO DISTRO   **  '.                                   07470000
076500     05  FILLER                          PIC X(19)   VALUE        07480000
076600         '   NO DISTRO   **  '.                                   07490000
076700     05  FILLER                          PIC X(19)   VALUE        07500000
076800         '   NO DISTRO   **  '.                                   07510000
076900     05  FILLER                          PIC X(19)   VALUE        07520000
077000         '   NO DISTRO   **  '.                                   07530000
077100     05  FILLER                          PIC X(18)   VALUE        07540000
077200         '   NO DISTRO   ** '.                                    07550000
077300*                                                                 07560000
077400 01  DH4-STORE-PROBLEM-LINE.                                      07570000
077500     05  FILLER                          PIC X(01)   VALUE SPACE. 07580000
077600     05  FILLER                          PIC X(24)   VALUE        07590000
077700         '** WARNING ** WARNING **'.                              07600000
077800     05  FILLER                          PIC X(16)   VALUE SPACE. 07610000
077900     05  FILLER                          PIC X(52)   VALUE        07620000
078000         'POTENTIAL PROBLEMS WITH STORES FOR THIS DISTRIBUTION'.  07630000
078100     05  FILLER                          PIC X(16)   VALUE SPACE. 07640000
078200     05  FILLER                          PIC X(24)   VALUE        07650000
078300         '** WARNING ** WARNING **'.                              07660000
078400                                                                  07670000
078500 01  DL-DETAIL-LINE.                                              07680000
078600     05  FILLER                          PIC  X(01)  VALUE SPACE. 07690000
078700     05  DL-DTL-LNE-AREA                 OCCURS 3 TIMES           07700000
078800                                            INDEXED BY            07710000
078900                                            DL-DTL-LNE-IDX.       07720000
079000         10  FILLER                      PIC  X(01).              07730000
079100         10  DL-STR-NBR                  PIC  ZZZ9.               07740000
079200         10  FILLER                      PIC  X(01).              07750000
079300         10  DL-CHAR5-ABBR-NAME          PIC  X(05).              07760000
079400         10  FILLER                      PIC  X(01).              07770000
079500         10  DL-EXPTED-ITM-CNT           PIC  ZZ,ZZ9.             07780000
079600         10  FILLER                      PIC  X(02).              07790000
079700         10  DL-UNITS-OVER-SHORT         PIC  X(06).              07800000
079800         10  FILLER                      PIC  X(02).              07810000
079900         10  DL-UNITS-DAMAGED            PIC  X(06).              07820000
080000         10  FILLER                      PIC  X(02).              07830000
080100         10  DL-UNITS-OPEN-TO-RECEIVE    PIC  X(6).               07840000
080200         10  FILLER                      PIC  X(02).              07850000
080300*                                                                 07860000
080400 01  PC-PROGRAM-CONSTANTS.                                        07870000
080500     05  PC-DB2-DUMMY-DATE               PIC  X(26)  VALUE        07880000
080600         '9999-09-09-09.09.09.000000'.                            07890000
080700     05  PC-DB2-DUMMY-DATE-TIME          PIC  X(26)  VALUE        07900000
080800         '9999-09-09-09.09.09.999999'.                            07910000
080900     05  PC-DB2-ZERO-DATE-TIME           PIC  X(26)  VALUE        07920000
081000         '0000-00-00-00.00.00.000000'.                            07930000
081100     05  PC-MULTIPLE-RESULT-SET-ROWS     PIC S9(04)  VALUE -811   07940000
081200                                                     COMP SYNC.   07950000
081300     05  PC-3                            PIC S9(04)  VALUE +3     07960000
081400                                                     COMP SYNC.   07970000
081500     05  PC-SLASH                        PIC  X(01)  VALUE '/'.   07980000
081600     05  PC-Y                            PIC  X(02)  VALUE 'Y'.   07990000
081700     05  PC-M                            PIC  X(01)  VALUE 'M'.   08000000
081800     05  PC-ONE                          PIC  9(01)  VALUE 1.     08010000
081900     05  PC-ZERO                         PIC S9(09)  COMP VALUE   08020000
082000         ZERO.                                                    08030000
082100     05  PC-2                            PIC  9(01)  VALUE 2.     08040000
082200     05  PC-5                            PIC  9(01)  VALUE 5.     08050000
082300     05  PC-9                            PIC  9(01)  VALUE 9.     08060000
082400     05  PC-T                            PIC  X(01)  VALUE 'T'.   08070000
082500     05  PC-N                            PIC  X(01)  VALUE 'N'.   08080000
082600     05  PC-I                            PIC  X(01)  VALUE 'I'.   08090000
082700     05  PC-U                            PIC  X(01)  VALUE 'U'.   08100000
082800     05  PC-V                            PIC  X(01)  VALUE 'V'.   08110000
082900     05  PC-R                            PIC  X(01)  VALUE 'R'.   08120000
083000     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  08130000
083100     05  PC-CS                           PIC  X(02)  VALUE 'CS'.  08140000
083200     05  PC-DC                           PIC  X(02)  VALUE 'DC'.  08150000
083300     05  PC-RV                           PIC  X(02)  VALUE 'RV'.  08160000
083400     05  PC-DASH                         PIC  X(01)  VALUE '-'.   08170000
083500     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  08180000
083600     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   08190000
083700                                                     COMP SYNC.   08200000
083800     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        08210000
083900                                              'PCKCS014'.         08220000
084000     05  PC-ROWS-PER-PAGE-30             PIC S9(04)  VALUE +30    08230000
084100                                                     COMP SYNC.   08240000
084200     05  PC-COLS-PER-PAGE                PIC S9(04)  VALUE +3     08250000
084300                                                     COMP SYNC.   08260000
084400     05  PC-MAX-STR-TBL-OCCURANCES       PIC S9(04)  VALUE +396   08270000
084500                                                     COMP SYNC.   08280000
084600     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     08290000
084700                                                     COMP SYNC.   08300000
084800     05  PC-PUT                          PIC  X(03)  VALUE 'PUT'. 08310000
084900     05  PC-A                            PIC  X(02)  VALUE 'A'.   08320000
085000     05  PC-10                           PIC  X(02)  VALUE '10'.  08330000
085100     05  PC-TOP-OF-PAGE                  PIC  X(01)  VALUE '1'.   08340000
085200     05  PC-SINGLE-SPACE                 PIC  X(01)  VALUE ' '.   08350000
085300     05  PC-DOUBLE-SPACE                 PIC  X(01)  VALUE '0'.   08360000
085400     05  PC-CURRENT-DATE              PIC X(10) VALUE SPACE.      08370000
085500     05  PC-VS-HNGFLD-TYPE-CDE       PIC S9(04) COMP              08380000
085600                                                VALUE +10.        08390000
085700     05  PC-SUBCLASS-MDSELV-CDE      PIC  X(03) VALUE 'SCL'.      08400000
085800     05  PC-MAJCLASS-MDSELV-CDE      PIC X(03) VALUE 'MCL'.       08410000
085900     05  PC-DPT-MDSELV-CDE           PIC X(03) VALUE 'DPT'.       08420000
086000     05  PC-MULT-SPECIAL-INSTRS-MSG      PIC  X(100) VALUE        08430000
086100         'MULT SPECIAL INSTRUCTIONS EXIST, SEE ONLINE SYSTEM'.    08440000
086200     05  PC-RTV-SPECIAL-INSTRS-MSG       PIC  X(100) VALUE        08450000
086300         'ATTACH THIS DOCUMENT TO RTV MERCHANDISE'.               08460000
086400     05  PC-RTV-PROCESSING-1.                                     08470000
086500         10  FILLER                          PIC X(39)  VALUE     08480000
086600             '^M0202000******************************'.           08490000
086700         10  FILLER                          PIC X(32)  VALUE     08500000
086800             '******************************^-'.                  08510000
086900     05  PC-RTV-PROCESSING-2.                                     08520000
087000         10  FILLER                          PIC X(12)  VALUE     08530000
087100             '^M0202000***'.                                      08540000
087200         10  FILLER                          PIC X(54)  VALUE     08550000
087300         '     RTV DOCUMENT, PLEASE ATTACH TO MERCHANDISE!!     '.08560000
087400         10  FILLER                          PIC X(05)  VALUE     08570000
087500             '***^-'.                                             08580000
087600                                                                  08590000
087700     05  PC-RTV-PROCESSING-NO-BARCODE-1.                          08600000
087800         10  FILLER                          PIC X(120) VALUE     08610000
087900             ALL '* '.                                            08620000
088000     05  PC-RTV-PROCESSING-NO-BARCODE-2.                          08630000
088100         10  FILLER                          PIC X(06)  VALUE     08640000
088200             '* * * '.                                            08650000
088300         10  FILLER                          PIC X(50)  VALUE     08660000
088400         '          R T V   D O C U M E N T ,   P L E A S E '.    08670000
088500         10  FILLER                          PIC X(54)  VALUE     08680000
088600         '  A T T A C H   T O   M E R C H A N D I S E ! !       '.08690000
088700         10  FILLER                          PIC X(10)  VALUE     08700000
088800             '    * * * '.                                        08710000
088900     05  PC-MARKING-APRON-RPT-HDR        PIC  X(46)  VALUE        08720000
089000         '    M  A  R  K  I  N  G     A  P  R  O  N     '.        08730000
089100     05  PC-UPC-CERT-MSG                 PIC  X(38)  VALUE        08740000
089200         '** ** UPC CERTIFICATION REQUIRED ** **'.                08750000
089300     05  PC-EXTERNAL-UPC-LOW          PIC S9(15)V                 08760000
089400                                      VALUE 000000000000000       08770000
089500                                      COMP-3.                     08780000
089600     05  PC-INTERNAL-UPC-LOW          PIC S9(15)V                 08790000
089700                                      VALUE 000399999999999       08800000
089800                                      COMP-3.                     08810000
089900     05  PC-INTERNAL-UPC-HIGH         PIC S9(15)V                 08820000
090000                                      VALUE 000500000000000       08830000
090100                                      COMP-3.                     08840000
090200     05  PC-EXTERNAL-UPC-HIGH         PIC S9(15)V                 08850000
090300                                      VALUE 999999999999999       08860000
090400                                      COMP-3.                     08870000
090500     05  PC-ABEND-MESSAGE                PIC  X(132) VALUE        08880000
090600          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    08890000
090700     05  PC-000                       PIC X(03) VALUE '000'.      08900000
090800     05  PC-999                       PIC X(03) VALUE '999'.      08910000
090900*                                                                 08920000
091000 01  PS-PROGRAM-SWITCHES.                                         08930000
091100     05  PS-UPDATES-DONE-SW              PIC  X      VALUE 'N'.   08940000
091200         88  PS-UPDATES-DONE                         VALUE 'Y'.   08950000
091300         88  PS-NO-UPDATES-DONE                      VALUE 'N'.   08960000
091400     05  PS-PRINT-NO-DISTRO-MSG-SW       PIC  X      VALUE 'N'.   08970000
091500         88  PS-PRINT-NO-DISTRO-MSG                  VALUE 'Y'.   08980000
091600         88  PS-DONT-PRINT-NO-DISTRO-MSG             VALUE 'N'.   08990000
091700     05  PS-PRINT-STORE-PROBLEM-SW       PIC  X      VALUE 'N'.   09000000
091800         88  PS-DONT-PRINT-STORE-PROBLEM             VALUE 'N'.   09010000
091900         88  PS-PRINT-STORE-PROBLEM                  VALUE 'Y'.   09020000
092000     05  PS-MORE-RECEIPT-SW              PIC  X      VALUE 'Y'.   09030000
092100         88  PS-NO-MORE-RECEIPT                      VALUE 'N'.   09040000
092200         88  PS-MORE-RECEIPT                         VALUE 'Y'.   09050000
092300     05  PS-REDISTRO-SW                  PIC  X      VALUE 'Y'.   09060000
092400         88  PS-NO-REDISTRO                          VALUE 'N'.   09070000
092500         88  PS-REDISTRO                             VALUE 'Y'.   09080000
092600     05  PS-SPECIAL-INSTRS-IND           PIC  X(01)  VALUE SPACE. 09090000
092700         88  PS-NO-SPECIAL-INSTRS-FOUND              VALUE 'N'.   09100000
092800         88  PS-MULT-SPECIAL-INSTRS-FOUND            VALUE 'Y'.   09110000
092900     05  PS-DIFF-OPER-UNIT-ID-IND        PIC  X(01)  VALUE 'N'.   09120000
093000         88  PS-DIFF-OPER-UNIT-ID                    VALUE 'Y'.   09130000
093100         88  PS-SAME-OPER-UNIT-ID                    VALUE 'N'.   09140000
093200     05  PS-VENDOR-REQ-CERT-IND          PIC X(1)    VALUE 'N'.   09150000
093300         88  PS-VENDOR-REQ-CERT                      VALUE 'Y'.   09160000
093400     05  PS-EOF-TABLE-SW                 PIC  X(01)  VALUE 'N'.   09170000
093500         88  PS-EOF-TABLE                            VALUE 'Y'.   09180000
093600     05  PS-FIRST-TIME-SW                PIC  X(01)  VALUE 'Y'.   09190000
093700         88  PS-FIRST-TIME                           VALUE 'Y'.   09200000
093800         88  PS-NOT-FIRST-TIME                       VALUE 'N'.   09210000
093900     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   09220000
094000         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   09230000
094100         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   09240000
094400     05  PS-TWKORIN-ZERO-SW              PIC X(01)   VALUE 'N'.   09250000
094500         88  PS-EOF-TWKORIN-ZERO                     VALUE 'Y'.   09260000
094800     05  PS-TRECITM-FOUND-SW             PIC X(01)   VALUE 'Y'.   09270000
094900         88  PS-NO-TRECITM                           VALUE 'N'.   09280000
095000         88  PS-YES-TRECITM                          VALUE 'Y'.   09290000
095100     05  PS-RTV-DISTRO-SW                PIC X(01)   VALUE 'N'.   09300000
095200         88  PS-NO-RTV-DISTRO                        VALUE 'N'.   09310000
095300         88  PS-RTV-DISTRO                           VALUE 'Y'.   09320000
095400     05  PS-RTV-PRINT-SW                 PIC X(01)   VALUE 'N'.   09330000
095500         88  PS-RTV-PRINT                            VALUE 'Y'.   09340000
095600         88  PS-NO-RTV-PRINT                         VALUE 'N'.   09350000
095700     05  PS-REPRINT-MSG-PRTED-SW         PIC X(01)   VALUE 'N'.   09360000
095800         88  PS-REPRINT-MSG-PRTED                    VALUE 'Y'.   09370000
095900         88  PS-NO-REPRINT-MSG-PRTED                 VALUE 'N'.   09380000
096000     05  PS-VSM-SW                        PIC  X     VALUE 'N'.   09390000
096100         88  PS-NOT-VSM                              VALUE 'N'.   09400000
096200         88  PS-VSM                                  VALUE 'Y'.   09410000
096300     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        09420000
096400         88  PS-CALL-API-NO                     VALUE 'N'.        09430000
096500         88  PS-CALL-API-YES                    VALUE 'Y'.        09440000
096600                                                                  09450000
096700*                                                                 09460000
096800 01  PS-PROGRAM-SUBSCRIPTS.                                       09470000
096900     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     09480000
097000                                                     COMP SYNC.   09490000
097100     05  PS-COUNTER                      PIC S9(04)  VALUE +0     09500000
097200                                                     COMP SYNC.   09510000
097300     05  PS-PAGE-SUB                     PIC S9(04)  VALUE +0     09520000
097400                                                     COMP SYNC.   09530000
097500     05  PS-RTV-SUB                      PIC S9(04)  VALUE +0     09540000
097600                                                     COMP SYNC.   09550000
097700     05  STR-SUB                         PIC S9(04)  VALUE +0     09560000
097800                                                     COMP SYNC.   09570000
097900*                                                                 09580000
098000 01  PV-PROGRAM-VARIABLES.                                        09590000
098100                                                                  09600000
098200     05  PV-ROWS-PER-PAGE                PIC S9(04)  VALUE +0     09610000
098300                                                     COMP SYNC.   09620000
098400     05  PV-NUM-ITEMS                    PIC S9(4)   VALUE ZERO   09630000
098500                                                     COMP SYNC.   09640000
098600     05  PV-STR-REC-QTY                  PIC S9(9) COMP.          09650000
098700     05  PV-STRS-ON-LAST-PAGE            PIC S9(9) COMP.          09660000
098800     05  PV-SUB-1                        PIC S9(4)   VALUE ZERO   09670000
098900                                                     COMP SYNC.   09680000
099000     05  PV-SUM-STR-PLAN-QTY             PIC S9(9)   COMP.        09690000
099100     05  PV-RETRY-COUNTER                PIC S9(4)   VALUE ZERO   09700000
099200                                                     COMP SYNC.   09710000
099300     05  PV-SUM-VERIFIED-QTY             PIC S9(09)  VALUE ZERO   09720000
099400                                                     COMP SYNC.   09730000
099500     05  PV-VERIFIED-IND                 PIC S9(04)  VALUE ZERO   09740000
099600                                                     COMP SYNC.   09750000
099700     05  PV-OTR                          PIC S9(09)  VALUE ZEROS. 09760000
099800     05  PV-EFF-CLOSE-DATE               PIC  X(10)  VALUE SPACES.09770000
099900     05  PV-DB2-CURRENT-TMST             PIC  X(26).              09780000
100000     05  PV-REC-TMST                     PIC  X(26).              09790000
100100     05  PV-REC-TMST-R REDEFINES PV-REC-TMST.                     09800000
100200         10  FILLER                      PIC  X(02).              09810000
100300         10  PV-REC-YY                   PIC  X(02).              09820000
100400         10  FILLER                      PIC  X(01).              09830000
100500         10  PV-REC-MM                   PIC  X(02).              09840000
100600         10  FILLER                      PIC  X(01).              09850000
100700         10  PV-REC-DD                   PIC  X(02).              09860000
100800         10  FILLER                      PIC  X(16).              09870000
100900     05  PV-R-DATE.                                               09880000
101000         10  PV-R-MM                     PIC  X(02).              09890000
101100         10  PV-SLASH-1                  PIC  X(01) VALUE '/'.    09900000
101200         10  PV-R-DD                     PIC  X(02).              09910000
101300         10  PV-SLASH-1                  PIC  X(01) VALUE '/'.    09920000
101400         10  PV-R-YY                     PIC  X(02).              09930000
101500     05  PV-SELECT-COUNT                 PIC S9(08)  VALUE +0.    09940000
101600     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZERO   09950000
101700                                                     COMP SYNC.   09960000
101800     05  PV-PAGES-REQ                    PIC  9(01)  VALUE ZEROS. 09970000
101900     05  PV-TOTAL-PAGES                  PIC  9(01)  VALUE ZEROS. 09980000
102000     05  PV-LAST-PAGE-COUNT              PIC S9(04)  VALUE ZEROS  09990000
102100                                                     COMP SYNC.   10000000
102200     05  PV-STR-NBR                      PIC S9(04)  VALUE +0     10010000
102300                                                     COMP.        10020000
102400     05  PV-DB2-COUNT                    PIC S9(9)   VALUE +0     10030000
102500                                                     COMP-3.      10040000
102600     05  PV-DB2-CURRENT-DATE             PIC  X(10)  VALUE SPACES.10050000
102700     05  PV-FRMTD-DIFF-OPER-UNT-ID.                               10060000
102800         10  FILLER                      PIC  X(01)  VALUE '('.   10070000
102900         10  PV-DIFF-OPER-UNT-ID         PIC  9(04)  VALUE ZEROS. 10080000
103000         10  FILLER                      PIC  X(01)  VALUE ')'.   10090000
103100     05  PV-EXPTED-ITM-CNT               PIC  9(06)  VALUE ZEROS. 10100000
103200     05  PV-STARTING-IDX-LOCATION        PIC  9(03)  VALUE ZEROS. 10110000
103300     05  PV-STR-CNT                      PIC  9(03)  VALUE ZEROS. 10120000
103400     05  PV-STORES-GIVEN-PIECES          PIC  9(04)  VALUE ZEROS. 10130000
103500     05  PV-RTV-STORES                   PIC  9(04)  VALUE ZEROS. 10140000
103600     05  PV-TOT-EXPTED-ITM-CNT           PIC  9(09)  VALUE ZEROS. 10150000
103700     05  PV-TOT-RTV-EXPTED-ITM-CNT       PIC  9(09)  VALUE ZEROS. 10160000
103800     05  PV-TABLE-STORE-COUNT            PIC S9(05)  VALUE ZERO   10170000
103900                                                     COMP-3.      10180000
104000     05  PV-CICS-RESP                    PIC S9(8) VALUE ZERO     10190000
104100                                                COMP SYNC.        10200000
104200     05  PV-CURRENT-DATE-X.                                       10210000
104300         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 10220000
104400         10  FILLER                      PIC  X(01)  VALUE '-'.   10230000
104500         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 10240000
104600         10  FILLER                      PIC  X(01)  VALUE '-'.   10250000
104700         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 10260000
104800     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            10270000
104900                                         PIC  X(10).              10280000
105000     05  PV-SQLCODE-NUMBER.                                       10290000
105100         10  FILLER                      PIC X(10)  VALUE         10300000
105200             'SQLCODE = '.                                        10310000
105300         10  PV-SQLCODE                  PIC +999.                10320000
105400     05  PV-DRS-ABEND-DISPLAY-LINE1.                              10330000
105500         10  FILLER                      PIC  X(14)  VALUE        10340000
105600             'DRRB ID = DRRB'.                                    10350000
105700         10  FILLER                      PIC  X(02)  VALUE SPACE. 10360000
105800         10  FILLER                      PIC  X(12)  VALUE        10370000
105900             'DRRB FUNC = '.                                      10380000
106000         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 10390000
106100         10  FILLER                      PIC  X(02)  VALUE SPACE. 10400000
106200         10  FILLER                      PIC  X(11)  VALUE        10410000
106300             'DRRB RID = '.                                       10420000
106400         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 10430000
106500         10  FILLER                      PIC  X(02)  VALUE SPACE. 10440000
106600         10  FILLER                      PIC  X(15)  VALUE        10450000
106700             'DRRB OPTIONS = '.                                   10460000
106800         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 10470000
106900     05  PV-DRS-ABEND-DISPLAY-LINE2.                              10480000
107000         10  FILLER                      PIC  X(10)  VALUE        10490000
107100             'DRRB RC = '.                                        10500000
107200         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 10510000
107300         10  FILLER                      PIC  X(02)  VALUE SPACE. 10520000
107400         10  FILLER                      PIC  X(18)  VALUE        10530000
107500             'DRRB ATTR-ERROR = '.                                10540000
107600         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 10550000
107700         10  FILLER                      PIC  X(02)  VALUE SPACE. 10560000
107800         10  FILLER                      PIC  X(12)  VALUE        10570000
107900             'DRRB DRDC = '.                                      10580000
108000         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 10590000
108100         10  FILLER                      PIC  X(02)  VALUE SPACE. 10600000
108200         10  FILLER                      PIC  X(13)  VALUE        10610000
108300             'DRRB LINES = '.                                     10620000
108400         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 10630000
108500     05  PV-DISPLAY-ITEM-NBR             PIC  9(15)  VALUE ZEROS. 10640000
108600     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 10650000
108700     05  PV-DISPLAY-KEYS.                                         10660000
108800         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  10670000
108900                                                BLANK WHEN ZEROS. 10680000
109000         10  FILLER                      PIC  X(02)  VALUE SPACE. 10690000
109100         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  10700000
109200                                                BLANK WHEN ZEROS. 10710000
109300         10  FILLER                      PIC  X(02)  VALUE SPACE. 10720000
109400         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  10730000
109500                                                BLANK WHEN ZEROS. 10740000
109600         10  FILLER                      PIC  X(02)  VALUE SPACE. 10750000
109700         10  PV-DISPLAY-WORK-ORD-SEQ-NBR PIC  9(04)  VALUE ZEROS  10760000
109800                                                BLANK WHEN ZEROS. 10770000
109900         10  FILLER                      PIC  X(02)  VALUE SPACE. 10780000
110000         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  10790000
110100                                                BLANK WHEN ZEROS. 10800000
110200         10  FILLER                      PIC  X(02)  VALUE SPACE. 10810000
110300         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  10820000
110400                                                BLANK WHEN ZEROS. 10830000
110500     05  PV-GP-QTY                       PIC  9(03)  VALUE ZEROS. 10840000
110600     05  PV-MAX-GROUP-PRICE-DIGITS       PIC  9(04)V9(02)         10850000
110700                                                     VALUE ZEROS. 10860000
110800     05  PV-EFF-DATE                     PIC  X(10)  VALUE SPACE. 10870000
110900     05  FILLER  REDEFINES  PV-EFF-DATE.                          10880000
111000         10  PV-EFF-DATE-CENTURY         PIC  X(02).              10890000
111100         10  PV-EFF-DATE-YEAR            PIC  X(02).              10900000
111200         10  FILLER                      PIC  X(01).              10910000
111300         10  PV-EFF-MONTH                PIC  X(02).              10920000
111400         10  FILLER                      PIC  X(01).              10930000
111500         10  PV-EFF-DAY                  PIC  X(02).              10940000
111600*                                                                 10950000
111700     05  PV-PRC-FCLTY-AREA-ID         PIC  X(06)  VALUE SPACES.   10960000
111800     05  PV-RETRY-COUNT               PIC  S9(4)  VALUE ZERO      10970000
111900                                                  COMP SYNC.      10980000
112000     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        10990000
112100                                                COMP SYNC.        11000000
112200     05  PV-SUBCLASS-NBR.                                         11010000
112300         10  FILLER                   PIC X(01) VALUE '0'.        11020000
112400         10  PV-SUBCLASS.                                         11030000
112500             15  PV-SUBCLASS-MAJ-NBR   PIC X(01).                 11040000
112600             15  PV-SUBCLASS-MIN-NBR  PIC X(01).                  11050000
112700     05  PV-MAJCLASS-NBR.                                         11060000
112800         10  PV-MAJCLASS-MAJ-NBR      PIC X(01).                  11070000
112900         10  FILLER                   PIC X(01) VALUE '0'.        11080000
113000*                                                                 11090000
113100*  USED FOR COMPUTING SORTATION CONTROL NUMBER CHECK DIGIT        11100000
113200     05  PV-CNTL-NBR-X                   PIC  X(13)  VALUE SPACE. 11110000
113300     05  PV-CNTL-NBR  REDEFINES  PV-CNTL-NBR-X                    11120000
113400                                         PIC  9(13).              11130000
113500     05  FILLER  REDEFINES  PV-CNTL-NBR.                          11140000
113600         10  PV-CNTL-NBR-DIGIT           PIC  9(01)               11150000
113700                                         OCCURS 13 TIMES          11160000
113800                                         INDEXED BY               11170000
113900                                         PV-DIGIT-IDX.            11180000
114000     05  PV-CNTL-NBR-PRODUCT             PIC  9(02)  VALUE ZEROS. 11190000
114100     05  FILLER  REDEFINES  PV-CNTL-NBR-PRODUCT.                  11200000
114200         10  PV-PRODUCT-DIGIT            PIC 9(01)                11210000
114300                                         OCCURS 2 TIMES.          11220000
114400     05  PV-CHECK-SUM                    PIC  9(03)  VALUE ZEROS. 11230000
114500     05  FILLER  REDEFINES  PV-CHECK-SUM.                         11240000
114600         10  FILLER                      PIC  9(02).              11250000
114700         10  PV-CKSUM-LEAST-SIGNIFICANT-DGT                       11260000
114800                                         PIC  9(01).              11270000
114900     05  PV-CHECK-DIGIT                  PIC  9(01)  VALUE ZEROS. 11280000
115000                                                                  11290000
115100 01  PV-CICS-MSG-AREA.                                            11300000
115200     05  FILLER                          PIC X(20) VALUE          11310000
115300                 '** PCKCS014 ** TASK='.                          11320000
115400     05  PV-TASK-NUMBER                  PIC Z(08).               11330000
115500     05  FILLER                          PIC X(07) VALUE          11340000
115600                 ' TIME= '.                                       11350000
115700     05  PV-TIME                         PIC X(08).               11360000
115800     05  FILLER                          PIC X(09) VALUE          11370000
115900         ' QUEUE = '.                                             11380000
116000     05  PV-QUEUE-NAME.                                           11390000
116100         10  PV-ADDRESS                  PIC X(4)  VALUE SPACES.  11400000
116200         10  PV-TASK                     PIC 9(5)  VALUE ZERO.    11410000
116300         10  PV-LAST-NUMBER              PIC X(1)  VALUE SPACES.  11420000
116400     05  FILLER                          PIC X(1)  VALUE SPACES.  11430000
116500     05  PV-CICS-MESSAGE                 PIC X(55) VALUE SPACES.  11440000
116600                                                                  11450000
116700 01  PV-CICS-KEYS.                                                11460000
116800     05  FILLER      PIC X(03) VALUE 'PO='.                       11470000
116900     05  PV-CICS-ORD PIC ZZZZZZZ9.                                11480000
117000     05  FILLER      PIC X(07) VALUE '; RCVR='.                   11490000
117100     05  PV-CICS-RCV PIC ZZZZZ9.                                  11500000
117200     05  FILLER      PIC X(07) VALUE '; LINE='.                   11510000
117300     05  PV-LINE     PIC 999.                                     11520000
117400     05  FILLER      PIC X(07) VALUE '; OPER='.                   11530000
117500     05  PV-OPER     PIC 999.                                     11540000
117600     05  FILLER      PIC X(08) VALUE '; FCLTY='.                  11550000
117700     05  PV-FCLTY    PIC 999.                                     11560000
117800                                                                  11570000
117900                                                                  11580000
118000                                                                  11590000
118100 01  ST-SYSTEM-TIME-DATE-AREA.                                    11600000
118200     05  ST-ABSTIME                      PIC S9(15)  VALUE ZERO   11610000
118300                                                     COMP-3.      11620000
118400     05  ST-SYSTEM-TIME.                                          11630000
118500         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 11640000
118600         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 11650000
118700             15  ST-SYSTEM-HOUR          PIC  X(02).              11660000
118800             15  FILLER                  PIC  X(01).              11670000
118900             15  ST-SYSTEM-MINUTE        PIC  X(02).              11680000
119000             15  FILLER                  PIC  X(01).              11690000
119100             15  ST-SYSTEM-SECOND        PIC  X(02).              11700000
119200     05  SD-SYSTEM-DATE.                                          11710000
119300         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 11720000
119400         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 11730000
119500             15  SD-SYSTEM-MONTH         PIC  X(02).              11740000
119600             15  FILLER                  PIC  X(01).              11750000
119700             15  SD-SYSTEM-DAY           PIC  X(02).              11760000
119800             15  FILLER                  PIC  X(01).              11770000
119900             15  SD-SYSTEM-YEAR          PIC  X(02).              11780000
120000         10  FILLER                      PIC  X(02)  VALUE SPACE. 11790000
120100     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       11800000
120200         10  FILLER                      PIC  X(06).              11810000
120300         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              11820000
120400     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     11830000
120500                                                     COMP.        11840000
120600*                                                                 11850000
120700*  THIS TABLE WILL CONSIST OF ALL STORES OPEN FOR RECEIVING       11860000
120800*  FOR THE CURRENT DATE, FOR A GIVEN DISTRIBUTION CENTER.         11870000
120900*                                                                 11880000
121000 01  ST-STORE-TABLE.                                              11890000
121100     05  ST-STORE-ENTRY                  OCCURS 1 TO 396 TIMES    11900000
121200                                         DEPENDING ON             11910000
121300                                            PV-TABLE-STORE-COUNT  11920000
121400                                         ASCENDING KEY IS         11930000
121500                                            ST-STR-NBR            11940000
121600                                         INDEXED BY ST-STR-IDX.   11950000
121700         10  ST-STR-NBR                  PIC S9(04) COMP.         11960000
121800         10  ST-CHAR5-ABBR-NAME          PIC X(5).                11970000
121900         10  ST-DC-NMBR                  PIC 9(4).                11980000
122000         10  ST-DC-RCT-START-DATE        PIC X(10).               11990000
122100         10  ST-DC-RCT-STOP-DATE         PIC X(10).               12000000
122200*                                                                 12010000
122300*  THIS TABLE WILL CONSIST OF ONLY THOSE STORES WHICH HAVE AN     12020000
122400*  EXPECTED ITEM COUNT. IT IS USED FOR PRINTING THE STORE DETAIL  12030000
122500*  LINE INFORMATION.                                              12040000
122600*                                                                 12050000
122700                                                                  12060000
122800 01  RA-RTV-ALLOC-TABLE.                                          12070000
122900     05  RA-ALLOC-ENTRY                  OCCURS 3 TIMES           12080000
123000                                         INDEXED BY RA-ALLOC-IDX. 12090000
123100         10  RA-STR-NBR                  PIC  9(04).              12100000
123200         10  RA-CHAR5-ABBR-NAME          PIC  X(05).              12110000
123300         10  RA-EXPTED-ITM-CNT           PIC  9(06).              12120000
123400         10  RA-DIFF-OPER-UNT-ID         PIC  X(06).              12130000
123500         10  RA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              12140000
123600         10  RA-CLOSED-IND               PIC  X(01).              12150000
123700             88  RA-STR-OPEN                  VALUE SPACE.        12160000
123800             88  RA-STR-CLOSED                VALUE '*'.          12170000
123900                                                                  12180000
124000*                                                                 12190000
124100 01  TL-BARCODE-LINE.                                             12200000
124200     05  FILLER                          PIC X(15)  VALUE         12210000
124300         '^M0101000^T0010'.                                       12220000
124400     05  FILLER                          PIC X(26)   VALUE        12230000
124500         'TOTAL STORES GIVEN ALLOCS:'.                            12240000
124600     05  FILLER                          PIC X(05)   VALUE SPACE. 12250000
124700     05  TL1-TOT-STR-GIVEN               PIC Z,ZZ9   VALUE ZERO.  12260000
124800     05  FILLER                          PIC X(19)   VALUE        12270000
124900         '^M0505000^T0750^BNZ'.                                   12280000
125000     05  TL-BARCODE-KEYREC-1             PIC X(08)   VALUE SPACES.12290000
125100     05  TL-BARCODE-REC-SEQ-1            PIC X(3)    VALUE SPACES.12300000
125200     05  TL-BARCODE-LINE-NMBR-X-1        PIC X(4)    VALUE SPACES.12310000
125300     05  TL-BARCODE-LINE-NMBR-1 REDEFINES TL-BARCODE-LINE-NMBR-X-112320000
125400                                         PIC 9(04).               12330000
125500     05  FILLER                          PIC X(4)    VALUE '^G^-'.12340000
125600*                                                                 12350000
125700 01  TL-NO-BARCODE-LINE.                                          12360000
125800     05  FILLER                          PIC X(26)   VALUE        12370000
125900         'TOTAL STORES GIVEN ALLOCS:'.                            12380000
126000     05  FILLER                          PIC X(05)   VALUE SPACE. 12390000
126100     05  TL1-TOT-STR-GIVEN-NB            PIC Z,ZZ9   VALUE ZERO.  12400000
126200                                                                  12410000
126300 01 TL2-TOTAL-LINE-2.                                             12420000
126400     05  FILLER                          PIC X(15)  VALUE         12430000
126500         '^M0101000^T0010'.                                       12440000
126600     05  FILLER                          PIC  X(26)  VALUE        12450000
126700         'TOTAL EXPECTED ITEM COUNT:'.                            12460000
126800     05  FILLER                          PIC  X(01)  VALUE SPACE. 12470000
126900     05  TL2-TOT-EXPTED-ITM-CNT          PIC Z,ZZZ,ZZ9.           12480000
127000     05  FILLER                          PIC X(15)  VALUE         12490000
127100         '^M0101000^T0750'.                                       12500000
127200* TRANSLATED TEXT                                                 12510000
127300     05  TL-BARCODE-KEYREC               PIC X(08)   VALUE SPACES.12520000
127400     05  FILLER                          PIC X(01)   VALUE SPACE. 12530000
127500     05  TL-BARCODE-REC-SEQ              PIC X(3)    VALUE SPACES.12540000
127600     05  FILLER                          PIC X(01)   VALUE SPACE. 12550000
127700     05  TL-BARCODE-LINE-NMBR-X          PIC X(4)    VALUE SPACES.12560000
127800     05  TL-BARCODE-LINE-NMBR  REDEFINES  TL-BARCODE-LINE-NMBR-X  12570000
127900                                         PIC 9(04).               12580000
128000     05  FILLER                          PIC X(01)   VALUE SPACE. 12590000
128100                                                                  12600000
128200*  SORTATION CONTROL NUMBER BARCODE                               12610000
128300     05  FILLER                          PIC X(19)   VALUE        12620000
128400         '^M0705000^T1000^BYZ'.                                   12630000
128500     05  TL-SORT-CONTROL-NBR.                                     12640000
128600         10 TL-SORT-KEYREC               PIC 9(08)   VALUE ZERO.  12650000
128700         10 TL-SORT-LINE-NBR             PIC 9(3)    VALUE ZERO.  12660000
128800         10 TL-SEQ-NBR                   PIC 9(2)    VALUE ZERO.  12670000
128900         10 TL-SORT-CHKDGT               PIC 9(1)    VALUE ZERO.  12680000
129000     05  FILLER                          PIC X(4)    VALUE '^G^-'.12690000
129100                                                                  12700000
129200                                                                  12710000
129300 01 TL2-TOTAL-LINE-2-NO-BARCODE.                                  12720000
129400     05  FILLER                          PIC  X(26)  VALUE        12730000
129500         'TOTAL EXPECTED ITEM COUNT:'.                            12740000
129600     05  FILLER                          PIC  X(01)  VALUE SPACE. 12750000
129700     05  TL2-TOT-EXPTED-ITM-CNT-NB       PIC Z,ZZZ,ZZ9.           12760000
129800                                                                  12770000
129900 01 TL3-TOTAL-LINE-3.                                             12780000
130000     05  FILLER                          PIC X(15)  VALUE         12790000
130100         '^M0101000^T0010'.                                       12800000
130200     05  FILLER                          PIC  X(26)  VALUE        12810000
130300         'TOTAL EXPECTED ITEM COUNT:'.                            12820000
130400     05  FILLER                          PIC  X(01)  VALUE SPACE. 12830000
130500     05  TL3-TOT-EXPTED-ITM-CNT          PIC Z,ZZZ,ZZ9.           12840000
130600     05  FILLER                          PIC X(15)  VALUE         12850000
130700         '^M0101000^T0750'.                                       12860000
130800* TRANSLATED TEXT                                                 12870000
130900     05  TL-BARCODE-KEYREC-2             PIC X(08)   VALUE SPACES.12880000
131000     05  FILLER                          PIC X(01)   VALUE SPACE. 12890000
131100     05  TL-BARCODE-REC-SEQ-2            PIC X(3)    VALUE SPACES.12900000
131200     05  FILLER                          PIC X(01)   VALUE SPACE. 12910000
131300     05  TL-BARCODE-LINE-NMBR-X2         PIC X(4)    VALUE SPACES.12920000
131400     05  TL-BARCODE-LINE-NMBR-2 REDEFINES TL-BARCODE-LINE-NMBR-X2 12930000
131500                                         PIC 9(04).               12940000
131600     05  FILLER                          PIC X(01)   VALUE SPACE. 12950000
131700     05  FILLER                          PIC X(2)    VALUE '^-'.  12960000
131800                                                                  12970000
131900                                                                  12980000
132000 01 TL3-TOTAL-LINE-3-NO-BARCODE.                                  12990000
132100     05  FILLER                          PIC  X(26)  VALUE        13000000
132200         'TOTAL EXPECTED ITEM COUNT:'.                            13010000
132300     05  FILLER                          PIC  X(01)  VALUE SPACE. 13020000
132400     05  TL3-TOT-EXPTED-ITM-CNT-NB       PIC Z,ZZZ,ZZ9.           13030000
132500                                                                  13040000
132600                                                                  13050000
132700 EJECT                                                            13060000
132800*                                                                 13070000
132900*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            13080000
133000*                                                                 13090000
133100     COPY DRRD001O.                                               13100000
133200                                                                  13110000
133300*                                                                 13120000
133400*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        13130000
133500*                                                                 13140000
133600     COPY DRRD002O.                                               13150000
133700                                                                  13160000
133800 EJECT                                                            13170000
133900*LMM - 1/27/05 -BEGIN                                             13180000
134000     COPY PEWS049.                                                13190000
134100*LMM - 1/27/05 -END                                               13200000
134200 EJECT                                                            13210000
134300*                                                                 13220000
134400*  SQL DB2 STORE TABLE CURSOR DECLARATION                         13230000
134500*                                                                 13240000
134600                                                                  13250000
134700     EXEC SQL                                                     13260000
134800         DECLARE STR-NBR-CSR  CURSOR FOR                          13270000
134900             SELECT A.LOC_NBR                                     13280000
135000                  , A.LOC_5_ABBR_NM                               13290000
135100                  , A.CLO_DTE                                     13300000
135200                  , A.CLO_DTE -                                   13310000
135300                            COALESCE(A.STP_ORD_DAYS_QTY,0) DAYS   13320000
135400                            AS EFF_STOP_DATE                      13330000
135500                  , B.EFF_BEG_DTE                                 13340000
135600                  , B.DC_NBR                                      13350000
135700               FROM XLT_LOC A                                     13360000
135800                  , XLT_DC_LOC_ASGMT B                            13370000
135900              WHERE A.LOC_TYP_CDE IN (:PC-DC, :PC-RV)             13380000
136000                AND B.LOC_NBR     = A.LOC_NBR                     13390000
136100                AND B.EFF_BEG_DTE =                               13400000
136200                (SELECT MAX(C.EFF_BEG_DTE)                        13410000
136300                   FROM XLT_DC_LOC_ASGMT C                        13420000
136400                  WHERE C.LOC_NBR = A.LOC_NBR                     13430000
136500                    AND DATE(EFF_BEG_DTE) <= CURRENT DATE         13440000
136600                )                                                 13450000
136700           ORDER BY A.LOC_NBR                                     13460000
136800     END-EXEC.                                                    13470000
136900                                                                  13480000
137000*                                                                 13490000
137100*  SQL DB2 RECEIPT ITEM DISTRIBUTION CURSOR DECLARATION           13500000
137200*                                                                 13510000
137300     EXEC SQL                                                     13520000
137400          DECLARE RECDIS-CSR CURSOR FOR                           13530000
137500              SELECT  A.STR_NBR,                                  13540000
137600                      A.EXPTED_ITM_QTY                            13550000
137700                FROM  TRECDIS A                                   13560000
137800                    , XLT_LOC B                                   13570000
137900               WHERE  (A.ORD_NBR           =  :DK-ORD-NBR         13580000
138000                 AND   A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR     13590000
138100                 AND   A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR    13600000
138200                 AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID     13610000
138300                 AND   A.FCLTY_ID          =  :DK-FCLTY-ID        13620000
138500                 AND   A.EXPTED_ITM_QTY    >  :PC-ZERO            13640000
138600                 AND   A.STR_NBR           =  B.LOC_NBR           13650000
138700                 AND   B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV))     13660000
138800            ORDER BY  1, 2                                        13670000
138900     END-EXEC.                                                    13680000
139000                                                                  13690000
139100*                                                                 13700000
139200*  SQL DB2 LINE LOCATION CURSOR DECLARATION                       13710000
139300*                                                                 13720000
139400     EXEC SQL                                                     13730000
139500          DECLARE LNELOC-CSR CURSOR FOR                           13740000
139600              SELECT  STRT_TMST,                                  13750000
139700                      LNE_LOC_CDE,                                13760000
139800                      SCREEN_SEQ_NBR                              13770000
139900                FROM  TWKORIN                                     13780000
140000               WHERE  (ORD_NBR           =  :DK-ORD-NBR           13790000
140100                 AND   RCVR_SEQ_NBR      =  :DK-RCVR-SEQ-NBR      13800000
140200                 AND   ORD_LNE_NBR       =  :DK-ORD-LNE-NBR       13810000
140300                 AND   WORK_ORD_SEQ_NBR  =  :DK-WORK-ORD-SEQ-NBR  13820000
140400                 AND   OPER_UNT_ID       =  :DK-OPER-UNT-ID       13830000
140500                 AND   FCLTY_ID          =  :DK-FCLTY-ID          13840000
140600                 AND   VER_STATUS_CDE    =  'A')                  13850000
140700            ORDER BY  SCREEN_SEQ_NBR                              13860000
140800     END-EXEC.                                                    13870000
140900                                                                  13880000
141000*                                                                 13890000
141100*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      13900000
141200*                                                                 13910000
141300     EXEC SQL                                                     13920000
141400          DECLARE TRBL-CSR1 CURSOR FOR                            13930000
141500              SELECT  B.TRBL_LONG_DESC                            13940000
141600                FROM  TTRBNTF A                                   13950000
141700                    , TTRBRSN B                                   13960000
141800               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           13970000
141900                 AND ((A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       13980000
142000                 AND   B.TRBL_LVL_IND     <> :PC-M)               13990000
142100                 OR   (A.PREPK_ID        =  :DK-PREPK-ID          14000000
142200                 AND   B.TRBL_LVL_IND     =  :PC-M))              14010000
142300                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      14020000
142400                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       14030000
142500                 AND   A.RESOLVED_IND    IN ('N', 'I')            14040000
142600                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE)       14050000
142700     END-EXEC.                                                    14060000
142800                                                                  14070000
142900                                                                  14080000
143000     EXEC SQL                                                     14090000
143100          DECLARE TRBL-CSR2 CURSOR FOR                            14100000
143200              SELECT  B.TRBL_LONG_DESC,                           14110000
143300                      A.RESOLVED_IND                              14120000
143400                FROM  TTRBNTF A                                   14130000
143500                    , TTRBRSN B                                   14140000
143600               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           14150000
143700                 AND ((A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       14160000
143800                 AND   B.TRBL_LVL_IND     <> :PC-M)               14170000
143900                 OR   (A.PREPK_ID        =  :DK-PREPK-ID          14180000
144000                 AND   B.TRBL_LVL_IND     =  :PC-M))              14190000
144100                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      14200000
144200                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       14210000
144300                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE        14220000
144400                 AND   B.NOTIF_IND       =  :PC-T)                14230000
144500     END-EXEC.                                                    14240000
149600/                                                                 14250000
149700     COPY DPWS276.                                                14260000
149800 01  PV-SAVE-OTR-AREA.                                            14270000
149900     05  PV-SAVE-OTR-TABLE OCCURS 3 TIMES                         14280000
150000             INDEXED BY PV-SAVE-OTR-IDX.                          14290000
150100         10 PV-OTR-DIST          PIC 9(4).                        14300000
150200         10 PV-SAVE-OTR          PIC X(32000).                    14310000
150300*        10 PV-SAVE-OTR          PIC X(23000).                    14320000
150400* THIS TABLE HOLDS THE OTR TABLES FOR UP TO 3 D.C.'S.             14330000
150500/                                                                 14340000
150600******************************************************************14350000
150700 LINKAGE SECTION.                                                 14360000
150800******************************************************************14370000
150900 01  DFHCOMMAREA.                                                 14380000
151000     05  FILLER                       OCCURS 1 TO 600 TIMES       14390000
151100                                      DEPENDING ON EIBCALEN.      14400000
151200         10  FILLER                   PIC X.                      14410000
151300                                                                  14420000
151400 PROCEDURE DIVISION.                                              14430000
151500                                                                  14440000
151600     MOVE EIBTASKN        TO  PV-TASK-NUMBER                      14450000
151700                                                                  14460000
151800                                                                  14470000
151900     PERFORM 1000-INITIALIZE.                                     14480000
152000                                                                  14490000
152100     PERFORM 2000-PROCESS-TABLE                                   14500000
152200              UNTIL PS-EOF-TABLE.                                 14510000
152300                                                                  14520000
152400                                                                  14530000
152500 0000-GOBACK.                                                     14540000
152600                                                                  14550000
152700     GOBACK.                                                      14560000
152800 EJECT                                                            14570000
152900 1000-INITIALIZE.                                                 14580000
153000* SETUP KEY FIELDS                                                14590000
153100     MOVE DFHCOMMAREA           TO CA-COMMAREA.                   14600000
153200     MOVE CA-ORD-NBR            TO DK-ORD-NBR.                    14610000
153300     MOVE CA-RCVR-SEQ-NBR       TO DK-RCVR-SEQ-NBR.               14620000
153400     MOVE CA-OPER-UNT-ID(2:3)   TO DK-OPER-UNT-ID.                14630000
153500     MOVE CA-FCLTY-ID           TO DK-FCLTY-ID.                   14640000
153600                                                                  14650000
153700                                                                  14660000
153800*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        14670000
153900*  IN PCKCS013                                                    14680000
154000     MOVE CA-DRIB-AREA(1:264)   TO DRS01-COMMAREA.                14690000
154100     MOVE CA-DRIB-AREA(265:216) TO DRS02-DRIB.                    14700000
154200                                                                  14710000
154300                                                                  14720000
154400* SETUP DATE AND TIME FOR REPORT HEADERS                          14730000
154500     EXEC CICS                                                    14740000
154600         ASKTIME ABSTIME (ST-ABSTIME)                             14750000
154700     END-EXEC.                                                    14760000
154800     EXEC CICS                                                    14770000
154900         FORMATTIME ABSTIME  (ST-ABSTIME)                         14780000
155000                    MMDDYY   (SD-MMDDYY-FORMAT)                   14790000
155100                    DATESEP                                       14800000
155200                    TIME     (ST-HHMMSS-FORMAT)                   14810000
155300                    TIMESEP                                       14820000
155400     END-EXEC.                                                    14830000
155500     EXEC CICS                                                    14840000
155600         FORMATTIME ABSTIME  (ST-ABSTIME)                         14850000
155700                       YEAR  (SD-YYYY-FORMAT)                     14860000
155800     END-EXEC.                                                    14870000
155900     MOVE SD-YYYY-FORMAT  TO  PV-CURRENT-CENTURY-YEAR.            14880000
156000     MOVE SD-SYSTEM-MONTH TO  PV-CURRENT-MONTH.                   14890000
156100     MOVE SD-SYSTEM-DAY   TO  PV-CURRENT-DAY.                     14900000
156200                                                                  14910000
156300     SET ST-STR-IDX                                               14920000
156400         RA-ALLOC-IDX TO 1.                                       14930000
156500     INITIALIZE RA-RTV-ALLOC-TABLE.                               14940000
156600                                                                  14950000
156700*  BUILD TABLE OF STORES                                          14960000
156800     PERFORM 7000-OPEN-STR-NBR-CSR.                               14970000
156900     PERFORM 7010-FETCH-STR-NBR-CSR.                              14980000
157000                                                                  14990000
157100     PERFORM 1200-LOAD-STR-NBR-TBL                                15000000
157200         VARYING ST-STR-IDX FROM 1 BY 1                           15010000
157300         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         15020000
157400         OR ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES.               15030000
157500     IF ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES                    15040000
157600         PERFORM 7020-CLOSE-STR-NBR-CSR                           15050000
157700         MOVE '1200-LOAD-STR-NBR-TBL'                             15060000
157800             TO DP013-PARAGRAPH                                   15070000
157900         MOVE 'STR TBL OVERFLOW.  MAX OCCURANCES IS: '            15080000
158000             TO DP013-MESSAGE-TEXT (1)                            15090000
158100         MOVE PC-MAX-STR-TBL-OCCURANCES                           15100000
158200             TO DP013-MESSAGE-TEXT (2)                            15110000
158300         SET DP013-LOGIC-ABEND TO TRUE                            15120000
158400         SET DP013-NO-ROLLBACK TO TRUE                            15130000
158500         PERFORM 9999-WRITE-CICS-LOG-MSG                          15140000
158600         GO TO 0000-GOBACK                                        15150000
158700     END-IF.                                                      15160000
158800     PERFORM 7020-CLOSE-STR-NBR-CSR.                              15170000
158900                                                                  15180000
159000                                                                  15190000
159100**************************************************************    15200000
159200* GET REPORT HEADER INFORMATION                                   15210000
159300**************************************************************    15220000
159400                                                                  15230000
159500                                                                  15240000
159600     PERFORM 7100-SELECT-PO-HDR-DATA.                             15250000
159700     MOVE CA-ORD-NBR-X           TO  HL5-PO-NBR.                  15260000
159800     MOVE PURCHS-DEPT-NBR        TO  HL5-DEPT-NBR.                15270000
159900                                                                  15280000
160000     PERFORM 7110-GET-KEYREC-NBR.                                 15290000
160100     MOVE RECEIV-RCVR-NBR        TO  HL4-KEYREC.                  15300000
160200     MOVE RECEIV-EXPTED-CART-CNT TO  HL5-TOT-CARTON-CNT.          15310000
160300     MOVE RECEIV-ACTL-CART-CNT   TO  HL6-TOT-CARTON-CNT.          15320000
160400     MOVE RECEIV-GOH-IND         TO  HL8-HANGER.                  15330000
160500     MOVE PV-REC-MM              TO  PV-R-MM.                     15340000
160600     MOVE PV-REC-DD              TO  PV-R-DD.                     15350000
160700     MOVE PV-REC-YY              TO  PV-R-YY.                     15360000
160800     MOVE PV-R-DATE              TO  HL7-REC-DATE                 15370000
160900                                                                  15380000
161000     PERFORM 7120-GET-PRIMARY-VNDR-NME.                           15390000
161100     MOVE ENTNME-ENT-NAME-DESC   TO  HL4-VNDR-NME.                15400000
161200     MOVE CA-DESTINATION         TO  HL4-PRINTER-DEST.            15410000
161300                                                                  15420000
161700     PERFORM 7140-GET-SPECIAL-INSTRS.                             15430000
161800     EVALUATE TRUE                                                15440000
161900     WHEN PS-NO-SPECIAL-INSTRS-FOUND                              15450000
162000             CONTINUE                                             15460000
162100     WHEN PS-MULT-SPECIAL-INSTRS-FOUND                            15470000
162200         MOVE PC-MULT-SPECIAL-INSTRS-MSG  TO  HL14-SPECIAL-INSTR  15480000
162300     WHEN OTHER                                                   15490000
162400         MOVE INSTCD-INSTR-DESC       TO  HL14-SPECIAL-INSTR      15500000
162500     END-EVALUATE.                                                15510000
162600                                                                  15520000
162700                                                                  15530000
162800* GET THE FIRST TS QUEUE RECORD FOR PROCESSING                    15540000
162900     SET LINE-IDX        TO 1.                                    15550000
163000                                                                  15560000
163100* LOAD KEY FIELDS FROM THE QUEUE RECORD FIRST OCCURRENCE          15570000
163200     MOVE CA-ORD-NBR          TO DK-ORD-NBR.                      15580000
163300     MOVE CA-RCVR-SEQ-NBR     TO DK-RCVR-SEQ-NBR.                 15590000
163400     MOVE CA-LINE-NBR (1)     TO DK-ORD-LNE-NBR                   15600000
163500                                 CA-ORD-LNE-NBR.                  15610000
163600     MOVE CA-OPER-UNT-ID-N    TO DK-OPER-UNT-ID.                  15620000
163700     MOVE CA-FCLTY-ID-N       TO DK-FCLTY-ID.                     15630000
163800                                                                  15640000
163900     MOVE CA-OPER-UNT-ID      TO  HL2-OPERATING-ID.               15650000
164000     MOVE CA-FCLTY-ID         TO  HL2-FACILITY-ID.                15660000
164100                                                                  15670000
164200     PERFORM 4050-SELECT-PRIM-SHIP                                15680000
164300                                                                  15690000
164400     MOVE CA-RCVR-SEQ-NBR-X   TO  HL6-RCVR-SEQ-NBR.               15700000
164500     MOVE CA-ORD-LNE-NBR-X    TO  HL7-LINE-NBR.                   15710000
164600     MOVE CA-WORK-ORD-SEQ-NBR-X                                   15720000
164700                              TO HL8-WORK-ORD-NBR.                15730000
164800                                                                  15740000
164900     INITIALIZE RA-RTV-ALLOC-TABLE.                               15750000
165000     MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                         15760000
165100                    PV-STORES-GIVEN-PIECES                        15770000
165200                    PV-TOT-RTV-EXPTED-ITM-CNT                     15780000
165300                    PV-STR-CNT                                    15790000
165400                    PV-RTV-STORES.                                15800000
165500     SET RA-ALLOC-IDX         TO 1.                               15810000
165600                                                                  15820000
165700/                                                                 15830000
165800 1200-LOAD-STR-NBR-TBL.                                           15840000
165900                                                                  15850000
166000     MOVE XLT00010-LOC-NBR       TO ST-STR-NBR (ST-STR-IDX)       15860000
166100     MOVE XLT00010-LOC-5-ABBR-NM TO ST-CHAR5-ABBR-NAME            15870000
166200                                   (ST-STR-IDX)                   15880000
166300                                                                  15890000
166400     MOVE XLT00014-DC-NBR        TO ST-DC-NMBR (ST-STR-IDX)       15900000
166500     MOVE XLT00014-EFF-BEG-DTE   TO ST-DC-RCT-START-DATE          15910000
166600                                   (ST-STR-IDX)                   15920000
166700     MOVE PV-EFF-CLOSE-DATE      TO ST-DC-RCT-STOP-DATE           15930000
166800                                   (ST-STR-IDX)                   15940000
166900                                                                  15950000
167000     ADD +1                      TO PV-TABLE-STORE-COUNT          15960000
167100                                                                  15970000
167200     PERFORM 7010-FETCH-STR-NBR-CSR.                              15980000
167300     EJECT                                                        15990000
167400 2000-PROCESS-TABLE.                                              16000000
167500                                                                  16010000
167600     SET PS-DONT-PRINT-NO-DISTRO-MSG                              16020000
167700         PS-DONT-PRINT-STORE-PROBLEM                              16030000
167800         PS-NO-UPDATES-DONE      TO TRUE.                         16040000
167900                                                                  16050000
168000     INITIALIZE XL001-ITEM-COMMAREA.                              16060000
168100                                                                  16070000
168200     PERFORM 7200-SELECT-PURITM-DATA.                             16080000
168300                                                                  16090000
168400     MOVE PURITM-SKU-DESC        TO  HL9-LNE-ITM-DESC.            16100000
168500     MOVE PURITM-SIZE-DESC       TO  HL10-SIZE-DESC.              16110000
168600     MOVE PURITM-COLOR-DESC      TO  HL11-COLOR-DESC.             16120000
168700     MOVE PURITM-UNT-RTL-PR-AMT  TO  HL12-UNT-RTL-PR-AMT.         16130000
168800     MOVE PURITM-VEND-STYL-NAME  TO  HL10-VNDR-STYLE-NME.         16140000
168900     MOVE RECITM-TKT-FMT-ID      TO  DK-TKT-FMT-ID.               16150000
169000     MOVE RECITM-PRE-TKT-IND     TO  HL13A-PRETICKET-IND          16160000
169100                                                                  16170000
169200     IF   PS-CALL-API-YES                 AND                     16180000
169300        ((PURITM-SKU-SEQ-NBR NOT = PC-000 AND                     16190000
169400          PURITM-SKU-SEQ-NBR NOT = PC-999))                       16200000
169500                                                                  16210000
169600         PERFORM 7205-CALL-CICS-API-ARCH                          16220000
169700         MOVE XL001-SKU-NBR          TO  HL5-SEQ-NBR              16230000
169800                                                                  16240000
169900     ELSE                                                         16250000
170000         MOVE ZEROES TO HL5-SEQ-NBR                               16260000
170100         MOVE SPACES TO HL8-SKU-DESC                              16270000
170200                        HL6-SIZE                                  16280000
170300                        HL7-COLOR                                 16290000
170400                        HL9-VNDR-STYLE-NME                        16300000
170500                        HL9-PRESENTATION                          16310000
170600                        HL5-CLASS-NBR                             16320000
170700                                                                  16330000
170800         IF PURITM-SKU-SEQ-NBR = PC-000                           16340000
170900            MOVE '00000000'      TO  HL5-SEQ-NBR                  16350000
171000         ELSE                                                     16360000
171100            IF PURITM-SKU-SEQ-NBR = PC-999                        16370000
171200               MOVE '99999999'   TO  HL5-SEQ-NBR                  16380000
171300            END-IF                                                16390000
171400         END-IF                                                   16400000
171500     END-IF                                                       16410000
171600                                                                  16420000
171700     PERFORM 4300-GET-TKT-DESC.                                   16430000
171800     PERFORM 4310-GET-TKT-PLACEMENT.                              16440000
171900                                                                  16450000
172000     PERFORM 7220-SELECT-TRECITM                                  16460000
172100     MOVE RECITM-PREPK-ID            TO  DK-PREPK-ID              16470000
172200     IF XL001-SKU-SQLCODE = PC-ROW-NOT-FOUND                      16480000
172300         MOVE RECITM-SIZE-DESC       TO  HL6-SIZE                 16490000
172400         MOVE RECITM-COLOR-DESC      TO  HL7-COLOR                16500000
172500     ELSE                                                         16510000
172600         MOVE XL001-SIZE-DESC        TO  HL6-SIZE                 16520000
172700         MOVE XL001-CSTM-CLOR-DESC   TO  HL7-COLOR                16530000
172800     END-IF.                                                      16540000
172900                                                                  16550000
173000     PERFORM 2100-FIND-LNE-LOC.                                   16560000
173100                                                                  16570000
173200     PERFORM 2200-PO-LINE-TRBL.                                   16580000
173300                                                                  16590000
173400     PERFORM 2230-PO-LINE-TRBL.                                   16600000
173500                                                                  16610000
173600     INITIALIZE PV-SAVE-OTR-AREA.                                 16620000
173700     SET PV-SAVE-OTR-IDX         TO 1.                            16630000
173800     SEARCH PV-SAVE-OTR-TABLE                                     16640000
173900         WHEN CA-OPER-UNT-ID-N = PV-OTR-DIST (PV-SAVE-OTR-IDX)    16650000
174000             CONTINUE                                             16660000
174100         WHEN PV-OTR-DIST (PV-SAVE-OTR-IDX) = ZERO                16670000
174200             MOVE CA-OPER-UNT-ID-N TO PV-OTR-DIST(PV-SAVE-OTR-IDX)16680000
174300             PERFORM 4200-CALC-OPEN-TO-REC                        16690000
174400             MOVE DP276-OTR-TABLE TO PV-SAVE-OTR (PV-SAVE-OTR-IDX)16700000
174500     END-SEARCH.                                                  16710000
174600                                                                  16720000
174700                                                                  16730000
174800     SET PS-NO-RTV-DISTRO TO TRUE.                                16740000
174900     PERFORM 2500-GET-RECDIS-DATA.                                16750000
175000                                                                  16760000
175100*    PERFORM 2600-UPC-CERTIFICATION.                              16770000
175200                                                                  16780000
175300     PERFORM 7410-SELECT-MKING-TMST.                              16790000
175400                                                                  16800000
175500     MOVE PC-ROWS-PER-PAGE-30       TO PV-ROWS-PER-PAGE.          16810000
175600                                                                  16820000
175700     IF TL2-TRBL-DESC (1) = SPACES                                16830000
175800         CONTINUE                                                 16840000
175900     ELSE                                                         16850000
176000         SUBTRACT 2 FROM PV-ROWS-PER-PAGE                         16860000
176100     END-IF.                                                      16870000
176200                                                                  16880000
176300     MOVE 1 TO PV-PAGES-REQ.                                      16890000
176400     MOVE 1  TO PV-TOTAL-PAGES.                                   16900000
176500                                                                  16910000
176600     MOVE PV-STR-CNT TO PV-STRS-ON-LAST-PAGE.                     16920000
176700                                                                  16930000
176800     PERFORM 4000-PRODUCE-RPT                                     16940000
176900         VARYING PS-RTV-SUB                                       16950000
177000         FROM 1 BY 1                                              16960000
177100         UNTIL PS-RTV-SUB > PC-3 OR                               16970000
177200               RA-STR-NBR (PS-RTV-SUB) = ZEROS.                   16980000
177300                                                                  16990000
177400* GET THE NEXT QUEUE RECORD                                       17000000
177500     PERFORM 9200-GET-NEXT-PO.                                    17010000
177600                                                                  17020000
177700                                                                  17030000
177800 EJECT                                                            17040000
177900******************************************************************17050000
178000*  DETERMINE THE CURRENT LINE LOCATION.                           17060000
178100******************************************************************17070000
178200 2100-FIND-LNE-LOC.                                               17080000
178300     PERFORM 7230-OPEN-LNELOC-CSR.                                17090000
178400     PERFORM 7240-FETCH-LNELOC-CSR.                               17100000
178500     PERFORM 2110-DETERMINE-LOC-LOC                               17110000
178600         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        17120000
178700     PERFORM 7250-CLOSE-LNELOC-CSR.                               17130000
178800*                                                                 17140000
178900******************************************************************17150000
179000*  THE CURRENT LINE LOCATION WILL HAVE A STARTING TIME STAMP      17160000
179100*  EQUAL TO THE DUMMY DATE.                                       17170000
179200******************************************************************17180000
179300 2110-DETERMINE-LOC-LOC.                                          17190000
179400     IF WKORIN-STRT-TMST  =  PC-DB2-DUMMY-DATE                    17200000
179500         CONTINUE                                                 17210000
179600     ELSE                                                         17220000
179700         MOVE WKORIN-LNE-LOC-CDE  TO  HL3-LNE-LOC                 17230000
179800     END-IF.                                                      17240000
179900     PERFORM 7240-FETCH-LNELOC-CSR.                               17250000
180000     EJECT                                                        17260000
180100 2200-PO-LINE-TRBL.                                               17270000
180200     PERFORM 7260-OPEN-TRBL-CSR.                                  17280000
180300     PERFORM 7270-FETCH-TRBL-CSR.                                 17290000
180400     INITIALIZE TL2-TROUBLE-LINE-2.                               17300000
180500     PERFORM 2210-LOAD-TRBL-TBL                                   17310000
180600         VARYING TRBL-IDX FROM 1 BY 1                             17320000
180700         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         17330000
180800         OR TRBL-IDX > 5.                                         17340000
180900     PERFORM 7280-CLOSE-TRBL-CSR.                                 17350000
181000                                                                  17360000
181100******************************************************************17370000
181200*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            17380000
181300******************************************************************17390000
181400 2210-LOAD-TRBL-TBL.                                              17400000
181500     MOVE TRBRSN-TRBL-LONG-DESC TO TL2-TRBL-DESC (TRBL-IDX).      17410000
181600     PERFORM 7270-FETCH-TRBL-CSR.                                 17420000
181700     EJECT                                                        17430000
181800 2230-PO-LINE-TRBL.                                               17440000
181900     PERFORM 7265-OPEN-TRBL-CSR2.                                 17450000
182000     PERFORM 7275-FETCH-TRBL-CSR2.                                17460000
182100     INITIALIZE TL3-TROUBLE-LINE-3.                               17470000
182200     PERFORM 2240-LOAD-TRBL-TBL2                                  17480000
182300         VARYING TRBL-IDX2 FROM 1 BY 1                            17490000
182400         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         17500000
182500         OR TRBL-IDX2 > 5.                                        17510000
182600     PERFORM 7285-CLOSE-TRBL-CSR2.                                17520000
182700                                                                  17530000
182800******************************************************************17540000
182900*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            17550000
183000******************************************************************17560000
183100 2240-LOAD-TRBL-TBL2.                                             17570000
183200     MOVE TRBRSN-TRBL-LONG-DESC TO TL3-TRBL-DESC (TRBL-IDX2).     17580000
183300     MOVE PC-DASH               TO TL3-DASH (TRBL-IDX2).          17590000
183400     IF TRBNTF-RESOLVED-IND = (PC-N OR PC-I)                      17600000
183500         MOVE PC-U              TO TL3-TRBL-IND (TRBL-IDX2)       17610000
183600     ELSE                                                         17620000
183700         MOVE PC-R              TO TL3-TRBL-IND (TRBL-IDX2)       17630000
183800     END-IF.                                                      17640000
183900     PERFORM 7275-FETCH-TRBL-CSR2.                                17650000
184000     EJECT                                                        17660000
184100                                                                  17670000
184200******************************************************************17680000
184300*  THIS MODULE RETRIEVES DATA FROM THE RECEIPT ITEM DISTRIBUTION  17690000
184400*  TABLE.  THE RECEIPT ITEM DISTRIBUTION TABLE IS ACCESSED WHEN   17700000
184500*  THE WORK ORDER DISTRIBUTION INDICATOR IS EQUAL TO A 'N'.       17710000
184600******************************************************************17720000
184700 2500-GET-RECDIS-DATA.                                            17730000
184800     PERFORM 7320-OPEN-RECDIS-CSR.                                17740000
184900     PERFORM 7330-FETCH-RECDIS-CSR.                               17750000
185000     PERFORM 2510-PROCESS-RECDIS-ROWS                             17760000
185100         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        17770000
185200     PERFORM 7340-CLOSE-RECDIS-CSR.                               17780000
185300*                                                                 17790000
185400 2510-PROCESS-RECDIS-ROWS.                                        17800000
185500     MOVE RECDIS-STR-NBR         TO  PV-STR-NBR.                  17810000
185600     MOVE RECDIS-EXPTED-ITM-QTY  TO  PV-EXPTED-ITM-CNT.           17820000
185700     SET RA-STR-OPEN(RA-ALLOC-IDX)                                17830000
185800         PS-SAME-OPER-UNIT-ID      TO TRUE.                       17840000
185900                                                                  17850000
186000     SEARCH ALL ST-STORE-ENTRY                                    17860000
186100         AT END                                                   17870000
186200             SET RA-STR-CLOSED(RA-ALLOC-IDX)                      17880000
186300                 PS-PRINT-STORE-PROBLEM                           17890000
186400                                 TO TRUE                          17900000
186500         WHEN ST-STR-NBR (ST-STR-IDX) = PV-STR-NBR                17910000
186600             PERFORM 2511-CHECK-IF-OPEN                           17920000
186700             PERFORM 2520-FILL-PRINT-TBL                          17930000
186800     END-SEARCH.                                                  17940000
186900                                                                  17950000
187000     PERFORM 7330-FETCH-RECDIS-CSR.                               17960000
187100 2511-CHECK-IF-OPEN.                                              17970000
187200     EVALUATE TRUE                                                17980000
187300     WHEN ST-DC-NMBR (ST-STR-IDX) = CA-OPER-UNT-ID (2:3)          17990000
187400         IF  (PV-CURRENT-DATE NOT < ST-DC-RCT-START-DATE          18000000
187500                                  (ST-STR-IDX))                   18010000
187600             AND                                                  18020000
187700             (PV-CURRENT-DATE NOT > ST-DC-RCT-STOP-DATE           18030000
187800                                  (ST-STR-IDX))                   18040000
187900             CONTINUE                                             18050000
188000         ELSE                                                     18060000
188100             SET RA-STR-CLOSED(RA-ALLOC-IDX)                      18070000
188200                 PS-PRINT-STORE-PROBLEM                           18080000
188300                                 TO TRUE                          18090000
188400         END-IF                                                   18100000
188500     WHEN OTHER                                                   18110000
188600*DIFFERENT OPER UNIT                                              18120000
188700         SET PS-DIFF-OPER-UNIT-ID TO TRUE                         18130000
188800     END-EVALUATE.                                                18140000
188900                                                                  18150000
189000                                                                  18160000
189100******************************************************************18170000
189200*  MOVE THE NECESSARY FIELDS TO THE WORKING STORAGE TABLE USED    18180000
189300*  FOR PRINTING THE REPORT.                                       18190000
189400******************************************************************18200000
189500 2520-FILL-PRINT-TBL.                                             18210000
189600     SET PS-RTV-DISTRO TO TRUE.                                   18220000
189700     PERFORM 2540-INSERT-TO-RA-TABLE.                             18230000
189800                                                                  18240000
189900                                                                  18250000
190000 2540-INSERT-TO-RA-TABLE.                                         18260000
190100     MOVE PV-STR-NBR             TO RA-STR-NBR (RA-ALLOC-IDX)     18270000
190200     MOVE ST-CHAR5-ABBR-NAME (ST-STR-IDX)                         18280000
190300                                 TO RA-CHAR5-ABBR-NAME            18290000
190400                                   (RA-ALLOC-IDX)                 18300000
190500                                                                  18310000
190600     IF PS-DIFF-OPER-UNIT-ID                                      18320000
190700         MOVE ST-DC-NMBR (ST-STR-IDX)                             18330000
190800                                 TO PV-DIFF-OPER-UNT-ID           18340000
190900         MOVE PV-FRMTD-DIFF-OPER-UNT-ID                           18350000
191000                                 TO RA-DIFF-OPER-UNT-ID           18360000
191100                                    (RA-ALLOC-IDX)                18370000
191200         IF PV-DIFF-OPER-UNT-ID = SPACES OR ZERO                  18380000
191300             CONTINUE                                             18390000
191400         ELSE                                                     18400000
191500             SET PV-SAVE-OTR-IDX TO 1                             18410000
191600             SEARCH PV-SAVE-OTR-TABLE                             18420000
191700                 WHEN PV-DIFF-OPER-UNT-ID = PV-OTR-DIST           18430000
191800                                         (PV-SAVE-OTR-IDX)        18440000
191900                      MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)          18450000
192000                                 TO DP276-OTR-TABLE               18460000
192100                 WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO         18470000
192200                     MOVE PV-DIFF-OPER-UNT-ID                     18480000
192300                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  18490000
192400                     PERFORM 4200-CALC-OPEN-TO-REC                18500000
192500                     MOVE DP276-OTR-TABLE                         18510000
192600                                 TO                               18520000
192700                          PV-SAVE-OTR (PV-SAVE-OTR-IDX)           18530000
192800             END-SEARCH                                           18540000
192900         END-IF                                                   18550000
193000     ELSE                                                         18560000
193100         SET PV-SAVE-OTR-IDX TO 1                                 18570000
193200         SEARCH PV-SAVE-OTR-TABLE                                 18580000
193300             WHEN CA-OPER-UNT-ID-N = PV-OTR-DIST (PV-SAVE-OTR-IDX)18590000
193400                 MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)               18600000
193500                                 TO DP276-OTR-TABLE               18610000
193600         END-SEARCH                                               18620000
193700     END-IF.                                                      18630000
193800                                                                  18640000
193900     MOVE PV-STR-NBR            TO DP276-SEARCH-NBR.              18650000
194000     PERFORM 4210-SEARCH-OTR.                                     18660000
194100     MOVE DP276-OTR-OUT         TO PV-OTR.                        18670000
194200     MOVE DP276-OTR-OUT-X       TO RA-ITEMS-OPEN-TO-RECEIVE       18680000
194300                                   (RA-ALLOC-IDX).                18690000
194400                                                                  18700000
194500     IF DP276-NO-DISTRO                                           18710000
194600         SET PS-PRINT-NO-DISTRO-MSG TO TRUE                       18720000
194700     END-IF.                                                      18730000
194800                                                                  18740000
194900                                                                  18750000
195000     MOVE PV-EXPTED-ITM-CNT                                       18760000
195100         TO  RA-EXPTED-ITM-CNT (RA-ALLOC-IDX).                    18770000
195200     COMPUTE  PV-TOT-EXPTED-ITM-CNT  =                            18780000
195300         PV-EXPTED-ITM-CNT  +  PV-TOT-EXPTED-ITM-CNT.             18790000
195400     ADD 1  TO  PV-STORES-GIVEN-PIECES.                           18800000
195500     ADD 1  TO  PV-RTV-STORES.                                    18810000
195600                                                                  18820000
195700     SET RA-ALLOC-IDX UP BY +1.                                   18830000
195800                                                                  18840000
195900     EJECT                                                        18850000
196000*2600-UPC-CERTIFICATION.                                          18860000
196100*  THIS SWITCH IS SET IN PARA 7130-GET-CERT-INFO WHILE            18870000
196200*  BUILDING THE REPORT HEADINGS FOR THE PO                        18880000
196300*    IF  PS-NO-TVNDAGR                                            18890000
196400*        CONTINUE                                                 18900000
196500*    ELSE                                                         18910000
196600*        PERFORM 2610-CHECK-UPC-CERTIFICATION                     18920000
196700*        IF PS-VENDOR-REQ-CERT                                    18930000
196800*            MOVE PC-UPC-CERT-MSG    TO HL11-UPC-CERT-MESSAGE     18940000
196900*            PERFORM 7430-GET-UPC-CERT                            18950000
197000*        ELSE                                                     18960000
197100*            MOVE SPACES             TO HL11-UPC-CERT-MESSAGE     18970000
197200*        END-IF                                                   18980000
197300*    END-IF.                                                      18990000
197400*                                                                 19000000
197500*                                                                 19010000
197600*2610-CHECK-UPC-CERTIFICATION.                                    19020000
197700*    MOVE 'N' TO PS-VENDOR-REQ-CERT-IND.                          19030000
197800*    PERFORM 2611-CT-VENDOR-UPCS                                  19040000
197900*    IF SQLCODE = +100                                            19050000
198000*        MOVE 'UPC CERTIFICATION REQUIRED'                        19060000
198100*                      TO WS-CERT-LINE                            19070000
198200*        MOVE PC-UPC-CERT-MSG    TO HL11-UPC-CERT-MESSAGE         19080000
198300*        SET PS-VENDOR-REQ-CERT TO TRUE                           19090000
198400*    ELSE                                                         19100000
198500*        PERFORM 2612-CT-VENDORS-REQ-CERT                         19110000
198600*        IF SQLCODE = +0   OR -811                                19120000
198700*            MOVE 'UPC CERTIFICATION REQUIRED'                    19130000
198800*                              TO WS-CERT-LINE                    19140000
198900*            MOVE PC-UPC-CERT-MSG    TO HL11-UPC-CERT-MESSAGE     19150000
199000*            SET PS-VENDOR-REQ-CERT TO TRUE                       19160000
199100*         END-IF                                                  19170000
199200*    END-IF.                                                      19180000
199300*                                                                 19190000
199400*2611-CT-VENDOR-UPCS.                                             19200000
199500*    INITIALIZE PV-DB2-CURRENT-DATE.                              19210000
199600*                                                                 19220000
199700*    EXEC SQL                                                     19230000
199800*        SELECT CURRENT DATE                                      19240000
199900*              ,UPC_NBR                                           19250000
200000*        INTO :PV-DB2-CURRENT-DATE                                19260000
200100*            ,:XLV00003-UPC-NBR                                   19270000
200200*        FROM XLV_UPC                                             19280000
200300*        WHERE   INTR_UPC_ID   = :XL001-INTR-UPC-ID               19290000
200400*          AND   UPC_TYP_CDE   = :PC-V                            19300000
200500*          AND ((UPC_NBR BETWEEN :PC-EXTERNAL-UPC-LOW             19310000
200600*                                      AND                        19320000
200700*                                :PC-INTERNAL-UPC-LOW)            19330000
200800*                         OR                                      19340000
200900*               (UPC_NBR BETWEEN :PC-INTERNAL-UPC-HIGH            19350000
201000*                                      AND                        19360000
201100*                                :PC-EXTERNAL-UPC-HIGH))          19370000
201200*    END-EXEC                                                     19380000
201300*                                                                 19390000
201400*    EVALUATE TRUE                                                19400000
201500*        WHEN SQLCODE = 0                                         19410000
201600*        WHEN SQLCODE = -811                                      19420000
201700*        WHEN SQLCODE = -904                                      19430000
201800*        WHEN SQLCODE = -911                                      19440000
201900*           CONTINUE                                              19450000
202000*        WHEN SQLCODE = +100                                      19460000
202100*           MOVE ZEROES TO  XL001-UPC-NBR                         19470000
202200*        WHEN SQLWARN0 NOT = SPACES                               19480000
202300*        WHEN SQLCODE < 0                                         19490000
202400*        WHEN SQLCODE > 0                                         19500000
202500*            MOVE '2611-CT-VENDOR-UPCS'                           19510000
202600*                TO DP013-PARAGRAPH                               19520000
202700*            MOVE 'SELECT THE XLV_UPC VIEW'                       19530000
202800*                TO DP013-MESSAGE-TEXT (1)                        19540000
202900*            MOVE SQLCA          TO DP013-SQLCA                   19550000
203000*            MOVE 'XLV_UPC'      TO DP013-DB2-TABLE-NAME (1)      19560000
203100*            SET DP013-DB2-ABEND TO TRUE                          19570000
203200*            SET DP013-NO-ROLLBACK TO TRUE                        19580000
203300*            PERFORM 9999-WRITE-CICS-LOG-MSG                      19590000
203400*            GO TO 0000-GOBACK                                    19600000
203500*    END-EVALUATE.                                                19610000
203600*                                                                 19620000
203700*2612-CT-VENDORS-REQ-CERT.                                        19630000
203800*    INITIALIZE PV-DB2-CURRENT-DATE.                              19640000
203900*                                                                 19650000
204000*    EXEC SQL                                                     19660000
204100*        SELECT CURRENT DATE                                      19670000
204200*              ,UPC_NBR                                           19680000
204300*        INTO :PV-DB2-CURRENT-DATE                                19690000
204400*            ,:XLV00003-UPC-NBR                                   19700000
204500*        FROM XLV_UPC                                             19710000
204600*        WHERE  (INTR_UPC_ID   = :XL001-INTR-UPC-ID               19720000
204700*          AND   UPC_TYP_CDE   = :PC-V                            19730000
204800*          AND ((UPC_NBR BETWEEN :PC-EXTERNAL-UPC-LOW             19740000
204900*                                      AND                        19750000
205000*                                :PC-INTERNAL-UPC-LOW)            19760000
205100*                         OR                                      19770000
205200*               (UPC_NBR BETWEEN :PC-INTERNAL-UPC-HIGH            19780000
205300*                                      AND                        19790000
205400*                                :PC-EXTERNAL-UPC-HIGH))          19800000
205500*          AND                                                    19810000
205600*              NOT  (CERTD_IND     = :PC-Y))                      19820000
205700*    END-EXEC                                                     19830000
205800*                                                                 19840000
205900*    EVALUATE TRUE                                                19850000
206000*        WHEN SQLCODE = 0                                         19860000
206100*        WHEN SQLCODE = +100                                      19870000
206200*        WHEN SQLCODE = -811                                      19880000
206300*        WHEN SQLCODE = -904                                      19890000
206400*        WHEN SQLCODE = -911                                      19900000
206500*            CONTINUE                                             19910000
206600*        WHEN SQLWARN0 NOT = SPACES                               19920000
206700*        WHEN SQLCODE < 0                                         19930000
206800*        WHEN SQLCODE > 0                                         19940000
206900*            MOVE '2612-CT-VENDORS-REQ-CERT'                      19950000
207000*                TO DP013-PARAGRAPH                               19960000
207100*            MOVE 'SELECT THE XLV_UPV VIEW'                       19970000
207200*                TO DP013-MESSAGE-TEXT (1)                        19980000
207300*            MOVE SQLCA          TO DP013-SQLCA                   19990000
207400*            MOVE 'XLV_UPC'      TO DP013-DB2-TABLE-NAME (1)      20000000
207500*            SET DP013-DB2-ABEND TO TRUE                          20010000
207600*            SET DP013-NO-ROLLBACK TO TRUE                        20020000
207700*            PERFORM 9999-WRITE-CICS-LOG-MSG                      20030000
207800*            GO TO 0000-GOBACK                                    20040000
207900*    END-EVALUATE.                                                20050000
208000                                                                  20060000
208100                                                                  20070000
208200                                                                  20080000
208300 4200-CALC-OPEN-TO-REC.                                           20090000
208400                                                                  20100000
208500     SET DP276-STORE-LEVEL-OTR                                    20110000
208600         DP276-RECEIVER-OTR               TO TRUE                 20120000
208700                                                                  20130000
208800     INITIALIZE DP276-KEYS                                        20140000
208900                                                                  20150000
209000     MOVE CA-ORD-NBR                      TO DP276-PO-NBR         20160000
209100     MOVE CA-LINE-NBR (LINE-IDX)          TO DP276-PO-LNE-NBR     20170000
209200     MOVE CA-RCVR-SEQ-NBR                 TO DP276-REC-SEQ-NBR    20180000
209300     MOVE PV-OTR-DIST(PV-SAVE-OTR-IDX)    TO DP276-OPER-UNT-ID    20190000
209400     MOVE PURITM-PO-LNE-NBR               TO DP276-PO-LNE-NBR     20200000
209500     MOVE CA-FCLTY-ID                     TO DP276-FCLTY-ID.      20210000
209600                                                                  20220000
209700     COPY DPPD276.                                                20230000
209800 EJECT                                                            20240000
209900*                                                                 20250000
210000******************************************************************20260000
210100*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        20270000
210200******************************************************************20280000
210300 4000-PRODUCE-RPT.                                                20290000
210400     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         20300000
210500                                                                  20310000
210600     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           20320000
210700     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             20330000
210800     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            20340000
210900     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            20350000
211000     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          20360000
211100                                                                  20370000
211200     IF PS-YES-TRECITM                                            20380000
211300         IF RECITM-MKING-APRON-TMST NOT = PC-DB2-DUMMY-DATE-TIME  20390000
211400             MOVE RL1-REPRINT-LINE-1 TO  DRS01-COMM-DATA          20400000
211500             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           20410000
211600             PERFORM 8000-LINK-TO-DRS                             20420000
211700             SET PS-TOP-OF-PAGE-SET                               20430000
211800                 PS-REPRINT-MSG-PRTED TO TRUE                     20440000
211900         ELSE                                                     20450000
212000             CONTINUE                                             20460000
212100     ELSE                                                         20470000
212200         INITIALIZE DRS01-COMM-DATA                               20480000
212300         STRING                                                   20490000
212400         'MARKING APRON COULD NOT BE PRINTED BECAUSE '            20500000
212500         'NO PACKSLIPS WERE KEYED FOR THIS LINE.     '            20510000
212600             DELIMITED BY SIZE INTO DRS01-COMM-DATA               20520000
212700             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           20530000
212800             PERFORM 8000-LINK-TO-DRS                             20540000
212900             SET PS-TOP-OF-PAGE-SET TO TRUE                       20550000
213000     END-IF.                                                      20560000
213100                                                                  20570000
213200     IF PS-NO-REPRINT-MSG-PRTED                                   20580000
213300         MOVE RL1-REPRINT-LINE-1 TO  DRS01-COMM-DATA              20590000
213400         MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL               20600000
213500         PERFORM 8000-LINK-TO-DRS                                 20610000
213600         SET PS-TOP-OF-PAGE-SET TO TRUE                           20620000
213700     END-IF.                                                      20630000
213800                                                                  20640000
213900     MOVE RT1-RTV-DISTRO-LINE-1 TO  DRS01-COMM-DATA.              20650000
214000     IF PS-TOP-OF-PAGE-SET                                        20660000
214100         MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL               20670000
214200     ELSE                                                         20680000
214300         MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL               20690000
214400     END-IF.                                                      20700000
214500     PERFORM 8000-LINK-TO-DRS.                                    20710000
214600     SET PS-TOP-OF-PAGE-SET TO TRUE.                              20720000
214700                                                                  20730000
214800     IF TL3-TRBL-DESC (1) NOT = SPACES                            20740000
214900         MOVE TL1-TROUBLE-LINE-1     TO  DRS01-COMM-DATA          20750000
215000         IF PS-TOP-OF-PAGE-SET                                    20760000
215100             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           20770000
215200         ELSE                                                     20780000
215300             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           20790000
215400         END-IF                                                   20800000
215500         PERFORM 8000-LINK-TO-DRS                                 20810000
215600         MOVE TL3-TROUBLE-LINE-3     TO  DRS01-COMM-DATA          20820000
215700         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           20830000
215800         PERFORM 8000-LINK-TO-DRS                                 20840000
215900         SET PS-TOP-OF-PAGE-SET TO TRUE                           20850000
216000     END-IF.                                                      20860000
216100                                                                  20870000
216200     MOVE PC-MARKING-APRON-RPT-HDR  TO  HL1-RPT-HDR               20880000
216300                                                                  20890000
216400     IF PS-PRINT-STORE-PROBLEM                                    20900000
216500         MOVE DH4-STORE-PROBLEM-LINE     TO  DRS01-COMM-DATA      20910000
216600         MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL       20920000
216700         PERFORM 8000-LINK-TO-DRS                                 20930000
216800     END-IF.                                                      20940000
216900                                                                  20950000
217000     MOVE PC-CURRENT-PROGRAM-NAME    TO HL1-PROGRAM-NAME.         20960000
217100     MOVE 1                          TO  HL1-RPT-NBR              20970000
217200                                         HL1-PGE-NBR              20980000
217300                                         HL1-OF-PGE-NBR.          20990000
217400     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         21000000
217500     IF PS-TOP-OF-PAGE-SET                                        21010000
217600         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           21020000
217700     ELSE                                                         21030000
217800         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           21040000
217900     END-IF.                                                      21050000
218000     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          21060000
218100     PERFORM 8000-LINK-TO-DRS.                                    21070000
218200                                                                  21080000
218300     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         21090000
218400     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          21100000
218500     PERFORM 8000-LINK-TO-DRS.                                    21110000
218600                                                                  21120000
218700     MOVE CA-PREPAIRER-USER-ID       TO  HL3-PREPAIRER-USER-ID.   21130000
218800     MOVE CA-DESTINATION             TO  HL4-PRINTER-DEST.        21140000
218900     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         21150000
219000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21160000
219100     PERFORM 8000-LINK-TO-DRS.                                    21170000
219200                                                                  21180000
219300     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         21190000
219400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21200000
219500     PERFORM 8000-LINK-TO-DRS.                                    21210000
219600                                                                  21220000
219700     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         21230000
219800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21240000
219900     PERFORM 8000-LINK-TO-DRS.                                    21250000
220000                                                                  21260000
220100     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         21270000
220200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21280000
220300     PERFORM 8000-LINK-TO-DRS.                                    21290000
220400                                                                  21300000
220500     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         21310000
220600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21320000
220700     PERFORM 8000-LINK-TO-DRS.                                    21330000
220800                                                                  21340000
220900     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         21350000
221000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21360000
221100     PERFORM 8000-LINK-TO-DRS.                                    21370000
221200                                                                  21380000
221300     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         21390000
221400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21400000
221500     PERFORM 8000-LINK-TO-DRS.                                    21410000
221600                                                                  21420000
221700     MOVE HL10-HEADING-LINE-10       TO  DRS01-COMM-DATA.         21430000
221800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21440000
221900     PERFORM 8000-LINK-TO-DRS.                                    21450000
222000                                                                  21460000
222100     MOVE HL11-HEADING-LINE-11       TO  DRS01-COMM-DATA.         21470000
222200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21480000
222300     PERFORM 8000-LINK-TO-DRS.                                    21490000
222400                                                                  21500000
222500     MOVE HL12-HEADING-LINE-12       TO  DRS01-COMM-DATA.         21510000
222600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21520000
222700     PERFORM 8000-LINK-TO-DRS.                                    21530000
222800                                                                  21540000
222900     MOVE HL13-HEADING-LINE-13       TO  DRS01-COMM-DATA.         21550000
223000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21560000
223100     PERFORM 8000-LINK-TO-DRS.                                    21570000
223200                                                                  21580000
223300     MOVE HL13A-HEADING-LINE-13A     TO  DRS01-COMM-DATA.         21590000
223400     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          21600000
223500     PERFORM 8000-LINK-TO-DRS.                                    21610000
223600                                                                  21620000
223700     MOVE PC-RTV-SPECIAL-INSTRS-MSG  TO  HL14-SPECIAL-INSTR.      21630000
223800     MOVE HL14-HEADING-LINE-14       TO  DRS01-COMM-DATA.         21640000
223900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21650000
224000     PERFORM 8000-LINK-TO-DRS.                                    21660000
224100                                                                  21670000
224200     MOVE DH1-DETAIL-HEADING-LINE-1  TO  DRS01-COMM-DATA.         21680000
224300     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          21690000
224400     PERFORM 8000-LINK-TO-DRS.                                    21700000
224500                                                                  21710000
224600     MOVE DH2-DETAIL-HEADING-LINE-2  TO  DRS01-COMM-DATA.         21720000
224700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21730000
224800     PERFORM 8000-LINK-TO-DRS.                                    21740000
224900                                                                  21750000
225000     IF PS-PRINT-NO-DISTRO-MSG                                    21760000
225100         MOVE DH3-NO-DISTRO-MSG          TO  DRS01-COMM-DATA      21770000
225200         MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL       21780000
225300         PERFORM 8000-LINK-TO-DRS                                 21790000
225400     END-IF                                                       21800000
225500                                                                  21810000
225600     MOVE HL15-HEADING-LINE-15       TO  DRS01-COMM-DATA.         21820000
225700     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          21830000
225800     PERFORM 8000-LINK-TO-DRS.                                    21840000
225900     PERFORM 4035-FILL-RTV-LNE.                                   21850000
226000     MOVE DL-DETAIL-LINE             TO  DRS01-COMM-DATA.         21860000
226100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          21870000
226200     PERFORM 8000-LINK-TO-DRS.                                    21880000
226300     MOVE SPACES                     TO  DRS01-COMM-DATA.         21890000
226400     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          21900000
226500     PERFORM 8000-LINK-TO-DRS                                     21910000
226600         VARYING PS-COUNTER                                       21920000
226700         FROM 1 BY 1                                              21930000
226800         UNTIL PS-COUNTER > PC-2.                                 21940000
226900                                                                  21950000
227000*    IF THE PRINTER IS ABLE TO PRINT BARCODE FORMATTING, DO IT    21960000
227100     IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                              21970000
227200         MOVE '^PY^-'                    TO DRS01-COMM-DATA       21980000
227300         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        21990000
227400         PERFORM 8000-LINK-TO-DRS                                 22000000
227500                                                                  22010000
227600*        IF PRINTING TO A "FORMSPRO" PRINTER, ACTIVATE FREE-FORM  22020000
227700         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           22030000
227800             MOVE DS004-PLC-ACTIVATE-FF-PROC TO DRS01-COMM-DATA   22040000
227900             MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL    22050000
228000             PERFORM 8000-LINK-TO-DRS                             22060000
228100         END-IF                                                   22070000
228200                                                                  22080000
228300         MOVE PC-RTV-PROCESSING-1        TO  DRS01-COMM-DATA      22090000
228400         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22100000
228500         PERFORM 8000-LINK-TO-DRS                                 22110000
228600                                                                  22120000
228700         MOVE PC-RTV-PROCESSING-1        TO  DRS01-COMM-DATA      22130000
228800         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22140000
228900         PERFORM 8000-LINK-TO-DRS                                 22150000
229000                                                                  22160000
229100         MOVE PC-RTV-PROCESSING-2        TO  DRS01-COMM-DATA      22170000
229200         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22180000
229300         PERFORM 8000-LINK-TO-DRS                                 22190000
229400                                                                  22200000
229500         MOVE PC-RTV-PROCESSING-1        TO  DRS01-COMM-DATA      22210000
229600         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22220000
229700         PERFORM 8000-LINK-TO-DRS                                 22230000
229800                                                                  22240000
229900         MOVE PC-RTV-PROCESSING-1        TO  DRS01-COMM-DATA      22250000
230000         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22260000
230100         PERFORM 8000-LINK-TO-DRS                                 22270000
230200                                                                  22280000
230300*        IF PRINTING TO A "FORMSPRO" PRINTER, DE-ACTIVATE FREE-FOR22290000
230400*        AND SEND THE SPECIAL "END" STRING FOR THIS PRINTER       22300000
230500         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           22310000
230600             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    22320000
230700                                             TO DRS01-COMM-DATA   22330000
230800             MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL    22340000
230900             PERFORM 8000-LINK-TO-DRS                             22350000
231000                                                                  22360000
231100             MOVE CA-LINES-PER-INCH          TO DS004-PLC-DI-LPI  22370000
231200             MOVE DS004-PLC-DEACTIVATE-IMAGE TO DRS01-COMM-DATA   22380000
231300             MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL    22390000
231400             PERFORM 8000-LINK-TO-DRS                             22400000
231500         ELSE                                                     22410000
231600             MOVE '^PN^-'                    TO DRS01-COMM-DATA   22420000
231700             MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL    22430000
231800             PERFORM 8000-LINK-TO-DRS                             22440000
231900         END-IF                                                   22450000
232000     ELSE                                                         22460000
232100*    ELSE PRINT THE LINES WITHOUT BARCODE FORMATTING.             22470000
232200                                                                  22480000
232300         MOVE PC-RTV-PROCESSING-NO-BARCODE-1                      22490000
232400                                         TO  DRS01-COMM-DATA      22500000
232500         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22510000
232600         PERFORM 8000-LINK-TO-DRS                                 22520000
232700                                                                  22530000
232800         MOVE PC-RTV-PROCESSING-NO-BARCODE-1                      22540000
232900                                         TO  DRS01-COMM-DATA      22550000
233000         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22560000
233100         PERFORM 8000-LINK-TO-DRS                                 22570000
233200                                                                  22580000
233300         MOVE PC-RTV-PROCESSING-NO-BARCODE-2                      22590000
233400                                         TO  DRS01-COMM-DATA      22600000
233500         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22610000
233600         PERFORM 8000-LINK-TO-DRS                                 22620000
233700                                                                  22630000
233800         MOVE PC-RTV-PROCESSING-NO-BARCODE-1                      22640000
233900                                         TO  DRS01-COMM-DATA      22650000
234000         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22660000
234100         PERFORM 8000-LINK-TO-DRS                                 22670000
234200                                                                  22680000
234300         MOVE PC-RTV-PROCESSING-NO-BARCODE-1                      22690000
234400                                         TO  DRS01-COMM-DATA      22700000
234500         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       22710000
234600         PERFORM 8000-LINK-TO-DRS                                 22720000
234700     END-IF.                                                      22730000
234800                                                                  22740000
234900     MOVE SPACES                  TO  DRS01-COMM-DATA.            22750000
235000     MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL.             22760000
235100     PERFORM 8000-LINK-TO-DRS                                     22770000
235200         VARYING PS-COUNTER                                       22780000
235300         FROM 1 BY 1                                              22790000
235400         UNTIL PS-COUNTER > PC-5.                                 22800000
235500     ADD PC-ONE TO PS-PAGE-SUB.                                   22810000
235600                                                                  22820000
235700***  BARCODE CODING  -  EXECUTE ONLY IF THE PRINTER IS CAPABLE    22830000
235800***                     OF PRINTING BARCODES AND IF IT IS         22840000
235900***                     PRINTING A RECEIVER FROM MFDC             22850000
236000     IF  CA-PRTR-PRTR-BRCDE-IND = 'Y'                             22860000
236100     AND CA-OPER-UNT-ID = '0085'                                  22870000
236200         MOVE DS004-PLC-ACTIVATE-IMAGE1                           22880000
236300                                      TO DRS01-COMM-DATA          22890000
236400*        MOVE '^PY^-'                 TO DRS01-COMM-DATA          22900000
236500         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           22910000
236600         PERFORM 8000-LINK-TO-DRS                                 22920000
236700                                                                  22930000
236800*    IF PRINTING TO A "FORMSPRO" PRINTER, ACTIVATE FREE-FORM      22940000
236900         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           22950000
237000             MOVE DS004-PLC-ACTIVATE-FF-PROC                      22960000
237100                                          TO DRS01-COMM-DATA      22970000
237200*            MOVE '^F'                    TO DRS01-COMM-DATA      22980000
237300             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       22990000
237400             PERFORM 8000-LINK-TO-DRS                             23000000
237500         END-IF                                                   23010000
237600                                                                  23020000
237700         MOVE 1                       TO TL1-TOT-STR-GIVEN        23030000
237800         MOVE CA-ORD-NBR-X            TO TL-BARCODE-KEYREC        23040000
237900                                         TL-BARCODE-KEYREC-1      23050000
238000                                         TL-BARCODE-KEYREC-2      23060000
238100         MOVE CA-RCVR-SEQ-NBR-X       TO TL-BARCODE-REC-SEQ       23070000
238200                                         TL-BARCODE-REC-SEQ-1     23080000
238300                                         TL-BARCODE-REC-SEQ-2     23090000
238400         MOVE CA-ORD-LNE-NBR          TO TL-BARCODE-LINE-NMBR     23100000
238500                                         TL-BARCODE-LINE-NMBR-1   23110000
238600                                         TL-BARCODE-LINE-NMBR-2   23120000
238700         MOVE RECEIV-RCVR-NBR         TO TL-SORT-KEYREC           23130000
238800         MOVE ZERO                    TO TL-SEQ-NBR               23140000
238900         MOVE CA-ORD-LNE-NBR          TO TL-SORT-LINE-NBR         23150000
239000         PERFORM 4020-COMPUTE-CNTL-NBR-CKDGT                      23160000
239100                                                                  23170000
239200         MOVE TL-BARCODE-LINE         TO DRS01-COMM-DATA          23180000
239300         MOVE PC-DOUBLE-SPACE         TO DRS01-COMM-CTL           23190000
239400         PERFORM 8000-LINK-TO-DRS                                 23200000
239500                                                                  23210000
239600         MOVE PV-TOT-RTV-EXPTED-ITM-CNT                           23220000
239700                                      TO  TL3-TOT-EXPTED-ITM-CNT  23230000
239800         MOVE TL3-TOTAL-LINE-3        TO  DRS01-COMM-DATA         23240000
239900         MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL          23250000
240000         PERFORM 8000-LINK-TO-DRS                                 23260000
240100                                                                  23270000
240200*    IF PRINTING TO A "FORMSPRO" PRINTER, DEACTIVATE FREE-FORM    23280000
240300         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           23290000
240400             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    23300000
240500                                          TO DRS01-COMM-DATA      23310000
240600             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       23320000
240700             PERFORM 8000-LINK-TO-DRS                             23330000
240800                                                                  23340000
240900             MOVE CA-LINES-PER-INCH       TO DS004-PLC-DI-LPI     23350000
241000             MOVE DS004-PLC-DEACTIVATE-IMAGE                      23360000
241100                                          TO DRS01-COMM-DATA      23370000
241200             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       23380000
241300             PERFORM 8000-LINK-TO-DRS                             23390000
241400         ELSE                                                     23400000
241500             MOVE '^PN^-'                 TO DRS01-COMM-DATA      23410000
241600             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       23420000
241700             PERFORM 8000-LINK-TO-DRS                             23430000
241800         END-IF                                                   23440000
241900     ELSE                                                         23450000
242000         MOVE 1                       TO TL1-TOT-STR-GIVEN-NB     23460000
242100         MOVE TL-NO-BARCODE-LINE      TO DRS01-COMM-DATA          23470000
242200         MOVE PC-DOUBLE-SPACE         TO DRS01-COMM-CTL           23480000
242300         PERFORM 8000-LINK-TO-DRS                                 23490000
242400                                                                  23500000
242500         MOVE PV-TOT-RTV-EXPTED-ITM-CNT                           23510000
242600              TO TL3-TOT-EXPTED-ITM-CNT-NB                        23520000
242700         MOVE TL3-TOTAL-LINE-3-NO-BARCODE                         23530000
242800                                      TO  DRS01-COMM-DATA         23540000
242900         MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL          23550000
243000         PERFORM 8000-LINK-TO-DRS                                 23560000
243100     END-IF.                                                      23570000
243200                                                                  23580000
243300***  BARCODE CODING                                               23590000
243400*                                                                 23600000
243500******************************************************************23610000
243600*  THIS MODULE CONTROLS THE PRINTING OF THE STORE DETAIL LINES.   23620000
243700*  ONLY STORES WHICH HAVE AN EXPECTED ALLOCATION WILL BE PRINTED. 23630000
243800******************************************************************23640000
243900/                                                                 23650000
244000 4020-COMPUTE-CNTL-NBR-CKDGT.                                     23660000
244100     SET PV-DIGIT-IDX TO +13.                                     23670000
244200     MOVE TL-SORT-CONTROL-NBR TO PV-CNTL-NBR-X.                   23680000
244300                                                                  23690000
244400     PERFORM                                                      23700000
244500         UNTIL PV-DIGIT-IDX = ZERO                                23710000
244600         COMPUTE PV-CNTL-NBR-PRODUCT =                            23720000
244700             PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX) * 2                 23730000
244800         COMPUTE PV-CHECK-SUM =                                   23740000
244900             PV-CHECK-SUM + (PV-PRODUCT-DIGIT (1) +               23750000
245000                             PV-PRODUCT-DIGIT (2))                23760000
245100         SET PV-DIGIT-IDX DOWN BY 1                               23770000
245200         IF PV-DIGIT-IDX NOT = ZERO                               23780000
245300             COMPUTE PV-CHECK-SUM =                               23790000
245400                 PV-CHECK-SUM + PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX)  23800000
245500             SET PV-DIGIT-IDX DOWN BY 1                           23810000
245600         END-IF                                                   23820000
245700     END-PERFORM.                                                 23830000
245800                                                                  23840000
245900     COMPUTE PV-CHECK-DIGIT = 10 - PV-CKSUM-LEAST-SIGNIFICANT-DGT.23850000
246000     MOVE PV-CHECK-DIGIT TO TL-SORT-CHKDGT                        23860000
246100     INITIALIZE PV-CHECK-SUM.                                     23870000
246200*                                                                 23880000
246300 4030-FILL-RTV-LNE.                                               23890000
246400     IF RA-CLOSED-IND (1) = '*'                                   23900000
246500         MOVE ALL '*' TO  DL-DTL-LNE-AREA (1)                     23910000
246600     ELSE                                                         23920000
246700         MOVE SPACES  TO  DL-DTL-LNE-AREA (1)                     23930000
246800     END-IF.                                                      23940000
246900                                                                  23950000
247000     MOVE RA-STR-NBR (1)                                          23960000
247100         TO  DL-STR-NBR (1).                                      23970000
247200     MOVE RA-CHAR5-ABBR-NAME (1)                                  23980000
247300         TO  DL-CHAR5-ABBR-NAME (1).                              23990000
247400     MOVE RA-EXPTED-ITM-CNT (1)                                   24000000
247500         TO  DL-EXPTED-ITM-CNT (1).                               24010000
247600     MOVE RA-DIFF-OPER-UNT-ID (1)                                 24020000
247700         TO  DL-UNITS-OVER-SHORT (1).                             24030000
247800     MOVE RA-ITEMS-OPEN-TO-RECEIVE (1)                            24040000
247900         TO  DL-UNITS-OPEN-TO-RECEIVE (1).                        24050000
248000                                                                  24060000
248100     IF RA-CLOSED-IND (2) = '*'                                   24070000
248200         MOVE ALL '*' TO  DL-DTL-LNE-AREA (2)                     24080000
248300     ELSE                                                         24090000
248400         MOVE SPACES  TO  DL-DTL-LNE-AREA (2)                     24100000
248500     END-IF.                                                      24110000
248600                                                                  24120000
248700     IF RA-STR-NBR (2) = ZEROS                                    24130000
248800         CONTINUE                                                 24140000
248900     ELSE                                                         24150000
249000         MOVE RA-STR-NBR (2)                                      24160000
249100             TO  DL-STR-NBR (2)                                   24170000
249200         MOVE RA-CHAR5-ABBR-NAME (2)                              24180000
249300             TO  DL-CHAR5-ABBR-NAME (2)                           24190000
249400         MOVE RA-EXPTED-ITM-CNT (2)                               24200000
249500             TO  DL-EXPTED-ITM-CNT (2)                            24210000
249600         MOVE RA-DIFF-OPER-UNT-ID (2)                             24220000
249700             TO  DL-UNITS-OVER-SHORT (2)                          24230000
249800         MOVE RA-ITEMS-OPEN-TO-RECEIVE (2)                        24240000
249900             TO  DL-UNITS-OPEN-TO-RECEIVE (2)                     24250000
250000     END-IF.                                                      24260000
250100                                                                  24270000
250200     IF RA-CLOSED-IND (3) = '*'                                   24280000
250300         MOVE ALL '*' TO  DL-DTL-LNE-AREA (3)                     24290000
250400     ELSE                                                         24300000
250500         MOVE SPACES  TO  DL-DTL-LNE-AREA (3)                     24310000
250600     END-IF.                                                      24320000
250700                                                                  24330000
250800     IF RA-STR-NBR (3) = ZEROS                                    24340000
250900         CONTINUE                                                 24350000
251000     ELSE                                                         24360000
251100         MOVE RA-STR-NBR (3)                                      24370000
251200             TO  DL-STR-NBR (3)                                   24380000
251300         MOVE RA-CHAR5-ABBR-NAME (3)                              24390000
251400             TO  DL-CHAR5-ABBR-NAME (3)                           24400000
251500         MOVE RA-EXPTED-ITM-CNT (3)                               24410000
251600             TO  DL-EXPTED-ITM-CNT (3)                            24420000
251700         MOVE RA-DIFF-OPER-UNT-ID (3)                             24430000
251800             TO  DL-UNITS-OVER-SHORT (3)                          24440000
251900         MOVE RA-ITEMS-OPEN-TO-RECEIVE (3)                        24450000
252000             TO  DL-UNITS-OPEN-TO-RECEIVE (3)                     24460000
252100     END-IF.                                                      24470000
252200                                                                  24480000
252300 4035-FILL-RTV-LNE.                                               24490000
252400     IF RA-CLOSED-IND (PS-RTV-SUB) = '*'                          24500000
252500         MOVE ALL '*' TO  DL-DTL-LNE-AREA (1)                     24510000
252600     ELSE                                                         24520000
252700         MOVE SPACES  TO  DL-DTL-LNE-AREA (1)                     24530000
252800     END-IF.                                                      24540000
252900                                                                  24550000
253000     MOVE RA-STR-NBR (PS-RTV-SUB)                                 24560000
253100         TO  DL-STR-NBR (1).                                      24570000
253200     MOVE RA-CHAR5-ABBR-NAME (PS-RTV-SUB)                         24580000
253300         TO  DL-CHAR5-ABBR-NAME (1).                              24590000
253400     MOVE RA-EXPTED-ITM-CNT (PS-RTV-SUB)                          24600000
253500         TO  DL-EXPTED-ITM-CNT (1)                                24610000
253600             PV-TOT-RTV-EXPTED-ITM-CNT.                           24620000
253700     MOVE RA-DIFF-OPER-UNT-ID (PS-RTV-SUB)                        24630000
253800         TO  DL-UNITS-OVER-SHORT (1).                             24640000
253900     MOVE RA-ITEMS-OPEN-TO-RECEIVE (PS-RTV-SUB)                   24650000
254000         TO  DL-UNITS-OPEN-TO-RECEIVE (1).                        24660000
254100     MOVE SPACES  TO  DL-DTL-LNE-AREA (2).                        24670000
254200     MOVE SPACES  TO  DL-DTL-LNE-AREA (3).                        24680000
254300                                                                  24690000
254400 EJECT                                                            24700000
254500                                                                  24710000
254600 4050-SELECT-PRIM-SHIP.                                           24720000
254700                                                                  24730000
254800     EXEC SQL                                                     24740000
254900         SELECT C.TRIP_ID                                         24750000
255000          INTO  :VHTRIP-TRIP-ID                                   24760000
255100           FROM TSHPTPO A                                         24770000
255200              , TSHIPMT B                                         24780000
255300              , TVHTRIP C                                         24790000
255400          WHERE A.PO_NBR         = :DK-ORD-NBR                    24800000
255500            AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               24810000
255600            AND A.SHIPT_ID       = B.SHIPT_ID                     24820000
255700            AND B.TRIP_ID        = C.TRIP_ID                      24830000
255800            AND A.PRIM_SHIPT_IND = :PC-Y                          24840000
255900     END-EXEC.                                                    24850000
256000                                                                  24860000
256100     EVALUATE TRUE                                                24870000
256200         WHEN SQLCODE = ZERO                                      24880000
256300             MOVE VHTRIP-TRIP-ID   TO HL2-TRIP-ID                 24890000
256400         WHEN SQLCODE = PC-ROW-NOT-FOUND                          24900000
256500             MOVE ZEROES           TO HL2-TRIP-ID                 24910000
256600             CONTINUE                                             24920000
256700         WHEN SQLWARN0 NOT = SPACE                                24930000
256800         WHEN SQLCODE < ZERO                                      24940000
256900         WHEN SQLCODE > ZERO                                      24950000
257000             MOVE '4050-SELECT-PRIM-SHIP '                        24960000
257100                 TO DP013-PARAGRAPH                               24970000
257200             MOVE 'ATTEMPTING TO SELECT TRIP ID  '                24980000
257300                 TO DP013-MESSAGE-TEXT (1)                        24990000
257400             MOVE SQLCA            TO DP013-SQLCA                 25000000
257500             MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (1)    25010000
257600             SET DP013-DB2-ABEND   TO TRUE                        25020000
257700             SET DP013-NO-ROLLBACK TO TRUE                        25030000
257800             PERFORM 9999-WRITE-CICS-LOG-MSG                      25040000
257900             GO TO 0000-GOBACK                                    25050000
258000     END-EVALUATE.                                                25060000
258100                                                                  25070000
258200 EJECT                                                            25080000
258300******************************************************************25090000
258400*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               25100000
258500******************************************************************25110000
258600 4300-GET-TKT-DESC.                                               25120000
258700     INITIALIZE DCLTTKTFMT.                                       25130000
258800                                                                  25140000
258900     PERFORM                                                      25150000
259000         WITH TEST AFTER                                          25160000
259100         VARYING PV-SELECT-COUNTER                                25170000
259200         FROM 1 BY 1                                              25180000
259300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              25190000
259400            OR  (SQLCODE = ZERO)                                  25200000
259500            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     25210000
259600      EXEC SQL                                                    25220000
259700          SELECT DISTINCT TKT_FMT_DESC                            25230000
259800                INTO :TKTFMT-TKT-FMT-DESC                         25240000
259900              FROM TTKTFMT                                        25250000
260000           WHERE                                                  25260000
260100              TKT_FMT_ID   = :DK-TKT-FMT-ID                       25270000
260200     END-EXEC                                                     25280000
260300                                                                  25290000
260400                                                                  25300000
260500         EVALUATE TRUE                                            25310000
260600             WHEN SQLCODE = ZERO                                  25320000
260700             WHEN SQLCODE = -811                                  25330000
260800                 MOVE TKTFMT-TKT-FMT-DESC TO                      25340000
260900                                         HL13A-TICKET-TYPE        25350000
261000             WHEN SQLCODE = -904                                  25360000
261100             WHEN SQLCODE = -913                                  25370000
261200                 CONTINUE                                         25380000
261300             WHEN SQLCODE = PC-ROW-NOT-FOUND                      25390000
261400                 MOVE SPACES    TO                                25400000
261500                                         HL13A-TICKET-TYPE        25410000
261600             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           25420000
261700                 MOVE TKTFMT-TKT-FMT-DESC TO                      25430000
261800                                         HL13A-TICKET-TYPE        25440000
261900             WHEN SQLWARN0 NOT = SPACES                           25450000
262000             WHEN SQLCODE < ZERO                                  25460000
262100             WHEN SQLCODE > ZERO                                  25470000
262200                  MOVE '4300-GET-TKT-DESC'                        25480000
262300                                 TO DP013-PARAGRAPH               25490000
262400                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           25500000
262500                                 TO DP013-MESSAGE-TEXT (1)        25510000
262600                  MOVE DK-TKT-FMT-ID                              25520000
262700                                 TO DP013-MESSAGE-TEXT (2)        25530000
262800                  MOVE PV-DISPLAY-KEYS                            25540000
262900                                     TO DP013-MESSAGE-TEXT (2)    25550000
263000                  MOVE SQLCA         TO DP013-SQLCA               25560000
263100                  MOVE 'TTKTFMT'     TO DP013-DB2-TABLE-NAME (1)  25570000
263200                  SET DP013-DB2-ABEND                             25580000
263300                                     TO TRUE                      25590000
263400                  SET DP013-NO-ROLLBACK                           25600000
263500                                     TO TRUE                      25610000
263600                  PERFORM 9999-WRITE-CICS-LOG-MSG                 25620000
263700                  GO TO 0000-GOBACK                               25630000
263800         END-EVALUATE                                             25640000
263900     END-PERFORM.                                                 25650000
264000                                                                  25660000
264100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    25670000
264200         MOVE '4300-GET-TKT-DESC'                                 25680000
264300                                     TO DP013-PARAGRAPH           25690000
264400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25700000
264500                                     TO DP013-MESSAGE-TEXT (1)    25710000
264600         MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'                    25720000
264700                                 TO DP013-MESSAGE-TEXT (1)        25730000
264800         MOVE DK-TKT-FMT-ID                                       25740000
264900                                 TO DP013-MESSAGE-TEXT (2)        25750000
265000         MOVE SQLCA                  TO DP013-SQLCA               25760000
265100         MOVE 'TTKTFMT'              TO DP013-DB2-TABLE-NAME (1)  25770000
265200         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  25780000
265300         SET DP013-DB2-ABEND         TO TRUE                      25790000
265400         SET DP013-NO-ROLLBACK       TO TRUE                      25800000
265500         PERFORM 9999-WRITE-CICS-LOG-MSG                          25810000
265600         GO TO 0000-GOBACK                                        25820000
265700     END-IF.                                                      25830000
265800 EJECT                                                            25840000
265900                                                                  25850000
266000******************************************************************25860000
266100*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               25870000
266200******************************************************************25880000
266300 4310-GET-TKT-PLACEMENT.                                          25890000
266400     INITIALIZE DCLTPTKREQ                                        25900000
266500                DCLTPTKLNE                                        25910000
266600                DCLTPLDESC.                                       25920000
266700                                                                  25930000
266800     PERFORM                                                      25940000
266900         WITH TEST AFTER                                          25950000
267000         VARYING PV-SELECT-COUNTER                                25960000
267100         FROM 1 BY 1                                              25970000
267200         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              25980000
267300            OR  (SQLCODE = ZERO)                                  25990000
267400            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     26000000
267500      EXEC SQL                                                    26010000
267600      SELECT                                                      26020000
267700              A.PO_NBR,                                           26030000
267800              A.PO_REQ_NBR,                                       26040000
267900              B.PO_LNE_NBR,                                       26050000
268000              B.TKT_PLCMNT_CDE,                                   26060000
268100              C.TKT_PLCMNT_DESC                                   26070000
268200         INTO  :PTKREQ-PO-NBR                                     26080000
268300             , :PTKREQ-PO-REQ-NBR                                 26090000
268400             , :PTKLNE-PO-LNE-NBR                                 26100000
268500             , :PTKLNE-TKT-PLCMNT-CDE                             26110000
268600             , :PLDESC-TKT-PLCMNT-DESC                            26120000
268700         FROM                                                     26130000
268800              TPTKREQ A                                           26140000
268900             ,TPTKLNE B                                           26150000
269000             ,TPLDESC C                                           26160000
269100         WHERE  A.PO_NBR = :DK-ORD-NBR                            26170000
269200           AND  B.PO_LNE_NBR =  :DK-ORD-LNE-NBR                   26180000
269300           AND  A.PO_REQ_NBR = B.PO_REQ_NBR                       26190000
269400           AND  B.TKT_PLCMNT_CDE = C.TKT_PLCMNT_CDE               26200000
269500     END-EXEC                                                     26210000
269600                                                                  26220000
269700                                                                  26230000
269800         EVALUATE TRUE                                            26240000
269900             WHEN SQLCODE = ZERO                                  26250000
270000                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   26260000
270100                                         HL13A-TICKET-PLACEMENT   26270000
270200             WHEN SQLCODE = -904                                  26280000
270300             WHEN SQLCODE = -913                                  26290000
270400                 CONTINUE                                         26300000
270500             WHEN SQLCODE = PC-ROW-NOT-FOUND                      26310000
270600                 MOVE SPACES TO  HL13A-TICKET-PLACEMENT           26320000
270700             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           26330000
270800                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   26340000
270900                                 HL13A-TICKET-PLACEMENT           26350000
271000             WHEN SQLWARN0 NOT = SPACES                           26360000
271100             WHEN SQLCODE < ZERO                                  26370000
271200             WHEN SQLCODE > ZERO                                  26380000
271300                  MOVE '4310-GET-TKT-PLACEMENT'                   26390000
271400                                 TO DP013-PARAGRAPH               26400000
271500                  MOVE 'UNSUCCESSFUL SELECT OF PLACMNT'           26410000
271600                                 TO DP013-MESSAGE-TEXT (1)        26420000
271700                  MOVE DK-ORD-NBR                                 26430000
271800                                 TO DP013-MESSAGE-TEXT (2)        26440000
271900                  MOVE SQLCA         TO DP013-SQLCA               26450000
272000                  MOVE 'TPTKREQ'     TO DP013-DB2-TABLE-NAME (1)  26460000
272100                  MOVE 'TPTKLNE'     TO DP013-DB2-TABLE-NAME (2)  26470000
272200                  MOVE 'TPLDESC'     TO DP013-DB2-TABLE-NAME (3)  26480000
272300                  SET DP013-DB2-ABEND                             26490000
272400                                     TO TRUE                      26500000
272500                  SET DP013-NO-ROLLBACK                           26510000
272600                                     TO TRUE                      26520000
272700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 26530000
272800                  GO TO 0000-GOBACK                               26540000
272900         END-EVALUATE                                             26550000
273000     END-PERFORM.                                                 26560000
273100                                                                  26570000
273200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    26580000
273300         MOVE '4310-GET-TKT-PLACEMENT'                            26590000
273400                                     TO DP013-PARAGRAPH           26600000
273500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26610000
273600                                     TO DP013-MESSAGE-TEXT (1)    26620000
273700         MOVE 'UNSUCCESSFUL SELECT OF TPLDESC'                    26630000
273800                                 TO DP013-MESSAGE-TEXT (1)        26640000
273900         MOVE DK-ORD-NBR                                          26650000
274000                                 TO DP013-MESSAGE-TEXT (2)        26660000
274100         MOVE SQLCA                  TO DP013-SQLCA               26670000
274200         MOVE 'TPTKREQ'              TO DP013-DB2-TABLE-NAME (1)  26680000
274300         MOVE 'TPTKLNE'              TO DP013-DB2-TABLE-NAME (2)  26690000
274400         MOVE 'TPLDESC'              TO DP013-DB2-TABLE-NAME (3)  26700000
274500         SET DP013-DB2-ABEND         TO TRUE                      26710000
274600         SET DP013-NO-ROLLBACK       TO TRUE                      26720000
274700         PERFORM 9999-WRITE-CICS-LOG-MSG                          26730000
274800         GO TO 0000-GOBACK                                        26740000
274900     END-IF.                                                      26750000
275000 EJECT                                                            26760000
275100                                                                  26770000
275200 EJECT                                                            26780000
275300 7000-OPEN-STR-NBR-CSR.                                           26790000
275400     EXEC SQL                                                     26800000
275500         OPEN STR-NBR-CSR                                         26810000
275600     END-EXEC.                                                    26820000
275700                                                                  26830000
275800     EVALUATE TRUE                                                26840000
275900         WHEN SQLCODE = ZERO                                      26850000
276000             CONTINUE                                             26860000
276100         WHEN SQLWARN0 NOT = SPACE                                26870000
276200         WHEN SQLCODE < ZERO                                      26880000
276300         WHEN SQLCODE > ZERO                                      26890000
276400             MOVE '7000-OPEN-STR-NBR-CSR'                         26900000
276500                 TO DP013-PARAGRAPH                               26910000
276600             MOVE 'OPEN THE STR-NBR-CSR'                          26920000
276700                 TO DP013-MESSAGE-TEXT (1)                        26930000
276800             MOVE SQLCA            TO DP013-SQLCA                 26940000
276900             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  26950000
277000             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  26960000
277100             SET DP013-DB2-ABEND   TO TRUE                        26970000
277200             SET DP013-NO-ROLLBACK TO TRUE                        26980000
277300             PERFORM 9999-WRITE-CICS-LOG-MSG                      26990000
277400             GO TO 0000-GOBACK                                    27000000
277500     END-EVALUATE.                                                27010000
277600*                                                                 27020000
277700     SKIP3                                                        27030000
277800 7010-FETCH-STR-NBR-CSR.                                          27040000
277900                                                                  27050000
278000     EXEC SQL                                                     27060000
278100         FETCH  STR-NBR-CSR                                       27070000
278200          INTO  :XLT00010-LOC-NBR                                 27080000
278300             ,  :XLT00010-LOC-5-ABBR-NM                           27090000
278400             ,  :XLT00010-CLO-DTE                                 27100000
278500             ,  :PV-EFF-CLOSE-DATE                                27110000
278600             ,  :XLT00014-EFF-BEG-DTE                             27120000
278700             ,  :XLT00014-DC-NBR                                  27130000
278800     END-EXEC.                                                    27140000
278900                                                                  27150000
279000     EVALUATE TRUE                                                27160000
279100         WHEN SQLCODE = ZERO                                      27170000
279200* * PV-EFF-CLOSE-DATE IS CALCULATED IN THE DECLARE, BUT           27180000
279300* * THERE IS NO CHECK TO SEE IF THE STORE IS CLOSED OR NOT        27190000
279400             IF XLT00010-CLO-DTE = '9999-09-99'                   27200000
279500                 MOVE '9999-09-09'   TO PV-EFF-CLOSE-DATE         27210000
279600             END-IF                                               27220000
279700         WHEN SQLCODE = PC-ROW-NOT-FOUND                          27230000
279800             CONTINUE                                             27240000
279900         WHEN SQLWARN0 NOT = SPACE                                27250000
280000         WHEN SQLCODE < ZERO                                      27260000
280100         WHEN SQLCODE > ZERO                                      27270000
280200             MOVE '7010-FETCH-STR-NBR-CSR'                        27280000
280300                 TO DP013-PARAGRAPH                               27290000
280400             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 27300000
280500-                 'FROM THE STR-NBR-CSR'                          27310000
280600                 TO DP013-MESSAGE-TEXT (1)                        27320000
280700             MOVE SQLCA            TO DP013-SQLCA                 27330000
280800             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  27340000
280900             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  27350000
281000             SET DP013-DB2-ABEND   TO TRUE                        27360000
281100             SET DP013-NO-ROLLBACK TO TRUE                        27370000
281200             PERFORM 9999-WRITE-CICS-LOG-MSG                      27380000
281300             GO TO 0000-GOBACK                                    27390000
281400     END-EVALUATE.                                                27400000
281500     SKIP3                                                        27410000
281600 7020-CLOSE-STR-NBR-CSR.                                          27420000
281700     EXEC SQL                                                     27430000
281800         CLOSE STR-NBR-CSR                                        27440000
281900     END-EXEC.                                                    27450000
282000                                                                  27460000
282100     EVALUATE TRUE                                                27470000
282200         WHEN SQLCODE = ZERO                                      27480000
282300             CONTINUE                                             27490000
282400         WHEN SQLWARN0 NOT = SPACE                                27500000
282500         WHEN SQLCODE < ZERO                                      27510000
282600         WHEN SQLCODE > ZERO                                      27520000
282700             MOVE '7020-CLOSE-STR-NBR-CSR'                        27530000
282800                 TO DP013-PARAGRAPH                               27540000
282900             MOVE 'CLOSE THE STR-NBR-CSR'                         27550000
283000                 TO DP013-MESSAGE-TEXT (1)                        27560000
283100             MOVE SQLCA            TO DP013-SQLCA                 27570000
283200             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  27580000
283300             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  27590000
283400             SET DP013-DB2-ABEND   TO TRUE                        27600000
283500             SET DP013-NO-ROLLBACK TO TRUE                        27610000
283600             PERFORM 9999-WRITE-CICS-LOG-MSG                      27620000
283700             GO TO 0000-GOBACK                                    27630000
283800     END-EVALUATE.                                                27640000
283900 EJECT                                                            27650000
284000 7100-SELECT-PO-HDR-DATA.                                         27660000
284100     INITIALIZE DCLTPURCHS                                        27670000
284200                DCLTSTATCD.                                       27680000
284300                                                                  27690000
284400     PERFORM                                                      27700000
284500         WITH TEST AFTER                                          27710000
284600         VARYING PV-SELECT-COUNTER                                27720000
284700         FROM 1 BY 1                                              27730000
284800         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              27740000
284900            OR  (SQLCODE = ZERO)                                  27750000
285000            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     27760000
285100                                                                  27770000
285200         EXEC SQL                                                 27780000
285300             SELECT  A.ENT_ID                                     27790000
285400                   , A.DEPT_NBR                                   27800000
285500               INTO  :PURCHS-ENT-ID                               27810000
285600                   , :PURCHS-DEPT-NBR                             27820000
285700               FROM  TPURCHS A,                                   27830000
285800                     TSTATCD B                                    27840000
285900              WHERE  A.PO_NBR          =  :DK-ORD-NBR             27850000
286000                AND  A.VER_STATUS_CDE  =  'A'                     27860000
286100                AND  B.STATUS_TYP_CDE  =  'P'                     27870000
286200                AND  B.STATUS_CLS      =  'ACT'                   27880000
286300                AND  A.STATUS_CDE      =  B.STATUS_CDE            27890000
286400         END-EXEC                                                 27900000
286500                                                                  27910000
286600         EVALUATE TRUE                                            27920000
286700             WHEN SQLCODE = ZERO                                  27930000
286800             WHEN SQLCODE = -904                                  27940000
286900             WHEN SQLCODE = -913                                  27950000
287000             WHEN SQLCODE = PC-ROW-NOT-FOUND                      27960000
287100                  CONTINUE                                        27970000
287200             WHEN SQLWARN0 NOT = SPACES                           27980000
287300             WHEN SQLCODE < ZERO                                  27990000
287400             WHEN SQLCODE > ZERO                                  28000000
287500                  MOVE '7100-SELECT-PO-HDR-DATA'                  28010000
287600                                     TO DP013-PARAGRAPH           28020000
287700                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 28030000
287800                                     TO DP013-MESSAGE-TEXT (1)    28040000
287900                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       28050000
288000                  MOVE ZEROES        TO  PV-DISPLAY-ORD-LNE-NBR   28060000
288100                  MOVE PV-DISPLAY-KEYS                            28070000
288200                                     TO DP013-MESSAGE-TEXT (2)    28080000
288300                  MOVE SQLCA         TO DP013-SQLCA               28090000
288400                  MOVE 'TPURCHS'     TO DP013-DB2-TABLE-NAME (1)  28100000
288500                  MOVE 'TSTATCD'     TO DP013-DB2-TABLE-NAME (2)  28110000
288600                  SET DP013-DB2-ABEND                             28120000
288700                                     TO TRUE                      28130000
288800                  SET DP013-NO-ROLLBACK                           28140000
288900                                     TO TRUE                      28150000
289000                  PERFORM 9999-WRITE-CICS-LOG-MSG                 28160000
289100                  GO TO 0000-GOBACK                               28170000
289200         END-EVALUATE                                             28180000
289300     END-PERFORM.                                                 28190000
289400                                                                  28200000
289500     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    28210000
289600         MOVE '7100-SELECT-PO-HDR-DATA' TO DP013-PARAGRAPH        28220000
289700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28230000
289800                                     TO DP013-MESSAGE-TEXT (1)    28240000
289900         MOVE 'THE FOLLOWING RECEIVER: '                          28250000
290000                                     TO DP013-MESSAGE-TEXT (2)    28260000
290100         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       28270000
290200         MOVE ZERO                   TO  PV-DISPLAY-ORD-LNE-NBR   28280000
290300         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    28290000
290400         MOVE SQLCA                  TO DP013-SQLCA               28300000
290500         MOVE 'TPURCHS'              TO DP013-DB2-TABLE-NAME (1)  28310000
290600         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (2)  28320000
290700         MOVE 'TSTATCD'              TO DP013-DB2-TABLE-NAME (3)  28330000
290800         SET DP013-DB2-ABEND         TO TRUE                      28340000
290900         SET DP013-NO-ROLLBACK       TO TRUE                      28350000
291000         PERFORM 9999-WRITE-CICS-LOG-MSG                          28360000
291100         GO TO 0000-GOBACK                                        28370000
291200     END-IF.                                                      28380000
291300     EJECT                                                        28390000
291400 7110-GET-KEYREC-NBR.                                             28400000
291500     INITIALIZE DCLTRECEIV.                                       28410000
291600                                                                  28420000
291700     PERFORM                                                      28430000
291800         WITH TEST AFTER                                          28440000
291900         VARYING PV-SELECT-COUNTER                                28450000
292000         FROM 1 BY 1                                              28460000
292100         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              28470000
292200            OR  (SQLCODE = ZERO)                                  28480000
292300            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     28490000
292400                                                                  28500000
292500         EXEC SQL                                                 28510000
292600             SELECT  ACTL_CART_CNT,                               28520000
292700                     EXPTED_CART_CNT,                             28530000
292800                     RCVR_NBR,                                    28540000
292900                     REC_TMST,                                    28550000
293000                     GOH_IND                                      28560000
293100               INTO  :RECEIV-ACTL-CART-CNT,                       28570000
293200                     :RECEIV-EXPTED-CART-CNT,                     28580000
293300                     :RECEIV-RCVR-NBR,                            28590000
293400                     :PV-REC-TMST,                                28600000
293500                     :RECEIV-GOH-IND                              28610000
293600               FROM  TRECEIV                                      28620000
293700              WHERE  (ORD_NBR         =  :DK-ORD-NBR              28630000
293800                AND   REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR         28640000
293900                AND   OPER_UNT_ID     =  :DK-OPER-UNT-ID          28650000
294000                AND   FCLTY_ID        =  :DK-FCLTY-ID             28660000
294100                AND   VER_STATUS_CDE  =  'A')                     28670000
294200         END-EXEC                                                 28680000
294300                                                                  28690000
294400         EVALUATE TRUE                                            28700000
294500             WHEN SQLCODE = ZERO                                  28710000
294600             WHEN SQLCODE = -904                                  28720000
294700             WHEN SQLCODE = -913                                  28730000
294800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      28740000
294900                 CONTINUE                                         28750000
295000             WHEN SQLWARN0 NOT = SPACES                           28760000
295100             WHEN SQLCODE < ZERO                                  28770000
295200             WHEN SQLCODE > ZERO                                  28780000
295300                  MOVE '7110-GET-KEYREC-NBR'                      28790000
295400                                     TO DP013-PARAGRAPH           28800000
295500                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     28810000
295600                                     TO DP013-MESSAGE-TEXT (1)    28820000
295700                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        28830000
295800                  MOVE DK-RCVR-SEQ-NBR                            28840000
295900                                     TO PV-DISPLAY-RCVR-SEQ-NBR   28850000
296000                  MOVE DK-OPER-UNT-ID                             28860000
296100                                     TO PV-DISPLAY-OPER-UNT-ID    28870000
296200                  MOVE DK-FCLTY-ID   TO PV-DISPLAY-FCLTY-ID       28880000
296300                  MOVE PV-DISPLAY-KEYS                            28890000
296400                                     TO DP013-MESSAGE-TEXT (2)    28900000
296500                  MOVE SQLCA         TO DP013-SQLCA               28910000
296600                  MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)  28920000
296700                  SET DP013-DB2-ABEND                             28930000
296800                                     TO TRUE                      28940000
296900                  SET DP013-NO-ROLLBACK                           28950000
297000                                     TO TRUE                      28960000
297100                  PERFORM 9999-WRITE-CICS-LOG-MSG                 28970000
297200                  GO TO 0000-GOBACK                               28980000
297300         END-EVALUATE                                             28990000
297400     END-PERFORM.                                                 29000000
297500                                                                  29010000
297600     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    29020000
297700         MOVE '7110-GET-KEYREC-NBR'                               29030000
297800                                     TO DP013-PARAGRAPH           29040000
297900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29050000
298000                                     TO DP013-MESSAGE-TEXT (1)    29060000
298100         MOVE 'THE KEYREC NUMBER.  KEYS = '                       29070000
298200                                     TO DP013-MESSAGE-TEXT (2)    29080000
298300         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        29090000
298400         MOVE DK-RCVR-SEQ-NBR        TO PV-DISPLAY-RCVR-SEQ-NBR   29100000
298500         MOVE DK-OPER-UNT-ID         TO PV-DISPLAY-OPER-UNT-ID    29110000
298600         MOVE DK-FCLTY-ID            TO PV-DISPLAY-FCLTY-ID       29120000
298700         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    29130000
298800         MOVE SQLCA                  TO DP013-SQLCA               29140000
298900         MOVE 'TRECEIV'              TO DP013-DB2-TABLE-NAME (1)  29150000
299000         SET DP013-DB2-ABEND         TO TRUE                      29160000
299100         SET DP013-NO-ROLLBACK       TO TRUE                      29170000
299200         PERFORM 9999-WRITE-CICS-LOG-MSG                          29180000
299300         GO TO 0000-GOBACK                                        29190000
299400     END-IF.                                                      29200000
299500/                                                                 29210000
299600 7120-GET-PRIMARY-VNDR-NME.                                       29220000
299700     INITIALIZE DCLTENTNME.                                       29230000
299800                                                                  29240000
299900     PERFORM                                                      29250000
300000         WITH TEST AFTER                                          29260000
300100         VARYING PV-SELECT-COUNTER                                29270000
300200         FROM 1 BY 1                                              29280000
300300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              29290000
300400            OR   (SQLCODE = ZERO)                                 29300000
300500            OR   (SQLCODE = PC-ROW-NOT-FOUND))                    29310000
300600                                                                  29320000
300700         EXEC SQL                                                 29330000
300800             SELECT  ENT_NAME_DESC                                29340000
300900               INTO  :ENTNME-ENT-NAME-DESC                        29350000
301000               FROM  TENTNME                                      29360000
301100              WHERE  (ENT_ID    =  :PURCHS-ENT-ID                 29370000
301200                AND   TYPE_CDE  =  '01')                          29380000
301300         END-EXEC                                                 29390000
301400                                                                  29400000
301500         EVALUATE TRUE                                            29410000
301600             WHEN SQLCODE = ZERO                                  29420000
301700             WHEN SQLCODE = -904                                  29430000
301800             WHEN SQLCODE = -913                                  29440000
301900             WHEN SQLCODE = PC-ROW-NOT-FOUND                      29450000
302000                  CONTINUE                                        29460000
302100             WHEN SQLWARN0 NOT = SPACES                           29470000
302200             WHEN SQLCODE < ZERO                                  29480000
302300             WHEN SQLCODE > ZERO                                  29490000
302400                  MOVE '7120-GET-PRIMARY-VNDR-NME'                29500000
302500                                     TO DP013-PARAGRAPH           29510000
302600                  MOVE 'SELECT PRIMARY VENDOR NAME ENT ID = '     29520000
302700                                     TO DP013-MESSAGE-TEXT (1)    29530000
302800                  MOVE PURCHS-ENT-ID TO PV-DISPLAY-ENT-ID         29540000
302900                  MOVE PV-DISPLAY-ENT-ID                          29550000
303000                                     TO DP013-MESSAGE-TEXT (2)    29560000
303100                  MOVE SQLCA         TO DP013-SQLCA               29570000
303200                  MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (1)  29580000
303300                  SET DP013-DB2-ABEND                             29590000
303400                                     TO TRUE                      29600000
303500                  SET DP013-NO-ROLLBACK                           29610000
303600                                     TO TRUE                      29620000
303700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 29630000
303800                  GO TO 0000-GOBACK                               29640000
303900         END-EVALUATE                                             29650000
304000     END-PERFORM.                                                 29660000
304100                                                                  29670000
304200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    29680000
304300         MOVE '7120-GET-PRIMARY-VNDR-NME'                         29690000
304400                                     TO DP013-PARAGRAPH           29700000
304500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29710000
304600                                     TO DP013-MESSAGE-TEXT (1)    29720000
304700         MOVE 'THE PRIMARY VENDOR NAME.  ENT ID = '               29730000
304800                                     TO DP013-MESSAGE-TEXT (2)    29740000
304900         MOVE PURCHS-ENT-ID          TO PV-DISPLAY-ENT-ID         29750000
305000         MOVE PV-DISPLAY-ENT-ID      TO DP013-MESSAGE-TEXT (3)    29760000
305100         MOVE SQLCA                  TO DP013-SQLCA               29770000
305200         MOVE 'TENTNME'              TO DP013-DB2-TABLE-NAME (1)  29780000
305300         SET DP013-DB2-ABEND         TO TRUE                      29790000
305400         SET DP013-NO-ROLLBACK       TO TRUE                      29800000
305500         PERFORM 9999-WRITE-CICS-LOG-MSG                          29810000
305600         GO TO 0000-GOBACK                                        29820000
305700     END-IF.                                                      29830000
305800/                                                                 29840000
310100 7140-GET-SPECIAL-INSTRS.                                         29850000
310200     INITIALIZE DCLTPOINST                                        29860000
310300                DCLTINSTCD.                                       29870000
310400                                                                  29880000
310500     PERFORM                                                      29890000
310600         WITH TEST AFTER                                          29900000
310700         VARYING PV-SELECT-COUNTER                                29910000
310800         FROM 1 BY 1                                              29920000
310900         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              29930000
311000            OR  (SQLCODE = ZERO)                                  29940000
311100            OR  (SQLCODE = PC-ROW-NOT-FOUND)                      29950000
311200            OR  (SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS))          29960000
311300                                                                  29970000
311400         EXEC SQL                                                 29980000
311500             SELECT  B.INSTR_DESC                                 29990000
311600               INTO  :INSTCD-INSTR-DESC                           30000000
311700               FROM  TPOINST A,                                   30010000
311800                     TINSTCD B                                    30020000
311900              WHERE  (A.PO_NBR     =  :DK-ORD-NBR                 30030000
312000                AND   A.RECIP_CDE  =  'DC'                        30040000
312100                AND   A.INSTR_NBR  =  B.INSTR_NBR)                30050000
312200         END-EXEC                                                 30060000
312300                                                                  30070000
312400         EVALUATE TRUE                                            30080000
312500             WHEN SQLCODE = ZERO                                  30090000
312600                 CONTINUE                                         30100000
312700             WHEN SQLCODE = -904                                  30110000
312800             WHEN SQLCODE = -913                                  30120000
312900                 CONTINUE                                         30130000
313000             WHEN SQLCODE = PC-ROW-NOT-FOUND                      30140000
313100                 SET PS-NO-SPECIAL-INSTRS-FOUND    TO  TRUE       30150000
313200             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           30160000
313300                 SET PS-MULT-SPECIAL-INSTRS-FOUND  TO  TRUE       30170000
313400             WHEN SQLWARN0 NOT = SPACES                           30180000
313500             WHEN SQLCODE < ZERO                                  30190000
313600             WHEN SQLCODE > ZERO                                  30200000
313700                  MOVE '7140-GET-SPECIAL-INSTRS'                  30210000
313800                                     TO DP013-PARAGRAPH           30220000
313900                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     30230000
314000                                     TO DP013-MESSAGE-TEXT (1)    30240000
314100                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        30250000
314200                  MOVE PV-DISPLAY-KEYS                            30260000
314300                                     TO DP013-MESSAGE-TEXT (2)    30270000
314400                  MOVE SQLCA         TO DP013-SQLCA               30280000
314500                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  30290000
314600                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  30300000
314700                  SET DP013-DB2-ABEND                             30310000
314800                                     TO TRUE                      30320000
314900                  SET DP013-NO-ROLLBACK                           30330000
315000                                     TO TRUE                      30340000
315100                  PERFORM 9999-WRITE-CICS-LOG-MSG                 30350000
315200                  GO TO 0000-GOBACK                               30360000
315300         END-EVALUATE                                             30370000
315400     END-PERFORM.                                                 30380000
315500                                                                  30390000
315600     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    30400000
315700         MOVE '7140-GET-SPECIAL-INSTRS'                           30410000
315800                                     TO DP013-PARAGRAPH           30420000
315900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30430000
316000                                     TO DP013-MESSAGE-TEXT (1)    30440000
316100         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                30450000
316200                                     TO DP013-MESSAGE-TEXT (2)    30460000
316300         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        30470000
316400         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    30480000
316500         MOVE SQLCA                  TO DP013-SQLCA               30490000
316600         MOVE 'TPOINST'              TO DP013-DB2-TABLE-NAME (1)  30500000
316700         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  30510000
316800         SET DP013-DB2-ABEND         TO TRUE                      30520000
316900         SET DP013-NO-ROLLBACK       TO TRUE                      30530000
317000         PERFORM 9999-WRITE-CICS-LOG-MSG                          30540000
317100         GO TO 0000-GOBACK                                        30550000
317200     END-IF.                                                      30560000
317300/                                                                 30570000
317400 7200-SELECT-PURITM-DATA.                                         30580000
317500     INITIALIZE DCLTPURITM                                        30590000
317600                                                                  30600000
317700     PERFORM                                                      30610000
317800         WITH TEST AFTER                                          30620000
317900         VARYING PV-SELECT-COUNTER                                30630000
318000         FROM 1 BY 1                                              30640000
318100         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              30650000
318200            OR  (SQLCODE = ZERO)                                  30660000
318300            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     30670000
318400                                                                  30680000
318500         EXEC SQL                                                 30690000
318600             SELECT  A.SKU_SEQ_NBR,                               30700000
318700                     A.VEND_STYL_NAME,                            30710000
318800                     A.SKU_DESC,                                  30720000
318900                     A.SIZE_DESC,                                 30730000
319000                     A.COLOR_DESC,                                30740000
319100                     A.UNT_RTL_PR_AMT,                            30750000
319200                     A.ITM_NBR,                                   30760000
319300                     A.PO_LNE_NBR,                                30770000
319400                     B.TKT_FMT_ID,                                30780000
319500                     B.PRE_TKT_IND                                30790000
319600               INTO  :PURITM-SKU-SEQ-NBR,                         30800000
319700                     :PURITM-VEND-STYL-NAME,                      30810000
319800                     :PURITM-SKU-DESC,                            30820000
319900                     :PURITM-SIZE-DESC,                           30830000
320000                     :PURITM-COLOR-DESC,                          30840000
320100                     :PURITM-UNT-RTL-PR-AMT,                      30850000
320200                     :PURITM-ITM-NBR,                             30860000
320300                     :PURITM-PO-LNE-NBR,                          30870000
320400                     :RECITM-TKT-FMT-ID,                          30880000
320500                     :RECITM-PRE-TKT-IND                          30890000
320600               FROM  TPURITM A                                    30900000
320700                  ,  TRECITM B                                    30910000
320800              WHERE  A.PO_NBR          =  :DK-ORD-NBR             30920000
320900                AND  A.PO_NBR          =  B.ORD_NBR               30930000
321000                AND  A.APP_PO_LNE_NBR  =  :DK-ORD-LNE-NBR         30940000
321100                AND  A.APP_PO_LNE_NBR  =  B.ORD_LNE_NBR           30950000
321200                AND  A.VER_NBR         =  B.PO_VER_NBR            30960000
321300                AND  B.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR        30970000
321400                AND  B.OPER_UNT_ID     =  :DK-OPER-UNT-ID         30980000
321500                AND  B.FCLTY_ID        =  :DK-FCLTY-ID            30990000
321600                AND  B.VER_STATUS_CDE  =  :PC-A                   31000000
321700         END-EXEC                                                 31010000
321800                                                                  31020000
321900         EVALUATE TRUE                                            31030000
322000             WHEN SQLCODE = ZERO                                  31040000
322100                  SET PS-CALL-API-YES TO TRUE                     31050000
322200             WHEN SQLCODE = -904                                  31060000
322300             WHEN SQLCODE = -913                                  31070000
322400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      31080000
322500                  SET PS-CALL-API-NO  TO TRUE                     31090000
322600             WHEN SQLWARN0 NOT = SPACES                           31100000
322700             WHEN SQLCODE < ZERO                                  31110000
322800             WHEN SQLCODE > ZERO                                  31120000
322900                  MOVE '7200-SELECT-PURITM-DATA'                  31130000
323000                                     TO DP013-PARAGRAPH           31140000
323100                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 31150000
323200                                     TO DP013-MESSAGE-TEXT (1)    31160000
323300                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       31170000
323400                  MOVE DK-ORD-LNE-NBR                             31180000
323500                                     TO  PV-DISPLAY-ORD-LNE-NBR   31190000
323600                  MOVE PV-DISPLAY-KEYS                            31200000
323700                                     TO DP013-MESSAGE-TEXT (2)    31210000
323800                  MOVE SQLCA         TO DP013-SQLCA               31220000
323900                  MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)  31230000
324000                  MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)  31240000
324100                  SET DP013-DB2-ABEND                             31250000
324200                                     TO TRUE                      31260000
324300                  SET DP013-NO-ROLLBACK                           31270000
324400                                     TO TRUE                      31280000
324500                  PERFORM 9999-WRITE-CICS-LOG-MSG                 31290000
324600                  GO TO 0000-GOBACK                               31300000
324700         END-EVALUATE                                             31310000
324800     END-PERFORM.                                                 31320000
324900                                                                  31330000
325000     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    31340000
325100         MOVE '7200-PURITM-DATA' TO DP013-PARAGRAPH               31350000
325200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     31360000
325300                                     TO DP013-MESSAGE-TEXT (1)    31370000
325400         MOVE 'THE FOLLOWING RECEIVER: '                          31380000
325500                                     TO DP013-MESSAGE-TEXT (2)    31390000
325600         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       31400000
325700         MOVE DK-ORD-LNE-NBR         TO  PV-DISPLAY-ORD-LNE-NBR   31410000
325800         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    31420000
325900         MOVE SQLCA                  TO DP013-SQLCA               31430000
326000         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (1)  31440000
326100         MOVE 'TRECITM'              TO DP013-DB2-TABLE-NAME (2)  31450000
326200         SET DP013-DB2-ABEND         TO TRUE                      31460000
326300         SET DP013-NO-ROLLBACK       TO TRUE                      31470000
326400         PERFORM 9999-WRITE-CICS-LOG-MSG                          31480000
326500         GO TO 0000-GOBACK                                        31490000
326600     END-IF.                                                      31500000
326700     EJECT                                                        31510000
326800*----------------------------------------------------------------*31520000
326900* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *31530000
327000*----------------------------------------------------------------*31540000
327100*                                                                 31550000
327200 7205-CALL-CICS-API-ARCH.                                         31560000
327300                                                                  31570000
327400        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               31580000
327500                                                                  31590000
327600        SET  XL001-BY-ITEM                                        31600000
327700             XL001-SELECT-SKU                                     31610000
327800             XL001-SELECT-SKU-STR                                 31620000
327900             XL001-SELECT-VND-STYL TO TRUE.                       31630000
328000                                                                  31640000
328100        CALL XL001-VSM-PGM USING  DFHEIBLK                        31650000
328200                                  XL001-COMMAREA                  31660000
328300                                  XL001-ITEM-COMMAREA.            31670000
328400                                                                  31680000
328500     EVALUATE TRUE                                                31690000
328600                                                                  31700000
328700          WHEN XL001-SKU-SQLCODE = +0                             31710000
328800              MOVE XL001-SKU-DESC  TO HL8-SKU-DESC                31720000
328900              PERFORM 7206-SELECT-VND-STYL                        31730000
329000                                                                  31740000
329100          WHEN XL001-SKU-SQLCODE = +100                           31750000
329200              MOVE ZEROES TO HL5-SEQ-NBR                          31760000
329300              MOVE SPACES TO HL8-SKU-DESC                         31770000
329400              MOVE SPACES TO HL6-SIZE                             31780000
329500              MOVE SPACES TO HL7-COLOR                            31790000
329600              MOVE SPACES TO HL9-VNDR-STYLE-NME                   31800000
329700              MOVE SPACES TO HL9-PRESENTATION                     31810000
329800                             HL5-CLASS-NBR                        31820000
329900                                                                  31830000
330000          WHEN XL001-INVALID-ACCESS                               31840000
330100              MOVE '7205-CALL-CICS-API-ARCH'                      31850000
330200                                    TO DP013-PARAGRAPH            31860000
330300              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           31870000
330400                                    TO DP013-MESSAGE-TEXT (1)     31880000
330500              MOVE PURITM-ITM-NBR   TO PV-DISPLAY-ITEM-NBR        31890000
330600              MOVE PV-DISPLAY-ITEM-NBR                            31900000
330700                                    TO DP013-MESSAGE-TEXT (2)     31910000
330800              MOVE SQLCA            TO DP013-SQLCA                31920000
330900              MOVE 'XLV_SKU'        TO DP013-DB2-TABLE-NAME (1)   31930000
331000              SET DP013-DB2-ABEND   TO TRUE                       31940000
331100              SET DP013-NO-ROLLBACK TO TRUE                       31950000
331200              PERFORM 9999-WRITE-CICS-LOG-MSG                     31960000
331300              GO TO 0000-GOBACK                                   31970000
331400                                                                  31980000
331500          WHEN OTHER                                              31990000
331600              MOVE '7205-CALL-CICS-API-ARCH'                      32000000
331700                   TO DP013-PARAGRAPH                             32010000
331800              MOVE 'PROCESSING SKU VIEW:'                         32020000
331900                   TO DP013-MESSAGE-TEXT (1)                      32030000
332000              MOVE PURITM-ITM-NBR    TO PV-DISPLAY-ITEM-NBR       32040000
332100              MOVE PV-DISPLAY-ITEM-NBR                            32050000
332200                                     TO DP013-MESSAGE-TEXT (2)    32060000
332300              MOVE XL001-SKU-SQLCODE TO SQLCODE                   32070000
332400              MOVE SQLCA             TO DP013-SQLCA               32080000
332500              MOVE 'XLV_SKU'         TO DP013-DB2-TABLE-NAME (1)  32090000
332600              SET DP013-DB2-ABEND    TO TRUE                      32100000
332700              SET DP013-NO-ROLLBACK  TO TRUE                      32110000
332800              PERFORM 9999-WRITE-CICS-LOG-MSG                     32120000
332900              GO TO 0000-GOBACK                                   32130000
333000                                                                  32140000
333100     END-EVALUATE.                                                32150000
333200                                                                  32160000
333300 7206-SELECT-VND-STYL.                                            32170000
333400                                                                  32180000
333500     EVALUATE TRUE                                                32190000
333600                                                                  32200000
333700          WHEN XL001-VND-STYL-SQLCODE = +0                        32210000
333800              MOVE XL001-VS-NBR    TO  HL9-VNDR-STYLE-NME         32220000
333900              MOVE XL001-HNG-FOLD-DESC                            32230000
334000                                   TO HL9-PRESENTATION            32240000
334100              MOVE XL001-SUB-CL-NBR-2CH                           32250000
334200                                     TO HL5-CLASS-NBR             32260000
334300              PERFORM 7207-SELECT-SKU-STR                         32270000
334400                                                                  32280000
334500          WHEN XL001-VND-STYL-SQLCODE = +100                      32290000
334600              MOVE SPACES            TO  HL9-VNDR-STYLE-NME       32300000
334700              MOVE SPACES            TO  HL9-PRESENTATION         32310000
334800                                         HL5-CLASS-NBR            32320000
334900              MOVE ZEROES            TO  HL11-SKU-RTL             32330000
335000                                                                  32340000
335100                                                                  32350000
335200          WHEN OTHER                                              32360000
335300              MOVE '7206-SELECT-VND-STYL'                         32370000
335400                                      TO DP013-PARAGRAPH          32380000
335500              MOVE 'PROCESSING VENDOUR STYLE:'                    32390000
335600                                      TO DP013-MESSAGE-TEXT (1)   32400000
335700              MOVE PURITM-ITM-NBR     TO PV-DISPLAY-ITEM-NBR      32410000
335800              MOVE PV-DISPLAY-ITEM-NBR                            32420000
335900                                      TO DP013-MESSAGE-TEXT (2)   32430000
336000              MOVE SQLCA              TO DP013-SQLCA              32440000
336100              MOVE 'XLV_VND_STYL'     TO DP013-DB2-TABLE-NAME (1) 32450000
336200              SET DP013-DB2-ABEND     TO TRUE                     32460000
336300              SET DP013-NO-ROLLBACK   TO TRUE                     32470000
336400              PERFORM 9999-WRITE-CICS-LOG-MSG                     32480000
336500              GO TO 0000-GOBACK                                   32490000
336600                                                                  32500000
336700     END-EVALUATE.                                                32510000
336800                                                                  32520000
336900 7207-SELECT-SKU-STR.                                             32530000
337000                                                                  32540000
337100     EVALUATE TRUE                                                32550000
337200                                                                  32560000
337300          WHEN XL001-SKU-STR-SQLCODE = +0                         32570000
337400              MOVE XL001-UNT-RTL-AMT                              32580000
337500                           TO  HL11-SKU-RTL                       32590000
337600                                                                  32600000
337700          WHEN XL001-SKU-STR-SQLCODE = +100                       32610000
337800              MOVE ZEROES            TO  HL11-SKU-RTL             32620000
337900                                                                  32630000
338000                                                                  32640000
338100          WHEN OTHER                                              32650000
338200              MOVE '7207-SELECT-SKU-STR'                          32660000
338300                                      TO DP013-PARAGRAPH          32670000
338400              MOVE 'PROCESSING SKU STR:'                          32680000
338500                                      TO DP013-MESSAGE-TEXT (1)   32690000
338600              MOVE PURITM-ITM-NBR     TO PV-DISPLAY-ITEM-NBR      32700000
338700              MOVE PV-DISPLAY-ITEM-NBR                            32710000
338800                                      TO DP013-MESSAGE-TEXT (2)   32720000
338900              MOVE SQLCA              TO DP013-SQLCA              32730000
339000              MOVE 'XLV_SKU_STR'      TO DP013-DB2-TABLE-NAME (1) 32740000
339100              SET DP013-DB2-ABEND     TO TRUE                     32750000
339200              SET DP013-NO-ROLLBACK   TO TRUE                     32760000
339300              PERFORM 9999-WRITE-CICS-LOG-MSG                     32770000
339400              GO TO 0000-GOBACK                                   32780000
339500                                                                  32790000
339600     END-EVALUATE.                                                32800000
339700                                                                  32810000
339800 7220-SELECT-TRECITM.                                             32820000
339900                                                                  32830000
340000     EXEC SQL                                                     32840000
340100         SELECT COLOR_DESC                                        32850000
340200              , SIZE_DESC                                         32860000
340300              , PREPK_ID                                          32870000
340400           INTO :RECITM-COLOR-DESC                                32880000
340500              , :RECITM-SIZE-DESC                                 32890000
340600              , :RECITM-PREPK-ID                                  32900000
340700           FROM  TRECITM                                          32910000
340800           WHERE ORD_NBR         = :DK-ORD-NBR                    32920000
340900             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                32930000
341000             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                32940000
341100             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               32950000
341200             AND VER_STATUS_CDE  = :PC-A                          32960000
341300     END-EXEC.                                                    32970000
341400                                                                  32980000
341500     EVALUATE TRUE                                                32990000
341600         WHEN SQLCODE = ZERO                                      33000000
341700         WHEN SQLCODE = +100                                      33010000
341800              CONTINUE                                            33020000
341900         WHEN SQLWARN0 NOT = SPACES                               33030000
342000         WHEN SQLCODE < ZERO                                      33040000
342100         WHEN SQLCODE > ZERO                                      33050000
342200              MOVE '7220-SELECT-TRECITM'                          33060000
342300                                     TO  DP013-PARAGRAPH          33070000
342400              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  33080000
342500                                     TO  DP013-MESSAGE-TEXT (1)   33090000
342600              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   33100000
342700              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   33110000
342800              MOVE SQLCA             TO  DP013-SQLCA              33120000
342900              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 33130000
343000              SET DP013-DB2-ABEND    TO  TRUE                     33140000
343100              SET DP013-NO-ROLLBACK  TO  TRUE                     33150000
343200              PERFORM 9999-WRITE-CICS-LOG-MSG                     33160000
343300              GO TO 0000-GOBACK                                   33170000
343400     END-EVALUATE.                                                33180000
343500/                                                                 33190000
343600 7230-OPEN-LNELOC-CSR.                                            33200000
343700     EXEC SQL                                                     33210000
343800         OPEN LNELOC-CSR                                          33220000
343900     END-EXEC.                                                    33230000
344000                                                                  33240000
344100     EVALUATE TRUE                                                33250000
344200         WHEN SQLCODE = ZERO                                      33260000
344300             CONTINUE                                             33270000
344400         WHEN SQLWARN0 NOT = SPACE                                33280000
344500         WHEN SQLCODE < ZERO                                      33290000
344600         WHEN SQLCODE > ZERO                                      33300000
344700             MOVE '7230-OPEN-LNELOC-CSR'                          33310000
344800                 TO DP013-PARAGRAPH                               33320000
344900             MOVE 'OPEN THE LNELOC-CSR'                           33330000
345000                 TO DP013-MESSAGE-TEXT (1)                        33340000
345100             MOVE SQLCA            TO DP013-SQLCA                 33350000
345200             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    33360000
345300             SET DP013-DB2-ABEND   TO TRUE                        33370000
345400             SET DP013-NO-ROLLBACK TO TRUE                        33380000
345500             PERFORM 9999-WRITE-CICS-LOG-MSG                      33390000
345600             GO TO 0000-GOBACK                                    33400000
345700     END-EVALUATE.                                                33410000
345800     SKIP3                                                        33420000
345900 7240-FETCH-LNELOC-CSR.                                           33430000
346000     INITIALIZE DCLTWKORIN.                                       33440000
346100                                                                  33450000
346200     EXEC SQL                                                     33460000
346300         FETCH  LNELOC-CSR                                        33470000
346400          INTO  :WKORIN-STRT-TMST,                                33480000
346500                :WKORIN-LNE-LOC-CDE,                              33490000
346600                :WKORIN-SCREEN-SEQ-NBR                            33500000
346700     END-EXEC.                                                    33510000
346800                                                                  33520000
346900     EVALUATE TRUE                                                33530000
347000         WHEN SQLCODE = ZERO                                      33540000
347100             CONTINUE                                             33550000
347200         WHEN SQLCODE = PC-ROW-NOT-FOUND                          33560000
347300             CONTINUE                                             33570000
347400         WHEN SQLWARN0 NOT = SPACE                                33580000
347500         WHEN SQLCODE < ZERO                                      33590000
347600         WHEN SQLCODE > ZERO                                      33600000
347700             MOVE '7240-FETCH-LNELOC-CSR'                         33610000
347800                 TO DP013-PARAGRAPH                               33620000
347900             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 33630000
348000-                 'FROM THE LNELOC-CSR'                           33640000
348100               TO DP013-MESSAGE-TEXT (1)                          33650000
348200             MOVE SQLCA            TO DP013-SQLCA                 33660000
348300             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    33670000
348400             SET DP013-DB2-ABEND   TO TRUE                        33680000
348500             SET DP013-NO-ROLLBACK TO TRUE                        33690000
348600             PERFORM 9999-WRITE-CICS-LOG-MSG                      33700000
348700             GO TO 0000-GOBACK                                    33710000
348800     END-EVALUATE.                                                33720000
348900     SKIP3                                                        33730000
349000 7250-CLOSE-LNELOC-CSR.                                           33740000
349100     EXEC SQL                                                     33750000
349200         CLOSE LNELOC-CSR                                         33760000
349300     END-EXEC.                                                    33770000
349400                                                                  33780000
349500     EVALUATE TRUE                                                33790000
349600         WHEN SQLCODE = ZERO                                      33800000
349700             CONTINUE                                             33810000
349800         WHEN SQLWARN0 NOT = SPACE                                33820000
349900         WHEN SQLCODE < ZERO                                      33830000
350000         WHEN SQLCODE > ZERO                                      33840000
350100             MOVE '7250-CLOSE-LNELOC-CSR'                         33850000
350200                 TO DP013-PARAGRAPH                               33860000
350300             MOVE 'CLOSE THE LNELOC-CSR'                          33870000
350400                 TO DP013-MESSAGE-TEXT (1)                        33880000
350500             MOVE SQLCA            TO DP013-SQLCA                 33890000
350600             MOVE 'TWKORIN'        TO DP013-DB2-TABLE-NAME (1)    33900000
350700             SET DP013-DB2-ABEND   TO TRUE                        33910000
350800             SET DP013-NO-ROLLBACK TO TRUE                        33920000
350900             PERFORM 9999-WRITE-CICS-LOG-MSG                      33930000
351000             GO TO 0000-GOBACK                                    33940000
351100     END-EVALUATE.                                                33950000
351200     EJECT                                                        33960000
351300 7260-OPEN-TRBL-CSR.                                              33970000
351400     EXEC SQL                                                     33980000
351500         OPEN TRBL-CSR1                                           33990000
351600     END-EXEC.                                                    34000000
351700                                                                  34010000
351800     EVALUATE TRUE                                                34020000
351900         WHEN SQLCODE = ZERO                                      34030000
352000             CONTINUE                                             34040000
352100         WHEN SQLWARN0 NOT = SPACE                                34050000
352200         WHEN SQLCODE < ZERO                                      34060000
352300         WHEN SQLCODE > ZERO                                      34070000
352400             MOVE '7260-OPEN-TRBL-CSR'                            34080000
352500                 TO DP013-PARAGRAPH                               34090000
352600             MOVE 'OPEN THE TRBL-CSR'                             34100000
352700                 TO DP013-MESSAGE-TEXT (1)                        34110000
352800             MOVE SQLCA            TO DP013-SQLCA                 34120000
352900             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    34130000
353000             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    34140000
353100             SET DP013-DB2-ABEND   TO TRUE                        34150000
353200             SET DP013-NO-ROLLBACK TO TRUE                        34160000
353300             PERFORM 9999-WRITE-CICS-LOG-MSG                      34170000
353400             GO TO 0000-GOBACK                                    34180000
353500     END-EVALUATE.                                                34190000
353600*                                                                 34200000
353700 7265-OPEN-TRBL-CSR2.                                             34210000
353800     EXEC SQL                                                     34220000
353900         OPEN TRBL-CSR2                                           34230000
354000     END-EXEC.                                                    34240000
354100                                                                  34250000
354200     EVALUATE TRUE                                                34260000
354300         WHEN SQLCODE = ZERO                                      34270000
354400             CONTINUE                                             34280000
354500         WHEN SQLWARN0 NOT = SPACE                                34290000
354600         WHEN SQLCODE < ZERO                                      34300000
354700         WHEN SQLCODE > ZERO                                      34310000
354800             MOVE '7265-OPEN-TRBL-CSR2'                           34320000
354900                 TO DP013-PARAGRAPH                               34330000
355000             MOVE 'OPEN THE TRBL-CSR2'                            34340000
355100                 TO DP013-MESSAGE-TEXT (1)                        34350000
355200             MOVE SQLCA            TO DP013-SQLCA                 34360000
355300             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    34370000
355400             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    34380000
355500             SET DP013-DB2-ABEND   TO TRUE                        34390000
355600             SET DP013-NO-ROLLBACK TO TRUE                        34400000
355700             PERFORM 9999-WRITE-CICS-LOG-MSG                      34410000
355800             GO TO 0000-GOBACK                                    34420000
355900     END-EVALUATE.                                                34430000
356000*                                                                 34440000
356100 7270-FETCH-TRBL-CSR.                                             34450000
356200     INITIALIZE DCLTTRBRSN.                                       34460000
356300                                                                  34470000
356400     EXEC SQL                                                     34480000
356500         FETCH  TRBL-CSR1                                         34490000
356600          INTO  :TRBRSN-TRBL-LONG-DESC                            34500000
356700     END-EXEC.                                                    34510000
356800                                                                  34520000
356900     EVALUATE TRUE                                                34530000
357000         WHEN SQLCODE = ZERO                                      34540000
357100             CONTINUE                                             34550000
357200         WHEN SQLCODE = PC-ROW-NOT-FOUND                          34560000
357300             CONTINUE                                             34570000
357400         WHEN SQLWARN0 NOT = SPACE                                34580000
357500         WHEN SQLCODE < ZERO                                      34590000
357600         WHEN SQLCODE > ZERO                                      34600000
357700             MOVE '7270-FETCH-TRBL-CSR'                           34610000
357800                 TO DP013-PARAGRAPH                               34620000
357900             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 34630000
358000-                 'FROM THE TRBL-CSR'                             34640000
358100               TO DP013-MESSAGE-TEXT (1)                          34650000
358200             MOVE SQLCA            TO DP013-SQLCA                 34660000
358300             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    34670000
358400             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    34680000
358500             SET DP013-DB2-ABEND   TO TRUE                        34690000
358600             SET DP013-NO-ROLLBACK TO TRUE                        34700000
358700             PERFORM 9999-WRITE-CICS-LOG-MSG                      34710000
358800             GO TO 0000-GOBACK                                    34720000
358900     END-EVALUATE.                                                34730000
359000*                                                                 34740000
359100 7275-FETCH-TRBL-CSR2.                                            34750000
359200     INITIALIZE DCLTTRBRSN                                        34760000
359300                                                                  34770000
359400     EXEC SQL                                                     34780000
359500         FETCH  TRBL-CSR2                                         34790000
359600          INTO  :TRBRSN-TRBL-LONG-DESC                            34800000
359700              , :TRBNTF-RESOLVED-IND                              34810000
359800     END-EXEC.                                                    34820000
359900                                                                  34830000
360000     EVALUATE TRUE                                                34840000
360100         WHEN SQLCODE = ZERO                                      34850000
360200             CONTINUE                                             34860000
360300         WHEN SQLCODE = PC-ROW-NOT-FOUND                          34870000
360400             CONTINUE                                             34880000
360500         WHEN SQLWARN0 NOT = SPACE                                34890000
360600         WHEN SQLCODE < ZERO                                      34900000
360700         WHEN SQLCODE > ZERO                                      34910000
360800             MOVE '7275-FETCH-TRBL-CSR2'                          34920000
360900                 TO DP013-PARAGRAPH                               34930000
361000             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 34940000
361100-                 'FROM THE TRBL-CSR2'                            34950000
361200               TO DP013-MESSAGE-TEXT (1)                          34960000
361300             MOVE SQLCA            TO DP013-SQLCA                 34970000
361400             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    34980000
361500             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    34990000
361600             SET DP013-DB2-ABEND   TO TRUE                        35000000
361700             SET DP013-NO-ROLLBACK TO TRUE                        35010000
361800             PERFORM 9999-WRITE-CICS-LOG-MSG                      35020000
361900             GO TO 0000-GOBACK                                    35030000
362000     END-EVALUATE.                                                35040000
362100*                                                                 35050000
362200 7280-CLOSE-TRBL-CSR.                                             35060000
362300     EXEC SQL                                                     35070000
362400         CLOSE TRBL-CSR1                                          35080000
362500     END-EXEC.                                                    35090000
362600                                                                  35100000
362700     EVALUATE TRUE                                                35110000
362800         WHEN SQLCODE = ZERO                                      35120000
362900             CONTINUE                                             35130000
363000         WHEN SQLWARN0 NOT = SPACE                                35140000
363100         WHEN SQLCODE < ZERO                                      35150000
363200         WHEN SQLCODE > ZERO                                      35160000
363300             MOVE '7280-CLOSE-TRBL-CSR'                           35170000
363400                 TO DP013-PARAGRAPH                               35180000
363500             MOVE 'CLOSE THE TRBL-CSR'                            35190000
363600                 TO DP013-MESSAGE-TEXT (1)                        35200000
363700             MOVE SQLCA            TO DP013-SQLCA                 35210000
363800             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    35220000
363900             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    35230000
364000             SET DP013-DB2-ABEND   TO TRUE                        35240000
364100             SET DP013-NO-ROLLBACK TO TRUE                        35250000
364200             PERFORM 9999-WRITE-CICS-LOG-MSG                      35260000
364300             GO TO 0000-GOBACK                                    35270000
364400     END-EVALUATE.                                                35280000
364500 7285-CLOSE-TRBL-CSR2.                                            35290000
364600     EXEC SQL                                                     35300000
364700         CLOSE TRBL-CSR2                                          35310000
364800     END-EXEC.                                                    35320000
364900                                                                  35330000
365000     EVALUATE TRUE                                                35340000
365100         WHEN SQLCODE = ZERO                                      35350000
365200             CONTINUE                                             35360000
365300         WHEN SQLWARN0 NOT = SPACE                                35370000
365400         WHEN SQLCODE < ZERO                                      35380000
365500         WHEN SQLCODE > ZERO                                      35390000
365600             MOVE '7285-CLOSE-TRBL-CSR2'                          35400000
365700                 TO DP013-PARAGRAPH                               35410000
365800             MOVE 'CLOSE THE TRBL-CSR2'                           35420000
365900                 TO DP013-MESSAGE-TEXT (1)                        35430000
366000             MOVE SQLCA            TO DP013-SQLCA                 35440000
366100             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    35450000
366200             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    35460000
366300             SET DP013-DB2-ABEND   TO TRUE                        35470000
366400             SET DP013-NO-ROLLBACK TO TRUE                        35480000
366500             PERFORM 9999-WRITE-CICS-LOG-MSG                      35490000
366600             GO TO 0000-GOBACK                                    35500000
366700     END-EVALUATE.                                                35510000
366800     EJECT                                                        35520000
366900 7320-OPEN-RECDIS-CSR.                                            35530000
367000     EXEC SQL                                                     35540000
367100         OPEN RECDIS-CSR                                          35550000
367200     END-EXEC.                                                    35560000
367300                                                                  35570000
367400     EVALUATE TRUE                                                35580000
367500         WHEN SQLCODE = ZERO                                      35590000
367600             CONTINUE                                             35600000
367700         WHEN SQLWARN0 NOT = SPACE                                35610000
367800         WHEN SQLCODE < ZERO                                      35620000
367900         WHEN SQLCODE > ZERO                                      35630000
368000             MOVE '7320-OPEN-RECDIS-CSR'                          35640000
368100                 TO DP013-PARAGRAPH                               35650000
368200             MOVE 'OPEN THE RECDIS-CSR'                           35660000
368300                 TO DP013-MESSAGE-TEXT (1)                        35670000
368400             MOVE SQLCA             TO DP013-SQLCA                35680000
368500             MOVE 'TRECDIS'         TO DP013-DB2-TABLE-NAME (1)   35690000
368600             SET DP013-DB2-ABEND    TO TRUE                       35700000
368700             SET DP013-NO-ROLLBACK  TO TRUE                       35710000
368800             PERFORM 9999-WRITE-CICS-LOG-MSG                      35720000
368900             GO TO 0000-GOBACK                                    35730000
369000     END-EVALUATE.                                                35740000
369100*                                                                 35750000
369200 7330-FETCH-RECDIS-CSR.                                           35760000
369300     INITIALIZE DCLTRECDIS.                                       35770000
369400                                                                  35780000
369500     EXEC SQL                                                     35790000
369600         FETCH  RECDIS-CSR                                        35800000
369700          INTO  :RECDIS-STR-NBR,                                  35810000
369800                :RECDIS-EXPTED-ITM-QTY                            35820000
369900     END-EXEC.                                                    35830000
370000                                                                  35840000
370100     EVALUATE TRUE                                                35850000
370200         WHEN SQLCODE = ZERO                                      35860000
370300              CONTINUE                                            35870000
370400         WHEN SQLCODE = PC-ROW-NOT-FOUND                          35880000
370500             CONTINUE                                             35890000
370600         WHEN SQLWARN0 NOT = SPACE                                35900000
370700         WHEN SQLCODE < ZERO                                      35910000
370800         WHEN SQLCODE > ZERO                                      35920000
370900             MOVE '7330-FETCH-RECDIS-CSR'                         35930000
371000                 TO DP013-PARAGRAPH                               35940000
371100             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 35950000
371200-                 'FROM THE RECDIS-CSR'                           35960000
371300                 TO DP013-MESSAGE-TEXT (1)                        35970000
371400             MOVE SQLCA            TO DP013-SQLCA                 35980000
371500             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    35990000
371600             SET DP013-DB2-ABEND   TO TRUE                        36000000
371700             SET DP013-NO-ROLLBACK TO TRUE                        36010000
371800             PERFORM 9999-WRITE-CICS-LOG-MSG                      36020000
371900             GO TO 0000-GOBACK                                    36030000
372000     END-EVALUATE.                                                36040000
372100     SKIP2                                                        36050000
372200 7340-CLOSE-RECDIS-CSR.                                           36060000
372300     EXEC SQL                                                     36070000
372400         CLOSE RECDIS-CSR                                         36080000
372500     END-EXEC.                                                    36090000
372600                                                                  36100000
372700     EVALUATE TRUE                                                36110000
372800         WHEN SQLCODE = ZERO                                      36120000
372900             CONTINUE                                             36130000
373000         WHEN SQLWARN0 NOT = SPACE                                36140000
373100         WHEN SQLCODE < ZERO                                      36150000
373200         WHEN SQLCODE > ZERO                                      36160000
373300             MOVE '7340-CLOSE-RECDIS-CSR'                         36170000
373400                 TO DP013-PARAGRAPH                               36180000
373500             MOVE 'CLOSE THE RECDIS-CSR'                          36190000
373600                 TO DP013-MESSAGE-TEXT (1)                        36200000
373700             MOVE SQLCA            TO DP013-SQLCA                 36210000
373800             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    36220000
373900             SET DP013-DB2-ABEND   TO TRUE                        36230000
374000             SET DP013-NO-ROLLBACK TO TRUE                        36240000
374100             PERFORM 9999-WRITE-CICS-LOG-MSG                      36250000
374200             GO TO 0000-GOBACK                                    36260000
374300     END-EVALUATE.                                                36270000
374400/                                                                 36280000
374500 7410-SELECT-MKING-TMST.                                          36290000
374600                                                                  36300000
374700     EXEC SQL                                                     36310000
374800         SELECT MKING_APRON_TMST                                  36320000
374900           INTO :RECITM-MKING-APRON-TMST                          36330000
375000           FROM  TRECITM                                          36340000
375100           WHERE ORD_NBR         = :DK-ORD-NBR                    36350000
375200             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                36360000
375300             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                36370000
375400             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               36380000
375500             AND VER_STATUS_CDE  = :PC-A                          36390000
375600     END-EXEC.                                                    36400000
375700                                                                  36410000
375800     EVALUATE TRUE                                                36420000
375900         WHEN SQLCODE = ZERO                                      36430000
376000              SET PS-YES-TRECITM     TO TRUE                      36440000
376100         WHEN SQLCODE = +100                                      36450000
376200              SET PS-NO-TRECITM      TO TRUE                      36460000
376300              MOVE PC-DB2-ZERO-DATE-TIME                          36470000
376400                                     TO RECITM-MKING-APRON-TMST   36480000
376500         WHEN SQLWARN0 NOT = SPACES                               36490000
376600         WHEN SQLCODE < ZERO                                      36500000
376700         WHEN SQLCODE > ZERO                                      36510000
376800              MOVE '7410-SELECT-MKING-TMST'                       36520000
376900                                     TO  DP013-PARAGRAPH          36530000
377000              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  36540000
377100                                     TO  DP013-MESSAGE-TEXT (1)   36550000
377200              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   36560000
377300              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   36570000
377400              MOVE SQLCA             TO  DP013-SQLCA              36580000
377500              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 36590000
377600              SET DP013-DB2-ABEND    TO  TRUE                     36600000
377700              SET DP013-NO-ROLLBACK  TO  TRUE                     36610000
377800              PERFORM 9999-WRITE-CICS-LOG-MSG                     36620000
377900              GO TO 0000-GOBACK                                   36630000
378000     END-EVALUATE.                                                36640000
378100     EJECT                                                        36650000
382500/                                                                 36660000
382600* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     36670000
382700******************************************************************36680000
382800 8000-LINK-TO-DRS.                                                36690000
382900                                                                  36700000
383000*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        36710000
383100*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          36720000
383200*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              36730000
383300     EXEC CICS                                                    36740000
383400         LINK                                                     36750000
383500             PROGRAM   ('DRS1INTC')                               36760000
383600             COMMAREA  (DRS01-COMMAREA)                           36770000
383700     END-EXEC.                                                    36780000
383800                                                                  36790000
383900     EVALUATE TRUE                                                36800000
384000         WHEN DRS01-DRRB-RC = ZERO                                36810000
384100             CONTINUE                                             36820000
384200         WHEN OTHER                                               36830000
384300             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        36840000
384400             SET DP013-OTHER-ABEND      TO TRUE                   36850000
384500             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       36860000
384600             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        36870000
384700             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    36880000
384800             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         36890000
384900             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      36900000
385000             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       36910000
385100             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      36920000
385200             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      36930000
385300                 TO DP013-MESSAGE-TEXT (1)                        36940000
385400             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      36950000
385500                 TO DP013-MESSAGE-TEXT (2)                        36960000
385600             SET DP013-LINK-RETURN      TO TRUE                   36970000
385700             PERFORM DP013-0000-PROCESS-ABEND                     36980000
385800             GO TO 0000-GOBACK                                    36990000
385900     END-EVALUATE.                                                37000000
386000     EJECT                                                        37010000
386100 9200-GET-NEXT-PO.                                                37020000
386200                                                                  37030000
386300     SET LINE-IDX     UP BY 1.                                    37040000
386400     IF CA-LINE-NBR (LINE-IDX) = ZERO                             37050000
386500         SET PS-EOF-TABLE TO TRUE                                 37060000
386600     ELSE                                                         37070000
386700         MOVE CA-ORD-NBR          TO DK-ORD-NBR                   37080000
386800         MOVE CA-RCVR-SEQ-NBR     TO DK-RCVR-SEQ-NBR              37090000
386900         MOVE CA-LINE-NBR (LINE-IDX)                              37100000
387000                                  TO DK-ORD-LNE-NBR               37110000
387100                                     CA-ORD-LNE-NBR               37120000
387200                                     CA-WORK-ORD-SEQ-NBR          37130000
387300         MOVE CA-OPER-UNT-ID-N    TO DK-OPER-UNT-ID               37140000
387400         MOVE CA-FCLTY-ID-N       TO DK-FCLTY-ID                  37150000
387500                                                                  37160000
387600         MOVE CA-OPER-UNT-ID     TO  HL2-OPERATING-ID             37170000
387700         MOVE CA-FCLTY-ID        TO  HL2-FACILITY-ID              37180000
387800                                                                  37190000
387900         PERFORM 4050-SELECT-PRIM-SHIP                            37200000
388000                                                                  37210000
388100         MOVE CA-RCVR-SEQ-NBR-X  TO  HL6-RCVR-SEQ-NBR             37220000
388200         MOVE CA-ORD-LNE-NBR-X   TO  HL7-LINE-NBR                 37230000
388300         MOVE CA-WORK-ORD-SEQ-NBR-X                               37240000
388400                                 TO HL8-WORK-ORD-NBR              37250000
388500                                                                  37260000
388600         INITIALIZE RA-RTV-ALLOC-TABLE                            37270000
388700         MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                     37280000
388800                        PV-STORES-GIVEN-PIECES                    37290000
388900                        PV-TOT-RTV-EXPTED-ITM-CNT                 37300000
389000                        PV-STR-CNT                                37310000
389100                        PV-RTV-STORES                             37320000
389200         SET RA-ALLOC-IDX         TO 1                            37330000
389300     END-IF.                                                      37340000
389400                                                                  37350000
389500/                                                                 37360000
389600 9999-WRITE-CICS-LOG-MSG.                                         37370000
389700                                                                  37380000
389800     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              37390000
389900     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             37400000
390000                                                                  37410000
390100     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         37420000
390200                                                                  37430000
390300     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           37440000
390400     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             37450000
390500     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            37460000
390600     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            37470000
390700     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          37480000
390800                                                                  37490000
390900     MOVE PC-MARKING-APRON-RPT-HDR   TO  HL1-RPT-HDR              37500000
391000                                                                  37510000
391100     MOVE PC-CURRENT-PROGRAM-NAME    TO HL1-PROGRAM-NAME.         37520000
391200     MOVE 1                          TO  HL1-RPT-NBR              37530000
391300                                         HL1-PGE-NBR              37540000
391400                                         HL1-OF-PGE-NBR.          37550000
391500     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         37560000
391600     IF PS-TOP-OF-PAGE-SET                                        37570000
391700         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           37580000
391800     ELSE                                                         37590000
391900         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           37600000
392000     END-IF.                                                      37610000
392100     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          37620000
392200     PERFORM 8000-LINK-TO-DRS.                                    37630000
392300                                                                  37640000
392400     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         37650000
392500     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          37660000
392600     PERFORM 8000-LINK-TO-DRS.                                    37670000
392700                                                                  37680000
392800     MOVE CA-PREPAIRER-USER-ID       TO  HL3-PREPAIRER-USER-ID.   37690000
392900     MOVE CA-DESTINATION             TO  HL4-PRINTER-DEST.        37700000
393000     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         37710000
393100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37720000
393200     PERFORM 8000-LINK-TO-DRS.                                    37730000
393300                                                                  37740000
393400     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         37750000
393500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37760000
393600     PERFORM 8000-LINK-TO-DRS.                                    37770000
393700                                                                  37780000
393800     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         37790000
393900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37800000
394000     PERFORM 8000-LINK-TO-DRS.                                    37810000
394100                                                                  37820000
394200     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         37830000
394300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37840000
394400     PERFORM 8000-LINK-TO-DRS.                                    37850000
394500                                                                  37860000
394600     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         37870000
394700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37880000
394800     PERFORM 8000-LINK-TO-DRS.                                    37890000
394900                                                                  37900000
395000     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         37910000
395100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37920000
395200     PERFORM 8000-LINK-TO-DRS.                                    37930000
395300                                                                  37940000
395400     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         37950000
395500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          37960000
395600     PERFORM 8000-LINK-TO-DRS.                                    37970000
395700                                                                  37980000
395800     MOVE HL10-HEADING-LINE-10       TO  DRS01-COMM-DATA.         37990000
395900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          38000000
396000     PERFORM 8000-LINK-TO-DRS.                                    38010000
396100                                                                  38020000
396200     MOVE HL11-HEADING-LINE-11       TO  DRS01-COMM-DATA.         38030000
396300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          38040000
396400     PERFORM 8000-LINK-TO-DRS.                                    38050000
396500                                                                  38060000
396600     MOVE HL12-HEADING-LINE-12       TO  DRS01-COMM-DATA.         38070000
396700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          38080000
396800     PERFORM 8000-LINK-TO-DRS.                                    38090000
396900                                                                  38100000
397000     MOVE HL13-HEADING-LINE-13       TO  DRS01-COMM-DATA.         38110000
397100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          38120000
397200     PERFORM 8000-LINK-TO-DRS.                                    38130000
397300                                                                  38140000
397400     MOVE HL14-HEADING-LINE-14       TO  DRS01-COMM-DATA.         38150000
397500     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          38160000
397600     PERFORM 8000-LINK-TO-DRS.                                    38170000
397700                                                                  38180000
397800     MOVE DH1-DETAIL-HEADING-LINE-1  TO  DRS01-COMM-DATA.         38190000
397900     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          38200000
398000     PERFORM 8000-LINK-TO-DRS.                                    38210000
398100                                                                  38220000
398200     MOVE DH2-DETAIL-HEADING-LINE-2  TO  DRS01-COMM-DATA.         38230000
398300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          38240000
398400     PERFORM 8000-LINK-TO-DRS.                                    38250000
398500                                                                  38260000
398600     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           38270000
398700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38280000
398800     PERFORM 8000-LINK-TO-DRS.                                    38290000
398900                                                                  38300000
399000     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           38310000
399100     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38320000
399200     PERFORM 8000-LINK-TO-DRS.                                    38330000
399300     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           38340000
399400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38350000
399500     PERFORM 8000-LINK-TO-DRS.                                    38360000
399600     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           38370000
399700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38380000
399800     PERFORM 8000-LINK-TO-DRS.                                    38390000
399900     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           38400000
400000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38410000
400100     PERFORM 8000-LINK-TO-DRS.                                    38420000
400200     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           38430000
400300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38440000
400400     PERFORM 8000-LINK-TO-DRS.                                    38450000
400500     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           38460000
400600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38470000
400700     PERFORM 8000-LINK-TO-DRS.                                    38480000
400800     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           38490000
400900     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38500000
401000     PERFORM 8000-LINK-TO-DRS.                                    38510000
401100     MOVE SQLCODE TO PV-SQLCODE.                                  38520000
401200     MOVE PV-SQLCODE-NUMBER        TO  DRS01-COMM-DATA.           38530000
401300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            38540000
401400     PERFORM 8000-LINK-TO-DRS.                                    38550000
401500                                                                  38560000
401600     SET DP013-LINK-RETURN         TO TRUE.                       38570000
401700     PERFORM DP013-0000-PROCESS-ABEND.                            38580000
401800                                                                  38590000
401900     COPY DPPD013.                                                38600000
402000/                                                                 38610000
