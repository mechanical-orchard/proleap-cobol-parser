000100*************************                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*************************                                         00030099
000400 PROGRAM-ID.      TRKUT020.                                       00040099
000500 AUTHOR.          VISWA KARUTURI.                                 00050099
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060099
000700 DATE-WRITTEN.    02/03/03.                                       00070099
000800 DATE-COMPILED.                                                   00080099
000900****************************************************************  00090099
001000*                 DECONSOLIDATOR SPLIT PROGRAM.                *  00100099
001100*                                                              *  00110099
001200* IT READS THE FILE THAT OUTPUT FROM PREP PROGRAM (TRKUT015)   *  00120099
001300* AND SPLIT THE RECORDS (IMPORT DC SPLIT INFORMATION TO THE    *  00130099
001400* DECONSOLIDATOR) BY DECONSOLIDATOR ENT-ID AND WRITES TO       *  00140099
001500* SEPERATE FILES.                                              *  00150099
001600* THE INVALID RECORDS (ENT-IDS NOT IN DECONSOLIDATOR ENT-ID    *  00160099
001600* LIST) WRITES TO EXCEPTION FILE AND THE RECORD STATISTICS     *  00161099
001700* WRITES TO REPORT.                                            *  00162099
001800****************************************************************  00163099
001900 ENVIRONMENT DIVISION.                                            00164099
002000 CONFIGURATION SECTION.                                           00165099
002100 SOURCE-COMPUTER. IBM-3090.                                       00166099
002200 OBJECT-COMPUTER. IBM-3090.                                       00167099
002300 INPUT-OUTPUT SECTION.                                            00168099
002400                                                                  00169099
002500 FILE-CONTROL.                                                    00170099
002600     SELECT INPUT-FILE1                                           00180099
002700         ASSIGN                       TO INP01.                   00190099
002600     SELECT INPUT-FILE2                                           00200099
002700         ASSIGN                       TO INP02.                   00210099
002600     SELECT INPUT-FILE3                                           00220099
002700         ASSIGN                       TO INP03.                   00230099
002600     SELECT INPUT-FILE4                                           00240099
002700         ASSIGN                       TO INP04.                   00250099
002600     SELECT INPUT-FILE5                                           00260099
002700         ASSIGN                       TO INP05.                   00270099
003500     SELECT INPUT-ENT-FILE                                        00271099
003600         ASSIGN                       TO INP06.                   00272099
003500     SELECT DEFAULT-ENTID-FILE                                    00272199
003600         ASSIGN                       TO INP07.                   00272299
002800     SELECT REPORT-FILE                                           00272399
002900         ASSIGN                       TO RPT01.                   00272499
003200     SELECT OUTPUT-FILE1                                          00272599
003300         ASSIGN                       TO OUT01.                   00272699
003400     SELECT OUTPUT-FILE2                                          00272799
003500         ASSIGN                       TO OUT02.                   00272899
003400     SELECT OUTPUT-FILE3                                          00272999
003500         ASSIGN                       TO OUT03.                   00273099
003400     SELECT OUTPUT-FILE4                                          00274099
003500         ASSIGN                       TO OUT04.                   00275099
003400     SELECT OUTPUT-FILE5                                          00276099
003500         ASSIGN                       TO OUT05.                   00277099
003000     SELECT DECONSOL-EXCP-FILE                                    00278099
003100         ASSIGN                       TO OUT06.                   00279099
003600*                                                                 00280099
003700***************                                                   00290099
003800 DATA DIVISION.                                                   00300099
003900***************                                                   00310099
004000*                                                                 00320099
004100 FILE SECTION.                                                    00330099
004200                                                                  00340099
004300 FD  INPUT-FILE1                                                  00350099
004400     RECORDING MODE IS F                                          00360099
004500     LABEL RECORDS ARE STANDARD                                   00370099
004600     RECORD CONTAINS 254 CHARACTERS                               00380099
004700     BLOCK CONTAINS 0 RECORDS.                                    00390099
004800 01  INPUT-RECORD1                    PIC  X(254).                00400099
                                                                        00410099
004300 FD  INPUT-FILE2                                                  00420099
004400     RECORDING MODE IS F                                          00430099
004500     LABEL RECORDS ARE STANDARD                                   00440099
004600     RECORD CONTAINS 254 CHARACTERS                               00450099
004700     BLOCK CONTAINS 0 RECORDS.                                    00460099
004800 01  INPUT-RECORD2                    PIC  X(254).                00470099
                                                                        00480099
004300 FD  INPUT-FILE3                                                  00481099
004400     RECORDING MODE IS F                                          00482099
004500     LABEL RECORDS ARE STANDARD                                   00483099
004600     RECORD CONTAINS 254 CHARACTERS                               00484099
004700     BLOCK CONTAINS 0 RECORDS.                                    00485099
004800 01  INPUT-RECORD3                    PIC  X(254).                00486099
                                                                        00487099
004300 FD  INPUT-FILE4                                                  00488099
004400     RECORDING MODE IS F                                          00489099
004500     LABEL RECORDS ARE STANDARD                                   00489199
004600     RECORD CONTAINS 254 CHARACTERS                               00489299
004700     BLOCK CONTAINS 0 RECORDS.                                    00489399
004800 01  INPUT-RECORD4                    PIC  X(254).                00489499
                                                                        00489599
004300 FD  INPUT-FILE5                                                  00489699
004400     RECORDING MODE IS F                                          00489799
004500     LABEL RECORDS ARE STANDARD                                   00489899
004600     RECORD CONTAINS 254 CHARACTERS                               00489999
004700     BLOCK CONTAINS 0 RECORDS.                                    00490099
004800 01  INPUT-RECORD5                    PIC  X(254).                00490199
                                                                        00490299
004300 FD  INPUT-ENT-FILE                                               00490399
004400     RECORDING MODE IS F                                          00490499
004500     LABEL RECORDS ARE STANDARD                                   00490599
004600     RECORD CONTAINS 80 CHARACTERS                                00490699
004700     BLOCK CONTAINS 0 RECORDS.                                    00490799
004800 01  INPUT-RECORD6                    PIC  X(80).                 00490899
                                                                        00490999
004300 FD  DEFAULT-ENTID-FILE                                           00491099
004400     RECORDING MODE IS F                                          00491199
004500     LABEL RECORDS ARE STANDARD                                   00491299
004600     RECORD CONTAINS 132 CHARACTERS                               00491399
004700     BLOCK CONTAINS 0 RECORDS.                                    00491499
004800 01  DEFAULT-ENTID-RECORD             PIC  X(132).                00491599
004900                                                                  00491699
005000 FD  REPORT-FILE                                                  00491799
005100     RECORDING MODE F                                             00491899
005200     BLOCK CONTAINS 0 RECORDS                                     00491999
005300     RECORD CONTAINS 132 CHARACTERS                               00492099
005400     LABEL RECORDS ARE OMITTED                                    00493099
005500     DATA RECORD IS PRINT-LINE.                                   00494099
005600 01  PRINT-LINE                          PIC X(132).              00495099
005700                                                                  00496099
005800 FD  DECONSOL-EXCP-FILE                                           00497099
005900     RECORDING MODE F                                             00498099
006000     BLOCK CONTAINS 0 RECORDS                                     00499099
006100     RECORD CONTAINS 254 CHARACTERS                               00500099
006200     LABEL RECORDS ARE STANDARD                                   00510099
006300     DATA RECORD IS DECONSOL-EXCP-LINE.                           00520099
006400    01 DECONSOL-EXCP-LINE                PIC X(254).              00530099
006500                                                                  00540099
006600 FD  OUTPUT-FILE1                                                 00550099
006700     RECORDING MODE F                                             00560099
006800     BLOCK CONTAINS 0 RECORDS                                     00570099
006900     RECORD CONTAINS 254 CHARACTERS                               00580099
007000     LABEL RECORDS ARE STANDARD                                   00590099
007100     DATA RECORD IS OUTPUT-RECORD1.                               00600099
007200    01 OUTPUT-RECORD1                    PIC X(254).              00610099
007300                                                                  00620099
007400 FD  OUTPUT-FILE2                                                 00630099
007500     RECORDING MODE F                                             00640099
007600     BLOCK CONTAINS 0 RECORDS                                     00650099
007700     RECORD CONTAINS 254 CHARACTERS                               00660099
007800     LABEL RECORDS ARE STANDARD                                   00670099
007900     DATA RECORD IS OUTPUT-RECORD2.                               00680099
008000    01 OUTPUT-RECORD2                      PIC X(254).            00690099
007300                                                                  00700099
007400 FD  OUTPUT-FILE3                                                 00710099
007500     RECORDING MODE F                                             00720099
007600     BLOCK CONTAINS 0 RECORDS                                     00730099
007700     RECORD CONTAINS 254 CHARACTERS                               00740099
007800     LABEL RECORDS ARE STANDARD                                   00750099
007900     DATA RECORD IS OUTPUT-RECORD3.                               00760099
008000    01 OUTPUT-RECORD3                      PIC X(254).            00770099
                                                                        00780099
007400 FD  OUTPUT-FILE4                                                 00790099
007500     RECORDING MODE F                                             00800099
007600     BLOCK CONTAINS 0 RECORDS                                     00801099
007700     RECORD CONTAINS 254 CHARACTERS                               00802099
007800     LABEL RECORDS ARE STANDARD                                   00803099
007900     DATA RECORD IS OUTPUT-RECORD4.                               00804099
008000    01 OUTPUT-RECORD4                      PIC X(254).            00805099
                                                                        00806099
007400 FD  OUTPUT-FILE5                                                 00807099
007500     RECORDING MODE F                                             00808099
007600     BLOCK CONTAINS 0 RECORDS                                     00809099
007700     RECORD CONTAINS 254 CHARACTERS                               00810099
007800     LABEL RECORDS ARE STANDARD                                   00810199
007900     DATA RECORD IS OUTPUT-RECORD5.                               00810299
008000    01 OUTPUT-RECORD5                      PIC X(254).            00810399
008100                                                                  00810499
008200*                                                                 00810599
008300 WORKING-STORAGE SECTION.                                         00810699
008400*                                                                 00810799
008500****************************************************************  00810899
008600** STANDARD HEADER LINE - KOHLS 132 COL                        *  00810999
008700****************************************************************  00811099
008800     COPY DPWS132O.                                               00812099
008500                                                                  00813099
010700******************************************************************00814099
010800*    ENTITY ID'S TABLE COPYBOOK LAYOUT                            00815099
010900******************************************************************00816099
011000     COPY TRRD030.                                                00817099
011100 EJECT                                                            00818099
                                                                        00819099
009000*************************************************                 00820099
009100* PROGRAM VARIABLES                                               00830099
009200*************************************************                 00840099
009300 01 PV-PROGRAM-VARIABLES.                                         00850099
009400    05 PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACES.      00860099
009500*RJ IF NEW VENDORS ARE ADDED, ADD AN 88 LEVEL HERE.               00870099
009600    05 PV-FILE-NO                   PIC 9(01) VALUE ZERO.         00880099
          05 PV-FILE1-ENTNAME             PIC X(10) VALUE SPACES.       00890099
          05 PV-FILE2-ENTNAME             PIC X(10) VALUE SPACES.       00900099
          05 PV-FILE3-ENTNAME             PIC X(10) VALUE SPACES.       00910099
          05 PV-FILE4-ENTNAME             PIC X(10) VALUE SPACES.       00920099
          05 PV-FILE5-ENTNAME             PIC X(10) VALUE SPACES.       00930099
010200    05 PV-PRT-TTL-READ.                                           00940099
010300      10                            PIC X(54) VALUE               00950099
010400         'TOTAL RECORDS READ:                                   '.00960099
010500      10 PV-EXTRACTS-READ-M           PIC Z,ZZZ,ZZ9.              00970099
010600    05 PV-PRT-TTL-WRITTEN.                                        00980099
010700      10                            PIC X(54) VALUE               00990099
010800         'TOTAL RECORDS WRITTEN:                                '.01000099
010900      10 PV-TOT-RECS-WRITTEN-M        PIC Z,ZZZ,ZZ9.              01010099
011000    05 PV-PRT-TTL-R.                                              01020099
011100      10 FILLER                     PIC X(06) VALUE               01030099
011200         'TOTAL '.                                                01040099
011100      10 PV-RPT-ENTNAME-READ        PIC X(10) VALUE               01050099
011200         SPACES.                                                  01060099
011100      10 FILLER                     PIC X(14) VALUE               01070099
011200         ' RECORDS READ:'.                                        01080099
011100      10 FILLER                     PIC X(24) VALUE SPACES.       01090099
011300      10 PV-READ-COUNT              PIC Z,ZZZ,ZZ9.                01100099
011400    05 PV-PRT-TTL-W.                                              01110099
011500      10 FILLER                     PIC X(06) VALUE               01120099
011600         'TOTAL '.                                                01130099
011100      10 PV-RPT-ENTNAME-WRITTEN     PIC X(10) VALUE               01140099
011200         SPACES.                                                  01150099
011100      10 FILLER                     PIC X(17) VALUE               01160099
011200         ' RECORDS WRITTEN:'.                                     01161099
011100      10 FILLER                     PIC X(21) VALUE SPACES.       01162099
011700      10 PV-WRITTEN-COUNT           PIC Z,ZZZ,ZZ9.                01163099
011000    05 PV-PRT-TTL-R1.                                             01164099
011100      10 FILLER                     PIC X(10) VALUE               01165099
011200         '*** TOTAL '.                                            01166099
011100      10 PV-RPT-ENTNAME-READ1       PIC X(10) VALUE               01167099
011200         SPACES.                                                  01168099
011100      10 FILLER                     PIC X(14) VALUE               01169099
011200         ' RECORDS READ:'.                                        01170099
011100      10 FILLER                     PIC X(17) VALUE SPACES.       01180099
011300      10 PV-READ-COUNT1             PIC Z,ZZZ,ZZ9.                01190099
011400    05 PV-PRT-TTL-W1.                                             01200099
011500      10 FILLER                     PIC X(10) VALUE               01210099
011600         '*** TOTAL '.                                            01220099
011100      10 PV-RPT-ENTNAME-WRITTEN1    PIC X(10) VALUE               01230099
011200         SPACES.                                                  01240099
011100      10 FILLER                     PIC X(17) VALUE               01250099
011200         ' RECORDS WRITTEN:'.                                     01251099
011100      10 FILLER                     PIC X(14) VALUE SPACES.       01252099
011700      10 PV-WRITTEN-COUNT1          PIC Z,ZZZ,ZZ9.                01253099
012600    05 PV-EXCEPT-LINE-W.                                          01254099
012700      10 FILLER                     PIC X(54) VALUE               01255099
012800         'TOTAL EXCEPTION RECORDS WRITTEN:                      '.01256099
012900      10 PV-EXCEPTION-WRITTEN-M     PIC Z,ZZZ,ZZ9.                01257099
013000    05 PV-TOT-LOGICAL-REC-BAD-M     PIC Z,ZZZ,ZZ9.                01258099
013100    05 PV-INVALID-ENT-ID-LINE.                                    01259099
013200      10 FILLER                     PIC X(54) VALUE               01260099
013300         'TOTAL RECORDS WITH AN INVALID ENTITY ID:             '. 01270099
013400      10 PV-INVALID-ENT-ID-ON-ISA-M     PIC Z,ZZZ,ZZ9.            01280099
010600     05  PV-ENT-NAME                    PIC X(30) VALUE SPACES.   01290099
015600     05  PV-READ-IND                    PIC  9(2) VALUE ZERO.     01300099
015600     05  PV-OPEN-INPUT-FILE-COUNTER     PIC  9(2) VALUE ZERO.     01310099
015600     05  PV-HOLD-NUMBER-OF-INPUT-FILES  PIC  9(2) VALUE ZERO.     01320099
015600     05  PV-DEFAULT-FILE-NO             PIC  9(1) VALUE ZERO.     01330099
015600     05  PV-DEFAULT-VENDOR-TRI          PIC  9(9) VALUE ZERO.     01340099
009400     05  PV-ABEND-CODE                  PIC  S9(04) VALUE +0      01341099
009500                                               COMP SYNC.         01342099
371116     05 PV-DEFAULT-ENTID-RECORD         PIC  X(132) VALUE SPACES. 01342199
013500                                                                  01343099
013600 01  PV-COUNTERS COMP-3.                                          01344099
010600     05  PV-OPEN-OUTPUT-FILE-COUNTER    PIC S9(5) VALUE ZERO.     01345099
010900     05  PV-HOLD-NUMBER-OF-OUTPUT-FILES PIC S9(5) VALUE ZEROS.    01346099
010900     05  PV-SAVE-NUMBER-OF-OUTPUT-FILES PIC S9(5) VALUE ZEROS.    01347099
013700     05  PV-EXCP-COUNTER                PIC S9(7) VALUE ZERO.     01348099
013900     05  PV-TOT-RECS-WRITTEN            PIC S9(7) VALUE ZERO.     01349099
014000     05  PV-TOT-LOGICAL-BAD             PIC S9(7) VALUE ZERO.     01350099
014100     05  PV-TOT-LOGICAL-REC-BAD         PIC S9(7) VALUE ZERO.     01360099
014200     05  PV-INVALID-ENT-ID-ON-ISA       PIC S9(7) VALUE ZERO.     01370099
014300     05  PV-MIS-MATCHING-CTT-COUNT      PIC S9(7) VALUE ZERO.     01380099
014400     05  PV-MISSING-CTT-RECS            PIC S9(7) VALUE ZERO.     01390099
014500     05  PV-READ-FILE1                  PIC S9(7) VALUE ZERO.     01400099
014600     05  PV-WRITTEN-FILE1               PIC S9(7) VALUE ZERO.     01410099
014700     05  PV-READ-FILE2                  PIC S9(7) VALUE ZERO.     01420099
014800     05  PV-WRITTEN-FILE2               PIC S9(7) VALUE ZERO.     01430099
           05  PV-READ-FILE3                  PIC S9(7) VALUE ZERO.     01440099
           05  PV-EXTRACTS-READ               PIC S9(7) VALUE ZERO.     01450099
           05  PV-WRITTEN-FILE3               PIC S9(7) VALUE ZERO.     01460099
           05  PV-READ-FILE4                  PIC S9(7) VALUE ZERO.     01470099
           05  PV-WRITTEN-FILE4               PIC S9(7) VALUE ZERO.     01480099
           05  PV-READ-FILE5                  PIC S9(7) VALUE ZERO.     01481099
           05  PV-WRITTEN-FILE5               PIC S9(7) VALUE ZERO.     01482099
014900     05  PV-EXCEPTION-WRITTEN           PIC S9(7) VALUE ZERO.     01483099
015000     05  PV-DATA-RECS-PER-LOGICAL-FILE  PIC  9(5) VALUE ZERO.     01484099
015100     05  PV-LOGICAL-PROCESSED           PIC S9(7) VALUE ZERO.     01485099
015200     05  PV-LOGICAL-PROCESSED-TR        PIC S9(7) VALUE ZERO.     01486099
015300     05  PV-LOGICAL-PROCESSED-HU        PIC S9(7) VALUE ZERO.     01487099
015400     05  PV-LINE-CNT                    PIC S9(5) VALUE ZERO.     01488099
015500     05  PV-PAGE-CNT                    PIC S9(5) VALUE ZERO.     01489099
015600     05  PV-RETRY-COUNTER               PIC S9(4) VALUE ZERO.     01490099
015700                                                                  01500099
015800     COPY TRRD004.                                                01510099
015900                                                                  01520099
011700 01 WS-DECONSOL-NO-TABLE.                                         01530099
011800    05 WS-DECONSOL-NO-TABLE-ENTRIES OCCURS 20 TIMES               01540099
011900                                 INDEXED BY DECNO-IND.            01550099
012000       10 WS-DECNO-FILE-NO        PIC 9(01).                      01560099
012100       10 WS-DECNO-ENT-ID         PIC 9(09).                      01570099
012200       10 WS-DECNO-DEFAULT-ENT-ID PIC X(01).                      01580099
012200       10 WS-DECNO-ENT-NAME       PIC X(30).                      01590099
                                                                        01600099
016000 01 PV-DECONSOL-RECORD.                                           01601099
016100    05 PV-DECONSOL-REC-TYPE         PIC X(03).                    01602099
016200       88 PV-DECONSOL-REC-ISA                 VALUE 'ISA'.        01603099
016300    05 PV-DECONSOL-ENT-ID           PIC 9(09).                    01604099
016400    05 FILLER                       PIC X(242).                   01605099
016500                                                                  01606099
       01  PV-REPORT1-NAME                PIC X(40) VALUE               01607099
016900         'DECONSOLIDATOR TRANSMISSION SPLIT REPORT'.              01608099
                                                                        01609099
       01  PV-REPORT2-NAME                PIC X(42) VALUE               01610099
016900         'DECONSOLIDATOR RETRANSMISSION SPLIT REPORT'.            01620099
                                                                        01630099
016600 01 HEAD-LINE1.                                                   01640099
016700      10  FILLER                    PIC X(44) VALUE SPACES.       01650099
016800      10  HEAD-LINE1-REPORT-NAME    PIC X(42) VALUE SPACES.       01660099
017100 01 HEAD-LINE2.                                                   01670099
017200      10                            PIC X(54) VALUE               01680099
017300         '*** THERE WERE EXCEPTION FILES OR RECORDS FOR THIS RUN'.01690099
017400      10                            PIC X(27) VALUE               01700099
017500         '.  CONTACT PROGRAMMING. ***'.                           01710099
017600                                                                  01720099
017700 01 HEAD-LINE3.                                                   01730099
017800      10                            PIC X(52) VALUE               01740099
017900         'STATISTICS (TOTALS EXCLUDE CONTROL AND CTT RECORDS)'.   01750099
018000                                                                  01760099
018100 01 HEAD-LINE4.                                                   01770099
018200      10                            PIC X(52) VALUE               01780099
018300         '----------------------------------------------------'.  01790099
018400                                                                  01800099
018500 01 HEAD-LINE5.                                                   01810099
018600      10                            PIC X(55) VALUE               01820099
018700        'THERE WERE NOT EXCEPTION FILES OR RECORDS FOR THIS RUN.'.01830099
018800                                                                  01840099
018900 01 PC-PROGRAM-CONSTANTS.                                         01850099
019000    05  PC-MAX-RETRIES              PIC 9(03) VALUE 3.            01860099
004400    05  PC-PRIMARY                  PIC XX    VALUE '01'.         01870099
019100                                                                  01880099
019200 01  PS-PROGRAM-SWITCHES.                                         01890099
019300     05  PS-END-OF-INPUT-FILE-SW         PIC X(01) VALUE 'N'.     01900099
019400         88  PS-END-OF-INPUT-FILE                  VALUE 'Y'.     01910099
019500         88  PS-END-OF-INPUT-FILE-NO               VALUE 'N'.     01920099
019300     05  PS-END-OF-INPUT-ENT-FILE-SW     PIC X(01) VALUE 'N'.     01930099
019400         88  PS-END-OF-INPUT-ENT-FILE              VALUE 'Y'.     01940099
019500         88  PS-END-OF-INPUT-ENT-FILE-NO           VALUE 'N'.     01950099
014400     05  PS-END-OF-SEARCH-SW        PIC X(01) VALUE 'N'.          01951099
014500         88  PS-END-OF-SEARCH                 VALUE 'Y'.          01952099
014600         88  PS-NOT-END-OF-SEARCH             VALUE 'N'.          01953099
014400     05  PS-REPORT-NUMBER-SW        PIC X(01) VALUE 'N'.          01954099
014500         88  PS-REPORT-NUMBER                 VALUE 'Y'.          01955099
014600         88  PS-REPORT-NUMBER-NO              VALUE 'N'.          01956099
019300     05  PS-END-OF-DEF-ENTID-FILE-SW PIC X(01)  VALUE 'N'.        01956199
019400         88  PS-END-OF-DEF-ENTID-FILE           VALUE 'Y'.        01956299
019500         88  PS-END-OF-DEF-ENTID-FILE-NO        VALUE 'N'.        01956399
019600                                                                  01957099
019700* SYSTEM TIME                                                     01958099
019800 01  SD-SYSTEM-TIME.                                              01959099
019900     05  SD-SYS-HR                  PIC 9(2).                     01960099
020000     05  SD-SYS-MIN                 PIC 9(2).                     01970099
020100                                                                  01980099
020200* SYTEM DATE                                                      01990099
020300 01  SD-SYSTEM-DATE.                                              02000099
020400     05  SD-SYSTEM-YEAR             PIC  9(02).                   02010099
020500     05  SD-SYSTEM-MONTH            PIC  9(02).                   02020099
020600     05  SD-SYSTEM-DAY              PIC  9(02).                   02030099
                                                                        02040099
020800****************************************************************  02050099
020900 PROCEDURE DIVISION.                                              02060099
021000****************************************************************  02070099
021100 0000-PROGRAM-MAINLINE.                                           02080099
021200                                                                  02090099
021300     PERFORM 1000-INITIALIZATION.                                 02100099
           MOVE 1 TO PV-READ-IND                                        02110099
021400     PERFORM 2500-READ-INPUT-FILE.                                02120099
021500     PERFORM 2000-PROCESS-FILE                                    02130099
021600         UNTIL PS-END-OF-INPUT-FILE.                              02140099
                                                                        02150099
           MOVE 2 TO PV-READ-IND                                        02160099
                     PV-OPEN-INPUT-FILE-COUNTER                         02161099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02161199
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02161299
               CONTINUE                                                 02161399
           ELSE                                                         02161499
              SET PS-END-OF-INPUT-FILE-NO TO TRUE                       02161599
021400        PERFORM 2500-READ-INPUT-FILE                              02161699
021500        PERFORM 2000-PROCESS-FILE                                 02161799
021600          UNTIL PS-END-OF-INPUT-FILE                              02161899
           END-IF                                                       02161999
                                                                        02162099
           MOVE 3 TO PV-READ-IND                                        02162199
                     PV-OPEN-INPUT-FILE-COUNTER                         02162299
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02162399
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02162499
               CONTINUE                                                 02162599
           ELSE                                                         02162699
              SET PS-END-OF-INPUT-FILE-NO TO TRUE                       02162799
021400        PERFORM 2500-READ-INPUT-FILE                              02162899
021500        PERFORM 2000-PROCESS-FILE                                 02162999
021600          UNTIL PS-END-OF-INPUT-FILE                              02163099
           END-IF                                                       02164099
                                                                        02165099
           MOVE 4 TO PV-READ-IND                                        02165199
                     PV-OPEN-INPUT-FILE-COUNTER                         02165299
           MOVE PV-SAVE-NUMBER-OF-OUTPUT-FILES                          02165399
           TO   PV-HOLD-NUMBER-OF-OUTPUT-FILES                          02165499
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02165599
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02165699
               CONTINUE                                                 02165799
           ELSE                                                         02165899
              SET PS-END-OF-INPUT-FILE-NO TO TRUE                       02165999
021400        PERFORM 2500-READ-INPUT-FILE                              02166099
021500        PERFORM 2000-PROCESS-FILE                                 02166199
021600          UNTIL PS-END-OF-INPUT-FILE                              02166299
           END-IF                                                       02166399
                                                                        02166499
           MOVE 5 TO PV-READ-IND                                        02166599
                     PV-OPEN-INPUT-FILE-COUNTER                         02166699
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02166799
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02166899
               CONTINUE                                                 02166999
           ELSE                                                         02167099
              SET PS-END-OF-INPUT-FILE-NO TO TRUE                       02167199
021400        PERFORM 2500-READ-INPUT-FILE                              02167299
021500        PERFORM 2000-PROCESS-FILE                                 02167399
021600          UNTIL PS-END-OF-INPUT-FILE                              02167499
           END-IF                                                       02167599
                                                                        02167699
021700     PERFORM 2800-WRITE-CTT-RECORDS.                              02167799
021800     PERFORM 3000-DISPLAY-COUNTS.                                 02167899
021900     PERFORM 4000-PRINT-REPORT.                                   02167999
022000     PERFORM 8000-CLOSE-FILES.                                    02168099
022100                                                                  02169099
022200     STOP RUN.                                                    02170099
022300                                                                  02180099
022400****************************************************************  02190099
022500* 1000-INITIALIZATION OPENS ALL FILES AND INITAILZES ALL OF    *  02200099
022600* THE NECESSARY FIELDS.                                        *  02210099
022700****************************************************************  02220099
022800 1000-INITIALIZATION.                                             02230099
022900                                                                  02240099
023000     OPEN OUTPUT REPORT-FILE                                      02250099
023300                 DECONSOL-EXCP-FILE                               02260099
023400           INPUT INPUT-ENT-FILE                                   02270099
                       DEFAULT-ENTID-FILE.                              02271099
023500                                                                  02272099
023600     INITIALIZE PRINT-LINE                                        02273099
                      WS-DECONSOL-NO-TABLE.                             02274099
023700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             02275099
023800     ACCEPT SD-SYSTEM-TIME FROM TIME.                             02276099
023900     MOVE SD-SYSTEM-MONTH         TO DP132O-RUN-MONTH.            02277099
024000     MOVE SD-SYSTEM-DAY           TO DP132O-RUN-DAY.              02278099
024100     MOVE SD-SYSTEM-YEAR          TO DP132O-RUN-YEAR.             02279099
024200     MOVE SD-SYS-HR               TO DP132O-RUN-HOUR.             02280099
024300     MOVE SD-SYS-MIN              TO DP132O-RUN-MINUTE.           02290099
024400     MOVE 'TRKUT020'              TO DP132O-PROGRAM-NAME.         02300099
024500                                                                  02310099
           PERFORM 1020-READ-INPUT-ENT-FILE                             02320099
           SET DECNO-IND TO 1                                           02330099
           PERFORM 1010-BUILD-ENT-TABLE                                 02340099
             UNTIL PS-END-OF-INPUT-ENT-FILE.                            02350099
                                                                        02360099
           OPEN INPUT INPUT-FILE1                                       02370099
           MOVE 2 TO PV-OPEN-INPUT-FILE-COUNTER                         02380099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02390099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02400099
               CONTINUE                                                 02410099
           ELSE                                                         02420099
              OPEN INPUT INPUT-FILE2                                    02430099
           END-IF.                                                      02440099
           MOVE 3 TO PV-OPEN-INPUT-FILE-COUNTER                         02450099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02451099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02452099
               CONTINUE                                                 02453099
           ELSE                                                         02454099
              OPEN INPUT INPUT-FILE3                                    02455099
           END-IF.                                                      02456099
           MOVE 4 TO PV-OPEN-INPUT-FILE-COUNTER                         02457099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02458099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02459099
               CONTINUE                                                 02459199
           ELSE                                                         02459299
              OPEN INPUT INPUT-FILE4                                    02459399
           END-IF.                                                      02459499
           MOVE 5 TO PV-OPEN-INPUT-FILE-COUNTER                         02459599
           IF PV-OPEN-INPUT-FILE-COUNTER >                              02459699
              PV-HOLD-NUMBER-OF-INPUT-FILES                             02459799
               CONTINUE                                                 02459899
           ELSE                                                         02459999
              OPEN INPUT INPUT-FILE5                                    02460099
           END-IF.                                                      02460199
                                                                        02460299
           OPEN OUTPUT OUTPUT-FILE1                                     02460399
           MOVE 2 TO PV-OPEN-OUTPUT-FILE-COUNTER                        02460499
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             02460599
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            02460699
               CONTINUE                                                 02460799
           ELSE                                                         02460899
              OPEN OUTPUT OUTPUT-FILE2                                  02460999
           END-IF.                                                      02461099
           MOVE 3 TO PV-OPEN-OUTPUT-FILE-COUNTER                        02461199
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             02461299
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            02461399
               CONTINUE                                                 02461499
           ELSE                                                         02461599
              OPEN OUTPUT OUTPUT-FILE3                                  02461699
           END-IF.                                                      02461799
           MOVE 4 TO PV-OPEN-OUTPUT-FILE-COUNTER                        02461899
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             02461999
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            02462099
               CONTINUE                                                 02462199
           ELSE                                                         02462299
              OPEN OUTPUT OUTPUT-FILE4                                  02462399
           END-IF.                                                      02462499
           MOVE 5 TO PV-OPEN-OUTPUT-FILE-COUNTER                        02462599
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             02462699
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            02462799
               CONTINUE                                                 02462899
           ELSE                                                         02462999
              OPEN OUTPUT OUTPUT-FILE5                                  02463099
           END-IF.                                                      02464099
016400****************************************************************  02464199
016500* 1010-BUILD-ENT-TABLE - BUILD ENTITY TABLE FROM INPUT-ENT-FILE*  02464299
016700****************************************************************  02464399
       1010-BUILD-ENT-TABLE.                                            02464499
012400     IF TR030-ENT-FILE-NO NUMERIC AND                             02464599
012400         (TR030-ENT-FILE-NO > 0 AND < 6)                          02464699
                   MOVE TR030-ENT-FILE-NO                               02464799
                   TO WS-DECNO-FILE-NO (DECNO-IND)                      02464899
                      PV-HOLD-NUMBER-OF-OUTPUT-FILES                    02464999
                      PV-HOLD-NUMBER-OF-INPUT-FILES                     02465099
               ELSE                                                     02465199
                   DISPLAY '** INVALID DECONSOLIDATOR NUMBER = '        02465299
                   TR030-ENT-FILE-NO                                    02465399
           END-IF.                                                      02465499
                                                                        02465599
           IF TR030-ENT-ID NUMERIC                                      02465699
               MOVE TR030-ENT-ID                                        02465799
               TO   WS-DECNO-ENT-ID (DECNO-IND)                         02465899
           ELSE                                                         02465999
               DISPLAY '** INVALID ENTITY ID '                          02466099
               TR030-DCONSLR-ENT-TBL-REC                                02466199
           END-IF.                                                      02466299
                                                                        02466399
           IF TR030-ENT-DEFAULT-IND = ('N' OR 'Y')                      02466499
               MOVE TR030-ENT-DEFAULT-IND                               02466599
               TO   WS-DECNO-DEFAULT-ENT-ID (DECNO-IND)                 02466699
           ELSE                                                         02466799
               DISPLAY '** INVALID DEFAULD ENTITY IND '                 02466899
               TR030-DCONSLR-ENT-TBL-REC                                02466999
           END-IF.                                                      02467099
                                                                        02467199
           IF TR030-ENT-DEFAULT-IND = 'Y'                               02467299
               MOVE TR030-ENT-ID         TO PV-DEFAULT-VENDOR-TRI       02467399
012400         MOVE TR030-ENT-FILE-NO TO PV-DEFAULT-FILE-NO             02467499
           END-IF.                                                      02467599
                                                                        02467699
012700     MOVE TR030-ENT-DCONSLR-NAME TO WS-DECNO-ENT-NAME(DECNO-IND). 02467799
                                                                        02467899
           PERFORM 1020-READ-INPUT-ENT-FILE                             02467999
           SET DECNO-IND UP BY 1.                                       02468099
                                                                        02468199
016400****************************************************************  02468299
016500* 1020-READ-INPUT-ENT-FILE                                     *  02468399
016700****************************************************************  02468499
       1020-READ-INPUT-ENT-FILE.                                        02468599
           READ INPUT-ENT-FILE INTO TR030-DCONSLR-ENT-TBL-REC           02468699
             AT END                                                     02468799
              SET PS-END-OF-INPUT-ENT-FILE TO TRUE.                     02468899
                                                                        02468999
024600****************************************************************  02469099
024700* DETERMINE DECONSOLIDATOR (TRIANGLE, HUDD ETC) WRITE TO       *  02469199
024800* CORRESPONDING FILE.                                          *  02469299
024900****************************************************************  02469399
025000 2000-PROCESS-FILE.                                               02469499
025100                                                                  02469599
025200     IF PV-DECONSOL-REC-ISA                                       02469699
               PERFORM 4070-SEARCH-ENT-ID-TBL                           02469799
025400         EVALUATE TRUE                                            02469899
025500             WHEN PV-FILE-NO = 1                                  02469999
025600                  PERFORM 2110-WRITE-FILE1                        02470099
025700             WHEN PV-FILE-NO = 2                                  02480099
025800                  PERFORM 2120-WRITE-FILE2                        02490099
025700             WHEN PV-FILE-NO = 3                                  02500099
025800                  PERFORM 2130-WRITE-FILE3                        02510099
025700             WHEN PV-FILE-NO = 4                                  02520099
025800                  PERFORM 2140-WRITE-FILE4                        02530099
025700             WHEN PV-FILE-NO = 5                                  02540099
025800                  PERFORM 2150-WRITE-FILE5                        02541099
025900             WHEN OTHER                                           02542099
026000                  PERFORM 2400-WRITE-EXCEPTION-REC                02543099
026100         END-EVALUATE                                             02544099
026200     ELSE                                                         02545099
026300         PERFORM 2400-WRITE-EXCEPTION-REC                         02545199
026400     END-IF.                                                      02545299
026500                                                                  02545399
026600 2110-WRITE-FILE1.                                                02545499
026700                                                                  02545599
           MOVE PV-ENT-NAME TO PV-FILE1-ENTNAME                         02545699
026800     PERFORM 2500-READ-INPUT-FILE.                                02545799
026900     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02545899
027000                   PS-END-OF-INPUT-FILE                           02545999
027100          ADD 1             TO PV-READ-FILE1                      02546099
027200          ADD 1             TO PV-EXTRACTS-READ                   02547099
027300          ADD 1             TO PV-WRITTEN-FILE1                   02548099
027400          ADD 1             TO PV-TOT-RECS-WRITTEN                02549099
027500          WRITE OUTPUT-RECORD1                                    02550099
027600              FROM PV-DECONSOL-RECORD                             02560099
027700          PERFORM 2500-READ-INPUT-FILE                            02570099
027800     END-PERFORM.                                                 02580099
027900                                                                  02590099
028000 2120-WRITE-FILE2.                                                02600099
028100                                                                  02610099
           MOVE PV-ENT-NAME TO PV-FILE2-ENTNAME                         02620099
028200     PERFORM 2500-READ-INPUT-FILE.                                02630099
028300     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02640099
028400                   PS-END-OF-INPUT-FILE                           02650099
028500         ADD 1              TO PV-READ-FILE2                      02660099
028600         ADD 1              TO PV-EXTRACTS-READ                   02670099
028700         ADD 1              TO PV-WRITTEN-FILE2                   02680099
028800         ADD 1              TO PV-TOT-RECS-WRITTEN                02690099
028900         WRITE OUTPUT-RECORD2                                     02700099
029000             FROM PV-DECONSOL-RECORD                              02710099
029100         PERFORM 2500-READ-INPUT-FILE                             02720099
029200     END-PERFORM.                                                 02730099
029300                                                                  02740099
028000 2130-WRITE-FILE3.                                                02750099
028100                                                                  02760099
           MOVE PV-ENT-NAME TO PV-FILE3-ENTNAME                         02770099
028200     PERFORM 2500-READ-INPUT-FILE.                                02780099
028300     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02790099
028400                   PS-END-OF-INPUT-FILE                           02800099
028500         ADD 1              TO PV-READ-FILE3                      02810099
028600         ADD 1              TO PV-EXTRACTS-READ                   02820099
028700         ADD 1              TO PV-WRITTEN-FILE3                   02830099
028800         ADD 1              TO PV-TOT-RECS-WRITTEN                02840099
028900         WRITE OUTPUT-RECORD3                                     02850099
029000             FROM PV-DECONSOL-RECORD                              02860099
029100         PERFORM 2500-READ-INPUT-FILE                             02870099
029200     END-PERFORM.                                                 02880099
                                                                        02890099
028000 2140-WRITE-FILE4.                                                02900099
                                                                        02910099
           MOVE PV-ENT-NAME TO PV-FILE4-ENTNAME                         02920099
028200     PERFORM 2500-READ-INPUT-FILE.                                02930099
028300     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02931099
028400                   PS-END-OF-INPUT-FILE                           02932099
028500         ADD 1              TO PV-READ-FILE4                      02932199
028600         ADD 1              TO PV-EXTRACTS-READ                   02932299
028700         ADD 1              TO PV-WRITTEN-FILE4                   02932399
028800         ADD 1              TO PV-TOT-RECS-WRITTEN                02932499
028900         WRITE OUTPUT-RECORD4                                     02932599
029000             FROM PV-DECONSOL-RECORD                              02932699
029100         PERFORM 2500-READ-INPUT-FILE                             02932799
029200     END-PERFORM.                                                 02932899
                                                                        02932999
028000 2150-WRITE-FILE5.                                                02933099
                                                                        02933199
           MOVE PV-ENT-NAME TO PV-FILE5-ENTNAME                         02933299
028200     PERFORM 2500-READ-INPUT-FILE.                                02933399
028300     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02933499
028400                   PS-END-OF-INPUT-FILE                           02933599
028500         ADD 1              TO PV-READ-FILE5                      02933699
028600         ADD 1              TO PV-EXTRACTS-READ                   02933799
028700         ADD 1              TO PV-WRITTEN-FILE5                   02933899
028800         ADD 1              TO PV-TOT-RECS-WRITTEN                02933999
028900         WRITE OUTPUT-RECORD5                                     02934099
029000             FROM PV-DECONSOL-RECORD                              02935099
029100         PERFORM 2500-READ-INPUT-FILE                             02936099
029200     END-PERFORM.                                                 02937099
                                                                        02938099
029400 2400-WRITE-EXCEPTION-REC.                                        02939099
029500                                                                  02939199
029600     IF PV-DECONSOL-REC-ISA                                       02939299
029700         WRITE DECONSOL-EXCP-LINE                                 02939399
029800            FROM PV-DECONSOL-RECORD                               02939499
029900         PERFORM 2500-READ-INPUT-FILE                             02939599
030000     END-IF.                                                      02939699
030100                                                                  02939799
030200     PERFORM UNTIL PV-DECONSOL-REC-ISA   OR                       02939899
030300                   PS-END-OF-INPUT-FILE                           02939999
030400         ADD 1              TO PV-INVALID-ENT-ID-ON-ISA           02940099
030500         ADD 1              TO PV-EXTRACTS-READ                   02950099
030600         ADD 1              TO PV-EXCEPTION-WRITTEN               02960099
030700         ADD 1              TO PV-TOT-LOGICAL-BAD                 02970099
030800         WRITE DECONSOL-EXCP-LINE                                 02980099
030900             FROM PV-DECONSOL-RECORD                              02990099
031000         PERFORM 2500-READ-INPUT-FILE                             03000099
031100     END-PERFORM.                                                 03010099
031200                                                                  03020099
031300 2500-READ-INPUT-FILE.                                            03030099
031400                                                                  03040099
           IF PV-READ-IND = 1                                           03050099
031500         READ INPUT-FILE1                                         03060099
031600               INTO PV-DECONSOL-RECORD                            03070099
031700                AT END                                            03080099
031800                    SET PS-END-OF-INPUT-FILE TO TRUE              03090099
           END-IF.                                                      03100099
031400                                                                  03110099
           IF PV-READ-IND = 2                                           03120099
031500         READ INPUT-FILE2                                         03130099
031600               INTO PV-DECONSOL-RECORD                            03140099
031700                AT END                                            03150099
031800                    SET PS-END-OF-INPUT-FILE TO TRUE              03160099
           END-IF.                                                      03170099
                                                                        03180099
           IF PV-READ-IND = 3                                           03181099
031500         READ INPUT-FILE3                                         03182099
031600               INTO PV-DECONSOL-RECORD                            03183099
031700                AT END                                            03184099
031800                    SET PS-END-OF-INPUT-FILE TO TRUE              03185099
           END-IF.                                                      03186099
                                                                        03187099
           IF PV-READ-IND = 4                                           03188099
031500         READ INPUT-FILE4                                         03188199
031600               INTO PV-DECONSOL-RECORD                            03188299
031700                AT END                                            03188399
031800                    SET PS-END-OF-INPUT-FILE TO TRUE              03188499
           END-IF.                                                      03188599
                                                                        03188699
           IF PV-READ-IND = 5                                           03188799
031500         READ INPUT-FILE5                                         03188899
031600               INTO PV-DECONSOL-RECORD                            03188999
031700                AT END                                            03189099
031800                    SET PS-END-OF-INPUT-FILE TO TRUE              03189199
           END-IF.                                                      03189299
                                                                        03189399
           IF PS-REPORT-NUMBER                                          03189499
               CONTINUE                                                 03189599
           ELSE                                                         03189699
               IF PV-DECONSOL-RECORD (4:5) = 'TRANS'                    03189799
                   SET PS-REPORT-NUMBER TO TRUE                         03189899
038300             MOVE 1               TO DP132O-REPORT-NUMBER         03189999
017000             MOVE PV-REPORT1-NAME TO HEAD-LINE1-REPORT-NAME       03190099
               ELSE                                                     03190199
                   IF PV-DECONSOL-RECORD (4:5) = 'RTRNS'                03190299
                      SET PS-REPORT-NUMBER TO TRUE                      03190399
038300                MOVE 2               TO DP132O-REPORT-NUMBER      03190499
017000                MOVE PV-REPORT2-NAME TO HEAD-LINE1-REPORT-NAME    03190599
                   END-IF                                               03190699
               END-IF                                                   03190799
           END-IF.                                                      03190899
031400                                                                  03190999
032000 2800-WRITE-CTT-RECORDS.                                          03191099
032100                                                                  03191199
032200     IF PV-WRITTEN-FILE1 > 0                                      03191299
032300         MOVE PV-WRITTEN-FILE1     TO TR004-HASH-TOTALS           03191399
032400         WRITE OUTPUT-RECORD1                                     03191499
032500             FROM TR004-REC-TYPE-CTT                              03191599
032600     END-IF.                                                      03191699
032100                                                                  03191799
032200     IF PV-WRITTEN-FILE2 > 0                                      03191899
032300         MOVE PV-WRITTEN-FILE2     TO TR004-HASH-TOTALS           03191999
032400         WRITE OUTPUT-RECORD2                                     03192099
032500             FROM TR004-REC-TYPE-CTT                              03193099
032600     END-IF.                                                      03194099
032100                                                                  03195099
032200     IF PV-WRITTEN-FILE3 > 0                                      03196099
032300         MOVE PV-WRITTEN-FILE3     TO TR004-HASH-TOTALS           03197099
032400         WRITE OUTPUT-RECORD3                                     03198099
032500             FROM TR004-REC-TYPE-CTT                              03199099
032600     END-IF.                                                      03200099
032100                                                                  03210099
032200     IF PV-WRITTEN-FILE4 > 0                                      03220099
032300         MOVE PV-WRITTEN-FILE4     TO TR004-HASH-TOTALS           03230099
032400         WRITE OUTPUT-RECORD4                                     03240099
032500             FROM TR004-REC-TYPE-CTT                              03250099
032600     END-IF.                                                      03260099
033300                                                                  03270099
032200     IF PV-WRITTEN-FILE5 > 0                                      03271099
032300         MOVE PV-WRITTEN-FILE5     TO TR004-HASH-TOTALS           03272099
032400         WRITE OUTPUT-RECORD5                                     03273099
032500             FROM TR004-REC-TYPE-CTT                              03274099
032600     END-IF.                                                      03275099
033300                                                                  03276099
033400******************************************************************03277099
033500* DISPLAY PROGRAM COUNTS TO CONSOLE. (SYSOUT)                    *03278099
033600******************************************************************03279099
033700 3000-DISPLAY-COUNTS.                                             03280099
033800                                                                  03290099
033900     DISPLAY '(TOTALS EXCLUDE CONTROL AND CTT RECORDS)        '.  03300099
034000     DISPLAY '                                                 '. 03310099
034100                                                                  03320099
034200     MOVE PV-EXTRACTS-READ    TO PV-EXTRACTS-READ-M.              03330099
034300     DISPLAY '*** TOTAL RECORDS READ:                            '03340099
034400                                 PV-EXTRACTS-READ-M.              03350099
034500     MOVE PV-TOT-RECS-WRITTEN TO PV-TOT-RECS-WRITTEN-M.           03360099
034600     DISPLAY '*** TOTAL RECORDS WRITTEN:                         '03370099
034700                                 PV-TOT-RECS-WRITTEN-M.           03380099
           IF PV-READ-FILE1 > ZEROES                                    03390099
               MOVE PV-READ-FILE1    TO PV-READ-COUNT1                  03400099
               MOVE PV-WRITTEN-FILE1 TO PV-WRITTEN-COUNT1               03410099
               MOVE PV-FILE1-ENTNAME TO PV-RPT-ENTNAME-READ1            03420099
                                        PV-RPT-ENTNAME-WRITTEN1         03430099
034800         DISPLAY ' '                                              03440099
               DISPLAY PV-PRT-TTL-R1                                    03450099
               DISPLAY PV-PRT-TTL-W1.                                   03460099
                                                                        03470099
           IF PV-READ-FILE2 > ZEROES                                    03480099
               MOVE PV-READ-FILE2    TO PV-READ-COUNT1                  03481099
               MOVE PV-WRITTEN-FILE2 TO PV-WRITTEN-COUNT1               03482099
               MOVE PV-FILE2-ENTNAME TO PV-RPT-ENTNAME-READ1            03483099
                                        PV-RPT-ENTNAME-WRITTEN1         03484099
034800         DISPLAY ' '                                              03485099
               DISPLAY PV-PRT-TTL-R1                                    03486099
               DISPLAY PV-PRT-TTL-W1.                                   03487099
                                                                        03488099
           IF PV-READ-FILE3 > ZEROES                                    03489099
               MOVE PV-READ-FILE3    TO PV-READ-COUNT1                  03490099
               MOVE PV-WRITTEN-FILE3 TO PV-WRITTEN-COUNT1               03491099
               MOVE PV-FILE3-ENTNAME TO PV-RPT-ENTNAME-READ1            03492099
                                        PV-RPT-ENTNAME-WRITTEN1         03492199
034800         DISPLAY ' '                                              03492299
               DISPLAY PV-PRT-TTL-R1                                    03492399
               DISPLAY PV-PRT-TTL-W1.                                   03492499
                                                                        03492599
           IF PV-READ-FILE4 > ZEROES                                    03492699
               MOVE PV-READ-FILE4    TO PV-READ-COUNT1                  03492799
               MOVE PV-WRITTEN-FILE4 TO PV-WRITTEN-COUNT1               03492899
               MOVE PV-FILE4-ENTNAME TO PV-RPT-ENTNAME-READ1            03492999
                                        PV-RPT-ENTNAME-WRITTEN1         03493099
034800         DISPLAY ' '                                              03493199
               DISPLAY PV-PRT-TTL-R1                                    03493299
               DISPLAY PV-PRT-TTL-W1.                                   03493399
                                                                        03493499
           IF PV-READ-FILE5 > ZEROES                                    03493599
               MOVE PV-READ-FILE5    TO PV-READ-COUNT1                  03493699
               MOVE PV-WRITTEN-FILE5 TO PV-WRITTEN-COUNT1               03493799
               MOVE PV-FILE5-ENTNAME TO PV-RPT-ENTNAME-READ1            03493899
                                        PV-RPT-ENTNAME-WRITTEN1         03493999
034800         DISPLAY ' '                                              03494099
               DISPLAY PV-PRT-TTL-R1                                    03494199
               DISPLAY PV-PRT-TTL-W1.                                   03494299
036200                                                                  03494399
036300     DISPLAY ' '.                                                 03494499
036400     MOVE PV-EXCEPTION-WRITTEN TO PV-EXCEPTION-WRITTEN-M.         03494599
036500     DISPLAY '*** TOTAL EXCEPTION RECORDS WRITTEN:               '03494699
036600                                  PV-EXCEPTION-WRITTEN-M.         03494799
036700     DISPLAY ' '.                                                 03494899
036800     MOVE PV-TOT-LOGICAL-BAD   TO PV-TOT-LOGICAL-REC-BAD-M.       03494999
036900     DISPLAY '*** TOTAL LOGICAL RECORDS NOT PROCESSED:           '03495099
037000                                PV-TOT-LOGICAL-REC-BAD-M.         03496099
037100     MOVE PV-INVALID-ENT-ID-ON-ISA TO PV-INVALID-ENT-ID-ON-ISA-M. 03497099
037200     DISPLAY '*** TOTAL RECORDS WITH AN INVALID ENT ID:          '03498099
037300                                      PV-INVALID-ENT-ID-ON-ISA-M. 03499099
037400                                                                  03500099
037500******************************************************************03510099
037600* PRINT A SUMMARY REPORT.                                        *03520099
037700******************************************************************03530099
037800 4000-PRINT-REPORT.                                               03540099
037900                                                                  03550099
038000     MOVE 0              TO PV-LINE-CNT.                          03560099
038100     ADD 1               TO PV-PAGE-CNT.                          03570099
038200     MOVE PV-PAGE-CNT    TO DP132O-PAGE-NUMBER.                   03580099
038400     MOVE 'TRKUT020'     TO DP132O-PROGRAM-NAME.                  03590099
038500                                                                  03600099
038600     MOVE DP132O-STANDRD-HEADER-132-COLS TO PRINT-LINE.           03610099
038700                                                                  03620099
038800     PERFORM 4025-WRITE-TOP1.                                     03630099
038900     MOVE SPACES TO PRINT-LINE.                                   03640099
039000     PERFORM 4050-WRITE-REPORT1.                                  03650099
039100     MOVE HEAD-LINE1 TO PRINT-LINE.                               03660099
039200     PERFORM 4050-WRITE-REPORT1.                                  03670099
039300     MOVE SPACES TO PRINT-LINE.                                   03680099
039400     PERFORM 4050-WRITE-REPORT1.                                  03690099
                                                                        03700099
021800     PERFORM 4500-WRITE-DEFAULT-ENTID-FILE                        03710099
             UNTIL PS-END-OF-DEF-ENTID-FILE.                            03720099
039300     MOVE SPACES TO PRINT-LINE.                                   03730099
039400     PERFORM 4050-WRITE-REPORT1.                                  03740099
                                                                        03750099
039500     IF PV-EXCEPTION-WRITTEN  > 0                                 03760099
039600        MOVE HEAD-LINE2 TO PRINT-LINE                             03770099
039700     ELSE                                                         03780099
039800        MOVE HEAD-LINE5 TO PRINT-LINE                             03790099
039900     END-IF.                                                      03800099
040000     PERFORM 4050-WRITE-REPORT1.                                  03810099
040100     MOVE SPACES TO PRINT-LINE.                                   03820099
040200     PERFORM 4050-WRITE-REPORT1.                                  03830099
040300     MOVE HEAD-LINE3 TO PRINT-LINE.                               03840099
040400     PERFORM 4050-WRITE-REPORT1.                                  03850099
040500     MOVE HEAD-LINE4 TO PRINT-LINE.                               03860099
040600     PERFORM 4050-WRITE-REPORT1.                                  03870099
040700     MOVE SPACES TO PRINT-LINE.                                   03880099
040800     PERFORM 4050-WRITE-REPORT1.                                  03890099
040900     MOVE SPACES TO PRINT-LINE.                                   03900099
041000     PERFORM 4050-WRITE-REPORT1.                                  03910099
041100     MOVE PV-PRT-TTL-READ TO PRINT-LINE.                          03920099
041200     PERFORM 4050-WRITE-REPORT1.                                  03930099
041300     MOVE PV-PRT-TTL-WRITTEN TO PRINT-LINE.                       03940099
041400     PERFORM 4050-WRITE-REPORT1.                                  03950099
           IF PV-READ-FILE1 > ZEROES                                    03960099
041500         MOVE SPACES TO PRINT-LINE                                03970099
041600         PERFORM 4050-WRITE-REPORT1                               03980099
               MOVE PV-READ-FILE1    TO PV-READ-COUNT                   03990099
               MOVE PV-WRITTEN-FILE1 TO PV-WRITTEN-COUNT                04000099
               MOVE PV-FILE1-ENTNAME TO PV-RPT-ENTNAME-READ             04010099
                                        PV-RPT-ENTNAME-WRITTEN          04020099
               MOVE PV-PRT-TTL-R     TO PRINT-LINE                      04030099
041800         PERFORM 4050-WRITE-REPORT1                               04040099
               MOVE PV-PRT-TTL-W     TO PRINT-LINE                      04050099
041800         PERFORM 4050-WRITE-REPORT1.                              04060099
           IF PV-READ-FILE2 > ZEROES                                    04070099
041500         MOVE SPACES TO PRINT-LINE                                04080099
041600         PERFORM 4050-WRITE-REPORT1                               04090099
               MOVE PV-READ-FILE2    TO PV-READ-COUNT                   04100099
               MOVE PV-WRITTEN-FILE2 TO PV-WRITTEN-COUNT                04110099
               MOVE PV-FILE2-ENTNAME TO PV-RPT-ENTNAME-READ             04120099
                                        PV-RPT-ENTNAME-WRITTEN          04130099
               MOVE PV-PRT-TTL-R     TO PRINT-LINE                      04140099
041800         PERFORM 4050-WRITE-REPORT1                               04150099
               MOVE PV-PRT-TTL-W     TO PRINT-LINE                      04160099
041800         PERFORM 4050-WRITE-REPORT1.                              04170099
           IF PV-READ-FILE3 > ZEROES                                    04180099
041500         MOVE SPACES TO PRINT-LINE                                04190099
041600         PERFORM 4050-WRITE-REPORT1                               04200099
               MOVE PV-READ-FILE3    TO PV-READ-COUNT                   04210099
               MOVE PV-WRITTEN-FILE3 TO PV-WRITTEN-COUNT                04211099
               MOVE PV-FILE3-ENTNAME TO PV-RPT-ENTNAME-READ             04212099
                                        PV-RPT-ENTNAME-WRITTEN          04213099
               MOVE PV-PRT-TTL-R     TO PRINT-LINE                      04214099
041800         PERFORM 4050-WRITE-REPORT1                               04215099
               MOVE PV-PRT-TTL-W     TO PRINT-LINE                      04216099
041800         PERFORM 4050-WRITE-REPORT1.                              04217099
           IF PV-READ-FILE4 > ZEROES                                    04218099
041500         MOVE SPACES TO PRINT-LINE                                04219099
041600         PERFORM 4050-WRITE-REPORT1                               04220099
               MOVE PV-READ-FILE4    TO PV-READ-COUNT                   04230099
               MOVE PV-WRITTEN-FILE4 TO PV-WRITTEN-COUNT                04240099
               MOVE PV-FILE4-ENTNAME TO PV-RPT-ENTNAME-READ             04250099
                                        PV-RPT-ENTNAME-WRITTEN          04260099
               MOVE PV-PRT-TTL-R     TO PRINT-LINE                      04261099
041800         PERFORM 4050-WRITE-REPORT1                               04262099
               MOVE PV-PRT-TTL-W     TO PRINT-LINE                      04263099
041800         PERFORM 4050-WRITE-REPORT1.                              04264099
           IF PV-READ-FILE5 > ZEROES                                    04265099
041500         MOVE SPACES TO PRINT-LINE                                04266099
041600         PERFORM 4050-WRITE-REPORT1                               04267099
               MOVE PV-READ-FILE5    TO PV-READ-COUNT                   04268099
               MOVE PV-WRITTEN-FILE5 TO PV-WRITTEN-COUNT                04269099
               MOVE PV-FILE5-ENTNAME TO PV-RPT-ENTNAME-READ             04269199
                                        PV-RPT-ENTNAME-WRITTEN          04269299
               MOVE PV-PRT-TTL-R     TO PRINT-LINE                      04269399
041800         PERFORM 4050-WRITE-REPORT1                               04269499
               MOVE PV-PRT-TTL-W     TO PRINT-LINE                      04269599
041800         PERFORM 4050-WRITE-REPORT1.                              04269699
042700     MOVE SPACES TO PRINT-LINE.                                   04269799
042800     PERFORM 4050-WRITE-REPORT1.                                  04269899
042900     MOVE PV-EXCEPT-LINE-W TO PRINT-LINE.                         04269999
043000     PERFORM 4050-WRITE-REPORT1.                                  04270099
043100     MOVE SPACE TO PRINT-LINE.                                    04280099
043200     PERFORM 4050-WRITE-REPORT1.                                  04290099
043300     MOVE PV-INVALID-ENT-ID-LINE TO PRINT-LINE.                   04300099
043400     PERFORM 4050-WRITE-REPORT1.                                  04310099
043500                                                                  04320099
043600******************************************************************04330099
043700* WRITE THE REPORT LINE AFTER ADVANCING A PAGE.                  *04340099
043800******************************************************************04350099
043900 4025-WRITE-TOP1.                                                 04360099
044000                                                                  04370099
044100     WRITE PRINT-LINE                                             04380099
044200          AFTER ADVANCING PAGE.                                   04390099
044300                                                                  04400099
044400     ADD 1     TO   PV-LINE-CNT.                                  04410099
044500                                                                  04420099
044600******************************************************************04430099
044700* WRITE THE REPORT LINE.                                         *04440099
044800******************************************************************04450099
044900 4050-WRITE-REPORT1.                                              04460099
045000                                                                  04470099
045100     WRITE PRINT-LINE                                             04480099
045200          AFTER ADVANCING 1.                                      04490099
045300                                                                  04500099
045400     ADD 1     TO PV-LINE-CNT.                                    04510099
045500                                                                  04520099
017500****************************************************************  04530099
017600* SEARCH INPUT ENTITY ID TABLE                                 *  04540099
017700****************************************************************  04550099
       4070-SEARCH-ENT-ID-TBL.                                          04560099
037600     SET DECNO-IND                 TO 1.                          04561099
037700     SET PS-NOT-END-OF-SEARCH      TO TRUE.                       04562099
037800     PERFORM UNTIL PS-END-OF-SEARCH                               04563099
037900          SEARCH WS-DECONSOL-NO-TABLE-ENTRIES                     04564099
038000              WHEN WS-DECNO-ENT-ID(DECNO-IND) =                   04565099
                         PV-DECONSOL-ENT-ID                             04566099
                         MOVE WS-DECNO-FILE-NO(DECNO-IND) TO            04566199
                              PV-FILE-NO                                04566299
                         MOVE WS-DECNO-ENT-NAME (DECNO-IND) TO          04566399
                              PV-ENT-NAME                               04566499
038700                   SET PS-END-OF-SEARCH TO TRUE                   04566599
038200              WHEN WS-DECNO-ENT-ID(DECNO-IND) = ZEROS             04566699
038700                   SET PS-END-OF-SEARCH TO TRUE                   04566799
                         MOVE ZERO TO PV-FILE-NO                        04566899
038200              WHEN WS-DECNO-ENT-ID(DECNO-IND) = LOW-VALUES        04566999
                         MOVE ZERO TO PV-FILE-NO                        04567099
038700                   SET PS-END-OF-SEARCH TO TRUE                   04567199
038800          END-SEARCH                                              04567299
038900     END-PERFORM.                                                 04567399
                                                                        04567499
037500******************************************************************04567599
037600* WRITE DEFAULT ENT ID FILE TO SUMMARY REPORT                    *04567699
037700******************************************************************04567799
031300 4500-WRITE-DEFAULT-ENTID-FILE.                                   04567899
                                                                        04567999
           INITIALIZE PV-DEFAULT-ENTID-RECORD.                          04568099
           READ DEFAULT-ENTID-FILE INTO PV-DEFAULT-ENTID-RECORD         04568199
             AT END                                                     04568299
              SET PS-END-OF-DEF-ENTID-FILE TO TRUE.                     04568399
                                                                        04568499
           IF PS-END-OF-DEF-ENTID-FILE-NO                               04568599
              WRITE PRINT-LINE FROM DEFAULT-ENTID-RECORD                04568699
           END-IF.                                                      04568799
                                                                        04568899
045600******************************************************************04568999
045700*  CLOSE THE FILES.                                              *04569099
045800******************************************************************04569199
045900 8000-CLOSE-FILES.                                                04569299
046000                                                                  04569399
046300     CLOSE       DECONSOL-EXCP-FILE                               04569499
046400                 INPUT-ENT-FILE                                   04569599
046500                 REPORT-FILE                                      04569699
                       DEFAULT-ENTID-FILE.                              04569799
                                                                        04569899
           MOVE 2 TO PV-OPEN-INPUT-FILE-COUNTER                         04569999
           IF PV-OPEN-INPUT-FILE-COUNTER >                              04570099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             04580099
               CONTINUE                                                 04590099
           ELSE                                                         04600099
              CLOSE INPUT-FILE2                                         04610099
           END-IF.                                                      04620099
           MOVE 3 TO PV-OPEN-INPUT-FILE-COUNTER                         04630099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              04640099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             04650099
               CONTINUE                                                 04651099
           ELSE                                                         04652099
              CLOSE INPUT-FILE3                                         04653099
           END-IF.                                                      04654099
           MOVE 4 TO PV-OPEN-INPUT-FILE-COUNTER                         04655099
           IF PV-OPEN-INPUT-FILE-COUNTER >                              04656099
              PV-HOLD-NUMBER-OF-INPUT-FILES                             04657099
               CONTINUE                                                 04658099
           ELSE                                                         04659099
              CLOSE INPUT-FILE4                                         04659199
           END-IF.                                                      04659299
           MOVE 5 TO PV-OPEN-INPUT-FILE-COUNTER                         04659399
           IF PV-OPEN-INPUT-FILE-COUNTER >                              04659499
              PV-HOLD-NUMBER-OF-INPUT-FILES                             04659599
               CONTINUE                                                 04659699
           ELSE                                                         04659799
              CLOSE INPUT-FILE5                                         04659899
           END-IF.                                                      04659999
                                                                        04660099
046100     CLOSE       OUTPUT-FILE1                                     04661099
           MOVE 2 TO PV-OPEN-OUTPUT-FILE-COUNTER                        04662099
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             04663099
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            04664099
               CONTINUE                                                 04665099
           ELSE                                                         04666099
              CLOSE OUTPUT-FILE2                                        04667099
           END-IF.                                                      04668099
           MOVE 3 TO PV-OPEN-OUTPUT-FILE-COUNTER                        04669099
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             04670099
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            04680099
               CONTINUE                                                 04681099
           ELSE                                                         04682099
              CLOSE OUTPUT-FILE3                                        04683099
           END-IF.                                                      04684099
           MOVE 4 TO PV-OPEN-OUTPUT-FILE-COUNTER                        04685099
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             04686099
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            04687099
               CONTINUE                                                 04688099
           ELSE                                                         04689099
              CLOSE OUTPUT-FILE4                                        04689199
           END-IF.                                                      04689299
           MOVE 5 TO PV-OPEN-OUTPUT-FILE-COUNTER                        04689399
           IF PV-OPEN-OUTPUT-FILE-COUNTER >                             04689499
              PV-HOLD-NUMBER-OF-OUTPUT-FILES                            04689599
               CONTINUE                                                 04689699
           ELSE                                                         04689799
              CLOSE OUTPUT-FILE5                                        04689899
           END-IF.                                                      04689999
