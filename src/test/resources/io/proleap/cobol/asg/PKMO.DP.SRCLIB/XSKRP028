000100*----------------------------------------------------------       00000100
000200 IDENTIFICATION DIVISION.                                         00000200
000300*----------------------------------------------------------       00000300
000400 PROGRAM-ID.    XSKRP028.                                         00000400
000500 AUTHOR.        JOSEPH MENYAH.                                    00000500
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00000600
000700                                                                  00000700
000800*----------------------------------------------------------       00000800
000900*            PRICING EVENT INTEGRITY CHECK                        00000900
001000*----------------------------------------------------------       00001000
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00002000
001020* INTEGRITY CHECK FOR THE PRICING BUSINESS EVENT.                 00003000
001124*                                                                 00004000
001128*----------------------------------------------------------       00008100
062810* DATE:         MAY 6, 2010                                       00008200
062810* WR/IR#:       WR# 38172                                         00008300
062810* PROGRAMMER:   CHERI PARMLEY                                     00008400
062810* DESCRIPTION:  WHEN PRICG-TYP-CDE = 'RBO' INDICATE THIS ON       00008500
062810*               REPORT WITH AN 'RBO' FOLLOWING THE KEY.           00008600
001128*----------------------------------------------------------       00008700
001129* DATE:         AUG 12, 2010                                      00009000
001130* WR/IR#:       WR# 38172                                         00010000
001131* PROGRAMMER:   CHERI PARMLEY                                     00020000
001140* DESCRIPTION:  REVERT BACK TO OLD PROGRAM WITH NO RBO            00030000
001150*               CHANGES. RE-ORDER THE PV-DOMAIN-NF AND            00040000
001150*               PV-PROMO-NF VARIABLES.                            00041000
001160*----------------------------------------------------------       00050000
P11215*  DATE:11/22/2010 CHANGED BY: COGNIZANT     PBI11215             00051000
P11215*  CHANGED THE PGM LOGIC IN SUCH A WAY SO THAT                    00051112
P11215*  THE REPORT WILL SKIP THE SKU'S AND READ THE NEXT SKU           00051212
P11215*  WHEN STYL_ID IN PROMO TABLES IS EQUAL TO 0.                    00053000
001125*----------------------------------------------------------       00054000
C34196*  DATE:10/18/2012 CHANGED BY: COGNIZANT     CRQ34196             00054114
C34196*  CHANGE MADE: REMOVED ADV_CDE FROM INTEGRITY CHECK AS THIS FIELD00054214
C34196*  NOT UPDATED CORRECTLY BY SOURCE TEAM                           00054314
001160*----------------------------------------------------------       00055014
C75493*  DATE:02/28/2014 CHANGED BY: COGNIZANT     CHG0075493           00056020
C75493*  CHANGE MADE: ADDED WRITE STATEMENT TO AVOID SKIPPING OF RECORDS00057020
C75493*  AFTER PAGE BREAK                                               00058020
C75493*----------------------------------------------------------       00059020
001170 ENVIRONMENT DIVISION.                                            00060000
001180*----------------------------------------------------------       00070000
001190 CONFIGURATION SECTION.                                           00080000
001200 SOURCE-COMPUTER. IBM-3090.                                       00090000
001300 OBJECT-COMPUTER. IBM-3090.                                       00100000
001400                                                                  00110000
001500 INPUT-OUTPUT SECTION.                                            00120000
001600                                                                  00130000
001700 FILE-CONTROL.                                                    00140000
004900     SELECT CONTROL-CARD                                          00150000
005000         ASSIGN TO INP00.                                         00151000
                                                                        00152000
004900     SELECT PROMO-EXTRACT-FILE                                    00153000
005000         ASSIGN TO INP01.                                         00154000
                                                                        00155000
004900     SELECT DOMAIN-EXTRACT-FILE                                   00156000
005000         ASSIGN TO INP02.                                         00157000
                                                                        00158000
                                                                        00159000
004900     SELECT ERROR-FILE                                            00160000
005000         ASSIGN TO OUT01.                                         00170000
                                                                        00180000
004900     SELECT REPORT-FILE                                           00190000
005000         ASSIGN TO RPT01.                                         00200000
                                                                        00201000
001900*----------------------------------------------------------       00202000
002000 DATA DIVISION.                                                   00203000
002100*----------------------------------------------------------       00204000
002200 FILE SECTION.                                                    00205000
002300                                                                  00206000
008000 FD  PROMO-EXTRACT-FILE                                           00207000
008100     RECORDING MODE IS F                                          00208000
008200     LABEL RECORDS ARE OMITTED                                    00209000
008300     RECORD CONTAINS 258 CHARACTERS                               00210000
008400     DATA RECORD IS PROMO-EVNT-RECORD.                            00220000
008500 01  PROMO-EVNT-REC              PIC X(258).                      00230000
008600                                                                  00240000
008000 FD  DOMAIN-EXTRACT-FILE                                          00250000
008100     RECORDING MODE IS F                                          00260000
008200     LABEL RECORDS ARE OMITTED                                    00270000
008300     RECORD CONTAINS 258 CHARACTERS                               00280000
008400     DATA RECORD IS DOMAIN-EVNT-RECORD.                           00290000
008500 01  DOMAIN-EVNT-REC              PIC X(258).                     00300000
006500                                                                  00310000
       FD  CONTROL-CARD                                                 00320000
           RECORDING MODE F                                             00330000
           BLOCK CONTAINS 0 RECORDS                                     00340000
           LABEL RECORDS ARE OMITTED                                    00350000
           DATA RECORD IS CONTROL-CARD-RECORD.                          00360000
       01  CONTROL-CARD-RECORD             PIC X(080).                  00370000
                                                                        00380000
       FD  REPORT-FILE                                                  00390000
           RECORDING MODE F                                             00400000
           BLOCK CONTAINS 0 RECORDS                                     00401000
           LABEL RECORDS ARE OMITTED                                    00402000
009600     RECORD CONTAINS 132 CHARACTERS                               00403000
           DATA RECORD IS REPORT-RECORD.                                00404000
       01  REPORT-RECORD                   PIC X(132).                  00405000
                                                                        00406000
       FD  ERROR-FILE                                                   00407000
           RECORDING MODE F                                             00408000
           BLOCK CONTAINS 0 RECORDS                                     00409000
           LABEL RECORDS ARE OMITTED                                    00410000
           DATA RECORD IS DIFFERENCES-RECORD.                           00410100
       01  DIFFERENCES-RECORD              PIC X(258).                  00410200
                                                                        00410300
002500*---------------------------------------------------------        00410400
002600                                                                  00410500
002700 WORKING-STORAGE SECTION.                                         00410600
002800*---------------------------------------------------------        00410700
003500* PC- PROGRAM CONSTANTS                                           00410800
003600*----------------------------------------------------------       00410900
003700 01  PC-PROGRAM-CONSTANTS.                                        00411000
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKRP028'. 00412000
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00413000
004000                                                                  00414000
097700 01  CD-CPU-DATE.                                                 00415000
097800     03  CD-CPU-YEAR             PIC 99.                          00416000
097900     03  CD-CPU-MONTH            PIC 99.                          00417000
098000     03  CD-CPU-DAY              PIC 99.                          00418000
098100                                                                  00419000
098200 01  CD-CPU-DATE-CC.                                              00420000
098300     03  CD-CPU-CENT             PIC 99.                          00430000
098400     03  CD-CPU-YYMMDD           PIC 9(6).                        00440000
                                                                        00450000
084800 01  PC-REPORT-NO                PIC  9(5)          VALUE 00001.  00460000
                                                                        00470000
011200 01  CT-CPU-TIME.                                                 00480000
011300     03  CT-HOUR                 PIC 99.                          00490000
011400     03  CT-MINUTE               PIC 99.                          00500000
011500     03  FILLER                  PIC 9(4).                        00501000
      *----------------------------------------------------------       00501100
      **PROGRAM                                                         00501200
      *----------------------------------------------------------       00501300
       01  PC-PROGRAM-COUNTER.                                          00501400
           05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   00501500
                                                          COMP-3.       00501600
           05  PC-PROMO-EXTRACT-RECS-READ      PIC 9(09) VALUE ZEROS.   00501700
           05  PC-DOMAIN-EXTRACT-RECS-READ     PIC 9(09) VALUE ZEROS.   00501800
           05  PC-ERROR-RECORD-WRITTEN         PIC 9(09) VALUE ZEROS.   00501900
           05  PC-ERROR-REPORT-WRITTEN         PIC 9(09) VALUE ZEROS.   00502000
           05  PC-PAGE-CNT                     PIC 9(09) VALUE ZEROS.   00502100
004100*----------------------------------------------------------       00502200
004200* PS- PROGRAM SWITCHES                                            00502300
004300*----------------------------------------------------------       00502400
004400 01  PS-PROGRAM-SWITCHES.                                         00502500
004500     05  PS-EOF-PROMO-EXTRACT-SW          PIC X(01)  VALUE SPACE. 00502600
004600         88  PS-EOF-PROMO                        VALUE 'Y'.       00502700
004600         88  PS-NOT-EOF-PROMO                    VALUE 'N'.       00502800
004800                                                                  00502900
004500     05  PS-EOF-DOMAIN-EXTRACT-SW         PIC X(01)  VALUE SPACE. 00503000
004600         88  PS-EOF-DOMAIN                       VALUE 'Y'.       00504000
004600         88  PS-NOT-EOF-DOMAIN                   VALUE 'N'.       00505000
004800                                                                  00506000
004500     05  PS-NEW-RECORD-SW                 PIC X(01)  VALUE SPACE. 00507000
004600         88  PS-NEW-RECORD                       VALUE 'Y'.       00508000
004600         88  PS-NOT-NEW-RECORD                   VALUE 'N'.       00509000
004800                                                                  00510000
004900*----------------------------------------------------------       00520000
      *    CONTROL-CARD-LAYOUT.                                         00530000
004900*----------------------------------------------------------       00540000
       01  CONTROL-CARD-LAYOUT.                                         00550000
           05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   00560000
           05  FILLER                          PIC X(01) VALUE SPACES.  00570000
           05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   00580000
           05  FILLER                          PIC X(69) VALUE SPACES.  00580100
004900*----------------------------------------------------------       00580200
005000* PV- PROGRAM VARIABLES                                           00580300
005100*----------------------------------------------------------       00580400
005200 01 PV-PROGRAM-VARIABLES.                                         00580500
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 00580600
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   00580700
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         00580800
005710    05  PV-PROMO-INTFC-ID-HLD         PIC 9(10) VALUE 0.          00580900
005710    05  PV-MDSE-LNE-ID-HLD            PIC 9(05) VALUE 0.          00581000
005800    05  PV-ACTION-CODE                PIC X(01).                  00582000
005810        88  PV-INSERT-DATA                       VALUE 'I'.       00583000
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       00584000
                                                                        00585000
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      00586000
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  00587000
006100        88  PV-NO-ERROR                          VALUE '00'.      00588000
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      00589000
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      00590000
007000                                                                  00600000
           05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     00610000
               88  PS-ERROR-FOUND                        VALUE 'Y'.     00620000
               88  PS-ERROR-NOT-FOUND                    VALUE 'N'.     00630000
                                                                        00640000
007100    05  PV-STRT-PARM.                                             00650000
007200        10  PV-STRT-DTE-CC            PIC X(02).                  00660000
007200        10  PV-STRT-DTE-YY            PIC X(02).                  00670000
007400        10  PV-STRT-DTE-MM            PIC X(02).                  00680000
007600        10  PV-STRT-DTE-DD            PIC X(02).                  00690000
007400        10  FILLER                    PIC X.                      00700000
007400        10  PV-DECREMENT              PIC X(02).                  00710000
007400        10  FILLER                    PIC X(69).                  00720000
007700                                                                  00730000
007100    05  PV-PROMO-STRT-DTE           PIC X(10).                    00740000
007100    05  PV-PROMO-END-DTE            PIC X(10).                    00750000
                                                                        00760000
008600    05  PV-PROMO-KEY.                                             00770000
008700        10  PV-PM-PROMO-INTFC-ID          PIC 9(10).              00780000
008700        10  PV-PM-MDSE-LNE-ID             PIC 9(10).              00790000
008700        10  PV-PM-INTFC-SUB-ID            PIC 9(10).              00800000
                                                                        00810000
008600    05  PV-DOMAIN-KEY.                                            00820000
008700        10  PV-XS-PROMO-INTFC-ID          PIC 9(10).              00830000
008700        10  PV-XS-MDSE-LNE-ID             PIC 9(10).              00831000
008700        10  PV-XS-INTFC-SUB-ID            PIC 9(10).              00832000
                                                                        00833000
008600    05  PV-AD-EVNT-END-DTE-TM.                                    00834000
008700        10  PV-AD-EVNT-END-DTE.                                   00835000
008800            15  PV-AD-EVNT-DTE-TM2-CCYY   PIC X(04).              00836000
008900            15  FILLER                    PIC X(01).              00837000
009000            15  PV-AD-EVNT-DTE-TM2-MM     PIC X(02).              00838000
009100            15  FILLER                    PIC X(01).              00839000
009200            15  PV-AD-EVNT-DTE-TM2-DD     PIC X(02).              00840000
009300        10  PV-AD-EVNT-END-TM             PIC X(16).              00850000
009400                                                                  00860000
008600    05  PV-PROMO-SOURCE              PIC X(40) VALUE              00870000
              'DATA SOURCE IS THE PROMO DATABASE'.                      00880000
                                                                        00890000
008600    05  PV-PROMO-NF                  PIC X(40) VALUE              00900000
              'RECORD NOT FOUND IN PROMO TABLES'.                       00910000
                                                                        00920000
008600    05  PV-DOMAIN-SOURCE             PIC X(40) VALUE              00930000
              'DATA SOURCE IS THE XS DOMAIN DATABASE'.                  00940000
                                                                        00950000
008600    05  PV-DOMAIN-NF                  PIC X(40) VALUE             00960000
              'RECORD NOT FOUND IN XS DOMAIN'.                          00970000
                                                                        00980000
       01  PV-PM-TOTAL-RECORD.                                          00980100
           05 PV-PM-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00980200
           05 PV-PM-ACTION-CDE                 PIC X(01) VALUE 'T'.     00980300
           05 PV-PM-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00980400
                                                                        00980500
       01  PV-XS-TOTAL-RECORD.                                          00980600
           05 PV-XS-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    00980700
           05 PV-XS-ACTION-CDE                 PIC X(01) VALUE 'T'.     00980800
           05 PV-XS-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    00980900
                                                                        00981000
000700 01  ERROR-RECORD                    PIC X(258) VALUE SPACES.     00982000
                                                                        00983000
042800     COPY DPWS132O.                                               00984000
042900                                                                  00985000
                                                                        00986000
043100 01  DR-HEAD2.                                                    00987000
043200     05  FILLER                 PIC X(41)    VALUE SPACES.        00988000
043300     05  DR-TITLE               PIC X(55)    VALUE                00989000
043400      'INTEGRITY CHECK PROGRAM  - PRICING         '.              00990000
                                                                        00990100
043500                                                                  00990200
043100 01  DR-HEAD3.                                                    00990300
043200     05  FILLER                 PIC X(03)    VALUE                00990400
            'KEY'.                                                      00990500
043200     05  FILLER                 PIC X(15)    VALUE SPACES.        00990600
043200     05  FILLER                 PIC X(10)    VALUE                00990700
            'FIELD NAME'.                                               00990800
043200     05  FILLER                 PIC X(14)    VALUE SPACES.        00990900
043200     05  FILLER                 PIC X(05)    VALUE                00991000
            'VALUE'.                                                    00992000
043200     05  FILLER                 PIC X(31)    VALUE SPACES.        00993000
043200     05  FILLER                 PIC X(16)    VALUE                00993100
            'SOURCE / MESSAGE'.                                         00993200
043200     05  FILLER                 PIC X(35)    VALUE SPACES.        00993300
043500                                                                  00993400
043100 01  DR-HEAD5.                                                    00993500
043200     05  FILLER                 PIC X(132)   VALUE ALL '='.       00993600
                                                                        00993700
000700 01  REPORT-DETAIL.                                               00993800
000800   05 PROMO-RPT-INFO.                                             00993900
000800      10 PROMO-EVNT-KEY              PIC X(30)    VALUE SPACES.   00994000
 00800      10 FILLER                      PIC X(5)     VALUE SPACES.   00995000
 00800      10 PROMO-RPT-DATA-NAME         PIC X(20)    VALUE SPACES.   00996000
 00800      10 FILLER                      PIC X(2)     VALUE SPACES.   00996100
 00800      10 PROMO-RPT-DATA-VALUE        PIC X(40)    VALUE SPACES.   00996200
000800   05 REPORT-NOTES                   PIC X(40)    VALUE SPACES.   00996300
010900*----------------------------------------------------------       00996400
011000* DOMAIN PRICING EVENT RECORD LAYOUT                              00996500
011100*----------------------------------------------------------       00996600
011200     COPY XSRD019.                                                00996700
011800                                                                  00996800
004900*----------------------------------------------------------       00996900
005000* PROMO PRICING  COPY BOOK.                                       00997000
005100*----------------------------------------------------------       00997100
           COPY PMRD706.                                                00997200
011800                                                                  00997300
030310                                                                  00997400
031400*----------------------------------------------------------       00997500
031500 PROCEDURE DIVISION.                                              00997600
032100*----------------------------------------------------------       00997700
032200 0000-MAINLINE.                                                   00997800
128200     ACCEPT CD-CPU-DATE FROM DATE.                                00997900
128300     IF CD-CPU-YEAR > 80                                          00998000
128400         MOVE 19 TO CD-CPU-CENT                                   00999000
128500     ELSE                                                         01000000
128600         MOVE 20 TO CD-CPU-CENT.                                  01010000
128700     MOVE CD-CPU-DATE TO CD-CPU-YYMMDD.                           01020000
128800                                                                  01030000
128900     ACCEPT CT-CPU-TIME FROM TIME.                                01040000
032300                                                                  01050000
032400     PERFORM 1000-INITIALIZATION.                                 01060000
032500                                                                  01070000
032600     PERFORM 2000-PROCESS-EXTRACT-DATA                            01080000
032700             UNTIL PS-EOF-DOMAIN                                  01090000
032700                OR PS-EOF-PROMO.                                  01100000
                                                                        01110000
           PERFORM 3000-PROCESS-EXTRA-RECORDS                           01120000
032700             UNTIL PS-EOF-DOMAIN                                  01130000
032700               AND PS-EOF-PROMO.                                  01140000
035000                                                                  01150000
035100     PERFORM 9999-WRAPUP.                                         01160000
035200                                                                  01170000
035500     GOBACK.                                                      01180000
035700                                                                  01190000
035701*0000-EXIT.                                                       01200000
035702 EJECT.                                                           01210000
035703                                                                  01220000
035800*----------------------------------------------------------       01230000
035900* 1000-INITIALIZATION.                                            01240000
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            01250000
036100*     UPDATE OR INSERT A RECORD.                                  01260000
036200*----------------------------------------------------------       01270000
036300 1000-INITIALIZATION.                                             01280000
                                                                        01290000
132408     MOVE CD-CPU-YEAR  TO DP132O-RUN-YEAR.                        01300000
132409     MOVE CD-CPU-MONTH TO DP132O-RUN-MONTH.                       01310000
132410     MOVE CD-CPU-DAY   TO DP132O-RUN-DAY.                         01320000
132420     MOVE CT-HOUR    TO DP132O-RUN-HOUR.                          01330000
132430     MOVE CT-MINUTE  TO DP132O-RUN-MINUTE.                        01340000
132440     MOVE 'XSKRP028' TO DP132O-PROGRAM-NAME.                      01350000
132450     MOVE 1          TO DP132O-REPORT-NUMBER.                     01360000
           SET PS-NOT-EOF-PROMO TO TRUE.                                01370000
           SET PS-NOT-EOF-DOMAIN TO TRUE.                               01380000
026600     OPEN INPUT  PROMO-EXTRACT-FILE                               01390000
026600                 DOMAIN-EXTRACT-FILE                              01400000
026600                 CONTROL-CARD                                     01410000
026600          OUTPUT ERROR-FILE                                       01420000
026600                 REPORT-FILE.                                     01430000
                                                                        01440000
           PERFORM 9999-PRINT-HEADINGS.                                 01450000
           PERFORM 9999-READ-CONTROL-CARD.                              01460000
           READ DOMAIN-EXTRACT-FILE INTO PV-XS-TOTAL-RECORD             01470000
           READ PROMO-EXTRACT-FILE INTO PV-PM-TOTAL-RECORD              01480000
                                                                        01490000
           IF PV-PM-TOTAL-NBR-OF-RECS NOT EQUAL TO                      01500000
              PV-XS-TOTAL-NBR-OF-RECS                                   01510000
             MOVE 1 TO CC-START-POINT                                   01520000
             MOVE 1 TO CC-READ-FREQUENCY                                01530000
           END-IF.                                                      01540000
                                                                        01550000
           PERFORM 9999-READ-PROMO-EXTRACT CC-START-POINT TIMES.        01560000
           PERFORM 9999-READ-DOMAIN-EXTRACT  CC-START-POINT TIMES.      01570000
                                                                        01580000
056500                                                                  01590000
037240*1100-EXIT.                                                       01600000
037250 EJECT.                                                           01610000
037251                                                                  01620000
037260*----------------------------------------------------------       01630000
037300* 2000-PROCESS-EXTRACT-DATA.                                      01640000
037400*     THIS CHECKS THE ACTION TO SEE WHETHER THE RECORD            01650000
037500*     SHOULD BE INSERTED INTO THE AD EVENT TABLE OR UPDATED.      01660000
037600*     IF SOMETHING IS WRONG WITH THE ACTION CODE IT WILL          01670000
037700*     PROCESS AN ERROR AND EXIT THE PROGRAM.                      01680000
037800*----------------------------------------------------------       01690000
037900 2000-PROCESS-EXTRACT-DATA.                                       01700000
                                                                        01710000
           IF PM706-PROMO-INTFC-ID = XS019-PROMO-INTFC-ID               01720000
             IF PM706-MDSE-LNE-ID    = XS019-MDSE-LNE-ID                01730000
               IF PM706-PROMO-INTFC-SUB-ID  = XS019-PROMO-INTFC-SUB-ID  01740000
                   PERFORM 2100-COMPARE-FIELDS                          01750000
                   PERFORM 9999-READ-DOMAIN-EXTRACT                     01760000
                           CC-READ-FREQUENCY TIMES                      01770000
                   PERFORM 9999-READ-PROMO-EXTRACT                      01780000
                           CC-READ-FREQUENCY TIMES                      01790000
               ELSE                                                     01800000
                IF PM706-PROMO-INTFC-SUB-ID > XS019-PROMO-INTFC-SUB-ID  01810000
                    MOVE PV-PROMO-NF    TO REPORT-NOTES                 01820000
                    MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY               01830000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01840000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01850000
                    PERFORM 9999-WRITE-ERROR-REPORT                     01860000
                    MOVE XS019-PRICING-RECORD TO ERROR-RECORD           01870000
                    PERFORM 9999-WRITE-ERROR-RECORD                     01880000
                    PERFORM 9999-READ-DOMAIN-EXTRACT                    01890000
                ELSE                                                    01891000
                    MOVE PV-DOMAIN-NF TO REPORT-NOTES                   01892000
                    MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                01893000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01894000
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01895000
                    PERFORM 9999-WRITE-ERROR-REPORT                     01896000
                    MOVE PM706-PRICING-RECORD        TO ERROR-RECORD    01897000
                    PERFORM 9999-WRITE-ERROR-RECORD                     01898000
                    PERFORM 9999-READ-PROMO-EXTRACT                     01899000
                END-IF                                                  01900000
               END-IF                                                   01900100
             ELSE                                                       01900200
               IF PM706-MDSE-LNE-ID >  XS019-MDSE-LNE-ID                01900300
                    MOVE PV-PROMO-NF    TO REPORT-NOTES                 01900400
                    MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY               01900500
 00800              MOVE SPACES         TO PROMO-RPT-DATA-NAME          01900600
 00800              MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01900700
                    PERFORM 9999-WRITE-ERROR-REPORT                     01900800
                    MOVE XS019-PRICING-RECORD TO ERROR-RECORD           01900900
                    PERFORM 9999-WRITE-ERROR-RECORD                     01901000
                    PERFORM 9999-READ-DOMAIN-EXTRACT                    01901100
               ELSE                                                     01901200
                    MOVE PV-DOMAIN-NF TO REPORT-NOTES                   01901300
                    MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                01901400
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01901500
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01901600
                    PERFORM 9999-WRITE-ERROR-REPORT                     01901700
                    MOVE PM706-PRICING-RECORD        TO ERROR-RECORD    01901800
                    PERFORM 9999-WRITE-ERROR-RECORD                     01901900
                    PERFORM 9999-READ-PROMO-EXTRACT                     01902000
               END-IF                                                   01902100
             END-IF                                                     01902200
           ELSE                                                         01902300
            IF PM706-PROMO-INTFC-ID > XS019-PROMO-INTFC-ID              01902400
                 MOVE PV-PROMO-NF    TO REPORT-NOTES                    01902500
                 MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY                  01902600
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01902700
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01902800
                                                                        01902900
                 PERFORM 9999-WRITE-ERROR-REPORT                        01903000
                 MOVE XS019-PRICING-RECORD TO ERROR-RECORD              01903100
                 PERFORM 9999-WRITE-ERROR-RECORD                        01903200
                 PERFORM 9999-READ-DOMAIN-EXTRACT                       01903300
            ELSE                                                        01903400
                 MOVE PV-DOMAIN-NF TO REPORT-NOTES                      01903500
                 MOVE PV-PROMO-KEY  TO PROMO-EVNT-KEY                   01903600
                    MOVE SPACES         TO PROMO-RPT-DATA-NAME          01903700
                    MOVE SPACES         TO PROMO-RPT-DATA-VALUE         01903800
                 PERFORM 9999-WRITE-ERROR-REPORT                        01903900
                 MOVE PM706-PRICING-RECORD        TO ERROR-RECORD       01904000
                 PERFORM 9999-WRITE-ERROR-RECORD                        01904100
                 PERFORM 9999-READ-PROMO-EXTRACT                        01904200
            END-IF                                                      01904300
           END-IF.                                                      01904400
                                                                        01904500
038000                                                                  01904600
038110*2000-EXIT.                                                       01904700
038200 EJECT.                                                           01904800
                                                                        01904900
038300*------------------------------------------------------           01905000
038400* 2100-COMPARE-FIELDS.                                            01906000
038500*     COMPARES THE EXTRACT FILES AND NOTES ANY DIFFERENCES        01907000
038600*------------------------------------------------------           01908000
038210                                                                  01909000
054400 2100-COMPARE-FIELDS.                                             01910000
           MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY.             01920000
036600     IF PM706-BUSINESS-EVNT-ID NOT EQUAL XS019-BUSINESS-EVNT-ID   01930000
              MOVE 'PM706-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01940000
              MOVE PM706-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01941000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              01942000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           01943000
              PERFORM 9999-WRITE-ERROR-REPORT                           01943100
              MOVE 'XS019-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      01943200
              MOVE XS019-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     01943300
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             01943400
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           01943500
              PERFORM 9999-WRITE-ERROR-REPORT                           01943600
              SET PS-ERROR-FOUND     TO TRUE                            01943700
           END-IF.                                                      01944000
                                                                        01944100
036600     IF PM706-PROMO-INTFC-ID   NOT EQUAL XS019-PROMO-INTFC-ID     01944200
              MOVE 'PM706-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      01945000
              MOVE PM706-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     01946000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              01947000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           01948000
              PERFORM 9999-WRITE-ERROR-REPORT                           01949000
              MOVE 'XS019-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      01950000
              MOVE XS019-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     01960000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             01970000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           01980000
              PERFORM 9999-WRITE-ERROR-REPORT                           01990000
              SET PS-ERROR-FOUND     TO TRUE                            02000000
           END-IF.                                                      02010000
                                                                        02020000
036600     IF PM706-PROMO-INTFC-SUB-ID NOT EQUAL TO                     02030000
              XS019-PROMO-INTFC-SUB-ID                                  02040000
              MOVE 'PM706-PROMO-INTFC-SUB-ID' TO PROMO-RPT-DATA-NAME    02050000
              MOVE PM706-PROMO-INTFC-SUB-ID   TO PROMO-RPT-DATA-VALUE   02060000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02070000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02080000
              PERFORM 9999-WRITE-ERROR-REPORT                           02090000
              MOVE 'XS019-PROMO-INTFC-SUB-ID'  TO PROMO-RPT-DATA-NAME   02100000
              MOVE XS019-PROMO-INTFC-SUB-ID    TO PROMO-RPT-DATA-VALUE  02110000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02120000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02120100
              PERFORM 9999-WRITE-ERROR-REPORT                           02120200
              SET PS-ERROR-FOUND     TO TRUE                            02120300
           END-IF.                                                      02120400
                                                                        02120500
036600     IF PM706-PRCG-TYP-CDE  NOT EQUAL XS019-PRICG-TYP-CDE         02120600
              MOVE 'PM706-PRCG-TYP-CDE'   TO PROMO-RPT-DATA-NAME        02120700
              MOVE PM706-PRCG-TYP-CDE     TO PROMO-RPT-DATA-VALUE       02120800
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02120900
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02121000
              PERFORM 9999-WRITE-ERROR-REPORT                           02122000
              MOVE 'XS019-PRICG-TYP-CDE'  TO PROMO-RPT-DATA-NAME        02123000
              MOVE XS019-PRICG-TYP-CDE     TO PROMO-RPT-DATA-VALUE      02124000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02125000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02126000
              PERFORM 9999-WRITE-ERROR-REPORT                           02127000
              SET PS-ERROR-FOUND     TO TRUE                            02128000
           END-IF.                                                      02129000
                                                                        02130000
036600     IF PM706-PROMO-ID   NOT EQUAL XS019-PROMO-ID                 02130100
              MOVE 'PM706-PROMO-ID'   TO PROMO-RPT-DATA-NAME            02130200
              MOVE PM706-PROMO-ID     TO PROMO-RPT-DATA-VALUE           02130300
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02130400
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02130500
              PERFORM 9999-WRITE-ERROR-REPORT                           02130600
              MOVE 'XS019-PROMO-ID'  TO PROMO-RPT-DATA-NAME             02130700
              MOVE XS019-PROMO-ID     TO PROMO-RPT-DATA-VALUE           02130800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02130900
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02131000
              PERFORM 9999-WRITE-ERROR-REPORT                           02131100
              SET PS-ERROR-FOUND     TO TRUE                            02131200
           END-IF.                                                      02131300
                                                                        02131400
036600     IF PM706-PROMO-ITM-ID   NOT EQUAL XS019-PROMO-ITM-ID         02131500
              MOVE 'PM706-PROMO-ITM-ID'   TO PROMO-RPT-DATA-NAME        02131600
              MOVE PM706-PROMO-ITM-ID     TO PROMO-RPT-DATA-VALUE       02131700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02131800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02131900
              PERFORM 9999-WRITE-ERROR-REPORT                           02132000
              MOVE 'XS019-PROMO-ITM-ID'  TO PROMO-RPT-DATA-NAME         02132100
              MOVE XS019-PROMO-ITM-ID     TO PROMO-RPT-DATA-VALUE       02132200
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02132300
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02132400
              PERFORM 9999-WRITE-ERROR-REPORT                           02132500
              SET PS-ERROR-FOUND     TO TRUE                            02132600
           END-IF.                                                      02132700
                                                                        02132800
036600     IF PM706-MDSE-LNE-ID NOT EQUAL XS019-MDSE-LNE-ID             02132900
              MOVE 'PM706-MDSE-LNE-ID' TO PROMO-RPT-DATA-NAME           02133000
              MOVE PM706-MDSE-LNE-ID   TO PROMO-RPT-DATA-VALUE          02133100
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02133200
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02133300
              PERFORM 9999-WRITE-ERROR-REPORT                           02133400
              MOVE 'XS019-MDSE-LNE-ID' TO PROMO-RPT-DATA-NAME           02133500
              MOVE XS019-MDSE-LNE-ID TO PROMO-RPT-DATA-VALUE            02133600
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02133700
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02133800
              PERFORM 9999-WRITE-ERROR-REPORT                           02133900
              SET PS-ERROR-FOUND     TO TRUE                            02134000
           END-IF.                                                      02135000
                                                                        02136000
036600     IF PM706-DEPT-NBR  NOT EQUAL XS019-DEPT-NBR                  02137000
              MOVE 'PM706-DEPT-NBR' TO PROMO-RPT-DATA-NAME              02138000
              MOVE PM706-DEPT-NBR   TO PROMO-RPT-DATA-VALUE             02139000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02140000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02150000
              PERFORM 9999-WRITE-ERROR-REPORT                           02160000
              MOVE 'XS019-DEPT-NBR' TO PROMO-RPT-DATA-NAME              02170000
              MOVE XS019-DEPT-NBR TO PROMO-RPT-DATA-VALUE               02180000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02190000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02200000
              PERFORM 9999-WRITE-ERROR-REPORT                           02210000
              SET PS-ERROR-FOUND     TO TRUE                            02220000
           END-IF.                                                      02220100
                                                                        02220200
036600     IF PM706-MAJ-CL-NBR NOT EQUAL XS019-MAJ-CL-NBR               02220300
              MOVE 'PM706-MAJ-CL-NBR' TO PROMO-RPT-DATA-NAME            02220400
              MOVE PM706-MAJ-CL-NBR   TO PROMO-RPT-DATA-VALUE           02220500
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02220600
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02220700
              PERFORM 9999-WRITE-ERROR-REPORT                           02220800
              MOVE 'XS019-MAJ-CL-NBR' TO PROMO-RPT-DATA-NAME            02220900
              MOVE XS019-MAJ-CL-NBR TO PROMO-RPT-DATA-VALUE             02221000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02221100
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02221200
              PERFORM 9999-WRITE-ERROR-REPORT                           02221300
              SET PS-ERROR-FOUND     TO TRUE                            02221400
           END-IF.                                                      02221500
                                                                        02221600
036600     IF PM706-SUB-CL-NBR NOT EQUAL XS019-SUB-CL-NBR               02221700
              MOVE 'PM706-SUB-CL-NBR' TO PROMO-RPT-DATA-NAME            02221800
              MOVE PM706-SUB-CL-NBR   TO PROMO-RPT-DATA-VALUE           02221900
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02222000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02222100
              PERFORM 9999-WRITE-ERROR-REPORT                           02222200
              MOVE 'XS019-SUB-CL-NBR' TO PROMO-RPT-DATA-NAME            02222300
              MOVE XS019-SUB-CL-NBR TO PROMO-RPT-DATA-VALUE             02222400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02222500
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02222600
              PERFORM 9999-WRITE-ERROR-REPORT                           02222700
              SET PS-ERROR-FOUND     TO TRUE                            02222800
           END-IF.                                                      02222900
                                                                        02223000
036600     IF PM706-STYLE-ID NOT EQUAL XS019-STYLE-ID                   02223200
P11215      IF PM706-STYLE-ID = 0                                       02223300
P11215         CONTINUE                                                 02223400
P11215      ELSE                                                        02223500
              MOVE 'PM706-STYLE-ID' TO PROMO-RPT-DATA-NAME              02223600
              MOVE PM706-STYLE-ID   TO PROMO-RPT-DATA-VALUE             02223700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02223800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02224000
              PERFORM 9999-WRITE-ERROR-REPORT                           02224100
              MOVE 'XS019-STYLE-ID' TO PROMO-RPT-DATA-NAME              02224200
              MOVE XS019-STYLE-ID TO PROMO-RPT-DATA-VALUE               02224300
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02224400
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02224500
              PERFORM 9999-WRITE-ERROR-REPORT                           02224600
              SET PS-ERROR-FOUND     TO TRUE                            02224700
P11215      END-IF                                                      02224800
           END-IF.                                                      02224900
                                                                        02225000
036600     IF PM706-SKU-NBR NOT EQUAL XS019-SKU-NBR                     02225200
              MOVE 'PM706-SKU-NBR' TO PROMO-RPT-DATA-NAME               02225300
              MOVE PM706-SKU-NBR   TO PROMO-RPT-DATA-VALUE              02225400
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02225500
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02225600
              PERFORM 9999-WRITE-ERROR-REPORT                           02225700
              MOVE 'XS019-SKU-NBR' TO PROMO-RPT-DATA-NAME               02225800
              MOVE XS019-SKU-NBR TO PROMO-RPT-DATA-VALUE                02225900
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02226000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02226100
              PERFORM 9999-WRITE-ERROR-REPORT                           02226200
              SET PS-ERROR-FOUND     TO TRUE                            02226300
           END-IF.                                                      02226400
                                                                        02226500
                                                                        02227900
036600     IF PM706-CLRNC-TYP-CDE NOT EQUAL XS019-CLRNC-TYP-CDE         02228000
              MOVE 'PM706-CLRNC-TYP-CDE' TO PROMO-RPT-DATA-NAME         02228100
              MOVE PM706-CLRNC-TYP-CDE   TO PROMO-RPT-DATA-VALUE        02228200
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02228300
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02228400
              PERFORM 9999-WRITE-ERROR-REPORT                           02228500
              MOVE 'XS019-CLRNC-TYP-CDE' TO PROMO-RPT-DATA-NAME         02228600
              MOVE XS019-CLRNC-TYP-CDE TO PROMO-RPT-DATA-VALUE          02228700
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02228800
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02228900
              PERFORM 9999-WRITE-ERROR-REPORT                           02229000
              SET PS-ERROR-FOUND     TO TRUE                            02229100
           END-IF.                                                      02229200
036600     IF PM706-PRICG-AMT NOT EQUAL XS019-PRICG-AMT                 02229300
              MOVE 'PM706-PRICG-AMT' TO PROMO-RPT-DATA-NAME             02229400
              MOVE PM706-PRICG-AMT   TO PROMO-RPT-DATA-VALUE            02229500
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02229600
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02229700
              PERFORM 9999-WRITE-ERROR-REPORT                           02229800
              MOVE 'XS019-PRICG-AMT' TO PROMO-RPT-DATA-NAME             02229900
              MOVE XS019-PRICG-AMT TO PROMO-RPT-DATA-VALUE              02230000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02230100
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02230200
              PERFORM 9999-WRITE-ERROR-REPORT                           02230300
              SET PS-ERROR-FOUND     TO TRUE                            02230400
           END-IF.                                                      02230500
                                                                        02230600
036600     IF PM706-GP-QTY NOT EQUAL XS019-GP-QTY                       02230700
              MOVE 'PM706-GP-QTY' TO PROMO-RPT-DATA-NAME                02230800
              MOVE PM706-GP-QTY      TO PROMO-RPT-DATA-VALUE            02230900
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02231000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02231100
              PERFORM 9999-WRITE-ERROR-REPORT                           02231200
              MOVE 'XS019-GP-QTY' TO PROMO-RPT-DATA-NAME                02231300
              MOVE XS019-GP-QTY TO PROMO-RPT-DATA-VALUE                 02231400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02231500
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02231600
              PERFORM 9999-WRITE-ERROR-REPORT                           02231700
              SET PS-ERROR-FOUND     TO TRUE                            02231800
           END-IF.                                                      02231900
                                                                        02232000
036600     IF PM706-GP-AMT NOT EQUAL XS019-GP-AMT                       02232100
              MOVE 'PM706-GP-AMT' TO PROMO-RPT-DATA-NAME                02232200
              MOVE PM706-GP-AMT      TO PROMO-RPT-DATA-VALUE            02232300
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02232400
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02232500
              PERFORM 9999-WRITE-ERROR-REPORT                           02232600
              MOVE 'XS019-GP-AMT' TO PROMO-RPT-DATA-NAME                02232700
              MOVE XS019-GP-AMT TO PROMO-RPT-DATA-VALUE                 02232800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02232900
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02233000
              PERFORM 9999-WRITE-ERROR-REPORT                           02233100
              SET PS-ERROR-FOUND     TO TRUE                            02233200
           END-IF.                                                      02233300
                                                                        02233400
036600     IF PM706-THRS-QTY NOT EQUAL XS019-THRS-QTY                   02233500
              MOVE 'PM706-THRS-QTY' TO PROMO-RPT-DATA-NAME              02233600
              MOVE PM706-THRS-QTY      TO PROMO-RPT-DATA-VALUE          02233700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02233800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02233900
              PERFORM 9999-WRITE-ERROR-REPORT                           02234000
              MOVE 'XS019-THRS-QTY' TO PROMO-RPT-DATA-NAME              02234100
              MOVE XS019-THRS-QTY TO PROMO-RPT-DATA-VALUE               02234200
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02234300
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02234400
              PERFORM 9999-WRITE-ERROR-REPORT                           02234500
              SET PS-ERROR-FOUND     TO TRUE                            02234600
           END-IF.                                                      02234700
                                                                        02234800
036600     IF PM706-THRS-AMT NOT EQUAL XS019-THRS-AMT                   02234900
              MOVE 'PM706-THRS-AMT' TO PROMO-RPT-DATA-NAME              02235000
              MOVE PM706-THRS-AMT      TO PROMO-RPT-DATA-VALUE          02235100
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02235200
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02235300
              PERFORM 9999-WRITE-ERROR-REPORT                           02235400
              MOVE 'XS019-THRS-AMT' TO PROMO-RPT-DATA-NAME              02235500
              MOVE XS019-THRS-AMT TO PROMO-RPT-DATA-VALUE               02235600
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02235700
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02235800
              PERFORM 9999-WRITE-ERROR-REPORT                           02235900
              SET PS-ERROR-FOUND     TO TRUE                            02236000
           END-IF.                                                      02236100
                                                                        02236200
036600     IF PM706-DISC-AMT NOT EQUAL XS019-DISC-AMT                   02236300
              MOVE 'PM706-DISC-AMT' TO PROMO-RPT-DATA-NAME              02236400
              MOVE PM706-DISC-AMT      TO PROMO-RPT-DATA-VALUE          02236500
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02236600
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02236700
              PERFORM 9999-WRITE-ERROR-REPORT                           02236800
              MOVE 'XS019-DISC-AMT' TO PROMO-RPT-DATA-NAME              02236900
              MOVE XS019-DISC-AMT TO PROMO-RPT-DATA-VALUE               02237000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02237100
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02237200
              PERFORM 9999-WRITE-ERROR-REPORT                           02237300
              SET PS-ERROR-FOUND     TO TRUE                            02237400
           END-IF.                                                      02237500
                                                                        02237600
036600     IF PM706-DISC-PCT NOT EQUAL XS019-DISC-PCT                   02237700
              MOVE 'PM706-DISC-PCT' TO PROMO-RPT-DATA-NAME              02237800
              MOVE PM706-DISC-PCT      TO PROMO-RPT-DATA-VALUE          02237900
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02238000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02238100
              PERFORM 9999-WRITE-ERROR-REPORT                           02238200
              MOVE 'XS019-DISC-PCT' TO PROMO-RPT-DATA-NAME              02238300
              MOVE XS019-DISC-PCT TO PROMO-RPT-DATA-VALUE               02238400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02238500
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02238600
              PERFORM 9999-WRITE-ERROR-REPORT                           02238700
              SET PS-ERROR-FOUND     TO TRUE                            02238800
           END-IF.                                                      02238900
                                                                        02239000
036600     IF PM706-RCPT-CMMT-TXT NOT EQUAL XS019-RCPT-CMMT-TXT         02239100
              MOVE 'PM706-RCPT-CMMT-TXT' TO PROMO-RPT-DATA-NAME         02239200
              MOVE PM706-RCPT-CMMT-TXT   TO PROMO-RPT-DATA-VALUE        02239300
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02239400
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02239500
              PERFORM 9999-WRITE-ERROR-REPORT                           02239600
              MOVE 'XS019-RCPT-CMMT-TXT' TO PROMO-RPT-DATA-NAME         02239700
              MOVE XS019-RCPT-CMMT-TXT   TO PROMO-RPT-DATA-VALUE        02239800
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02239900
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02240000
              PERFORM 9999-WRITE-ERROR-REPORT                           02240100
              SET PS-ERROR-FOUND     TO TRUE                            02240200
           END-IF.                                                      02240300
                                                                        02240400
036600     IF PM706-ASSN-LVL-CDE NOT EQUAL XS019-ASSN-LVL-CDE           02240500
              MOVE 'PM706-ASSN-LVL-CDE' TO PROMO-RPT-DATA-NAME          02240600
              MOVE PM706-ASSN-LVL-CDE   TO PROMO-RPT-DATA-VALUE         02240700
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02240800
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02240900
              PERFORM 9999-WRITE-ERROR-REPORT                           02241000
              MOVE 'XS019-ASSN-LVL-CDE' TO PROMO-RPT-DATA-NAME          02241100
              MOVE XS019-ASSN-LVL-CDE TO PROMO-RPT-DATA-VALUE           02241200
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02241300
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02241400
              PERFORM 9999-WRITE-ERROR-REPORT                           02241500
              SET PS-ERROR-FOUND     TO TRUE                            02241600
           END-IF.                                                      02241700
                                                                        02241800
036600     IF PM706-ESL-TOPR-TYP NOT EQUAL XS019-ESL-TOPR-TYP           02241900
              MOVE 'PM706-ESL-TOPR-TYP' TO PROMO-RPT-DATA-NAME          02242000
              MOVE PM706-ESL-TOPR-TYP   TO PROMO-RPT-DATA-VALUE         02242100
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02242200
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02242300
              PERFORM 9999-WRITE-ERROR-REPORT                           02242400
              MOVE 'XS019-ESL-TOPR-TYP' TO PROMO-RPT-DATA-NAME          02242500
              MOVE XS019-ESL-TOPR-TYP TO PROMO-RPT-DATA-VALUE           02242600
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02242700
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02242800
              PERFORM 9999-WRITE-ERROR-REPORT                           02242900
              SET PS-ERROR-FOUND     TO TRUE                            02243000
           END-IF.                                                      02243100
                                                                        02243200
036600     IF PM706-MDSE-HIER-CDE NOT EQUAL XS019-MDSE-HIER-CDE         02243300
              MOVE 'PM706-MDSE-HIER-CDE' TO PROMO-RPT-DATA-NAME         02243400
              MOVE PM706-MDSE-HIER-CDE   TO PROMO-RPT-DATA-VALUE        02243500
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02243600
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02243700
              PERFORM 9999-WRITE-ERROR-REPORT                           02243800
              MOVE 'XS019-MDSE-HIER-CDE' TO PROMO-RPT-DATA-NAME         02243900
              MOVE XS019-MDSE-HIER-CDE TO PROMO-RPT-DATA-VALUE          02244000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02244100
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02244200
              PERFORM 9999-WRITE-ERROR-REPORT                           02244300
              SET PS-ERROR-FOUND     TO TRUE                            02244400
           END-IF.                                                      02244500
                                                                        02244600
036600     IF PM706-STAT-CDE  NOT EQUAL XS019-STAT-CDE                  02244700
              MOVE 'PM706-STAT-CDE'   TO PROMO-RPT-DATA-NAME            02244800
              MOVE PM706-STAT-CDE           TO PROMO-RPT-DATA-VALUE     02244900
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              02245000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           02245100
              PERFORM 9999-WRITE-ERROR-REPORT                           02245200
              MOVE 'XS019-STAT-CDE'   TO PROMO-RPT-DATA-NAME            02245300
              MOVE XS019-STAT-CDE     TO PROMO-RPT-DATA-VALUE           02245400
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             02245500
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           02245600
              PERFORM 9999-WRITE-ERROR-REPORT                           02245700
              SET PS-ERROR-FOUND     TO TRUE                            02246000
           END-IF.                                                      02246100
                                                                        02246200
                                                                        02246300
           IF  PS-ERROR-FOUND                                           02246400
037200        IF PM706-LAST-UPD-TMST > XS019-LAST-UPD-TMST              02246500
                 PERFORM 9999-FORMAT-ERROR-RECORD                       02246600
                 PERFORM 9999-WRITE-ERROR-RECORD                        02246700
                 SET PS-ERROR-NOT-FOUND     TO TRUE                     02246800
              END-IF                                                    02246900
           END-IF.                                                      02247000
054500                                                                  02248000
056900 2100-EXIT.                                                       02249000
057000     EXIT.                                                        02250000
043600 EJECT.                                                           02260000
043610                                                                  02270000
                                                                        02280000
      ******************************************************************02290000
      **COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   02300000
      ******************************************************************02310000
       3000-PROCESS-EXTRA-RECORDS.                                      02320000
                                                                        02330000
           IF  PS-NOT-EOF-PROMO                                         02340000
               INITIALIZE REPORT-DETAIL                                 02350000
               MOVE PV-DOMAIN-NF            TO REPORT-NOTES             02360000
               MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY          02370000
               PERFORM 9999-WRITE-ERROR-REPORT                          02380000
               MOVE PM706-PRICING-RECORD TO ERROR-RECORD                02390000
               PERFORM 9999-WRITE-ERROR-RECORD                          02400000
               PERFORM 9999-READ-PROMO-EXTRACT                          02410000
           END-IF.                                                      02420000
                                                                        02430000
           IF  PS-NOT-EOF-DOMAIN                                        02440000
               INITIALIZE REPORT-DETAIL                                 02450000
               MOVE PV-PROMO-NF              TO REPORT-NOTES            02460000
               MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY          02470000
               PERFORM 9999-WRITE-ERROR-REPORT                          02480000
               MOVE XS019-PRICING-RECORD TO ERROR-RECORD                02490000
               PERFORM 9999-WRITE-ERROR-RECORD                          02500000
               PERFORM 9999-READ-DOMAIN-EXTRACT                         02510000
           END-IF.                                                      02520000
                                                                        02530000
056900 3000-EXIT.                                                       02540000
057000     EXIT.                                                        02550000
                                                                        02560000
       EJECT.                                                           02570000
059800*----------------------------------------------------------       02580000
059900* 9999-WRAPUP.                                                    02590000
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           02600000
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           02610000
059930*     PROGRAM.                                                    02620000
060000*----------------------------------------------------------       02630000
060100 9999-WRAPUP.                                                     02640000
026600     CLOSE PROMO-EXTRACT-FILE                                     02650000
026600           DOMAIN-EXTRACT-FILE                                    02660000
026600           ERROR-FILE                                             02670000
026600           REPORT-FILE.                                           02680000
                                                                        02690000
           IF  PC-ERROR-RECORD-WRITTEN > 0                              02700000
               MOVE 04               TO RETURN-CODE                     02710000
           END-IF.                                                      02720000
                                                                        02730000
                                                                        02740000
060500                                                                  02750000
060710*9999-EXIT.                                                       02760000
060800 EJECT.                                                           02770000
      ***************************************************************** 02780000
      **FORMAT ERROR-RECORD                                             02790000
      ***************************************************************** 02800000
       9999-FORMAT-ERROR-RECORD.                                        02810000
           MOVE PM706-PRICING-RECORD TO ERROR-RECORD.                   02820000
                                                                        02830000
       EJECT.                                                           02840000
      ***************************************************************** 02850000
      **READ PROMO  EXTRACT FILE                                        02860000
      ***************************************************************** 02870000
       9999-READ-PROMO-EXTRACT.                                         02880000
           IF  PS-NOT-EOF-PROMO                                         02890000
               READ PROMO-EXTRACT-FILE INTO PM706-PRICING-RECORD        02900000
                    AT END                                              02910000
                       SET PS-EOF-PROMO TO TRUE                         02920000
               END-READ                                                 02930000
           END-IF.                                                      02940000
                                                                        02950000
           IF  PS-NOT-EOF-PROMO                                         02960000
               ADD +1                  TO PC-PROMO-EXTRACT-RECS-READ    02970000
               MOVE PM706-PROMO-INTFC-ID   TO PV-PM-PROMO-INTFC-ID      02980000
               MOVE PM706-MDSE-LNE-ID      TO PV-PM-MDSE-LNE-ID         02990000
               MOVE PM706-PROMO-INTFC-SUB-ID     TO PV-PM-INTFC-SUB-ID  03000000
           END-IF.                                                      03010000
                                                                        03020000
       EJECT.                                                           03030000
      ***************************************************************** 03040000
      **READ XS EXTRACT FILE                                            03050000
      ***************************************************************** 03060000
       9999-READ-DOMAIN-EXTRACT.                                        03070000
           IF  PS-NOT-EOF-DOMAIN                                        03080000
               READ DOMAIN-EXTRACT-FILE INTO XS019-PRICING-RECORD       03090000
                    AT END                                              03100000
                       SET PS-EOF-DOMAIN TO TRUE                        03110000
               END-READ                                                 03120000
           END-IF.                                                      03130000
                                                                        03140000
           IF  PS-NOT-EOF-DOMAIN                                        03150000
               ADD +1              TO PC-DOMAIN-EXTRACT-RECS-READ       03160000
               MOVE XS019-PROMO-INTFC-ID  TO PV-XS-PROMO-INTFC-ID       03170000
               MOVE XS019-MDSE-LNE-ID     TO PV-XS-MDSE-LNE-ID          03180000
               MOVE XS019-PROMO-INTFC-SUB-ID    TO PV-XS-INTFC-SUB-ID   03190000
           END-IF.                                                      03200000
                                                                        03210000
       EJECT.                                                           03220000
      ***************************************************************** 03230000
      **READ CONTROL CARD FOR FREQUENCY OF COMPARE                      03240000
      ***************************************************************** 03250000
       9999-READ-CONTROL-CARD.                                          03260000
                                                                        03270000
           READ CONTROL-CARD INTO CONTROL-CARD-LAYOUT.                  03280000
                                                                        03290000
       EJECT.                                                           03300000
      ***************************************************************** 03310000
      **WRITE ERROR RECORD                                              03320000
      ***************************************************************** 03330000
       9999-WRITE-ERROR-RECORD.                                         03340000
           WRITE DIFFERENCES-RECORD FROM ERROR-RECORD.                  03350000
           ADD +1  TO PC-ERROR-RECORD-WRITTEN.                          03360000
       EJECT.                                                           03370000
      ***************************************************************** 03380000
      **WRITE ERROR REPORT                                              03390000
      ***************************************************************** 03400000
       9999-WRITE-ERROR-REPORT.                                         03410000
           IF PC-ERROR-REPORT-WRITTEN > 66                              03420000
C75493        WRITE REPORT-RECORD FROM REPORT-DETAIL                    03421020
C75493        INITIALIZE REPORT-DETAIL                                  03422020
C75493        ADD +1 TO PC-ERROR-REPORT-WRITTEN                         03423020
              PERFORM 9999-PRINT-HEADINGS                               03430000
           ELSE                                                         03440000
              WRITE REPORT-RECORD FROM REPORT-DETAIL                    03450000
              INITIALIZE REPORT-DETAIL                                  03460000
              ADD +1 TO PC-ERROR-REPORT-WRITTEN                         03470000
           END-IF.                                                      03480000
                                                                        03490000
       EJECT.                                                           03500000
      ***************************************************************** 03510000
      **PRINT HEADINGS                                                  03520000
      ***************************************************************** 03530000
       9999-PRINT-HEADINGS.                                             03540000
           ADD 1 TO PC-PAGE-CNT.                                        03550000
           MOVE PC-PAGE-CNT TO DP132O-PAGE-NUMBER.                      03560000
           MOVE ZEROS TO PC-ERROR-REPORT-WRITTEN.                       03570000
                                                                        03580000
491700     WRITE REPORT-RECORD                                          03590000
491800         FROM DP132O-STANDRD-HEADER-132-COLS                      03600000
491900         AFTER ADVANCING PAGE.                                    03610000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03620000
                                                                        03630000
491700     WRITE REPORT-RECORD                                          03640000
491800         FROM DR-HEAD2                                            03650000
491900         AFTER ADVANCING 1 LINE.                                  03660000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03670000
                                                                        03680000
491700     WRITE REPORT-RECORD                                          03690000
491800         FROM DR-HEAD3                                            03700000
491900         AFTER ADVANCING 2 LINE.                                  03710000
           ADD +2                       TO PC-ERROR-REPORT-WRITTEN.     03720000
                                                                        03730000
491700     WRITE REPORT-RECORD                                          03740000
491800         FROM DR-HEAD5                                            03750000
491900         AFTER ADVANCING 1 LINE.                                  03760000
                                                                        03770000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     03780000
                                                                        03790000
       EJECT.                                                           03800000
