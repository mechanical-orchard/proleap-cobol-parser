000100***************************************************************** 00010058
000200 IDENTIFICATION DIVISION.                                         00020058
000300***************************************************************** 00030058
000400                                                                  00040058
000500 PROGRAM-ID.             SUKRP013.                                00050058
000600 AUTHOR.                 DAN HINTZ.                               00060058
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070058
000800 DATE-WRITTEN            SEPTEMBER 1997.                          00080058
000900 DATE-COMPILED.                                                   00090058
001000***************************************************************** 00100058
001100***************************************************************** 00110058
001200*  THIS PROGRAM WILL CREATE THE LISTING OF PO/RECEIVERS FOR AN  * 00120058
001300*  AUDIT CONTROL NUMBER.  IT IS PRODUCED FOLLOWING THE AUDIT OF * 00130058
001400*  SELECTED PO/RECEIVERS IN A CARTON WHICH IS DONE USING LRT    * 00140058
001500*  TERMINALS.                                                   * 00150058
001600***************************************************************** 00160058
001700*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00170058
001800*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00180058
001900*                                                               * 00190058
001700*  CHANGED 10/13/14 BY CHERI PARMLEY                            * 00170058
001800*   CHG#0094517 EXPANDED PO# FROM 7 TO 8 DIGITS                 * 00180058
002000***************************************************************** 00200058
002100***************************************************************** 00210058
002200 ENVIRONMENT DIVISION.                                            00220058
002300***************************************************************** 00230058
002400                                                                  00240058
002500 CONFIGURATION SECTION.                                           00250058
002600                                                                  00260058
002700 SOURCE-COMPUTER.        IBM-3090.                                00270058
002800 OBJECT-COMPUTER.        IBM-3090.                                00280058
002900                                                                  00290058
003000 INPUT-OUTPUT SECTION.                                            00300058
003100                                                                  00310058
003200 FILE-CONTROL.                                                    00320058
003300*                                                                 00330058
003400     SELECT PRINT-CONTROL-FILE                                    00340058
003500         ASSIGN TO PRTIN.                                         00350058
003600                                                                  00360058
003700     SELECT CARTON-FILE                                           00370058
003800         ASSIGN TO INP01.                                         00380058
003900                                                                  00390058
004000     SELECT RECEIVER-FILE                                         00400058
004100         ASSIGN TO INP02.                                         00410058
004200                                                                  00420058
004300     SELECT SU-CARTON-AUDIT-RPT-FILE                              00430058
004400         ASSIGN TO RPT01.                                         00440058
004200                                                                  00420058
      * 03/07/14 DRW BEG                                                        
           SELECT CARDIN-AUDIT-NBR-FILE                                         
               ASSIGN TO CARDIN.                                                
      * 03/07/14 DRW END                                                        
004500*                                                                 00450058
004600***************************************************************** 00460058
004700 DATA DIVISION.                                                   00470058
004800***************************************************************** 00480058
004900*                                                                 00490058
005000 FILE SECTION.                                                    00500058
      *                                                                         
       FD  CARDIN-AUDIT-NBR-FILE                                                
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 80 CHARACTERS.                                       
       01  CC-RECORD                       PIC X(80).                           
                                                                                
005100*                                                                 00510058
005200 FD  CARTON-FILE                                                  00520058
005300     RECORDING MODE IS F                                          00530058
005400     BLOCK CONTAINS 0  RECORDS.                                   00540058
005500 01  CARTON-RECORD                   PIC  X(200).                 00550058
005600*                                                                 00560058
005700*                                                                 00570058
005800 FD  RECEIVER-FILE                                                00580058
005900     RECORDING MODE IS F                                          00590058
006000     BLOCK CONTAINS 0  RECORDS.                                   00600058
006100 01  RECEIVER-RECORD                 PIC  X(200).                 00610058
006200*                                                                 00620058
006300*                                                                 00630058
006400 FD  SU-CARTON-AUDIT-RPT-FILE                                     00640058
006500     RECORDING MODE IS F                                          00650058
006600     BLOCK CONTAINS 0  RECORDS.                                   00660058
006700 01  SU-CARTON-AUDIT-RPT-RECORD      PIC  X(132).                 00670058
006800*                                                                 00680058
006900 FD  PRINT-CONTROL-FILE                                           00690058
007000     RECORDING MODE IS F                                          00700058
007100     BLOCK CONTAINS 0  RECORDS.                                   00710058
007200 01  PRINT-CONTROL-CARD              PIC  X(080).                 00720058
007300*                                                                 00730058
007400                                                                  00740058
007500 WORKING-STORAGE SECTION.                                         00750058
007600*                                                                 00760058
007700 01  PROGRAM-SWITCHES.                                            00770058
      * 03/07/14 DRW BEG                                                        
           05  PS-MANUAL-COMBO-SW          PIC  X(01)    VALUE 'N'.             
               88  PS-MANUAL-COMBO-AUDIT                 VALUE 'Y'.             
               88  PS-NOT-MANUAL-COMBO-AUDIT             VALUE 'N'.             
           05  PS-END-OF-CARDIN-SW         PIC  X(01)    VALUE 'N'.             
               88  PS-END-OF-CARDIN-FILE                 VALUE 'Y'.             
               88  PS-NOT-END-OF-CARDIN-FILE             VALUE 'N'.             
      * 03/07/14 DRW END                                                        
007800     05  PS-END-OF-CARTON-FILE-SW    PIC  X(01)    VALUE 'N'.     00780058
007900         88  PS-END-OF-CARTON-FILE                 VALUE 'Y'.     00790058
008000         88  PS-NOT-END-OF-CARTON-FILE             VALUE 'N'.     00800058
008100     05  PS-END-OF-RECEIVER-FILE-SW  PIC  X(01)    VALUE 'N'.     00810058
008200         88  PS-END-OF-RECEIVER-FILE               VALUE 'Y'.     00820058
008300         88  PS-NOT-END-OF-RECEIVER-FILE           VALUE 'N'.     00830058
008400     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00840058
008500         88  PS-FIRST-TIME                         VALUE 'Y'.     00850058
008600         88  PS-NOT-FIRST-TIME                     VALUE 'N'.     00860058
008700     05  PS-ERROR-FOUND-SW           PIC  X(01)    VALUE 'N'.     00870058
008800         88  PS-ERROR-FOUND                        VALUE 'Y'.     00880058
008900         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00890058
009000     05  PS-RECEIVER-ERROR-SW        PIC  X(01)    VALUE 'N'.     00900058
009100         88  PS-RECEIVER-ERROR                     VALUE 'Y'.     00910058
009200         88  PS-NO-RECEIVER-ERROR                  VALUE 'N'.     00920058
009300     05  PS-DATA-TO-REPORT-SW        PIC  X(01)    VALUE 'N'.     00930058
009400         88  NO-DATA-TO-REPORT                     VALUE 'Y'.     00940058
009500         88  DATA-TO-REPORT                        VALUE 'N'.     00950058
009600*                                                                 00960058
009700 01  PC-CONSTANTS.                                                00970058
009800     05  PC-1                        PIC S9(03)    VALUE +1       00980058
009900                                                   COMP-3.        00990058
010000     05  PC-2                        PIC S9(03)    VALUE +2       01000058
010100                                                   COMP-3.        01010058
010200     05  PC-3                        PIC S9(03)    VALUE +3       01020058
010300                                                   COMP-3.        01030058
010400     05  PC-7                        PIC S9(01)    VALUE +7.      01040058
010500     05  PC-15                       PIC S9(03)    VALUE +15      01050058
010600                                                   COMP-3.        01060058
010700     05  PC-60                       PIC S9(03)    VALUE +60      01070058
010800                                                   COMP-3.        01080058
010900     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01090058
011000     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01100058
011100     05  PC-00                       PIC  X(02)    VALUE '00'.    01110058
011200     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    01120058
011300     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     01130058
011400     05  PC-SUKRP013                 PIC  X(08)    VALUE          01140058
011500         'SUKRP013'.                                              01150058
011600     05  PC-100-PCT-CHECK            PIC  X(10)    VALUE          01160058
011700         '100% CHECK'.                                            01170058
011800     05  PC-SPOT-CHECK               PIC  X(10)    VALUE          01180058
011900         'SPOT CHECK'.                                            01190058
012000     05  PC-REWORK                   PIC  X(10)    VALUE          01200058
012100         'REWORK    '.                                            01210058
012200     05  PC-IN-PROCESS               PIC  X(10)    VALUE          01220058
012300         'IN PROCESS'.                                            01230058
012400     05  PC-COMPLETE                 PIC  X(10)    VALUE          01240058
012500         '  COMPLETE'.                                            01250058
012600     05  PC-POSTPONED                PIC  X(10)    VALUE          01260058
012700         ' POSTPONED'.                                            01270058
012800     05  PC-UNKNOWN                  PIC  X(10)    VALUE          01280058
012900         'UNKNOWN   '.                                            01290058
013000     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          01300058
013100         '9999-09-09-09.09.09.999999'.                            01310058
013200     05  PC-OVER-SHORT-MSG           PIC  X(28)    VALUE          01320058
013300         'RCVR LEVEL OVER/SHORT EXISTS'.                          01330058
013400     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01340058
013500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01350058
           05  PC-RFID                     PIC  X(04)    VALUE 'RFID'.          
           05  PC-QC                       PIC  X(02)    VALUE 'QC'.            
013600*                                                                 01360058
013700 01  PV-MISC-FIELDS.                                              01370058
013800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01380058
013900                                                   COMP-3.        01390058
014000     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01400058
014100                                                   COMP-3.        01410058
014200     05  PV-ERROR-COUNT              PIC S9(04)    VALUE ZERO     01420058
014300                                                   COMP SYNC.     01430058
014400     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     01440058
014500                                                   COMP SYNC.     01450058
014600     05  PV-EXPTED-QTY               PIC S9(04)    VALUE ZERO     01460058
014700                                                   COMP SYNC.     01470058
014800     05  PV-AUDIT-DURATION-TIME      PIC S9(09)    VALUE ZERO     01480058
014900                                                   COMP SYNC.     01490058
015000     05  PV-AUDIT-DURATION-HOURS     PIC S9(09)    VALUE ZERO     01500058
015100                                                   COMP SYNC.     01510058
015200     05  PV-AUDIT-DURATION-MINUTES   PIC S9(09)    VALUE ZERO     01520058
015300                                                   COMP SYNC.     01530058
015400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01540058
015500                                                   COMP SYNC.     01550058
015600     05  PV-CARTONS-IN-ERROR         PIC S9(09)    VALUE ZERO     01560058
015700                                                   COMP SYNC.     01570058
015800     05  PV-CARTONS-IN-AUDIT         PIC S9(09)    VALUE ZERO     01580058
015900                                                   COMP SYNC.     01590058
016000     05  PV-CURR-SHIPT-UNT-ID        PIC S9(18)    VALUE ZERO     01600058
016100                                                   COMP-3.        01610058
016200     05  PV-PCT-CTNS-IN-ERROR        PIC S9(03)V9(4) VALUE ZERO   01620058
016300                                                   COMP-3.        01630058
016400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01640058
016500     05  PV-AUD-CNTL-NBR             PIC  9(09)    VALUE ZERO.    01650058
016600     05  PV-OPER-UNT-ID              PIC  9(04)    VALUE ZERO.    01660058
016700     05  PV-PO-RECEIVER.                                          01670058
      *CLP 10/13/14 START                                                       
016800         10  PV-PO                   PIC  ZZZZZZZ9  VALUE ZERO.   01680058
016900         10  FILLER                  PIC  X(01)    VALUE '-'.     01690058
017000         10  PV-RECEIVER             PIC  9(04)    VALUE ZERO.    01700058
017100     05  PV-CURR-PO-RECEIVER.                                     01710058
017200         10  PV-CURR-PO-NBR          PIC  ZZZZZZZ9  VALUE ZERO.   01720058
017300         10  PV-CURR-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01730058
017400     05  PV-PREV-PO-RECEIVER.                                     01740058
017500         10  PV-PREV-PO-NBR          PIC  ZZZZZZZ9  VALUE ZERO.   01750058
017600         10  PV-PREV-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01760058
017700     05  PV-KEY-PO-RECEIVER.                                      01770058
017800         10  PV-KEY-PO-NBR           PIC  ZZZZZZZ9  VALUE ZERO.   01780058
017900         10  PV-KEY-REC-SEQ-NBR      PIC  9(04)    VALUE ZERO.    01790058
018000     05  PV-TODAYS-DATE.                                          01800058
      *CLP 10/13/14 END                                                         
018100         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01810058
018200         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01820058
018300         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01830058
018400     05  PV-TODAYS-TIME.                                          01840058
018500         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01850058
018600         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01860058
018700         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01870058
018800         10  FILLER                  PIC  9(02)    VALUE ZERO.    01880058
018900     05  PV-DB2-DATE.                                             01890058
019000         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01900058
019100         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    01910058
019200         10  FILLER                  PIC  X(01)    VALUE ZERO.    01920058
019300         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    01930058
019400         10  FILLER                  PIC  X(01)    VALUE ZERO.    01940058
019500         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    01950058
019600     05  PV-DB2-TMST.                                             01960058
019700         10 PV-DB2-TMST-CCYY          PIC  9(04).                 01970058
019800         10 FILLER                    PIC  X(01).                 01980058
019900         10 PV-DB2-TMST-MM            PIC  9(02).                 01990058
020000         10 FILLER                    PIC  X(01).                 02000058
020100         10 PV-DB2-TMST-DD            PIC  9(02).                 02010058
020200         10 FILLER                    PIC  X(01).                 02020058
020300         10 PV-DB2-TMST-HH            PIC  9(02).                 02030058
020400         10 FILLER                    PIC  X(01).                 02040058
020500         10 PV-DB2-TMST-MN            PIC  9(02).                 02050058
020600         10 FILLER                    PIC  X(01).                 02060058
020700         10 PV-DB2-TMST-SS            PIC  9(02).                 02070058
020800         10 FILLER                    PIC  X(07).                 02080058
020900     05  PV-FORMAT-DATE.                                          02090058
021000         10 PV-FORMAT-DATE-MM         PIC  9(02).                 02100058
021100         10 FILLER                    PIC  X(01) VALUE '/'.       02110058
021200         10 PV-FORMAT-DATE-DD         PIC  9(02).                 02120058
021300         10 FILLER                    PIC  X(01) VALUE '/'.       02130058
021400         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 02140058
021500     05  PV-FORMAT-TIME.                                          02150058
021600         10 PV-FORMAT-TIME-HH         PIC  9(02).                 02160058
021700         10 FILLER                    PIC  X(01) VALUE ':'.       02170058
021800         10 PV-FORMAT-TIME-MN         PIC  9(02).                 02180058
021900*                                                                 02190058
022000******************************************************************02200058
022100* COPY BOOK CONTAINING THE LAYOUT OF THE CARTON LEVEL AUDIT       02210058
022200* EXTRACT FILE                                                    02220058
022300******************************************************************02230058
022400 01  SU003-COPYBOOK.                                              02240058
022500     COPY SURD003.                                                02250058
022600                                                                  02260058
022700******************************************************************02270058
022800* COPY BOOK CONTAINING THE LAYOUT OF THE RECEIVER LEVEL AUDIT     02280058
022900* EXTRACT FILE                                                    02290058
023000******************************************************************02300058
023100 01  SU004-COPYBOOK.                                              02310058
023200     COPY SURD004.                                                02320058
      ******************************************************************        
      *  NUMERIC EDIT ROUTINE COMMAREA                                          
      ******************************************************************        
           COPY DPWS010I.                                                       
023300/                                                                 02330058
023400*  LOGISTICS DOMAIN LOCATION MODULE                               00010000
023500*                                                                 00020000
023600     COPY XLWS071.                                                00030000
023700/                                                                 02330058
023800******************************************************************02340058
023900* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     02350058
024000******************************************************************02360058
024100     COPY DSWS004.                                                02370058
024200                                                                  02380058
024300******************************************************************02390058
024400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02400058
024500******************************************************************02410058
024600     COPY DPWS132O.                                               02420058
024700*                                                                 02430058
024800*                                                                 02440058
024900 01  HEADING-LINES.                                               02450058
025000     05  HEADING-LINE-0.                                          02460058
025100         10  FILLER                  PIC  X(52)    VALUE SPACES.  02470058
025200         10  FILLER                  PIC  X(28)    VALUE          02480058
025300             'VENDOR ACCURACY CARTON AUDIT'.                      02490058
025400         10  FILLER                  PIC  X(52)    VALUE SPACES.  02500058
025500*                                                                 02510058
025600     05  HEADING-LINE-1.                                          02520058
025700         10  FILLER                  PIC  X(40)    VALUE SPACES.  02530058
025800         10  FILLER                  PIC  X(28)    VALUE          02540058
025900             'LISTING OF PO/RECEIVERS FOR '.                      02550058
026000         10  FILLER                  PIC  X(23)    VALUE          02560058
026100             'AN AUDIT CONTROL NUMBER'.                           02570058
026200         10  FILLER                  PIC  X(41)    VALUE SPACES.  02580058
026300*                                                                 02590058
026400     05  HEADING-LINE-2.                                          02600058
026500         10  FILLER                  PIC  X(03)    VALUE SPACE.   02610058
026600         10  FILLER                  PIC  X(23)    VALUE          02620058
026700             'AUDIT CONTROL NUMBER:  '.                           02630058
026800         10  HL2-AUD-CNTL-NBR        PIC  X(10)    VALUE SPACES.  02640058
026900         10  FILLER                  PIC  X(08)    VALUE SPACE.   02650058
027000         10  FILLER                  PIC  X(18)    VALUE          02660058
027100             'AUDIT TYPE:       '.                                02670058
027200         10  HL2-AUDIT-TYPE          PIC  X(10)    VALUE SPACES.  02680058
027300         10  FILLER                  PIC  X(18)    VALUE SPACE.   02690058
027400         10  FILLER                  PIC  X(21)    VALUE          02700058
027500             'AUDIT STATUS:        '.                             02710058
027600         10  HL2-AUDIT-STATUS        PIC  X(10)    VALUE SPACES.  02720058
027700         10  FILLER                  PIC  X(11)    VALUE SPACES.  02730058
027800*                                                                 02740058
027900     05  HEADING-LINE-3.                                          02750058
028000         10  FILLER                  PIC  X(03)    VALUE SPACES.  02760058
028100         10  FILLER                  PIC  X(18)    VALUE          02770058
028200             'AUDIT START:      '.                                02780058
028300         10  HL3-AUDIT-START-DATE.                                02790058
028400             15  HL3-AUDIT-START-DATE-MM                          02800058
028500                                     PIC  X(02)    VALUE SPACES.  02810058
028600             15  FILLER              PIC  X(01)    VALUE '/'.     02820058
028700             15  HL3-AUDIT-START-DATE-DD                          02830058
028800                                     PIC  X(02)    VALUE SPACES.  02840058
028900             15  FILLER              PIC  X(01)    VALUE '/'.     02850058
029000             15  HL3-AUDIT-START-DATE-CCYY                        02860058
029100                                     PIC  X(04)    VALUE SPACES.  02870058
029200         10  FILLER                  PIC  X(02)    VALUE SPACES.  02880058
029300         10  HL3-AUDIT-START-TIME.                                02890058
029400             15  HL3-AUDIT-START-TIME-HH                          02900058
029500                                     PIC  X(02)    VALUE SPACES.  02910058
029600             15  FILLER              PIC  X(01)    VALUE ':'.     02920058
029700             15  HL3-AUDIT-START-TIME-MN                          02930058
029800                                     PIC  X(02)    VALUE SPACES.  02940058
029900         10  FILLER                  PIC  X(06)    VALUE SPACES.  02950058
030000         10  FILLER                  PIC  X(18)    VALUE          02960058
030100             'AUDIT STOP:       '.                                02970058
030200         10  HL3-AUDIT-STOP-DATE.                                 02980058
030300             15  HL3-AUDIT-STOP-DATE-MM                           02990058
030400                                     PIC  X(02)    VALUE SPACES.  03000058
030500             15  FILLER              PIC  X(01)    VALUE '/'.     03010058
030600             15  HL3-AUDIT-STOP-DATE-DD                           03020058
030700                                     PIC  X(02)    VALUE SPACES.  03030058
030800             15  FILLER              PIC  X(01)    VALUE '/'.     03040058
030900             15  HL3-AUDIT-STOP-DATE-CCYY                         03050058
031000                                     PIC  X(04)    VALUE SPACES.  03060058
031100         10  FILLER                  PIC  X(02)    VALUE SPACES.  03070058
031200         10  HL3-AUDIT-STOP-TIME.                                 03080058
031300             15  HL3-AUDIT-STOP-TIME-HH                           03090058
031400                                     PIC  X(02)    VALUE SPACES.  03100058
031500             15  FILLER              PIC  X(01)    VALUE ':'.     03110058
031600             15  HL3-AUDIT-STOP-TIME-MN                           03120058
031700                                     PIC  X(02)    VALUE SPACES.  03130058
031800         10  FILLER                  PIC  X(11)    VALUE SPACES.  03140058
031900         10  FILLER                  PIC  X(25)    VALUE          03150058
032000             'AUDIT DURATION (HH:MM):  '.                         03160058
032100         10  HL3-AUDIT-DURATION.                                  03170058
032200             15  HL3-AUDIT-DURATION-HH                            03180058
032300                                     PIC  ZZ9      VALUE ZEROES.  03190058
032400             15  FILLER              PIC  X(01)    VALUE ':'.     03200058
032500             15  HL3-AUDIT-DURATION-MM                            03210058
032600                                     PIC  9(02)    VALUE ZEROES.  03220058
032700         10  FILLER                  PIC  X(11)    VALUE SPACES.  03230058
032800*                                                                 03240058
      * 03/07/14 DRW BEG                                                        
027900     05  HEADING-LINE-3P5.                                        02750058
028000         10  FILLER                  PIC  X(03)    VALUE SPACES.  02760058
028100         10  FILLER                  PIC  X(23)    VALUE          02770058
                   'AUDIT CATEGORY:        '.                                   
               10  HL3P5-AUDIT-CATEGORY    PIC  X(04).                          
               10  FILLER                  PIC  X(102)   VALUE SPACES.          
      * 03/07/14 DRW END                                                        
032800*                                                                 03240058
032900     05  HEADING-LINE-4.                                          03250058
033000         10  FILLER                  PIC  X(03)    VALUE SPACES.  03260058
033100         10  FILLER                  PIC  X(11)    VALUE          03270058
033200             'FACILITY:  '.                                       03280058
033300         10  HL4-AUDIT-FCLTY-PRINT.                               03290058
033400             15  HL4-AUDIT-FCLTY-ID  PIC  X(04)    VALUE SPACES.  03300058
033500             15  FILLER              PIC  X(03)    VALUE ' - '.   03310058
033600             15  HL4-AUDIT-FCLTY-NAME                             03320058
033700                                     PIC  X(25)    VALUE SPACES.  03330058
033800         10  FILLER                  PIC  X(02)    VALUE SPACES.  03340058
033900         10  FILLER                  PIC  X(24)    VALUE          03350058
034000             'AUDIT PROCESS AREA:     '.                          03360058
034100         10  HL4-AUDIT-PRC-AREA      PIC  X(06)    VALUE SPACES.  03370058
034200         10  FILLER                  PIC  X(55)    VALUE SPACES.  03380058
034300*                                                                 03390058
034400     05  HEADING-LINE-5.                                          03400058
034500         10  FILLER                  PIC  X(39)    VALUE SPACES.  03410058
034600         10  FILLER                  PIC  X(07)    VALUE          03420058
034700             'RECEIPT'.                                           03430058
034800         10  FILLER                  PIC  X(18)    VALUE SPACES.  03440058
034900         10  FILLER                  PIC  X(03)    VALUE          03450058
035000             'ADJ'.                                               03460058
035100         10  FILLER                  PIC  X(05)    VALUE SPACES.  03470058
035200         10  FILLER                  PIC  X(07)    VALUE          03480058
035300             'AUDITED'.                                           03490058
035400         10  FILLER                  PIC  X(04)    VALUE SPACES.  03500058
035500         10  FILLER                  PIC  X(04)    VALUE          03510058
035600             'CART'.                                              03520058
035700         10  FILLER                  PIC  X(05)    VALUE SPACES.  03530058
035800         10  FILLER                  PIC  X(07)    VALUE          03540058
035900             'PERCENT'.                                           03550058
036000         10  FILLER                  PIC  X(33)    VALUE SPACES.  03560058
036100*                                                                 03570058
036200     05  HEADING-LINE-6.                                          03580058
036300         10  FILLER                  PIC  X(04)    VALUE SPACES.  03590058
036400         10  FILLER                  PIC  X(11)    VALUE          03600058
036500             'PO/RECEIVER'.                                       03610058
036600         10  FILLER                  PIC  X(02)    VALUE SPACES.  03620058
036700         10  FILLER                  PIC  X(11)    VALUE          03630058
036800             'VENDOR NAME'.                                       03640058
036900         10  FILLER                  PIC  X(11)    VALUE SPACES.  03650058
037000         10  FILLER                  PIC  X(04)    VALUE          03660058
037100             'DATE'.                                              03670058
037200         10  FILLER                  PIC  X(08)    VALUE SPACES.  03680058
037300         10  FILLER                  PIC  X(08)    VALUE          03690058
037400             'CART CNT'.                                          03700058
037500         10  FILLER                  PIC  X(02)    VALUE SPACES.  03710058
037600         10  FILLER                  PIC  X(08)    VALUE          03720058
037700             'CART CNT'.                                          03730058
037800         10  FILLER                  PIC  X(02)    VALUE SPACES.  03740058
037900         10  FILLER                  PIC  X(08)    VALUE          03750058
038000             'CART CNT'.                                          03760058
038100         10  FILLER                  PIC  X(02)    VALUE SPACES.  03770058
038200         10  FILLER                  PIC  X(08)    VALUE          03780058
038300             'IN ERROR'.                                          03790058
038400         10  FILLER                  PIC  X(02)    VALUE SPACES.  03800058
038500         10  FILLER                  PIC  X(08)    VALUE          03810058
038600             'IN ERROR'.                                          03820058
038700         10  FILLER                  PIC  X(03)    VALUE SPACES.  03830058
038800         10  FILLER                  PIC  X(07)    VALUE          03840058
038900             'MESSAGE'.                                           03850058
039000         10  FILLER                  PIC  X(24)    VALUE SPACES.  03860058
039100*                                                                 03870058
039200*                                                                 03880058
039300 01  MISCELLANEOUS-LINES.                                         03890058
039400     05  NO-DATA-LINE.                                            03900058
039500         10  FILLER                  PIC  X(44)    VALUE SPACES.  03910058
039600         10  FILLER                  PIC  X(46)    VALUE          03920058
039700             '**** NO INFORMATION EXISTS FOR THIS AUDIT ****'.    03930058
039800         10  FILLER                  PIC  X(43)    VALUE SPACES.  03940058
039900     05  END-OF-REPORT-LINE.                                      03950058
040000         10  FILLER                  PIC  X(44)    VALUE SPACES.  03960058
040100         10  FILLER                  PIC  X(45)    VALUE          03970058
040200             '*******   E N D   O F   R E P O R T   *******'.     03980058
040300         10  FILLER                  PIC  X(43)    VALUE SPACES.  03990058
040400*                                                                 04000058
040500 01  DETAIL-LINES.                                                04010058
040600     05  DETAIL-LINE1.                                            04020058
040700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04030058
      *CLP 10/13/14 START                                                       
040800         10  DL1-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  04040058
040900         10  FILLER                  PIC  X(01)    VALUE SPACES.  04050058
      *CLP 10/13/14 END                                                         
041000         10  DL1-VENDOR-NAME         PIC  X(20)    VALUE SPACES.  04060058
041100         10  FILLER                  PIC  X(02)    VALUE SPACES.  04070058
041200         10  DL1-DATE-RCVD.                                       04080058
041300             15  DL1-DATE-RCVD-MM    PIC  X(02)    VALUE SPACES.  04090058
041400             15  FILLER              PIC  X(01)    VALUE '/'.     04100058
041500             15  DL1-DATE-RCVD-DD    PIC  X(02)    VALUE SPACES.  04110058
041600             15  FILLER              PIC  X(01)    VALUE '/'.     04120058
041700             15  DL1-DATE-RCVD-CCYY  PIC  X(04)    VALUE SPACES.  04130058
041800         10  FILLER                  PIC  X(03)    VALUE SPACES.  04140058
041900         10  DL1-EXPTED-CART-CNT     PIC  ZZZZZZ9  VALUE ZEROES.  04150058
042000         10  FILLER                  PIC  X(03)    VALUE SPACES.  04160058
042100         10  DL1-ADJ-CART-CNT        PIC  ZZZZZZ9  VALUE ZEROES.  04170058
042200         10  FILLER                  PIC  X(03)    VALUE SPACES.  04180058
042300         10  DL1-AUDITED-CART-CNT    PIC  ZZZZZZ9  VALUE ZEROES.  04190058
042400         10  FILLER                  PIC  X(03)    VALUE SPACES.  04200058
042500         10  DL1-CARTONS-IN-ERROR    PIC  ZZZZZZ9  VALUE ZEROES.  04210058
042600         10  FILLER                  PIC  X(03)    VALUE SPACES.  04220058
042700         10  DL1-PCT-CTNS-IN-ERROR   PIC  ZZZ.99   VALUE ZEROES.  04230058
042800         10  FILLER                  PIC  X(01)    VALUE '%'.     04240058
042900         10  FILLER                  PIC  X(03)    VALUE SPACES.  04250058
043000         10  DL1-MESSAGE             PIC  X(28)    VALUE SPACES.  04260058
043100         10  FILLER                  PIC  X(02)    VALUE SPACES.  04270058
043200                                                                  04280058
043300*01  CC-CONTROL-CARD.                                             04290058
043400*    05  CC-AUD-CNTL-NBR              PIC S9(09).                 04300058
      * 03/07/14 DRW BEG                                                        
       01  CC-CARDIN.                                                           
           05  CC-AUDIT-CNTL-NBR           PIC 9(09).                           
           05  CC-CARTON-ID                PIC 9(18).                           
           05  CC-SYSTEM-MANUAL-AUDIT      PIC X(01).                           
               88  CC-SYSTEM-GENERATED-AUDIT    VALUE 'S'.                      
               88  CC-MANUAL-GENERATED-AUDIT    VALUE 'M'.                      
           05  CC-RFID-QC-AUDIT-IND        PIC X(01).                           
               88  CC-RFID-AUDIT                VALUE 'R'.                      
               88  CC-QC-AUDIT                  VALUE 'S'.                      
           05  CC-RFID-QC-AUD-CMB-IND      PIC X(01).                           
               88  CC-RFID-AUD-ONLY             VALUE 'R'.                      
               88  CC-QC-AUD-ONLY               VALUE 'S'.                      
               88  CC-QC-AND-RFID-AUD           VALUE 'B'.                      
      * 03/07/14 DRW END                                                        
      *                                                                         
043500                                                                  04310058
043600 01  CC-PRINT-CARD.                                               04320058
043700     05  CC-PRINTER-ID                PIC  X(08).                 04330058
043800     05  CC-PRTR-CNTL-IND             PIC  X(01).                 04340058
043900     05  CC-TRACK-NBR                 PIC  9(01).                 04350058
044000*DMB 9/18/01                                                      04360058
044100     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    04370058
044200     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    04380058
044300*                                                                 04390058
044400                                                                  04400058
044500*                                                                 04410058
044600*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE (TSUNAUD)          04420058
044700*                                                                 04430058
044800     EXEC SQL                                                     04440058
044900          INCLUDE TSUNAUD                                         04450058
045000     END-EXEC.                                                    04460058
045200*  COPY BOOK FOR SHIPPING UNIT AUDIT TRANSACTIONS TABLE           04480058
045300*  (TSUATRN)                                                      04490058
045400*                                                                 04500058
045500     EXEC SQL                                                     04510058
045600          INCLUDE TSUATRN                                         04520058
045700     END-EXEC.                                                    04530058
045800*                                                                 04540058
045900*  COPY BOOK FOR THE SHIPPING UNIT AUDIT EXCEPTION TABLE          04550058
046000*  (TSUEXCP)                                                      04560058
046100*                                                                 04570058
046200     EXEC SQL                                                     04580058
046300          INCLUDE TSUEXCP                                         04590058
046400     END-EXEC.                                                    04600058
046500*                                                                 04610058
046600*  COPY BOOK FOR RECEIVER TABLE (TRECEIV)                         04620058
046700*                                                                 04630058
046800     EXEC SQL                                                     04640058
046900          INCLUDE TRECEIV                                         04650058
047000     END-EXEC.                                                    04660058
047100*                                                                 04670058
047200*  COPY BOOK FOR THE PURCHASE ORDER TABLE (TPURCHS)               04680058
047300*                                                                 04690058
047400     EXEC SQL                                                     04700058
047500          INCLUDE TPURCHS                                         04710058
047600     END-EXEC.                                                    04720058
047700*                                                                 04790058
047800*  COPY BOOK FOR THE ENTITY NAME TABLE (TENTNME)                  04800058
047900*                                                                 04810058
048000     EXEC SQL                                                     04820058
048100          INCLUDE TENTNME                                         04830058
048200     END-EXEC.                                                    04840058
048300 EJECT                                                            04850058
048400*  DB2 COMMUNICATION AREA                                         04860058
048500*                                                                 04870058
048600     EXEC SQL                                                     04880058
048700         INCLUDE SQLCA                                            04890058
048800     END-EXEC.                                                    04900058
048900 EJECT                                                            04910058
049000*  DB2 COMMUNICATION AREA2                                        04920058
049100*                                                                 04930058
049200     COPY SQLCA2.                                                 04940058
049300                                                                  04950058
049400 EJECT                                                            04960058
049500                                                                  04970058
049600 PROCEDURE DIVISION.                                              04980058
049700*                                                                 04990058
049800 0000-MAINLINE-PROCESSING.                                        05000058
049900******************************************************************05010058
050000**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      05020058
050100******************************************************************05030058
           OPEN INPUT  CARDIN-AUDIT-NBR-FILE                                    
050400                 PRINT-CONTROL-FILE                               05060058
050500          OUTPUT SU-CARTON-AUDIT-RPT-FILE.                        05070058
                                                                                
           PERFORM 7000-READ-CARDIN-FILE.                                       
                                                                                
           IF PS-END-OF-CARDIN-FILE                                             
               DISPLAY '** SUKRP013 ABEND **'                                   
               DISPLAY '** CARDIN (AUDIT NUMBER) FILE IS EMPTY **'              
               MOVE +4019                  TO PV-ABEND-CODE                     
               CALL 'ILBOABN0' USING PV-ABEND-CODE                              
           END-IF.                                                              
056200                                                                  05640058
056300     READ PRINT-CONTROL-FILE INTO CC-PRINT-CARD                   05650058
056400     DISPLAY 'PRINTER CARD = ' CC-PRINT-CARD.                     05660058
056500                                                                  05670058
056600     ACCEPT PV-TODAYS-DATE                                        05680058
056700       FROM DATE.                                                 05690058
056800*                                                                 05700058
056900     ACCEPT PV-TODAYS-TIME                                        05710058
057000       FROM TIME.                                                 05720058
                                                                                
      * 03/07/14 DRW BEG                                                        
           PERFORM 0500-CHECK-FOR-MANUAL-COMBO.                                 
                                                                                
           IF PS-MANUAL-COMBO-AUDIT                                             
                                                                                
               DISPLAY 'MANUAL COMBO QC PROCESSING'                             
                                                                                
               PERFORM 1000-INITIALIZATION                                      
                                                                        05100058
               PERFORM 2000-PROCESS-SU                                  05110058
                   UNTIL PS-END-OF-CARTON-FILE                          05120058
                                                                                
               PERFORM 2400-PRINT-AUDIT-DETAIL                                  
                                                                                
               CLOSE CARTON-FILE                                        05500058
                     RECEIVER-FILE                                      05510058
                                                                        05100058
               SET CC-RFID-AUDIT      TO TRUE                                   
               SET CC-RFID-AUD-ONLY   TO TRUE                                   
               DISPLAY 'MANUAL COMBO RFID PROCESSING SET'                       
                                                                                
           END-IF.                                                              
      * 03/07/14 DRW END                                                        
050600*                                                                 05080058
050700     PERFORM 1000-INITIALIZATION.                                 05090058
050800*                                                                 05100058
050900     PERFORM 2000-PROCESS-SU                                      05110058
051000         UNTIL PS-END-OF-CARTON-FILE.                             05120058
                                                                                
           PERFORM 2400-PRINT-AUDIT-DETAIL.                                     
051100*                                                                 05130058
           CLOSE CARDIN-AUDIT-NBR-FILE.                                         
054800     CLOSE CARTON-FILE                                            05500058
054900           RECEIVER-FILE                                          05510058
055000           PRINT-CONTROL-FILE                                     05520058
055100           SU-CARTON-AUDIT-RPT-FILE.                              05530058
055200*                                                                 05540058
055300     GOBACK.                                                      05550058
055400*                                                                 05560058
110600******************************************************************        
110700*  0500-CHECK-FOR-MANUAL-COMBO.                                           
110800*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.                  
111100******************************************************************        
      * 03/07/14 DRW BEG                                                        
111600 0500-CHECK-FOR-MANUAL-COMBO.                                             
111700                                                                          
           IF CC-MANUAL-GENERATED-AUDIT AND CC-QC-AND-RFID-AUD                  
               DISPLAY 'MANUAL COMBO AUDIT'                                     
               SET PS-MANUAL-COMBO-AUDIT      TO TRUE                           
               SET CC-QC-AUDIT                TO TRUE                           
               SET CC-QC-AUD-ONLY             TO TRUE                           
           END-IF.                                                              
      * 03/07/14 DRW END                                                        
055500*                                                                 05570058
055600 1000-INITIALIZATION.                                             05580058
055700******************************************************************05590058
055800**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               05600058
055900******************************************************************05610058
           INITIALIZE PS-END-OF-CARTON-FILE-SW                                  
008100                PS-END-OF-RECEIVER-FILE-SW.                       00810058
008400*               PS-FIRST-TIME-SW.                                 00840058
056000*    ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05620058
056100*    DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   05630058
050200     OPEN INPUT  CARTON-FILE                                      05040058
050300                 RECEIVER-FILE.                                   05050058
057100*                                                                 05730058
057200     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             05740058
057300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 05750058
057400     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   05760058
057500     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  05770058
057600*                                                                 05780058
057700     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  05790058
057800     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                05800058
057900     MOVE PC-SUKRP013        TO DP132O-PROGRAM-NAME.              05810058
058000                                                                  05820058
058100     PERFORM 7050-READ-CARTON-EXTRACT.                            05830058
058200                                                                  05840058
058300     IF PS-END-OF-CARTON-FILE                                     05850058
058400        SET NO-DATA-TO-REPORT   TO TRUE                           05860058
058500        MOVE CC-AUDIT-CNTL-NBR  TO PV-AUD-CNTL-NBR                05870058
058600        MOVE PV-AUD-CNTL-NBR    TO HL2-AUD-CNTL-NBR               05880058
058700     ELSE                                                         05890058
058800        MOVE SU003-PO-NBR       TO PV-CURR-PO-NBR                 05900058
058900        MOVE SU003-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR            05910058
059000                                                                  05920058
059100        PERFORM 1100-SELECT-TSUNAUD                               05930058
059200                                                                  05940058
059300        MOVE SU003-AUD-CNTL-NBR TO PV-AUD-CNTL-NBR                05950058
059400        MOVE PV-AUD-CNTL-NBR    TO HL2-AUD-CNTL-NBR               05960058
059500                                                                  05970058
059600        EVALUATE SUNAUD-AUD-TYP-CDE                               05980058
059700            WHEN '01'                                             05990058
059800                MOVE PC-100-PCT-CHECK TO HL2-AUDIT-TYPE           06000058
059900            WHEN '02'                                             06010058
060000                MOVE PC-SPOT-CHECK    TO HL2-AUDIT-TYPE           06020058
060100            WHEN '03'                                             06030058
060200                MOVE PC-REWORK        TO HL2-AUDIT-TYPE           06040058
060300            WHEN OTHER                                            06050058
060400                MOVE PC-UNKNOWN       TO HL2-AUDIT-TYPE           06060058
060500        END-EVALUATE                                              06070058
060600                                                                  06080058
060700        EVALUATE SUNAUD-AUD-STAT-CDE                              06090058
060800            WHEN 'IP'                                             06100058
060900                MOVE PC-IN-PROCESS TO HL2-AUDIT-STATUS            06110058
061000            WHEN 'CM'                                             06120058
061100                MOVE PC-COMPLETE   TO HL2-AUDIT-STATUS            06130058
061200            WHEN 'PP'                                             06140058
061300                MOVE PC-POSTPONED  TO HL2-AUDIT-STATUS            06150058
061400            WHEN OTHER                                            06160058
061500                MOVE PC-UNKNOWN    TO HL2-AUDIT-STATUS            06170058
061600        END-EVALUATE                                              06180058
061700                                                                  06190058
061800        MOVE SUNAUD-AUD-STRT-TMST TO PV-DB2-TMST                  06200058
061900        MOVE PV-DB2-TMST-MM       TO HL3-AUDIT-START-DATE-MM      06210058
062000        MOVE PV-DB2-TMST-DD       TO HL3-AUDIT-START-DATE-DD      06220058
062100        MOVE PV-DB2-TMST-CCYY     TO HL3-AUDIT-START-DATE-CCYY    06230058
062200        MOVE PV-DB2-TMST-HH       TO HL3-AUDIT-START-TIME-HH      06240058
062300        MOVE PV-DB2-TMST-MN       TO HL3-AUDIT-START-TIME-MN      06250058
062400                                                                  06260058
062500        IF  SUNAUD-AUD-STP-TMST = PC-DEFAULT-TMST                 06270058
062600            MOVE SPACES TO HL3-AUDIT-STOP-DATE                    06280058
062700                           HL3-AUDIT-STOP-TIME                    06290058
062800                           HL3-AUDIT-DURATION                     06300058
062900        ELSE                                                      06310058
063000            MOVE SUNAUD-AUD-STP-TMST                              06320058
063100                                  TO PV-DB2-TMST                  06330058
063200            MOVE PV-DB2-TMST-MM   TO HL3-AUDIT-STOP-DATE-MM       06340058
063300            MOVE PV-DB2-TMST-DD   TO HL3-AUDIT-STOP-DATE-DD       06350058
063400            MOVE PV-DB2-TMST-CCYY TO HL3-AUDIT-STOP-DATE-CCYY     06360058
063500            MOVE PV-DB2-TMST-HH   TO HL3-AUDIT-STOP-TIME-HH       06370058
063600            MOVE PV-DB2-TMST-MN   TO HL3-AUDIT-STOP-TIME-MN       06380058
063700                                                                  06390058
063800            PERFORM 1200-CALC-DURATION                            06400058
063900                                                                  06410058
064000*  SUBTRACT OUT THE MINUTES THAT THE AUDIT WAS EITHER             06420058
064100*  CLOSED OR POSTPONED -- THIS TIME SHOULD NOT COUNT              06430058
064200*  COUNT AGAINST THE TIME OF THE AUDIT                            06440058
064300                                                                  06450058
064400            COMPUTE PV-AUDIT-DURATION-TIME =                      06460058
064500                PV-AUDIT-DURATION-TIME -                          06470058
064600                    SUNAUD-AUD-PSPND-MNIT-QTY -                   06480058
064700                        SUNAUD-AUD-CLO-MNIT-QTY                   06490058
064800                                                                  06500058
064900            DIVIDE PV-AUDIT-DURATION-TIME BY 60                   06510058
065000                GIVING PV-AUDIT-DURATION-HOURS                    06520058
065100             REMAINDER PV-AUDIT-DURATION-MINUTES                  06530058
065200                                                                  06540058
065300            MOVE PV-AUDIT-DURATION-HOURS                          06550058
065400                                  TO HL3-AUDIT-DURATION-HH        06560058
065500            MOVE PV-AUDIT-DURATION-MINUTES                        06570058
065600                                  TO HL3-AUDIT-DURATION-MM        06580058
065700        END-IF                                                    06590058
                                                                                
      * 03/07/14 DRW BEG                                                        
059600        IF CC-RFID-AUDIT                                          05980058
059800            MOVE PC-RFID          TO HL3P5-AUDIT-CATEGORY         06000058
              ELSE                                                              
060400            MOVE PC-QC            TO HL3P5-AUDIT-CATEGORY         06060058
060500        END-IF                                                    06070058
      * 03/07/14 DRW END                                                        
065800                                                                  06600058
065900        PERFORM 1300-LOCATION-NAME                                06610058
066000                                                                  06620058
066100        MOVE SUNAUD-OPER-UNT-ID   TO PV-OPER-UNT-ID               06630058
066200        MOVE PV-OPER-UNT-ID       TO HL4-AUDIT-FCLTY-ID           06640058
066300        MOVE XL071-LOC-NM         TO HL4-AUDIT-FCLTY-NAME         06650058
066400        MOVE SUNAUD-PRC-FCLTY-AREA-ID                             06660058
066500                                  TO HL4-AUDIT-PRC-AREA           06670058
066600     END-IF.                                                      06680058
066700                                                                  06690058
066800*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  06700058
066900     IF CC-PRTR-CNTL-IND = 'P'                                    06710058
067000         MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR     06720058
067100         MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI          06730058
067200                                                                  06740058
067300         WRITE SU-CARTON-AUDIT-RPT-RECORD                         06750058
067400             FROM DS004-PLC-LOAD-FORM                             06760058
067500         AFTER ADVANCING 1 LINE                                   06770058
067600     END-IF.                                                      06780058
067700                                                                  06790058
067800     PERFORM 8000-WRITE-REPORT-HEADERS.                           06800058
067900                                                                  06810058
068000     IF PS-END-OF-CARTON-FILE                                     06820058
068100        WRITE SU-CARTON-AUDIT-RPT-RECORD                          06830058
068200          FROM NO-DATA-LINE                                       06840058
068300            AFTER ADVANCING 2 LINE.                               06850058
068400                                                                  06860058
068500*                                                                 06870058
068600 1100-SELECT-TSUNAUD.                                             06880058
068700******************************************************************06890058
068800**  SELECT INFORMATION FROM THE SHIPPING UNIT AUDIT TABLE FOR THE 06900058
068900**  HEADER PORTION OF THE REPORT.                                 06910058
069000******************************************************************06920058
069100     INITIALIZE DCLTSUNAUD.                                       06930058
069200                                                                  06940058
069300     MOVE '1100-SELECT-TSUNAUD '                                  06950058
069400                                 TO PV-ABEND-PARAGRAPH.           06960058
069500     EXEC SQL                                                     06970058
069600       SELECT  A.AUD_STRT_TMST                                    06980058
069700              ,A.AUD_STP_TMST                                     06990058
069800              ,A.AUD_PSPND_MNIT_QTY                               07000058
069900              ,A.AUD_CLO_MNIT_QTY                                 07010058
070000              ,A.OPER_UNT_ID                                      07020058
070100              ,A.FCLTY_ID                                         07030058
070200              ,A.PRC_FCLTY_AREA_ID                                07040058
070300              ,A.AUD_STAT_CDE                                     07050058
070400              ,A.AUD_TYP_CDE                                      07060058
070500         INTO  :SUNAUD-AUD-STRT-TMST                              07070058
070600              ,:SUNAUD-AUD-STP-TMST                               07080058
070700              ,:SUNAUD-AUD-PSPND-MNIT-QTY                         07090058
070800              ,:SUNAUD-AUD-CLO-MNIT-QTY                           07100058
070900              ,:SUNAUD-OPER-UNT-ID                                07110058
071000              ,:SUNAUD-FCLTY-ID                                   07120058
071100              ,:SUNAUD-PRC-FCLTY-AREA-ID                          07130058
071200              ,:SUNAUD-AUD-STAT-CDE                               07140058
071300              ,:SUNAUD-AUD-TYP-CDE                                07150058
071400         FROM  TSUNAUD        A                                   07160058
071500        WHERE  A.AUD_CNTL_NBR = :SU003-AUD-CNTL-NBR               07170058
071600     END-EXEC.                                                    07180058
071700                                                                  07190058
071800     EVALUATE TRUE                                                07200058
071900       WHEN SQLCODE = ZEROS                                       07210058
072000         CONTINUE                                                 07220058
072100       WHEN OTHER                                                 07230058
072200         DISPLAY PV-ABEND-PARAGRAPH                               07240058
072300         DISPLAY 'AUDIT CONTROL NUMBER ' SU003-AUD-CNTL-NBR       07250058
072400         PERFORM Z999-SQL-ERROR                                   07260058
072500     END-EVALUATE.                                                07270058
072600                                                                  07280058
072700                                                                  07290058
072800 1200-CALC-DURATION.                                              07300058
072900******************************************************************07310058
073000**  CALCULATE THE DURATION OF THE AUDIT                           07320058
073100******************************************************************07330058
073200     INITIALIZE PV-AUDIT-DURATION-TIME.                           07340058
073300                                                                  07350058
073400     MOVE '1200-CALC-DURATION  ' TO PV-ABEND-PARAGRAPH.           07360058
073500                                                                  07370058
073600     EXEC SQL                                                     07380058
073700       SELECT                                                     07390058
073800           ((DAY(AUD_STP_TMST) - DAY(AUD_STRT_TMST)) * 1440) +    07400058
073900           ((HOUR(AUD_STP_TMST) - HOUR(AUD_STRT_TMST)) * 60) +    07410058
074000            (MINUTE(AUD_STP_TMST) - MINUTE(AUD_STRT_TMST))        07420058
074100         INTO                                                     07430058
074200             :PV-AUDIT-DURATION-TIME                              07440058
074300         FROM                                                     07450058
074400             TSUNAUD                                              07460058
074500        WHERE                                                     07470058
074600             AUD_CNTL_NBR = :SU003-AUD-CNTL-NBR                   07480058
074700     END-EXEC.                                                    07490058
074800                                                                  07500058
074900     EVALUATE TRUE                                                07510058
075000       WHEN SQLCODE = ZEROS                                       07520058
075100         CONTINUE                                                 07530058
075200       WHEN OTHER                                                 07540058
075300         DISPLAY PV-ABEND-PARAGRAPH                               07550058
075400         DISPLAY 'AUD CNTL NBR ' SU003-AUD-CNTL-NBR               07560058
075500         PERFORM Z999-SQL-ERROR                                   07570058
075600     END-EVALUATE.                                                07580058
075700                                                                  07590058
075800*                                                                 07600058
075900 1300-LOCATION-NAME.                                              07610058
076000******************************************************************07620058
076100**  FETCH THE FACILITY NAME TO DISPLAY IN THE HEADING OF THE      07630058
076200**  REPORT                                                        07640058
076300******************************************************************07650058
076400                                                                  00040001
076500     MOVE '1300-LOCATION-NAME' TO PV-ABEND-PARAGRAPH.             07680058
076600                                                                          
076700     INITIALIZE XL071-COMMAREA-REC.                               00050001
076800     MOVE SUNAUD-OPER-UNT-ID    TO XL071-LOCATION-NUMBER          00060001
076900                                                                  00070001
077000     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         00080001
077100                                                                  00090001
077200     EVALUATE TRUE                                                00100001
077300     WHEN XL071-NO-ERRORS                                         00110001
077400         CONTINUE                                                         
077500     WHEN XL071-LOC-NOT-FOUND                                     00130001
077600     WHEN XL071-DC-ASGMT-NOT-FND                                  00140001
077700         MOVE 'UNKNOWN FACILITY' TO XL071-LOC-NM                  07820058
077800     WHEN XL071-BAD-DB2-RETURN                                    00160001
077900         DISPLAY PV-ABEND-PARAGRAPH                               07840058
078000         DISPLAY 'CALL LOCATION MOD '                             00180001
078100         DISPLAY 'XLT00010'                                       00190001
078200         DISPLAY 'OPER UNIT ID ' SUNAUD-OPER-UNT-ID               07850058
078300         DISPLAY 'FCLTY ID     ' SUNAUD-FCLTY-ID                  07860058
078400         MOVE XL071-SQLCA             TO SQLCA                    00200001
078500         PERFORM Z999-SQL-ERROR                                   07870058
078600     END-EVALUATE.                                                00220001
078700/                                                                 07900058
078800 2000-PROCESS-SU.                                                 07910058
078900******************************************************************07920058
079000*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *07930058
079100*  VENDOR ACCURACY CARTON AUDIT REPORT.                          *07940058
079200******************************************************************07950058
079300     IF  PV-CURR-PO-RECEIVER NOT = PV-PREV-PO-RECEIVER            07960058
079400         IF  PS-FIRST-TIME                                        07970058
079500             SET PS-NOT-FIRST-TIME     TO TRUE                    07980058
079600             PERFORM 7100-READ-RECEIVER-EXTRACT                   07990058
079700             MOVE SU004-PO-NBR         TO PV-KEY-PO-NBR           08000058
079800             MOVE SU004-REC-SEQ-NBR    TO PV-KEY-REC-SEQ-NBR      08010058
079900         ELSE                                                     08020058
080000             IF  PS-ERROR-FOUND                                   08030058
080100                 ADD +1                TO PV-CARTONS-IN-ERROR     08040058
080200             END-IF                                               08050058
080300             MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR    08060058
080400*  FOR SPOT CHECKS THE PERCENT IN ERROR IS CALCULATED BASED ON THE08070058
080500*  NUMBER OF CARTONS AUDITED INSTEAD OF THE NUMBER OF CARTONS     08080058
080600*  EXPECTED.                                                      08090058
080700             IF SUNAUD-AUD-TYP-CDE = '02'                         08100058
080800                IF PV-CARTONS-IN-AUDIT = 0                        08110058
080900                   MOVE 0 TO PV-PCT-CTNS-IN-ERROR                 08120058
081000                ELSE                                              08130058
081100                   COMPUTE PV-PCT-CTNS-IN-ERROR =                 08140058
081200                   (PV-CARTONS-IN-ERROR /                         08150058
081300                        PV-CARTONS-IN-AUDIT) * 100                08160058
081400                END-IF                                            08170058
081500             ELSE                                                 08180058
081600                IF RECEIV-EXPTED-CART-CNT = 0                     08190058
081700                   MOVE ZEROES TO PV-PCT-CTNS-IN-ERROR            08200058
081800                ELSE                                              08210058
081900                   IF RECEIV-EXPTED-CART-CNT = 0                  08220058
082000                      MOVE 0 TO PV-PCT-CTNS-IN-ERROR              08230058
082100                   ELSE                                           08240058
082200                      COMPUTE PV-PCT-CTNS-IN-ERROR =              08250058
082300                      (PV-CARTONS-IN-ERROR /                      08260058
082400                           RECEIV-EXPTED-CART-CNT) * 100          08270058
082500                   END-IF                                         08280058
082600                END-IF                                            08290058
082700             END-IF                                               08300058
082800             MOVE PV-PCT-CTNS-IN-ERROR TO DL1-PCT-CTNS-IN-ERROR   08310058
082900             PERFORM 8400-WRITE-DETAIL-LINES                      08320058
083000         END-IF                                                   08330058
083100                                                                  08340058
083200         MOVE PV-CURR-PO-NBR         TO PV-PREV-PO-NBR            08350058
083300         MOVE PV-CURR-REC-SEQ-NBR    TO PV-PREV-REC-SEQ-NBR       08360058
083400         MOVE SU003-PO-NBR           TO PV-CURR-PO-NBR            08370058
083500                                        PV-PO                     08380058
083600         MOVE SU003-REC-SEQ-NBR      TO PV-CURR-REC-SEQ-NBR       08390058
083700                                        PV-RECEIVER               08400058
083800         MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER           08410058
083900                                                                  08420058
084000         PERFORM 2100-FETCH-TRECEIV-INFO                          08430058
084100                                                                  08440058
084200         MOVE ENTNME-ENT-NAME-DESC   TO DL1-VENDOR-NAME           08450058
084300         MOVE RECEIV-REC-TMST        TO PV-DB2-TMST               08460058
084400         MOVE PV-DB2-TMST-MM         TO DL1-DATE-RCVD-MM          08470058
084500         MOVE PV-DB2-TMST-DD         TO DL1-DATE-RCVD-DD          08480058
084600         MOVE PV-DB2-TMST-CCYY       TO DL1-DATE-RCVD-CCYY        08490058
084700         MOVE RECEIV-EXPTED-CART-CNT TO DL1-EXPTED-CART-CNT       08500058
084800         MOVE RECEIV-ACTL-CART-CNT   TO DL1-ADJ-CART-CNT          08510058
084900                                                                  08520058
085000         PERFORM 2200-FETCH-TSUATRN-INFO                          08530058
085100                                                                  08540058
085200         MOVE PV-CARTONS-IN-AUDIT    TO DL1-AUDITED-CART-CNT      08550058
085300                                                                  08560058
085400         SET PS-NO-RECEIVER-ERROR    TO TRUE                      08570058
085500                                                                  08580058
085600******************************************************************08590058
085700*  CHECK IF THE RECEIVER IS IN ERROR.  IF THE AUDITED QUANTITY   *08600058
085800*  DOES NOT MATCH THE RECEIVED QUANTITY, AN ERROR MESSAGE IS     *08610058
085900*  DISPLAYED FOR THE RECEIVER STATING THAT AN OVER/SHORT         *08620058
086000*  CONDITION EXISTS.                                             *08630058
086100******************************************************************08640058
086200         PERFORM                                                  08650058
086300           UNTIL (PV-KEY-PO-RECEIVER > PV-CURR-PO-RECEIVER)       08660058
086400              OR (PS-END-OF-RECEIVER-FILE)                        08670058
086500                                                                  08680058
086600             IF  SU004-QTY-AUD NOT = SU004-QTY-RECV               08690058
086700                 SET PS-RECEIVER-ERROR TO TRUE                    08700058
086800             END-IF                                               08710058
086900                                                                  08720058
087000             PERFORM 7100-READ-RECEIVER-EXTRACT                   08730058
087100             MOVE SU004-PO-NBR         TO PV-KEY-PO-NBR           08740058
087200             MOVE SU004-REC-SEQ-NBR    TO PV-KEY-REC-SEQ-NBR      08750058
087300         END-PERFORM                                              08760058
087400                                                                  08770058
087500         IF  PS-RECEIVER-ERROR                                    08780058
087600             MOVE PC-OVER-SHORT-MSG TO DL1-MESSAGE                08790058
087700             MOVE 1 TO RETURN-CODE                                08800058
087800         ELSE                                                     08810058
087900             MOVE SPACES            TO DL1-MESSAGE                08820058
088000         END-IF                                                   08830058
088100                                                                  08840058
088200         INITIALIZE PV-CARTONS-IN-ERROR                           08850058
088300                    PV-CURR-SHIPT-UNT-ID                          08860058
088400         SET PS-NO-ERROR-FOUND       TO TRUE                      08870058
088500     END-IF.                                                      08880058
088600                                                                  08890058
088700******************************************************************08900058
088800*  CHECK IF THIS CARTON IS IN ERROR.  IF AN ERROR EXSIST FOR     *08910058
088900*  AN ITEM THE ERR-CNT-COMBO WILL BE SET TO A 1                  *08920058
089000*  EACH CARTON IN THE AUDIT HAS BEEN ASSIGNED A UNIQUE           *08930058
089100*  SHIPT-UNT-ID.  WHEN THIS CHANGES, WE ARE NOW EXAMINING A      *08940058
089200*  DIFFERENT CARTON FOR ERRORS.                                  *08950058
089300******************************************************************08960058
089400     IF  SU003-SHIPT-UNT-ID NOT = PV-CURR-SHIPT-UNT-ID            08970058
089500         MOVE SU003-SHIPT-UNT-ID   TO PV-CURR-SHIPT-UNT-ID        08980058
089600         IF  PS-ERROR-FOUND                                       08990058
089700             ADD  +1               TO PV-CARTONS-IN-ERROR         09000058
089800             SET PS-NO-ERROR-FOUND TO TRUE                        09010058
089900         END-IF                                                   09020058
           END-IF.                                                      09030058
090100                                                                  09040058
           IF  SU003-UNT-ERR-CNT-COMBO > 0                              09050058
               SET PS-ERROR-FOUND        TO TRUE                        09060058
           END-IF                                                       09070058
090500                                                                  09080058
090600     PERFORM 7050-READ-CARTON-EXTRACT.                            09090058
090700                                                                  09100058
090800     MOVE SU003-PO-NBR       TO PV-CURR-PO-NBR.                   09110058
090900     MOVE SU003-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR.              09120058
091000                                                                  09130058
091100                                                                  09140058
091200 2100-FETCH-TRECEIV-INFO.                                         09150058
091300******************************************************************09160058
091400*  FETCH RECEIVER RELATED INFORMATION                            *09170058
091500******************************************************************09180058
091600     INITIALIZE DCLTRECEIV                                        09190058
091700                DCLTPURCHS                                        09200058
091800                DCLTENTNME.                                       09210058
091900                                                                  09220058
092000     MOVE '2100-FETCH-TRECEIV-INFO'                               09230058
092100                                 TO PV-ABEND-PARAGRAPH.           09240058
092200                                                                  09250058
092300     EXEC SQL                                                     09260058
092400       SELECT  A.REC_TMST                                         09270058
092500              ,A.EXPTED_CART_CNT                                  09280058
092600              ,A.ACTL_CART_CNT                                    09290058
092700              ,C.ENT_NAME_DESC                                    09300058
092800         INTO  :RECEIV-REC-TMST                                   09310058
092900              ,:RECEIV-EXPTED-CART-CNT                            09320058
093000              ,:RECEIV-ACTL-CART-CNT                              09330058
093100              ,:ENTNME-ENT-NAME-DESC                              09340058
093200         FROM  TRECEIV A                                          09350058
093300              ,TPURCHS B                                          09360058
093400              ,TENTNME C                                          09370058
093500        WHERE  A.ORD_NBR        = :SU003-PO-NBR                   09380058
093600          AND  A.REC_SEQ_NBR    = :SU003-REC-SEQ-NBR              09390058
093700          AND  A.ORD_NBR        = B.PO_NBR                        09400058
093800          AND  B.VER_STATUS_CDE = :PC-ACTIVE-STATUS               09410058
093900          AND  B.ENT_ID         = C.ENT_ID                        09420058
094000          AND  C.TYPE_CDE       = :PC-LONG-NAME                   09430058
094100     END-EXEC.                                                    09440058
094200                                                                  09450058
094300     EVALUATE TRUE                                                09460058
094400       WHEN SQLCODE = ZEROS                                       09470058
094500         CONTINUE                                                 09480058
094600       WHEN SQLCODE = +100                                        09490058
094700         MOVE 'UNKNOWN VENDOR' TO ENTNME-ENT-NAME-DESC            09500058
094800       WHEN OTHER                                                 09510058
094900         DISPLAY PV-ABEND-PARAGRAPH                               09520058
095000         DISPLAY 'PO NUMBER     ' SU003-PO-NBR                    09530058
095100         DISPLAY 'REC SEQ NBR   ' SU003-REC-SEQ-NBR               09540058
095200         PERFORM Z999-SQL-ERROR                                   09550058
095300     END-EVALUATE.                                                09560058
095400                                                                  09570058
095500                                                                  09580058
095600 2200-FETCH-TSUATRN-INFO.                                         09590058
095700******************************************************************09600058
095800*  FETCH AUDIT CARTON COUNT INFORMATION                          *09610058
095900******************************************************************09620058
096000     INITIALIZE PV-CARTONS-IN-AUDIT.                              09630058
096100                                                                  09640058
096200     MOVE '2200-FETCH-TSUATRN-INFO'                               09650058
096300                                 TO PV-ABEND-PARAGRAPH.           09660058
096400                                                                  09670058
096500     EXEC SQL                                                     09680058
096600       SELECT  COUNT(*)                                           09690058
096700         INTO  :PV-CARTONS-IN-AUDIT                               09700058
096800         FROM  TSUATRN                                            09710058
096900        WHERE  AUD_CNTL_NBR   = :SU003-AUD-CNTL-NBR               09720058
097000          AND  TRN_NBR        = :SU003-PO-NBR                     09730058
097100          AND  REC_SEQ_NBR    = :SU003-REC-SEQ-NBR                09740058
097200     END-EXEC.                                                    09750058
097300                                                                  09760058
097400     EVALUATE TRUE                                                09770058
097500       WHEN SQLCODE = ZEROS                                       09780058
097600       WHEN SQLCODE = +100                                        09790058
097700         CONTINUE                                                 09800058
097800       WHEN OTHER                                                 09810058
097900         DISPLAY PV-ABEND-PARAGRAPH                               09820058
098000         DISPLAY 'AUD CNTL NBR ' SU003-AUD-CNTL-NBR               09830058
098100         DISPLAY 'PO NUMBER    ' SU003-PO-NBR                     09840058
098200         DISPLAY 'REC SEQ NBR  ' SU003-REC-SEQ-NBR                09850058
098300         PERFORM Z999-SQL-ERROR                                   09860058
098400     END-EVALUATE.                                                09870058
098500                                                                  09880058
098600                                                                  09890058
098700 2300-CHECK-TSUEXCP.                                              09900058
098800******************************************************************09910058
098900*  FETCH THE SHIPPING UNIT AUDIT EXCEPTION COUNT INFORMATION     *09920058
099000******************************************************************09930058
099100     INITIALIZE PV-ERROR-COUNT.                                   09940058
099200                                                                  09950058
099300     MOVE '2300-CHECK-TSUEXCP'   TO PV-ABEND-PARAGRAPH.           09960058
099400                                                                  09970058
099500     EXEC SQL                                                     09980058
099600       SELECT  COUNT(*)                                           09990058
099700         INTO  :PV-ERROR-COUNT                                    10000058
099800         FROM  TSUEXCP                                            10010058
099900        WHERE  AUD_CNTL_NBR   = :SU003-AUD-CNTL-NBR               10020058
100000          AND  SHIPT_UNT_ID   = :SU003-SHIPT-UNT-ID               10030058
100100          AND  UPC_NBR        = :SU003-UPC                        10040058
100200     END-EXEC.                                                    10050058
100300                                                                  10060058
100400     EVALUATE TRUE                                                10070058
100500       WHEN SQLCODE = ZEROS                                       10080058
100600       WHEN SQLCODE = +100                                        10090058
100700         CONTINUE                                                 10100058
100800       WHEN OTHER                                                 10110058
100900         DISPLAY PV-ABEND-PARAGRAPH                               10120058
101000         DISPLAY 'AUD CNTL NBR ' SU003-AUD-CNTL-NBR               10130058
101100         DISPLAY 'SHIPT UNT ID ' SU003-SHIPT-UNT-ID               10140058
101200         DISPLAY 'UPC NUMBER   ' SU003-UPC                        10150058
101300         PERFORM Z999-SQL-ERROR                                   10160058
101400     END-EVALUATE.                                                10170058
101500                                                                  10180058
098600                                                                  09890058
098800******************************************************************09910058
098900* PRINT THE HEADING DETAIL LINE FOR THE AUDIT                    *09920058
099000******************************************************************09930058
098700 2400-PRINT-AUDIT-DETAIL.                                         09900058
101600                                                                  10190058
051300     IF NO-DATA-TO-REPORT                                         05150058
051400        CONTINUE                                                  05160058
051500     ELSE                                                         05170058
              IF  PS-ERROR-FOUND                                        08990058
                  IF PV-CARTONS-IN-ERROR = 0                                    
                      ADD  +1           TO PV-CARTONS-IN-ERROR          09000058
                  END-IF                                                        
              END-IF                                                    09020058
051600        MOVE PV-CARTONS-IN-ERROR  TO DL1-CARTONS-IN-ERROR         05180058
051700        IF SUNAUD-AUD-TYP-CDE = '02'                              05190058
051800           IF PV-CARTONS-IN-AUDIT = 0                             05200058
051900              MOVE 0 TO PV-PCT-CTNS-IN-ERROR                      05210058
052000           ELSE                                                   05220058
052100              COMPUTE PV-PCT-CTNS-IN-ERROR =                      05230058
052200              (PV-CARTONS-IN-ERROR / PV-CARTONS-IN-AUDIT) * 100   05240058
052300           END-IF                                                 05250058
052400        ELSE                                                      05260058
052500           IF RECEIV-EXPTED-CART-CNT = 0                          05270058
052600              MOVE 0 TO PV-PCT-CTNS-IN-ERROR                      05280058
052700           ELSE                                                   05290058
052800              COMPUTE PV-PCT-CTNS-IN-ERROR =                      05300058
052900              (PV-CARTONS-IN-ERROR / RECEIV-EXPTED-CART-CNT) * 10005310058
053000           END-IF                                                 05320058
053100        END-IF                                                    05330058
053200        MOVE PV-PCT-CTNS-IN-ERROR TO DL1-PCT-CTNS-IN-ERROR        05340058
053300                                                                  05350058
053400        PERFORM 8400-WRITE-DETAIL-LINES                           05360058
053500     END-IF.                                                      05370058
053600                                                                  05380058
053700     WRITE SU-CARTON-AUDIT-RPT-RECORD                             05390058
053800       FROM END-OF-REPORT-LINE                                    05400058
053900         AFTER ADVANCING 2 LINES.                                 05410058
054000*                                                                 05420058
054100*DMB 9/18/01    IF CC-PRTR-CNTL-IND = 'P'                         05430058
054200     IF CC-PRTR-CUT-IND = 'Y'                                     05440058
054300         WRITE SU-CARTON-AUDIT-RPT-RECORD                         05450058
054400             FROM DS004-PLC-CUT-FORM                              05460058
054500         AFTER ADVANCING 1 LINE                                   05470058
054600     END-IF.                                                      05480058
                                                                                
       7000-READ-CARDIN-FILE.                                                   
      ******************************************************************        
                                                                                
           READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                            
              AT END                                                            
                 SET PS-END-OF-CARDIN-FILE TO TRUE.                             
                                                                                
           IF PS-END-OF-CARDIN-FILE                                             
               CONTINUE                                                         
           ELSE                                                                 
               DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR                      
      *        DISPLAY 'CARTON ID IS : ' CC-CTN-LAST-17                         
               DISPLAY 'CARTON ID IS : ' CC-CARTON-ID                           
               PERFORM 7100-VALIDATE-CONTROL-CARD                               
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * 7100-VALIDATE-CONTROL-CARD - VERIFIES THAT THE AUDIT CONTROL            
      * NUMBER AND THE SHIPPING UNIT ID ARE BOTH NUMBERIC                       
      ******************************************************************        
       7100-VALIDATE-CONTROL-CARD.                                              
                                                                                
      *NUMERIC EDIT OF AUDIT CONTROL NBR                                        
           MOVE CC-AUDIT-CNTL-NBR          TO DP010I-UNEDITED-FIELD.            
           MOVE +9                         TO DP010I-MAXIMUM-DIGITS.            
           MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.          
           SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                             
           CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
               USING DP010I-NUMERIC-EDIT-AREA.                                  
                                                                                
           IF DP010I-NO-ERROR-DETECTED                                          
               MOVE DP010I-NUMERIC-FIELD  TO PV-AUD-CNTL-NBR                    
           ELSE                                                                 
               DISPLAY '** SUKRP013 ABEND **'                                   
               DISPLAY '** AUDIT NUMBER IS NOT NUMERIC **'                      
               MOVE +4019                  TO PV-ABEND-CODE                     
               CALL 'ILBOABN0' USING PV-ABEND-CODE                              
           END-IF.                                                              
      *                                                                         
                                                                                
      *NUMERIC EDIT OF CARTON ID                                                
      *    IF CC-CTN-FIRST-DIGIT = 0                                            
      *    MOVE CC-CTN-LAST-17         TO DP010I-UNEDITED-FIELD.                
      *    MOVE +17                    TO DP010I-MAXIMUM-DIGITS.                
      *    MOVE 0                      TO DP010I-MAXIMUM-DECIMALS.              
      *    SET DP010I-NEGATIVE-NOT-ALLOWED                                      
      *                                TO TRUE.                                 
      *    CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
      *        USING DP010I-NUMERIC-EDIT-AREA.                                  
      *                                                                         
      *    IF DP010I-NO-ERROR-DETECTED                                          
      *        MOVE DP010I-NUM-FIELD-17-DIG-0-DEC                               
      *                                TO PV-CURR-SHIPT-UNT-ID                  
      *        CONTINUE                                                         
      *    ELSE                                                                 
      *        DISPLAY '** SUKRP013 ABEND **'                                   
      *        DISPLAY '** CARTON NUMBER MUST BE NUMERIC **'                    
      *        MOVE +4019              TO PV-ABEND-CODE                         
      *        CALL 'ILBOABN0' USING PV-ABEND-CODE                              
      *    END-IF.                                                              
      *    ELSE                                                                 
      *        DISPLAY '** SUKRP013 ABEND **'                                   
      *        DISPLAY '** FIRST DIGIT OF CARTON NBR MUST BE 0 OR 4 ***'        
      *        MOVE +4019              TO PV-ABEND-CODE                         
      *        CALL 'ILBOABN0' USING PV-ABEND-CODE                              
      *    END-IF.                                                              
                                                                                
           MOVE CC-CARTON-ID           TO PV-CURR-SHIPT-UNT-ID.                 
      *    IF PV-CURR-SHIPT-UNT-ID > 0                                          
      *       SET PS-USE-CARTON-CURSORS TO TRUE                                 
      *       DISPLAY 'USING CARTON CURSOR'                                     
      *    ELSE                                                                 
      *       SET PS-USE-AUDIT-CURSORS  TO TRUE                                 
      *       DISPLAY 'USING AUDIT CURSOR'                                      
      *    END-IF.                                                              
                                                                                
101700 7050-READ-CARTON-EXTRACT.                                        10200058
101800******************************************************************10210058
101900*  READ A RECORD FROM THE CARTON EXTRACT FILE.                   *10220058
102000******************************************************************10230058
102100     INITIALIZE SU003-EXTRACT-RECORD.                             10240058
102200                                                                  10250058
102300     READ CARTON-FILE INTO SU003-EXTRACT-RECORD                   10260058
102400        AT END                                                    10270058
102500           SET PS-END-OF-CARTON-FILE TO TRUE.                     10280058
102600                                                                  10290058
102700                                                                  10300058
102800 7100-READ-RECEIVER-EXTRACT.                                      10310058
102900******************************************************************10320058
103000*  READ A RECORD FROM THE CARTON EXTRACT FILE.                   *10330058
103100******************************************************************10340058
103200     INITIALIZE SU004-EXTRACT-RECORD.                             10350058
103300                                                                  10360058
103400     READ RECEIVER-FILE INTO SU004-EXTRACT-RECORD                 10370058
103500        AT END                                                    10380058
103600           SET PS-END-OF-RECEIVER-FILE TO TRUE.                   10390058
103700                                                                  10400058
103800                                                                  10410058
103900                                                                  10420058
104000 8000-WRITE-REPORT-HEADERS.                                       10430058
104100******************************************************************10440058
104200*  PRINT THE HEADING FOR THE REPORT.                             *10450058
104300******************************************************************10460058
104400     PERFORM 8200-WRITE-TOP-LINE.                                 10470058
104500*                                                                 10480058
104600     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10490058
104700       FROM HEADING-LINE-0                                        10500058
104800         AFTER ADVANCING 2 LINE.                                  10510058
104900*                                                                 10520058
105000     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10530058
105100       FROM HEADING-LINE-1                                        10540058
105200         AFTER ADVANCING 1 LINE.                                  10550058
105300*                                                                 10560058
105400     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10570058
105500       FROM HEADING-LINE-2                                        10580058
105600         AFTER ADVANCING 3 LINES.                                 10590058
105700*                                                                 10600058
105800     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10610058
105900       FROM HEADING-LINE-3                                        10620058
106000         AFTER ADVANCING 1 LINES.                                 10630058
106100*                                                                 10640058
      * 03/07/14 DRW BEG                                                        
105800     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10610058
105900       FROM HEADING-LINE-3P5                                      10620058
106000         AFTER ADVANCING 1 LINES.                                 10630058
      * 03/07/14 DRW END                                                        
106100*                                                                 10640058
106200     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10650058
106300       FROM HEADING-LINE-4                                        10660058
106400         AFTER ADVANCING 2 LINES.                                 10670058
106500*                                                                 10680058
106600     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10690058
106700       FROM HEADING-LINE-5                                        10700058
106800         AFTER ADVANCING 3 LINES.                                 10710058
106900                                                                  10720058
107000     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10730058
107100       FROM HEADING-LINE-6                                        10740058
107200         AFTER ADVANCING 1 LINE.                                  10750058
107300*                                                                 10760058
107400     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10770058
107500       FROM PC-BLANK-LINE                                         10780058
107600         AFTER ADVANCING 1 LINE.                                  10790058
107700*                                                                 10800058
107800     MOVE PC-15                   TO PV-LINE-CNT.                 10810058
107900*                                                                 10820058
108000*                                                                 10830058
108100 8200-WRITE-TOP-LINE.                                             10840058
108200******************************************************************10850058
108300*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *10860058
108400*     NEEDED FOR AN ASN NUMBER.                                  *10870058
108500******************************************************************10880058
108600     ADD 1                        TO PV-PAGE-CNT.                 10890058
108700*                                                                 10900058
108800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          10910058
108900*                                                                 10920058
109000     WRITE SU-CARTON-AUDIT-RPT-RECORD                             10930058
109100       FROM DP132O-STANDRD-HEADER-132-COLS                        10940058
109200         AFTER ADVANCING PAGE.                                    10950058
109300*                                                                 10960058
109400*                                                                 10970058
109500 8400-WRITE-DETAIL-LINES.                                         10980058
109600******************************************************************10990058
109700*     WRITES THE DETAIL LINE INFORMATION.                        *11000058
109800******************************************************************11010058
109900     WRITE SU-CARTON-AUDIT-RPT-RECORD                             11020058
110000       FROM DETAIL-LINE1                                          11030058
110100         AFTER ADVANCING 1 LINE.                                  11040058
110200*                                                                 11050058
110300     ADD +1                          TO PV-LINE-CNT.              11060058
110400*                                                                 11070058
110500*                                                                 11080058
110600******************************************************************11090058
110700*     SQL WARNING OR ERROR PROCESSING                            *11100058
110800******************************************************************11110058
110900                                                                  11120058
111000*                                                                 11130058
111100 Z999-SQL-ERROR.                                                  11140058
111200*---------------                                                  11150058
111300                                                                  11160058
111400     MOVE SQLCODE    TO SQLCODE2.                                 11170058
111500     MOVE SQLERRD(3) TO SQLERRD3.                                 11180058
111600     DISPLAY '** ABEND **       ** = SQLERROR'.                   11190058
111700     DISPLAY '** PROGRAM        ** = SUKRP013'.                   11200058
111800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11210058
111900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11220058
112000     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   11230058
112100     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  11240058
112200     EXEC SQL                                                     11250058
112300         COMMIT                                                   11260058
112400     END-EXEC.                                                    11270058
112500     MOVE +4013 TO PV-ABEND-CODE.                                 11280058
112600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11290058
