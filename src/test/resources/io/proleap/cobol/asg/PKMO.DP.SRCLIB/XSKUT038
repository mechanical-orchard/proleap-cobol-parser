000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      XSKUT038.                                       00020000
000300 AUTHOR.          BARB ERTL.                                      00030000
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
000500 DATE-WRITTEN.    12/04/2002.                                     00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800**XS MQ TABLE LOAD - MESSAGE LOAD FOR LOCATION TABLES             00080000
000900******************************************************************00090000
001000**THIS PROGRAM TAKES MESSAGES FROM A FLAT FILE AND PUTS THEM IN   00100000
001100**THE MESSAGE QUEUE FOR PROCESSING.  THIS PROGRAM CAN BE USED     00110000
001200**FOR TESTING AND TO RELOAD MESSAGES WRITTEN TO A FLAT FILE.      00120000
001300******************************************************************00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002100     SELECT CONTROL-CARD-1                                        00210000
002200            ASSIGN TO INP01.                                      00220000
002300     SELECT CONTROL-CARD-2                                        00230000
002400            ASSIGN TO INP02.                                      00240000
002500     SELECT MESSAGE-FILE                                          00250000
002600            ASSIGN TO INP03.                                      00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  CONTROL-CARD-1                                               00310000
003200     RECORDING MODE F                                             00320000
003300     BLOCK CONTAINS 0 RECORDS                                     00330000
003400     LABEL RECORDS ARE OMITTED                                    00340000
003500     DATA RECORD IS CONTROL-CARD-1-RECORD.                        00350000
003600 01  CONTROL-CARD-1-RECORD           PIC X(080).                  00360000
003700                                                                  00370000
003800 FD  CONTROL-CARD-2                                               00380000
003900     RECORDING MODE F                                             00390000
004000     BLOCK CONTAINS 0 RECORDS                                     00400000
004100     LABEL RECORDS ARE OMITTED                                    00410000
004200     DATA RECORD IS CONTROL-CARD-2-RECORD.                        00420000
004300 01  CONTROL-CARD-2-RECORD           PIC X(080).                  00430000
004400                                                                  00440000
004500 FD  MESSAGE-FILE                                                 00450000
004600     RECORDING MODE F                                             00460000
004700     BLOCK CONTAINS 0 RECORDS                                     00470000
004800     LABEL RECORDS ARE OMITTED                                    00480000
004900     DATA RECORD IS MESSAGE-FILE-RECORD.                          00490000
005000 01  MESSAGE-FILE-RECORD             PIC X(500).                  00500001
005100                                                                  00510000
005200 WORKING-STORAGE SECTION.                                         00520000
005300******************************************************************00530000
005400**PROGRAM SWITCHES                                                00540000
005500******************************************************************00550000
005600 01  PS-PROGRAM-SWITCHES.                                         00560000
005700     05  PS-END-OF-MSGS-ON-Q-SW          PIC X(01)   VALUE 'Y'.   00570000
005800         88  PS-NO-MSGS                              VALUE 'N'.   00580000
005900         88  PS-MORE-MSGS                            VALUE 'Y'.   00590000
006000******************************************************************00600000
006100**CONTROL CARD 1 RECORD LAYOUT - QUEUE MANAGER NAME               00610000
006200******************************************************************00620000
006300 01  CC-CONTROL-CARD-1-LAYOUT.                                    00630000
006400     05  CC-QUEUE-MANAGER-NAME      PIC X(48)   VALUE SPACES.     00640000
006500     05  FILLER                     PIC X(32)   VALUE SPACES.     00650000
006600******************************************************************00660000
006700**CONTROL CARD 2 RECORD LAYOUT - ITEM QUEUE NAME                  00670000
006800******************************************************************00680000
006900 01  CC-CONTROL-CARD-2-LAYOUT.                                    00690000
007000     05  CC-ITEM-QUEUE-NAME         PIC X(48)   VALUE SPACES.     00700000
007100     05  FILLER                     PIC X(32)   VALUE SPACES.     00710000
007200******************************************************************00720000
007300**PROGRAM CONSTANTS                                               00730000
007400******************************************************************00740000
007500 01  PC-PROGRAM-CONSTANTS.                                        00750000
007600     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)   VALUE 'XSKUT038'. 00760000
007700******************************************************************00770000
007800******************************************************************00780000
007900**MQ WORKING STORAGE                                              00790000
008000******************************************************************00800000
008100 01  MQV-WORKING-STORAGE.                                         00810000
008200     05  MQV-MQCONN                 PIC  X(08) VALUE 'CSQBCONN'.  00820000
008300     05  MQV-MQOPEN                 PIC  X(08) VALUE 'CSQBOPEN'.  00830000
008400     05  MQV-MQINQ                  PIC  X(08) VALUE 'CSQBINQ'.   00840000
008500     05  MQV-MQPUT                  PIC  X(08) VALUE 'CSQBPUT'.   00850000
008600     05  MQV-MQGET                  PIC  X(08) VALUE 'CSQBGET'.   00860000
008700     05  MQV-MQCMIT                 PIC  X(08) VALUE 'CSQBCOMM'.  00870000
008800     05  MQV-MQBACK                 PIC  X(08) VALUE 'CSQBBACK'.  00880000
008900     05  MQV-MQCLOSE                PIC  X(08) VALUE 'CSQBCLOS'.  00890000
009000     05  MQV-MQDISC                 PIC  X(08) VALUE 'CSQBDISC'.  00900000
009100     05  MQV-MQCHECK                PIC  X(08) VALUE 'MQR2C'.     00910000
009200     05  MQV-HCONN                  PIC S9(09) BINARY VALUE 0.    00920000
009300     05  MQV-COMPLETION-CODE        PIC S9(09) BINARY.            00930000
009400     05  MQV-REASON                 PIC S9(09) BINARY.            00940000
009500     05  MQV-OPEN-OPTIONS           PIC S9(09) BINARY.            00950000
009600     05  MQV-GQ-HANDLE              PIC S9(09) BINARY VALUE 0.    00960000
009700     05  MQV-PQ-HANDLE              PIC S9(09) BINARY VALUE 0.    00970000
009800     05  MQV-REASON-TEXT            PIC X(30)  VALUE SPACES.      00980000
009900     05  MQV-MSGBUFFER              PIC X(450) VALUE SPACES.      00990000
010000     05  MQV-MSG                    PIC X(450) VALUE SPACES.      01000000
010100     05  MQV-ERRMSGBUF              PIC X(500) VALUE SPACES.      01010000
010200     05  MQV-MESSAGE-BUFFER         PIC X(500) VALUE SPACES.      01020000
010300     05  MQV-MSG-LENGTH             PIC S9(09) BINARY VALUE +500. 01030002
010400     05  MQV-DATA-LENGTH            PIC S9(09) BINARY.            01040000
010500******************************************************************01050000
010600**COPYBOOKS                                                       01060000
010700******************************************************************01070000
010800***INPUT FILE LAYOUT - RMS LOCATION MESSAGE COPYBOOK              01080000
010900     COPY HORD100.                                                01090000
011000***OBJECT-DESCRIPTOR.                                             01100000
011100 01  MQM-OBJECT-DESCRIPTOR.                                       01110000
011200     COPY CMQODV.                                                 01120000
011300***MESSAGE-DESCRIPTOR.                                            01130000
011400 01  MQM-MESSAGE-DESCRIPTOR.                                      01140000
011500     COPY CMQMDV.                                                 01150000
011600***GET-MESSAGE-OPTIONS.                                           01160000
011700 01  MQM-GET-MESSAGE-OPTIONS.                                     01170000
011800     COPY CMQGMOV.                                                01180000
011900***PUT-MESSAGE-OPTIONS.                                           01190000
012000 01  MQM-PUT-MESSAGE-OPTIONS.                                     01200000
012100     COPY CMQPMOV.                                                01210000
012200***CONSTANTS.                                                     01220000
012300 01  MQM-CONSTANTS.                                               01230000
012400     COPY CMQV.                                                   01240000
012500******************************************************************01250000
012600**PROGRAM COUNTERS                                                01260000
012700******************************************************************01270000
012800 01  PC-PROGRAM-COUNTERS.                                         01280000
012900     05  PC-MESSAGES-PUT-ON-QUEUE     PIC 9(05) VALUE ZEROS.      01290000
013000     05  PC-MSG-FILE-READ             PIC 9(05) VALUE ZEROS.      01300000
013100     05  PC-COMMIT-COUNTER            PIC 9(05) VALUE ZEROS.      01310000
013200******************************************************************01320000
013300**ERROR HANDLING                                                  01330000
013400******************************************************************01340000
013500 01  PV-MISC-ABEND-FIELDS.                                        01350000
013600     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      01360000
013700     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      01370000
013800     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      01380000
013900     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      01390000
014000 01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 01400000
014100     88  ABEND-4013-DB2-ERROR              VALUE +4013.           01410000
014200 PROCEDURE DIVISION.                                              01420000
014300***************************************************************** 01430000
014400 0000-MAINLINE.                                                   01440000
014500                                                                  01450000
014600     PERFORM 1000-INITIALIZATION.                                 01460000
014700     PERFORM 2000-PROCESS-RECORDS                                 01470000
014800             UNTIL PS-NO-MSGS.                                    01480000
014900     PERFORM 9000-WRAPUP.                                         01490000
015000     GOBACK.                                                      01500000
015100                                                                  01510000
015200******************************************************************01520000
015300**INITIALIZATION AREA                                             01530000
015400******************************************************************01540000
015500 1000-INITIALIZATION.                                             01550000
015600                                                                  01560000
015700     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01570000
015800                                                                  01580000
015900     OPEN INPUT  CONTROL-CARD-1                                   01590000
016000                 CONTROL-CARD-2                                   01600000
016100                 MESSAGE-FILE.                                    01610000
016200                                                                  01620000
016300     PERFORM 7000-READ-CONTROL-CARD-1.                            01630000
016400     PERFORM 7100-READ-CONTROL-CARD-2.                            01640000
016500                                                                  01650000
016600     IF  CC-QUEUE-MANAGER-NAME    =  SPACES                       01660000
016700      OR CC-ITEM-QUEUE-NAME       =  SPACES                       01670000
016800         DISPLAY 'QUEUE MANAGER NAME    ' CC-QUEUE-MANAGER-NAME   01680000
016900         DISPLAY 'ITEM QUEUE NAME       ' CC-ITEM-QUEUE-NAME      01690000
017000         PERFORM 9100-MQ-ABEND                                    01700000
017100     END-IF.                                                      01710000
017200                                                                  01720000
017300     PERFORM 1200-CONNECT-TO-QMGR.                                01730000
017400     PERFORM 1300-OPEN-LOCATION-QUEUE.                            01740000
017500                                                                  01750000
017600     PERFORM 7200-READ-MSG-FILE.                                  01760000
017700                                                                  01770000
017800******************************************************************01780000
017900**CONNECT TO THE QUEUE MANAGER                                    01790000
018000******************************************************************01800000
018100 1200-CONNECT-TO-QMGR.                                            01810000
018200                                                                  01820000
018300     MOVE '1200-CONNECT-TO-QMGR' TO PV-PARAGRAPH-NAME.            01830000
018400                                                                  01840000
018500     CALL MQV-MQCONN USING CC-QUEUE-MANAGER-NAME                  01850000
018600                           MQV-HCONN                              01860000
018700                           MQV-COMPLETION-CODE                    01870000
018800                           MQV-REASON.                            01880000
018900                                                                  01890000
019000     EVALUATE TRUE                                                01900000
019100        WHEN MQV-COMPLETION-CODE = MQCC-OK                        01910000
019200             CONTINUE                                             01920000
019300        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                01930000
019400             CALL MQV-MQCHECK USING MQV-REASON                    01940000
019500                                    MQV-REASON-TEXT               01950000
019600             DISPLAY 'QUEUE CONNECTING TO ' CC-QUEUE-MANAGER-NAME 01960000
019700             MOVE 'UNABLE TO CONNECT' TO PV-OPERATION-MSG-1       01970000
019800             PERFORM 9100-MQ-ABEND                                01980000
019900     END-EVALUATE.                                                01990000
020000                                                                  02000000
020100******************************************************************02010000
020200**OPEN THE QUEUE                                                  02020000
020300******************************************************************02030000
020400 1300-OPEN-LOCATION-QUEUE.                                        02040000
020500                                                                  02050000
020600     MOVE '1300-OPEN-LOCATION-QUEUE' TO PV-PARAGRAPH-NAME.        02060000
020700                                                                  02070000
020800     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        02080000
020900     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME.            02090000
021000                                                                  02100000
021100     COMPUTE MQV-OPEN-OPTIONS      = MQOO-OUTPUT                  02110000
021200                                   + MQOO-FAIL-IF-QUIESCING.      02120000
021300*                                  + MQOO-SET-IDENTITY-CONTEXT.   02130000
021400                                                                  02140000
021500     CALL MQV-MQOPEN USING MQV-HCONN                              02150000
021600                           MQM-OBJECT-DESCRIPTOR                  02160000
021700                           MQV-OPEN-OPTIONS                       02170000
021800                           MQV-PQ-HANDLE                          02180000
021900                           MQV-COMPLETION-CODE                    02190000
022000                           MQV-REASON.                            02200000
022100                                                                  02210000
022200     EVALUATE TRUE                                                02220000
022300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        02230000
022400             CONTINUE                                             02240000
022500        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                02250000
022600             CALL MQV-MQCHECK USING MQV-REASON                    02260000
022700                                    MQV-REASON-TEXT               02270000
022800             DISPLAY 'OPENING QUEUE ' CC-QUEUE-MANAGER-NAME       02280000
022900             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      02290000
023000             PERFORM 9200-DISCONNECT-QUEUE                        02300000
023100             PERFORM 9100-MQ-ABEND                                02310000
023200     END-EVALUATE.                                                02320000
023300                                                                  02330000
023400******************************************************************02340000
023500**PROCESSES INPUT FILE                                            02350000
023600******************************************************************02360000
023700 2000-PROCESS-RECORDS.                                            02370000
023800                                                                  02380000
023900     MOVE '2000-PROCESS-RECORDS' TO PV-PARAGRAPH-NAME.            02390000
024000                                                                  02400000
024100     PERFORM 2100-PUT-MESSAGE-QUEUE.                              02410000
024200                                                                  02420000
024300     IF  PC-COMMIT-COUNTER > 100                                  02430000
024400         PERFORM 2200-MQV-COMMIT                                  02440000
024500         INITIALIZE PC-COMMIT-COUNTER                             02450000
024600     END-IF.                                                      02460000
024700                                                                  02470000
024800     INITIALIZE HORD100-RECORD.                                   02480000
024900                                                                  02490000
025000     PERFORM 7200-READ-MSG-FILE.                                  02500000
025100                                                                  02510000
025200******************************************************************02520000
025300**PUT MESSAGE ON QUEUE FOR PROCESSING                             02530000
025400******************************************************************02540000
025500 2100-PUT-MESSAGE-QUEUE.                                          02550000
025600                                                                  02560000
025700     MOVE '2100-PUT-MESSAGE-QUEUE' TO PV-PARAGRAPH-NAME.          02570000
025800                                                                  02580000
025900     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        02590000
026000     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME.            02600000
026100                                                                  02610000
026200     MOVE HORD100-RECORD           TO MQV-MESSAGE-BUFFER.         02620000
026300     MOVE MQMI-NONE                TO MQMD-MSGID.                 02630000
026400     MOVE MQCI-NONE                TO MQMD-CORRELID.              02640000
026500*    MOVE MQFMT-STRING             TO MQMD-FORMAT.                02650000
026600     MOVE MQPER-PERSISTENT         TO MQMD-PERSISTENCE.           02660000
026700                                                                  02670000
026800     COMPUTE MQPMO-CONTEXT  =  MQV-PQ-HANDLE.                     02680000
026900     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT.                   02690000
027000*                           +  MQPMO-SET-IDENTITY-CONTEXT.        02700000
027100                                                                  02710000
027200     CALL MQV-MQPUT USING MQV-HCONN                               02720000
027300                          MQV-PQ-HANDLE                           02730000
027400                          MQMD                                    02740000
027500                          MQPMO                                   02750000
027600                          MQV-MSG-LENGTH                          02760000
027700                          MQV-MESSAGE-BUFFER                      02770000
027800                          MQV-COMPLETION-CODE                     02780000
027900                          MQV-REASON.                             02790000
028000                                                                  02800000
028100     EVALUATE TRUE                                                02810000
028200        WHEN MQV-COMPLETION-CODE = MQCC-OK                        02820000
028300             ADD +1           TO PC-MESSAGES-PUT-ON-QUEUE         02830000
028400        WHEN MQV-COMPLETION-CODE NOT = MQCC-OK                    02840000
028500             CALL MQV-MQCHECK USING MQV-REASON                    02850000
028600                                    MQV-REASON-TEXT               02860000
028700             PERFORM 2300-BACK-OUT-MQ                             02870001
028800             PERFORM 9200-DISCONNECT-QUEUE                        02880000
028900             PERFORM 9100-MQ-ABEND                                02890000
029000     END-EVALUATE.                                                02900000
029100                                                                  02910000
029200******************************************************************02920000
029300**COMMIT MQ PROCESSING EVERY 100 MESSAGES                         02930000
029400******************************************************************02940000
029500 2200-MQV-COMMIT.                                                 02950000
029600                                                                  02960000
029700     MOVE '2200-MQV-COMMIT' TO PV-PARAGRAPH-NAME.                 02970000
029800                                                                  02980000
029900     CALL MQV-MQCMIT USING MQV-HCONN                              02990000
030000                           MQV-COMPLETION-CODE                    03000000
030100                           MQV-REASON.                            03010000
030200                                                                  03020000
030300     EVALUATE TRUE                                                03030000
030400        WHEN MQV-COMPLETION-CODE = MQCC-OK                        03040000
030500             CONTINUE                                             03050000
030600        WHEN MQV-COMPLETION-CODE NOT = MQCC-OK                    03060000
030700             CALL MQV-MQCHECK USING MQV-REASON                    03070000
030800                                    MQV-REASON-TEXT               03080000
030900             PERFORM 2300-BACK-OUT-MQ                             03090001
031000             PERFORM 9100-MQ-ABEND                                03100000
031100     END-EVALUATE.                                                03110000
031200                                                                  03120000
031300******************************************************************03130000
031400* BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       03140000
031500******************************************************************03150000
031600 2300-BACK-OUT-MQ.                                                03160001
031700                                                                  03170000
031800     CALL MQV-MQBACK USING MQV-HCONN                              03180000
031900                           MQV-COMPLETION-CODE                    03190000
032000                           MQV-REASON.                            03200000
032100                                                                  03210000
032200     EVALUATE TRUE                                                03220000
032300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        03230000
032400             CONTINUE                                             03240000
032500        WHEN MQV-COMPLETION-CODE NOT = MQCC-OK                    03250000
032600             CALL MQV-MQCHECK USING MQV-REASON                    03260000
032700                                    MQV-REASON-TEXT               03270000
032800             PERFORM 9100-MQ-ABEND                                03280000
032900     END-EVALUATE.                                                03290000
033000                                                                  03300000
033100***************************************************************** 03310000
033200**READ CONTROL CARD 1                                             03320000
033300***************************************************************** 03330000
033400 7000-READ-CONTROL-CARD-1.                                        03340000
033500                                                                  03350000
033600     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1-LAYOUT.           03360000
033700                                                                  03370000
033800***************************************************************** 03380000
033900**READ CONTROL CARD 2                                             03390000
034000***************************************************************** 03400000
034100 7100-READ-CONTROL-CARD-2.                                        03410000
034200                                                                  03420000
034300     READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2-LAYOUT.           03430000
034400                                                                  03440000
034500******************************************************************03450001
034600**READS NEXT MESSAGE FROM THE MESSAGE FILE                        03460001
034700******************************************************************03470001
034800 7200-READ-MSG-FILE.                                              03480001
034900                                                                  03490001
035000     MOVE '7200-READ-MSG-FILE' TO PV-PARAGRAPH-NAME.              03500001
035100                                                                  03510001
035200     READ MESSAGE-FILE INTO HORD100-RECORD                        03520001
035300          AT END                                                  03530001
035400             SET PS-NO-MSGS TO TRUE                               03540001
035500     END-READ.                                                    03550001
035600                                                                  03560001
035700     IF PS-MORE-MSGS                                              03570003
035800         ADD +1 TO PC-MSG-FILE-READ                               03580003
035900         ADD +1 TO PC-COMMIT-COUNTER                              03590003
036000     END-IF.                                                      03600003
036100                                                                  03610001
036200****************************************************************  03620000
036300*END OF PROGRAM ROUTINE                                           03630000
036400****************************************************************  03640000
036500 9000-WRAPUP.                                                     03650000
036600                                                                  03660000
036700     PERFORM 2200-MQV-COMMIT.                                     03670000
036800                                                                  03680000
036900     CLOSE CONTROL-CARD-1                                         03690000
037000           CONTROL-CARD-2                                         03700000
037100           MESSAGE-FILE.                                          03710000
037200                                                                  03720000
037300     PERFORM 9900-DISPLAY-STATISTICS.                             03730001
037400                                                                  03740000
037500******************************************************************03750000
037600**MQ ABEND ROUTINE                                                03760000
037700******************************************************************03770000
037800 9100-MQ-ABEND.                                                   03780000
037900                                                                  03790000
038000     DISPLAY '**** ABEND *************************************'.  03800000
038100     DISPLAY '** MQSERIES ERROR **'.                              03810000
038200     DISPLAY '** PROGRAM:    ' PC-CURRENT-PROGRAM-NAME.           03820000
038300     DISPLAY '** ABEND CODE: ' MQV-COMPLETION-CODE.               03830000
038400     DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH-NAME.                 03840000
038500     DISPLAY '** MESSAGE:    ' PV-OPERATION-MSG-1.                03850000
038600     DISPLAY '** COMP CODE:  ' MQV-COMPLETION-CODE.               03860000
038700     DISPLAY '** RSN CODE:   ' MQV-REASON.                        03870000
038800     DISPLAY '** RSN TEXT:   ' MQV-REASON-TEXT.                   03880000
038900     DISPLAY '************************************************'.  03890000
039000     MOVE +4013 TO ABEND-CODE.                                    03900000
039100     CALL 'ILBOABN0' USING ABEND-CODE.                            03910000
039200****************************************************************  03920000
039300*DISCONNECT FROM QUEUE IN THE EVENT OF ERROR OR END OF PROGRAM    03930000
039400****************************************************************  03940000
039500 9200-DISCONNECT-QUEUE.                                           03950000
039600                                                                  03960000
039700     CALL MQV-MQDISC USING MQV-HCONN                              03970000
039800                           MQV-COMPLETION-CODE                    03980000
039900                           MQV-REASON.                            03990000
040000                                                                  04000000
040100     EVALUATE TRUE                                                04010000
040200        WHEN MQV-COMPLETION-CODE = MQCC-OK                        04020000
040300             CONTINUE                                             04030000
040400        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                04040000
040500             DISPLAY 'UNABLE TO DISCONNECT FROM QUEUE'            04050000
040600             PERFORM 9100-MQ-ABEND                                04060000
040700     END-EVALUATE.                                                04070000
040800****************************************************************  04080000
040900*DISPLAY PROGRAM STATISTICS FOR THIS RUN                          04090000
041000****************************************************************  04100000
041100 9900-DISPLAY-STATISTICS.                                         04110001
041200                                                                  04120000
041300     DISPLAY '*********************************************'.     04130000
041400     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            04140000
041500     DISPLAY '*********************************************'.     04150000
041600     DISPLAY 'MESSAGES PUT ON QUEUE '   PC-MESSAGES-PUT-ON-QUEUE. 04160000
041700     DISPLAY 'MESSAGES READ FROM LOG: ' PC-MSG-FILE-READ.         04170000
