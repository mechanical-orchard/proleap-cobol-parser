000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300******************************************************************00030004
000400                                                                  00040004
000500 PROGRAM-ID.             PCKUT092.                                00050004
000600 AUTHOR.                 BRENDA ROCKWELL.                         00060004
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070004
000800 DATE-WRITTEN            DECEMBER, 2009.                          00080004
000900 DATE-COMPILED.                                                   00090004
001000                                                                  00100004
001100*----------------------------------------------------------------*00110004
001200* THIS PROGRAM WILL TAKE THE EXTRACTED TRAILER DETAIL            *00120004
001300* RECORDS FROM THE AUDIT ROUTINE AND PRODUCE ONE                 *00130004
001400* ONE OUTPUT FILE TO BE USED IN THE TRAILER REPORT PROGRAM.      *00140004
001500*                                                                *00150004
001600* THE INPUT AND OUTPUT FILE LAYOUTS ARE PCRD068.                 *00160004
001700*----------------------------------------------------------------*00170004
001800***************************************************************** 00180004
001900*  CHANGE LOG.                                                    00190004
002000*  DATE         CHANGED BY      DESC                              00200004
002100*  -----------  -------------- ---------------------------------- 00210004
002200*  10/07/2011   S. ANDERSON    EFC OPTIMIZATION AND HOLIDAY PREP  00220004
002300*               (CODEWORKS)     - ADDITIONAL DATA NEEDED FOR      00230004
002400*                                 SUMMARY REPORTS                 00240004
002500*                              PROJ ID:   3253                    00250004
002600*                              WR/IR#:   WR40392                  00260004
002700*  03/07/2014   VENKATESH S    CHANGES TO CALCULATE COMBO, RFID   00270004
002800*               (COGNIZANT)    AND QC AUDITS NEEDED FOR           00280004
002900*                                 SUMMARY REPORTS                 00290004
003000*                              PROJ ID:   5148D                   00300004
003100*                              CHANGES TAGGED *VSH 03/07/14       00310004
003200*  03/28/2014   SHOBHIT BAIJAL CHANGES TO REMOVE LOGIC TO COUNT   00320004
003300*               (COGNIZANT)    RF COMBO AND QC AUDITS AND INSTEAD 00330004
003400*                              JUST SUM THE VALUES FROM PCKUT091  00340004
003500*                              PROJ ID:   5148D                   00350004
003600*                              CHANGES TAGGED *SB 03/28/14        00360004
003700***************************************************************** 00370004
003800***************************************************************** 00380004
003900 ENVIRONMENT DIVISION.                                            00390004
004000***************************************************************** 00400004
004100 INPUT-OUTPUT SECTION.                                            00410004
004200                                                                  00420004
004300 FILE-CONTROL.                                                    00430004
004400                                                                  00440004
004500     SELECT INPUT-FILE ASSIGN TO INP01.                           00450004
004600                                                                  00460004
004700     SELECT EXTRACT-TRLR-RPT-FILE ASSIGN TO OUT01.                00470004
004800                                                                  00480004
004900***************************************************************** 00490004
005000 DATA DIVISION.                                                   00500004
005100***************************************************************** 00510004
005200 FILE SECTION.                                                    00520004
005300*                                                                 00530004
005400*                                                                 00540004
005500 FD  INPUT-FILE                                                   00550004
005600     RECORDING MODE IS F                                          00560004
005700     LABEL RECORDS ARE STANDARD                                   00570004
005800     BLOCK CONTAINS 0 RECORDS.                                    00580004
005900*VSH 03/07/14 - BEGIN PR#5148D                                    00590004
006000 01  INPUT-RECORD                PIC X(400).                      00600004
006100*VSH 03/07/14 - END PR#5148D                                      00610004
006200                                                                  00620004
006300 FD  EXTRACT-TRLR-RPT-FILE                                        00630004
006400     RECORDING MODE IS F                                          00640004
006500     LABEL RECORDS ARE STANDARD                                   00650004
006600     BLOCK CONTAINS 0 RECORDS.                                    00660004
006700*VSH 03/07/14 - BEGIN PR#5148D                                    00670004
006800 01  EXTRACT-TRLR-RPT-RECORD     PIC X(400).                      00680004
006900*VSH 03/07/14 - END PR#5148D                                      00690004
007000*                                                                 00700004
007100*                                                                 00710004
007200***************************************************************** 00720004
007300 WORKING-STORAGE SECTION.                                         00730004
007400                                                                  00740004
007500 01  PS-PROGRAM-SWITCHES.                                         00750004
007600     05  PS-END-OF-INPUT-FILE-SW      PIC X(01)  VALUE 'N'.       00760004
007700         88  PS-END-OF-INPUT-FILE                VALUE 'Y'.       00770004
007800         88  PS-NOT-END-OF-INPUT-FILE            VALUE 'N'.       00780004
007900*VSH 03/07/14 - BEGIN PR#5148D                                    00790004
008000     05  PS-LINE-LEVEL-FOUND-SW          PIC  X(01)  VALUE 'N'.   00800004
008100         88  PS-LINE-LEVEL-FOUND                     VALUE 'Y'.   00810004
008200         88  PS-NO-LINE-LEVEL-FOUND                  VALUE 'N'.   00820004
008300     05  PS-PO-LEVEL-FOUND-SW            PIC  X(01)  VALUE 'N'.   00830004
008400         88  PS-PO-LEVEL-FOUND                       VALUE 'Y'.   00840004
008500         88  PS-NO-PO-LEVEL-FOUND                    VALUE 'N'.   00850004
008600*VSH 03/07/14 - END PR#5148D                                      00860004
008700                                                                  00870004
008800 01  PV-PROGRAM-VARIABLES.                                        00880004
008900     05  PV-ATTR-DEPT                 PIC  S9(10)V9(5) COMP-3.    00890004
009000     05  PV-READ-COUNT                PIC S9(09) VALUE ZERO       00900004
009100                                                  COMP SYNC.      00910004
009200     05  PV-WRITE-COUNT               PIC S9(09) VALUE ZERO       00920004
009300                                                  COMP SYNC.      00930004
009400                                                                  00940004
009500     05  PV-DISPLAY-READ-CNT          PIC ZZZ,ZZZ,ZZ9.            00950004
009600     05  PV-DISPLAY-WRITE-CNT         PIC ZZZ,ZZZ,ZZ9.            00960004
009700                                                                  00970004
009800     05  PV-DISPLAY-TRIP-ID           PIC Z(8)9-.                 00980004
009900     05  PV-DISPLAY-PO-NBR            PIC Z(8)9-.                 00990004
010000     05  PV-DISPLAY-PO-LNE-NBR        PIC Z(8)9-.                 01000004
010100     05  PV-DISPLAY-RCVR-SEQ-NBR      PIC 9999-.                  01010004
010200                                                                  01020004
010300 01  PV-SAVE-FIELDS.                                              01030004
010400     05  PV-SAVE-TRIP-ID             PIC  S9(9) COMP.             01040004
010500     05  PV-SAVE-ZONE                PIC   X(05)  VALUE SPACES.   01050004
010600     05  PV-SAVE-RECORD.                                          01060004
010700         10 FILLER                   PIC   X(72)  VALUE SPACES.   01070004
010800         10 PV-SAVE-RECORD-ZONE      PIC   X(5)  VALUE SPACES.    01080004
010900         10 FILLER                   PIC   X(323) VALUE SPACES.   01090004
011000                                                                  01100004
011100 01  PV-TOTAL-FIELDS.                                             01110004
011200     05  PV-TOTAL-NBR-POS            PIC  S9(09) VALUE ZERO       01120004
011300                                                  COMP SYNC.      01130004
011400     05  PV-TOTAL-NBR-CTNS           PIC  S9(09) VALUE ZERO       01140004
011500                                                  COMP SYNC.      01150004
011600     05  PV-TOTAL-AUD-CTNS           PIC  S9(09) VALUE ZERO       01160004
011700                                                  COMP SYNC.      01170004
011800     05  PV-TOTAL-U-CTNS             PIC  S9(09) VALUE ZERO       01180004
011900                                                  COMP SYNC.      01190004
012000*VSH 03/07/14 - BEGIN PR#5148D                                    01200004
012100     05  PV-TOTAL-RFID-AUD-CTNS      PIC  S9(09) VALUE ZERO       01210004
012200                                                  COMP SYNC.      01220004
012300     05  PV-TOTAL-RFID-U-CTNS        PIC  S9(09) VALUE ZERO       01230004
012400                                                  COMP SYNC.      01240004
012500     05  PV-TOTAL-COMBO-CTNS         PIC  S9(09) VALUE ZERO       01250004
012600                                                  COMP SYNC.      01260004
012700*VSH 03/07/14 - END PR#5148D                                      01270004
012800     05  PV-TOTAL-CRSDK-CTNS         PIC  S9(09) VALUE ZERO       01280004
012900                                                  COMP SYNC.      01290004
013000     05  PV-TOTAL-P2L-CTNS           PIC  S9(09) VALUE ZERO       01300004
013100                                                  COMP SYNC.      01310004
013200     05  PV-TOTAL-P2L-CTNS-ZONE      PIC  S9(09) VALUE ZERO       01320004
013300                                                  COMP SYNC.      01330004
013400     05  PV-TOTAL-TRBL-CTNS          PIC  S9(09) VALUE ZERO       01340004
013500                                                  COMP SYNC.      01350004
013600     05  PV-TOTAL-SET-DVT-CTNS       PIC  S9(09) VALUE ZERO       01360004
013700                                                  COMP SYNC.      01370004
013800     05  PV-TOTAL-100-AUD-CTNS       PIC  S9(09) VALUE ZERO       01380004
013900                                                  COMP SYNC.      01390004
014000     05  PV-TOTAL-CTNS-TO-SCAN       PIC  S9(09) VALUE ZERO       01400004
014100                                                  COMP SYNC.      01410004
014200     05  PV-TOTAL-RFID-CTNS          PIC  S9(09) VALUE ZERO       01420004
014300                                                  COMP SYNC.      01430004
014400     05  PV-TOTAL-RFID-UNITS         PIC  S9(09) VALUE ZERO       01440004
014500                                                  COMP SYNC.      01450004
014600     05  PV-EFC-CTN-CNT              PIC  S9(09) VALUE ZERO       01460004
014700                                                  COMP SYNC.      01470004
014800     05  PV-EFC-UNT-CNT              PIC  S9(09) VALUE ZERO       01480004
014900                                                  COMP SYNC.      01490004
015000     05  PV-UNIT-CNT                 PIC  S9(09) VALUE ZERO       01500004
015100                                                  COMP SYNC.      01510004
015101*                                                                 01510106
015102*** DMH 7/1/14 - BEGIN                                            01510206
015110     05  PV-TOTAL-HAZ-CTNS           PIC  S9(09) VALUE ZERO       01511006
015120                                                  COMP SYNC.      01512006
015130     05  PV-TOTAL-HAZ-UNITS          PIC  S9(09) VALUE ZERO       01513006
015140                                                  COMP SYNC.      01514006
015150     05  PV-TOTAL-CNTL-FLOW-CTNS     PIC  S9(09) VALUE ZERO       01515006
015151                                                 COMP SYNC.       01515106
015152     05  PV-TOTAL-CNTL-FLOW-UNITS    PIC  S9(09) VALUE ZERO       01515206
015153                                                 COMP SYNC.       01515306
015160*** DMH 7/1/14 - BEGIN                                            01516006
015170*                                                                 01517006
015200 01 PC-PROGRAM-CONSTANTS.                                         01520004
015300     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'PCKUT092'. 01530004
015400                                                                  01540004
015500***********************************************************       01550004
015600*  RECORD LAYOUT FOR REPORT FILE                                  01560004
015700***********************************************************       01570004
015800*OUTPUT FILE LAYOUT                                               01580004
015900     COPY PCRD068.                                                01590004
016000                                                                  01600004
016100 EJECT                                                            01610004
016200                                                                  01620004
016300*VSH 03/07/14 - BEGIN PR#5148D                                    01630004
016400******************************************************            01640004
016500*  SUT00014 - SUT_PO_AUD_EXC                         *            01650004
016600******************************************************            01660004
016700     EXEC SQL                                                     01670004
016800          INCLUDE SUT00014                                        01680004
016900     END-EXEC.                                                    01690004
017000******************************************************            01700004
017100******************************************************            01710004
017200*  DB2 AREA FOR COMMUNICATIONS                       *            01720004
017300******************************************************            01730004
017400     EXEC SQL                                                     01740004
017500          INCLUDE SQLCA                                           01750004
017600     END-EXEC.                                                    01760004
017700                                                                  01770004
017800     COPY SQLCA2.                                                 01780004
017900*VSH 03/07/14 - END PR#5148D                                      01790004
018000                                                                  01800004
018100***********************************************************       01810004
018200 PROCEDURE DIVISION.                                              01820004
018300***********************************************************       01830004
018400     DISPLAY '***BEGINNING PCKUT092***'.                          01840004
018500                                                                  01850004
018600     PERFORM 1000-INITIALIZE.                                     01860004
018700                                                                  01870004
018800     PERFORM 2000-PROCESS-EXTRACTS                                01880004
018900         UNTIL PS-END-OF-INPUT-FILE.                              01890004
019000                                                                  01900004
019100***DO NOT WRITE AN OUTPUT RECORD IF THE INPUT FILE DID NOT        01910004
019200***CONTAIN ANY RECORDS.                                           01920004
019300     IF PV-READ-COUNT > 0                                         01930004
019400        PERFORM 8000-WRITE-OUTPUT-RECORD                          01940004
019500     END-IF.                                                      01950004
019600                                                                  01960004
019700***TKMAQ68                                                        01970004
019800     IF PV-SAVE-ZONE NOT = SPACES                                 01980004
019900        MOVE SPACES TO PV-SAVE-RECORD-ZONE                        01990004
020000        MOVE ZERO   TO PV-TOTAL-P2L-CTNS-ZONE                     02000004
020100        PERFORM 8000-WRITE-OUTPUT-RECORD                          02010004
020200      END-IF                                                      02020004
020300***TKMAQ68                                                        02030004
020400                                                                  02040004
020500     PERFORM 9000-CLOSE-FILES.                                    02050004
020600                                                                  02060004
020700     GOBACK.                                                      02070004
020800                                                                  02080004
020900******************************************************************02090004
021000*  DO FIRST TIME PROGRAM INITIALIZE TASKS.                        02100004
021100 1000-INITIALIZE.                                                 02110004
021200******************************************************************02120004
021300     OPEN INPUT  INPUT-FILE                                       02130004
021400          OUTPUT EXTRACT-TRLR-RPT-FILE.                           02140004
021500                                                                  02150004
021600     INITIALIZE PC068-RECORD-LAYOUT.                              02160004
021700                                                                  02170004
021800*FIRST READ                                                       02180004
021900     PERFORM 7000-READ-INPUT-FILE.                                02190004
022000                                                                  02200004
022100     IF PS-END-OF-INPUT-FILE                                      02210004
022200         DISPLAY '** FILE IS EMPTY **'                            02220004
022300     ELSE                                                         02230004
022400         MOVE PC068-TRIP-ID TO PV-SAVE-TRIP-ID                    02240004
022500         MOVE PC068-STORE-ZONE TO PV-SAVE-ZONE                    02250004
022600     END-IF.                                                      02260004
022700                                                                  02270004
022800******************************************************************02280004
022900 1000-ZERO-TOTALS.                                                02290004
023000******************************************************************02300004
023100     MOVE ZERO TO PV-TOTAL-NBR-POS                                02310004
023200                  PV-TOTAL-NBR-CTNS                               02320004
023300                  PV-TOTAL-AUD-CTNS                               02330004
023400                  PV-TOTAL-U-CTNS                                 02340004
023500                  PV-TOTAL-CRSDK-CTNS                             02350004
023600                  PV-TOTAL-P2L-CTNS                               02360004
023700                  PV-TOTAL-P2L-CTNS-ZONE                          02370004
023800                  PV-TOTAL-TRBL-CTNS                              02380004
023900                  PV-TOTAL-SET-DVT-CTNS                           02390004
024000                  PV-TOTAL-100-AUD-CTNS                           02400004
024100                  PV-EFC-CTN-CNT                                  02410004
024200                  PV-EFC-UNT-CNT                                  02420004
024300                  PV-UNIT-CNT                                     02430004
024400                  PV-TOTAL-CTNS-TO-SCAN                           02440004
024500                  PV-TOTAL-RFID-CTNS                              02450004
024600                  PV-TOTAL-RFID-UNITS                             02460004
024700*VSH 03/07/14 - BEGIN PR#5148D                                    02470004
024800                  PV-TOTAL-RFID-AUD-CTNS                          02480004
024900                  PV-TOTAL-RFID-U-CTNS                            02490004
025000                  PV-TOTAL-COMBO-CTNS                             02500006
025100*VSH 03/07/14 - END PR#5148D                                      02510004
025110                                                                  02511006
025120*** DMH 7/1/14 - BEGIN                                            02512006
025130                  PV-TOTAL-HAZ-CTNS                               02513006
025150                  PV-TOTAL-HAZ-UNITS                              02515006
025170                  PV-TOTAL-CNTL-FLOW-CTNS                         02517006
025190                  PV-TOTAL-CNTL-FLOW-UNITS.                       02519006
025192*** DMH 7/1/14 - END                                              02519206
025193*                                                                 02519306
025200     MOVE SPACES TO PV-SAVE-ZONE.                                 02520004
025300***************************************************************** 02530004
025400 2000-PROCESS-EXTRACTS.                                           02540004
025500***************************************************************** 02550004
025600        IF PC068-TRIP-ID = PV-SAVE-TRIP-ID                        02560004
025700           IF PC068-STORE-ZONE = PV-SAVE-ZONE                     02570004
025800               PERFORM 2010-PROCESS-TRIP-ID                       02580004
025900           ELSE                                                   02590004
026000               MOVE ZERO TO PV-TOTAL-P2L-CTNS-ZONE                02600004
026100               PERFORM 8000-WRITE-OUTPUT-RECORD                   02610004
026200               PERFORM 2010-PROCESS-TRIP-ID                       02620004
026300           END-IF                                                 02630004
026400        ELSE                                                      02640004
026500           PERFORM 8000-WRITE-OUTPUT-RECORD                       02650004
026600** IF THE LAST RECORD WRITTEN WAS A 'ZONE' RECORD, WE NEED        02660004
026700** TO WRITE ANOTHER RECORD                                        02670004
026800           IF PV-SAVE-ZONE NOT = SPACES                           02680004
026900               MOVE SPACES TO PV-SAVE-RECORD-ZONE                 02690004
027000               MOVE ZERO   TO PV-TOTAL-P2L-CTNS-ZONE              02700004
027100               PERFORM 8000-WRITE-OUTPUT-RECORD                   02710004
027200           END-IF                                                 02720004
027300           PERFORM 1000-ZERO-TOTALS                               02730004
027400           PERFORM 2010-PROCESS-TRIP-ID                           02740004
027500           MOVE PC068-TRIP-ID TO PV-SAVE-TRIP-ID                  02750004
027600        END-IF                                                    02760004
027700                                                                  02770004
027800        PERFORM 7000-READ-INPUT-FILE.                             02780004
027900                                                                  02790004
028000***************************************************************** 02800004
028100 2010-PROCESS-TRIP-ID.                                            02810004
028200***************************************************************** 02820004
028300     COMPUTE PV-TOTAL-NBR-POS    = PV-TOTAL-NBR-POS + 1.          02830004
028400     COMPUTE PV-TOTAL-NBR-CTNS   =                                02840004
028500             PV-TOTAL-NBR-CTNS   + PC068-TOT-CTN-CNT.             02850004
028600*SB 03/28/14 - BEGIN PR#5148D                                     02860004
028700     COMPUTE PV-TOTAL-AUD-CTNS   =                                02870004
028800             PV-TOTAL-AUD-CTNS   + PC068-AUD-CRTNS-TRLR.          02880004
028900     COMPUTE PV-TOTAL-U-CTNS     =                                02890004
029000             PV-TOTAL-U-CTNS     + PC068-AUD-CRTNS-TRLR-U.        02900004
029100     COMPUTE PV-TOTAL-RFID-AUD-CTNS   =                           02910004
029200             PV-TOTAL-RFID-AUD-CTNS + PC068-RFID-AUD-CRTNS-TRLR.  02920004
029300     COMPUTE PV-TOTAL-COMBO-CTNS      =                           02930004
029400             PV-TOTAL-COMBO-CTNS    + PC068-COMB-AUD-CRTNS-TRLR.  02940004
029500*SB 03/28/14 - END PR#5148D                                       02950004
029600     COMPUTE PV-TOTAL-CRSDK-CTNS =                                02960004
029700             PV-TOTAL-CRSDK-CTNS + PC068-XDCK-CTN-CNT.            02970004
029800     COMPUTE PV-TOTAL-P2L-CTNS   =                                02980004
029900             PV-TOTAL-P2L-CTNS   + PC068-P2L-CTN-CNT.             02990004
030000     COMPUTE PV-TOTAL-P2L-CTNS-ZONE =                             03000004
030100             PV-TOTAL-P2L-CTNS-ZONE + PC068-P2L-CTN-CNT.          03010004
030200     COMPUTE PV-TOTAL-TRBL-CTNS  =                                03020004
030300             PV-TOTAL-TRBL-CTNS  + PC068-TRBLE-CTN-LINE.          03030004
030400     COMPUTE PV-TOTAL-SET-DVT-CTNS =                              03040004
030500             PV-TOTAL-SET-DVT-CTNS + PC068-SET-DIVERT-CNT-PO.     03050004
030600     COMPUTE PV-TOTAL-100-AUD-CTNS =                              03060004
030700             PV-TOTAL-100-AUD-CTNS + PC068-AUD-CRTNS-100-PO.      03070004
030800     COMPUTE PV-TOTAL-CTNS-TO-SCAN =                              03080004
030900             PV-TOTAL-CTNS-TO-SCAN + PC068-CRTNS-TO-SCAN.         03090004
031000     COMPUTE PV-TOTAL-RFID-CTNS =                                 03100004
031100             PV-TOTAL-RFID-CTNS + PC068-RFID-CTN-CNT.             03110004
031200     COMPUTE PV-TOTAL-RFID-UNITS =                                03120004
031300             PV-TOTAL-RFID-UNITS + PC068-RFID-UNT-CNT             03130004
031301*                                                                 03130106
031302*** DMH - 7/1/14 - BEGIN                                          03130206
031310     COMPUTE PV-TOTAL-HAZ-CTNS  =                                 03131006
031311             PV-TOTAL-HAZ-CTNS  +  PC068-HAZ-CTN-CNT.             03131106
031320     COMPUTE PV-TOTAL-HAZ-UNITS =                                 03132006
031321             PV-TOTAL-HAZ-UNITS +  PC068-HAZ-UNT-CNT.             03132106
031330     COMPUTE PV-TOTAL-CNTL-FLOW-CTNS =                            03133006
031331             PV-TOTAL-CNTL-FLOW-CTNS +  PC068-CNTL-FLOW-CTN-CNT.  03133106
031340     COMPUTE PV-TOTAL-CNTL-FLOW-UNITS =                           03134006
031341             PV-TOTAL-CNTL-FLOW-UNITS + PC068-CNTL-FLOW-UNT-CNT.  03134106
031350*** DMH - 7/1/14 - END                                            03135006
031360*                                                                 03136006
031400                                                                  03140004
031500     IF PC068-EFC-NBR NOT = PC068-CURR-LOC                        03150004
031600        AND PC068-EFC-NBR NOT = 0                                 03160004
031700        IF PC068-TOT-CTN-CNT NUMERIC                              03170004
031800          COMPUTE PV-EFC-CTN-CNT =                                03180004
031900                  PV-EFC-CTN-CNT + PC068-TOT-CTN-CNT              03190004
032000        END-IF                                                    03200004
032100        IF PC068-UNIT-CNT NUMERIC                                 03210004
032200          COMPUTE PV-EFC-UNT-CNT =                                03220004
032300                  PV-EFC-UNT-CNT + PC068-UNIT-CNT                 03230004
032400        END-IF                                                    03240004
032500     END-IF.                                                      03250004
032600     COMPUTE PV-UNIT-CNT =                                        03260004
032700                  PV-UNIT-CNT + PC068-UNIT-CNT                    03270004
032800                                                                  03280004
032900     IF PC068-STORE-ZONE NOT = SPACES                             03290004
033000         MOVE PV-TOTAL-P2L-CTNS-ZONE TO PC068-P2L-CTN-CNT         03300004
033100     ELSE                                                         03310004
033200         MOVE PV-TOTAL-P2L-CTNS TO PC068-P2L-CTN-CNT.             03320004
033300                                                                  03330004
033400     MOVE 'TLR'               TO PC068-RECORD-TYPE.               03340004
033500*    MOVE PV-TOTAL-NBR-POS    TO PC068-PO-CNT-TRLR.               03350004
033600     MOVE PV-TOTAL-NBR-CTNS   TO PC068-TOT-CTN-CNT.               03360004
033700                                                                  03370004
033800     IF PC068-AUD-TYP NOT = 'M' AND                               03380004
033900        PC068-AUD-CRTNS-100-PO > 0                                03390004
034000        MOVE PC068-OPER-UNT-ID TO SUT00014-OPER-UNT-ID            03400004
034100        MOVE PC068-PO-NBR      TO SUT00014-PO-NBR                 03410004
034200        MOVE PC068-PO-LNE-NBR  TO SUT00014-PO-LNE-NBR             03420004
034300        MOVE PC068-PACK-ID     TO SUT00014-PO-PREPK-ID            03430004
034400        IF PC068-PKG-TYPE = 'B' OR 'C'                            03440004
034500           PERFORM 7500-SELECT-BULK                               03450004
034600        ELSE IF PC068-PKG-TYPE = 'M' OR 'I'                       03460004
034700                PERFORM 7550-SELECT-PRE-PACK                      03470004
034800             END-IF                                               03480004
034900        END-IF                                                    03490004
035000        IF PS-NO-LINE-LEVEL-FOUND                                 03500004
035100            PERFORM 7600-SELECT-PO-LEVEL                          03510004
035200        END-IF                                                    03520004
035300                                                                  03530004
035400        IF PS-LINE-LEVEL-FOUND OR PS-PO-LEVEL-FOUND               03540004
035500           IF PC068-AUD-TYP = SPACES                              03550004
035600              MOVE SUT00014-AUD-TYP-CDE TO PC068-AUD-TYP          03560004
035700           ELSE                                                   03570004
035800              IF SUT00014-AUD-TYP-CDE NOT = PC068-AUD-TYP         03580004
035900                 MOVE 'M'               TO PC068-AUD-TYP          03590004
036000              END-IF                                              03600004
036100           END-IF                                                 03610004
036200        END-IF                                                    03620004
036300     END-IF.                                                      03630004
036400*VSH 03/07/14 - END PR#5148D                                      03640004
036500                                                                  03650004
036600*SB 03/28/14 - BEGIN PR#5148D                                     03660004
036700     MOVE PV-TOTAL-AUD-CTNS      TO PC068-AUD-CRTNS-TRLR.         03670004
036800     MOVE PV-TOTAL-U-CTNS        TO PC068-AUD-CRTNS-TRLR-U.       03680004
036900     MOVE PV-TOTAL-RFID-AUD-CTNS TO PC068-RFID-AUD-CRTNS-TRLR.    03690004
037000     MOVE PV-TOTAL-COMBO-CTNS    TO PC068-COMB-AUD-CRTNS-TRLR.    03700004
037100*SB 03/28/14 - END PR#5148D                                       03710004
037200                                                                  03720004
037300     MOVE PV-TOTAL-CRSDK-CTNS TO PC068-XDCK-CTN-CNT.              03730004
037400     MOVE PV-TOTAL-TRBL-CTNS  TO PC068-TRBLE-CTN-CNT-TRLR.        03740004
037500     MOVE PV-TOTAL-SET-DVT-CTNS TO PC068-SET-DIVERT-CNT-TRLR.     03750004
037600     MOVE PV-TOTAL-100-AUD-CTNS TO PC068-AUD-CRTNS-100-TRLR.      03760004
037700     MOVE PV-TOTAL-CTNS-TO-SCAN TO PC068-CRTNS-TO-SCAN-TRLR.      03770004
037800     MOVE PV-TOTAL-RFID-CTNS    TO PC068-RFID-CTN-CNT.            03780004
037900     MOVE PV-TOTAL-RFID-UNITS   TO PC068-RFID-UNT-CNT.            03790004
038000*    MOVE PV-SAVE-ZONE          TO PC068-STORE-ZONE.              03800004
038100     MOVE PC068-STORE-ZONE      TO PV-SAVE-ZONE.                  03810004
038200                                                                  03820004
038300     MOVE PV-EFC-CTN-CNT        TO PC068-EFC-CTN-CNT-TRLR.        03830004
038400     MOVE PV-EFC-UNT-CNT        TO PC068-EFC-UNT-CNT-TRLR.        03840004
038500     MOVE PV-UNIT-CNT           TO PC068-UNIT-CNT-TRLR.           03850004
038600                                                                  03860004
038610*                                                                 03861006
038620*** DMH - 7/1/14 - BEGIN                                          03862006
038640     MOVE PV-TOTAL-HAZ-CTNS        TO PC068-HAZ-CTN-CNT.          03864006
038660     MOVE PV-TOTAL-HAZ-UNITS       TO PC068-HAZ-UNT-CNT.          03866006
038680     MOVE PV-TOTAL-CNTL-FLOW-CTNS  TO PC068-CNTL-FLOW-CTN-CNT.    03868006
038691     MOVE PV-TOTAL-CNTL-FLOW-UNITS TO PC068-CNTL-FLOW-UNT-CNT.    03869106
038692*** DMH - 7/1/14 - END                                            03869206
038693*                                                                 03869306
038700     MOVE PC068-RECORD-LAYOUT TO PV-SAVE-RECORD.                  03870004
038800                                                                  03880004
038900***************************************************************** 03890004
039000 7000-READ-INPUT-FILE.                                            03900004
039100***************************************************************** 03910004
039200      READ INPUT-FILE INTO PC068-RECORD-LAYOUT                    03920004
039300        AT END                                                    03930004
039400           SET PS-END-OF-INPUT-FILE TO TRUE                       03940004
039500        NOT AT END                                                03950004
039600           ADD +1 TO PV-READ-COUNT                                03960004
039700      END-READ.                                                   03970004
039800                                                                  03980004
039900*VSH 03/07/14 - BEGIN PR#5148D                                    03990004
040000***************************************************************** 04000004
040100 7500-SELECT-BULK.                                                04010004
040200                                                                  04020004
040300     EXEC SQL                                                     04030004
040400          SELECT AUD_TYP_CDE                                      04040004
040500          INTO   :SUT00014-AUD-TYP-CDE                            04050004
040600          FROM   SUT_PO_AUD_EXC                                   04060004
040700          WHERE  PO_NBR        = :SUT00014-PO-NBR                 04070004
040800            AND  PO_LNE_NBR    = :SUT00014-PO-LNE-NBR             04080004
040900            AND  OPER_UNT_ID   = :SUT00014-OPER-UNT-ID            04090004
041000          WITH UR                                                 04100004
041100     END-EXEC.                                                    04110004
041200                                                                  04120004
041300     EVALUATE TRUE                                                04130004
041400         WHEN SQLCODE = ZERO                                      04140004
041500             SET PS-LINE-LEVEL-FOUND     TO TRUE                  04150004
041600         WHEN OTHER                                               04160004
041700             SET PS-NO-LINE-LEVEL-FOUND  TO TRUE                  04170004
041800     END-EVALUATE.                                                04180004
041900                                                                  04190004
042000 7550-SELECT-PRE-PACK.                                            04200004
042100                                                                  04210004
042200     EXEC SQL                                                     04220004
042300          SELECT AUD_TYP_CDE                                      04230004
042400          INTO   :SUT00014-AUD-TYP-CDE                            04240004
042500          FROM   SUT_PO_AUD_EXC                                   04250004
042600          WHERE  PO_NBR        = :SUT00014-PO-NBR                 04260004
042700            AND  PO_PREPK_ID   = :SUT00014-PO-PREPK-ID            04270004
042800            AND  OPER_UNT_ID   = :SUT00014-OPER-UNT-ID            04280004
042900           WITH UR                                                04290004
043000     END-EXEC.                                                    04300004
043100                                                                  04310004
043200     EVALUATE TRUE                                                04320004
043300         WHEN SQLCODE = ZERO                                      04330004
043400             SET PS-LINE-LEVEL-FOUND     TO TRUE                  04340004
043500         WHEN OTHER                                               04350004
043600             SET PS-NO-LINE-LEVEL-FOUND  TO TRUE                  04360004
043700     END-EVALUATE.                                                04370004
043800                                                                  04380004
043900 7600-SELECT-PO-LEVEL.                                            04390004
044000                                                                  04400004
044100     EXEC SQL                                                     04410004
044200          SELECT AUD_TYP_CDE                                      04420004
044300          INTO   :SUT00014-AUD-TYP-CDE                            04430004
044400          FROM   SUT_PO_AUD_EXC                                   04440004
044500          WHERE  PO_NBR        = :SUT00014-PO-NBR                 04450004
044600            AND  PO_LNE_NBR    = 0                                04460004
044700            AND  PO_PREPK_ID   = 0                                04470004
044800            AND  OPER_UNT_ID   = :SUT00014-OPER-UNT-ID            04480004
044900           WITH UR                                                04490004
045000     END-EXEC.                                                    04500004
045100                                                                  04510004
045200     EVALUATE TRUE                                                04520004
045300         WHEN SQLCODE = ZERO                                      04530004
045400              SET PS-PO-LEVEL-FOUND     TO TRUE                   04540004
045500         WHEN OTHER                                               04550004
045600              SET PS-NO-PO-LEVEL-FOUND  TO TRUE                   04560004
045700     END-EVALUATE.                                                04570004
045800*VSH 03/07/14 - END PR#5148D                                      04580004
045900                                                                  04590004
046000***************************************************************** 04600004
046100 8000-WRITE-OUTPUT-RECORD.                                        04610004
046200***************************************************************** 04620004
046300     WRITE EXTRACT-TRLR-RPT-RECORD                                04630004
046400       FROM PV-SAVE-RECORD.                                       04640004
046500                                                                  04650004
046600     ADD +1 TO PV-WRITE-COUNT.                                    04660004
046700                                                                  04670004
046800***************************************************************** 04680004
046900 9000-CLOSE-FILES.                                                04690004
047000                                                                  04700004
047100     DISPLAY ' '.                                                 04710004
047200     DISPLAY '**************************************************'.04720004
047300     DISPLAY 'PROGRAM.................'   PC-PROGRAM-NAME.        04730004
047400     DISPLAY ' '.                                                 04740004
047500     MOVE PV-READ-COUNT              TO PV-DISPLAY-READ-CNT.      04750004
047600     DISPLAY 'TOT RECS READ       : '   PV-DISPLAY-READ-CNT.      04760004
047700     DISPLAY ' '.                                                 04770004
047800                                                                  04780004
047900     MOVE PV-WRITE-COUNT              TO PV-DISPLAY-WRITE-CNT.    04790004
048000     DISPLAY 'TOT RECS WRITTEN : '   PV-DISPLAY-WRITE-CNT.        04800004
048100                                                                  04810004
048200     CLOSE INPUT-FILE                                             04820004
048300           EXTRACT-TRLR-RPT-FILE.                                 04830004
048400                                                                  04840004
