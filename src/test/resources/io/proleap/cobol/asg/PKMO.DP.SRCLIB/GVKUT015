000100******************************************************************00010076
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*                                                                 00040000
000500 PROGRAM-ID.    GVKUT015.                                         00050070
000600 AUTHOR.        JIM ARENDT.                                       00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  03/18.                                            00080000
001000*                                                                 00090000
001100*----------------------------------------------------------------*00100000
001200*         STORE TRANSFER PROCESSING FOR BOSS                     *00110000
001300*----------------------------------------------------------------*00120000
001900                                                                  00130000
001020******************************************************************00131085
001030*  CHANGE LOG                                                     00132085
001040*  DATE       CHANGED BY      DESC                                00133085
001050*  ---------- -------------   ------------------------------------00134085
001102*  12/2019    CHG0238695 BOB MCASEY                               00137086
001102*                             PREVENT THE PROGRAM FROM ABENDING   00138086
001102*                             WHEN A SKU IS NOT FOUND.  SET A RC  00138185
001102*                             OF 4008.                            00138285
250113*  10/2020    CHG0250113      JIM HUNTER                          00138394
250113*                             CHECK FOR ECOM (SHIP STORE) PRICE   00138494
250113*                             AND USE IT WHEN FOUND. IF NOT FOUND 00138594
250113*                             CONTINUE TO USE CORP LOC ZERO PRICE.00138694
250113*                             ADDED PARA C350-SELECT-SKU-STR.     00138794
001103******************************************************************00139085
002000******************************************************************00140000
002100 ENVIRONMENT DIVISION.                                            00150000
002200******************************************************************00160000
002300                                                                  00170000
002400 CONFIGURATION SECTION.                                           00180000
002500                                                                  00190000
002600 OBJECT-COMPUTER.  IBM-3090.                                      00200000
002700 SOURCE-COMPUTER.  IBM-3090.                                      00210000
002800                                                                  00220000
004500******************************************************************00230000
002900 INPUT-OUTPUT SECTION.                                            00240000
003000                                                                  00250000
003100 FILE-CONTROL.                                                    00260000
003000                                                                  00270000
003200     SELECT BOSS-INPUT-FILE                                       00280000
003300         ASSIGN TO INP01.                                         00290000
003000                                                                  00300067
003200     SELECT BOSS-DATE-FILE                                        00310067
003300         ASSIGN TO INP02.                                         00320067
003000                                                                  00330000
003400     SELECT MERCHANDISE-LEDGER-FILE                               00340000
003500         ASSIGN TO OUT01.                                         00350000
003000                                                                  00360000
003600     SELECT SKU-INTRANSIT-FILE                                    00370001
003700         ASSIGN TO OUT02.                                         00380000
003000                                                                  00390000
003800     SELECT SKU-ADJUST-FILE                                       00400000
003900         ASSIGN TO OUT03.                                         00410000
003000                                                                  00420000
003800     SELECT SKU-MISLOAD-FILE                                      00430000
003900         ASSIGN TO OUT04.                                         00440000
003000                                                                  00450000
003800     SELECT BOSS-OUTPUT-FILE                                      00460000
003900         ASSIGN TO OUT05.                                         00470000
003900                                                                  00480010
003900     SELECT SKU-RECEIPTS-FILE                                     00490054
003900         ASSIGN TO OUT06.                                         00500054
003900                                                                  00510028
004500******************************************************************00520000
004600 DATA DIVISION.                                                   00530000
004700******************************************************************00540000
004900 FILE SECTION.                                                    00550000
005000                                                                  00560000
005100 FD  BOSS-INPUT-FILE                                              00570000
005200     RECORDING MODE IS F                                          00580000
005300     LABEL RECORDS ARE STANDARD                                   00590000
005400     RECORD CONTAINS 130 CHARACTERS                               00600000
005500     BLOCK CONTAINS 0 RECORDS.                                    00610000
005600                                                                  00620000
005700 01  BOSS-INPUT-RECORD           PIC  X(130).                     00630065
005800                                                                  00640000
005900                                                                  00650000
004400 FD  BOSS-DATE-FILE                                               00660067
004500     RECORDING MODE IS F                                          00670067
004600     LABEL RECORDS ARE STANDARD                                   00680067
005400     RECORD CONTAINS 80 CHARACTERS                                00690067
004700     BLOCK CONTAINS 0 RECORDS.                                    00700067
004800                                                                  00710067
004900 01  BOSS-DATE-RECORD                   PIC  X(80).               00720067
004300                                                                  00730067
004300                                                                  00740067
006000 FD  MERCHANDISE-LEDGER-FILE                                      00750000
006100     RECORDING MODE IS F                                          00760000
006200     LABEL RECORDS ARE STANDARD                                   00770000
006300     RECORD CONTAINS 80 CHARACTERS                                00780000
006400     BLOCK CONTAINS 0 RECORDS.                                    00790000
006500                                                                  00800000
006600 01  MERCHANDISE-LEDGER-RECORD   PIC  X(80).                      00810065
006700                                                                  00820000
006800                                                                  00830000
006900 FD  SKU-INTRANSIT-FILE                                           00840001
007000     RECORDING MODE IS F                                          00850000
007100     LABEL RECORDS ARE STANDARD                                   00860000
007200     RECORD CONTAINS 100 CHARACTERS                               00870000
007300     BLOCK CONTAINS 0 RECORDS.                                    00880000
007400                                                                  00890000
007500 01  SKU-INTRANSIT-RECORD        PIC  X(100).                     00900065
007600                                                                  00910000
007700                                                                  00920000
007800 FD  SKU-ADJUST-FILE                                              00930000
007900     RECORDING MODE IS F                                          00940000
008000     LABEL RECORDS ARE STANDARD                                   00950000
008100     RECORD CONTAINS 200 CHARACTERS                               00960000
008200     BLOCK CONTAINS 0 RECORDS.                                    00970000
008300                                                                  00980000
008400 01  SKU-ADJUST-RECORD           PIC  X(200).                     00990065
008500                                                                  01000000
008500                                                                  01010000
007800 FD  SKU-MISLOAD-FILE                                             01020000
007900     RECORDING MODE IS F                                          01030000
008000     LABEL RECORDS ARE STANDARD                                   01040000
008100     RECORD CONTAINS 100 CHARACTERS                               01050000
008200     BLOCK CONTAINS 0 RECORDS.                                    01060000
008300                                                                  01070000
008400 01  SKU-MISLOAD-RECORD          PIC  X(100).                     01080065
008300                                                                  01090000
005000                                                                  01100000
005100 FD  BOSS-OUTPUT-FILE                                             01110000
005200     RECORDING MODE IS F                                          01120000
005300     LABEL RECORDS ARE STANDARD                                   01130000
005400     RECORD CONTAINS 130 CHARACTERS                               01140000
005500     BLOCK CONTAINS 0 RECORDS.                                    01150000
005600                                                                  01160000
005700 01  BOSS-OUTPUT-RECORD          PIC  X(130).                     01170065
005000                                                                  01180000
024600 FD  SKU-RECEIPTS-FILE                                            01190054
024500     RECORDING MODE IS F                                          01200054
025000     LABEL RECORDS ARE STANDARD                                   01210054
025000     RECORD CONTAINS 200 CHARACTERS                               01220054
019000     BLOCK CONTAINS 0 RECORDS.                                    01230054
024600                                                                  01240054
024500 01  SKU-RECEIPTS-RECORD         PIC  X(200).                     01250065
025000                                                                  01260054
025000******************************************************************01270054
019000 WORKING-STORAGE SECTION.                                         01280054
024400 01  PC-PROGRAM-CONSTANTS.                                        01290000
024600     05  PC-PROGRAM-NAME         PIC  X(08)    VALUE 'GVKUT015'.  01300070
024500     05  PC-MERCH-TRAN-CODE      PIC  X(01)    VALUE '3'.         01310000
025000     05  PC-INV-SHIP             PIC  X(04)    VALUE 'SHIP'.      01320003
025000     05  PC-INV-RECV             PIC  X(04)    VALUE 'RECV'.      01330003
026900                                                                  01340000
015200 01  PV-PROGRAM-VARIABLES.                                        01350000
015300     05  PV-ML-QTY               PIC  9(05).                      01360000
016200     05  PV-SQLCODE              PIC  9(09)     VALUE ZERO.       01370000
010310     05  PV-UNIT-RETAIL          PIC  9(05)V99  VALUE ZEROS.      01380000
010320     05  PV-UNIT-RETAIL-QTY      PIC  9(05)V99  VALUE ZEROS.      01390000
071000     05  PV-SKU-NMBR             PIC  9(08).                      01400000
071100     05  PV-SKU REDEFINES PV-SKU-NMBR.                            01410000
071200         10 FILLER               PIC  X(08).                      01420000
007500     05  PV-BATCH-NMBR.                                           01430000
007600         10  FILLER              PIC  X(01)     VALUE '0'.        01440000
007500         10  PV-BATCH-NMBR-LAST3.                                 01450000
007600             15  FILLER          PIC  X(01)     VALUE '6'.        01460000
007700             15  PV-BATCH-DAY    PIC  X(02)     VALUE SPACES.     01470000
020000     05  PV-SKU-NUM.                                              01480000
020100         10  PV-SKUNUM-DEPT      PIC  9(03).                      01490000
020200         10  PV-SKUNUM-CLASS     PIC  9(02).                      01500000
020300         10  PV-SKUNUM-SUBCLASS  PIC  9(02).                      01510000
020400     05  PV-NEW-SKU.                                              01520000
020500         10  PV-NEW-SKU-DEPT     PIC  X(03).                      01530000
020600         10  PV-NEW-SKU-CLASS    PIC  X(02).                      01540000
020700         10  PV-NEW-SKU-SUBCLASS PIC  X(02).                      01550000
012000     05  PV-MAJ-CL-NBR-9         PIC  9(04).                      01560000
012000     05  PV-MAJ-CL-NBR-X   REDEFINES  PV-MAJ-CL-NBR-9             01570000
012000                                 PIC  X(04).                      01580000
012000     05  PV-SUB-CL-NBR-9         PIC  9(04).                      01590000
012000     05  PV-SUB-CL-NBR-X   REDEFINES  PV-SUB-CL-NBR-9             01600000
012000                                 PIC  X(04).                      01610000
005500     05  PV-ORIG-TRIP-ID         PIC  9(09).                      01620000
005500     05  PV-ORIG-TRIP-ID-X REDEFINES  PV-ORIG-TRIP-ID             01630000
005500                                 PIC  X(09).                      01640000
005500     05  PV-SCAN-TRIP-ID         PIC  9(09).                      01650000
005500     05  PV-SCAN-TRIP-ID-X REDEFINES  PV-SCAN-TRIP-ID             01660000
005500                                 PIC  X(09).                      01670000
005500     05  PV-RCVR-SEQ-NBR-9       PIC  9(04).                      01680000
005500     05  PV-RCVR-SEQ-NBR-X REDEFINES  PV-RCVR-SEQ-NBR-9           01690000
005500                                 PIC  X(04).                      01700000
005500     05  PV-TRN-LNE-NBR-9        PIC  9(04).                      01710000
005500     05  PV-TRN-LNE-NBR-X   REDEFINES  PV-TRN-LNE-NBR-9           01720000
005500                                 PIC  X(04).                      01730000
005500     05  PV-TO-STR-NBR-X.                                         01740000
005500         10  FILLER              PIC  X(02).                      01750022
005500         10  PV-TO-TRANSFER      PIC  X(03).                      01760022
005500     05  PV-TO-STR-NBR-9  REDEFINES PV-TO-STR-NBR-X               01770000
005500                                 PIC  9(05).                      01780000
005500     05  PV-FROM-STR-NBR-X.                                       01790000
005500         10  FILLER              PIC  X(03).                      01800022
005500         10  PV-FROM-TRANSFER    PIC  X(02).                      01810022
005500     05  PV-FROM-STR-NBR-9  REDEFINES PV-FROM-STR-NBR-X           01820022
005500                                 PIC  9(05).                      01830000
005500     05  PV-TRANSFER-NBR.                                         01840000
005500         10  PV-TRANSFER-FROM    PIC  X(02).                      01850022
005500         10  PV-TRANSFER-TO      PIC  X(03).                      01860022
005500     05  PV-PARM-BOSS-RECV       PIC S9(09) COMP.                 01870009
027000     05  PV-DB2-TMST-DATE        PIC  X(26)    VALUE SPACES.      01880019
027000     05  PV-DB2-TMST-DATE-PLUS   PIC  X(26)    VALUE SPACES.      01890019
027000     05  PV-DUMMY-DATE           PIC  X(10)    VALUE SPACES.      01900068
017000                                                                  01910000
015200 01  PA-PROGRAM-ACCUMS.                                           01920000
015700     05  PA-SHIP-COUNTER         PIC S9(07)    COMP SYNC VALUE +0.01930074
015700     05  PA-RECEIVE-COUNTER      PIC S9(07)    COMP SYNC VALUE +0.01940074
015700     05  PA-CANCEL-COUNTER       PIC S9(07)    COMP SYNC VALUE +0.01950044
015700     05  PA-INPUT-RECORDS-READ   PIC S9(07)    COMP SYNC VALUE +0.01960044
015800     05  PA-MERCH-RECS-WR        PIC S9(07)    COMP SYNC VALUE +0.01970000
015800     05  PA-MERCH-HIGH-QTY-RECS  PIC S9(07)    COMP SYNC VALUE +0.01980000
016000     05  PA-ADJSHP-RECS-WR       PIC S9(07)    COMP SYNC VALUE +0.01990059
016000     05  PA-ADJCAN-RECS-WR       PIC S9(07)    COMP SYNC VALUE +0.02000059
024600     05  PA-RECEIPT-RECS-WR      PIC S9(07)    COMP SYNC VALUE +0.02010054
024500     05  PA-ARSE-COUNTS-WR       PIC S9(07)    COMP SYNC VALUE +0.02020054
025000     05  PA-UNSE-COUNTS-WR       PIC S9(07)    COMP SYNC VALUE +0.02030054
025000     05  PA-CANCEL-COUNTS-WR     PIC S9(07)    COMP SYNC VALUE +0.02040054
019000     05  PA-BOSS-OUTPUT-WR       PIC S9(07)    COMP SYNC VALUE +0.02050054
016100     05  PA-DISPLAY-COUNT        PIC  Z,ZZZ,ZZ9.                  02060000
1219RM     05  PA-RECS-SKIP-COUNTER    PIC S9(07)    COMP SYNC VALUE +0.02061079
1219RM     05  PA-RECS-PRC-DIF-COUNTER PIC S9(07)    COMP SYNC VALUE +0.02062092
016100                                                                  02070000
018100 01  PV-ABEND-FIELDS.                                             02080000
018500     05  PV-ABEND-PARAGRAPH          PIC  X(50) VALUE SPACES.     02090000
018600     05  PV-ABEND-OPERATION          PIC  X(50) VALUE SPACES.     02100000
018700     05  PV-ABEND-TABLE              PIC  X(08) VALUE SPACES.     02110014
019000     05  PV-DB2-OPERATION-MESSAGE-1  PIC  X(79) VALUE SPACES.     02120000
019100     05  PV-DB2-OPERATION-MESSAGE-2  PIC  X(79) VALUE SPACES.     02130000
019200     05  PV-DB2-OPERATION-MESSAGE-3  PIC  X(79) VALUE SPACES.     02140000
019500                                                                  02150000
006600 01  PV-INPUT-FILE.                                               02160068
027000     05  PV-BATCH-DATE-ISO-FMT       PIC  X(10).                  02170068
027100     05  FILLER      REDEFINES       PV-BATCH-DATE-ISO-FMT.       02180068
027300         10  PV-BATCH-DATE-CC        PIC  9(02).                  02190068
027300         10  PV-BATCH-DATE-YY        PIC  9(02).                  02200068
027700         10  FILLER                  PIC  X(01).                  02210068
027800         10  PV-BATCH-DATE-MM        PIC  9(02).                  02220068
028000         10  FILLER                  PIC  X(01).                  02230068
028100         10  PV-BATCH-DATE-DD        PIC  9(02).                  02240068
024100                                                                  02250000
012800 01  PS-PROGRAM-SWITCHES.                                         02260000
013300     05  PS-END-OF-INPUT-SW      PIC  X(01)     VALUE 'N'.        02270042
013500         88  PS-END-OF-INPUT                    VALUE 'Y'.        02280000
013500         88  PS-END-OF-INPUT-N                  VALUE 'N'.        02290000
007900     05  PS-END-OF-CONTROL-SW    PIC  X(01)     VALUE 'N'.        02300068
008000         88  PS-END-OF-CONTROL                  VALUE 'Y'.        02310068
008100         88  PS-NOT-END-OF-CONTROL              VALUE 'N'.        02320068
014800                                                                  02330000
014900 01  DK-DB2-KEY-FIELDS.                                           02340000
015000     05  DK-SKU                  PIC  9(08).                      02350000
015000     05  DK-DEPT-NBR             PIC  X(03).                      02360031
015000     05  DK-PO-NBR               PIC S9(09)     COMP.             02370042
015100                                                                  02380000
004500******************************************************************02390065
075400*  ABEND ROUTINE WORKING STORAGE                                  02400000
004500******************************************************************02410065
075600     COPY DPWS004.                                                02420000
075700                                                                  02430000
075800 01  ABEND-CODE                  PIC S9(04)    COMP SYNC VALUE +0.02440000
075900                                                                  02450000
004500******************************************************************02460065
076100*  DB2 TABLES                                                     02470000
004500******************************************************************02480065
076400     EXEC SQL                                                     02490000
076500        INCLUDE TCOCNTL                                           02500000
076600     END-EXEC.                                                    02510000
076700                                                                  02520009
076400     EXEC SQL                                                     02530009
076500        INCLUDE TKRPRPM                                           02540009
076600     END-EXEC.                                                    02550009
076700                                                                  02560000
076400     EXEC SQL                                                     02570029
076500        INCLUDE TENTNME                                           02580029
076600     END-EXEC.                                                    02590029
076700                                                                  02600029
076400     EXEC SQL                                                     02610029
076500        INCLUDE TVNDDPT                                           02620029
076600     END-EXEC.                                                    02630029
076700                                                                  02640029
076400     EXEC SQL                                                     02650029
076500        INCLUDE TEXTENT                                           02660029
076600     END-EXEC.                                                    02670029
076700                                                                  02680029
005000* * * XLV_SKU_STR VIEW                                            02681089
005100     EXEC SQL                                                     02682089
005200         INCLUDE XLV00002                                         02683089
005300     END-EXEC.                                                    02684089
076700                                                                  02685089
004500******************************************************************02690065
082700*  DB2 COMMUNICATION AREA                                         02700000
004500******************************************************************02710065
083000     EXEC SQL                                                     02720000
083100        INCLUDE SQLCA                                             02730000
083200     END-EXEC.                                                    02740000
083300                                                                  02750000
004500******************************************************************02760065
083500*  DB2 COMMUNICATION AREA 2                                       02770000
004500******************************************************************02780065
083700     COPY SQLCA2.                                                 02790000
083800                                                                  02800000
004500******************************************************************02810065
010600*COPYBOOK FOR LOGISTIC DOMAIN MODULE                              02820000
004500******************************************************************02830065
010800     COPY XLWS001.                                                02840000
010900                                                                  02850000
004500******************************************************************02860065
011000*   BOSS MQ INPUT RECORD LAYOUT.                                  02870054
004500******************************************************************02880065
011200     COPY GVRD002.                                                02890000
011300                                                                  02900000
004500******************************************************************02910065
011400*   MERCHANDISE LEDGER OUTPUT RECORD LAYOUT.                      02920000
004500******************************************************************02930065
011600     COPY MLRD019.                                                02940000
011700                                                                  02950000
004500******************************************************************02960065
011800*   FASHION SALES MAINTENANCE OUTPUT RECORD LAYOUTS.              02970000
004500******************************************************************02980065
012000     COPY FSRD035.                                                02990000
012100                                                                  03000000
012200     COPY FSRD036.                                                03010001
012100                                                                  03020026
004500******************************************************************03030065
011000*   OUTPUT RECORD LAYOUT.                                         03040000
004500******************************************************************03050065
012200     COPY PCRD010.                                                03060000
012100                                                                  03070028
083900******************************************************************03080000
084000 PROCEDURE DIVISION.                                              03090000
084100******************************************************************03100000
084300 A000-MAIN-DRIVER.                                                03110000
084400                                                                  03120000
084500     PERFORM B050-INITIALIZATION.                                 03130000
085500                                                                  03140000
085600     IF PS-END-OF-INPUT                                           03150000
085800         CONTINUE                                                 03160000
085900     ELSE                                                         03170000
086400         PERFORM B100-PROCESS-STR-MISLOADS                        03180000
086500             UNTIL PS-END-OF-INPUT                                03190000
087000     END-IF.                                                      03200000
087100                                                                  03210000
088000     PERFORM B300-EXIT-ROUTINE.                                   03220000
088100                                                                  03230000
088900     GOBACK.                                                      03240000
089000                                                                  03250000
084100******************************************************************03260000
089100 B050-INITIALIZATION.                                             03270000
026500                                                                  03280000
024300     DISPLAY ' '.                                                 03290000
024300     DISPLAY '**********************************'.                03300000
024400     DISPLAY '      START OF ' PC-PROGRAM-NAME                    03310013
024500     DISPLAY '**********************************'.                03320000
024300     DISPLAY ' '.                                                 03330000
026700                                                                  03340000
084700     OPEN INPUT  BOSS-INPUT-FILE                                  03350000
004400                 BOSS-DATE-FILE                                   03360067
084800          OUTPUT MERCHANDISE-LEDGER-FILE                          03370000
084900                 SKU-INTRANSIT-FILE                               03380001
024600                 SKU-RECEIPTS-FILE                                03390054
024500                 SKU-ADJUST-FILE                                  03400054
025000                 SKU-MISLOAD-FILE                                 03410054
025000                 BOSS-OUTPUT-FILE.                                03420054
019000                                                                  03430054
199800     PERFORM B060-RETRIEVE-TIMESTAMP.                             03440068
089600                                                                  03450009
034200     PERFORM B065-READ-BATCH-DATE.                                03460068
089600                                                                  03470068
199800     PERFORM B070-READ-PARM-TABLE.                                03480009
085300                                                                  03490000
085400     PERFORM Z100-READ-STR-MISLOADS.                              03500000
084600                                                                  03510000
084100******************************************************************03520000
199800 B060-RETRIEVE-TIMESTAMP.                                         03530068
199900                                                                  03540020
200000     EXEC SQL                                                     03550000
200100        SELECT BTCH_PRC_DTE                                       03560000
200100              ,CURRENT TIMESTAMP                                  03570019
200100              ,CURRENT TIMESTAMP + 1 MINUTE                       03580019
200200          INTO :PV-DUMMY-DATE                                     03590068
200200              ,:PV-DB2-TMST-DATE                                  03600019
200200              ,:PV-DB2-TMST-DATE-PLUS                             03610019
200200          FROM TCOCNTL                                            03620000
200200         WHERE OPER_UNT_ID = 90                                   03630000
200200         WITH UR                                                  03640066
200900     END-EXEC.                                                    03650000
201092                                                                  03660000
201100     EVALUATE TRUE                                                03670000
201200         WHEN SQLCODE = ZERO                                      03680000
028100             CONTINUE                                             03690069
201300                                                                  03700000
201600         WHEN OTHER                                               03710000
201800             MOVE 'B060-RETRIEVE-BATCH-DATE'                      03720000
201900                                        TO PV-ABEND-PARAGRAPH     03730000
205200             MOVE 'TCOCNTL'             TO PV-ABEND-TABLE         03740014
202000             MOVE 'SELECT BATCH DATE'   TO PV-ABEND-OPERATION     03750000
202100             PERFORM Z900-SQL-ABEND                               03760000
202200     END-EVALUATE.                                                03770000
202300                                                                  03780068
033800******************************************************************03790067
033900*  READ INPUT CONTROL CARD TO GET THE CURRENT BATCH PROCESSING    03800067
034000*  DATE.                                                          03810067
034100******************************************************************03820067
034200 B065-READ-BATCH-DATE.                                            03830068
034300                                                                  03840067
004400     READ BOSS-DATE-FILE                                          03850068
034500         INTO PV-INPUT-FILE                                       03860067
034600             AT END                                               03870067
034700                 MOVE 'Y' TO PS-END-OF-CONTROL-SW.                03880067
034800                                                                  03890067
034900     IF PS-END-OF-CONTROL                                         03900067
035000         DISPLAY ' '                                              03910067
035100         DISPLAY ' *** NO CONTROL CARD FOUND TO PROCESS ***'      03920067
035200         DISPLAY ' '                                              03930067
035300     ELSE                                                         03940067
035400         DISPLAY 'BATCH PROCESS DATE  = ' PV-BATCH-DATE-ISO-FMT   03950068
028100         MOVE PV-BATCH-DATE-DD      TO PV-BATCH-DAY               03960069
035500     END-IF.                                                      03970067
035600                                                                  03980067
084100******************************************************************03990009
199800 B070-READ-PARM-TABLE.                                            04000009
199900                                                                  04010009
200000     EXEC SQL                                                     04020009
200000         SELECT FUNC_QTY                                          04030009
200000           INTO :PV-PARM-BOSS-RECV                                04040009
200000           FROM TKRPRPM                                           04050009
200000          WHERE LOC_ID            =  90                           04060009
200000            AND SYS_PRC_FUNC_CDE  = 'BSSRCV'                      04070009
200000            AND INTFC_SYS_CDE     = 'GIV'                         04080009
200000            AND FUNC_PRC_STAT_CDE = 'AC'                          04090009
200000           WITH UR                                                04100009
200900     END-EXEC.                                                    04110009
201092                                                                  04120009
201100     EVALUATE TRUE                                                04130009
201200         WHEN SQLCODE = ZERO                                      04140009
028100             CONTINUE                                             04150009
201300                                                                  04160009
201600         WHEN OTHER                                               04170009
201800             MOVE 'B070-READ-PARM-TABLE'                          04180009
201900                                        TO PV-ABEND-PARAGRAPH     04190009
205200             MOVE 'TKRPRPM'             TO PV-ABEND-TABLE         04200014
202000             MOVE 'SELECT BOSS PARM'    TO PV-ABEND-OPERATION     04210009
202100             PERFORM Z900-SQL-ABEND                               04220009
202200     END-EVALUATE.                                                04230009
202300                                                                  04240009
084100******************************************************************04250000
099600 B100-PROCESS-STR-MISLOADS.                                       04260000
099700                                                                  04270000
099700     IF GV002-INV-TYPE = PC-INV-SHIP                              04280024
101400        ADD 1                   TO PA-SHIP-COUNTER                04290074
101400        PERFORM C300-PROCESS-SHPRCV-RECORD                        04300078
099700     ELSE                                                         04310074
099700        IF GV002-INV-TYPE = PC-INV-RECV                           04320074
101400           ADD 1                TO PA-RECEIVE-COUNTER             04330074
101400           PERFORM C300-PROCESS-SHPRCV-RECORD                     04340078
              ELSE                                                      04350074
101400           ADD 1                TO PA-CANCEL-COUNTER              04360074
101400           PERFORM C400-PROCESS-CANCEL-RECORD                     04370074
101500        END-IF                                                    04380074
101500     END-IF.                                                      04390074
                                                                        04400003
101600     PERFORM Z100-READ-STR-MISLOADS.                              04410000
101700                                                                  04420000
084100******************************************************************04430000
106300*   DISPLAY INPUT/OUTPUT RECORD COUNTS                            04440000
106300*   CLOSE INPUT/OUTPUT FILES                                      04450000
084100******************************************************************04460000
106300 B300-EXIT-ROUTINE.                                               04470000
106400                                                                  04480000
106600     DISPLAY ' --RECORDS READ--'.                                 04490045
106700                                                                  04500000
106800     MOVE PA-SHIP-COUNTER                  TO PA-DISPLAY-COUNT.   04510074
106900     DISPLAY '   SHIP RECORDS READ        = ' PA-DISPLAY-COUNT.   04520074
106700                                                                  04530047
106800     MOVE PA-RECEIVE-COUNTER               TO PA-DISPLAY-COUNT.   04540074
106900     DISPLAY '   RECV RECORDS READ        = ' PA-DISPLAY-COUNT.   04550074
106700                                                                  04560074
106800     MOVE PA-CANCEL-COUNTER                TO PA-DISPLAY-COUNT.   04570050
106900     DISPLAY '   CNCL RECORDS READ        = ' PA-DISPLAY-COUNT.   04580075
106700                                                                  04590047
106800     MOVE PA-INPUT-RECORDS-READ            TO PA-DISPLAY-COUNT.   04600050
106900     DISPLAY '      TOTAL RECORDS READ    = ' PA-DISPLAY-COUNT.   04610061
107000                                                                  04620000
107000                                                                  04630072
106500     DISPLAY ' '.                                                 04640000
106600     DISPLAY ' --RECORDS WRITTEN--'                               04650084
106500     DISPLAY '  SHIP RECORDS WRITTEN:'                            04660084
106500                                                                  04670000
185600     MOVE PA-BOSS-OUTPUT-WR                 TO PA-DISPLAY-COUNT.  04680084
107800     DISPLAY '   BOSS RPT RECORDS WRITTEN  = ' PA-DISPLAY-COUNT.  04690084
107300                                                                  04700000
107100     MOVE PA-MERCH-RECS-WR                  TO PA-DISPLAY-COUNT.  04710084
107200     DISPLAY '    SUK142 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04720084
107300                                                                  04730000
015800     MOVE PA-MERCH-HIGH-QTY-RECS            TO PA-DISPLAY-COUNT.  04740084
107200     DISPLAY '    SUK142 RECS QTY > 999    = ' PA-DISPLAY-COUNT.  04750084
107300                                                                  04760000
107400     MOVE PA-ARSE-COUNTS-WR                 TO PA-DISPLAY-COUNT.  04770084
107500     DISPLAY '    RCK050 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04780084
107700                                                                  04790059
107700     MOVE PA-ADJSHP-RECS-WR                 TO PA-DISPLAY-COUNT.  04800084
107800     DISPLAY '    FSK022 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04810084
108000     MOVE PA-RECEIPT-RECS-WR                TO PA-DISPLAY-COUNT.  04820084
107800     DISPLAY '    FSK023 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04830084
108000                                                                  04840000
108000                                                                  04850072
106500     DISPLAY '  RECV RECORDS WRITTEN:'                            04860084
106500                                                                  04870072
185600     MOVE PA-UNSE-COUNTS-WR                 TO PA-DISPLAY-COUNT.  04880084
107800     DISPLAY '    SUK060 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04890084
107600                                                                  04900072
107600                                                                  04910072
106500     DISPLAY '  CANCEL RECORDS WRITTEN:'.                         04920084
107600                                                                  04930044
107700     MOVE PA-ADJCAN-RECS-WR                 TO PA-DISPLAY-COUNT.  04940084
107800     DISPLAY '    FSK022 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04950084
185600     MOVE PA-CANCEL-COUNTS-WR               TO PA-DISPLAY-COUNT.  04960084
107800     DISPLAY '    SUK060 RECORDS WRITTEN   = ' PA-DISPLAY-COUNT.  04970084
106500     DISPLAY ' '.                                                 04980044
185600                                                                  04990044
1219RM     MOVE PA-RECS-SKIP-COUNTER              TO PA-DISPLAY-COUNT.  04990184
1219RM     DISPLAY '    RECORDS SKIPPED          = ' PA-DISPLAY-COUNT.  04991084
1219RM     DISPLAY ' '.                                                 04992080
                                                                        04993080
1219RM     MOVE PA-RECS-PRC-DIF-COUNTER           TO PA-DISPLAY-COUNT.  04994092
1219RM     DISPLAY '  RECORDS WITH DIFFERENT CORP AND ECOM PRICES = '   04995093
1219RM                                               PA-DISPLAY-COUNT.  04995192
1219RM     DISPLAY ' '.                                                 04996092
                                                                        04997092
088200     CLOSE BOSS-INPUT-FILE                                        05000000
004400           BOSS-DATE-FILE                                         05010067
088300           MERCHANDISE-LEDGER-FILE                                05020000
088400           SKU-INTRANSIT-FILE                                     05030001
088400           SKU-RECEIPTS-FILE                                      05040054
088500           SKU-ADJUST-FILE                                        05050000
008400           SKU-MISLOAD-FILE                                       05060000
008400           BOSS-OUTPUT-FILE.                                      05070053
                                                                        05070179
1219RM     IF PA-RECS-SKIP-COUNTER > 0                                  05070282
1219RM           MOVE 4008 TO RETURN-CODE                               05071083
1219RM     END-IF.                                                      05072079
088800                                                                  05080000
084100******************************************************************05090000
117200 C300-PROCESS-SHPRCV-RECORD.                                      05100078
117300                                                                  05110000
135300     PERFORM E100-EDIT-XLV-SKU.                                   05120000
122300                                                                  05130000
1219RM     IF XL001-SKU-SQLCODE NOT EQUAL TO  +100                      05131081
1219RM                                                                  05132081
099700         IF GV002-INV-TYPE = PC-INV-SHIP                          05140081
250113            PERFORM C350-SELECT-SKU-STR                           05141094
1219RM                                                                  05142091
122800            PERFORM D300-CREATE-MERCH-LEDGER-REC                  05150081
123300                                                                  05160000
123000**         UPDATE STORE EXPECTED                                  05170081
122900            PERFORM D400-CREATE-ARSE-SHIP-REC                     05180081
123300                                                                  05190000
123000**         UPDATE EFC EXPECTED                                    05200081
123000**      CREATE AN ADJUSTMENT RECORD TO DECREASE EFC INVENTORY     05210081
123000            PERFORM D500-CREATE-SKU-ADJUST-REC                    05220081
123300                                                                  05230058
123000            PERFORM D700-CREATE-BOSS-OUTPUT-REC                   05240081
123300                                                                  05250051
123300            PERFORM D800-CREATE-SKU-RECEIPTS-REC                  05260081
123300                                                                  05270053
099700         ELSE                                                     05280081
123000**     RELIEVE STORE EXPECTED                                     05290052
123000            PERFORM D600-CREATE-UNSE-SHIP-REC                     05300081
123300                                                                  05310051
1219RM         END-IF                                                   05320081
123000     END-IF.                                                      05321081
146800                                                                  05330001
250113 C350-SELECT-SKU-STR.                                             05331094
250113******************************************************************05331194
250113*  COPIED FROM 7200-SELECT-SKU-STR PARA IN PROGRAM XLKUT001.      05331294
250113*  AFTER XLKUT001 IS CALLED WITH STORE NUMBER ZERO, EXECUTE A     05331394
250113*  COPY OF PARA 7200-SELECT-SKU-STR HERE WITH THE ECOM STORE      05331494
250113*  STORE NUMBER TO SEE IF PRICING FOR IT EXISTS.                  05331594
250113*  IF PRICING FOR THE ECOM LOCATION IS FOUND, OVERLAY THE VALUES  05331694
250113*  RETURNED FOR LOC ZERO IN THE CALL TO XLKUT001.  THE ECOM       05331794
250113*  PRICE NEEDS TO BE PASSED ON THE TRANSFER OUTPUT AND ML FILES.  05331894
250113*  IF PRICING FOR THE ECOM LOCATION IS NOT FOUND, NO ACTION IS    05331994
250113*  NEEDED - THE VALUES RETURNED FOR LOC ZERO WILL BE USED.        05332094
250113*  XL001-INTR-UPC-ID IS RETURNED FROM THE LOC ZERO CALL.          05332194
250113******************************************************************05332294
250113                                                                  05332394
250113     MOVE GV002-INV-SHIP-NODE  TO XLV00002-STR-NBR.               05332494
250113                                                                  05332694
250113     EXEC SQL                                                     05332794
250113        SELECT   DISTINCT                                         05332894
250113                 UNT_RTL_AMT                                      05332994
250113             ,   UNT_COST_AMT                                     05333094
250113             ,   GP_QTY                                           05333194
250113             ,   GP_AMT                                           05333294
250113             ,   STR_SKU_STAT_CDE                                 05333394
250113         INTO   :XLV00002-UNT-RTL-AMT                             05333594
250113             ,  :XLV00002-UNT-COST-AMT                            05333694
250113             ,  :XLV00002-GP-QTY                                  05333794
250113             ,  :XLV00002-GP-AMT                                  05333894
250113             ,  :XLV00002-STR-SKU-STAT-CDE                        05333994
250113          FROM  XLV_SKU_STR                                       05334194
250113         WHERE  STR_NBR       = :XLV00002-STR-NBR                 05334294
250113           AND  INTR_UPC_ID   = :XL001-INTR-UPC-ID                05334394
250113          WITH UR                                                 05334494
250113     END-EXEC.                                                    05334594
250113                                                                  05334694
250113     EVALUATE TRUE                                                05335094
250113         WHEN SQLCODE = ZERO                                      05335194
250113             IF   XLV00002-UNT-RTL-AMT NOT =  XL001-UNT-RTL-AMT   05335794
250113              DISPLAY 'REPLACE LOC ZERO PRICE ' XL001-UNT-RTL-AMT 05335894
250113              ' WITH ECOM PRICE ' XLV00002-UNT-RTL-AMT            05336094
250113              ' FOR STR ' XLV00002-STR-NBR                        05336194
250113              ' SKU ' GV002-INV-ITEM-ID                           05336294
250113              ' TRANSFER NBR ' GV002-INV-ORDER-NBR                05336394
250113                 ADD 1         TO PA-RECS-PRC-DIF-COUNTER         05336494
250113             END-IF                                               05336594
250113             MOVE XLV00002-UNT-RTL-AMT     TO XL001-UNT-RTL-AMT   05336694
250113             MOVE XLV00002-UNT-COST-AMT    TO XL001-UNT-COST-AMT  05336794
250113             MOVE XLV00002-GP-QTY          TO XL001-GP-QTY        05336894
250113             MOVE XLV00002-GP-AMT          TO XL001-GP-AMT        05336994
250113             MOVE XLV00002-STR-SKU-STAT-CDE                       05337094
250113                                       TO XL001-STR-SKU-STAT-CDE  05337194
250113         WHEN SQLCODE = +100                                      05337294
250113             CONTINUE                                             05337394
250113         WHEN OTHER                                               05337494
250113             MOVE 'C350-SELECT-SKU-STR' TO PV-ABEND-PARAGRAPH     05337594
250113             MOVE 'XLV_SKU_STR'         TO PV-ABEND-TABLE         05337694
250113             MOVE 'SELECT ECOM PRICE'   TO PV-ABEND-OPERATION     05337794
250113             PERFORM Z900-SQL-ABEND                               05337894
250113     END-EVALUATE.                                                05337994
250113                                                                  05338094
146800                                                                  05339094
084100******************************************************************05340003
117200 C400-PROCESS-CANCEL-RECORD.                                      05350003
117300                                                                  05360003
135300     PERFORM E100-EDIT-XLV-SKU.                                   05370003
123300                                                                  05380003
123000**  CREATE AN ADJUSTMENT RECORD TO DECREASE STORE INVENTORY       05390062
123000     PERFORM D500-CREATE-SKU-ADJUST-REC.                          05400065
123300                                                                  05410018
123000     PERFORM D600-CREATE-UNSE-SHIP-REC.                           05420065
146800                                                                  05430003
084100******************************************************************05440003
146900 D300-CREATE-MERCH-LEDGER-REC.                                    05450000
147000                                                                  05460000
147000     INITIALIZE ML019-TRANSFER-RECORD.                            05470000
147000                                                                  05480000
147100     MOVE PC-MERCH-TRAN-CODE    TO ML019-TRANSFER-CODE.           05490000
147200     MOVE GV002-INV-SHIP-NODE   TO PV-FROM-STR-NBR-9              05500022
147200                                   ML019-TRANSFER-FROM-STORE-9.   05510022
027800     MOVE PV-BATCH-DATE-MM      TO ML019-TRANSFER-MM.             05520000
028100     MOVE PV-BATCH-DATE-DD      TO ML019-TRANSFER-DD.             05530000
147800                                                                  05540000
027800     MOVE PV-BATCH-DATE-MM      TO ML019-TRANSFER-KOHLS-MM.       05550019
148000                                                                  05560000
148000     IF XL001-GP-QTY > 1                                          05570000
148000       COMPUTE XL001-UNT-RTL-AMT = XL001-GP-AMT                   05580000
148000                                 / XL001-GP-QTY                   05590000
148000     END-IF.                                                      05600000
148100     MOVE XL001-UNT-RTL-AMT     TO ML019-TRANSFER-PER-UNT-RTL-AMT.05610000
148000                                                                  05620000
070700     MOVE PV-BATCH-NMBR-LAST3   TO ML019-TRANSFER-BATCH-NBR.      05630000
148300                                                                  05640000
148400     MOVE XL001-DEPT-NBR-3CH    TO PV-SKUNUM-DEPT                 05650000
148500                                   PV-NEW-SKU-DEPT.               05660000
148600     MOVE XL001-SUB-CL-NBR-2CH  TO PV-SKUNUM-SUBCLASS             05670000
148700                                   PV-NEW-SKU-SUBCLASS.           05680000
148800     MOVE XL001-MAJ-CL-NBR-2CH  TO PV-SKUNUM-CLASS                05690000
148900                                   PV-NEW-SKU-CLASS.              05700000
149000                                                                  05710000
149100     MOVE PV-NEW-SKU-DEPT       TO ML019-TRANSFER-DEPT-NBR.       05720032
149200     MOVE PV-NEW-SKU-SUBCLASS   TO ML019-TRANSFER-CLASS-NBR.      05730000
149300                                                                  05740000
149400     MOVE XL001-SKU-NBR         TO PV-SKU-NMBR.                   05750000
149500     MOVE PV-SKU                TO ML019-SKU.                     05760000
149501                                                                  05770000
149502     MOVE XL001-ENT-ID          TO ML019-TRANSFER-ENT-ID.         05780000
149600                                                                  05790000
150100     MOVE GV002-INV-RECEIVING-NODE                                05800000
150100                                TO PV-TO-STR-NBR-9                05810022
147200                                   ML019-TRANSFER-TO-STORE-9.     05820022
150230                                                                  05830000
150231     MOVE PV-TO-TRANSFER        TO PV-TRANSFER-TO.                05840000
150232     MOVE PV-FROM-TRANSFER      TO PV-TRANSFER-FROM.              05850022
147400     MOVE PV-TRANSFER-NBR       TO ML019-TRANSFER-NBR.            05860000
147400                                                                  05870000
150240     IF GV002-INV-QUANTITY > 999                                  05880000
150250        MOVE GV002-INV-QUANTITY TO PV-ML-QTY                      05890000
150260        PERFORM UNTIL PV-ML-QTY < 1000                            05900000
015800           ADD 1                TO PA-MERCH-HIGH-QTY-RECS         05910000
150270           MOVE 999             TO ML019-TRANSFER-QTY             05920000
150271           PERFORM Z110-WRITE-MERCH-LEDGER-REC                    05930000
150272           SUBTRACT 999                                           05940000
150273              FROM PV-ML-QTY GIVING PV-ML-QTY                     05950065
150275        END-PERFORM                                               05960000
150276        MOVE PV-ML-QTY          TO ML019-TRANSFER-QTY             05970000
150280     ELSE                                                         05980000
150300        MOVE GV002-INV-QUANTITY TO ML019-TRANSFER-QTY             05990000
150500     END-IF.                                                      06000000
150700                                                                  06010000
150410     PERFORM Z110-WRITE-MERCH-LEDGER-REC.                         06020000
150700                                                                  06030000
084100******************************************************************06040000
122900 D400-CREATE-ARSE-SHIP-REC.                                       06050000
150900                                                                  06060000
076900     INITIALIZE PC010-PCT-INTRANSIT-REC.                          06070000
077120                                                                  06080000
040600     MOVE XL001-INTR-UPC-ID          TO PC010-INTR-UPC-ID.        06090000
077100     MOVE GV002-INV-RECEIVING-NODE   TO PC010-STR-NBR.            06100000
077200     MOVE 'AR'                       TO PC010-TRN-TYP-CDE.        06110000
077201     MOVE GV002-INV-QUANTITY         TO PC010-IN-TRNST-QTY.       06120000
077400     MOVE PC-PROGRAM-NAME            TO PC010-UPD-USR-ID.         06130011
077500     MOVE GV002-INV-ORDER-NBR        TO DK-PO-NBR                 06140031
077500                                        PC010-PO-NBR.             06150031
077500     MOVE PV-PARM-BOSS-RECV          TO PC010-RCVR-SEQ-NBR.       06160009
077700     MOVE 0                          TO PC010-TRIP-ID.            06170000
077800     MOVE 'SE'                       TO PC010-TRN-CLSN-CDE.       06180000
077900     MOVE 0                          TO PC010-UPC-NBR.            06190000
077900     MOVE 'Y'                        TO PC010-BOSS-INDICATOR.     06200056
033454     MOVE PV-DB2-TMST-DATE           TO PC010-EVENT-TMST.         06210019
079200                                                                  06220000
153000     PERFORM Z120-WRITE-ARSE-OUTPUT-REC.                          06230000
153200                                                                  06240000
084100******************************************************************06250000
153300 D500-CREATE-SKU-ADJUST-REC.                                      06260000
153400                                                                  06270062
153400     INITIALIZE FS035-ADJUSTMENT-RECORD.                          06280000
153400                                                                  06290000
153500     MOVE XL001-ITM-NBR         TO FS035-ITM-NBR.                 06300000
099700     IF GV002-INV-TYPE = PC-INV-SHIP                              06310062
099700*      FOR INVOICE TYPE OF SHIP - USE THE EFC NUMBER              06320063
153700        MOVE GV002-INV-SHIP-NODE                                  06330062
153700                                TO FS035-LOC-NBR                  06340062
153700     ELSE                                                         06350062
099700*      FOR INVOICE TYPE OF CANCEL - USE THE STORE NUMBER          06360063
150100        MOVE GV002-INV-RECEIVING-NODE                             06370062
153700                                TO FS035-LOC-NBR                  06380062
153700     END-IF.                                                      06390062
154100     MOVE PV-BATCH-NMBR         TO FS035-BTCH-NBR.                06400000
154200     MOVE PC-PROGRAM-NAME       TO FS035-ADJ-SRC-PGM-NM.          06410000
153800     SET  FS035-RCPT-ADJ        TO TRUE.                          06420025
153900     SET  FS035-ACTN-NEG        TO TRUE.                          06430025
154000     MOVE GV002-INV-QUANTITY    TO FS035-ADJ-QTY.                 06440025
154300                                                                  06450000
154400     PERFORM Z130-WRITE-SKU-ADJUST-REC.                           06460000
154500                                                                  06470000
084100******************************************************************06480000
123000 D600-CREATE-UNSE-SHIP-REC.                                       06490000
154500                                                                  06500000
033445     INITIALIZE PC010-PCT-INTRANSIT-REC.                          06510000
066800                                                                  06520000
040600     MOVE XL001-INTR-UPC-ID          TO PC010-INTR-UPC-ID.        06530000
033447     MOVE GV002-INV-RECEIVING-NODE   TO PC010-STR-NBR.            06540016
033477                                                                  06550044
099700     IF GV002-INV-TYPE = PC-INV-RECV                              06560057
033448        MOVE 'UN'                    TO PC010-TRN-TYP-CDE         06570012
033448     ELSE                                                         06580026
033448        MOVE 'CL'                    TO PC010-TRN-TYP-CDE         06590012
033448     END-IF.                                                      06600026
033448                                                                  06610026
024600     MOVE PC-PROGRAM-NAME            TO PC010-UPD-USR-ID.         06620011
033450     MOVE ZERO                       TO PC010-STAT-CDE-DS.        06630000
033451     MOVE 1                          TO PC010-STAT-CDE-SU.        06640000
033452     MOVE 'SE'                       TO PC010-TRN-CLSN-CDE.       06650000
033454     MOVE PV-DB2-TMST-DATE-PLUS      TO PC010-EVENT-TMST.         06660019
033455     MOVE GV002-INV-ORDER-NBR        TO PC010-PO-NBR.             06670000
077500     MOVE PV-PARM-BOSS-RECV          TO PC010-RCVR-SEQ-NBR.       06680009
033456     MOVE 'PO'                       TO PC010-OTB-TYP-CDE.        06690000
077900     MOVE 'Y'                        TO PC010-BOSS-INDICATOR.     06700056
033457     MOVE GV002-INV-QUANTITY         TO PC010-IN-TRNST-QTY.       06710000
033457     COMPUTE PC010-IN-TRNST-QTY =                                 06720016
033458             PC010-IN-TRNST-QTY * -1.                             06730023
033460                                                                  06740000
154400     PERFORM Z140-WRITE-UNSE-OUTPUT-REC.                          06750000
154400                                                                  06760000
084100******************************************************************06770000
123000 D700-CREATE-BOSS-OUTPUT-REC.                                     06780000
154500                                                                  06790000
148400     MOVE XL001-DEPT-NBR-3CH         TO DK-DEPT-NBR               06800031
148400                                        GV002-INV-DEPT-NBR.       06810031
012000     MOVE XL001-MAJ-CL-NBR           TO GV002-INV-MAJOR-CLASS.    06820000
021700     MOVE XL001-SUB-CL-NBR           TO GV002-INV-SUB-CLASS.      06830000
010100     MOVE XL001-SKU-DESC             TO GV002-INV-SKU-DESC.       06840000
016300     MOVE PV-BATCH-NMBR              TO GV002-INV-BATCH-NBR.      06850000
016300     MOVE PV-BATCH-DATE-ISO-FMT      TO GV002-INV-BATCH-DATE.     06860000
063100     MOVE XL001-UNT-RTL-AMT          TO PV-UNIT-RETAIL.           06870000
063100                                                                  06880000
063101     MULTIPLY PV-UNIT-RETAIL BY GV002-INV-QUANTITY                06890026
063102          GIVING PV-UNIT-RETAIL-QTY                               06900000
063110     MOVE PV-UNIT-RETAIL-QTY         TO GV002-INV-RETAIL-VALUE.   06910000
033460                                                                  06920000
154400     PERFORM Z150-WRITE-BOSS-OUTPUT-REC.                          06930000
154400                                                                  06940000
084100******************************************************************06950010
024600 D800-CREATE-SKU-RECEIPTS-REC.                                    06960054
024500                                                                  06970054
025000     INITIALIZE FS036-RECEIPT-RECORD.                             06980054
025000                                                                  06990054
019000     MOVE XL001-ITM-NBR               TO FS036-ITM-NBR.           07000054
024600     MOVE GV002-INV-ORDER-NBR         TO FS036-PO-NBR.            07010054
024500     MOVE PV-PARM-BOSS-RECV           TO FS036-RCVR-NBR.          07020054
025000     MOVE PV-BATCH-DATE-ISO-FMT       TO FS036-RCPT-DTE           07030054
025000                                         FS036-VRFD-DTE.          07040054
019000     MOVE PV-BATCH-NMBR               TO FS036-BTCH-NBR.          07050054
024600     MOVE PC-PROGRAM-NAME             TO FS036-RCPT-SRC-PGM-NM.   07060054
024500     MOVE GV002-INV-RECEIVING-NODE    TO FS036-LOC-NBR.           07070054
024600     MOVE GV002-INV-QUANTITY          TO FS036-TOT-RCPT-QTY       07080054
024500                                         FS036-LOC-RCPT-QTY.      07090054
025000                                                                  07100054
025000     PERFORM Z135-WRITE-SKU-RECEIPTS-REC.                         07110054
019000                                                                  07120054
084100******************************************************************07130000
174000 E100-EDIT-XLV-SKU.                                               07140000
174100                                                                  07150000
174300     MOVE GV002-INV-ITEM-ID          TO DK-SKU.                   07160000
174400                                                                  07170000
174500     INITIALIZE XL001-ITEM-COMMAREA.                              07180000
174600                                                                  07190000
174700     SET XL001-BY-NUMERIC-SKU                                     07200000
174800         XL001-SELECT-SKU                                         07210000
174900         XL001-SELECT-VND-STYL                                    07220000
175000         XL001-SELECT-SKU-STR        TO TRUE.                     07230000
175100                                                                  07240000
175200      MOVE DK-SKU                    TO XL001-KEY-SKU.            07250000
175300                                                                  07260000
175400      CALL 'XLKUT001'                                             07270000
175400          USING XL001-ITEM-COMMAREA.                              07280000
175500                                                                  07290000
175600      EVALUATE TRUE                                               07300000
175700        WHEN XL001-SKU-SQLCODE   = +0                             07310000
175800           PERFORM E150-VND-CHECK-PARA                            07320000
175500                                                                  07330000
175900        WHEN XL001-SKU-SQLCODE   = +100                           07340000
176100           DISPLAY '*** SKU NOT FOUND ==> ' DK-SKU                07350000
176400           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      07360078
176500           MOVE 'XLV-SKU '             TO PV-ABEND-TABLE          07370078
176600           MOVE 'SKU NOT FOUND'        TO PV-ABEND-OPERATION      07380078
176700           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 07390078
1219RM*          PERFORM Z900-SQL-ABEND                                 07400079
1219RM           ADD 1 TO PA-RECS-SKIP-COUNTER                          07402082
176200                                                                  07410000
176300        WHEN XL001-SKU-CONTENTION                                 07420000
176400           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      07430000
176500           MOVE 'XLV-SKU '             TO PV-ABEND-TABLE          07440014
176600           MOVE 'SKU CONTENTION'       TO PV-ABEND-OPERATION      07450000
176700           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 07460000
176800           PERFORM Z900-SQL-ABEND                                 07470000
176900                                                                  07480000
177000        WHEN OTHER                                                07490000
177100           MOVE 'E100-EDIT-XLV-SKU'    TO PV-ABEND-PARAGRAPH      07500000
177200           MOVE 'XLV-SKU '             TO PV-ABEND-TABLE          07510014
177300           MOVE 'INVALID SKU ACCESS'   TO PV-ABEND-OPERATION      07520000
177400           MOVE XL001-SKU-SQLCODE      TO SQLCODE                 07530000
176100           DISPLAY '*** SKU ERROR ==> ' DK-SKU                    07540000
177500           PERFORM Z900-SQL-ABEND                                 07550000
177700                                                                  07560000
177600      END-EVALUATE.                                               07570000
177700                                                                  07580000
084100******************************************************************07590000
177800 E150-VND-CHECK-PARA.                                             07600000
184500                                                                  07610000
178000      EVALUATE TRUE                                               07620000
178100        WHEN XL001-VND-STYL-SQLCODE = +0                          07630000
178110             MOVE XL001-DEPT-NBR-3CH     TO PV-SKUNUM-DEPT        07640000
178130             MOVE XL001-SUB-CL-NBR-2CH   TO PV-SKUNUM-SUBCLASS    07650000
178150             MOVE XL001-MAJ-CL-NBR-2CH   TO PV-SKUNUM-CLASS       07660000
178200             PERFORM E200-STR-CHECK-PARA                          07670000
178300                                                                  07680000
178400        WHEN XL001-VND-STYL-SQLCODE = +100                        07690000
178410             MOVE ZERO                   TO PV-SKUNUM-DEPT        07700000
178420                                            PV-SKUNUM-SUBCLASS    07710000
178430                                            PV-SKUNUM-CLASS       07720000
178600                                                                  07730000
178700        WHEN XL001-VND-STYL-CONTENTION                            07740000
178800             MOVE 'E150-VND-CHECK-PARA'  TO PV-ABEND-PARAGRAPH    07750000
178900             MOVE 'XLV-VND-STYL'         TO PV-ABEND-TABLE        07760014
179000             MOVE 'VND CONTENTION'       TO PV-ABEND-OPERATION    07770000
179100             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               07780000
179200             PERFORM Z900-SQL-ABEND                               07790000
179300                                                                  07800000
179400        WHEN OTHER                                                07810000
178800             MOVE 'E150-VND-CHECK-PARA'  TO PV-ABEND-PARAGRAPH    07820000
179600             MOVE 'XLV-VND-STYL'         TO PV-ABEND-TABLE        07830014
179700             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               07840000
179800             MOVE 'INVALID VND ACCESS'   TO PV-ABEND-OPERATION    07850000
179900             MOVE XL001-VND-STYL-SQLCODE TO SQLCODE               07860000
180000             PERFORM Z900-SQL-ABEND                               07870000
180100                                                                  07880000
180200      END-EVALUATE.                                               07890000
180300                                                                  07900000
084100******************************************************************07910000
180400 E200-STR-CHECK-PARA.                                             07920000
180500                                                                  07930000
180600      EVALUATE TRUE                                               07940000
180700        WHEN XL001-SKU-STR-SQLCODE = +0                           07950000
180800           CONTINUE                                               07960000
180900                                                                  07970000
181000        WHEN XL001-SKU-STR-SQLCODE = +100                         07980000
181200           MOVE 0                     TO XL001-UNT-RTL-AMT        07990000
181300                                                                  08000000
181400        WHEN XL001-SKU-STR-CONTENTION                             08010000
181500           MOVE 'E200-STR-CHECK-PARA' TO PV-ABEND-PARAGRAPH       08020000
181600           MOVE 'XLV-SKU-STR'         TO PV-ABEND-TABLE           08030014
181700           MOVE 'STR CONTENTION'      TO PV-ABEND-OPERATION       08040000
181800           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  08050000
181900           PERFORM Z900-SQL-ABEND                                 08060000
182000                                                                  08070000
182100        WHEN OTHER                                                08080000
182200           MOVE 'E200-STR-CHECK-PARA' TO PV-ABEND-PARAGRAPH       08090000
182300           MOVE 'XLV-STR-STYL'        TO PV-ABEND-TABLE           08100014
182400           MOVE XL001-SKU-STR-SQLCODE TO SQLCODE                  08110000
182500           MOVE 'INVALID STR ACCESS'  TO PV-ABEND-OPERATION       08120000
182600           PERFORM Z900-SQL-ABEND                                 08130000
182700                                                                  08140000
182800      END-EVALUATE.                                               08150000
182900                                                                  08160000
084100******************************************************************08170028
089700 F100-GET-VENDOR-INFO.                                            08180028
089800                                                                  08190028
089900     EXEC SQL                                                     08200028
090000          SELECT INHOUSE_NBR                                      08210028
090100            INTO :VNDDPT-INHOUSE-NBR                              08220028
090200            FROM TVNDDPT                                          08230028
090300           WHERE DEPT_NBR  = :DK-DEPT-NBR                         08240031
090400             AND ENT_ID    = :XL001-ENT-ID                        08250028
093200            WITH UR                                               08260028
090500     END-EXEC.                                                    08270028
090600                                                                  08280028
090700     EVALUATE TRUE                                                08290028
090800         WHEN SQLCODE = +0                                        08300028
091000             PERFORM F200-TENTNME-INFO                            08310028
090600                                                                  08320028
091100         WHEN SQLCODE = +100                                      08330028
090100              MOVE ZEROES      TO VNDDPT-INHOUSE-NBR              08340032
090600                                                                  08350028
091500         WHEN OTHER                                               08360028
091600              MOVE 'F100-GET-VENDOR-INFO'                         08370028
091700                               TO PV-ABEND-PARAGRAPH              08380028
091800              MOVE 'SELECT TVNDDPT'                               08390028
091900                               TO PV-ABEND-OPERATION              08400028
092000              MOVE 'TVNDDPT'   TO PV-ABEND-TABLE                  08410030
092100              MOVE DK-DEPT-NBR TO PV-DB2-OPERATION-MESSAGE-1      08420031
179200              PERFORM Z900-SQL-ABEND                              08430030
092300     END-EVALUATE.                                                08440028
092400                                                                  08450028
084100******************************************************************08460028
092500 F200-TENTNME-INFO.                                               08470028
092600                                                                  08480028
092700     EXEC SQL                                                     08490028
092800          SELECT ENT_NAME_DESC                                    08500028
092900            INTO :ENTNME-ENT-NAME-DESC                            08510028
093000            FROM TENTNME                                          08520028
093100           WHERE ENT_ID    = :XL001-ENT-ID                        08530032
093200             AND TYPE_CDE  = '01'                                 08540028
093200            WITH UR                                               08550028
093300     END-EXEC.                                                    08560028
093400                                                                  08570028
093500     EVALUATE TRUE                                                08580028
093600         WHEN SQLCODE = +0                                        08590028
093900             PERFORM F300-TEXTENT-INFO                            08600028
093900                                                                  08610028
094000         WHEN SQLCODE = +100                                      08620028
092900              MOVE SPACES      TO ENTNME-ENT-NAME-DESC            08630031
095300                                                                  08640028
094400         WHEN OTHER                                               08650028
094500              MOVE 'F200-TENTNME-INFO'                            08660028
094600                               TO PV-ABEND-PARAGRAPH              08670028
094700              MOVE 'SELECT TENTNME'                               08680028
094800                               TO PV-ABEND-OPERATION              08690028
094900              MOVE 'TENTNME'   TO PV-ABEND-TABLE                  08700030
095000              MOVE DK-DEPT-NBR TO PV-DB2-OPERATION-MESSAGE-1      08710031
179200              PERFORM Z900-SQL-ABEND                              08720030
095200     END-EVALUATE.                                                08730028
095300                                                                  08740028
084100******************************************************************08750028
095400 F300-TEXTENT-INFO.                                               08760028
095500                                                                  08770028
095600     EXEC SQL                                                     08780028
095700          SELECT DUN_NBR                                          08790028
095800            INTO :EXTENT-DUN-NBR                                  08800028
095900            FROM TEXTENT                                          08810028
096000           WHERE ENT_ID  = :XL001-ENT-ID                          08820032
093200            WITH UR                                               08830028
096100     END-EXEC.                                                    08840028
096200                                                                  08850028
096300     EVALUATE TRUE                                                08860028
096400         WHEN SQLCODE = +0                                        08870028
096500             CONTINUE                                             08880028
096200                                                                  08890028
096600         WHEN SQLCODE = +100                                      08900028
095800              MOVE SPACES           TO EXTENT-DUN-NBR             08910031
096200                                                                  08920028
097000         WHEN OTHER                                               08930028
097100              MOVE 'F300-TEXTENT-INFO'                            08940028
097200                                    TO PV-ABEND-PARAGRAPH         08950028
097300              MOVE 'SELECT TEXTENT' TO PV-ABEND-OPERATION         08960028
097500              MOVE 'TEXTENT'        TO PV-ABEND-TABLE             08970030
097600              MOVE DK-DEPT-NBR      TO PV-DB2-OPERATION-MESSAGE-1 08980032
179200              PERFORM Z900-SQL-ABEND                              08990030
097800     END-EVALUATE.                                                09000028
097900                                                                  09010028
084100******************************************************************09020000
183000 Z100-READ-STR-MISLOADS.                                          09030000
183100                                                                  09040000
183200     READ BOSS-INPUT-FILE                                         09050000
183300       INTO GV002-INVENTORY-RECORD                                09060000
183400         AT END                                                   09070000
183400           SET PS-END-OF-INPUT      TO TRUE.                      09080000
183500                                                                  09090000
183600     IF PS-END-OF-INPUT                                           09100000
183600         CONTINUE                                                 09110000
183600     ELSE                                                         09120000
183700         ADD +1 TO PA-INPUT-RECORDS-READ                          09130000
183800     END-IF.                                                      09140000
183900                                                                  09150000
084100******************************************************************09160000
184000 Z110-WRITE-MERCH-LEDGER-REC.                                     09170000
184100                                                                  09180000
184200     WRITE MERCHANDISE-LEDGER-RECORD                              09190043
184300         FROM ML019-TRANSFER-RECORD.                              09200043
183900                                                                  09210000
184400     ADD +1                           TO PA-MERCH-RECS-WR.        09220000
184100                                                                  09230000
084100******************************************************************09240000
153000 Z120-WRITE-ARSE-OUTPUT-REC.                                      09250000
184700                                                                  09260000
184800     WRITE SKU-INTRANSIT-RECORD                                   09270001
184900         FROM PC010-PCT-INTRANSIT-REC.                            09280000
184500                                                                  09290000
185600     ADD +1                           TO PA-ARSE-COUNTS-WR.       09300000
185100                                                                  09310000
084100******************************************************************09320000
185200 Z130-WRITE-SKU-ADJUST-REC.                                       09330000
185300                                                                  09340060
185400     WRITE SKU-ADJUST-RECORD                                      09350000
185500         FROM FS035-ADJUSTMENT-RECORD.                            09360000
185300                                                                  09370000
099700     IF GV002-INV-TYPE = PC-INV-SHIP                              09380059
185600        ADD +1                        TO PA-ADJSHP-RECS-WR        09390059
033448     ELSE                                                         09400059
185600        ADD +1                        TO PA-ADJCAN-RECS-WR        09410059
033448     END-IF.                                                      09420059
185700                                                                  09430000
024600******************************************************************09440054
024500 Z135-WRITE-SKU-RECEIPTS-REC.                                     09450054
025000                                                                  09460054
025000     WRITE SKU-RECEIPTS-RECORD                                    09470054
019000         FROM FS036-RECEIPT-RECORD.                               09480054
024600                                                                  09490054
024500     ADD +1                           TO PA-RECEIPT-RECS-WR.      09500054
025000                                                                  09510054
025000******************************************************************09520054
019000 Z140-WRITE-UNSE-OUTPUT-REC.                                      09530054
185300                                                                  09540000
185400     WRITE SKU-MISLOAD-RECORD                                     09550000
185500         FROM PC010-PCT-INTRANSIT-REC.                            09560000
185300                                                                  09570000
033448     IF PC010-TRN-TYP-CDE = 'UN'                                  09580044
185600        ADD +1                        TO PA-UNSE-COUNTS-WR        09590044
033448     ELSE                                                         09600044
185600        ADD +1                        TO PA-CANCEL-COUNTS-WR      09610044
033448     END-IF.                                                      09620044
185700                                                                  09630000
084100******************************************************************09640000
154400 Z150-WRITE-BOSS-OUTPUT-REC.                                      09650000
185300                                                                  09660000
185400     WRITE BOSS-OUTPUT-RECORD                                     09670000
185500         FROM GV002-INVENTORY-RECORD.                             09680000
185300                                                                  09690000
185600     ADD +1                           TO PA-BOSS-OUTPUT-WR.       09700000
185700                                                                  09710000
084100******************************************************************09720027
204100 Z900-SQL-ABEND.                                                  09730000
204200                                                                  09740000
204300     MOVE SQLCODE TO PV-SQLCODE.                                  09750000
204400     DISPLAY '*** DB2 ERROR '.                                    09760000
204500     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       09770000
204600     DISPLAY '*** PROGRAM   = ' PC-PROGRAM-NAME.                  09780000
204700     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               09790000
204800     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               09800000
204900     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       09810000
205000     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       09820000
205100     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       09830000
205200     DISPLAY '*** TABLE 1   = ' PV-ABEND-TABLE.                   09840014
205300                                                                  09850000
205500*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         09860000
205600*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        09870000
205700                                                                  09880000
205800     COPY DPPD004.                                                09890000
205900                                                                  09900000
206000     CALL 'ILBOABN0' USING ABEND-CODE.                            09910000
