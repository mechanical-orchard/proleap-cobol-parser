000100 TITLE 'MAINTAIN LEGACY TPURITM TABLE FROM RMS PO SYSTEM'.        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    XLKUP009.                                         00030000
000400 AUTHOR.        DENNIS STEFFEN.                                   00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  EARLY SPRING 2003.                                00060000
000700 DATE-COMPILED.                                                   00070000
217830***************************************************************** 00080018
217830* 02/08/19 MADE BY: JIM HUNTER              CHG0217830            00090018
217830*  MAINFRAME REFACTORING - DB2 LUW HANDLES CALLS WITH CHAR        00100018
217830*  FORMATTING OF DECIMAL FIELDS DIFFERENTLY THAN THE MAINFRAME    00110018
217830*  VERSION OF DB2.   REPLACING THE CHAR FORMATTING WITH DIGITS.   00120018
217830*  CHAR RETURNS A LEADING SPACE AND TRAILING DECIMAL POINT        00130018
217830*  AND DIGITS DOESN'T.                                            00140018
217830*  SEE PARAGRAPH 7210-SELECT-XLTSKU-ALL.                          00150018
MB1993* 04/27/21 MADE BY: TKMA4MB                                       00151019
MB1993*  REMOVED JUNK VALUES VEND_STYL_NAME BEFORE INSERTING TPURITM    00152021
217830******************************************************************00160018
000800 ENVIRONMENT DIVISION.                                            00170000
000900 CONFIGURATION SECTION.                                           00180000
001000 SOURCE-COMPUTER.  IBM-3090.                                      00190000
001100 OBJECT-COMPUTER.  IBM-3090.                                      00200000
001200 DATA DIVISION.                                                   00210000
001300                                                                  00220000
001400 WORKING-STORAGE SECTION.                                         00230000
001500                                                                  00240000
001600 01  PV-CRAPOLA.                                                  00250000
001700     05  PS-EXISTENCE-PO              PIC S9 COMP-3 VALUE ZERO.   00260000
001800         88  PS-PO-EXISTS-YES                       VALUE 1.      00270000
001900         88  PS-PO-EXISTS-NO                        VALUE ZERO.   00280000
002000     05  PS-EXISTENCE-SKU             PIC S9 COMP-3 VALUE ZERO.   00290000
002100         88  PS-SKU-EXISTS-YES                      VALUE 1.      00300000
002200         88  PS-SKU-EXISTS-NO                       VALUE ZERO.   00310000
002300     05  PS-EXISTENCE-PURITM          PIC S9 COMP-3 VALUE ZERO.   00320000
002400         88  PS-PURITM-EXISTS-YES                   VALUE 1.      00330000
002500         88  PS-PURITM-EXISTS-NO                    VALUE ZERO.   00340000
002600     05  PS-INTERNAL-ERROR-SW         PIC X(01)     VALUE 'N'.    00350000
002700         88  PS-INTERNAL-ERROR-YES                  VALUE 'Y'.    00360000
002800         88  PS-INTERNAL-ERROR-NO                   VALUE 'N'.    00370000
002900     05  PS-ADD-UPDATE-SW             PIC X(01)     VALUE SPACE.  00380000
003000         88  PS-INSERT-MODE                         VALUE 'I'.    00390000
003100         88  PS-UPDATE-MODE                         VALUE 'U'.    00400000
003200         88  PS-DELETE-MODE                         VALUE 'D'.    00410000
003300     05  PS-COMPLETE-SW               PIC X(01)     VALUE SPACE.  00420000
003400         88  PS-DONE-YES                            VALUE 'Y'.    00430000
003500         88  PS-DONE-NO                             VALUE 'N'.    00440000
003600     05  PS-PACK-CSR-SW               PIC X(01)     VALUE 'N'.    00450000
003700         88  PS-END-PACK-CSR-NO                     VALUE 'N'.    00460000
003800         88  PS-END-PACK-CSR-YES                    VALUE 'Y'.    00470000
003900     05  PS-ERROR-SW                  PIC X(01)     VALUE 'N'.    00480000
004000         88  PS-ERROR-NO                            VALUE 'N'.    00490000
004100         88  PS-ERROR-YES                           VALUE 'Y'.    00500000
004200     05  PS-CSR-OPEN-SW               PIC X(01)     VALUE 'N'.    00510000
004300         88  PS-CSR-OPEN-NO                         VALUE 'N'.    00520000
004400         88  PS-CSR-OPEN-YES                        VALUE 'Y'.    00530000
004500                                                                  00540000
004600     05  PS-NULL-IND                  PIC S9(04) COMP VALUE ZERO. 00550000
004700     05  DK-SUB-CL                    PIC X(02)     VALUE SPACE.  00560000
004800     05  DK-KOHLS-SIZE-CDE            PIC X(05)     VALUE SPACE.  00570000
004900     05  PV-WORK-QTY                  PIC X(13) JUST RIGHT.       00580000
005000     05  PV-CURRENT-STATUS-CDE        PIC X(02)  VALUE SPACES.    00590000
005100     05  PV-CURRENT-CNCLD-UNT-QTY     PIC S9(08) COMP             00600000
005200                                                 VALUE ZERO.      00610000
005300     05  PV-DISP-SKU                  PIC 9(08).                  00620000
005400     05  PV-DISP-SQLCODE              PIC -ZZ9.                   00630000
006400     05  PV-DB2-PKG-COUNT            PIC S9(9)  COMP-3            00640000
006500                                                VALUE ZERO.       00650000
006700                                                                  00660000
006800*    USED FOR CALCULATIONS                                        00670000
006900 01  PV-COUNTERS.                                                 00680000
007000     05  PV-UNT-QTY                   PIC S9(9) COMP.             00690000
007100     05  PV-UNT-COST-AMT              PIC S9(4)V9(3) COMP-3.      00700000
007200     05  PV-UNT-RTL-PR-AMT            PIC S9(6)V9(2) COMP-3.      00710000
007300     05  PV-MARKUP-PCT                PIC S9(03)V9999 COMP-3      00720000
007400                                            VALUE ZERO.           00730000
007500                                                                  00740000
007600     05  PV-UNT-QTY-NEW               PIC S9(9) COMP.             00750000
007700     05  PV-CNCLD-UNT-QTY-NEW         PIC S9(9) COMP.             00760000
007800     05  PV-UNT-COST-AMT-NEW          PIC S9(4)V9(3) COMP-3.      00770000
007900     05  PV-UNT-RTL-PR-AMT-NEW        PIC S9(6)V9(2) COMP-3.      00780000
008000     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00790000
008100                                                 COMP SYNC.       00800000
008200                                                                  00810000
008300 01  PC-CONSTANTS.                                                00820000
008400*   THIS IS SET TO ZERO TO MAXIMIZE THE THROUGHPUT.               00830000
008500*   IF THE NEED ARISES, WE CAN EASILY INCREASE THIS.              00840000
008600     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +01       00850000
008700                                                 COMP.            00860000
008800*    ITEM MODULE COPYBOOK                                         00870000
008900*    COPY XLWS001.                                                00880000
009000/                                                                 00890000
009100*    NUMERIC EDITING ROUTINE                                      00900000
009200     COPY DPWS010I.                                               00910000
009300/                                                                 00920000
009400*    LEGACY PO HEADER                                             00930000
009500     EXEC SQL                                                     00940000
009600         INCLUDE TPURCHS                                          00950000
009700     END-EXEC.                                                    00960000
009800                                                                  00970000
009900*    LEGACY PO LINES                                              00980000
010000     EXEC SQL                                                     00990000
010100         INCLUDE TPURITM                                          01000000
010200     END-EXEC.                                                    01010000
010300                                                                  01020000
010400*    LEGACY PO PREPACK                                            01030000
010500     EXEC SQL                                                     01040000
010600         INCLUDE TPOPRPK                                          01050000
010700     END-EXEC.                                                    01060000
010800                                                                  01070000
010900*    DOMAIN SKU TABLE                                             01080000
011000     EXEC SQL                                                     01090000
011100         INCLUDE XLT00003                                         01100000
011200     END-EXEC.                                                    01110000
011300                                                                  01120000
011400*    DOMAIN VENDOR STYLE                                          01130000
011500     EXEC SQL                                                     01140000
011600         INCLUDE XLT00004                                         01150000
011700     END-EXEC.                                                    01160000
011800                                                                  01170000
012900                                                                  01180000
013000/                                                                 01190000
013100     EXEC SQL                                                     01200000
013200         DECLARE PACK-LINE-CSR CURSOR FOR                         01210000
013300         SELECT                                                   01220000
013400             PUR.VER_NBR                                          01230000
013500         ,   PUR.PO_LNE_NBR                                       01240000
013600         ,   PUR.STATUS_CDE                                       01250000
013700         ,   PUR.UNT_QTY                                          01260000
013800         ,   PUR.UNT_COST_AMT                                     01270000
013900         ,   PUR.GP_RTL_AMT                                       01280000
014000         ,   PUR.GP_QTY                                           01290000
014100         ,   PUR.UNT_RTL_PR_AMT                                   01300000
014200         ,   PUR.TOT_VAL_RTL_AMT                                  01310000
014300         ,   PUR.MU_PCT                                           01320000
014400         ,   PUR.PREPK_RATO_QTY                                   01330000
014500         ,   PUR.RMS_PO_SKU_NBR                                   01340000
014600         FROM                                                     01350000
014700             TPOPRPK              PK                              01360000
014800         ,   TPURITM              PUR                             01370000
014900         WHERE                                                    01380000
015000             PK.PK_SKU_NBR            = :POPRPK-PK-SKU-NBR        01390000
015100         AND PK.PO_NBR                = :PURITM-PO-NBR            01400000
015200         AND PK.PO_NBR                = PUR.PO_NBR                01410000
015300         AND PK.PO_PREPK_ID           = PUR.PO_PREPK_ID           01420000
015400         AND PUR.VER_STATUS_CDE       = 'A'                       01430000
015500         ORDER BY                                                 01440000
015600             PUR.PO_LNE_NBR                                       01450000
015700                                                                  01460000
015800         END-EXEC                                                 01470000
015900/                                                                 01480000
016000     EXEC SQL                                                     01490000
016100          INCLUDE SQLCA                                           01500000
016200     END-EXEC.                                                    01510000
016300     COPY SQLCA2.                                                 01520000
016400                                                                  01530000
016500 LINKAGE SECTION.                                                 01540000
016600 01  XLRD011-RECORD.                                              01550000
016700     COPY XLRD011.                                                01560000
016800/                                                                 01570000
016900 PROCEDURE DIVISION USING XLRD011-RECORD.                         01580000
017000                                                                  01590000
017100     PERFORM 1000-INITIALIZATION.                                 01600000
017200                                                                  01610000
017300     PERFORM 2000-PROCESS-MESSAGE                                 01620000
017400         UNTIL PS-DONE-YES                                        01630000
017500               OR XL011-SQL-ERROR                                 01640000
017600               OR XL011-SYSTEM-ERROR                              01650000
017700               OR PS-INTERNAL-ERROR-YES                           01660000
017800                                                                  01670000
017900*    IF PS-INTERNAL-ERROR-NO AND                                  01680000
018000*        XL011-SUCCESSFUL AND PS-PURITM-EXISTS-YES                01690000
018100*        PERFORM 8000-CALL-XLKUP013                               01700000
018200*    END-IF.                                                      01710000
018300                                                                  01720000
018400     PERFORM 9999-WRAPUP.                                         01730000
018500                                                                  01740000
018600     GOBACK.                                                      01750000
018700                                                                  01760000
018800 1000-INITIALIZATION.                                             01770000
018900                                                                  01780000
019000*    WE NEED A TPURCHS AND A TPURITM BEFORE WE CAN  TABLES.       01790000
019100*    CAN'T ADD OR CHANGE ANY PURITM WITHOUT HAVING A TPURCHS ROW. 01800000
019200*    IF A HEADER EXISTS, FIND THE ITEM NBR FOR THE SKU GIVEN BY   01810000
019300*    RMS.  THE ITEM NBR WILL IDENTIFY THE TPURITM ROW TO PROCESS. 01820000
019400*    IF WE CAN'T DETERMINE THE ITEM NBR WE ARE KAPUT RIGHT THERE. 01830000
019500                                                                  01840000
019600*    WE WANT TO CLEAR OUT ANY HOLD OVER INFO BEFORE PROCEEDING    01850000
019700     INITIALIZE DCLTPURITM                                        01860000
019800                PV-COUNTERS                                       01870000
019900                                                                  01880000
020000     IF XL011-DEBUG-YES                                           01890000
020100         DISPLAY 'XLKUP009 - 1000-INITIALIZATION'                 01900000
020200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  01910000
020300                             XL011-RETURN-CODE                    01920000
020400     END-IF                                                       01930000
020500     INITIALIZE XL011-RETURN-AREA                                 01940000
020600     SET PS-INTERNAL-ERROR-NO                                     01950000
020700         PS-DONE-NO                   TO TRUE                     01960000
020800     SET PS-ERROR-NO                  TO TRUE                     01970000
020900     MOVE 'XLKUP009'                  TO XL011-ERROR-PROGRAM.     01980000
021000     MOVE XL011-ORDER-NBR             TO PURITM-PO-NBR            01990000
021100                                                                  02000000
021200     IF XL011-DEBUG-YES                                           02010000
021300         DISPLAY 'XLKUP009 - XL011-ORDER-NBR = '  XL011-ORDER-NBR 02020000
021400               ' '  XL011-MSG-ID                                  02030000
021500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  02040000
021600                             XL011-RETURN-CODE                    02050000
021700     END-IF                                                       02060000
021800                                                                  02070000
021900     PERFORM 7000-SELECT-TPURCHS.                                 02080000
022000     IF XL011-SUCCESSFUL                                          02090000
022100         IF XL011-MSG-ID = 'HDR_DELETE'                           02100000
022200             SET PS-UPDATE-MODE       TO TRUE                     02110000
022300         ELSE                                                     02120000
022400             PERFORM 1100-DOES-PURITM-EXIST                       02130000
022500         END-IF                                                   02140000
022600     END-IF.                                                      02150000
022700                                                                  02160000
022800 1100-DOES-PURITM-EXIST.                                          02170000
022900                                                                  02180000
023000     MOVE '1100-DOES-PURITM-EXIST'    TO XL011-ERROR-PARAGRAPH    02190000
023100     IF XL011-DEBUG-YES                                           02200000
023200        DISPLAY 'XLKUP009 - 1100-DOES-PURITM-EXIST'               02210000
023300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  02220000
023400                             XL011-RETURN-CODE                    02230000
023500     END-IF                                                       02240000
023600*    LOAD THE KEY FOR THE ITEM NBR LOOKUP                         02250000
023700     EVALUATE XL011-MSG-ID                                        02260000
023800       WHEN 'ORD_SKU_ADD'                                         02270000
023900             MOVE XL011-SA-COMP-SKU-NBR   TO XLT00003-SKU-NBR     02280020
024000       WHEN 'ORD_LOC_QTY_CHANGE'                                  02290000
024100             IF XL011-LQC-PK-SKU-IND = 'Y'                        02300000
024200                 SET XL011-PACK-YES   TO TRUE                     02310000
024300                 MOVE XL011-LQC-COMP-SKU-NBR                      02320000
024400                                      TO POPRPK-PK-SKU-NBR        02330000
024500             ELSE                                                 02340000
024600                 MOVE XL011-LQC-COMP-SKU-NBR                      02350000
024700                                      TO XLT00003-SKU-NBR         02360000
024800             END-IF                                               02370000
024900                                                                  02380000
025000       WHEN 'ORD_SKU_COST_CHANGE'                                 02390000
025100             MOVE XL011-SCC-COMP-SKU-NBR  TO XLT00003-SKU-NBR     02400000
025200                                                                  02410000
025300*      WHEN 'ORD_LOCATION_DELETE'                                 02420000
025400*            MOVE XL011-LD-COMP-SKU-NBR   TO XLT00003-SKU-NBR     02430000
025500                                                                  02440000
025600                                                                  02450000
025700       WHEN 'ORD_QTY_CHANGE'                                      02460000
025800             IF XL011-SKQC-PK-SKU-IND = 'Y'                       02470000
025900                 SET XL011-PACK-YES   TO TRUE                     02480000
026000                 MOVE XL011-SKQC-COMP-SKU-NBR                     02490000
026100                                      TO POPRPK-PK-SKU-NBR        02500000
026200             ELSE                                                 02510000
026300                 MOVE XL011-SKQC-COMP-SKU-NBR                     02520000
026400                                      TO XLT00003-SKU-NBR         02530000
026500             END-IF                                               02540000
026600                                                                  02550000
026700           WHEN 'ORD_SKU_ATTR_CHANGE'                             02560000
026800             IF XL011-SAC-PK-SKU-IND = 'Y'                        02570000
026900                 SET XL011-PACK-YES   TO TRUE                     02580000
027000                 MOVE XL011-SAC-COMP-SKU-NBR                      02590000
027100                                      TO POPRPK-PK-SKU-NBR        02600000
027200             ELSE                                                 02610000
027300                 MOVE XL011-SAC-COMP-SKU-NBR                      02620000
027400                                      TO XLT00003-SKU-NBR         02630000
027500             END-IF                                               02640000
027600                                                                  02650000
027700           WHEN 'ORD_SKU_DELETE'                                  02660000
027800             IF XL011-SD-PK-SKU-IND = 'Y'                         02670000
027900                 SET XL011-PACK-YES   TO TRUE                     02680000
028000                 MOVE XL011-SD-COMP-SKU-NBR                       02690000
028100                                      TO POPRPK-PK-SKU-NBR        02700000
028200             ELSE                                                 02710000
028300                 MOVE XL011-SD-COMP-SKU-NBR                       02720000
028400                                      TO XLT00003-SKU-NBR         02730000
028500             END-IF                                               02740000
028600                                                                  02750000
028700       WHEN 'PACK_COMP_ADD'                                       02760000
028800             MOVE XL011-PCA-COMP-SKU-NBR  TO XLT00003-SKU-NBR     02770000
028900                                                                  02780000
029000       WHEN 'PACK_COMP_CHANGE'                                    02790000
029100             MOVE XL011-PCC-COMP-SKU-NBR                          02800000
029200                                      TO XLT00003-SKU-NBR         02810000
029300                                                                  02820000
029400       WHEN 'ORD_PACK_RTL_CHANGE'                                 02830000
029500*            NOT PROCESSED HERE                                   02840000
029600             SET PS-DONE-YES          TO TRUE                     02850000
029700                                                                  02860000
029800       WHEN 'ORD_PACK_ADD'                                        02870000
029900*            THIS MESSAGE TYPE IS NOT USED HERE                   02880000
030000             SET PS-DONE-YES          TO TRUE                     02890000
030100                                                                  02900000
030200       WHEN 'ORD_PACK_REPLACE'                                    02910000
030300             SET PS-DONE-YES          TO TRUE                     02920000
030400     END-EVALUATE.                                                02930000
030500                                                                  02940000
030600*    LOOK UP THE ITEM NBR FOR THE GIVEN SKU                       02950000
030700     EVALUATE TRUE                                                02960000
030800         WHEN XL011-MSG-ID = 'PACK_COMP_ADD'                      02970000
030900         WHEN XL011-MSG-ID = 'PACK_COMP_CHANGE'                   02980000
031000             PERFORM 7200-SELECT-XLTSKU-ITEM                      02990000
031100             MOVE XLT00003-ITM-NBR        TO PURITM-ITM-NBR       03000000
031200         WHEN XL011-PACK-YES                                      03010000
031300             CONTINUE                                             03020000
031400         WHEN OTHER                                               03030000
031500             PERFORM 7200-SELECT-XLTSKU-ITEM                      03040000
031600     END-EVALUATE.                                                03050000
031700                                                                  03060000
031800*    IF WE HAVE AN ITEM NBR WE CAN LOOK FOR AN EXISTING TPURITM   03070000
031900     EVALUATE TRUE                                                03080000
032000     WHEN XL011-MSG-ID = 'ORD_SKU_ADD'                            03090000
032100         IF PS-SKU-EXISTS-YES                                     03100000
032200             MOVE XLT00003-ITM-NBR        TO PURITM-ITM-NBR       03110000
032300             PERFORM 7005-SELECT-TPURITM                          03120000
032400             IF PURITM-PREPK-RATO-QTY > ZERO                      03130000
032500                 SET PS-INSERT-MODE   TO TRUE                     03140000
032600             END-IF                                               03150000
032700         END-IF                                                   03160000
032800     WHEN XL011-MSG-ID = 'ORD_PACK_ADD'                           03170000
032810         SET PS-INSERT-MODE           TO TRUE                     03180000
032820     WHEN XL011-MSG-ID = 'PACK_COMP_ADD'                          03190000
032840          PERFORM 7600-SELECT-PACK-ITEM                           03200000
032850     WHEN XL011-PACK-YES                                          03210000
032860         SET PS-UPDATE-MODE           TO TRUE                     03220000
032870     WHEN OTHER                                                   03230000
032880         IF PS-SKU-EXISTS-YES                                     03240000
032890             MOVE XLT00003-ITM-NBR        TO PURITM-ITM-NBR       03250000
032900             PERFORM 7005-SELECT-TPURITM                          03260000
033000         END-IF                                                   03270000
033100     END-EVALUATE.                                                03280000
033200/                                                                 03290000
033300 2000-PROCESS-MESSAGE.                                            03300000
033400                                                                  03310000
033500     MOVE '2000-PROCESS-MESSAGE'      TO XL011-ERROR-PARAGRAPH    03320000
033600     IF XL011-DEBUG-YES                                           03330000
033700         DISPLAY 'XLKUP009 - 2000-PROCESS-MESSAGE'                03340000
033800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  03350000
033900                             XL011-RETURN-CODE                    03360000
034000     END-IF                                                       03370000
034100     EVALUATE TRUE                                                03380000
034200     WHEN PS-INSERT-MODE                                          03390000
034300*        (TPURITM DOESN'T EXIST NOW)                              03400000
034400         EVALUATE XL011-MSG-ID                                    03410000
034500           WHEN 'ORD_SKU_ADD'                                     03420000
034600             IF XL011-SA-PACK-SKU-IND = 'Y'                       03430000
034700*                NO PURITMS ARE CREATED HERE FOR PACKS            03440000
034800                 SET PS-DONE-YES      TO TRUE                     03450000
034900             ELSE                                                 03460000
035000                 PERFORM 3000-INSERT                              03470000
035100             END-IF                                               03480000
035200           WHEN 'ORD_SKU_COST_CHANGE'                             03490000
035300             MOVE 'UPDATE REJECTED- TPURITM NOT ON FILE'          03500000
035400                                      TO XL011-ERROR-TEXT         03510000
035500             SET XL011-SYSTEM-ERROR   TO TRUE                     03520000
035600           WHEN 'ORD_SKU_ATTR_CHANGE'                             03530000
035700             MOVE 'UPDATE REJECTED- TPURITM NOT ON FILE'          03540000
035800                                      TO XL011-ERROR-TEXT         03550000
035900             SET XL011-SYSTEM-ERROR   TO TRUE                     03560000
036000           WHEN 'ORD_QTY_CHANGE'                                  03570000
036100             MOVE 'UPDATE REJECTED- TPURITM NOT ON FILE'          03580000
036200                                      TO XL011-ERROR-TEXT         03590000
036300             SET XL011-SYSTEM-ERROR   TO TRUE                     03600000
036400           WHEN 'ORD_SKU_DELETE'                                  03610000
036500           WHEN 'HDR_DELETE'                                      03620000
036600*             NO ACTION NEEDED BECAUSE THERE'S NOTHING TO DELETE  03630000
036700             SET PS-DONE-YES          TO TRUE                     03640000
036800                                                                  03650000
036900           WHEN 'ORD_PACK_ADD'                                    03660000
037000*            THIS MESSAGE TYPE IS NOT USED HERE                   03670000
037100             SET PS-DONE-YES          TO TRUE                     03680000
037200           WHEN 'PACK_COMP_ADD'                                   03690000
037300               PERFORM 4000-INSERT-PACK-COMP                      03700000
037400                                                                  03710000
037500           WHEN 'PACK_COMP_CHANGE'                                03720000
037600           WHEN 'ORD_PACK_REPLACE'                                03730000
037700           WHEN 'ORD_PACK_RTL_CHANGE'                             03740000
037800             MOVE 'UPDATE REJECTED- TPURITM NOT ON FILE'          03750000
037900                                      TO XL011-ERROR-TEXT         03760000
038000             SET XL011-SYSTEM-ERROR   TO TRUE                     03770000
038100           WHEN OTHER                                             03780000
038200             MOVE 'UNRECOGNIZED MSG-ID (ADD-MODE)'                03790000
038300                                      TO XL011-ERROR-TEXT         03800000
038400             SET XL011-SYSTEM-ERROR   TO TRUE                     03810000
038500         END-EVALUATE                                             03820000
038600                                                                  03830000
038700     WHEN PS-UPDATE-MODE                                          03840000
038800                                                                  03850000
038900*        (TPURITM EXISTS ALREADY)                                 03860000
039000         EVALUATE XL011-MSG-ID                                    03870000
039100           WHEN 'ORD_SKU_ADD'                                     03880000
039200***GB 10/2/14                                                     03890000
039300***    WHEN SKU ALREADY EXISTS ON PO AND ORD_SKU_ADD DO NOT WRITE 03900000
039400***    TO ERROR QUEUE                                             03910000
039500***          MOVE 'INSERT REJECTED- TPURITM ALREADY ON FILE'      03920000
039600***                                   TO XL011-ERROR-TEXT         03930000
039700             SET PS-DONE-YES          TO TRUE                     03940000
039800***GB 10/2/14SET XL011-SYSTEM-ERROR   TO TRUE                     03950000
039900           WHEN 'ORD_SKU_COST_CHANGE'                             03960000
040000               PERFORM 2200-UPDATE-SKU-COST                       03970000
040100                                                                  03980000
040200           WHEN 'ORD_SKU_ATTR_CHANGE'                             03990000
040300               IF XL011-SAC-PK-SKU-IND = 'Y'                      04000000
040400                   PERFORM 2300P-UPDATE-SKU-ATTR                  04010000
040500               ELSE                                               04020000
040600                   PERFORM 2300-UPDATE-SKU-ATTR                   04030000
040700               END-IF                                             04040000
040800                                                                  04050000
040900           WHEN 'ORD_QTY_CHANGE'                                  04060000
041000               IF XL011-SKQC-PK-SKU-IND = 'Y'                     04070000
041100                   PERFORM 2400P-UPDATE-TPURITM-QTYS              04080000
041200               ELSE                                               04090000
041300                   PERFORM 2400-UPDATE-TPURITM-QTYS               04100000
041400               END-IF                                             04110000
041500           WHEN 'ORD_LOC_QTY_CHANGE'                              04120000
041600             IF XL011-LQC-PK-SKU-IND = 'Y'                        04130000
041700                 PERFORM 2500P-CHG-LOC-QTY                        04140000
041800             ELSE                                                 04150000
041900                 PERFORM 2500-CHG-LOC-QTY                         04160000
042000             END-IF                                               04170000
042100           WHEN 'ORD_SKU_DELETE'                                  04180000
042200             IF XL011-SD-PK-SKU-IND = 'Y'                         04190000
042300               PERFORM 2800P-DELETE-HDR                           04200000
042400             ELSE                                                 04210000
042500               PERFORM 2800-DELETE-HDR                            04220000
042600             END-IF                                               04230000
042700           WHEN 'HDR_DELETE'                                      04240000
042800               PERFORM 7170-DELETE-ALL-TPURITM                    04250000
042900*          WHEN 'ORD_LOC_ATT_CHANGE'                              04260000
043000*            SET PS-DONE-YES          TO TRUE                     04270000
043100                                                                  04280000
043200           WHEN 'PACK_COMP_CHANGE'                                04290000
043300               PERFORM 2200P-UPDATE-SKU-COST-RTL                  04300000
043400                                                                  04310000
043500           WHEN 'ORD_PACK_ADD'                                    04320000
043600*            THIS MESSAGE TYPE IS NOT USED HERE                   04330000
043700             SET PS-DONE-YES          TO TRUE                     04340000
043800           WHEN 'ORD_PACK_REPLACE'                                04350000
043900           WHEN 'PACK_COMP_ADD'                                   04360000
044000           WHEN 'ORD_PACK_RTL_CHANGE'                             04370000
044100             SET PS-DONE-YES          TO TRUE                     04380000
044200           WHEN OTHER                                             04390000
044300             MOVE 'UNRECOGNIZED MSG-ID (UPDATE-MODE)'             04400000
044400                                      TO XL011-ERROR-TEXT         04410000
044500             SET XL011-SYSTEM-ERROR   TO TRUE                     04420000
044600         END-EVALUATE                                             04430000
044700     END-EVALUATE.                                                04440000
044800/                                                                 04450000
044900 2200-UPDATE-SKU-COST.                                            04460000
045000                                                                  04470000
045100     MOVE '2200-UPDATE-SKU-COST'      TO XL011-ERROR-PARAGRAPH    04480000
045200     IF XL011-DEBUG-YES                                           04490000
045300         DISPLAY 'XLKUP009 - 2200-UPDATE-SKU-COST'                04500000
045400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  04510000
045500                             XL011-RETURN-CODE                    04520000
045600     END-IF                                                       04530000
045700     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    04540000
045800     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  04550000
045900     MOVE XL011-SCC-UNIT-COST         TO PV-WORK-QTY              04560000
046000     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    04570000
046100     PERFORM 8100-NUMERIC-EDIT                                    04580000
046200     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-COST-AMT.     04590000
046300                                                                  04600000
046400     PERFORM 3030-CALC-EXTENDS-AND-PCTS                           04610000
046500     PERFORM 7130-UPDATE-TPURITM-COSTS.                           04620000
046600                                                                  04630000
046700 2200P-UPDATE-SKU-COST-RTL.                                       04640000
046800                                                                  04650000
046900     MOVE '2200P-UPDATE-SKU-COST-RTL' TO XL011-ERROR-PARAGRAPH    04660000
047000     IF XL011-DEBUG-YES                                           04670000
047100         DISPLAY 'XLKUP009 - 2200P-UPDATE-SKU-COST-RTL'           04680000
047200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  04690000
047300                             XL011-RETURN-CODE                    04700000
047400     END-IF                                                       04710000
047500                                                                  04720000
047600     MOVE XL011-ORDER-NBR             TO POPRPK-PO-NBR            04730000
047700     MOVE XL011-PCC-PACK-SKU-NBR      TO POPRPK-PK-SKU-NBR        04740000
047800     PERFORM 7310-SELECT-POPRPK-ID                                04750000
047900     MOVE POPRPK-PO-PREPK-ID          TO PURITM-PO-PREPK-ID       04760000
048000                                                                  04770000
048100     PERFORM 7500-SELECT-PURITM-NBRS                              04780000
048200                                                                  04790000
048300     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    04800000
048400     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  04810000
048500     MOVE XL011-PCC-UNIT-COST         TO PV-WORK-QTY              04820000
048600     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    04830000
048700     PERFORM 8100-NUMERIC-EDIT                                    04840000
048800     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-COST-AMT.     04850000
048900                                                                  04860000
049000                                                                  04870000
049100     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    04880000
049200     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  04890000
049300     MOVE XL011-PCC-FIRST-COST        TO PV-WORK-QTY              04900000
049400     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    04910000
049500     PERFORM 8100-NUMERIC-EDIT                                    04920000
049600     MOVE DP010I-NUMERIC-FIELD        TO PURITM-PRD-1ST-COST-AMT. 04930000
049700                                                                  04940000
049800     MOVE XL011-PCC-UNT-RTL-AMT       TO PV-WORK-QTY              04950000
049900     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    04960000
050000     MOVE 7                           TO DP010I-MAXIMUM-DIGITS    04970000
050100     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  04980000
050200     PERFORM 8100-NUMERIC-EDIT                                    04990000
050300     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-RTL-PR-AMT    05000000
050400                                                                  05010000
050500     MOVE XL011-PCC-GP-RTL-AMT        TO DP010I-UNEDITED-FIELD    05020000
050600     MOVE 7                           TO DP010I-MAXIMUM-DIGITS    05030000
050700     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  05040000
050800     PERFORM 8100-NUMERIC-EDIT                                    05050000
050900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-RTL-AMT        05060000
051000                                                                  05070000
051100     MOVE XL011-PCC-GP-RTL-QTY        TO DP010I-UNEDITED-FIELD    05080000
051200     MOVE 5                           TO DP010I-MAXIMUM-DIGITS    05090000
051300     MOVE 0                           TO DP010I-MAXIMUM-DECIMALS  05100000
051400     PERFORM 8100-NUMERIC-EDIT                                    05110000
051500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-QTY            05120000
051600                                                                  05130000
051700     PERFORM 3030-CALC-EXTENDS-AND-PCTS                           05140000
051800                                                                  05150000
051900     PERFORM 7130P-UPD-TPURITM-CST-RTL.                           05160000
052000                                                                  05170000
052100 2300-UPDATE-SKU-ATTR.                                            05180000
052200                                                                  05190000
052300     MOVE '2300-UPDATE-SKU-ATTR'      TO XL011-ERROR-PARAGRAPH    05200000
052400     IF XL011-DEBUG-YES                                           05210000
052500         DISPLAY 'XLKUP009 - 2300-UPDATE-SKU-ATTR'                05220000
052600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  05230000
052700                             XL011-RETURN-CODE                    05240000
052800     END-IF                                                       05250000
052900                                                                  05260000
053000     IF XL011-SAC-PROMO-STRT-DTE = SPACES OR ZEROES               05270000
053100         MOVE '0001-01-01'            TO PURITM-AD-EVNT-DTE       05280000
053200     ELSE                                                         05290000
053300     STRING XL011-SAC-PROMO-STRT-DTE (1:4)                        05300000
053400         '-'                                                      05310000
053500         XL011-SAC-PROMO-STRT-DTE (5:2)                           05320000
053600         '-'                                                      05330000
053700         XL011-SAC-PROMO-STRT-DTE (7:2) DELIMITED BY SIZE         05340000
053800                                      INTO PURITM-AD-EVNT-DTE     05350000
053900     END-IF                                                       05360000
054000                                                                  05370000
054100     MOVE XL011-SAC-PIC-SKU-IND       TO PURITM-PIC-ITM-IND       05380000
054200                                                                  05390000
054300                                                                  05400000
054400     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    05410000
054500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  05420000
054600     MOVE XL011-SAC-FIRST-COST        TO PV-WORK-QTY              05430000
054700     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    05440000
054800     PERFORM 8100-NUMERIC-EDIT                                    05450000
054900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-PRD-1ST-COST-AMT. 05460000
055000                                                                  05470000
055100     MOVE XL011-SAC-UNT-RTL-AMT       TO PV-WORK-QTY              05480000
055200     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    05490000
055300     MOVE 7                           TO DP010I-MAXIMUM-DIGITS    05500000
055400     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  05510000
055500     PERFORM 8100-NUMERIC-EDIT                                    05520000
055600     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-RTL-PR-AMT    05530000
055700                                                                  05540000
055800     MOVE XL011-SAC-GP-RTL-AMT        TO DP010I-UNEDITED-FIELD    05550000
055900     MOVE 7                           TO DP010I-MAXIMUM-DIGITS    05560000
056000     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  05570000
056100     PERFORM 8100-NUMERIC-EDIT                                    05580000
056200     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-RTL-AMT        05590000
056300                                                                  05600000
056400     MOVE XL011-SAC-GP-RTL-QTY        TO DP010I-UNEDITED-FIELD    05610000
056500     MOVE 5                           TO DP010I-MAXIMUM-DIGITS    05620000
056600     MOVE 0                           TO DP010I-MAXIMUM-DECIMALS  05630000
056700     PERFORM 8100-NUMERIC-EDIT                                    05640000
056800     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-QTY            05650000
056900                                                                  05660000
057000*GB  3/07/12 BEG *2300-UPDATE-SKU-ATTR                            05670000
057100     MOVE XL011-SAC-INNER-PACK-QTY    TO DP010I-UNEDITED-FIELD    05680000
057200     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    05690000
057300     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  05700000
057400     PERFORM 8100-NUMERIC-EDIT                                    05710000
057500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-INNR-PK-QTY       05720000
057600                                                                  05730000
057700     MOVE XL011-SAC-OUTER-PACK-QTY    TO DP010I-UNEDITED-FIELD    05740000
057800     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    05750000
057900     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  05760000
058000     PERFORM 8100-NUMERIC-EDIT                                    05770000
058100     MOVE DP010I-NUMERIC-FIELD        TO PURITM-OUTR-PK-QTY       05780000
058200                                                                  05790000
058300*GB  3/07/12 END                                                  05800000
058400     PERFORM 3030-CALC-EXTENDS-AND-PCTS                           05810000
058500                                                                  05820000
058600     PERFORM 7140-UPDATE-TPURITM-ATTR.                            05830000
058700                                                                  05840000
058800 2300P-UPDATE-SKU-ATTR.                                           05850000
058900                                                                  05860000
059000     MOVE '2300P-UPDATE-SKU-ATTR'     TO XL011-ERROR-PARAGRAPH    05870000
059100     IF XL011-DEBUG-YES                                           05880000
059200         DISPLAY 'XLKUP009 - 2300P-UPDATE-SKU-ATTR'               05890000
059300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  05900000
059400                             XL011-RETURN-CODE                    05910000
059500     END-IF                                                       05920000
059600                                                                  05930000
059700     IF XL011-SAC-PROMO-STRT-DTE = SPACES OR ZEROES               05940000
059800         MOVE '0001-01-01'            TO PURITM-AD-EVNT-DTE       05950000
059900     ELSE                                                         05960000
060000     STRING XL011-SAC-PROMO-STRT-DTE (1:4)                        05970000
060100         '-'                                                      05980000
060200         XL011-SAC-PROMO-STRT-DTE (5:2)                           05990000
060300         '-'                                                      06000000
060400         XL011-SAC-PROMO-STRT-DTE (7:2) DELIMITED BY SIZE         06010000
060500                                      INTO PURITM-AD-EVNT-DTE     06020000
060600     END-IF                                                       06030000
060700                                                                  06040000
060800     MOVE XL011-SAC-PIC-SKU-IND       TO PURITM-PIC-ITM-IND       06050000
060900                                                                  06060000
061000                                                                  06070000
061100     MOVE XL011-SAC-COMP-SKU-NBR  TO POPRPK-PK-SKU-NBR            06080000
061200     PERFORM 7400-OPEN-PACK-CSR                                   06090000
061300     PERFORM 7410-FETCH-PACK-CSR                                  06100000
061400     PERFORM UNTIL PS-END-PACK-CSR-YES                            06110000
061500                 OR PS-ERROR-YES                                  06120000
061600                                                                  06130000
061700*        PERFORM 3040-LINE-STATUS                                 06140000
061800                                                                  06150000
061900*GB  3/07/12 BEG *2300P-UPDATE-SKU-ATTR                           06160000
062000*    MOVE XL011-SAC-INNER-PACK-QTY    TO DP010I-UNEDITED-FIELD    06170000
062100*    MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06180000
062200*    MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06190000
062300*    PERFORM 8100-NUMERIC-EDIT                                    06200000
062400*    MOVE DP010I-NUMERIC-FIELD        TO PURITM-INNR-PK-QTY       06210000
062500*                                                                 06220000
062600*    MOVE XL011-SAC-OUTER-PACK-QTY    TO DP010I-UNEDITED-FIELD    06230000
062700*    MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06240000
062800*    MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06250000
062900*    PERFORM 8100-NUMERIC-EDIT                                    06260000
063000*    MOVE DP010I-NUMERIC-FIELD        TO PURITM-OUTR-PK-QTY       06270000
063100*                                                                 06280000
063200*GB  3/07/12 END                                                  06290000
063300*                                                                 06300000
063400* 7/28   MOVE 8                       TO DP010I-MAXIMUM-DIGITS    06310000
063500*        MOVE 4                       TO DP010I-MAXIMUM-DECIMALS  06320000
063600*        MOVE XL011-SAC-FIRST-COST    TO PV-WORK-QTY              06330000
063700*        MOVE PV-WORK-QTY             TO DP010I-UNEDITED-FIELD    06340000
063800*        PERFORM 8100-NUMERIC-EDIT                                06350000
063900* 7/28   MOVE DP010I-NUMERIC-FIELD    TO PURITM-PRD-1ST-COST-AMT  06360000
064000                                                                  06370000
064100*        PERFORM 3030P-CALC-EXTENDS-AND-PCTS                      06380000
064200         PERFORM 3040-LINE-STATUS                                 06390000
064300         PERFORM 7140P-UPDATE-TPURITM-ATTR                        06400000
064400         PERFORM 7410-FETCH-PACK-CSR                              06410000
064500     END-PERFORM.                                                 06420000
064600                                                                  06430000
064700     IF PS-CSR-OPEN-YES                                           06440000
064800         PERFORM 7420-CLOSE-PACK-CSR                              06450000
064900     END-IF                                                       06460000
065000     SET PS-DONE-YES                  TO TRUE.                    06470000
065100/                                                                 06480000
065200 2400-UPDATE-TPURITM-QTYS.                                        06490000
065300                                                                  06500000
065400     MOVE '2400-UPDATE-TPURITM-QTYS'  TO XL011-ERROR-PARAGRAPH    06510000
065500     IF XL011-DEBUG-YES                                           06520000
065600         DISPLAY 'XLKUP009 - 2400-UPDATE-TPURITM-QTYS'            06530000
065700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  06540000
065800                             XL011-RETURN-CODE                    06550000
065900     END-IF                                                       06560000
066000     MOVE XL011-SKQC-ORD-QTY          TO PV-WORK-QTY              06570000
066100     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    06580000
066200     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06590000
066300     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06600000
066400     PERFORM 8100-NUMERIC-EDIT                                    06610000
066500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-QTY           06620000
066600                                                                  06630000
066700     MOVE XL011-SKQC-CNCLD-QTY        TO PV-WORK-QTY              06640000
066800     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    06650000
066900     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06660000
067000     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06670000
067100     PERFORM 8100-NUMERIC-EDIT                                    06680000
067200     MOVE DP010I-NUMERIC-FIELD        TO PURITM-CNCLD-UNT-QTY     06690000
067300                                                                  06700000
067400     PERFORM 3030-CALC-EXTENDS-AND-PCTS                           06710000
067500     PERFORM 3040-LINE-STATUS                                     06720000
067900                                                                  06730000
068000     PERFORM 7150-UPDATE-TPURITM-COSTS.                           06740012
068500                                                                  06750000
068600 2400P-UPDATE-TPURITM-QTYS.                                       06760000
068700                                                                  06770000
068800     MOVE '2400P-UPDATE-TPURITM-QTYS' TO XL011-ERROR-PARAGRAPH    06780000
068900     IF XL011-DEBUG-YES                                           06790000
069000         DISPLAY 'XLKUP009 - 2400P-UPDATE-TPURITM-QTYS'           06800000
069100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  06810000
069200                             XL011-RETURN-CODE                    06820000
069300     END-IF                                                       06830000
069400     MOVE XL011-SKQC-ORD-QTY          TO PV-WORK-QTY              06840000
069500     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    06850000
069600     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06860000
069700     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06870000
069800     PERFORM 8100-NUMERIC-EDIT                                    06880000
069900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-QTY           06890000
070000                                         PV-UNT-QTY-NEW           06900000
070100                                                                  06910000
070200     MOVE XL011-SKQC-CNCLD-QTY        TO PV-WORK-QTY              06920000
070300     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    06930000
070400     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    06940000
070500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  06950000
070600     PERFORM 8100-NUMERIC-EDIT                                    06960000
070700     MOVE DP010I-NUMERIC-FIELD        TO PURITM-CNCLD-UNT-QTY     06970000
070800                                         PV-CNCLD-UNT-QTY-NEW     06980000
070900                                                                  06990000
071000     MOVE XL011-SKQC-COMP-SKU-NBR     TO POPRPK-PK-SKU-NBR        07000000
071100     PERFORM 7400-OPEN-PACK-CSR                                   07010000
071200     PERFORM 7410-FETCH-PACK-CSR                                  07020000
071300                                                                  07030000
071400     PERFORM UNTIL PS-END-PACK-CSR-YES                            07040000
071500                   OR PS-ERROR-YES                                07050000
071600         PERFORM 3030P-CALC-EXTENDS-AND-PCTS                      07060000
071700         PERFORM 3040-LINE-STATUS                                 07070000
072000         PERFORM 7150P-UPDATE-TPURITM-COSTS                       07080000
072500         PERFORM 7410-FETCH-PACK-CSR                              07090000
072600     END-PERFORM.                                                 07100000
072700                                                                  07110000
072800     IF PS-CSR-OPEN-YES                                           07120000
072900         PERFORM 7420-CLOSE-PACK-CSR                              07130000
073000     END-IF                                                       07140000
073100     SET PS-DONE-YES                  TO TRUE.                    07150000
073200/                                                                 07160000
073300 2500-CHG-LOC-QTY.                                                07170000
073400                                                                  07180000
073500     MOVE '2500-CHG-LOC-QTY'          TO XL011-ERROR-PARAGRAPH    07190000
073600     IF XL011-DEBUG-YES                                           07200000
073700         DISPLAY 'XLKUP009 - 2500-CHG-LOC-QTY'                    07210000
073800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  07220000
073900                             XL011-RETURN-CODE                    07230000
074000     END-IF                                                       07240000
074100     MOVE XL011-LQC-ORD-QTY           TO PV-WORK-QTY              07250000
074200     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    07260000
074300     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    07270000
074400     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  07280000
074500     PERFORM 8100-NUMERIC-EDIT                                    07290000
074600     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-QTY           07300000
074700                                                                  07310000
074800     MOVE XL011-LQC-CNCLD-QTY         TO PV-WORK-QTY              07320000
074900     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    07330000
075000     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    07340000
075100     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  07350000
075200     PERFORM 8100-NUMERIC-EDIT                                    07360000
075300     MOVE DP010I-NUMERIC-FIELD        TO PURITM-CNCLD-UNT-QTY     07370000
075400                                                                  07380000
075500     PERFORM 3030-CALC-EXTENDS-AND-PCTS                           07390000
075600     PERFORM 3040-LINE-STATUS                                     07400000
075700                                                                  07410000
075800     PERFORM 7150-UPDATE-TPURITM-COSTS.                           07420000
075900                                                                  07430000
076000 2500P-CHG-LOC-QTY.                                               07440000
076100                                                                  07450000
076200     MOVE '2500P-CHG-LOC-QTY'         TO XL011-ERROR-PARAGRAPH    07460000
076300     IF XL011-DEBUG-YES                                           07470000
076400         DISPLAY 'XLKUP009 - 2500P-CHG-LOC-QTY'                   07480000
076500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  07490000
076600                             XL011-RETURN-CODE                    07500000
076700     END-IF                                                       07510000
076800     MOVE XL011-LQC-ORD-QTY           TO PV-WORK-QTY              07520000
076900     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    07530000
077000     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    07540000
077100     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  07550000
077200     PERFORM 8100-NUMERIC-EDIT                                    07560000
077300     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-QTY           07570000
077400                                         PV-UNT-QTY               07580000
077500                                                                  07590000
077600     MOVE XL011-LQC-CNCLD-QTY         TO PV-WORK-QTY              07600000
077700     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    07610000
077800     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    07620000
077900     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  07630000
078000     PERFORM 8100-NUMERIC-EDIT                                    07640000
078100     MOVE DP010I-NUMERIC-FIELD        TO PURITM-CNCLD-UNT-QTY     07650000
078200                                         PV-CNCLD-UNT-QTY-NEW     07660000
078300                                                                  07670000
078400*    PERFORM 3040-LINE-STATUS                                     07680000
078500                                                                  07690000
078600     MOVE XL011-LQC-COMP-SKU-NBR  TO POPRPK-PK-SKU-NBR            07700000
078700     PERFORM 7400-OPEN-PACK-CSR                                   07710000
078800     PERFORM 7410-FETCH-PACK-CSR                                  07720000
078900     PERFORM UNTIL PS-END-PACK-CSR-YES                            07730000
079000              OR PS-ERROR-YES                                     07740000
079100         PERFORM 3030P-CALC-EXTENDS-AND-PCTS                      07750000
079200         PERFORM 3040-LINE-STATUS                                 07760000
079300         PERFORM 7150P-UPDATE-TPURITM-COSTS                       07770000
079400         PERFORM 7410-FETCH-PACK-CSR                              07780000
079500     END-PERFORM.                                                 07790000
079600                                                                  07800000
079700     IF PS-CSR-OPEN-YES                                           07810000
079800         PERFORM 7420-CLOSE-PACK-CSR                              07820000
079900     END-IF                                                       07830000
080000     SET PS-DONE-YES                  TO TRUE.                    07840000
080100/                                                                 07850000
080200/                                                                 07860000
080300*GET PACKAGING CODE FROM TPURCHS                                  07870000
080400***************************************************************** 07880000
080500 2600-SELECT-TPURCHS.                                             07890000
080600****************************************************************  07900000
080700                                                                  07910000
080800     IF XL011-DEBUG-YES                                           07920000
080900          DISPLAY 'XLKUP009 - 2600-SELECT-TPURCHS'                07930000
081000          DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                 07940000
081100                              XL011-RETURN-CODE                   07950000
081200     END-IF                                                       07960000
081300                                                                  07970000
081400     PERFORM                                                      07980000
081500         WITH TEST AFTER                                          07990000
081600         VARYING PV-RETRY-COUNTER                                 08000000
081700         FROM 1 BY 1                                              08010000
081800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08020000
081900            OR  (SQLCODE = +100)                                  08030000
082000            OR  (SQLCODE = +0))                                   08040000
082100            OR PS-ERROR-YES                                       08050000
082200                                                                  08060000
082300     EXEC SQL                                                     08070000
082400        SELECT 1                                                  08080000
082500          INTO :PV-DB2-PKG-COUNT                                  08090000
082600          FROM  TPURCHS                                           08100000
082700        WHERE  PO_NBR                  = :PURITM-PO-NBR           08110000
082800          AND  VER_STATUS_CDE          = 'A'                      08120000
082900          AND  PKGNG_CDE               IN ('M', 'I')              08130000
083000          FETCH FIRST 1 ROW ONLY                                  08140000
083100          WITH UR                                                 08150000
083200     END-EXEC                                                     08160000
083300                                                                  08170000
083400     MOVE SQLCODE                     TO XL011-SQLCODE            08180000
083500                                         PV-DISP-SQLCODE          08190000
083600                                                                  08200000
083700         EVALUATE TRUE                                            08210000
083800             WHEN SQLCODE = ZERO                                  08220000
083900                 SET PS-ERROR-NO      TO TRUE                     08230000
084000                 SET PS-DONE-YES      TO TRUE                     08240000
084100**REMOVE 07/21/14                                                 08250000
084200**GB 6/13/14                                                      08260000
084300**REMOVE 07/21/14 PERFORM 7140P-UPDATE-TPURITM-ATTR               08270000
084301**GB 6/13/14                                                      08280000
084302**REMOVE 07/21/14                                                 08290000
084303             WHEN SQLCODE = +100                                  08300000
084304                 MOVE '2600-SELECT-TPURCHS'                       08310000
084305                                      TO XL011-ERROR-PARAGRAPH    08320000
084306                 STRING 'NO TPURITM FOUND FOR =' XL011-ORDER-NBR  08330000
084307                      DELIMITED BY SIZE                           08340000
084308                          INTO XL011-ERROR-TEXT                   08350000
084309                 SET XL011-SYSTEM-ERROR                           08360000
084310                                      TO TRUE                     08370000
084320                                                                  08380000
084330             WHEN SQLCODE = -904                                  08390000
084340             WHEN SQLCODE = -911                                  08400000
084350             WHEN SQLCODE = -913                                  08410000
084360                 IF  PV-RETRY-COUNTER > PC-MAX-RETRIES            08420000
084370                     SET XL011-SQL-ERROR                          08430000
084380                         PS-ERROR-YES TO TRUE                     08440000
084390                     MOVE '2600-SELECT-TPURCHS'                   08450000
084400                                      TO XL011-ERROR-PARAGRAPH    08460000
084500                     MOVE 'DB2 SYSTEM ERROR'                      08470000
084600                                      TO XL011-ERROR-TEXT         08480000
084700                 END-IF                                           08490000
084800             WHEN OTHER                                           08500000
084900                 SET PS-ERROR-YES     TO TRUE                     08510000
085000                 SET XL011-SQL-ERROR  TO TRUE                     08520000
085010                 MOVE '2600-SELECT-TPURCHS'                       08530000
085020                                      TO XL011-ERROR-PARAGRAPH    08540000
085030                 MOVE 'DB2 SYSTEM ERROR'                          08550000
085040                                      TO XL011-ERROR-TEXT         08560000
085050         END-EVALUATE                                             08570000
085060     END-PERFORM.                                                 08580000
085070/                                                                 08590000
085080 2800-DELETE-HDR.                                                 08600000
085090                                                                  08610000
085100     MOVE '2800-DELETE-HDR'           TO XL011-ERROR-PARAGRAPH    08620000
085200     IF XL011-DEBUG-YES                                           08630000
085300         DISPLAY 'XLKUP009 - 2800-DELETE-HDR'                     08640000
085400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  08650000
085500                             XL011-RETURN-CODE                    08660000
085600     END-IF                                                       08670000
085700                                                                  08680000
086100     PERFORM 7110-DELETE-TPURITM.                                 08690000
086600                                                                  08700000
086700 2800P-DELETE-HDR.                                                08710000
086800                                                                  08720000
086900     MOVE '2800P-DELETE-HDR'          TO XL011-ERROR-PARAGRAPH    08730000
087000     IF XL011-DEBUG-YES                                           08740000
087100         DISPLAY 'XLKUP009 - 2800P-DELETE-HDR'                    08750000
087200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  08760000
087300                             XL011-RETURN-CODE                    08770000
087400     END-IF                                                       08780000
087500                                                                  08790000
087600     MOVE XL011-SD-COMP-SKU-NBR   TO POPRPK-PK-SKU-NBR            08800000
087700     PERFORM 7400-OPEN-PACK-CSR                                   08810000
087800     PERFORM 7410-FETCH-PACK-CSR                                  08820000
087900     PERFORM UNTIL PS-END-PACK-CSR-YES                            08830000
088000                 OR PS-ERROR-YES                                  08840000
088100         PERFORM 3040-LINE-STATUS                                 08850000
088400         PERFORM 7110P-DELETE-TPURITM-BY-PREPK                    08860000
088900                                                                  08870000
089000         PERFORM 7410-FETCH-PACK-CSR                              08880000
089100     END-PERFORM.                                                 08890000
089200                                                                  08900000
089300     IF PS-CSR-OPEN-YES                                           08910000
089400         PERFORM 7420-CLOSE-PACK-CSR                              08920000
089500     END-IF                                                       08930000
089600     SET PS-DONE-YES                  TO TRUE.                    08940000
089700/                                                                 08950000
089800                                                                  08960000
089900                                                                  08970000
090000 3000-INSERT.                                                     08980000
090100                                                                  08990000
090200     MOVE '3000-INSERT'               TO XL011-ERROR-PARAGRAPH    09000000
090300     IF XL011-DEBUG-YES                                           09010000
090400         DISPLAY 'XLKUP009 - 3000-INSERT'                         09020000
090500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  09030000
090600                             XL011-RETURN-CODE                    09040000
090700     END-IF                                                       09050000
090800     INITIALIZE DCLTPURITM                                        09060000
090900     MOVE XL011-ORDER-NBR             TO PURITM-PO-NBR            09070000
091000     MOVE 1                           TO PURITM-VER-NBR           09080000
091100     PERFORM 3010-BUILD-COMMON-FIELDS.                            09090000
091200     IF XL011-SUCCESSFUL                                          09100000
091300         PERFORM 3020-SKU-QTYS                                    09110000
091400         PERFORM 3030-CALC-EXTENDS-AND-PCTS                       09120000
091500         PERFORM 3040-LINE-STATUS                                 09130000
091800         PERFORM 7100-INSERT-TPURITM                              09140000
092300     END-IF.                                                      09150000
092400                                                                  09160000
092500 3000P-INSERT.                                                    09170000
092600                                                                  09180000
092700     MOVE '3000P-INSERT'              TO XL011-ERROR-PARAGRAPH    09190000
092800     IF XL011-DEBUG-YES                                           09200000
092900         DISPLAY 'XLKUP009 - 3000P-INSERT'                        09210000
093000         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  09220000
093100                             XL011-RETURN-CODE                    09230000
093200     END-IF                                                       09240000
093300     INITIALIZE DCLTPURITM                                        09250000
093400     MOVE XL011-ORDER-NBR             TO PURITM-PO-NBR            09260000
093500     MOVE 1                           TO PURITM-VER-NBR           09270000
093600     PERFORM 3010P-BUILD-COMMON-FIELDS.                           09280000
093700     IF XL011-SUCCESSFUL                                          09290000
093800         PERFORM 3030-CALC-EXTENDS-AND-PCTS                       09300000
093900         PERFORM 3040-LINE-STATUS                                 09310000
094200         PERFORM 7100-INSERT-TPURITM                              09320000
094700     END-IF.                                                      09330000
094800                                                                  09340000
094900 3010-BUILD-COMMON-FIELDS.                                        09350000
095000                                                                  09360000
095100     MOVE '3010-BUILD-COMMON-FIELDS'  TO XL011-ERROR-PARAGRAPH    09370000
095200     IF XL011-DEBUG-YES                                           09380000
095300         DISPLAY 'XLKUP009 - 3010-BUILD-COMMON-FIELDS'            09390000
095400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  09400000
095500                             XL011-RETURN-CODE                    09410000
095600     END-IF                                                       09420000
095700     PERFORM 7010-FIND-NEXT-LINE                                  09430000
095800     IF PURITM-PO-LNE-NBR > 999                                   09440000
095900         STRING 'LINE NBR GREATER THAN 999 FOR PO '               09450000
096000             XL011-ORDER-NBR                                      09460000
096100             DELIMITED BY SIZE        INTO XL011-ERROR-TEXT       09470000
096200         SET XL011-SYSTEM-ERROR       TO TRUE                     09480000
096300     ELSE                                                         09490000
096400         PERFORM 3011-FINISH-COMMON-FIELDS                        09500000
096500     END-IF.                                                      09510000
096600                                                                  09520000
096700 3010P-BUILD-COMMON-FIELDS.                                       09530000
096800                                                                  09540000
096900     MOVE '3010P-BUILD-COMMON-FIELDS' TO XL011-ERROR-PARAGRAPH    09550000
097000     IF XL011-DEBUG-YES                                           09560000
097100         DISPLAY 'XLKUP009 - 3010P-BUILD-COMMON-FIELDS'           09570000
097200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  09580000
097300                             XL011-RETURN-CODE                    09590000
097400     END-IF                                                       09600000
097500     PERFORM 7010-FIND-NEXT-LINE                                  09610000
097600     IF PURITM-PO-LNE-NBR > 999                                   09620000
097700         STRING 'LINE NBR GREATER THAN 999 FOR PO '               09630000
097800             XL011-ORDER-NBR                                      09640000
097900             DELIMITED BY SIZE        INTO XL011-ERROR-TEXT       09650000
098000         SET XL011-SYSTEM-ERROR       TO TRUE                     09660000
098100     ELSE                                                         09670000
098200         PERFORM 3011P-FINISH-COMMON-FIELDS                       09680000
098300     END-IF.                                                      09690000
098400                                                                  09700000
098500 3011-FINISH-COMMON-FIELDS.                                       09710000
098600                                                                  09720000
098700     MOVE '3011-FINISH-COMMON-FIELDS' TO XL011-ERROR-PARAGRAPH    09730000
098800     IF XL011-DEBUG-YES                                           09740000
098900         DISPLAY 'XLKUP009 - 3011-FINISH-COMMON-FIELDS'           09750000
099000         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  09760000
099100                             XL011-RETURN-CODE                    09770000
099200     END-IF                                                       09780000
099300     MOVE 'A'                         TO PURITM-VER-STATUS-CDE    09790000
099400     MOVE SPACES                      TO PURITM-SKU-SEQ-NBR       09800000
099500     MOVE XL011-SA-COMP-SKU-NBR (6:3) TO PURITM-SKU-SEQ-NBR       09810000
099600                                                                  09820000
099700     INITIALIZE DCLXLT00003                                       09830000
099800                DCLXLT00004                                       09840000
099900                DK-SUB-CL                                         09850000
100000                DK-KOHLS-SIZE-CDE                                 09860000
100100     MOVE XL011-SA-COMP-SKU-NBR       TO XLT00003-SKU-NBR         09870000
100200     PERFORM 7210-SELECT-XLTSKU-ALL                               09880000
100300                                                                  09890000
100400     MOVE DK-SUB-CL                   TO PURITM-CL-NBR            09900000
100500     MOVE XLT00004-VS-NBR             TO PURITM-VEND-STYL-NAME    09910000
MB1993                                                                  09910119
MB1993     INSPECT PURITM-VEND-STYL-NAME    REPLACING ALL               09911019
MB1993         '>'   BY ' '.                                            09912019
MB1993     INSPECT PURITM-VEND-STYL-NAME    REPLACING ALL               09913019
MB1993         X'41' BY ' '.                                            09914019
MB1993                                                                  09915019
100600     MOVE XLT00003-CSTM-CLOR-DESC     TO PURITM-COLOR-DESC        09920000
100700     MOVE XLT00003-SIZE-DESC          TO PURITM-SIZE-DESC         09930000
100800     MOVE XLT00003-ITM-NBR            TO PURITM-ITM-NBR           09940000
100900     MOVE XLT00003-SKU-DESC           TO PURITM-SKU-DESC          09950000
101000     MOVE XLT00003-NRF-CLOR-CDE       TO PURITM-COLOR-CDE         09960000
101100     MOVE DK-KOHLS-SIZE-CDE           TO PURITM-SIZE-CDE          09970000
101200                                                                  09980000
101300     MOVE XL011-SA-COMP-SKU-NBR       TO PURITM-RMS-PO-SKU-NBR    09990000
101400     MOVE 'EA'                        TO PURITM-UM-IND            10000000
101500                                                                  10010000
101600*    MOVE 'XLKUP009'                  TO PURITM-LAST-UPD-BY-UID   10020000
101700                                                                  10030000
101800     MOVE PURITM-PO-LNE-NBR           TO PURITM-APP-PO-LNE-NBR    10040000
101900     MOVE XL011-SA-PIC-SKU-IND        TO PURITM-PIC-ITM-IND       10050000
102000     MOVE ZERO                        TO PURITM-PIC-PG-NBR        10060000
102100     MOVE 'N'                         TO PURITM-SHIP-TO-TMP-DC-IND10070000
102200     IF XL011-SA-PROMO-STRT-DTE = SPACES                          10080000
102300         MOVE '0001-01-01'            TO PURITM-AD-EVNT-DTE       10090000
102400     ELSE                                                         10100000
102500     STRING XL011-SA-PROMO-STRT-DTE (1:4)                         10110000
102600         '-'                                                      10120000
102700         XL011-SA-PROMO-STRT-DTE (5:2)                            10130000
102800         '-'                                                      10140000
102900         XL011-SA-PROMO-STRT-DTE (7:2) DELIMITED BY SIZE          10150000
103000                                      INTO PURITM-AD-EVNT-DTE     10160000
103100     END-IF.                                                      10170000
103200                                                                  10180000
103300 3011P-FINISH-COMMON-FIELDS.                                      10190000
103400                                                                  10200000
103500     MOVE '3011P-FINISH-COMMON-FIELDS' TO XL011-ERROR-PARAGRAPH   10210000
103600     IF XL011-DEBUG-YES                                           10220000
103700         DISPLAY 'XLKUP009 - 3011P-FINISH-COMMON-FIELDS'          10230000
103800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  10240000
103900                             XL011-RETURN-CODE                    10250000
104000     END-IF                                                       10260000
104100     MOVE 'A'                         TO PURITM-VER-STATUS-CDE    10270000
104200*    MOVE SPACES                      TO PURITM-SKU-SEQ-NBR       10280000
104300                                                                  10290000
104400     EVALUATE XL011-MSG-ID                                        10300000
104500     WHEN 'PACK_COMP_ADD'                                         10310000
104600         MOVE XL011-PCA-COMP-SKU-NBR(6:3) TO PURITM-SKU-SEQ-NBR   10320000
104700         PERFORM 3011PCA-BUILD-FROM-PCA                           10330000
104800     WHEN OTHER                                                   10340000
104900         CONTINUE                                                 10350000
105000     END-EVALUATE.                                                10360000
105100                                                                  10370000
105200 3011PCA-BUILD-FROM-PCA.                                          10380000
105300     IF XL011-DEBUG-YES                                           10390000
105400         DISPLAY 'XLKUP009 - 3011PCA-BUILD-FROM-PCA'              10400000
105500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  10410000
105600                             XL011-RETURN-CODE                    10420000
105700     END-IF                                                       10430000
105800     MOVE '3011PCA-BUILD-FROM-PCA'     TO XL011-ERROR-PARAGRAPH   10440000
105900*    BUILDING A PURITM FROM A 'PACK_COMP_ADD' SEGMENT             10450000
106000                                                                  10460000
106100     INITIALIZE DCLXLT00003                                       10470000
106200                DCLXLT00004                                       10480000
106300                DK-SUB-CL                                         10490000
106400                DK-KOHLS-SIZE-CDE                                 10500000
106500                                                                  10510000
106600     MOVE XL011-PCA-COMP-SKU-NBR      TO XLT00003-SKU-NBR         10520000
106700     PERFORM 7210-SELECT-XLTSKU-ALL                               10530000
106800                                                                  10540000
106900     MOVE DK-SUB-CL                   TO PURITM-CL-NBR            10550000
107000     MOVE XLT00004-VS-NBR             TO PURITM-VEND-STYL-NAME    10560019
MB1993                                                                  10561019
MB1993     INSPECT PURITM-VEND-STYL-NAME    REPLACING ALL               10562019
MB1993         '>'   BY ' '.                                            10563019
MB1993     INSPECT PURITM-VEND-STYL-NAME    REPLACING ALL               10564019
MB1993         X'41' BY ' '.                                            10565019
MB1993                                                                  10566019
107100     MOVE XLT00003-CSTM-CLOR-DESC     TO PURITM-COLOR-DESC        10570019
107200     MOVE XLT00003-SIZE-DESC          TO PURITM-SIZE-DESC         10580000
107300     MOVE XLT00003-ITM-NBR            TO PURITM-ITM-NBR           10590000
107400     MOVE XLT00003-SKU-DESC           TO PURITM-SKU-DESC          10600000
107500     MOVE XLT00003-NRF-CLOR-CDE       TO PURITM-COLOR-CDE         10610000
107600     MOVE DK-KOHLS-SIZE-CDE           TO PURITM-SIZE-CDE          10620000
107700                                                                  10630000
107800     MOVE XL011-PACK-PIC-ITM-IND      TO PURITM-PIC-ITM-IND       10640000
107900     MOVE XL011-PACK-AD-EVNT-DTE      TO PURITM-AD-EVNT-DTE       10650000
108000                                                                  10660000
108100     MOVE XL011-PCA-COMP-SKU-NBR      TO PURITM-RMS-PO-SKU-NBR    10670000
108200     MOVE 'EA'                        TO PURITM-UM-IND            10680000
108300                                                                  10690000
108400*    MOVE 'XLKUP009'                  TO PURITM-LAST-UPD-BY-UID   10700000
108500                                                                  10710000
108600     MOVE PURITM-PO-LNE-NBR           TO PURITM-APP-PO-LNE-NBR    10720000
108700     MOVE ZERO                        TO PURITM-PIC-PG-NBR        10730000
108800     MOVE 'N'                         TO PURITM-SHIP-TO-TMP-DC-IND10740000
108900                                                                  10750000
109000     MOVE XL011-PCA-PK-RATO-UNT-QTY   TO PURITM-PREPK-RATO-QTY    10760000
109100                                                                  10770000
109200     MOVE XL011-ORDER-NBR             TO POPRPK-PO-NBR            10780000
109300     MOVE XL011-PCA-PACK-SKU-NBR      TO POPRPK-PK-SKU-NBR        10790000
109400     PERFORM 7310-SELECT-POPRPK-ID                                10800000
109500     MOVE POPRPK-PO-PREPK-ID          TO PURITM-PO-PREPK-ID       10810000
109600                                                                  10820000
109700     COMPUTE                                                      10830000
109800         PURITM-UNT-QTY = XL011-PACK-ORD-QTY *                    10840000
109900             XL011-PCA-PK-RATO-UNT-QTY                            10850000
110000     END-COMPUTE                                                  10860000
110100                                                                  10870000
110200     COMPUTE                                                      10880000
110300         PURITM-CNCLD-UNT-QTY = XL011-PACK-CNCLD-QTY *            10890000
110400             XL011-PCA-PK-RATO-UNT-QTY                            10900000
110500     END-COMPUTE                                                  10910000
110600                                                                  10920000
110700     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    10930000
110800     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  10940000
110900     MOVE XL011-PCA-UNIT-COST         TO PV-WORK-QTY              10950000
111000     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    10960000
111100     PERFORM 8100-NUMERIC-EDIT                                    10970000
111200     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-COST-AMT.     10980000
111300                                                                  10990000
111400     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11000000
111500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11010000
111600     MOVE XL011-PCA-FIRST-COST        TO PV-WORK-QTY              11020000
111700     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11030000
111800     PERFORM 8100-NUMERIC-EDIT                                    11040000
111900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-PRD-1ST-COST-AMT. 11050000
112000                                                                  11060000
112100     MOVE XL011-PCA-GP-RTL-AMT        TO DP010I-UNEDITED-FIELD    11070000
112200     MOVE 07                          TO DP010I-MAXIMUM-DIGITS    11080000
112300     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  11090000
112400     PERFORM 8100-NUMERIC-EDIT                                    11100000
112500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-RTL-AMT.       11110000
112600                                                                  11120000
112700     MOVE XL011-PCA-GP-RTL-QTY        TO DP010I-UNEDITED-FIELD    11130000
112800     MOVE 05                          TO DP010I-MAXIMUM-DIGITS    11140000
112900     MOVE 0                           TO DP010I-MAXIMUM-DECIMALS  11150000
113000     PERFORM 8100-NUMERIC-EDIT                                    11160000
113100     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-QTY.           11170000
113200                                                                  11180000
113300     MOVE XL011-PCA-UNT-RTL-AMT       TO PV-WORK-QTY              11190000
113400     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11200000
113500     MOVE 07                          TO DP010I-MAXIMUM-DIGITS    11210000
113600     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  11220000
113700     PERFORM 8100-NUMERIC-EDIT                                    11230000
113800     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-RTL-PR-AMT    11240000
113900                                         PV-UNT-RTL-PR-AMT.       11250000
114000*GB  3/07/12 BEG                                                  11260000
114100* INNER PACK QUANTITY                                             11270000
114200     MOVE XL011-PCA-INNER-PACK-QTY    TO PV-WORK-QTY              11280000
114300     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11290000
114400     MOVE 08                          TO DP010I-MAXIMUM-DIGITS    11300000
114500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11310000
114600     PERFORM 8100-NUMERIC-EDIT                                    11320000
114700     MOVE DP010I-NUMERIC-FIELD        TO PURITM-INNR-PK-QTY       11330000
114800* OUTER PACK QUANTITY                                             11340000
114900     MOVE XL011-PCA-OUTER-PACK-QTY    TO PV-WORK-QTY              11350000
115000     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11360000
115100     MOVE 08                          TO DP010I-MAXIMUM-DIGITS    11370000
115200     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11380000
115300     PERFORM 8100-NUMERIC-EDIT                                    11390000
115400     MOVE DP010I-NUMERIC-FIELD        TO PURITM-OUTR-PK-QTY.      11400000
115500*GB  3/07/12 END                                                  11410000
115600                                                                  11420000
115700 3020-SKU-QTYS.                                                   11430000
115800                                                                  11440000
115900     MOVE '3020-SKU-QTYS'              TO XL011-ERROR-PARAGRAPH   11450000
116000     IF XL011-DEBUG-YES                                           11460000
116100         DISPLAY 'XLKUP009 - 3020-SKU-QTYS'                       11470000
116200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  11480000
116300                             XL011-RETURN-CODE                    11490000
116400     END-IF                                                       11500000
116500     MOVE XL011-SA-ORD-QTY            TO DP010I-UNEDITED-FIELD    11510000
116600     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11520000
116700     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11530000
116800     PERFORM 8100-NUMERIC-EDIT                                    11540000
116900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-QTY           11550000
117000                                                                  11560000
117100     MOVE XL011-SA-CNCLD-QTY          TO DP010I-UNEDITED-FIELD    11570000
117200     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11580000
117300     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11590000
117400     PERFORM 8100-NUMERIC-EDIT                                    11600000
117500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-CNCLD-UNT-QTY     11610000
117600                                                                  11620000
117700     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11630000
117800     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11640000
117900     MOVE XL011-SA-UNIT-COST          TO PV-WORK-QTY              11650000
118000     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11660000
118100     PERFORM 8100-NUMERIC-EDIT                                    11670000
118200     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-COST-AMT.     11680000
118300                                                                  11690000
118400     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11700000
118500     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11710000
118600     MOVE XL011-SA-FIRST-COST         TO PV-WORK-QTY              11720000
118700     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    11730000
118800     PERFORM 8100-NUMERIC-EDIT                                    11740000
118900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-PRD-1ST-COST-AMT. 11750000
119000                                                                  11760000
119100     MOVE XL011-SA-GP-RTL-AMT         TO DP010I-UNEDITED-FIELD    11770000
119200     MOVE 07                          TO DP010I-MAXIMUM-DIGITS    11780000
119300     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  11790000
119400     PERFORM 8100-NUMERIC-EDIT                                    11800000
119500     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-RTL-AMT.       11810000
119600                                                                  11820000
119700     MOVE XL011-SA-GP-RTL-QTY         TO DP010I-UNEDITED-FIELD    11830000
119800     MOVE 05                          TO DP010I-MAXIMUM-DIGITS    11840000
119900     MOVE 0                           TO DP010I-MAXIMUM-DECIMALS  11850000
120000     PERFORM 8100-NUMERIC-EDIT                                    11860000
120100     MOVE DP010I-NUMERIC-FIELD        TO PURITM-GP-QTY.           11870000
120200                                                                  11880000
120300*GB  3/07/12 BEG *3020-SKU-QTYS                                   11890000
120400* INNER PACK QUANTITY                                             11900000
120500     MOVE XL011-SA-INNER-PACK-QTY     TO DP010I-UNEDITED-FIELD    11910000
120600     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    11920000
120700     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  11930000
120800     PERFORM 8100-NUMERIC-EDIT                                    11940000
120900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-INNR-PK-QTY       11950000
121000                                                                  11960000
121100* OUTER PACK QUANTITY                                             11970000
121200*GB  7/22/12  INNER PACK AND VND-QTY EXIST ON TWO SEPERATE TABLES 11980000
121300*GB  SO MERCH CANNOT USE VND-QTY AS OUTER PACK, SO NEW COLUMN HAS 11990000
121400*GB  BEEN ADDED TO TABLE , NEW FIELD HAS BEEN ADDED TO COPYBOOK   12000000
121500*GB  MOVE XL011-SA-VND-QTY            TO DP010I-UNEDITED-FIELD    12010000
121600     MOVE XL011-SA-OUTER-PACK-QTY     TO DP010I-UNEDITED-FIELD    12020000
121700     MOVE 8                           TO DP010I-MAXIMUM-DIGITS    12030000
121800     MOVE 4                           TO DP010I-MAXIMUM-DECIMALS  12040000
121900     PERFORM 8100-NUMERIC-EDIT                                    12050000
122000     MOVE DP010I-NUMERIC-FIELD        TO PURITM-OUTR-PK-QTY       12060000
122100                                                                  12070000
122200*GB  3/07/12 END                                                  12080000
122300                                                                  12090000
122400     MOVE XL011-SA-UNT-RTL-AMT        TO PV-WORK-QTY              12100000
122500     MOVE PV-WORK-QTY                 TO DP010I-UNEDITED-FIELD    12110000
122600     MOVE 07                          TO DP010I-MAXIMUM-DIGITS    12120000
122700     MOVE 2                           TO DP010I-MAXIMUM-DECIMALS  12130000
122800     PERFORM 8100-NUMERIC-EDIT                                    12140000
122900     MOVE DP010I-NUMERIC-FIELD        TO PURITM-UNT-RTL-PR-AMT    12150000
123000                                         PV-UNT-RTL-PR-AMT.       12160000
123100                                                                  12170000
123200 3030-CALC-EXTENDS-AND-PCTS.                                      12180000
123300                                                                  12190000
123400     MOVE '3030-CALC-EXTENDS-AND-PCTS' TO XL011-ERROR-PARAGRAPH   12200000
123500     IF XL011-DEBUG-YES                                           12210000
123600         DISPLAY 'XLKUP009 - 3030-CALC-EXTENDS-AND-PCTS'          12220000
123700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  12230000
123800                             XL011-RETURN-CODE                    12240000
123900     END-IF                                                       12250000
124000     COMPUTE                                                      12260000
124100         PURITM-TOT-VAL-COST-AMT = PURITM-UNT-COST-AMT *          12270000
124200                                       PURITM-UNT-QTY             12280000
124300     END-COMPUTE                                                  12290000
124400                                                                  12300000
124500     IF PURITM-GP-RTL-AMT > ZERO                                  12310000
124600         COMPUTE PURITM-TOT-VAL-RTL-AMT =                         12320000
124700                 PURITM-UNT-QTY *                                 12330000
124800                (PURITM-GP-RTL-AMT / PURITM-GP-QTY)               12340000
124900         ON SIZE ERROR                                            12350000
125000             MOVE ZERO                TO PURITM-TOT-VAL-RTL-AMT   12360000
125100         END-COMPUTE                                              12370000
125200     ELSE                                                         12380000
125300         COMPUTE PURITM-TOT-VAL-RTL-AMT =                         12390000
125400                 PURITM-UNT-QTY * PURITM-UNT-RTL-PR-AMT           12400000
125500     END-IF                                                       12410000
125600                                                                  12420000
125700     IF PURITM-TOT-VAL-COST-AMT >= PURITM-TOT-VAL-RTL-AMT         12430000
125800         MOVE ZERO                    TO PV-MARKUP-PCT            12440000
125900     ELSE                                                         12450000
126000         COMPUTE PV-MARKUP-PCT =                                  12460000
126100          (( PURITM-TOT-VAL-RTL-AMT - PURITM-TOT-VAL-COST-AMT )   12470000
126200                / PURITM-TOT-VAL-RTL-AMT ) * 100                  12480000
126300         ON SIZE ERROR                                            12490000
126400             MOVE ZERO                TO PV-MARKUP-PCT            12500000
126500         END-COMPUTE                                              12510000
126600     END-IF                                                       12520000
126700     MOVE PV-MARKUP-PCT               TO PURITM-MU-PCT.           12530000
126800                                                                  12540000
126900     IF XL011-DEBUG-YES                                           12550000
127000         DISPLAY 'LINE ='  PURITM-PO-LNE-NBR                      12560000
127100                 ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            12570000
127200                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             12580000
127300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  12590000
127400                             XL011-RETURN-CODE                    12600000
127500     END-IF.                                                      12610000
127600                                                                  12620000
127700 3030P-CALC-EXTENDS-AND-PCTS.                                     12630000
127800                                                                  12640000
127900     MOVE '3030P-CALC-EXTENDS-AND-PCTS' TO XL011-ERROR-PARAGRAPH  12650000
128000     IF XL011-DEBUG-YES                                           12660000
128100         DISPLAY SPACES                                           12670000
128200         DISPLAY 'XLKUP009 - 3030P-CALC-EXTENDS-AND-PCTS'         12680000
128300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  12690000
128400                             XL011-RETURN-CODE                    12700000
128500     END-IF                                                       12710000
128600                                                                  12720000
128700     COMPUTE PURITM-UNT-QTY =                                     12730000
128800         PURITM-PREPK-RATO-QTY * PV-UNT-QTY-NEW                   12740000
128900     ON SIZE ERROR                                                12750000
129000             DISPLAY 'XLKUP009 - PARA 3030P SIZE ERROR - PO '     12760000
129100                              XL011-ORDER-NBR                     12770000
129200                              ' (UNT-QTY)'                        12780000
129300     END-COMPUTE                                                  12790000
129400                                                                  12800000
129500     COMPUTE PURITM-CNCLD-UNT-QTY =                               12810000
129600         PURITM-PREPK-RATO-QTY * PV-CNCLD-UNT-QTY-NEW             12820000
129700     ON SIZE ERROR                                                12830000
129800             DISPLAY 'XLKUP009 - PARA 3030P SIZE ERROR - PO '     12840000
129900                              XL011-ORDER-NBR                     12850000
130000                              ' (CNCLD-UNT-QTY)'                  12860000
130100     END-COMPUTE                                                  12870000
130200                                                                  12880000
130300     COMPUTE                                                      12890000
130400         PURITM-TOT-VAL-COST-AMT = PV-UNT-COST-AMT *              12900000
130500                                       PURITM-UNT-QTY             12910000
130600     END-COMPUTE                                                  12920000
130700                                                                  12930000
130800     IF PURITM-GP-RTL-AMT > ZERO                                  12940000
130900         COMPUTE PURITM-TOT-VAL-RTL-AMT =                         12950000
131000                 PURITM-UNT-QTY *                                 12960000
131100                (PURITM-GP-RTL-AMT / PURITM-GP-QTY)               12970000
131200         ON SIZE ERROR                                            12980000
131300             MOVE ZERO                TO PURITM-TOT-VAL-RTL-AMT   12990000
131400         END-COMPUTE                                              13000000
131500     ELSE                                                         13010000
131600         COMPUTE PURITM-TOT-VAL-RTL-AMT =                         13020000
131700                 PURITM-UNT-QTY * PURITM-UNT-RTL-PR-AMT           13030000
131800     END-IF                                                       13040000
131900                                                                  13050000
132000     IF XL011-DEBUG-YES                                           13060000
132100         DISPLAY 'LINE ='  PURITM-PO-LNE-NBR                      13070000
132200                 ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            13080000
132300                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             13090000
132400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  13100000
132500                             XL011-RETURN-CODE                    13110000
132600     END-IF                                                       13120000
132700                                                                  13130000
132800     COMPUTE PV-MARKUP-PCT   =                                    13140000
132900      (( PURITM-TOT-VAL-RTL-AMT - PURITM-TOT-VAL-COST-AMT )       13150000
133000            / PURITM-TOT-VAL-RTL-AMT ) * 100                      13160000
133100     ON SIZE ERROR                                                13170000
133200         MOVE ZERO                    TO PV-MARKUP-PCT            13180000
133300     END-COMPUTE.                                                 13190000
133400     MOVE PV-MARKUP-PCT               TO PURITM-MU-PCT.           13200000
133500                                                                  13210000
133600 3040-LINE-STATUS.                                                13220000
133700                                                                  13230000
133800     MOVE '3040-LINE-STATUS'           TO XL011-ERROR-PARAGRAPH   13240000
133900                                                                  13250000
134000     IF XL011-DEBUG-YES                                           13260000
134100         DISPLAY 'XLKUP009 - 3040-LINE-STATUS'                    13270000
134200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  13280000
134300                             XL011-RETURN-CODE                    13290000
134400     END-IF                                                       13300000
134500                                                                  13310000
134600     IF PURITM-CNCLD-UNT-QTY > ZERO                               13320000
134700         IF PURITM-UNT-QTY = ZERO                                 13330000
134800             MOVE 'CA'                TO PURITM-STATUS-CDE        13340000
134900         ELSE                                                     13350000
135000             MOVE 'CB'                TO PURITM-STATUS-CDE        13360000
135100         END-IF                                                   13370000
135200     ELSE                                                         13380000
135300         IF PV-CURRENT-STATUS-CDE = 'CA' OR 'CB'                  13390000
135400             IF PURITM-UNT-QTY > ZERO                             13400000
135500                 MOVE 'AC'            TO PURITM-STATUS-CDE        13410000
135600             ELSE                                                 13420000
135700                 MOVE PV-CURRENT-STATUS-CDE                       13430000
135800                                      TO PURITM-STATUS-CDE        13440000
135900                 MOVE PV-CURRENT-CNCLD-UNT-QTY                    13450000
136000                                      TO PURITM-CNCLD-UNT-QTY     13460000
136100             END-IF                                               13470000
136200         ELSE                                                     13480000
136300             MOVE 'AC'                TO PURITM-STATUS-CDE        13490000
136400         END-IF                                                   13500000
136500     END-IF.                                                      13510000
136600                                                                  13520000
136700     IF XL011-DEBUG-YES                                           13530000
136800         DISPLAY 'PURITM-STATUS-CDE     = ' PURITM-STATUS-CDE     13540000
136900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  13550000
137000                             XL011-RETURN-CODE                    13560000
137100     END-IF.                                                      13570000
137200/                                                                 13580000
137300 4000-INSERT-PACK-COMP.                                           13590000
137400                                                                  13600000
137500     IF XL011-DEBUG-YES                                           13610000
137600         DISPLAY 'XLKUP009 - 4000-INSERT-PACK-COMP'               13620000
137700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  13630000
137800                             XL011-RETURN-CODE                    13640000
137900     END-IF                                                       13650000
138000     PERFORM 3000P-INSERT.                                        13660000
138100/                                                                 13670000
178246                                                                  13680000
178247                                                                  13690000
178248 7000-SELECT-TPURCHS.                                             13700000
178249                                                                  13710000
178250     MOVE '7000-SELECT-TPURCHS'       TO XL011-ERROR-PARAGRAPH    13720000
178260     IF XL011-DEBUG-YES                                           13730000
178270         DISPLAY 'XLKUP009 - 7000-SELECT-TPURCHS'                 13740000
178280         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  13750000
178290                             XL011-RETURN-CODE                    13760000
178300     END-IF                                                       13770000
178400     MOVE XL011-ORDER-NBR             TO PURCHS-PO-NBR            13780000
178500     MOVE ZERO                        TO PS-EXISTENCE-PO          13790000
178600                                                                  13800000
178700* JAK 04/2007 - ADD ENT_ID & STATUS_CDE TO SELECT                 13810000
178800                                                                  13820000
178900*    SET PS-ERROR-NO                  TO TRUE                     13830000
179000     PERFORM                                                      13840000
179100         WITH TEST AFTER                                          13850000
179200         VARYING PV-RETRY-COUNTER                                 13860000
179300         FROM 1 BY 1                                              13870000
179400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13880000
179500            OR  (SQLCODE = +0)                                    13890000
179600            OR  (SQLCODE = +100))                                 13900000
179700            OR PS-ERROR-YES                                       13910000
179800                                                                  13920000
179900                                                                  13930000
180000     EXEC SQL                                                     13940000
180100         SELECT 1                                                 13950000
180200              , ENT_ID                                            13960000
180300              , STATUS_CDE                                        13970000
180400         INTO                                                     13980000
180500             :PS-EXISTENCE-PO                                     13990000
180600           , :PURCHS-ENT-ID                                       14000000
180700           , :PURCHS-STATUS-CDE                                   14010000
180800         FROM                                                     14020000
180900             TPURCHS                                              14030000
181000         WHERE                                                    14040000
181100             PO_NBR                   = :PURCHS-PO-NBR            14050000
181200         AND VER_STATUS_CDE           = 'A'                       14060000
181300         FETCH FIRST 1 ROWS ONLY                                  14070000
181400     END-EXEC                                                     14080000
181500                                                                  14090000
181600     MOVE SQLCODE                     TO XL011-SQLCODE            14100000
181700                                         PV-DISP-SQLCODE          14110000
181800     IF XL011-DEBUG-YES                                           14120000
181900         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    14130000
182000                  ' PS-ERROR-SW=' PS-ERROR-SW                     14140000
182100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  14150000
182200                             XL011-RETURN-CODE                    14160000
182300     END-IF                                                       14170000
182400                                                                  14180000
182500     EVALUATE TRUE                                                14190000
182600         WHEN SQLCODE = ZERO                                      14200000
182700             CONTINUE                                             14210000
182800         WHEN SQLCODE = -904                                      14220000
182900         WHEN SQLCODE = -911                                      14230000
183000         WHEN SQLCODE = -913                                      14240000
183100             DISPLAY '7000-!!!!!!!!!!!'                           14250000
183200                                                                  14260000
183300         WHEN SQLCODE = +100                                      14270000
183400             IF XL011-MSG-ID = 'HDR_DELETE'                       14280000
183500                 CONTINUE                                         14290000
183600             ELSE                                                 14300000
183700                 STRING 'NO TPURCHS FOR PO = ' XL011-ORDER-NBR    14310000
183800                         DELIMITED BY SIZE                        14320000
183900                                      INTO XL011-ERROR-TEXT       14330000
184000                 SET XL011-SYSTEM-ERROR TO TRUE                   14340000
184100                 MOVE 'TPURCHS'       TO XL011-DB2-TABLE-NAME(1)  14350000
184200             END-IF                                               14360000
184300         WHEN OTHER                                               14370000
184400             SET XL011-SQL-ERROR                                  14380000
184500                 PS-ERROR-YES         TO TRUE                     14390000
184600             MOVE 'TPURCHS'           TO XL011-DB2-TABLE-NAME(1)  14400000
184700     END-EVALUATE                                                 14410000
184800     END-PERFORM                                                  14420000
184900                                                                  14430000
185000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14440000
185100         SET XL011-SQL-ERROR                                      14450000
185200                 PS-ERROR-YES         TO TRUE                     14460000
185300     END-IF.                                                      14470000
185400                                                                  14480000
185500     IF XL011-DEBUG-YES                                           14490000
185600         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    14500000
185700                  ' PS-ERROR-SW=' PS-ERROR-SW                     14510000
185800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  14520000
185900                             XL011-RETURN-CODE                    14530000
186000     END-IF.                                                      14540000
186100/                                                                 14550000
186200 7005-SELECT-TPURITM.                                             14560000
186300** GB 06/25/14 ADD AND STMT TO RETURN ROWS THAT ARE NOT CANCELLED 14570000
186400** GB IF NO ROWS FOUND PERFORM 7006- PARA TO CHECK FOR            14580000
186500** GB ANY TPURITM ROWS                                            14590000
186600** GB 06/25/14                                                    14600000
186700                                                                  14610000
186800     MOVE '7005-SELECT-TPURITM'       TO XL011-ERROR-PARAGRAPH    14620000
186900     IF XL011-DEBUG-YES                                           14630000
186910         DISPLAY 'XLKUP009 - 7005-SELECT-TPURITM'                 14640000
186920         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  14650000
186930                             XL011-RETURN-CODE                    14660000
186940     END-IF                                                       14670000
186950     MOVE ZERO                        TO PS-EXISTENCE-PURITM      14680000
186960*    SET PS-ERROR-NO                  TO TRUE                     14690000
186970                                                                  14700000
186980     PERFORM                                                      14710000
186990         WITH TEST AFTER                                          14720000
187000         VARYING PV-RETRY-COUNTER                                 14730000
187100         FROM 1 BY 1                                              14740000
187200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14750000
187300            OR  (SQLCODE = +0)                                    14760000
187400            OR  (SQLCODE = +100))                                 14770000
187500            OR PS-ERROR-YES                                       14780000
187600                                                                  14790000
187700                                                                  14800000
187800     EXEC SQL                                                     14810000
187900         SELECT                                                   14820000
188000             STATUS_CDE                                           14830000
188100         ,   UNT_QTY                                              14840000
188200         ,   UNT_COST_AMT                                         14850000
188300         ,   UNT_RTL_PR_AMT                                       14860000
188400         ,   GP_RTL_AMT                                           14870000
188500         ,   GP_QTY                                               14880000
188600         ,   PREPK_RATO_QTY                                       14890000
188700         ,   CNCLD_UNT_QTY                                        14900000
188800         INTO                                                     14910000
188900             :PV-CURRENT-STATUS-CDE                               14920000
189000         ,   :PURITM-UNT-QTY                                      14930000
189100         ,   :PURITM-UNT-COST-AMT                                 14940000
189200         ,   :PURITM-UNT-RTL-PR-AMT                               14950000
189300         ,   :PURITM-GP-RTL-AMT                                   14960000
189400         ,   :PURITM-GP-QTY                                       14970000
189500         ,   :PURITM-PREPK-RATO-QTY                               14980000
189600         ,   :PV-CURRENT-CNCLD-UNT-QTY                            14990000
189700         FROM                                                     15000000
189800             TPURITM                                              15010000
189900         WHERE                                                    15020000
190000             PO_NBR                   = :PURITM-PO-NBR            15030000
190100         AND ITM_NBR                  = :PURITM-ITM-NBR           15040000
190200         AND VER_STATUS_CDE           = 'A'                       15050000
190300         AND STATUS_CDE          NOT IN ('CA' , 'CB')             15060000
190400         FETCH FIRST 1 ROWS ONLY                                  15070000
190500     END-EXEC                                                     15080000
190600                                                                  15090000
190700     MOVE SQLCODE                     TO XL011-SQLCODE            15100000
190800                                         PV-DISP-SQLCODE          15110000
190900                                                                  15120000
191000     IF XL011-DEBUG-YES                                           15130000
191100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    15140000
191200                  ' PS-ERROR-SW=' PS-ERROR-SW                     15150000
191300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  15160000
191400                             XL011-RETURN-CODE                    15170000
191500     END-IF                                                       15180000
191600                                                                  15190000
191700     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  15200000
191800     EVALUATE TRUE                                                15210000
191900         WHEN SQLCODE = ZERO                                      15220000
192000             SET PS-PURITM-EXISTS-YES                             15230000
192100                 PS-UPDATE-MODE       TO TRUE                     15240000
192300         WHEN SQLCODE = +100                                      15250000
192400             PERFORM 7006-SELECT-TPURITM-2                        15260000
192500                                                                  15270000
192600         WHEN SQLCODE = -904                                      15280000
192700         WHEN SQLCODE = -911                                      15290000
192800         WHEN SQLCODE = -913                                      15300000
192900             DISPLAY '7005-!!!!!!!!!!!'                           15310000
193000                                                                  15320000
193100         WHEN OTHER                                               15330000
193200             SET XL011-SQL-ERROR                                  15340000
193300                 PS-ERROR-YES         TO TRUE                     15350000
193400             MOVE 'TPURITM'           TO XL011-DB2-TABLE-NAME(1)  15360000
193600     END-EVALUATE                                                 15370000
193700     END-PERFORM                                                  15380000
193800                                                                  15390000
193900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15400000
194000         SET XL011-SQL-ERROR                                      15410000
194100                 PS-ERROR-YES         TO TRUE                     15420000
194200     END-IF.                                                      15430000
194300                                                                  15440000
194400     IF XL011-DEBUG-YES                                           15450000
194500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    15460000
194600                  ' PS-ERROR-SW=' PS-ERROR-SW                     15470000
194700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  15480000
194800                             XL011-RETURN-CODE                    15490000
194900     END-IF.                                                      15500000
195000/                                                                 15510000
195100 7006-SELECT-TPURITM-2.                                           15520000
195200                                                                  15530000
195300     MOVE '7006-SELECT-TPURITM-2'     TO XL011-ERROR-PARAGRAPH    15540000
195400     IF XL011-DEBUG-YES                                           15550000
195500         DISPLAY 'XLKUP009 - 7006-SELECT-TPURITM'                 15560000
195600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  15570000
195700                             XL011-RETURN-CODE                    15580000
195800     END-IF                                                       15590000
195900     MOVE ZERO                        TO PS-EXISTENCE-PURITM      15600000
196000*    SET PS-ERROR-NO                  TO TRUE                     15610000
196100                                                                  15620000
196200     PERFORM                                                      15630000
196210         WITH TEST AFTER                                          15640000
196220         VARYING PV-RETRY-COUNTER                                 15650000
196230         FROM 1 BY 1                                              15660000
196240         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15670000
196250            OR  (SQLCODE = +0)                                    15680000
196260            OR  (SQLCODE = +100))                                 15690000
196270            OR PS-ERROR-YES                                       15700000
196280                                                                  15710000
196290                                                                  15720000
196300     EXEC SQL                                                     15730000
196301         SELECT                                                   15740000
196302             STATUS_CDE                                           15750000
196303         ,   UNT_QTY                                              15760000
196304         ,   UNT_COST_AMT                                         15770000
196305         ,   UNT_RTL_PR_AMT                                       15780000
196306         ,   GP_RTL_AMT                                           15790000
196307         ,   GP_QTY                                               15800000
196308         ,   PREPK_RATO_QTY                                       15810000
196309         ,   CNCLD_UNT_QTY                                        15820000
196310         INTO                                                     15830000
196311             :PV-CURRENT-STATUS-CDE                               15840000
196312         ,   :PURITM-UNT-QTY                                      15850000
196313         ,   :PURITM-UNT-COST-AMT                                 15860000
196314         ,   :PURITM-UNT-RTL-PR-AMT                               15870000
196315         ,   :PURITM-GP-RTL-AMT                                   15880000
196316         ,   :PURITM-GP-QTY                                       15890000
196317         ,   :PURITM-PREPK-RATO-QTY                               15900000
196318         ,   :PV-CURRENT-CNCLD-UNT-QTY                            15910000
196319         FROM                                                     15920000
196320             TPURITM                                              15930000
196321         WHERE                                                    15940000
196322             PO_NBR                   = :PURITM-PO-NBR            15950000
196323         AND ITM_NBR                  = :PURITM-ITM-NBR           15960000
196324         AND VER_STATUS_CDE           = 'A'                       15970000
196325         FETCH FIRST 1 ROWS ONLY                                  15980000
196326     END-EXEC                                                     15990000
196327                                                                  16000000
196328     MOVE SQLCODE                     TO XL011-SQLCODE            16010000
196329                                         PV-DISP-SQLCODE          16020000
196330                                                                  16030000
196331     IF XL011-DEBUG-YES                                           16040000
196332         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    16050000
196333                  ' PS-ERROR-SW=' PS-ERROR-SW                     16060000
196334         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  16070000
196335                             XL011-RETURN-CODE                    16080000
196336     END-IF                                                       16090000
196337                                                                  16100000
196338     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  16110000
196339     EVALUATE TRUE                                                16120000
196340         WHEN SQLCODE = ZERO                                      16130000
196341             SET PS-PURITM-EXISTS-YES                             16140000
196342                 PS-UPDATE-MODE       TO TRUE                     16150000
196344         WHEN SQLCODE = +100                                      16160000
196345             SET PS-PURITM-EXISTS-NO                              16170000
196346                 PS-INSERT-MODE       TO TRUE                     16180000
196348                                                                  16190000
196349         WHEN SQLCODE = -904                                      16200000
196350         WHEN SQLCODE = -911                                      16210000
196351         WHEN SQLCODE = -913                                      16220000
196352             DISPLAY '7006-!!!!!!!!!!!'                           16230000
196353                                                                  16240000
196354         WHEN OTHER                                               16250000
196355             SET XL011-SQL-ERROR                                  16260000
196356                 PS-ERROR-YES         TO TRUE                     16270000
196357             MOVE 'TPURITM'           TO XL011-DB2-TABLE-NAME(1)  16280000
196359     END-EVALUATE                                                 16290000
196360     END-PERFORM                                                  16300000
196361                                                                  16310000
196362     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16320000
196363         SET XL011-SQL-ERROR                                      16330000
196364                 PS-ERROR-YES         TO TRUE                     16340000
196365     END-IF.                                                      16350000
196366                                                                  16360000
196367     IF XL011-DEBUG-YES                                           16370000
196368         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    16380000
196369                  ' PS-ERROR-SW=' PS-ERROR-SW                     16390000
196370         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  16400000
196371                             XL011-RETURN-CODE                    16410000
196372     END-IF.                                                      16420000
196373/                                                                 16430000
196374 7010-FIND-NEXT-LINE.                                             16440000
196375     MOVE '7010-FIND-NEXT-LINE'       TO XL011-ERROR-PARAGRAPH    16450000
196376     IF XL011-DEBUG-YES                                           16460000
196377         DISPLAY 'XLKUP009 - 7010-FIND-NEXT-LINE'                 16470000
196378         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  16480000
196379                             XL011-RETURN-CODE                    16490000
196380     END-IF                                                       16500000
196390                                                                  16510000
196400*    SET PS-ERROR-NO                  TO TRUE                     16520000
196500     PERFORM                                                      16530000
196600         WITH TEST AFTER                                          16540000
196700         VARYING PV-RETRY-COUNTER                                 16550000
196800         FROM 1 BY 1                                              16560000
196900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16570000
197000            OR  (SQLCODE = +0)                                    16580000
197100            OR  (SQLCODE = +100)                                  16590000
197200            OR  (SQLCODE = -305))                                 16600000
197300            OR PS-ERROR-YES                                       16610000
197400                                                                  16620000
197500                                                                  16630000
197600     EXEC SQL                                                     16640000
197700         SELECT                                                   16650000
197800         CASE WHEN                                                16660000
197900              MAX(PO_LNE_NBR) + 1 IS NULL THEN 1                  16670000
198000             ELSE                                                 16680000
198100              MAX(PO_LNE_NBR) + 1                                 16690000
198200             END                                                  16700000
198300         INTO                                                     16710000
198400             :PURITM-PO-LNE-NBR                                   16720000
198500         FROM                                                     16730000
198600             TPURITM                                              16740000
198700         WHERE                                                    16750000
198800             PO_NBR                   = :PURITM-PO-NBR            16760000
198900     END-EXEC                                                     16770000
199000                                                                  16780000
199100     MOVE SQLCODE                     TO XL011-SQLCODE            16790000
199200                                         PV-DISP-SQLCODE          16800000
199300                                                                  16810000
199400     IF XL011-DEBUG-YES                                           16820000
199500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    16830000
199600                  ' PS-ERROR-SW=' PS-ERROR-SW                     16840000
199700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  16850000
199800                             XL011-RETURN-CODE                    16860000
199900     END-IF                                                       16870000
200000                                                                  16880000
200100     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  16890000
200200     EVALUATE TRUE                                                16900000
200300         WHEN SQLCODE = ZERO                                      16910000
200400         WHEN SQLCODE = +100                                      16920000
200500         WHEN SQLCODE = -305                                      16930000
200600             CONTINUE                                             16940000
200700         WHEN SQLCODE = -904                                      16950000
200800         WHEN SQLCODE = -911                                      16960000
200900         WHEN SQLCODE = -913                                      16970000
201000             DISPLAY '7010-!!!!!!!!!!!'                           16980000
201100                                                                  16990000
201200         WHEN OTHER                                               17000000
201300             SET XL011-SQL-ERROR                                  17010000
201400                 PS-ERROR-YES         TO TRUE                     17020000
201500     END-EVALUATE                                                 17030000
201600                                                                  17040000
201700     END-PERFORM                                                  17050000
201800                                                                  17060000
201900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17070000
202000         SET XL011-SQL-ERROR                                      17080000
202100                 PS-ERROR-YES         TO TRUE                     17090000
202200     END-IF.                                                      17100000
202300                                                                  17110000
202400     IF XL011-DEBUG-YES                                           17120000
202500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    17130000
202600                  ' PS-ERROR-SW=' PS-ERROR-SW                     17140000
202700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  17150000
202800                             XL011-RETURN-CODE                    17160000
202900     END-IF.                                                      17170000
203000/                                                                 17180000
203100 7100-INSERT-TPURITM.                                             17190000
203200                                                                  17200000
203300     IF XL011-DEBUG-YES                                           17210000
203400         DISPLAY 'XLKUP009 - 7100-INSERT-TPURITM'                 17220000
203500         ' ITEM = ' PURITM-ITM-NBR                                17230000
203600         ' UNT-QTY = ' PURITM-UNT-QTY                             17240000
203700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  17250000
203800                             XL011-RETURN-CODE                    17260000
203900     END-IF                                                       17270000
204000     MOVE '7100-INSERT-TPURTIM'       TO XL011-ERROR-PARAGRAPH    17280000
204100     IF XL011-DEBUG-YES                                           17290000
204200         DISPLAY 'LINE ='  PURITM-PO-LNE-NBR                      17300000
204300                 ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            17310000
204400                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             17320000
204500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  17330000
204600                             XL011-RETURN-CODE                    17340000
204700     END-IF.                                                      17350000
204800*    SET PS-ERROR-NO                  TO TRUE                     17360000
204900     PERFORM                                                      17370000
205000         WITH TEST AFTER                                          17380000
205100         VARYING PV-RETRY-COUNTER                                 17390000
205200         FROM 1 BY 1                                              17400000
205300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17410000
205400            OR  (SQLCODE = +0))                                   17420000
205500            OR PS-ERROR-YES                                       17430000
205600                                                                  17440000
205700                                                                  17450000
205800     EXEC SQL                                                     17460000
205900         INSERT INTO TPURITM                                      17470000
206000             (                                                    17480000
206100               PO_NBR                                             17490000
206200              ,VER_NBR                                            17500000
206300              ,PO_LNE_NBR                                         17510000
206400              ,VER_STATUS_CDE                                     17520000
206500              ,SKU_SEQ_NBR                                        17530000
206600              ,CL_NBR                                             17540000
206700              ,VEND_STYL_NAME                                     17550000
206800              ,COLOR_DESC                                         17560000
206900              ,SIZE_DESC                                          17570000
207000              ,UM_IND                                             17580000
207100              ,UNT_QTY                                            17590000
207200              ,UNT_RTL_PR_AMT                                     17600000
207300              ,UNT_COST_AMT                                       17610000
207400              ,TOT_VAL_COST_AMT                                   17620000
207500              ,TOT_VAL_RTL_AMT                                    17630000
207600              ,MU_PCT                                             17640000
207700              ,CRE_TMST                                           17650000
207800              ,LAST_UPD_TMST                                      17660000
207900              ,ITM_NBR                                            17670000
208000              ,SKU_DESC                                           17680000
208100              ,COLOR_CDE                                          17690000
208200              ,SIZE_CDE                                           17700000
208300              ,AD_EVNT_DTE                                        17710000
208400              ,STATUS_CDE                                         17720000
208500              ,CRE_BY_UID                                         17730000
208600              ,LAST_UPD_BY_UID                                    17740000
208700              ,GP_RTL_AMT                                         17750000
208800              ,GP_QTY                                             17760000
208900              ,APP_PO_LNE_NBR                                     17770000
209000              ,PIC_ITM_IND                                        17780000
209100              ,PIC_PG_NBR                                         17790000
209200              ,PRD_1ST_COST_AMT                                   17800000
209300              ,STAT_TMST                                          17810000
209400              ,PO_PREPK_ID                                        17820000
209500              ,PREPK_RATO_QTY                                     17830000
209600              ,SHIP_TO_TMP_DC_IND                                 17840000
209700              ,RMS_PO_SKU_NBR                                     17850000
209800              ,CNCLD_UNT_QTY                                      17860000
209900              ,INNR_PK_QTY                                        17870000
210000              ,OUTR_PK_QTY                                        17880000
210100         )                                                        17890000
210200         VALUES                                                   17900000
210300         (                                                        17910000
210400                 :PURITM-PO-NBR                                   17920000
210500             ,   :PURITM-VER-NBR                                  17930000
210600             ,   :PURITM-PO-LNE-NBR                               17940000
210700             ,   :PURITM-VER-STATUS-CDE                           17950000
210800             ,   :PURITM-SKU-SEQ-NBR                              17960000
210900             ,   :PURITM-CL-NBR                                   17970000
211000             ,   :PURITM-VEND-STYL-NAME                           17980000
211100             ,   :PURITM-COLOR-DESC                               17990000
211200             ,   :PURITM-SIZE-DESC                                18000000
211300             ,   :PURITM-UM-IND                                   18010000
211400             ,   :PURITM-UNT-QTY                                  18020000
211500             ,   :PURITM-UNT-RTL-PR-AMT                           18030000
211600             ,   :PURITM-UNT-COST-AMT                             18040000
211700             ,   :PURITM-TOT-VAL-COST-AMT                         18050000
211800             ,   :PURITM-TOT-VAL-RTL-AMT                          18060000
211900             ,   :PURITM-MU-PCT                                   18070000
212000             ,   CURRENT TIMESTAMP                                18080000
212100             ,   CURRENT TIMESTAMP                                18090000
212200             ,   :PURITM-ITM-NBR                                  18100000
212300             ,   :PURITM-SKU-DESC                                 18110000
212400             ,   :PURITM-COLOR-CDE                                18120000
212500             ,   :PURITM-SIZE-CDE                                 18130000
212600             ,   :PURITM-AD-EVNT-DTE                              18140000
212700             ,   :PURITM-STATUS-CDE                               18150000
212800             ,   'XLKUP009'                                       18160000
212900             ,   :PURITM-LAST-UPD-BY-UID                          18170000
213000             ,   :PURITM-GP-RTL-AMT                               18180000
213100             ,   :PURITM-GP-QTY                                   18190000
213200             ,   :PURITM-APP-PO-LNE-NBR                           18200000
213300             ,   :PURITM-PIC-ITM-IND                              18210000
213400             ,   :PURITM-PIC-PG-NBR                               18220000
213500             ,   :PURITM-PRD-1ST-COST-AMT                         18230000
213600             ,   CURRENT TIMESTAMP                                18240000
213700             ,   :PURITM-PO-PREPK-ID                              18250000
213800             ,   :PURITM-PREPK-RATO-QTY                           18260000
213900             ,   :PURITM-SHIP-TO-TMP-DC-IND                       18270000
214000             ,   :PURITM-RMS-PO-SKU-NBR                           18280000
214100             ,   :PURITM-CNCLD-UNT-QTY                            18290000
214200             ,   :PURITM-INNR-PK-QTY                              18300000
214300             ,   :PURITM-OUTR-PK-QTY                              18310000
214400                                                                  18320000
214500             )                                                    18330000
214600        END-EXEC                                                  18340000
214700                                                                  18350000
214800                                                                  18360000
214900     MOVE SQLCODE                     TO XL011-SQLCODE            18370000
215000                                         PV-DISP-SQLCODE          18380000
215100                                                                  18390000
215200     IF XL011-DEBUG-YES                                           18400000
215300         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    18410000
215400                  ' PS-ERROR-SW=' PS-ERROR-SW                     18420000
215500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  18430000
215600                             XL011-RETURN-CODE                    18440000
215700     END-IF                                                       18450000
215800                                                                  18460000
215900     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  18470000
216000     EVALUATE TRUE                                                18480000
216100         WHEN SQLCODE = ZERO                                      18490000
216200             SET PS-DONE-YES          TO TRUE                     18500000
216300                                                                  18510000
216400         WHEN SQLCODE = -904                                      18520000
216500         WHEN SQLCODE = -911                                      18530000
216600         WHEN SQLCODE = -913                                      18540000
216700             DISPLAY '7100-!!!!!!!!!!!'                           18550000
216800                                                                  18560000
216900         WHEN OTHER                                               18570000
217000             SET XL011-SQL-ERROR                                  18580000
217100                 PS-ERROR-YES         TO TRUE                     18590000
217200     END-EVALUATE                                                 18600000
217300     END-PERFORM                                                  18610000
217400                                                                  18620000
217500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18630000
217600         SET XL011-SQL-ERROR                                      18640000
217700                 PS-ERROR-YES         TO TRUE                     18650000
217800     END-IF.                                                      18660000
217900                                                                  18670000
218000     IF XL011-DEBUG-YES                                           18680000
218100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    18690000
218200                  ' PS-ERROR-SW=' PS-ERROR-SW                     18700000
218300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  18710000
218400                             XL011-RETURN-CODE                    18720000
218500     END-IF.                                                      18730000
218600                                                                  18740000
218700/                                                                 18750000
218800 7110-DELETE-TPURITM.                                             18760000
218900     IF XL011-DEBUG-YES                                           18770000
219000         DISPLAY 'XLKUP009 - 7110-DELETE-TPURITM'                 18780000
219100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  18790000
219200                             XL011-RETURN-CODE                    18800000
219300     END-IF                                                       18810000
219400     MOVE '7110-DELETE-TPURITM'       TO XL011-ERROR-PARAGRAPH    18820000
219500                                                                  18830000
219600*    SET PS-ERROR-NO                  TO TRUE                     18840000
219700     PERFORM                                                      18850000
219800         WITH TEST AFTER                                          18860000
219900         VARYING PV-RETRY-COUNTER                                 18870000
220000         FROM 1 BY 1                                              18880000
220100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18890000
220200            OR  (SQLCODE = +100)                                  18900000
220300            OR  (SQLCODE = +0))                                   18910000
220400            OR PS-ERROR-YES                                       18920000
220500                                                                  18930000
220600     EXEC SQL                                                     18940000
220700         DELETE                                                   18950000
220800         FROM                                                     18960000
220900             TPURITM                                              18970000
221000         WHERE                                                    18980000
221100             PO_NBR                   = :PURITM-PO-NBR            18990000
221200         AND ITM_NBR                  = :PURITM-ITM-NBR           19000000
221300     END-EXEC                                                     19010000
221400                                                                  19020000
221500     MOVE SQLCODE                     TO XL011-SQLCODE            19030000
221600                                         PV-DISP-SQLCODE          19040000
221700                                                                  19050000
221800     IF XL011-DEBUG-YES                                           19060000
221900         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    19070000
222000                  ' PS-ERROR-SW=' PS-ERROR-SW                     19080000
222100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  19090000
222200                             XL011-RETURN-CODE                    19100000
222300     END-IF                                                       19110000
222400                                                                  19120000
222500                                                                  19130000
222600     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  19140000
222700     EVALUATE TRUE                                                19150000
222800         WHEN SQLCODE = ZERO                                      19160000
222900         WHEN SQLCODE = +100                                      19170000
223000             SET PS-DONE-YES          TO TRUE                     19180000
223100                                                                  19190000
223200         WHEN SQLCODE = -904                                      19200000
223300         WHEN SQLCODE = -911                                      19210000
223400         WHEN SQLCODE = -913                                      19220000
223500             DISPLAY '7110-!!!!!!!!!!!'                           19230000
223600                                                                  19240000
223700       WHEN OTHER                                                 19250000
223800             SET XL011-SQL-ERROR                                  19260000
223900                 PS-ERROR-YES         TO TRUE                     19270000
224000     END-EVALUATE                                                 19280000
224100                                                                  19290000
224200     END-PERFORM.                                                 19300000
224300                                                                  19310000
224400                                                                  19320000
224500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19330000
224600         SET XL011-SQL-ERROR                                      19340000
224700                 PS-ERROR-YES         TO TRUE                     19350000
224800     END-IF.                                                      19360000
224900                                                                  19370000
225000     IF XL011-DEBUG-YES                                           19380000
225100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    19390000
225200                  ' PS-ERROR-SW=' PS-ERROR-SW                     19400000
225300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  19410000
225400                             XL011-RETURN-CODE                    19420000
225500     END-IF.                                                      19430000
225600                                                                  19440000
225700                                                                  19450000
225800 7110P-DELETE-TPURITM-BY-PREPK.                                   19460000
225900     IF XL011-DEBUG-YES                                           19470000
226000         DISPLAY 'XLKUP009 - 7110P-DELETE-TPURITM-BY-PREPK'       19480000
226100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  19490000
226200                             XL011-RETURN-CODE                    19500000
226300     END-IF                                                       19510000
226400     MOVE '7110P-DELETE-TPURITM-BY-PREPK'                         19520000
226500                                      TO XL011-ERROR-PARAGRAPH    19530000
226600                                                                  19540000
226700*    SET PS-ERROR-NO                  TO TRUE                     19550000
226800     PERFORM                                                      19560000
226900         WITH TEST AFTER                                          19570000
227000         VARYING PV-RETRY-COUNTER                                 19580000
227100         FROM 1 BY 1                                              19590000
227200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19600000
227300            OR  (SQLCODE = +100)                                  19610000
227400            OR  (SQLCODE = +0))                                   19620000
227500            OR PS-ERROR-YES                                       19630000
227600                                                                  19640000
227700     EXEC SQL                                                     19650000
227800         DELETE                                                   19660000
227900         FROM                                                     19670000
228000             TPURITM                                              19680000
228100         WHERE                                                    19690000
228200             PO_NBR                   = :PURITM-PO-NBR            19700000
228300         AND VER_NBR                  = :PURITM-VER-NBR           19710000
228400         AND PO_LNE_NBR               = :PURITM-PO-LNE-NBR        19720000
228500     END-EXEC                                                     19730000
228600                                                                  19740000
228700     MOVE SQLCODE                     TO XL011-SQLCODE            19750000
228800                                         PV-DISP-SQLCODE          19760000
228900                                                                  19770000
229000     IF XL011-DEBUG-YES                                           19780000
229100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    19790000
229200                  ' PS-ERROR-SW=' PS-ERROR-SW                     19800000
229300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  19810000
229400                             XL011-RETURN-CODE                    19820000
229500     END-IF                                                       19830000
229600                                                                  19840000
229700     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  19850000
229800     EVALUATE TRUE                                                19860000
229900         WHEN SQLCODE = ZERO                                      19870000
230000         WHEN SQLCODE = +100                                      19880000
230100             SET PS-DONE-YES          TO TRUE                     19890000
230200                                                                  19900000
230300         WHEN SQLCODE = -904                                      19910000
230400         WHEN SQLCODE = -911                                      19920000
230500         WHEN SQLCODE = -913                                      19930000
230600             DISPLAY '7110P-!!!!!!!!!!!'                          19940000
230700                                                                  19950000
230800       WHEN OTHER                                                 19960000
230900             SET XL011-SQL-ERROR                                  19970000
231000                 PS-ERROR-YES         TO TRUE                     19980000
231100     END-EVALUATE                                                 19990000
231200                                                                  20000000
231300                                                                  20010000
231400     END-PERFORM.                                                 20020000
231500                                                                  20030000
231600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20040000
231700         SET XL011-SQL-ERROR                                      20050000
231800                 PS-ERROR-YES         TO TRUE                     20060000
231900     END-IF.                                                      20070000
232000                                                                  20080000
232100     IF XL011-DEBUG-YES                                           20090000
232200         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    20100000
232300                  ' PS-ERROR-SW=' PS-ERROR-SW                     20110000
232400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  20120000
232500                             XL011-RETURN-CODE                    20130000
232600     END-IF.                                                      20140000
232700/                                                                 20150000
232800 7130-UPDATE-TPURITM-COSTS.                                       20160000
232900     IF XL011-DEBUG-YES                                           20170000
233000         DISPLAY 'XLKUP009 - 7130-UPDATE-TPURITM-COSTS'           20180000
233100         DISPLAY 'LINE ='  PURITM-PO-LNE-NBR                      20190000
233200                 ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            20200000
233300                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             20210000
233400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  20220000
233500                             XL011-RETURN-CODE                    20230000
233600     END-IF.                                                      20240000
233700     MOVE '7130-UPDATE-TPURITM-COSTS'                             20250000
233800                                      TO XL011-ERROR-PARAGRAPH    20260000
233900                                                                  20270000
234000*    SET PS-ERROR-NO                  TO TRUE                     20280000
234100                                                                  20290000
234200     PERFORM                                                      20300000
234300         WITH TEST AFTER                                          20310000
234400         VARYING PV-RETRY-COUNTER                                 20320000
234500         FROM 1 BY 1                                              20330000
234600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20340000
234700            OR  (SQLCODE = +100)                                  20350000
234800            OR  (SQLCODE = +0))                                   20360000
234900            OR PS-ERROR-YES                                       20370000
235000                                                                  20380000
235100     EXEC SQL                                                     20390000
235200         UPDATE                                                   20400000
235300             TPURITM                                              20410000
235400         SET                                                      20420000
235500             UNT_COST_AMT             = :PURITM-UNT-COST-AMT      20430000
235600         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  20440000
235700         ,   MU_PCT                   = :PURITM-MU-PCT            20450000
235800         WHERE                                                    20460000
235900             PO_NBR                   = :PURITM-PO-NBR            20470000
236000         AND ITM_NBR                  = :PURITM-ITM-NBR           20480000
236100         AND VER_STATUS_CDE           = 'A'                       20490000
236200     END-EXEC                                                     20500000
236300                                                                  20510000
236400     MOVE SQLCODE                     TO XL011-SQLCODE            20520000
236500                                         PV-DISP-SQLCODE          20530000
236600                                                                  20540000
236700                                                                  20550000
236800     IF XL011-DEBUG-YES                                           20560000
236900         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    20570000
237000                  ' PS-ERROR-SW=' PS-ERROR-SW                     20580000
237100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  20590000
237200                             XL011-RETURN-CODE                    20600000
237300     END-IF                                                       20610000
237400                                                                  20620000
237500     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  20630000
237600     EVALUATE TRUE                                                20640000
237700         WHEN SQLCODE = ZERO                                      20650000
237800             SET PS-DONE-YES          TO TRUE                     20660000
237900         WHEN SQLCODE = +100                                      20670000
238000             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     20680000
238100                     DELIMITED BY SIZE                            20690000
238200                                      INTO XL011-ERROR-TEXT       20700000
238300             SET XL011-SYSTEM-ERROR   TO TRUE                     20710000
238400                                                                  20720000
238500         WHEN SQLCODE = -904                                      20730000
238600         WHEN SQLCODE = -911                                      20740000
238700         WHEN SQLCODE = -913                                      20750000
238800             DISPLAY '7130-!!!!!!!!!!!'                           20760000
238900                                                                  20770000
239000         WHEN OTHER                                               20780000
239100             SET XL011-SQL-ERROR                                  20790000
239200                 PS-ERROR-YES         TO TRUE                     20800000
239300         END-EVALUATE                                             20810000
239400     END-PERFORM.                                                 20820000
239500                                                                  20830000
239600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20840000
239700         SET XL011-SQL-ERROR                                      20850000
239800                 PS-ERROR-YES         TO TRUE                     20860000
239900     END-IF.                                                      20870000
240000     IF XL011-DEBUG-YES                                           20880000
240100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    20890000
240200                  ' PS-ERROR-SW=' PS-ERROR-SW                     20900000
240300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  20910000
240400                             XL011-RETURN-CODE                    20920000
240500     END-IF.                                                      20930000
240600                                                                  20940000
240700/                                                                 20950000
240800 7130P-UPD-TPURITM-CST-RTL.                                       20960000
240900     IF XL011-DEBUG-YES                                           20970000
241000         DISPLAY 'XLKUP009 - 7130P-UPD-TPURITM-CST-RTL'           20980000
241100         DISPLAY 'PURITM-PO-NBR= ' PURITM-PO-NBR                  20990000
241200                 'PURITM-ITM-NBR= ' PURITM-ITM-NBR                21000000
241300                 'PURITM-PO-PREPK-ID= ' PURITM-PO-PREPK-ID        21010000
241400         DISPLAY ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            21020000
241500                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             21030000
241600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  21040000
241700                             XL011-RETURN-CODE                    21050000
241800     END-IF.                                                      21060000
241900     MOVE '7130P-UPD-TPURITM-CST-RTL'                             21070000
242000                                      TO XL011-ERROR-PARAGRAPH    21080000
242100                                                                  21090000
242200*    SET PS-ERROR-NO                  TO TRUE                     21100000
242300     PERFORM                                                      21110000
242400         WITH TEST AFTER                                          21120000
242500         VARYING PV-RETRY-COUNTER                                 21130000
242600         FROM 1 BY 1                                              21140000
242700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21150000
242800            OR  (SQLCODE = +100)                                  21160000
242900            OR  (SQLCODE = +0))                                   21170000
243000            OR PS-ERROR-YES                                       21180000
243100                                                                  21190000
243200     EXEC SQL                                                     21200000
243300         UPDATE                                                   21210000
243400             TPURITM                                              21220000
243500         SET                                                      21230000
243600             UNT_COST_AMT             = :PURITM-UNT-COST-AMT      21240000
243700         ,   PRD_1ST_COST_AMT         = :PURITM-PRD-1ST-COST-AMT  21250000
243800         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  21260000
243900         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   21270000
244000         ,   MU_PCT                   = :PURITM-MU-PCT            21280000
244100         ,   UNT_RTL_PR_AMT           = :PURITM-UNT-RTL-PR-AMT    21290000
244200         ,   GP_RTL_AMT               = :PURITM-GP-RTL-AMT        21300000
244300         ,   GP_QTY                   = :PURITM-GP-QTY            21310000
244400         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         21320000
244500         ,   LAST_UPD_BY_UID          = 'XLKUP009'                21330000
244600         WHERE                                                    21340000
244700             PO_NBR                   = :PURITM-PO-NBR            21350000
244800         AND ITM_NBR                  = :PURITM-ITM-NBR           21360000
244900         AND PO_PREPK_ID              = :PURITM-PO-PREPK-ID       21370000
245000         AND VER_STATUS_CDE           = 'A'                       21380000
245100     END-EXEC                                                     21390000
245200                                                                  21400000
245300     MOVE SQLCODE                     TO XL011-SQLCODE            21410000
245400                                         PV-DISP-SQLCODE          21420000
245500     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  21430000
245600                                                                  21440000
245700     MOVE SQLCODE                     TO XL011-SQLCODE            21450000
245800                                         PV-DISP-SQLCODE          21460000
245900                                                                  21470000
246000                                                                  21480000
246100     IF XL011-DEBUG-YES                                           21490000
246200         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    21500000
246300                  ' PS-ERROR-SW=' PS-ERROR-SW                     21510000
246400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  21520000
246500                             XL011-RETURN-CODE                    21530000
246600     END-IF                                                       21540000
246700                                                                  21550000
246800     EVALUATE TRUE                                                21560000
246900         WHEN SQLCODE = ZERO                                      21570000
247000             SET PS-DONE-YES          TO TRUE                     21580000
247100         WHEN SQLCODE = +100                                      21590000
247200             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     21600000
247300                     DELIMITED BY SIZE                            21610000
247400                                      INTO XL011-ERROR-TEXT       21620000
247500             SET XL011-SYSTEM-ERROR   TO TRUE                     21630000
247600                                                                  21640000
247700         WHEN SQLCODE = -904                                      21650000
247800         WHEN SQLCODE = -911                                      21660000
247900         WHEN SQLCODE = -913                                      21670000
248000             DISPLAY '7130P-!!!!!!!!!!!'                          21680000
248100                                                                  21690000
248200       WHEN OTHER                                                 21700000
248300             SET XL011-SQL-ERROR                                  21710000
248400                 PS-ERROR-YES         TO TRUE                     21720000
248500       END-EVALUATE                                               21730000
248600                                                                  21740000
248700     END-PERFORM.                                                 21750000
248800                                                                  21760000
248900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21770000
249000         SET XL011-SQL-ERROR                                      21780000
249100                 PS-ERROR-YES         TO TRUE                     21790000
249200     END-IF.                                                      21800000
249300                                                                  21810000
249400     IF XL011-DEBUG-YES                                           21820000
249500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    21830000
249600                  ' PS-ERROR-SW=' PS-ERROR-SW                     21840000
249700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  21850000
249800                             XL011-RETURN-CODE                    21860000
249900     END-IF.                                                      21870000
250000/                                                                 21880000
250100 7140-UPDATE-TPURITM-ATTR.                                        21890000
250200     IF XL011-DEBUG-YES                                           21900000
250300         DISPLAY 'XLKUP009 - 7140-UPDATE-TPURITM-ATTR'            21910000
250400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  21920000
250500                             XL011-RETURN-CODE                    21930000
250600     END-IF                                                       21940000
250700     MOVE '7140-UPDATE-TPURITM-ATTR'  TO XL011-ERROR-PARAGRAPH    21950000
250800                                                                  21960000
250900*    SET PS-ERROR-NO                  TO TRUE                     21970000
251000                                                                  21980000
251100     PERFORM                                                      21990000
251200         WITH TEST AFTER                                          22000000
251300         VARYING PV-RETRY-COUNTER                                 22010000
251400         FROM 1 BY 1                                              22020000
251500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22030000
251600            OR  (SQLCODE = +100)                                  22040000
251700            OR  (SQLCODE = +0))                                   22050000
251800            OR PS-ERROR-YES                                       22060000
251900                                                                  22070000
252000     EXEC SQL                                                     22080000
252100         UPDATE                                                   22090000
252200             TPURITM                                              22100000
252300         SET                                                      22110000
252400             AD_EVNT_DTE              = :PURITM-AD-EVNT-DTE       22120000
252500         ,   PIC_ITM_IND              = :PURITM-PIC-ITM-IND       22130000
252600         ,   PRD_1ST_COST_AMT         = :PURITM-PRD-1ST-COST-AMT  22140000
252700         ,   UNT_RTL_PR_AMT           = :PURITM-UNT-RTL-PR-AMT    22150000
252800         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   22160000
252900         ,   MU_PCT                   = :PURITM-MU-PCT            22170000
253000         ,   GP_RTL_AMT               = :PURITM-GP-RTL-AMT        22180000
253100         ,   GP_QTY                   = :PURITM-GP-QTY            22190000
253200         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         22200000
253300         ,   LAST_UPD_BY_UID          = 'XLKUP009'                22210000
253400         ,   INNR_PK_QTY              = :PURITM-INNR-PK-QTY       22220000
253500         ,   OUTR_PK_QTY              = :PURITM-OUTR-PK-QTY       22230000
253600         WHERE                                                    22240000
253700             PO_NBR                   = :PURITM-PO-NBR            22250000
253800         AND ITM_NBR                  = :PURITM-ITM-NBR           22260000
253900         AND VER_STATUS_CDE           = 'A'                       22270000
254000         AND PO_PREPK_ID              = 0                         22280000
254100     END-EXEC                                                     22290000
254200                                                                  22300000
254300     MOVE SQLCODE                     TO XL011-SQLCODE            22310000
254400                                         PV-DISP-SQLCODE          22320000
254500                                                                  22330000
254600     IF XL011-DEBUG-YES                                           22340000
254700         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    22350000
254800                  ' PS-ERROR-SW=' PS-ERROR-SW                     22360000
254900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  22370000
255000                             XL011-RETURN-CODE                    22380000
255100     END-IF                                                       22390000
255200                                                                  22400000
255300     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  22410000
255400     EVALUATE TRUE                                                22420000
255500         WHEN SQLCODE = ZERO                                      22430000
255600             SET PS-DONE-YES          TO TRUE                     22440000
255700         WHEN SQLCODE = +100                                      22450000
255800             PERFORM 2600-SELECT-TPURCHS                          22460000
255900*            STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     22470000
256000*                    DELIMITED BY SIZE                            22480000
256100*                                     INTO XL011-ERROR-TEXT       22490000
256200*            SET XL011-SYSTEM-ERROR   TO TRUE                     22500000
256300                                                                  22510000
256400         WHEN SQLCODE = -904                                      22520000
256500         WHEN SQLCODE = -911                                      22530000
256600         WHEN SQLCODE = -913                                      22540000
256700             DISPLAY '7140-!!!!!!!!!!!'                           22550000
256800                                                                  22560000
256900       WHEN OTHER                                                 22570000
257000             SET XL011-SQL-ERROR                                  22580000
257100                 PS-ERROR-YES         TO TRUE                     22590000
257200     END-EVALUATE                                                 22600000
257300                                                                  22610000
257400     END-PERFORM.                                                 22620000
257500                                                                  22630000
257600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22640000
257700         SET XL011-SQL-ERROR                                      22650000
257800                 PS-ERROR-YES         TO TRUE                     22660000
257900     END-IF.                                                      22670000
258000                                                                  22680000
258100     IF XL011-DEBUG-YES                                           22690000
258200         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    22700000
258300                  ' PS-ERROR-SW=' PS-ERROR-SW                     22710000
258400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  22720000
258500                             XL011-RETURN-CODE                    22730000
258600     END-IF.                                                      22740000
258700                                                                  22750000
258800 7140P-UPDATE-TPURITM-ATTR.                                       22760000
258900     IF XL011-DEBUG-YES                                           22770000
259000         DISPLAY 'XLKUP009 - 7140P-UPDATE-TPURITM-ATTR'           22780000
259100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  22790000
259200                             XL011-RETURN-CODE                    22800000
259300     END-IF                                                       22810000
259400     MOVE '7140P-UPDATE-TPURITM-ATTR' TO XL011-ERROR-PARAGRAPH    22820000
259500                                                                  22830000
259600*    SET PS-ERROR-NO                  TO TRUE                     22840000
259700                                                                  22850000
259800     PERFORM                                                      22860000
259900         WITH TEST AFTER                                          22870000
260000         VARYING PV-RETRY-COUNTER                                 22880000
260100         FROM 1 BY 1                                              22890000
260200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22900000
260300            OR  (SQLCODE = +100)                                  22910000
260400            OR  (SQLCODE = +0))                                   22920000
260500            OR PS-ERROR-YES                                       22930000
260600                                                                  22940000
260700     EXEC SQL                                                     22950000
260800         UPDATE                                                   22960000
260900             TPURITM                                              22970000
261000         SET                                                      22980000
261100             AD_EVNT_DTE              = :PURITM-AD-EVNT-DTE       22990000
261200         ,   PIC_ITM_IND              = :PURITM-PIC-ITM-IND       23000000
261300* 7/28   ,   PRD_1ST_COST_AMT         = :PURITM-PRD-1ST-COST-AMT  23010000
261400         ,   UNT_RTL_PR_AMT           = :PURITM-UNT-RTL-PR-AMT    23020000
261500         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   23030000
261600         ,   MU_PCT                   = :PURITM-MU-PCT            23040000
261700         ,   GP_RTL_AMT               = :PURITM-GP-RTL-AMT        23050000
261800         ,   GP_QTY                   = :PURITM-GP-QTY            23060000
261900         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         23070000
262000         ,   LAST_UPD_BY_UID          = 'XLKUP009'                23080000
262100         WHERE                                                    23090000
262200             PO_NBR                   = :PURITM-PO-NBR            23100000
262300         AND VER_NBR                  = :PURITM-VER-NBR           23110000
262400         AND PO_LNE_NBR               = :PURITM-PO-LNE-NBR        23120000
262500         AND VER_STATUS_CDE           = 'A'                       23130000
262600     END-EXEC                                                     23140000
262700                                                                  23150000
262800     MOVE SQLCODE                     TO XL011-SQLCODE            23160000
262900                                         PV-DISP-SQLCODE          23170000
263000                                                                  23180000
263100     IF XL011-DEBUG-YES                                           23190000
263200         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    23200000
263300                  ' PS-ERROR-SW=' PS-ERROR-SW                     23210000
263400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  23220000
263500                             XL011-RETURN-CODE                    23230000
263600     END-IF                                                       23240000
263700                                                                  23250000
263800     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  23260000
263900                                                                  23270000
264000     EVALUATE TRUE                                                23280000
264100         WHEN SQLCODE = ZERO                                      23290000
264200             SET PS-DONE-YES          TO TRUE                     23300000
264300         WHEN SQLCODE = +100                                      23310000
264400             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     23320000
264500                     DELIMITED BY SIZE                            23330000
264600                                      INTO XL011-ERROR-TEXT       23340000
264700             SET XL011-SYSTEM-ERROR   TO TRUE                     23350000
264800                                                                  23360000
264900         WHEN SQLCODE = -904                                      23370000
265000         WHEN SQLCODE = -911                                      23380000
265100         WHEN SQLCODE = -913                                      23390000
265200             DISPLAY '7140P-!!!!!!!!!!!'                          23400000
265300                                                                  23410000
265400       WHEN OTHER                                                 23420000
265500             SET XL011-SQL-ERROR                                  23430000
265600                 PS-ERROR-YES         TO TRUE                     23440000
265700     END-EVALUATE                                                 23450000
265800                                                                  23460000
265900     END-PERFORM.                                                 23470000
266000                                                                  23480000
266100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23490000
266200         SET XL011-SQL-ERROR                                      23500000
266300                 PS-ERROR-YES         TO TRUE                     23510000
266400     END-IF.                                                      23520000
266500                                                                  23530000
266600     IF XL011-DEBUG-YES                                           23540000
266700         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    23550000
266800                  ' PS-ERROR-SW=' PS-ERROR-SW                     23560000
266900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  23570000
267000                             XL011-RETURN-CODE                    23580000
267100     END-IF.                                                      23590000
267200/                                                                 23600000
267300** GB 6/13/14  ADDED PO_PREPK_ID = 0 TO SELECT TO NOT RE-ACTIVATE 23610000
267400** PREVIOUSLY CANCELLED ROWS THAT WERE PART OF A PREPK            23620000
267500** SITUTAION WHEN A PREPK PO CHANGED TO A BULK PO                 23630000
267600 7150-UPDATE-TPURITM-COSTS.                                       23640000
267700                                                                  23650000
267800     IF XL011-DEBUG-YES                                           23660000
267900         DISPLAY 'XLKUP009 - 7150-UPDATE-TPURITM-COSTS'           23670000
268000            ' ITEM = ' PURITM-ITM-NBR                             23680000
268100            ' UNT-QTY = ' PURITM-UNT-QTY                          23690000
268200         DISPLAY 'LINE ='  PURITM-PO-LNE-NBR                      23700000
268300                 ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            23710000
268400                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             23720000
268500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  23730000
268600                             XL011-RETURN-CODE                    23740000
268700     END-IF.                                                      23750000
268800     MOVE '7150-UPDATE-TPURITM-COSTS' TO XL011-ERROR-PARAGRAPH    23760000
268900                                                                  23770000
269000*    SET PS-ERROR-NO                  TO TRUE                     23780000
269100     PERFORM                                                      23790000
269200         WITH TEST AFTER                                          23800000
269300         VARYING PV-RETRY-COUNTER                                 23810000
269400         FROM 1 BY 1                                              23820000
269500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23830000
269600            OR  (SQLCODE = +100)                                  23840000
269700            OR  (SQLCODE = +0))                                   23850000
269800            OR PS-ERROR-YES                                       23860000
269900                                                                  23870000
270000                                                                  23880000
270100     IF PURITM-STATUS-CDE = PV-CURRENT-STATUS-CDE                 23890000
270200                                                                  23900000
270300     EXEC SQL                                                     23910000
270400         UPDATE                                                   23920000
270500             TPURITM                                              23930000
270600         SET                                                      23940000
270700             UNT_QTY                  = :PURITM-UNT-QTY           23950000
270800         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  23960000
270900         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   23970000
271000         ,   CNCLD_UNT_QTY            = :PURITM-CNCLD-UNT-QTY     23980000
271100         ,   MU_PCT                   = :PURITM-MU-PCT            23990000
271200         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         24000000
271300         ,   LAST_UPD_BY_UID          = 'XLKUP009'                24010000
271400         WHERE                                                    24020000
271500             PO_NBR                   = :PURITM-PO-NBR            24030000
271600         AND ITM_NBR                  = :PURITM-ITM-NBR           24040000
271700         AND VER_STATUS_CDE           = 'A'                       24050000
271800         AND PO_PREPK_ID              =  0                        24060000
271900     END-EXEC                                                     24070000
272000                                                                  24080000
272010     ELSE                                                         24090000
272020                                                                  24100000
272030     EXEC SQL                                                     24110000
272040         UPDATE                                                   24120000
272050             TPURITM                                              24130000
272060         SET                                                      24140000
272070             UNT_QTY                  = :PURITM-UNT-QTY           24150000
272080         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  24160000
272090         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   24170000
272100         ,   CNCLD_UNT_QTY            = :PURITM-CNCLD-UNT-QTY     24180000
272200         ,   STATUS_CDE               = :PURITM-STATUS-CDE        24190000
272300         ,   STAT_TMST                = CURRENT TIMESTAMP         24200000
272400         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         24210000
272500         ,   LAST_UPD_BY_UID          = 'XLKUP009'                24220000
272600         WHERE                                                    24230000
272700             PO_NBR                   = :PURITM-PO-NBR            24240000
272800         AND ITM_NBR                  = :PURITM-ITM-NBR           24250000
272900         AND VER_STATUS_CDE           = 'A'                       24260000
273000         AND PO_PREPK_ID              =  0                        24270000
273100     END-EXEC                                                     24280000
273200                                                                  24290000
273300     END-IF                                                       24300000
273400                                                                  24310000
273500     MOVE SQLCODE                     TO XL011-SQLCODE            24320000
273600                                         PV-DISP-SQLCODE          24330000
273700     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  24340000
273800                                                                  24350000
273900                                                                  24360000
274000     IF XL011-DEBUG-YES                                           24370000
274100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    24380000
274200                  ' PS-ERROR-SW=' PS-ERROR-SW                     24390000
274300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  24400000
274400                             XL011-RETURN-CODE                    24410000
274500     END-IF                                                       24420000
274600                                                                  24430000
274700     EVALUATE TRUE                                                24440000
274800         WHEN SQLCODE = ZERO                                      24450000
274900             SET PS-DONE-YES          TO TRUE                     24460000
275000         WHEN SQLCODE = +100                                      24470000
275100             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     24480000
275200                     DELIMITED BY SIZE                            24490000
275300                                      INTO XL011-ERROR-TEXT       24500000
275400             SET XL011-SYSTEM-ERROR   TO TRUE                     24510000
275500                                                                  24520000
275600         WHEN SQLCODE = -904                                      24530000
275700         WHEN SQLCODE = -911                                      24540000
275800         WHEN SQLCODE = -913                                      24550000
275900             DISPLAY '7150-!!!!!!!!!!!'                           24560000
276000                                                                  24570000
276100       WHEN OTHER                                                 24580000
276200             SET XL011-SQL-ERROR                                  24590000
276300                 PS-ERROR-YES         TO TRUE                     24600000
276400     END-EVALUATE                                                 24610000
276500                                                                  24620000
276600     END-PERFORM.                                                 24630000
276700                                                                  24640000
276800                                                                  24650000
276900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24660000
277000         SET XL011-SQL-ERROR                                      24670000
277100                 PS-ERROR-YES         TO TRUE                     24680000
277200     END-IF.                                                      24690000
277300                                                                  24700000
277400     IF XL011-DEBUG-YES                                           24710000
277500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    24720000
277600                  ' PS-ERROR-SW=' PS-ERROR-SW                     24730000
277700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  24740000
277800                             XL011-RETURN-CODE                    24750000
277900     END-IF.                                                      24760000
278000                                                                  24770000
278100                                                                  24780000
278200 7150P-UPDATE-TPURITM-COSTS.                                      24790000
278300                                                                  24800000
278400     MOVE '7150P-UPDATE-TPURITM-COSTS' TO XL011-ERROR-PARAGRAPH   24810000
278500     IF XL011-DEBUG-YES                                           24820000
278600         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              24830000
278700            ' LINE = ' PURITM-PO-LNE-NBR                          24840000
278800            ' UNT-QTY = ' PURITM-UNT-QTY                          24850000
278900         DISPLAY 'XLKUP009 - TOT-COST= ' PURITM-TOT-VAL-COST-AMT  24860000
279000                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             24870000
279100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  24880000
279200                             XL011-RETURN-CODE                    24890000
279300     END-IF.                                                      24900000
279400                                                                  24910000
279500     IF PURITM-STATUS-CDE = PV-CURRENT-STATUS-CDE                 24920000
279600         PERFORM 7150P1-UPDATE-TPURITM                            24930000
279700     ELSE                                                         24940000
279800         PERFORM 7150P2-UPDATE-TPURITM                            24950000
279900     END-IF.                                                      24960000
280000                                                                  24970000
280100 7150P1-UPDATE-TPURITM.                                           24980000
280200                                                                  24990000
280300     MOVE '7150P1-UPDATE-TPURITM' TO XL011-ERROR-PARAGRAPH        25000000
280400     IF XL011-DEBUG-YES                                           25010000
280500         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              25020000
280600            ' LINE = ' PURITM-PO-LNE-NBR                          25030000
280700            ' UNT-QTY = ' PURITM-UNT-QTY                          25040000
280800         DISPLAY 'XLKUP009 - TOT-COST= ' PURITM-TOT-VAL-COST-AMT  25050000
280900                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             25060000
281000         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  25070000
281100                             XL011-RETURN-CODE                    25080000
281200     END-IF.                                                      25090000
281300                                                                  25100000
281400*    SET PS-ERROR-NO                  TO TRUE                     25110000
281500                                                                  25120000
281600     PERFORM                                                      25130000
281700         WITH TEST AFTER                                          25140000
281800         VARYING PV-RETRY-COUNTER                                 25150000
281900         FROM 1 BY 1                                              25160000
282000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25170000
282100            OR  (SQLCODE = +100)                                  25180000
282200            OR  (SQLCODE = +0))                                   25190000
282300            OR PS-ERROR-YES                                       25200000
282400                                                                  25210000
282500     EXEC SQL                                                     25220000
282600         UPDATE                                                   25230000
282700             TPURITM                                              25240000
282800         SET                                                      25250000
282900             UNT_QTY                  = :PURITM-UNT-QTY           25260000
283000         ,   CNCLD_UNT_QTY            = :PURITM-CNCLD-UNT-QTY     25270000
283100         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  25280000
283200         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   25290000
283300         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         25300000
283400         ,   LAST_UPD_BY_UID          = 'XLKUP009'                25310000
283500         WHERE                                                    25320000
283600             PO_NBR                   = :PURITM-PO-NBR            25330000
283700         AND VER_NBR                  = :PURITM-VER-NBR           25340000
283800         AND PO_LNE_NBR               = :PURITM-PO-LNE-NBR        25350000
283900         AND VER_STATUS_CDE           = 'A'                       25360000
284000     END-EXEC                                                     25370000
284100                                                                  25380000
284200     MOVE SQLCODE                     TO XL011-SQLCODE            25390000
284300                                         PV-DISP-SQLCODE          25400000
284400                                                                  25410000
284500                                                                  25420000
284600     IF XL011-DEBUG-YES                                           25430000
284700         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    25440000
284800                  ' PS-ERROR-SW=' PS-ERROR-SW                     25450000
284900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  25460000
285000                             XL011-RETURN-CODE                    25470000
285100     END-IF                                                       25480000
285200                                                                  25490000
285300     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  25500000
285400     EVALUATE TRUE                                                25510000
285500         WHEN SQLCODE = ZERO                                      25520000
285600             SET PS-DONE-YES          TO TRUE                     25530000
285700         WHEN SQLCODE = +100                                      25540000
285800             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     25550000
285900                     DELIMITED BY SIZE                            25560000
286000                                      INTO XL011-ERROR-TEXT       25570000
286100             SET XL011-SYSTEM-ERROR   TO TRUE                     25580000
286200                                                                  25590000
286300         WHEN SQLCODE = -904                                      25600000
286400         WHEN SQLCODE = -911                                      25610000
286500         WHEN SQLCODE = -913                                      25620000
286600             DISPLAY '7150P1-!!!!!!!!!!!'                         25630000
286700                                                                  25640000
286800       WHEN OTHER                                                 25650000
286900             SET XL011-SQL-ERROR                                  25660000
287000                 PS-ERROR-YES         TO TRUE                     25670000
287100     END-EVALUATE                                                 25680000
287200                                                                  25690000
287300     END-PERFORM.                                                 25700000
287400                                                                  25710000
287500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25720000
287600         SET XL011-SQL-ERROR                                      25730000
287700             PS-ERROR-YES             TO TRUE                     25740000
287800     END-IF.                                                      25750000
287900                                                                  25760000
288000     IF XL011-DEBUG-YES                                           25770000
288100         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    25780000
288200                  ' PS-ERROR-SW=' PS-ERROR-SW                     25790000
288300         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  25800000
288400                             XL011-RETURN-CODE                    25810000
288500     END-IF.                                                      25820000
288600                                                                  25830000
288700 7150P2-UPDATE-TPURITM.                                           25840000
288800                                                                  25850000
288900     MOVE '7150P2-UPDATE-TPURITM' TO XL011-ERROR-PARAGRAPH        25860000
289000     IF XL011-DEBUG-YES                                           25870000
289100         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              25880000
289200            ' LINE = ' PURITM-PO-LNE-NBR                          25890000
289300            ' UNT-QTY = ' PURITM-UNT-QTY                          25900000
289400         DISPLAY 'XLKUP009 - TOT-COST= ' PURITM-TOT-VAL-COST-AMT  25910000
289500                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             25920000
289600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  25930000
289700                             XL011-RETURN-CODE                    25940000
289800     END-IF.                                                      25950000
289900                                                                  25960000
290000*    SET PS-ERROR-NO                  TO TRUE                     25970000
290100     PERFORM                                                      25980000
290200         WITH TEST AFTER                                          25990000
290300         VARYING PV-RETRY-COUNTER                                 26000000
290400         FROM 1 BY 1                                              26010000
290500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26020000
290600            OR  (SQLCODE = +100)                                  26030000
290700            OR  (SQLCODE = +0))                                   26040000
290800            OR PS-ERROR-YES                                       26050000
290900                                                                  26060000
291000     EXEC SQL                                                     26070000
291100         UPDATE                                                   26080000
291200             TPURITM                                              26090000
291300         SET                                                      26100000
291400             UNT_QTY                  = :PURITM-UNT-QTY           26110000
291500         ,   TOT_VAL_COST_AMT         = :PURITM-TOT-VAL-COST-AMT  26120000
291600         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   26130000
291700         ,   CNCLD_UNT_QTY            = :PURITM-CNCLD-UNT-QTY     26140000
291800         ,   STATUS_CDE               = :PURITM-STATUS-CDE        26150000
291900         ,   STAT_TMST                = CURRENT TIMESTAMP         26160000
292000         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         26170000
292100         ,   LAST_UPD_BY_UID          = 'XLKUP009'                26180000
292200         WHERE                                                    26190000
292300             PO_NBR                   = :PURITM-PO-NBR            26200000
292400         AND VER_NBR                  = :PURITM-VER-NBR           26210000
292500         AND PO_LNE_NBR               = :PURITM-PO-LNE-NBR        26220000
292600         AND VER_STATUS_CDE           = 'A'                       26230000
292700     END-EXEC                                                     26240000
292800                                                                  26250000
292900     MOVE SQLCODE                     TO XL011-SQLCODE            26260000
293000                                         PV-DISP-SQLCODE          26270000
293100                                                                  26280000
293200     IF XL011-DEBUG-YES                                           26290000
293300         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    26300000
293400                  ' PS-ERROR-SW=' PS-ERROR-SW                     26310000
293500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  26320000
293600                             XL011-RETURN-CODE                    26330000
293700     END-IF                                                       26340000
293800                                                                  26350000
293900     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  26360000
294000     EVALUATE TRUE                                                26370000
294100         WHEN SQLCODE = ZERO                                      26380000
294200             SET PS-DONE-YES          TO TRUE                     26390000
294300         WHEN SQLCODE = +100                                      26400000
294400             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     26410000
294500                     DELIMITED BY SIZE                            26420000
294600                                      INTO XL011-ERROR-TEXT       26430000
294700             SET XL011-SYSTEM-ERROR   TO TRUE                     26440000
294800                                                                  26450000
294900         WHEN SQLCODE = -904                                      26460000
295000         WHEN SQLCODE = -911                                      26470000
295100         WHEN SQLCODE = -913                                      26480000
295200             DISPLAY '7150P2-!!!!!!!!!!!'                         26490000
295300                                                                  26500000
295400       WHEN OTHER                                                 26510000
295500             SET XL011-SQL-ERROR                                  26520000
295600                 PS-ERROR-YES         TO TRUE                     26530000
295700     END-EVALUATE                                                 26540000
295800                                                                  26550000
295900     END-PERFORM.                                                 26560000
296000                                                                  26570000
296100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26580000
296200         SET XL011-SQL-ERROR                                      26590000
296300             PS-ERROR-YES             TO TRUE                     26600000
296400     END-IF.                                                      26610000
296500                                                                  26620000
296600     IF XL011-DEBUG-YES                                           26630000
296700         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    26640000
296800                  ' PS-ERROR-SW=' PS-ERROR-SW                     26650000
296900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  26660000
297000                             XL011-RETURN-CODE                    26670000
297100     END-IF.                                                      26680000
297200                                                                  26690000
297300                                                                  26700000
297400 7160-UPDATE-TPURITM.                                             26710000
297500     MOVE '7160-UPDATE-TPURITM'       TO XL011-ERROR-PARAGRAPH    26720000
297600     IF XL011-DEBUG-YES                                           26730000
297700         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              26740000
297800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  26750000
297900                             XL011-RETURN-CODE                    26760000
298000     END-IF                                                       26770000
298100                                                                  26780000
298200                                                                  26790000
298300*    SET PS-ERROR-NO                  TO TRUE                     26800000
298400     PERFORM                                                      26810000
298500         WITH TEST AFTER                                          26820000
298600         VARYING PV-RETRY-COUNTER                                 26830000
298700         FROM 1 BY 1                                              26840000
298800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26850000
298900            OR  (SQLCODE = +100)                                  26860000
299000            OR  (SQLCODE = +0))                                   26870000
299100            OR PS-ERROR-YES                                       26880000
299200                                                                  26890000
299300     EXEC SQL                                                     26900000
299400         UPDATE                                                   26910000
299500             TPURITM                                              26920000
299600         SET                                                      26930000
299700             UNT_RTL_PR_AMT           = :PURITM-UNT-RTL-PR-AMT    26940000
299800         ,   TOT_VAL_RTL_AMT          = :PURITM-TOT-VAL-RTL-AMT   26950000
299900         ,   MU_PCT                   = :PURITM-MU-PCT            26960000
300000          ,  GP_RTL_AMT               = :PURITM-GP-RTL-AMT        26970000
300100          ,  GP_QTY                   = :PURITM-GP-QTY            26980000
300200         ,   LAST_UPD_TMST            = CURRENT TIMESTAMP         26990000
300300         ,   LAST_UPD_BY_UID          = 'XLKUP009'                27000000
300400         WHERE                                                    27010000
300500             PO_NBR                   = :PURITM-PO-NBR            27020000
300600         AND ITM_NBR                  = :PURITM-ITM-NBR           27030000
300700         AND VER_STATUS_CDE           = 'A'                       27040000
300800     END-EXEC                                                     27050000
300900                                                                  27060000
301000     MOVE SQLCODE                     TO XL011-SQLCODE            27070000
301100                                         PV-DISP-SQLCODE          27080000
301200                                                                  27090000
301300     IF XL011-DEBUG-YES                                           27100000
301400         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    27110000
301500                  ' PS-ERROR-SW=' PS-ERROR-SW                     27120000
301600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  27130000
301700                             XL011-RETURN-CODE                    27140000
301800     END-IF                                                       27150000
301900                                                                  27160000
302000     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  27170000
302100     EVALUATE TRUE                                                27180000
302200         WHEN SQLCODE = ZERO                                      27190000
302300             SET PS-DONE-YES          TO TRUE                     27200000
302400         WHEN SQLCODE = +100                                      27210000
302500             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     27220000
302600                     DELIMITED BY SIZE                            27230000
302700                                      INTO XL011-ERROR-TEXT       27240000
302800             SET XL011-SYSTEM-ERROR   TO TRUE                     27250000
302900                                                                  27260000
303000         WHEN SQLCODE = -904                                      27270000
303100         WHEN SQLCODE = -911                                      27280000
303200         WHEN SQLCODE = -913                                      27290000
303300             DISPLAY '7160-!!!!!!!!!!!'                           27300000
303400                                                                  27310000
303500       WHEN OTHER                                                 27320000
303600             SET XL011-SQL-ERROR                                  27330000
303700                 PS-ERROR-YES         TO TRUE                     27340000
303800     END-EVALUATE                                                 27350000
303900                                                                  27360000
304000     END-PERFORM.                                                 27370000
304100                                                                  27380000
304200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27390000
304300         SET XL011-SQL-ERROR                                      27400000
304400                 PS-ERROR-YES         TO TRUE                     27410000
304500     END-IF.                                                      27420000
304600                                                                  27430000
304700     IF XL011-DEBUG-YES                                           27440000
304800         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    27450000
304900                  ' PS-ERROR-SW=' PS-ERROR-SW                     27460000
305000         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  27470000
305100                             XL011-RETURN-CODE                    27480000
305200     END-IF.                                                      27490000
305300/                                                                 27500000
305400 7170-DELETE-ALL-TPURITM.                                         27510000
305500     MOVE '7170-DELETE-ALL-TPURITM'   TO XL011-ERROR-PARAGRAPH    27520000
305600     IF XL011-DEBUG-YES                                           27530000
305700         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              27540000
305800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  27550000
305900                             XL011-RETURN-CODE                    27560000
306000     END-IF                                                       27570000
306100                                                                  27580000
306200*    SET PS-ERROR-NO                  TO TRUE                     27590000
306300     PERFORM                                                      27600000
306400         WITH TEST AFTER                                          27610000
306500         VARYING PV-RETRY-COUNTER                                 27620000
306600         FROM 1 BY 1                                              27630000
306700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27640000
306800            OR  (SQLCODE = +100)                                  27650000
306900            OR  (SQLCODE = +0))                                   27660000
307000            OR PS-ERROR-YES                                       27670000
307100                                                                  27680000
307200     EXEC SQL                                                     27690000
307300         DELETE                                                   27700000
307400         FROM                                                     27710000
307500             TPURITM                                              27720000
307600         WHERE                                                    27730000
307700             PO_NBR                   = :PURITM-PO-NBR            27740000
307800     END-EXEC                                                     27750000
307900                                                                  27760000
308000     MOVE SQLCODE                     TO XL011-SQLCODE            27770000
308100                                         PV-DISP-SQLCODE          27780000
308200                                                                  27790000
308300     IF XL011-DEBUG-YES                                           27800000
308400         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    27810000
308500                  ' PS-ERROR-SW=' PS-ERROR-SW                     27820000
308600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  27830000
308700                             XL011-RETURN-CODE                    27840000
308800     END-IF                                                       27850000
308900                                                                  27860000
309000     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  27870000
309100     EVALUATE TRUE                                                27880000
309200         WHEN SQLCODE = ZERO                                      27890000
309300         WHEN SQLCODE = +100                                      27900000
309400             SET PS-DONE-YES          TO TRUE                     27910000
309500         WHEN SQLCODE = -904                                      27920000
309600         WHEN SQLCODE = -911                                      27930000
309700         WHEN SQLCODE = -913                                      27940000
309800             DISPLAY '7170-!!!!!!!!!!!'                           27950000
309900                                                                  27960000
310000       WHEN OTHER                                                 27970000
310100             SET XL011-SQL-ERROR                                  27980000
310200                 PS-ERROR-YES         TO TRUE                     27990000
310300     END-EVALUATE                                                 28000000
310400                                                                  28010000
310500     END-PERFORM.                                                 28020000
310600                                                                  28030000
310700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28040000
310800         SET XL011-SQL-ERROR                                      28050000
310900                 PS-ERROR-YES         TO TRUE                     28060000
311000     END-IF.                                                      28070000
311100                                                                  28080000
311200     IF XL011-DEBUG-YES                                           28090000
311300         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    28100000
311400                  ' PS-ERROR-SW=' PS-ERROR-SW                     28110000
311500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  28120000
311600                             XL011-RETURN-CODE                    28130000
311700     END-IF.                                                      28140000
311800/                                                                 28150000
311900 7200-SELECT-XLTSKU-ITEM.                                         28160000
312000                                                                  28170000
312100     MOVE '7200-SELECT-XLTSKU-ITEM'   TO XL011-ERROR-PARAGRAPH    28180000
312200     IF XL011-DEBUG-YES                                           28190000
312300         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              28200000
312400         MOVE XLT00003-SKU-NBR  TO PV-DISP-SKU                    28210000
312500         DISPLAY 'XLKUP009 - XLT00003-SKU-NBR = ' PV-DISP-SKU     28220000
312600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  28230000
312700                             XL011-RETURN-CODE                    28240000
312800     END-IF                                                       28250000
312900                                                                  28260000
313000     MOVE ZERO                        TO PS-EXISTENCE-SKU         28270000
313100                                                                  28280000
313200*    SET PS-ERROR-NO                  TO TRUE                     28290000
313300     PERFORM                                                      28300000
313400         WITH TEST AFTER                                          28310000
313500         VARYING PV-RETRY-COUNTER                                 28320000
313600         FROM 1 BY 1                                              28330000
313700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28340000
313800            OR  (SQLCODE = +0))                                   28350000
313900            OR PS-ERROR-YES                                       28360000
314000                                                                  28370000
314100     EXEC SQL                                                     28380000
314200     SELECT                                                       28390000
314300         ITM_NBR                                                  28400000
314400     INTO                                                         28410000
314500         :XLT00003-ITM-NBR                                        28420000
314600     FROM                                                         28430000
314700         XLT_SKU                                                  28440000
314800     WHERE                                                        28450000
314900         SKU_NBR                      = :XLT00003-SKU-NBR         28460000
315000     END-EXEC                                                     28470000
315100                                                                  28480000
315200     MOVE SQLCODE                     TO XL011-SQLCODE            28490000
315300                                         PV-DISP-SQLCODE          28500000
315400     IF XL011-DEBUG-YES                                           28510000
315500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    28520000
315600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  28530000
315700                             XL011-RETURN-CODE                    28540000
315800     END-IF                                                       28550000
315900                                                                  28560000
316000     MOVE 'XLT_SKU'                   TO XL011-DB2-TABLE-NAME(1)  28570000
316100     EVALUATE TRUE                                                28580000
316200         WHEN SQLCODE = ZERO                                      28590000
316300         WHEN SQLCODE = -811                                      28600000
316400             SET PS-SKU-EXISTS-YES    TO TRUE                     28610000
316500         WHEN SQLCODE = +100                                      28620000
316600             SET PS-SKU-EXISTS-NO                                 28630000
316700                 XL011-SYSTEM-ERROR   TO TRUE                     28640000
316800         WHEN SQLCODE = -904                                      28650000
316900         WHEN SQLCODE = -911                                      28660000
317000         WHEN SQLCODE = -913                                      28670000
317100             DISPLAY '7200-!!!!!!!!!!!'                           28680000
317200                                                                  28690000
317300       WHEN OTHER                                                 28700000
317400             SET XL011-SQL-ERROR                                  28710000
317500                 PS-ERROR-YES         TO TRUE                     28720000
317600     END-EVALUATE                                                 28730000
317700                                                                  28740000
317800     END-PERFORM.                                                 28750000
317900                                                                  28760000
318000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28770000
318100         SET XL011-SQL-ERROR                                      28780000
318200                 PS-ERROR-YES         TO TRUE                     28790000
318300     END-IF.                                                      28800000
318400                                                                  28810000
318500     IF XL011-DEBUG-YES                                           28820000
318600         DISPLAY 'XLKUP009 - XLT00003-ITM-NBR = ' XLT00003-ITM-NBR28830000
318700                  ' PS-ERROR-SW=' PS-ERROR-SW                     28840000
318800         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  28850000
318900                             XL011-RETURN-CODE                    28860000
319000     END-IF.                                                      28870000
319100/                                                                 28880000
319200 7210-SELECT-XLTSKU-ALL.                                          28890000
319300                                                                  28900000
319400     MOVE '7210-SELECT-XLTSKU-ALL'    TO XL011-ERROR-PARAGRAPH    28910000
319500     IF XL011-DEBUG-YES                                           28920000
319600         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              28930000
319700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  28940000
319800                             XL011-RETURN-CODE                    28950000
319900     END-IF                                                       28960000
320000                                                                  28970000
320100*    SET PS-ERROR-NO                  TO TRUE                     28980000
320200     PERFORM                                                      28990000
320300         WITH TEST AFTER                                          29000000
320400         VARYING PV-RETRY-COUNTER                                 29010000
320500         FROM 1 BY 1                                              29020000
320600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29030000
320700            OR  (SQLCODE = +0)                                    29040000
320800            OR  (SQLCODE = +100)                                  29050000
320900            OR  (SQLCODE = -811))                                 29060000
321000            OR PS-ERROR-YES                                       29070000
321100                                                                  29080000
321200                                                                  29090000
321300     EXEC SQL                                                     29100000
321400       SELECT                                                     29110000
321500         VND.VS_NBR                                               29120000
217830       , SUBSTR(DIGITS(VND.SUB_CL_NBR),3,2)                       29130018
321700       , SKU.CSTM_CLOR_DESC                                       29140000
321800       , SKU.SIZE_DESC                                            29150000
321900       , SKU.ITM_NBR                                              29160000
322000       , SKU.SKU_DESC                                             29170000
322100       , SKU.NRF_CLOR_CDE                                         29180000
322200       , SUBSTR(CHAR(SKU.KOHLS_SIZE_CDE),1,5)                     29190015
322300     INTO                                                         29200000
322400         :XLT00004-VS-NBR                                         29210000
322500       , :DK-SUB-CL                                               29220000
322600       , :XLT00003-CSTM-CLOR-DESC                                 29230000
322700       , :XLT00003-SIZE-DESC                                      29240000
322800       , :XLT00003-ITM-NBR                                        29250000
322900       , :XLT00003-SKU-DESC                                       29260000
323000       , :XLT00003-NRF-CLOR-CDE                                   29270000
323100       , :DK-KOHLS-SIZE-CDE                                       29280000
323200       FROM                                                       29290000
323300         XLT_SKU  SKU                                             29300000
323400       , XLT_VND_STYL VND                                         29310000
323500       WHERE                                                      29320000
323600         SKU.SKU_NBR           = :XLT00003-SKU-NBR                29330000
323700         AND SKU.STYL_ID       = VND.STYL_ID                      29340000
323800     END-EXEC                                                     29350000
323900                                                                  29360000
324000     MOVE SQLCODE                     TO XL011-SQLCODE            29370000
324100                                         PV-DISP-SQLCODE          29380000
324200                                                                  29390000
324300     IF XL011-DEBUG-YES                                           29400000
324400         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    29410000
324500                  ' PS-ERROR-SW=' PS-ERROR-SW                     29420000
324600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  29430000
324700                             XL011-RETURN-CODE                    29440000
324800     END-IF                                                       29450000
324900                                                                  29460000
325000     MOVE 'XLT_SKU'                   TO XL011-DB2-TABLE-NAME(1)  29470000
325100     MOVE 'XLT_VND_STYL'              TO XL011-DB2-TABLE-NAME(2)  29480000
325200     EVALUATE TRUE                                                29490000
325300         WHEN SQLCODE = ZERO                                      29500000
325400         WHEN SQLCODE = -811                                      29510000
325500             CONTINUE                                             29520000
325600         WHEN SQLCODE = -904                                      29530000
325700         WHEN SQLCODE = -911                                      29540000
325800         WHEN SQLCODE = -913                                      29550000
325900             DISPLAY '7210-!!!!!!!!!!!'                           29560000
326000                                                                  29570000
326100         WHEN SQLCODE = +100                                      29580000
326200             MOVE XLT00003-SKU-NBR    TO PV-DISP-SKU              29590000
326300             STRING 'NO SKU OR VND STYL FOR '                     29600000
326400                     'PO = ' XL011-ORDER-NBR                      29610000
326500                     ' SKU = ' PV-DISP-SKU                        29620000
326600                     DELIMITED BY SIZE                            29630000
326700                                      INTO XL011-ERROR-TEXT       29640000
326800             SET XL011-SYSTEM-ERROR   TO TRUE                     29650000
326900       WHEN OTHER                                                 29660000
327000             SET XL011-SQL-ERROR                                  29670000
327100                 PS-ERROR-YES         TO TRUE                     29680000
327200     END-EVALUATE                                                 29690000
327300                                                                  29700000
327400     END-PERFORM.                                                 29710000
327500                                                                  29720000
327600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29730000
327700         SET XL011-SQL-ERROR                                      29740000
327800                 PS-ERROR-YES         TO TRUE                     29750000
327900     END-IF.                                                      29760000
328000                                                                  29770000
328100                                                                  29780000
328200     IF XL011-DEBUG-YES                                           29790000
328300         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    29800000
328400                  ' PS-ERROR-SW=' PS-ERROR-SW                     29810000
328500         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  29820000
328600                             XL011-RETURN-CODE                    29830000
328700     END-IF.                                                      29840000
328800                                                                  29850000
328900*7300-SELECT-NEXT-POPRPK-ID.                                      29860000
329000*                                                                 29870000
329100*    MOVE '7300-SELECT-NEXT-POPRPK-ID' TO XL011-ERROR-PARAGRAPH   29880000
329200*    IF XL011-DEBUG-YES                                           29890000
329300*        DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              29900000
329400*    END-IF                                                       29910000
329500*    EXEC SQL                                                     29920000
329600*        SELECT MAX(PO_PREPK_ID)                                  29930000
329700*        INTO :POPRPK-PO-PREPK-ID :PS-NULL-IND                    29940000
329800*        FROM  TPOPRPK                                            29950000
329900*        WHERE PO_NBR               = :POPRPK-PO-NBR              29960000
330000*    END-EXEC.                                                    29970000
330100*                                                                 29980000
330200*    MOVE SQLCODE                     TO XL011-SQLCODE            29990000
330300*    MOVE 'TPOPRPK'                   TO XL011-DB2-TABLE-NAME(1)  30000000
330400*    EVALUATE TRUE                                                30010000
330500*        WHEN SQLCODE = ZERO                                      30020000
330600*        WHEN SQLCODE = -811                                      30030000
330700*        WHEN SQLCODE = +100                                      30040000
330800*            CONTINUE                                             30050000
330900*      WHEN OTHER                                                 30060000
331000*            SET XL011-SQL-ERROR      TO TRUE                     30070000
331100*    END-EVALUATE.                                                30080000
331200*                                                                 30090000
331300                                                                  30100000
331400 7310-SELECT-POPRPK-ID.                                           30110000
331500                                                                  30120000
331600     MOVE '7310-SELECT-POPRPK-ID'     TO XL011-ERROR-PARAGRAPH    30130000
331700     IF XL011-DEBUG-YES                                           30140000
331800         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              30150000
331900         DISPLAY 'POPRPK-PO-NBR =' POPRPK-PO-NBR                  30160000
332000                 ' POPRPK-PK-SKU-NBR =' POPRPK-PK-SKU-NBR         30170000
332100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  30180000
332200                             XL011-RETURN-CODE                    30190000
332300     END-IF                                                       30200000
332400     MOVE ZERO                        TO POPRPK-PO-PREPK-ID       30210000
332500                                                                  30220000
332600*    SET PS-ERROR-NO                  TO TRUE                     30230000
332700     PERFORM                                                      30240000
332800         WITH TEST AFTER                                          30250000
332900         VARYING PV-RETRY-COUNTER                                 30260000
333000         FROM 1 BY 1                                              30270000
333100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30280000
333200            OR  (SQLCODE = +0))                                   30290000
333300            OR PS-ERROR-YES                                       30300000
333400                                                                  30310000
333500                                                                  30320000
333600     EXEC SQL                                                     30330000
333700         SELECT                                                   30340000
333800             PO_PREPK_ID                                          30350000
333900         INTO :POPRPK-PO-PREPK-ID                                 30360000
334000         FROM  TPOPRPK                                            30370000
334100         WHERE PO_NBR               = :POPRPK-PO-NBR              30380000
334200           AND PK_SKU_NBR           = :POPRPK-PK-SKU-NBR          30390000
334300*LMM       AND PREPK_STAT_CDE       = 'A'                         30400000
334400     END-EXEC                                                     30410000
334500                                                                  30420000
334600     MOVE SQLCODE                     TO XL011-SQLCODE            30430000
334700                                         PV-DISP-SQLCODE          30440000
334800                                                                  30450000
334900     IF XL011-DEBUG-YES                                           30460000
335000         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    30470000
335100                  ' PS-ERROR-SW=' PS-ERROR-SW                     30480000
335200         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  30490000
335300                             XL011-RETURN-CODE                    30500000
335400     END-IF                                                       30510000
335500                                                                  30520000
335600                                                                  30530000
335700     MOVE 'TPOPRPK'                   TO XL011-DB2-TABLE-NAME(1)  30540000
335800     EVALUATE TRUE                                                30550000
335900         WHEN SQLCODE = ZERO                                      30560000
336000         WHEN SQLCODE = -811                                      30570000
336100             CONTINUE                                             30580000
336200         WHEN SQLCODE = +100                                      30590000
336300             MOVE POPRPK-PK-SKU-NBR   TO PV-DISP-SKU              30600000
336400             STRING 'NO TPOPRPK FOUND FOR = ' XL011-ORDER-NBR     30610000
336500                    ' PK-SKU = ' PV-DISP-SKU                      30620000
336600                     DELIMITED BY SIZE                            30630000
336700                                      INTO XL011-ERROR-TEXT       30640000
336800             SET XL011-SYSTEM-ERROR   TO TRUE                     30650000
336900                                                                  30660000
337000         WHEN SQLCODE = -904                                      30670000
337100         WHEN SQLCODE = -911                                      30680000
337200         WHEN SQLCODE = -913                                      30690000
337300             DISPLAY '7310-!!!!!!!!!!!'                           30700000
337400                                                                  30710000
337500       WHEN OTHER                                                 30720000
337600             SET XL011-SQL-ERROR                                  30730000
337700                 PS-ERROR-YES         TO TRUE                     30740000
337800     END-EVALUATE                                                 30750000
337900                                                                  30760000
338000     END-PERFORM.                                                 30770000
338100                                                                  30780000
338200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30790000
338300         SET XL011-SQL-ERROR                                      30800000
338400                 PS-ERROR-YES         TO TRUE                     30810000
338500     END-IF.                                                      30820000
338600                                                                  30830000
338700     IF XL011-DEBUG-YES                                           30840000
338800         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    30850000
338900                  ' PS-ERROR-SW=' PS-ERROR-SW                     30860000
339000         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  30870000
339100                             XL011-RETURN-CODE                    30880000
339200     END-IF.                                                      30890000
339300                                                                  30900000
339400 7400-OPEN-PACK-CSR.                                              30910000
339500                                                                  30920000
339600     MOVE '7400-OPEN-PACK-CSR'        TO XL011-ERROR-PARAGRAPH    30930000
339700     IF XL011-DEBUG-YES                                           30940000
339800         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              30950000
339900         DISPLAY ' PK_SKU_NBR = ' POPRPK-PK-SKU-NBR               30960000
340000           ' PK.PO_NBR = ' PURITM-PO-NBR                          30970000
340100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  30980000
340200                             XL011-RETURN-CODE                    30990000
340300     END-IF                                                       31000000
340400                                                                  31010000
340500*    SET PS-ERROR-NO                  TO TRUE                     31020000
340600     PERFORM                                                      31030000
340700         WITH TEST AFTER                                          31040000
340800         VARYING PV-RETRY-COUNTER                                 31050000
340900         FROM 1 BY 1                                              31060000
341000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31070000
341100            OR  (SQLCODE = +0))                                   31080000
341200            OR PS-ERROR-YES                                       31090000
341300                                                                  31100000
341400     SET PS-CSR-OPEN-NO               TO TRUE                     31110000
341500     EXEC SQL                                                     31120000
341600         OPEN PACK-LINE-CSR                                       31130000
341700     END-EXEC                                                     31140000
341800                                                                  31150000
341900     MOVE SQLCODE                     TO XL011-SQLCODE            31160000
342000                                         PV-DISP-SQLCODE          31170000
342100                                                                  31180000
342200                                                                  31190000
342300     IF XL011-DEBUG-YES                                           31200000
342400         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    31210000
342500                  ' PS-ERROR-SW=' PS-ERROR-SW                     31220000
342600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  31230000
342700                             XL011-RETURN-CODE                    31240000
342800     END-IF                                                       31250000
342900                                                                  31260000
343000     MOVE 'TPOPRPK'                   TO XL011-DB2-TABLE-NAME(1)  31270000
343100     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(2)  31280000
343200     EVALUATE TRUE                                                31290000
343300         WHEN SQLCODE = ZERO                                      31300000
343400             SET PS-CSR-OPEN-YES      TO TRUE                     31310000
343500                                                                  31320000
343600         WHEN SQLCODE = -904                                      31330000
343700         WHEN SQLCODE = -911                                      31340000
343800         WHEN SQLCODE = -913                                      31350000
343900             DISPLAY '7400-!!!!!!!!!!!'                           31360000
344000                                                                  31370000
344100       WHEN OTHER                                                 31380000
344200             SET XL011-SQL-ERROR                                  31390000
344300                 PS-ERROR-YES         TO TRUE                     31400000
344400     END-EVALUATE                                                 31410000
344500                                                                  31420000
344600     END-PERFORM.                                                 31430000
344700                                                                  31440000
344800                                                                  31450000
344900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31460000
345000         SET XL011-SQL-ERROR                                      31470000
345100                 PS-ERROR-YES         TO TRUE                     31480000
345200     END-IF.                                                      31490000
345300                                                                  31500000
345400     IF XL011-DEBUG-YES                                           31510000
345500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    31520000
345600                  ' PS-ERROR-SW=' PS-ERROR-SW                     31530000
345700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  31540000
345800                             XL011-RETURN-CODE                    31550000
345900     END-IF.                                                      31560000
346000                                                                  31570000
346100 7410-FETCH-PACK-CSR.                                             31580000
346200                                                                  31590000
346300     MOVE '7410-FETCH-PACK-CSR'       TO XL011-ERROR-PARAGRAPH    31600000
346400     IF XL011-DEBUG-YES                                           31610000
346500         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              31620000
346600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  31630000
346700                             XL011-RETURN-CODE                    31640000
346800     END-IF                                                       31650000
346900                                                                  31660000
347000     EXEC SQL                                                     31670000
347100         FETCH PACK-LINE-CSR                                      31680000
347200         INTO                                                     31690000
347300             :PURITM-VER-NBR                                      31700000
347400         ,   :PURITM-PO-LNE-NBR                                   31710000
347500         ,   :PV-CURRENT-STATUS-CDE                               31720000
347600         ,   :PV-UNT-QTY                                          31730000
347700         ,   :PV-UNT-COST-AMT                                     31740000
347800         ,   :PURITM-GP-RTL-AMT                                   31750000
347900         ,   :PURITM-GP-QTY                                       31760000
348000         ,   :PURITM-UNT-RTL-PR-AMT                               31770000
348100         ,   :PURITM-TOT-VAL-RTL-AMT                              31780000
348200         ,   :PURITM-MU-PCT                                       31790000
348300         ,   :PURITM-PREPK-RATO-QTY                               31800000
348400         ,   :PURITM-RMS-PO-SKU-NBR                               31810000
348500     END-EXEC                                                     31820000
348600                                                                  31830000
348700     MOVE SQLCODE                     TO XL011-SQLCODE            31840000
348800                                         PV-DISP-SQLCODE          31850000
348900                                                                  31860000
349000     MOVE 'TPOPRPK'                   TO XL011-DB2-TABLE-NAME(1)  31870000
349100     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(2)  31880000
349200     EVALUATE TRUE                                                31890000
349300         WHEN SQLCODE = ZERO                                      31900000
349400             SET PS-END-PACK-CSR-NO   TO TRUE                     31910000
349500         WHEN SQLCODE = +100                                      31920000
349600             SET PS-END-PACK-CSR-YES  TO TRUE                     31930000
349700                                                                  31940000
349800       WHEN OTHER                                                 31950000
349900             SET XL011-SQL-ERROR                                  31960000
350000                 PS-CSR-OPEN-NO                                   31970000
350100                 PS-ERROR-YES         TO TRUE                     31980000
350200     END-EVALUATE.                                                31990000
350300                                                                  32000000
350400     IF XL011-DEBUG-YES                                           32010000
350500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    32020000
350600                  ' PS-ERROR-SW=' PS-ERROR-SW                     32030000
350700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  32040000
350800                             XL011-RETURN-CODE                    32050000
350900     END-IF.                                                      32060000
351000                                                                  32070000
351100 7420-CLOSE-PACK-CSR.                                             32080000
351200                                                                  32090000
351300     MOVE '7420-CLOSE-PACK-CSR'       TO XL011-ERROR-PARAGRAPH    32100000
351400     IF XL011-DEBUG-YES                                           32110000
351500         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              32120000
351600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  32130000
351700                             XL011-RETURN-CODE                    32140000
351800     END-IF                                                       32150000
351900     EXEC SQL                                                     32160000
352000         CLOSE PACK-LINE-CSR                                      32170000
352100     END-EXEC.                                                    32180000
352200                                                                  32190000
352300     MOVE SQLCODE                     TO XL011-SQLCODE            32200000
352400                                         PV-DISP-SQLCODE          32210000
352500                                                                  32220000
352600     IF XL011-DEBUG-YES                                           32230000
352700         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    32240000
352800                  ' PS-ERROR-SW=' PS-ERROR-SW                     32250000
352900         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  32260000
353000                             XL011-RETURN-CODE                    32270000
353100     END-IF.                                                      32280000
353200                                                                  32290000
353300                                                                  32300000
353400     MOVE 'TPOPRPK'                   TO XL011-DB2-TABLE-NAME(1)  32310000
353500     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(2)  32320000
353600     EVALUATE TRUE                                                32330000
353700         WHEN SQLCODE = ZERO                                      32340000
353800             CONTINUE                                             32350000
353900       WHEN OTHER                                                 32360000
354000             SET XL011-SQL-ERROR                                  32370000
354100                 PS-ERROR-YES         TO TRUE                     32380000
354200     END-EVALUATE.                                                32390000
354300                                                                  32400000
354400     IF XL011-DEBUG-YES                                           32410000
354500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    32420000
354600                  ' PS-ERROR-SW=' PS-ERROR-SW                     32430000
354700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  32440000
354800                             XL011-RETURN-CODE                    32450000
354900     END-IF.                                                      32460000
355000/                                                                 32470000
355100 7500-SELECT-PURITM-NBRS.                                         32480000
355200                                                                  32490000
355300     MOVE '7500-SELECT-PURITM-NBRS'   TO XL011-ERROR-PARAGRAPH    32500000
355400     IF XL011-DEBUG-YES                                           32510000
355500         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              32520000
355600         DISPLAY 'PURITM-PO-NBR= ' PURITM-PO-NBR                  32530000
355700                 ' PURITM-ITM-NBR= ' PURITM-ITM-NBR               32540000
355800                 ' PURITM-PO-PREPK-ID= ' PURITM-PO-PREPK-ID       32550000
355900         DISPLAY ' TOT-COST= ' PURITM-TOT-VAL-COST-AMT            32560000
356000                 ' TOT-RTL = ' PURITM-TOT-VAL-RTL-AMT             32570000
356100         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  32580000
356200                             XL011-RETURN-CODE                    32590000
356300     END-IF.                                                      32600000
356400                                                                  32610000
356500                                                                  32620000
356600*    SET PS-ERROR-NO                  TO TRUE                     32630000
356700     PERFORM                                                      32640000
356800         WITH TEST AFTER                                          32650000
356900         VARYING PV-RETRY-COUNTER                                 32660000
357000         FROM 1 BY 1                                              32670000
357100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32680000
357200            OR  (SQLCODE = +0)                                    32690000
357300            OR  (SQLCODE = +100))                                 32700000
357400            OR PS-ERROR-YES                                       32710000
357500                                                                  32720000
357600         EXEC SQL                                                 32730000
357700             SELECT                                               32740000
357800                GP_RTL_AMT                                        32750000
357900              , GP_QTY                                            32760000
358000              , UNT_QTY                                           32770000
358100              , UNT_RTL_PR_AMT                                    32780000
358200              , CNCLD_UNT_QTY                                     32790000
358300              , TOT_VAL_COST_AMT                                  32800000
358400              , TOT_VAL_RTL_AMT                                   32810000
358500              , MU_PCT                                            32820000
358600              , UNT_COST_AMT                                      32830000
358700              , STATUS_CDE                                        32840000
358800              , PREPK_RATO_QTY                                    32850000
358900         INTO                                                     32860000
359000             :PURITM-GP-RTL-AMT                                   32870000
359100         ,   :PURITM-GP-QTY                                       32880000
359200         ,   :PURITM-UNT-QTY                                      32890000
359300         ,   :PURITM-UNT-RTL-PR-AMT                               32900000
359400         ,   :PURITM-CNCLD-UNT-QTY                                32910000
359500         ,   :PURITM-TOT-VAL-COST-AMT                             32920000
359600         ,   :PURITM-TOT-VAL-RTL-AMT                              32930000
359700         ,   :PURITM-MU-PCT                                       32940000
359800         ,   :PURITM-UNT-COST-AMT                                 32950000
359900         ,   :PURITM-STATUS-CDE                                   32960000
360000         ,   :PURITM-PREPK-RATO-QTY                               32970000
360100                                                                  32980000
360200         FROM                                                     32990000
360300             TPURITM PUR                                          33000000
360400             WHERE                                                33010000
360500                 PUR.PO_NBR           = :PURITM-PO-NBR            33020000
360600             AND PUR.ITM_NBR          = :PURITM-ITM-NBR           33030000
360700             AND PUR.PO_PREPK_ID      = :PURITM-PO-PREPK-ID       33040000
360800             AND PUR.VER_STATUS_CDE   = 'A'                       33050000
360900         END-EXEC                                                 33060000
361000                                                                  33070000
361100     MOVE SQLCODE                     TO XL011-SQLCODE            33080000
361200                                         PV-DISP-SQLCODE          33090000
361300                                                                  33100000
361400     IF XL011-DEBUG-YES                                           33110000
361500         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    33120000
361600                  ' PS-ERROR-SW=' PS-ERROR-SW                     33130000
361700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  33140000
361800                             XL011-RETURN-CODE                    33150000
361900     END-IF                                                       33160000
362000                                                                  33170000
362100     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  33180000
362200     EVALUATE TRUE                                                33190000
362300         WHEN SQLCODE = ZERO                                      33200000
362400             IF XL011-DEBUG-YES                                   33210000
362500                 DISPLAY ' ITEM = ' PURITM-ITM-NBR                33220000
362600                         ' UNT-QTY = ' PURITM-UNT-QTY             33230000
362700         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  33240000
362800                             XL011-RETURN-CODE                    33250000
362900             END-IF                                               33260000
363000         WHEN SQLCODE = +100                                      33270000
363100             STRING 'NO TPURITM FOUND FOR = ' XL011-ORDER-NBR     33280000
363200                     DELIMITED BY SIZE                            33290000
363300                                      INTO XL011-ERROR-TEXT       33300000
363400             SET XL011-SYSTEM-ERROR   TO TRUE                     33310000
363500                                                                  33320000
363600         WHEN SQLCODE = -904                                      33330000
363700         WHEN SQLCODE = -911                                      33340000
363800         WHEN SQLCODE = -913                                      33350000
363900             DISPLAY '7500-!!!!!!!!!!!'                           33360000
364000                                                                  33370000
364100       WHEN OTHER                                                 33380000
364200             SET XL011-SQL-ERROR                                  33390000
364300                 PS-ERROR-YES         TO TRUE                     33400000
364400     END-EVALUATE                                                 33410000
364500                                                                  33420000
364600     END-PERFORM.                                                 33430000
364700                                                                  33440000
364800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33450000
364900         SET XL011-SQL-ERROR                                      33460000
365000                 PS-ERROR-YES         TO TRUE                     33470000
365100     END-IF.                                                      33480000
365200                                                                  33490000
365300     IF XL011-DEBUG-YES                                           33500000
365400         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    33510000
365500                  ' PS-ERROR-SW=' PS-ERROR-SW                     33520000
365600         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  33530000
365700                             XL011-RETURN-CODE                    33540000
365800     END-IF.                                                      33550000
365900/                                                                 33560000
366000 7600-SELECT-PACK-ITEM.                                           33570000
366100                                                                  33580000
366200     MOVE '7600-SELECT-PACK-ITEM  '   TO XL011-ERROR-PARAGRAPH    33590000
366201     MOVE XL011-PCA-PACK-SKU-NBR      TO POPRPK-PK-SKU-NBR        33600001
366210     IF XL011-DEBUG-YES                                           33610000
366230         DISPLAY 'XLKUP009 - ' XL011-ERROR-PARAGRAPH              33620000
366240         DISPLAY 'PURITM-PO-NBR= ' PURITM-PO-NBR                  33630000
366250                 ' PK.PK_SKU_NBR = ' POPRPK-PK-SKU-NBR            33640003
366260                 ' XLT00003-SKU-NBR  = ' XLT00003-SKU-NBR         33650002
366270         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  33660000
366280                             XL011-RETURN-CODE                    33670000
366290         DISPLAY 'POPRPK-PK-SKU-NBR' POPRPK-PK-SKU-NBR            33680000
366291         DISPLAY 'PURITM-PO-NBR    ' PURITM-PO-NBR                33690000
366292         DISPLAY 'XLT00003-SKU-NBR ' XLT00003-SKU-NBR             33700000
366293     END-IF.                                                      33710000
366294                                                                  33720000
366295                                                                  33730000
366296*    SET PS-ERROR-NO                  TO TRUE                     33740000
366297     PERFORM                                                      33750000
366298         WITH TEST AFTER                                          33760000
366299         VARYING PV-RETRY-COUNTER                                 33770000
366300         FROM 1 BY 1                                              33780000
366301         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33790000
366302            OR  (SQLCODE = +0)                                    33800000
366303            OR  (SQLCODE = +100)                                  33810004
366304            OR  (SQLCODE = -811))                                 33820004
366305            OR PS-ERROR-YES                                       33830004
366306                                                                  33840004
366307         EXEC SQL                                                 33850004
366308             SELECT                                               33860004
366309                 PUR.PO_NBR                                       33870004
366310             INTO                                                 33880004
366311                 :PURITM-PO-NBR                                   33890004
366312             FROM                                                 33900004
366313                 TPOPRPK              PK                          33910004
366314             ,   TPURITM              PUR                         33920004
366315             WHERE                                                33930004
366316                 PK.PK_SKU_NBR            = :POPRPK-PK-SKU-NBR    33940004
366317             AND PK.PO_NBR                = :PURITM-PO-NBR        33950004
366318             AND PK.PO_NBR                = PUR.PO_NBR            33960004
366319             AND PUR.RMS_PO_SKU_NBR       = :XLT00003-SKU-NBR     33970004
366320             AND PK.PO_PREPK_ID           = PUR.PO_PREPK_ID       33980004
366321             AND PUR.VER_STATUS_CDE       = 'A'                   33990004
366322         END-EXEC                                                 34000004
366323                                                                  34010004
366324     MOVE SQLCODE                     TO XL011-SQLCODE            34020004
366325                                         PV-DISP-SQLCODE          34030004
366326                                                                  34040004
366327     IF XL011-DEBUG-YES                                           34050004
366328         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    34060004
366329                  ' PS-ERROR-SW=' PS-ERROR-SW                     34070004
366330         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  34080004
366331                             XL011-RETURN-CODE                    34090004
366332     END-IF                                                       34100004
366333                                                                  34110004
366334     MOVE 'TPURITM'                   TO XL011-DB2-TABLE-NAME(1)  34120004
366335     EVALUATE TRUE                                                34130004
366336         WHEN SQLCODE = ZERO                                      34140004
366337         WHEN SQLCODE = -811                                      34150004
366338             SET PS-DONE-YES  TO TRUE                             34160004
366339         WHEN SQLCODE = +100                                      34170004
366340             SET PS-INSERT-MODE TO TRUE                           34180005
366341         WHEN SQLCODE = -904                                      34190004
366342         WHEN SQLCODE = -911                                      34200004
366343         WHEN SQLCODE = -913                                      34210004
366344             DISPLAY '7600-!!!!!!!!!!!'                           34220004
366345                                                                  34230004
366346       WHEN OTHER                                                 34240004
366347             SET XL011-SQL-ERROR                                  34250004
366348                 PS-ERROR-YES         TO TRUE                     34260004
366349     END-EVALUATE                                                 34270004
366350                                                                  34280004
366351     END-PERFORM.                                                 34290004
366352                                                                  34300004
366353     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34310004
366354         SET XL011-SQL-ERROR                                      34320004
366355                 PS-ERROR-YES         TO TRUE                     34330004
366356     END-IF.                                                      34340004
366357                                                                  34350004
366358     IF XL011-DEBUG-YES                                           34360004
366359         DISPLAY 'XLKUP009 - XL011-SQLCODE = ' PV-DISP-SQLCODE    34370004
366360                  ' PS-ERROR-SW=' PS-ERROR-SW                     34380004
366361         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  34390004
366362                             XL011-RETURN-CODE                    34400004
366363     END-IF.                                                      34410004
366364/                                                                 34420004
366365*8000-CALL-XLKUP013.                                              34430004
366366*    CALL PC-XLKUP013 USING XLRD011-RECORD.                       34440004
366367                                                                  34450004
366368 8100-NUMERIC-EDIT.                                               34460004
366369     IF XL011-DEBUG-YES                                           34470004
366370         DISPLAY 'XLKUP009 - 8100-NUMERIC-EDIT'                   34480004
366371         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  34490004
366372                             XL011-RETURN-CODE                    34500004
366380     END-IF                                                       34510000
366390     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      34520000
366400     CALL DP010I-NUMERIC-EDIT-ROUTINE                             34530000
366500          USING DP010I-NUMERIC-EDIT-AREA                          34540000
366600     IF  DP010I-ERROR-DETECTED                                    34550000
366700         MOVE '8100-NUMERIC-EDIT'     TO XL011-ERROR-PARAGRAPH    34560000
366800     END-IF.                                                      34570000
366900/                                                                 34580000
367000 9999-WRAPUP.                                                     34590000
367100                                                                  34600000
367200     IF XL011-DEBUG-YES                                           34610000
367300         DISPLAY 'XLKUP009 - 9999-WRAPUP'                         34620000
367400         DISPLAY 'XLKUP009 - XL011-RETURN-CODE='                  34630000
367500                             XL011-RETURN-CODE                    34640000
367600     END-IF                                                       34650000
367700     MOVE SQLCA                       TO XL011-SQLCA.             34660000
367800*                                                                 34670000
367900*    THIS STUFF USED TO BE IN THE BUILD LOGIC.                    34680000
368000*    INITIALIZE XL001-ITEM-COMMAREA                               34690000
368100*    MOVE XL011-SA-SKU                TO XL001-KEY-SKU            34700000
368200*    SET XL001-BY-NUMERIC-SKU                                     34710000
368300*        XL001-SELECT-SKU                                         34720000
368400*        XL001-SELECT-VND-STYL        TO TRUE                     34730000
368500*    PERFORM 8000-CALL-XLKUT001                                   34740000
368600*    IF XL001-SKU-SQLCODE = ZERO                                  34750000
368700*        MOVE XL001-SUB-CL-NBR-2CH    TO PURITM-CL-NBR            34760000
368800*        MOVE XL001-VS-NBR            TO PURITM-VEND-STYL-NAME    34770000
368900*        MOVE XL001-CSTM-CLOR-DESC    TO PURITM-COLOR-DESC        34780000
369000*        MOVE XL001-SIZE-DESC         TO PURITM-SIZE-DESC         34790000
369100*        MOVE XL001-ITM-NBR           TO PURITM-ITM-NBR           34800000
369200*        MOVE XL001-SKU-DESC          TO PURITM-SKU-DESC          34810000
369300*        MOVE XL001-NRF-CLOR-CDE      TO PURITM-COLOR-CDE         34820000
369400*        MOVE XL001-KOHLS-SIZE-CDE    TO PURITM-SIZE-CDE          34830000
369500*    END-IF                                                       34840000
369600                                                                  34850000
369700*8000-CALL-XLKUT001.                                              34860000
369800*                                                                 34870000
369900*    CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                34880000
370000*                                                                 34890000
370100*    MOVE XL001-SKU-SQLCODE           TO XL011-SQLCODE            34900000
370200*                                                                 34910000
370300*    EVALUATE TRUE                                                34920000
370400*        WHEN XL001-SKU-SQLCODE = ZERO                            34930000
370500*            CONTINUE                                             34940000
370600*        WHEN XL001-SKU-CONTENTION                                34950000
370700*        WHEN XL001-SKU-NOT-FOUND                                 34960000
370800*            CONTINUE                                             34970000
370900*        WHEN XL001-UPC-SQLCODE > ZERO                            34980000
371000*        WHEN XL001-UPC-SQLCODE < ZERO                            34990000
371100*            SET XL011-SQL-ERROR      TO TRUE                     35000000
371200*    END-EVALUATE.                                                35010000
371300                                                                  35020000
