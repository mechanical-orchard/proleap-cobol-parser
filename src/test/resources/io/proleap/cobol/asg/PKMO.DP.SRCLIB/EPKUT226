      *----------------------------------------------------------       00010011
       IDENTIFICATION DIVISION.                                         00020011
      *----------------------------------------------------------       00030011
       PROGRAM-ID.           EPKUT226.                                  00040011
       AUTHOR.               DAVID WELLER.                              00050011
       INSTALLATION.         KOHLS DEPARTMENT STORES.                   00051011
       DATE-WRITTEN.         JANUARY 8, 2009.                           00052011
                                                                        00053011
      *-------------------------------------------------------------*   00054011
      *  CHANGE FILE HEADER FORMATTER FOR OFFERS WITHOUT EXCLUSIONS *   00055011
      *-------------------------------------------------------------*   00056011
      * THIS PROGRAM WILL READ THE OFFER FILES AND CREATE FORMATTED *   00057011
      * OFFERS FILE WITH APPROPRIATE HEADERS.                       *   00058011
      * THE INTENTIONS IS TO FORMAT ONE SET OF HEADERS FOR EACH     *   00059011
      * STR-GRP-TYP-CDE / STR-GRP-ID COMINATION.                    *   00060011
      *-------------------------------------------------------------*   00070011
      *  INPUT FILES:                       DESCRIPTION             *   00080011
      *  --------------                   ---------------           *   00090011
      *   INP01                      FILE MAPPED TO XST_OFR         *   00100011
      *   INP02                      FILE MAPPED TO XST_OFR_SECT    *   00110011
      *   INP03                      FILE MAPPED TO XST_OFR_BWP     *   00120011
      *   INP04                      FILE MAPPED TO XST_OFR_MDSE_SET*   00130011
      *   INP05                      STORE LIST FILE                *   00140011
      *                                                             *   00141011
      *  ALL THE ABOVE INPUT FILES ARE CREATED IN PROGRAM EPKUT225  *   00142011
      *-------------------------------------------------------------*   00143011
      *                                                             *   00143111
      *  INPUT:                                                     *   00143211
      *        OFFERS-DATA-FILE                 EPRD271             *   00143311
      *        OFFERS-SECTION-FILE              EPRD272             *   00143411
      *        OFFERS-BWP-FILE                  EPRD273             *   00143511
      *        OFFERS-MDSE-FILE                 EPRD274             *   00143611
      *        STORE-LIST-FILE                  EPRD206             *   00143711
      *                                                             *   00143811
      *  OUTPUT:                                                    *   00143911
      *        FORMATTED-OFFERS-FILE            EPRD200             *   00144011
      *                                (FOR HEADER FORMAT)          *   00144111
      *-------------------------------------------------------------*   00144211
      * HISTORY LOG:                                                *   00144311
      *                                                             *   00144411
      *-------------------------------------------------------------*   00144511
      * DATE:  02/2010                                              *   00144614
      * WR/IR#:  WR0034297                                          *   00144714
      * PROGRAMMER:  DAVE WELLER                                    *   00144814
      * DESCRIPTION:  CREATED PROGRAM                               *   00144914
      *                                                             *   00145011
      *-------------------------------------------------------------*   00146011
       ENVIRONMENT DIVISION.                                            00147011
      *-------------------------------------------------------------*   00148011
       CONFIGURATION SECTION.                                           00149011
       SOURCE-COMPUTER. IBM-3090.                                       00150011
       OBJECT-COMPUTER. IBM-3090.                                       00160011
                                                                        00170011
       INPUT-OUTPUT SECTION.                                            00180011
                                                                        00190011
       FILE-CONTROL.                                                    00200011
                                                                        00210011
      *  INPUT:                                                     *   00220011
                 SELECT OFFERS-DATA-FILE                                00230011
                   ASSIGN TO INP01.                                     00240011
                                                                        00250011
                 SELECT OFFERS-SECTION-FILE                             00260011
                   ASSIGN TO INP02.                                     00270011
                                                                        00280011
                 SELECT OFFERS-BWP-FILE                                 00290011
                   ASSIGN TO INP03.                                     00300011
                                                                        00310011
                 SELECT OFFERS-MDSE-FILE                                00320011
                   ASSIGN TO INP04.                                     00330011
                                                                        00361011
      *  OUTPUT:                                                    *   00362011
                 SELECT FORMATTED-OFFERS-FILE                           00363011
                   ASSIGN TO OUT01.                                     00364011
                                                                        00365011
      *-------------------------------------------------------------*   00365111
       DATA DIVISION.                                                   00365211
      *----------------------------------------------------------       00365311
       FILE SECTION.                                                    00365411
                                                                        00365511
       FD  OFFERS-DATA-FILE                                             00365611
           RECORDING MODE IS F                                          00365711
           LABEL RECORDS ARE STANDARD                                   00365811
           RECORD CONTAINS 160 CHARACTERS                               00365911
           BLOCK CONTAINS 0 RECORDS                                     00366011
           DATA RECORD IS OFFERS-DATA-RECORD.                           00367011
                                                                        00368011
       01  OFFERS-DATA-RECORD           PIC X(160).                     00369011
                                                                        00370011
       FD  OFFERS-SECTION-FILE                                          00380011
           RECORDING MODE IS F                                          00390011
           LABEL RECORDS ARE STANDARD                                   00400011
           RECORD CONTAINS 120 CHARACTERS                               00410011
           BLOCK CONTAINS 0 RECORDS                                     00420011
           DATA RECORD IS OFFERS-SECTION-RECORD.                        00430011
                                                                        00440011
       01  OFFERS-SECTION-RECORD             PIC X(120).                00450011
                                                                        00460011
       FD  OFFERS-BWP-FILE                                              00470011
           RECORDING MODE IS F                                          00480011
           LABEL RECORDS ARE STANDARD                                   00490011
           RECORD CONTAINS 110 CHARACTERS                               00491011
           BLOCK CONTAINS 0 RECORDS                                     00492011
           DATA RECORD IS OFFERS-BWP-RECORD.                            00493011
                                                                        00493111
       01  OFFERS-BWP-RECORD                 PIC X(110).                00493211
                                                                        00493311
       FD  OFFERS-MDSE-FILE                                             00493411
           RECORDING MODE IS F                                          00493511
           LABEL RECORDS ARE STANDARD                                   00493611
           RECORD CONTAINS 96 CHARACTERS                                00493711
           BLOCK CONTAINS 0 RECORDS                                     00493811
           DATA RECORD IS OFFERS-MDSE-RECORD.                           00493911
                                                                        00494011
       01  OFFERS-MDSE-RECORD                PIC X(96).                 00494111
                                                                        00495111
       FD  FORMATTED-OFFERS-FILE                                        00495211
           RECORDING MODE IS V                                          00495311
           RECORD IS VARYING IN SIZE                                    00495411
           FROM 1 TO 200 CHARACTERS                                     00495511
           DEPENDING ON PV-BYTE-COUNT                                   00495611
           LABEL RECORDS ARE STANDARD                                   00495711
           DATA RECORD IS FORMATTED-OFFERS-RECORD.                      00495811
                                                                        00495911
       01  FORMATTED-OFFERS-RECORD.                                     00496011
           05  FORM-OFR-FLD                  PIC X(01)                  00496111
               OCCURS 200 TIMES                                         00496211
                    INDEXED BY                                          00496311
                    FORM-OFR-LEN.                                       00496411
                                                                        00496511
      *----------------------------------------------------------       00496611
       WORKING-STORAGE SECTION.                                         00496711
                                                                        00496811
       01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00496911
                                                        COMP SYNC.      00497011
           88  AC-INPUT-CONTROL-CARD-ERROR              VALUE +4003.    00498011
           88  AC-DB2-ERROR                             VALUE +4013.    00499011
           88  AC-INPUT-FILE-EMPTY                      VALUE +4008.    00500011
           88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00510011
                                                                        00520011
      *----------------------------------------------------------       00530011
      * PC- PROGRAM CONSTANTS                                           00540011
      *----------------------------------------------------------       00550011
       01  PC-PROGRAM-CONSTANTS.                                        00560011
           05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT226'. 00570011
           05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00580011
           05  PC-FIELD-LENGTH              PIC S9(03) VALUE +10 COMP-3.00590011
           05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.        00600011
           05  PC-NULL-VALUE                PIC X(01) VALUE '~'.        00610011
           05  PC-UNDER-SCORE               PIC X(01) VALUE '_'.        00620011
           05  PC-DASH                      PIC X(01) VALUE '-'.        00630011
           05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.        00640011
           05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.        00650011
           05  PC-TIME-START                PIC X(08) VALUE '00:00:01'. 00660011
           05  PC-TIME-END                  PIC X(08) VALUE '23:59:59'. 00661011
           05  PC-STORE-SPECIFIC-GRP        PIC X(05) VALUE '05000'.    00662011
           05  PC-FIVE-ZERO                 PIC X(05) VALUE '00000'.    00663011
           05  PC-HDR-IND                   PIC X(03) VALUE 'HDR'.      00664011
           05  PC-OFR-IND                   PIC X(03) VALUE 'OFR'.      00664111
                                                                        00664211
      *----------------------------------------------------------       00664311
      * PV- PROGRAM VARIABLES                                           00664411
      *----------------------------------------------------------       00664511
       01  PV-PROGRAM-STATUS.                                           00664611
           05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     00664711
           05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.     00664811
           05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.     00664911
           05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00665011
           05  PV-SQL-SUB                   PIC S9(4) VALUE +0 COMP.    00666011
      *                                                                 00667011
       01  PV-PROGRAM-VARIABLES.                                        00668011
           05  PV-TALLY                     PIC S9(03) COMP-3 VALUE +0. 00669011
           05  PV-BYTE-COUNT                PIC  9(04) VALUE ZERO.      00670011
           05  PV-BYTE-COUNT-OFFER          PIC  9(04) VALUE ZERO.      00680011
           05  PV-SQL-SUB                   PIC  9(01) VALUE ZERO.      00690011
           05  PV-SPACE                     PIC  X(01).                 00700011
           05  PV-DISPLAY-INDEX             PIC S9(04) COMP.            00710011
                                                                        00720011
           05  PV-VARIABLE-OUTPUT-FIELD.                                00730011
               10  PV-BIT-VARIABLE          PIC X(01)                   00740011
                                                VALUE SPACES            00750011
                                                OCCURS 50 TIMES         00760011
                                                INDEXED BY              00770011
                                                PV-BIT-IDX              00780011
                                                PV-STR-IDX              00790011
                                                PV-EOF-IDX.             00800011
                                                                        00810011
           05  PV-VARIABLE-OUTPUT-CODE.                                 00820011
               10  PV-BIT-CODE              PIC X(01)                   00830011
                                                VALUE SPACES            00840011
                                                OCCURS 3 TIMES          00841011
                                                INDEXED BY              00841111
                                                PV-CDE-BIT-IDX          00841211
                                                PV-CDE-STR-IDX          00841311
                                                PV-CDE-EOF-IDX.         00841411
                                                                        00841511
           05  PV-VARIABLE-ID.                                          00841611
               10 PV-EFBM-VAR               PIC X(01)                   00841711
                                                VALUE SPACES            00841811
                                                OCCURS 10 TIMES         00841911
                                                INDEXED BY              00842011
                                                PV-EFBM-BIT-IDX         00842111
                                                PV-EFBM-IDX.            00842211
                                                                        00842311
           05  PV-ACCEPT-DATE               PIC 9(08).                  00842416
           05  PV-ACCEPT-DATE-REDEF REDEFINES PV-ACCEPT-DATE.           00842516
               10  PV-ACCEPT-YYYY           PIC X(04).                  00842716
               10  PV-ACCEPT-MO             PIC X(02).                  00842816
               10  PV-ACCEPT-DD             PIC X(02).                  00842916
           05  PV-ACCEPT-TIME               PIC 9(08).                  00843016
           05  PV-ACCEPT-TIME-REDEF REDEFINES PV-ACCEPT-TIME.           00843116
               10  PV-ACCEPT-HH             PIC X(02).                  00843216
               10  PV-ACCEPT-MM             PIC X(02).                  00843316
               10  PV-ACCEPT-SS             PIC X(02).                  00843416
               10  PV-ACCEPT-MS             PIC X(02).                  00843516
                                                                        00844416
           05  PV-SAVE-PREV-TIMESTAMP       PIC X(26) VALUE SPACES.     00844516
           05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.     00844616
           05  PV-CURRENT-TMST REDEFINES    PV-TIMESTAMP.               00844716
               10  PV-CURR-YYYY             PIC 9(04).                  00844816
               10  PV-CURR-DASH1            PIC X(01).                  00844916
               10  PV-CURR-MO               PIC 9(02).                  00845016
               10  PV-CURR-DASH2            PIC X(01).                  00845116
               10  PV-CURR-DD               PIC 9(02).                  00845216
               10  PV-CURR-DASH3            PIC X(01).                  00845316
               10  PV-CURR-HH               PIC 9(02).                  00845416
               10  PV-CURR-PERIOD1          PIC X(01).                  00845516
               10  PV-CURR-MM               PIC 9(02).                  00845616
               10  PV-CURR-PERIOD2          PIC X(01).                  00845716
               10  PV-CURR-SS               PIC 9(02).                  00845816
               10  PV-CURR-PERIOD3          PIC X(01).                  00845916
               10  PV-CURR-SSSSSS           PIC 9(06).                  00846016
                                                                        00847516
           05  PV-HEADER-TMST.                                          00847616
               10  PV-HEADER-YYYY           PIC 9(04)  VALUE ZERO.      00847716
               10  PV-HEADER-MO             PIC 9(02)  VALUE ZERO.      00847816
               10  PV-HEADER-DD             PIC 9(02)  VALUE ZERO.      00847916
               10  PV-HEADER-HH             PIC 9(02)  VALUE ZERO.      00848016
               10  PV-HEADER-MM             PIC 9(02)  VALUE ZERO.      00848116
               10  PV-HEADER-SS             PIC 9(02)  VALUE ZERO.      00848216
                                                                        00848318
           05  PV-FORMAT-TRIGGER-TYPE       PIC X(01).                  00848418
                                                                        00848516
           05  PV-FORMAT-HDR-DIST-DTE.                                  00848616
               10  PV-FORMAT-YYYY           PIC X(04).                  00848716
               10  PV-FORMAT-MO             PIC X(02).                  00848816
               10  PV-FORMAT-DD             PIC X(02).                  00848916
                                                                        00849016
           05  PV-FORMAT-EVNT-OFFR.                                     00849116
               10  PV-FORMAT-EVENT-ID       PIC 9(10).                  00849216
               10  PV-FORMAT-OFFER-ID       PIC 9(10).                  00849316
                                                                        00849416
           05  PV-EFF-WORK-DTE.                                         00849516
               10  PV-EFF-WORK-YYYY         PIC X(04).                  00849616
               10  PV-EFF-WORK-MM           PIC X(02).                  00849716
               10  PV-EFF-WORK-DD           PIC X(02).                  00849816
                                                                        00849916
           05  PV-FORMAT-EFFECTIVE-DTE.                                 00850016
               10  PV-EFFECT-YYYY           PIC X(04).                  00850116
               10  PV-EFFECT-DASH-1         PIC X(01) VALUE '-'.        00850216
               10  PV-EFFECT-MM             PIC X(02).                  00850316
               10  PV-EFFECT-DASH-2         PIC X(01) VALUE '-'.        00850416
               10  PV-EFFECT-DD             PIC X(02).                  00850516
               10  PV-EFFECT-SPCE-1         PIC X(01) VALUE ' '.        00850616
               10  PV-EFFECT-TIME           PIC X(08).                  00850716
                                                                        00850816
           05  PV-QUOTIENT                  PIC 9(04)  VALUE ZERO.      00850916
           05  PV-RMDR-4                    PIC 9(04)  VALUE ZERO.      00851016
           05  PV-RMDR-100                  PIC 9(04)  VALUE ZERO.      00851116
                                                                        00851216
      *----------------------------------------------------------       00851316
      * PV- PROGRAM COUNT VARIABLES                                     00851416
      *----------------------------------------------------------       00851516
       01  PV-PROGRAM-COUNTERS.                                         00851616
           05  PV-OFFER-WRITEN              PIC 9(09) VALUE 0.          00851716
           05  PV-OFFER-SECTION             PIC 9(09) VALUE 0.          00851816
           05  PV-OFFER-BWP                 PIC 9(09) VALUE 0.          00851916
           05  PV-OFFER-MDSE                PIC 9(09) VALUE 0.          00852016
           05  PV-OFFER-STORE               PIC 9(09) VALUE 0.          00852116
           05  PV-TOTAL-RECORDS-OUT         PIC 9(09) VALUE 0.          00852216
           05  PV-PIPE-COUNT                PIC 9(04) VALUE 0.          00852316
                                                                        00852416
      *----------------------------------------------------------------*00852516
      * PV- PROGRAM VARIABLES OFFER RANGE FOR A STORE                  *00852616
      *----------------------------------------------------------------*00852716
       01  PV-OFFER-RANGE.                                              00852816
           05  PV-BEGIN-OFR-ID              PIC 9(10).                  00852916
           05  PV-END-OFR-ID                PIC 9(10).                  00853016
           05  PV-STORE-NBR-RANGE           PIC 9(05).                  00853116
           05  PV-CURRENT-FILE-STORE        PIC 9(05).                  00853216
           05  PV-STR-GRP-TYP-CDE           PIC 9(05).                  00853316
           05  PV-STR-GRP-ID                PIC 9(05).                  00853416
                                                                        00853516
      *----------------------------------------------------------------*00853616
      * PV- PREVIOUS STORE LIST RECORD                                 *00853716
      *----------------------------------------------------------------*00853816
       01  PV-PREVIOUS-STRL-DATA.                                       00853911
           05  PV-STRL-EVNT-ID              PIC 9(10).                  00854011
           05  PV-STRL-OFR-ID               PIC 9(10).                  00854111
           05  PV-STRL-SECT-TYP-CDE         PIC X(01).                  00854211
           05  PV-STRL-GRP-ID               PIC 9(05).                  00854311
           05  PV-STRL-GRP-TYP-CDE          PIC 9(05).                  00854411
           05  PV-STRL-IE-IND               PIC X(01).                  00854511
           05  PV-STRL-STR-NBR              PIC 9(05).                  00854611
                                                                        00854711
      *----------------------------------------------------------------*00854811
      * PS- PROGRAM SWITCHES                                           *00854911
      *----------------------------------------------------------------*00855011
       01  PS-PROGRAM-SWITCHES.                                         00855111
           05  PS-END-OF-OFR-SW             PIC  X(01) VALUE 'N'.       00855211
               88  PS-END-OFR-FILE                     VALUE 'Y'.       00855311
               88  PS-NOT-END-OFR-FILE                 VALUE 'N'.       00855411
           05  PS-END-OF-SEC-SW             PIC  X(01) VALUE 'N'.       00855511
               88  PS-END-SEC-FILE                     VALUE 'Y'.       00855611
               88  PS-NOT-END-SEC-FILE                 VALUE 'N'.       00855711
           05  PS-END-OF-BWP-SW             PIC  X(01) VALUE 'N'.       00855811
               88  PS-END-BWP-FILE                     VALUE 'Y'.       00855911
               88  PS-NOT-END-BWP-FILE                 VALUE 'N'.       00856011
           05  PS-END-OF-MDSE-SW            PIC  X(01) VALUE 'N'.       00856111
               88  PS-END-OF-MDSE-FILE                 VALUE 'Y'.       00856211
               88  PS-NOT-END-OF-MDSE-FILE             VALUE 'N'.       00856311
           05  PS-END-OF-PROCES-SW          PIC  X(01) VALUE 'N'.       00856611
               88  PS-END-OF-PROCESSING                VALUE 'Y'.       00856711
               88  PS-NOT-END-OF-PROCESSING            VALUE 'N'.       00856811
                                                                        00856911
      * THESE SWITCHES ARE USED TO WRITE THE HEADER RECORDS             00857011
                                                                        00857111
           05  PS-OFFER-HDR-WRITEN-SW       PIC  X(01) VALUE 'N'.       00857211
               88 PS-OFFER-HDR-WRITEN                  VALUE 'Y'.       00857311
               88 PS-OFFER-HDR-NOT-WRITEN              VALUE 'N'.       00857411
           05  PS-SECTN-HDR-WRITEN-SW       PIC  X(01) VALUE 'N'.       00857511
               88 PS-SECTN-HDR-WRITEN                  VALUE 'Y'.       00857611
               88 PS-SECTN-HDR-NOT-WRITEN              VALUE 'N'.       00857711
           05  PS-BWP-HDR-WRITEN-SW         PIC  X(01) VALUE 'N'.       00857811
               88 PS-BWP-HDR-WRITEN                    VALUE 'Y'.       00857911
               88 PS-BWP-HDR-NOT-WRITEN                VALUE 'N'.       00858011
           05  PS-MDSE-HDR-WRITEN-SW        PIC  X(01) VALUE 'N'.       00858111
               88 PS-MDSE-HDR-WRITEN                   VALUE 'Y'.       00858211
               88 PS-MDSE-HDR-NOT-WRITEN               VALUE 'N'.       00858311
                                                                        00858411
      * THESE SWITCHES ARE USED TO DETERMINE IF OFFER IS IN RANGE.      00858511
                                                                        00858611
           05  PS-EP271-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00858711
               88 PS-EP271-OFR-INRANGE                 VALUE 'Y'.       00858811
               88 PS-EP271-OFR-NOT-INRANGE             VALUE 'N'.       00858911
           05  PS-EP272-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00859011
               88 PS-EP272-OFR-INRANGE                 VALUE 'Y'.       00859111
               88 PS-EP272-OFR-NOT-INRANGE             VALUE 'N'.       00859211
           05  PS-EP273-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00859311
               88 PS-EP273-OFR-INRANGE                 VALUE 'Y'.       00859411
               88 PS-EP273-OFR-NOT-INRANGE             VALUE 'N'.       00859511
           05  PS-EP274-OFR-RANGE-SW        PIC  X(01) VALUE 'N'.       00859611
               88 PS-EP274-OFR-INRANGE                 VALUE 'Y'.       00859711
               88 PS-EP274-OFR-NOT-INRANGE             VALUE 'N'.       00859811
                                                                        00859911
      *----------------------------------------------------------       00860011
      * CONTROL CARD EPCC252 LAYOUT                                     00860111
      *----------------------------------------------------------       00860211
      *    COPY EPRD252.                                                00860312
                                                                        00860411
      *----------------------------------------------------------       00860511
      * COPYBOOK  EPRD271 LAYOUT                                        00860611
      *----------------------------------------------------------       00860711
           COPY EPRD271.                                                00860811
                                                                        00860911
      *----------------------------------------------------------       00861011
      * COPYBOOK  EPRD272 LAYOUT                                        00862011
      *----------------------------------------------------------       00863011
           COPY EPRD272.                                                00864011
                                                                        00865011
      *----------------------------------------------------------       00866011
      * COPYBOOK  EPRD273 LAYOUT                                        00867011
      *----------------------------------------------------------       00868011
           COPY EPRD273.                                                00869011
                                                                        00870011
      *----------------------------------------------------------       00880011
      * COPYBOOK  EPRD274 LAYOUT                                        00890011
      *----------------------------------------------------------       00891011
           COPY EPRD274.                                                00892011
                                                                        00893011
      *----------------------------------------------------------       00894011
      * COPYBOOK  EPRD200 LAYOUT     (FOR HEADER RECORD)                00895011
      *----------------------------------------------------------       00896011
           COPY EPRD200.                                                00896111
                                                                        00896211
      *------------------------------------------------------------     00896811
      * VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         00896911
      *------------------------------------------------------------     00897011
           COPY DPWS004.                                                00898011
                                                                        00899011
      *----------------------------------------------------------       00966011
       PROCEDURE DIVISION.                                              00967011
      *----------------------------------------------------------       00968011
       0000-MAINLINE.                                                   00969011
                                                                        00970011
           PERFORM 1000-INITIALIZATION.                                 00980011
                                                                        00990011
           PERFORM 2000-PROCESS-OFFERS                                  01000011
                   UNTIL PS-END-OF-PROCESSING.                          01010011
                                                                        01020011
           PERFORM 9200-WRAPUP.                                         01030011
                                                                        01040011
           GOBACK.                                                      01050011
                                                                        01060011
      *----------------------------------------------------------       01070011
      * 1000-INITIALIZATION.                                            01080011
      *     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           01090011
      *     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      01100011
      *     FILES.                                                      01110011
      *----------------------------------------------------------       01120011
       1000-INITIALIZATION.                                             01130011
                                                                        01140011
           DISPLAY '****************************************'.          01150011
           DISPLAY '**          EPKUT226 STARTED          **'.          01160011
           DISPLAY '****************************************'.          01170011
                                                                        01180011
           INITIALIZE PV-PROGRAM-VARIABLES.                             01190011
                                                                        01200011
           INITIALIZE PV-OFFER-RANGE.                                   01210011
                                                                        01220011
           INITIALIZE PV-PREVIOUS-STRL-DATA.                            01230011
                                                                        01240011
           SET PS-NOT-END-OFR-FILE      TO TRUE.                        01250011
           SET PS-NOT-END-SEC-FILE      TO TRUE.                        01260011
           SET PS-NOT-END-BWP-FILE      TO TRUE.                        01270011
           SET PS-NOT-END-OF-MDSE-FILE  TO TRUE.                        01280011
                                                                        01300011
           PERFORM 1100-OPEN-FILES.                                     01310011
                                                                        01320011
           PERFORM 1200-GET-TIMESTAMP.                                  01330016
                                                                        01340011
           PERFORM 6100-READ-OFFER-DATA.                                01350911
                                                                        01351011
           IF PS-END-OFR-FILE                                           01352011
              DISPLAY '***    OFFERS FILE IS EMPTY    ****'             01353011
           ELSE                                                         01354011
              PERFORM 3100-GET-OFFER-RANGE                              01355011
              PERFORM 5100-DETERMINE-OFFER-INRANGE                      01356011
           END-IF.                                                      01357011
                                                                        01358011
           PERFORM 6200-READ-SECTN-DATA.                                01359011
                                                                        01360011
           IF PS-END-SEC-FILE                                           01370011
              DISPLAY '***    SECTION FILE IS EMPTY    ****'            01380011
           ELSE                                                         01390011
              PERFORM 5200-DETERMINE-SECTN-INRANGE                      01400011
           END-IF.                                                      01401011
                                                                        01402011
           PERFORM 6300-READ-BWP-DATA.                                  01403011
                                                                        01404011
           IF PS-END-BWP-FILE                                           01405011
              DISPLAY '***    BWP   FILE IS EMPTY    ****'              01406011
           ELSE                                                         01407011
              PERFORM 5300-DETERMINE-BWP-INRANGE                        01408011
           END-IF.                                                      01409011
                                                                        01410011
           PERFORM 6400-READ-MDSE-DATA.                                 01420011
                                                                        01430011
           IF PS-END-OF-MDSE-FILE                                       01440011
              DISPLAY '***    MDSE  FILE IS EMPTY    ****'              01440111
           ELSE                                                         01440211
              PERFORM 5400-DETERMINE-MDSE-INRANGE                       01440311
           END-IF.                                                      01440411
                                                                        01440511
           PERFORM 1300-DETERMINE-PROCESS.                              01440611
                                                                        01440711
      *----------------------------------------------------------       01440811
      * 1100-OPEN-FILES.                                                01440911
      *     THIS PARAGRAPH OPENS ALL THE FILES IN MODE REQUIRED         01441011
      *----------------------------------------------------------       01442011
       1100-OPEN-FILES.                                                 01443011
                                                                        01444011
           OPEN INPUT OFFERS-DATA-FILE                                  01445011
                      OFFERS-SECTION-FILE                               01446011
                      OFFERS-BWP-FILE                                   01447011
                      OFFERS-MDSE-FILE.                                 01448011
                                                                        01449011
                                                                        01460011
           OPEN OUTPUT FORMATTED-OFFERS-FILE.                           01470011
                                                                        01480011
      *----------------------------------------------------------       01490011
      * 1200-GET-TIMESTAMP.                                             01500016
      *     THIS PARAGRAPH BUILDS THE TIMESTAMP WHICH WILL BE           01510016
      *     USED TO UPDATE THE FILE-DIST-DATE AND THE CRT-TIMESTAMP     01520011
      *     ON THE HEADER RECORD (EPRD200).                             01521011
      *----------------------------------------------------------       01522011
       1200-GET-TIMESTAMP.                                              01523016
                                                                        01591016
           ACCEPT PV-ACCEPT-DATE FROM DATE YYYYMMDD.                    01592016
           ACCEPT PV-ACCEPT-TIME FROM TIME.                             01593016
                                                                        01594016
      *** FORMAT A STANDARD DB2 TIMESTAMP FROM DATE AND TIME            01594116
                                                                        01594216
           MOVE PV-ACCEPT-YYYY       TO PV-CURR-YYYY.                   01595016
           MOVE PV-ACCEPT-MO         TO PV-CURR-MO.                     01596016
           MOVE PV-ACCEPT-DD         TO PV-CURR-DD.                     01597016
           MOVE PV-ACCEPT-HH         TO PV-CURR-HH.                     01598016
           MOVE PV-ACCEPT-MM         TO PV-CURR-MM.                     01599016
           MOVE PV-ACCEPT-SS         TO PV-CURR-SS.                     01599116
           MOVE ZEROS                TO PV-CURR-SSSSSS.                 01599216
           MOVE '-'                  TO PV-CURR-DASH1                   01599316
                                        PV-CURR-DASH2                   01599416
                                        PV-CURR-DASH3.                  01599516
           MOVE '.'                  TO PV-CURR-PERIOD1                 01599616
                                        PV-CURR-PERIOD2                 01599716
                                        PV-CURR-PERIOD3.                01599816
           DISPLAY 'TIMESTAMP:  ' PV-TIMESTAMP.                         01599916
                                                                        01600011
      *** SET UP TIMESTAMP    INFORMATION FOR HEADER                    01610011
                                                                        01620011
           MOVE PV-CURR-YYYY         TO PV-HEADER-YYYY.                 01621011
                                                                        01621111
           MOVE PV-CURR-MO           TO PV-HEADER-MO.                   01621211
                                                                        01621311
           MOVE PV-CURR-DD           TO PV-HEADER-DD.                   01621411
                                                                        01621511
           MOVE PV-CURR-HH           TO PV-HEADER-HH.                   01621611
                                                                        01621711
           MOVE PV-CURR-MM           TO PV-HEADER-MM.                   01621811
                                                                        01621911
           MOVE PV-CURR-SS           TO PV-HEADER-SS.                   01622011
                                                                        01623011
      *** SET UP FILE DISTRIBUTION DATE FOR HEADER RECORD               01624011
                                                                        01625011
           MOVE PV-CURR-YYYY         TO PV-FORMAT-YYYY.                 01626011
                                                                        01627011
           MOVE PV-CURR-MO           TO PV-FORMAT-MO.                   01628016
                                                                        01629011
           MOVE PV-CURR-DD           TO PV-FORMAT-DD.                   01630011
                                                                        01630111
      *----------------------------------------------------------       01630211
      * 1300-DETERMINE-PROCESS                                          01630311
      *     THIS PARAGRAPH BASED ON THE READ FLAGS DETERMINES           01630411
      *     PROCESSING                                                  01630511
      *     - IF ALL THE INPUT FILES ARE EMPTY, DISPLAY AND END THE     01630611
      *       PROGRAM SUCCESSFULY                                       01630711
      *     - IF ALL THE INPUT FILES ARE NOT EMPTY, PROCESS FURTHER     01630811
      *     - IF STR LIST FILE IS EMPTY, BUT THE OTHER FOUR ARE NOT     01630911
      *       EMPTY PROCEED FURTHER, THIS CONDITION WILL ARISE WHEN     01631011
      *       THE FULL FILE IS BEING FORMATTED FOR A SINGLE STORE, TO   01632011
      *       GET THE OFR RANGE COMPLETE STORE LIST FILE IS BEING READ. 01633011
      *     - IF ONE OF THE INPUT FILES IS EPMTY, BUT THE OTHERS NOT    01634011
      *       THEN ABEND.                                               01635011
      *----------------------------------------------------------       01636011
       1300-DETERMINE-PROCESS.                                          01637011
                                                                        01638011
           EVALUATE TRUE                                                01639011
               WHEN   PS-END-OFR-FILE                                   01640011
                AND   PS-END-SEC-FILE                                   01641011
                AND   PS-END-BWP-FILE                                   01642011
                AND   PS-END-OF-MDSE-FILE                               01643011
                                                                        01645011
                     SET PS-END-OF-PROCESSING TO TRUE                   01646011
                                                                        01647011
               WHEN   PS-NOT-END-OFR-FILE                               01648011
                AND   PS-NOT-END-SEC-FILE                               01649011
                AND   PS-NOT-END-BWP-FILE                               01650011
                AND   PS-NOT-END-OF-MDSE-FILE                           01650111
                                                                        01650311
                     SET PS-NOT-END-OF-PROCESSING TO TRUE               01650411
                                                                        01651311
               WHEN OTHER                                               01651411
                                                                        01651511
                   DISPLAY '  '                                         01651611
                   DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA OTHER' 01651711
                   DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'          01651811
                   MOVE '1300-DETERMINE-PROCESS  ' TO PV-PARAGRAPH-NAME 01651911
                   SET AC-INPUT-FILE-EMPTY  TO TRUE                     01652011
                   PERFORM 9910-ABEND                                   01652111
                                                                        01652211
           END-EVALUATE.                                                01652311
                                                                        01652411
      *----------------------------------------------------------       01652511
      * 2000-PROCESS-OFFERS.                                            01652611
      * ----------------------------                                    01652711
      * WHEN THE PROCESSING REACHES THIS PARAGRAPH FOR THE FIRST TIME   01652811
      * IT ALREADY HAS THE OFFER RANGE FOR THE FIRST STORE, START       01652911
      * FORMATTING THE HEADERS FOR THE OFFERS IN FOLLOWING ORDER        01653011
      *                                                                 01654011
      * (1) FORMAT THE OFR_DT_FUL HEADER AND THEN WRITE ALL THE OFFERS  01655011
      *     DATA FOLLOWING IT FOR THE OFFER_ID RANGE.                   01656011
      *     (THIS WOULD ALSO INVOLVE READING THE OFFERS DATA FILE INP01)01657011
      *                                                                 01658011
      * (2) FORMAT THE OFR_RA_FUL HEADER AND THEN WRITE ALL THE OFFERS  01659011
      *     SECTION DATA FOLLOWING IT FOR THE OFFER_ID RANGE.           01660011
      *     (THIS WOULD ALSO INVOLVE READING THE OFFERS SECT FILE INP02)01670011
      *                                                                 01680011
      * (3) FORMAT THE OFR_BT_FUL HEADER AND THEN WRITE ALL THE OFFERS  01690011
      *     BWP DATA FOLLOWING IT FOR THE OFFER_ID RANGE.               01700011
      *     (THIS WOULD ALSO INVOLVE READING THE OFFERS BWP  FILE INP03)01710011
      *                                                                 01720011
      * (4) FORMAT THE OFR_MD_FUL HEADER AND THEN WRITE ALL THE OFFERS  01730011
      *     MDSE DATA FOLLOWING IT FOR THE OFFER_ID RANGE.              01740011
      *     (THIS WOULD ALSO INVOLVE READING THE OFFERS MDSE FILE INP04)01750011
      *                                                                 01760011
      * (5) READ THE STORE LIST FILE TO GET THE RANGE OF OFFERS         01770011
      *     FOR THE NEXT STORE.                                         01780011
      *     (THIS WOULD ALSO INVOLVE READING THE STORE LIST  FILE INP05)01790011
      *                                                                 01800011
      *----------------------------------------------------------       01810011
       2000-PROCESS-OFFERS.                                             01820011
                                                                        01830011
           MOVE ZERO            TO  PV-OFFER-WRITEN.                    01840011
                                                                        01850011
           MOVE ZERO            TO  PV-OFFER-SECTION.                   01860011
                                                                        01870011
           MOVE ZERO            TO  PV-OFFER-BWP.                       01880011
                                                                        01890011
           MOVE ZERO            TO  PV-OFFER-MDSE.                      01900011
                                                                        01910011
           PERFORM 3300-FORMAT-WRITE-OFFER-DATA UNTIL                   01920011
                PS-EP271-OFR-NOT-INRANGE OR                             01930011
                PS-END-OFR-FILE.                                        01940011
                                                                        01950011
           PERFORM 3400-FORMAT-WRITE-SECTN-DATA UNTIL                   01960011
                PS-EP272-OFR-NOT-INRANGE OR                             01970011
                PS-END-SEC-FILE.                                        01980011
                                                                        01990011
           PERFORM 3500-FORMAT-WRITE-BWP-DATA UNTIL                     02000011
                PS-EP273-OFR-NOT-INRANGE OR                             02010011
                PS-END-BWP-FILE.                                        02020011
                                                                        02030011
           PERFORM 3600-FORMAT-WRITE-MDSE-DATA UNTIL                    02040011
                PS-EP274-OFR-NOT-INRANGE OR                             02050011
                PS-END-OF-MDSE-FILE.                                    02060011
                                                                        02070011
           PERFORM 9920-DISPLAY-TOTALS.                                 02080011
                                                                        02090011
           IF PS-END-OFR-FILE     AND                                   02100011
              PS-END-SEC-FILE     AND                                   02110011
              PS-END-BWP-FILE     AND                                   02120011
              PS-END-OF-MDSE-FILE                                       02130011
              SET PS-END-OF-PROCESSING TO TRUE                          02160011
           ELSE                                                         02170011
              PERFORM 3100-GET-OFFER-RANGE                              02180011
              PERFORM 5100-DETERMINE-OFFER-INRANGE                      02190011
              PERFORM 5200-DETERMINE-SECTN-INRANGE                      02200011
              PERFORM 5300-DETERMINE-BWP-INRANGE                        02210011
              PERFORM 5400-DETERMINE-MDSE-INRANGE                       02220011
           END-IF.                                                      02230011
                                                                        02240011
      *-----------------------------------------------------------------02250011
      * 3100-GET-OFFER-RANGE.                                           02260011
      *  THIS PARAGRAPH WILL GET THE OFFER RANGE FOR A PARTICULAR STORE 02270011
      *  LATER THE PROGRAM USES THIS RANGE TO FORMAT THE HEADER AND '   02280011
      *  DETAIL RECORDS.                                                02290011
      *----------------------------------------------------------------*02300011
       3100-GET-OFFER-RANGE.                                            02310011
                                                                        02320011
           MOVE EP271-STR-GRP-TYP-CDE   TO PV-STR-GRP-TYP-CDE.          02350011
           MOVE EP271-STR-GRP-ID        TO PV-STR-GRP-ID.               02360011
                                                                        02370011
           DISPLAY '** BEGIN GROUP RANGE  ***'                          02371011
               PV-STR-GRP-TYP-CDE '  ' PV-STR-GRP-ID.                   02372011
           SET PS-OFFER-HDR-NOT-WRITEN TO TRUE.                         02373011
           SET PS-SECTN-HDR-NOT-WRITEN TO TRUE.                         02374011
           SET PS-BWP-HDR-NOT-WRITEN TO TRUE.                           02375011
           SET PS-MDSE-HDR-NOT-WRITEN TO TRUE.                          02376011
                                                                        02376111
                                                                        02383111
      *-----------------------------------------------------------------02383211
      * 3300-FORMAT-WRITE-OFFER-DATA                                    02383311
      *  THIS PARAGRAPH WILL DO THE FOLLOWING                           02383411
      *  (1) WRITE FORMATTED HEADER RECORDS (OFR_DT_FUL)                02383511
      *  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02383611
      *  (3) READ THE OFFERS DATA FILE FOR NEXT RECORD                  02383711
      *----------------------------------------------------------------*02383811
       3300-FORMAT-WRITE-OFFER-DATA.                                    02383911
                                                                        02384011
           IF PS-OFFER-HDR-NOT-WRITEN                                   02384111
              SET EP200-XST-OFFER TO TRUE                               02384211
              PERFORM 4100-FORMAT-AND-WRITE-HDR                         02384311
              SET PS-OFFER-HDR-WRITEN TO TRUE                           02384411
           END-IF.                                                      02384511
                                                                        02384611
           SET FORM-OFR-LEN                                             02384711
             TO +1.                                                     02384811
           MOVE 0 TO  PV-BYTE-COUNT.                                    02384911
           INITIALIZE FORMATTED-OFFERS-RECORD.                          02385011
                                                                        02385111
           PERFORM 6900-MOVE-DELIMITER.                                 02385211
           MOVE EP271-TRIGGER-TYPE TO PV-FORMAT-TRIGGER-TYPE.           02385318
           PERFORM 4250-MOVE-TRIGGER-TYPE.                              02385411
                                                                        02385511
           MOVE EP271-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02385611
           MOVE EP271-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02385711
                                                                        02385811
           PERFORM 4300-MOVE-EVENT-OFR-ID.                              02385911
           PERFORM 4350-MOVE-REST-OFFER-DATA.                           02386011
           PERFORM 4200-WRITE-DATA-RECORD.                              02386111
                                                                        02386211
           ADD 1 TO PV-OFFER-WRITEN.                                    02386311
                                                                        02386411
           PERFORM 6100-READ-OFFER-DATA.                                02386511
                                                                        02386611
           IF PS-NOT-END-OFR-FILE                                       02386711
              PERFORM 5100-DETERMINE-OFFER-INRANGE                      02386811
           END-IF.                                                      02386911
                                                                        02387011
      *-----------------------------------------------------------------02387111
      * 3400-FORMAT-WRITE-SECTN-DATA                                    02388011
      *  THIS PARAGRAPH WILL DO THE FOLLOWING                           02388111
      *  (1) WRITE FORMATTED HEADER RECORD (OFR_RA_FUL)                 02388211
      *  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02388311
      *  (3) READ THE OFFERS SECTION FILE FOR NEXT RECORD               02388411
      *----------------------------------------------------------------*02388511
       3400-FORMAT-WRITE-SECTN-DATA.                                    02388611
                                                                        02388711
           IF PS-SECTN-HDR-NOT-WRITEN                                   02388811
              SET EP200-XST-OFR-SECT TO TRUE                            02388911
              PERFORM 4100-FORMAT-AND-WRITE-HDR                         02389011
              SET PS-SECTN-HDR-WRITEN TO TRUE                           02389111
           END-IF.                                                      02389211
                                                                        02389311
           SET FORM-OFR-LEN                                             02389411
             TO +1.                                                     02389511
           MOVE 0 TO  PV-BYTE-COUNT.                                    02389611
           INITIALIZE FORMATTED-OFFERS-RECORD.                          02389711
                                                                        02389811
           PERFORM 6900-MOVE-DELIMITER.                                 02389911
           MOVE EP272-TRIGGER-TYPE TO PV-FORMAT-TRIGGER-TYPE.           02390018
           PERFORM 4250-MOVE-TRIGGER-TYPE.                              02390111
                                                                        02390211
           MOVE EP272-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02390311
           MOVE EP272-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02390411
                                                                        02390511
           PERFORM 4300-MOVE-EVENT-OFR-ID.                              02390611
           PERFORM 4400-MOVE-REST-SECTION-DATA.                         02390711
                                                                        02390811
           PERFORM 4200-WRITE-DATA-RECORD.                              02390911
                                                                        02391011
           ADD 1 TO PV-OFFER-SECTION.                                   02391111
                                                                        02391211
           PERFORM 6200-READ-SECTN-DATA.                                02391311
                                                                        02391411
           IF PS-NOT-END-SEC-FILE                                       02391511
              PERFORM 5200-DETERMINE-SECTN-INRANGE                      02391611
           END-IF.                                                      02391711
                                                                        02391811
      *-----------------------------------------------------------------02391911
      * 3500-FORMAT-WRITE-BWP-DATA                                      02392011
      *  THIS PARAGRAPH WILL DO THE FOLLOWING                           02392111
      *  (1) WRITE FORMATTED HEADER RECORD (OFR_BT_FUL)                 02392211
      *  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02392311
      *  (3) READ THE OFFERS BWP FILE FOR NEXT RECORD                   02392411
      *----------------------------------------------------------------*02392511
       3500-FORMAT-WRITE-BWP-DATA.                                      02392611
                                                                        02392711
           IF PS-BWP-HDR-NOT-WRITEN                                     02392811
              SET EP200-XST-OFR-BWP TO TRUE                             02392911
              PERFORM 4100-FORMAT-AND-WRITE-HDR                         02393011
              SET PS-BWP-HDR-WRITEN TO TRUE                             02393111
           END-IF.                                                      02393211
                                                                        02393311
           SET FORM-OFR-LEN                                             02393411
             TO +1.                                                     02393511
           MOVE 0 TO  PV-BYTE-COUNT.                                    02393611
           INITIALIZE FORMATTED-OFFERS-RECORD.                          02393711
                                                                        02393811
           PERFORM 6900-MOVE-DELIMITER.                                 02393911
           MOVE EP273-TRIGGER-TYPE TO PV-FORMAT-TRIGGER-TYPE.           02394018
           PERFORM 4250-MOVE-TRIGGER-TYPE.                              02394111
                                                                        02394211
           MOVE EP273-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02394311
           MOVE EP273-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02394411
                                                                        02394511
           PERFORM 4300-MOVE-EVENT-OFR-ID.                              02394611
           PERFORM 4450-MOVE-REST-BWP-DATA.                             02394711
                                                                        02394811
           PERFORM 4200-WRITE-DATA-RECORD.                              02394911
                                                                        02395011
           ADD 1 TO PV-OFFER-BWP.                                       02395111
                                                                        02395211
           PERFORM 6300-READ-BWP-DATA.                                  02395311
                                                                        02395411
           IF  PS-NOT-END-BWP-FILE                                      02395511
              PERFORM 5300-DETERMINE-BWP-INRANGE                        02395611
           END-IF.                                                      02395711
                                                                        02395811
      *-----------------------------------------------------------------02395911
      * 3600-FORMAT-WRITE-MDSE-DATA                                     02396011
      *  THIS PARAGRAPH WILL DO THE FOLLOWING                           02396111
      *  (1) WRITE FORMATTED HEADER RECORD (OFR_MD_FUL)                 02396211
      *  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   02396311
      *  (3) READ THE OFFERS MDSE FILE FOR NEXT RECORD                  02396411
      *----------------------------------------------------------------*02396511
       3600-FORMAT-WRITE-MDSE-DATA.                                     02396611
                                                                        02396711
           IF PS-MDSE-HDR-NOT-WRITEN                                    02396811
              SET EP200-XST-OFR-MDSE-SET TO TRUE                        02396911
              PERFORM 4100-FORMAT-AND-WRITE-HDR                         02397011
              SET PS-MDSE-HDR-WRITEN TO TRUE                            02397111
           END-IF.                                                      02397211
                                                                        02397311
           SET FORM-OFR-LEN                                             02397411
             TO 1.                                                      02397511
           MOVE 0 TO  PV-BYTE-COUNT.                                    02397611
           INITIALIZE FORMATTED-OFFERS-RECORD.                          02397711
                                                                        02397811
           PERFORM 6900-MOVE-DELIMITER.                                 02397911
           MOVE EP274-TRIGGER-TYPE TO PV-FORMAT-TRIGGER-TYPE.           02398018
           PERFORM 4250-MOVE-TRIGGER-TYPE.                              02398111
                                                                        02398211
           MOVE EP274-EVENT-ID TO PV-FORMAT-EVENT-ID.                   02398311
           MOVE EP274-OFFER-ID TO PV-FORMAT-OFFER-ID.                   02398411
                                                                        02398511
           PERFORM 4300-MOVE-EVENT-OFR-ID.                              02398611
           PERFORM 4500-MOVE-REST-MDSE-DATA.                            02398711
                                                                        02398811
           PERFORM 4200-WRITE-DATA-RECORD.                              02398911
                                                                        02399011
           ADD 1 TO PV-OFFER-MDSE.                                      02399111
                                                                        02399211
           PERFORM 6400-READ-MDSE-DATA.                                 02399311
                                                                        02399411
           IF PS-NOT-END-OF-MDSE-FILE                                   02399511
              PERFORM 5400-DETERMINE-MDSE-INRANGE                       02399611
           END-IF.                                                      02399711
                                                                        02399811
      *-----------------------------------------------------------------02399911
      * 4100-FORMAT-AND-WRITE-HDR                                       02400011
      *  THIS PARAGRAPH MOVES APPROPRIATE VALUES TO THE EPRD200 COPYBOOK02400111
      *  LAYOUT (BEFORE WRITING OUT THE HEADER RECORD)                  02400211
      *----------------------------------------------------------------*02400311
       4100-FORMAT-AND-WRITE-HDR.                                       02401011
                                                                        02401111
           MOVE PC-HDR-IND             TO EP200-HDR-INDICATOR.          02401211
           MOVE PV-STR-GRP-TYP-CDE     TO EP200-STR-GRP-TYP.            02401411
           MOVE PC-FIVE-ZERO           TO EP200-STR-GRP-EXCP-IND.       02401511
           MOVE PV-STR-GRP-ID          TO EP200-STR-GRP-ID-STR-LOC.     02401711
           MOVE PV-FORMAT-HDR-DIST-DTE TO EP200-FILE-DIST-DATE.         02401811
           MOVE PC-OFR-IND             TO EP200-FILE-NAME-OFFER.        02401911
           MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-1.           02402011
           MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-2.           02403011
           MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-3.           02403111
           MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-4.           02403211
           MOVE PC-UNDER-SCORE         TO EP200-UNDERSCORE-5.           02403311
           SET EP200-FILE-NAME-CHG TO TRUE.                             02403511
           MOVE PC-FIVE-ZERO           TO EP200-STORE-NBR.              02403711
           MOVE PV-HEADER-TMST         TO EP200-CRT-TIMESTAMP.          02403811
           MOVE 'C'                    TO EP200-FILE-TYPE-APPLY.        02403911
                                                                        02404011
           PERFORM 4150-WRITE-HDR-RECORD.                               02404111
                                                                        02404211
      *-----------------------------------------------------------------02404311
      * 4150-WRITE-HDR-RECORD                                           02404411
      *  THIS PARAGRAPH WILL WRITE THE HEADER RECORD TO THE O/P FILE    02404511
      *-----------------------------------------------------------------02404611
       4150-WRITE-HDR-RECORD.                                           02404711
                                                                        02404811
           PERFORM 5000-INCR-HEADER-TIMESTAMP.                          02404911
                                                                        02405011
           MOVE 64                                                      02405111
             TO PV-BYTE-COUNT.                                          02405211
           WRITE FORMATTED-OFFERS-RECORD                                02405311
             FROM EP200-OFFER-HEADER-RECORD.                            02405411
                                                                        02405511
      *-----------------------------------------------------------------02405611
      * 4200-WRITE-DATA-RECORD                                          02405711
      *  THIS PARAGRAPH WILL WRITE THE DATA RECORD TO THE O/P FILE      02405811
      *-----------------------------------------------------------------02405911
       4200-WRITE-DATA-RECORD.                                          02406011
                                                                        02406111
           WRITE FORMATTED-OFFERS-RECORD.                               02406211
                                                                        02406311
      *-----------------------------------------------------------------02406411
      * 4250-MOVE-TRIGGER-TYPE                                          02406511
      *  THIS PARAGRAPH WILL MOVE 'A' TO THE OUTPUT FILE VARIABLE       02406611
      *----------------------------------------------------------------*02406711
       4250-MOVE-TRIGGER-TYPE.                                          02406811
                                                                        02406911
           MOVE PV-FORMAT-TRIGGER-TYPE                                  02407018
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             02407211
           SET FORM-OFR-LEN                                             02407311
             UP BY +1.                                                  02407411
           ADD 1                                                        02407511
             TO PV-BYTE-COUNT.                                          02407611
           PERFORM 6900-MOVE-DELIMITER.                                 02407711
                                                                        02407811
      *----------------------------------------------------------       02407911
      * 4300-MOVE-EVENT-OFR-ID.                                         02408011
      *     THIS PARAGRAPH MOVES THE EVENT ID AND THE OFR ID TO         02408111
      *     THE OUTPUT FIELD VARIABLE                                   02409011
      *----------------------------------------------------------       02409111
       4300-MOVE-EVENT-OFR-ID.                                          02409211
                                                                        02409311
      * FORMATTING EVNT_ID                                              02409411
           INITIALIZE PV-VARIABLE-ID                                    02409511
                      PV-TALLY.                                         02409611
                                                                        02409711
           INSPECT PV-FORMAT-EVENT-ID TALLYING PV-TALLY                 02409811
               FOR LEADING ZEROES.                                      02409911
           SET PV-EFBM-IDX TO PV-TALLY.                                 02410011
           SET PV-EFBM-IDX UP BY +1.                                    02410111
           MOVE PV-FORMAT-EVENT-ID TO  PV-VARIABLE-ID.                  02410211
                                                                        02410311
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02410411
              FROM PV-EFBM-IDX BY 1                                     02410511
             UNTIL PV-EFBM-BIT-IDX > 10.                                02410611
                                                                        02410711
           PERFORM 6900-MOVE-DELIMITER.                                 02410811
                                                                        02410911
                                                                        02411011
      * FORMATTING OFR_ID                                               02411111
           INITIALIZE PV-VARIABLE-ID                                    02411211
                      PV-TALLY.                                         02411311
                                                                        02411411
           INSPECT PV-FORMAT-OFFER-ID TALLYING PV-TALLY                 02411511
               FOR LEADING ZEROES.                                      02411611
           SET PV-EFBM-IDX TO PV-TALLY.                                 02411711
           SET PV-EFBM-IDX UP BY +1.                                    02411811
           MOVE PV-FORMAT-OFFER-ID TO  PV-VARIABLE-ID.                  02411911
                                                                        02412011
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02412111
              FROM PV-EFBM-IDX BY 1                                     02412211
             UNTIL PV-EFBM-BIT-IDX > 10.                                02412311
                                                                        02412411
           PERFORM 6900-MOVE-DELIMITER.                                 02412511
                                                                        02412611
      *----------------------------------------------------------       02412711
      * 4350-MOVE-REST-OFFER-DATA.                                      02412811
      *      THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM      02412911
      *      EPRD201 COPYBOOK TO THE VARIABLE OUTPUT RECORD             02413011
      *----------------------------------------------------------       02413111
       4350-MOVE-REST-OFFER-DATA.                                       02413211
                                                                        02413311
      *-------  MOVE PROMO-SCHM-CDE --------(NOT NULL)-----*******      02413411
                                                                        02413511
           INITIALIZE PV-VARIABLE-ID                                    02413611
                      PV-TALLY.                                         02413711
                                                                        02413811
           MOVE EP271-PROMO-SCHM-CDE  TO PV-VARIABLE-ID.                02413911
                                                                        02414011
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02414111
              FROM 1 BY 1                                               02414211
             UNTIL PV-EFBM-BIT-IDX > 4.                                 02414311
                                                                        02414411
           PERFORM 6900-MOVE-DELIMITER.                                 02414511
      *-------  MOVE EVENT-TYP-CDE --------(NOT NULL)-----*******       02414611
                                                                        02414711
           INITIALIZE PV-VARIABLE-ID                                    02414811
                      PV-TALLY.                                         02414911
                                                                        02415011
           MOVE EP271-EVENT-TYP-CODE  TO PV-VARIABLE-ID.                02415111
                                                                        02415211
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02415311
              FROM 1 BY 1                                               02415411
             UNTIL PV-EFBM-BIT-IDX > 2.                                 02415511
                                                                        02415611
           PERFORM 6900-MOVE-DELIMITER.                                 02415711
      *-------  MOVE EVENT-NAME    --------(NOT NULL)-----*******       02415811
                                                                        02415911
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02416011
                      PV-TALLY.                                         02416111
                                                                        02416211
           IF EP271-EVENT-NAME = SPACES                                 02416311
              PERFORM 6800-MOVE-SPACE                                   02416411
           ELSE                                                         02416511
              MOVE EP271-EVENT-NAME      TO PV-VARIABLE-OUTPUT-FIELD    02416611
              PERFORM 6600-FIND-DATA-END                                02416711
                VARYING PV-EOF-IDX                                      02416811
                   FROM 50 BY -1                                        02416911
                   UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02417011
              PERFORM 6650-FIELD-MOVER                                  02417111
                VARYING PV-BIT-IDX                                      02417211
                   FROM 1 BY 1                                          02417311
                   UNTIL PV-BIT-IDX > PV-EOF-IDX                        02417411
                                                                        02417511
              PERFORM 6900-MOVE-DELIMITER                               02417611
           END-IF.                                                      02417711
                                                                        02417811
      *-------  MOVE OFFER-NAME    --------(NOT NULL)-----*******       02417911
                                                                        02418011
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02418111
                      PV-TALLY.                                         02418211
                                                                        02418311
           IF EP271-OFFER-NAME = SPACES                                 02418411
              PERFORM 6800-MOVE-SPACE                                   02418511
           ELSE                                                         02418611
              MOVE EP271-OFFER-NAME      TO PV-VARIABLE-OUTPUT-FIELD    02418711
              PERFORM 6600-FIND-DATA-END                                02418811
                VARYING PV-EOF-IDX                                      02418911
                   FROM 50 BY -1                                        02419011
                   UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02419111
              PERFORM 6650-FIELD-MOVER                                  02419211
                VARYING PV-BIT-IDX                                      02419311
                   FROM 1 BY 1                                          02419411
                   UNTIL PV-BIT-IDX > PV-EOF-IDX                        02419511
                                                                        02419611
              PERFORM 6900-MOVE-DELIMITER                               02419711
           END-IF.                                                      02419811
                                                                        02419911
      *-------  MOVE DISC-LEVEL-CODE-------(NOT NULL)-----*******       02420011
                                                                        02420111
           INITIALIZE PV-VARIABLE-ID                                    02420211
                      PV-TALLY.                                         02420311
                                                                        02420411
           MOVE EP271-DISC-LEVEL-CODE  TO PV-VARIABLE-ID.               02420511
                                                                        02420611
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02420711
              FROM 1 BY 1                                               02420811
             UNTIL PV-EFBM-BIT-IDX > 3.                                 02420911
                                                                        02421011
           PERFORM 6900-MOVE-DELIMITER.                                 02421111
                                                                        02421211
      *-------  MOVE OFFER-USAGE-TYPE-CODE -(NOT NULL)-----*******      02421311
                                                                        02421411
           INITIALIZE PV-VARIABLE-ID                                    02421511
                      PV-TALLY.                                         02421611
                                                                        02421711
           MOVE EP271-OFFER-USAGE-TYPE-CODE TO PV-VARIABLE-ID.          02421811
                                                                        02421911
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02422011
              FROM 1 BY 1                                               02422111
             UNTIL PV-EFBM-BIT-IDX > 3.                                 02422211
                                                                        02422311
           PERFORM 6900-MOVE-DELIMITER.                                 02422411
                                                                        02422511
      *-------  MOVE BARCODE-TYPE-CODE------(NOT NULL)-----*******      02422611
                                                                        02422711
           INITIALIZE PV-VARIABLE-ID                                    02422811
                      PV-TALLY.                                         02422911
                                                                        02423011
           MOVE EP271-BARCODE-TYPE-CODE     TO PV-VARIABLE-ID.          02423111
                                                                        02423211
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02423311
              FROM 1 BY 1                                               02423411
             UNTIL PV-EFBM-BIT-IDX > 1.                                 02423511
                                                                        02423611
           PERFORM 6900-MOVE-DELIMITER.                                 02423711
                                                                        02423811
      *-------  MOVE UNEARN-IND ------------(NOT NULL)-----*******      02423911
                                                                        02424011
           INITIALIZE PV-VARIABLE-ID                                    02424111
                      PV-TALLY.                                         02424211
                                                                        02424311
           MOVE EP271-UNEARN-IND            TO PV-VARIABLE-ID.          02424411
                                                                        02424511
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02424611
              FROM 1 BY 1                                               02424711
             UNTIL PV-EFBM-BIT-IDX > 1.                                 02424811
                                                                        02424911
           PERFORM 6900-MOVE-DELIMITER.                                 02425011
                                                                        02425111
      *-------  MOVE OFR-TRGR-TYP-CDE-------(NOT NULL)-----*******      02425211
                                                                        02425311
           INITIALIZE PV-VARIABLE-ID                                    02425411
                      PV-TALLY.                                         02425511
                                                                        02425611
           MOVE EP271-OFR-TRGR-TYP-CDE      TO PV-VARIABLE-ID.          02425711
                                                                        02425811
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02425911
              FROM 1 BY 1                                               02426011
             UNTIL PV-EFBM-BIT-IDX > 3.                                 02426111
                                                                        02426211
           PERFORM 6900-MOVE-DELIMITER.                                 02426311
                                                                        02426411
      *-------  MOVE BWP-ITM-APPL-CDE-----------(NULL)-----*******      02426511
                                                                        02426611
           INITIALIZE PV-VARIABLE-ID                                    02426711
                      PV-TALLY.                                         02426811
                                                                        02426911
           EVALUATE TRUE                                                02427011
               WHEN EP271-BWP-ITM-APPL-CDE = '~'                        02427111
                    PERFORM 6850-MOVE-NULL-VALUE                        02427211
               WHEN EP271-BWP-ITM-APPL-CDE = SPACES                     02427311
                    PERFORM 6800-MOVE-SPACE                             02427411
               WHEN OTHER                                               02427511
                    MOVE EP271-BWP-ITM-APPL-CDE      TO PV-VARIABLE-ID  02427611
                                                                        02427711
                    PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02427811
                       FROM 1 BY 1                                      02427911
                       UNTIL PV-EFBM-BIT-IDX > 2                        02428011
                                                                        02428111
                    PERFORM 6900-MOVE-DELIMITER                         02428211
           END-EVALUATE.                                                02428311
                                                                        02428411
      *----------------------------------------------------------       02428511
      * 4400-MOVE-REST-SECTION-DATA.                                    02428611
      *     THIS PARAGRAPH FORMATS AND MOVES THE DATA FILEDS FROM       02428711
      *     EPRD202 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02428811
      *----------------------------------------------------------       02428911
       4400-MOVE-REST-SECTION-DATA.                                     02429011
                                                                        02429111
      *-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02429211
                                                                        02429311
           INITIALIZE PV-VARIABLE-ID                                    02429411
                      PV-TALLY.                                         02429511
                                                                        02429611
           MOVE EP272-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02429711
                                                                        02429811
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02429911
              FROM 1 BY 1                                               02430011
             UNTIL PV-EFBM-BIT-IDX > 1.                                 02430111
                                                                        02430211
           PERFORM 6900-MOVE-DELIMITER.                                 02430311
                                                                        02430411
      *-------  MOVE EFF-BEG-DATE-----------(NOT NULL)-----*******      02430511
                                                                        02430611
           INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02430711
                      PV-EFF-WORK-DTE.                                  02430811
                                                                        02430911
           MOVE EP272-EFF-BEG-DTE           TO PV-EFF-WORK-DTE.         02431011
                                                                        02431111
           MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          02431211
           MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            02431311
           MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            02431411
           MOVE PC-TIME-START               TO PV-EFFECT-TIME.          02431511
           MOVE PC-DASH                     TO PV-EFFECT-DASH-1.        02431611
           MOVE PC-DASH                     TO PV-EFFECT-DASH-2.        02431711
                                                                        02431811
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02431911
           MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02432011
                                                                        02432111
           PERFORM 6600-FIND-DATA-END                                   02432211
             VARYING PV-EOF-IDX                                         02432311
               FROM 50 BY -1                                            02432411
                 UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02432511
           PERFORM 6650-FIELD-MOVER                                     02432611
             VARYING PV-BIT-IDX                                         02432711
               FROM 1 BY 1                                              02432811
                 UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02432911
                                                                        02433011
           PERFORM 6900-MOVE-DELIMITER.                                 02433111
                                                                        02433211
      *-------  MOVE EFF-END-DATE-----------(NOT NULL)-----*******      02433311
                                                                        02433411
           INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02433511
                      PV-EFF-WORK-DTE.                                  02433611
                                                                        02433711
           MOVE EP272-EFF-END-DTE           TO PV-EFF-WORK-DTE.         02433811
                                                                        02433911
           MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          02434011
           MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            02434111
           MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            02434211
           MOVE PC-TIME-END                 TO PV-EFFECT-TIME.          02434311
           MOVE PC-DASH                     TO PV-EFFECT-DASH-1.        02434411
           MOVE PC-DASH                     TO PV-EFFECT-DASH-2.        02434511
                                                                        02434611
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02434711
           MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02434811
                                                                        02434911
           PERFORM 6600-FIND-DATA-END                                   02435011
             VARYING PV-EOF-IDX                                         02435111
               FROM 50 BY -1                                            02435211
                 UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02435311
           PERFORM 6650-FIELD-MOVER                                     02435411
             VARYING PV-BIT-IDX                                         02435511
               FROM 1 BY 1                                              02435611
                 UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02435711
                                                                        02435811
           PERFORM 6900-MOVE-DELIMITER.                                 02435911
                                                                        02436011
      *-------  MOVE REDMN-SUPVR-OVERRID-DTE (NOT NULL)-----*******     02436111
                                                                        02436211
           INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           02436311
                      PV-EFF-WORK-DTE.                                  02436411
                                                                        02436511
           MOVE EP272-REDMN-SUPVR-OVRRID-DTE TO PV-EFF-WORK-DTE.        02436611
                                                                        02436711
           MOVE PV-EFF-WORK-YYYY             TO PV-EFFECT-YYYY.         02436811
           MOVE PV-EFF-WORK-MM               TO PV-EFFECT-MM.           02436911
           MOVE PV-EFF-WORK-DD               TO PV-EFFECT-DD.           02437011
           MOVE PC-TIME-END                  TO PV-EFFECT-TIME.         02437111
           MOVE PC-DASH                      TO PV-EFFECT-DASH-1.       02437211
           MOVE PC-DASH                      TO PV-EFFECT-DASH-2.       02437311
                                                                        02437411
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         02437511
           MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   02437611
                                                                        02437711
           PERFORM 6600-FIND-DATA-END                                   02437811
             VARYING PV-EOF-IDX                                         02437911
               FROM 50 BY -1                                            02438011
                 UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         02438111
           PERFORM 6650-FIELD-MOVER                                     02438211
             VARYING PV-BIT-IDX                                         02438311
               FROM 1 BY 1                                              02438411
                 UNTIL PV-BIT-IDX > PV-EOF-IDX.                         02438511
                                                                        02438611
           PERFORM 6900-MOVE-DELIMITER.                                 02438711
                                                                        02438811
      *-------  MOVE BWP-GET-CNCTR-CDE------(NOT NULL)-----*******      02438911
                                                                        02439011
           INITIALIZE PV-VARIABLE-ID                                    02439111
                      PV-TALLY.                                         02439211
                                                                        02439311
           MOVE EP272-BWP-GET-CNCTR-CDE    TO PV-VARIABLE-ID.           02439411
                                                                        02439511
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02439611
              FROM 1 BY 1                                               02439711
             UNTIL PV-EFBM-BIT-IDX > 3 OR                               02439811
                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02439911
                                                                        02440011
           PERFORM 6900-MOVE-DELIMITER.                                 02440111
                                                                        02440211
      *-------  MOVE BWP-BUY-CNCTR-CDE------(NOT NULL)-----*******      02440311
                                                                        02440411
           INITIALIZE PV-VARIABLE-ID                                    02440511
                      PV-TALLY.                                         02440611
                                                                        02440711
           MOVE EP272-BWP-BUY-CNCTR-CDE         TO PV-VARIABLE-ID.      02440811
                                                                        02440911
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02441011
              FROM 1 BY 1                                               02441111
             UNTIL PV-EFBM-BIT-IDX > 3 OR                               02441211
                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02441311
                                                                        02441411
           PERFORM 6900-MOVE-DELIMITER.                                 02441511
                                                                        02441611
      *-------  MOVE CUSTFACG-SHRT-DESC----(NOT NULL)-----*******       02441711
                                                                        02441811
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02441911
                      PV-TALLY.                                         02442011
                                                                        02442111
           IF EP272-CUSTFACG-SHRT-DESC = SPACES                         02442211
              PERFORM 6800-MOVE-SPACE                                   02442311
           ELSE                                                         02442411
              MOVE EP272-CUSTFACG-SHRT-DESC  TO PV-VARIABLE-OUTPUT-FIELD02442511
              PERFORM 6600-FIND-DATA-END                                02442611
                VARYING PV-EOF-IDX                                      02442711
                   FROM 50 BY -1                                        02442811
                   UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        02442911
              PERFORM 6650-FIELD-MOVER                                  02443011
                VARYING PV-BIT-IDX                                      02443111
                   FROM 1 BY 1                                          02443211
                   UNTIL PV-BIT-IDX > PV-EOF-IDX                        02443311
                                                                        02443411
              PERFORM 6900-MOVE-DELIMITER                               02443511
           END-IF.                                                      02443611
                                                                        02443711
      *-------  MOVE POS-BTN-TXT --------------(NULL)-----*******       02443811
                                                                        02443911
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          02444011
                      PV-TALLY.                                         02444111
           EVALUATE TRUE                                                02444211
               WHEN EP272-POS-BTN-TXT = '~'                             02444311
                  PERFORM 6850-MOVE-NULL-VALUE                          02444411
               WHEN EP272-POS-BTN-TXT = SPACES                          02444511
                  PERFORM 6800-MOVE-SPACE                               02444611
               WHEN OTHER                                               02444711
                  MOVE EP272-POS-BTN-TXT    TO PV-VARIABLE-OUTPUT-FIELD 02444811
                  PERFORM 6600-FIND-DATA-END                            02444911
                     VARYING PV-EOF-IDX                                 02445011
                       FROM 50 BY -1                                    02445111
                       UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE    02445211
                  PERFORM 6650-FIELD-MOVER                              02445311
                     VARYING PV-BIT-IDX                                 02445411
                     FROM 1 BY 1                                        02445511
                     UNTIL PV-BIT-IDX > PV-EOF-IDX                      02445611
                                                                        02445711
                  PERFORM 6900-MOVE-DELIMITER                           02445811
           END-EVALUATE.                                                02445911
                                                                        02446011
      *-------  MOVE VLD-POS-TNDR-CMP-TYP-CDE (NOT NULL)-----*******    02446111
                                                                        02446211
           INITIALIZE PV-VARIABLE-ID                                    02446311
                      PV-TALLY.                                         02446411
                                                                        02446511
           MOVE EP272-VLD-POS-TNDR-CMP-TYP-CDE TO PV-VARIABLE-ID.       02446611
                                                                        02446711
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02446811
              FROM 1 BY 1                                               02446911
             UNTIL PV-EFBM-BIT-IDX > 3 OR                               02447011
                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    02447111
                                                                        02447211
           PERFORM 6900-MOVE-DELIMITER.                                 02447311
                                                                        02447411
      *-------  MOVE POS-BTN-RLTV-SEQ-NBR --------(NULL)-----*******    02447511
                                                                        02447611
           INITIALIZE PV-VARIABLE-ID                                    02447711
                      PV-TALLY.                                         02447811
                                                                        02447911
           EVALUATE TRUE                                                02448011
               WHEN EP272-POS-BTN-RLTV-SEQ-NBR-X = '~'                  02448111
                    PERFORM 6850-MOVE-NULL-VALUE                        02448211
               WHEN EP272-POS-BTN-RLTV-SEQ-NBR = ZEROES                 02448311
                    PERFORM 6700-MOVE-ZERO                              02448411
               WHEN OTHER                                               02448511
                                                                        02448611
                    INSPECT EP272-POS-BTN-RLTV-SEQ-NBR TALLYING PV-TALLY02448711
                        FOR LEADING ZEROES                              02448811
                    SET PV-EFBM-IDX TO PV-TALLY                         02448911
                    SET PV-EFBM-IDX UP BY +1                            02449011
                    MOVE EP272-POS-BTN-RLTV-SEQ-NBR TO PV-VARIABLE-ID   02449111
                                                                        02449211
                    PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02449311
                       FROM PV-EFBM-IDX BY 1                            02449411
                       UNTIL PV-EFBM-BIT-IDX > 10  OR                   02449511
                       PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '               02449611
                                                                        02449711
                    PERFORM 6900-MOVE-DELIMITER                         02449811
           END-EVALUATE.                                                02449911
                                                                        02450011
      *-------  MOVE LMT-PER-TRN-QTY -------------(NULL)-----*******    02450111
                                                                        02450211
           INITIALIZE PV-VARIABLE-ID                                    02450311
                      PV-TALLY.                                         02450411
                                                                        02450511
           EVALUATE TRUE                                                02450611
               WHEN EP272-LMT-PER-TRN-QTY-X = '~'                       02450711
                    PERFORM 6850-MOVE-NULL-VALUE                        02450811
               WHEN EP272-LMT-PER-TRN-QTY = ZEROES                      02450911
                    PERFORM 6700-MOVE-ZERO                              02451011
               WHEN OTHER                                               02451111
                    INSPECT EP272-LMT-PER-TRN-QTY TALLYING PV-TALLY     02451211
                        FOR LEADING ZEROES                              02451311
                    SET PV-EFBM-IDX TO PV-TALLY                         02451411
                    SET PV-EFBM-IDX UP BY +1                            02451511
                                                                        02451611
                    MOVE EP272-LMT-PER-TRN-QTY TO PV-VARIABLE-ID        02451711
                                                                        02451811
                    PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   02451911
                       FROM PV-EFBM-IDX BY 1                            02452011
                       UNTIL PV-EFBM-BIT-IDX > 10 OR                    02452111
                           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '           02452211
                                                                        02452311
                    PERFORM 6900-MOVE-DELIMITER                         02452411
           END-EVALUATE.                                                02452511
                                                                        02452611
      *----------------------------------------------------------       02452711
      * 4450-MOVE-REST-BWP-DATA.                                        02452811
      *     THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM       02452911
      *     EPRD203 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02453011
      *----------------------------------------------------------       02454011
       4450-MOVE-REST-BWP-DATA.                                         02454111
                                                                        02454211
      *-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02454311
                                                                        02454411
           INITIALIZE PV-VARIABLE-ID                                    02454511
                      PV-TALLY.                                         02454611
                                                                        02454711
           MOVE EP273-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02454811
                                                                        02454911
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02455011
              FROM 1 BY 1                                               02455111
             UNTIL PV-EFBM-BIT-IDX > 1.                                 02455211
                                                                        02455311
           PERFORM 6900-MOVE-DELIMITER.                                 02455411
                                                                        02455511
      *-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      02455611
                                                                        02455711
           INITIALIZE PV-VARIABLE-ID                                    02455811
                      PV-TALLY.                                         02455911
                                                                        02456011
           INSPECT EP273-OFR-SECT-BWP-ID TALLYING PV-TALLY              02456111
               FOR LEADING ZEROES.                                      02456211
           SET PV-EFBM-IDX TO PV-TALLY.                                 02456311
           SET PV-EFBM-IDX UP BY +1.                                    02456411
           MOVE EP273-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                02456511
                                                                        02456611
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02456711
              FROM PV-EFBM-IDX BY 1                                     02456811
             UNTIL PV-EFBM-BIT-IDX > 10.                                02456911
                                                                        02457011
           PERFORM 6900-MOVE-DELIMITER.                                 02457111
                                                                        02457211
      *-------  MOVE TIER-LVL-NBR    -------(NOT NULL)-----*******      02457311
                                                                        02457411
           INITIALIZE PV-VARIABLE-ID                                    02457511
                      PV-TALLY.                                         02457611
           IF EP273-TIER-LVL-NBR = ZEROES                               02457711
              PERFORM 6700-MOVE-ZERO                                    02457811
           ELSE                                                         02457911
              INSPECT EP273-TIER-LVL-NBR TALLYING PV-TALLY              02458011
                  FOR LEADING ZEROES                                    02458111
              SET PV-EFBM-IDX TO PV-TALLY                               02458211
              SET PV-EFBM-IDX UP BY +1                                  02458311
              MOVE EP273-TIER-LVL-NBR    TO PV-VARIABLE-ID              02458411
                                                                        02458511
              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX         02458611
                 FROM PV-EFBM-IDX BY 1                                  02458711
                 UNTIL PV-EFBM-BIT-IDX > 10 OR                          02458811
                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                     02458911
                                                                        02459011
              PERFORM 6900-MOVE-DELIMITER                               02459111
           END-IF.                                                      02459211
                                                                        02459311
      *-------  MOVE BWP-SELN-TYP-CDE-------(NOT NULL)-----*******      02459411
                                                                        02459511
           INITIALIZE PV-VARIABLE-ID                                    02459611
                      PV-TALLY.                                         02459711
                                                                        02459811
           MOVE EP273-BWP-SELN-TYP-CDE      TO PV-VARIABLE-ID.          02459911
                                                                        02460011
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02460111
              FROM 1 BY 1                                               02460211
             UNTIL PV-EFBM-BIT-IDX > 3 OR                               02460311
             PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                        02460411
                                                                        02460511
           PERFORM 6900-MOVE-DELIMITER.                                 02460611
                                                                        02460711
      *-------  MOVE BWP-BUY-QTY ---------------(NULL)-----*******      02460811
                                                                        02460911
           INITIALIZE PV-VARIABLE-ID                                    02461011
                      PV-TALLY.                                         02461111
           EVALUATE TRUE                                                02461211
               WHEN EP273-BWP-BUY-QTY-X = '~'                           02461311
                   PERFORM 6850-MOVE-NULL-VALUE                         02461411
               WHEN EP273-BWP-BUY-QTY = ZEROES                          02461511
                   PERFORM 6700-MOVE-ZERO                               02461611
               WHEN OTHER                                               02461711
                   INSPECT EP273-BWP-BUY-QTY  TALLYING PV-TALLY         02461811
                       FOR LEADING ZEROES                               02461911
                   SET PV-EFBM-IDX TO PV-TALLY                          02462011
                   SET PV-EFBM-IDX UP BY +1                             02462111
                   MOVE EP273-BWP-BUY-QTY     TO PV-VARIABLE-ID         02462211
                                                                        02462311
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02462411
                      FROM PV-EFBM-IDX BY 1                             02462511
                      UNTIL PV-EFBM-BIT-IDX > 10 OR                     02462611
                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                02462711
                                                                        02462811
                   PERFORM 6900-MOVE-DELIMITER                          02462911
           END-EVALUATE.                                                02463011
                                                                        02463111
      *-------  MOVE BWP-BUY-AMT ---------------(NULL)-----*******      02463211
                                                                        02463311
           INITIALIZE PV-VARIABLE-ID                                    02463411
                      PV-TALLY.                                         02463511
           EVALUATE TRUE                                                02463611
               WHEN EP273-BWP-BUY-AMT-X = '~'                           02463711
                   PERFORM 6850-MOVE-NULL-VALUE                         02463811
               WHEN EP273-BWP-BUY-AMT = ZEROES                          02463911
                   MOVE '.00'                 TO PV-VARIABLE-ID         02464011
                                                                        02464111
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02464211
                      FROM 1 BY 1                                       02464311
                      UNTIL PV-EFBM-BIT-IDX > 3                         02464411
                                                                        02464511
                   PERFORM 6900-MOVE-DELIMITER                          02464611
               WHEN OTHER                                               02464711
                   INSPECT EP273-BWP-BUY-AMT  TALLYING PV-TALLY         02464811
                       FOR LEADING ZEROES                               02464911
                   SET PV-EFBM-IDX TO PV-TALLY                          02465011
                                                                        02465111
                   EVALUATE TRUE                                        02465211
                                                                        02465311
                      WHEN PV-EFBM-IDX < 7                              02465411
                         SET PV-EFBM-IDX UP BY +1                       02465511
                      WHEN PV-EFBM-IDX = 8                              02465611
                         SET PV-EFBM-IDX DOWN BY +1                     02465711
                                                                        02465811
                   END-EVALUATE                                         02465911
                                                                        02466011
                   MOVE EP273-BWP-BUY-AMT     TO PV-VARIABLE-ID         02466111
                                                                        02466211
                   PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02466311
                      FROM PV-EFBM-IDX BY 1                             02466411
                      UNTIL PV-EFBM-BIT-IDX > 10 OR                     02466511
                        PV-EFBM-VAR(PV-EFBM-BIT-IDX)  = ' '             02466611
                                                                        02466711
                   PERFORM 6900-MOVE-DELIMITER                          02466811
           END-EVALUATE.                                                02466911
                                                                        02467011
      *-------  MOVE BWP-BUY-TOL-AMT -----------(NULL)-----*******      02467111
                                                                        02467211
           INITIALIZE PV-VARIABLE-ID                                    02467311
                      PV-TALLY.                                         02467411
           EVALUATE TRUE                                                02467511
               WHEN EP273-BWP-BUY-TOL-AMT-X = '~'                       02467611
                   PERFORM 6850-MOVE-NULL-VALUE                         02467711
               WHEN EP273-BWP-BUY-TOL-AMT = ZEROES                      02467811
                   MOVE '.00'                 TO PV-VARIABLE-ID         02467911
                                                                        02468011
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02468111
                      FROM 1 BY 1                                       02468211
                      UNTIL PV-EFBM-BIT-IDX > 3                         02468311
                   PERFORM 6900-MOVE-DELIMITER                          02468411
                                                                        02468511
               WHEN OTHER                                               02468611
                   INSPECT EP273-BWP-BUY-TOL-AMT  TALLYING PV-TALLY     02468711
                       FOR LEADING ZEROES                               02468811
                   SET PV-EFBM-IDX TO PV-TALLY                          02468911
                                                                        02469011
                   EVALUATE TRUE                                        02469111
                                                                        02469211
                      WHEN PV-EFBM-IDX < 7                              02469311
                         SET PV-EFBM-IDX UP BY +1                       02469411
                      WHEN PV-EFBM-IDX = 8                              02469511
                         SET PV-EFBM-IDX DOWN BY +1                     02469611
                                                                        02469711
                   END-EVALUATE                                         02469811
                                                                        02469911
                   MOVE EP273-BWP-BUY-TOL-AMT     TO PV-VARIABLE-ID     02470011
                                                                        02470111
                   PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02470211
                      FROM PV-EFBM-IDX BY 1                             02470311
                      UNTIL PV-EFBM-BIT-IDX > 10  OR                    02470411
                         PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '             02470511
                                                                        02470611
                   PERFORM 6900-MOVE-DELIMITER                          02470711
           END-EVALUATE.                                                02470811
                                                                        02470911
      *-------  MOVE BWP-GET-QTY ---------------(NULL)-----*******      02471011
                                                                        02471111
           INITIALIZE PV-VARIABLE-ID                                    02471211
                      PV-TALLY.                                         02471311
           EVALUATE TRUE                                                02471411
               WHEN EP273-BWP-GET-QTY-X = '~'                           02471511
                   PERFORM 6850-MOVE-NULL-VALUE                         02471611
               WHEN EP273-BWP-GET-QTY = ZEROES                          02471711
                   PERFORM 6700-MOVE-ZERO                               02471811
               WHEN OTHER                                               02471911
                   INSPECT EP273-BWP-GET-QTY  TALLYING PV-TALLY         02472011
                       FOR LEADING ZEROES                               02472111
                   SET PV-EFBM-IDX TO PV-TALLY                          02472211
                   SET PV-EFBM-IDX UP BY +1                             02472311
                   MOVE EP273-BWP-GET-QTY     TO PV-VARIABLE-ID         02472411
                                                                        02472511
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02472611
                      FROM PV-EFBM-IDX BY 1                             02472711
                      UNTIL PV-EFBM-BIT-IDX > 10 OR                     02472811
                        PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02472911
                                                                        02473011
                   PERFORM 6900-MOVE-DELIMITER                          02473111
           END-EVALUATE.                                                02473211
                                                                        02473311
      *-------  MOVE GET-PCT-OFF-PCT------------(NULL)-----*******      02473411
                                                                        02473511
           INITIALIZE PV-VARIABLE-ID                                    02473611
                      PV-TALLY.                                         02473711
           EVALUATE TRUE                                                02473811
               WHEN EP273-BWP-GET-PCT-OFF-PCT-X = '~'                   02473911
                   PERFORM 6850-MOVE-NULL-VALUE                         02474011
               WHEN EP273-BWP-GET-PCT-OFF-PCT = ZEROES                  02474111
                   PERFORM 6700-MOVE-ZERO                               02474211
               WHEN OTHER                                               02474311
                   INSPECT EP273-BWP-GET-PCT-OFF-PCT  TALLYING PV-TALLY 02474411
                       FOR LEADING ZEROES                               02474511
                   SET PV-EFBM-IDX TO PV-TALLY                          02474611
                   SET PV-EFBM-IDX UP BY +1                             02474711
                   MOVE EP273-BWP-GET-PCT-OFF-PCT TO PV-VARIABLE-ID     02474811
                                                                        02474911
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02475011
                      FROM PV-EFBM-IDX BY 1                             02475111
                      UNTIL PV-EFBM-BIT-IDX > 10 OR                     02475211
                        PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02475311
                                                                        02475411
                   PERFORM 6900-MOVE-DELIMITER                          02475511
           END-EVALUATE.                                                02475611
                                                                        02475711
      *-------  MOVE GET-DOL-OFF-AMT------------(NULL)-----*******      02475811
                                                                        02475911
           INITIALIZE PV-VARIABLE-ID                                    02476011
                      PV-TALLY.                                         02476111
           EVALUATE TRUE                                                02476211
               WHEN EP273-BWP-GET-DOL-OFF-AMT-X = '~'                   02476311
                   PERFORM 6850-MOVE-NULL-VALUE                         02476411
               WHEN EP273-BWP-GET-DOL-OFF-AMT = ZEROES                  02476511
                   PERFORM 6700-MOVE-ZERO                               02476611
               WHEN OTHER                                               02476711
                   INSPECT EP273-BWP-GET-DOL-OFF-AMT  TALLYING PV-TALLY 02476811
                       FOR LEADING ZEROES                               02476911
                   SET PV-EFBM-IDX TO PV-TALLY                          02477011
                                                                        02477111
                   EVALUATE TRUE                                        02477211
                                                                        02477311
                      WHEN PV-EFBM-IDX < 7                              02477411
                         SET PV-EFBM-IDX UP BY +1                       02477511
                      WHEN PV-EFBM-IDX = 8                              02477611
                         SET PV-EFBM-IDX DOWN BY +1                     02477711
                                                                        02477811
                   END-EVALUATE                                         02477911
                                                                        02478011
                   MOVE EP273-BWP-GET-DOL-OFF-AMT TO PV-VARIABLE-ID     02478111
                                                                        02478211
                   PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02478311
                      FROM PV-EFBM-IDX BY 1                             02478411
                      UNTIL PV-EFBM-BIT-IDX > 10  OR                    02478511
                        PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02478611
                                                                        02478711
                   PERFORM 6900-MOVE-DELIMITER                          02478811
           END-EVALUATE.                                                02478911
                                                                        02479011
      *-------  MOVE GET-PRPT-AMT --------------(NULL)-----*******      02479111
                                                                        02479211
           INITIALIZE PV-VARIABLE-ID                                    02479311
                      PV-TALLY.                                         02479411
           EVALUATE TRUE                                                02479511
               WHEN EP273-BWP-GET-PRPT-AMT-X = '~'                      02479611
                   PERFORM 6850-MOVE-NULL-VALUE                         02479711
               WHEN EP273-BWP-GET-PRPT-AMT = ZEROES                     02479811
                   PERFORM 6700-MOVE-ZERO                               02479911
               WHEN OTHER                                               02480011
                   INSPECT EP273-BWP-GET-PRPT-AMT  TALLYING PV-TALLY    02480111
                       FOR LEADING ZEROES                               02480211
                   SET PV-EFBM-IDX TO PV-TALLY                          02480311
                                                                        02480411
                   EVALUATE TRUE                                        02480511
                                                                        02480611
                      WHEN PV-EFBM-IDX < 7                              02480711
                         SET PV-EFBM-IDX UP BY +1                       02480811
                      WHEN PV-EFBM-IDX = 8                              02480911
                         SET PV-EFBM-IDX DOWN BY +1                     02481011
                                                                        02481111
                   END-EVALUATE                                         02481211
                                                                        02481311
                   MOVE EP273-BWP-GET-PRPT-AMT TO PV-VARIABLE-ID        02481411
                                                                        02481511
                   PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX02481611
                      FROM PV-EFBM-IDX BY 1                             02481711
                      UNTIL PV-EFBM-BIT-IDX > 10 OR                     02481811
                        PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              02481911
                                                                        02482011
                   PERFORM 6900-MOVE-DELIMITER                          02482111
           END-EVALUATE.                                                02482211
                                                                        02482311
                                                                        02482411
      *----------------------------------------------------------       02482511
      * 4500-MOVE-REST-MDSE-DATA.                                       02482611
      *     THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM       02482711
      *     EPRD204 COPYBOOK TO THE VARIABLE OUTPUT RECORD              02482811
      *----------------------------------------------------------       02482911
       4500-MOVE-REST-MDSE-DATA.                                        02483011
                                                                        02483111
      *-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      02483211
                                                                        02483311
           INITIALIZE PV-VARIABLE-ID                                    02483411
                      PV-TALLY.                                         02483511
                                                                        02483611
           MOVE EP274-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          02483719
                                                                        02483811
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02483911
              FROM 1 BY 1                                               02484011
             UNTIL PV-EFBM-BIT-IDX > 1.                                 02484111
                                                                        02484211
           PERFORM 6900-MOVE-DELIMITER.                                 02484311
                                                                        02484411
      *-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      02484511
                                                                        02484611
           INITIALIZE PV-VARIABLE-ID                                    02484711
                      PV-TALLY.                                         02484811
                                                                        02484911
           INSPECT EP274-OFR-SECT-BWP-ID TALLYING PV-TALLY              02485011
               FOR LEADING ZEROES.                                      02485111
           SET PV-EFBM-IDX TO PV-TALLY.                                 02485211
           SET PV-EFBM-IDX UP BY +1.                                    02485311
           MOVE EP274-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                02485411
                                                                        02485511
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02485611
              FROM PV-EFBM-IDX BY 1                                     02485711
             UNTIL PV-EFBM-BIT-IDX > 10.                                02485811
                                                                        02485911
           PERFORM 6900-MOVE-DELIMITER.                                 02486011
                                                                        02486111
      *-------  MOVE OFR-SECT-MDSE-SET-ID --(NOT NULL)-----*******      02486211
                                                                        02486311
           INITIALIZE PV-VARIABLE-ID                                    02486411
                      PV-TALLY.                                         02486511
                                                                        02486611
           INSPECT EP274-MDSE-SET-ID TALLYING PV-TALLY                  02486711
               FOR LEADING ZEROES.                                      02486811
           SET PV-EFBM-IDX TO PV-TALLY.                                 02486911
           SET PV-EFBM-IDX UP BY +1.                                    02487011
           MOVE EP274-MDSE-SET-ID TO PV-VARIABLE-ID.                    02487111
                                                                        02487211
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02487311
              FROM PV-EFBM-IDX BY 1                                     02487411
             UNTIL PV-EFBM-BIT-IDX > 10.                                02487511
                                                                        02487611
           PERFORM 6900-MOVE-DELIMITER.                                 02487711
                                                                        02487811
      *-------  MOVE MDSE-HIER-CDE ---------(NOT NULL)-----*******      02487911
                                                                        02488011
           INITIALIZE PV-VARIABLE-ID                                    02488111
                      PV-TALLY.                                         02488211
                                                                        02488311
           MOVE EP274-MDSE-HIER-CDE TO PV-VARIABLE-ID.                  02488411
                                                                        02488511
           PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            02488611
              FROM 1 BY 1                                               02488711
             UNTIL PV-EFBM-BIT-IDX > 3 OR                               02488811
                   PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE.                02488911
                                                                        02489011
           PERFORM 6900-MOVE-DELIMITER.                                 02490011
                                                                        02500011
      *-------  MOVE DEPT-NBR ------------------(NULL)-----*******      02510011
                                                                        02520011
           INITIALIZE PV-VARIABLE-ID                                    02530011
                      PV-TALLY.                                         02540011
           EVALUATE TRUE                                                02550011
               WHEN EP274-DEPT-NBR-X = '~'                              02560011
                   PERFORM 6850-MOVE-NULL-VALUE                         02570011
               WHEN EP274-DEPT-NBR   = ZEROES                           02580011
                   PERFORM 6700-MOVE-ZERO                               02590011
               WHEN OTHER                                               02600011
                   INSPECT EP274-DEPT-NBR  TALLYING PV-TALLY            02610011
                       FOR LEADING ZEROES                               02620011
                   SET PV-EFBM-IDX TO PV-TALLY                          02630011
                   SET PV-EFBM-IDX UP BY +1                             02640011
                   MOVE EP274-DEPT-NBR TO PV-VARIABLE-ID                02641011
                                                                        02642011
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02643011
                      FROM PV-EFBM-IDX BY 1                             02644011
                      UNTIL PV-EFBM-BIT-IDX > 4 OR                      02645011
                            PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02646011
                                                                        02647011
                   PERFORM 6900-MOVE-DELIMITER                          02648011
           END-EVALUATE.                                                02649011
                                                                        02650011
      *-------  MOVE MAJ-CL-NBR ----------------(NULL)-----*******      02651011
                                                                        02652011
           INITIALIZE PV-VARIABLE-ID                                    02653011
                      PV-TALLY.                                         02653111
           EVALUATE TRUE                                                02653211
               WHEN EP274-MAJ-CL-NBR-X = '~'                            02653311
                   PERFORM 6850-MOVE-NULL-VALUE                         02653411
               WHEN EP274-MAJ-CL-NBR = ZEROES                           02653511
                   PERFORM 6700-MOVE-ZERO                               02653611
               WHEN OTHER                                               02653711
                   INSPECT EP274-MAJ-CL-NBR  TALLYING PV-TALLY          02653811
                       FOR LEADING ZEROES                               02653911
                   SET PV-EFBM-IDX TO PV-TALLY                          02654011
                   SET PV-EFBM-IDX UP BY +1                             02654111
                   MOVE EP274-MAJ-CL-NBR TO PV-VARIABLE-ID              02654211
                                                                        02654311
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02654411
                      FROM PV-EFBM-IDX BY 1                             02654511
                      UNTIL PV-EFBM-BIT-IDX > 4 OR                      02654611
                            PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02654711
                                                                        02654811
                   PERFORM 6900-MOVE-DELIMITER                          02654911
           END-EVALUATE.                                                02655011
                                                                        02655111
      *-------  MOVE SUB-CL-NBR ----------------(NULL)-----*******      02655211
                                                                        02655311
           INITIALIZE PV-VARIABLE-ID                                    02655411
                      PV-TALLY.                                         02655511
           EVALUATE TRUE                                                02655611
               WHEN EP274-SUB-CL-NBR-X = '~'                            02655711
                   PERFORM 6850-MOVE-NULL-VALUE                         02655811
               WHEN EP274-SUB-CL-NBR = ZEROES                           02655911
                   PERFORM 6700-MOVE-ZERO                               02656011
               WHEN OTHER                                               02656111
                   INSPECT EP274-SUB-CL-NBR  TALLYING PV-TALLY          02656211
                       FOR LEADING ZEROES                               02656311
                   SET PV-EFBM-IDX TO PV-TALLY                          02656411
                   SET PV-EFBM-IDX UP BY +1                             02656511
                   MOVE EP274-SUB-CL-NBR TO PV-VARIABLE-ID              02656611
                                                                        02656711
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02656811
                      FROM PV-EFBM-IDX BY 1                             02656911
                      UNTIL PV-EFBM-BIT-IDX > 4 OR                      02657011
                            PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02657111
                                                                        02657211
                   PERFORM 6900-MOVE-DELIMITER                          02657311
           END-EVALUATE.                                                02657411
                                                                        02657511
      *-------  MOVE STYL-ID -- ----------------(NULL)-----*******      02657611
                                                                        02657711
           INITIALIZE PV-VARIABLE-ID                                    02657811
                      PV-TALLY.                                         02657911
           EVALUATE TRUE                                                02658011
               WHEN EP274-STYL-ID-X = '~'                               02658111
                   PERFORM 6850-MOVE-NULL-VALUE                         02658211
               WHEN EP274-STYL-ID = ZEROES                              02658311
                   PERFORM 6700-MOVE-ZERO                               02658411
               WHEN OTHER                                               02658511
                   INSPECT EP274-STYL-ID     TALLYING PV-TALLY          02658611
                       FOR LEADING ZEROES                               02658711
                   SET PV-EFBM-IDX TO PV-TALLY                          02658811
                   SET PV-EFBM-IDX UP BY +1                             02658911
                   MOVE EP274-STYL-ID    TO PV-VARIABLE-ID              02659011
                                                                        02659111
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02659211
                      FROM PV-EFBM-IDX BY 1                             02659311
                      UNTIL PV-EFBM-BIT-IDX > 8 OR                      02659411
                            PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02659511
                                                                        02659611
                   PERFORM 6900-MOVE-DELIMITER                          02659711
           END-EVALUATE.                                                02659811
                                                                        02659911
      *-------  MOVE SKU-NBR -------------------(NULL)-----*******      02660011
                                                                        02660111
           INITIALIZE PV-VARIABLE-ID                                    02660211
                      PV-TALLY.                                         02660311
           EVALUATE TRUE                                                02660411
               WHEN EP274-SKU-NBR-X = '~'                               02660511
                   PERFORM 6850-MOVE-NULL-VALUE                         02660611
               WHEN EP274-SKU-NBR = ZEROES                              02660711
                   PERFORM 6700-MOVE-ZERO                               02660811
               WHEN OTHER                                               02660911
                   INSPECT EP274-SKU-NBR     TALLYING PV-TALLY          02661011
                       FOR LEADING ZEROES                               02661111
                   SET PV-EFBM-IDX TO PV-TALLY                          02661211
                   SET PV-EFBM-IDX UP BY +1                             02661311
                   MOVE EP274-SKU-NBR    TO PV-VARIABLE-ID              02661411
                                                                        02661511
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02661611
                      FROM PV-EFBM-IDX BY 1                             02661711
                      UNTIL PV-EFBM-BIT-IDX > 8 OR                      02661811
                            PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        02661911
                                                                        02662011
                   PERFORM 6900-MOVE-DELIMITER                          02662111
           END-EVALUATE.                                                02662211
                                                                        02662311
      *-------  MOVE IE-IND  ---------------(NOT NULL)-----*******      02662411
                                                                        02662511
           INITIALIZE PV-VARIABLE-ID                                    02662611
                      PV-TALLY.                                         02662711
           EVALUATE TRUE                                                02662811
               WHEN EP274-IE-IND = SPACES                               02662911
                   PERFORM 6800-MOVE-SPACE                              02663011
               WHEN OTHER                                               02663111
                   MOVE EP274-IE-IND     TO PV-VARIABLE-ID              02663211
                                                                        02663311
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02663411
                      FROM 1 BY 1                                       02663511
                      UNTIL PV-EFBM-BIT-IDX > 1                         02663611
                                                                        02663711
                   PERFORM 6900-MOVE-DELIMITER                          02663811
           END-EVALUATE.                                                02663911
                                                                        02664011
      *-------  MOVE EMP-DISC-CDE --------------(NULL)-----*******      02664111
                                                                        02664211
           INITIALIZE PV-VARIABLE-ID                                    02664311
                      PV-TALLY.                                         02664411
           EVALUATE TRUE                                                02664511
               WHEN EP274-EMP-DISC-CDE = '~'                            02664611
                   PERFORM 6850-MOVE-NULL-VALUE                         02664711
               WHEN EP274-EMP-DISC-CDE = SPACES                         02664811
                   PERFORM 6800-MOVE-SPACE                              02664911
               WHEN OTHER                                               02665011
                   MOVE EP274-EMP-DISC-CDE     TO PV-VARIABLE-ID        02665111
                                                                        02665211
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02665311
                      FROM 1 BY 1                                       02665411
                      UNTIL PV-EFBM-BIT-IDX > 1                         02665511
                                                                        02665611
                   PERFORM 6900-MOVE-DELIMITER                          02665711
           END-EVALUATE.                                                02665811
                                                                        02665911
      *-------  MOVE DISC-ELIG-IND--------------(NULL)-----*******      02666011
                                                                        02666111
           INITIALIZE PV-VARIABLE-ID                                    02666211
                      PV-TALLY.                                         02666311
           EVALUATE TRUE                                                02666411
               WHEN EP274-DISC-ELIG-IND = '~'                           02666511
                   PERFORM 6850-MOVE-NULL-VALUE                         02666611
               WHEN EP274-DISC-ELIG-IND = SPACES                        02666711
                   PERFORM 6800-MOVE-SPACE                              02666811
               WHEN OTHER                                               02666911
                   MOVE EP274-DISC-ELIG-IND    TO PV-VARIABLE-ID        02667011
                                                                        02668011
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02669011
                      FROM 1 BY 1                                       02669111
                      UNTIL PV-EFBM-BIT-IDX > 1                         02669211
                                                                        02669311
                   PERFORM 6900-MOVE-DELIMITER                          02669411
           END-EVALUATE.                                                02669511
                                                                        02669611
      *-------  MOVE TKT-CLOR-CDE --------------(NULL)-----*******      02669711
                                                                        02669811
           INITIALIZE PV-VARIABLE-ID                                    02669911
                      PV-TALLY.                                         02670011
           EVALUATE TRUE                                                02671011
               WHEN EP274-TKT-CLOR-CDE  = '~'                           02672011
                   PERFORM 6850-MOVE-NULL-VALUE                         02673011
               WHEN EP274-TKT-CLOR-CDE  = SPACES                        02674011
                   PERFORM 6800-MOVE-SPACE                              02675011
               WHEN OTHER                                               02676011
                   MOVE EP274-TKT-CLOR-CDE     TO PV-VARIABLE-ID        02677011
                                                                        02678011
                   PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    02679011
                      FROM 1 BY 1                                       02679111
                      UNTIL PV-EFBM-BIT-IDX > 1                         02679211
                                                                        02679311
                   PERFORM 6900-MOVE-DELIMITER                          02679411
           END-EVALUATE.                                                02679511
                                                                        02679611
                                                                        02679711
      *-------------------------------------------------------------    02679811
      * 5000-INCR-HEADER-TIMESTAMP.                                     02679911
      *     THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND     02680011
      *     THIS WOULD ENSURE THE HEADER RECORDS TO BE 1 SECOND APART   02690011
      *     WHICH IS MID-TIER REQUIREMENT.                              02700011
      *-------------------------------------------------------------    02710011
       5000-INCR-HEADER-TIMESTAMP.                                      02720011
                                                                        02730011
           ADD 1                                                        02740011
             TO PV-HEADER-SS.                                           02750011
           IF PV-HEADER-SS GREATER 59                                   02760011
               MOVE ZERO                                                02770011
                 TO PV-HEADER-SS                                        02780011
               ADD 1                                                    02790011
                 TO PV-HEADER-MM                                        02800011
           END-IF.                                                      02810011
                                                                        02820011
           IF PV-HEADER-MM GREATER 59                                   02830011
               MOVE ZERO                                                02840011
                 TO PV-HEADER-MM                                        02850011
               ADD 1                                                    02860011
                 TO PV-HEADER-HH                                        02870011
           END-IF.                                                      02880011
                                                                        02890011
           IF PV-HEADER-HH GREATER 23                                   02900011
               MOVE ZERO                                                02910011
                 TO PV-HEADER-HH                                        02920011
               ADD 1                                                    02930011
                 TO PV-HEADER-DD                                        02940011
           END-IF.                                                      02950011
                                                                        02960011
           IF PV-HEADER-MO = 01                                         02970011
             OR PV-HEADER-MO = 03                                       02980011
               OR PV-HEADER-MO = 05                                     02990011
                 OR PV-HEADER-MO = 07                                   03000011
                   OR PV-HEADER-MO = 08                                 03010011
                     OR PV-HEADER-MO = 10                               03020011
                       OR PV-HEADER-MO = 12                             03030011
               IF PV-HEADER-DD GREATER 31                               03040011
                   MOVE 1                                               03050011
                     TO PV-HEADER-DD                                    03060011
                   ADD 1                                                03070011
                     TO PV-HEADER-MO                                    03080011
               END-IF                                                   03090011
           ELSE                                                         03100011
               IF PV-HEADER-MO = 04                                     03110011
                 OR PV-HEADER-MO = 06                                   03120011
                   OR PV-HEADER-MO = 09                                 03130011
                     OR PV-HEADER-MO = 11                               03140011
                   IF PV-HEADER-DD GREATER 30                           03150011
                       MOVE 1                                           03160011
                         TO PV-HEADER-DD                                03170011
                       ADD 1                                            03180011
                         TO PV-HEADER-MO                                03190011
                   END-IF                                               03200011
               ELSE                                                     03210011
                   IF PV-HEADER-MO = 02                                 03220011
                       DIVIDE PV-HEADER-YYYY BY 100                     03230011
                         GIVING PV-QUOTIENT                             03240011
                           REMAINDER PV-RMDR-100                        03250011
                       DIVIDE PV-HEADER-YYYY BY 4                       03260011
                         GIVING PV-QUOTIENT                             03270011
                           REMAINDER PV-RMDR-4                          03280011
                       IF PV-RMDR-100 = 0                               03290011
                           IF PV-HEADER-DD GREATER 28                   03291011
                               MOVE 1                                   03292011
                                 TO PV-HEADER-DD                        03293011
                               ADD 1                                    03294011
                                 TO PV-HEADER-MO                        03295011
                           END-IF                                       03295111
                       ELSE                                             03295211
                           IF PV-RMDR-4 = 0                             03295311
                               IF PV-HEADER-DD GREATER 29               03295411
                                   MOVE 1                               03295511
                                     TO PV-HEADER-DD                    03295611
                                   ADD 1                                03295711
                                     TO PV-HEADER-MO                    03295811
                               END-IF                                   03295911
                           ELSE                                         03296011
                               IF PV-HEADER-DD GREATER 28               03296111
                                   MOVE 1                               03296211
                                     TO PV-HEADER-DD                    03296311
                                   ADD 1                                03296411
                                     TO PV-HEADER-MO                    03296511
                               END-IF                                   03296611
                           END-IF                                       03296711
                       END-IF                                           03296811
                   END-IF                                               03296911
               END-IF                                                   03297011
           END-IF.                                                      03297111
                                                                        03297211
           IF PV-HEADER-MO GREATER 12                                   03297311
               MOVE 1                                                   03297411
                 TO PV-HEADER-MO                                        03297511
               ADD 1                                                    03297611
                 TO PV-HEADER-YYYY                                      03297711
           END-IF.                                                      03297811
                                                                        03297911
      *-----------------------------------------------------------------03298011
      * 5100-DETERMINE-OFFER-INRANGE.                                   03299011
      *  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03299111
      *  OFFER RECORD READ.                                             03299211
      *----------------------------------------------------------------*03299311
       5100-DETERMINE-OFFER-INRANGE.                                    03299411
                                                                        03299511
           IF EP271-STR-GRP-TYP-CDE = PV-STR-GRP-TYP-CDE                03299911
                   AND EP271-STR-GRP-ID = PV-STR-GRP-ID                 03300011
               SET PS-EP271-OFR-INRANGE TO TRUE                         03300111
           ELSE                                                         03300211
               SET PS-EP271-OFR-NOT-INRANGE TO TRUE                     03300311
           END-IF.                                                      03300411
                                                                        03300511
      *-----------------------------------------------------------------03300611
      * 5200-DETERMINE-SECTN-INRANGE.                                   03300711
      *  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03300811
      *  SECTN RECORD READ (EP272)                                      03300911
      *----------------------------------------------------------------*03301011
       5200-DETERMINE-SECTN-INRANGE.                                    03302011
                                                                        03303011
           IF EP272-STR-GRP-TYP-CDE = PV-STR-GRP-TYP-CDE                03303411
                   AND EP272-STR-GRP-ID = PV-STR-GRP-ID                 03303511
              SET PS-EP272-OFR-INRANGE TO TRUE                          03303611
           ELSE                                                         03303711
              SET PS-EP272-OFR-NOT-INRANGE TO TRUE                      03303811
           END-IF.                                                      03303911
                                                                        03304011
      *-----------------------------------------------------------------03305011
      * 5300-DETERMINE-BWP-INRANGE.                                     03306011
      *  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03306111
      *  BWP   RECORD READ (EP273)                                      03306211
      *----------------------------------------------------------------*03306311
       5300-DETERMINE-BWP-INRANGE.                                      03306411
                                                                        03306511
           IF EP273-STR-GRP-TYP-CDE = PV-STR-GRP-TYP-CDE                03306911
                   AND EP273-STR-GRP-ID = PV-STR-GRP-ID                 03307011
              SET PS-EP273-OFR-INRANGE TO TRUE                          03307111
           ELSE                                                         03307211
              SET PS-EP273-OFR-NOT-INRANGE TO TRUE                      03307311
           END-IF.                                                      03307411
                                                                        03307511
      *-----------------------------------------------------------------03307611
      * 5400-DETERMINE-MDSE-INRANGE.                                    03307711
      *  THIS PARAGRAPH WILL SET THE OFFER RANGE SWITCHES BASED ON THE  03307811
      *  MDSE  RECORD READ (EP274)                                      03307911
      *----------------------------------------------------------------*03308011
       5400-DETERMINE-MDSE-INRANGE.                                     03308111
                                                                        03308211
           IF EP274-STR-GRP-TYP-CDE = PV-STR-GRP-TYP-CDE                03308611
                   AND EP274-STR-GRP-ID = PV-STR-GRP-ID                 03308711
              SET PS-EP274-OFR-INRANGE TO TRUE                          03308811
           ELSE                                                         03308911
              SET PS-EP274-OFR-NOT-INRANGE TO TRUE                      03309011
           END-IF.                                                      03309111
                                                                        03309211
      *----------------------------------------------------------       03310611
      * 6100-READ-OFFER-DATA                                            03310711
      *     THIS PARAGRAPH READS DATA FROM OFFERS-DATA-FILE INTO        03310811
      *     COPYBOOK EPRD201  (INP01)                                   03310911
      *----------------------------------------------------------       03311011
       6100-READ-OFFER-DATA.                                            03312011
                                                                        03313011
           READ OFFERS-DATA-FILE INTO                                   03313111
               EP271-OFFER-XST-OFR-RECORD                               03313211
           AT END                                                       03313311
               SET PS-END-OFR-FILE TO TRUE                              03313411
           END-READ.                                                    03313511
                                                                        03313611
           IF PS-NOT-END-OFR-FILE                                       03313711
              MOVE 0 TO PV-PIPE-COUNT                                   03313911
              PERFORM 8100-CHECK-INP01-FOR-PIPES                        03314011
           END-IF.                                                      03314111
                                                                        03314211
      *----------------------------------------------------------       03314311
      * 6200-READ-SECTN-DATA                                            03314411
      *     THIS PARAGRAPH READS DATA FROM OFFERS-SECTION-FILE INTO     03314511
      *     COPYBOOK EPRD202  (INP02)                                   03314611
      *----------------------------------------------------------       03314711
       6200-READ-SECTN-DATA.                                            03314811
                                                                        03314911
           READ OFFERS-SECTION-FILE INTO                                03315011
               EP272-OFFER-XST-OFR-SECT-RCD                             03315111
           AT END                                                       03315211
               SET PS-END-SEC-FILE TO TRUE                              03315311
           END-READ.                                                    03315411
                                                                        03315511
           IF PS-NOT-END-SEC-FILE                                       03315611
              MOVE 0 TO PV-PIPE-COUNT                                   03315811
              PERFORM 8200-CHECK-INP02-FOR-PIPES                        03315911
           END-IF.                                                      03316011
                                                                        03316111
      *----------------------------------------------------------       03316211
      * 6300-READ-BWP-DATA                                              03316311
      *     THIS PARAGRAPH READS DATA FROM OFFERS-BWP-FILE INTO         03316411
      *     COPYBOOK EPRD203  (INP03)                                   03316511
      *----------------------------------------------------------       03316611
       6300-READ-BWP-DATA.                                              03316711
                                                                        03316811
           READ OFFERS-BWP-FILE INTO                                    03316911
               EP273-OFFER-XST-BWP-RECORD                               03317011
           AT END                                                       03318011
               SET PS-END-BWP-FILE TO TRUE                              03319011
           END-READ.                                                    03319111
                                                                        03319211
           IF PS-NOT-END-BWP-FILE                                       03319311
              MOVE 0 TO PV-PIPE-COUNT                                   03319511
              PERFORM 8300-CHECK-INP03-FOR-PIPES                        03319611
           END-IF.                                                      03319711
                                                                        03319811
      *----------------------------------------------------------       03319911
      * 6400-READ-MDSE-DATA                                             03320011
      *     THIS PARAGRAPH READS DATA FROM OFFERS-MDSE-FILE INTO        03320111
      *     COPYBOOK EPRD204  (INP04)                                   03320211
      *----------------------------------------------------------       03320311
       6400-READ-MDSE-DATA.                                             03320411
                                                                        03320511
           READ OFFERS-MDSE-FILE INTO                                   03320611
               EP274-OFFER-XST-OFR-MDSE-SET                             03320711
           AT END                                                       03320811
               SET PS-END-OF-MDSE-FILE TO TRUE                          03320911
           END-READ.                                                    03321011
                                                                        03322011
           IF PS-NOT-END-OF-MDSE-FILE                                   03323011
              MOVE 0 TO PV-PIPE-COUNT                                   03324111
              PERFORM 8400-CHECK-INP04-FOR-PIPES                        03324211
           END-IF.                                                      03324311
                                                                        03324411
      *----------------------------------------------------------       03324511
      * 6500-MOVE-ID-DATA                                               03324611
      *     THIS PARAGRAPH MOVES ONE BIT OF DATA TO THE OUTPUT FILE REC 03324711
      *----------------------------------------------------------       03324811
       6500-MOVE-ID-DATA.                                               03324911
                                                                        03325011
           MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                            03325111
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03325211
           SET FORM-OFR-LEN                                             03325311
             UP BY +1.                                                  03325411
           ADD 1                                                        03325511
             TO PV-BYTE-COUNT.                                          03325611
                                                                        03325711
      *----------------------------------------------------------       03325811
      * 6550-MOVE-AMT-ID-DATA                                           03325911
      *     THIS PARAGRAPH IS USED TO MOVE A BIT VALUE FROM INPUT       03326011
      *     TO THE OUTPUT RECORD, WHERE THE INPUT FIELD IS              03327011
      *     DECIMAL AMOUNT, DECIMAL POINT IS SPECIFICALLY MOVED         03328011
      *     TO FORMAT THE AMOUNT FIELD CORRECTLY.                       03329011
      *----------------------------------------------------------       03329111
       6550-MOVE-AMT-ID-DATA.                                           03329211
                                                                        03329311
           IF PV-EFBM-BIT-IDX = 7                                       03329411
              MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         03329511
                TO FORM-OFR-FLD(FORM-OFR-LEN)                           03329611
                                                                        03329711
              SET FORM-OFR-LEN UP BY +1                                 03329811
              ADD 1 TO PV-BYTE-COUNT                                    03329911
                                                                        03330011
              MOVE '.' TO FORM-OFR-FLD(FORM-OFR-LEN)                    03330111
                                                                        03330211
           ELSE                                                         03330311
              MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         03330411
                TO FORM-OFR-FLD(FORM-OFR-LEN)                           03330511
           END-IF.                                                      03330611
                                                                        03330711
           SET FORM-OFR-LEN                                             03330811
             UP BY +1.                                                  03330911
           ADD 1                                                        03331011
             TO PV-BYTE-COUNT.                                          03331111
                                                                        03331211
      *-------------------------------------------------------------    03331311
      * 6600-FIND-DATA-END.                                             03331411
      *  THIS PARAGRAPH IS USED IN A LOOP TO DETERMINE THE LENGTH OF    03331511
      *  THE STRING.                                                    03331611
      *-------------------------------------------------------------    03331711
       6600-FIND-DATA-END.                                              03331811
                                                                        03331911
           MOVE ' '                                                     03332011
             TO PV-SPACE.                                               03332111
                                                                        03332211
      *----------------------------------------------------------       03332311
      * 6650-FIELD-MOVER                                                03332411
      *     THIS PARAGRAPH MOVES A BIT OF DATA TO THE OUTPUT FILE RECORD03332511
      *----------------------------------------------------------       03332611
       6650-FIELD-MOVER.                                                03332711
                                                                        03332811
           MOVE PV-BIT-VARIABLE(PV-BIT-IDX)                             03332911
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03333011
           SET FORM-OFR-LEN                                             03334011
             UP BY +1.                                                  03334111
           ADD 1                                                        03334211
             TO PV-BYTE-COUNT.                                          03334311
                                                                        03334411
      *-----------------------------------------------------------------03334511
      * 6700-MOVE-ZERO                                                  03334611
      *  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE       03334711
      *----------------------------------------------------------------*03334811
       6700-MOVE-ZERO.                                                  03334911
                                                                        03335011
           MOVE PC-ONE-ZERO                                             03335111
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03335211
           SET FORM-OFR-LEN                                             03335311
             UP BY +1.                                                  03335411
           ADD 1                                                        03335511
             TO PV-BYTE-COUNT.                                          03335611
                                                                        03335711
           PERFORM 6900-MOVE-DELIMITER.                                 03335811
                                                                        03335911
      *-----------------------------------------------------------------03336011
      * 6800-MOVE-SPACE                                                 03336111
      *  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       03336211
      *----------------------------------------------------------------*03336311
       6800-MOVE-SPACE.                                                 03336411
                                                                        03336511
           MOVE PC-ONE-SPACE                                            03336611
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03336711
           SET FORM-OFR-LEN                                             03336811
             UP BY +1.                                                  03336911
           ADD 1                                                        03337011
             TO PV-BYTE-COUNT.                                          03337111
                                                                        03337211
           PERFORM 6900-MOVE-DELIMITER.                                 03337311
                                                                        03337411
                                                                        03337511
      *-----------------------------------------------------------------03337611
      * 6850-MOVE-NULL-VALUE                                            03337711
      *  THIS PARAGRAPH WILL MOVE '~' TO THE OUTPUT FILE VARIABLE       03337811
      *----------------------------------------------------------------*03337911
       6850-MOVE-NULL-VALUE.                                            03338011
                                                                        03339011
           MOVE PC-NULL-VALUE                                           03339111
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03339211
           SET FORM-OFR-LEN                                             03339311
             UP BY +1.                                                  03339411
           ADD 1                                                        03339511
             TO PV-BYTE-COUNT.                                          03339611
                                                                        03339711
           PERFORM 6900-MOVE-DELIMITER.                                 03339811
                                                                        03339911
      *-----------------------------------------------------------------03340011
      * 6900-MOVE-DELIMITER.                                            03340111
      *  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE       03340211
      *----------------------------------------------------------------*03340311
       6900-MOVE-DELIMITER.                                             03340411
                                                                        03340511
           MOVE PC-CSV-DELIMITER                                        03340611
             TO FORM-OFR-FLD(FORM-OFR-LEN).                             03340711
           SET FORM-OFR-LEN                                             03340811
             UP BY +1.                                                  03340911
           ADD 1                                                        03341011
             TO PV-BYTE-COUNT.                                          03341111
                                                                        03341211
      *----------------------------------------------------------       03341311
      * 8100-CHECK-INP01-FOR-PIPES                                      03341411
      *     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03341511
      *     REPLACES PIPES WITH SPACE.                                  03341611
      *----------------------------------------------------------       03341711
       8100-CHECK-INP01-FOR-PIPES.                                      03341811
                                                                        03341911
           INSPECT EP271-OFFER-XST-OFR-RECORD                           03342011
                TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03342111
                                                                        03342211
           IF PV-PIPE-COUNT > 0                                         03342311
              INSPECT EP271-OFFER-XST-OFR-RECORD                        03342411
                  REPLACING ALL '|'  BY  ' '                            03342511
              DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'  03342611
                      ' | WITH A SPACE '                                03342711
              DISPLAY EP271-OFFER-XST-OFR-RECORD                        03342811
           END-IF.                                                      03342911
                                                                        03343011
      *----------------------------------------------------------       03344011
      * 8200-CHECK-INP02-FOR-PIPES                                      03344111
      *     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03344211
      *     REPLACES PIPES WITH SPACE.                                  03344311
      *----------------------------------------------------------       03344411
       8200-CHECK-INP02-FOR-PIPES.                                      03344511
                                                                        03344611
           INSPECT EP272-OFFER-XST-OFR-SECT-RCD                         03344711
                TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03344811
                                                                        03344911
           IF PV-PIPE-COUNT > 0                                         03345011
              INSPECT EP272-OFFER-XST-OFR-SECT-RCD                      03345111
                  REPLACING ALL '|'  BY  ' '                            03345211
              DISPLAY ' INPUT SECTN RECORD HAD PIPES IN IT, REPLACING ' 03345311
                      ' | WITH A SPACE '                                03345411
              DISPLAY EP272-OFFER-XST-OFR-SECT-RCD                      03345511
           END-IF.                                                      03345611
                                                                        03345711
      *----------------------------------------------------------       03345811
      * 8300-CHECK-INP03-FOR-PIPES                                      03345911
      *     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03346011
      *     REPLACES PIPES WITH SPACE.                                  03346111
      *----------------------------------------------------------       03346211
       8300-CHECK-INP03-FOR-PIPES.                                      03346311
                                                                        03346411
           INSPECT EP273-OFFER-XST-BWP-RECORD                           03346511
                TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03346611
                                                                        03346711
           IF PV-PIPE-COUNT > 0                                         03346811
              INSPECT EP273-OFFER-XST-BWP-RECORD                        03346911
                  REPLACING ALL '|'  BY  ' '                            03347011
              DISPLAY ' INPUT  BWP  RECORD HAD PIPES IN IT, REPLACING ' 03347111
                      ' | WITH A SPACE '                                03347211
              DISPLAY EP273-OFFER-XST-BWP-RECORD                        03347311
           END-IF.                                                      03347411
                                                                        03347511
      *----------------------------------------------------------       03347611
      * 8400-CHECK-INP04-FOR-PIPES                                      03347711
      *     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 03347811
      *     REPLACES PIPES WITH SPACE.                                  03347911
      *----------------------------------------------------------       03348011
       8400-CHECK-INP04-FOR-PIPES.                                      03348111
                                                                        03348211
           INSPECT EP274-OFFER-XST-OFR-MDSE-SET                         03348311
                TALLYING PV-PIPE-COUNT FOR ALL '|'.                     03348411
                                                                        03348511
           IF PV-PIPE-COUNT > 0                                         03348611
              INSPECT EP274-OFFER-XST-OFR-MDSE-SET                      03348711
                  REPLACING ALL '|'  BY  ' '                            03348811
              DISPLAY ' INPUT MDSE  RECORD HAD PIPES IN IT, REPLACING ' 03348911
                      ' | WITH A SPACE '                                03349011
              DISPLAY EP274-OFFER-XST-OFR-MDSE-SET                      03349111
           END-IF.                                                      03349211
                                                                        03349311
      ******************************************************************03349411
      *     CLOSES ALL FILES AND DISPLAYS ANY NEEDED INFORMATION.      *03349511
      ******************************************************************03349611
       9200-WRAPUP.                                                     03349711
           MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.03349811
                                                                        03349911
                                                                        03351011
           DISPLAY '****************************************'.          03351111
           DISPLAY '**          EPKUT226 END              **'.          03351211
           DISPLAY '****************************************'.          03351311
                                                                        03351411
           CLOSE OFFERS-DATA-FILE.                                      03351511
           CLOSE OFFERS-SECTION-FILE.                                   03351611
           CLOSE OFFERS-BWP-FILE.                                       03351711
           CLOSE OFFERS-MDSE-FILE.                                      03351811
                                                                        03352011
           CLOSE FORMATTED-OFFERS-FILE.                                 03352111
                                                                        03353811
      ******************************************************************03353911
      *     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.              *   03354011
      ******************************************************************03354111
       9910-ABEND.                                                      03354211
                                                                        03354311
           PERFORM 9920-DISPLAY-TOTALS.                                 03354411
                                                                        03354511
           DISPLAY '** ABEND           **'.                             03354611
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03354711
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03354811
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       03354911
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       03355011
                                                                        03355111
           CALL 'ILBOABN0' USING AC-ABEND-CODE.                         03355211
                                                                        03355311
      ******************************************************************03355411
      *     DISPLAY END OF JOB TOTALS                                  *03355511
      ******************************************************************03355611
       9920-DISPLAY-TOTALS.                                             03355711
                                                                        03355811
           DISPLAY '****************************************'.          03355911
      *    DISPLAY '**     STATISTICS  FOR  STORE ' PV-STORE-NBR-RANGE  03356011
           DISPLAY '**     STATISTICS  FOR  GROUP '                     03356111
                   PV-STR-GRP-TYP-CDE ' - ' PV-STR-GRP-ID               03356211
                   '     **'.                                           03356311
           DISPLAY '****************************************'.          03356411
                                                                        03356511
           DISPLAY '** OFFER RECS  WRITEN ====> '                       03356611
                   PV-OFFER-WRITEN                                      03356711
                   ' **'.                                               03356811
           DISPLAY '** OFR_SECT WRITEN    ====> '                       03356911
                   PV-OFFER-SECTION                                     03357011
                   ' **'.                                               03357111
           DISPLAY '** OFR_BWP WRITEN     ====> '                       03357211
                   PV-OFFER-BWP                                         03357311
                   ' **'.                                               03357411
           DISPLAY '** OFR_MDSE WRITEN    ====> '                       03357511
                   PV-OFFER-MDSE                                        03357611
                   ' **'.                                               03357711
           DISPLAY '****************************************'.          03357811
                                                                        03357911
