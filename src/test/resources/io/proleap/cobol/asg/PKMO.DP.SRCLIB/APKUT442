000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT442.                                        00020000
000300 AUTHOR.         JEAN KURK.                                       00030000
000400 DATE-WRITTEN.   08/26/2021.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000700*    COBOL 2 WITH SQL                                            *00070000
000800*    SELECT UNUSED NON-INVOICED RECEIPTS                         *00080000
000900*                                                                *00090000
001000*    THIS PROGRAM WAS ORIGINALLY PART OF APKRP365.  IT DOES THE  *00100000
001000*    SELECTION OF ALL ENTRIES ON THE NON-INVOICED RECEIPTS TABLE *00101000
001100*    THAT ARE UNMATCHED AS OF THE RUN DATE AND TIME.  DOLLARS    *00110000
001200*    DOLLARS ARE SUMMED BY VENDOR/DEPT/PO/CREATE DATE.  THE      *00120000
001210*    ORIGINAL PROGRAM WAS SPLIT TO ALLOW FOR SORTING THE SEPHORA *00121000
001210*    VENDORS TO THE END OF THE REPORT.                           *00121100
001300*                                                                *00122000
001400* INPUT:                                                         *00123000
001500*  1. AP NONINVOICED RECEIPTS TABLE      (TNINREC)               *00124000
001600*  2. LOGISTICS PO HEADER TABLE          (TPURCHS)               *00125000
001700*  3. EXTERNAL ENTITY ID TABLE           (TEXTENT)               *00126000
001710*  4. EXTERNAL ENTERPRISE NAME           (TENTNME)               *00127000
001710*  5. VENDOR CAPABILITIES - VND_VNT_CPBL (VNT00001)              *00127100
001710*  6. MERCHANDISE AREA                   (TMDSEAR)               *00127200
001800*                                                                *00128000
001900* OUTPUT:                                                        *00129000
002000*  1. UNUSED NON-INVOICED RECEIPTS FILE                          *00130000
002100*                                                                *00140000
002300*----------------------------------------------------------------*00150000
002400*                                                                *00160000
002500* CHANGE LOG:                                                    *00170000
002600* DATE  08/26/2021                                               *00180000
002610*     CHANGE MADE: INITIAL VERSION.                              *00190000
002620*     MADE BY: JEAN KURK               WR/IR #: CHG0260549       *00200000
002630*                                                                *00210000
002700*----------------------------------------------------------------*00220000
002800   EJECT                                                          00230000
002900 ENVIRONMENT DIVISION.                                            00240000
003000 CONFIGURATION SECTION.                                           00250000
003100 SOURCE-COMPUTER.    IBM-3090.                                    00260000
003200 OBJECT-COMPUTER.    IBM-3090.                                    00270000
003300                                                                  00280000
003400 INPUT-OUTPUT SECTION.                                            00290000
003500 FILE-CONTROL.                                                    00300000
003600     SELECT UNUSED-NIR-RPT-FILE ASSIGN TO UT-S-OUT01.             00310000
003700 EJECT                                                            00320000
003800 DATA DIVISION.                                                   00330000
003900 FILE SECTION.                                                    00340000
004000                                                                  00350000
004100 FD  UNUSED-NIR-RPT-FILE                                          00360000
004200     RECORDING MODE IS F                                          00370000
004300     LABEL RECORDS ARE STANDARD.                                  00380004
004600 01  UNUSED-NIR-RPT-REC               PIC X(100).                 00410000
004800                                                                  00430000
004900 EJECT                                                            00440000
005000 WORKING-STORAGE SECTION.                                         00450000
005100                                                                  00460000
005200 01  PV-PROGRAM-VARIABLES.                                        00470000
005300     05  FILLER                  PIC  X(30)  VALUE                00480000
005400         '** BEGINING OF APKUT442 W/S **'.                        00490000
005500     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00500000
005600     05  PV-PROGRAM-NAME         PIC  X(08)  VALUE 'APKUT442'.    00510000
005610     05  HOLD-ENT-ID             PIC S9(09)  VALUE 0.             00520002
005611     05  PV-REC-DTE              PIC  X(10)  VALUE SPACES.        00530000
005620     05  PV-NIR-COST             PIC S9(11)V999  COMP-3 VALUE 0.  00550000
006600                                                                  00580000
006700 01  PS-PROGRAM-SWITCHES.                                         00590000
006800     05  PS-OUT-OF-VENDORS-SW        PIC X(01) VALUE 'M'.         00600000
006900         88  OUT-OF-VENDORS                    VALUE 'O'.         00610000
007000         88  MORE-VENDORS                      VALUE 'M'.         00620000
007200                                                                  00640000
007300 01  PC-PROGRAM-COUNTERS.                                         00650000
008000     05  PC-WRITE-COUNT          PIC S9(09)  VALUE 0              00720000
008100                                             COMP-3.              00730000
008400     05  PC-UNUSED-NIR-COUNT     PIC S9(05)  VALUE ZERO           00760000
008500                                             COMP-3.              00770000
013100 EJECT                                                            01309000
013200*----------------------------------------------------------------*01310000
013300*  COMMUNICATIONS AREA2 FOR DB2                                  *01320000
013400*----------------------------------------------------------------*01330000
013500     COPY SQLCA2.                                                 01340000
013600                                                                  01350000
013700                                                                  01360000
013800     EXEC SQL                                                     01370000
013900          INCLUDE SQLCA                                           01380000
014000     END-EXEC.                                                    01390000
014100 EJECT                                                            01400000
014200*----------------------------------------------------------------*01410000
014300*  ACCOUNTS PAYABLE NON-INVOICED RECEIPTS TABLE                  *01420000
014400*----------------------------------------------------------------*01430000
014500     EXEC SQL                                                     01440000
014600          INCLUDE TNINREC                                         01450000
014700     END-EXEC.                                                    01460000
014800 EJECT                                                            01470000
014810*----------------------------------------------------------------*01480000
014820*  PURCHASE ORDER HEADER TABLE                                   *01481000
014830*----------------------------------------------------------------*01482000
014840     EXEC SQL                                                     01483000
014850          INCLUDE TPURCHS                                         01484000
014860     END-EXEC.                                                    01485000
014870 EJECT                                                            01486000
014900*----------------------------------------------------------------*01487000
015000*  EXTERNAL ENTERPRISE NAME TABLE                                *01488000
015100*----------------------------------------------------------------*01489000
015200     EXEC SQL                                                     01490000
015300          INCLUDE TENTNME                                         01500000
015400     END-EXEC.                                                    01510000
015500 EJECT                                                            01520000
015600*----------------------------------------------------------------*01530000
015700*  EXTERNAL ENTITY ID TABLE                                      *01540000
015800*----------------------------------------------------------------*01550000
015900     EXEC SQL                                                     01560000
016000          INCLUDE TEXTENT                                         01570000
016100     END-EXEC.                                                    01580000
016200 EJECT                                                            01590000
015600*----------------------------------------------------------------*01591000
015700*  VENDOR CAPABILITIES - VNT_VND_CPBL                            *01592000
015800*----------------------------------------------------------------*01593000
015900     EXEC SQL                                                     01594000
016000          INCLUDE VNT00001                                        01595000
016100     END-EXEC.                                                    01596000
016200 EJECT                                                            01597000
015600*----------------------------------------------------------------*01598000
015700*  MERCHANDISE AREA                                              *01599000
015800*----------------------------------------------------------------*01599100
015900     EXEC SQL                                                     01599200
016000          INCLUDE TMDSEAR                                         01599300
016100     END-EXEC.                                                    01599400
016200 EJECT                                                            01599500
066700*--------------------------------------------------------------*  01599603
066800* COPYBOOK FOR SEPHORA LOGIC                                   *  01599703
066900*--------------------------------------------------------------*  01599803
067000     COPY APWS021.                                                01599903
067100                                                                  01600003
066700*--------------------------------------------------------------*  01600104
066800* COPYBOOK FOR OUTPUT RECORD                                   *  01600204
066900*--------------------------------------------------------------*  01600304
067000     COPY APRD442.                                                01600404
067100                                                                  01600504
016300*----------------------------------------------------------------*01601000
016400*   UNUSED_NIR_CSR GETS ALL UNMATCHED ROWS ON THE TNINREC TABLE  *01610000
016500*----------------------------------------------------------------*01620000
016600     EXEC SQL                                                     01630000
016700       DECLARE UNUSED_NIR_CSR CURSOR FOR                          01640000
016800         SELECT DUN_NBR                                           01650000
016900              , B.DEPT_NBR                                        01660000
017000              , B.PO_NBR                                          01670000
017000              , B.ENT_ID                                          01671002
017100              , MIN(DATE(A.REC_TMST))                             01680000
017300              , SUM(NON_INVC_UNT_QTY * UNT_COST_AMT)              01690000
017400              , D.ENT_NAME_DESC                                   01700000
017500           FROM TNINREC A                                         01710000
017600              , TPURCHS B                                         01720000
017700              , TEXTENT C                                         01730000
017800              , TENTNME D                                         01740000
017900          WHERE A.PO_NBR         = B.PO_NBR                       01750000
018000            AND B.VER_STATUS_CDE = 'A'                            01760000
018100            AND A.STATUS_CDE     = ' '                            01770000
018200            AND B.ENT_ID         = C.ENT_ID                       01780000
018210            AND B.ENT_ID         = D.ENT_ID                       01790000
018220            AND C.ENT_ID         = D.ENT_ID                       01800000
018230            AND D.TYPE_CDE       = '01'                           01810000
018240       GROUP BY B.ENT_ID                                          01820002
017400              , D.ENT_NAME_DESC                                   01820107
018241              , DUN_NBR                                           01821000
018242              , B.DEPT_NBR                                        01822000
018243              , B.PO_NBR                                          01823000
018250       ORDER BY B.ENT_ID                                          01824002
017400              , D.ENT_NAME_DESC                                   01824107
018260              , DUN_NBR                                           01825000
018270              , B.DEPT_NBR                                        01826000
018280              , B.PO_NBR                                          01827000
018300     END-EXEC.                                                    01828000
018400 EJECT                                                            01829000
018500*----------------------------------------------------------------*01830000
018600*  ABEND DATA AREAS                                              *01840000
018700*----------------------------------------------------------------*01850000
018800 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          01860000
018900                                             COMP SYNC.           01870000
019000     88  AC-BAD-DATA                         VALUE +4003.         01880000
019100     88  AC-DB2-ERROR                        VALUE +4013.         01890000
019300                                                                  01910000
019400 01  ABEND-AREAS.                                                 01920000
019500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01930000
019600             '*****       ABEND'.                                 01940000
019700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01950000
019800             '*****   PROGRAM: APKUT442'.                         01960000
019900     05  AA-PARAGRAPH-LIT.                                        01970000
020000         10  FILLER              PIC  X(17)  VALUE                01980000
020100             '***** PARAGRAPH: '.                                 01990000
020200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02000000
020300     05  AA-MESSAGE-LINE.                                         02010000
020400         10  FILLER              PIC  X(06)  VALUE '*****'.       02020000
020500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02030000
020600     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                02040000
020700             '*****    DB2 ERROR'.                                02050000
020800     05  AA-DB2-OPERATION-LIT.                                    02060000
020900         10  FILLER              PIC  X(17)  VALUE                02070000
021000             '***** OPERATION: '.                                 02080000
021100         10  AA-DB2-OPERATION.                                    02090000
021200             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        02100000
021300             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        02110000
021400     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        02120000
021500     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        02130000
021600     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        02140000
021700     05  AA-DB2-TABLE-4          PIC  X(08)  VALUE SPACES.        02150000
021900                                                                  02170000
022000                                                                  02180000
022100     COPY DPWS004.                                                02190000
022200 01  FILLER                      PIC  X(25)  VALUE                02200000
022300     '** END OF APKUT442 W/S **'.                                 02210000
022400 EJECT                                                            02220000
022500 PROCEDURE DIVISION.                                              02230000
022600 A100-MAIN.                                                       02240000
022700                                                                  02250000
022800     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    02260000
022900                                                                  02270000
023000     PERFORM B100-INITIALIZE.                                     02280000
023100                                                                  02290000
023200     PERFORM B200-CREATE-FILE                                     02300001
023300         UNTIL OUT-OF-VENDORS.                                    02310000
023400                                                                  02320000
023500     PERFORM B300-END-PROGRAM.                                    02330000
023600                                                                  02340000
023700     GOBACK.                                                      02350000
023800 EJECT                                                            02360000
023900*----------------------------------------------------------------*02370000
024000*    INITIALIZATION PROCESSING                                   *02380000
024100*    CALLED FROM A100-MAIN                                       *02390000
024200*----------------------------------------------------------------*02400000
024300 B100-INITIALIZE.                                                 02410000
024400                                                                  02420000
024500     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02430000
024600                                                                  02440000
024700     OPEN OUTPUT UNUSED-NIR-RPT-FILE.                             02450000
024800                                                                  02460000
024900     INITIALIZE DCLTNINREC                                        02470000
025000                DCLTPURCHS                                        02480000
025010                DCLTEXTENT                                        02490000
025100                DCLTENTNME                                        02500001
025100                DCLTMDSEAR                                        02501001
025100                DCLVNT00001.                                      02502001
025200                                                                  02510000
129500*    GET SEPHORA DATA                                             02630702
129500     MOVE PV-PROGRAM-NAME      TO SA-PROGRAM-NAME.                02630802
129500     PERFORM S100-GET-SEPHORA-DEPT.                               02630902
026320                                                                  02631100
026400     PERFORM Y100-OPEN-UNUSED-NIR-CSR.                            02631200
026500     PERFORM R100-FETCH-UNUSED-NIR.                               02631300
026600 EJECT                                                            02637000
026700*----------------------------------------------------------------*02638000
026800*    MOVES DATA FROM THE DB2 TABLE AREAS TO THE REPORT.          *02639000
026900*    CALLED FROM A100-MAIN                                       *02640000
027000*----------------------------------------------------------------*02650000
027100 B200-CREATE-FILE.                                                02660001
027200                                                                  02670000
027300     MOVE 'B200-CREATE-FILE'       TO PV-CURRENT-PARAGRAPH.       02680002
027300     INITIALIZE APRD442-RECORD.                                   02680102
027300                                                                  02680202
027300     IF PURCHS-ENT-ID NOT = HOLD-ENT-ID                           02680302
026522         MOVE PURCHS-ENT-ID        TO HOLD-ENT-ID                 02681002
027400         MOVE PURCHS-ENT-ID        TO PV-ENT-ID                   02690002
027400         MOVE PURCHS-DEPT-NBR      TO PV-DEPT-NBR                 02700002
027400         PERFORM S500-CHECK-FOR-SEPHORA                           02701002
027400     END-IF.                                                      02701102
027400                                                                  02702002
216700     IF PS-SEPHORA-ALL                                            02703002
216700         SET AP442-IS-SEPHORA      TO TRUE                        02704005
216700     ELSE                                                         02705002
216700         SET AP442-IS-NOT-SEPHORA  TO TRUE                        02706005
216700     END-IF.                                                      02707002
027700     MOVE ENTNME-ENT-NAME-DESC     TO AP442-VENDOR-NAME.          02710108
027700     MOVE EXTENT-DUN-NBR           TO AP442-DUN-NBR.              02710208
027700     MOVE PURCHS-DEPT-NBR          TO AP442-DEPT-NBR.             02711002
027710     MOVE PURCHS-PO-NBR            TO AP442-PO-NBR.               02720002
027900     MOVE PV-REC-DTE               TO AP442-CREATE-DTE            02730002
028000     MOVE PV-NIR-COST              TO AP442-GROSS-COST            02740002
028400                                                                  02809500
028200     PERFORM W100-WRITE-UNUSED-NIR-FILE.                          02809601
028500     PERFORM R100-FETCH-UNUSED-NIR.                               02809700
028600 EJECT                                                            02809800
028700*----------------------------------------------------------------*02809900
028800*    ENDING PROCESSING: DISPLAYS COUNT OF VENDORS AND CLOSES     *02810000
028900*    THE CURSOR AND FILES.                                       *02811000
029000*    CALLED FROM A100-MAIN                                       *02820000
029100*----------------------------------------------------------------*02830000
029200 B300-END-PROGRAM.                                                02840000
029300                                                                  02850000
029400     MOVE 'B300-END-PROGRAM' TO PV-CURRENT-PARAGRAPH.             02860000
029500                                                                  02870000
029600     DISPLAY 'VENDORS PROCESSED = ' PC-UNUSED-NIR-COUNT.          02880000
029600     DISPLAY 'RECORDS ON FILE   = ' PC-WRITE-COUNT.               02881000
029700                                                                  02890000
029810     PERFORM Y110-CLOSE-UNUSED-NIR-CSR.                           02940000
029900                                                                  02950000
030000     CLOSE UNUSED-NIR-RPT-FILE.                                   02960000
030100 EJECT                                                            02970000
030200*----------------------------------------------------------------*02980000
030300*    RETRIEVES THE VENDORS ON THE VENDOR SPECIFICATION TABLE.    *02990000
030400*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE SIMPLY        *03000000
030500*           RESULTS IN THE OUT OF VENDORS SWITCH BEING SET.      *03010000
030600*----------------------------------------------------------------*03020000
030700 R100-FETCH-UNUSED-NIR.                                           03030000
030800                                                                  03040000
030900     MOVE 'R100-FETCH-UNUSED-NIR' TO PV-CURRENT-PARAGRAPH.        03050000
031000                                                                  03060000
031700     EXEC SQL                                                     03070000
031800         FETCH UNUSED_NIR_CSR                                     03080000
031900         INTO                                                     03090000
032100             :EXTENT-DUN-NBR                                      03100000
032200            ,:PURCHS-DEPT-NBR                                     03110000
032300            ,:PURCHS-PO-NBR                                       03120000
032300            ,:PURCHS-ENT-ID                                       03121002
032400            ,:PV-REC-DTE                                          03130000
032401            ,:PV-NIR-COST                                         03140000
032410            ,:ENTNME-ENT-NAME-DESC                                03150000
032500     END-EXEC,                                                    03160001
032600                                                                  03170000
032700     EVALUATE TRUE                                                03180000
032800         WHEN SQLCODE = ZERO                                      03190000
032810              ADD 1 TO PC-UNUSED-NIR-COUNT                        03200000
032900         WHEN SQLCODE = +100                                      03210000
033000              SET OUT-OF-VENDORS TO TRUE                          03220000
033400         WHEN SQLWARN0 NOT = SPACES                               03230000
033500         WHEN SQLCODE  NOT = ZERO                                 03240000
033600             MOVE PV-CURRENT-PARAGRAPH TO AA-PARAGRAPH-NAME       03250000
033800             MOVE 'UNSUCCESSFUL FETCH WITH UNUSED_NIR_CSR'        03260000
034000                                 TO AA-DB2-OPERATION              03270000
034100             MOVE 'TNINREC'      TO AA-DB2-TABLE-1                03280000
034200             MOVE 'TPURCHS'      TO AA-DB2-TABLE-2                03290000
034300             MOVE 'TEXTENT'      TO AA-DB2-TABLE-3                03300000
034400             MOVE 'TENTNME'      TO AA-DB2-TABLE-4                03310000
034600             PERFORM Z998-DB2-ABEND                               03320000
034700     END-EVALUATE.                                                03330000
036900 EJECT                                                            03340000
037000*----------------------------------------------------------------*03350000
037100*    WRITES THE VENDOR SPECIFICATION RECORDS                     *03360000
037200*----------------------------------------------------------------*03370000
037300 W100-WRITE-UNUSED-NIR-FILE.                                      03380000
037400                                                                  03390000
037500     MOVE 'W100-WRITE-UNUSED-NIR-FILE' TO PV-CURRENT-PARAGRAPH.   03400000
037600                                                                  03410000
038000                                                                  03470000
038100     WRITE UNUSED-NIR-RPT-REC FROM APRD442-RECORD.                03480000
038200     ADD 1  TO PC-WRITE-COUNT.                                    03490000
038300                                                                  03500000
040419                                                                  04010000
040420*----------------------------------------------------------------*04020000
040500*    OPENS THE VENDOR SPECIFICATION CURSOR.                      *04030000
040600*    CALLED FROM B100-INITIALIZE                                 *04040000
040700*----------------------------------------------------------------*04050000
040800 Y100-OPEN-UNUSED-NIR-CSR.                                        04060000
040900                                                                  04070000
041000     MOVE 'Y100-OPEN-UNUSED-NIR-CSR' TO PV-CURRENT-PARAGRAPH.     04080000
041100                                                                  04090000
041800     EXEC SQL                                                     04160001
041900         OPEN UNUSED_NIR_CSR                                      04170001
042000     END-EXEC.                                                    04180001
042100                                                                  04190000
042200     EVALUATE TRUE                                                04200001
042300         WHEN SQLCODE = ZERO                                      04210001
042400         WHEN SQLCODE = -904                                      04220001
042500         WHEN SQLCODE = -913                                      04230001
042600             CONTINUE                                             04240001
042700                                                                  04250000
042800                 WHEN SQLWARN0 NOT = SPACES                       04260000
042900         WHEN SQLCODE  NOT = ZERO                                 04270001
043000         MOVE PV-CURRENT-PARAGRAPH                                04280001
043100                             TO AA-PARAGRAPH-NAME                 04290001
043200         MOVE 'UNSUCCESSFUL OPEN ON UNUSED_NIR_CSR'               04300001
043300                             TO AA-DB2-OPERATION                  04310001
043400         MOVE 'TPAYREQ'      TO AA-DB2-TABLE-1                    04320001
043500         MOVE 'TINVOIC'      TO AA-DB2-TABLE-2                    04330001
043600         MOVE SPACES         TO AA-DB2-TABLE-3                    04340001
043700                                AA-DB2-TABLE-4                    04350001
043900         PERFORM Z998-DB2-ABEND                                   04370001
044000     END-EVALUATE.                                                04380001
045600                                                                  04540000
045700*----------------------------------------------------------------*04550000
045800*    CLOSES THE VENDOR SPECIFICATION CURSOR.                     *04560000
045900*    CALLED FROM B300-END-PROGRAM                                *04570000
046000*----------------------------------------------------------------*04580000
046100 Y110-CLOSE-UNUSED-NIR-CSR.                                       04590000
046200                                                                  04600000
046300     MOVE 'Y110-CLOSE-UNUSED-NIR-CSR' TO PV-CURRENT-PARAGRAPH.    04610000
046400                                                                  04620000
047100     EXEC SQL                                                     04690001
047200         CLOSE UNUSED_NIR_CSR                                     04700001
047300     END-EXEC.                                                    04710001
047400                                                                  04720000
047500     EVALUATE TRUE                                                04730001
047600         WHEN SQLCODE = ZERO                                      04740001
047700         WHEN SQLCODE = -904                                      04750001
047800         WHEN SQLCODE = -913                                      04760001
047900             CONTINUE                                             04770001
048000                                                                  04780000
048100         WHEN SQLWARN0 NOT = SPACES                               04790001
048200         WHEN SQLCODE  NOT = ZERO                                 04800001
048300             MOVE PV-CURRENT-PARAGRAPH                            04810001
048400                                 TO AA-PARAGRAPH-NAME             04820001
048500             MOVE 'UNSUCCESSFUL CLOSE ON UNUSED_NIR_CSR'          04830001
048600                                 TO AA-DB2-OPERATION              04840001
048700             MOVE 'TPAYREQ'      TO AA-DB2-TABLE-1                04850001
048800             MOVE 'TINVOIC'      TO AA-DB2-TABLE-2                04860001
048900             MOVE SPACES         TO AA-DB2-TABLE-3                04870001
049000                                    AA-DB2-TABLE-4                04880001
049200             PERFORM Z998-DB2-ABEND                               04900001
049300     END-EVALUATE.                                                04910001
050800 EJECT                                                            05060000
050900*----------------------------------------------------------------*05070000
051000*    ABEND ROUTINE FOR DB2 ERRORS                                *05080000
051100*----------------------------------------------------------------*05090000
051200 Z998-DB2-ABEND.                                                  05100000
051300                                                                  05110000
051400     CLOSE UNUSED-NIR-RPT-FILE.                                   05120000
051500     DISPLAY AA-ABEND-LIT.                                        05130000
051600     DISPLAY AA-DB2-ERROR-LIT.                                    05140000
051700     DISPLAY AA-PROGRAM-LIT.                                      05150000
051800     DISPLAY AA-PARAGRAPH-LIT.                                    05160000
051900     DISPLAY AA-DB2-OPERATION-LIT.                                05170000
052000     DISPLAY AA-DB2-TABLE-1.                                      05180000
052100     DISPLAY AA-DB2-TABLE-2.                                      05190000
052200     DISPLAY AA-DB2-TABLE-3.                                      05200000
052300     DISPLAY AA-DB2-TABLE-4.                                      05210000
052400     SET AC-DB2-ERROR TO TRUE.                                    05220000
052500                                                                  05230000
052600     COPY DPPD004.                                                05240000
052700                                                                  05250000
052800     CALL 'ILBOABN0' USING ABEND-CODE.                            05260000
052900 EJECT                                                            05270000
066700*--------------------------------------------------------------*  05400002
066800* COPYBOOK FOR SEPHORA PROCESSES                               *  05410002
066900*--------------------------------------------------------------*  05420002
067000     COPY APPD021.                                                05430002
067100                                                                  05440002
