000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    DLKUP004.                                         00050001
000600 AUTHOR.        RON KRIER.                                        00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   JANUARY, 2004.                                    00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200*  THIS PROGRAM UPDATES ROWS ON THE SUT_BUS_EVNT_EXPRT AND        00120001
001300*  PCT_BUS_EVNT_EXPRT TABLES TO INDICATE THE INFORMATION HAS      00130001
001400*  BEEN EXTRACTED AND SENT TO THE DLX LABOR SYSTEM.               00131001
001500*  INPUT FILE FOR THIS PROGRAM CREATED FROM DLKUT003.             00132001
001600******************************************************************00140001
001700                                                                  00150001
001800******************************************************************00160001
001900 ENVIRONMENT DIVISION.                                            00170001
002000******************************************************************00180001
002100                                                                  00190001
002200 CONFIGURATION SECTION.                                           00200001
002300                                                                  00210001
002400 SOURCE-COMPUTER.        IBM-3090.                                00220001
002500 OBJECT-COMPUTER.        IBM-3090.                                00230001
002600                                                                  00240001
002700 INPUT-OUTPUT SECTION.                                            00250001
002800                                                                  00260001
002900 FILE-CONTROL.                                                    00270001
003000                                                                  00290001
003100     SELECT EXPORT-KEY-FILE                                       00300001
003200         ASSIGN TO INP01.                                         00310001
003300                                                                  00320001
003400******************************************************************00330001
003500 DATA DIVISION.                                                   00340001
003600******************************************************************00350001
003700                                                                  00360001
003800 FILE SECTION.                                                    00370001
003900                                                                  00380001
004000 FD  EXPORT-KEY-FILE                                              00390001
004100     RECORDING MODE IS F                                          00400001
004200     LABEL RECORDS ARE STANDARD                                   00410001
004300     BLOCK CONTAINS 0 RECORDS.                                    00420001
004400                                                                  00430001
004500 01  EXPORT-KEY-RECORD                PIC X(050).                 00440001
004600                                                                  00450001
004700*                                                                 00460001
004800******************************************************************00470001
004900 WORKING-STORAGE SECTION.                                         00480001
005000******************************************************************00490001
005100*                                                                 00530001
005200******************************************************************00540001
005300*  RECORD LAYOUT FOR THE EXPORT KEY FILE                          00550001
005400******************************************************************00560001
005500     COPY DLRD004.                                                00570001
005600*                                                                 00580001
005700******************************************************************00590001
005800*  DB2 FORMATTED MESSAGE AREA                                     00600001
005900******************************************************************00610001
006000     COPY DPWS004.                                                00620001
006100*                                                                 00630001
006200*                                                                 00640001
006300     COPY SQLCA2.                                                 00650001
006400*                                                                 00660001
006500******************************************************************00670001
006600*  COMMUNICATIONS AREA FOR DB2                                    00680001
006700******************************************************************00690001
006800*                                                                 00700001
006900     EXEC SQL                                                     00710001
007000          INCLUDE SQLCA                                           00720001
007100     END-EXEC.                                                    00730001
007200*                                                                 00740001
007300*                                                                 00750001
007400******************************************************************00760001
007500*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SU APPLICATION     00770001
007600*  ID BUSINESS EVENT EXPORT TABLE                                 00780001
007700******************************************************************00790001
007800     EXEC SQL                                                     00800001
007900          INCLUDE SUT00037                                        00810001
008000     END-EXEC.                                                    00820001
008100*                                                                 00830001
008200******************************************************************00831001
008300*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE PC APPLICATION     00832001
008400*  ID BUSINESS EVENT EXPORT TABLE                                 00833001
008500******************************************************************00834001
008600     EXEC SQL                                                     00835001
008700          INCLUDE PCT00011                                        00836001
008800     END-EXEC.                                                    00837001
008900*                                                                 00838001
009000 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00840001
009100                                                   COMP SYNC.     00850001
009200                                                                  00860001
009300 01  DATABASE-KEYS.                                               00861002
009400     05  DK-EVNT-EXPRT-ID            PIC S9(09)    COMP.          00861102
009500                                                                  00862002
009600 01  PS-PROGRAM-SWITCHES.                                         00870001
009700     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00880001
009800         88  PS-EOF                                VALUE 'Y'.     00890001
009900         88  PS-NOT-EOF                            VALUE 'N'.     00900001
010000     05  PS-UPDATE-SUCCESSFUL-SW     PIC  X(01)    VALUE 'N'.     00901002
010100         88  PS-UPDATE-SUCCESSFUL                  VALUE 'Y'.     00902002
010200         88  PS-UPDATE-NOT-SUCCESSFUL              VALUE 'N'.     00903002
010300                                                                  00910001
010400 01  PC-PROGRAM-CONSTANTS.                                        00920001
010500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00930001
010600         'DLKUP004'.                                              00940001
010700                                                                  00970001
010800     05  PC-COMMIT-HOLD              PIC 9(3)      VALUE 010.     00980007
010900     05  PC-C                        PIC X(1)      VALUE 'C'.     00990001
011000     05  PC-D                        PIC X(1)      VALUE 'D'.     01000001
011100     05  PC-V                        PIC X(1)      VALUE 'V'.     01010001
011200     05  PC-MAX-RETRIES              PIC S9(03) VALUE 3 COMP-3.   01111499
011300                                                                  01020001
011400 01  PV-PROGRAM-VARIABLES.                                        01030001
011500     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  01040001
011600     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01050001
011700     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             01060001
011800     05  PV-SQLCODE                  PIC  9(4)     VALUE  0.      01061006
011900     05  PV-TIMESTAMP                PIC X(26)   VALUE SPACES.    01070003
012000     05  PV-NOTFND-COUNT             PIC S9(09)  VALUE +0         01080002
012100                                                    COMP-3.       01090002
012200     05  PV-PC-NOTFND-COUNT          PIC S9(09)  VALUE +0         01091002
012300                                                    COMP-3.       01092002
012400     05  PV-SU-NOTFND-COUNT          PIC S9(09)  VALUE +0         01093002
012500                                                    COMP-3.       01094002
012600     05  PV-READ-COUNT               PIC S9(09)  VALUE +0         01100002
012700                                                    COMP-3.       01110002
012800     05  PV-PC-READ-COUNT            PIC S9(09)  VALUE +0         01111002
012900                                                    COMP-3.       01112002
013000     05  PV-SU-READ-COUNT            PIC S9(09)  VALUE +0         01113002
013100                                                    COMP-3.       01114002
013200     05  PV-UPDATE-COUNT             PIC S9(09)  VALUE +0         01120002
013300                                                    COMP-3.       01130002
013400     05  PV-PC-UPDATE-COUNT          PIC S9(09)  VALUE +0         01140002
013500                                                    COMP-3.       01150002
013600     05  PV-SU-UPDATE-COUNT          PIC S9(09)  VALUE +0         01151002
013700                                                    COMP-3.       01152002
013800     05  PV-COMMIT-COUNT             PIC S9(09)  VALUE +0         01160002
013900                                                    COMP-3.       01170002
014000     05  PV-COMMIT-COUNTER           PIC 9(03)     VALUE ZERO.    01180001
014100     05  PV-RETRY-COUNTER            PIC S9(4) VALUE +0 COMP.     01180001
014200                                                                  01190001
014300 01  PV-COMMIT-INFO.                                              01200001
014400     05  FILLER                      PIC X(30) VALUE              01210001
014500        ' EXPORT KEY-RECORD NUMBER: '.                            01220001
014600     05  PV-COMMIT-KEY.                                           01230001
014700         10  PV-COMMIT-KEY-NBR       PIC 9999999999.              01240001
014800         10  FILLER                  PIC X(01) VALUE SPACE.       01250001
014900         10  PV-COMMIT-RECD-NBR      PIC ZZZ,ZZ9.                 01260001
015000         10  FILLER                  PIC X(01) VALUE SPACE.       01270001
015100     05  FILLER                      PIC X(24) VALUE SPACE.       01290001
015200     05  FILLER                      PIC X(22) VALUE              01300001
015300        ' # RECS UPDATED     : '.                                 01310001
015400     05  PV-RECS-UPDATED-COUNT       PIC 9(7)  VALUE 0.           01320001
015500*                                                                 01330001
015600*                                                                 01340001
015700******************************************************************01350001
015800 PROCEDURE DIVISION.                                              01360001
015900******************************************************************01370001
016000                                                                  01380001
016100 0000-PROGRAM-MAINLINE.                                           01390001
016200******************************************************************01400001
016300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01410001
016400*      PROGRAM.                                                   01420001
016500******************************************************************01430001
016600                                                                  01440001
016700     PERFORM 1000-INITIALIZE.                                     01450001
016800     PERFORM 2000-PROCESS-INPUT                                   01460001
016900       UNTIL PS-EOF.                                              01470001
017000     PERFORM 9000-EOJ-ROUTINE.                                    01480001
017100                                                                  01490001
017200     STOP RUN.                                                    01500001
017300*                                                                 01530001
017400 1000-INITIALIZE.                                                 01540001
017500******************************************************************01550001
017600*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01560001
017700******************************************************************01570001
017800                                                                  01580001
017900     OPEN INPUT  EXPORT-KEY-FILE.                                 01590002
018000                                                                  01600001
018100     MOVE +0 TO PV-COMMIT-COUNTER                                 01610001
018200                                                                  01611003
018300     EXEC SQL                                                     01612003
018400          SET :PV-TIMESTAMP = CURRENT TIMESTAMP                   01613003
018500     END-EXEC.                                                    01614003
018600                                                                  01620001
018700     PERFORM 7000-READ-INPUT.                                     01630001
018800                                                                  01640001
018900 2000-PROCESS-INPUT.                                              01670001
019000******************************************************************01680001
019100*  PROCESS THE INPUT FILE AND UPDATE THE EXPRT_STAT_CDE ON THE    01690002
019200*  CORRESPONDING TABLE (EITHER SUT_BUS_EVNT_EXPRT OR              01700002
019300*  PCT_BUS_EVNT_EXPRT) TO A VALUE OF "P" WHICH INDICATES THAT     01710002
019400*  THE ROW HAS BEEN EXTRACTED AND PUBLISHED.                      01711002
019500******************************************************************01720001
019600                                                                  01730001
019700     IF  DL004-PC-APP-ID                                          01731002
019800         ADD +1  TO PV-PC-READ-COUNT                              01731102
019900         PERFORM 8100-UPDATE-PC-EXPORT-TABLE                      01732002
020000     ELSE                                                         01733002
020100         IF  DL004-SU-APP-ID                                      01734002
020200             ADD +1  TO PV-SU-READ-COUNT                          01734102
020300             PERFORM 8200-UPDATE-SU-EXPORT-TABLE                  01735002
020400         ELSE                                                     01736002
020500             MOVE PV-READ-COUNT TO PV-DISPLAY-COUNT               01736102
020600             DISPLAY 'INVALID APP ID: ' DL004-APP-ID-EXPORT-CDE   01736202
020700             DISPLAY 'RECORD NUMBER : ' PV-DISPLAY-COUNT          01736302
020800             PERFORM 9100-SQL-ABEND                               01736402
020900         END-IF                                                   01738002
021000     END-IF.                                                      01739002
021100                                                                  01739102
021200     ADD +1 TO PV-COMMIT-COUNTER.                                 01760001
021300                                                                  01770001
021400     IF PV-COMMIT-COUNTER > PC-COMMIT-HOLD                        01780001
021500         EXEC SQL                                                 01790001
021600            COMMIT                                                01800001
021700         END-EXEC                                                 01810001
021800                                                                  01820001
021900         IF SQLCODE NOT = +0                                      01830001
022000             DISPLAY '### COMMIT FAILED ! ###'                    01840001
022100             PERFORM 9100-SQL-ABEND                               01850001
022200         END-IF                                                   01860001
022300                                                                  01870001
022400         ADD PV-COMMIT-COUNTER           TO PV-COMMIT-COUNT       01880001
022500         MOVE DK-EVNT-EXPRT-ID           TO PV-COMMIT-KEY-NBR     01890002
022600                                                                  01920001
022700         MOVE PV-COMMIT-COUNT    TO PV-RECS-UPDATED-COUNT         01930001
022800         DISPLAY 'COMMIT TAKEN: ' PV-COMMIT-INFO                  01940001
022900                                                                  01950001
023000         MOVE +0 TO PV-COMMIT-COUNTER                             01960001
023100     END-IF.                                                      01970001
023200                                                                  01980001
023300     PERFORM 7000-READ-INPUT.                                     01990001
023400                                                                  02020001
023500 7000-READ-INPUT.                                                 02030001
023600******************************************************************02040001
023700*  READ   THE INPUT FILE                                          02050001
023800******************************************************************02060001
023900     READ EXPORT-KEY-FILE INTO                                    02070002
024000          DL004-EAI-KEY-RECORD-LAYOUT                             02080002
024100          AT END SET PS-EOF  TO TRUE.                             02090001
024200                                                                  02100001
024300     IF PS-NOT-EOF                                                02110001
024400         ADD +1  TO PV-READ-COUNT                                 02120001
024500         MOVE DL004-EVNT-EXPRT-ID TO DK-EVNT-EXPRT-ID             02130002
024600     END-IF.                                                      02160001
024700*                                                                 02170001
024800                                                                  02190001
024900 8100-UPDATE-PC-EXPORT-TABLE.                                     02200002
025000                                                                  02280001
025100     PERFORM WITH TEST AFTER                                      05156099
025200             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 05157099
025300             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         05158099
025400                     (SQLCODE = ZERO OR SQLCODE = +100)           05159099
025500                                                                  05160099
025600         EXEC SQL                                                 02290002
025700             UPDATE PCT_BUS_EVNT_EXPRT                            02300002
025800                SET EXPRT_STAT_CDE = 'P'                          02310002
025900                , LAST_UPD_TMST = :PV-TIMESTAMP                   02311003
026000             WHERE EVNT_EXPRT_ID = :DK-EVNT-EXPRT-ID              02320002
026100         END-EXEC                                                 02360002
026200                                                                  02370001
026300         EVALUATE TRUE                                            02380002
026400             WHEN SQLCODE = ZERO                                  02390002
026500                 ADD +1           TO PV-UPDATE-COUNT              02400002
026600                 ADD +1           TO PV-PC-UPDATE-COUNT           02401002
026700             WHEN SQLCODE = +100                                  02410002
026800                 ADD +1           TO PV-NOTFND-COUNT              02420002
026900                 ADD +1           TO PV-PC-NOTFND-COUNT           02421002
027000             WHEN SQLCODE = -904                                  02430002
027100             WHEN SQLCODE = -911                                  02431004
027200             WHEN SQLCODE = -913                                  02440002
027300                 CONTINUE                                                 
027400         WHEN SQLCODE < ZERO                                      02460002
027500         WHEN SQLCODE > ZERO                                      02470002
027600         WHEN SQLWARN0 = 'W'                                      02480002
027700                 MOVE '8100-UPDATE-PC-EXPORT-TABLE'               02490002
027800                                  TO PV-PARAGRAPH-NAME            02500002
027900                 MOVE 'UPDATE OF PCT_BUS_EVNT_EXPRT'              02510002
028000                                  TO PV-DB2-OPERATION-ATTEMPTED   02520002
028100                 MOVE SQLCODE     TO PV-SQLCODE                   02521005
028200                 PERFORM 9100-SQL-ABEND                           02530002
028300         END-EVALUATE                                             02540002
028400     END-PERFORM.                                                         
028500                                                                  02550002
028600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07476099
028700         (SQLCODE NOT = ZERO AND SQLCODE NOT = +100)              07477099
028800             MOVE '8100-UPDATE-PC-EXPORT-TABLE'                   02441002
028900                              TO PV-PARAGRAPH-NAME                02442002
029000             MOVE 'DEADLOCK * UPDATE PCT_BUS_EVNT_EXPRT'          02443002
029100                              TO PV-DB2-OPERATION-ATTEMPTED       02444002
029200             MOVE SQLCODE     TO PV-SQLCODE                       02444105
029300             PERFORM 9100-SQL-ABEND                               02445002
029400     END-IF.                                                      07479599
029500                                                                  07479699
029600 8200-UPDATE-SU-EXPORT-TABLE.                                     02560002
029700                                                                  02570002
029800     PERFORM WITH TEST AFTER                                      05156099
029900             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 05157099
030000             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         05158099
030100                     (SQLCODE = ZERO OR SQLCODE = +100)           05159099
030200                                                                  05160099
030300         EXEC SQL                                                 02580002
030400             UPDATE SUT_BUS_EVNT_EXPRT                            02590002
030500                SET EXPRT_STAT_CDE = 'P'                          02600002
030600                  , LAST_UPD_TMST  = :PV-TIMESTAMP                02601003
030700             WHERE EVNT_EXPRT_ID = :DK-EVNT-EXPRT-ID              02610002
030800         END-EXEC                                                 02620002
030900                                                                  02630002
031000         EVALUATE TRUE                                            02631002
031100             WHEN SQLCODE = ZERO                                  02632002
031200                 ADD +1       TO PV-UPDATE-COUNT                  02633002
031300                 ADD +1       TO PV-SU-UPDATE-COUNT               02634002
031400             WHEN SQLCODE = +100                                  02635002
031500                 ADD +1       TO PV-NOTFND-COUNT                  02636002
031600                 ADD +1       TO PV-SU-NOTFND-COUNT               02637002
031700             WHEN SQLCODE = -904                                  02638002
031800             WHEN SQLCODE = -911                                  02638104
031900             WHEN SQLCODE = -913                                  02639002
032000                 CONTINUE                                                 
032100             WHEN SQLCODE < ZERO                                  02639702
032200             WHEN SQLCODE > ZERO                                  02639802
032300             WHEN SQLWARN0 = 'W'                                  02639902
032400                 MOVE '8200-UPDATE-SU-EXPORT-TABLE'               02640002
032500                         TO PV-PARAGRAPH-NAME                     02640102
032600                 MOVE 'UPDATE OF SUT_BUS_EVNT_EXPRT'              02640202
032700                         TO PV-DB2-OPERATION-ATTEMPTED            02640302
032800                 MOVE SQLCODE        TO PV-SQLCODE                02640405
032900                 PERFORM 9100-SQL-ABEND                           02640502
033000         END-EVALUATE                                             02640602
033100     END-PERFORM.                                                         
033200                                                                  02550002
033300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    07476099
033400         (SQLCODE NOT = ZERO AND SQLCODE NOT = +100)              07477099
033500             MOVE '8200-UPDATE-SU-EXPORT-TABLE'                   02639102
033600                                 TO PV-PARAGRAPH-NAME             02639202
033700             MOVE 'DEADLOCK * UPDATE SUT_BUS_EVNT_EXPRT'          02639302
033800                                 TO PV-DB2-OPERATION-ATTEMPTED    02639402
033900             MOVE SQLCODE        TO PV-SQLCODE                    02639505
034000     END-IF.                                                      07479599
034100                                                                  07479699
034200                                                                  02641002
034300 9000-EOJ-ROUTINE.                                                02650001
034400******************************************************************02660001
034500*  CLOSE OUTPUT FILE.  DISPLAY RECORD COUNTS                      02670001
034600******************************************************************02680001
034700     CLOSE EXPORT-KEY-FILE.                                       02690002
034800     MOVE PV-READ-COUNT    TO PV-DISPLAY-COUNT.                   02700002
034900     DISPLAY 'TOTAL RECORDS READ        : '  PV-DISPLAY-COUNT.    02710002
035000     MOVE PV-PC-READ-COUNT TO PV-DISPLAY-COUNT.                   02711002
035100     DISPLAY 'TOTAL PC RECORDS READ     : '  PV-DISPLAY-COUNT.    02712002
035200     MOVE PV-SU-READ-COUNT TO PV-DISPLAY-COUNT.                   02713002
035300     DISPLAY 'TOTAL SU RECORDS READ     : '  PV-DISPLAY-COUNT.    02714002
035400     MOVE PV-UPDATE-COUNT TO PV-DISPLAY-COUNT.                    02720001
035500     DISPLAY 'TOTAL RECORDS UPDATED     : '  PV-DISPLAY-COUNT.    02730002
035600     MOVE PV-PC-UPDATE-COUNT TO PV-DISPLAY-COUNT.                 02731002
035700     DISPLAY 'TOTAL PC RECORDS UPDATED  : '  PV-DISPLAY-COUNT.    02732002
035800     MOVE PV-SU-UPDATE-COUNT TO PV-DISPLAY-COUNT.                 02733002
035900     DISPLAY 'TOTAL SU RECORDS UPDATED  : '  PV-DISPLAY-COUNT.    02734002
036000     MOVE PV-NOTFND-COUNT TO PV-DISPLAY-COUNT.                    02740001
036100     DISPLAY 'TOTAL RECORDS NOT FOUND   : '  PV-DISPLAY-COUNT.    02750002
036200     MOVE PV-PC-NOTFND-COUNT TO PV-DISPLAY-COUNT.                 02751002
036300     DISPLAY 'TOTAL PC RECORDS NOT FOUND: '  PV-DISPLAY-COUNT.    02752002
036400     MOVE PV-SU-NOTFND-COUNT TO PV-DISPLAY-COUNT.                 02753002
036500     DISPLAY 'TOTAL SU RECORDS NOT FOUND: '  PV-DISPLAY-COUNT.    02754002
036600*                                                                 02780001
036700 9100-SQL-ABEND.                                                  02790001
036800******************************************************************02800001
036900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    02810001
037000*  ERROR OR WARNING CODE OCCURS.                                  02820001
037100******************************************************************02830001
037200     DISPLAY '9100-SQL-ABEND'.                                    02840001
037300     DISPLAY '** ABEND     **'.                                   02850001
037400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        02860001
037500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              02870001
037600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     02880001
037700     DISPLAY '** SQLCODE   ** = ' PV-SQLCODE.                     02881005
037800     DISPLAY '***'                                                02890001
037900     DISPLAY '*** LAST COMMIT TAKEN **' PV-COMMIT-INFO            02900001
038000     DISPLAY '***'                                                02910001
038100     DISPLAY '*** COMMITTED UPDATE COUNTS FOLLOW: ***'            02920001
038200     DISPLAY '***'                                                02930001
038300     EXEC SQL                                                     02940001
038400          ROLLBACK                                                02950001
038500     END-EXEC.                                                    02960001
038600******************************************************************02970001
038700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    02980001
038800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02990001
038900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     03000001
039000* FORMAT.                                                         03010001
039100******************************************************************03020001
039200     COPY DPPD004.                                                03030001
039300                                                                  03040001
039400     MOVE +4013                  TO ABEND-CODE.                   03050001
039500     CALL 'ILBOABN0' USING ABEND-CODE.                            03060001
