000100*-----------------------*                                         00010006
000200 IDENTIFICATION DIVISION.                                         00020006
000300*-----------------------*                                         00030006
000400 PROGRAM-ID.    PCKCS117.                                         00040006
000500 AUTHOR.        ANNE RECKNAGEL.                                   00050006
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060006
000700 DATE-WRITTEN.  07-01-93.                                         00070006
000800 DATE-COMPILED.                                                   00080006
000900                                                                  00090006
001000*----------------------------------------------------------------*00100006
001100*    E117 - USERID LABEL CREATION                                *00110006
001200*                                                                *00120006
001300*    THIS PROGRAM ALLOWS THE USER TO ENTER A USERID.  THIS WILL  *00130006
001400*    THEN BE CONVERTED INTO BARCODE AND A LABEL PRINTED.  THIS   *00140006
001500*    LABEL WILL BE PLACED ON THE BACK SIDE OF THEIR EMPLOYEE     *00150006
001600*    BADGE.                                                      *00160006
001700*----------------------------------------------------------------*00170006
001710* DATE  11/04/2021                                                        
001720*            - CHANGE CALL OF 'DPKUT100' TO                     *         
001730*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 *         
001740*              MAKING THE CALL DYNAMIC VS STATIC                *         
001750*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232                
1122RM*----------------------------------------------------------------         
1122RM* DATE  11/07/2022                                              *         
1122RM*            - ADD COPYBOOK DPWS930                             *         
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            *         
1122RM*              DYNAMIC.                                         *         
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      *         
001760*-----------------------------------------------------------------        
001800                                                                  00180006
001900 ENVIRONMENT DIVISION.                                            00190006
002000                                                                  00200006
002100 DATA DIVISION.                                                   00210006
002200                                                                  00220006
002300 WORKING-STORAGE SECTION.                                         00230006
002400                                                                  00240006
002500 01  PC-PROGRAM-CONSTANTS.                                        00250006
002600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC117A  '.  00260006
002700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM117 '.  00270006
002800     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS117'.  00280006
002900     05  PC-CICSP1                PIC  X(06)  VALUE  'CICSP1'.    00290006
003000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00300006
003100                                              COMP.               00310006
003200     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  6.           00320006
003300     05  PC-OP-CO-NBR             PIC  X(02)  VALUE  '03'.        00330006
003400     05  PC-OPER-UNT-ID           PIC S9(04)  VALUE +0 COMP.      00340006
003500     05  PC-FCLTY-ID              PIC S9(04)  VALUE +0 COMP.      00350006
003600     05  PC-A                     PIC  X(01)  VALUE 'A'.          00360006
003700     05  PC-01                    PIC  X(02)  VALUE '01'.         00370006
003800     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE 'DPKCS060'.   00380006
003900                                                                  00390006
004000     05  PC-TSYMSG-NUMBERS.                                       00400006
004100         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00410006
004200*            INVALID VALUE                                        00420006
004300         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00430006
004400*            REQUIRED ENTRY                                       00440006
004500         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00450006
004600*            MUST BE NUMERIC                                      00460006
004700         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00470006
004800*            INVALID PRINTER DESTINATION                          00480006
004900*WR-10584                                                         00490011
005000         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00500006
005100         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       00510006
005200*WR-10584                                                         00520011
005300                                                                  00530006
005400 01  PM-PROGRAM-MESSAGES.                                         00540006
005500     05  PM-PROGRAM-MESSAGE-1.                                    00550006
005600         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       00560006
005700         10  FILLER               PIC  X(01)  VALUE '-'.          00570006
005800         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       00580006
005900         10  FILLER               PIC  X(48)  VALUE SPACES.       00590006
006000                                                                  00600006
006100 01  PS-PROGRAM-SWITCHES.                                         00610006
006200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00620006
006300         88  PS-ERROR                         VALUE  'Y'.         00630006
006400         88  PS-NO-ERROR                      VALUE  'N'.         00640006
006500     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         00650006
006600         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         00660006
006700         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         00670006
006800     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         00680006
006900         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         00690006
007000         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         00700006
007100     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         00710006
007200         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         00720006
007300         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         00730006
007400                                                                  00740006
007500 01  PV-PROGRAM-VARIABLES.                                        00750006
007600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00760006
007700                                              COMP SYNC.          00770006
007800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00780006
007900                                              COMP SYNC.          00790006
008000     05  PV-PRINTER-ID            PIC S9(04)  VALUE +0            00800006
008100                                              COMP.               00810006
008200     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            00820006
008300                                              COMP.               00830006
008400     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            00840006
008500                                              COMP.               00850006
008600     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       00860006
008700     05  PV-PIC9-FOUR REDEFINES                                   00870006
008800         PV-PICX-FOUR             PIC 9(04).                      00880006
008900     05  PV-SUPPRESS-FOUR         PIC ZZZ9.                       00890006
009000     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            00900006
009100                                              COMP.               00910006
009200 EJECT                                                            00920006
009300*----------------------------------------------------------------*00930006
009400*  SENDING/RECEIVING AREA FOR THE                                *00940006
009500*  PRINTER VALIDATION ROUTING (DPKCS060)                         *00950006
009600*----------------------------------------------------------------*00960006
009700     COPY DPWS072.                                                00970006
009800                                                                  00980006
009900 EJECT                                                            00990006
010000*----------------------------------------------------------------*01000006
010100*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *01010006
010200*----------------------------------------------------------------*01020006
010300                                                                  01030006
010400     COPY DPWS030.                                                01040006
1122RM     COPY DPWS930.                                                01040006
010500 EJECT                                                            01050006
010600                                                                  01060006
010700*----------------------------------------------------------------*01070006
010800*    NUMERIC EDIT COPYBOOK                                       *01080006
010900*----------------------------------------------------------------*01090006
011000                                                                  01100006
011100     COPY DPWS010I.                                               01110006
011200 EJECT                                                            01120006
011300                                                                  01130006
011400*----------------------------------------------------------------*01140006
011500*    STANDARD COMMAREA.                                          *01150006
011600*----------------------------------------------------------------*01160006
011700                                                                  01170006
011800     COPY DPWS020.                                                01180006
011900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01190006
012000                                                                  01200006
012100*----------------------------------------------------------------*01210006
012200*    INTER-APPLICATION COMMAREA.                                 *01220006
012300*----------------------------------------------------------------*01230006
012400                                                                  01240006
012500         10  INTER-APPL-COMM-AREA PIC X(200).                     01250006
012600*----------------------------------------------------------------*01260006
012700*    SPECIFIC COMMMAREA FOR PCKCS117.                            *01270006
012800*----------------------------------------------------------------*01280006
012900         10  ASC-SPECIFIC-COMMAREA.                               01290006
013000             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          01300006
013100                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.01310006
013200                 88  ASC-ADD-PENDING                    VALUE 'N'.01320006
013300             15  ASC-PRTR-ID.                                     01330006
013400                 20  ASC-PRTR-ID-N           PIC  9(03).          01340006
013500             15  ASC-PRTR-DESC               PIC  X(25).          01350006
013600             15  FILLER                      PIC  X(08).          01360006
013700             15  ASC-USERID                  PIC  X(08).          01370006
013800             15  ASC-OPER-UNT-ID             PIC X(04).           01380006
013900             15  ASC-OPER-UNT-ID-N REDEFINES                      01390006
014000                 ASC-OPER-UNT-ID             PIC 9(04).           01400006
014100             15  ASC-FCLTY-ID                PIC X(04).           01410006
014200             15  ASC-FCLTY-ID-N       REDEFINES                   01420006
014300                 ASC-FCLTY-ID                PIC 9(04).           01430006
014400             15  ASC-OP-UNIT-NAME            PIC X(24).           01440006
014500         10  FILLER                          PIC  X(2788).        01450006
014600     EJECT                                                        01460006
015100*LINK FOR SOCKET PRINT PGM                                        01510006
015200     COPY PCWS140.                                                01520006
015300     EJECT                                                        01530006
015400*----------------------------------------------------------------*01540006
015500*    ABEND PROCESSING COPYBOOK.                                  *01550006
015600*----------------------------------------------------------------*01560006
015700                                                                  01570006
015800     COPY DPWS013.                                                01580006
015900                                                                  01590006
016000     EJECT                                                        01600006
016100*----------------------------------------------------------------*01610006
016200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01620006
016300*----------------------------------------------------------------*01630006
016400                                                                  01640006
016500     COPY DPWS015.                                                01650006
016600                                                                  01660006
016700*----------------------------------------------------------------*01670006
016800*    FUNCTION KEYS COPYBOOK                                      *01680006
016900*----------------------------------------------------------------*01690006
017000                                                                  01700006
017100     COPY DPWS016.                                                01710006
017200                                                                  01720006
017300*----------------------------------------------------------------*01730006
017400*    MAP LAYOUT                                                  *01740006
017500*----------------------------------------------------------------*01750006
017600                                                                  01760006
017700     COPY PCKM117.                                                01770006
017800                                                                  01780006
017900 EJECT                                                            01790006
018000                                                                  01800006
018100*    DB2 AREA FOR COMMUNICATIONS                                  01810006
018200                                                                  01820006
018300     EXEC SQL                                                     01830006
018400          INCLUDE SQLCA                                           01840006
018500     END-EXEC.                                                    01850006
018600/                                                                 01860006
018700*----------------------------------------------------------------*01870006
018800*    DB2 AREA FOR THE LOCATION TABLE - XLT_LOC                   *01880006
018900*----------------------------------------------------------------*01890006
019000                                                                  01900006
019100     EXEC SQL                                                     01910006
019200         INCLUDE XLT00010                                         01920006
019300     END-EXEC.                                                    01930006
019400                                                                  01940006
019500 EJECT                                                            01950006
019600 LINKAGE SECTION.                                                 01960006
019700                                                                  01970006
019800 01  DFHCOMMAREA.                                                 01980006
019900     05  FILLER                         OCCURS  1 TO 4072 TIMES   01990006
020000                                        DEPENDING ON EIBCALEN.    02000006
020100         10  FILLER                     PIC X.                    02010006
020200                                                                  02020006
020300                                                                  02030006
020400 PROCEDURE DIVISION.                                              02040006
020500*----------------------------------------------------------------*02050006
020600*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *02060006
020700*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *02070006
020800*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *02080006
020900*                                                                *02090006
021000*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *02100006
021100*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *02110006
021200*----------------------------------------------------------------*02120006
021300 0000-MAIN-MODULE.                                                02130006
021400                                                                  02140006
021500     INITIALIZE DP030-CICS-API-FIELDS.                            02150006
021600                                                                  02160006
021700     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02170006
021800     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02180006
021900     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02190006
022000                                                                  02200006
022100     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02210006
022200                                                                  02220006
022300     MOVE LENGTH OF PC117AI      TO DP030-MAP-LENGTH (1).         02230006
022400     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02240006
022500                                                                  02250006
022600     PERFORM 0001-CALL-CICS-ARCH-API.                             02260006
022700                                                                  02270006
022800     PERFORM 1000-CONTROL-PROCESSING.                             02280006
022900                                                                  02290006
023000     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02300006
023100                                                                  02310006
023200     PERFORM 0001-CALL-CICS-ARCH-API.                             02320006
023300                                                                  02330006
023400                                                                  02340006
023500 0001-CALL-CICS-ARCH-API.                                         02350006
023600                                                                  02360006
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               02370006
1122RM     CALL DP930-CICS-ARCH-API                                             
1122RM                     USING DFHEIBLK                                       
023800                           DFHCOMMAREA                            02380006
023900                           DP030-CICS-API-FIELDS                  02390006
024000                           DP020-STANDARD-COMMAREA                02400006
024100                           PC117AI.                               02410006
024200                                                                  02420006
024300     IF  DP030-RC-CALL-SUCCESSFUL                                 02430006
024400         CONTINUE                                                 02440006
024500     ELSE                                                         02450006
024600         SET DP013-NO-ROLLBACK   TO TRUE                          02460006
024700         SET DP013-XCTL-DISPLAY-RESTART                           02470006
024800                                 TO TRUE                          02480006
024900         SET DP013-CICS-ABEND    TO TRUE                          02490006
025000         MOVE 'BEFORE 0000-MAIN-MODULE'                           02500006
025100                                 TO DP013-PARAGRAPH               02510006
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02520006
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        02530006
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
025400         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        02540006
025500         PERFORM DP013-0000-PROCESS-ABEND                         02550006
025600     END-IF.                                                      02560006
025700 EJECT                                                            02570006
025800*----------------------------------------------------------------*02580006
025900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02590006
026000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02600006
026100*                                                                *02610006
026200*    PERFORMED BY 0000-MAIN-MODULE.                              *02620006
026300*----------------------------------------------------------------*02630006
026400                                                                  02640006
026500 1000-CONTROL-PROCESSING.                                         02650006
026600                                                                  02660006
026700     EVALUATE TRUE                                                02670006
026800         WHEN DP020-NEXT-ACT-INITIAL                              02680006
026900         WHEN ASC-ADD-COMPLETE                                    02690006
027000             INITIALIZE ASC-SPECIFIC-COMMAREA                     02700006
027100             SET ASC-ADD-PENDING TO TRUE                          02710006
027200             PERFORM 3000-BUILD-INITIAL-PANEL                     02720006
027300                                                                  02730006
027400         WHEN DP020-NEXT-ACT-READ-MAP                             02740006
027500             PERFORM 2000-FKEY-PROCESSING                         02750006
027600                                                                  02760006
027700         WHEN DP020-NEXT-ACT-RETURN                               02770006
027800             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 02780006
027900             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   02790006
028000             PERFORM 3200-DISPLAY-PANEL                           02800006
028100                                                                  02810006
028200         WHEN OTHER                                               02820006
028300             SET DP013-LOGIC-ABEND                                02830006
028400                                 TO TRUE                          02840006
028500             SET DP013-NO-ROLLBACK                                02850006
028600                                 TO TRUE                          02860006
028700             MOVE '1000-CONTROL-PROCESSING'                       02870006
028800                                 TO DP013-PARAGRAPH               02880006
028900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02890006
029000                                 TO DP013-MESSAGE-TEXT(1)         02900006
029100             MOVE DP020-NEXT-APPL-ACTIVITY                        02910006
029200                                 TO DP013-MESSAGE-TEXT(2)         02920006
029300             PERFORM DP013-0000-PROCESS-ABEND                     02930006
029400     END-EVALUATE.                                                02940006
029500                                                                  02950006
029600*----------------------------------------------------------------*02960006
029700*   DETERMINE THE PROCESSING PATH HERE.                          *02970006
029800*                                                                *02980006
029900*   PERFORMED BY 3000.                                           *02990006
030000*----------------------------------------------------------------*03000006
030100                                                                  03010006
030200 2000-FKEY-PROCESSING.                                            03020006
030300                                                                  03030006
030400     EVALUATE TRUE                                                03040006
030500         WHEN DP020-SRC-AID = DP016-CLEAR                         03050006
030600             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 03060006
030700             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   03070006
030800             PERFORM 3200-DISPLAY-PANEL                           03080006
030900                                                                  03090006
031000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03100006
031100             INITIALIZE ASC-SPECIFIC-COMMAREA                     03110006
031200             PERFORM 3000-BUILD-INITIAL-PANEL                     03120006
031300             PERFORM 2210-RESET-ATTRIBUTES                        03130006
031400             PERFORM 3200-DISPLAY-PANEL                           03140006
031500                                                                  03150006
031600         WHEN DP020-SRC-AID = DP016-ENTER                         03160006
031700             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 03170006
031800             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   03180006
031900             PERFORM 3200-DISPLAY-PANEL                           03190006
032000                                                                  03200006
032100         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 03210006
032200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03220006
032300             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 03230006
032400             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   03240006
032500             IF  PS-ERROR                                         03250006
032600                 SET DP030-OVERRIDE-GO                            03260006
032700                                 TO TRUE                          03270006
032800                 PERFORM 3200-DISPLAY-PANEL                       03280006
032900             ELSE                                                 03290006
033000                 SET DP030-CONTINUE-GO                            03300006
033100                                 TO TRUE                          03310006
033200                 PERFORM 4000-SETUP-LABELS                        03320006
033400*WR-10584                                                         03340011
033500                 IF PC140-CRA-SUCCESSFUL                          03350015
033600*WR-10584                                                         03360011
033700                     SET ASC-ADD-COMPLETE                         03370006
033800                                 TO TRUE                          03380006
033900                     SET DP020-MSG-INFORMATIONAL                  03390006
034000                                 TO TRUE                          03400006
034100                     INITIALIZE ASC-SPECIFIC-COMMAREA             03410006
034200                     MOVE SPACES TO ASC-PRTR-ID                   03420006
034300                     PERFORM 2300-MOVE-COMMAREA-TO-SCREEN         03430006
034400                     PERFORM 3000-BUILD-INITIAL-PANEL             03440006
034500                 END-IF                                           03450006
034600             END-IF                                               03460006
034700                                                                  03470006
034800         WHEN OTHER                                               03480006
034900             SET DP013-NO-ROLLBACK                                03490006
035000                                 TO TRUE                          03500006
035100             SET DP013-XCTL-DISPLAY-RESTART                       03510006
035200                                 TO TRUE                          03520006
035300             SET DP013-CICS-ABEND                                 03530006
035400                                 TO TRUE                          03540006
035500             MOVE '2000-FKEY-PROCESSING'                          03550006
035600                                 TO DP013-PARAGRAPH               03560006
035700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03570006
035800                                 TO DP013-MESSAGE-TEXT (1)        03580006
035900             PERFORM DP013-0000-PROCESS-ABEND                     03590006
036000     END-EVALUATE.                                                03600006
036100                                                                  03610006
036200 EJECT                                                            03620006
036300*----------------------------------------------------------------*03630006
036400*    HERE WE SIMPLY MOVE DATA ENTERED ON THE SCREEN TO THE COMM  *03640006
036500*    AREA.                                                       *03650006
036600*                                                                *03660006
036700*    PERFORMED BY 2000-FKEY-PROCESSING.                          *03670006
036800*----------------------------------------------------------------*03680006
036900                                                                  03690006
037000 2100-MOVE-SCREEN-TO-COMMAREA.                                    03700006
037100                                                                  03710006
037200     IF AOPUNITL > ZERO                                           03720006
037300         MOVE AOPUNITI           TO ASC-OPER-UNT-ID               03730006
037400     ELSE                                                         03740006
037500         IF AOPUNITF = DP015-ERASE-EOF                            03750006
037600             MOVE SPACE          TO ASC-OPER-UNT-ID               03760006
037700         END-IF                                                   03770006
037800     END-IF                                                       03780006
037900                                                                  03790006
038000     IF AFACILL  > ZERO                                           03800006
038100         MOVE AFACILI            TO ASC-FCLTY-ID                  03810006
038200     ELSE                                                         03820006
038300         IF AFACILF  = DP015-ERASE-EOF                            03830006
038400             MOVE SPACE          TO ASC-FCLTY-ID                  03840006
038500         END-IF                                                   03850006
038600     END-IF                                                       03860006
038700                                                                  03870006
038800     IF  APRTRL > ZERO                                            03880006
038900         MOVE APRTRI             TO ASC-PRTR-ID                   03890006
039000     ELSE                                                         03900006
039100         IF  APRTRF = DP015-ERASE-EOF                             03910006
039200             MOVE SPACE          TO ASC-PRTR-ID                   03920006
039300         END-IF                                                   03930006
039400     END-IF.                                                      03940006
039500                                                                  03950006
039600     IF  AUSERL > ZERO                                            03960006
039700         MOVE AUSERI             TO ASC-USERID                    03970006
039800     ELSE                                                         03980006
039900         IF  AUSERF = DP015-ERASE-EOF                             03990006
040000             MOVE SPACE          TO ASC-USERID                    04000006
040100         END-IF                                                   04010006
040200     END-IF.                                                      04020006
040300                                                                  04030006
040400*----------------------------------------------------------------*04040006
040500*    HERE WE SIMPLY ENSURE THE DATA IS CORRECT.  IF NOT, ISSUE   *04050006
040600*    APPROPRIATE ERRORS.                                         *04060006
040700*                                                                *04070006
040800*    PERFORMED BY 2000-FKEY-PROCESSING.                          *04080006
040900*----------------------------------------------------------------*04090006
041000                                                                  04100006
041100 2200-EDIT-DATA-IN-COMMAREA.                                      04110006
041200                                                                  04120006
041300     PERFORM 2210-RESET-ATTRIBUTES.                               04130006
041400                                                                  04140006
041500     IF  ASC-USERID = SPACES                                      04150006
041600         SET PS-ERROR            TO TRUE                          04160006
041700         SET DP020-MSG-FATAL     TO TRUE                          04170006
041800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              04180006
041900         MOVE DP015-UNP-ALP-BRT-OFF                               04190006
042000                                 TO AUSERA                        04200006
042100         MOVE DP015-RED          TO AUSERC                        04210006
042200         MOVE DP015-REVERSE      TO AUSERH                        04220006
042300         MOVE -1                 TO AUSERL                        04230006
042400         SET DP030-SET-CURSOR-APPL-1                              04240006
042500                                 TO TRUE                          04250006
042600     END-IF.                                                      04260006
042700                                                                  04270006
042800                                                                  04280006
042900     SET ERROR-ON-FACILITY-EDIT TO TRUE                           04290006
043000     PERFORM 2243-EDIT-FACILITY.                                  04300006
043100                                                                  04310006
043200     SET ERROR-ON-OP-UNIT-EDIT TO TRUE                            04320006
043300     PERFORM 2242-EDIT-OPERATING-UNIT.                            04330006
043400                                                                  04340006
043500     SET ERROR-ON-PRINTER-EDIT TO TRUE                            04350006
043600     PERFORM 2240-EDIT-PRINTER-ID                                 04360006
043700                                                                  04370006
043800                                                                  04380006
043900     IF NO-ERROR-ON-FACILITY-EDIT AND                             04390006
044000        NO-ERROR-ON-OP-UNIT-EDIT  AND                             04400006
044100        NO-ERROR-ON-PRINTER-EDIT                                  04410006
044200            PERFORM 2260-VALIDATE-PRINTER                         04420006
044300*WR-10584                                                         04430011
044400            MOVE ZEROES                 TO PC140-CRA-LOC-ID       04440009
044500            MOVE DP072-XMIT-INTFC-CDE   TO PC140-XMIT-INTFC-CDE   04450009
044600*WR-10584                                                         04460011
044700            IF PS-NO-ERROR                                        04470006
044800                PERFORM 2265-VALIDATE-PRINTER-ID                  04480006
044900                MOVE DP072-XMIT-INTFC-CDE                         04490006
045000*WR-10584                                                         04500011
045100                                     TO PC140-XMIT-INTFC-CDE      04510006
045200*WR-10584                                                         04520011
045300                MOVE DP072-PRTR-LOC-DESC TO ASC-PRTR-DESC         04530006
045400                                            APRDESCO              04540006
045500                MOVE DP072-PRTR-IP-ADDRESS                        04550006
045600                                     TO PC140-UL-IP-ADDRESS       04560015
046000                MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE               04600006
046100                                     TO PC140-UL-OS-RLSE-CDE      04630006
046500                MOVE DP072-PRTR-DATA-XFER-MODE-ID                 04650006
046600                                     TO PC140-UL-XFER-MODE-ID     04680006
047000            END-IF                                                04700006
047100     END-IF                                                       04710006
047200                                                                  04720006
047300                                                                  04730006
047400     IF  PS-NO-ERROR                                              04740006
047500         MOVE -1                 TO APRTRL                        04750006
047600         SET DP030-SET-CURSOR-APPL-1                              04760006
047700                                 TO TRUE                          04770006
047800     END-IF.                                                      04780006
047900                                                                  04790006
048000                                                                  04800006
048100 2210-RESET-ATTRIBUTES.                                           04810006
048200                                                                  04820006
048300     MOVE DP015-UNP-ALP-NOR-OFF  TO AUSERA                        04830006
048400                                    AOPUNITA                      04840006
048500                                    AFACILA                       04850006
048600     MOVE DP015-UNP-NUM-NOR-OFF  TO APRTRA.                       04860006
048700     MOVE DP015-GREEN            TO APRTRC                        04870006
048800                                    AUSERC                        04880006
048900                                    AOPUNITC                      04890006
049000                                    AFACILC                       04900006
049100     MOVE DP015-UNDERLINE        TO APRTRH                        04910006
049200                                    AUSERH                        04920006
049300                                    AOPUNITH                      04930006
049400                                    AFACILH                       04940006
049500     .                                                            04950006
049600                                                                  04960006
049700                                                                  04970006
049800 2242-EDIT-OPERATING-UNIT.                                        04980006
049900                                                                  04990006
050000     IF ASC-OPER-UNT-ID NOT > SPACES                              05000006
050100         SET PS-ERROR            TO TRUE                          05010006
050200         SET DP020-MSG-FATAL     TO TRUE                          05020006
050300         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              05030006
050400         MOVE DP015-UNP-NUM-BRT-OFF                               05040006
050500                                 TO AOPUNITA                      05050006
050600         MOVE DP015-RED          TO AOPUNITC                      05060006
050700         MOVE DP015-REVERSE      TO AOPUNITH                      05070006
050800         MOVE -1                 TO AOPUNITL                      05080006
050900         SET DP030-SET-CURSOR-APPL-1                              05090006
051000                                 TO TRUE                          05100006
051100                                                                  05110006
051200     ELSE                                                         05120006
051300                                                                  05130006
051400         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     05140006
051500*WR-10584                                                         05150011
051600                                        PC140-CRA-OPER-UNT-ID     05160006
051700*WR-10584                                                         05170011
051800         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     05180006
051900         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   05190006
052000                                                                  05200006
052100         SET DP010I-NEGATIVE-NOT-ALLOWED                          05210006
052200                                     TO TRUE                      05220006
052300                                                                  05230006
052410         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
052420                         USING DP010I-NUMERIC-EDIT-AREA                   
052500                                                                  05250006
052600         IF DP010I-NO-ERROR-DETECTED                              05260006
052700             MOVE DP010I-NUMERIC-FIELD                            05270006
052800                                     TO ASC-OPER-UNT-ID-N         05280006
052900                                        PV-SUPPRESS-FOUR          05290006
053000             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  05300006
053100             SET  NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                05310006
053200             PERFORM 2245-GET-OP-UNIT-NAME                        05320006
053300         ELSE                                                     05330006
053400             SET PS-ERROR            TO TRUE                      05340006
053500             SET DP020-MSG-FATAL     TO TRUE                      05350006
053600             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          05360006
053700             MOVE DP015-UNP-NUM-BRT-OFF                           05370006
053800                                     TO AOPUNITA                  05380006
053900             MOVE DP015-RED          TO AOPUNITC                  05390006
054000             MOVE DP015-REVERSE      TO AOPUNITH                  05400006
054100             MOVE -1                 TO AOPUNITL                  05410006
054200             SET DP030-SET-CURSOR-APPL-1                          05420006
054300                                     TO TRUE                      05430006
054400         END-IF                                                   05440006
054500     .                                                            05450006
054600                                                                  05460006
054700 2243-EDIT-FACILITY.                                              05470006
054800                                                                  05480006
054900     MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD         05490006
055000*WR-10584                                                         05500011
055100                                    PC140-CRA-FACLTY-ID           05510006
055200*WR-10584                                                         05520011
055300     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         05530006
055400     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       05540006
055500                                                                  05550006
055600     SET DP010I-NEGATIVE-NOT-ALLOWED                              05560006
055700                                 TO TRUE                          05570006
055800                                                                  05580006
055910     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
055920                         USING DP010I-NUMERIC-EDIT-AREA                   
056000                                                                  05600006
056100     IF DP010I-NO-ERROR-DETECTED                                  05610006
056200         MOVE DP010I-NUMERIC-FIELD                                05620006
056300                                 TO ASC-FCLTY-ID-N                05630006
056400                                    PV-SUPPRESS-FOUR              05640006
056500         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       05650006
056600         SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                    05660006
056700     ELSE                                                         05670006
056800         SET PS-ERROR            TO TRUE                          05680006
056900         SET DP020-MSG-FATAL     TO TRUE                          05690006
057000         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              05700006
057100         MOVE DP015-UNP-NUM-BRT-OFF                               05710006
057200                                 TO AFACILA                       05720006
057300         MOVE DP015-RED          TO AFACILC                       05730006
057400         MOVE DP015-REVERSE      TO AFACILH                       05740006
057500         MOVE -1                 TO AFACILL                       05750006
057600         SET DP030-SET-CURSOR-APPL-1                              05760006
057700                                 TO TRUE                          05770006
057800     END-IF                                                       05780006
057900     .                                                            05790006
058000                                                                  05800006
058100*----------------------------------------------------------------*05810006
058200*    CHECK THE PRINTER ID FOR NUMERIC                            *05820006
058300*----------------------------------------------------------------*05830006
058400                                                                  05840006
058500 2240-EDIT-PRINTER-ID.                                            05850006
058600                                                                  05860006
058700     MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD         05870006
058800*WR-10584                                                         05880011
058900                                    PC140-UL-PRTR-ID.             05890006
059000*WR-10584                                                         05900011
059100     MOVE +3                     TO DP010I-MAXIMUM-DIGITS.        05910006
059200     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      05920006
059300                                                                  05930006
059400     SET DP010I-NEGATIVE-NOT-ALLOWED                              05940006
059500                                 TO TRUE.                         05950006
059600                                                                  05960006
059710     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
059720                         USING DP010I-NUMERIC-EDIT-AREA                   
059800                                                                  05980006
059900     IF DP010I-NO-ERROR-DETECTED                                  05990006
060000         MOVE DP010I-NUMERIC-FIELD                                06000006
060100                                 TO ASC-PRTR-ID-N                 06010006
060200         MOVE ASC-PRTR-ID        TO APRTRO                        06020006
060300         SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                     06030006
060400     ELSE                                                         06040006
060500         SET PS-ERROR            TO TRUE                          06050006
060600         SET DP020-MSG-FATAL     TO TRUE                          06060006
060700         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              06070006
060800         MOVE DP015-UNP-NUM-BRT-OFF                               06080006
060900                                 TO APRTRA                        06090006
061000         MOVE DP015-RED          TO APRTRC                        06100006
061100         MOVE DP015-REVERSE      TO APRTRH                        06110006
061200         MOVE -1                 TO APRTRL                        06120006
061300         SET DP030-SET-CURSOR-APPL-1                              06130006
061400                                 TO TRUE                          06140006
061500     END-IF.                                                      06150006
061600                                                                  06160006
061700/                                                                 06170006
061800 2245-GET-OP-UNIT-NAME.                                           06180006
061900                                                                  06190006
062000     MOVE SPACES            TO ASC-OP-UNIT-NAME                   06200006
062100                               AOPDESCO                           06210006
062200     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        06220006
062300     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     06230006
062400                                                                  06240006
062500     PERFORM                                                      06250006
062600         WITH TEST AFTER                                          06260006
062700         VARYING PV-RETRY-COUNTER                                 06270006
062800         FROM 1 BY 1                                              06280006
062900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               06290006
063000                   OR (SQLCODE = +0)                              06300006
063100                   OR (SQLCODE = +100))                           06310006
063200                                                                  06320006
063300         EXEC SQL                                                 06330006
063400            SELECT  LOC_NM                                        06340006
063500              INTO :XLT00010-LOC-NM                               06350006
063600              FROM  XLT_LOC                                       06360006
063700             WHERE  LOC_NBR     = :PC-OPER-UNT-ID                 06370006
063900         END-EXEC                                                 06390006
064000                                                                  06400006
064100         EVALUATE TRUE                                            06410006
064200             WHEN SQLCODE = +0                                    06420006
064300                 MOVE XLT00010-LOC-NM TO ASC-OP-UNIT-NAME         06430006
064400                                         AOPDESCO                         
064500             WHEN SQLCODE = +100                                  06450006
064600             WHEN SQLCODE = -811                                  06460006
064700             WHEN SQLCODE = -904                                  06470006
064800             WHEN SQLCODE = -913                                  06480006
064900                 CONTINUE                                         06490006
065000             WHEN SQLWARN0 NOT = SPACES                           06500006
065100             WHEN SQLCODE < +0                                    06510006
065200             WHEN SQLCODE > +0                                    06520006
065300                 MOVE '2245-GET-OP-UNIT-NAME'                     06530006
065400                                 TO DP013-PARAGRAPH               06540006
065500                 MOVE 'SELECT STORE NUMBER'                       06550006
065600                                 TO DP013-MESSAGE-TEXT (1)        06560006
065700                 MOVE SQLCA      TO DP013-SQLCA                   06570006
065800                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      06580006
065900                 SET DP013-DB2-ABEND                              06590006
066000                                 TO TRUE                          06600006
066100                 SET DP013-XCTL-DISPLAY-RESTART                   06610006
066200                                 TO TRUE                          06620006
066300                 PERFORM DP013-0000-PROCESS-ABEND                 06630006
066400         END-EVALUATE                                             06640006
066500     END-PERFORM.                                                 06650006
066600                                                                  06660006
066700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        06670006
066800         MOVE '3010-VALIDATE-FCLTY-ID'                            06680006
066900                                 TO DP013-PARAGRAPH               06690006
067000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     06700006
067100                                 TO DP013-MESSAGE-TEXT (1)        06710006
067200         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        06720006
067300         MOVE SQLCA              TO DP013-SQLCA                   06730006
067400         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      06740006
067500         SET DP013-DB2-ABEND     TO TRUE                          06750006
067600         SET DP013-XCTL-DISPLAY-RESTART                           06760006
067700                                 TO TRUE                          06770006
067800         PERFORM DP013-0000-PROCESS-ABEND                         06780006
067900     END-IF.                                                      06790006
068000                                                                  06800006
068100                                                                  06810006
068200*---------------------------------------------------------------* 06820006
068300*   2260-VALIDATE-PRINTER                                       * 06830006
068400* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                     * 06840006
068500*---------------------------------------------------------------* 06850006
068600 2260-VALIDATE-PRINTER.                                           06860006
068700                                                                  06870006
068800                                                                  06880006
068900     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            06890006
069000     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           06900006
069100     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        06910006
069200     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     06920006
069300                                     DP072-OPER-UNT-ID.           06930006
069400     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        06940006
069500                                     DP072-FCLTY-ID.              06950006
069600                                                                  06960006
069700     SET DP072-VALIDATE           TO TRUE.                        06970006
069800                                                                  06980006
069900     EXEC CICS                                                    06990006
070000          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  07000006
070100               COMMAREA (DP072-COMM-AREA)                         07010006
070200               RESP     (PV-CICS-RESPONSE)                        07020006
070300     END-EXEC.                                                    07030006
070400                                                                  07040006
070500     EVALUATE TRUE                                                07050006
070600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07060006
070700              CONTINUE                                            07070006
070800         WHEN OTHER                                               07080006
070900              SET PS-ERROR                TO TRUE                 07090006
071000              SET DP020-MSG-FATAL         TO TRUE                 07100006
071100              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     07110006
071200              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               07120006
071300              MOVE DP015-RED              TO APRTRC               07130006
071400              MOVE DP015-REVERSE          TO APRTRH               07140006
071500              MOVE -1                     TO APRTRL               07150006
071600              MOVE SPACES                 TO ASC-PRTR-DESC        07160006
071700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07170006
071800              PERFORM DP013-0000-PROCESS-ABEND                    07180006
071900     END-EVALUATE.                                                07190006
072000                                                                  07200006
072100 EJECT                                                            07210006
072200*----------------------------------------------------------------*07220006
072300*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *07230006
072400*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *07240006
072500*  CAN BE PRINTED ON THIS PRINTER.                               *07250006
072600*----------------------------------------------------------------*07260006
072700 2265-VALIDATE-PRINTER-ID.                                        07270006
072800                                                                  07280006
072900     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     07290006
073000         CONTINUE                                                 07300006
073100     ELSE                                                         07310006
073200         SET  PS-ERROR                TO TRUE                     07320006
073300         SET  DP020-MSG-FATAL         TO TRUE                     07330006
073400         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         07340006
073500         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   07350006
073600         MOVE DP015-RED               TO APRTRC                   07360006
073700         MOVE DP015-REVERSE           TO APRTRH                   07370006
073800         MOVE -1                      TO APRTRL                   07380006
073900         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     07390006
074000     END-IF.                                                      07400006
074100                                                                  07410006
074200 EJECT                                                            07420006
074300*----------------------------------------------------------------*07430006
074400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07440006
074500*                                                                *07450006
074600*----------------------------------------------------------------*07460006
074700                                                                  07470006
074800 2300-MOVE-COMMAREA-TO-SCREEN.                                    07480006
074900                                                                  07490006
075000     MOVE ASC-OPER-UNT-ID-N      TO PV-SUPPRESS-FOUR              07500006
075100     MOVE PV-SUPPRESS-FOUR       TO AOPUNITO                      07510006
075200     MOVE ASC-FCLTY-ID-N         TO PV-SUPPRESS-FOUR              07520006
075300     MOVE PV-SUPPRESS-FOUR       TO AFACILO                       07530006
075400     MOVE ASC-PRTR-ID            TO APRTRO.                       07540006
075500     MOVE ASC-PRTR-DESC          TO APRDESCO.                     07550006
075600     MOVE ASC-USERID             TO AUSERO.                       07560006
075700                                                                  07570006
075800 EJECT                                                            07580006
075900*----------------------------------------------------------------*07590006
076000*    NO INFORMATION IS DEFAULTED TO, DISPLAY BLANK MAP.          *07600006
076100*----------------------------------------------------------------*07610006
076200                                                                  07620006
076300 3000-BUILD-INITIAL-PANEL.                                        07630006
076400                                                                  07640006
076500     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          07650006
076600     MOVE -1                     TO APRTRL.                       07660006
076700                                                                  07670006
076800*    *-------------------------------------*                      07680006
076900*    * DEFAULT OPERATING UNIT AND FACILITY *                      07690006
077000*    *-------------------------------------*                      07700006
077100     PERFORM 3300-FORMAT-OP-UNIT                                  07710006
077200                                                                  07720006
077300     PERFORM 3400-FORMAT-FCLTY-ID                                 07730006
077400                                                                  07740006
077500     PERFORM 3200-DISPLAY-PANEL.                                  07750006
077600                                                                  07760006
077700                                                                  07770006
077800*----------------------------------------------------------------*07780006
077900*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *07790006
078000*                                                                *07800006
078100*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *07810006
078200*    PERFORMED BY 3000-PROCESS-PANEL.                            *07820006
078300*----------------------------------------------------------------*07830006
078400                                                                  07840006
078500 3200-DISPLAY-PANEL.                                              07850006
078600                                                                  07860006
078700     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            07870006
078800     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           07880006
078900                                                                  07890006
079000/                                                                 07900006
079100 3300-FORMAT-OP-UNIT.                                             07910006
079200                                                                  07920006
079300     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD         07930006
079400     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         07940006
079500     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       07950006
079600                                                                  07960006
079700     SET DP010I-NEGATIVE-NOT-ALLOWED                              07970006
079800                                 TO TRUE                          07980006
079900                                                                  07990006
080010     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
080020                         USING DP010I-NUMERIC-EDIT-AREA                   
080100                                                                  08010006
080200     IF DP010I-NO-ERROR-DETECTED                                  08020006
080300         MOVE DP010I-NUMERIC-FIELD                                08030006
080400                                 TO PV-PIC9-FOUR                  08040006
080500         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              08050006
080600         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      08060006
080700                                    ASC-OPER-UNT-ID               08070006
080800     ELSE                                                         08080006
080900         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  08090006
081000         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              08100006
081100         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      08110006
081200                                    ASC-OPER-UNT-ID               08120006
081300                                                                  08130006
081400     .                                                            08140006
081500                                                                  08150006
081600/                                                                 08160006
081700 3400-FORMAT-FCLTY-ID.                                            08170006
081800                                                                  08180006
081900     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD         08190006
082000     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         08200006
082100     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       08210006
082200                                                                  08220006
082300     SET DP010I-NEGATIVE-NOT-ALLOWED                              08230006
082400                                 TO TRUE                          08240006
082500                                                                  08250006
082610     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
082620                         USING DP010I-NUMERIC-EDIT-AREA                   
082700                                                                  08270006
082800     IF DP010I-NO-ERROR-DETECTED                                  08280006
082900         MOVE DP010I-NUMERIC-FIELD                                08290006
083000                                 TO PV-PIC9-FOUR                  08300006
083100         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              08310006
083200         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       08320006
083300                                    ASC-FCLTY-ID-N                08330006
083400     ELSE                                                         08340006
083500         MOVE DP020-FCLTY-ID     TO AFACILO                       08350006
083600                                    ASC-FCLTY-ID                  08360006
083700         SET PS-ERROR            TO TRUE                          08370006
083800         SET DP020-MSG-FATAL     TO TRUE                          08380006
083900         MOVE PC-TSYMSG-00005                                     08390006
084000                                 TO DP020-MSG-NUMBER              08400006
084100         MOVE DP015-UNP-ALP-BRT-OFF                               08410006
084200                                 TO AFACILA                       08420006
084300         MOVE DP015-RED          TO AFACILC                       08430006
084400         MOVE DP015-REVERSE      TO AFACILH                       08440006
084500         MOVE -1                 TO AFACILL                       08450006
084600         SET DP030-SET-CURSOR-APPL-1                              08460006
084700                                 TO TRUE                          08470006
084800     .                                                            08480006
084900 EJECT                                                            08490006
085000 4000-SETUP-LABELS.                                               08500006
085100                                                                  08510006
085400     SET PC140-COMMON-USERID-LBL-NBR TO TRUE.                     08540006
085500*WR-10584                                                         08550011
085600                                                                  08560006
086200     MOVE ASC-PRTR-ID            TO PC140-UL-PRTR-ID.             08620006
086300     MOVE PC-CICSP1              TO PC140-UL-CICS.                08630012
086400     MOVE ASC-USERID             TO PC140-UL-USERID.              08640012
086500                                                                  08650006
086600*WR-10584                                                         08660012
086800     PERFORM 4600-LINK-SOCKET-PRINT-ROUTINE.                            12
087200                                                                  08720006
089700 4600-LINK-SOCKET-PRINT-ROUTINE.                                  08970006
089800                                                                  08980006
089900     MOVE DP020-USERID           TO PC140-CRA-USERID.             08990006
090000     MOVE 400                    TO PV-COMMAREA-LENGTH.           09000006
090100                                                                  09010006
090200     EXEC CICS                                                    09020006
090300          LINK PROGRAM  ('PCKCS707')                              09030006
090400               COMMAREA (PC140-LABELMST)                          09040006
090500               LENGTH   (PV-COMMAREA-LENGTH)                      09050006
090600               RESP     (PV-CICS-RESPONSE)                        09060006
090700     END-EXEC.                                                    09070006
090800                                                                  09080006
090900     EVALUATE TRUE                                                09090006
091000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09100006
091100              CONTINUE                                            09110006
091200         WHEN OTHER                                               09120006
091300              PERFORM DP013-0000-PROCESS-ABEND                    09130006
091400     END-EVALUATE.                                                09140006
091500     IF PC140-CRA-SOCKET-COMM-ERROR                               09150006
091600         SET PS-ERROR            TO TRUE                          09160006
091700         SET DP020-MSG-FATAL     TO TRUE                          09170006
091800         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              09180006
091900         MOVE DP015-UNP-NUM-BRT-OFF                               09190006
092000                                 TO APRTRA                        09200006
092100         MOVE DP015-RED          TO APRTRC                        09210006
092200         MOVE DP015-REVERSE      TO APRTRH                        09220006
092300         MOVE -1                 TO APRTRL                        09230006
092400         SET DP030-SET-CURSOR-APPL-1                              09240006
092500                                 TO TRUE                          09250006
092600     ELSE                                                         09260006
092700     IF PC140-CRA-INVALID-PRT-FMT                                 09270006
092800         SET PS-ERROR            TO TRUE                          09280006
092900         SET DP020-MSG-FATAL     TO TRUE                          09290006
093000         MOVE DP015-UNP-NUM-BRT-OFF                               09300006
093100                                 TO APRTRA                        09310006
093200         MOVE DP015-RED          TO APRTRC                        09320006
093300         MOVE DP015-REVERSE      TO APRTRH                        09330006
093400         MOVE -1                 TO APRTRL                        09340006
093500         SET DP030-SET-CURSOR-APPL-1                              09350006
093600                                 TO TRUE                          09360006
093700         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                09370006
093800         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                09380006
093900         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            09390006
094000     ELSE                                                         09400006
094100         SET DP020-MSG-INFORMATIONAL TO TRUE                      09410006
094200         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              09420006
094300         MOVE -1                 TO APRTRL                        09430006
094400         SET DP030-SET-CURSOR-APPL-1                              09440006
094500                                 TO TRUE                          09450006
094600     END-IF.                                                      09460006
094700*WR-10584                                                         09470011
094800 EJECT                                                            09480006
094900*----------------------------------------------------------------*09490006
095000*    ABEND PROCESSOR MODULE                                      *09500006
095100*----------------------------------------------------------------*09510006
095200                                                                  09520006
095300     COPY DPPD013.                                                09530006
