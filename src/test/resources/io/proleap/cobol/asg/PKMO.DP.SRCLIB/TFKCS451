      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    TFKCS451.                                         00040000
       AUTHOR.        JACK KRAMER.                                      00050000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
       DATE-WRITTEN.  JANUARY 1997.                                     00070000
       DATE-COMPILED.                                                   00080000
                                                                        00090000
      *---------------------------------------------------------------* 00100000
      *    P451 - RECEIVE TRANSFER HEADER.                            * 00110000
      *                                                               * 00120000
      *    THIS PROGRAM DISPLAYS TRANSFER HEADER INFORMATION AND      * 00130000
      *    ALLOWS THE USER TO ENTER SEAL/TRAILER INFORMATION AND      * 00140000
      *    RECEIVED BY INITIAL AND NAME. THE USER MAY ELECT TO GO TO  * 00150000
      *    LINE ITEM RECEIPT OR RECEIVE THE TRANSFER WITHOUT DOING    * 00160000
      *    A DETAIL RECEIPT.                                          * 00170000
      *---------------------------------------------------------------* 00180000
      *  1/20/2003 - RAY GRAF                                           00181000
      *   PROCESS NONINTELLIGENT SKU.                                   00182000
111703******************************************************************00184000
111703* 11/17/2003 - RAY GRAF                                           00185000
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00186000
111703******************************************************************00187000
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00188000
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00189000
      ***************************************************************** 00189100
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00189200
100404**     EXPAND STORE NUMBER.  MAKE DOMAIN COMPLIANT.               00189300
      ***************************************************************** 00189400
SR3403*  DATE 03/19/12 JALAJ KUMAR                WR#SR3403             00189500
SR3403*  PRICE FIELD EXPANSIONS FOR LARGE RETAIL PROJECT                00189600
SR3403******************************************************************00189700
CICS  * CHANGED 11/16/2022    BY JIM HUNTER      WR: CHG0278345         00189899
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00189999
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00190099
CICS  *-----------------------------------------------------------------00190199
      * CHANGED 04/14/2023    BY JEAN KURK       WR: CHG0281369         00190299
      * REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE                    00190399
      *-----------------------------------------------------------------00190599
       EJECT                                                            00191000
       ENVIRONMENT DIVISION.                                            00200000
                                                                        00210000
       DATA DIVISION.                                                   00220000
                                                                        00230000
       WORKING-STORAGE SECTION.                                         00240000
                                                                        00250000
       01  DK-DB2-KEYS.                                                 00260000
           15  DK-XFER-DKEY-ID                PIC  S9(9)  VALUE ZERO    00270000
                                                          COMP.         00280000
           15  DK-STORE-NBR                   PIC  S9(4)  VALUE ZERO    00290000
                                                          COMP.         00300000
                                                                        00310000
       01  PC-PROGRAM-CONSTANTS.                                        00320000
           05  PC-KOHLS-OPERATING-COMPANY     PIC  X(02)  VALUE '03'.   00330000
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340000
                                                          'TF451A  '.   00350000
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360000
                                                          'TFKM451 '.   00370000
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380000
                                                          'TFKCS451'.   00390000
           05  PC-COMMON-MAP1-NAME            PIC  X(08)  VALUE         00400000
                                                          'TF451A  '.   00410000
           05  PC-TOTE-MAP-NAME               PIC  X(08)  VALUE         00420000
                                                          'TF451B  '.   00430000
           05  PC-TRAILER-MAP-NAME            PIC  X(08)  VALUE         00440000
                                                          'TF451C  '.   00450000
           05  PC-COMMON-MAP2-NAME            PIC  X(08)  VALUE         00460000
                                                          'TF451D  '.   00470000
           05  PC-CALLBACK-MAP-NAME           PIC  X(08)  VALUE         00580000
                                                          'TF451E  '.   00590000
           05  PC-NON-CALLBACK-MAP-NAME       PIC  X(08)  VALUE         00590100
                                                          'TF451F  '.   00590200
           05  PC-COMMON-MAP3-NAME            PIC  X(08)  VALUE         00590300
                                                          'TF451G  '.   00590400
111703*    05  PC-DEFECTIVE-DAMAGE            PIC  X(02)  VALUE '01'.   00790000
111703     05  PC-DEFECTIVE-DAMAGE-SORT1      PIC  X(02)  VALUE '00'.   00791000
111703     05  PC-DEFECTIVE-DAMAGE-SORT2      PIC  X(02)  VALUE '01'.   00792000
           05  PC-CALLBACK                    PIC  X(02)  VALUE '02'.   00800000
           05  PC-STOCK-BAL-CORP              PIC  X(02)  VALUE '03'.   00810000
           05  PC-STOCK-BAL-STORE             PIC  X(02)  VALUE '04'.   00820000
           05  PC-CUSTOMER                    PIC  X(02)  VALUE '05'.   00830000
           05  PC-NON-RETAIL                  PIC  X(02)  VALUE '06'.   00840000
           05  PC-SECURE-TOTE                 PIC  X(02)  VALUE '02'.   00850000
           05  PC-TRAILER                     PIC  X(02)  VALUE '04'.   00860000
           05  PC-SETUP-FORMAT                PIC  X(01)  VALUE '1'.    00870000
           05  PC-MAX-TIMESTAMP               PIC  X(26)  VALUE         00880000
                            '9999-12-31-24.00.00.000000'.               00890000
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00960000
                                                          COMP-3.       00970000
           05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00980000
                                                           COMP SYNC.   00990000
           05  PC-FASHION-SALES                PIC  X(02)  VALUE 'FS'.  01000000
           05  PC-MERCHANDISE-LEDGER           PIC  X(02)  VALUE 'ML'.  01010000
           05  PC-COMPLETE-RSN-CDE             PIC  X(02)  VALUE 'CM'.  01020000
           05  PC-ADJUSTMENT-RSN-CDE           PIC  X(02)  VALUE 'AD'.  01030000
           05  PC-MISDIRECT-RSN-CDE            PIC  X(02)  VALUE 'MD'.  01040000
           05  PC-ASSUMPTIVELY-RECEIVED        PIC  X(02)  VALUE 'AR'.  01050000
           05  PC-COMPLETED                    PIC  X(02)  VALUE 'CM'.  01060000
           05  PC-INTERMEDIATELY-RECEIVED      PIC  X(02)  VALUE 'IR'.  01070000
           05  PC-POSITIVE-RECEIPT             PIC  X(02)  VALUE 'PR'.  01080000
           05  PC-NO                           PIC  X(01)  VALUE 'N'.   01090000
           05  PC-YES                          PIC  X(01)  VALUE 'Y'.   01090100
           05  PC-CLEARANCE-STATUS             PIC  9(02)  VALUE 30.    01090300
      *                                                                 01090400
           05  PC-TSYMSG-NUMBERS.                                       01090500
               10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01090600
               10  PC-TSYMSG-00010            PIC  9(05)  VALUE 00010.  01090700
               10  PC-TSYMSG-01403            PIC  9(05)  VALUE 01403.  01100000
               10  PC-TSYMSG-01506            PIC  9(05)  VALUE 01506.  01120000
               10  PC-TSYMSG-01507            PIC  9(05)  VALUE 01507.  01120100
               10  PC-TSYMSG-01508            PIC  9(05)  VALUE 01508.  01120200
               10  PC-TSYMSG-01520            PIC  9(05)  VALUE 01520.  01120300
               10  PC-TSYMSG-01677            PIC  9(05)  VALUE 01677.  01120400
               10  PC-TSYMSG-01678            PIC  9(05)  VALUE 01678.  01120500
               10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01120600
           05  PC-CALLBACK-LITERAL            PIC  X(15)  VALUE         01121000
                   'CALLBACK NO...:'.                                   01122000
           05  PC-APPROVAL-LITERAL            PIC  X(15)  VALUE         01123000
                   'APPROVAL NO...:'.                                   01124000
           05  PC-REQUESTOR-LITERAL           PIC  X(15)  VALUE         01124100
                   'REQUESTED BY..:'.                                   01124200
           05  PC-ATTENTION-LITERAL           PIC  X(15)  VALUE         01125000
                   'ATTENTION TO..:'.                                   01126000
           05  PC-CUST-NAME-LITERAL           PIC  X(15)  VALUE         01126100
                   'CUSTOMER NAME.:'.                                   01126200
           05  PC-CUST-PHONE-LITERAL          PIC  X(15)  VALUE         01126300
                   'CUSTOMER PHONE:'.                                   01126400
           05  PC-ADDRESS-LITERAL             PIC  X(12)  VALUE         01126500
                   'ADDRESS....:'.                                      01126600
           05  PC-CITY-LITERAL                PIC  X(12)  VALUE         01126700
                   'CITY.......:'.                                      01126800
           05  PC-STATE-LITERAL               PIC  X(12)  VALUE         01126900
                   'STATE/ZIP..:'.                                      01127000
      *                                                                 01130000
       01  PS-PROGRAM-SWITCHES.                                         01140000
           05  PS-DISCREPANCY-SW              PIC  X(01)  VALUE 'Y'.    01180000
               88  PS-DISCREPANCY-EXISTS                  VALUE 'Y'.    01190000
               88  PS-NO-DISCREPANCY-EXISTS               VALUE 'N'.    01200000
           05  PS-XFER-DISCREPANCY-IND         PIC  X(01)  VALUE 'N'.   01210000
               88  PS-NO-XFER-DISCREPANCY                  VALUE 'N'.   01220000
               88  PS-XFER-DISCREPANCY                     VALUE 'Y'.   01230000
           05  PS-TRANSFER-FOUND-SW           PIC  X(01)  VALUE 'N'.    01300000
               88  PS-TRANSFER-FOUND                      VALUE 'Y'.    01310000
               88  PS-TRANSFER-NOT-FOUND                  VALUE 'N'.    01320000
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01330000
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    01340000
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01350000
           05  PS-XFER-ITMS-IND                PIC  X(01)  VALUE 'N'.   01360000
               88  PS-MORE-XFER-ITMS                       VALUE 'N'.   01370000
               88  PS-END-OF-XFER-ITMS                     VALUE 'Y'.   01380000
           05  PS-UPDATE-IND                   PIC  X(01)  VALUE 'N'.   01390000
               88  PS-UPDATE-STATUS                        VALUE 'U'.   01400000
               88  PS-INSERT-STATUS                        VALUE 'I'.   01400100
      *                                                                 01400200
       01  PV-PROGRAM-VARIABLES.                                        01400300
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01400400
                                                    COMP SYNC.          01400500
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      01400600
                                                          COMP SYNC.    01400700
           05  PV-XFER-NBR.                                             01400800
100404*        10  PV-XFER-FR-STR             PIC 9(03).                01400900
100404         10  PV-XFER-FR-STR             PIC 9(04).                01401000
               10  PV-XFER-SEQ-NBR            PIC 9(06).                01401100
           05  PV-MAP-START-BYTE              PIC S9(04)  VALUE ZERO    01401200
                                                          COMP SYNC.    01401300
           05  PV-DISPLAY-AREA.                                         01401400
               10  PV-DISPLAY-ITM-NBR          PIC  9(15)  VALUE ZEROS. 01401500
               10  PV-DISPLAY-XFER-DKEY-ID     PIC  9(09)  VALUE ZEROS. 01401600
               10  PV-DISPLAY-XFER-LNE-NBR     PIC  9(04)  VALUE ZEROS. 01401700
               10  PV-DISPLAY-XFER-LNE-SEQ-NBR PIC  9(04)  VALUE ZEROS. 01401800
               10  PV-DISPLAY-PSTG-SEQ-NBR     PIC  9(04)  VALUE ZEROS. 01401900
           05  PV-XFER-QTY              PIC S9(05)    VALUE +0 COMP-3.  01402000
           05  PV-XFER-PRICE            PIC S9(09)V99 VALUE +0 COMP-3.  01402100
           05  PV-XFER-QTY-IND          PIC S9(04)  VALUE +0            01402200
                                                    COMP SYNC.          01402300
           05  PV-XFER-PRICE-IND        PIC S9(04)  VALUE +0            01402400
                                                    COMP SYNC.          01402500
           05  PV-PSTG-SEQ-NBR                 PIC S9(04)  VALUE ZEROS  01402600
                                                           COMP SYNC.   01402700
           05  PV-DB2-NULL-IND                 PIC S9(04)  VALUE ZEROS  01402800
                                                           COMP SYNC.   01402900
           05  PV-NAME.                                                 01480000
               10  PV-INT                     PIC X(01).                01480100
               10                             PIC X(01) VALUE SPACE.    01480200
               10  PV-NAM                     PIC X(20).                01480300
           05  PV-PHONE.                                                01480400
               10                             PIC X(01) VALUE '('.      01480500
               10  PV-PHONE-AREA              PIC 9(03).                01480600
               10                             PIC X(02) VALUE ')-'.     01480700
               10  PV-PHONE-EXCH              PIC 9(03).                01480800
               10                             PIC X(01) VALUE '-'.      01480900
               10  PV-PHONE-NBR               PIC 9(04).                01481000
           05  PV-ZIP.                                                  01481100
               10  PV-ZIP-CODE                PIC X(05).                01481200
               10  PV-ZIP-DASH                PIC X(01).                01481300
               10  PV-ZIP-EXT                 PIC X(04).                01481400
           05  PV-CURRENT-TIMESTAMP           PIC X(26).                01481500
           05  PV-CUR-RTL-AMT                  PIC S9(7)V9(2) COMP-3.   01481900
SR3403     05  PV-CICS-APPL-ID.                                         01482099
SR3403         10  FILLER                     PIC X(4).                 01483099
SR3403         10  PV-CICS-REGION-ENVIRONMENT PIC X.                    01484099
SR3403             88  PV-CR-PRODUCTION            VALUE 'P'.           01485099
SR3403         10  PV-FILLER                  PIC X(3).                 01486099
           EJECT                                                        01670000
      ***************************************************************** 01686000
      **                  SYMBOLIC MAP DESCRIPTION                   ** 01690000
      **                                                             ** 01700000
      **  THE MAPSET FOR THIS PROGRAM CONSISTS OF 7 SEPERATE MAPS.   ** 01710000
      **  5 MAPS WILL BE DISPLAYED AT ONE TIME; THE SPECIFIC MAPS    ** 01720000
      **  DISPLAYED WILL DEPEND ON THE CONTAINER TYPE AND TRANSFER   ** 01730000
      **  TYPE BEING PROCESSED.                                      ** 01740000
      **  THE MAPS CONTAIN DATA AS FOLLOWS:                          ** 01750000
      **                                                             ** 01760000
      **  A)  COMMON HEADER MAP 1 - TRANSFER NUMBER & RECEIVED BY.   ** 01770000
      **  B)  TOTE SEAL INFO FOR ALL CONTAINERS EXCEPT TRAILER.      ** 01830000
      **  C)  TRAILER NUMBER & SEAL INFO FOR TRAILER CONTAINERS.     ** 01840000
      **  D)  COMMON HEADER MAP 2.                                   ** 01840100
      **  E)  CALLBACK NUMBER - FOR CALLBACK TRANSFER TYPE.          ** 01840200
      **  F)  NON-CALLBACK LINE 8.                                   ** 01840300
      **  G)  COMMON HEADER MAP 3 - REMAINING HEADER INFO.           ** 01840400
      ***************************************************************** 01870000
       01  MR-MAPSET-REDEFINITION.                                      01880000
           05  MR-A-COMMON.                                             01890000
               10  FILLER                        PIC  X(12).            01891000
               10  MR-A-RECV-STR-L               PIC S9(04)  COMP.      01910000
               10  MR-A-RECV-STR-A               PIC  X(01).            01920000
               10  MR-A-RECV-STR-C               PIC  X(01).            01930000
               10  MR-A-RECV-STR-H               PIC  X(01).            01940000
100404*        10  MR-A-RECV-STR                 PIC  X(03).            01950000
100404         10  MR-A-RECV-STR                 PIC  X(04).            01951000
      *                                                                 01960000
               10  MR-A-XFER-NBR-L               PIC S9(04)  COMP.      01960100
               10  MR-A-XFER-NBR-A               PIC  X(01).            01960200
               10  MR-A-XFER-NBR-C               PIC  X(01).            01960300
               10  MR-A-XFER-NBR-H               PIC  X(01).            01960400
100404*        10  MR-A-XFER-NBR                 PIC  X(12).            01960500
100404         10  MR-A-XFER-NBR                 PIC  X(13).            01960600
      *                                                                 01960700
               10  MR-A-RECV-BY-INT-L            PIC S9(04)  COMP.      02700000
               10  MR-A-RECV-BY-INT-A            PIC  X(01).            02710000
               10  MR-A-RECV-BY-INT-C            PIC  X(01).            02720000
               10  MR-A-RECV-BY-INT-H            PIC  X(01).            02730000
               10  MR-A-RECV-BY-INT              PIC  X(01).            02740000
      *                                                                 02750000
               10  MR-A-RECV-BY-NAM-L            PIC S9(04)  COMP.      02760000
               10  MR-A-RECV-BY-NAM-A            PIC  X(01).            02770000
               10  MR-A-RECV-BY-NAM-C            PIC  X(01).            02780000
               10  MR-A-RECV-BY-NAM-H            PIC  X(01).            02790000
               10  MR-A-RECV-BY-NAM              PIC  X(20).            02800000
      *                                                                 04160000
           05  MR-B-TOTES.                                              04170000
               10  FILLER                        PIC  X(12).            04180000
               10  MR-B-LG-TOTE-SEAL1-L          PIC S9(04)  COMP.      04190000
               10  MR-B-LG-TOTE-SEAL1-A          PIC  X(01).            04200000
               10  MR-B-LG-TOTE-SEAL1-C          PIC  X(01).            04210000
               10  MR-B-LG-TOTE-SEAL1-H          PIC  X(01).            04220000
               10  MR-B-LG-TOTE-SEAL1            PIC  X(07).            04230000
      *                                                                 04240000
               10  MR-B-LG-TOTE-SEAL2-L          PIC S9(04)  COMP.      04250000
               10  MR-B-LG-TOTE-SEAL2-A          PIC  X(01).            04260000
               10  MR-B-LG-TOTE-SEAL2-C          PIC  X(01).            04270000
               10  MR-B-LG-TOTE-SEAL2-H          PIC  X(01).            04280000
               10  MR-B-LG-TOTE-SEAL2            PIC  X(07).            04290000
      *                                                                 04300000
               10  MR-B-SM-TOTE-SEAL-L           PIC S9(04)  COMP.      04310000
               10  MR-B-SM-TOTE-SEAL-A           PIC  X(01).            04320000
               10  MR-B-SM-TOTE-SEAL-C           PIC  X(01).            04330000
               10  MR-B-SM-TOTE-SEAL-H           PIC  X(01).            04340000
               10  MR-B-SM-TOTE-SEAL             PIC  X(07).            04350000
      *                                                                 04360000
           05  MR-C-TRAILER.                                            04370000
               10  FILLER                        PIC  X(12).            04380000
               10  MR-C-TRLR-SEAL-L              PIC S9(04)  COMP.      04390000
               10  MR-C-TRLR-SEAL-A              PIC  X(01).            04400000
               10  MR-C-TRLR-SEAL-C              PIC  X(01).            04410000
               10  MR-C-TRLR-SEAL-H              PIC  X(01).            04420000
               10  MR-C-TRLR-SEAL                PIC  X(07).            04430000
      *                                                                 04440000
               10  MR-C-TRLR-NBR-L               PIC S9(04)  COMP.      04450000
               10  MR-C-TRLR-NBR-A               PIC  X(01).            04460000
               10  MR-C-TRLR-NBR-C               PIC  X(01).            04470000
               10  MR-C-TRLR-NBR-H               PIC  X(01).            04480000
               10  MR-C-TRLR-NBR                 PIC  X(08).            04490000
      *                                                                 04490100
           05  MR-D-COMMON.                                             04490200
               10  FILLER                        PIC  X(12).            04490300
               10  MR-D-XFER-TYPE-L              PIC S9(04)  COMP.      04490400
               10  MR-D-XFER-TYPE-A              PIC  X(01).            04490500
               10  MR-D-XFER-TYPE-C              PIC  X(01).            04490600
               10  MR-D-XFER-TYPE-H              PIC  X(01).            04490700
               10  MR-D-XFER-TYPE                PIC  X(01).            04490800
      *                                                                 04490900
               10  MR-D-XFER-DESC-L              PIC S9(04)  COMP.      04491000
               10  MR-D-XFER-DESC-A              PIC  X(01).            04491100
               10  MR-D-XFER-DESC-C              PIC  X(01).            04491200
               10  MR-D-XFER-DESC-H              PIC  X(01).            04491300
               10  MR-D-XFER-DESC                PIC  X(19).            04491400
      *                                                                 04491500
               10  MR-D-CONT-TYPE-L              PIC S9(04)  COMP.      04491600
               10  MR-D-CONT-TYPE-A              PIC  X(01).            04491700
               10  MR-D-CONT-TYPE-C              PIC  X(01).            04491800
               10  MR-D-CONT-TYPE-H              PIC  X(01).            04491900
               10  MR-D-CONT-TYPE                PIC  X(01).            04492000
      *                                                                 04492100
               10  MR-D-CONT-DESC-L              PIC S9(04)  COMP.      04492200
               10  MR-D-CONT-DESC-A              PIC  X(01).            04492300
               10  MR-D-CONT-DESC-C              PIC  X(01).            04492400
               10  MR-D-CONT-DESC-H              PIC  X(01).            04492500
               10  MR-D-CONT-DESC                PIC  X(18).            04492600
      *                                                                 04492700
               10  MR-D-FR-STORE-NBR-L           PIC S9(04)  COMP.      04492800
               10  MR-D-FR-STORE-NBR-A           PIC  X(01).            04492900
               10  MR-D-FR-STORE-NBR-C           PIC  X(01).            04493000
               10  MR-D-FR-STORE-NBR-H           PIC  X(01).            04493100
               10  MR-D-FR-STORE-NBR.                                   04493200
100404*            15  MR-D-FR-STORE-NBR-N       PIC  9(03).            04493300
100404             15  MR-D-FR-STORE-NBR-N       PIC  9(04).            04493400
      *                                                                 04493500
               10  MR-D-FR-STORE-NAM-L           PIC S9(04)  COMP.      04493600
               10  MR-D-FR-STORE-NAM-A           PIC  X(01).            04493700
               10  MR-D-FR-STORE-NAM-C           PIC  X(01).            04493800
               10  MR-D-FR-STORE-NAM-H           PIC  X(01).            04493900
               10  MR-D-FR-STORE-NAM             PIC  X(10).            04494000
      *                                                                 04494100
               10  MR-D-TO-STORE-NBR-L           PIC S9(04)  COMP.      04494200
               10  MR-D-TO-STORE-NBR-A           PIC  X(01).            04494300
               10  MR-D-TO-STORE-NBR-C           PIC  X(01).            04494400
               10  MR-D-TO-STORE-NBR-H           PIC  X(01).            04494500
               10  MR-D-TO-STORE-NBR.                                   04494600
100404*            15  MR-D-TO-STORE-NBR-N       PIC  9(03).            04494700
100404             15  MR-D-TO-STORE-NBR-N       PIC  9(04).            04494800
      *                                                                 04494900
               10  MR-D-TO-STORE-NAM-L           PIC S9(04)  COMP.      04495000
               10  MR-D-TO-STORE-NAM-A           PIC  X(01).            04495100
               10  MR-D-TO-STORE-NAM-C           PIC  X(01).            04495200
               10  MR-D-TO-STORE-NAM-H           PIC  X(01).            04495300
               10  MR-D-TO-STORE-NAM             PIC  X(10).            04495400
      *                                                                 04495500
           05  MR-E-CALLBACK.                                           04495600
               10  FILLER                        PIC  X(12).            04495700
               10  MR-E-CALLBACK-NBR-L           PIC S9(04)  COMP.      04495800
               10  MR-E-CALLBACK-NBR-A           PIC  X(01).            04495900
               10  MR-E-CALLBACK-NBR-C           PIC  X(01).            04496000
               10  MR-E-CALLBACK-NBR-H           PIC  X(01).            04496100
               10  MR-E-CALLBACK-NBR             PIC  X(04).            04496200
               10  MR-E-CALLBACK-NBR-N REDEFINES                        04496300
                   MR-E-CALLBACK-NBR             PIC  9(04).            04496400
      *                                                                 04496500
           05  MR-F-NON-CALLBACK.                                       04496600
               10  FILLER                        PIC  X(12).            04496700
               10  MR-F-LITERAL-1-L              PIC S9(04)  COMP.      04496800
               10  MR-F-LITERAL-1-A              PIC  X(01).            04496900
               10  MR-F-LITERAL-1-C              PIC  X(01).            04497000
               10  MR-F-LITERAL-1-H              PIC  X(01).            04497100
               10  MR-F-LITERAL-1                PIC  X(15).            04497200
      *                                                                 04497300
               10  MR-F-FIELD-1-L                PIC S9(04)  COMP.      04497400
               10  MR-F-FIELD-1-A                PIC  X(01).            04497500
               10  MR-F-FIELD-1-C                PIC  X(01).            04497600
               10  MR-F-FIELD-1-H                PIC  X(01).            04497700
               10  MR-F-FIELD-1                  PIC  X(21).            04497800
      *                                                                 04497900
               10  MR-F-LITERAL-2-L              PIC S9(04)  COMP.      04498000
               10  MR-F-LITERAL-2-A              PIC  X(01).            04498100
               10  MR-F-LITERAL-2-C              PIC  X(01).            04498200
               10  MR-F-LITERAL-2-H              PIC  X(01).            04498300
               10  MR-F-LITERAL-2                PIC  X(15).            04498400
      *                                                                 04498500
               10  MR-F-FIELD-2-L                PIC S9(04)  COMP.      04498600
               10  MR-F-FIELD-2-A                PIC  X(01).            04498700
               10  MR-F-FIELD-2-C                PIC  X(01).            04498800
               10  MR-F-FIELD-2-H                PIC  X(01).            04498900
               10  MR-F-FIELD-2                  PIC  X(22).            04499000
      *                                                                 04499100
           05  MR-G-COMMON.                                             04499200
               10  FILLER                        PIC  X(12).            04499300
               10  MR-G-CUST-NAME-LIT-L          PIC S9(04)  COMP.      04499400
               10  MR-G-CUST-NAME-LIT-A          PIC  X(01).            04499500
               10  MR-G-CUST-NAME-LIT-C          PIC  X(01).            04499600
               10  MR-G-CUST-NAME-LIT-H          PIC  X(01).            04499700
               10  MR-G-CUST-NAME-LIT            PIC  X(15).            04499800
      *                                                                 04499900
               10  MR-G-CUST-NAME-L              PIC S9(04)  COMP.      04500000
               10  MR-G-CUST-NAME-A              PIC  X(01).            04500100
               10  MR-G-CUST-NAME-C              PIC  X(01).            04500200
               10  MR-G-CUST-NAME-H              PIC  X(01).            04500300
               10  MR-G-CUST-NAME                PIC  X(20).            04500400
      *                                                                 04500500
               10  MR-G-CUST-PHONE-LIT-L         PIC S9(04)  COMP.      04500600
               10  MR-G-CUST-PHONE-LIT-A         PIC  X(01).            04500700
               10  MR-G-CUST-PHONE-LIT-C         PIC  X(01).            04500800
               10  MR-G-CUST-PHONE-LIT-H         PIC  X(01).            04500900
               10  MR-G-CUST-PHONE-LIT           PIC  X(15).            04501000
      *                                                                 04501100
               10  MR-G-CUST-PHONE-L             PIC S9(04)  COMP.      04501200
               10  MR-G-CUST-PHONE-A             PIC  X(01).            04501300
               10  MR-G-CUST-PHONE-C             PIC  X(01).            04501400
               10  MR-G-CUST-PHONE-H             PIC  X(01).            04501500
               10  MR-G-CUST-PHONE               PIC X(14).             04501600
      *                                                                 04501700
               10  MR-G-ADDRESS-LIT-L            PIC S9(04)  COMP.      04501800
               10  MR-G-ADDRESS-LIT-A            PIC  X(01).            04501900
               10  MR-G-ADDRESS-LIT-C            PIC  X(01).            04502000
               10  MR-G-ADDRESS-LIT-H            PIC  X(01).            04502100
               10  MR-G-ADDRESS-LIT              PIC  X(12).            04502200
      *                                                                 04502300
               10  MR-G-ADDR1-L                  PIC S9(04)  COMP.      04502400
               10  MR-G-ADDR1-A                  PIC  X(01).            04502500
               10  MR-G-ADDR1-C                  PIC  X(01).            04502600
               10  MR-G-ADDR1-H                  PIC  X(01).            04502700
               10  MR-G-ADDR1                    PIC  X(20).            04502800
      *                                                                 04502900
               10  MR-G-CITY-LIT-L               PIC S9(04)  COMP.      04503000
               10  MR-G-CITY-LIT-A               PIC  X(01).            04503100
               10  MR-G-CITY-LIT-C               PIC  X(01).            04503200
               10  MR-G-CITY-LIT-H               PIC  X(01).            04503300
               10  MR-G-CITY-LIT                 PIC  X(12).            04503400
      *                                                                 04503500
               10  MR-G-CITY-L                   PIC S9(04)  COMP.      04503600
               10  MR-G-CITY-A                   PIC  X(01).            04503700
               10  MR-G-CITY-C                   PIC  X(01).            04503800
               10  MR-G-CITY-H                   PIC  X(01).            04503900
               10  MR-G-CITY                     PIC  X(20).            04504000
      *                                                                 04504100
               10  MR-G-ADDR2-L                  PIC S9(04)  COMP.      04504200
               10  MR-G-ADDR2-A                  PIC  X(01).            04504300
               10  MR-G-ADDR2-C                  PIC  X(01).            04504400
               10  MR-G-ADDR2-H                  PIC  X(01).            04504500
               10  MR-G-ADDR2                    PIC  X(20).            04504600
      *                                                                 04504700
               10  MR-G-STATE-LIT-L              PIC S9(04)  COMP.      04504800
               10  MR-G-STATE-LIT-A              PIC  X(01).            04504900
               10  MR-G-STATE-LIT-C              PIC  X(01).            04505000
               10  MR-G-STATE-LIT-H              PIC  X(01).            04505100
               10  MR-G-STATE-LIT                PIC  X(12).            04505200
      *                                                                 04505300
               10  MR-G-STATE-L                  PIC S9(04)  COMP.      04505400
               10  MR-G-STATE-A                  PIC  X(01).            04505500
               10  MR-G-STATE-C                  PIC  X(01).            04505600
               10  MR-G-STATE-H                  PIC  X(01).            04505700
               10  MR-G-STATE                    PIC  X(02).            04505800
      *                                                                 04505900
               10  MR-G-ZIP-L                    PIC S9(04)  COMP.      04506000
               10  MR-G-ZIP-A                    PIC  X(01).            04506100
               10  MR-G-ZIP-C                    PIC  X(01).            04506200
               10  MR-G-ZIP-H                    PIC  X(01).            04506300
               10  MR-G-ZIP                      PIC X(10).             04506400
      *                                                                 04506500
               10  MR-G-TOT-QTY-L                PIC S9(04)  COMP.      04506600
               10  MR-G-TOT-QTY-A                PIC  X(01).            04506700
               10  MR-G-TOT-QTY-C                PIC  X(01).            04506800
               10  MR-G-TOT-QTY-H                PIC  X(01).            04506900
               10  MR-G-TOT-QTY                  PIC ZZZZ9.             04507000
      *                                                                 04507100
               10  MR-G-TOT-RTL-L                PIC S9(04)  COMP.      04507200
               10  MR-G-TOT-RTL-A                PIC  X(01).            04507300
               10  MR-G-TOT-RTL-C                PIC  X(01).            04507400
               10  MR-G-TOT-RTL-H                PIC  X(01).            04507500
SR3403         10  MR-G-TOT-RTL                  PIC ZZZZZZZZZ.99.      04507700
      *                                                                 04507800
       01  MD-MAP-DATA-AREA                      PIC X(3000).           05240000
      *                                                                 05250000
           EJECT                                                        05260000
      *---------------------------------------------------------------* 05270000
      *    COMMAREA FOR DISCREPANCY PRINT PROGRAM.                    * 05280000
      *---------------------------------------------------------------* 05290000
           COPY TFWS005.                                                05290100
                                                                        05290200
      *----------------------------------------------------------------*05290300
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      05290400
      *----------------------------------------------------------------*05290500
080204     COPY RFWS009.                                                05290600
                                                                        05290700
      *---------------------------------------------------------------* 05290800
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 05290900
      *---------------------------------------------------------------* 05291000
                                                                        05300000
           COPY DPWS015.                                                05310000
                                                                        05320000
      *---------------------------------------------------------------* 05330000
      *    FUNCTION KEYS COPYBOOK.                                    * 05340000
      *---------------------------------------------------------------* 05350000
                                                                        05360000
           COPY DPWS016.                                                05370000
                                                                        05380000
      *---------------------------------------------------------------* 05390000
      *    NUMERIC EDIT LAYOUT.                                       * 05400000
      *---------------------------------------------------------------* 05410000
                                                                        05420000
           COPY DPWS010I.                                               05430000
       EJECT                                                            05440000
      *---------------------------------------------------------------* 05450000
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05460099
      *---------------------------------------------------------------* 05470000
                                                                        05480000
           COPY DPWS030.                                                05490000
CICS       COPY DPWS930.                                                05491099
       EJECT                                                            05500000
      *---------------------------------------------------------------* 05510000
      *    STANDARD COMMAREA.                                         * 05520000
      *---------------------------------------------------------------* 05530000
                                                                        05540000
           COPY DPWS020.                                                05550000
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05560000
                                                                        05570000
      *---------------------------------------------------------------* 05580000
      * INTER-APPLICATION COMMAREA.                                   * 05590000
      *   TFWS006 - IS THE INPUT LAYOUT WHEN COMING FROM THE          * 05600000
      *             TRANSFER RECEIPT SCREEN.                          * 05610000
      *   TFWS006 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED TO THE   * 05620000
      *             TRANSFER RECEIPT ITEM SCREEN.                     * 05630000
      *---------------------------------------------------------------* 05640000
                                                                        05650000
               10  INTER-APPL-COMM-AREA       PIC X(200).               05660000
           COPY TFWS006.                                                05670000
      *---------------------------------------------------------------* 05680000
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05690000
      *---------------------------------------------------------------* 05700000
               10  ASC-SPECIFIC-COMMAREA.                               05710000
                   15  ASC-XFER-NBR.                                    05721000
100404*                20  ASC-XFER-FR-STR                 PIC  9(03).  05740000
100404                 20  ASC-XFER-FR-STR                 PIC  9(04).  05740100
                       20  ASC-XFER-DASH-1                 PIC  X(01).  05740200
                       20  ASC-XFER-SEQ-NBR                PIC  9(06).  05740300
                       20  ASC-XFER-DASH-2                 PIC  X(01).  05740400
                       20  ASC-XFER-CHECK-DIGIT            PIC  9(01).  05740500
                   15  ASC-XFER-DKEY-ID                    PIC  S9(09)  05740600
                                                                COMP.   05740700
                   15  ASC-XFER-TYPE                       PIC  X(02).  05750000
                       88  ASC-NON-RETAIL-XFER             VALUE '06'.  05750100
                       88  ASC-RETAIL-XFER                 VALUE        05750200
111703*                                                '01' THRU '05'.  05751000
111703                                                 '00' THRU '05'.  05752000
                   15  ASC-XFER-DESC                       PIC  X(21).  05760000
                   15  ASC-CURRENT-TIMESTAMP               PIC  X(26).  05770000
                   15  ASC-CONTNR-TYPE                     PIC  X(02).  05771000
                   15  ASC-CONTNR-DESC                     PIC  X(18).  05780000
100404*            15  ASC-RCV-STORE-NBR                   PIC  9(03).  05790000
100404             15  ASC-RCV-STORE-NBR                   PIC  9(04).  05791000
100404*            15  ASC-TO-STORE-NBR                    PIC  9(03).  05800000
100404             15  ASC-TO-STORE-NBR                    PIC  9(04).  05810000
                   15  ASC-TO-STORE-NAM                    PIC  X(10).  05820000
100404*            15  ASC-FR-STORE-NBR                    PIC  9(03).  05820100
100404             15  ASC-FR-STORE-NBR                    PIC  9(04).  05820200
                   15  ASC-FR-STORE-NAM                    PIC  X(10).  05820300
                   15  ASC-COMP-BY.                                     05830000
                       20  ASC-COMP-BY-INT                 PIC  X(01).  05831000
                       20  ASC-COMP-BY-NAM                 PIC  X(20).  05840000
                   15  ASC-RECV-BY-INT                     PIC  X(01).  05840100
                   15  ASC-RECV-BY-NAM.                                 05840200
                       20  ASC-RECV-BY-NAM-1               PIC  X(01).  05840300
                       20  ASC-RECV-BY-NAM-19              PIC  X(19).  05840400
                   15  ASC-REQ-BY.                                      05850000
                       20  ASC-REQ-BY-INT                  PIC  X(01).  05851000
                       20  ASC-REQ-BY-NAM                  PIC  X(20).  05860000
                   15  ASC-ATTN-TO.                                     05870000
                       20  ASC-ATTN-TO-INT                 PIC  X(01).  05871000
                       20  ASC-ATTN-TO-NAM                 PIC  X(20).  05880000
                   15  ASC-CALLBACK-NBR                    PIC  X(04).  05890000
                   15  ASC-CALLBACK-NBR-N REDEFINES ASC-CALLBACK-NBR    05900000
                                                           PIC  9(04).  05910000
                   15  ASC-NEW-CALLBACK                    PIC  X(04).  05910100
                   15  ASC-NEW-CALLBACK-N REDEFINES ASC-NEW-CALLBACK    05910200
                                                           PIC  9(04).  05910300
                   15  ASC-APPROVAL-NBR                    PIC  X(09).  05920000
                   15  ASC-APPROVAL-NBR-N REDEFINES ASC-APPROVAL-NBR    05930000
                                                           PIC  9(09).  05940000
                   15  ASC-CUST-NAME                       PIC  X(20).  05950000
                   15  ASC-PHONE                           PIC  X(10).  05960000
                   15  FILLER REDEFINES ASC-PHONE.                      05970000
                       20  ASC-PHONE-AREA.                              05980000
                           25  ASC-PHONE-AREA-N            PIC  9(03).  05990000
                       20  ASC-PHONE-EXCH.                              06000000
                           25  ASC-PHONE-EXCH-N            PIC  9(03).  06010000
                       20  ASC-PHONE-NBR.                               06020000
                           25  ASC-PHONE-NBR-N             PIC  9(04).  06030000
                   15  ASC-ADDR1                           PIC  X(20).  06040000
                   15  ASC-ADDR2                           PIC  X(20).  06050000
                   15  ASC-CITY                            PIC  X(20).  06060000
                   15  ASC-STATE                           PIC  X(02).  06070000
                   15  ASC-ZIP                             PIC X(05).   06080000
                   15  ASC-ZIP-N REDEFINES ASC-ZIP         PIC  9(05).  06090000
                   15  ASC-ZIP-EXT                         PIC  X(04).  06100000
                   15  ASC-ZIP-EXT-N REDEFINES ASC-ZIP-EXT PIC  9(04).  06110000
                   15  ASC-CMP-LG-TOTE-SEAL1               PIC  X(07).  06120000
                   15  ASC-CMP-LG-TOTE-SEAL2               PIC  X(07).  06130000
                   15  ASC-CMP-SM-TOTE-SEAL                PIC  X(07).  06140000
                   15  ASC-CMP-TRAILER-SEAL                PIC  X(07).  06150000
                   15  ASC-CMP-TRAILER-NBR                 PIC  X(08).  06160000
                   15  ASC-LG-TOTE-SEAL1                   PIC  X(07).  06160100
                   15  ASC-LG-TOTE-SEAL2                   PIC  X(07).  06160200
                   15  ASC-SM-TOTE-SEAL                    PIC  X(07).  06160300
                   15  ASC-TRAILER-SEAL                    PIC  X(07).  06160400
                   15  ASC-TRAILER-NBR                     PIC  X(08).  06160500
                   15  ASC-TOT-QTY                         PIC S9(05).  06160600
SR3403             15  ASC-TOT-RETAIL                PIC S9(09)V99.     06160800
                                                                        06570000
                   15  ASC-ERROR-SW                      PIC  X(01).    06571000
                       88  ASC-NO-ERROR                    VALUE 'N'.   06572000
                       88  ASC-ERROR                       VALUE 'Y'.   06573000
                   15  ASC-RECEIVE-REQUEST-SW              PIC  X(01).  06580000
                       88  ASC-RECEIVE-REQUEST             VALUE 'Y'.   06590000
                       88  ASC-NO-RECEIVE-REQUEST          VALUE 'N'.   06600000
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06601000
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06602000
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06603000
                   15  ASC-RCV-STR-OVRRID-IND      PIC  X(01).          06604000
                       88  ASC-RCV-STR-OVERRIDE      VALUE 'Y'.         06605000
                       88  ASC-NO-RCV-STR-OVERRIDE   VALUE 'N'.         06606000
                   15  ASC-CALL-IC-IND             PIC  X(01).          06607000
                       88  ASC-CALL-INV-CONTROL      VALUE 'Y'.         06608000
           EJECT                                                        06740000
      *---------------------------------------------------------------* 06750000
      *    ABEND PROCESSING COPYBOOK.                                 * 06760000
      *---------------------------------------------------------------* 06770000
                                                                        06780000
           COPY DPWS013.                                                06790000
                                                                        06800000
       EJECT                                                            06810000
      *---------------------------------------------------------------* 06880000
      *    DB2 AREA FOR TRANSFER TABLE                                * 06890000
      *---------------------------------------------------------------* 06900000
           EXEC SQL                                                     06910000
                INCLUDE TTFMSTR                                         06920000
           END-EXEC.                                                    06930000
      *---------------------------------------------------------------* 06940000
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 06950000
      *---------------------------------------------------------------* 06960000
           EXEC SQL                                                     06970000
                INCLUDE TTFITEM                                         06980000
           END-EXEC.                                                    06990000
      *---------------------------------------------------------------* 06990100
      *    DB2 AREA FOR TRANSFER ITEM RECEIPT TABLE                   * 06990200
      *---------------------------------------------------------------* 06990300
           EXEC SQL                                                     06990400
                INCLUDE TTFITRC                                         06990500
           END-EXEC.                                                    06990600
      *---------------------------------------------------------------* 06990700
      *    DB2 AREA FOR TRANSFER ITEM POSTING TABLE                   * 06990800
      *---------------------------------------------------------------* 06990900
           EXEC SQL                                                     06991000
                INCLUDE TTFITPS                                         06991100
           END-EXEC.                                                    06991200
      *---------------------------------------------------------------* 07000000
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 07010000
      *---------------------------------------------------------------* 07020000
           EXEC SQL                                                     07030000
                INCLUDE TTFCUST                                         07040000
           END-EXEC.                                                    07050000
      *---------------------------------------------------------------* 07060000
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 07070000
      *---------------------------------------------------------------* 07080000
           EXEC SQL                                                     07090000
                INCLUDE TTFSTAT                                         07100000
           END-EXEC.                                                    07100100
      *---------------------------------------------------------------* 07100200
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 07100300
      *---------------------------------------------------------------* 07100400
           EXEC SQL                                                     07100500
                INCLUDE TTFTYCD                                         07100600
           END-EXEC.                                                    07100700
      *---------------------------------------------------------------* 07100800
      *    DB2 AREA FOR TRANSFER RECEIPT TABLE                        * 07100900
      *---------------------------------------------------------------* 07101000
           EXEC SQL                                                     07101100
                INCLUDE TTFRCPT                                         07101200
           END-EXEC.                                                    07101300
      *---------------------------------------------------------------* 07101400
      *    DB2 AREA FOR TRANSFER CONTAINER TYPE TABLE                 * 07101500
      *---------------------------------------------------------------* 07101600
           EXEC SQL                                                     07101700
                INCLUDE TTFSHCT                                         07101800
           END-EXEC.                                                    07101900
      *---------------------------------------------------------------* 07102000
      *    DB2 AREA FOR TRANSFER DISCREPANCY TABLE                    * 07102100
      *---------------------------------------------------------------* 07102200
           EXEC SQL                                                     07102300
                INCLUDE TTFDSCP                                         07102400
           END-EXEC.                                                    07102500
      *---------------------------------------------------------------* 07103200
100404*    DB2 AREA FOR XST_LOC TABLE                                 * 07103300
      *---------------------------------------------------------------* 07103400
           EXEC SQL                                                     07103500
100404          INCLUDE XST00001                                        07103600
           END-EXEC.                                                    07103700
      *---------------------------------------------------------------* 07103800
100404*    DB2 AREA FOR XST_SKU_LOC TABLE                             * 07103900
      *---------------------------------------------------------------* 07104000
           EXEC SQL                                                     07105000
100404          INCLUDE XST00008                                        07106000
           END-EXEC.                                                    07107000
      *---------------------------------------------------------------* 07108000
100404*    DB2 AREA FOR XST_SKU TABLE                                 * 07109000
      *---------------------------------------------------------------* 07110000
           EXEC SQL                                                     07120000
100404          INCLUDE XST00010                                        07130000
           END-EXEC.                                                    07140000
      *---------------------------------------------------------------* 07141000
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 07142000
      *---------------------------------------------------------------* 07143000
           EXEC SQL                                                     07144000
100404          INCLUDE XST00012                                        07145000
           END-EXEC.                                                    07146000
      *---------------------------------------------------------------* 07150000
      *    DB2 AREA FOR COMMUNICATIONS                                * 07160000
      *---------------------------------------------------------------* 07170000
           EXEC SQL                                                     07180000
                INCLUDE SQLCA                                           07190000
           END-EXEC.                                                    07200000
      *---------------------------------------------------------------* 07200100
      *    CURSOR FOR TRANSFER ITEMS                                  * 07200200
      *---------------------------------------------------------------* 07200300
           EXEC SQL                                                     07200400
               DECLARE XFER_ITM_CSR CURSOR FOR                          07200500
                   SELECT  XFER_LNE_NBR,                                07200600
                           ITM_NBR,                                     07201000
                           XFER_PRIC_AMT,                               07202000
                           XFER_QTY,                                    07203000
100404                     KOHLS_UPC_NBR                                07203100
                     FROM  TTFITEM                                      07204000
                    WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID)          07205000
                 ORDER BY  XFER_LNE_NBR                                 07206000
100404           WITH UR                                                07206100
           END-EXEC.                                                    07207000
                                                                        07210000
       EJECT                                                            07610000
       LINKAGE SECTION.                                                 07620000
                                                                        07630000
       01  DFHCOMMAREA.                                                 07640000
           05  FILLER                         OCCURS  1 TO 4072 TIMES   07650000
                                              DEPENDING ON EIBCALEN.    07660000
               10  FILLER                     PIC X.                    07670000
                                                                        07680000
       EJECT                                                            07690000
       PROCEDURE DIVISION.                                              07700000
      ******************************************************************07710000
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07720000
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07730000
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07740000
      ******************************************************************07750000
       0000-MAIN-MODULE.                                                07760000
           INITIALIZE DP030-CICS-API-FIELDS.                            07770000
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07780000
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07790000
           MOVE +5                       TO DP030-NUMBER-OF-MAPS.       07800000
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07810000
           PERFORM 0001-CALL-CICS-ARCH-API.                             07820000
      *                                                                 07830000
           MOVE 1                      TO PV-MAP-START-BYTE.            07840000
           MOVE LENGTH OF MR-A-COMMON  TO DP030-MAP-LENGTH (1).         07850000
           MOVE MD-MAP-DATA-AREA                                        07860000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (1))          07870000
                                       TO MR-A-COMMON.                  07880000
           ADD DP030-MAP-LENGTH (1)                                     07890000
                                       TO PV-MAP-START-BYTE.            07900000
           EVALUATE ASC-CONTNR-TYPE                                     08340000
               WHEN PC-TRAILER                                          08350000
                   MOVE LENGTH OF MR-C-TRAILER                          08360000
                                       TO DP030-MAP-LENGTH (2)          08370000
                   MOVE MD-MAP-DATA-AREA                                08380000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          08390000
                                       TO MR-C-TRAILER                  08400000
                   ADD DP030-MAP-LENGTH (2)                             08410000
                                       TO PV-MAP-START-BYTE             08420000
               WHEN OTHER                                               08430000
                   MOVE LENGTH OF MR-B-TOTES                            08440000
                                       TO DP030-MAP-LENGTH (2)          08450000
                   MOVE MD-MAP-DATA-AREA                                08460000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          08470000
                                       TO MR-B-TOTES                    08480000
                   ADD DP030-MAP-LENGTH (2)                             08490000
                                       TO PV-MAP-START-BYTE             08500000
           END-EVALUATE.                                                08510000
           MOVE LENGTH OF MR-D-COMMON  TO DP030-MAP-LENGTH (3).         08510100
           MOVE MD-MAP-DATA-AREA                                        08510200
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))          08510300
                                       TO MR-D-COMMON.                  08510400
           ADD DP030-MAP-LENGTH (3)                                     08510500
                                       TO PV-MAP-START-BYTE.            08510600
           IF ASC-XFER-TYPE = PC-CALLBACK                               08510700
               MOVE LENGTH OF MR-E-CALLBACK                             08510800
                                       TO DP030-MAP-LENGTH (4)          08510900
               MOVE MD-MAP-DATA-AREA                                    08511000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))          08511100
                                       TO MR-E-CALLBACK                 08511200
               ADD DP030-MAP-LENGTH (4)                                 08511300
                                       TO PV-MAP-START-BYTE             08511400
           ELSE                                                         08511500
               MOVE LENGTH OF MR-F-NON-CALLBACK                         08511600
                                       TO DP030-MAP-LENGTH (4)          08511700
               MOVE MD-MAP-DATA-AREA                                    08511800
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))          08511900
                                       TO MR-F-NON-CALLBACK             08512000
               ADD DP030-MAP-LENGTH (4)                                 08512100
                                       TO PV-MAP-START-BYTE             08512200
           END-IF.                                                      08512300
           MOVE LENGTH OF MR-G-COMMON  TO DP030-MAP-LENGTH (5).         08512400
           MOVE MD-MAP-DATA-AREA                                        08512500
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (5))          08512600
                                       TO MR-G-COMMON.                  08512700
           ADD DP030-MAP-LENGTH (5)                                     08512800
                                       TO PV-MAP-START-BYTE.            08512900
      *                                                                 08670000
           PERFORM 1000-CONTROL-PROCESSING                              08680000
      *                                                                 08690000
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08700000
           PERFORM 0001-CALL-CICS-ARCH-API.                             08710000
                                                                        08720000
      ******************************************************************08730000
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08740000
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08750000
      ******************************************************************08760000
       0001-CALL-CICS-ARCH-API.                                         08770000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08780099
                                          DFHCOMMAREA                   08790099
                                          DP030-CICS-API-FIELDS         08800099
                                          DP020-STANDARD-COMMAREA       08810099
                                          MD-MAP-DATA-AREA.             08820099
      *                                                                 08830000
           IF  DP030-RC-CALL-SUCCESSFUL                                 08840000
               CONTINUE                                                 08850000
           ELSE                                                         08860000
               SET DP013-NO-ROLLBACK                                    08870000
                   DP013-XCTL-DISPLAY-RESTART                           08880000
                   DP013-CICS-ABEND      TO TRUE                        08890000
               MOVE '0001-CALL-CICS-ARCH-API'                           08900000
                                         TO DP013-PARAGRAPH             08910000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08911099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08912099
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08940000
               PERFORM DP013-0000-PROCESS-ABEND                         08950000
           END-IF.                                                      08960000
      *----------------------------------------------------------------*08970000
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08980000
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08990000
      *----------------------------------------------------------------*09000000
                                                                        09010000
       1000-CONTROL-PROCESSING.                                         09020000
                                                                        09030000
           EVALUATE TRUE                                                09040000
               WHEN DP020-NEXT-ACT-INITIAL                              09050000
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     09060000
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 09070000
      ***-----$TEMPLATE NOTE$-------------------------------------------09080000
      *** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09090000
      *** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09100000
      *** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09110000
      ***---------------------------------------------------------------09120000
                   IF  PS-COMMAREA-NOT-VALID                            09130000
      ***              MOVE PC-TSYMSG-99901                             09140000
      ***                                TO DP020-MSG-NUMBER            09150000
      ***              SET DP020-MSG-FATAL                              09160000
      ***                                TO TRUE                        09170000
                       SET DP020-NEXT-ACT-APPL-ERROR                    09180000
                                         TO TRUE                        09190000
                   ELSE                                                 09200000
                       PERFORM 4000-BUILD-INITIAL-PANEL                 09210000
                   END-IF                                               09220000
                                                                        09230000
               WHEN DP020-NEXT-ACT-READ-MAP                             09240000
                   PERFORM 2000-PROCESS-PANEL                           09250000
                                                                        09260000
               WHEN DP020-NEXT-ACT-RETURN                               09260100
                   SET ASC-NO-RECEIVE-REQUEST TO TRUE                   09261000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09261200
                                                                        09261300
               WHEN OTHER                                               09261400
                   SET DP013-LOGIC-ABEND TO TRUE                        09261500
                   SET DP013-NO-ROLLBACK TO TRUE                        09261600
                   MOVE '1000-CONTROL-PROCESSING'                       09261700
                                         TO DP013-PARAGRAPH             09261800
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09262000
                                         TO DP013-MESSAGE-TEXT(1)       09263000
                   PERFORM DP013-0000-PROCESS-ABEND                     09264000
           END-EVALUATE.                                                09265000
                                                                        09266000
       EJECT                                                            09267000
      *----------------------------------------------------------------*09268000
      * MOVE DATA FROM THE INTER-APPLICATION COMMAREA TO SPECIFIC      *09269000
      * COMMAREA. READ THE TRANSFER MASTER.                            *09270000
      *----------------------------------------------------------------*09280000
                                                                        09290000
       1100-PROCESS-INTER-APPL-COMM.                                    09300000
                                                                        09310000
           SET PS-COMMAREA-VALID         TO TRUE.                       09320000
           MOVE TF006-XFER-NBR           TO PV-XFER-NBR.                09340000
           MOVE TF006-XFER-TYPE          TO ASC-XFER-TYPE.              09340100
           MOVE TF006-CONTNR-TYPE        TO ASC-CONTNR-TYPE.            09340200
           MOVE PV-XFER-FR-STR           TO ASC-XFER-FR-STR.            09340300
           MOVE PV-XFER-SEQ-NBR          TO ASC-XFER-SEQ-NBR.           09340400
           MOVE TF006-CHECK-DIGIT        TO ASC-XFER-CHECK-DIGIT        09360000
           MOVE '-'                      TO ASC-XFER-DASH-1             09370000
                                            ASC-XFER-DASH-2.            09380000
           MOVE TF006-DKEY-ID            TO DK-XFER-DKEY-ID             09490000
                                            ASC-XFER-DKEY-ID.           09500000
           MOVE TF006-RCV-XFER-BEG-TMST  TO ASC-CURRENT-TIMESTAMP.      09510000
           IF TF006-RCV-STR-OVERRIDE                                    09520000
               SET ASC-RCV-STR-OVERRIDE  TO TRUE                        09530000
           ELSE                                                         09540000
               SET ASC-NO-RCV-STR-OVERRIDE  TO TRUE                     09550000
           END-IF.                                                      09560000
           MOVE TF006-RCV-STR-NBR        TO ASC-RCV-STORE-NBR.          09853500
           MOVE TF006-CALL-IC-IND        TO ASC-CALL-IC-IND.            09853600
           PERFORM 4100-GET-TRANSFER.                                   09853700
                                                                        09853800
       EJECT                                                            09853900
      *----------------------------------------------------------------*09854000
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09854100
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09854200
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09854300
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09854400
      * FUNCTION KEYS CAN GET THIS FAR.                                *09854500
      *----------------------------------------------------------------*09854600
                                                                        09854700
       2000-PROCESS-PANEL.                                              09854800
             EVALUATE TRUE                                              09854900
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09855000
                   SET ASC-NO-RECEIVE-REQUEST TO TRUE                   09855100
                   MOVE ASC-XFER-DKEY-ID TO DK-XFER-DKEY-ID             09855200
                   MOVE ASC-CALLBACK-NBR  TO ASC-NEW-CALLBACK           09855300
                   PERFORM 4000-BUILD-INITIAL-PANEL                     09855400
                                                                        09855500
               WHEN DP020-SRC-AID = DP016-CLEAR                         09855600
                   SET ASC-NO-RECEIVE-REQUEST TO TRUE                   09855700
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09855800
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09855900
                                                                        09856800
               WHEN OTHER                                               09856900
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09857000
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09857100
                   IF  ASC-NO-ERROR                                     09857200
                       SET DP030-CONTINUE-GO                            09857300
                                       TO TRUE                          09857400
                       PERFORM 2100-CHECK-FUNCTION-KEY                  09857500
                   ELSE                                                 09857600
                       SET DP030-OVERRIDE-GO                            09857700
                                       TO TRUE                          09857800
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09857900
                   END-IF                                               09858000
             END-EVALUATE.                                              09858100
       EJECT                                                            09863800
      *----------------------------------------------------------------*09864000
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09870000
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09880000
      * CICS ARCHITECTURE API.                                         *09890000
      *----------------------------------------------------------------*09900000
       2100-CHECK-FUNCTION-KEY.                                         09910000
           EVALUATE TRUE                                                09920000
                                                                        09931900
      *---  LNE ITM  -----------------------------------------------*   09932000
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09933000
                   PERFORM 2110-PREPARE-INTER-APPL-COMM                 09933100
                                                                        09933200
      *---  RECEIVE  -----------------------------------------------*   09933300
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09933400
                   SET PS-NO-DISCREPANCY-EXISTS      TO TRUE            09933500
                   PERFORM 5000-CHECK-FOR-DISCREPANCY                   09933600
                   MOVE ASC-XFER-DKEY-ID      TO DK-XFER-DKEY-ID        09933700
                   IF PS-DISCREPANCY-EXISTS                             09933800
                       MOVE PC-TSYMSG-01506   TO DP020-MSG-NUMBER       16540000
                       SET DP020-MSG-FATAL    TO TRUE                   16550000
                       SET DP030-SET-CURSOR-TRAILER                     16570000
                       DP030-OVERRIDE-GO      TO TRUE                   16580000
                   ELSE                                                 16580100
                       IF ASC-RECEIVE-REQUEST                           16580200
                           PERFORM 7100-SELECT-MAX-RCPT-TMST            18012200
                           IF PV-NULL-IND IS NOT NEGATIVE               18012400
                               IF TFRCPT-RCV-XFER-BEG-TMST NOT =        18012600
                                                 ASC-CURRENT-TIMESTAMP  18012700
      * -- SOMEONE ELSE HAS TRIED TO RECEIVE THE TRANSFER SINCE THE     18012800
      * -- INTERMEDIATE RECEIPT ROW WAS INSERTED; DELETE THE 'IR'       18012900
      * -- STATUS AND THE CURRENT RECEIPT ROW, AND INSERT NEW ONES WITH 18013000
      * -- THE CURRENT TIMESTAMP                                        18013100
                                   PERFORM 7800-DELETE-IR-STATUS        18013200
                                   PERFORM 7810-DELETE-CURRENT-RECEIPT  18013300
                                   SET PS-INSERT-STATUS  TO TRUE        18013400
                                   PERFORM 7000-SELECT-CURRENT-TIMESTAMP18013500
                               ELSE                                     18013600
      * -- THE INSERTED 'IR' IS THE MOST CURRENT, USE THE BEGINNING     18013700
      * -- TIMESTAMP FROM THAT ROW AS THE TIMESTAMP FOR THE RECEIPT     18013800
                                   SET PS-UPDATE-STATUS  TO TRUE        18013900
                                   MOVE ASC-CURRENT-TIMESTAMP TO        18014000
                                                PV-CURRENT-TIMESTAMP    18015000
                               END-IF                                   18016000
                           ELSE                                         18017000
      * -- IF FOR SOME REASON, THE CURRENT RECEIPT ROW WAS NOT FOUND,   18018000
      * -- DELETE THE 'IR' STATUS AND INSERT NEW STATUS & RECEIPT ROWS  18018100
                               PERFORM 7800-DELETE-IR-STATUS            18018200
                               SET PS-INSERT-STATUS    TO TRUE          18018300
                               PERFORM 7000-SELECT-CURRENT-TIMESTAMP    18018400
                           END-IF                                       18018500
                           IF ASC-RCV-STORE-NBR NOT = ASC-TO-STORE-NBR  18018600
                               PERFORM 7500-INSERT-DISCREPANCY-ROW      18018700
                               SET PS-XFER-DISCREPANCY     TO TRUE      18018800
                               MOVE PC-YES   TO TFRCPT-XFER-DSCRP-IND   18018900
                           ELSE                                         18019000
                               SET PS-NO-XFER-DISCREPANCY  TO TRUE      18020000
                               MOVE PC-NO    TO TFRCPT-XFER-DSCRP-IND   18030000
                           END-IF                                       18040000
                           IF ASC-RETAIL-XFER                           18050000
                               PERFORM 8100-CHK-ASSUMPTIVE-RECEIPT      18060000
                           END-IF                                       18060100
                           PERFORM 6000-RECEIVE-TRANSFER                18060200
                           IF PS-XFER-DISCREPANCY                       18060300
                             IF ASC-CALL-INV-CONTROL                    18060400
                               MOVE PC-TSYMSG-01678 TO DP020-MSG-NUMBER 18060500
                             ELSE                                       18060600
                               MOVE PC-TSYMSG-01508 TO DP020-MSG-NUMBER 18060700
                             END-IF                                     18060800
                             SET DP020-MSG-WARNING TO TRUE              18060900
                             INITIALIZE TF005-COMMAREA                  18061000
080204                       MOVE ASC-RCV-STORE-NBR                     18062000
080204                                            TO RFWS009-STORE-NBR  18062100
SR3403                       PERFORM 2105-FILL-PRINTER-DEST             18062299
SR3403*                      MOVE RFWS009-STORE-PRINTER-DEST            18062399
SR3403*                                           TO TF005-PRINTER-DEST 18062499
                             MOVE ASC-XFER-FR-STR                       18064000
                                          TO TF005-XFER-FROM-STORE-NBR  18065000
                             MOVE ASC-XFER-SEQ-NBR                      18066000
                                                  TO TF005-XFER-SEQ-NBR 18067000
                             MOVE DP020-USERID      TO TF005-USER-ID    18068000
                             EXEC CICS                                  18069000
                                START TRANSID ('P455')                  18070000
                                FROM    (TF005-COMMAREA)                18080000
                             END-EXEC                                   18090000
                           ELSE                                         18100000
                             IF ASC-CALL-INV-CONTROL                    18110000
                               MOVE PC-TSYMSG-01677 TO DP020-MSG-NUMBER 18110100
                               SET DP020-MSG-WARNING       TO TRUE      18110200
                             ELSE                                       18110300
                               MOVE PC-TSYMSG-01507 TO DP020-MSG-NUMBER 18110400
                               SET DP020-MSG-INFORMATIONAL TO TRUE      18110500
                             END-IF                                     18110600
                           END-IF                                       18110700
                       ELSE                                             18110800
                           SET ASC-RECEIVE-REQUEST TO TRUE              18110900
                           MOVE PC-TSYMSG-01403  TO DP020-MSG-NUMBER    18111000
                           MOVE 'F23-RECEIVE'    TO DP020-MSG-TEXT      18111100
                           SET DP020-MSG-INFORMATIONAL TO TRUE          18111200
                           SET DP030-SET-CURSOR-TRAILER  TO TRUE        18111300
                           SET DP030-OVERRIDE-GO      TO TRUE           18111400
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         18111500
                       END-IF                                           18111600
                   END-IF                                               18111700
                                                                        18111800
               WHEN DP020-SRC-AID = DP016-ENTER                         18111900
                   SET ASC-NO-RECEIVE-REQUEST TO TRUE                   18112000
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18112100
                                                                        18112200
               WHEN OTHER                                               18112300
                   SET DP013-NO-ROLLBACK                                18112400
                       DP013-XCTL-DISPLAY-RESTART                       18112500
                       DP013-CICS-ABEND  TO TRUE                        18112600
                   MOVE '2100-CHECK-FUNCTION-KEY'                       18112700
                                         TO DP013-PARAGRAPH             18112800
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      18112900
                                         TO DP013-MESSAGE-TEXT (1)      18113000
                   PERFORM DP013-0000-PROCESS-ABEND                     18113100
           END-EVALUATE.                                                18113200
      *                                                                 18113300
       EJECT                                                            18113400
SR3403******************************************************************18113599
SR3403*    DETERMINE WHAT REGION IF TEST USE TEST PRINTER               18113699
SR3403******************************************************************18113799
SR3403 2105-FILL-PRINTER-DEST.                                          18113899
SR3403                                                                  18113999
SR3403     EXEC CICS                                                    18114099
SR3403       ASSIGN                                                     18114199
SR3403       APPLID (PV-CICS-APPL-ID)                                   18114299
SR3403     END-EXEC.                                                    18114399
SR3403                                                                  18114499
SR3403     EVALUATE TRUE                                                18114599
SR3403       WHEN PV-CR-PRODUCTION                                      18114699
SR3403           MOVE RFWS009-STORE-PRINTER-DEST                        18114799
SR3403                TO TF005-PRINTER-DEST                             18114899
SR3403       WHEN OTHER                                                 18114999
SR3403           MOVE 'U4106' TO  TF005-PRINTER-DEST                    18115099
SR3403     END-EVALUATE.                                                18115199
      ******************************************************************18115200
      ** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **18115300
      ** INTER-APPLICATION COMMAREA.                                  **18115400
      ******************************************************************18115500
       2110-PREPARE-INTER-APPL-COMM.                                    18115600
           INITIALIZE TF006-INTER-APPL-COMMAREA.                        18115700
           MOVE ASC-XFER-FR-STR        TO PV-XFER-FR-STR.               18115800
           MOVE ASC-XFER-SEQ-NBR       TO PV-XFER-SEQ-NBR.              18116000
           MOVE PV-XFER-NBR            TO TF006-XFER-NBR.               18117000
           MOVE ASC-XFER-DKEY-ID       TO TF006-DKEY-ID.                18118000
           MOVE ASC-XFER-TYPE          TO TF006-XFER-TYPE.              18119000
           MOVE ASC-XFER-CHECK-DIGIT   TO TF006-CHECK-DIGIT.            18120000
           MOVE ASC-LG-TOTE-SEAL1      TO TF006-LG-TTE-1ST-SEAL-ID.     18130000
           MOVE ASC-LG-TOTE-SEAL2      TO TF006-LG-TTE-2ND-SEAL-ID.     18140000
           MOVE ASC-SM-TOTE-SEAL       TO TF006-SM-TTE-BAG-SEAL-ID.     18150000
           MOVE ASC-TRAILER-NBR        TO TF006-TRLR-NBR.               18160000
           MOVE ASC-TRAILER-SEAL       TO TF006-TRLR-SEAL-ID.           18170000
           MOVE ASC-RECV-BY-INT        TO TF006-XFER-RECV-BY-FIRST-INIT.18180000
           MOVE ASC-RECV-BY-NAM        TO TF006-XFER-RECV-BY-LAST-NAME. 18190000
           MOVE ASC-CURRENT-TIMESTAMP  TO TF006-RCV-XFER-BEG-TMST.      18200000
           MOVE ASC-RCV-STORE-NBR      TO TF006-RCV-STR-NBR.            18210000
           MOVE ASC-RCV-STR-OVRRID-IND TO TF006-RCV-STR-OVRRID-IND.     18220000
           MOVE ASC-CALL-IC-IND        TO TF006-CALL-IC-IND.            18230000
           IF ASC-NEW-CALLBACK NOT = ASC-CALLBACK-NBR                   18240000
               MOVE ASC-NEW-CALLBACK-N TO TF006-CALLBACK-NBR            18250000
               SET TF006-CALLBACK-OVERRIDE  TO TRUE                     18260000
           END-IF.                                                      18260100
       EJECT                                                            18260200
      *----------------------------------------------------------------*18260300
      *  CHECK TO SEE IF SOMEONE ELSE IS RECEVING THIS TRANSFER.        18260400
      *----------------------------------------------------------------*18260500
       2140-CHK-XFER-STATUS.                                            18260600
           MOVE ASC-XFER-DKEY-ID      TO DK-XFER-DKEY-ID.               18260700
           PERFORM 7200-SELECT-MAX-STAT-TMST                            18260800
           PERFORM 7250-SELECT-CURRENT-STATUS                           18260900
                                                                        18261000
           EVALUATE TFSTAT-XFER-STAT-CDE                                18261100
               WHEN PC-COMPLETED                                        18261200
               WHEN PC-INTERMEDIATELY-RECEIVED                          18261300
               WHEN PC-ASSUMPTIVELY-RECEIVED                            18261400
                   CONTINUE                                             18261500
               WHEN OTHER                                               18261600
                   SET  DP020-MSG-FATAL                                 18261700
                        DP030-OVERRIDE-GO                               18261800
                        ASC-ERROR               TO  TRUE                18261900
                   MOVE PC-TSYMSG-01520        TO  DP020-MSG-NUMBER     18262000
           END-EVALUATE.                                                18262100
      *                                                                 18262200
       2150-CHK-XFER-IN-USE.                                            18262300
           PERFORM 7100-SELECT-MAX-RCPT-TMST.                           18262400
                                                                        18262500
           IF PV-NULL-IND IS NOT NEGATIVE                               18262600
               PERFORM 7020-SELECT-CURRENT-RCPT                         18262700
               IF TFRCPT-RCV-XFER-BEG-TMST  =  TFRCPT-RCV-XFER-END-TMST 18262800
                   SET  DP020-MSG-FATAL                                 18262900
                        DP030-OVERRIDE-GO                               18263000
                        ASC-ERROR               TO  TRUE                18263100
                   MOVE PC-TSYMSG-01520  TO  DP020-MSG-NUMBER           18263200
               END-IF                                                   18263300
           END-IF.                                                      18263400
      ******************************************************************18263500
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18263600
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18263700
      ******************************************************************18263800
       2200-MOVE-SCREEN-TO-COMMAREA.                                    18263900
      *                                                                 18264000
           IF MR-A-RECV-BY-INT-L > 0                                    18264100
               MOVE MR-A-RECV-BY-INT   TO ASC-RECV-BY-INT               18264200
           ELSE                                                         18264300
               IF  MR-A-RECV-BY-INT-A = DP015-ERASE-EOF                 18264400
                   MOVE SPACE          TO ASC-RECV-BY-INT               18264500
               END-IF                                                   18264600
           END-IF                                                       18264700
           IF MR-A-RECV-BY-NAM-L > 0                                    18264800
               MOVE MR-A-RECV-BY-NAM   TO ASC-RECV-BY-NAM               18264900
           ELSE                                                         18265000
               IF  MR-A-RECV-BY-NAM-A = DP015-ERASE-EOF                 18265100
                   MOVE SPACE          TO ASC-RECV-BY-NAM               18265200
               END-IF                                                   18265300
           END-IF                                                       18265400
           EVALUATE ASC-CONTNR-TYPE                                     18265500
               WHEN PC-TRAILER                                          18265600
                   IF MR-C-TRLR-SEAL-L > 0                              18265700
                       MOVE MR-C-TRLR-SEAL                              18265800
                                               TO ASC-TRAILER-SEAL      18265900
                   ELSE                                                 18266000
                       IF  MR-C-TRLR-SEAL-A = DP015-ERASE-EOF           18266100
                           MOVE SPACE          TO ASC-TRAILER-SEAL      18266200
                       END-IF                                           18266300
                   END-IF                                               18266400
                   IF MR-C-TRLR-NBR-L > 0                               18266500
                       MOVE MR-C-TRLR-NBR                               18266600
                                               TO ASC-TRAILER-NBR       18266700
                   ELSE                                                 18266800
                       IF  MR-C-TRLR-NBR-A = DP015-ERASE-EOF            18266900
                           MOVE SPACE          TO ASC-TRAILER-NBR       18267000
                       END-IF                                           18267100
                   END-IF                                               18267200
               WHEN OTHER                                               18267300
                   IF MR-B-LG-TOTE-SEAL1-L > 0                          18267400
                       MOVE MR-B-LG-TOTE-SEAL1                          18267500
                                               TO ASC-LG-TOTE-SEAL1     18267600
                   ELSE                                                 18267700
                       IF  MR-B-LG-TOTE-SEAL1-A = DP015-ERASE-EOF       18267800
                           MOVE SPACE          TO ASC-LG-TOTE-SEAL1     18267900
                       END-IF                                           18268000
                   END-IF                                               18268100
                   IF MR-B-LG-TOTE-SEAL2-L > 0                          18268200
                       MOVE MR-B-LG-TOTE-SEAL2                          18268300
                                               TO ASC-LG-TOTE-SEAL2     18268400
                   ELSE                                                 18268500
                       IF  MR-B-LG-TOTE-SEAL2-A = DP015-ERASE-EOF       18268600
                           MOVE SPACE          TO ASC-LG-TOTE-SEAL2     18268700
                       END-IF                                           18268800
                   END-IF                                               18268900
                   IF MR-B-SM-TOTE-SEAL-L > 0                           18269000
                       MOVE MR-B-SM-TOTE-SEAL                           18269100
                                               TO ASC-SM-TOTE-SEAL      18269200
                   ELSE                                                 18269300
                       IF  MR-B-SM-TOTE-SEAL-A = DP015-ERASE-EOF        18269400
                           MOVE SPACE          TO ASC-SM-TOTE-SEAL      18269500
                       END-IF                                           18269600
                   END-IF                                               18269700
           END-EVALUATE.                                                18269800
           EVALUATE ASC-XFER-TYPE                                       18269900
               WHEN PC-CALLBACK                                         18270000
                   IF MR-E-CALLBACK-NBR-L > 0                           18270100
                       MOVE MR-E-CALLBACK-NBR  TO ASC-NEW-CALLBACK      18270200
                   ELSE                                                 18270300
                       IF  MR-E-CALLBACK-NBR-A = DP015-ERASE-EOF        18270400
                           MOVE ZERO           TO ASC-NEW-CALLBACK      18270500
                       END-IF                                           18270600
                   END-IF                                               18270700
           END-EVALUATE.                                                18270800
      ******************************************************************18270900
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **18271000
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **18271100
      ******************************************************************18271200
       3000-EDIT-DATA-IN-COMMAREA.                                      18271300
           SET ASC-NO-ERROR              TO TRUE.                       18271400
           PERFORM 3200-RESET-ATTRIBUTES.                               18271500
           PERFORM 2140-CHK-XFER-STATUS.                                22560300
           IF ASC-NO-ERROR                                              22560400
               PERFORM 2150-CHK-XFER-IN-USE                             22560500
           END-IF.                                                      22560700
           PERFORM 3300-EDIT-HEADER-INFO.                               22560800
           IF ASC-NO-ERROR                                              22560900
               SET DP030-SET-CURSOR-APPL-1   TO TRUE                    22561000
               MOVE -1                       TO MR-A-RECV-BY-INT-L      22561100
           END-IF.                                                      22561200
      *                                                                 22561300
       EJECT                                                            22561400
      ******************************************************************22561500
      ** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **22561600
      ******************************************************************22561700
                                                                        22561800
       3200-RESET-ATTRIBUTES.                                           22561900
           MOVE DP015-UNP-ALP-NOR-OFF    TO MR-A-RECV-BY-INT-A          22562000
                                            MR-A-RECV-BY-NAM-A.         22562100
           MOVE DP015-GREEN              TO MR-A-RECV-BY-INT-C          22562200
                                            MR-A-RECV-BY-NAM-C.         22562300
           MOVE DP015-UNDERLINE          TO MR-A-RECV-BY-INT-H          22562400
                                            MR-A-RECV-BY-NAM-H.         22562500
           EVALUATE ASC-CONTNR-TYPE                                     22562600
               WHEN PC-TRAILER                                          22562700
                   MOVE DP015-UNP-ALP-NOR-OFF                           22562800
                                         TO MR-C-TRLR-NBR-A             22562900
                                            MR-C-TRLR-SEAL-A            22563000
                   MOVE DP015-GREEN      TO MR-C-TRLR-NBR-C             22563100
                                            MR-C-TRLR-SEAL-C            22563200
                   MOVE DP015-UNDERLINE  TO MR-C-TRLR-NBR-H             22563300
                                            MR-C-TRLR-SEAL-H            22563400
               WHEN OTHER                                               22563500
                   MOVE DP015-UNP-ALP-NOR-OFF                           22563600
                                         TO MR-B-LG-TOTE-SEAL1-A        22563700
                                            MR-B-LG-TOTE-SEAL2-A        22563800
                                            MR-B-SM-TOTE-SEAL-A         22563900
                   MOVE DP015-GREEN      TO MR-B-LG-TOTE-SEAL1-C        22564000
                                            MR-B-LG-TOTE-SEAL2-C        22564100
                                            MR-B-SM-TOTE-SEAL-C         22564200
                   MOVE DP015-UNDERLINE  TO MR-B-LG-TOTE-SEAL1-H        22564300
                                            MR-B-LG-TOTE-SEAL2-H        22564400
                                            MR-B-SM-TOTE-SEAL-H         22564500
           END-EVALUATE.                                                22564600
           EVALUATE ASC-XFER-TYPE                                       22564700
               WHEN PC-CALLBACK                                         22564800
                   MOVE DP015-UNP-NUM-NOR-OFF                           22564900
                                         TO MR-E-CALLBACK-NBR-A         22565000
                   MOVE DP015-GREEN      TO MR-E-CALLBACK-NBR-C         22565100
                   MOVE DP015-UNDERLINE  TO MR-E-CALLBACK-NBR-H         22565200
           END-EVALUATE.                                                22565300
      *                                                                 22565400
      ******************************************************************22565500
      ** EDIT THE HEADING INFORMATION.                                **22565600
      ******************************************************************22565700
       3300-EDIT-HEADER-INFO.                                           22565800
           IF ASC-RECV-BY-INT NOT > SPACES                              22565900
               MOVE DP015-RED             TO MR-A-RECV-BY-INT-C         22566000
               MOVE DP015-REVERSE         TO MR-A-RECV-BY-INT-H         22566100
               IF ASC-NO-ERROR                                          22566200
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22566300
                   SET DP020-MSG-FATAL    TO TRUE                       22566400
                   MOVE -1                TO MR-A-RECV-BY-INT-L         22566500
                   SET DP030-SET-CURSOR-APPL-1                          22566600
                       ASC-ERROR          TO TRUE                       22566700
               END-IF                                                   22566800
           END-IF                                                       22566900
           IF ASC-RECV-BY-NAM-19 NOT > SPACES                           22567000
               MOVE DP015-RED             TO MR-A-RECV-BY-NAM-C         22567100
               MOVE DP015-REVERSE         TO MR-A-RECV-BY-NAM-H         22567200
               IF ASC-NO-ERROR                                          22567300
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22567400
                   SET DP020-MSG-FATAL    TO TRUE                       22567500
                   MOVE -1                TO MR-A-RECV-BY-NAM-L         22567600
                   SET DP030-SET-CURSOR-APPL-1                          22567700
                       ASC-ERROR          TO TRUE                       22567800
               END-IF                                                   22567900
           END-IF.                                                      22568000
           EVALUATE ASC-CONTNR-TYPE                                     22568100
               WHEN PC-TRAILER                                          22568200
                   PERFORM 3360-EDIT-TRAILER                            22568300
               WHEN PC-SECURE-TOTE                                      22568400
                   PERFORM 3370-EDIT-TOTE                               22568500
           END-EVALUATE.                                                22568600
           EVALUATE ASC-XFER-TYPE                                       22568700
               WHEN PC-CALLBACK                                         22568800
                   IF ASC-NEW-CALLBACK-N NOT > ZERO                     22568900
                       MOVE DP015-RED           TO MR-E-CALLBACK-NBR-C  22569000
                       MOVE DP015-REVERSE       TO MR-E-CALLBACK-NBR-H  22569100
                       IF ASC-NO-ERROR                                  22569200
                           MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER     22569300
                           SET DP020-MSG-FATAL  TO TRUE                 22569400
                           MOVE -1              TO MR-E-CALLBACK-NBR-L  22569500
                           SET DP030-SET-CURSOR-APPL-4                  22569600
                               ASC-ERROR        TO TRUE                 22569700
                       END-IF                                           22569800
                   END-IF                                               22569900
           END-EVALUATE.                                                22570000
                                                                        22570100
      ******************************************************************22570200
      ** EDIT THE TRAILER INFORMATION.                                **22570300
      ******************************************************************22570400
       3360-EDIT-TRAILER.                                               22570500
           IF ASC-TRAILER-SEAL NOT > SPACES                             22570600
               MOVE DP015-RED             TO MR-C-TRLR-SEAL-C           22570700
               MOVE DP015-REVERSE         TO MR-C-TRLR-SEAL-H           22570800
               IF ASC-NO-ERROR                                          22570900
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22571000
                   SET DP020-MSG-FATAL    TO TRUE                       22571100
                   MOVE -1                TO MR-C-TRLR-SEAL-L           22571200
                   SET DP030-SET-CURSOR-APPL-2                          22571300
                       ASC-ERROR          TO TRUE                       22571400
               END-IF                                                   22571500
           END-IF.                                                      22571600
           IF ASC-TRAILER-NBR NOT > SPACES                              22571700
               MOVE DP015-RED             TO MR-C-TRLR-NBR-C            22571800
               MOVE DP015-REVERSE         TO MR-C-TRLR-NBR-H            22571900
               IF ASC-NO-ERROR                                          22572000
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22572100
                   SET DP020-MSG-FATAL    TO TRUE                       22572200
                   MOVE -1                TO MR-C-TRLR-NBR-L            22572300
                   SET DP030-SET-CURSOR-APPL-2                          22572400
                       ASC-ERROR          TO TRUE                       22572500
               END-IF                                                   22572600
           END-IF.                                                      22572700
      ******************************************************************22572800
      ** EDIT THE TOTE INFORMATION - ONLY REQUIRED FOR SECURE TOTES.  **22572900
      ******************************************************************22573000
       3370-EDIT-TOTE.                                                  22573100
           IF ASC-LG-TOTE-SEAL1 NOT > SPACES                            22573200
               MOVE DP015-RED             TO MR-B-LG-TOTE-SEAL1-C       22573300
               MOVE DP015-REVERSE         TO MR-B-LG-TOTE-SEAL1-H       22573400
               IF ASC-NO-ERROR                                          22573500
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22573600
                   SET DP020-MSG-FATAL    TO TRUE                       22573700
                   MOVE -1                TO MR-B-LG-TOTE-SEAL1-L       22573800
                   SET DP030-SET-CURSOR-APPL-2                          22573900
                       ASC-ERROR          TO TRUE                       22574000
               END-IF                                                   22574100
           END-IF.                                                      22574200
           IF ASC-LG-TOTE-SEAL2 NOT > SPACES                            22574300
               MOVE DP015-RED             TO MR-B-LG-TOTE-SEAL2-C       22574400
               MOVE DP015-REVERSE         TO MR-B-LG-TOTE-SEAL2-H       22574500
               IF ASC-NO-ERROR                                          22574600
                   MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER           22574700
                   SET DP020-MSG-FATAL    TO TRUE                       22574800
                   MOVE -1                TO MR-B-LG-TOTE-SEAL2-L       22574900
                   SET DP030-SET-CURSOR-APPL-2                          22575000
                       ASC-ERROR          TO TRUE                       22575100
               END-IF                                                   22575200
           END-IF.                                                      22575300
      *                                                                 23750000
      *----------------------------------------------------------------*25350000
      *    SET UP AND DISPLAY THE INITIAL SCREEN.                      *25360000
      *----------------------------------------------------------------*25390000
                                                                        25400000
       4000-BUILD-INITIAL-PANEL.                                        25410000
           SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25500000
           MOVE -1          TO MR-A-RECV-BY-INT-L.                      25510000
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        25520000
       EJECT                                                            25530000
                                                                        25540000
      *----------------------------------------------------------------*25540100
      * SELECT DATA FROM THE TRANSFER TABLES                            25540200
      *----------------------------------------------------------------*25540300
       4100-GET-TRANSFER.                                               25540400
           PERFORM                                                      25540500
               WITH TEST AFTER                                          25540600
               VARYING PV-RETRY-COUNT                                   25540700
               FROM 1 BY 1                                              25540800
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 25540900
                         OR (SQLCODE = ZERO)                            25541000
                         OR (SQLCODE = +100))                           25541100
      *                                                                 25541200
               EXEC SQL                                                 25541300
                   SELECT X.FR_STR_NBR                                  25541400
                         ,X.TO_STR_NBR                                  25541500
                         ,X.CPLD_INIT_1ST_NM                            25541600
                         ,X.CPLD_LAST_NM                                25541700
                         ,X.LG_TTE_1ST_SEAL_ID                          25541800
                         ,X.LG_TTE_2ND_SEAL_ID                          25541900
                         ,X.SM_TTE_BAG_SEAL_ID                          25542000
                         ,X.TRLR_NBR                                    25542100
                         ,X.TRLR_SEAL_ID                                25542200
                         ,X.CLBK_NBR                                    25542300
                         ,X.STK_BAL_APVL_NBR                            25542400
                         ,X.RQSTR_INIT_1ST_NM                           25542500
                         ,X.RQSTR_LAST_NM                               25542600
                         ,X.ATTN_INIT_1ST_NM                            25542700
                         ,X.ATTN_LAST_NM                                25542800
                         ,CT.CONTNR_TYP_DESC                            25542900
                         ,XT.TYP_1ST_LNE_DESC                           25543000
                         ,XT.TYP_2ND_LNE_DESC                           25543100
                   INTO   :TFMSTR-FR-STR-NBR                            25543200
                         ,:TFMSTR-TO-STR-NBR                            25543300
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      25543400
                         ,:TFMSTR-CPLD-LAST-NM                          25543500
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    25543600
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    25543700
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    25543800
                         ,:TFMSTR-TRLR-NBR                              25543900
                         ,:TFMSTR-TRLR-SEAL-ID                          25544000
                         ,:TFMSTR-CLBK-NBR                              25544100
                         ,:TFMSTR-STK-BAL-APVL-NBR                      25544200
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     25544300
                         ,:TFMSTR-RQSTR-LAST-NM                         25544400
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      25544500
                         ,:TFMSTR-ATTN-LAST-NM                          25544600
                         ,:TFSHCT-CONTNR-TYP-DESC                       25544700
                         ,:TFTYCD-TYP-1ST-LNE-DESC                      25544800
                         ,:TFTYCD-TYP-2ND-LNE-DESC                      25544900
                   FROM   TTFMSTR X                                     25545000
                         ,TTFSHCT CT                                    25545100
                         ,TTFTYCD XT                                    25545200
                   WHERE  X.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND   25545300
                          X.CONTNR_TYP_CDE = CT.CONTNR_TYP_CDE    AND   25545400
                          X.XFER_TYP_CDE   = XT.XFER_TYP_CDE            25545500
               END-EXEC                                                 25545600
                                                                        25545700
               EVALUATE TRUE                                            25545800
                   WHEN SQLCODE = ZERO                                  25545900
                      SET PS-TRANSFER-FOUND     TO TRUE                 25546000
                      MOVE TFMSTR-FR-STR-NBR    TO ASC-FR-STORE-NBR     25546100
                      MOVE TFMSTR-TO-STR-NBR    TO ASC-TO-STORE-NBR     25546200
                      MOVE SPACES               TO ASC-COMP-BY          25546300
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      25546400
                                                TO ASC-COMP-BY-INT      25546500
                      MOVE TFMSTR-CPLD-LAST-NM  TO ASC-COMP-BY-NAM      25546600
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    25546700
                                              TO ASC-CMP-LG-TOTE-SEAL1  25546800
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    25546900
                                              TO ASC-CMP-LG-TOTE-SEAL2  25547000
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    25547100
                                              TO ASC-CMP-SM-TOTE-SEAL   25547200
                      MOVE TFMSTR-TRLR-NBR      TO ASC-CMP-TRAILER-NBR  25547300
                      MOVE TFMSTR-TRLR-SEAL-ID  TO ASC-CMP-TRAILER-SEAL 25547400
                      MOVE TFMSTR-CLBK-NBR      TO ASC-CALLBACK-NBR-N   25547500
                                                   ASC-NEW-CALLBACK-N   25547600
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      25547700
                                                TO ASC-APPROVAL-NBR-N   25547800
                      MOVE SPACES               TO ASC-REQ-BY           25547900
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     25548000
                                                TO ASC-REQ-BY-INT       25548100
                      MOVE TFMSTR-RQSTR-LAST-NM TO ASC-REQ-BY-NAM       25548200
                      MOVE SPACES               TO ASC-ATTN-TO          25548300
                      MOVE TFMSTR-ATTN-INIT-1ST-NM                      25548400
                                                TO ASC-ATTN-TO-INT      25548500
                      MOVE TFMSTR-ATTN-LAST-NM  TO ASC-ATTN-TO-NAM      25548600
                      MOVE TFSHCT-CONTNR-TYP-DESC                       25548700
                                                TO ASC-CONTNR-DESC      25548800
                      IF TFTYCD-TYP-2ND-LNE-DESC = SPACES               25548900
                          MOVE TFTYCD-TYP-1ST-LNE-DESC                  25549000
                                         TO ASC-XFER-DESC               25550000
                      ELSE                                              25560000
                          STRING                                        25570000
                              TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 25580000
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 25590000
                                         INTO ASC-XFER-DESC             25600000
                      END-IF                                            25600100
                      PERFORM 4200-GET-STORE-NAMES                      25600200
                      PERFORM 4300-READ-TRANSFER-ITEM                   25600300
                      IF ASC-XFER-TYPE = PC-CUSTOMER                    25600400
                          PERFORM 4350-READ-CUSTOMER                    25600500
                      END-IF                                            25600600
                   WHEN SQLCODE = +100                                  25600700
                   WHEN SQLCODE = -904                                  25600800
                   WHEN SQLCODE = -913                                  25600900
                       CONTINUE                                         25601000
                   WHEN SQLWARN0 NOT = SPACES                           25601100
                   WHEN SQLCODE < ZERO                                  25601200
                   WHEN SQLCODE > ZERO                                  25601300
                       MOVE '4100-GET-TRANSFER'                         25601400
                                         TO DP013-PARAGRAPH             25601500
                       MOVE 'SELECT TRANSFER DATA'                      25601600
                                         TO DP013-MESSAGE-TEXT (1)      25601700
                       MOVE SQLCA        TO DP013-SQLCA                 25601800
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    25601900
                       MOVE 'TTFSHCT'    TO DP013-DB2-TABLE-NAME (2)    25602000
                       MOVE 'TTFTYCD'    TO DP013-DB2-TABLE-NAME (3)    25602100
                       SET DP013-DB2-ABEND                              25602200
                           DP013-XCTL-DISPLAY-RESTART                   25602300
                                         TO TRUE                        25602400
                       PERFORM DP013-0000-PROCESS-ABEND                 25602500
               END-EVALUATE                                             25602600
           END-PERFORM.                                                 25602700
      *                                                                 25602800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          25602900
               MOVE '4100-GET-TRANSFER'                                 25603000
                                         TO DP013-PARAGRAPH             25603100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25603200
                                         TO DP013-MESSAGE-TEXT (1)      25603300
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      25603400
               MOVE SQLCA                TO DP013-SQLCA                 25603500
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    25603600
               MOVE 'TTFSHCT'            TO DP013-DB2-TABLE-NAME (2)    25603700
               MOVE 'TTFTYCD'            TO DP013-DB2-TABLE-NAME (3)    25603800
               SET DP013-DB2-ABEND                                      25603900
                   DP013-XCTL-DISPLAY-RESTART                           25604000
                                         TO TRUE                        25604100
               PERFORM DP013-0000-PROCESS-ABEND                         25604200
           END-IF.                                                      25604300
       EJECT                                                            25604400
      *----------------------------------------------------------------*25604500
      *    GET THE 10 CHARACTER STORE NAME FOR FROM & TO STORES.       *25604600
      *----------------------------------------------------------------*25604700
       4200-GET-STORE-NAMES.                                            25604800
           MOVE ASC-FR-STORE-NBR         TO DK-STORE-NBR.               25604900
100404     PERFORM 4250-READ-XST-LOC.                                   25605000
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-FR-STORE-NAM.           25605100
           MOVE ASC-TO-STORE-NBR         TO DK-STORE-NBR.               25605200
100404     PERFORM 4250-READ-XST-LOC.                                   25605300
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-TO-STORE-NAM.           25605400
       EJECT                                                            25605500
      *----------------------------------------------------------------*25605600
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *25605700
      *----------------------------------------------------------------*25605800
100404 4250-READ-XST-LOC.                                               25605900
           PERFORM WITH TEST AFTER                                      25606000
               VARYING PV-RETRY-COUNT                                   25606100
               FROM 1 BY 1                                              25606200
               UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  25606300
                    OR SQLCODE = ZERO                                   25606400
                    OR SQLCODE = +100                                   25606500
               EXEC SQL                                                 25606600
100404             SELECT LOC_10_ABBR_NM                                25606700
100404                 INTO :XST00001-LOC-10-ABBR-NM                    25606800
100404                 FROM XST_LOC                                     25606900
100404                 WHERE (LOC_NBR  = :DK-STORE-NBR)                 25607000
               END-EXEC                                                 25607100
               EVALUATE TRUE                                            25607200
                   WHEN SQLCODE = ZERO                                  25607300
                   WHEN SQLCODE = -904                                  25607400
                   WHEN SQLCODE = -913                                  25607500
                       CONTINUE                                         25607600
                   WHEN SQLCODE = +100                                  25607700
100404                 MOVE 'INVALID'     TO XST00001-LOC-10-ABBR-NM    25607800
                   WHEN OTHER                                           25607900
100404                 MOVE '4250-READ-XST-LOC'                         25608200
                                         TO DP013-PARAGRAPH             25608300
100404                 MOVE 'SELECT A ROW FROM XST_LOC'                 25608400
                                         TO DP013-MESSAGE-TEXT (1)      25608500
                       MOVE SQLCA        TO DP013-SQLCA                 25608600
100404                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)    25608700
                       SET DP013-DB2-ABEND                              25608800
                           DP013-XCTL-DISPLAY-RESTART                   25608900
                                         TO TRUE                        25609000
                       PERFORM DP013-0000-PROCESS-ABEND                 25609100
               END-EVALUATE                                             25609200
           END-PERFORM.                                                 25609300
      *                                                                 25609400
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          25609500
100404         MOVE '4250-READ-XST-LOC'                                 25609600
                                         TO DP013-PARAGRAPH             25609700
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25609800
                                         TO DP013-MESSAGE-TEXT (1)      25609900
100404         MOVE 'A ROW FROM XST_LOC' TO DP013-MESSAGE-TEXT (2)      25610000
               MOVE SQLCA                TO DP013-SQLCA                 25610100
100404         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)    25610200
               SET DP013-DB2-ABEND                                      25610300
                   DP013-XCTL-DISPLAY-RESTART                           25610400
                                         TO TRUE                        25610500
               PERFORM DP013-0000-PROCESS-ABEND                         25610600
           END-IF.                                                      25610700
       EJECT                                                            25610800
      *----------------------------------------------------------------*25610900
      *  GET THE TOTAL XFER QTY & PRICE.                               *25611000
      *----------------------------------------------------------------*25611100
       4300-READ-TRANSFER-ITEM.                                         25611200
           PERFORM WITH TEST AFTER                                      25611300
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       25611400
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  25611500
                    OR SQLCODE = ZERO                                   25611600
                    OR SQLCODE = +100                                   25611700
               EXEC SQL                                                 25611800
                   SELECT SUM(XFER_PRIC_AMT * XFER_QTY)                 25611900
                         ,SUM(XFER_QTY)                                 25612000
                       INTO :PV-XFER-PRICE                              25613000
                            :PV-XFER-PRICE-IND                          25613100
                           ,:PV-XFER-QTY                                25613200
                            :PV-XFER-QTY-IND                            25613300
                       FROM TTFITEM                                     25613400
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           25613500
               END-EXEC                                                 25613600
               EVALUATE TRUE                                            25613700
                   WHEN SQLCODE = ZERO                                  25613800
                   WHEN SQLCODE = +100                                  25613900
                   WHEN SQLCODE = -904                                  25614000
                   WHEN SQLCODE = -913                                  25614100
                       CONTINUE                                         25614200
                   WHEN SQLWARN0 NOT = SPACES                           25614300
                   WHEN SQLCODE < ZERO                                  25614400
                   WHEN SQLCODE > ZERO                                  25614500
                       MOVE '4300-READ-TRANSFER-ITEM'                   25614600
                                         TO DP013-PARAGRAPH             25614700
                       MOVE 'SUMMARIZE DATA FROM TTFITEM'               25614800
                                         TO DP013-MESSAGE-TEXT (1)      25614900
                       MOVE SQLCA        TO DP013-SQLCA                 25615000
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)    25615100
                       SET DP013-DB2-ABEND                              25615200
                           DP013-XCTL-DISPLAY-RESTART                   25615300
                                         TO TRUE                        25615400
                       PERFORM DP013-0000-PROCESS-ABEND                 25615500
               END-EVALUATE                                             25615600
           END-PERFORM.                                                 25615700
      *                                                                 25615800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          25615900
               MOVE '4300-READ-TRANSFER-ITEM'                           25616000
                                         TO DP013-PARAGRAPH             25616100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25616200
                                         TO DP013-MESSAGE-TEXT (1)      25616300
               MOVE 'DATA FROM TTFITEM'  TO DP013-MESSAGE-TEXT (2)      25616400
               MOVE SQLCA                TO DP013-SQLCA                 25616500
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)    25616600
               SET DP013-DB2-ABEND                                      25616700
                   DP013-XCTL-DISPLAY-RESTART                           25616800
                                         TO TRUE                        25616900
               PERFORM DP013-0000-PROCESS-ABEND                         25617000
           END-IF.                                                      25617100
      *                                                                 25617200
           IF SQLCODE = +100                                            25617300
               MOVE ZEROES                TO ASC-TOT-RETAIL             25617400
                                             ASC-TOT-QTY                25617500
           ELSE                                                         25617600
                   MOVE PV-XFER-PRICE                                   25617700
                                          TO ASC-TOT-RETAIL             25617800
                   MOVE PV-XFER-QTY                                     25617900
                                          TO ASC-TOT-QTY                25618000
           END-IF.                                                      25618100
       EJECT                                                            25618200
      *----------------------------------------------------------------*35413800
      * SELECT DATA FROM THE TRANSFER CUSTOMER TABLE.                  *35413900
      *----------------------------------------------------------------*35414000
       4350-READ-CUSTOMER.                                              35415000
           INITIALIZE DCLTTFCUST.                                       35415100
           PERFORM WITH TEST AFTER                                      35415200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       35415300
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  35415400
                    OR SQLCODE = ZERO                                   35415500
                    OR SQLCODE = +100                                   35415600
               EXEC SQL                                                 35415700
                   SELECT CUST_NM                                       35415800
                         ,CUST_1ST_LNE_ADDR                             35415900
                         ,CUST_2ND_LNE_ADDR                             35416000
                         ,CTY_NM                                        35416100
                         ,ST_CDE                                        35416200
                         ,ZIP_CDE                                       35416300
                         ,ZIP_EXT_CDE                                   35416400
                         ,PHN_NBR                                       35416500
                       INTO :TFCUST-CUST-NM                             35416600
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   35416700
                           ,:TFCUST-CUST-2ND-LNE-ADDR                   35416800
                           ,:TFCUST-CTY-NM                              35416900
                           ,:TFCUST-ST-CDE                              35417000
                           ,:TFCUST-ZIP-CDE                             35417100
                           ,:TFCUST-ZIP-EXT-CDE                         35417200
                           ,:TFCUST-PHN-NBR                             35417300
                       FROM TTFCUST                                     35417400
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           35417500
               END-EXEC                                                 35417600
               EVALUATE TRUE                                            35417700
                   WHEN SQLCODE = -904                                  35417800
                   WHEN SQLCODE = -913                                  35417900
                       CONTINUE                                         35418000
                   WHEN SQLCODE = +100                                  35418100
                       MOVE 'NOT FOUND'   TO ASC-CUST-NAME              35418300
                   WHEN SQLCODE = ZERO                                  35418400
                       MOVE TFCUST-CUST-NM                              35418700
                                          TO ASC-CUST-NAME              35418800
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    35418900
                                          TO ASC-ADDR1                  35419000
                       MOVE TFCUST-CUST-2ND-LNE-ADDR                    35419100
                                          TO ASC-ADDR2                  35419200
                       MOVE TFCUST-CTY-NM                               35419300
                                          TO ASC-CITY                   35419400
                       MOVE TFCUST-ST-CDE                               35419500
                                          TO ASC-STATE                  35419600
                       MOVE TFCUST-ZIP-CDE                              35419700
                                          TO ASC-ZIP                    35419800
                       MOVE TFCUST-ZIP-EXT-CDE                          35419900
                                          TO ASC-ZIP-EXT                35420000
                       MOVE TFCUST-PHN-NBR                              35420100
                                          TO ASC-PHONE                  35420200
                   WHEN SQLWARN0 NOT = SPACES                           35420300
                   WHEN SQLCODE < ZERO                                  35420400
                   WHEN SQLCODE > ZERO                                  35420500
                       MOVE '4350-READ-CUSTOMER'                        35420600
                                         TO DP013-PARAGRAPH             35420700
                       MOVE 'READ DATA FROM TTFCUST'                    35420800
                                         TO DP013-MESSAGE-TEXT (1)      35420900
                       MOVE SQLCA        TO DP013-SQLCA                 35421000
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    35421100
                       SET DP013-DB2-ABEND                              35421200
                           DP013-XCTL-DISPLAY-RESTART                   35421300
                                         TO TRUE                        35421400
                       PERFORM DP013-0000-PROCESS-ABEND                 35421500
               END-EVALUATE                                             35421600
           END-PERFORM.                                                 35421700
      *                                                                 35421800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          35421900
               MOVE '4350-READ-CUSTOMER'                                35422000
                                         TO DP013-PARAGRAPH             35422100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35422200
                                         TO DP013-MESSAGE-TEXT (1)      35422300
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      35422400
               MOVE SQLCA                TO DP013-SQLCA                 35422500
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    35422600
               SET DP013-DB2-ABEND                                      35422700
                   DP013-XCTL-DISPLAY-RESTART                           35422800
                                         TO TRUE                        35422900
               PERFORM DP013-0000-PROCESS-ABEND                         35423000
           END-IF.                                                      35423100
       EJECT                                                            40540000
      *----------------------------------------------------------------*40540100
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *40540200
      *----------------------------------------------------------------*40540300
                                                                        40540400
       4400-MOVE-COMMAREA-TO-SCREEN.                                    40540500
           MOVE ASC-RCV-STORE-NBR              TO MR-A-RECV-STR.        40540600
           MOVE ASC-XFER-NBR                   TO MR-A-XFER-NBR.        40540700
           MOVE ASC-RECV-BY-INT                TO MR-A-RECV-BY-INT.     40540800
           MOVE ASC-RECV-BY-NAM                TO MR-A-RECV-BY-NAM.     40540900
           MOVE ASC-XFER-TYPE(2:1)             TO MR-D-XFER-TYPE.       40541000
           MOVE ASC-XFER-DESC                  TO MR-D-XFER-DESC.       40541100
           MOVE ASC-CONTNR-TYPE(2:1)           TO MR-D-CONT-TYPE.       40541200
           MOVE ASC-CONTNR-DESC                TO MR-D-CONT-DESC.       40541300
           MOVE ASC-TO-STORE-NBR               TO MR-D-TO-STORE-NBR.    40541400
           MOVE ASC-TO-STORE-NAM               TO MR-D-TO-STORE-NAM.    40541500
           MOVE ASC-FR-STORE-NBR               TO MR-D-FR-STORE-NBR.    40541600
           MOVE ASC-FR-STORE-NAM               TO MR-D-FR-STORE-NAM.    40541700
           MOVE ASC-TOT-QTY                    TO MR-G-TOT-QTY.         40541800
           MOVE ASC-TOT-RETAIL                 TO MR-G-TOT-RTL.         40541900
           SET DP030-ERASE                                              40542000
               DP030-SEND-MAP-AND-DATA (1)                              40542100
               DP030-SEND-MAP-AND-DATA (2)                              40542200
               DP030-SEND-MAP-AND-DATA (3)                              40542300
               DP030-SEND-MAP-AND-DATA (4)                              40542400
               DP030-SEND-MAP-AND-DATA (5)     TO TRUE.                 40542500
           MOVE PC-COMMON-MAP1-NAME            TO DP030-MAP-NAME (1).   40542600
           MOVE 1                              TO PV-MAP-START-BYTE.    40542700
           MOVE MR-A-COMMON                    TO MD-MAP-DATA-AREA.     40542800
           MOVE LENGTH OF MR-A-COMMON          TO DP030-MAP-LENGTH (1). 40542900
           ADD DP030-MAP-LENGTH (1)            TO PV-MAP-START-BYTE.    40543000
           EVALUATE ASC-XFER-TYPE                                       40543100
               WHEN PC-CUSTOMER                                         40543200
                   MOVE SPACES                 TO MR-F-LITERAL-2        40543300
                                                  MR-F-FIELD-2          40543400
                                                  PV-NAME               40543500
                   MOVE PC-REQUESTOR-LITERAL   TO MR-F-LITERAL-1        40543600
                   MOVE ASC-REQ-BY-INT         TO PV-INT                40543700
                   MOVE ASC-REQ-BY-NAM         TO PV-NAM                40543800
                   MOVE PV-NAME                TO MR-F-FIELD-1          40543900
                   MOVE PC-CUST-NAME-LITERAL   TO MR-G-CUST-NAME-LIT    40544000
                   MOVE ASC-CUST-NAME          TO MR-G-CUST-NAME        40544100
                   MOVE PC-CUST-PHONE-LITERAL  TO MR-G-CUST-PHONE-LIT   40544200
                   MOVE ASC-PHONE-AREA-N       TO PV-PHONE-AREA         40544300
                   MOVE ASC-PHONE-EXCH-N       TO PV-PHONE-EXCH         40544400
                   MOVE ASC-PHONE-NBR-N        TO PV-PHONE-NBR          40544500
                   MOVE PV-PHONE               TO MR-G-CUST-PHONE       40544600
                   MOVE PC-ADDRESS-LITERAL     TO MR-G-ADDRESS-LIT      40544700
                   MOVE ASC-ADDR1              TO MR-G-ADDR1            40544800
                   MOVE ASC-ADDR2              TO MR-G-ADDR2            40544900
                   MOVE PC-CITY-LITERAL        TO MR-G-CITY-LIT         40545000
                   MOVE ASC-CITY               TO MR-G-CITY             40545100
                   MOVE PC-STATE-LITERAL       TO MR-G-STATE-LIT        40545200
                   MOVE ASC-STATE              TO MR-G-STATE            40545300
                   MOVE ASC-ZIP                TO PV-ZIP-CODE           40545400
                   IF ASC-ZIP-EXT > SPACES                              40545500
                       MOVE ASC-ZIP-EXT        TO PV-ZIP-EXT            40545600
                       MOVE '-'                TO PV-ZIP-DASH           40545700
                   END-IF                                               40545800
                   MOVE PV-ZIP                 TO MR-G-ZIP              40545900
               WHEN OTHER                                               40546000
                   MOVE SPACES                 TO MR-F-LITERAL-1        40546100
                                                  MR-F-LITERAL-2        40546200
                                                  MR-F-FIELD-1          40546300
                                                  MR-F-FIELD-2          40546400
                                                  MR-G-CUST-NAME-LIT    40546500
                                                  MR-G-CUST-NAME        40546600
                                                  MR-G-CUST-PHONE-LIT   40546700
                                                  MR-G-CUST-PHONE       40546800
                                                  MR-G-ADDRESS-LIT      40546900
                                                  MR-G-ADDR1            40547000
                                                  MR-G-ADDR2            40547100
                                                  MR-G-CITY-LIT         40547200
                                                  MR-G-CITY             40547300
                                                  MR-G-STATE-LIT        40547400
                                                  MR-G-STATE            40547500
                                                  MR-G-ZIP              40547600
           END-EVALUATE.                                                40547700
           EVALUATE ASC-XFER-TYPE                                       40547800
               WHEN PC-CALLBACK                                         40547900
                   MOVE ASC-NEW-CALLBACK       TO MR-E-CALLBACK-NBR     40548000
               WHEN PC-STOCK-BAL-CORP                                   40549000
                   MOVE PC-APPROVAL-LITERAL    TO MR-F-LITERAL-1        40550000
                   MOVE ASC-APPROVAL-NBR       TO MR-F-FIELD-1          40550100
               WHEN PC-NON-RETAIL                                       40550200
                   MOVE PC-REQUESTOR-LITERAL   TO MR-F-LITERAL-1        40550300
                   MOVE SPACES                 TO PV-NAME               40550400
                   MOVE ASC-REQ-BY-INT         TO PV-INT                40550500
                   MOVE ASC-REQ-BY-NAM         TO PV-NAM                40550600
                   MOVE PV-NAME                TO MR-F-FIELD-1          40550700
                   MOVE PC-ATTENTION-LITERAL   TO MR-F-LITERAL-2        40550800
                   MOVE SPACES                 TO PV-NAME               40550900
                   MOVE ASC-ATTN-TO-INT        TO PV-INT                40551000
                   MOVE ASC-ATTN-TO-NAM        TO PV-NAM                40552000
                   MOVE PV-NAME                TO MR-F-FIELD-2          40552100
           END-EVALUATE.                                                40552200
           EVALUATE ASC-CONTNR-TYPE                                     40552300
               WHEN PC-TRAILER                                          40552400
                   MOVE ASC-TRAILER-NBR        TO MR-C-TRLR-NBR         40552500
                   MOVE ASC-TRAILER-SEAL       TO MR-C-TRLR-SEAL        40552600
                   MOVE PC-TRAILER-MAP-NAME                             40552700
                                               TO DP030-MAP-NAME (2)    40552800
                   MOVE LENGTH OF MR-C-TRAILER                          40552900
                                               TO DP030-MAP-LENGTH (2)  40553000
                   MOVE MR-C-TRAILER           TO MD-MAP-DATA-AREA      40553100
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   40553200
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     40553300
               WHEN OTHER                                               40553400
                   MOVE ASC-LG-TOTE-SEAL1      TO MR-B-LG-TOTE-SEAL1    40553500
                   MOVE ASC-LG-TOTE-SEAL2      TO MR-B-LG-TOTE-SEAL2    40553600
                   MOVE ASC-SM-TOTE-SEAL       TO MR-B-SM-TOTE-SEAL     40553700
                   MOVE PC-TOTE-MAP-NAME                                40553800
                                               TO DP030-MAP-NAME (2)    40553900
                   MOVE LENGTH OF MR-B-TOTES                            40554000
                                               TO DP030-MAP-LENGTH (2)  40554100
                   MOVE MR-B-TOTES             TO MD-MAP-DATA-AREA      40554200
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   40554300
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     40554400
           END-EVALUATE.                                                40554500
           MOVE PC-COMMON-MAP2-NAME            TO DP030-MAP-NAME (3).   40554600
           MOVE MR-D-COMMON                    TO MD-MAP-DATA-AREA      40554700
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (3))   40554800
           MOVE LENGTH OF MR-D-COMMON          TO DP030-MAP-LENGTH (3). 40554900
           ADD DP030-MAP-LENGTH (3)            TO PV-MAP-START-BYTE.    40555000
           IF ASC-XFER-TYPE = PC-CALLBACK                               40555100
               MOVE PC-CALLBACK-MAP-NAME       TO DP030-MAP-NAME (4)    40555200
               MOVE LENGTH OF MR-E-CALLBACK    TO DP030-MAP-LENGTH (4)  40555300
               MOVE MR-E-CALLBACK              TO MD-MAP-DATA-AREA      40555400
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))   40555500
               ADD DP030-MAP-LENGTH (4)        TO PV-MAP-START-BYTE     40555600
           ELSE                                                         40555700
               MOVE PC-NON-CALLBACK-MAP-NAME   TO DP030-MAP-NAME (4)    40555800
               MOVE LENGTH OF MR-F-NON-CALLBACK TO DP030-MAP-LENGTH (4) 40555900
               MOVE MR-F-NON-CALLBACK          TO MD-MAP-DATA-AREA      40556000
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (4))   40556100
               ADD DP030-MAP-LENGTH (4)        TO PV-MAP-START-BYTE     40556200
           END-IF.                                                      40556300
           MOVE PC-COMMON-MAP3-NAME            TO DP030-MAP-NAME (5).   40556400
           MOVE MR-G-COMMON                    TO MD-MAP-DATA-AREA      40556500
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (5))   40556600
           MOVE LENGTH OF MR-G-COMMON          TO DP030-MAP-LENGTH (5). 40556700
           ADD DP030-MAP-LENGTH (5)            TO PV-MAP-START-BYTE.    40556800
       EJECT                                                            40556900
      *----------------------------------------------------------------*40557000
      * CHECK FOR SEAL DISCREPANCY. LG TOTE SEAL 1 & 2 MAY BE REVERSED *40557100
      *----------------------------------------------------------------*40557200
       5000-CHECK-FOR-DISCREPANCY.                                      40557300
           EVALUATE TRUE                                                40557400
                ALSO TRUE                                               40557500
               WHEN (ASC-LG-TOTE-SEAL1 = ASC-CMP-LG-TOTE-SEAL1 AND      40557600
                     ASC-LG-TOTE-SEAL2 = ASC-CMP-LG-TOTE-SEAL2)         40557700
                ALSO ASC-SM-TOTE-SEAL = ASC-CMP-SM-TOTE-SEAL            40557800
               WHEN (ASC-LG-TOTE-SEAL1 = ASC-CMP-LG-TOTE-SEAL2 AND      40557900
                     ASC-LG-TOTE-SEAL2 = ASC-CMP-LG-TOTE-SEAL1)         40558000
                ALSO ASC-SM-TOTE-SEAL = ASC-CMP-SM-TOTE-SEAL            40559000
                   CONTINUE                                             40560000
               WHEN OTHER                                               40570000
                   SET PS-DISCREPANCY-EXISTS TO TRUE                    40580000
           END-EVALUATE.                                                40580100
       EJECT                                                            40580200
      *                                                                 40580300
      *----------------------------------------------------------------*40580400
      *  PERFORM THE TRANSFER RECEIPT.                                 *40580500
      *----------------------------------------------------------------*40580600
       6000-RECEIVE-TRANSFER.                                           40580700
           PERFORM 6010-OPEN-XFER-ITM-CSR.                              40580800
           PERFORM 7050-FETCH-XFER-ITM-CSR.                             40580900
                                                                        40581000
           PERFORM 6100-INSERT-XFER-ITM-RCPTS                           40582000
               UNTIL PS-END-OF-XFER-ITMS.                               40583000
                                                                        40584000
           PERFORM 6020-CLOSE-XFER-ITM-CSR.                             40584100
                                                                        40584200
           IF PS-UPDATE-STATUS                                          40584300
               PERFORM 7610-UPDATE-XFER-RECEIPT-ROW                     40584400
               PERFORM 7660-UPDATE-STATUS-TO-PR                         40584500
           ELSE                                                         40584600
               PERFORM 7600-INSERT-XFER-RECEIPT-ROW                     40584700
               PERFORM 7650-INSERT-XFER-PR-STAT-ROW                     40584800
           END-IF.                                                      40584900
           IF ASC-NEW-CALLBACK NOT = ASC-CALLBACK-NBR                   40585000
               MOVE ASC-NEW-CALLBACK-N    TO TFMSTR-CLBK-NBR            40586000
               PERFORM 8600-UPDATE-TTFMSTR                              40587000
           END-IF.                                                      40588000
      *                                                                 40588100
      *----------------------------------------------------------------*40588200
      *  OPEN THE TRANSFER ITEM CURSOR.                                *40588300
      *----------------------------------------------------------------*40588400
       6010-OPEN-XFER-ITM-CSR.                                          40588500
           EXEC SQL                                                     40588600
               OPEN XFER_ITM_CSR                                        40588700
           END-EXEC.                                                    40588800
                                                                        40588900
           EVALUATE TRUE                                                40589000
               WHEN SQLCODE = ZERO                                      40590000
                   CONTINUE                                             40600000
               WHEN SQLWARN0 NOT = SPACES                               40610000
               WHEN SQLCODE < ZERO                                      40620000
               WHEN SQLCODE > ZERO                                      40630000
                   MOVE '6010-OPEN-XFER-ITM-CSR'                        40640000
                                             TO DP013-PARAGRAPH         40650000
                   MOVE 'OPEN THE XFER_ITM_CSR CURSOR'                  40660000
                                             TO DP013-MESSAGE-TEXT (1)  40670000
                   MOVE SQLCA                TO DP013-SQLCA             40680000
                   MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)40680100
                   SET DP013-DB2-ABEND                                  40680200
                       DP013-XCTL-DISPLAY-RESTART                       40680300
                                             TO TRUE                    40680400
                   PERFORM DP013-0000-PROCESS-ABEND                     40680500
           END-EVALUATE.                                                40680600
      *                                                                 40680700
      *----------------------------------------------------------------*40680800
      * CLOSE THE TRANSFER ITEM CURSOR.                                *40680900
      *----------------------------------------------------------------*40681000
       6020-CLOSE-XFER-ITM-CSR.                                         40682000
           EXEC SQL                                                     40683000
               CLOSE XFER_ITM_CSR                                       40684000
           END-EXEC.                                                    40685000
                                                                        40686000
           EVALUATE TRUE                                                40687000
               WHEN SQLCODE = ZERO                                      40688000
                   CONTINUE                                             40689000
               WHEN SQLWARN0 NOT = SPACES                               40690000
               WHEN SQLCODE < ZERO                                      40700000
               WHEN SQLCODE > ZERO                                      40710000
                   MOVE '6020-CLOSE-XFER-ITM-CSR'                       40720000
                                             TO DP013-PARAGRAPH         40730000
                   MOVE 'CLOSE THE XFER_ITM_CSR CURSOR'                 40740000
                                             TO DP013-MESSAGE-TEXT (1)  40750000
                   MOVE SQLCA                TO DP013-SQLCA             40760000
                   MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)40760100
                   SET DP013-DB2-ABEND                                  40760200
                       DP013-XCTL-DISPLAY-RESTART                       40760300
                                             TO TRUE                    40760400
                   PERFORM DP013-0000-PROCESS-ABEND                     40760500
           END-EVALUATE.                                                40760600
      *----------------------------------------------------------------*40760700
      *  SET UP DATA TO BE INSERTED INTO THE ITEM RECEIPT TABLE        *40760800
      *----------------------------------------------------------------*40760900
       6100-INSERT-XFER-ITM-RCPTS.                                      40761000
           IF TFITEM-ITM-NBR  =  ZEROS                                  40762000
               MOVE ZEROS                 TO  TFITRC-RCVD-RTL-PRIC-AMT  40763000
           ELSE                                                         40764000
               PERFORM 7150-SELECT-CUR-UNT-RTL-AMT                      40765000
               MOVE PV-CUR-RTL-AMT        TO  TFITRC-RCVD-RTL-PRIC-AMT  40766000
           END-IF.                                                      40767000
                                                                        40768000
           PERFORM 7620-INSERT-ITM-RCPT.                                40769000
                                                                        40770000
           IF PS-XFER-DISCREPANCY AND ASC-RETAIL-XFER                   40780000
               PERFORM 6110-CREATE-ADJUSTMENT                           40790000
           END-IF.                                                      40800000
                                                                        40810000
           PERFORM 7050-FETCH-XFER-ITM-CSR.                             40820000
      *                                                                 40820100
      *----------------------------------------------------------------*40820200
      *  THERE IS A DISCREPANCY BETWEEN 'TO' STORE AND 'RECV' STORE,   *40820300
      *  SO INSERT MISDIRECT POSTINGS IN THE ITEM POSTING TABLE.       *40820400
      *----------------------------------------------------------------*40820500
       6110-CREATE-ADJUSTMENT.                                          40820600
           MOVE TFITEM-XFER-PRIC-AMT    TO  TFITPS-ITM-RTL-PRCE-AMT.    40820700
           MOVE TFITEM-XFER-QTY         TO  TFITPS-ITM-QTY.             40820800
           MOVE ASC-TO-STORE-NBR        TO  TFITPS-FRM-PSTG-STR-NBR.    40820900
           MOVE TFDSCP-RCVD-AT-STR-NBR  TO  TFITPS-TO-PSTG-STR-NBR.     40821000
           MOVE PC-MISDIRECT-RSN-CDE    TO  TFITPS-ADJ-RSN-CDE.         40822000
111703*    IF (ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE                    40823000
111703     IF (ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE-SORT1              40823100
111703           OR                                                     40824000
111703         ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE-SORT2              40824100
                 OR                                                     40824200
               ASC-XFER-TYPE  =  PC-CALLBACK)                           40825000
                 OR                                                     40826000
               (ASC-XFER-TYPE NOT = PC-NON-RETAIL                       40827000
                 AND                                                    40827100
                TFITEM-ITM-NBR = ZEROS)                                 40827200
              MOVE PC-MERCHANDISE-LEDGER TO TFITPS-EXTL-SYS-PRCG-CDE    40828000
           ELSE                                                         40829000
              MOVE PC-FASHION-SALES      TO TFITPS-EXTL-SYS-PRCG-CDE    40830000
           END-IF.                                                      40840000
           PERFORM 7300-SELECT-MAX-PSTG-SEQ-NBR.                        40850000
           PERFORM 7350-INSERT-ADJUSTMENT-ROW.                          40860000
      *                                                                 40870000
      *----------------------------------------------------------------*40880000
      *  GET THE CURRENT SYSTEM TIMESTAMP TO BE USED FOR THE RECEIPT.   40890000
      *----------------------------------------------------------------*40900000
       7000-SELECT-CURRENT-TIMESTAMP.                                   40910000
                                                                        40920000
           EXEC SQL                                                     40930000
               SET  :PV-CURRENT-TIMESTAMP =   CURRENT TIMESTAMP         40940000
           END-EXEC.                                                    40950000
                                                                        40960000
           EVALUATE TRUE                                                40970000
               WHEN SQLCODE = ZERO                                      40980000
                   CONTINUE                                             40990000
               WHEN SQLWARN0 NOT = SPACES                               41000000
               WHEN SQLCODE < ZERO                                      41010000
               WHEN SQLCODE > ZERO                                      41020000
                   MOVE '7000-SELECT-CURRENT-TIMESTAMP'                 41030000
                                             TO DP013-PARAGRAPH         41040000
                   MOVE 'SELECT THE CURRENT TIMESTAMP'                  41050000
                                             TO DP013-MESSAGE-TEXT (1)  41060000
                   MOVE SQLCA                TO DP013-SQLCA             41070000
                   SET DP013-DB2-ABEND                                  41080000
                   DP013-XCTL-DISPLAY-RESTART                           41090000
                                            TO TRUE                     41100000
                   PERFORM DP013-0000-PROCESS-ABEND                     41110000
           END-EVALUATE.                                                41110100
      *                                                                 41110200
      *----------------------------------------------------------------*41110300
      *  GET THE CURRENT RECEIPT TIMESTAMP FOR THIS TRANSFER.           41110400
      *----------------------------------------------------------------*41110500
       7020-SELECT-CURRENT-RCPT.                                        41110600
           PERFORM                                                      41110700
               WITH TEST AFTER                                          41110800
               VARYING PV-RETRY-COUNT                                   41110900
               FROM 1 BY 1                                              41111000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 41111100
                   OR (SQLCODE = +0)                                    41111200
                   OR (SQLCODE = +100))                                 41111300
                                                                        41111400
               EXEC SQL                                                 41111500
                   SELECT  RCV_XFER_END_TMST                            41111600
                     INTO  :TFRCPT-RCV-XFER-END-TMST                    41111700
                     FROM  TTFRCPT                                      41111800
                    WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID  AND      41111900
                       RCV_XFER_BEG_TMST  =  :TFRCPT-RCV-XFER-BEG-TMST) 41112000
               END-EXEC                                                 41112100
                                                                        41112200
               EVALUATE TRUE                                            41112300
                   WHEN SQLCODE = ZERO                                  41112400
                   WHEN SQLCODE = +100                                  41112500
                   WHEN SQLCODE = -904                                  41112600
                   WHEN SQLCODE = -913                                  41112700
                       CONTINUE                                         41112800
                   WHEN SQLWARN0 NOT = SPACES                           41112900
                   WHEN SQLCODE < ZERO                                  41113000
                   WHEN SQLCODE > ZERO                                  41113100
                       MOVE '7020-SELECT-CURRENT-RCPT'                  41113200
                                             TO DP013-PARAGRAPH         41113300
                       MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIM41113400
      -                 'MP: '           TO DP013-MESSAGE-TEXT (1)      41113500
                       MOVE TFMSTR-XFER-DKEY-ID                         41113600
                                             TO PV-DISPLAY-XFER-DKEY-ID 41113700
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     41113800
                                             TO DP013-MESSAGE-TEXT (2)  41113900
                       MOVE TFRCPT-RCV-XFER-BEG-TMST                    41114000
                                             TO DP013-MESSAGE-TEXT (3)  41114100
                       MOVE SQLCA            TO DP013-SQLCA             41114200
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)41114300
                       SET DP013-DB2-ABEND                              41114400
                       DP013-XCTL-DISPLAY-RESTART                       41114500
                                            TO TRUE                     41114600
                       PERFORM DP013-0000-PROCESS-ABEND                 41114700
               END-EVALUATE                                             41114800
           END-PERFORM.                                                 41114900
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41115000
                   MOVE '7020-SELECT-CURRENT-RCPT'                      41115100
                                             TO DP013-PARAGRAPH         41115200
                   MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIMESTA41115300
      -                 'MP: '               TO DP013-MESSAGE-TEXT (1)  41115400
                   MOVE TFMSTR-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 41115500
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         41115600
                                             TO DP013-MESSAGE-TEXT (2)  41115700
                   MOVE TFRCPT-RCV-XFER-BEG-TMST                        41115800
                                             TO DP013-MESSAGE-TEXT (3)  41115900
                   MOVE SQLCA                TO DP013-SQLCA             41116000
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)41116100
                   SET DP013-DB2-ABEND                                  41116200
                       DP013-XCTL-DISPLAY-RESTART                       41116300
                                            TO TRUE                     41116400
                   PERFORM DP013-0000-PROCESS-ABEND                     41116500
           END-IF.                                                      41116600
      *                                                                 41116700
      *----------------------------------------------------------------*41116800
      *  READ A ROW FROM THE TRANSFER ITEM TABLE.                      *41116900
      *----------------------------------------------------------------*41117000
       7050-FETCH-XFER-ITM-CSR.                                         41118000
           INITIALIZE DCLTTFITEM.                                       41119000
                                                                        41119100
           PERFORM WITH TEST AFTER                                      41119200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41119300
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41119400
                    OR SQLCODE = ZERO                                   41119500
                    OR SQLCODE = +100                                   41119600
                                                                        41119700
               EXEC SQL                                                 41119800
                   FETCH  XFER_ITM_CSR                                  41119900
                    INTO  :TFITEM-XFER-LNE-NBR,                         41120000
                          :TFITEM-ITM-NBR,                              41160000
                          :TFITEM-XFER-PRIC-AMT,                        41170000
                          :TFITEM-XFER-QTY,                             41180000
100404                    :TFITEM-KOHLS-UPC-NBR                         41181000
               END-EXEC                                                 41190000
                                                                        41190100
               EVALUATE TRUE                                            41190200
                   WHEN SQLCODE = -904                                  41190300
                   WHEN SQLCODE = -913                                  41190400
                   WHEN SQLCODE = ZERO                                  41190500
                       CONTINUE                                         41190600
                   WHEN SQLCODE = +100                                  41190700
                       SET PS-END-OF-XFER-ITMS   TO TRUE                41190800
                   WHEN SQLWARN0 NOT = SPACES                           41190900
                   WHEN SQLCODE < ZERO                                  41191000
                   WHEN SQLCODE > ZERO                                  41192000
                       MOVE '7050-FETCH-XFER-ITM-CSR'                   41193000
                                             TO DP013-PARAGRAPH         41194000
                       MOVE 'FETCH XFER_ITM_CSR'                        41195000
                                             TO DP013-MESSAGE-TEXT (1)  41196000
                       MOVE 'FOR XFER_DKEY_ID: '                        41197000
                                             TO DP013-MESSAGE-TEXT (2)  41198000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 41199000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     41200000
                                             TO DP013-MESSAGE-TEXT (3)  41210000
                       MOVE SQLCA            TO DP013-SQLCA             41220000
                       MOVE 'TTFMSTR'        TO DP013-DB2-TABLE-NAME (1)41220100
                       SET DP013-DB2-ABEND                              41220200
                           DP013-XCTL-DISPLAY-RESTART                   41220300
                                         TO TRUE                        41220400
                       PERFORM DP013-0000-PROCESS-ABEND                 41220500
               END-EVALUATE                                             41220600
           END-PERFORM.                                                 41220700
      *                                                                 41220800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41220900
                   MOVE '7050-FETCH-XFER-ITM-CSR'                       41221000
                                             TO DP013-PARAGRAPH         41222000
                   MOVE 'FETCH XFER_ITM_CSR' TO DP013-MESSAGE-TEXT (1)  41223000
                   MOVE 'FOR XFER_DKEY_ID: ' TO DP013-MESSAGE-TEXT (2)  41224000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 41225000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         41226000
                                             TO DP013-MESSAGE-TEXT (3)  41227000
                   MOVE SQLCA                TO DP013-SQLCA             41228000
                   MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)41228100
                   SET DP013-DB2-ABEND                                  41228200
                       DP013-XCTL-DISPLAY-RESTART                       41228300
                                             TO TRUE                    41228400
                   PERFORM DP013-0000-PROCESS-ABEND                     41228500
           END-IF.                                                      41228600
      *----------------------------------------------------------------*41228700
      *  GET THE MAX RECEIPT TIMESTAMP FOR THIS TRANSFER.              *41228800
      *----------------------------------------------------------------*41228900
       7100-SELECT-MAX-RCPT-TMST.                                       41229000
           MOVE ASC-XFER-DKEY-ID       TO DK-XFER-DKEY-ID.              41229100
           PERFORM WITH TEST AFTER                                      41229200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41229300
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41229400
                    OR SQLCODE = ZERO                                   41229500
                                                                        41229600
               EXEC SQL                                                 41229700
                   SELECT  MAX(RCV_XFER_BEG_TMST)                       41229800
                     INTO  :TFRCPT-RCV-XFER-BEG-TMST                    41229900
                              :PV-NULL-IND                              41230000
                     FROM  TTFRCPT                                      41230100
                     WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID)         41230200
               END-EXEC                                                 41230300
                                                                        41230400
               EVALUATE TRUE                                            41230500
                   WHEN SQLCODE = -904                                  41230600
                   WHEN SQLCODE = -913                                  41230700
                   WHEN SQLCODE = ZERO                                  41230800
                       CONTINUE                                         41230900
                   WHEN SQLWARN0 NOT = SPACES                           41231000
                   WHEN SQLCODE < ZERO                                  41231100
                   WHEN SQLCODE > ZERO                                  41231200
                       MOVE '7100-SELECT-MAX-RCPT-TMST'                 41231300
                                             TO DP013-PARAGRAPH         41231400
                       MOVE 'SELECT MAX TIMESTAMP FOR XFER_DKEY_ID: '   41231500
                                             TO DP013-MESSAGE-TEXT (1)  41231600
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 41231700
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     41231800
                                             TO DP013-MESSAGE-TEXT (2)  41231900
                       MOVE SQLCA            TO DP013-SQLCA             41232000
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)41232100
                       SET DP013-DB2-ABEND                              41232200
                           DP013-XCTL-DISPLAY-RESTART                   41232300
                                         TO TRUE                        41232400
                       PERFORM DP013-0000-PROCESS-ABEND                 41232500
               END-EVALUATE                                             41232600
           END-PERFORM.                                                 41232700
      *                                                                 41232800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41232900
               MOVE '7100-SELECT-MAX-RCPT-TMST'                         41233000
                                             TO DP013-PARAGRAPH         41233100
               MOVE 'SELECT MAX TIMESTAMP FOR XFER_DKEY_ID: '           41233200
                                             TO DP013-MESSAGE-TEXT (1)  41233300
               MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID     41233400
               MOVE PV-DISPLAY-XFER-DKEY-ID                             41233500
                                             TO DP013-MESSAGE-TEXT (2)  41233600
               MOVE SQLCA                TO DP013-SQLCA                 41233700
               MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)    41233800
               SET DP013-DB2-ABEND                                      41233900
                   DP013-XCTL-DISPLAY-RESTART                           41234000
                                         TO TRUE                        41234100
               PERFORM DP013-0000-PROCESS-ABEND                         41234200
           END-IF.                                                      41234300
      *----------------------------------------------------------------*41234400
      *  GET THE CURRENT RETAIL PRICE FOR THE ITEM.                    *41234500
      *----------------------------------------------------------------*41234600
       7150-SELECT-CUR-UNT-RTL-AMT.                                     41234700
100404     INITIALIZE DCLXST00008                                       41234800
100404                DCLXST00010.                                      41234900
                                                                        41235000
           PERFORM WITH TEST AFTER                                      41235100
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41235200
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41235300
                    OR SQLCODE = ZERO                                   41235400
                    OR SQLCODE = +100                                   41235500
                                                                        41235600
               EXEC SQL                                                 41235700
100404             SELECT  B.UNT_RTL_AMT                                41235800
                          ,B.INTR_UPC_ID                                41235900
100404                    ,C.REGN_PRIC_IND                              41236000
100404               INTO  :XST00008-UNT-RTL-AMT                        41236100
100404                    ,:XST00008-INTR-UPC-ID                        41236200
100404                    ,:XST00010-REGN-PRIC-IND                      41236300
100404               FROM  XST_UPC     A                                41237000
100404                    ,XST_SKU_LOC B                                41237100
100404                    ,XST_SKU     C                                41237200
100404          WHERE  (A.UPC_NBR            =  :TFITEM-KOHLS-UPC-NBR   41238300
100404            AND   A.LAST_ACTN_CDE     IN ('A', 'U')               41238400
100404            AND   A.INTR_UPC_ID        = B.INTR_UPC_ID            41238500
100404            AND   B.LOC_NBR            = 0                        41238600
100404            AND   B.END_TMST          IS NULL                     41238700
100404            AND   B.LOC_SKU_STAT_CDE NOT IN ('98')                41238800
100404            AND   A.INTR_UPC_ID        = C.INTR_UPC_ID)           41238900
                                                                        41239200
               END-EXEC                                                 41239300
                                                                        41239400
               EVALUATE TRUE                                            41239500
                   WHEN SQLCODE = ZERO                                  41239600
100404                 MOVE XST00008-UNT-RTL-AMT  TO PV-CUR-RTL-AMT     41239700
100404                 IF XST00010-REGN-PRIC-IND = PC-YES               41239800
                           EVALUATE ASC-XFER-TYPE                       41239900
111703*                        WHEN  PC-DEFECTIVE-DAMAGE                41240000
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT1          41240100
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT2          41240200
                               WHEN  PC-CALLBACK                        41240300
                                  MOVE ASC-FR-STORE-NBR TO DK-STORE-NBR 41240400
                                  PERFORM 7900-CHECK-REGN-PRC           41240500
                               WHEN  PC-STOCK-BAL-CORP                  41240600
                               WHEN  PC-STOCK-BAL-STORE                 41240700
                               WHEN  PC-CUSTOMER                        41240800
                                  MOVE ASC-RCV-STORE-NBR TO DK-STORE-NBR41240900
                                  PERFORM 7900-CHECK-REGN-PRC           41241000
                           END-EVALUATE                                 41241100
                       END-IF                                           41241200
                   WHEN SQLCODE = +100                                  41241300
100404                 MOVE ZEROES           TO XST00008-UNT-RTL-AMT    41241400
                   WHEN SQLCODE = -904                                  41241500
                   WHEN SQLCODE = -913                                  41241600
                       CONTINUE                                         41241700
                   WHEN OTHER                                           41241900
                       MOVE '7150-SELECT-CUR-UNT-RTL-AMT'               41260000
                                             TO DP013-PARAGRAPH         41270000
                       MOVE 'SELECT CURRENT UNIT RETAIL AMOUNT FOR ITEM_41280000
      -                 'NMBR: '             TO DP013-MESSAGE-TEXT (1)  41290000
                       MOVE TFITEM-ITM-NBR   TO PV-DISPLAY-ITM-NBR      41300000
                       MOVE PV-DISPLAY-ITM-NBR TO DP013-MESSAGE-TEXT (2)41310000
                       MOVE SQLCA            TO DP013-SQLCA             41320000
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)41320100
                       SET DP013-DB2-ABEND                              41320200
                           DP013-XCTL-DISPLAY-RESTART                   41320300
                                         TO TRUE                        41320400
                       PERFORM DP013-0000-PROCESS-ABEND                 41320500
               END-EVALUATE                                             41320600
           END-PERFORM.                                                 41320700
      *                                                                 41320800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41320900
                   MOVE '7150-SELECT-CUR-UNT-RTL-AMT'                   41321000
                                             TO DP013-PARAGRAPH         41322000
                   MOVE 'SELECT CURRENT UNIT RETAIL AMOUNT FOR ITEM_NMBR41323000
      -                 ': '                 TO DP013-MESSAGE-TEXT (1)  41324000
                   MOVE TFITEM-ITM-NBR       TO PV-DISPLAY-ITM-NBR      41325000
                   MOVE PV-DISPLAY-ITM-NBR   TO DP013-MESSAGE-TEXT (2)  41326000
                   MOVE SQLCA                TO DP013-SQLCA             41327000
100404             MOVE 'XST_SKU_LOC'        TO DP013-DB2-TABLE-NAME (1)41327100
                   SET DP013-DB2-ABEND                                  41327200
                       DP013-XCTL-DISPLAY-RESTART                       41327300
                                             TO TRUE                    41327400
                   PERFORM DP013-0000-PROCESS-ABEND                     41327500
           END-IF.                                                      41327600
      *                                                                 41327700
      *----------------------------------------------------------------*41327800
      *  GET THE MAX STATUS TIMESTAMP TO CHECK THE CURRENT STATUS.      41327900
      *----------------------------------------------------------------*41328000
       7200-SELECT-MAX-STAT-TMST.                                       41329000
           INITIALIZE DCLTTFSTAT.                                       41330000
                                                                        41340000
           PERFORM                                                      41350000
               WITH TEST AFTER                                          41360000
               VARYING PV-RETRY-COUNT                                   41370000
               FROM 1 BY 1                                              41380000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 41390000
                   OR (SQLCODE = +0)                                    41400000
                   OR (SQLCODE = +100))                                 41410000
                                                                        41420000
               EXEC SQL                                                 41430000
                   SELECT  MAX(XFER_STAT_TMST)                          41440000
                     INTO  :TFSTAT-XFER-STAT-TMST                       41450000
                               :PV-NULL-IND                             41460000
                     FROM  TTFSTAT                                      41470000
                    WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID)          41480000
               END-EXEC                                                 41490000
                                                                        41500000
               EVALUATE TRUE                                            41510000
                   WHEN SQLCODE = ZERO                                  41520000
                   WHEN SQLCODE = +100                                  41530000
                   WHEN SQLCODE = -904                                  41540000
                   WHEN SQLCODE = -913                                  41550000
                       CONTINUE                                         41560000
                   WHEN SQLWARN0 NOT = SPACES                           41570000
                   WHEN SQLCODE < ZERO                                  41580000
                   WHEN SQLCODE > ZERO                                  41590000
                       MOVE '7200-SELECT-MAX-STAT-TMST'                 41600000
                                             TO DP013-PARAGRAPH         41610000
                       MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '   41620000
                                             TO DP013-MESSAGE-TEXT (1)  41630000
                       MOVE DK-XFER-DKEY-ID                             41640000
                                             TO PV-DISPLAY-XFER-DKEY-ID 41650000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     41660000
                                             TO DP013-MESSAGE-TEXT (2)  41670000
                       MOVE SQLCA            TO DP013-SQLCA             41680000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)41690000
                       SET DP013-DB2-ABEND                              41700000
                           DP013-XCTL-DISPLAY-RESTART                   41710000
                                             TO TRUE                    41720000
                       PERFORM DP013-0000-PROCESS-ABEND                 41730000
               END-EVALUATE                                             41740000
           END-PERFORM.                                                 41750000
                                                                        41760000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41770000
               MOVE '7200-SELECT-MAX-STAT-TMST'                         41780000
                                             TO DP013-PARAGRAPH         41790000
               MOVE 'MAX RETRIES EXCEEDED FOR'                          41800000
                                        TO DP013-MESSAGE-TEXT (1)       41810000
               MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '           41820000
                                             TO DP013-MESSAGE-TEXT (2)  41830000
               MOVE DK-XFER-DKEY-ID                                     41840000
                                             TO PV-DISPLAY-XFER-DKEY-ID 41850000
               MOVE PV-DISPLAY-XFER-DKEY-ID                             41860000
                                             TO DP013-MESSAGE-TEXT (3)  41870000
               MOVE SQLCA               TO DP013-SQLCA                  41880000
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)     41890000
               SET DP013-DB2-ABEND                                      41900000
                   DP013-XCTL-DISPLAY-RESTART                           41910000
                                        TO TRUE                         41920000
               PERFORM DP013-0000-PROCESS-ABEND                         41930000
           END-IF.                                                      41940000
      *                                                                 41950000
      *----------------------------------------------------------------*41960000
      *  GET THE CURRENT STATUS.                                        41970000
      *----------------------------------------------------------------*41980000
       7250-SELECT-CURRENT-STATUS.                                      41990000
           PERFORM                                                      42000000
               WITH TEST AFTER                                          42010000
               VARYING PV-RETRY-COUNT                                   42020000
               FROM 1 BY 1                                              42030000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42040000
                   OR (SQLCODE = +0)                                    42050000
                   OR (SQLCODE = +100))                                 42060000
                                                                        42070000
               EXEC SQL                                                 42080000
                   SELECT  XFER_STAT_CDE                                42090000
                     INTO  :TFSTAT-XFER-STAT-CDE                        42100000
                     FROM  TTFSTAT                                      42110000
                    WHERE  (XFER_DKEY_ID     =  :DK-XFER-DKEY-ID        42120000
                      AND   XFER_STAT_TMST   =  :TFSTAT-XFER-STAT-TMST) 42130000
               END-EXEC                                                 42140000
                                                                        42150000
               EVALUATE TRUE                                            42160000
                   WHEN SQLCODE = ZERO                                  42170000
                   WHEN SQLCODE = +100                                  42180000
                   WHEN SQLCODE = -904                                  42190000
                   WHEN SQLCODE = -913                                  42200000
                       CONTINUE                                         42210000
                   WHEN SQLWARN0 NOT = SPACES                           42220000
                   WHEN SQLCODE < ZERO                                  42230000
                   WHEN SQLCODE > ZERO                                  42240000
                       MOVE '7250-SELECT-CURRENT-STATUS'                42250000
                                             TO DP013-PARAGRAPH         42260000
                       MOVE 'SELECT CURRENT STATUS FOR DATALESS KEY/TIME42270000
      -                 'STAMP: '            TO DP013-MESSAGE-TEXT (1)  42280000
                       MOVE DK-XFER-DKEY-ID                             42290000
                                             TO PV-DISPLAY-XFER-DKEY-ID 42300000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     42310000
                                             TO DP013-MESSAGE-TEXT (2)  42320000
                       MOVE TFSTAT-XFER-STAT-TMST                       42330000
                                             TO DP013-MESSAGE-TEXT (3)  42340000
                       MOVE SQLCA            TO DP013-SQLCA             42350000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)42360000
                       SET DP013-DB2-ABEND                              42370000
                           DP013-XCTL-DISPLAY-RESTART                   42380000
                                             TO TRUE                    42390000
                       PERFORM DP013-0000-PROCESS-ABEND                 42400000
               END-EVALUATE                                             42410000
           END-PERFORM.                                                 42420000
                                                                        42430000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42440000
               MOVE '7250-SELECT-CURRENT-STATUS'                        42450000
                                             TO DP013-PARAGRAPH         42460000
               MOVE 'SELECT CURRENT STATUS FOR DATALESS KEY/TIMESTAMP'  42470000
                                             TO DP013-MESSAGE-TEXT (1)  42480000
               MOVE DK-XFER-DKEY-ID                                     42490000
                                             TO PV-DISPLAY-XFER-DKEY-ID 42500000
               MOVE PV-DISPLAY-XFER-DKEY-ID                             42510000
                                             TO DP013-MESSAGE-TEXT (2)  42520000
               MOVE TFSTAT-XFER-STAT-TMST                               42530000
                                             TO DP013-MESSAGE-TEXT (3)  42540000
               MOVE SQLCA               TO DP013-SQLCA                  42550000
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)     42560000
               SET DP013-DB2-ABEND                                      42570000
                   DP013-XCTL-DISPLAY-RESTART                           42580000
                                        TO TRUE                         42590000
               PERFORM DP013-0000-PROCESS-ABEND                         42600000
           END-IF.                                                      42610000
      *                                                                 42610100
      *----------------------------------------------------------------*42610200
      *  GET THE MAXIMUM POSTING SEQUENCE NUMBER FOR THIS LINE NUMBER. *42610300
      *----------------------------------------------------------------*42610400
       7300-SELECT-MAX-PSTG-SEQ-NBR.                                    42610500
           INITIALIZE PV-PSTG-SEQ-NBR.                                  42610600
                                                                        42610700
           PERFORM WITH TEST AFTER                                      42610800
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42610900
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  42611000
                    OR SQLCODE = ZERO                                   42612000
                                                                        42613000
               EXEC SQL                                                 42614000
                   SELECT  MAX(PSTG_SEQ_NBR)                            42615000
                     INTO  :PV-PSTG-SEQ-NBR                             42616000
                               :PV-DB2-NULL-IND                         42617000
                     FROM  TTFITPS                                      42618000
                     WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID          42619000
                      AND   XFER_LNE_NBR  =  :TFITEM-XFER-LNE-NBR)      42620000
               END-EXEC                                                 42630000
                                                                        42630100
               EVALUATE TRUE                                            42630200
                   WHEN SQLCODE = -904                                  42630300
                   WHEN SQLCODE = -913                                  42630400
                   WHEN SQLCODE = ZERO                                  42630500
                       CONTINUE                                         42630600
                   WHEN SQLWARN0 NOT = SPACES                           42630700
                   WHEN SQLCODE < ZERO                                  42630800
                   WHEN SQLCODE > ZERO                                  42630900
                       MOVE '7300-SELECT-MAX-PSTG-SEQ-NBR'              42631000
                                             TO DP013-PARAGRAPH         42632000
                       MOVE 'SELECT MAX(PSTG_SEQ_NBR) FOR XFER_DKEY_ID:'42633000
                                             TO DP013-MESSAGE-TEXT (1)  42634000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 42635000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     42636000
                                             TO DP013-MESSAGE-TEXT (2)  42637000
                       MOVE SQLCA            TO DP013-SQLCA             42638000
                       MOVE 'TTFITPS'        TO DP013-DB2-TABLE-NAME (1)42638100
                       SET DP013-DB2-ABEND                              42638200
                           DP013-XCTL-DISPLAY-RESTART                   42638300
                                         TO TRUE                        42638400
                       PERFORM DP013-0000-PROCESS-ABEND                 42638500
               END-EVALUATE                                             42638600
           END-PERFORM.                                                 42638700
      *                                                                 42638800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42638900
                   MOVE '7300-SELECT-MAX-PSTG-SEQ-NBR'                  42639000
                                             TO DP013-PARAGRAPH         42640000
                   MOVE 'SELECT MAX(PSTG_SEQ_NBR) FOR XFER_DKEY_ID: '   42650000
                                             TO DP013-MESSAGE-TEXT (1)  42660000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 42670000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         42680000
                                             TO DP013-MESSAGE-TEXT (2)  42690000
                   MOVE SQLCA                TO DP013-SQLCA             42700000
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)42700100
               SET DP013-DB2-ABEND                                      42700200
                   DP013-XCTL-DISPLAY-RESTART                           42700300
                                         TO TRUE                        42700400
               PERFORM DP013-0000-PROCESS-ABEND                         42700500
           END-IF.                                                      42700600
      *                                                                 42700700
      *----------------------------------------------------------------*42700800
      *  INSERT A ROW IN THE ITEM POSTING TABLE.                       *42700900
      *----------------------------------------------------------------*42701000
       7350-INSERT-ADJUSTMENT-ROW.                                      42702000
           COMPUTE TFITPS-PSTG-SEQ-NBR  =                               42703000
               PV-PSTG-SEQ-NBR + 1.                                     42704000
                                                                        42704100
           PERFORM WITH TEST AFTER                                      42704200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42704300
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  42704400
                    OR SQLCODE = ZERO                                   42704500
                                                                        42704600
               EXEC SQL                                                 42704700
                   INSERT INTO TTFITPS                                  42704800
                       (XFER_DKEY_ID,                                   42704900
                        XFER_LNE_NBR,                                   42705000
                        PSTG_SEQ_NBR,                                   42706000
                        XFER_RCPT_TMST,                                 42707000
                        ADJ_RSN_CDE,                                    42708000
                        FRM_PSTG_STR_NBR,                               42709000
                        TO_PSTG_STR_NBR,                                42710000
                        ITM_RTL_PRCE_AMT,                               42720000
                        ITM_QTY,                                        42730000
                        EXTL_SYS_PRCG_CDE)                              42740000
                   VALUES                                               42750000
                       (:DK-XFER-DKEY-ID,                               42760000
                        :TFITEM-XFER-LNE-NBR,                           42770000
                        :TFITPS-PSTG-SEQ-NBR,                           42780000
                        :PV-CURRENT-TIMESTAMP,                          42790000
                        :TFITPS-ADJ-RSN-CDE,                            42800000
                        :TFITPS-FRM-PSTG-STR-NBR,                       42810000
                        :TFITPS-TO-PSTG-STR-NBR,                        42820000
                        :TFITPS-ITM-RTL-PRCE-AMT,                       42830000
                        :TFITPS-ITM-QTY,                                42840000
                        :TFITPS-EXTL-SYS-PRCG-CDE)                      42850000
               END-EXEC                                                 42860000
                                                                        42860100
               EVALUATE TRUE                                            42860200
                   WHEN SQLCODE = -904                                  42860300
                   WHEN SQLCODE = -913                                  42860400
                   WHEN SQLCODE = ZERO                                  42860500
                       CONTINUE                                         42860600
                   WHEN SQLWARN0 NOT = SPACES                           42860700
                   WHEN SQLCODE < ZERO                                  42860800
                   WHEN SQLCODE > ZERO                                  42860900
                       MOVE '7350-INSERT-ADJUSTMENT-ROW'                42861000
                                             TO DP013-PARAGRAPH         42862000
                       MOVE 'INSERT ADJUSTMENT FOR XFER_DKEY_ID/XFER_LNE42863000
      -                '_NBR/PSTG_SEQ_NBR: ' TO DP013-MESSAGE-TEXT (1)  42864000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 42865000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     42866000
                                             TO DP013-MESSAGE-TEXT (2)  42867000
                       MOVE TFITEM-XFER-LNE-NBR                         42868000
                                             TO PV-DISPLAY-XFER-LNE-NBR 42869000
                       MOVE PV-DISPLAY-XFER-LNE-NBR                     42870000
                                             TO DP013-MESSAGE-TEXT (3)  42880000
                       MOVE PV-PSTG-SEQ-NBR  TO PV-DISPLAY-PSTG-SEQ-NBR 42890000
                       MOVE PV-DISPLAY-PSTG-SEQ-NBR                     42900000
                                             TO DP013-MESSAGE-TEXT (4)  42910000
                       MOVE SQLCA            TO DP013-SQLCA             42920000
                       MOVE 'TTFITPS'        TO DP013-DB2-TABLE-NAME (1)42920100
                       SET DP013-DB2-ABEND                              42920200
                           DP013-XCTL-DISPLAY-RESTART                   42920300
                                         TO TRUE                        42920400
                       PERFORM DP013-0000-PROCESS-ABEND                 42920500
               END-EVALUATE                                             42920600
           END-PERFORM.                                                 42920700
      *                                                                 42920800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42920900
                   MOVE '7350-INSERT-ADJUSTMENT-ROW'                    42921000
                                             TO DP013-PARAGRAPH         42922000
                   MOVE 'INSERT ADJUSTMENT FOR XFER_DKEY_ID/XFER_LNE_NBR42923000
      -                 '/PSTG_SEQ_NBR: '    TO DP013-MESSAGE-TEXT (1)  42924000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 42925000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         42926000
                                             TO DP013-MESSAGE-TEXT (2)  42927000
                   MOVE TFITEM-XFER-LNE-NBR  TO PV-DISPLAY-XFER-LNE-NBR 42928000
                   MOVE PV-DISPLAY-XFER-LNE-NBR                         42929000
                                             TO DP013-MESSAGE-TEXT (3)  42930000
                   MOVE PV-PSTG-SEQ-NBR      TO PV-DISPLAY-PSTG-SEQ-NBR 42940000
                   MOVE PV-DISPLAY-PSTG-SEQ-NBR                         42950000
                                             TO DP013-MESSAGE-TEXT (4)  42960000
                   MOVE SQLCA                TO DP013-SQLCA             42970000
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)42970100
               SET DP013-DB2-ABEND                                      42970200
                   DP013-XCTL-DISPLAY-RESTART                           42970300
                                         TO TRUE                        42970400
               PERFORM DP013-0000-PROCESS-ABEND                         42970500
           END-IF.                                                      42970600
      *                                                                 42970700
      *----------------------------------------------------------------*42970800
      *  INSERT A ROW IN THE DISCREPANCY TABLE.                        *42970900
      *----------------------------------------------------------------*42971000
       7500-INSERT-DISCREPANCY-ROW.                                     42972000
           INITIALIZE DCLTTFDSCP.                                       42973000
           MOVE ASC-RCV-STORE-NBR     TO TFDSCP-RCVD-AT-STR-NBR.        42974000
           MOVE ASC-XFER-DKEY-ID      TO TFDSCP-XFER-DKEY-ID.           42975000
           MOVE ASC-LG-TOTE-SEAL1     TO TFDSCP-LG-TTE-1ST-SEAL-ID.     42976000
           MOVE ASC-LG-TOTE-SEAL2     TO TFDSCP-LG-TTE-2ND-SEAL-ID.     42977000
           MOVE ASC-SM-TOTE-SEAL      TO TFDSCP-SM-TTE-BG-SEAL-ID.      42978000
           MOVE ASC-TRAILER-NBR       TO TFDSCP-TRLR-NBR.               42979000
           MOVE ASC-TRAILER-SEAL      TO TFDSCP-TRLR-SEAL-ID.           42980000
                                                                        42990000
           PERFORM                                                      43000000
               WITH TEST AFTER                                          43010000
               VARYING PV-RETRY-COUNT                                   43020000
               FROM 1 BY 1                                              43030000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 43040000
                   OR (SQLCODE = +0))                                   43050000
                                                                        43060000
               EXEC SQL                                                 43070000
                   INSERT INTO TTFDSCP                                  43080000
                       (XFER_DKEY_ID,                                   43090000
                        RCV_XFER_BEG_TMST,                              43100000
                        RCVD_AT_STR_NBR,                                43110000
                        LG_TTE_1ST_SEAL_ID,                             43120000
                        LG_TTE_2ND_SEAL_ID,                             43130000
                        SM_TTE_BG_SEAL_ID,                              43140000
                        TRLR_NBR,                                       43150000
                        TRLR_SEAL_ID)                                   43160000
                   VALUES                                               43170000
                       (:TFDSCP-XFER-DKEY-ID,                           43180000
                        :PV-CURRENT-TIMESTAMP,                          43190000
                        :TFDSCP-RCVD-AT-STR-NBR,                        43200000
                        :TFDSCP-LG-TTE-1ST-SEAL-ID,                     43210000
                        :TFDSCP-LG-TTE-2ND-SEAL-ID,                     43220000
                        :TFDSCP-SM-TTE-BG-SEAL-ID,                      43230000
                        :TFDSCP-TRLR-NBR,                               43240000
                        :TFDSCP-TRLR-SEAL-ID)                           43250000
               END-EXEC                                                 43260000
                                                                        43270000
               EVALUATE TRUE                                            43280000
                   WHEN SQLCODE = ZERO                                  43290000
                   WHEN SQLCODE = -904                                  43300000
                   WHEN SQLCODE = -913                                  43310000
                       CONTINUE                                         43320000
                   WHEN SQLWARN0 NOT = SPACES                           43330000
                   WHEN SQLCODE < ZERO                                  43340000
                   WHEN SQLCODE > ZERO                                  43350000
                       MOVE '7500-INSERT-DISCREPANCY-ROW'               43360000
                                             TO DP013-PARAGRAPH         43370000
                       MOVE 'INSERT A DISCREPANCY ROW FOR DATALESS KEY V43380000
      -                 'ALUE: '                                        43390000
                                             TO DP013-MESSAGE-TEXT (1)  43400000
                       MOVE TFRCPT-XFER-DKEY-ID                         43410000
                                             TO PV-DISPLAY-XFER-DKEY-ID 43420000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     43430000
                                             TO DP013-MESSAGE-TEXT (2)  43440000
                       MOVE SQLCA            TO DP013-SQLCA             43450000
                       MOVE 'TTFDSCP'        TO DP013-DB2-TABLE-NAME (1)43460000
                       SET DP013-DB2-ABEND                              43470000
                       DP013-XCTL-DISPLAY-RESTART                       43480000
                                            TO TRUE                     43490000
                       PERFORM DP013-0000-PROCESS-ABEND                 43500000
               END-EVALUATE                                             43510000
           END-PERFORM.                                                 43520000
                                                                        43530000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          43540000
                   MOVE '7500-INSERT-DISCREPANCY-ROW'                   43550000
                                             TO DP013-PARAGRAPH         43560000
                   MOVE 'INSERT A DISCREPANCY ROW FOR DATALESS KEY VALUE43570000
      -                 ': '                                            43580000
                                             TO DP013-MESSAGE-TEXT (1)  43590000
                   MOVE TFRCPT-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 43600000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         43610000
                                             TO DP013-MESSAGE-TEXT (2)  43620000
                   MOVE SQLCA                TO DP013-SQLCA             43630000
                   MOVE 'TTFDSCP'            TO DP013-DB2-TABLE-NAME (1)43640000
                   SET DP013-DB2-ABEND                                  43650000
                       DP013-XCTL-DISPLAY-RESTART                       43660000
                                            TO TRUE                     43670000
                   PERFORM DP013-0000-PROCESS-ABEND                     43680000
           END-IF.                                                      43690000
      *                                                                 43690100
      *----------------------------------------------------------------*43690200
      *  INSERT A ROW IN THE TRANSFER RECEIPT TABLE.                   *43690300
      *----------------------------------------------------------------*43690400
       7600-INSERT-XFER-RECEIPT-ROW.                                    43690500
           MOVE ASC-RCV-STORE-NBR      TO TFRCPT-STR-NBR.               43690600
           MOVE ASC-RECV-BY-INT        TO TFRCPT-RCVR-INIT-1ST-NM.      43690700
           MOVE ASC-RECV-BY-NAM        TO TFRCPT-RCVR-LAST-NM.          43690800
           MOVE ASC-RCV-STR-OVRRID-IND TO TFRCPT-RCV-STR-OVRRID-IND.    43690900
           MOVE DP020-USERID           TO TFRCPT-RCV-BY-USR-ID.         43691000
           IF ASC-CALL-INV-CONTROL                                      43692000
               MOVE PC-YES             TO TFRCPT-RCVG-PROB-IND          43693000
           ELSE                                                         43694000
               MOVE PC-NO              TO TFRCPT-RCVG-PROB-IND          43695000
           END-IF.                                                      43696000
                                                                        43697000
           PERFORM                                                      43698000
               WITH TEST AFTER                                          43699000
               VARYING PV-RETRY-COUNT                                   43700000
               FROM 1 BY 1                                              43710000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 43720000
                   OR (SQLCODE = +0))                                   43730000
                                                                        43740000
               EXEC SQL                                                 43750000
                   INSERT INTO TTFRCPT                                  43760000
                       (XFER_DKEY_ID,                                   43770000
                        RCV_XFER_BEG_TMST,                              43780000
                        RCPT_MTHD_CDE,                                  43790000
                        ENTR_MTHD_TYP_CDE,                              43800000
                        STR_NBR,                                        43810000
                        RCVR_INIT_1ST_NM,                               43820000
                        RCVR_LAST_NM,                                   43830000
                        RCV_XFER_END_TMST,                              43840000
                        BYP_DTL_CK_IND,                                 43850000
                        XFER_DSCRP_IND,                                 43860000
                        RCV_BY_USR_ID,                                  43870000
                        RCV_STR_OVRRID_IND,                             43880000
                        RCVG_PROB_IND)                                  43890000
                   VALUES                                               43900000
                       (:DK-XFER-DKEY-ID,                               43910000
                        :PV-CURRENT-TIMESTAMP,                          43920000
                        '02',                                           43930000
                        '02',                                           43940000
                        :TFRCPT-STR-NBR,                                43950000
                        :TFRCPT-RCVR-INIT-1ST-NM,                       43960000
                        :TFRCPT-RCVR-LAST-NM,                           43970000
                        CURRENT TIMESTAMP,                              43980000
                        :PC-YES,                                        43990000
                        :TFRCPT-XFER-DSCRP-IND,                         44000000
                        :TFRCPT-RCV-BY-USR-ID,                          44010000
                        :TFRCPT-RCV-STR-OVRRID-IND,                     44020000
                        :TFRCPT-RCVG-PROB-IND)                          44030000
               END-EXEC                                                 44040000
                                                                        44050000
               EVALUATE TRUE                                            44060000
                   WHEN SQLCODE = ZERO                                  44070000
                   WHEN SQLCODE = -904                                  44080000
                   WHEN SQLCODE = -913                                  44090000
                       CONTINUE                                         44100000
                   WHEN SQLWARN0 NOT = SPACES                           44110000
                   WHEN SQLCODE < ZERO                                  44120000
                   WHEN SQLCODE > ZERO                                  44130000
                       MOVE '7600-INSERT-XFER-RECEIPT-ROW'              44140000
                                             TO DP013-PARAGRAPH         44150000
                       MOVE 'INSERT A TRANSFER RECEIPT ROW FOR DATALESS 44160000
      -                 'KEY VALUE: '        TO DP013-MESSAGE-TEXT (1)  44170000
                       MOVE DK-XFER-DKEY-ID                             44180000
                                             TO PV-DISPLAY-XFER-DKEY-ID 44190000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     44200000
                                             TO DP013-MESSAGE-TEXT (2)  44210000
                       MOVE SQLCA            TO DP013-SQLCA             44220000
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)44230000
                       SET DP013-DB2-ABEND                              44240000
                       DP013-XCTL-DISPLAY-RESTART                       44250000
                                            TO TRUE                     44260000
                       PERFORM DP013-0000-PROCESS-ABEND                 44270000
               END-EVALUATE                                             44280000
           END-PERFORM.                                                 44290000
                                                                        44300000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          44310000
                   MOVE '7600-INSERT-XFER-RECEIPT-ROW'                  44320000
                                             TO DP013-PARAGRAPH         44330000
                   MOVE 'INSERT A TRANSFER RECEIPT ROW FOR DATALESS KEY 44340000
      -                 'VALUE: '            TO DP013-MESSAGE-TEXT (1)  44350000
                   MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID     44360000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         44370000
                                             TO DP013-MESSAGE-TEXT (2)  44380000
                   MOVE SQLCA                TO DP013-SQLCA             44390000
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)44400000
                   SET DP013-DB2-ABEND                                  44410000
                       DP013-XCTL-DISPLAY-RESTART                       44420000
                                            TO TRUE                     44430000
                   PERFORM DP013-0000-PROCESS-ABEND                     44440000
           END-IF.                                                      44440100
      *----------------------------------------------------------------*44440200
      *  UPDATE THE TRANSFER RECEIPT ROW.                              *44440300
      *----------------------------------------------------------------*44440400
       7610-UPDATE-XFER-RECEIPT-ROW.                                    44440500
           MOVE ASC-RCV-STORE-NBR      TO TFRCPT-STR-NBR.               44440600
           MOVE ASC-RECV-BY-INT        TO TFRCPT-RCVR-INIT-1ST-NM.      44440700
           MOVE ASC-RECV-BY-NAM        TO TFRCPT-RCVR-LAST-NM.          44440800
           IF ASC-CALL-INV-CONTROL                                      44440900
               MOVE PC-YES             TO TFRCPT-RCVG-PROB-IND          44441000
           ELSE                                                         44442000
               MOVE PC-NO              TO TFRCPT-RCVG-PROB-IND          44443000
           END-IF.                                                      44444000
                                                                        44445000
           PERFORM                                                      44446000
               WITH TEST AFTER                                          44447000
               VARYING PV-RETRY-COUNT                                   44448000
               FROM 1 BY 1                                              44449000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 44450000
                   OR (SQLCODE = +0))                                   44460000
                                                                        44470000
               EXEC SQL                                                 44480000
                 UPDATE  TTFRCPT                                        44490000
                    SET  RCPT_MTHD_CDE     =  '02',                     44500000
                         RCVR_INIT_1ST_NM  =  :TFRCPT-RCVR-INIT-1ST-NM, 44510000
                         RCVR_LAST_NM      =  :TFRCPT-RCVR-LAST-NM,     44520000
                         RCV_XFER_END_TMST =  CURRENT TIMESTAMP,        44530000
                         BYP_DTL_CK_IND    =  :PC-YES,                  44540000
                         XFER_DSCRP_IND    =  :TFRCPT-XFER-DSCRP-IND,   44550000
                         RCVG_PROB_IND     =  :TFRCPT-RCVG-PROB-IND     44560000
                  WHERE (XFER_DKEY_ID      =  :DK-XFER-DKEY-ID          44570000
                    AND  RCV_XFER_BEG_TMST =  :PV-CURRENT-TIMESTAMP)    44580000
               END-EXEC                                                 44590000
                                                                        44600000
               EVALUATE TRUE                                            44610000
                   WHEN SQLCODE = ZERO                                  44620000
                   WHEN SQLCODE = -904                                  44630000
                   WHEN SQLCODE = -913                                  44640000
                       CONTINUE                                         44650000
                   WHEN SQLWARN0 NOT = SPACES                           44660000
                   WHEN SQLCODE < ZERO                                  44670000
                   WHEN SQLCODE > ZERO                                  44680000
                       MOVE '7610-UPDATE-XFER-RECEIPT-ROW'              44690000
                                             TO DP013-PARAGRAPH         44700000
                       MOVE 'UPDATE A TRANSFER RECEIPT ROW FOR DATALESS 44710000
      -                 'KEY VALUE: '        TO DP013-MESSAGE-TEXT (1)  44720000
                       MOVE DK-XFER-DKEY-ID                             44730000
                                             TO PV-DISPLAY-XFER-DKEY-ID 44740000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     44750000
                                             TO DP013-MESSAGE-TEXT (2)  44760000
                       MOVE SQLCA            TO DP013-SQLCA             44770000
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)44780000
                       SET DP013-DB2-ABEND                              44790000
                       DP013-XCTL-DISPLAY-RESTART                       44800000
                                            TO TRUE                     44810000
                       PERFORM DP013-0000-PROCESS-ABEND                 44820000
               END-EVALUATE                                             44830000
           END-PERFORM.                                                 44840000
                                                                        44850000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          44860000
                   MOVE '7610-UPDATE-XFER-RECEIPT-ROW'                  44870000
                                             TO DP013-PARAGRAPH         44880000
                   MOVE 'UPDATE A TRANSFER RECEIPT ROW FOR DATALESS KEY 44890000
      -                 'VALUE: '            TO DP013-MESSAGE-TEXT (1)  44900000
                   MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID     44910000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         44920000
                                             TO DP013-MESSAGE-TEXT (2)  44930000
                   MOVE SQLCA                TO DP013-SQLCA             44940000
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)44950000
                   SET DP013-DB2-ABEND                                  44960000
                       DP013-XCTL-DISPLAY-RESTART                       44970000
                                            TO TRUE                     44980000
                   PERFORM DP013-0000-PROCESS-ABEND                     44990000
           END-IF.                                                      44990100
      *----------------------------------------------------------------*44990200
      *  INSERT A ROW IN THE ITEM RECEIPT TABLE.                       *44990300
      *----------------------------------------------------------------*44990400
       7620-INSERT-ITM-RCPT.                                            44990500
                                                                        44990600
           PERFORM                                                      44990700
               WITH TEST AFTER                                          44990800
               VARYING PV-RETRY-COUNT                                   44990900
               FROM 1 BY 1                                              44991000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 44992000
                   OR (SQLCODE = +0))                                   44993000
                                                                        44994000
               EXEC SQL                                                 44995000
                   INSERT INTO TTFITRC                                  44996000
                       (XFER_DKEY_ID,                                   44997000
                        XFER_LNE_NBR,                                   44998000
                        XFER_LNE_SEQ_NBR,                               44999000
                        XFER_RCPT_TMST,                                 45000000
                        RCVD_XFER_QTY,                                  45010000
                        RCVD_XFER_PRIC_AMT,                             45020000
                        RCVD_RTL_PRIC_AMT,                              45030000
                        XFER_ITM_DSCRP_IND)                             45040000
                   VALUES                                               45050000
                       (:DK-XFER-DKEY-ID,                               45060000
                        :TFITEM-XFER-LNE-NBR,                           45070000
                        1,                                              45080000
                        :PV-CURRENT-TIMESTAMP,                          45090000
                        :TFITEM-XFER-QTY,                               45100000
                        :TFITEM-XFER-PRIC-AMT,                          45110000
                        :TFITRC-RCVD-RTL-PRIC-AMT,                      45120000
                        :PC-NO)                                         45130000
               END-EXEC                                                 45140000
                                                                        45150000
               EVALUATE TRUE                                            45160000
                   WHEN SQLCODE = ZERO                                  45170000
                   WHEN SQLCODE = -904                                  45180000
                   WHEN SQLCODE = -913                                  45190000
                       CONTINUE                                         45200000
                   WHEN SQLWARN0 NOT = SPACES                           45210000
                   WHEN SQLCODE < ZERO                                  45220000
                   WHEN SQLCODE > ZERO                                  45230000
                       MOVE '7620-INSERT-ITM-RCPT'                      45240000
                                             TO DP013-PARAGRAPH         45250000
                       MOVE 'INSERT ITEM RECEIPT FOR XFER_DKEY_ID/XFER_L45260000
      -                     'NE_NBR/XFER_RCPT_TMST: '                   45270000
                                             TO DP013-MESSAGE-TEXT (1)  45280000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 45290000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     45300000
                                             TO DP013-MESSAGE-TEXT (2)  45310000
                       MOVE TFITEM-XFER-LNE-NBR                         45320000
                                             TO PV-DISPLAY-XFER-LNE-NBR 45330000
                       MOVE PV-DISPLAY-XFER-LNE-NBR                     45340000
                                             TO DP013-MESSAGE-TEXT (3)  45350000
                       MOVE PV-CURRENT-TIMESTAMP                        45360000
                                             TO DP013-MESSAGE-TEXT (4)  45370000
                       MOVE SQLCA            TO DP013-SQLCA             45380000
                       MOVE 'TTFITRC'        TO DP013-DB2-TABLE-NAME (1)45390000
                       SET DP013-DB2-ABEND                              45400000
                       DP013-XCTL-DISPLAY-RESTART                       45410000
                                            TO TRUE                     45420000
                       PERFORM DP013-0000-PROCESS-ABEND                 45430000
               END-EVALUATE                                             45440000
           END-PERFORM.                                                 45450000
      *                                                                 45460000
                                                                        45470000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          45480000
                   MOVE '7620-INSERT-ITM-RCPT'                          45490000
                                             TO DP013-PARAGRAPH         45500000
                   MOVE 'INSERT ITEM RECEIPT FOR XFER_DKEY_ID/XFER_LNE_N45510000
      -                 'BR/XFER_RCPT_TMST: '                           45520000
                                             TO DP013-MESSAGE-TEXT (1)  45530000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 45540000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         45550000
                                             TO DP013-MESSAGE-TEXT (2)  45560000
                   MOVE TFITEM-XFER-LNE-NBR  TO PV-DISPLAY-XFER-LNE-NBR 45570000
                   MOVE PV-DISPLAY-XFER-LNE-NBR                         45580000
                                             TO DP013-MESSAGE-TEXT (3)  45590000
                   MOVE PV-CURRENT-TIMESTAMP                            45600000
                                             TO DP013-MESSAGE-TEXT (4)  45610000
                   MOVE SQLCA                TO DP013-SQLCA             45620000
                   MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)45630000
                   SET DP013-DB2-ABEND                                  45640000
                       DP013-XCTL-DISPLAY-RESTART                       45650000
                                            TO TRUE                     45660000
                   PERFORM DP013-0000-PROCESS-ABEND                     45670000
           END-IF.                                                      45670100
      *----------------------------------------------------------------*45670200
      *  INSERT THE POSITIVE RECEIPT ROW IN THE STATUS TABLE.          *45670300
      *----------------------------------------------------------------*45670400
       7650-INSERT-XFER-PR-STAT-ROW.                                    45670500
                                                                        45670600
           PERFORM                                                      45670700
               WITH TEST AFTER                                          45670800
               VARYING PV-RETRY-COUNT                                   45670900
               FROM 1 BY 1                                              45671000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 45672000
                   OR (SQLCODE = +0))                                   45673000
                                                                        45674000
               EXEC SQL                                                 45675000
                   INSERT INTO TTFSTAT                                  45676000
                       (XFER_DKEY_ID,                                   45677000
                        XFER_STAT_TMST,                                 45678000
                        XFER_STAT_CDE)                                  45679000
                   VALUES                                               45680000
                       (:DK-XFER-DKEY-ID,                               45690000
                        :PV-CURRENT-TIMESTAMP,                          45700000
                        'PR')                                           45710000
               END-EXEC                                                 45720000
                                                                        45730000
               EVALUATE TRUE                                            45740000
                   WHEN SQLCODE = ZERO                                  45750000
                   WHEN SQLCODE = -904                                  45760000
                   WHEN SQLCODE = -913                                  45770000
                       CONTINUE                                         45780000
                   WHEN SQLWARN0 NOT = SPACES                           45790000
                   WHEN SQLCODE < ZERO                                  45800000
                   WHEN SQLCODE > ZERO                                  45810000
                       MOVE '7650-INSERT-XFER-PR-STAT-ROW'              45820000
                                             TO DP013-PARAGRAPH         45830000
                      MOVE 'INSERT A TRANSFER STATUS ROW OF POSITIVELY' 45840000
                                             TO DP013-MESSAGE-TEXT (1)  45850000
                       MOVE 'RECEIVED FOR DATALESS KEY VALUE: '         45860000
                                             TO DP013-MESSAGE-TEXT (2)  45870000
                       MOVE DK-XFER-DKEY-ID                             45880000
                                             TO PV-DISPLAY-XFER-DKEY-ID 45890000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     45900000
                                             TO DP013-MESSAGE-TEXT (2)  45910000
                       MOVE SQLCA            TO DP013-SQLCA             45920000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)45930000
                       SET DP013-DB2-ABEND                              45940000
                       DP013-XCTL-DISPLAY-RESTART                       45950000
                                            TO TRUE                     45960000
                       PERFORM DP013-0000-PROCESS-ABEND                 45970000
               END-EVALUATE                                             45980000
           END-PERFORM.                                                 45990000
                                                                        46000000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46010000
                   MOVE '7650-INSERT-XFER-PR-STAT-ROW'                  46020000
                                             TO DP013-PARAGRAPH         46030000
                   MOVE 'INSERT A TRANSFER STATUS ROW OF POSITIVELY'    46040000
                                             TO DP013-MESSAGE-TEXT (1)  46050000
                   MOVE 'RECEIVED FOR DATALESS KEY VALUE: '             46060000
                                             TO DP013-MESSAGE-TEXT (2)  46070000
                   MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID     46080000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         46090000
                                             TO DP013-MESSAGE-TEXT (2)  46100000
                   MOVE SQLCA                TO DP013-SQLCA             46110000
                   MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)46120000
                   SET DP013-DB2-ABEND                                  46130000
                       DP013-XCTL-DISPLAY-RESTART                       46140000
                                            TO TRUE                     46150000
                   PERFORM DP013-0000-PROCESS-ABEND                     46160000
           END-IF.                                                      46170000
      *----------------------------------------------------------------*46180000
      *  UPDATE THE 'IR' STATUS ROW TO 'PR'.                            46190000
      *----------------------------------------------------------------*46200000
       7660-UPDATE-STATUS-TO-PR.                                        46210000
                                                                        46220000
           PERFORM                                                      46230000
               WITH TEST AFTER                                          46240000
               VARYING PV-RETRY-COUNT                                   46250000
               FROM 1 BY 1                                              46260000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46270000
                   OR (SQLCODE = +0))                                   46280000
                                                                        46290000
               EXEC SQL                                                 46300000
                 UPDATE  TTFSTAT                                        46310000
                    SET  XFER_STAT_CDE    =  'PR'                       46320000
                  WHERE  (XFER_DKEY_ID    =  :DK-XFER-DKEY-ID           46330000
                    AND   XFER_STAT_TMST  =  :PV-CURRENT-TIMESTAMP)     46340000
               END-EXEC                                                 46350000
                                                                        46360000
               EVALUATE TRUE                                            46370000
                   WHEN SQLCODE = ZERO                                  46380000
                   WHEN SQLCODE = -904                                  46390000
                   WHEN SQLCODE = -913                                  46400000
                       CONTINUE                                         46410000
                   WHEN SQLWARN0 NOT = SPACES                           46420000
                   WHEN SQLCODE < ZERO                                  46430000
                   WHEN SQLCODE > ZERO                                  46440000
                       MOVE '7660-UPDATE-STATUS-TO-PR'                  46450000
                                             TO DP013-PARAGRAPH         46460000
                      MOVE 'UPDATE A TRANSFER STATUS ROW TO POSITIVELY' 46470000
                                             TO DP013-MESSAGE-TEXT (1)  46480000
                       MOVE 'RECEIVED FOR DATALESS KEY VALUE: '         46490000
                                             TO DP013-MESSAGE-TEXT (2)  46500000
                       MOVE DK-XFER-DKEY-ID                             46510000
                                             TO PV-DISPLAY-XFER-DKEY-ID 46520000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     46530000
                                             TO DP013-MESSAGE-TEXT (2)  46540000
                       MOVE SQLCA            TO DP013-SQLCA             46550000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)46560000
                       SET DP013-DB2-ABEND                              46570000
                       DP013-XCTL-DISPLAY-RESTART                       46580000
                                            TO TRUE                     46590000
                       PERFORM DP013-0000-PROCESS-ABEND                 46600000
               END-EVALUATE                                             46610000
           END-PERFORM.                                                 46620000
                                                                        46630000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46640000
                   MOVE '7660-UPDATE-STATUS-TO-PR'                      46650000
                                             TO DP013-PARAGRAPH         46660000
                   MOVE 'UPDATE A TRANSFER STATUS ROW TO POSITIVELY'    46670000
                                             TO DP013-MESSAGE-TEXT (1)  46680000
                   MOVE 'RECEIVED FOR DATALESS KEY VALUE: '             46690000
                                             TO DP013-MESSAGE-TEXT (2)  46700000
                   MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID     46710000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         46720000
                                             TO DP013-MESSAGE-TEXT (2)  46730000
                   MOVE SQLCA                TO DP013-SQLCA             46740000
                   MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)46750000
                   SET DP013-DB2-ABEND                                  46760000
                       DP013-XCTL-DISPLAY-RESTART                       46770000
                                            TO TRUE                     46780000
                   PERFORM DP013-0000-PROCESS-ABEND                     46790000
           END-IF.                                                      46800000
      *                                                                 46800100
      *----------------------------------------------------------------*46800200
      *  CHECK TO SEE IF THIS TRANSFER HAS BEEN ASSUMPTIVELY RECEIVED. *46800300
      *----------------------------------------------------------------*46800400
       7700-SELECT-ASSUMPTIVE-RECEIPT.                                  46800500
                                                                        46800600
           PERFORM                                                      46800700
               WITH TEST AFTER                                          46800800
               VARYING PV-RETRY-COUNT                                   46800900
               FROM 1 BY 1                                              46801000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46802000
                   OR (SQLCODE = +0)                                    46803000
                   OR (SQLCODE = +100))                                 46804000
                                                                        46805000
               EXEC SQL                                                 46806000
                   SELECT  XFER_STAT_CDE                                46807000
                     INTO  :TFSTAT-XFER-STAT-CDE                        46808000
                     FROM  TTFSTAT                                      46809000
                    WHERE  (XFER_DKEY_ID   =  :DK-XFER-DKEY-ID          46810000
                     AND   XFER_STAT_CDE  =  :PC-ASSUMPTIVELY-RECEIVED) 46820000
               END-EXEC                                                 46830000
                                                                        46840000
               EVALUATE TRUE                                            46850000
                   WHEN SQLCODE = ZERO                                  46860000
                   WHEN SQLCODE = +100                                  46870000
                   WHEN SQLCODE = -904                                  46880000
                   WHEN SQLCODE = -913                                  46890000
                       CONTINUE                                         46900000
                   WHEN SQLWARN0 NOT = SPACES                           46910000
                   WHEN SQLCODE < ZERO                                  46920000
                   WHEN SQLCODE > ZERO                                  46930000
                       MOVE '7700-SELECT-ASSUMPTIVE-RECEIPT'            46940000
                                             TO DP013-PARAGRAPH         46950000
                       MOVE 'CHECK FOR AN ASSUMPTIVE RECEIPT FOR XFER_DK46960000
      -                 'EY_ID: '            TO DP013-MESSAGE-TEXT (1)  46970000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 46980000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     46990000
                                             TO DP013-MESSAGE-TEXT (2)  47000000
                       MOVE SQLCA            TO DP013-SQLCA             47010000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)47020000
                       SET DP013-DB2-ABEND                              47030000
                       DP013-XCTL-DISPLAY-RESTART                       47040000
                                            TO TRUE                     47050000
                       PERFORM DP013-0000-PROCESS-ABEND                 47060000
               END-EVALUATE                                             47070000
           END-PERFORM.                                                 47080000
                                                                        47090000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          47100000
                   MOVE '7700-SELECT-ASSUMPTIVE-RECEIPT'                47110000
                                             TO DP013-PARAGRAPH         47120000
                   MOVE 'CHECK FOR AN ASSUMPTIVE RECEIPT FOR XFER_DKEY_I47130000
      -                 'D: '                TO DP013-MESSAGE-TEXT (1)  47140000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 47150000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         47160000
                                             TO DP013-MESSAGE-TEXT (2)  47170000
                   MOVE SQLCA                TO DP013-SQLCA             47180000
                   MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)47190000
                   SET DP013-DB2-ABEND                                  47200000
                       DP013-XCTL-DISPLAY-RESTART                       47210000
                                            TO TRUE                     47220000
                   PERFORM DP013-0000-PROCESS-ABEND                     47230000
           END-IF.                                                      47230100
      *----------------------------------------------------------------*47230200
      *  DELETE THE IR STATUS ROW BECAUSE IT IS NO LONGER THE MAX TMST *47230300
      *----------------------------------------------------------------*47230400
       7800-DELETE-IR-STATUS.                                           47230500
                                                                        47230600
           PERFORM                                                      47230700
               WITH TEST AFTER                                          47230800
               VARYING PV-RETRY-COUNT                                   47230900
               FROM 1 BY 1                                              47231000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 47232000
                   OR (SQLCODE = +0)                                    47233000
                   OR (SQLCODE = +100))                                 47234000
      *                                                                 47235000
               EXEC SQL                                                 47236000
                 DELETE FROM TTFSTAT                                    47237000
                  WHERE  (XFER_DKEY_ID       =  :DK-XFER-DKEY-ID        47238000
                    AND   XFER_STAT_TMST     =  :ASC-CURRENT-TIMESTAMP) 47239000
               END-EXEC                                                 47240000
                                                                        47250000
               EVALUATE TRUE                                            47260000
                   WHEN SQLCODE = ZERO                                  47270000
                   WHEN SQLCODE = +100                                  47280000
                   WHEN SQLCODE = -904                                  47290000
                   WHEN SQLCODE = -913                                  47300000
                       CONTINUE                                         47310000
                   WHEN SQLWARN0 NOT = SPACES                           47320000
                   WHEN SQLCODE < ZERO                                  47330000
                   WHEN SQLCODE > ZERO                                  47340000
                       MOVE '7800-DELETE-IR-STATUS'                     47350000
                                             TO DP013-PARAGRAPH         47360000
                       MOVE 'DELETE A TRANSFER STATUS ROW FOR XFER_DKEY'47370000
                                             TO DP013-MESSAGE-TEXT (1)  47380000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 47390000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     47400000
                                             TO DP013-MESSAGE-TEXT (2)  47410000
                       MOVE ASC-CURRENT-TIMESTAMP                       47420000
                                             TO DP013-MESSAGE-TEXT (3)  47430000
                       MOVE SQLCA            TO DP013-SQLCA             47440000
                       MOVE 'TTFSTAT'        TO DP013-DB2-TABLE-NAME (1)47450000
                       SET DP013-DB2-ABEND                              47460000
                       DP013-XCTL-DISPLAY-RESTART                       47470000
                                            TO TRUE                     47480000
                       PERFORM DP013-0000-PROCESS-ABEND                 47490000
               END-EVALUATE                                             47500000
           END-PERFORM.                                                 47510000
                                                                        47520000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          47530000
                   MOVE '7800-DELETE-IR-STATUS'                         47540000
                                             TO DP013-PARAGRAPH         47550000
                   MOVE 'DELETE A TRANSFER STATUS ROW FOR XFER_DKEY'    47560000
                                             TO DP013-MESSAGE-TEXT (1)  47570000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 47580000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         47590000
                                             TO DP013-MESSAGE-TEXT (2)  47600000
                   MOVE SQLCA                TO DP013-SQLCA             47610000
                   MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (1)47620000
                   SET DP013-DB2-ABEND                                  47630000
                       DP013-XCTL-DISPLAY-RESTART                       47640000
                                            TO TRUE                     47650000
                   PERFORM DP013-0000-PROCESS-ABEND                     47660000
           END-IF.                                                      47660100
      *----------------------------------------------------------------*47660200
      *  DELETE THE RECEIPT ROW BECAUSE IT IS NO LONGER THE MAX TMST   *47660300
      *----------------------------------------------------------------*47660400
       7810-DELETE-CURRENT-RECEIPT.                                     47660500
                                                                        47660600
           PERFORM                                                      47660700
               WITH TEST AFTER                                          47660800
               VARYING PV-RETRY-COUNT                                   47660900
               FROM 1 BY 1                                              47661000
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 47662000
                   OR (SQLCODE = +0)                                    47663000
                   OR (SQLCODE = +100))                                 47664000
      *                                                                 47665000
               EXEC SQL                                                 47666000
                 DELETE FROM TTFRCPT                                    47667000
                  WHERE  (XFER_DKEY_ID       =  :DK-XFER-DKEY-ID        47668000
                    AND   RCV_XFER_BEG_TMST  =  :ASC-CURRENT-TIMESTAMP) 47669000
               END-EXEC                                                 47670000
                                                                        47680000
               EVALUATE TRUE                                            47690000
                   WHEN SQLCODE = ZERO                                  47700000
                   WHEN SQLCODE = +100                                  47710000
                   WHEN SQLCODE = -904                                  47720000
                   WHEN SQLCODE = -913                                  47730000
                       CONTINUE                                         47740000
                   WHEN SQLWARN0 NOT = SPACES                           47750000
                   WHEN SQLCODE < ZERO                                  47760000
                   WHEN SQLCODE > ZERO                                  47770000
                       MOVE '7810-DELETE-CURRENT-RECEIPT'               47780000
                                             TO DP013-PARAGRAPH         47790000
                       MOVE 'DELETE A TRANSFER RECEIPT FOR XFER_DKEY:'  47800000
                                             TO DP013-MESSAGE-TEXT (1)  47810000
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 47820000
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     47830000
                                             TO DP013-MESSAGE-TEXT (2)  47840000
                       MOVE SQLCA            TO DP013-SQLCA             47850000
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)47860000
                       SET DP013-DB2-ABEND                              47870000
                       DP013-XCTL-DISPLAY-RESTART                       47880000
                                            TO TRUE                     47890000
                       PERFORM DP013-0000-PROCESS-ABEND                 47900000
               END-EVALUATE                                             47910000
           END-PERFORM.                                                 47920000
                                                                        47930000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          47940000
                   MOVE '7810-DELETE-CURRENT-RECEIPT'                   47950000
                                             TO DP013-PARAGRAPH         47960000
                   MOVE 'DELETE A TRANSFER RECEIPT FOR XFER_DKEY:'      47970000
                                             TO DP013-MESSAGE-TEXT (1)  47980000
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 47990000
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         48000000
                                             TO DP013-MESSAGE-TEXT (2)  48010000
                   MOVE SQLCA                TO DP013-SQLCA             48020000
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)48030000
                   SET DP013-DB2-ABEND                                  48040000
                       DP013-XCTL-DISPLAY-RESTART                       48050000
                                            TO TRUE                     48060000
                   PERFORM DP013-0000-PROCESS-ABEND                     48070000
           END-IF.                                                      48080000
                                                                        48080100
       7900-CHECK-REGN-PRC.                                             48080200
           PERFORM                                                      48080400
               WITH TEST AFTER                                          48080500
               VARYING PV-RETRY-COUNT                                   48080600
               FROM 1 BY 1                                              48080700
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 48080800
                   OR (SQLCODE = +0)                                    48080900
                   OR (SQLCODE = +100))                                 48081000
               EXEC SQL                                                 48081100
100404             SELECT  LOC_SKU_STAT_CDE,                            48081200
                           UNT_RTL_AMT                                  48081300
                     INTO :XST00008-LOC-SKU-STAT-CDE,                   48081400
                          :XST00008-UNT-RTL-AMT                         48081500
                     FROM  XST_SKU_LOC A                                48081600
100404              WHERE  A.INTR_UPC_ID  = :XST00008-INTR-UPC-ID       48082400
100404                AND  A.LOC_NBR      = :DK-STORE-NBR               48082500
100404                AND  A.BEG_TMST    <= CURRENT TIMESTAMP           48082600
100404                AND  (A.END_TMST    > CURRENT TIMESTAMP           48082700
100404                 OR  A.END_TMST IS NULL)                          48082800
               END-EXEC                                                 48082900
                                                                        48083000
               EVALUATE TRUE                                            48083100
                   WHEN SQLCODE = ZERO                                  48083200
100404                 IF XST00008-LOC-SKU-STAT-CDE                     48083300
100404                                           = PC-CLEARANCE-STATUS  48083400
100404                     MOVE XST00008-UNT-RTL-AMT TO PV-CUR-RTL-AMT  48083500
                       END-IF                                           48083600
                   WHEN SQLCODE = -904                                  48083700
                   WHEN SQLCODE = -913                                  48083800
                   WHEN SQLCODE = +100                                  48083900
                       CONTINUE                                         48084000
                   WHEN OTHER                                           48084100
                       MOVE '7900-CHECK-REGN-PRC'                       48084400
                                             TO DP013-PARAGRAPH         48084500
100404                 MOVE 'SELECT DATA FROM XST_SKU_LOC'              48084600
                                             TO DP013-MESSAGE-TEXT (1)  48084700
                       MOVE SQLCA            TO DP013-SQLCA             48084800
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)48084900
                       SET DP013-DB2-ABEND                              48085200
                           DP013-XCTL-DISPLAY-RESTART                   48085300
                                         TO TRUE                        48085400
                       PERFORM DP013-0000-PROCESS-ABEND                 48085500
               END-EVALUATE                                             48085600
           END-PERFORM.                                                 48085700
                                                                        48086000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          48087000
               MOVE '7900-CHECK-REGN-PRC'                               48087100
                                     TO DP013-PARAGRAPH                 48087200
100404         MOVE 'SELECT DATA FROM XST_SKU_LOC'                      48087300
                                     TO DP013-MESSAGE-TEXT (1)          48087400
               MOVE SQLCA            TO DP013-SQLCA                     48087500
100404         MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)        48087600
               SET DP013-DB2-ABEND                                      48087900
                   DP013-XCTL-DISPLAY-RESTART                           48088000
                                 TO TRUE                                48088100
               PERFORM DP013-0000-PROCESS-ABEND                         48088200
           END-IF.                                                      48089600
      *                                                                 48089700
      *----------------------------------------------------------------*48089800
      *  CHECK FOR ASSUMPTIVE RECEIPT; IF NOT, CREATE ASSUMPTIVE       *48089900
      *  RECEIPT POSTINGS.                                             *48090000
      *----------------------------------------------------------------*48090100
       8100-CHK-ASSUMPTIVE-RECEIPT.                                     48090200
           PERFORM 7700-SELECT-ASSUMPTIVE-RECEIPT.                      48090300
                                                                        48090400
           IF SQLCODE  =  PC-ROW-NOT-FOUND                              48090500
               PERFORM 8110-CREATE-ASMTV-RCPT-BOOKING                   48090600
               SET  PS-MORE-XFER-ITMS  TO  TRUE                         48090700
           END-IF.                                                      48090800
      *                                                                 48090900
      *----------------------------------------------------------------*48091000
      *  CREATE THE ASSUMPTIVE RECEIPT POSTINGS.                       *48091100
      *----------------------------------------------------------------*48091200
       8110-CREATE-ASMTV-RCPT-BOOKING.                                  48091300
           PERFORM 6010-OPEN-XFER-ITM-CSR.                              48091400
           PERFORM 7050-FETCH-XFER-ITM-CSR.                             48091500
                                                                        48091600
           PERFORM 8111-CREATE-BOOKINGS                                 48091700
               UNTIL PS-END-OF-XFER-ITMS.                               48091800
                                                                        48091900
           PERFORM 6020-CLOSE-XFER-ITM-CSR.                             48092000
      *                                                                 48092100
      *----------------------------------------------------------------*48092200
      *  SET UP THE DATA FOR ASSUMPTIVE RECEIPT POSTING.               *48092300
      *----------------------------------------------------------------*48092400
       8111-CREATE-BOOKINGS.                                            48092500
           IF TFITEM-XFER-QTY  >  ZERO                                  48092600
               MOVE TFITEM-XFER-PRIC-AMT    TO  TFITPS-ITM-RTL-PRCE-AMT 48092700
               MOVE TFITEM-XFER-QTY         TO  TFITPS-ITM-QTY          48092800
               MOVE ASC-FR-STORE-NBR        TO  TFITPS-FRM-PSTG-STR-NBR 48092900
               MOVE ASC-TO-STORE-NBR        TO  TFITPS-TO-PSTG-STR-NBR  48093000
               MOVE PC-COMPLETE-RSN-CDE     TO  TFITPS-ADJ-RSN-CDE      48093100
111703*        IF (ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE                48093200
111703         IF (ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE-SORT1          48093300
111703               OR                                                 48093400
111703             ASC-XFER-TYPE  =  PC-DEFECTIVE-DAMAGE-SORT2          48093500
                     OR                                                 48094000
                   ASC-XFER-TYPE  =  PC-CALLBACK)                       48100000
                     OR                                                 48101000
                  (ASC-XFER-TYPE NOT =  PC-NON-RETAIL                   48102000
                     AND                                                48103000
                   TFITEM-ITM-NBR = ZEROS)                              48104000
                  MOVE PC-MERCHANDISE-LEDGER TO TFITPS-EXTL-SYS-PRCG-CDE48130000
               ELSE                                                     48140000
                  MOVE PC-FASHION-SALES      TO TFITPS-EXTL-SYS-PRCG-CDE48150000
               END-IF                                                   48160000
               PERFORM 7350-INSERT-ADJUSTMENT-ROW                       48170000
               MOVE ZEROS                   TO  PV-PSTG-SEQ-NBR         48180000
           END-IF.                                                      48190000
                                                                        48200000
           PERFORM 7050-FETCH-XFER-ITM-CSR.                             48210000
      *----------------------------------------------------------------*48220000
      *  UPDATE THE TRANSFER MASTER TABLE WITH CALLBACK NUMBER.        *48230000
      *----------------------------------------------------------------*48240000
       8600-UPDATE-TTFMSTR.                                             48250000
           PERFORM                                                      48260000
             WITH TEST AFTER                                            48270000
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       48280000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  48290000
                    OR SQLCODE = ZERO                                   48300000
               EXEC SQL                                                 48310000
                 UPDATE TTFMSTR                                         48320000
                   SET  CLBK_NBR           = :TFMSTR-CLBK-NBR           48330000
                   WHERE (XFER_DKEY_ID  = :DK-XFER-DKEY-ID)             48340000
               END-EXEC                                                 48350000
               EVALUATE TRUE                                            48360000
                   WHEN SQLCODE = ZERO                                  48370000
                   WHEN SQLCODE = -904                                  48380000
                   WHEN SQLCODE = -913                                  48390000
                       CONTINUE                                         48400000
                   WHEN SQLWARN0 NOT = SPACES                           48410000
                   WHEN SQLCODE < ZERO                                  48420000
                   WHEN SQLCODE > ZERO                                  48430000
                       MOVE '8600-UPDATE-TTFMSTR'                       48440000
                                           TO DP013-PARAGRAPH           48450000
                       MOVE 'UPDATE A ROW IN TTFMSTR'                   48460000
                                           TO DP013-MESSAGE-TEXT (1)    48470000
                       MOVE SQLCA          TO DP013-SQLCA               48480000
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  48490000
                       SET DP013-DB2-ABEND TO TRUE                      48500000
                       PERFORM DP013-0000-PROCESS-ABEND                 48510000
               END-EVALUATE                                             48520000
           END-PERFORM.                                                 48530000
                                                                        48540000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           48550000
              MOVE '8600-UPDATE-TTFMSTR'                                48560000
                                           TO DP013-PARAGRAPH           48570000
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'48580000
                                           TO DP013-MESSAGE-TEXT (1)    48590000
              MOVE 'IN THE TRANSFER MASTER TABLE'                       48600000
                                           TO DP013-MESSAGE-TEXT (2)    48610000
              MOVE SQLCA                   TO DP013-SQLCA               48620000
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  48630000
              SET DP013-DB2-ABEND          TO TRUE                      48640000
              PERFORM DP013-0000-PROCESS-ABEND                          48650000
           END-IF.                                                      48660000
       EJECT                                                            48660100
      *                                                                 48660200
      *----------------------------------------------------------------*48660300
      *    ABEND PROCESSOR MODULE                                      *48660400
      *----------------------------------------------------------------*48660500
                                                                        48660600
           COPY DPPD013.                                                48660700
